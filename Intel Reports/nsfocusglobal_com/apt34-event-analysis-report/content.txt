<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    
     <!-- Imports css bower-->
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/bower_components/bootstrap/dist/css/bootstrap.css">

    <!-- Reset css -->
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/reset.css">

    <!-- Imports css estilos -->
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/header.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/styles-global.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/index.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/product-page.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/solutions-overview.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/content-simple.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/contact.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/theme.css">
    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/footer.css">

    <link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/css/custom.css">

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">

	<!-- Add fancyBox -->
	<link rel="stylesheet" href="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/js/fancybox/source/jquery.fancybox.css?v=2.1.6" type="text/css" media="screen" />

  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en-us" href="https://nsfocusglobal.com/apt34-event-analysis-report/" />
<link rel="alternate" hreflang="pt-br" href="https://nsfocusglobal.com/pt-br/apt34-event-analysis-report/" />
<link rel="alternate" hreflang="x-default" href="https://nsfocusglobal.com/apt34-event-analysis-report/" />

	<!-- This site is optimized with the Yoast SEO plugin v20.6 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>APT34 Event Analysis Report - NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks.</title>
	<link rel="canonical" href="https://nsfocusglobal.com/apt34-event-analysis-report/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="APT34 Event Analysis Report - NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks." />
	<meta property="og:description" content="1 Overview On April 18, 2019 a hacker/hacker organization sold a toolkit of the APT34 group, under the false name of Lab Dookhtegan, on a Telegram channel. The organization also posted screenshots of the tool’s backend panels, where victim data had been collected. Early in the middle of March 2019, this hacker/hacker organization had released [&hellip;]" />
	<meta property="og:url" content="https://nsfocusglobal.com/apt34-event-analysis-report/" />
	<meta property="og:site_name" content="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks." />
	<meta property="article:published_time" content="2019-11-09T01:08:39+00:00" />
	<meta property="article:modified_time" content="2019-11-05T11:09:30+00:00" />
	<meta property="og:image" content="https://nsfocusglobal.com/wp-content/uploads/2019/08/cover.jpg" />
	<meta property="og:image:width" content="699" />
	<meta property="og:image:height" content="413" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Adeline Zhang" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Adeline Zhang" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="22 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://nsfocusglobal.com/apt34-event-analysis-report/","url":"https://nsfocusglobal.com/apt34-event-analysis-report/","name":"APT34 Event Analysis Report - NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks.","isPartOf":{"@id":"https://nsfocusglobal.com/pt-br/#website"},"primaryImageOfPage":{"@id":"https://nsfocusglobal.com/apt34-event-analysis-report/#primaryimage"},"image":{"@id":"https://nsfocusglobal.com/apt34-event-analysis-report/#primaryimage"},"thumbnailUrl":"https://nsfocusglobal.com/wp-content/uploads/2019/08/cover.jpg","datePublished":"2019-11-09T01:08:39+00:00","dateModified":"2019-11-05T11:09:30+00:00","author":{"@id":"https://nsfocusglobal.com/pt-br/#/schema/person/d0d0c2ea4b54c7653c863f1212bf1292"},"breadcrumb":{"@id":"https://nsfocusglobal.com/apt34-event-analysis-report/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://nsfocusglobal.com/apt34-event-analysis-report/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://nsfocusglobal.com/apt34-event-analysis-report/#primaryimage","url":"https://nsfocusglobal.com/wp-content/uploads/2019/08/cover.jpg","contentUrl":"https://nsfocusglobal.com/wp-content/uploads/2019/08/cover.jpg","width":699,"height":413},{"@type":"BreadcrumbList","@id":"https://nsfocusglobal.com/apt34-event-analysis-report/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://nsfocusglobal.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://nsfocusglobal.com/blog/"},{"@type":"ListItem","position":3,"name":"APT34 Event Analysis Report"}]},{"@type":"WebSite","@id":"https://nsfocusglobal.com/pt-br/#website","url":"https://nsfocusglobal.com/pt-br/","name":"NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks.","description":"Evolved Network Security","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://nsfocusglobal.com/pt-br/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https://nsfocusglobal.com/pt-br/#/schema/person/d0d0c2ea4b54c7653c863f1212bf1292","name":"Adeline Zhang","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://nsfocusglobal.com/pt-br/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/4e3759da48c7a887b50ac535d7751c6d?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/4e3759da48c7a887b50ac535d7751c6d?s=96&d=mm&r=g","caption":"Adeline Zhang"},"url":"https://nsfocusglobal.com/author/azhang/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//www.googletagmanager.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks. &raquo; Feed" href="https://nsfocusglobal.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks. &raquo; Comments Feed" href="https://nsfocusglobal.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks. &raquo; APT34 Event Analysis Report Comments Feed" href="https://nsfocusglobal.com/apt34-event-analysis-report/feed/" />
<link rel="alternate" type="application/rss+xml" title="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks. &raquo; Stories Feed" href="https://nsfocusglobal.com/web-stories/feed/"><style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='wp-block-library-css' href='https://nsfocusglobal.com/wp-includes/css/dist/block-library/style.min.css?ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css' href='https://nsfocusglobal.com/wp-includes/css/dashicons.min.css?ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='ap-block-posts-style-css' href='https://nsfocusglobal.com/wp-content/plugins/advanced-post-block/dist/style.css?ver=1.11.4' type='text/css' media='all' />
<link rel='stylesheet' id='classic-theme-styles-css' href='https://nsfocusglobal.com/wp-includes/css/classic-themes.min.css?ver=1' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;}:where(.is-layout-flex){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='wpml-blocks-css' href='https://nsfocusglobal.com/wp-content/plugins/sitepress-multilingual-cms/dist/css/blocks/styles.css?ver=4.6.4' type='text/css' media='all' />
<link rel='stylesheet' id='contact-form-7-css' href='https://nsfocusglobal.com/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.7.4' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://nsfocusglobal.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.3.13' type='text/css' media='all' />
<link rel='stylesheet' id='st-widget-css' href='https://nsfocusglobal.com/wp-content/plugins/share-this/css/style.css?ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='wp-pagenavi-css' href='https://nsfocusglobal.com/wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<link rel='stylesheet' id='cms-navigation-style-base-css' href='https://nsfocusglobal.com/wp-content/plugins/wpml-cms-nav/res/css/cms-navigation-base.css?ver=1.5.5' type='text/css' media='screen' />
<link rel='stylesheet' id='cms-navigation-style-css' href='https://nsfocusglobal.com/wp-content/plugins/wpml-cms-nav/res/css/cms-navigation.css?ver=1.5.5' type='text/css' media='screen' />
<link rel='stylesheet' id='fancybox-style-css' href='https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/js/fancybox/source/jquery.fancybox.css?v=2.1.6&#038;ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='fonts-style-css' href='https://fonts.googleapis.com/css?family=Roboto%3A300%2C400%2C500%2C400italic%2C300italic&#038;ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='base-style-css' href='https://nsfocusglobal.com/wp-content/themes/nsfocus/style.css?ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='base-theme-css' href='https://nsfocusglobal.com/wp-content/themes/nsfocus/theme.css?ver=6.1.7' type='text/css' media='all' />
<link rel='stylesheet' id='main-styles-css' href='https://nsfocusglobal.com/wp-content/themes/nsfocus/style.css?ver=1644238833' type='text/css' media='' />
<style id='wcw-inlinecss-inline-css' type='text/css'>
.widget_wpcategorieswidget ul.children{display:none;} .widget_wp_categories_widget{background:#fff; position:relative;}.widget_wp_categories_widget h2,.widget_wpcategorieswidget h2{color:#4a5f6d;font-size:20px;font-weight:400;margin:0 0 25px;line-height:24px;text-transform:uppercase}.widget_wp_categories_widget ul li,.widget_wpcategorieswidget ul li{font-size: 16px; margin: 0px; border-bottom: 1px dashed #f0f0f0; position: relative; list-style-type: none; line-height: 35px;}.widget_wp_categories_widget ul li:last-child,.widget_wpcategorieswidget ul li:last-child{border:none;}.widget_wp_categories_widget ul li a,.widget_wpcategorieswidget ul li a{display:inline-block;color:#007acc;transition:all .5s ease;-webkit-transition:all .5s ease;-ms-transition:all .5s ease;-moz-transition:all .5s ease;text-decoration:none;}.widget_wp_categories_widget ul li a:hover,.widget_wp_categories_widget ul li.active-cat a,.widget_wp_categories_widget ul li.active-cat span.post-count,.widget_wpcategorieswidget ul li a:hover,.widget_wpcategorieswidget ul li.active-cat a,.widget_wpcategorieswidget ul li.active-cat span.post-count{color:#ee546c}.widget_wp_categories_widget ul li span.post-count,.widget_wpcategorieswidget ul li span.post-count{height: 30px; min-width: 35px; text-align: center; background: #fff; color: #605f5f; border-radius: 5px; box-shadow: inset 2px 1px 3px rgba(0, 122, 204,.1); top: 0px; float: right; margin-top: 2px;}li.cat-item.cat-have-child > span.post-count{float:inherit;}li.cat-item.cat-item-7.cat-have-child { background: #f8f9fa; }li.cat-item.cat-have-child > span.post-count:before { content: "("; }li.cat-item.cat-have-child > span.post-count:after { content: ")"; }.cat-have-child.open-m-menu ul.children li { border-top: 1px solid #d8d8d8;border-bottom:none;}li.cat-item.cat-have-child:after{ position: absolute; right: 8px; top: 8px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAABmJLR0QA/wD/AP+gvaeTAAAAoklEQVQ4je3PzQpBURSG4WfknztxGS6BKOIaDQwkSXJTnI7J2rXbhSND3lqTtb/19m3+NGWANVof3LTiZpAWXVxQY4t2A0k7snXcdmGMKpY1dui8kHQik/JVOMAC9+zxlFfO6GFfSDZlaI5bFjpjWEgOhWT9rHYpu2CEPo7Z/v5KklgW37zG5JLlO0liVjTLJaumkmeyj5qUTEP2lSQxiflVHtR5PTMAQTkfAAAAAElFTkSuQmCC); content: ""; width: 18px; height: 18px;transform: rotate(270deg);}ul.children li.cat-item.cat-have-child:after{content:"";background-image: none;}.cat-have-child ul.children {display: none; z-index: 9; width: auto; position: relative; margin: 0px; padding: 0px; margin-top: 0px; padding-top: 10px; padding-bottom: 10px; list-style: none; text-align: left; background:  #f8f9fa; padding-left: 5px;}.widget_wp_categories_widget ul li ul.children li,.widget_wpcategorieswidget ul li ul.children li { border-bottom: 1px solid #fff; padding-right: 5px; }.cat-have-child.open-m-menu ul.children{display:block;}li.cat-item.cat-have-child.open-m-menu:after{transform: rotate(0deg);}.widget_wp_categories_widget > li.product_cat,.widget_wpcategorieswidget > li.product_cat {list-style: none;}.widget_wp_categories_widget > ul,.widget_wpcategorieswidget > ul {padding: 0px;}.widget_wp_categories_widget > ul li ul ,.widget_wpcategorieswidget > ul li ul {padding-left: 15px;}
</style>
<link rel='stylesheet' id='newsletter-css' href='https://nsfocusglobal.com/wp-content/plugins/newsletter/style.css?ver=7.6.8' type='text/css' media='all' />
<link rel='stylesheet' id='tablepress-default-css' href='https://nsfocusglobal.com/wp-content/tablepress-combined.min.css?ver=25' type='text/css' media='all' />
<link rel='stylesheet' id='moove_gdpr_frontend-css' href='https://nsfocusglobal.com/wp-content/plugins/gdpr-cookie-compliance/dist/styles/gdpr-main.css?ver=4.13.3' type='text/css' media='all' />
<style id='moove_gdpr_frontend-inline-css' type='text/css'>
#moove_gdpr_cookie_modal,#moove_gdpr_cookie_info_bar,.gdpr_cookie_settings_shortcode_content{font-family:Nunito,sans-serif}#moove_gdpr_save_popup_settings_button{background-color:#373737;color:#fff}#moove_gdpr_save_popup_settings_button:hover{background-color:#000}#moove_gdpr_cookie_info_bar .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton,#moove_gdpr_cookie_info_bar .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton{background-color:#0C4DA2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder a.mgbutton,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder button.mgbutton,.gdpr_cookie_settings_shortcode_content .gdpr-shr-button.button-green{background-color:#0C4DA2;border-color:#0C4DA2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder a.mgbutton:hover,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-footer-content .moove-gdpr-button-holder button.mgbutton:hover,.gdpr_cookie_settings_shortcode_content .gdpr-shr-button.button-green:hover{background-color:#fff;color:#0C4DA2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close span.gdpr-icon{background-color:#0C4DA2;border:1px solid #0C4DA2}#moove_gdpr_cookie_info_bar span.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar span.change-settings-button:focus,#moove_gdpr_cookie_info_bar button.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar button.change-settings-button:focus{-webkit-box-shadow:0 0 1px 3px #0C4DA2;-moz-box-shadow:0 0 1px 3px #0C4DA2;box-shadow:0 0 1px 3px #0C4DA2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close i:hover,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close span.gdpr-icon:hover,#moove_gdpr_cookie_info_bar span[data-href]>u.change-settings-button{color:#0C4DA2}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li.menu-item-selected a span.gdpr-icon,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li.menu-item-selected button span.gdpr-icon{color:inherit}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a span.gdpr-icon,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button span.gdpr-icon{color:inherit}#moove_gdpr_cookie_modal .gdpr-acc-link{line-height:0;font-size:0;color:transparent;position:absolute}#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-close:hover i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li button i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-modal-left-content #moove-gdpr-menu li a i,#moove_gdpr_cookie_modal .moove-gdpr-modal-content .moove-gdpr-tab-main .moove-gdpr-tab-main-content a:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content span.change-settings-button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.change-settings-button:hover,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button:hover,#moove_gdpr_cookie_info_bar span[data-href]>u.change-settings-button,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a.mgbutton:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button.mgbutton:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content a:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content button:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content span.change-settings-button.focus-g,span.change-settings-button:focus,button.change-settings-button.focus-g,button.change-settings-button:focus,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button.focus-g,#moove_gdpr_cookie_info_bar.moove-gdpr-dark-scheme .moove-gdpr-info-bar-container .moove-gdpr-info-bar-content u.change-settings-button:focus{color:#0C4DA2}#moove_gdpr_cookie_modal.gdpr_lightbox-hide{display:none}
</style>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/jquery/jquery.min.js?ver=3.6.1' id='jquery-core-js'></script>
<script type='text/javascript' id='jquery-core-js-after'>
jQuery(document).ready(function($){ jQuery('li.cat-item:has(ul.children)').addClass('cat-have-child'); jQuery('.cat-have-child').removeClass('open-m-menu');jQuery('li.cat-have-child > a').click(function(){window.location.href=jQuery(this).attr('href');return false;});jQuery('li.cat-have-child').click(function(){

		var li_parentdiv = jQuery(this).parent().parent().parent().attr('class');
			if(jQuery(this).hasClass('open-m-menu')){jQuery('.cat-have-child').removeClass('open-m-menu');}else{jQuery('.cat-have-child').removeClass('open-m-menu');jQuery(this).addClass('open-m-menu');}});});
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/underscore.min.js?ver=1.13.4' id='underscore-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/backbone.min.js?ver=1.4.1' id='backbone-js'></script>
<script type='text/javascript' id='wp-api-request-js-extra'>
/* <![CDATA[ */
var wpApiSettings = {"root":"https:\/\/nsfocusglobal.com\/wp-json\/","nonce":"96bcd82e5c","versionString":"wp\/v2\/"};
/* ]]> */
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/api-request.min.js?ver=6.1.7' id='wp-api-request-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/wp-api.min.js?ver=6.1.7' id='wp-api-js'></script>
<script type='text/javascript' id='wp-util-js-extra'>
/* <![CDATA[ */
var _wpUtilSettings = {"ajax":{"url":"\/wp-admin\/admin-ajax.php"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/wp-util.min.js?ver=6.1.7' id='wp-util-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.13.9' id='regenerator-runtime-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0' id='wp-polyfill-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/vendor/react.min.js?ver=17.0.1' id='react-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/vendor/react-dom.min.js?ver=17.0.1' id='react-dom-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/escape-html.min.js?ver=03e27a7b6ae14f7afaa6' id='wp-escape-html-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/element.min.js?ver=47162ff4492c7ec4956b' id='wp-element-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/advanced-post-block/assets/js/swiper-bundle.min.js?ver=7.0.3' id='swiper-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/advanced-post-block/assets/js/easy-ticker.min.js?ver=3.2.1' id='easyTicker-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/hooks.min.js?ver=4169d3cf8e8d95a3d6d5' id='wp-hooks-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/dist/i18n.min.js?ver=9e794f35a71bb98672ae' id='wp-i18n-js'></script>
<script type='text/javascript' id='wp-i18n-js-after'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/advanced-post-block/dist/script.js?ver=1.11.4' id='ap-block-posts-script-js'></script>
<script type='text/javascript' id='wpml-browser-redirect-js-extra'>
/* <![CDATA[ */
var wpml_browser_redirect_params = {"pageLanguage":"en","languageUrls":{"en_us":"https:\/\/nsfocusglobal.com\/apt34-event-analysis-report\/","en":"https:\/\/nsfocusglobal.com\/apt34-event-analysis-report\/","us":"https:\/\/nsfocusglobal.com\/apt34-event-analysis-report\/","pt_br":"https:\/\/nsfocusglobal.com\/pt-br\/apt34-event-analysis-report\/","pt":"https:\/\/nsfocusglobal.com\/pt-br\/apt34-event-analysis-report\/","br":"https:\/\/nsfocusglobal.com\/pt-br\/apt34-event-analysis-report\/","pt-br":"https:\/\/nsfocusglobal.com\/pt-br\/apt34-event-analysis-report\/"},"cookie":{"name":"_icl_visitor_lang_js","domain":"nsfocusglobal.com","path":"\/","expiration":24}};
/* ]]> */
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/sitepress-multilingual-cms/dist/js/browser-redirect/app.js?ver=4.6.4' id='wpml-browser-redirect-js'></script>

<!-- Google Analytics snippet added by Site Kit -->
<script type='text/javascript' src='https://www.googletagmanager.com/gtag/js?id=GT-P8VJD75' id='google_gtagjs-js' async></script>
<script type='text/javascript' id='google_gtagjs-js-after'>
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag('set', 'linker', {"domains":["nsfocusglobal.com"]} );
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "GT-P8VJD75");
</script>

<!-- End Google Analytics snippet added by Site Kit -->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://nsfocusglobal.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://nsfocusglobal.com/wp-includes/wlwmanifest.xml" />
<link rel='shortlink' href='https://nsfocusglobal.com/?p=9526' />
<link rel="alternate" type="application/json+oembed" href="https://nsfocusglobal.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnsfocusglobal.com%2Fapt34-event-analysis-report%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://nsfocusglobal.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fnsfocusglobal.com%2Fapt34-event-analysis-report%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.4 stt:1,44;" />
<meta name="generator" content="Site Kit by Google 1.111.0" /><meta name="google-site-verification" content="VOgyKvZQuiXfNpeAiVIja4rBgwNcAbriZ7Bhpu11t_8" />
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-W47JDG62');</script>
<!-- End Google Tag Manager --><script charset="utf-8" type="text/javascript">var switchTo5x=true;</script>
<script charset="utf-8" type="text/javascript" id="st_insights_js" src="https://ws.sharethis.com/button/buttons.js?publisher=wp.4ef35619-c8dc-4e68-b977-a68abc1a07fb&amp;product=sharethis-wordpress"></script>
<script charset="utf-8" type="text/javascript">stLight.options({"publisher":"wp.4ef35619-c8dc-4e68-b977-a68abc1a07fb","doNotCopy":true,"hashAddressBar":false,"doNotHash":true});var st_type="wordpress5.4.2";</script>
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css" id="wp-custom-css">
			.wp-block-image figcaption {
	text-align: center;
}		</style>
		  <link rel='stylesheet' id='base-style-css'  href='https://nsfocusglobal.com/wp-content/themes/nsfocus/style.css' type='text/css' media='all' />
  </head>
  <body>

  <header>

    <!-- Modal -->
    <div class="modal fade" id="underAttack" tabindex="-1" role="dialog" aria-labelledby="underAttackLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header" style="border: 0;">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          </div>
          <div class="modal-body">
            <div class="modal-attack">
              <h2>Under Attack</h2>
              <p>We understand that when you are under attack you need help immediately. Our team of security experts are available to get you back online and help ensure your critical assets are protected.</p>
              <h4>North America/International HQ - Santa Clara, CA</h4>
              <h5>call: + 1 408-907-6638</h5>

              <h4>LATAM - Sao Paulo, Brazil</h4>
              <h5>call: +55 11 3521-7124</h5>

              <h4>Asia Pacific - Singapore</h4>
              <h5>call: +65 6509-8500</h5>

              <h4>Japan - Tokyo</h4>
              <h5>call: +81 3-6206-8156</h5>

              <h4>EMEA - United Kingdom</h4>
              <h5>call: +44 (0) 20 3476 6</h5>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- <a href=""><button type="button" class="under" data-toggle="modal" data-target="#underAttack">Under Attack? Call Us</button></a> -->
    <a href="https://nsfocusglobal.com/under-attack/"><button type="button" class="under">Under Attack? Call Us</button></a>
    <div class="top-menu">
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <div class="row">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-2">



              <ul class="nav navbar-nav navbar-right">

              <li id="menu-item-6169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6169"><a href="/blog">Blog</a></li>
<li id="menu-item-23689" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23689"><a href="https://nsfocusglobal.com/trial-enquiry/">Trial Enquiry</a></li>
<li id="menu-item-25621" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25621"><a href="https://nsfocusglobal.com/support-2/">Support Portal</a></li>
<li id="menu-item-6674" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6674"><a target="_blank" rel="noopener" href="http://www.nsfocus.com.cn/">中文</a></li>
<li id="menu-item-19169" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19169"><a href="/pt-br/">Portuguese</a></li>

                                <!--  -->
                <!-- UNCOMMENT THIS BLOCK TO SHOW LANGUAGES OPTIONS -->
                <!--  -->
                <!-- <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Language <span class="caret"></span></a>
                  <ul class="dropdown-menu">
                                      </ul>
                </li> -->


              </ul>





            </div><!-- /.navbar-collapse -->
          </div>
        </div><!-- /.container-fluid -->
      </nav>
    </div>
    <div class="main-menu">
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <div class="row">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="https://nsfocusglobal.com/">
                <img src="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/images/logo-ns.png" alt="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks.">
              </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav navbar-right navbar-main-menu">

                  <ul id="menu-03-new-main-menu" class="nav navbar-nav"><li id="menu-item-25623" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-25623 dropdown"><a title="Cloud-Delivered Services" href="https://nsfocusglobal.com/products/cloud-ddos-protection-service-cloud-dps/" class="dropdown-toggle">Cloud-Delivered Services <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-6789" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6789"><a title="Cloud DDoS Protection Service" href="/cloud-ddos-protection-service-cloud-dps/">Cloud DDoS Protection Service</a></li>
	<li id="menu-item-26204" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-26204"><a title="Continuous Threat Exposure Management" href="https://nsfocusglobal.com/products/continuous-threat-exposure-management/">Continuous Threat Exposure Management</a></li>
	<li id="menu-item-6790" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6790 dropdown"><a title="Threat Intelligence Service" href="/threat-intelligence-ti/">Threat Intelligence Service</a>
	<ul role="menu" class=" dropdown-menu">
		<li id="menu-item-4470" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4470"><a title="Threat Intelligence Subscription Service" href="https://nsfocusglobal.com/products/threat-intelligence-ti/">Threat Intelligence Subscription Service</a></li>
		<li id="menu-item-6741" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6741"><a title="Exposed Internet Surface Analysis" href="https://nsfocusglobal.com/products/exposed-internet-surface-analysis/">Exposed Internet Surface Analysis</a></li>
		<li id="menu-item-8170" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8170"><a title="Attack Threat Monitoring" href="https://nsfocusglobal.com/products/attack-threat-monitoring/">Attack Threat Monitoring</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-5074" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-5074 dropdown"><a title="Products" href="/products/anti-ddos-system-ads/" class="dropdown-toggle">Products <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-6788" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6788"><a title="DDoS Attack Protection" href="/anti-ddos-system-ads/">DDoS Attack Protection</a></li>
	<li id="menu-item-25622" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-25622 dropdown"><a title="Security Operations" href="https://nsfocusglobal.com/products/intelligent-security-operations-platform-isop/">Security Operations</a>
	<ul role="menu" class=" dropdown-menu">
		<li id="menu-item-14056" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14056"><a title="Intelligent Security Operations Platform" href="https://nsfocusglobal.com/products/intelligent-security-operations-platform-isop/">Intelligent Security Operations Platform</a></li>
		<li id="menu-item-22304" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22304"><a title="Unified Threat Sensor" href="https://nsfocusglobal.com/products/unified-threat-sensor/">Unified Threat Sensor</a></li>
	</ul>
</li>
	<li id="menu-item-27449" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27449"><a title="Remote Security Assessment System" href="https://nsfocusglobal.com/products/remote-security-assessment-system/">Remote Security Assessment System</a></li>
	<li id="menu-item-6791" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6791 dropdown"><a title="Web Application &amp; API Protection" href="https://nsfocusglobal.com/products/web-application-firewall-waf/">Web Application &#038; API Protection</a>
	<ul role="menu" class=" dropdown-menu">
		<li id="menu-item-5917" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5917"><a title="Web Application Firewall" href="https://nsfocusglobal.com/products/web-application-firewall-waf/">Web Application Firewall</a></li>
	</ul>
</li>
	<li id="menu-item-21564" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21564"><a title="Next-Generation Firewall" href="https://nsfocusglobal.com/products/next-gen-firewall-2/">Next-Generation Firewall</a></li>
	<li id="menu-item-6540" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6540"><a title="Next Generation Intrusion Prevention" href="https://nsfocusglobal.com/products/next-generation-intrusion-prevention-ngips/">Next Generation Intrusion Prevention</a></li>
</ul>
</li>
<li id="menu-item-20500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-20500 dropdown"><a title="Solutions" href="https://nsfocusglobal.com/solutions-overview-4/" class="dropdown-toggle">Solutions <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-4480" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-4480 dropdown"><a title="DDoS Defenses" href="https://nsfocusglobal.com/solutions-overview-3/on-premises/">DDoS Defenses</a>
	<ul role="menu" class=" dropdown-menu">
		<li id="menu-item-4870" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4870"><a title="On-Premises DDoS Defenses" href="https://nsfocusglobal.com/solutions-overview-3/on-premises/">On-Premises DDoS Defenses</a></li>
		<li id="menu-item-4871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4871"><a title="Hybrid DDoS Defenses" href="https://nsfocusglobal.com/solutions-overview-3/hybrid-ddos-protection/">Hybrid DDoS Defenses</a></li>
	</ul>
</li>
	<li id="menu-item-20400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20400"><a title="Value-Added Service for ISP/MSP" href="https://nsfocusglobal.com/solutions-overview-3/value-added-service-solution/">Value-Added Service for ISP/MSP</a></li>
	<li id="menu-item-20428" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20428"><a title="5G Network Security Solution" href="https://nsfocusglobal.com/solutions-overview-3/5g-network-security-solution/">5G Network Security Solution</a></li>
	<li id="menu-item-6611" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6611"><a title="Cloud-in-a-Box" href="https://nsfocusglobal.com/products/cloud-box-ciab/">Cloud-in-a-Box</a></li>
</ul>
</li>
<li id="menu-item-18147" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-18147 dropdown"><a title="Support &amp; Services" href="https://nsfocusglobal.com/services/" class="dropdown-toggle">Support &#038; Services <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-18149" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-18149"><a title="Services Overview" href="/services">Services Overview</a></li>
	<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a title="NSFOCUS Product Support Services" href="https://nsfocusglobal.com/services/nsfocus-product-support-services/">NSFOCUS Product Support Services</a></li>
	<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21315"><a title="NSFOCUS Professional Services" href="https://nsfocusglobal.com/services/nsfocus-professional-services/">NSFOCUS Professional Services</a></li>
	<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a title="NSFOCUS Security Assessment Services" href="https://nsfocusglobal.com/services/nsfocus-security-assessment-services/">NSFOCUS Security Assessment Services</a></li>
	<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a title="NSFOCUS Managed Security Services" href="https://nsfocusglobal.com/services/nsfocus-managed-security-services/">NSFOCUS Managed Security Services</a></li>
	<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a title="Training Services" href="https://nsfocusglobal.com/services/training-services/">Training Services</a></li>
</ul>
</li>
<li id="menu-item-4420" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4420 dropdown"><a title="Resources" href="https://nsfocusglobal.com/company-overview/resources/" class="dropdown-toggle">Resources <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-6682" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6682"><a title="Datasheets" href="https://nsfocusglobal.com/company-overview/resources#datasheets">Datasheets</a></li>
	<li id="menu-item-6683" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6683"><a title="Whitepapers" href="https://nsfocusglobal.com/company-overview/resources#whitepapers">Whitepapers</a></li>
	<li id="menu-item-6684" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6684"><a title="Reports" href="https://nsfocusglobal.com/company-overview/resources#reports">Reports</a></li>
	<li id="menu-item-6685" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6685"><a title="Case Studies" href="https://nsfocusglobal.com/company-overview/resources#case-studies">Case Studies</a></li>
	<li id="menu-item-6686" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6686"><a title="Infographics" href="https://nsfocusglobal.com/company-overview/resources#info">Infographics</a></li>
	<li id="menu-item-6687" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6687"><a title="Articles" href="https://nsfocusglobal.com/company-overview/resources#articles">Articles</a></li>
</ul>
</li>
<li id="menu-item-6681" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6681 dropdown"><a title="News and Events" href="/category/press-releases/" class="dropdown-toggle">News and Events <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-4589" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4589"><a title="Press Releases" href="https://nsfocusglobal.com/category/press-releases/">Press Releases</a></li>
	<li id="menu-item-4588" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4588"><a title="NSFOCUS in the News" href="https://nsfocusglobal.com/category/news/">NSFOCUS in the News</a></li>
	<li id="menu-item-4590" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4590"><a title="Global Events" href="https://nsfocusglobal.com/category/events/">Global Events</a></li>
</ul>
</li>
<li id="menu-item-4411" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4411 dropdown"><a title="Company" href="https://nsfocusglobal.com/company-overview/about/" class="dropdown-toggle">Company <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-4483" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4483"><a title="About" href="https://nsfocusglobal.com/company-overview/about/">About</a></li>
	<li id="menu-item-4415" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4415"><a title="Management Team" href="https://nsfocusglobal.com/company-overview/management-team/">Management Team</a></li>
	<li id="menu-item-4416" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4416"><a title="NSFOCUS Security Labs" href="https://nsfocusglobal.com/company-overview/nsfocus-security-labs/">NSFOCUS Security Labs</a></li>
	<li id="menu-item-4412" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4412"><a title="Careers" href="https://nsfocusglobal.com/company-overview/careers/">Careers</a></li>
	<li id="menu-item-4413" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4413"><a title="Contact Us" href="https://nsfocusglobal.com/company-overview/contact-us/">Contact Us</a></li>
</ul>
</li>
</ul>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6169"><a href="/blog">Blog</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23689"><a href="https://nsfocusglobal.com/trial-enquiry/">Trial Enquiry</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25621"><a href="https://nsfocusglobal.com/support-2/">Support Portal</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6674"><a target="_blank" rel="noopener" href="http://www.nsfocus.com.cn/">中文</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19169"><a href="/pt-br/">Portuguese</a></li>
                    
                    <!--  -->
                    <!-- UNCOMMENT THIS BLOCK TO SHOW LANGUAGES OPTIONS -->
                    <!--  -->
                    <!-- <li class="dropdown language-mobile">
  	                  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Language <span class="caret"></span></a>
  	                  <ul class="dropdown-menu">	                    
  	                      	                  </ul>
  	                </li> -->



                <!-- <li><a class="under" href="#" data-toggle="modal" data-target="#underAttack">Under Attack? Call Us</a></li> -->
                <li><a class="under" href="https://nsfocusglobal.com/under-attack/">Under Attack? Call Us</a></li>
              </ul>
            </div><!-- /.navbar-collapse -->
          </div>
        </div><!-- /.container-fluid -->
      </nav>
    </div>
  </header>
<div class="space-header"></div>
	<section class="hero-internal-global" style="background: url('/wp-content/uploads/2017/02/banner-company.jpg') 80% 50% / cover no-repeat;">
	    <div class="container">
	        <div class="row">
	            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
	                <h1 style="text-align: center;">APT34 Event Analysis Report</h1>
	            </div>
	        </div>
	    </div>
	</section>

	<!-- Content page -->
	<section class="content-simple single-page">
		<div class="container">
			<div class="row">
				<div class="single-content col-lg-12 col-md-12 col-sm-12" style="padding: 0px 40px;">
									                <h3 class="acblogstitle">APT34 Event Analysis Report</h3>      <div class="acdateauth">November 9, 2019 | <b>Adeline Zhang</b></div>
      <div class="acblogpostcontent">
         <div class="acblogpostSthumb"><img width="699" height="413" src="https://nsfocusglobal.com/wp-content/uploads/2019/08/cover.jpg" class="attachment-full size-full wp-post-image" alt="" decoding="async" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/08/cover.jpg 699w, https://nsfocusglobal.com/wp-content/uploads/2019/08/cover-300x177.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/08/cover-305x180.jpg 305w" sizes="(max-width: 699px) 100vw, 699px" /></div>
         <h2><span id="1_Overview"><strong><a name="_Toc130115382"></a><a name="_Toc6669485"></a>1 Overview</strong></span></h2>
<p>On April 18, 2019 a hacker/hacker organization sold a toolkit of the APT34 group, under the false name of Lab Dookhtegan, on a Telegram channel. The organization also posted screenshots of the tool’s backend panels, where victim data had been collected. Early in the middle of March 2019, this hacker/hacker organization had released and sold this toolkit on the Internet. Interestingly, the CEO of a security company in Kuwait took to Twitter to stress in particular the authenticity of this post.<span id="more-9526"></span></p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-1.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9527" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-1.jpg" alt="" width="534" height="271" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-1.jpg 534w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-1-300x152.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-1-332x168.jpg 332w" sizes="(max-width: 534px) 100vw, 534px"></a></p>
<p>Tools included in the leaked toolkit are listed as follows:</p>
<ul>
<li>Glimpse: a new trojan based on PowerShell, dubbed BondUpdater by Palo Alto Networks</li>
<li>PoisonFrog: an old version of BondUpdater</li>
<li>HyperShell</li>
<li>HighShell: dubbed TwoFace by Palo Alto Networks</li>
<li>MinionProject: Fox management interface with the HighShell module loaded</li>
<li>Webmask: HTTP proxy hijacking tool, the main tool behind DNSpionage, used for DNS tunneling</li>
</ul>
<p>NSFOCUS Security Labs and NSFOCUS M01N Security Research Team made an analysis of this toolkit together and found that tools included in the leaked toolkit differed from the previously released attacks tools of the APT34 group. In this report, we have made a detailed analysis of the leaked tools from the perspectives of tactics, techniques and procedures (TTPs).</p>
<h3><span id="11_Distribution_of_Attack_Targets_by_Industry"><strong><a name="_Toc6669486"></a>1.1 Distribution of Attack Targets by Industry</strong></span></h3>
<p>In addition to countries in the Middle East, APT34 has also hit China Mainland,  China Taiwan, Turkey, Albania, and other countries and regions. China Mainland and China Taiwan both received a large proportion of attacks.</p>
<p>Through analysis, we have found 12 malicious WebShell files used to target China Energy Conservation and Environmental Protection Group, China Railway Construction Corporation, and Western Securities Co., Ltd. among other Chinese companies, as well as six such files used to be against companies in Hong Kong, Macao, and Taiwan.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-2.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9528" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-2.jpg" alt="" width="794" height="195" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-2.jpg 794w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-2-300x74.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-2-768x189.jpg 768w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-2-332x82.jpg 332w" sizes="(max-width: 794px) 100vw, 794px"></a></p>
<p>The released toolkit also contains a lot of passwords which are packaged and released in different archives according to information sources.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-3.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9529" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-3.jpg" alt="" width="697" height="403" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-3.jpg 697w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-3-300x173.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-3-311x180.jpg 311w" sizes="(max-width: 697px) 100vw, 697px"></a></p>
<p>From the above figure, we can see that the archive names contain airport names and oil company names. More than 12,000 weak passwords were disclosed this time.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-4.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9530" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-4.jpg" alt="" width="354" height="473" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-4.jpg 354w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-4-225x300.jpg 225w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-4-135x180.jpg 135w" sizes="(max-width: 354px) 100vw, 354px"></a></p>
<h3><span id="12_About_APT34"><strong><a name="_Toc6669487"></a>1.2 About APT34</strong></span></h3>
<p>The APT34 group, named by FireEye, uses tools and attack approaches that bear a high resemblance to the OilRig organization, an organization active in the Middle East followed up by Palo Alto Networks. The APT34 group started to carry out malicious activities as early as in 2014, targeting governments and the financial, energy, chemical, and telecom sectors. This group, though often seen in the Middle East, also hits China, as indicated in files leaked this time.</p>
<p>On November 4, 2017, FireEye discovered that this group exploited the vulnerability (CVE-2017-11882) to launch attacks by leveraging tools similar to those leaked this time.</p>
<h2><span id="2_TTPs"><strong><a name="_Toc6669488"></a>2 TTPs</strong></span></h2>
<p>During the functional analysis of APT34’s leaked sample, we have ascertained the attack tactics and techniques used by this hacking group, via a reverse deduction based on attack procedures. Overall, four phases of the kill chain are involved: privilege escalation, collection, exfiltration, and command and control.</p>
<p><strong>Privilege Escalation</strong></p>
<p>This leaked sample uses multiple WebShell backdoor programs like HighShell, HyperShell, and MinionProject, each of which is a .NET program. Some of these programs encrypt the communications in order to evade defense measures. By reference to the tool use record documents included in the leaked files and the list of websites compromised by APT34, we can see that this hacking group mainly uses these WebShell programs, placed in /owa/auth/, to target the Outlook email system of the Exchange server. This sample’s attack targets are found all around the world, including 14 enterprises in the energy and securities sectors in the Chinese mainland. By the time this report is released, some of those WebShell backdoor programs are still active.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-5.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9531" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-5.jpg" alt="" width="549" height="142" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-5.jpg 549w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-5-300x78.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-5-332x86.jpg 332w" sizes="(max-width: 549px) 100vw, 549px"></a></p>
<p>The following figure shows WebShell backdoors targeting companies in China:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-6.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9532" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-6.jpg" alt="" width="522" height="157" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-6.jpg 522w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-6-300x90.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-6-332x100.jpg 332w" sizes="(max-width: 522px) 100vw, 522px"></a></p>
<p>The following table lists URLs of active WebShells:</p>
<table width="556">
<thead>
<tr>
<td width="299">WebShell</td>
<td width="154">Website</td>
<td width="103">Country/Region</td>
</tr>
</thead>
<tbody>
<tr>
<td width="299">https://202.***.***.31/owa/auth/signout.aspx</td>
<td width="154">rtarf.*****.th</td>
<td width="103">Thailand</td>
</tr>
<tr>
<td width="299">https://202.***.***.4/owa/auth/signout.aspx</td>
<td width="154">rtarf.*****.th</td>
<td width="103">Thailand</td>
</tr>
<tr>
<td width="299">https://122.***.***.136/owa/auth/error3.aspx</td>
<td width="154">mail.*****.com.tw</td>
<td width="103">Taiwan</td>
</tr>
<tr>
<td width="299">https://202.***.***.169/owa/auth/signin.aspx</td>
<td width="154">*****.com{outlook}</td>
<td width="103"></td>
</tr>
<tr>
<td width="299">https://202.***.***.206/owa/auth/signout.aspx</td>
<td width="154">wmail.*****.com</td>
<td width="103"></td>
</tr>
<tr>
<td width="299">https://213.***.***.51/owa/auth/logon.aspx</td>
<td width="154">*****.gov.tr{outlook}</td>
<td width="103">Turkey</td>
</tr>
<tr>
<td width="299">https://1.***.***.13/owa/auth/error1.aspx</td>
<td width="154">mail.*****.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://1.***.***.14/owa/auth/error1.aspx</td>
<td width="154">mail.*****.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://114.***.***.1/owa/auth/error1.aspx</td>
<td width="154">mail.generali-*****.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://180.***.***.217/owa/auth/error3.aspx</td>
<td width="154">exchange.*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://180.***.***.230/owa/auth/error1.aspx</td>
<td width="154">*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://210.***.***.26/owa/auth/error1.aspx</td>
<td width="154">lswebext.*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://221.***.***.230/owa/auth/outlook.aspx</td>
<td width="154">mail.*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://222.***.***.8/owa/auth/outlook.aspx</td>
<td width="154">mail.*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://222.***.***.76/owa/auth/error1.aspx</td>
<td width="154">*****.*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://58.***.***.113/owa/auth/error1.aspx</td>
<td width="154">mail.*****.com.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://60.***.***.237/owa/auth/error3.aspx</td>
<td width="154">*****.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://60.***.***.237/owa/auth/logoff.aspx</td>
<td width="154">*****.cn</td>
<td width="103">China</td>
</tr>
<tr>
<td width="299">https://202.***.***.218/owa/auth/error1.aspx</td>
<td width="154">mail.*****.com</td>
<td width="103"></td>
</tr>
<tr>
<td width="299">https://202.***.***.218/owa/auth/exppw.aspx</td>
<td width="154">mail.*****.com</td>
<td width="103"></td>
</tr>
<tr>
<td width="299">https://132.***.***.165/owa/auth/logout.aspx</td>
<td width="154">CSEX.*****.technion.ac.il</td>
<td width="103">Israel</td>
</tr>
<tr>
<td width="299">https://132.***.***.165/owa/auth/signout.aspx</td>
<td width="154">CSEX.csf.*****.ac.il</td>
<td width="103">Israel</td>
</tr>
<tr>
<td width="299">https://209.***.***.35/owa/auth/logout.aspx</td>
<td width="154">mail.*****.co.zw</td>
<td width="103">Zimbabwe</td>
</tr>
<tr>
<td width="299">https://114.***.***.22/owa/auth/login.aspx</td>
<td width="154">mail.******.ws</td>
<td width="103">Samoa</td>
</tr>
<tr>
<td width="299">https://114.***.***.3/owa/auth/login.aspx</td>
<td width="154">mail.*****.ws</td>
<td width="103">Samoa</td>
</tr>
<tr>
<td width="299">https://185.***.***.199/owa/auth/logout.aspx</td>
<td width="154">******.com.sa</td>
<td width="103">Saudi Arabia</td>
</tr>
<tr>
<td width="299">https://46.***.****.125/owa/auth/signin.aspx</td>
<td width="154">*****.com.sa</td>
<td width="103">Saudi Arabia</td>
</tr>
<tr>
<td width="299">https://51.***.***.170/owa/auth/owaauth.aspx</td>
<td width="154">*****.edu.sa</td>
<td width="103">Saudi Arabia</td>
</tr>
<tr>
<td width="299">https://91.***.***.155/owa/auth/signin.aspx</td>
<td width="154">*****.gov.sa</td>
<td width="103">Saudi Arabia</td>
</tr>
<tr>
<td width="299">https://83.***.***.132/owa/auth/logon.aspx</td>
<td width="154">mail.*****.com.ps{outlook}</td>
<td width="103">Palestine</td>
</tr>
<tr>
<td width="299">https://78.***.***.199/owa/auth/logon.aspx</td>
<td width="154">*****.gov.qa{outlook}</td>
<td width="103">Qatar</td>
</tr>
<tr>
<td width="299">https://110.***.***.90/owa/auth/errorff.aspx</td>
<td width="154">mail.fmis.*****.gov.kh</td>
<td width="103">Cambodia</td>
</tr>
<tr>
<td width="299">https://211.***.***.68/owa/auth/error1.aspx</td>
<td width="154">mailexchange.*****.co.kr</td>
<td width="103">North Korea</td>
</tr>
<tr>
<td width="299">https://168.***.***.220/owa/auth/error3.aspx</td>
<td width="154">mail.tc-*****.co</td>
<td width="103">Colombia</td>
</tr>
<tr>
<td width="299">https://213.***.***.221/owa/auth/errorff.aspx</td>
<td width="154">*****.gov.kw</td>
<td width="103">Kuwait</td>
</tr>
<tr>
<td width="299">https://77.***.***.125/owa/auth/logout.aspx</td>
<td width="154">{ul.*****.lb}</td>
<td width="103">Lebanon</td>
</tr>
<tr>
<td width="299">https://202.***.***.11/owa/auth/error1.aspx</td>
<td width="154">webmail.*****.com.mo</td>
<td width="103">Macao</td>
</tr>
<tr>
<td width="299">https://202.***.***.141/owa/auth/error3.aspx</td>
<td width="154">*****.must.edu.mo</td>
<td width="103">Macao</td>
</tr>
<tr>
<td width="299">https://213.***.***.73/owa/auth/error4.aspx</td>
<td width="154">ad.*****.eg{shell}</td>
<td width="103">Egypt</td>
</tr>
<tr>
<td width="299">https://200.***.***.13/owa/auth/error3.aspx</td>
<td width="154">sre.*****.mx</td>
<td width="103">Mexico</td>
</tr>
<tr>
<td width="299">https://202.***.***.68/owa/auth/error0.aspx</td>
<td width="154">mfa.*****.mn</td>
<td width="103">Myanmar</td>
</tr>
<tr>
<td width="299">https://202.***.***.68/owa/auth/error1.aspx</td>
<td width="154">mifa.*****.mn</td>
<td width="103">Myanmar</td>
</tr>
<tr>
<td width="299">https://197.***.***.10/owa/auth/logout.aspx</td>
<td width="154">mail.*****.gov.ng</td>
<td width="103">Nigeria</td>
</tr>
<tr>
<td width="299">https://41.***.***.221/owa/auth/logout.aspx</td>
<td width="154">mail.*****.gov.ng</td>
<td width="103">Nigeria</td>
</tr>
<tr>
<td width="299">https://mail.*****.ae/owa/auth/change_password.aspx</td>
<td width="154">mail.*****.ae</td>
<td width="103">United Arab Emirates</td>
</tr>
<tr>
<td width="299">https://mail.*****.com.sa/owa/auth/GetLoginToken.aspx</td>
<td width="154">mail.*****.com.sa</td>
<td width="103">Saudi Arabia</td>
</tr>
<tr>
<td width="299">https://webmail.*****.bh/owa/auth/Timeoutctl.aspx</td>
<td width="154">webmail.*****.bh</td>
<td width="103">Bahrain</td>
</tr>
<tr>
<td width="299">https://webmail.*****.bh/owa/auth/EventClass.aspx</td>
<td width="154">webmail.*****.bh</td>
<td width="103">Bahrain</td>
</tr>
<tr>
<td width="299">https://webmail.*****.bh/ecp/auth/EventClass.aspx</td>
<td width="154">webmail.*****.bh</td>
<td width="103">Bahrain</td>
</tr>
<tr>
<td width="299">http://*****.ae:8080/_layouts/WrkStatLog.aspx</td>
<td width="154">*****.ae</td>
<td width="103">United Arab Emirates</td>
</tr>
<tr>
<td width="299">https://www.*****.jo/statistic.aspx</td>
<td width="154">www.*****.jo</td>
<td width="103">Jordan</td>
</tr>
<tr>
<td width="299">https://e-*****.al/dptaktkonstatim.aspx</td>
<td width="154">e-*****.al</td>
<td width="103">Albania</td>
</tr>
<tr>
<td width="299">https://webmail.*****.ae/owa/auth/RedirSuiteService.aspx</td>
<td width="154">webmail.*****.ae</td>
<td width="103">United Arab Emirates</td>
</tr>
<tr>
<td width="299">https://webmail.*****.ae/owa/auth/handlerservice.aspx</td>
<td width="154">webmail.*****.ae</td>
<td width="103">United Arab Emirates</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong>Collection</strong></p>
<p>Our Webmask analysis of this leaked sample mainly focuses on attacks against Outlook. Through the analysis, we found that such attacks used the email connection and man-in-the-browser (MITB) technologies. Also, we dissected the sample’s source code and instructions and discovered that this tool could steal users’ email account passwords and cookies for Outlook authentication as well as inject code into traffic for further information collection.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-7.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9533" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-7.jpg" alt="" width="693" height="572" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-7.jpg 693w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-7-300x248.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-7-218x180.jpg 218w" sizes="(max-width: 693px) 100vw, 693px"></a></p>
<p><strong>Exfiltration</strong></p>
<p>In this phase, the Exfiltration Over Command and Control Channel tactic is applied. The attacker sends sensitive data to the controlled server using a DNS protocol through command and control, in a way to avoid information disclosure due to common data loss prevention techniques.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-8.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9534" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-8.jpg" alt="" width="672" height="321" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-8.jpg 672w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-8-300x143.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-8-332x159.jpg 332w" sizes="(max-width: 672px) 100vw, 672px"></a></p>
<p><strong>Command and Control</strong></p>
<p>The leaked sample used two remote access Trojans (RATs), <strong>poisonfrog.ps1 </strong>(old version) and Glimpse (<strong>dns_main.ps1</strong>) (new version), for remote control of the target server by using a DNS protocol for communication.</p>
<p>After a sample analysis, we found that both versions of RATs used PowerShell as an agent for code execution, and prior to that, the RATs needed to hijack the victim’s DNS server for DNS redirection in order to parse the domain name suffix designated by the attacker. By generating a subdomain with a specific algorithm, the victim’s machine performs a DNS query to request an A/TXT record of the subdomain from the DNS server (C2 server) and obtains the IP address provided by the C2 server for communications. In addition, the attacker will create a scheduled task to execute the PowerShell script regularly to obtain information from the C2 server before executing commands. The C2 server mainly provides command execution and file upload and download functions.</p>
<p>The C2 server of the old version already implements proxy detection and can download files from the remote server for web proxy configuration. The old version only supports the query of DNS A records and generates subdomain names that contain part of the UUID (Universally Unique Identifier) value of the victim’s system.</p>
<p>The C2 server of the new version does not involve proxy configuration and deems that the DNS hijacking is already completed. It can parse DNS TXT records and generate subdomain names that do not contain the UUID value of the victim’s system.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-9.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9535" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-9.jpg" alt="" width="498" height="279" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-9.jpg 498w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-9-300x168.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-9-321x180.jpg 321w" sizes="(max-width: 498px) 100vw, 498px"></a></p>
<h2><span id="3_Trojan_and_WebShell_Analysis"><strong><a name="_Toc6669489"></a>3 Trojan and WebShell Analysis</strong></span></h2>
<p>The following figures show the directory structure of each tool used by this leaked sample:</p>
<p>Glimpse:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-10.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9536" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-10.jpg" alt="" width="266" height="238" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-10.jpg 266w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-10-201x180.jpg 201w" sizes="(max-width: 266px) 100vw, 266px"></a></p>
<p>PoisonFrog:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-11.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9537" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-11.jpg" alt="" width="363" height="379" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-11.jpg 363w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-11-287x300.jpg 287w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-11-172x180.jpg 172w" sizes="(max-width: 363px) 100vw, 363px"></a></p>
<p>Webmask:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-12.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9538" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-12.jpg" alt="" width="293" height="177"></a></p>
<p>Webshells_and_Panel:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-13.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9539" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-13.jpg" alt="" width="487" height="43" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-13.jpg 487w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-13-300x26.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-13-332x29.jpg 332w" sizes="(max-width: 487px) 100vw, 487px"></a></p>
<p>When sorting out files and trying to reproduce the sample, we found that remote control tools had an incomplete logic which renders one-click deployment impossible. These tools can run properly only after an analysis and reconfiguration is completed. MinionProject, however, cannot directly execute due to the lack of files.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-14.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9540" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-14.jpg" alt="" width="567" height="212" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-14.jpg 567w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-14-300x112.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-14-332x124.jpg 332w" sizes="(max-width: 567px) 100vw, 567px"></a></p>
<p>To sum up, we believe that the leaked toolkit is incomplete, which should be noted during analysis of the toolkit. So far, no backdoor is discovered left by the leaker.</p>
<h3><span id="31_Glimpse"><strong><a name="_Toc6669490"></a>3.1 Glimpse</strong></span></h3>
<p>Glimpse is a remote control tool that uses DNS tunneling. It consists of an agent, a panel, and a server.</p>
<h4><span id="311_Agent"><strong>3.1.1 Agent</strong></span></h4>
<p>The agent is a program at the controlled end.</p>
<ul>
<li><strong>Major Functions</strong></li>
</ul>
<p>The startup script is <strong>runner_.vbs</strong> which is used to start the main script of PowerShell.</p>
<p>The main script is <strong>dns_main.ps1</strong> used for communications with the server.</p>
<ul>
<li><strong>File-related Operations</strong></li>
</ul>
<p>The program generates the directory <strong>PUBLIC\Libraries\guid\</strong> (hereinafter referred to as the agent directory in which guid is generated by <strong>Dns_main.ps1</strong>) and creates folders in this directory like <strong>receivebox</strong>, <strong>sendbox</strong>, and <strong>done</strong> to communicate with the server by reading or writing into files in these folders.</p>
<ul>
<li><strong>Communication Process</strong></li>
</ul>
<ol>
<li>The agent can communicate with the server through the ping mode (DNS A mode) or text mode (DNS TXT mode). Commands received by the agent from the server are saved as files with RCVD as the file name prefix in the <strong>\receivebox\ </strong>directory of the agent.</li>
<li>Check the commands from the server and perform the related behavior.</li>
</ol>
<p>The following table lists commands from the server.</p>
<table width="529">
<thead>
<tr>
<td width="101">Trailing Byte of a Command File Name</td>
<td width="123">Meaning</td>
<td width="296">Operation</td>
</tr>
</thead>
<tbody>
<tr>
<td width="101">0</td>
<td width="123">Executing commands issued by the server</td>
<td width="296">Reads contents from the command file, executes them as CMD commands, and saves the command output as a file with <strong>proc</strong> as the file name prefix in the agent directory, <strong>\sendbox</strong>.</td>
</tr>
<tr>
<td width="101">1</td>
<td width="123">Uploading a file</td>
<td width="296">Places the file designated in the body of the command file in the agent directory <strong>\sendbox</strong> and sends this file to the C&amp;C server.</td>
</tr>
<tr>
<td width="101">Others</td>
<td width="123">Downloading a file</td>
<td width="296">Places the command file in the agent directory <strong>\done</strong>.</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<ol start="3">
<li>After executing commands issued by the server, the agent will send the file saved in the agent directory <strong>\sendbox</strong> to the server.</li>
</ol>
<h4><span id="312_Panel"><strong>3.1.2 Panel</strong></span></h4>
<p>The panel is the graphic panel of Glimpse, used to manage the communications between the agent and the server.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-15.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9541" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-15.jpg" alt="" width="507" height="281" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-15.jpg 507w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-15-300x166.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-15-325x180.jpg 325w" sizes="(max-width: 507px) 100vw, 507px"></a></p>
<h4><span id="313_Server"><strong>3.1.3 Server</strong></span></h4>
<p>The server issues commands to the agent, instructing it what to do next.</p>
<ul>
<li><strong>Major Functions</strong></li>
</ul>
<p>The server uses a DNS tunneling protocol for communications, issuing commands to the agent or receiving files uploaded by the agent via the DNS tunnel of the A or TXT type.</p>
<ul>
<li><strong>File-related Operations</strong></li>
</ul>
<p>The program generates the directory <strong>ALLUSERSPROFILE/Glimpse/dns/aid/</strong> (hereinafter referred to as the server directory in which <strong>aid</strong> indicates the guid ID received from the agent) and then creates folders like <strong>wait</strong>, <strong>receive</strong>, <strong>done</strong>, <strong>sended</strong>, and <strong>sending</strong> in this directory to communicate with the agent by reading or writing into files in those folders.</p>
<ul>
<li><strong>Communication Process</strong></li>
</ul>
<ol>
<li>Receives false DNS requests from the agent.</li>
<li>Parses information received from the agent by using local rules.</li>
</ol>
<p>For a false DNS request, the contents are in the format of data.mainData.mainData2.mainData3, each part of which contains different contents.</p>
<p><strong>Data</strong></p>
<table width="529">
<thead>
<tr>
<td width="89">0–14</td>
<td width="64">15–n</td>
<td width="64">n+1</td>
<td width="105">n+2</td>
<td width="104">n+3</td>
<td width="48">n+4</td>
</tr>
</thead>
<tbody>
<tr>
<td width="89">dataRand</td>
<td width="64">Unknown</td>
<td width="64">C</td>
<td width="105">reqNoIndex</td>
<td width="104">actionIndex</td>
<td width="48">T</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>If the data contains the trailing string CxxT (x indicates arbitrary characters), the server determines that the data is based on a tunneling protocol.</p>
<p>If the data contains the trailing string in other formats than CxxT, the server forwards the data.</p>
<p><strong>datarand</strong>: records the action and aid. The data location is variable and determined by both reqNoIndex and actionIndex.</p>
<p><strong>aid</strong>: ID of the packet, based on which the server directory is generated on the server.</p>
<p><strong>action</strong>: action of the agent.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-16.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9542" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-16.jpg" alt="" width="532" height="154" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-16.jpg 532w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-16-300x87.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-16-332x96.jpg 332w" sizes="(max-width: 532px) 100vw, 532px"></a></p>
<table width="529">
<thead>
<tr>
<td width="109">Value of the action Field</td>
<td width="410">Operation</td>
</tr>
</thead>
<tbody>
<tr>
<td width="109">M</td>
<td width="410">The agent checks the <strong>mode</strong> folder in the specific directory and handles ping information.</td>
</tr>
<tr>
<td width="109">W</td>
<td width="410">The server, in the DNS TXT manner, merges the contents in the <strong>wait</strong> folder in the server directory and sends them.</td>
</tr>
<tr>
<td width="109">D</td>
<td width="410">The server sends the contents in the <strong>wait</strong> folder in the server directory as fragments in DNS TXT manner.</td>
</tr>
<tr>
<td width="109">0</td>
<td width="410">The server disguises names of files in the <strong>wait</strong> folder as IP strings and sends them to the agent.</td>
</tr>
<tr>
<td width="109">1</td>
<td width="410">The server sends files in the <strong>wait</strong> folder as fragments to the agent in DNS A manner.</td>
</tr>
<tr>
<td width="109">2</td>
<td width="410">The server receives files by fragment from the agent in DNS A manner and saves them in the <strong>part</strong> folder.</td>
</tr>
</tbody>
</table>
<p><strong>mainData</strong>: saves the body of the command file.</p>
<p><strong>mainData2</strong>: saves the command file name.</p>
<p><strong>mainData3</strong>: saves the domain name of the C&amp;C server.</p>
<ul>
<li><strong>Tunnel Format</strong></li>
</ul>
<p>The server is a forged DNS server which responds to the agent’s DNS requests by returning designated IP strings. Different IP strings have different meanings, as shown in the following table.</p>
<table width="529">
<thead>
<tr>
<td>IP String</td>
<td>Meaning</td>
</tr>
</thead>
<tbody>
<tr>
<td>99.250.250.199</td>
<td>The server responds to a new agent and creates a session.</td>
</tr>
<tr>
<td>199.250.250.99</td>
<td>The server responds to the ping information of the agent.</td>
</tr>
<tr>
<td>3.2.1.0</td>
<td>The server has files to be sent.</td>
</tr>
<tr>
<td>24.125.a.b</td>
<td>A file named <strong>a+b</strong> waits to be sent by the server.</td>
</tr>
<tr>
<td>11.24.237.110</td>
<td>There are files to be sent by the server.</td>
</tr>
<tr>
<td>a.b.c.d</td>
<td>The server sends fragments as DNS A records. In this IP string, <strong>a.b.c</strong> indicates the data contents and <strong>d</strong> indicates the data index.</td>
</tr>
<tr>
<td>1.2.3.0</td>
<td>Fragments are sent by the server.</td>
</tr>
<tr>
<td>a.2.3.b</td>
<td>The server is receiving fragments from the agent. In this IP string, <strong>a</strong> indicates the agent ID and <strong>b</strong> indicates the fragment ID.</td>
</tr>
<tr>
<td>253.25.42.87</td>
<td>The server has received fragments from the agent.</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3><span id="32_PoisonFrog"><strong><a name="_Toc6669491"></a>3.2 PoisonFrog</strong></span></h3>
<ul>
<li><strong>Major Functions</strong></li>
</ul>
<p>PoisonFrog is a remote control tool that can steal information from the controlled server and execute CMD commands issued by the C&amp;C server.</p>
<ul>
<li><strong>Operation Process</strong></li>
</ul>
<ol>
<li>The <strong>ps1</strong> script executes to release the <strong>hUpdater.ps1</strong> and <strong>dUpdater.ps1</strong> scripts and the <strong>UpdateTask.vbs</strong> script as well as set Windows scheduled tasks.</li>
<li>The <strong>ps1</strong> script accesses the C&amp;C domain and uploads and downloads files as instructed by commands issued via the domain.</li>
<li>The <strong>ps1</strong> script identifies the trailing character of the name of the file downloaded from the C&amp;C server as the command and operates on files in the specified directory as instructed by this command.</li>
<li>As a scheduled task, the <strong>vbs</strong> script is set to execute every 10 minutes.</li>
</ol>
<p>The following figure shows part of contents of the <strong>poisonfrog.ps1</strong> script.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-17.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9543" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-17.jpg" alt="" width="754" height="125" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-17.jpg 754w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-17-300x50.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-17-332x55.jpg 332w" sizes="(max-width: 754px) 100vw, 754px"></a></p>
<ul>
<li><strong>Component Analysis</strong></li>
</ul>
<p><strong>hUpdater.ps1</strong></p>
<p>This script is mainly used to send data to the C&amp;C server and receive commands and files from this server.</p>
<p>When <strong>cfg.ini</strong> exists, the <strong>hUpdater.ps1</strong> script will read contents from this file to extract the proxy and communicate with the C&amp;C server in proxy mode.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-18.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9544" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-18.jpg" alt="" width="547" height="264" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-18.jpg 547w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-18-300x145.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-18-332x160.jpg 332w" sizes="(max-width: 547px) 100vw, 547px"></a></p>
<p>As for command format parsing, the <strong>hUpdater.ps1</strong> script obtains strings from the C&amp;C server and splits them into four or more arrays with angle brackets. SSA[0]&lt;&gt;SSA[1]&lt;&gt;SSA[2]&lt;&gt;SSA[3]&lt;&gt;SSA[4]&lt;&gt;SSA[5] is such an example. In the string, each array corresponds to a different response function. For instance, when SSA[2] has a value other than <strong>not</strong>, it downloads files to a specified directory. The following table describes functions of these arrays.</p>
<table width="529">
<thead>
<tr>
<td width="89">Command</td>
<td width="461">Description</td>
</tr>
</thead>
<tbody>
<tr>
<td width="89">SSA[0]</td>
<td width="461">When SSA[0] has a value other than <strong>not</strong>, upload the file named <strong>SSA[0]</strong> to the URI <strong>/fil/<em>domain name</em>/SSA[0]</strong> and then delete the original file.</td>
</tr>
<tr>
<td width="89">SSA[1]</td>
<td width="461">When SSA[1] has a value other than <strong>not</strong>, it uploads strings to a specified URL. SSA[1] code has been commented out.</td>
</tr>
<tr>
<td width="89">SSA[2]</td>
<td width="461">When SSA[0] has a value other than <strong>not</strong>, download the file under <strong>/fil/SSA[3] </strong>to the local directory C:/…./SSA[0]/SSA[2].</td>
</tr>
<tr>
<td width="89">SSA[4]</td>
<td width="461">When SSA[4] has a value other than <strong>not</strong>, upload the SSA[4] file to <strong>/fil/<em>domain name</em>/SSA[0]</strong>.</td>
</tr>
<tr>
<td width="89">SSA[5]</td>
<td width="461">When the array length is 2, continue to perform operations within the loop.</td>
</tr>
</tbody>
</table>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-19.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9545" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-19.jpg" alt="" width="548" height="341" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-19.jpg 548w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-19-300x187.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-19-289x180.jpg 289w" sizes="(max-width: 548px) 100vw, 548px"></a></p>
<p><strong>dUpdater.ps1</strong></p>
<p>The <strong>dUpdater.ps1</strong> script parses the trailing character in the file name located first during the traversal of the <strong>receivebox</strong> folder, as a command. The following table describes the mapping between commands and the script’s functions.</p>
<table width="529">
<thead>
<tr>
<td width="102">Command</td>
<td width="448">Description</td>
</tr>
</thead>
<tbody>
<tr>
<td width="102">0</td>
<td width="448">The <strong>dUpdater.ps1</strong> script parses the contents in the <strong>ZZA[0]</strong> file in the <strong>receivebox</strong> folder and writes the contents into the<strong> ZZA[0]</strong> file in the <strong>sendbox</strong> directory. If the <strong>ZZA[0]</strong> file exists in the <strong>receivebox</strong> folder, this script will delete this file.</td>
</tr>
<tr>
<td width="102">1</td>
<td width="448">If the contents in the <strong>ZZA[0]</strong> file in the <strong>receivebox</strong> folder is parsed as a file path, the <strong>dUpdater.ps1</strong> script copies this file to the <strong>sendbox</strong> directory and then deletes the <strong>ZZA[0]</strong> file in the <strong>receivebox</strong> folder.
<p>&nbsp;</p></td>
</tr>
<tr>
<td width="102">2</td>
<td width="448">The <strong>dUpdater.ps1</strong> script moves the<strong> ZZA[0]</strong> file in the <strong>receivebox </strong>folder to the <strong>done/</strong> directory and types <strong>200&lt;&gt;</strong> plus <em>the path of the done/ directory</em> as the content of this file and then deletes the <strong>ZZA[0] file</strong> in the <strong>receivebox </strong>folder.</td>
</tr>
</tbody>
</table>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-20.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9546" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-20.jpg" alt="" width="685" height="459" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-20.jpg 685w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-20-300x201.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-20-269x180.jpg 269w" sizes="(max-width: 685px) 100vw, 685px"></a></p>
<p><strong>Server-Side Scripts</strong></p>
<p>The scripts are used to assemble commands (e.g. SSA[0]&lt;&gt;SSA[1]&lt;&gt;SSA[2]&lt;&gt;SSA[3]&lt;&gt;SSA[4]&lt;&gt;SSA[5]) and store data. Each function has its own function.</p>
<table width="529">
<thead>
<tr>
<td width="220">Function</td>
<td width="300">Description</td>
</tr>
</thead>
<tbody>
<tr>
<td width="220">Panel</td>
<td width="300">Serves as a control panel.</td>
</tr>
<tr>
<td width="220">NotFount</td>
<td width="300">Notifies the log-in user of the login failure.</td>
</tr>
<tr>
<td width="220">Posted</td>
<td width="300">Issues commands from the agent panel to upload and download files.</td>
</tr>
<tr>
<td width="220">Deletecommand</td>
<td width="300">Deletes commands from the database.</td>
</tr>
<tr>
<td width="220">Deleteagent</td>
<td width="300">Deletes the agent and its related files.</td>
</tr>
<tr>
<td width="220">Descriptionposted</td>
<td width="300">Describes information returned by the server.</td>
</tr>
<tr>
<td width="220">Fileposted</td>
<td width="300">Sends files to the <strong>receive</strong> folder on the server.</td>
</tr>
<tr>
<td width="220">Agent</td>
<td width="300">Creates the <strong>receive</strong>, <strong>send</strong>, and <strong>wait</strong> folders in each <strong>agentID</strong> folder and stores files that contain commands in such folders and writes commands into the database.</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3><span id="33_WebMask"><strong><a name="_Toc6669492"></a>3.3 WebMask</strong></span></h3>
<p>This tool is used by the APT34 group as a DNS proxy and for HTTP hijacking.</p>
<ul>
<li>Major Functions</li>
</ul>
<p>This tool consists of three parts:</p>
<ul>
<li>Shell script <strong>sh</strong>: used for installation</li>
<li><strong>py</strong>: used to steal passwords and for hijacking</li>
<li><strong>py</strong>, <strong>dnsd.js</strong>, and <strong>config.json</strong>: used to configure the local DNS proxy
<ul>
<li>Component Analysis</li>
</ul>
</li>
</ul>
<p>DNSd Module</p>
<p>This module starts the local DNS proxy. The configuration file and the IP address of the proxy server are specified with startup parameters. By default, the script only does DNS forwarding.</p>
<p>The DNSd module can be started using the python script (<strong>dnsd.py</strong>) or JavaScript (<strong>dnsd.js</strong>).</p>
<p><strong>guide.txt</strong> explains two way to use the DNSd tool.</p>
<ol>
<li><strong>py</strong> is used as a transparent proxy.</li>
</ol>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-21.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9547" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-21.jpg" alt="" width="439" height="211" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-21.jpg 439w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-21-300x144.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-21-332x160.jpg 332w" sizes="(max-width: 439px) 100vw, 439px"></a></p>
<ol start="2">
<li>The native-dns module is used as a DNS proxy. As shown in the following figure, 195.229.237.52 is the IP address of a DNS server in the United Arab Emirates and 185.162.235.106 is a bot IP address used as an example.</li>
</ol>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-22.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9548" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-22.jpg" alt="" width="487" height="249" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-22.jpg 487w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-22-300x153.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-22-332x170.jpg 332w" sizes="(max-width: 487px) 100vw, 487px"></a></p>
<p><strong>Icap Module</strong></p>
<p>This module is a tool written in PyICAP. PyICAP is a python3 framework for writing ICAP servers. ICAP is usually used to extend transparent proxy servers, implementing content filters in the transparent HTTP proxy cache and performing specific services (can be specified by developers) for HTTP requests/responses.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-23.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9549" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-23.jpg" alt="" width="526" height="275" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-23.jpg 526w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-23-300x157.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-23-332x174.jpg 332w" sizes="(max-width: 526px) 100vw, 526px"></a></p>
<p>The extract_login_password method is used to steal account passwords included in HTTP information and record them in a designated file. It extracts data in HTTP requests using regular expressions.</p>
<p>Meanwhile, this tool records header information involved in HTTP interactions, including the user’s IP address, request time, requested content, and recorded cookies. When analyzing the tool code, we found hijacking code, i.e., the following JavaScript statement:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-24.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9550" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-24.jpg" alt="" width="951" height="37" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-24.jpg 951w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-24-300x12.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-24-768x30.jpg 768w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-24-332x13.jpg 332w" sizes="(max-width: 951px) 100vw, 951px"></a></p>
<p>When the hijacking code executes, the first img src leads the victim’s machine to access <strong>logo.jpg</strong> on the attacker’s server. During the process, NTLM authentication will be conducted automatically to allow the attacker to obtain the NetNTLMv2 hash which can be used for man-in-the-middle (MITM) attacks.</p>
<p>Assume that the attacker has taken control of the proxy. In this case, he can use his server to respond to DNS requests to WPAD, and then answer requests to obtain images that are actually PAC files.</p>
<h3><span id="34_Webshells_and_Panel"><strong><a name="_Toc6669493"></a>3.4 Webshells_and_Panel</strong></span></h3>
<p>The Webshells_and_Panel directory contains multiple WebShell tools written in C#:</p>
<p><strong>simpleDownload.aspx</strong>: a simple tool only with the upload function.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-25.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9551" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-25.jpg" alt="" width="434" height="135" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-25.jpg 434w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-25-300x93.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-25-332x103.jpg 332w" sizes="(max-width: 434px) 100vw, 434px"></a></p>
<p><strong>simple.aspx</strong>: a relatively complicated tool to provide authentication and command execution functions besides the upload function.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-26.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9552" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-26.jpg" alt="" width="516" height="252" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-26.jpg 516w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-26-300x147.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-26-332x162.jpg 332w" sizes="(max-width: 516px) 100vw, 516px"></a></p>
<p><strong>highshell.aspx</strong>: a full-featured tool that seems like the first version, providing functions like file upload, command execution, and database manipulation. This version of tool was reported by Palo Alto Networks in 2017.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-27.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9553" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-27.jpg" alt="" width="734" height="325" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-27.jpg 734w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-27-300x133.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-27-237x105.jpg 237w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-27-332x147.jpg 332w" sizes="(max-width: 734px) 100vw, 734px"></a></p>
<p>This tool implements login authentication as follows:</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-28.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9554" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-28.jpg" alt="" width="866" height="110" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-28.jpg 866w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-28-300x38.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-28-768x98.jpg 768w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-28-332x42.jpg 332w" sizes="(max-width: 866px) 100vw, 866px"></a></p>
<p>The following shows how login authentication is implemented via pseudocode:</p>
<p>Base64(sha256(bytes(cookies[“p”] + salt))) == pp</p>
<p>Both <strong>salt</strong> and <strong>pp</strong> are predefined values.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-29.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9555" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-29.jpg" alt="" width="740" height="94" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-29.jpg 740w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-29-300x38.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-29-332x42.jpg 332w" sizes="(max-width: 740px) 100vw, 740px"></a></p>
<p>The configured cookie value can be used for authentication.</p>
<p>In addition, we have found multiple upgraded versions (minor differences exists between them) of HighShell in the Hypershell directory. The following figure shows HighShell 8.6.2.</p>
<p><a href="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-30.jpg"><img decoding="async" loading="lazy" class="alignnone size-full wp-image-9556" src="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-30.jpg" alt="" width="508" height="277" srcset="https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-30.jpg 508w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-30-300x164.jpg 300w, https://nsfocusglobal.com/wp-content/uploads/2019/11/1109-30-330x180.jpg 330w" sizes="(max-width: 508px) 100vw, 508px"></a></p>
<p>This version of tool is rewritten with the Semantic UI framework and its backend has been split into several modules. Arguably, this version goes further in engineering than common versions. Like other versions, this version performs authentication based on cookies.</p>
<p>&nbsp;</p>
<h2><span id="4_YARA_Rules"><strong><a name="_Toc6669494"></a>4 YARA Rules</strong></span></h2>
<table>
<tbody>
<tr>
<td width="565">/*
<p>YARA Rule Set</p>
<p>Author: Florian Roth</p>
<p>Date: 2019-04-17</p>
<p>Identifier: Leaked APT34 / OilRig tools</p>
<p>Reference: https://twitter.com/0xffff0800/status/1118406371165126656</p>
<p>*/</p>
<p>rule APT_APT34_PS_Malware_Apr19_1 {</p>
<p>meta:</p>
<p>description = “Detects APT34 PowerShell malware”</p>
<p>author = “Florian Roth”</p>
<p>reference = “https://twitter.com/0xffff0800/status/1118406371165126656”</p>
<p>date = “2019-04-17”</p>
<p>hash1 = “b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768”</p>
<p>strings:</p>
<p>$x1 = “= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID” ascii</p>
<p>$x2 = “Write-Host \”excepton occured!\”” ascii /* 🙂 */</p>
<p>&nbsp;</p>
<p>$s1 = “Start-Sleep -s 1;” fullword ascii</p>
<p>$s2 = “Start-Sleep -m 100;” fullword ascii</p>
<p>condition:</p>
<p>1 of ($x*) or 2 of them</p>
<p>}</p>
<p>&nbsp;</p>
<p>rule APT_APT34_PS_Malware_Apr19_2 {</p>
<p>meta:</p>
<p>description = “Detects APT34 PowerShell malware”</p>
<p>author = “Florian Roth”</p>
<p>reference = “https://twitter.com/0xffff0800/status/1118406371165126656”</p>
<p>date = “2019-04-17”</p>
<p>hash1 = “2943e69e6c34232dee3236ced38d41d378784a317eeaf6b90482014210fcd459”</p>
<p>strings:</p>
<p>$x1 = “= \”http://\” + [System.Net.Dns]::GetHostAddresses(\”” ascii</p>
<p>$x2 = “$t = get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID” fullword ascii</p>
<p>$x3 = “| Where { $_ -notmatch ‘^\\s+$’ }” ascii</p>
<p>&nbsp;</p>
<p>$s1 = “= new-object System.Net.WebProxy($u, $true);” fullword ascii</p>
<p>$s2 = ” -eq \”dom\”){$” ascii</p>
<p>$s3 = ” -eq \”srv\”){$” ascii</p>
<p>$s4 = “+\”&lt;&gt;\” | Set-Content” ascii</p>
<p>condition:</p>
<p>1 of ($x*) and 3 of them</p>
<p>}</p>
<p>&nbsp;</p>
<p>rule APT_APT34_PS_Malware_Apr19_3 {</p>
<p>meta:</p>
<p>description = “Detects APT34 PowerShell malware”</p>
<p>author = “Florian Roth”</p>
<p>reference = “https://twitter.com/0xffff0800/status/1118406371165126656”</p>
<p>date = “2019-04-17”</p>
<p>hash1 = “27e03b98ae0f6f2650f378e9292384f1350f95ee4f3ac009e0113a8d9e2e14ed”</p>
<p>strings:</p>
<p>$x1 = “Powershell.exe -exec bypass -file ${global:$address1}”</p>
<p>$x2 = “schtasks /create /F /ru SYSTEM /sc minute /mo 10 /tn”</p>
<p>$x3 = “\”\\UpdateTasks\\UpdateTaskHosts\””</p>
<p>$x4 = “wscript /b \\`\”${global:$address1” ascii</p>
<p>$x5 = “::FromBase64String([string]${global:$http_ag}))” ascii</p>
<p>$x6 = “.run command1, 0, false\” | Out-File ” fullword ascii</p>
<p>$x7 = “\\UpdateTask.vbs” fullword ascii</p>
<p>$x8 = “hUpdater.ps1” fullword ascii</p>
<p>condition:</p>
<p>1 of them</p>
<p>}</p></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><a name="_Toc6669495"></a>Source: <a href="https://github.com/Neo23x0/signature-base/blob/master/yara/apt_oilrig.yar">https://github.com/Neo23x0/signature-base/blob/master/yara/apt_oilrig.yar</a></p>
<h2><span id="5_Indicators_of_Compromise"><strong>5 Indicators of Compromise</strong></span></h2>
<p>myleftheart.com</p>
<p>C:\Users\Public\Public\atag[0-9]{4}[A-Z]{2}</p>
<p>C:\Users\Public\Public\dUpdater.ps1</p>
<p>C:\Users\Public\Public\hUpdated.ps1</p>
<p>C:\Users\Public\Public\UpdateTask.vbs</p>
<p>27e03b98ae0f6f2650f378e9292384f1350f95ee4f3ac009e0113a8d9e2e14ed</p>
<p>b1d621091740e62c84fc8c62bcdad07873c8b61b83faba36097ef150fd6ec768</p>
<p>2943e69e6c34232dee3236ced38d41d378784a317eeaf6b90482014210fcd459</p>
<p>07e791d18ea8f2f7ede2962522626b43f28cb242873a7bd55fff4feb91299741</p>
<p>dd6d7af00ef4ca89a319a230cdd094275c3a1d365807fe5b34133324bdaa0229</p>
<p>3ca3a957c526eaeabcf17b0b2cd345c0fffab549adfdf04470b6983b87f7ec62</p>
<p>c9d5dc956841e000bfd8762e2f0b48b66c79b79500e894b4efa7fb9ba17e4e9e</p>
<p>a6a0fbfee08367046d3d26fb4b4cf7779f7fb6eaf7e60e1d9b6bf31c5be5b63e</p>
<p>fe1b011fe089969d960d2dce2a61020725a02e15dbc812ee6b6ecc6a98875392</p>
<p>185.***.***.61</p>
<p>46.***.***.196</p>
<p>185.***.***.80</p>
<p>185.***.***.17</p>
<p>185.***.***,252</p>
<p>185.***.***.103</p>
<p>70.***.***.34</p>
<p>109.***.***.129</p>
<p>185.***.***.140</p>
<p>185.***.***.158</p>
<p>178.***.***.230</p>
<p>146.***.***.108</p>
<p>23.***.***.76</p>
<p>185.***.***.8</p>
<p>95.***.***.172</p>
<p>173.***.***.194</p>
<p>173.***.***.201</p>
<p>172.***.***.238</p>
<p>23.***.***.69</p>
<p>185.***.***.86</p>
<p>185.***.***.56</p>
<p>194.***.***.15</p>
<p>185.***.***.63</p>
<p>81.***.***.249</p>
<p>213.***.***.32</p>
<p>46.***.***.42</p>
<p>185.***.***.157</p>
<p>198.***.***.22</p>
<p>213.***.***.9</p>
<p>158.***.***.62</p>
<p>168.***.***.92</p>
<p>38.***.***.153</p>
<p>176.***.***.215</p>
<p>88.***.***.174</p>
<p>190.***.***.59</p>
<p>103.***.***.181</p>
<p>217.***.***.122</p>
<p>46.***.***.52</p>
<p>185.***.***.35</p>
<p>172.***.***.226</p>
<p>103.***.***.14</p>
<p>95.***.***.173</p>
<p>142.***.***.99</p>
<p>194.***.***.23</p>
<p>194.***.***.10</p>
<p>185.***.***.14</p>
<p>185.***.***.35</p>
<p>185.***.***.75</p>
<p>185.***.***.157</p>
<p>185.***.***.59</p>
<p>185.***.***.217</p>
<p>23.***.***.6</p>
<p>185.***.***.63</p>
<h2><span id="6_Mitigations"><strong><a name="_Toc6669496"></a>6 Mitigations</strong></span></h2>
<ol>
<li>Be cautious with emails from unknown sources. Do not open emails from strangers, such as those containing links, so as to prevent information disclosure or computer viruses.</li>
<li>Do not use weak passwords. Change passwords frequently and make sure strong enough passwords are used.</li>
<li>Fix vulnerabilities in time, especially those in border devices. Enable automatic update on not-frequently-used devices to keep the devices and their software latest.</li>
<li>Deploy border protection devices and an intelligence-based alerting system provided by security firms to nip security hazards in the bud.</li>
</ol>
<h2><span id="7_Detection_Means"><strong>7 Detection Means</strong></span></h2>
<p>Network layer:</p>
<p>Check whether there are abnormal DNS parsing server addresses.</p>
<p>Check whether machines within the network send a great number of DNS requests every 50 ms.</p>
<p>Check whether there are abnormal domain name requests.</p>
<p>Host layer:</p>
<p>Check whether the following directories or files exist on hosts:</p>
<p>C:\Users\Public\Public\atag[0-9]{4}[A-Z]{2}</p>
<p>C:\Users\Public\Public\dUpdater.ps1</p>
<p>C:\Users\Public\Public\hUpdated.ps1</p>
<p>C:\Users\Public\Public\UpdateTask.vbs</p>
<p>Check whether DNS server addresses are tampered with on hosts.</p>
<p><a name="_Toc6669498"></a>Check whether unknown files exist in the root directory of the HTTP server.</p>
<h2><span id="8_References"><strong>8 References</strong></span></h2>
<p>https://github.com/Neo23x0/signature-base/blob/master/yara/apt_oilrig.yar</p>
<p>https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html</p>
<blockquote class="wp-embedded-content" data-secret="SNWGmAwTvh"><p><a href="https://unit42.paloaltonetworks.com/unit42-oilrig-performs-tests-twoface-webshell/">OilRig Performs Tests on the TwoFace Webshell</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" src="https://unit42.paloaltonetworks.com/unit42-oilrig-performs-tests-twoface-webshell/embed/#?secret=SNWGmAwTvh" data-secret="SNWGmAwTvh" width="600" height="338" title="“OilRig Performs Tests on the TwoFace Webshell” — Unit42" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></p>
<blockquote class="wp-embedded-content" data-secret="xvvP5NqE0A"><p><a href="https://unit42.paloaltonetworks.com/unit42-oilrig-uses-updated-bondupdater-target-middle-eastern-government/">OilRig Uses Updated BONDUPDATER to Target Middle Eastern Government</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" src="https://unit42.paloaltonetworks.com/unit42-oilrig-uses-updated-bondupdater-target-middle-eastern-government/embed/#?secret=xvvP5NqE0A" data-secret="xvvP5NqE0A" width="600" height="338" title="“OilRig Uses Updated BONDUPDATER to Target Middle Eastern Government” — Unit42" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></p>
<p>https://misterch0c.blogspot.com/2019/04/apt34-oilrig-leak.html</p>
<p>https://raidforums.com/Thread-access-to-top-secret-information-and-hacking-tools-of-Iran-ministry-of-intelligence?pid=540189</p>
<p>https://anonfile.com/8f8aL0S1mb/targets_txt</p>
<p class="no-break"><span class="st_linkedin_large" st_title="APT34 Event Analysis Report" st_url="https://nsfocusglobal.com/apt34-event-analysis-report/"></span><span class="st_facebook_large" st_title="APT34 Event Analysis Report" st_url="https://nsfocusglobal.com/apt34-event-analysis-report/"></span><span class="st_twitter_large" st_title="APT34 Event Analysis Report" st_url="https://nsfocusglobal.com/apt34-event-analysis-report/"></span><span class="st_googleplus_large" st_title="APT34 Event Analysis Report" st_url="https://nsfocusglobal.com/apt34-event-analysis-report/"></span></p>      </div>
   
   			         <!--       <div class="navigation-single">
	<div class="prev">&laquo; <a href="https://nsfocusglobal.com/what-should-i-do-when-i-am-directed-to-a-macao-gambling-website-instead-of-the-intended-website/" rel="next">What Should I Do When I Am Directed to a Macao Gambling Website Instead of the Intended Website</a></div>
	<div class="next"><a href="https://nsfocusglobal.com/information-security-in-the-workplace-phishing-email-v/" rel="prev">Information Security in the Workplace- Phishing email-v</a> &raquo;</div>
</div> -->
			            				</div>
			</div>
		</div>
	</section>

	<footer>
        <div class="container">

            <div class="row">
                <div class="links">
                    <ul id="menu-03-new-main-menu-1" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-25623"><a href="https://nsfocusglobal.com/products/cloud-ddos-protection-service-cloud-dps/">Cloud-Delivered Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6789"><a href="/cloud-ddos-protection-service-cloud-dps/">Cloud DDoS Protection Service</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-26204"><a href="https://nsfocusglobal.com/products/continuous-threat-exposure-management/">Continuous Threat Exposure Management</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6790"><a href="/threat-intelligence-ti/">Threat Intelligence Service</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-5074"><a href="/products/anti-ddos-system-ads/">Products</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6788"><a href="/anti-ddos-system-ads/">DDoS Attack Protection</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-25622"><a href="https://nsfocusglobal.com/products/intelligent-security-operations-platform-isop/">Security Operations</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27449"><a href="https://nsfocusglobal.com/products/remote-security-assessment-system/">Remote Security Assessment System</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6791"><a href="https://nsfocusglobal.com/products/web-application-firewall-waf/">Web Application &#038; API Protection</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21564"><a href="https://nsfocusglobal.com/products/next-gen-firewall-2/">Next-Generation Firewall</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6540"><a href="https://nsfocusglobal.com/products/next-generation-intrusion-prevention-ngips/">Next Generation Intrusion Prevention</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-20500"><a href="https://nsfocusglobal.com/solutions-overview-4/">Solutions</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4480"><a href="https://nsfocusglobal.com/solutions-overview-3/on-premises/">DDoS Defenses</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20400"><a href="https://nsfocusglobal.com/solutions-overview-3/value-added-service-solution/">Value-Added Service for ISP/MSP</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20428"><a href="https://nsfocusglobal.com/solutions-overview-3/5g-network-security-solution/">5G Network Security Solution</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6611"><a href="https://nsfocusglobal.com/products/cloud-box-ciab/">Cloud-in-a-Box</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-18147"><a href="https://nsfocusglobal.com/services/">Support &#038; Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-18149"><a href="/services">Services Overview</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://nsfocusglobal.com/services/nsfocus-product-support-services/">NSFOCUS Product Support Services</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21315"><a href="https://nsfocusglobal.com/services/nsfocus-professional-services/">NSFOCUS Professional Services</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://nsfocusglobal.com/services/nsfocus-security-assessment-services/">NSFOCUS Security Assessment Services</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://nsfocusglobal.com/services/nsfocus-managed-security-services/">NSFOCUS Managed Security Services</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://nsfocusglobal.com/services/training-services/">Training Services</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4420"><a href="https://nsfocusglobal.com/company-overview/resources/">Resources</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6682"><a href="https://nsfocusglobal.com/company-overview/resources#datasheets">Datasheets</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6683"><a href="https://nsfocusglobal.com/company-overview/resources#whitepapers">Whitepapers</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6684"><a href="https://nsfocusglobal.com/company-overview/resources#reports">Reports</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6685"><a href="https://nsfocusglobal.com/company-overview/resources#case-studies">Case Studies</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6686"><a href="https://nsfocusglobal.com/company-overview/resources#info">Infographics</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6687"><a href="https://nsfocusglobal.com/company-overview/resources#articles">Articles</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6681"><a href="/category/press-releases/">News and Events</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4589"><a href="https://nsfocusglobal.com/category/press-releases/">Press Releases</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4588"><a href="https://nsfocusglobal.com/category/news/">NSFOCUS in the News</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-4590"><a href="https://nsfocusglobal.com/category/events/">Global Events</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-4411"><a href="https://nsfocusglobal.com/company-overview/about/">Company</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4483"><a href="https://nsfocusglobal.com/company-overview/about/">About</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4415"><a href="https://nsfocusglobal.com/company-overview/management-team/">Management Team</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4416"><a href="https://nsfocusglobal.com/company-overview/nsfocus-security-labs/">NSFOCUS Security Labs</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4412"><a href="https://nsfocusglobal.com/company-overview/careers/">Careers</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4413"><a href="https://nsfocusglobal.com/company-overview/contact-us/">Contact Us</a></li>
</ul>
</li>
</ul>                </div>
            </div>

            <div class="row">
                <div class="bottom">
                    <div class="col-lg-2">
                                                                                                <ul>
                            <li><a target="_blank" href="https://www.facebook.com/nsfocus" target="_blank"><button><i class="fa fa-facebook"></i></button></a></li>                            <li><a target="_blank" href="https://www.linkedin.com/company/nsfocus" target="_blank"><button><i class="fa fa-linkedin"></i></button></a></li>                            <li><a target="_blank" href="https://twitter.com/NSFOCUS_Intl" target="_blank"><button><i class="fa fa-twitter"></i></button></a></li>                        </ul>
                    </div>
                    <div class="col-lg-4">
                        <p>
                            <!-- ©COPYRIGHT 2017, NSFOCUS. ALL RIGHTS RESERVED -->
                            &copy;COPYRIGHT 2024, <a href="https://nsfocusglobal.com">NSFOCUS</a>. ALL RIGHTS RESERVED <a href="/privacy-policy/">PRIVACY POLICY</a> | <a href="/terms-and-conditions/">TERMS OF USE</a> | <a href="/legal-terms-conditions/">LEGAL TERMS AND CONDITIONS</a>
                                                    </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    
  <!--copyscapeskip-->
  <aside id="moove_gdpr_cookie_info_bar" class="moove-gdpr-info-bar-hidden moove-gdpr-align-center moove-gdpr-dark-scheme gdpr_infobar_postion_bottom" aria-label="GDPR Cookie Banner" style="display: none;">
    <div class="moove-gdpr-info-bar-container">
      <div class="moove-gdpr-info-bar-content">
        
<div class="moove-gdpr-cookie-notice">
  <p>We are using cookies to give you the best experience on our website.</p><p>You can find out more about which cookies we are using or switch them off in <button  data-href="#moove_gdpr_cookie_modal" class="change-settings-button">settings</button>.</p></div>
<!--  .moove-gdpr-cookie-notice -->        
<div class="moove-gdpr-button-holder">
		  <button class="mgbutton moove-gdpr-infobar-allow-all gdpr-fbo-0" aria-label="Accept" >Accept</button>
	  </div>
<!--  .button-container -->      </div>
      <!-- moove-gdpr-info-bar-content -->
    </div>
    <!-- moove-gdpr-info-bar-container -->
  </aside>
  <!-- #moove_gdpr_cookie_info_bar -->
  <!--/copyscapeskip-->
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=5.7.4' id='swv-js'></script>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/nsfocusglobal.com\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.7.4' id='contact-form-7-js'></script>
<script type='text/javascript' id='post-views-counter-frontend-js-before'>
var pvcArgsFrontend = {"mode":"js","postID":9526,"requestURL":"https:\/\/nsfocusglobal.com\/wp-admin\/admin-ajax.php","nonce":"a02c3fa583"};
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.3.13' id='post-views-counter-frontend-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/themes/nsfocus/js/comment-reply.js?ver=6.1.7' id='comment-reply-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/themes/nsfocus/js/jquery.main.js?ver=6.1.7' id='base-script-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/js/fancybox/source/jquery.fancybox.pack.js?v=2.1.6&#038;ver=6.1.7' id='fancybox-script-js'></script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/page-links-to/dist/new-tab.js?ver=3.3.6' id='page-links-to-js'></script>
<script type='text/javascript' id='moove_gdpr_frontend-js-extra'>
/* <![CDATA[ */
var moove_frontend_gdpr_scripts = {"ajaxurl":"https:\/\/nsfocusglobal.com\/wp-admin\/admin-ajax.php","post_id":"9526","plugin_dir":"https:\/\/nsfocusglobal.com\/wp-content\/plugins\/gdpr-cookie-compliance","show_icons":"all","is_page":"","ajax_cookie_removal":"false","strict_init":"1","enabled_default":{"third_party":0,"advanced":0},"geo_location":"false","force_reload":"false","is_single":"1","hide_save_btn":"false","current_user":"0","cookie_expiration":"365","script_delay":"2000","close_btn_action":"1","close_btn_rdr":"","scripts_defined":"{\"cache\":true,\"header\":\"\",\"body\":\"\",\"footer\":\"\",\"thirdparty\":{\"header\":\"\",\"body\":\"\",\"footer\":\"\"},\"advanced\":{\"header\":\"\",\"body\":\"\",\"footer\":\"\"}}","gdpr_scor":"true","wp_lang":"_en"};
/* ]]> */
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-content/plugins/gdpr-cookie-compliance/dist/scripts/main.js?ver=4.13.3' id='moove_gdpr_frontend-js'></script>
<script type='text/javascript' id='moove_gdpr_frontend-js-after'>
var gdpr_consent__strict = "false"
var gdpr_consent__thirdparty = "false"
var gdpr_consent__advanced = "false"
var gdpr_consent__cookies = ""
</script>
<script type='text/javascript' src='https://nsfocusglobal.com/wp-includes/js/wp-embed.min.js?ver=6.1.7' id='wp-embed-js'></script>

    
  <!--copyscapeskip-->
  <!-- V1 -->
  <div id="moove_gdpr_cookie_modal" class="gdpr_lightbox-hide" role="complementary" aria-label="GDPR Settings Screen">
    <div class="moove-gdpr-modal-content moove-clearfix logo-position-left moove_gdpr_modal_theme_v1">
          
        <button class="moove-gdpr-modal-close" aria-label="Close GDPR Cookie Settings">
          <span class="gdpr-sr-only">Close GDPR Cookie Settings</span>
          <span class="gdpr-icon moovegdpr-arrow-close"></span>
        </button>
            <div class="moove-gdpr-modal-left-content">
        
<div class="moove-gdpr-company-logo-holder">
  <img src="https://nsfocusglobal.com/wp-content/plugins/gdpr-cookie-compliance/dist/images/gdpr-logo.png" alt="NSFOCUS, Inc., a global network and cyber security leader, protects enterprises and carriers from advanced cyber attacks."   width="350"  height="233"  class="img-responsive" />
</div>
<!--  .moove-gdpr-company-logo-holder -->        <ul id="moove-gdpr-menu">
          
<li class="menu-item-on menu-item-privacy_overview menu-item-selected">
  <button data-href="#privacy_overview" class="moove-gdpr-tab-nav" aria-label="Privacy Overview">
    <span class="gdpr-nav-tab-title">Privacy Overview</span>
  </button>
</li>

  <li class="menu-item-strict-necessary-cookies menu-item-off">
    <button data-href="#strict-necessary-cookies" class="moove-gdpr-tab-nav" aria-label="Strictly Necessary Cookies">
      <span class="gdpr-nav-tab-title">Strictly Necessary Cookies</span>
    </button>
  </li>




        </ul>
        
<div class="moove-gdpr-branding-cnt">
  		<a href="https://wordpress.org/plugins/gdpr-cookie-compliance/" rel="noopener noreferrer" target="_blank" class='moove-gdpr-branding'>Powered by&nbsp; <span>GDPR Cookie Compliance</span></a>
		</div>
<!--  .moove-gdpr-branding -->      </div>
      <!--  .moove-gdpr-modal-left-content -->
      <div class="moove-gdpr-modal-right-content">
        <div class="moove-gdpr-modal-title">
           
        </div>
        <!-- .moove-gdpr-modal-ritle -->
        <div class="main-modal-content">

          <div class="moove-gdpr-tab-content">
            
<div id="privacy_overview" class="moove-gdpr-tab-main">
      <span class="tab-title">Privacy Overview</span>
    <div class="moove-gdpr-tab-main-content">
  	<p>This website uses cookies so that we can provide you with the best user experience possible. Cookie information is stored in your browser and performs functions such as recognising you when you return to our website and helping our team to understand which sections of the website you find most interesting and useful.</p>
  	  </div>
  <!--  .moove-gdpr-tab-main-content -->

</div>
<!-- #privacy_overview -->            
  <div id="strict-necessary-cookies" class="moove-gdpr-tab-main" style="display:none">
    <span class="tab-title">Strictly Necessary Cookies</span>
    <div class="moove-gdpr-tab-main-content">
      <p>Strictly Necessary Cookie should be enabled at all times so that we can save your preferences for cookie settings.</p>
      <div class="moove-gdpr-status-bar ">
        <div class="gdpr-cc-form-wrap">
          <div class="gdpr-cc-form-fieldset">
            <label class="cookie-switch" for="moove_gdpr_strict_cookies">    
              <span class="gdpr-sr-only">Enable or Disable Cookies</span>        
              <input type="checkbox" aria-label="Strictly Necessary Cookies"  value="check" name="moove_gdpr_strict_cookies" id="moove_gdpr_strict_cookies">
              <span class="cookie-slider cookie-round" data-text-enable="Enabled" data-text-disabled="Disabled"></span>
            </label>
          </div>
          <!-- .gdpr-cc-form-fieldset -->
        </div>
        <!-- .gdpr-cc-form-wrap -->
      </div>
      <!-- .moove-gdpr-status-bar -->
              <div class="moove-gdpr-strict-warning-message" style="margin-top: 10px;">
          <p>If you disable this cookie, we will not be able to save your preferences. This means that every time you visit this website you will need to enable or disable cookies again.</p>
        </div>
        <!--  .moove-gdpr-tab-main-content -->
                                              
    </div>
    <!--  .moove-gdpr-tab-main-content -->
  </div>
  <!-- #strict-necesarry-cookies -->
            
            
            
          </div>
          <!--  .moove-gdpr-tab-content -->
        </div>
        <!--  .main-modal-content -->
        <div class="moove-gdpr-modal-footer-content">
          <div class="moove-gdpr-button-holder">
			  		<button class="mgbutton moove-gdpr-modal-allow-all button-visible" aria-label="Enable All">Enable All</button>
		  					<button class="mgbutton moove-gdpr-modal-save-settings button-visible" aria-label="Save Settings">Save Settings</button>
				</div>
<!--  .moove-gdpr-button-holder -->        </div>
        <!--  .moove-gdpr-modal-footer-content -->
      </div>
      <!--  .moove-gdpr-modal-right-content -->

      <div class="moove-clearfix"></div>

    </div>
    <!--  .moove-gdpr-modal-content -->
  </div>
  <!-- #moove_gdpr_cookie_modal -->
  <!--/copyscapeskip-->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76013834-1', 'auto');
      ga('send', 'pageview');

    </script>
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- Include all compiled plugins (below), or include individual files as needed -->


	<!-- Add fancyBox -->
	<script type="text/javascript" src="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/js/fancybox/source/jquery.fancybox.pack.js?v=2.1.6"></script>

    <script type="text/javascript">
      piAId = '264712';
      piCId = '3851';

      (function() {
        function async_load(){
                    var s = document.createElement('script'); s.type = 'text/javascript';
                    s.src = ('https:' == document.location.protocol ? 'https://pi' : 'http://cdn') + '.pardot.com/pd.js';
                    var c = document.getElementsByTagName('script')[0]; c.parentNode.insertBefore(s, c);
        }
        if(window.attachEvent) { window.attachEvent('onload', async_load); }
        else { window.addEventListener('load', async_load, false); }
      })();
    </script>
    <script charset="utf-8" type="text/javascript">var switchTo5x=true;</script>
    <script charset="utf-8" type="text/javascript" id="st_insights_js" src="https://ws.sharethis.com/button/buttons.js?publisher=wp.4ef35619-c8dc-4e68-b977-a68abc1a07fb&product=sharethis-wordpress"></script>
    <script charset="utf-8" type="text/javascript">stLight.options({"publisher":"wp.4ef35619-c8dc-4e68-b977-a68abc1a07fb","doNotCopy":true,"hashAddressBar":false,"doNotHash":true});var st_type="wordpress5.4.2";</script>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type"text/javascript" src="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type"text/javascript" src="https://nsfocusglobal.com/wp-content/themes/nsfocus/assets/js/main.js"></script>
<script type="text/javascript">
    adroll_adv_id = "VOLPABQAMFCT5EGAPOPO4W";
    adroll_pix_id = "PMOMCOHVANB25EDKEY3DJS";

    (function () {
        var _onload = function(){
            if (document.readyState && !/loaded|complete/.test(document.readyState)){setTimeout(_onload, 10);return}
            if (!window.__adroll_loaded){__adroll_loaded=true;setTimeout(_onload, 50);return}
            var scr = document.createElement("script");
            var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
            scr.setAttribute('async', 'true');
            scr.type = "text/javascript";
            scr.src = host + "/j/roundtrip.js";
            ((document.getElementsByTagName('head') || [null])[0] ||
                document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
        };
        if (window.addEventListener) {window.addEventListener('load', _onload, false);}
        else {window.attachEvent('onload', _onload)}
    }());
</script>
  </body>
</html>