<!DOCTYPE html>
<head>
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css4151def6b0fdc3ce746302f6817921f03c999acf99c0ba877519f018629af.css" as="style" media="all" />
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css384a0d9ab289ef454c88961c0fc1c3d38833e309f76c02bf3b8db0ee789e3.css" as="style" media="all" />
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css7ad1d6b6e819226c0c124f4533bcc5c4e8ade6e976eec83f15a089c1cc629.css" as="style" media="all" />
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css11bfb69684eee16363aeb9113a29af5435aa495580008532cfcf232a857e5.css" as="style" media="all" />
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css0b2d7813f4eaac59a39eb7f97670ebbf540d7c19ca831bc69ec166baa0407.css" as="style" media="all" />
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css9e8bfb8176708e1de94ca165c394f3e9c61fcc7d37864981c79853add4738.css" as="style" media="all" />
<link rel="preload" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-cssa4b8ab1816f9b65c6cca1961b3f8d6c2f465ed8b4d97c2ecafdf651569a9a.css" as="style" media="all" /><script data-cfasync="false">function fvmuag(){var e=navigator.userAgent;if(e.match(/x11.*ox\/54|id\s4.*us.*ome\/62|oobo|ight|tmet|eadl|ngdo|PTST/i))return!1;if(e.match(/x11.*me\/86\.0/i)){var r=screen.width;if("number"==typeof r&&1367==r)return!1}return!0}</script><meta http-equiv="content-type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#d1f1f1"><meta name="robots" content="max-image-preview:large" /><title>S3 Ransomware Part 2: Prevention and Defense - Rhino Security Labs</title><meta name="description" content="In part 2 of this blog series, we discuss various methods to prevent and defend against S3 Ransomware, including a script to check bucket configurations" /><link rel="canonical" href="https://rhinosecuritylabs.com/aws/s3-ransomware-part-2-prevention-and-defense/" /><meta property="og:locale" content="en_US" /><meta property="og:type" content="article" /><meta property="og:title" content="S3 Ransomware Part 2: Prevention and Defense - Rhino Security Labs" /><meta property="og:description" content="In part 2 of this blog series, we discuss various methods to prevent and defend against S3 Ransomware, including a script to check bucket configurations" /><meta property="og:url" content="https://rhinosecuritylabs.com/aws/s3-ransomware-part-2-prevention-and-defense/" /><meta property="og:site_name" content="Rhino Security Labs" /><meta property="article:publisher" content="https://www.facebook.com/Rhino-Security-Labs-411918502240729/" /><meta property="article:section" content="AWS" /><meta property="article:published_time" content="2019-06-10T10:13:51-07:00" /><meta property="article:modified_time" content="2019-06-10T16:50:02-07:00" /><meta property="og:updated_time" content="2019-06-10T16:50:02-07:00" /><meta property="og:image" content="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/s3-Buckets.png" /><meta property="og:image:secure_url" content="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/s3-Buckets.png" /><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="In part 2 of this blog series, we discuss various methods to prevent and defend against S3 Ransomware, including a script to check bucket configurations" /><meta name="twitter:title" content="S3 Ransomware Part 2: Prevention and Defense - Rhino Security Labs" /><meta name="twitter:site" content="@RhinoSecurity" /><meta name="twitter:image" content="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/s3-Buckets.png" /><meta name="twitter:creator" content="@RhinoSecurity" /><meta property="DC.date.issued" content="2019-06-10T10:13:51-07:00" /><meta name="google-site-verification" content="LGh-9Y4RhyX8Zml1Jq-wLJuCSwihKX6Q-9hniz6CCEA" />
<link rel="icon" type="image/png" sizes="16x16" href="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="stylesheet" id="wp-block-library-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css4151def6b0fdc3ce746302f6817921f03c999acf99c0ba877519f018629af.css" type="text/css" media="all" />
<style id="global-styles-inline-css" type="text/css" media="all">body{--wp--preset--color--black:#000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#fff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale:url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale:url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow:url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red:url('#wp-duotone-blue-red');--wp--preset--duotone--midnight:url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow:url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green:url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange:url('#wp-duotone-blue-orange');--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px}.has-black-color{color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-color{color:var(--wp--preset--color--white)!important}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple)!important}.has-black-background-color{background-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-background-color{background-color:var(--wp--preset--color--white)!important}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple)!important}.has-black-border-color{border-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-border-color{border-color:var(--wp--preset--color--white)!important}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple)!important}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple)!important}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan)!important}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange)!important}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red)!important}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray)!important}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum)!important}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple)!important}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux)!important}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk)!important}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean)!important}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass)!important}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight)!important}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large)!important}</style>
<link rel="stylesheet" id="fonts-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css384a0d9ab289ef454c88961c0fc1c3d38833e309f76c02bf3b8db0ee789e3.css" type="text/css" media="all" />
<link rel="stylesheet" id="plugin-style-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css7ad1d6b6e819226c0c124f4533bcc5c4e8ade6e976eec83f15a089c1cc629.css" type="text/css" media="all" />
<link rel="stylesheet" id="bootstrap-style-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css11bfb69684eee16363aeb9113a29af5435aa495580008532cfcf232a857e5.css" type="text/css" media="all" />
<link rel="stylesheet" id="prettify-style-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css0b2d7813f4eaac59a39eb7f97670ebbf540d7c19ca831bc69ec166baa0407.css" type="text/css" media="all" />
<link rel="stylesheet" id="blog-colors-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-css9e8bfb8176708e1de94ca165c394f3e9c61fcc7d37864981c79853add4738.css" type="text/css" media="all" />
<link rel="stylesheet" id="main-style-css" href="https://rhinosecuritylabs.com/wp-content/cache/fvm/min/1715016739-cssa4b8ab1816f9b65c6cca1961b3f8d6c2f465ed8b4d97c2ecafdf651569a9a.css" type="text/css" media="all" />
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/jquery-3.2.1.js" id="jquery-js"></script>
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/blog.js" id="blog-js"></script>
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/custom_rsl_scripts.js" id="custom_scripts-js"></script>
</head>
<body id="top-of-page" class="post-template-default postid-23283 single-format-standard">
<style media="all">html{background:#f9f9f9}</style>
<div class="header-wrapper">
<div class="container">
<header class="header">
<h1 class="brand">
<a href="https://rhinosecuritylabs.com">
<img src="https://rhinosecuritylabs.com/wp-content/uploads/2015/11/rhino-logo.png" alt="Rhino Security Labs">
</a>
</h1>
<nav class="cta-nav">
<a href="#" class="mobile-trigger visible-xs">
<i class="fa fa-bars"></i>
</a>
<span class="phone-number">
<a href="tel:1-888-944-8679">
<i class="fa fa-phone"></i> (888) 944-8679 </a>
</span>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/contact/">Contact Us</a>
</li>
<li class="cta">
<a href="https://rhinosecuritylabs.com/landing/request-a-quote/">Get a quote</a>
</li>
</ul>
<div class="mobile-menu">
<div class="arrow-up"></div>
<ul class="clearfix">
<li>
<a href="/assessment-services/" target>
<span>Assessments</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/" target>
<span>Application and Network</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/" target>
<span>Web Application Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/network-penetration-testing/" target>
<span>Network Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/mobile-app-assessment/" target>
<span>Mobile App Penetration Testing</span>
</a>
</li>
</ul>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/aws-cloud-penetration-testing/" target>
<span>Cloud Penetration Testing</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="/assessment-services/aws-cloud-penetration-testing/" target>
<span>AWS Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/gcp-penetration-testing/" target>
<span>GCP Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/azure-penetration-testing/" target>
<span>Azure Penetration Testing</span>
</a>
</li>
</ul>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/red-team-engagement/" target>
<span>Adversary Simulation</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/red-team-engagement/" target>
<span>Red Team Assessments</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/social-engineering/email-phishing-assessment/" target>
<span>Email Spear Phishing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/social-engineering/vishing-assessments/" target>
<span>Vishing (Voice Call) Testing</span>
</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/" target>
<span>Industries</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/industry/technology/" target>
<span>Technology</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/healthcare/" target>
<span>Healthcare</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/financial/" target>
<span>Financial</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/retail/" target>
<span>Retail</span>
</a>
</li>
</ul>
</li>
<li>
<a href="https://rhinosecuritylabs.com/resources/" target>
<span>Resources</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/blog/" target>
<span>Security Blog</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/penetration-testing/aws-security-vulnerabilities-and-the-attackers-perspective/" target>
<span>Penetration Testing AWS Environments</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/research/epson-easymp-remote-projection-vulnerabilities/" target>
<span>EasyMP Zeroday Disclosure</span>
</a>
</li>
</ul>
</li>
<li>
<a href="https://rhinosecuritylabs.com/resources/" target>
<span>Downloads</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/landing/6-questions-ask-pentest-vendors/" target="_blank">
<span>Ebook: Questions For Every Pentest Vendor</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/landing/penetration-test-report/" target>
<span>Example Pentest Report</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/penetration-testing-faq/" target>
<span>Penetration Testing FAQ</span>
</a>
</li>
</ul>
</li>
<li>
<a href="/research-and-vulnerability-disclosure" target>
<span>Security Research</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/#section-1" target>
<span>Research and Tool Development</span>
</a>
</li>
<li>
<a href="/research-and-vulnerability-disclosure/#section-2" target>
<span>Vulnerability Disclosure</span>
</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="https://rhinosecuritylabs.com/blog/" target>
<span>Security Blog</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/company/" target>
<span>Company</span>
<i class="fa fa-angle-down"></i>
</a>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/company/" target>
<span>About Us</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/company/leadership/" target>
<span>Leadership</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/careers/" target>
<span>Careers</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/careers/rhino-company-principles/" target>
<span>Company Principles</span>
</a>
</li>
</ul>
</li>
</ul>
</nav>
<nav class="main-nav">
<ul class="clearfix">
<li class="dd-trigger tier">
<a href="/assessment-services/" target>
<span>Assessments</span>
<i class="fa fa-angle-down"></i>
</a>
<div class="dd">
<div class="arrow-up"></div>
<nav class="submenu">
<div class="row">
<div class="col-sm-4">
<div class="tier-col">
<div class="menu-header on">
<a href="https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/" target>
<span>Application and Network</span>
<i class="fa fa-angle-down"></i>
</a>
</div>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/" target>
<span>Web Application Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/network-penetration-testing/" target>
<span>Network Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/mobile-app-assessment/" target>
<span>Mobile App Penetration Testing</span>
</a>
</li>
</ul>
</div>
</div>
<div class="col-sm-4">
<div class="tier-col">
<div class="menu-header on">
<a href="https://rhinosecuritylabs.com/assessment-services/aws-cloud-penetration-testing/" target>
<span>Cloud Penetration Testing</span>
<i class="fa fa-angle-down"></i>
</a>
</div>
<ul>
<li>
<a href="/assessment-services/aws-cloud-penetration-testing/" target>
<span>AWS Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/gcp-penetration-testing/" target>
<span>GCP Penetration Testing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/azure-penetration-testing/" target>
<span>Azure Penetration Testing</span>
</a>
</li>
</ul>
</div>
</div>
<div class="col-sm-4">
<div class="tier-col">
<div class="menu-header on">
<a href="https://rhinosecuritylabs.com/assessment-services/red-team-engagement/" target>
<span>Adversary Simulation</span>
<i class="fa fa-angle-down"></i>
</a>
</div>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/red-team-engagement/" target>
<span>Red Team Assessments</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/social-engineering/email-phishing-assessment/" target>
<span>Email Spear Phishing</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/social-engineering/vishing-assessments/" target>
<span>Vishing (Voice Call) Testing</span>
</a>
</li>
</ul>
</div>
</div>
</div>
</nav>
</div>
</li>
<li class="dd-trigger">
<a href="https://rhinosecuritylabs.com/industry/" target>
<span>Industries</span>
<i class="fa fa-angle-down"></i>
</a>
<div class="dd">
<div class="arrow-up"></div>
<nav class="submenu">
<ul>
<li>
<a href="https://rhinosecuritylabs.com/industry/technology/" target>
<span>Technology</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/healthcare/" target>
<span>Healthcare</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/financial/" target>
<span>Financial</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/retail/" target>
<span>Retail</span>
</a>
</li>
</ul>
</nav>
</div>
</li>
<li class="dd-trigger tier">
<a href="https://rhinosecuritylabs.com/resources/" target>
<span>Resources</span>
<i class="fa fa-angle-down"></i>
</a>
<div class="dd">
<div class="arrow-up"></div>
<nav class="submenu">
<div class="row">
<div class="col-sm-4">
<div class="tier-col">
<div class="menu-header on">
<a href="https://rhinosecuritylabs.com/blog/" target>
<span>Security Blog</span>
<i class="fa fa-angle-down"></i>
</a>
</div>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/penetration-testing/aws-security-vulnerabilities-and-the-attackers-perspective/" target>
<span>Penetration Testing AWS Environments</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/research/epson-easymp-remote-projection-vulnerabilities/" target>
<span>EasyMP Zeroday Disclosure</span>
</a>
</li>
</ul>
</div>
</div>
<div class="col-sm-4">
<div class="tier-col">
<div class="menu-header on">
<a href="https://rhinosecuritylabs.com/resources/" target>
<span>Downloads</span>
<i class="fa fa-angle-down"></i>
</a>
</div>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/landing/6-questions-ask-pentest-vendors/" target="_blank">
<i class="fa fa-file-pdf-o"></i>
<span>Ebook: Questions For Every Pentest Vendor</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/landing/penetration-test-report/" target>
<i class="fa fa-file-pdf-o"></i>
<span>Example Pentest Report</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/penetration-testing-faq/" target>
<span>Penetration Testing FAQ</span>
</a>
</li>
</ul>
</div>
</div>
<div class="col-sm-4">
<div class="tier-col">
<div class="menu-header on">
<a href="/research-and-vulnerability-disclosure" target>
<span>Security Research</span>
<i class="fa fa-angle-down"></i>
</a>
</div>
<ul>
<li>
<a href="https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/#section-1" target>
<span>Research and Tool Development</span>
</a>
</li>
<li>
<a href="/research-and-vulnerability-disclosure/#section-2" target>
<span>Vulnerability Disclosure</span>
</a>
</li>
</ul>
</div>
</div>
</div>
</nav>
</div>
</li>
<li>
<a href="https://rhinosecuritylabs.com/blog/" target>
<span>Security Blog</span>
</a>
</li>
<li class="dd-trigger">
<a href="https://rhinosecuritylabs.com/company/" target>
<span>Company</span>
<i class="fa fa-angle-down"></i>
</a>
<div class="dd">
<div class="arrow-up"></div>
<nav class="submenu">
<ul>
<li>
<a href="https://rhinosecuritylabs.com/company/" target>
<span>About Us</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/company/leadership/" target>
<span>Leadership</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/careers/" target>
<span>Careers</span>
</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/careers/rhino-company-principles/" target>
<span>Company Principles</span>
</a>
</li>
</ul>
</nav>
</div>
</li>
</ul>
</nav>
</header>
</div>
</div>
<div class="subhero small blog-hero" data-saos-lazy-bg-small="https://rhinosecuritylabs.com/wp-content/uploads/2017/12/Resources_CHILD-e1508618995267-767x235.jpg" data-saos-lazy-bg-large="https://rhinosecuritylabs.com/wp-content/uploads/2017/12/Resources_CHILD-e1508618995267-1920x280.jpg"></div>
<div class="container">
<div id="single" class="row single">
<div class="col-md-12">
<article class="single-post">
<div class="blog-breadcrumbs">
<p>
<span class="breadcrumb-text">
<a href="https://rhinosecuritylabs.com/blog">
Strategic and Technical Blog
</a>
</span>
</p>
<span class="chevrons"><i class="fa fa-chevron-right"></i><i class="fa fa-chevron-right"></i></span>
<p>
<span class="breadcrumb-text">
<a href="https://rhinosecuritylabs.com/aws/">AWS</a> </span>
</p>
</div>
<div class="intro-wrapper">
<div class="title-image color red dark">
<img src="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/s3-Buckets-1140x400.png" alt="AWS Simple Storage Service" title="S3 Buckets">
<div class="vct">
<div class="vctr">
<div class="vctd">
<h1 class="standard-header left-text white remove-margin">S3 Ransomware Part 2: Prevention and Defense</h1>
</div>
</div>
</div>
<div class="meta-wrapper">
<p class="post-author">Spencer Gietzen</p>
</div>
</div>
</div>
<div class="post-content blog-section">
<div class="blog-textarea standard-section">
<p style="text-align: center;"><i><span style="font-weight: 400;">This is part two in a two-part series on S3 Ransomware. <a href="https://rhinosecuritylabs.com/penetration-testing/s3-ransomware-part-1-attack-vector/">Part One</a> discusses the attack vector of S3 Ransomware and demonstrates a proof of concept.</span></i></p>
<p style="text-align: left;"><b>Note</b><strong>:</strong> <span style="font-weight: 400;">This post not only discusses defense mechanisms against S3 ransomware, but it also touches on important general security hygiene you should be following in your AWS accounts.</span></p>
</div>
<h2 class="standard-header smaller center-text bordered small-top-margin extra-bottom-margin">Part 1 Recap: S3 Ransomware</h2>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">As demonstrated in <a href="https://rhinosecuritylabs.com/penetration-testing/s3-ransomware-part-1-attack-vector/">part one</a> of this blog, S3 ransomware is an attack that can have an extremely high impact on a company. S3 ransomware is when an attacker is able to gain access to a victim’s S3 buckets, then they replace each object with a new copy of itself, but encrypted with the attacker’s KMS key. The victim would no longer be able to access their own S3 objects and would need to submit to the attackers demands in order to get them back (or risk the extra time it might take to go to the authorities or AWS incident response). </span></p>
</div>
<h3 class="standard-subheader center-text">S3 Ransomware Security Controls</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">While S3 ransomware can be fairly straightforward for an attacker to perform, with the right defenses in place, you can protect yourself. There are many different ways to defend against and prevent S3 ransomware, and this post aims to outline those various methods.</span></p>
</div>
<h2 class="standard-header smaller center-text bordered small-top-margin extra-bottom-margin">Defense and Prevention Methods</h2>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">There is no single method that acts as a “silver bullet” when preventing and defending against S3 ransomware given the cost, effort, and impact each method has on its own. Instead, the following methods are meant to be a collection of good practices to follow. Not every method is a good fit for every environment, so it is important to understand them all and be able to choose the best methods to implement in your own environment.</span></p>
</div>
<h3 class="standard-subheader center-text">Method #1: Follow Security Best Practice to Prevent Unauthorized Access to your Account</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">This is the most obvious defense, in that it essentially means &#8220;don&#8217;t let unauthorized people into your environment&#8221;, but that is much easier said than done. There is a laundry list of things to do for this defense, but some important ones are outlined here:</span></p>
<ul>
<li style="font-weight: 400;"><span style="font-weight: 400;">Have all users use methods of temporary access to access the environment instead of long-lived credentials (use IAM roles instead of IAM users).</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Create pre-receive hooks in your Git repositories (more info </span><a href="https://githooks.com/"><span style="font-weight: 400;">here</span></a><span style="font-weight: 400;">) to monitor for commits that may accidentally contain credentials and deny them before a developer pushes their access keys or credentials.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Perform regular phishing/social engineering training with your team to educate employees on how to spot targeted attacks.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Enforce multi-factor authentication (MFA) </span><i><span style="font-weight: 400;">everywhere possible </span></i><span style="font-weight: 400;">for everyone (both for the AWS web console and for AWS access keys)! This makes it more difficult (but still not impossible) for an attacker who has stolen credentials to actually use those credentials.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Enforce long, complex passwords/passphrases, and if MFA is not being enforced </span><i><span style="font-weight: 400;">everywhere</span></i><span style="font-weight: 400;">, then enforce password expiration at a reasonable interval while disallowing repeat passwords</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Ensure that strong application security is in place for any application that has AWS access. This can help prevent something like a server-side request forgery (SSRF) attack to an EC2 instance&#8217;s metadata or a local file read/remote code execution vulnerability from reading credentials from the AWS CLI or environment variables.</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Regularly audit and monitor IAM access that is delegated within your accounts/organization (with something like </span><a href="https://github.com/Netflix/security_monkey"><span style="font-weight: 400;">Security Monkey by Netflix</span></a><span style="font-weight: 400;">).</span></li>
</ul>
<p><span style="font-weight: 400;">Additionally, consider reading </span><a href="https://rhinosecuritylabs.com/aws/aws-iam-credentials-get-compromised/"><span style="font-weight: 400;">this blog post</span></a><span style="font-weight: 400;"> on how AWS accounts are compromised.</span></p>
</div>
<h3 class="standard-subheader center-text">Method #2: Follow the Principle of Least-Privilege</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">This defense involves setting up your environment and delegating access in such a way that no one has more access than they should. That means that for any user (role/group/etc), they should only have the IAM permissions granted to them that they </span><i><span style="font-weight: 400;">need</span></i><span style="font-weight: 400;"> to use, and those permissions should only be allowed on resources that they </span><i><span style="font-weight: 400;">need </span></i><span style="font-weight: 400;">to work with.</span></p>
<p><span style="font-weight: 400;">For example, a simple &#8220;s3:PutObject&#8221; permission granted on any resource (&#8220;*&#8221;) could mean a massive ransomware attack across every bucket in your account. By limiting the resource to a specific bucket, such as &#8220;arn:aws:s3:::example_bucket&#8221;, then only that specific bucket could be targeted.</span></p>
<p><span style="font-weight: 400;">The principle of least-privilege should be applied at both the IAM policy level and the resource policy level (such as an S3 bucket policy) to be most effective.</span></p>
</div>
<h3 class="standard-subheader center-text">Method #3: Logging and Monitoring Activity in Your Account</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">You should always have AWS CloudTrail enabled in your account. Ideally, CloudTrail should cover all regions in all of your accounts, log read and write management events, log data events for your S3 buckets and Lambda functions, enable log file encryption, and enable log file validation.</span></p>
<p><span style="font-weight: 400;">It might not always make sense to log data events for </span><i><span style="font-weight: 400;">every </span></i><span style="font-weight: 400;">bucket in your account depending on your budget, because it can get fairly expensive if they are frequently accessed. If you aren’t logging data events for every bucket, it is very important that the buckets you </span><i><span style="font-weight: 400;">are </span></i><span style="font-weight: 400;">logging are the ones that contain sensitive content. This way, you can view fine-grained details of who is accessing your data, how they&#8217;re doing it, and where they&#8217;re doing it from.</span></p>
<p><span style="font-weight: 400;">Log file validation in CloudTrail can help ensure that your log files are not being modified before you read them, so you can 100% trust what you are looking at. This is important to enable, but be sure to actually verify your logs (with something like “aws cloudtrail validate-logs”), as you won’t be alerted of modifications to your logs, even with the setting enabled.</span></p>
<p><span style="font-weight: 400;">In addition to CloudTrail, a tool like AWS GuardDuty should be enabled to monitor for malicious activity within your account. These alerts along with your CloudTrail logs should be exported to an external SIEM for further inspection and monitoring.</span></p>
<p><span style="font-weight: 400;">If you use AWS Organizations, you should be enabling CloudTrail and GuardDuty at the Organization level and applying them to your child accounts. This way, attackers in child accounts cannot modify or disable any important settings.</span></p>
<p><span style="font-weight: 400;">Depending on your budget and other factors, consider enabling other types of logs and monitoring tools for your other resources. This might include something like Elastic Load Balancer access logs or host-based logs for your EC2 instances, or possibly enabling something like AWS Inspector or AWS Config.</span></p>
</div>
<h3 class="standard-subheader center-text">Method #4: S3 Object Versioning and MFA Delete</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">This is perhaps the most important, but potentially very expensive, defense method to use against S3 ransomware specifically. S3 Object Versioning allows S3 objects to be &#8220;versioned&#8221;, which means that if a file is modified, then both copies are kept in the bucket as a sort of &#8220;history&#8221;. The same thing happens if a file is uploaded with the same name as a file that already exists in the bucket. An example scenario here would be a versioned bucket that CloudTrail logs are being stored in. If an attacker modified a log file to remove traces of their activity, then the defender could compare the old version of the file and the current version to see </span><i><span style="font-weight: 400;">exactly </span></i><span style="font-weight: 400;">what the attacker removed.</span></p>
<p><span style="font-weight: 400;">S3 Object Versioning is not enough on its own though, because in theory, an attacker could just disable the versioning and overwrite/delete any existing versions that are in the bucket without the worry of a new version being created. To combat this, AWS offers the feature of </span><a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete"><span style="font-weight: 400;">multi-factor authentication delete</span></a><span style="font-weight: 400;"> in S3 buckets. Having MFA delete enabled forces MFA to be used to do either of the following two things:</span></p>
<ol>
<li style="font-weight: 400;"><span style="font-weight: 400;">Change the versioning state of the specified S3 bucket (i.e. disable versioning)</span></li>
<li style="font-weight: 400;"><span style="font-weight: 400;">Permanently delete an object version</span></li>
</ol>
<p><span style="font-weight: 400;">If both versioning and MFA delete are enabled on a bucket, that means an attacker would need to compromise the root user and their MFA device to disable versioning and MFA delete on the bucket. This is possible in theory, but in practice is very unlikely.</span></p>
</div>
<h3 class="standard-subheader center-text">Method #5: Bucket Policies and ACLs</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">It is imperative to not make your buckets accessible by the public. Buckets and the objects in them can be made publicly accessible through a variety of different ways, but most often it is the bucket ACL or bucket policy that is the culprit.</span></p>
<p><span style="font-weight: 400;">You should avoid using the bucket ACL entirely in most cases, but sometimes it’s not possible due to a few different reasons. It is an old, &#8220;managed&#8221; way of managing access to your bucket and it does not allow fine-grained access control. If you grant someone access to &#8220;List objects&#8221; in an ACL, they can get a list of all the objects in the bucket in a single API call </span><i><span style="font-weight: 400;">and </span></i><span style="font-weight: 400;">can read any of those files. If you grant someone access to &#8220;Write objects&#8221; in an ACL, that means they can create, overwrite, </span><i><span style="font-weight: 400;">and </span></i><span style="font-weight: 400;">delete objects in the bucket. Those two are reason enough to avoid using ACLs.</span></p>
<p><span style="font-weight: 400;">You should be using bucket policies instead of ACLs because it allows the most fine-grained permissions management. Instead of granting a user list </span><i><span style="font-weight: 400;">and </span></i><span style="font-weight: 400;">read permissions in the ACL, you could grant them only one of the two permissions in the bucket policy. You can even impose further restrictions, such as read access to only a few objects in the bucket. For example, if you have a website that is reading S3 objects directly from your bucket, it does not need permission to list every object in the bucket, because it should already know what it is fetching. In this case, you could just grant it &#8220;s3:GetObject&#8221; in the bucket policy instead of list and read in the ACL. Instead of granting create/overwrite </span><i><span style="font-weight: 400;">and </span></i><span style="font-weight: 400;">delete object permissions through the ACL, you could grant one or the other and impose further restrictions, just like above. </span></p>
<p><span style="font-weight: 400;">Another feature of S3 bucket policies is that they have the ability to enforce encryption of a specific type. Examples of this are forcing any uploaded file to be encrypted with AES256, or forcing any uploaded file to be encrypted with a specific AWS KMS key. This can be used to prevent S3 ransomware because, ideally, the attacker won&#8217;t have access to modify the bucket&#8217;s policy. </span></p>
<p><span style="font-weight: 400;">You could set your bucket policy to only allow objects to be uploaded with your specific KMS key. In that case, the attacker would not be able to use another KMS key that you haven&#8217;t specified in the policy, which is necessary to ransomware the bucket. They would then get an access denied error message, ultimately preventing the attack.</span></p>
<p><span style="font-weight: 400;">Here is an example S3 bucket policy that forces file uploads to use a certain KMS key for encryption:</span></p>
</div>
<div class="blog-code-snippet desert">
<pre class="prettyprint">{&quot;Version&quot;:&quot;2012-10-17&quot;,&quot;Statement&quot;:[{&quot;Effect&quot;:&quot;Deny&quot;,&quot;Principal&quot;:&quot;*&quot;,&quot;Action&quot;:&quot;s3:PutObject&quot;,&quot;Resource&quot;:[&quot;arn:aws:s3:::my-bucket-name\/*&quot;,&quot;arn:aws:s3:::my-bucket-name&quot;],&quot;Condition&quot;:{&quot;StringNotEquals&quot;:{&quot;s3:x-amz-server-side-encryption-aws-kms-key-id&quot;:&quot;arn:aws:kms:REGION:ACCOUNT-ID:key\/KEY-ID&quot;}}}]}</pre>
</div>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">More information on S3 actions, resources, and condition keys can be found </span><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazons3.html"><span style="font-weight: 400;">here</span></a><span style="font-weight: 400;">. </span></p>
</div>
<h3 class="standard-subheader center-text">Method #6: Account-Wide S3 Public Access Settings</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">If your concern is that your developers might grant public accessibility to your buckets, then you can utilize the account-wide option to block public ACLs and public policies from taking effect. Note that this applies to every bucket in your account and might cause problems if you rely on cross-account/public access to specific buckets in your account.</span></p>
<p><span style="font-weight: 400;">If you can verify that it is alright to block public access to all your buckets, then you should consider enabling the account-wide S3 public-access settings for your account.</span></p>
</div>
<div class="blog-image blog-section standard-section medium">
<div class="blog-image-wrapper">
<img data-full-image="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-4.png" data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-4-750x645.png" alt="Account-Wide S3 Public Access Settings" title="S3 Ransomware">
</div>
</div>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">The screenshot above shows the public access settings for an example account in the AWS web console. In this example, all existing, public bucket ACLs and all existing, public bucket policies will be blocked, meaning that they won&#8217;t actually grant public access because of this higher-tier public access setting. Additionally, new ACLs and policies that grant public access will be blocked as well.</span></p>
</div>
<h3 class="standard-subheader center-text">Method #7: Backups</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">Finally, of course, you </span><i><span style="font-weight: 400;">need </span></i><span style="font-weight: 400;">to back up your data! Whether that is done with a MFA versioned bucket, data replicated across buckets or accounts, or even locally, it is extremely important. With sufficiently backed up data, you can just ignore the attacker (after your incident response plan has been put into action, of course) and restore your backups, then it was like you were never ransomwared at all.</span></p>
</div>
<h2 class="standard-header smaller center-text bordered small-top-margin extra-bottom-margin">Recovering from a Successful Ransomware Attack</h2>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">If you’ve been targeted with an S3 ransomware attack, how you respond will likely depend on a few different factors. AWS Security is aware of the risk of the attack vector, but it is uncertain what their role could be in helping you</span><span style="font-weight: 400;">—</span><span style="font-weight: 400;">if any. If you can accept the extra time it will take, it would likely be best to contact the authorities, though the delay involved in that may be too much to accept for your business. For that reason, it is best to implement a strong defense to this attack so that you don’t end up in that situation needing to weigh your potential options and their risks.</span></p>
</div>
<h3 class="standard-subheader center-text">Incident Response Plan</h3>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">If you have been targeted, then the first step would be to enact your incident response plan. Doing this will lower the blast radius of the attacker, get them out of the environment, and determine what they have gained access to and attacked. This is one reason why strong logging and monitoring in an AWS environment are both essential. Knowing what they attackers has accessed will help you determine what your next steps need to be.</span></p>
</div>
<h2 class="standard-header smaller center-text bordered small-top-margin extra-bottom-margin">Script for Checking Bucket Configurations</h2>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">We wrote a script that checks the important settings on all buckets in an AWS account. This includes checks for object versioning and MFA delete on each bucket. You can find this script <a href="https://github.com/RhinoSecurityLabs/Cloud-Security-Research/blob/master/AWS/s3_ransomware/s3-ransomware-bucket-check.py">on our GitHub</a></span><span style="font-weight: 400;">. It also has an option to enable object versioning for any buckets that don’t have it enabled already.</span></p>
<p><span style="font-weight: 400;">This screenshot shows some of the example output of running the script against a vulnerable AWS account.</span></p>
</div>
<div class="blog-image blog-section standard-section medium">
<div class="blog-image-wrapper">
<img data-full-image="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-5.png" data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-5-750x90.png" alt="Vulnerable AWS account" title="Example Output">
</div>
</div>
<div class="blog-textarea standard-section">
<p><span style="font-weight: 400;">When opening the CSV file where the results were output, you will see something like the following screenshot (S3 bucket names are censored):</span></p>
</div>
<div class="blog-image blog-section standard-section original" style="max-width: 1600px">
<div class="blog-image-wrapper">
<img data-full-image="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-6.png" data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-6.png" alt="S3 Bucket List" title="CSV Output">
</div>
</div>
<div class="blog-textarea standard-section">
<p>There are a few arguments to be aware of when running this script:</p>
</div>
<div class="blog-code-snippet clean">
<pre>-p/--profile: The AWS CLI profile to use for authentication with AWS (~/.aws/credentials).

-b/--buckets: A comma-separated list of S3 buckets to check. These should be owned by you, or at least publicly accessible. If this argument is not provided, all buckets in the account will be checked.

-e/--enable-versioning: If this argument is passed in, the script will attempt to enable object versioning on any buckets that have it disabled/suspended. Note that the script will not enable MFA delete, because that requires access to the root AWS user to enable.</pre>
</div>
<div class="blog-textarea standard-section">
<p>The following screenshot shows the usage of the enable versioning argument (S3 bucket names are censored again).</p>
</div>
<div class="blog-image blog-section standard-section medium">
<div class="blog-image-wrapper">
<img data-full-image="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-7.png" data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/S3-Ransomware-Image-7-750x338.png" alt="S3 Buckets" title="-e/--enable-versioning">
</div>
</div>
<div class="blog-textarea standard-section">
<p>The CSV file will report “Enabled” for object versioning for any bucket that had its versioning successfully enabled. If the script fails to enable versioning (because of something like a permissions error), it will move onto the next bucket and mark the failed bucket with its original versioning setting (“Disabled”/”Suspended”).</p>
</div>
<h2 class="standard-header smaller center-text bordered small-top-margin extra-bottom-margin">Conclusion</h2>
<div class="blog-textarea standard-section">
<p>S3 ransomware can be fairly straightforward for an attacker to perform, but there are a variety of both easy and difficult defense mechanisms that defenders can put in place. At the lowest level, it is simple for a defender to enable versioning and MFA delete on an S3 bucket, which would effectively prevent ransomware in a majority of cases.</p>
<p>It is extremely important to implement defense mechanisms in your AWS environment and sensitive S3 buckets. While it might not be necessary to execute every method outlined above, it is imperative to determine which attack vectors and entry points you are most susceptible to, and therefore need to protect against.</p>
<p>While the above outlined methods will be very useful in helping prevent against S3 ransomware, there are always more methods of defense for prevention/detection out there. We encourage any readers to contact us with other ideas so we can add them to this post (credited to you) and share them with other people who are trying to defend their own environment.</p>
</div>
</div>
<div class="related-services">
<h2 class="page-heading center">Related Resources</h2>
<div class="row">
<div class="col-sm-4">
<div class="related-service red dark">
<img data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2019/06/s3-Buckets-472x230.png" class="rel-image" alt="AWS Simple Storage Service" title="S3 Buckets">
<div class="vct">
<div class="vctr">
<div class="vctd">
<h3 class="standard-subheader smaller center-text white remove-margin">S3 Ransomware Part 1: Attack Vector</h3>
</div>
</div>
</div>
<a class="panel-link" href="https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/"></a>
</div>
</div>
<div class="col-sm-4">
<div class="related-service none medium">
<img data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2021/02/pacu-blog-472x230.png" class="rel-image" alt title="pacu blog">
<div class="vct">
<div class="vctr">
<div class="vctd">
<h3 class="standard-subheader smaller center-text white remove-margin">Attacking AWS Cognito with Pacu (p1)</h3>
</div>
</div>
</div>
<a class="panel-link" href="https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p1/"></a>
</div>
</div>
<div class="col-sm-4">
<div class="related-service dark-red medium">
<img data-saos-lazy="https://rhinosecuritylabs.com/wp-content/uploads/2021/02/pacu-blog-472x230.png" class="rel-image" alt title="pacu blog">
<div class="vct">
<div class="vctr">
<div class="vctd">
<h3 class="standard-subheader smaller center-text white remove-margin">Attacking AWS Cognito with Pacu (p2)</h3>
</div>
</div>
</div>
<a class="panel-link" href="https://rhinosecuritylabs.com/aws/attacking-aws-cognito-with-pacu-p2/"></a>
</div>
</div>
</div>
</div>
<div class="contact-link small" data-saos-lazy-bg-small="https://rhinosecuritylabs.com/wp-content/uploads/2015/10/Secure_code_review-720x350.jpg" data-saos-lazy-bg-large="https://rhinosecuritylabs.com/wp-content/uploads/2015/10/Secure_code_review-1140x400.jpg">
<div class="vct">
<div class="vctr">
<div class="vctd">
<h2 class="standard-header small white remove-top-margin" style="color: #ffffff; border-color: #fff;">Interested in more information?</h2>
<p class="center-text" style="color: #ffffff;"></p>
20603
<div class="clearfix">
<a target href="https://rhinosecuritylabs.com/contact/" class="standard-button                                      button-blue                                                          button-icon                                      button-bold-weight                   button-large                    button-top-margin                   button-center">
<span class="border"></span>
<span class="text">
Contact Us Today </span>
<span class="button-icon-wrapper">
<i class="fa fa-angle-double-right"></i>
</span>
</a>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</div>
<div class="image-modal">
<div class="modal-close"><i class="fa fa-times"></i></div>
<div class="image-modal-content">
<img>
</div>
</div>
<footer class="footer">
<div class="container">
<div class="col-md-3">
<h5>
<a href="https://rhinosecuritylabs.com/assessment-services/">Assessment Services</a>
</h5>
<ul class="no-style">
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/network-penetration-testing/">Network Penetration Test</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/">Webapp Penetration Test</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/aws-cloud-penetration-testing/">AWS Cloud Penetration Testing</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/gcp-penetration-testing/">GCP Cloud Penetration Testing</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/azure-penetration-testing/">Azure Penetration Testing</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/mobile-app-assessment/">Mobile App Assessment</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/secure-code-review/">Secure Code Review</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/social-engineering/">Social Engineering / Phishing Testing</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/social-engineering/vishing-assessments/">Vishing (Voice Call) Testing</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/red-team-engagement/">Red Team Engagements</a>
</li>
</ul>
</div>
<div class="col-md-2">
<h5>
<a href="https://rhinosecuritylabs.com/industry/">Industries</a>
</h5>
<ul class="no-style">
<li>
<a href="https://rhinosecuritylabs.com/industry/healthcare/">Healthcare</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/financial/">Finance</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/technology/">Technology</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/industry/retail/">Retail</a>
</li>
</ul>
</div>
<div class="col-md-2">
<h5>
<a href="https://rhinosecuritylabs.com/resources/">Resources</a>
</h5>
<ul class="no-style">
<li>
<a href="https://rhinosecuritylabs.com/blog-technical/">Technical Blog</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/blog-strategic/">Strategic Blog</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/landing/penetration-test-report/">Example Pentest Report</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/">Technical Research</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/">Vulnerability Disclosures</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/company/vulnerability-disclosure-policy/">Disclosure Policy</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/penetration-testing-faq/">Penetration Testing FAQ</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/assessment-services/support-aws-penetration-testing-form/">Support: AWS Pentest Form</a>
</li>
<li>
<a href></a>
</li>
</ul>
</div>
<div class="col-md-2">
<h5>
<a href="https://rhinosecuritylabs.com/company/">Company</a>
</h5>
<ul class="no-style">
<li>
<a href="https://rhinosecuritylabs.com/company/leadership/">Leadership</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/blog/">Blog</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/careers/">Careers</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/careers/rhino-company-principles/">Company Principles</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/contact/">Contact Us</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/request-a-quote/">Get a Quote</a>
</li>
<li>
<a href="https://rhinosecuritylabs.com/blog/feed/"><i class="fa fa-rss"></i> RSS Feed</a> </li>
</ul>
</div>
<div class="col-md-3">
<h5>About Us</h5>
<div class="tiny white">
<p>Rhino Security Labs is a top penetration testing and security assessment firm, with a focus on cloud pentesting (AWS, GCP, Azure), network pentesting, web application pentesting, and phishing.<br/>
With manual, deep-dive engagements, we identify security vulnerabilities which put clients at risk.</p>
<p>Endorsed by industry leaders, Rhino Security Labs is a trusted security advisor to the Fortune 500.</p>
</div>
</div>
</div>
<div class="bottom-bar">
<div class="container">
<div class="row">
<div class="col-md-4 col-sm-4">
<p class="tiny white"><a href="mailto:info@rhinosecuritylabs.com">info@rhinosecuritylabs.com</a></p>
</div>
<div class="col-md-4 col-sm-4">
<p class="tiny white">
<a href="tel:1-888-944-8679">
(888) 944-8679 </a>
</p>
</div>
<div class="col-md-4 col-sm-4">
<p class="tiny white">Rhino Security Labs, Inc</p>
</div>
</div>
</div>
</div>
</footer>
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/plugins.js" id="plugins-js"></script>
<script type="text/javascript" id="main-script-js-extra">
/* <![CDATA[ */
var site_urls = {"ajax":"https:\/\/rhinosecuritylabs.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/script.js" id="main-script-js"></script>
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/run_prettify.js" id="run-prettify-js"></script>
<script type="text/javascript" src="https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/js/hubspot.js" id="hs-script-js"></script>
</body>
</html>