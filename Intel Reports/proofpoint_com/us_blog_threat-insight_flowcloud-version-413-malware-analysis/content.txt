


<!DOCTYPE html>
<html lang="en-us" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="page-en">
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MGR7P8X');</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1V8SZE3GL"></script>
<script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-B1V8SZE3GL');</script>
<script>(function(){var a=window.mutiny=window.mutiny||{};if(!window.mutiny.client){a.client={_queue:{}};var b=["identify","trackConversion"];var c=[].concat(b,["defaultOptOut","optOut","optIn"]);var d=function factory(c){return function(){for(var d=arguments.length,e=new Array(d),f=0;f<d;f++){e[f]=arguments[f]}a.client._queue[c]=a.client._queue[c]||[];if(b.includes(c)){return new Promise(function(b,d){a.client._queue[c].push({args:e,resolve:b,reject:d})})}else{a.client._queue[c].push({args:e})}}};c.forEach(function(b){a.client[b]=d(b)})}})();</script>
<script data-cfasync="false" src="https://client-registry.mutinycdn.com/personalize/client/d454424c4514a20a.js"></script>
<meta charset="utf-8" />
<meta name="description" content="Proofpoint researchers are continuing to track the threat actor TA410’s use of FlowCloud, a remote access trojan (RAT). Below is a new in-depth analysis of another version of the FlowCloud RAT," />
<link rel="shortlink" href="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" />
<link rel="canonical" href="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" />
<link rel="image_src" href="https://www.proofpoint.com/sites/default/files/styles/metatag/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=JJVdYzsg" />
<link rel="icon" href="/themes/custom/proofpoint/apps/drupal/favicon.ico" />
<link rel="mask-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon.svg" />
<link rel="icon" sizes="16x16" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-16x16.png" />
<link rel="icon" sizes="32x32" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-32x32.png" />
<link rel="icon" sizes="96x96" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-96x96.png" />
<link rel="icon" sizes="192x192" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-192x192.png" />
<link rel="apple-touch-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<meta property="og:site_name" content="Proofpoint" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" />
<meta property="og:title" content="FlowCloud Version 4.1.3 Malware Analysis | Proofpoint US" />
<meta property="og:description" content="Proofpoint researchers are continuing to track the threat actor TA410’s use of FlowCloud, a remote access trojan (RAT). Below is a new in-depth analysis of another version of the FlowCloud RAT," />
<meta property="og:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=JJVdYzsg" />
<meta property="og:image:url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=JJVdYzsg" />
<meta property="og:image:secure_url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=JJVdYzsg" />
<meta property="article:published_time" content="2020-06-10T16:44:44-07:00" />
<meta property="article:modified_time" content="2020-06-11T09:24:13-07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@proofpoint" />
<meta name="twitter:title" content="FlowCloud Version 4.1.3 Malware Analysis | Proofpoint US" />
<meta name="twitter:description" content="Proofpoint researchers are continuing to track the threat actor TA410’s use of FlowCloud, a remote access trojan (RAT). Below is a new in-depth analysis of another version of the FlowCloud RAT," />
<meta name="twitter:url" content="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" />
<meta name="twitter:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=JJVdYzsg" />
<script data-cfasync="false" type="text/javascript" id="vwoCode">window._vwo_code=window._vwo_code || (function() {
      var account_id=1002484,
      version=1.3,
      settings_tolerance=2000,
      library_tolerance=2500,z
      use_existing_jquery=false,
      is_spa=1,
      hide_element='body',
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document,code={use_existing_jquery:function(){return use_existing_jquery},library_tolerance:function(){return library_tolerance},finish:function(){if(!f){f=true;var e=d.getElementById('_vis_opt_path_hides');if(e)e.parentNode.removeChild(e)}},finished:function(){return f},load:function(e){var t=d.createElement('script');t.fetchPriority='high';t.src=e;t.type='text/javascript';t.innerText;t.onerror=function(){_vwo_code.finish()};d.getElementsByTagName('head')[0].appendChild(t)},init:function(){window.settings_timer=setTimeout(function(){_vwo_code.finish()},settings_tolerance);var e=d.createElement('style'),t=hide_element?hide_element+'{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}':'',i=d.getElementsByTagName('head')[0];e.setAttribute('id','_vis_opt_path_hides');e.setAttribute('nonce',document.querySelector('#vwoCode').nonce);e.setAttribute('type','text/css');if(e.styleSheet)e.styleSheet.cssText=t;else e.appendChild(d.createTextNode(t));i.appendChild(e);this.load('https://dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&f='+ +is_spa+'&vn='+version);return settings_timer}};window._vwo_settings_timer = code.init();return code;}());</script>
<meta name="facebook-domain-verification" content="l349mr2tyecyl7w3a1146378lqxru1" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/proofpoint.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Regular-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Bold-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="alternate" hreflang="en-us" href="https://www.proofpoint.com/us/blog/threat-insight/flowcloud-version-413-malware-analysis" />

    <title>FlowCloud Version 4.1.3 Malware Analysis | Proofpoint US</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_lU4Ioaf3R6UrS0uGXtit16d46yiN0qAsRSfzbn2WSZg.css?delta=0&amp;language=en&amp;theme=particle&amp;include=eJxVj0EOAyEIRS80xkVPBJaxpigTwEl6-9p0oa4ID_L4uAgjaPR_PexjTjUiGB0XqJfEFJPo0mWRzBROaW6TniJOGu7HRMiSV0lzah4uyKTbUnoH62hJC1LA7i5tzl8Ez9IWD-ogSXtF209NyeSL93dn1464De7lMRYEDsRUR1D7ApFWbSI" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_kNBflpplxurR8MuEncwxsmIY99rl7i0aoXWJJaNo-9c.css?delta=1&amp;language=en&amp;theme=particle&amp;include=eJxVj0EOAyEIRS80xkVPBJaxpigTwEl6-9p0oa4ID_L4uAgjaPR_PexjTjUiGB0XqJfEFJPo0mWRzBROaW6TniJOGu7HRMiSV0lzah4uyKTbUnoH62hJC1LA7i5tzl8Ez9IWD-ogSXtF209NyeSL93dn1464De7lMRYEDsRUR1D7ApFWbSI" />

    <script src="/sites/default/files/js/js_L66B4ykoym9_-33ZMf8UzW3ch3MFFdemzlbHNsNeMWI.js?scope=header&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://platform-api.sharethis.com/js/sharethis.js#property=6543fd1a2398960013d900a7&amp;product=inline-share-buttons&amp;source=platform"></script>

  </head>
  <body class="path-node user-anonymous">
        <a href="#main-content" class="visually-hidden focusable">
      Skip to main content
    </a>
    <div class="limit-width-wrapper">
      
        <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    
  

  
  
  
  


<div class="header-nav__spacer"></div>
<div class="header-nav js-is-top">
	<div class="header-nav__extra">
		<div class="header-nav__extra-wrap">
			<div class="header-nav__top-language" data-open="content:x_lng">
				<span>English (Americas)</span>
			</div>
			<div class="header-nav__actions">
				<div class="header-nav__top-search" data-open="content:x_sch">
					<span>Search</span>
				</div>
				<div class="header-nav__top-login" data-open="content:x_lgn">
					<span>Login</span>
				</div>
			</div>
		</div>
	</div>
	<div class="header-nav__main">
		<div class="header-nav__main-wrap">
			<div class="header-nav__expand" data-open="home"></div>
			<ul class="header-nav__top-links">
																						<li class="header-nav__top-link">
								<div data-open="content:platform_panel" class="header-nav__top-link-text">
									Platform
								</div>
							</li>
																																	<li class="header-nav__top-link">
								<div data-open="content:products_panel" class="header-nav__top-link-text">
									Products
								</div>
							</li>
																																	<li class="header-nav__top-link">
								<div data-open="content:solutions_panel" class="header-nav__top-link-text">
									Solutions
								</div>
							</li>
																																													</ul>
			<a href="/us" class="header-nav__logo">Proofpoint</a>
			<div class="header-nav__buttons">
									

    


  <a href=/us/contact class="global-elements__cta-button--outline header-nav__button" >
    <span>Contact</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


							</div>
			<div class="header-nav__mobile-actions">
				<div class="header-nav__mobile-search" data-open="content:x_sch">Search</div>
				<div class="header-nav__mobile-menu" data-open="home"></div>
			</div>
		</div>
	</div>
</div>

<div class="header-nav__menu">
	<div class="header-nav__menu-wrapper">
		<div class="header-nav__menu-close"></div>
		<div class="header-nav__menu-pane" data-home={true}>
			<ul class="header-nav__home-links">
				                      <li class="header-nav__home-link" data-open="content:platform_panel" ><span>Platform</span></li>
          				                      <li class="header-nav__home-link" data-open="content:products_panel" ><span>Products</span></li>
          				                      <li class="header-nav__home-link" data-open="content:solutions_panel" ><span>Solutions</span></li>
          				                      <li class="header-nav__home-link" data-open="content:partners_panel" ><span>Partners</span></li>
          				                      <li class="header-nav__home-link" data-open="content:resources_panel" ><span>Resources</span></li>
          				                      <li class="header-nav__home-link" data-open="content:company_panel" ><span>Company</span></li>
          							</ul>
			<div class="header-nav__menu-extras">
				<div class="header-nav__menu-search" data-open="content:x_sch">Search</div>
				<div class="header-nav__menu-login" data-open="content:x_lgn">Login</div>
				<div class="header-nav__menu-language" data-open="content:x_lng">English (Americas)</div>
			</div>
		</div>
					<div class="header-nav__menu-pane" data-sublinks="Platform">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Platform</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Products">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Products</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Solutions">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Solutions</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Partners">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Partners</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Resources">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Resources</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Company">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Company</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
							<div class="header-nav__menu-pane" data-content="products_panel">
				<div class="header-nav__content">
																																												                                 <a href="/us/products/protect-people" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Protect People</div>
                    									    <div class="header-nav__content-group-desc">Multi-layered, adaptive defenses for threat detection, impersonation, and supplier risk.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="/us/products/threat-defense" class="header-nav__content-link-text">Email Security</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/impersonation-protection" class="header-nav__content-link-text">Impersonation Protection</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:products_more_tp_products_panel">More products</a>
                                                          </div>
              						                                 <a href="/us/products/defend-data" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Defend Data</div>
                    									    <div class="header-nav__content-group-desc">Transform your information protection with a human-centric, omni-channel approach.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="/us/products/data-security-posture-management" class="header-nav__content-link-text">Data Security Posture Management</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/data-loss-prevention" class="header-nav__content-link-text">Enterprise DLP</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-dlp" class="header-nav__content-link-text">Adaptive Email DLP</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/insider-threat-management" class="header-nav__content-link-text">Insider Threat Management</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/compliance-and-archiving" class="header-nav__content-link-text">Intelligent Compliance</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Mitigate Human Risk</div>
                    									    <div class="header-nav__content-group-desc">Unlock full user risk visibility and drive behavior change.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/products/mitigate-human-risk" class="header-nav__content-link-text">Security Awareness</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Augment Your Capabilities</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/products/premium-services" class="header-nav__content-link-text">Managed Services</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/packages" class="header-nav__content-link-text">Product Packages</a>
                                                          </div>
              						                                <div class="header-nav__content-link-spacer"></div>
                																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="products_more_tp_products_panel">
				<div class="header-nav__content">
																	 <div class="header-nav__content-heading">More Protect People Products</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/products/identity-protection" class="header-nav__content-link-text">Account Take-Over and Identity Protection</a>
                                                              <div class="header-nav__content-link-desc">Secure vulnerable identities, stop lateral movement and privilege escalation.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-security" class="header-nav__content-link-text">Adaptive Email Security</a>
                                                              <div class="header-nav__content-link-desc">Stop more threats with a fully integrated layer of behavioral AI.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/email-protection/email-fraud-defense" class="header-nav__content-link-text">Email Fraud Defense</a>
                                                              <div class="header-nav__content-link-desc">Protect your brand reputation, increase deliverability and identify lookalikes of your domains.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/email-security-and-protection/secure-email-relay" class="header-nav__content-link-text">Secure Email Relay</a>
                                                              <div class="header-nav__content-link-desc">Secure your application email and accelerate DMARC implementation.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_panel">
				<div class="header-nav__content">
																																												                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Use Case</div>
                    									    <div class="header-nav__content-group-desc">How Proofpoint protects your people and data.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/ensure-acceptable-genai-use" class="header-nav__content-link-text">Ensure Acceptable GenAI Use</a>
                                                              <div class="header-nav__content-link-desc">Empower your workforce with safe GenAI practices.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-authentication-with-dmarc" class="header-nav__content-link-text">Authenticate Your Email</a>
                                                              <div class="header-nav__content-link-desc">Protect your email deliverability with DMARC.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-email-and-cloud-threats" class="header-nav__content-link-text">Combat Email and Cloud Threats</a>
                                                              <div class="header-nav__content-link-desc">Protect your people from email and cloud threats with an intelligent and holistic approach.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_use_case_panel">More use cases</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Industry</div>
                    									    <div class="header-nav__content-group-desc">People-centric solutions for your organization.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/federal" class="header-nav__content-link-text">Federal Government</a>
                                                              <div class="header-nav__content-link-desc">Cybersecurity for federal government agencies.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/state-and-local-government" class="header-nav__content-link-text">State and Local Government</a>
                                                              <div class="header-nav__content-link-desc">Protecting the public sector, and the public from cyber threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_industry_panel">More industries</a>
                                                          </div>
              						                                 <a href="/us/compare" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Comparing Proofpoint</div>
                    									    <div class="header-nav__content-group-desc">Evaluating cybersecurity vendors? Check out our side-by-side comparisons.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:compare_proofpoint_panel">View comparisons</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_by_use_case_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Solutions By Use Case</h3> 						 <div class="header-nav__content-heading">How Proofpoint protects your people and data.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/change-user-behavior" class="header-nav__content-link-text">Change User Behavior</a>
                                                              <div class="header-nav__content-link-desc">Help your employees identify, resist and report attacks before the damage is done.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-data-loss-and-insider-risk" class="header-nav__content-link-text">Combat Data Loss and Insider Risk</a>
                                                              <div class="header-nav__content-link-desc">Prevent data loss via negligent, compromised and malicious insiders.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/enable-intelligent-compliance" class="header-nav__content-link-text">Modernize Compliance and Archiving</a>
                                                              <div class="header-nav__content-link-desc">Manage risk and data retention needs with a modern compliance and archiving solution.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/protect-cloud-apps" class="header-nav__content-link-text">Protect Cloud Apps</a>
                                                              <div class="header-nav__content-link-desc">Keep your people and their cloud apps secure by eliminating threats and data loss.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/prevent-loss-from-ransomware" class="header-nav__content-link-text">Prevent Loss from Ransomware</a>
                                                              <div class="header-nav__content-link-desc">Learn about this growing threat and stop attacks by securing ransomware&#039;s top vector: email.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/secure-microsoft-365" class="header-nav__content-link-text">Secure Microsoft 365</a>
                                                              <div class="header-nav__content-link-desc">Implement the best security and compliance solution for Microsoft 365.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_by_industry_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Solutions By Industry</h3> 						 <div class="header-nav__content-heading">People-centric solutions for your organization.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/higher-education-security" class="header-nav__content-link-text">Higher Education</a>
                                                              <div class="header-nav__content-link-desc">A higher level of security for higher education.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/financial-services-and-insurance" class="header-nav__content-link-text">Financial Services</a>
                                                              <div class="header-nav__content-link-desc">Eliminate threats, build trust and foster growth for your organization.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/healthcare-information-security" class="header-nav__content-link-text">Healthcare</a>
                                                              <div class="header-nav__content-link-desc">Protect clinicians, patient data, and your intellectual property against advanced threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/mobile-message-security-solutions-for-service-providers" class="header-nav__content-link-text">Mobile Operators</a>
                                                              <div class="header-nav__content-link-desc">Make your messaging environment a secure environment.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-security-solutions-for-service-providers" class="header-nav__content-link-text">Internet Service Providers</a>
                                                              <div class="header-nav__content-link-desc">Cloudmark email protection.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/protection-compliance-small-business" class="header-nav__content-link-text">Small and Medium Businesses</a>
                                                              <div class="header-nav__content-link-desc">Big-time security for small business.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="compare_proofpoint_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Proofpoint vs. the competition</h3> 						 <div class="header-nav__content-heading">Side-by-side comparisons.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-abnormal-security" class="header-nav__content-link-text">Proofpoint vs. Abnormal Security</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-mimecast" class="header-nav__content-link-text">Proofpoint vs. Mimecast</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-cisco" class="header-nav__content-link-text">Proofpoint vs. Cisco</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft" class="header-nav__content-link-text">Proofpoint vs Microsoft</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft-purview" class="header-nav__content-link-text">Proofpoint vs. Microsoft Purview</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-legacy-dlp" class="header-nav__content-link-text">Proofpoint vs. Legacy DLP</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="partners_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Partners</h3> 						 <div class="header-nav__content-heading">Deliver Proofpoint solutions to your customers.</div> 													

  


  <a href=https://partners.proofpoint.com class="global-elements__cta-button header-nav__content-button" >
    <span>Become a Partner</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/partners/trusted-data-solutions-partnership" class="header-nav__content-link-text">Archive Extraction Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about Extraction Partners.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/global-system-integrator-gsi-and-global-managed-service-provider-msp-partners" class="header-nav__content-link-text">GSI Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our global consulting.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/technology-alliance-partners" class="header-nav__content-link-text">Technology and Alliance Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our relationships.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/digital-risk-and-compliance-partners" class="header-nav__content-link-text">Social Media Protection Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about the technology and....</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/msp" class="header-nav__content-link-text">MSP Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our MSP solutions.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="https://partners.proofpoint.com" class="header-nav__content-link-text">Portal Login</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="resources_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Resources</h3> 						 <div class="header-nav__content-heading">Find reports, webinars, blogs, events, podcasts and more.</div> 													

  


  <a href=/us/resources class="global-elements__cta-button header-nav__content-button" >
    <span>Resource Library</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/blog" class="header-nav__content-link-text">Blog</a>
                                                              <div class="header-nav__content-link-desc">Keep up with the latest news and happenings.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/webinars" class="header-nav__content-link-text">Webinars</a>
                                                              <div class="header-nav__content-link-desc">Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/cybersecurity-academy" class="header-nav__content-link-text">Cybersecurity Academy</a>
                                                              <div class="header-nav__content-link-desc">Earn your certification to become a Proofpoint Certified Guardian.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/podcasts" class="header-nav__content-link-text">Podcasts</a>
                                                              <div class="header-nav__content-link-desc">Learn about the human side of cybersecurity.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/new-perimeters" class="header-nav__content-link-text">New Perimeters Magazine</a>
                                                              <div class="header-nav__content-link-desc">Get the latest cybersecurity insights in your hands.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/threat-reference" class="header-nav__content-link-text">Threat Glossary</a>
                                                              <div class="header-nav__content-link-desc">Learn about the latest security threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/events" class="header-nav__content-link-text">Events</a>
                                                              <div class="header-nav__content-link-desc">Connect with us at events to learn how to protect your people and data from ever-evolving threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/customer-stories" class="header-nav__content-link-text">Customer Stories</a>
                                                              <div class="header-nav__content-link-desc">Read how our customers solve their most pressing cybersecurity challenges.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="company_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Company</h3> 						 <div class="header-nav__content-heading">Proofpoint protects organizations' greatest assets and biggest risks: their people.</div> 													

  


  <a href=/us/company/about class="global-elements__cta-button header-nav__content-button" >
    <span>About Proofpoint</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/why-proofpoint" class="header-nav__content-link-text">Why Proofpoint</a>
                                                              <div class="header-nav__content-link-desc">Learn about our unique people-centric approach to protection.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/company/careers" class="header-nav__content-link-text">Careers</a>
                                                              <div class="header-nav__content-link-desc">Stand out and make a difference at one of the world&#039;s leading cybersecurity companies.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/newsroom" class="header-nav__content-link-text">News Center</a>
                                                              <div class="header-nav__content-link-desc">Read the latest press releases, news stories and media highlights about Proofpoint.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/legal/trust" class="header-nav__content-link-text">Privacy and Trust</a>
                                                              <div class="header-nav__content-link-desc">Learn about how we handle data and make commitments to privacy and other regulations.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/legal/esg" class="header-nav__content-link-text">Environmental, Social, and Governance</a>
                                                              <div class="header-nav__content-link-desc">Learn how we apply our principles to positively impact our community.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/support-services" class="header-nav__content-link-text">Support</a>
                                                              <div class="header-nav__content-link-desc">Access the full range of Proofpoint support services.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="platform_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Platform</h3> 						 <div class="header-nav__content-heading">Discover the Proofpoint human-centric platform.</div> 													

  


  <a href=/us/platform class="global-elements__cta-button header-nav__content-button" >
    <span>Learn More</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/platform/nexus" class="header-nav__content-link-text">Nexus</a>
                                                              <div class="header-nav__content-link-desc">Detection technologies to protect people and defend data.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/platform/zen" class="header-nav__content-link-text">Zen</a>
                                                              <div class="header-nav__content-link-desc">Protect and engage users wherever they work.</div>
                                      </div>
              																				</div>
			</div>
				<div class="header-nav__menu-pane" data-content="x_sch">
			<div class="header-nav__content">
				<div class="header-nav__content-title--search">
					Search Proofpoint
				</div>
				<div class="header-nav__search">

					<form class="header-nav__search-form">
						<input type="text" class="header-nav__search-input" placeholder="">
						<input type="submit" class="header-nav__search-button" val="Search">
					</form>
					<div class="header-nav__search-sugg-title">Try searching for</div>
					<div class="header-nav__search-suggestions">
													<a href="/us/search?content%5Bquery%5D=Email%20Security" class="header-nav__search-suggestion">Email Security</a>
													<a href="/us/search?content%5Bquery%5D=Phishing" class="header-nav__search-suggestion">Phishing</a>
													<a href="/us/search?content%5Bquery%5D=DLP" class="header-nav__search-suggestion">DLP</a>
													<a href="/us/search?content%5Bquery%5D=Email%20Fraud" class="header-nav__search-suggestion">Email Fraud</a>
											</div>
				</div>
			</div>
		</div>
		<div class="header-nav__menu-pane" data-content="x_lgn">
			<div class="header-nav__content">
				<div class="header-nav__content-title">
					Select Product Login
				</div>
				<ul class="header-nav__logins">
											<li class="header-nav__content-login">
							<a href="https://proofpoint.my.site.com/community/s/" target="_blank">Support Log-in</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://proofpointcybersecurityacademy.adobelearningmanager.com" target="_blank">Proofpoint Cybersecurity Academy</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://digitalrisk.proofpoint.com/" target="_blank">Digital Risk Portal</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://emaildefense.proofpoint.com/login.php" target="_blank">Email Fraud Defense</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://threatintel.proofpoint.com/" target="_blank">ET Intelligence</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://us1.proofpointessentials.com/app/login.php" target="_blank">Proofpoint Essentials</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://proofpointcommunities.force.com/community" target="_blank">Sendmail Support Log-in</a>
						</li>
									</ul>
			</div>
		</div>
		<div class="header-nav__menu-pane" data-content="x_lng">
			<div class="header-nav__content">
				<div class="header-nav__content-title">
					Select Language
				</div>

				<ul class="header-nav__language-links">
                    <li class="header-nav__language-link">
            <a href="/us">English (Americas)</a>
          </li>
          					            					                          <li class="header-nav__language-link">
                <a href="/uk">English (Europe, Middle East, Africa)</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/au">English (Asia-Pacific)</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/es">Español</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/de">Deutsch</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/fr">Français</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/it">Italiano</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/br">Português</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/jp">日本語</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/kr">한국어</a>
              </li>
            									</ul>
			</div>
		</div>
	</div>
</div>



<div class="layout-container">
  
    <div>
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>


  <main class="container" role="main">
    <a id="main-content" tabindex="-1"></a>    <section class="row">
      <div class="layout-content">
          <div>
    <div id="block-particle-content">
  
    
      




<article about="/us/blog/threat-insight/flowcloud-version-413-malware-analysis" class="node--type--blog-post node--view-mode--full node node-blog-full _legacy_content _blog-full">
  



  <div class="breadcrumbs _legacy_element _breadcrumbs"><div class="nav-crumbs"><div class="breadcrumb__item"><a href="/us/blog" class="breadcrum__item-link">Blog</a></div><div class="breadcrumb__item"><a href="/us/blog/threat-insight" class="breadcrum__item-link">Threat Insight</a></div><div class="breadcrumb__item">
            FlowCloud Version 4.1.3 Malware Analysis          </div></div></div>

  <div class="blog-banner">
    <div class="blog-banner__image">      <picture>
                  <source srcset="/sites/default/files/styles/image_1920_750/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=545nw4WB 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=aH2g1dDE 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=4-2ujGUC 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
              <source srcset="/sites/default/files/styles/image_1920_750/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=545nw4WB 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=aH2g1dDE 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=4-2ujGUC 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
                  <img loading="lazy" src="/sites/default/files/styles/image_768_300/public/2020-06/pfpt-ti-blog-img-20200610.jpg.webp?itok=vpfzyxh8" width="768" height="300" alt="FlowCloud Version 4.1.3 Malware Analysis" typeof="foaf:Image" />

  </picture>


</div>
    <div class="blog-banner__gradient-overlay"></div>
    <div class="blog-banner__heading-wrap">
      
      


<h1 class="blog-banner__heading">
      <span>FlowCloud Version 4.1.3 Malware Analysis</span>

  </h1>

    </div>
  </div>

  <div class="blog-content">
    <div class="blog-content__sharethis sharethis_toolbox sharethis_32x32_style">
      <div class="blog-content__sharethis_label sharethis__label">Share with your network!</div>
      <div class="blog-content__sharethis_buttons sharethis_buttons">
        <div class="sharethis-inline-share-buttons"></div>
        
<span class="addthis_button_subscribe at300b UNCONVERTED" title=Subscribe>
  <span class="at-icon-wrapper block-subscribe-button__trigger block-subscribe-button__addthis"></span>
</span>


      </div>
    </div>
        <div class="blog-content__metadata blog-content__metadata-author">
      <span class="blog-content__date">  <time datetime="2020-06-11T00:30:00Z">June 10, 2020</time>

</span>
        <span class="blog-content__author">
                Dennis Schwarz
  
        </span>
    </div>
    <div class="node-full__body blog-content__body">  <p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Proofpoint researchers are continuing to track the threat actor TA410’s use of <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" style="color:#0563c1; text-decoration:underline">FlowCloud</a>, a remote access trojan (RAT). Below is a new in-depth analysis of another version of the FlowCloud RAT, version 4.1.3. While we do not have many campaign details or targeting information on this particular sample, this is another version of FlowCloud in the wild. Earlier this week we provided an analysis of <a href="https://www.proofpoint.com/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" style="color:#0563c1; text-decoration:underline">version 5.0.1</a>, which was used during the targeting of critical U.S. utility providers last year.</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">It is currently unclear which of the versions is the “newer one”&nbsp;or if there are distinct variants of&nbsp;FlowCloud&nbsp;being used&nbsp;for different purposes. The version we previously detailed had an older compilation date (December 15, 2018 – it is unclear whether the date is forged), but a newer internal version (5.0.1) than the&nbsp;sample&nbsp;discussed here.</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">One major difference between the two&nbsp;is that version&nbsp;5.0.1&nbsp;is&nbsp;written&nbsp;in C++ using extensive object-oriented programing,&nbsp;Boost&nbsp;library, and a C++ implementation of Protocol buffers—version 4.1.3&nbsp;was written&nbsp;in C without any object-oriented techniques and used&nbsp;a C implementation of&nbsp;<a href="https://github.com/protobuf-c/protobuf-c" style="color:#0563c1; text-decoration:underline"><span style="color:#0563c1">Protocol buffers</span></a>.&nbsp;Version 5.0.1&nbsp;also makes use&nbsp;of SHA512, a modified (or broken)&nbsp;AES, and TEA algorithms instead of the MD5 and RC4 as described below.&nbsp;In general, version&nbsp;5.0.1 was a larger and more difficult&nbsp;malware&nbsp;to reverse engineer.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FlowCloud has typical RAT functionality such as access to the filesystem, processes, and&nbsp;services,&nbsp;screenshots, keylogging, command shell,&nbsp;and&nbsp;added&nbsp;functionality via plugins.&nbsp;It also&nbsp;includes port mapping and Nmap&nbsp;port scanning&nbsp;to help&nbsp;facilitate&nbsp;lateral movement.&nbsp;Although&nbsp;the&nbsp;additional functionality was&nbsp;not implemented&nbsp;in the analyzed sample below, there are indicators in the code and configuration data&nbsp;that suggests&nbsp;support for audio recording, clipboard stealing, and exfiltrating files based on specific search criteria such as file type and name pattern. These might&nbsp;be implemented via&nbsp;FlowCloud’s&nbsp;plugin&nbsp;mechanism&nbsp;or&nbsp;may be present&nbsp;in other versions of the malware.</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">In this&nbsp;blog&nbsp;post&nbsp;we&nbsp;will&nbsp;analyze&nbsp;the following FlowCloud sample:</span></span></span></p>

<table class="MsoTableGrid" style="border-collapse:collapse; border:none">
	<tbody>
		<tr>
			<td style="border-bottom:1px solid black; width:90px; padding:0in 7px 0in 7px; border-top:1px solid black; border-right:1px solid black; border-left:1px solid black" valign="top">
			<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><span style="font-size:15.0pt"><span style="color:#595959">SHA256</span></span></span></span></span></p>
			</td>
			<td style="border-bottom:1px solid black; width:534px; padding:0in 7px 0in 7px; border-top:1px solid black; border-right:1px solid black; border-left:none" valign="top">
			<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><span style="font-size:15.0pt"><span style="color:#595959">b75e1391fcb558e42cc05399fa716829114323e1d01aa284445955548302d71f</span></span></span></span></span></p>
			</td>
		</tr>
	</tbody>
</table>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Per its metadata, it&nbsp;is version 4.1.3 and&nbsp;was compiled&nbsp;on March 21, 2019 (it is unclear whether the date is forged). It&nbsp;was recently uploaded&nbsp;to&nbsp;<a href="https://www.virustotal.com/gui/file/b75e1391fcb558e42cc05399fa716829114323e1d01aa284445955548302d71f/" style="color:#0563c1; text-decoration:underline"><span style="color:#0563c1">VirusTotal</span></a>&nbsp;on May 12, 2020 by a submitter from Taiwan.&nbsp;At the time of research, the command and control (C&amp;C) server&nbsp;(114.55.109[.]199)&nbsp;was still active.</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:12.0pt">Naming</span></b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The name “FlowCloud” comes from a debugging string left in one of the earlier&nbsp;samples&nbsp;we found:&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><i>g:\FlowCloud\trunk\Dev\src\fcClient\Release\fcClientDll.pdb</i>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The name was also used in the configuration data&nbsp;of&nbsp;the sample analyzed for this&nbsp;blog&nbsp;post&nbsp;as the “product_name”:&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><i>1 (product_name): "flowcloud"</i>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><i>2 (product_version): "v4.1.3"</i>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:12.0pt">Protocol Buffers</span></b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FlowCloud&nbsp;makes extensive use&nbsp;of a data structure known as&nbsp;Protocol buffers&nbsp;(“protobufs”)&nbsp;in its configuration and C&amp;C&nbsp;communications. “<a href="https://developers.google.com/protocol-buffers" style="color:#0563c1; text-decoration:underline" target="_blank"><span style="color:#0563c1">Protocol buffers are Google's language-neutral, platform-neutral, extensible mechanism for serializing structured data – think XML, but smaller, faster, and simpler. You define how you want your data to be structured once, then you can use special generated source code to easily write and read your structured data to and from a variety of data streams and using a variety of languages.</span></a>”&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">As an example, in the analyzed&nbsp;sample,&nbsp;FlowCloud&nbsp;stores its configuration data as a 3344-byte&nbsp;serialized&nbsp;protobuf&nbsp;as shown in Figure 1:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-1" data-entity-type="file" data-entity-uuid="579d9e36-3883-4598-9d6d-a68a3f1a3ca8" height="522" src="/sites/default/files/inline-images/image-20200610171847-1.png" width="1024" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 1 Configuration data serialized as a protobuf</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Using the Protocol buffer compiler (“protoc”), the&nbsp;serialized&nbsp;data can be&nbsp;deserialized&nbsp;into a more human-readable format as shown in Figure 2:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-2" data-entity-type="file" data-entity-uuid="73eafd94-e5e6-4a75-899a-adf88fa68458" height="517" src="/sites/default/files/inline-images/image-20200610171847-2.png" width="586" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 2 Configuration data that has been deserialized (truncated for readability)</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">To recover the names of the fields, the associated&nbsp;<a href="https://sjiang1.github.io/autoiodocu/protobuf-c_doc/structProtobufCMessageDescriptor.html" style="color:#0563c1; text-decoration:underline" target="_blank"><span style="color:#0563c1">ProtobufCMessageDescriptor</span></a>&nbsp;and&nbsp;<a href="https://sjiang1.github.io/autoiodocu/protobuf-c_doc/structProtobufCFieldDescriptor.html" style="color:#0563c1; text-decoration:underline" target="_blank"><span style="color:#0563c1">ProtobufCFieldDescriptor</span></a>&nbsp;structures can be&nbsp;identified&nbsp;as shown in Figure 3:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-3" data-entity-type="file" data-entity-uuid="cf920bca-354c-43c3-8a4f-ca42f078abfe" height="305" src="/sites/default/files/inline-images/image-20200610171847-3.png" width="1024" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 3 Configuration data’s associated ProtobufCMessageDescriptor</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">We have included an&nbsp;IDA Pro Python script on our <a href="https://github.com/EmergingThreats/threatresearch/blob/master/flowcloud/ida_protobufc.py" style="color:#0563c1; text-decoration:underline">GitHub&nbsp;</a>that can be&nbsp;used to parse and display some of the important fields of these structures as shown in Figure 4:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-4" data-entity-type="file" data-entity-uuid="5951a955-6710-4890-bbd4-52bd6866ab5b" height="883" src="/sites/default/files/inline-images/image-20200610171847-4.png" width="1024" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 4 Parsed ProtobufCMessageDescriptor and ProtobufCFieldDescriptor (truncated for readability)</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The “id” numbers from the structures can&nbsp;be matched&nbsp;with the deserialized data for labeling as shown in Figure 5:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-5" data-entity-type="file" data-entity-uuid="a8474a52-ba00-436f-86c3-54c90a65b44f" height="480" src="/sites/default/files/inline-images/image-20200610171847-5.png" width="478" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 5 Labeled protobuf for configuration data (truncated for readability)</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The&nbsp;ProtobufCMessageDescriptor&nbsp;structure&nbsp;also&nbsp;starts with magic bytes (e.g.&nbsp;0x28aaeef9), so these can be used to identify all the&nbsp;protobufs&nbsp;compiled into the malware. In&nbsp;the&nbsp;analyzed sample there were 78&nbsp;protobufs&nbsp;included.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:12.0pt">Configuration</span></b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">In the analyzed sample, a working directory was setup in:&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><i>C:\Windows\Fonts\zitbee.fon\</i>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The fully labeled configuration data is available on our <a href="https://github.com/EmergingThreats/threatresearch/blob/master/flowcloud/flowcloud_config" style="color:#0563c1; text-decoration:underline">GitHub&nbsp;</a>. Most of its fields are&nbsp;self-identifying&nbsp;and include things such as:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">C&amp;C addresses (e.g. “exchange_server”)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">C&amp;C ports (e.g. “exchange_server_port”)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Encryption keys (e.g. “xchg_server_key”)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Various installation options (e.g. “install_config”)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Various command options (e.g.&nbsp;“keyboard_policy”)</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The configuration data is also stored&nbsp;as a serialized&nbsp;protobuf&nbsp;and&nbsp;encrypted&nbsp;in a “winver.dat” file. It is encrypted using a basic XOR and addition algorithm. We have included a Python script that can be used to decrypt this config file on our <a href="https://github.com/EmergingThreats/threatresearch/blob/master/flowcloud/decrypt_config.py" style="color:#0563c1; text-decoration:underline">GitHub&nbsp;</a>.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:12.0pt">Dependencies</span></b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FlowCloud&nbsp;uses HTTP to download&nbsp;some dependencies from its C&amp;C server (“exchange_server: exchange_server_port+1” from the config). Figure 6&nbsp;shows an example:</span></span></span></p>

<p><img alt="image-20200610171847-6" data-entity-type="file" data-entity-uuid="bf660f2f-4b07-466e-90ee-1fafca036cfb" height="348" src="/sites/default/files/inline-images/image-20200610171847-6.png" width="879" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 6 Example dependency download</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The URIs are hardcoded into the sample. The response data starts with an encrypted 16-byte header:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Header key (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">CRC32 checksum (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Decrypted/decompressed data length (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Encrypted/compressed&nbsp;data length (DWORD)</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The header key&nbsp;is used&nbsp;with some XOR and ROR operations to decrypt the remaining bytes of the header.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">After the header there is RC4 encrypted data. The RC4 key is generated by taking a hardcoded string (e.g. “y983nfdicu3j2dcn09wur9*^&amp;(y4r3inf;'fdskaf'SKF”) and hashing its hex digest 1000 times with MD5.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The decrypted data starts with another 16-byte header as described above. The data that follows this inner header is ZLIB compressed and once decompressed contains a PE file.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The downloaded dependencies include:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">/SL3716/S8437AEB.DAT - SQLite</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">/WC413/21FB9FCF.DAT - Nmap</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">/WC413/6EE2EFF7.DAT - Packet.dll (used with Nmap)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">/WC413/67B1B02F.DAT - wpcap.dll&nbsp;(used with Nmap)</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">We have included a Python script on our <a href="https://github.com/EmergingThreats/threatresearch/blob/master/flowcloud/decrypt_dependency.py" style="color:#0563c1; text-decoration:underline">GitHub&nbsp;</a>that can be used to decrypt these dependencies.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:12.0pt">Command and Control</span></b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">C&amp;C uses a binary protocol over&nbsp;TCP&nbsp;to&nbsp;“exchange_server:exchange_server_port” from the config. An example exchange&nbsp;is shown&nbsp;in Figure 7:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-7" data-entity-type="file" data-entity-uuid="a996047e-35a9-4758-bcce-11df4893fa40" height="651" src="/sites/default/files/inline-images/image-20200610171847-7.png" width="771" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 7 Example C&amp;C exchange</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Both requests and responses are structured similarly. They start with a 28-byte header called “HHDR”:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Header key (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">CRC32 checksum (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“HHDR” (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Unknown&nbsp;counter (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Unknown hardcoded 1 (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Data length (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Unknown hardcoded 1 (BYTE)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Hash type (BYTE)</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">1 is MD5&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Compression type (BYTE)</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">1 is ZLIB</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Crypto type (BYTE)</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">2 is RC4&nbsp;</span></span></span></span></li>
	</ul>
	</li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The header key&nbsp;is used&nbsp;with some XOR and ROR operations to decrypt the remaining bytes of the header.</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Following “HHDR” is a 24-byte header called “HCMD”:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Header key (DWORD)&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">CRC32 checksum (DWORD)&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“HCMD” (DWORD)&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Command (DWORD)&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Subcommand (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Data length (DWORD)&nbsp;</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The header key is used with some XOR and ROR operations to decrypt the remaining bytes of the header.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Following the “HCMD” header is a 16-byte header as described above in the “Dependencies” section.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">After the third header there is RC4 encrypted data. The RC4 key for this data is generated by taking the “xchg_server_key” from the config and hashing its hex digest one time with MD5.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Once the data is decrypted there is a final 16-byte header and ZLIB compressed data (see the “Dependencies” section above).&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">We have included a Python script on our <a href="https://github.com/EmergingThreats/threatresearch/blob/master/flowcloud/decrypt_comms.py" style="color:#0563c1; text-decoration:underline">GitHub&nbsp;</a>&nbsp;that can be&nbsp;used to decrypt these requests or responses.&nbsp;Figure 8&nbsp;is an example output of our script:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-8" data-entity-type="file" data-entity-uuid="7286e31b-a3a2-4b0e-a9d0-fdd9e20bcb93" height="660" src="/sites/default/files/inline-images/image-20200610171847-8.png" width="1024" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 8 Example parsing of a C&amp;C request</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">&nbsp;</span></span></span><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The decrypted&nbsp;data is a&nbsp;serialized&nbsp;protobuf.&nbsp;For example, the names of the&nbsp;protobufs&nbsp;involved with command 1&nbsp;subcommand&nbsp;2 are:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FcNet__MsgUsr&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FcNet__MsgUsr__System&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FcNet__MsgUsr__System__Adapter&nbsp;</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">This command&nbsp;is used&nbsp;to send&nbsp;various&nbsp;system information to the C&amp;C server as shown in Figure 9:&nbsp;</span></span></span></p>

<p><img alt="image-20200610171847-9" data-entity-type="file" data-entity-uuid="28508a7e-7969-440d-84d0-233cae9f311f" height="917" src="/sites/default/files/inline-images/image-20200610171847-9.png" width="1024" loading="lazy"></p>

<p class="MsoCaption" style="margin-bottom:13px"><span style="font-size:9pt"><span style="font-family:Calibri,sans-serif"><span style="color:#44546a"><span style="font-style:italic">Figure 9 Labeled protobuf for command 1 subcommand 2 (edited for privacy)</span></span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b>C&amp;C Commands</b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">We have identified the following commands that can be executed via C&amp;C command polls:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Command 2 – filesystem related</span></span></span></span>

	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Subcommand 0 - get drive information</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">1 - get directory listing</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">2 - create directory</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">3 - rename directory</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4 - write file</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">5 - read file</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">6 - remove directory</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">7 - get file attributes</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">8 - set file attributes and times</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">9 - add file to "filemgr" list (see below)</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">10 - search directory for files with a given&nbsp;file name pattern</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">11 -&nbsp;ShellExecute&nbsp;"open" file with arguments</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">12 - add directory to "folderimage" list (see below)&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">3 – take a screenshot&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">5 – Exfiltrate&nbsp;data related (see below)</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">0 - get exfiltrate&nbsp;data size</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">1 - get exfiltrate&nbsp;data file count</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">2 - get exfiltrate&nbsp;data item list</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">3 - change status of exfiltrate&nbsp;data&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">6 – process related</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">0 - get process list</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">1 - kill process&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">7 – service related</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">0 - get service list</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">1 - start service</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">2 - stop service</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">3 - delete service</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4 - set service start type&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">9 – system related</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">0 - get installed software</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4097 – reboot</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4098 – reboot</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4099 –&nbsp;NtRaiseHardError</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4100 – copy %SYSTEM%\winver.exe to %WIN%\System\winver.exe then&nbsp;NtRaiseHardError&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">10 – cmd.exe command shell</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4097 – write command to shell&nbsp;</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">11 – lateral movement related</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4097 - setup port mapping using&nbsp;<a href="https://github.com/windworst/LCX" style="color:#0563c1; text-decoration:underline" target="_blank"><span style="color:#0563c1">https://github.com/windworst/LCX</span></a></span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4098 - remove port mapping</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">4099 - get port mappings</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">8193 - start&nbsp;Nmap&nbsp;scan</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">8194 - replies with "Unsupported yet."</span></span></span></span></li>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">8195 - get&nbsp;Nmap&nbsp;scan results&nbsp;</span></span></span></span></li>
	</ul>
	</li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif"><b>Data Exfiltration Managers</b>&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">In addition to the C&amp;C commands,&nbsp;FlowCloud&nbsp;has some additional functionality&nbsp;organized as “data exfiltration&nbsp;managers" that include:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“filemgr”&nbsp;– exfiltrate&nbsp;files&nbsp;as specified by a C&amp;C command&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“folderimage”&nbsp;– exfiltrate directories as specified by a C&amp;C command&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“screen” - exfiltrate screenshots&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“keylog” - exfiltrate keylogging data</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Keylogging data is gathered by an external program and sent to&nbsp;FlowCloud&nbsp;via a named pipe (e.g.&nbsp;“\\.\pipe\namedpipe_keymousespy_english”)</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“audio” - possibly audio recording</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The config and code hint at this functionality, but&nbsp;it is&nbsp;not implemented in the analyzed sample</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“smtfile” -&nbsp;possibly search&nbsp;for and exfiltrate files based on file types and name patterns</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The config and code hint at this functionality, but it is not implemented in the analyzed sample</span></span></span></span></li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“plugin” - download and execute additional plugins</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">PE file exports associated&nbsp;with&nbsp;plugins:</span></span></span></span>
		<ul>
			<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“pluginInfo”</span></span></span></span></li>
			<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“startModule”</span></span></span></span></li>
			<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“setOtherInterface2”</span></span></span></span></li>
		</ul>
		</li>
	</ul>
	</li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">“clipboard” - possibly steal clipboard contents</span></span></span></span>
	<ul>
		<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">​​​​​​​​​​​​​​</span></span></span></span><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The config and code hint at this functionality, but it is not implemented in the analyzed sample&nbsp;</span></span></span></span></li>
	</ul>
	</li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">These exfiltration managers run in their own execution threads and some are controlled by “policies” in the config.&nbsp;They store their data in various SQLite databases and&nbsp;then&nbsp;another execution thread will eventually exfiltrate the data to the C&amp;C server.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">As an example, the “screen” exfiltration manager takes continuous screenshots according to its “screen_policy”:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">state –&nbsp;is policy active&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">cycle_time&nbsp;– sleep time between screenshots&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">cache_count&nbsp;– maximum number of screenshots waiting to be exfiltrated&nbsp;</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">bit_depth&nbsp;– bit depth of screenshot&nbsp;</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">A screenshot is taken.&nbsp;Depending on its size, the data may be broken up into chunks.&nbsp;The data is then compressed with ZLIB and encrypted with RC4&nbsp;(uses “file_key” from config). As described&nbsp;above, 16-byte encrypted headers are attached to the compressed and encrypted data.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Two&nbsp;additional&nbsp;headers are prepended to the compressed and encrypted data. They are encrypted similarly to the 16-byte, 28-byte, and 24-byte&nbsp;headers above.&nbsp;The first header is 96-bytes:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Header key (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">CRC32 checksum of header (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">CRC32 checksum of data (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Product name&nbsp;(16-bytes)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Product version (16-bytes)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Unknown hardcoded 1 (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Timestamp (QWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">File attributes (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Data length (QWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Creation time (QWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Last access time (QWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Last write time (QWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Length of the next header (DWORD)</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The second header is at least 24-bytes, but its length depends on the number of data chunks&nbsp;and length of&nbsp;a&nbsp;filename:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Header key (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">CRC32 checksum of header (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Header&nbsp;length (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Offset to end of chunk list (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Offset to start of chunk list (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Number of chunks (DWORD)</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">File name and chunk list (variable length)</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">The&nbsp;encrypted&nbsp;screenshot data&nbsp;is then saved&nbsp;to&nbsp;a&nbsp;SQLite database. In the analyzed sample this&nbsp;was stored&nbsp;in&nbsp;the&nbsp;file “data\E70EEF62”. We have included an example of the schema used on our <a href="https://github.com/EmergingThreats/threatresearch/blob/master/flowcloud/screen_schema" style="color:#0563c1; text-decoration:underline"><span style="text-decoration:none"><span style="text-underline:none">GitHub</span></span></a>, but it basically consists of a “file” table to store metadata about the data to exfiltrate and a “file_data” table that stores the&nbsp;data.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">Periodically a separate execution thread will go through the SQLite databases created by the exfiltration managers and send the data to the C&amp;C server. It uses the same C&amp;C protocol as described&nbsp;above, but&nbsp;using&nbsp;the “file_server,”&nbsp;“file_server_port,”&nbsp;and “file_server_key” values from the config.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="font-family:&quot;Segoe UI&quot;,sans-serif">The Proofpoint threat research team</span></span><span style="font-size:10.5pt"><span style="font-family:&quot;Segoe UI&quot;,sans-serif"> analyzed </span></span><span style="font-size:10.5pt"><span style="font-family:&quot;Segoe UI&quot;,sans-serif">and performed reverse engineering on&nbsp;</span></span></span></span><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">a recently discovered version&nbsp;(4.1.3)&nbsp;of the&nbsp;FlowCloud&nbsp;RAT.&nbsp;While the version that we analyzed is for Windows only, we believe that there may be additional variants. One piece of evidence that&nbsp;may&nbsp;support the theory that there are additional FlowCloud variants, is the&nbsp;“plateform” (sic) field detailed in Figure 9&nbsp;above. This is an enumerated data type that&nbsp;can have the following values:&nbsp;</span></span></span></p>

<ul>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FC_NET__USR_LIST__USR__SYSTEM__PLATEFORM_TYPE__WINDOWS</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FC_NET__USR_LIST__USR__SYSTEM__PLATEFORM_TYPE__LINUX</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FC_NET__USR_LIST__USR__SYSTEM__PLATEFORM_TYPE__MAC</span></span></span></span></li>
	<li><span style="font-size:11pt"><span style="tab-stops:list .5in"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">FC_NET__USR_LIST__USR__SYSTEM__PLATEFORM_TYPE__ANDROID&nbsp;</span></span></span></span></li>
</ul>

<p><span style="font-size:11pt"><span style="vertical-align:baseline"><span style="font-family:Calibri,sans-serif">While&nbsp;we have&nbsp;only seen versions of&nbsp;FlowCloud&nbsp;for Windows, this&nbsp;implies&nbsp;there may be other implementations of&nbsp;FlowCloud&nbsp;for other operating systems.&nbsp;</span></span></span></p>

<p><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><b>ET and ETPRO Suricata/SNORT Signatures</b></span></span></p>

<p><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><b>2842895 - ETPRO MALWARE FlowCloud Dependency Download M1</b></span></span></p>

<p><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><b>2842896 - ETPRO MALWARE FlowCloud Dependency Download M2</b></span></span></p>

<p><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><b>2842897 - ETPRO MALWARE FlowCloud Dependency Download M3</b></span></span></p>

<p><span style="font-size:11pt"><span style="font-family:Calibri,sans-serif"><b>2842898 - ETPRO MALWARE FlowCloud Dependency Download M4</b></span></span></p>

</div>
  </div>

      <div class="blog__content-pager">
      
  <div class="content-pager _legacy_blocks _content_pager">
    <div class="content-pager__items-wrapper">
      <div class="content-pager__items">
        <div class="content-pager__item content-pager__item--prev">
          <a href="/us/blog/threat-insight/ta410-group-behind-lookback-attacks-against-us-utilities-sector-returns-new" hreflang="en">Previous Blog Post</a>
        </div>
        <div class="content-pager__item content-pager__item--next">
          <a href="/us/blog/threat-insight/hakbit-ransomware-campaign-against-germany-austria-switzerland" hreflang="en">Next Blog Post</a>
        </div>
      </div>
    </div>
  </div>

    </div>
        




  
        
<div class="subscribe-block blog-subscribe _legacy_blocks _subscribe-block subscribe-block--black blog-subscribe--black v3-dark-bg-only" data-animate="true">
  <div class="subscribe-block__inner blog-subscribe__inner">
    <div class="subscribe-block__copy">
      

      
<h3 class="subscribe-block__heading">
      Subscribe to the Proofpoint Blog
  </h3>

          </div>
    <div class="subscribe-block__form">
        <div class="mk-form">
  <div class="mk-form__form-container _legacy_element _marketo_form">
    <script type="IN/Form2"
      data-data-form="mktoForm_19277"
      data-field-firstname="FirstName"
      data-field-lastname="LastName"
      data-field-email="Email"
      data-field-company="Company"
      data-field-title="Title"
      data-field-state="State"
      data-field-country="Country"
    ></script>
    <form
      id="mktoForm_19277"
      data-mkto-id="19277"
      data-mkto-base="//go.proofpoint.com"
      data-munchkin-id="309-RHV-619"
      data-submit-text=""
      data-redirect-link=""
      data-prefill=""
      data-event-label=""
      data-lang-code="us"
      data-validate-email="1"
      class="mk-form__form marketo-form-block__form"
    ></form>
  </div>
</div>


    </div>
  </div>
</div>



  </article>


  </div>

  </div>

      </div>
    </section>
  </main>

</div>

<div class="footer-v3" data-animate="true">
  <div class="footer-v3__inner">
          <nav class="footer-v3__nav">
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Products</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="/us/products/protect-people">Protect People</a></li>
            <li><a href="/us/products/defend-data">Defend Data</a></li>
            <li><a href="/us/products/mitigate-human-risk">Mitigate Human Risk</a></li>
            <li><a href="/us/products/premium-services">Premium Services</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Get Support</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="https://proofpoint.my.site.com/community/s/" target="_blank">Product Support Login</a></li>
            <li><a href="/us/support-services">Support Services</a></li>
            <li><a href="https://ipcheck.proofpoint.com" target="_blank">IP Address Blocked?</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Connect with Us</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="tel:+1-408-517-4710" class="icon-phone-ppoint">+1-408-517-4710</a></li>
            <li><a href="/us/events">Attend an Event</a></li>
            <li><a href="/us/contact">Contact Us</a></li>
            <li><a href="/us/free-demo-request">Free Demo Request</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">More</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="/us/company/about">About Proofpoint</a></li>
            <li><a href="/us/why-proofpoint">Why Proofpoint</a></li>
            <li><a href="/us/company/careers">Careers</a></li>
            <li><a href="/us/leadership-team">Leadership Team</a></li>
            <li><a href="/us/newsroom">News Center</a></li>
            <li><a href="/us/legal/trust">Privacy and Trust</a></li>
          </ul>
        </div>
      </nav>
        <div class="footer-v3__bottom-wrap">
      <section class="footer-v3__bottom">
        <div class="footer-v3__logo">
          <a href="/us" class="footer-v3__logo-link">
            <div class="footer-v3__logo-image"></div>
          </a>
          <div class="footer-v3__bottom-copyright-info">&copy;
            2025.
            All rights reserved.
          </div>
        </div>
        <div class="footer-v3__bottom-copyright">
          <a class="footer-v3__bottom-copyright-info" href="/us/legal/license">Terms and conditions</a>
          <a class="footer-v3__bottom-copyright-info" href="/us/legal/privacy-policy">Privacy Policy</a>
          <a class="footer-v3__bottom-copyright-info" href="/us/sitemap">Sitemap</a>
        </div>
        <ul class="footer-v3__bottom-social-menu">
          <li>
            <a href="http://www.facebook.com/proofpoint" class="icon-facebook" target="_blank"></a>
          </li>
          <li>
            <a href="http://www.twitter.com/proofpoint" class="icon-twitter" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/proofpoint" class="icon-linkedin" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.youtube.com/channel/UCIvtJgsrUzFo90NKeiVozhQ" class="icon-youtube-play" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.instagram.com/proofpoint" class="icon-instagram" target="_blank"></a>
          </li>
        </ul>
      </section>
    </div>
  </div>
</div>


  </div>

      <script type="text/javascript">document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E")); </script> <script>Munchkin.init('309-RHV-619');</script><div class="element-invisible" style="clear:both;"><!-- Google Code for Remarketing Tag -->
                <!--------------------------------------------------
                Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
                --------------------------------------------------->
                <script type="text/javascript">
                /* <![CDATA[ */
                var google_conversion_id = 950296937;
                var google_custom_params = window.google_tag_params;
                var google_remarketing_only = true;
                /* ]]> */
                </script>
                <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
                </script>
                <noscript>
                <div style="display:inline;">
                <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/950296937/?value=0&amp;guid=ON&amp;script=0"/>
                </div>
                </noscript></div>
    </div>
    <div id="flyout-container"></div>
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"us\/","currentPath":"node\/95056","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"eJxVj0GOBCEIRS9Uxkxm07eZgE2rKQWD2EnffqxadFkbEh7w_6eBWg6FPBYJu-sDe9CM5HCYCW9tmcd7dy0vXAmeQUfFfsEgbMTmGkTSFety-RIxUvf-vVAsglAcFarzfBGMIrGQe8mNpmk9FRjed5Z5Cb48eDy8tfaXfx7sC3AcM597klEw0WNSQXcy8XVwSHvmg3UCDckPy6WffQKdske1lE9kaQb2BsiAeLp_mUhB0K1_ulH1CJ3-Ae6OlH4","theme":"particle","theme_token":null},"ajaxTrustedUrl":[],"vwo":{"id":1002484,"timeout_library":2500,"timeout_setting":2000,"usejquery":"false","testnull":null},"pp_i18n":{"language":"us"},"instantsearch":{"indexName":"content","path":"search"},"user":{"uid":0,"permissionsHash":"950e699712383dfb12102e31b44368231fb90da457b28535a744dde764a08ef5"}}</script>
<script src="/sites/default/files/js/js_0PTCwSWOAiJfplqS7IFUoDMAex3W5Bbe_Jb-l5UBdEg.js?scope=footer&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://geoip-js.com/js/apis/geoip2/v2.1/geoip2.js"></script>
<script src="/sites/default/files/js/js_wkNfGxWc0_xjHnljIpXLLuxGbYfbmVyUkyJqtaY6aW8.js?scope=footer&amp;delta=2&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//munchkin.marketo.net/munchkin.js"></script>
<script src="/sites/default/files/js/js_zEAv3h028JMo53L_-Row7FrtbUFIpsoOM8aflgqba6U.js?scope=footer&amp;delta=4&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="/themes/custom/proofpoint/apps/drupal/../../dist/app-drupal/assets/js/app.js?q=azagEYzR9Pc&amp;v=1"></script>
<script src="/sites/default/files/js/js_zzdzQ-ZTO1G8iCWRlb03McG3cjvNopJ7pLFZ6iL6viI.js?scope=footer&amp;delta=6&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//go.proofpoint.com/js/forms2/js/forms2.min.js"></script>

  </body>
</html>
