<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct</title><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="description" content="The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language."/><link type="text/css" rel="stylesheet" data-href="https://use.typekit.net/zka3qml.css" data-optimized-fonts="true"/><link href="https://www.deepinstinct.com/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets" rel="canonical"/><link href="https://www.deepinstinct.com/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets" hrefLang="x-default" rel="alternate"/><link href="https://www.deepinstinct.com/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets" hrefLang="en" rel="alternate"/><meta property="og:title" content="Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct"/><meta property="og:description" content="The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language."/><meta property="og:url" content="https://www.deepinstinct.com/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets"/><meta property="og:image" content="https://www.deepinstinct.com/image/blt2eeaeef7f7e6bc32/65032de5eb5afe5a044a7c05/blog-image-rusty-flag.jpg"/><meta property="og:site_name" content="Deep Instinct"/><meta property="article:published_time" content="2023-09-14T16:00:00.000Z"/><meta property="article:modified_time" content="2023-09-18T17:00:20.445Z"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@DeepInstinctSec"/><meta name="twitter:title" content="Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct"/><meta name="twitter:description" content="The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language."/><meta name="twitter:image" content="https://www.deepinstinct.com/image/blt2eeaeef7f7e6bc32/65032de5eb5afe5a044a7c05/blog-image-rusty-flag.jpg"/><meta class="swiftype" name="title" data-type="string" content="Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct"/><meta class="swiftype" name="description" data-type="string" content="The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language."/><meta class="swiftype" name="language" data-type="string" content="en"/><meta class="swiftype" name="last_modified" data-type="date" content="2023-09-18T17:00:20.445Z"/><script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@graph":[
    {
      "@type":"WebSite",
      "@id":"https://www.deepinstinct.com/#website",
      "url":"https://www.deepinstinct.com/",
      "name":"Deep Instinct",
      "description":"The Deep Learning AI Cybersecurity Platform, Offering Cyber Threat Prevention Solutions.",
      "inLanguage":"en"
    },
    {
      "@type":"WebPage",
      "@id":"https://www.deepinstinct.com/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets#webpage",
      "url":"https://www.deepinstinct.com/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets",
      "name":"Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct",
      "isPartOf":{"@id":"https://www.deepinstinct.com/#website"},
      "datePublished":"2023-09-14T16:00:00.000Z",
      "dateModified":"2023-09-18T17:00:20.445Z",
      "description":"The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language.",
      "inLanguage":"en"
    }
  ]
}
  </script><script src="https://www.googleoptimize.com/optimize.js?id=OPT-P298HTJ"></script><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><meta name="next-head-count" content="32"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-52PC3MW');
function getUTMParams() {
    let params = new URLSearchParams(window.location.search);
    let utmCampaign = params.get('_ga');
   
    localStorage.setItem('utm_campaign', utmCampaign);
}
</script><link rel="preload" href="/_next/static/css/750ec5d7420478b9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/750ec5d7420478b9.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b3c831d72c60daeb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b3c831d72c60daeb.css" data-n-p=""/><link rel="preload" href="/_next/static/css/ddca67f80ea11511.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ddca67f80ea11511.css"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="000353a0-bc31-4071-a34b-8905de7b1675" data-blockingmode="auto" defer="" data-nscript="beforeInteractive"></script><script defer="" src="/_next/static/chunks/5935-76bf011ee3d88f83.js"></script><script defer="" src="/_next/static/chunks/7029-3230841eb82dea3f.js"></script><script defer="" src="/_next/static/chunks/6839.c8ee40f8e73e0e22.js"></script><script src="/_next/static/chunks/webpack-d130c9295ed0ba68.js" defer=""></script><script src="/_next/static/chunks/framework-314c182fa7e2bf37.js" defer=""></script><script src="/_next/static/chunks/main-c5b7e6d77b82bab5.js" defer=""></script><script src="/_next/static/chunks/pages/_app-88813e0d1ae2e973.js" defer=""></script><script src="/_next/static/chunks/5675-5d8e1c18eb2a06a1.js" defer=""></script><script src="/_next/static/chunks/8882-efb8f68e8ac16c1e.js" defer=""></script><script src="/_next/static/chunks/1053-69c3e67c1a3e9c2f.js" defer=""></script><script src="/_next/static/chunks/512-de9e9b45ad8341f5.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bpid%5D-7f7601d838d136ca.js" defer=""></script><script src="/_next/static/nHrLbpBAijfh0TcvFHHAo/_buildManifest.js" defer=""></script><script src="/_next/static/nHrLbpBAijfh0TcvFHHAo/_ssgManifest.js" defer=""></script><link rel="stylesheet" href="https://use.typekit.net/zka3qml.css"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-52PC3MW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><div class="page"><div class="site-wide-alert bg-blue"><div class="container--full"><div class="container"><div class="site-wide-alert__content text-center py-2"><h2 class="site-wide-alert__title text-m my-1 mr-3 inline-block text-white">Discover how Deep Instinct Prevention for Storage (DPS) protects your NAS storage more effectively than Trellix.</h2><a class="inline-block font-bold uppercase text-cta tracking-widder undefined button_btn--link__RQBF4 undefined button_btn--arrow-yellow__LVTTd text-yellow" href="/deep-instinct-versus-trellix">Learn More<i class="button_btn__icon__m_ZnD"><svg fill="currentColor" width="16" height="10" viewBox="0 0 16 10" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><g stroke="currentColor"><path d="M10 2l4 3-4 3M13 5H0"></path></g><defs><clipPath id="clip0"><path fill="currentColor" d="M0 0h15v9H0z" transform="rotate(-180 8 5)"></path></clipPath></defs></svg></i></a></div></div></div></div><header class="header top-0 z-50 relative header_header__ts5le header_white__g4PkN sticky"><div id="header-inner" class="header-inner pt-4 pb-3 lg:pt-6 lg:pb-5 w-full header_header-inner___UpZ4"><div data-focus-guard="true" tabindex="-1" style="width:1px;height:0px;padding:0;overflow:hidden;position:fixed;top:1px;left:1px"></div><div data-focus-lock-disabled="disabled"><div class="lg:flex lg:justify-between container header_header-wrap__n6kfO"><div class="flex justify-between lg:items-center"><a aria-label="to home page" class="logo_logo-wrap__H2Rxo" href="/"><svg fill="currentColor" width="135" height="67" viewBox="0 0 994 471.4" class="icon inline-block align-middle relative z-50 logo_logo__PUfyf" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M964.49 294.51h1.38v-16.97h6.88v-1.38h-15.14v1.38h6.88v16.97zM31.01 309.46h42.48v161.19H31.01z" fill="currentColor"></path><path d="M226.82 324.53c-10.25-8.72-27.69-13.27-53.1-13.27h-82.3v161.19h42.85V345.77h36c13.65 0 21.24 1.14 25 4.93 4.55 4.55 6.83 12.52 6.83 24.65v97.1h40.58V370c.07-21.2-5.24-36-15.86-45.47Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M521.06 309.46h42.85v161.19h-42.85z" fill="currentColor"></path><path d="M714.6 324.53c-10.25-9.1-26.94-13.27-52-13.27h-81.13v161.19h39.45V345.77h38.3c12.9 0 20.1 1.14 23.89 4.93 4.18 4.18 6.07 11.38 6.07 24.65v97.1h40.21V370c0-22-4.55-36.75-14.79-45.47ZM939.74 277.51h-40.59v33.37h-73.57c-15.17 0-26.55.77-36 3.8a62.75 62.75 0 0 0-25 15.17 74.23 74.23 0 0 0-17.83 27.69 99.23 99.23 0 0 0-6.45 35.64 92.67 92.67 0 0 0 6.45 34.14 75.85 75.85 0 0 0 17.83 27.31c6.45 6.07 14 10.24 24.65 14 9.48 3 21.62 3.8 36.79 3.8h57.65v-34.49h-44.44c-12.13 0-19.34-.38-23.89-1.14s-10.62-2.28-14-4.18c-6.82-4.17-10.24-6.07-13.27-12.89-3.41-6.82-4.93-15.55-4.93-26.17 0-18.58 4.17-31.49 12.13-39.07 8.34-7.58 23.51-8.34 44-8.34h60.31v78.12c0 16.31 3.8 27.69 12.13 36.79 8 8.35 19 12.14 36 12.14H986v-28.07h-15.92c-11 0-19-2.64-23.51-7.58-4.55-5.31-6.83-14.41-6.83-26.92v-64.1h49.69V312h-49.69ZM464.36 272.9l-40.58 24.29v12.92H309.63c-20.48 0-34.51 4.17-43.62 12.13-9.11 8.34-13.66 20.85-13.66 38.31s3.8 29.58 11.38 36c7.59 6.83 22.76 10.24 44.76 10.24h37.93c9.1 0 15.17 1.15 19 3.8 4.17 3 6.45 7.59 6.45 13.65s-2.28 10.24-6.45 13.27c-4.55 3-11.75 3.8-19 3.8h-90.65v30.72h111.51c13.66 0 23.52-4.17 31.49-12.89 8.34-9.49 12.51-21.24 12.51-36 0-15.56-4.55-26.56-14-34.9-8.72-8-22-11.38-40.58-11.38h-39.85c-8.73 0-14-2.65-16.69-4.55-3.79-2.65-5.69-7.58-5.69-13.27 0-6.45 2.28-10.62 6.45-13.27 3.8-2.28 12.52-3.41 25.41-3.41h97.09v81.16c0 16.31 3.79 28.07 12.14 36.79 8 8.34 18.95 12.14 35.64 12.14l38.68-.07v-28.77h-16.31c-11 0-18.59-2.66-23.13-8-4.55-4.93-6.45-14-6.45-26.93v-67.09h45.89v-31.48h-45.52ZM995 277.5c-.92 0-1.46.51-1.91 1.89 0 0-5 14.92-6 14.92s-6-14.92-6-14.92c-.47-1.37-1-1.89-1.92-1.89-2.29 0-2 1.84-2 1.84v17h1.38v-17c0-.46.77-.9 1.29.15s5.17 16.81 7.26 16.81 6.74-15.75 7.27-16.81 1.29-.62 1.29-.15v17H997v-17s.26-1.84-2-1.84Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M503.43 77.18h-80.3v204.67L464 257.23v-21.32h37.12c15.91 0 28.79-1.9 38.26-5.68a58.4 58.4 0 0 0 24.63-18.56 73 73 0 0 0 12.87-23.86 99.81 99.81 0 0 0 4.21-28.81c-.39-25.77-7.21-45.85-20.84-60.25s-32.59-21.57-56.82-21.57ZM526.91 192c-7.2 7.19-19.7 11-36.75 11h-26.52v-92.86h29.93c16.29 0 28 3.41 34.47 10.23 6.82 6.82 9.85 18.56 9.85 34.85.01 17.43-3.78 29.55-10.98 36.78ZM228.4 110.14a46 46 0 0 1 46.21 44.32l.38 4.17a87.25 87.25 0 0 0 6.06 29.17 88 88 0 0 0 17.05 25.38 83.12 83.12 0 0 0 25.38 17 81.12 81.12 0 0 0 31.07 6.06h55.3v-33h-55.3A46 46 0 0 1 308.33 159l-.37-4.17a87.26 87.26 0 0 0-6.07-29.17 87.74 87.74 0 0 0-17-25.38 82.84 82.84 0 0 0-25.39-17 78.54 78.54 0 0 0-31.06-6.44H172v33.33h56.4Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="m318.18 156 .38 4.16a27.28 27.28 0 0 0 2.27 11h89v-31.48h-93.17a118.19 118.19 0 0 1 1.52 16.32ZM264.77 161.28l-.38-4.17c-.37-6.06-1.89-12.12-5.3-17H172v31.44h93.19c-.05-3.83-.42-7.24-.42-10.27ZM315.54 132.49a46.41 46.41 0 0 1 39.4-22h54.91V77.18h-54.92a79.91 79.91 0 0 0-31.06 6.44 74.14 74.14 0 0 0-25 16.67 93.47 93.47 0 0 1 12.88 21.22 95 95 0 0 1 3.79 10.98ZM268.18 181a46.42 46.42 0 0 1-39.4 22h-56.71v32.56h56.7c11.37 0 21.59-1.89 31.06-6.06a74.14 74.14 0 0 0 25-16.67A93.47 93.47 0 0 1 272 191.57a43.64 43.64 0 0 1-3.82-10.57ZM159.48 235.52V1.8h-39.42v75.39H82.93c-15.91 0-28.79 1.89-38.26 5.68a58.32 58.32 0 0 0-24.62 18.56 73.06 73.06 0 0 0-12.88 23.86A99.76 99.76 0 0 0 3 154.08c0 25.38 6.82 45.84 20.45 59.85q20.46 21.6 56.82 21.59h79.21Zm-39.81-32.19H90.12c-16.28 0-27.65-3.4-34.47-10.23s-10.23-18.56-10.23-34.85c0-16.67 3.79-29.17 11-36.37s19.71-11 37.13-11h26.14Z" fill="currentColor" transform="translate(-3 -1.8)"></path></svg></a><button data-autofocus="false" aria-label="open menu" class="bg-yellow items-center flex justify-center rounded-full z-50 lg:hidden button-menu_header__button__ym788"><span class="sr-only block">Open menu</span><span class="sr-only hidden">Close menu</span><span class="icon flex flex-col justify-center button-menu_icon-wrap__y2ev2"><span class="block"></span><span class="block"></span><span class="block"></span></span></button></div><div class="hidden"><nav><ul class="main-menu lg:relative lg:flex justify-end items-baseline main_wrap__wT1ud"></ul></nav><div class="lg:flex justify-end mt-8 pt-4 lg:mt-0 lg:pt-0 border-t border-white lg:border-0 lg:mb-2"><nav class="header-secondary"><ul class="flex lg:block justify-around mb-5 lg:mb-0"><li class="lg:ml-9 inline-block hover:underline"><a class="link--secondary capitalize text-menu-sm font-semibold lg:mb-3" href="/partners">Partners</a></li><li class="lg:ml-9 inline-block hover:underline"><a class="link--secondary capitalize text-menu-sm font-semibold lg:mb-3" target="_blank" rel="noopener" href="https://portal.deepinstinct.com">Login</a></li></ul></nav><nav class="language-switcher lg:ml-9"><ul></ul></nav><div class="relative lg:ml-5 lg:w-5"><div class="hidden absolute w-full -top-1 lg:-right-0"><div class="relative"><form><input type="text" placeholder="Search..." class="st-default-search-input w-56 HeaderSearch_header-search-icon__3pO2z"/></form><div class="absolute w-full z-50 bg-white text-blue rounded py-2 px-5 HeaderSearch_header-search-results__LbnDx">Please enter keyword to search.</div></div></div><button class="mb-3 ml-3 absolute right-5 lg:right-3 top-1 lg:ml-0 lg:top-0 z-10"><svg fill="currentColor" width="16" height="16" viewBox="0 0 16 16" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M15.3169 13.9331L11.5862 10.2025C12.6029 8.95914 13.1027 7.37257 12.9824 5.77099C12.8621 4.16941 12.1307 2.67535 10.9397 1.59784C9.74871 0.520335 8.18911 -0.058176 6.58351 -0.0180311C4.97792 0.0221137 3.44918 0.677843 2.31349 1.81352C1.17781 2.94921 0.522083 4.47795 0.481938 6.08354C0.441793 7.68914 1.0203 9.24874 2.09781 10.4398C3.17532 11.6308 4.66938 12.3621 6.27096 12.4824C7.87254 12.6028 9.45911 12.1029 10.7025 11.0863L14.4331 14.8169C14.551 14.9307 14.7089 14.9937 14.8727 14.9923C15.0366 14.9909 15.1934 14.9252 15.3092 14.8093C15.4251 14.6934 15.4909 14.5366 15.4923 14.3728C15.4937 14.2089 15.4307 14.051 15.3169 13.9331ZM6.74999 11.25C5.76108 11.25 4.79438 10.9568 3.97213 10.4074C3.14989 9.85796 2.50903 9.07706 2.13059 8.16343C1.75215 7.2498 1.65313 6.24447 1.84606 5.27456C2.03899 4.30466 2.51519 3.41374 3.21445 2.71448C3.91371 2.01522 4.80463 1.53902 5.77453 1.34609C6.74444 1.15316 7.74977 1.25218 8.6634 1.63062C9.57703 2.00906 10.3579 2.64992 10.9073 3.47216C11.4567 4.29441 11.75 5.26111 11.75 6.25002C11.7485 7.57564 11.2212 8.84655 10.2839 9.78391C9.34652 10.7213 8.07561 11.2485 6.74999 11.25Z" fill="currentColor"></path></svg></button></div></div></div></div></div><div data-focus-guard="true" tabindex="-1" style="width:1px;height:0px;padding:0;overflow:hidden;position:fixed;top:1px;left:1px"></div></div></header><main role="main"><div class="blog-content BlogContent_blog-content__xmvuQ"><div class="blog-header"><div class="blog-header__image relative"><div class="absolute left-0 top-0 w-full h-4/5 bg-blue"></div><div class="container mx-auto"><div class="blog-header__image max-w-blog w-full mx-auto relative z-1 pt-9 mb-12"><a class="inline-block font-bold uppercase text-cta tracking-widder undefined button_btn--link__RQBF4 undefined button_btn--arrow-left__8dYK2 undefined button_btn--arrow-left-blue__c3n8m px-3.5 py-4 absolute left-0 z-1 uppercase !tracking-widest hover:underline bg-yellow text-blue BlogHeader_blog-header__back__Ju0lb" href="/blog">Back To Blog<i class="button_btn__icon__m_ZnD"><svg fill="currentColor" width="16" height="10" viewBox="0 0 16 10" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><g stroke="currentColor"><path d="M10 2l4 3-4 3M13 5H0"></path></g><defs><clipPath id="clip0"><path fill="currentColor" d="M0 0h15v9H0z" transform="rotate(-180 8 5)"></path></clipPath></defs></svg></i></a><img alt="" title="" aria-hidden="true" loading="lazy" width="930" height="400" decoding="async" data-nimg="1" style="color:transparent;width:100%;height:auto;object-fit:cover" sizes="100vw" srcSet="/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=640&amp;q=100 640w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=768&amp;q=100 768w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=1024&amp;q=100 1024w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=1200&amp;q=100 1200w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=1400&amp;q=100 1400w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=1680&amp;q=100 1680w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=1920&amp;q=100 1920w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=2048&amp;q=100 2048w, /_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=3840&amp;q=100 3840w" src="/_next/image?url=https%3A%2F%2Fwww.deepinstinct.com%2Fimage%2Fblt2eeaeef7f7e6bc32%2F65032de5eb5afe5a044a7c05%2Fblog-image-rusty-flag.jpg&amp;w=3840&amp;q=100"/></div></div></div><div class="blog-header__content container mx-auto mb-12"><div class="max-w-blog w-full mx-auto pb-9 border-b-2 border-grey"><div class="flex justify-between mb-12"><div class="font-sans font-bold text-sm tracking-widest pt-2"><svg fill="currentColor" width="108" height="74" viewBox="0 0 108 74" class="icon inline-block align-middle w-3 h-auto text-blue mr-2 pb-0.5" preserveAspectRatio="xMaxYMax meet" focusable="false"><path fill="currentColor" d="M44.4768 35.7511l.1732 1.9185c.1506 4.5919 1.1008 9.1233 2.8086 13.3936 1.9192 4.3149 4.5894 8.2604 7.8879 11.656 3.3942 3.3069 7.3765 5.9611 11.7452 7.828 4.5389 1.9426 9.4284 2.9494 14.3714 2.9593h26.1259V58.1943H81.4631c-5.5289.025-10.8511-2.0845-14.8415-5.8825-3.9904-3.798-6.3365-8.987-6.5423-14.4702l-.1733-1.9186c-.1506-4.5918-1.1008-9.1232-2.8086-13.3935-1.9249-4.3117-4.5944-8.2564-7.8879-11.656-3.3912-3.31055-7.3743-5.96513-11.7452-7.82796C32.9045 1.18953 28.0212.242402 23.0929.258217L-1363.38.258097V15.3982l1386.4729.0001c5.5289-.0249 10.8511 2.0846 14.8415 5.8826 3.9904 3.798 6.3366 8.987 6.5424 14.4702z"></path><path fill="currentColor" d="M39.9171 37.1447l-.1733-1.9095c.0089-1.7374-.3483-3.4574-1.0487-5.0497l-1402.0751-.0001v14.4795l1403.9991.0001c-.4051-2.4759-.6396-4.9765-.702-7.4841M64.4654 30.0136c0 1.7375.1733 3.3031.1733 4.6968l.1732 1.9095c.0892 2.7814.9371 5.4868 2.4531 7.828h40.324V30.0136H64.4654zM63.0609 25.6608c1.9239-3.0828 4.6085-5.6274 7.7999-7.3932 3.1914-1.7657 6.7841-2.6941 10.4379-2.6973h26.2993V.611107L81.2439.611105c-4.9345-.082349-9.8312.867315-14.3714 2.787275-4.3397 1.74338-8.2745 4.34875-11.5627 7.65612 2.4133 2.9712 4.4158 6.2491 5.9546 9.7466.7914 1.5385 1.3799 3.1719 1.7508 4.8597M22.8829 73.3344c4.9442-.0262 9.8334-1.0323 14.3805-2.9592 4.3379-1.7468 8.272-4.3517 11.5628-7.6561-2.4166-2.969-4.4193-6.2472-5.9546-9.7464-.6902-1.6429-1.278-3.3263-1.76-5.0407-1.9239 3.0827-4.6085 5.6274-7.8 7.3931-3.1914 1.7657-6.784 2.6941-10.4379 2.6973l-1386.2537-.0001v15.312l1386.2629.0001z"></path></svg>SEPTEMBER 14, 2023</div><div class="social-share SocialShare_social-share__4Q7V0"><button aria-label="linkedin" class="react-share__ShareButton social-share__btn linkedin hover:opacity-80" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg fill="currentColor" width="22" height="22" viewBox="0 0 22 22" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M4.58333 2.3913C4.58333 3.73043 3.575 4.78261 2.29167 4.78261C1.00833 4.78261 0 3.73043 0 2.3913C0 1.05217 1.00833 0 2.29167 0C3.575 0 4.58333 1.05217 4.58333 2.3913ZM4.58333 6.69565H0V22H4.58333V6.69565ZM11.9167 6.69565H7.33333V22H11.9167V13.9652C11.9167 9.46957 17.4167 9.08696 17.4167 13.9652V22H22V12.3391C22 4.78261 13.8417 5.06956 11.9167 8.8V6.69565Z" fill="currentColor"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton social-share__btn twitter hover:opacity-80" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg fill="currentColor" width="23" height="19" viewBox="0 0 23 19" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M7.23329 19C15.9129 19 20.6595 11.6908 20.6595 5.35298C20.6595 5.14532 20.6553 4.93872 20.6459 4.73292C21.5673 4.05595 22.3683 3.21094 23 2.24946C22.1545 2.63129 21.2447 2.88841 20.2902 3.00434C21.2643 2.4106 22.0125 1.47093 22.3654 0.35098C21.4535 0.900584 20.4437 1.29996 19.3691 1.51533C18.5077 0.583106 17.2813 0 15.9244 0C13.3182 0 11.2048 2.14816 11.2048 4.79593C11.2048 5.17244 11.2464 5.53831 11.327 5.88956C7.40542 5.68934 3.92781 3.78048 1.60068 0.878514C1.19495 1.58712 0.961353 2.41086 0.961353 3.28911C0.961353 4.95308 1.79452 6.42214 3.06142 7.28178C2.28736 7.25758 1.56014 7.04114 0.924206 6.68165C0.92316 6.7016 0.92316 6.7218 0.92316 6.74281C0.92316 9.06593 2.55 11.0054 4.70893 11.4449C4.31261 11.5547 3.89564 11.6137 3.46505 11.6137C3.16108 11.6137 2.86548 11.5829 2.57799 11.5273C3.17861 13.4327 4.92082 14.8196 6.98635 14.8587C5.37102 16.1454 3.33635 16.9119 1.12563 16.9119C0.745015 16.9119 0.369369 16.8899 0 16.8455C2.08829 18.2058 4.56793 19 7.23329 19Z" fill="currentColor"></path></svg></button><button aria-label="facebook" class="react-share__ShareButton social-share__btn facebook hover:opacity-80" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg fill="currentColor" width="13" height="26" viewBox="0 0 13 26" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M3.25 8.66667H0V13H3.25V26H8.66667V13H12.5667L13 8.66667H8.66667V6.825C8.66667 5.85 8.88333 5.41667 9.85833 5.41667H13V0H8.88333C4.98333 0 3.25 1.73333 3.25 4.98333V8.66667Z" fill="currentColor"></path></svg></button></div></div><h1 class="text-h-md lg:text-h-lg mb-6">Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets</h1><div class="blog-header__author mt-7 md:grid md:gap-4 md:grid-cols-3"><div class="mb-3 md:mb-0"><a class="author-teaser hover:underline AuthorTeaser_author-teaser__cItRk" href="/author/simon-kenin"><span class="author-teaser__image block"><img alt="Simon Kenin" loading="lazy" width="60" height="60" decoding="async" data-nimg="1" class="rounded-full overflow-hidden" style="color:transparent;max-width:100%;height:auto" srcSet="/_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt14ca71678553d70e%2F6305444727ca1b5cd53ebd62%2Fkenin-simon.png&amp;w=64&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt14ca71678553d70e%2F6305444727ca1b5cd53ebd62%2Fkenin-simon.png&amp;w=128&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt14ca71678553d70e%2F6305444727ca1b5cd53ebd62%2Fkenin-simon.png&amp;w=128&amp;q=75"/></span><span class="author-teaser__content block text-m pt-2"><span class="font-semibold block">Simon Kenin</span><span class="block">Threat Intelligence Researcher</span></span></a></div><div class="mb-3 md:mb-0"><a class="author-teaser hover:underline AuthorTeaser_author-teaser__cItRk" href="/author/ron-ben-yizhak"><span class="author-teaser__image block"><img alt="Ron Ben Yizhak" loading="lazy" width="60" height="60" decoding="async" data-nimg="1" class="rounded-full overflow-hidden" style="color:transparent;max-width:100%;height:auto" srcSet="/_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt45ff8834cd7b7189%2F65032ecc20c4f956cf6fdc49%2Fron-ben-yizhak.jpg&amp;w=64&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt45ff8834cd7b7189%2F65032ecc20c4f956cf6fdc49%2Fron-ben-yizhak.jpg&amp;w=128&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt45ff8834cd7b7189%2F65032ecc20c4f956cf6fdc49%2Fron-ben-yizhak.jpg&amp;w=128&amp;q=75"/></span><span class="author-teaser__content block text-m pt-2"><span class="font-semibold block">Ron Ben Yizhak</span><span class="block">Security Researcher</span></span></a></div><div class="mb-3 md:mb-0"><a class="author-teaser hover:underline AuthorTeaser_author-teaser__cItRk" href="/author/mark-vaitzman"><span class="author-teaser__image block"><img alt="Mark Vaitzman" loading="lazy" width="60" height="60" decoding="async" data-nimg="1" class="rounded-full overflow-hidden" style="color:transparent;max-width:100%;height:auto" srcSet="/_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt3df272da1b0692a8%2F64934a24224c074385405c19%2Fmark-vaitzman-v2.jpg&amp;w=64&amp;q=75 1x, /_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt3df272da1b0692a8%2F64934a24224c074385405c19%2Fmark-vaitzman-v2.jpg&amp;w=128&amp;q=75 2x" src="/_next/image?url=https%3A%2F%2Fimages.contentstack.io%2Fv3%2Fassets%2Fblt1ec077b6b53d6b3e%2Fblt3df272da1b0692a8%2F64934a24224c074385405c19%2Fmark-vaitzman-v2.jpg&amp;w=128&amp;q=75"/></span><span class="author-teaser__content block text-m pt-2"><span class="font-semibold block">Mark Vaitzman</span><span class="block">Threat Lab Team Leader</span></span></a></div></div></div></div></div><div class="text-block container--full"><div class="container mx-auto relative mb-6 lg:mb-10 overflow-hidden"><div class="max-w-blog w-full mx-auto TextBlock_text__JUObc"><div class="paragraph-item"><p>Key takeaways:</p><ul><li>The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets</li><li>The operation has at least two different initial access vectors</li><li>The operation is not associated with a known threat actor; the operation was instead named because of their novel malware written in the Rust programming language</li><li>One of the lures used in the operation is a modified document that was used by the Storm-0978 group. This could be a deliberate “false flag”</li></ul><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 1: Attack Flow" src="https://www.deepinstinct.com/image/bltc500e8e577b407b5/65028d348606a8f21cc873d7/fig1-AttackFlowRusty.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 1: Attack Flow</figcaption></figure><p></p><h5>LNK Vector:</h5><p>Deep Instinct Threat Lab observed a malicious LNK file with low detections named “1.KARABAKH.jpg.lnk.”</p><p>The file has a double extension to lure the victim to click an image that is related to a military incident in <a href="https://en.wikipedia.org/wiki/Nagorno-Karabakh" target="_blank" rel="noopener">Nagorno-Karabakh</a>.</p><p>The LNK downloads and executes an MSI installer hosted by DropBox:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Fig 2: LNK arguments" src="https://www.deepinstinct.com/image/blt72f719f046aed339/65028d5ef41335980a8918e4/fig2-LNK-Arguments.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Fig 2: LNK arguments</figcaption></figure><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Fig 3: OSINT information about MSI uploader from Dropbox" src="https://www.deepinstinct.com/image/bltcdb6b050e52030ad/65028d8d7960981affb2dee1/fig3-osint-about-MSI-uploader-Dropbox.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Fig 3: OSINT information about MSI uploader from Dropbox</figcaption></figure><p></p><p>The MSI file drops an implant written in Rust, an xml file for a scheduled task to execute the implant, and a decoy image file:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 4: Decoy image file" src="https://www.deepinstinct.com/image/blt6930cc293aa4cf67/65028dc568d8e111ac604833/fig4-decoy-image.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 4: Decoy image file</figcaption></figure><p></p><p>The image file includes watermarks of the <a href="https://mod.gov.az/en" target="_blank" rel="noopener">symbol</a> of the Azerbaijanian MOD.</p><h5>Office False Flag Vector:</h5><p>Once we identified the LNK campaign the Deep Instinct Threat Lab attempted to identify additional, related files.</p><p>Deep Instinct Threat Lab quickly found another MSI file hosted on DropBox that drops a different variant of the same Rust implant; however, the identification of the initial access vector for this campaign was trickier.</p><p>The DropBox URL was masked with a URL shortener (hxxps://t[.]]ly/8CYQW) and the evidence showed that this URL was invoked via exploitation of Microsoft Equation Editor CVE-2017-11882.</p><p>Deep Instinct Threat Lab identified a file named “Overview_of_UWCs_UkraineInNATO_campaign.docx” that was invoking the request to this shortened URL; however, this filename and its content are known to be associated with a <a href="https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/" target="_blank" rel="noopener">Storm-0978</a> campaign utilizing CVE-2023-36884.</p><p>The identified file even had a comment on VirusTotal that it is related to the Storm-0978 campaign:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 5: VT comment" src="https://www.deepinstinct.com/image/blte13eea8de10129de/65028e2f9e7ba645b2cabbf9/fig5-VT_comments.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 5: VT comment</figcaption></figure><p></p><p>After further investigation it was revealed that this is a different file, not related to the Storm-0978 campaign. The embedded “afchunk.rtf” file has been replaced and CVE-2023-36884 is not used. Instead, CVE-2017-11882 is used to download and install the MSI file.</p><p>This action looks like a deliberate false flag attempt to pin this attack on Storm-0978.</p><p></p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Fig 6: OSINT information about MSI uploader for Office vector" src="https://www.deepinstinct.com/image/blt0ad88745f4ac3c5a/65028e6ba26337c73b96b6af/fig6-osint-information-msi-uploaderd.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Fig 6: OSINT information about MSI uploader for Office vector</figcaption></figure><p></p><p>Even though the initial lure is an Office file, the delivered MSI file also open a decoy file, this time a PDF invoice:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Fig 7: PDF decoy dropped by Office vector" src="https://www.deepinstinct.com/image/bltfb1f227360da24a9/6502909f1c72d8a20e8b120c/fig7-PDF-decoy-droppedPDF.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Fig 7: PDF decoy dropped by Office vector</figcaption></figure><p></p><h5>MSI Analysis:</h5><p>While the initial vectors are different, the execution is the same and it is done by invoking msiexec with URL to DropBox.</p><p>Using a Linux file command or msitools it seems that the MSI files were created by “MSI Wrapper” <a href="https://www.exemsi.com/" target="_blank" rel="noopener">https://www.exemsi.com/</a>, which is often used by threat actors to drop malicious files.</p><p>The MSI installers are dropping and executing the Rust implant along with a decoy file and xml file for scheduled task.</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 8: MSI Metadata" src="https://www.deepinstinct.com/image/blt9a1c244f60882ab6/650291e21709f57bfebf53c1/fig8-msi-metadata.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 8: MSI Metadata</figcaption></figure><p></p><h5>Rust Implant Analysis:</h5><p>Each attack had its unique file names and metadata. One of the file Rust Implants named “WinDefenderHealth.exe” is written in Rust. It is expected to gather information and send it to the attacker server, which is still active at the time of this research.</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img asset_uid="blte9120922332ab068" alt="Figure 9: Metadata of the Rust malware" src="https://www.deepinstinct.com/image/blte9120922332ab068/6502913d3a3d4841e1f6efba/fig9-Rust-defender-healthCheckmetadataVT.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 9: Metadata of the Rust malware</figcaption></figure><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 10: Rust compiler" src="https://www.deepinstinct.com/image/blt9e4e043348197e65/65029386f4133504258918f5/fig10-Rust-malware-compiler.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 10: Rust compiler</figcaption></figure><p></p><p>Rust is becoming more popular among malware authors. Security products are not yet detecting Rust malware accurately, and the reverse engineering process is more complex. The Rust standard library is not familiar to tools like IDA and Ghidra. It results in tagging large portions of the code as unknown, and it is difficult to differentiate the code of the standard library from the code of the malware. To overcome this, the plugin GhidRust was used, but it didn&#x27;t detect the functions of the standard library. In addition, BinDiff was used. A simple Rust binary was compiled and compared against the malware, but very little code was shared. Some open projects for Rust were used in the malware such as Tokio (a runtime for writing reliable, asynchronous, and slim applications with the Rust programming language), hyper (a fast and correct HTTP implementation for Rust) and Serde JSON (a framework for serializing and deserializing Rust data structures efficiently and generically). After that part, we moved on to dynamic analysis.</p><p>Once the file is executed it goes to sleep for 12 minutes. This is a known method to avoid security researchers and sandbox’s easy analysis.</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 11: “Sleep” for 12 minutes" src="https://www.deepinstinct.com/image/blt70fbe3ef467a938d/650293edeb5afe09bc4a7884/fig11-sleep-12-minutes-to-avoid-easy-reversing.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 11: “Sleep” for 12 minutes</figcaption></figure><p></p><p>Then it starts collecting information about the infected machine:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 12: “Collect” information" src="https://www.deepinstinct.com/image/blt43287626dd55bb8c/650321cc796098004ab2e260/fig12-Collect-information.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 12: “Collect” information</figcaption></figure><p></p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 13: Processes collecting information about the PC" src="https://www.deepinstinct.com/image/blt3d7dc9d84a471c52/650295df1c72d858748b1217/fig13-ExfilProccesses.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 13: Processes collecting information about the PC</figcaption></figure><p></p><p>The malware then reads the output of the above executions by redirecting their StdOut to a named pipe. It is notable that the values of StdIn, StdOut, and StdErr match the handles of the processes to the named pipes.</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 14: “Read” the collected information" src="https://www.deepinstinct.com/image/bltbb4b1a45002b971a/650297073a3d489d5af6efd7/fig14-tsdoutNamedPipes.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 14: “Read” the collected information</figcaption></figure><p></p><p>The information is gathered leveraging the following template:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 15: Sample of the collected info before encryption" src="https://www.deepinstinct.com/image/blt6497946a4527cebe/6502975576c8e45ee3b5f637/fig15-collected-info.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 15: Sample of the collected info before encryption</figcaption></figure><p></p><p>The above information is then encrypted and sent to the attacker server using an uncommon, hardcoded port <strong>35667</strong>:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 16: Encrypted information being sent to the server" src="https://www.deepinstinct.com/image/blt474685ab5f698b32/6502977d9bf26140fd6bcd01/fig16-encrypted-information-sent-toC2.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 16: Encrypted information being sent to the server</figcaption></figure><p></p><p>We have built a script to decrypt the information, available in our <a href="https://github.com/deepinstinct/Rusty-Flag-DecryptData" target="_blank" rel="noopener">Git</a>, that the malware is sending.</p><p>All analyzed files above have a low detection rate on VT at the time. There are zero detections on first seen and most of the detections are generic ones.</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 17: Detections of the RUST implant in VT. All detections are generic." src="https://www.deepinstinct.com/image/blt831a4c472c34a419/650297c50433c0d28e25462b/fig17-VT_Detections.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 17: Detections of the RUST implant in VT. All detections are generic.</figcaption></figure><p></p><p>While the other Rust implant still has zero detections:</p><p></p><figure style="margin:auto;text-align:center;width:auto"><img alt="Figure 18: 2nd Rust implant VT detections" src="https://www.deepinstinct.com/image/blt3926fc166ca5accf/65029808a8cf8b810b3e0b3f/fig18-sengforVTDet.png" style="margin:auto;text-align:center;width:autopx"/><figcaption style="text-align:center">Figure 18: 2nd Rust implant VT detections</figcaption></figure><p></p><h5>Conclusion:</h5><p>Deep Instinct Threat Lab could not attribute these attacks to any known threat actor. There is a possibility that these files are part of a red team exercise.</p><p>Regardless of the above statement, the fact that both Rust implants had zero detections when first uploaded to VirusTotal shows that writing malware in esoteric languages can bypass many security solutions.</p><p></p><p></p><h5>MITRE:</h5><p></p><table><thead class="bg-grey"><tr><th><span>Tactic</span></th><th><span>Technique</span></th><th><span>Description</span></th><th><span>Observable</span></th></tr></thead><tbody><tr><td><span>Discovery</span></td><td><span>T1082 System Information Discovery</span></td><td><span>The malware executes systeminfo.exe to gain information about the infected computer</span></td><td><span>systeminfo.exe</span></td></tr><tr><td><span>Discovery</span></td><td><span>T1016 System Network Configuration Discovery</span></td><td><span>Gain detailed information about the network interfaces on the system</span></td><td><span>ipconfig.exe /all</span></td></tr><tr><td><span>Discovery</span></td><td><span>T1033 System Owner/User Discovery</span></td><td><span>Gain user, group, and privileges information for the users</span></td><td><span>Whoami.exe /all</span></td></tr><tr><td><span>Discovery</span></td><td><span>T1087 Account Discovery</span></td><td><span>Gain information about local or domain accounts on a system</span></td><td><span>Net.exe user</span></td></tr><tr><td><span>Discovery</span></td><td><span>T1057 Process Discovery</span></td><td><span>Gain a list of currently running processes, including detailed information about each one</span></td><td><span>Tasklist.exe /v</span></td></tr><tr><td><span>Persistence</span></td><td><span>T1053 Scheduled Task/Job</span></td><td><span>Create a scheduled task using the xml file</span></td><td><span>Schtasks.exe</span></td></tr><tr><td><span>Command and Control</span></td><td><span>T1132 Data Encoding</span></td><td><span>Encrypted communication</span></td><td><span>Encrypted information sent to the C2. A tool for decrypting the information is provided in our Git.</span></td></tr></tbody></table><p></p><h5>IOC:</h5><p>78.135.73[.]140</p><p></p><table><thead class="bg-grey"><tr><th><span>SHA256</span></th><th><span>Description</span></th></tr></thead><tbody><tr><td><span>463183002d558ec6f4f12475cc81ac2cb8da21549959f587e0fb93bd3353e13e</span></td><td><span>Archive containing malicious Office file</span></td></tr><tr><td><span>edc531d255b9ae8ae6902dc676f24e95a478576cad297e08e2bbc0b8fe03e4ce</span></td><td><span>Malicious Office file</span></td></tr><tr><td><span>1546bb5bfc25741434148b77fe51fed7618432a232049b3f6f7210e7fb1f3f0e</span></td><td><span>MSI file from hxxps://t[.]ly/8CYQW</span></td></tr><tr><td><span>387304b50852736281a29d00ed2d8cdb3368d171215f1099b41c404e7e099193</span></td><td><span>SangforUD.EXE Rust implant</span></td></tr><tr><td><span>0742cd9b92661f23f6b294cc29c814de027b5b64b045e4807fc03123b153bcd5</span></td><td><span>Decoy PDF file</span></td></tr><tr><td><span>04725fb5a9e878d68e03176364f3b1057a5c54cca06ec988013a508d6bb29b42</span></td><td><span>Malicious LNK file</span></td></tr><tr><td><span>35f2f7cd7945f43d9692b6ea39d82c4fc9b86709b18164ad295ce66ac20fd8e5</span></td><td><span>MSI file from LNK vector</span></td></tr><tr><td><span>5327308fee51fc6bb95996c4185c4cfcbac580b747d79363c7cf66505f3ff6db</span></td><td><span>WinDefenderHealth.EXE Rust implant</span></td></tr><tr><td><span>e508cafa5c45847ecea35539e836dc9370699d21522839342c3f3573bf550555</span></td><td><span>Decoy JPEG file</span></td></tr></tbody></table><p></p><p></p></div></div></div></div><div class="back-page container mx-auto"><div class="max-w-blog w-full mx-auto pt-9 border-t-2 border-blue"><div class="flex justify-between mb-12 md:mb-16"><a class="inline-block font-bold uppercase text-cta tracking-widder undefined button_btn--link__RQBF4 undefined button_btn--arrow-left__8dYK2 undefined button_btn--arrow-left-blue__c3n8m hover:underline mt-2" href="/blog">Back To Blog<i class="button_btn__icon__m_ZnD"><svg fill="currentColor" width="16" height="10" viewBox="0 0 16 10" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><g stroke="currentColor"><path d="M10 2l4 3-4 3M13 5H0"></path></g><defs><clipPath id="clip0"><path fill="currentColor" d="M0 0h15v9H0z" transform="rotate(-180 8 5)"></path></clipPath></defs></svg></i></a><div class="social-share SocialShare_social-share__4Q7V0"><button aria-label="linkedin" class="react-share__ShareButton social-share__btn linkedin hover:opacity-80" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg fill="currentColor" width="22" height="22" viewBox="0 0 22 22" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M4.58333 2.3913C4.58333 3.73043 3.575 4.78261 2.29167 4.78261C1.00833 4.78261 0 3.73043 0 2.3913C0 1.05217 1.00833 0 2.29167 0C3.575 0 4.58333 1.05217 4.58333 2.3913ZM4.58333 6.69565H0V22H4.58333V6.69565ZM11.9167 6.69565H7.33333V22H11.9167V13.9652C11.9167 9.46957 17.4167 9.08696 17.4167 13.9652V22H22V12.3391C22 4.78261 13.8417 5.06956 11.9167 8.8V6.69565Z" fill="currentColor"></path></svg></button><button aria-label="twitter" class="react-share__ShareButton social-share__btn twitter hover:opacity-80" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg fill="currentColor" width="23" height="19" viewBox="0 0 23 19" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M7.23329 19C15.9129 19 20.6595 11.6908 20.6595 5.35298C20.6595 5.14532 20.6553 4.93872 20.6459 4.73292C21.5673 4.05595 22.3683 3.21094 23 2.24946C22.1545 2.63129 21.2447 2.88841 20.2902 3.00434C21.2643 2.4106 22.0125 1.47093 22.3654 0.35098C21.4535 0.900584 20.4437 1.29996 19.3691 1.51533C18.5077 0.583106 17.2813 0 15.9244 0C13.3182 0 11.2048 2.14816 11.2048 4.79593C11.2048 5.17244 11.2464 5.53831 11.327 5.88956C7.40542 5.68934 3.92781 3.78048 1.60068 0.878514C1.19495 1.58712 0.961353 2.41086 0.961353 3.28911C0.961353 4.95308 1.79452 6.42214 3.06142 7.28178C2.28736 7.25758 1.56014 7.04114 0.924206 6.68165C0.92316 6.7016 0.92316 6.7218 0.92316 6.74281C0.92316 9.06593 2.55 11.0054 4.70893 11.4449C4.31261 11.5547 3.89564 11.6137 3.46505 11.6137C3.16108 11.6137 2.86548 11.5829 2.57799 11.5273C3.17861 13.4327 4.92082 14.8196 6.98635 14.8587C5.37102 16.1454 3.33635 16.9119 1.12563 16.9119C0.745015 16.9119 0.369369 16.8899 0 16.8455C2.08829 18.2058 4.56793 19 7.23329 19Z" fill="currentColor"></path></svg></button><button aria-label="facebook" class="react-share__ShareButton social-share__btn facebook hover:opacity-80" style="background-color:transparent;border:none;padding:0;font:inherit;color:inherit;cursor:pointer"><svg fill="currentColor" width="13" height="26" viewBox="0 0 13 26" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M3.25 8.66667H0V13H3.25V26H8.66667V13H12.5667L13 8.66667H8.66667V6.825C8.66667 5.85 8.88333 5.41667 9.85833 5.41667H13V0H8.88333C4.98333 0 3.25 1.73333 3.25 4.98333V8.66667Z" fill="currentColor"></path></svg></button></div></div></div></div></div></main><footer class="Footer_footer__OQpsI bg-blue-dark text-white py-10 relative z-1"><div class="container--full"><div class="container mx-auto"><div class="footer__top"><div class="footer__menus grid grid-cols-1 gap-0 lg:grid-cols-4 lg:gap-4 2xl:grid-cols-5 mb-4"><div class="footer__logo mb-10"><a class="text-white" href="/"><svg fill="currentColor" width="135" height="67" viewBox="0 0 994 471.4" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M964.49 294.51h1.38v-16.97h6.88v-1.38h-15.14v1.38h6.88v16.97zM31.01 309.46h42.48v161.19H31.01z" fill="currentColor"></path><path d="M226.82 324.53c-10.25-8.72-27.69-13.27-53.1-13.27h-82.3v161.19h42.85V345.77h36c13.65 0 21.24 1.14 25 4.93 4.55 4.55 6.83 12.52 6.83 24.65v97.1h40.58V370c.07-21.2-5.24-36-15.86-45.47Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M521.06 309.46h42.85v161.19h-42.85z" fill="currentColor"></path><path d="M714.6 324.53c-10.25-9.1-26.94-13.27-52-13.27h-81.13v161.19h39.45V345.77h38.3c12.9 0 20.1 1.14 23.89 4.93 4.18 4.18 6.07 11.38 6.07 24.65v97.1h40.21V370c0-22-4.55-36.75-14.79-45.47ZM939.74 277.51h-40.59v33.37h-73.57c-15.17 0-26.55.77-36 3.8a62.75 62.75 0 0 0-25 15.17 74.23 74.23 0 0 0-17.83 27.69 99.23 99.23 0 0 0-6.45 35.64 92.67 92.67 0 0 0 6.45 34.14 75.85 75.85 0 0 0 17.83 27.31c6.45 6.07 14 10.24 24.65 14 9.48 3 21.62 3.8 36.79 3.8h57.65v-34.49h-44.44c-12.13 0-19.34-.38-23.89-1.14s-10.62-2.28-14-4.18c-6.82-4.17-10.24-6.07-13.27-12.89-3.41-6.82-4.93-15.55-4.93-26.17 0-18.58 4.17-31.49 12.13-39.07 8.34-7.58 23.51-8.34 44-8.34h60.31v78.12c0 16.31 3.8 27.69 12.13 36.79 8 8.35 19 12.14 36 12.14H986v-28.07h-15.92c-11 0-19-2.64-23.51-7.58-4.55-5.31-6.83-14.41-6.83-26.92v-64.1h49.69V312h-49.69ZM464.36 272.9l-40.58 24.29v12.92H309.63c-20.48 0-34.51 4.17-43.62 12.13-9.11 8.34-13.66 20.85-13.66 38.31s3.8 29.58 11.38 36c7.59 6.83 22.76 10.24 44.76 10.24h37.93c9.1 0 15.17 1.15 19 3.8 4.17 3 6.45 7.59 6.45 13.65s-2.28 10.24-6.45 13.27c-4.55 3-11.75 3.8-19 3.8h-90.65v30.72h111.51c13.66 0 23.52-4.17 31.49-12.89 8.34-9.49 12.51-21.24 12.51-36 0-15.56-4.55-26.56-14-34.9-8.72-8-22-11.38-40.58-11.38h-39.85c-8.73 0-14-2.65-16.69-4.55-3.79-2.65-5.69-7.58-5.69-13.27 0-6.45 2.28-10.62 6.45-13.27 3.8-2.28 12.52-3.41 25.41-3.41h97.09v81.16c0 16.31 3.79 28.07 12.14 36.79 8 8.34 18.95 12.14 35.64 12.14l38.68-.07v-28.77h-16.31c-11 0-18.59-2.66-23.13-8-4.55-4.93-6.45-14-6.45-26.93v-67.09h45.89v-31.48h-45.52ZM995 277.5c-.92 0-1.46.51-1.91 1.89 0 0-5 14.92-6 14.92s-6-14.92-6-14.92c-.47-1.37-1-1.89-1.92-1.89-2.29 0-2 1.84-2 1.84v17h1.38v-17c0-.46.77-.9 1.29.15s5.17 16.81 7.26 16.81 6.74-15.75 7.27-16.81 1.29-.62 1.29-.15v17H997v-17s.26-1.84-2-1.84Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="M503.43 77.18h-80.3v204.67L464 257.23v-21.32h37.12c15.91 0 28.79-1.9 38.26-5.68a58.4 58.4 0 0 0 24.63-18.56 73 73 0 0 0 12.87-23.86 99.81 99.81 0 0 0 4.21-28.81c-.39-25.77-7.21-45.85-20.84-60.25s-32.59-21.57-56.82-21.57ZM526.91 192c-7.2 7.19-19.7 11-36.75 11h-26.52v-92.86h29.93c16.29 0 28 3.41 34.47 10.23 6.82 6.82 9.85 18.56 9.85 34.85.01 17.43-3.78 29.55-10.98 36.78ZM228.4 110.14a46 46 0 0 1 46.21 44.32l.38 4.17a87.25 87.25 0 0 0 6.06 29.17 88 88 0 0 0 17.05 25.38 83.12 83.12 0 0 0 25.38 17 81.12 81.12 0 0 0 31.07 6.06h55.3v-33h-55.3A46 46 0 0 1 308.33 159l-.37-4.17a87.26 87.26 0 0 0-6.07-29.17 87.74 87.74 0 0 0-17-25.38 82.84 82.84 0 0 0-25.39-17 78.54 78.54 0 0 0-31.06-6.44H172v33.33h56.4Z" fill="currentColor" transform="translate(-3 -1.8)"></path><path d="m318.18 156 .38 4.16a27.28 27.28 0 0 0 2.27 11h89v-31.48h-93.17a118.19 118.19 0 0 1 1.52 16.32ZM264.77 161.28l-.38-4.17c-.37-6.06-1.89-12.12-5.3-17H172v31.44h93.19c-.05-3.83-.42-7.24-.42-10.27ZM315.54 132.49a46.41 46.41 0 0 1 39.4-22h54.91V77.18h-54.92a79.91 79.91 0 0 0-31.06 6.44 74.14 74.14 0 0 0-25 16.67 93.47 93.47 0 0 1 12.88 21.22 95 95 0 0 1 3.79 10.98ZM268.18 181a46.42 46.42 0 0 1-39.4 22h-56.71v32.56h56.7c11.37 0 21.59-1.89 31.06-6.06a74.14 74.14 0 0 0 25-16.67A93.47 93.47 0 0 1 272 191.57a43.64 43.64 0 0 1-3.82-10.57ZM159.48 235.52V1.8h-39.42v75.39H82.93c-15.91 0-28.79 1.89-38.26 5.68a58.32 58.32 0 0 0-24.62 18.56 73.06 73.06 0 0 0-12.88 23.86A99.76 99.76 0 0 0 3 154.08c0 25.38 6.82 45.84 20.45 59.85q20.46 21.6 56.82 21.59h79.21Zm-39.81-32.19H90.12c-16.28 0-27.65-3.4-34.47-10.23s-10.23-18.56-10.23-34.85c0-16.67 3.79-29.17 11-36.37s19.71-11 37.13-11h26.14Z" fill="currentColor" transform="translate(-3 -1.8)"></path></svg></a></div><div class="grid grid-cols-2 md:grid-cols-3 gap-4 lg:col-span-3 2xl:col-span-4 2xl:grid-cols-4"><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__2dwEv">Products</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Prevention Platform" href="/platform">Prevention Platform</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Prevention for Storage" href="/prevention-for-storage">Prevention for Storage</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Prevention for Applications" href="/prevention-for-applications">Prevention for Applications</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Prevention for Endpoints" href="/endpoint-security">Prevention for Endpoints</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="DIANNA - AI Cyber Companion" href="/dianna-ai-cyber-companion">DIANNA - AI Cyber Companion</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Data Security: Powered by Deep Instinct" href="/data-security">Data Security: Powered by Deep Instinct</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Deep Learning: Prevention-First Cybersecurity" href="/why-deep-instinct">Deep Learning: Prevention-First Cybersecurity</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__2dwEv">Why Deep Instinct</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="&gt;99% Threat Accuracy" href="/endpoint-protection-platforms">&gt;99% Threat Accuracy</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Prevent Ransomware" href="/ransomware-protection-solution">Prevent Ransomware</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Prevent Zero-Day Attacks" href="/zero-day-attacks">Prevent Zero-Day Attacks</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__2dwEv">Enhance Existing Cyber Tools</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Extend &amp; Enhance EDR/XDR" href="/endpoint-detection-response">Extend &amp; Enhance EDR/XDR</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="+ Microsoft Defender" href="/vs-microsoft-defender">+ Microsoft Defender</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="+ Tanium" href="/deep-instinct-tanium">+ Tanium</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Legacy AV" href="/deep-instinct-vs-competitors">Legacy AV</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Replace Trellix" href="/deep-instinct-versus-trellix">Replace Trellix</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__2dwEv">Company</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="About Deep Instinct" href="/about-us">About Deep Instinct</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Our Customers" href="/customers">Our Customers</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Newsroom" href="/newsroom">Newsroom</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Careers" href="/careers">Careers</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Contact Us" href="/contact-us">Contact Us</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__2dwEv">Resources</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Asset Library" href="/resources">Asset Library</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Blog" href="/blog">Blog</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Videos" href="/videos">Videos</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Events &amp; Webinars" href="/events-webinars">Events &amp; Webinars</a></li></ul></div></div><div class="footer__menu"><div class="mb-5"><h3 class="text-sm uppercase font-sans tracking-widest font-bold mb-4"><span class="Footer_footer__border-bottom__2dwEv">Quick links</span></h3><ul><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Request Demo" target="_blank" rel="noopener" href="https://info.deepinstinct.com/request-a-demo">Request Demo</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Customer Portal" target="_blank" rel="noopener" href="https://portal.deepinstinct.com/">Customer Portal</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Integrations and Compliance" href="/compliance-certification-evaluation">Integrations and Compliance</a></li><li><a class="text-sm tracking-wide Footer_footer__border-bottom__2dwEv" aria-label="Training" href="/deep-instinct-training">Training</a></li></ul></div></div></div></div></div><div class="footer__bottom border-t border-grey py-2 pt-9 grid grid-cols-1 md:grid-cols-5 xl:grid-cols-4"><div class="footer__copyright order-3 md:col-span-2 md:order-2 xl:col-span-1 xl:order-1 flex items-center"><p class="font-medium text-h-xs tracking-wide-sm">© <!-- -->2024<!-- --> Deep Instinct. All rights reserved.</p></div><div class="footer__more text-left col-span-1 order-2 py-4 md:py-0 md:col-span-3 md:text-right md:order-3 xl:order-2 xl:text-center xl:col-span-2"><ul><li class="block px-0 md:inline-block md:px-5 "><a class="text-sm tracking-wide-sm font-medium Footer_footer__border-bottom__2dwEv" aria-label="Privacy Policy" href="/privacy-policy">Privacy Policy</a></li><li class="block px-0 md:inline-block md:px-5 "><a class="text-sm tracking-wide-sm font-medium Footer_footer__border-bottom__2dwEv" aria-label="Candidate Privacy Policy" href="/candidate-privacy-policy">Candidate Privacy Policy</a></li><li class="block px-0 md:inline-block md:px-5 "><a class="text-sm tracking-wide-sm font-medium Footer_footer__border-bottom__2dwEv" aria-label="Cookie Policy" href="/cookies-policy">Cookie Policy</a></li><li class="block px-0 md:inline-block md:px-5 md:pr-0 xl:pr-5"><a class="text-sm tracking-wide-sm font-medium Footer_footer__border-bottom__2dwEv" aria-label="Terms of use" href="/terms-of-use">Terms of use</a></li></ul></div><div class="footer__social text-center order-1 md:col-span-5 md:order-1 md:mb-4 xl:mb-0 xl:order-3 xl:text-right xl:col-span-1"><ul class="flex justify-center xl:justify-end"><li class="flex items-center h-6"><a href="https://www.youtube.com/channel/UCYerfisJf3hc9QOWmic1G9Q" aria-label="Find us on youtube" class="inline-block px-3 hover:opacity-80 " target="_blank" rel="noopener"><svg fill="currentColor" width="36" height="36" viewBox="0 0 36 36" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path fill-rule="evenodd" clip-rule="evenodd" d="M25.1528 2.27992L25.1528 2.27995L25.1654 2.28091C26.2554 2.36361 26.9066 2.5722 27.3166 2.81315C27.6834 3.02865 27.9742 3.33705 28.2219 3.89044C28.4913 4.49225 28.7004 5.36816 28.8303 6.66641C28.9592 7.95408 29 9.536 29 11.4973C29 13.4583 28.9592 15.049 28.8302 16.3475C28.7 17.6573 28.4903 18.5468 28.2192 19.158C27.9692 19.7216 27.6795 20.0247 27.3266 20.2293C26.9315 20.4585 26.295 20.6559 25.2156 20.7105L25.2072 20.711C20.6373 20.9614 10.4021 20.9617 5.8144 20.7121C4.73649 20.6284 4.09086 20.4209 3.68337 20.1814C3.31663 19.9659 3.02578 19.6575 2.77809 19.1042C2.50873 18.5023 2.29962 17.6264 2.16968 16.3282C2.0408 15.0405 2 13.4586 2 11.4973C2 9.536 2.0408 7.95408 2.16968 6.66641C2.29962 5.36816 2.50873 4.49225 2.77809 3.89044C3.02578 3.33705 3.31663 3.02865 3.68337 2.81315C4.09341 2.5722 4.74456 2.36361 5.83463 2.28091L5.83464 2.28094L5.84716 2.27992C10.3881 1.9067 20.6119 1.9067 25.1528 2.27992ZM0 11.4973C0 19.3957 0.645833 22.3258 5.68333 22.708C10.3333 22.9627 20.6667 22.9627 25.3167 22.708C30.3542 22.4532 31 19.3957 31 11.4973C31 3.59888 30.3542 0.668818 25.3167 0.286636C20.6667 -0.0955454 10.3333 -0.0955454 5.68333 0.286636C0.645833 0.668818 0 3.59888 0 11.4973ZM12.4123 16.2863C11.7503 16.5859 11 16.1018 11 15.3753V8.52019C11 7.79363 11.7503 7.30959 12.4123 7.60913L19.9867 11.0367C20.7703 11.3913 20.7703 12.5042 19.9867 12.8588L12.4123 16.2863Z" fill="currentColor"></path></svg></a></li><li class="flex items-center h-6"><a href="https://www.linkedin.com/company/deep-instinct" aria-label="Find us on linkedin" class="inline-block px-3 hover:opacity-80 " target="_blank" rel="noopener"><svg fill="currentColor" width="36" height="36" viewBox="0 0 36 36" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M4.58333 2.3913C4.58333 3.73043 3.575 4.78261 2.29167 4.78261C1.00833 4.78261 0 3.73043 0 2.3913C0 1.05217 1.00833 0 2.29167 0C3.575 0 4.58333 1.05217 4.58333 2.3913ZM4.58333 6.69565H0V22H4.58333V6.69565ZM11.9167 6.69565H7.33333V22H11.9167V13.9652C11.9167 9.46957 17.4167 9.08696 17.4167 13.9652V22H22V12.3391C22 4.78261 13.8417 5.06956 11.9167 8.8V6.69565Z" fill="currentColor"></path></svg></a></li><li class="flex items-center h-6"><a href="https://twitter.com/DeepInstinctSec" aria-label="Find us on twitter" class="inline-block px-3 hover:opacity-80 " target="_blank" rel="noopener"><svg fill="currentColor" width="36" height="36" viewBox="0 0 36 36" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M7.23329 19C15.9129 19 20.6595 11.6908 20.6595 5.35298C20.6595 5.14532 20.6553 4.93872 20.6459 4.73292C21.5673 4.05595 22.3683 3.21094 23 2.24946C22.1545 2.63129 21.2447 2.88841 20.2902 3.00434C21.2643 2.4106 22.0125 1.47093 22.3654 0.35098C21.4535 0.900584 20.4437 1.29996 19.3691 1.51533C18.5077 0.583106 17.2813 0 15.9244 0C13.3182 0 11.2048 2.14816 11.2048 4.79593C11.2048 5.17244 11.2464 5.53831 11.327 5.88956C7.40542 5.68934 3.92781 3.78048 1.60068 0.878514C1.19495 1.58712 0.961353 2.41086 0.961353 3.28911C0.961353 4.95308 1.79452 6.42214 3.06142 7.28178C2.28736 7.25758 1.56014 7.04114 0.924206 6.68165C0.92316 6.7016 0.92316 6.7218 0.92316 6.74281C0.92316 9.06593 2.55 11.0054 4.70893 11.4449C4.31261 11.5547 3.89564 11.6137 3.46505 11.6137C3.16108 11.6137 2.86548 11.5829 2.57799 11.5273C3.17861 13.4327 4.92082 14.8196 6.98635 14.8587C5.37102 16.1454 3.33635 16.9119 1.12563 16.9119C0.745015 16.9119 0.369369 16.8899 0 16.8455C2.08829 18.2058 4.56793 19 7.23329 19Z" fill="currentColor"></path></svg></a></li><li class="flex items-center h-6"><a href="https://www.facebook.com/DeepInstinctInc" aria-label="Find us on facebook" class="inline-block px-3 hover:opacity-80 xl:pr-0" target="_blank" rel="noopener"><svg fill="currentColor" width="36" height="36" viewBox="0 0 36 36" class="icon inline-block align-middle" preserveAspectRatio="xMaxYMax meet" focusable="false"><path d="M3.25 8.66667H0V13H3.25V26H8.66667V13H12.5667L13 8.66667H8.66667V6.825C8.66667 5.85 8.88333 5.41667 9.85833 5.41667H13V0H8.88333C4.98333 0 3.25 1.73333 3.25 4.98333V8.66667Z" fill="currentColor"></path></svg></a></li></ul></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"blockPost":{"_version":10,"locale":"en-us","uid":"blt4f46a56cbb1a9d36","ACL":{},"_in_progress":false,"author":[{"_content_type_uid":"di_author","_version":5,"locale":"en-us","uid":"blt2ce6e13206a5e142","ACL":{},"_in_progress":false,"author_title":"Threat Intelligence Researcher","bio":"","created_at":"2022-01-25T22:28:35.544Z","created_by":"bltba60fae7b7f3b3d2","image":{"parent_uid":"blt9a4786940a2a3a18","uid":"blt14ca71678553d70e","created_by":"blt0d598b36a82e8d10","updated_by":"blt0d598b36a82e8d10","created_at":"2022-08-23T21:19:03.054Z","updated_at":"2022-08-23T21:19:03.054Z","content_type":"image/png","file_size":"271930","filename":"kenin-simon.png","title":"kenin-simon.png","ACL":{},"_version":1,"is_dir":false,"tags":[],"publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2022-08-23T21:19:20.259Z","user":"blt0d598b36a82e8d10"},"url":"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt14ca71678553d70e/6305444727ca1b5cd53ebd62/kenin-simon.png"},"tags":[],"title":"Simon Kenin","updated_at":"2022-08-23T21:19:12.080Z","updated_by":"blt0d598b36a82e8d10","url":"/simon-kenin","publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2022-08-23T21:19:20.287Z","user":"blt0d598b36a82e8d10"}},{"_content_type_uid":"di_author","_version":4,"locale":"en-us","uid":"blt867fed4cb1df5928","ACL":{},"_in_progress":false,"author_title":"Security Researcher","bio":"","created_at":"2021-09-14T09:13:40.583Z","created_by":"blt1d5768f5c3f56b45","image":{"parent_uid":"blt9a4786940a2a3a18","uid":"blt45ff8834cd7b7189","created_by":"bltc9f76683df0aaacc","updated_by":"bltc9f76683df0aaacc","created_at":"2023-09-14T16:03:24.695Z","updated_at":"2023-09-14T16:03:24.695Z","content_type":"image/jpeg","file_size":"13498","filename":"ron-ben-yizhak.jpg","title":"ron-ben-yizhak.jpg","ACL":{},"_version":1,"is_dir":false,"tags":[],"publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2023-09-14T16:03:33.744Z","user":"bltc9f76683df0aaacc"},"url":"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt45ff8834cd7b7189/65032ecc20c4f956cf6fdc49/ron-ben-yizhak.jpg"},"social_links":[],"tags":[],"title":"Ron Ben Yizhak","updated_at":"2023-09-14T16:03:27.782Z","updated_by":"bltc9f76683df0aaacc","url":"/ron-ben-yizhak","publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2023-09-14T16:03:33.783Z","user":"bltc9f76683df0aaacc"}},{"_content_type_uid":"di_author","_version":3,"locale":"en-us","uid":"blt44fa07e9a7e6b00e","ACL":{},"_in_progress":false,"author_title":"Threat Lab Team Leader","bio":"","created_at":"2022-11-18T16:37:15.334Z","created_by":"bltc9f76683df0aaacc","image":{"parent_uid":"blt9a4786940a2a3a18","uid":"blt3df272da1b0692a8","created_by":"bltc9f76683df0aaacc","updated_by":"bltc9f76683df0aaacc","created_at":"2023-06-21T19:06:12.184Z","updated_at":"2023-06-21T19:06:12.184Z","content_type":"image/jpeg","file_size":"185871","filename":"mark-vaitzman-v2.jpg","title":"mark-vaitzman-v2.jpg","ACL":{},"_version":1,"is_dir":false,"tags":[],"publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2023-06-21T19:06:38.272Z","user":"bltc9f76683df0aaacc"},"url":"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt3df272da1b0692a8/64934a24224c074385405c19/mark-vaitzman-v2.jpg"},"social_links":[],"tags":[],"title":"Mark Vaitzman","updated_at":"2023-06-21T19:06:31.207Z","updated_by":"bltc9f76683df0aaacc","url":"/mark-vaitzman","publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2023-06-21T19:06:38.297Z","user":"bltc9f76683df0aaacc"}}],"created_at":"2023-09-13T21:43:34.637Z","created_by":"bltc9f76683df0aaacc","description":"","di_tags":[],"image":{"src":"https://www.deepinstinct.com/image/blt2eeaeef7f7e6bc32/65032de5eb5afe5a044a7c05/blog-image-rusty-flag.jpg","alt":"","title":"","meta":{"type":"image","uid":"blt2eeaeef7f7e6bc32","locale":"en-us"},"width":930,"height":400},"modular_blocks":[{"richtext_block":{"rich_text_editor":"\u003cp\u003eKey takeaways:\u003c/p\u003e\u003cul\u003e\u003cli\u003eThe Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets\u003c/li\u003e\u003cli\u003eThe operation has at least two different initial access vectors\u003c/li\u003e\u003cli\u003eThe operation is not associated with a known threat actor; the operation was instead named because of their novel malware written in the Rust programming language\u003c/li\u003e\u003cli\u003eOne of the lures used in the operation is a modified document that was used by the Storm-0978 group. This could be a deliberate “false flag”\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 1: Attack Flow\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltc500e8e577b407b5/65028d348606a8f21cc873d7/fig1-AttackFlowRusty.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 1: Attack Flow\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eLNK Vector:\u003c/h5\u003e\u003cp\u003eDeep Instinct Threat Lab observed a malicious LNK file with low detections named “1.KARABAKH.jpg.lnk.”\u003c/p\u003e\u003cp\u003eThe file has a double extension to lure the victim to click an image that is related to a military incident in \u003ca href=\"https://en.wikipedia.org/wiki/Nagorno-Karabakh\" target=\"_blank\"\u003eNagorno-Karabakh\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eThe LNK downloads and executes an MSI installer hosted by DropBox:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 2: LNK arguments\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt72f719f046aed339/65028d5ef41335980a8918e4/fig2-LNK-Arguments.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 2: LNK arguments\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 3: OSINT information about MSI uploader from Dropbox\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltcdb6b050e52030ad/65028d8d7960981affb2dee1/fig3-osint-about-MSI-uploader-Dropbox.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 3: OSINT information about MSI uploader from Dropbox\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe MSI file drops an implant written in Rust, an xml file for a scheduled task to execute the implant, and a decoy image file:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 4: Decoy image file\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt6930cc293aa4cf67/65028dc568d8e111ac604833/fig4-decoy-image.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 4: Decoy image file\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe image file includes watermarks of the \u003ca href=\"https://mod.gov.az/en\" target=\"_blank\"\u003esymbol\u003c/a\u003e of the Azerbaijanian MOD.\u003c/p\u003e\u003ch5\u003eOffice False Flag Vector:\u003c/h5\u003e\u003cp\u003eOnce we identified the LNK campaign the Deep Instinct Threat Lab attempted to identify additional, related files.\u003c/p\u003e\u003cp\u003eDeep Instinct Threat Lab quickly found another MSI file hosted on DropBox that drops a different variant of the same Rust implant; however, the identification of the initial access vector for this campaign was trickier.\u003c/p\u003e\u003cp\u003eThe DropBox URL was masked with a URL shortener (hxxps://t[.]]ly/8CYQW) and the evidence showed that this URL was invoked via exploitation of Microsoft Equation Editor CVE-2017-11882.\u003c/p\u003e\u003cp\u003eDeep Instinct Threat Lab identified a file named “Overview_of_UWCs_UkraineInNATO_campaign.docx” that was invoking the request to this shortened URL; however, this filename and its content are known to be associated with a \u003ca href=\"https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/\" target=\"_blank\"\u003eStorm-0978\u003c/a\u003e campaign utilizing CVE-2023-36884.\u003c/p\u003e\u003cp\u003eThe identified file even had a comment on VirusTotal that it is related to the Storm-0978 campaign:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 5: VT comment\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blte13eea8de10129de/65028e2f9e7ba645b2cabbf9/fig5-VT_comments.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 5: VT comment\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter further investigation it was revealed that this is a different file, not related to the Storm-0978 campaign. The embedded “afchunk.rtf” file has been replaced and CVE-2023-36884 is not used. Instead, CVE-2017-11882 is used to download and install the MSI file.\u003c/p\u003e\u003cp\u003eThis action looks like a deliberate false flag attempt to pin this attack on Storm-0978.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 6: OSINT information about MSI uploader for Office vector\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt0ad88745f4ac3c5a/65028e6ba26337c73b96b6af/fig6-osint-information-msi-uploaderd.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 6: OSINT information about MSI uploader for Office vector\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eEven though the initial lure is an Office file, the delivered MSI file also open a decoy file, this time a PDF invoice:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 7: PDF decoy dropped by Office vector\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltfb1f227360da24a9/6502909f1c72d8a20e8b120c/fig7-PDF-decoy-droppedPDF.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 7: PDF decoy dropped by Office vector\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eMSI Analysis:\u003c/h5\u003e\u003cp\u003eWhile the initial vectors are different, the execution is the same and it is done by invoking msiexec with URL to DropBox.\u003c/p\u003e\u003cp\u003eUsing a Linux file command or msitools it seems that the MSI files were created by “MSI Wrapper” \u003ca href=\"https://www.exemsi.com/\" target=\"_blank\"\u003ehttps://www.exemsi.com/\u003c/a\u003e, which is often used by threat actors to drop malicious files.\u003c/p\u003e\u003cp\u003eThe MSI installers are dropping and executing the Rust implant along with a decoy file and xml file for scheduled task.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 8: MSI Metadata\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt9a1c244f60882ab6/650291e21709f57bfebf53c1/fig8-msi-metadata.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 8: MSI Metadata\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eRust Implant Analysis:\u003c/h5\u003e\u003cp\u003eEach attack had its unique file names and metadata. One of the file Rust Implants named “WinDefenderHealth.exe” is written in Rust. It is expected to gather information and send it to the attacker server, which is still active at the time of this research.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg asset_uid=\"blte9120922332ab068\" alt=\"Figure 9: Metadata of the Rust malware\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blte9120922332ab068/6502913d3a3d4841e1f6efba/fig9-Rust-defender-healthCheckmetadataVT.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 9: Metadata of the Rust malware\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 10: Rust compiler\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt9e4e043348197e65/65029386f4133504258918f5/fig10-Rust-malware-compiler.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 10: Rust compiler\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eRust is becoming more popular among malware authors. Security products are not yet detecting Rust malware accurately, and the reverse engineering process is more complex. The Rust standard library is not familiar to tools like IDA and Ghidra. It results in tagging large portions of the code as unknown, and it is difficult to differentiate the code of the standard library from the code of the malware. To overcome this, the plugin GhidRust was used, but it didn't detect the functions of the standard library. In addition, BinDiff was used. A simple Rust binary was compiled and compared against the malware, but very little code was shared. Some open projects for Rust were used in the malware such as Tokio (a runtime for writing reliable, asynchronous, and slim applications with the Rust programming language), hyper (a fast and correct HTTP implementation for Rust) and Serde JSON (a framework for serializing and deserializing Rust data structures efficiently and generically). After that part, we moved on to dynamic analysis.\u003c/p\u003e\u003cp\u003eOnce the file is executed it goes to sleep for 12 minutes. This is a known method to avoid security researchers and sandbox’s easy analysis.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 11: “Sleep” for 12 minutes\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt70fbe3ef467a938d/650293edeb5afe09bc4a7884/fig11-sleep-12-minutes-to-avoid-easy-reversing.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 11: “Sleep” for 12 minutes\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThen it starts collecting information about the infected machine:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 12: “Collect” information\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt43287626dd55bb8c/650321cc796098004ab2e260/fig12-Collect-information.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 12: “Collect” information\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 13: Processes collecting information about the PC\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt3d7dc9d84a471c52/650295df1c72d858748b1217/fig13-ExfilProccesses.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 13: Processes collecting information about the PC\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe malware then reads the output of the above executions by redirecting their StdOut to a named pipe. It is notable that the values of StdIn, StdOut, and StdErr match the handles of the processes to the named pipes.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 14: “Read” the collected information\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltbb4b1a45002b971a/650297073a3d489d5af6efd7/fig14-tsdoutNamedPipes.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 14: “Read” the collected information\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe information is gathered leveraging the following template:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 15: Sample of the collected info before encryption\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt6497946a4527cebe/6502975576c8e45ee3b5f637/fig15-collected-info.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 15: Sample of the collected info before encryption\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe above information is then encrypted and sent to the attacker server using an uncommon, hardcoded port \u003cstrong\u003e35667\u003c/strong\u003e:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 16: Encrypted information being sent to the server\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt474685ab5f698b32/6502977d9bf26140fd6bcd01/fig16-encrypted-information-sent-toC2.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 16: Encrypted information being sent to the server\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWe have built a script to decrypt the information, available in our \u003ca href=\"https://github.com/deepinstinct/Rusty-Flag-DecryptData\" target=\"_blank\"\u003eGit\u003c/a\u003e, that the malware is sending.\u003c/p\u003e\u003cp\u003eAll analyzed files above have a low detection rate on VT at the time. There are zero detections on first seen and most of the detections are generic ones.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 17: Detections of the RUST implant in VT. All detections are generic.\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt831a4c472c34a419/650297c50433c0d28e25462b/fig17-VT_Detections.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 17: Detections of the RUST implant in VT. All detections are generic.\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWhile the other Rust implant still has zero detections:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 18: 2nd Rust implant VT detections\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt3926fc166ca5accf/65029808a8cf8b810b3e0b3f/fig18-sengforVTDet.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 18: 2nd Rust implant VT detections\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eConclusion:\u003c/h5\u003e\u003cp\u003eDeep Instinct Threat Lab could not attribute these attacks to any known threat actor. There is a possibility that these files are part of a red team exercise.\u003c/p\u003e\u003cp\u003eRegardless of the above statement, the fact that both Rust implants had zero detections when first uploaded to VirusTotal shows that writing malware in esoteric languages can bypass many security solutions.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eMITRE:\u003c/h5\u003e\u003cp\u003e\u003c/p\u003e\u003ctable\u003e\u003cthead class=\"bg-grey\"\u003e\u003ctr\u003e\u003cth\u003e\u003cspan\u003eTactic\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eTechnique\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eDescription\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eObservable\u003c/span\u003e\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1082 System Information Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eThe malware executes systeminfo.exe to gain information about the infected computer\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003esysteminfo.exe\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1016 System Network Configuration Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain detailed information about the network interfaces on the system\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eipconfig.exe /all\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1033 System Owner/User Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain user, group, and privileges information for the users\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eWhoami.exe /all\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1087 Account Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain information about local or domain accounts on a system\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eNet.exe user\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1057 Process Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain a list of currently running processes, including detailed information about each one\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eTasklist.exe /v\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003ePersistence\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1053 Scheduled Task/Job\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eCreate a scheduled task using the xml file\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eSchtasks.exe\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eCommand and Control\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1132 Data Encoding\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eEncrypted communication\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eEncrypted information sent to the C2. A tool for decrypting the information is provided in our Git.\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eIOC:\u003c/h5\u003e\u003cp\u003e78.135.73[.]140\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003ctable\u003e\u003cthead class=\"bg-grey\"\u003e\u003ctr\u003e\u003cth\u003e\u003cspan\u003eSHA256\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eDescription\u003c/span\u003e\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e463183002d558ec6f4f12475cc81ac2cb8da21549959f587e0fb93bd3353e13e\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eArchive containing malicious Office file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eedc531d255b9ae8ae6902dc676f24e95a478576cad297e08e2bbc0b8fe03e4ce\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMalicious Office file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e1546bb5bfc25741434148b77fe51fed7618432a232049b3f6f7210e7fb1f3f0e\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMSI file from hxxps://t[.]ly/8CYQW\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e387304b50852736281a29d00ed2d8cdb3368d171215f1099b41c404e7e099193\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eSangforUD.EXE Rust implant\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e0742cd9b92661f23f6b294cc29c814de027b5b64b045e4807fc03123b153bcd5\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eDecoy PDF file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e04725fb5a9e878d68e03176364f3b1057a5c54cca06ec988013a508d6bb29b42\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMalicious LNK file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e35f2f7cd7945f43d9692b6ea39d82c4fc9b86709b18164ad295ce66ac20fd8e5\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMSI file from LNK vector\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e5327308fee51fc6bb95996c4185c4cfcbac580b747d79363c7cf66505f3ff6db\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eWinDefenderHealth.EXE Rust implant\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003ee508cafa5c45847ecea35539e836dc9370699d21522839342c3f3573bf550555\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eDecoy JPEG file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e","_metadata":{"uid":"cscc4cf62359335fcb"}}}],"publication_date":"2023-09-14T16:00:00.000Z","seo":{"seo_title":"Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct","seo_metakeywords":"","seo_metadescription":"The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language.","image":{"parent_uid":"blt9c31661088dd7a65","uid":"blt2eeaeef7f7e6bc32","created_by":"bltc9f76683df0aaacc","updated_by":"bltc9f76683df0aaacc","created_at":"2023-09-14T15:59:33.563Z","updated_at":"2023-09-14T15:59:33.563Z","content_type":"image/jpeg","file_size":"197028","filename":"blog-image-rusty-flag.jpg","title":"blog-image-rusty-flag.jpg","ACL":{},"_version":1,"is_dir":false,"tags":[],"publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2023-09-14T16:00:40.592Z","user":"bltc9f76683df0aaacc"},"url":"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt2eeaeef7f7e6bc32/65032de5eb5afe5a044a7c05/blog-image-rusty-flag.jpg"},"hide":false},"tags":[],"title":"Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets","updated_at":"2023-09-18T17:00:20.445Z","updated_by":"bltc9f76683df0aaacc","url":"/blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets","publish_details":{"environment":"blt1b1ee2a5b0429c28","locale":"en-us","time":"2023-09-18T17:00:25.566Z","user":"bltc9f76683df0aaacc"},"processed_blocks":[{"name":"richtext_block","content":{"id":"cscc4cf62359335fcb","body":"\u003cp\u003eKey takeaways:\u003c/p\u003e\u003cul\u003e\u003cli\u003eThe Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets\u003c/li\u003e\u003cli\u003eThe operation has at least two different initial access vectors\u003c/li\u003e\u003cli\u003eThe operation is not associated with a known threat actor; the operation was instead named because of their novel malware written in the Rust programming language\u003c/li\u003e\u003cli\u003eOne of the lures used in the operation is a modified document that was used by the Storm-0978 group. This could be a deliberate “false flag”\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 1: Attack Flow\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltc500e8e577b407b5/65028d348606a8f21cc873d7/fig1-AttackFlowRusty.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 1: Attack Flow\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eLNK Vector:\u003c/h5\u003e\u003cp\u003eDeep Instinct Threat Lab observed a malicious LNK file with low detections named “1.KARABAKH.jpg.lnk.”\u003c/p\u003e\u003cp\u003eThe file has a double extension to lure the victim to click an image that is related to a military incident in \u003ca href=\"https://en.wikipedia.org/wiki/Nagorno-Karabakh\" target=\"_blank\"\u003eNagorno-Karabakh\u003c/a\u003e.\u003c/p\u003e\u003cp\u003eThe LNK downloads and executes an MSI installer hosted by DropBox:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 2: LNK arguments\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt72f719f046aed339/65028d5ef41335980a8918e4/fig2-LNK-Arguments.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 2: LNK arguments\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 3: OSINT information about MSI uploader from Dropbox\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltcdb6b050e52030ad/65028d8d7960981affb2dee1/fig3-osint-about-MSI-uploader-Dropbox.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 3: OSINT information about MSI uploader from Dropbox\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe MSI file drops an implant written in Rust, an xml file for a scheduled task to execute the implant, and a decoy image file:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 4: Decoy image file\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt6930cc293aa4cf67/65028dc568d8e111ac604833/fig4-decoy-image.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 4: Decoy image file\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe image file includes watermarks of the \u003ca href=\"https://mod.gov.az/en\" target=\"_blank\"\u003esymbol\u003c/a\u003e of the Azerbaijanian MOD.\u003c/p\u003e\u003ch5\u003eOffice False Flag Vector:\u003c/h5\u003e\u003cp\u003eOnce we identified the LNK campaign the Deep Instinct Threat Lab attempted to identify additional, related files.\u003c/p\u003e\u003cp\u003eDeep Instinct Threat Lab quickly found another MSI file hosted on DropBox that drops a different variant of the same Rust implant; however, the identification of the initial access vector for this campaign was trickier.\u003c/p\u003e\u003cp\u003eThe DropBox URL was masked with a URL shortener (hxxps://t[.]]ly/8CYQW) and the evidence showed that this URL was invoked via exploitation of Microsoft Equation Editor CVE-2017-11882.\u003c/p\u003e\u003cp\u003eDeep Instinct Threat Lab identified a file named “Overview_of_UWCs_UkraineInNATO_campaign.docx” that was invoking the request to this shortened URL; however, this filename and its content are known to be associated with a \u003ca href=\"https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/\" target=\"_blank\"\u003eStorm-0978\u003c/a\u003e campaign utilizing CVE-2023-36884.\u003c/p\u003e\u003cp\u003eThe identified file even had a comment on VirusTotal that it is related to the Storm-0978 campaign:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 5: VT comment\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blte13eea8de10129de/65028e2f9e7ba645b2cabbf9/fig5-VT_comments.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 5: VT comment\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eAfter further investigation it was revealed that this is a different file, not related to the Storm-0978 campaign. The embedded “afchunk.rtf” file has been replaced and CVE-2023-36884 is not used. Instead, CVE-2017-11882 is used to download and install the MSI file.\u003c/p\u003e\u003cp\u003eThis action looks like a deliberate false flag attempt to pin this attack on Storm-0978.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 6: OSINT information about MSI uploader for Office vector\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt0ad88745f4ac3c5a/65028e6ba26337c73b96b6af/fig6-osint-information-msi-uploaderd.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 6: OSINT information about MSI uploader for Office vector\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eEven though the initial lure is an Office file, the delivered MSI file also open a decoy file, this time a PDF invoice:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Fig 7: PDF decoy dropped by Office vector\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltfb1f227360da24a9/6502909f1c72d8a20e8b120c/fig7-PDF-decoy-droppedPDF.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFig 7: PDF decoy dropped by Office vector\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eMSI Analysis:\u003c/h5\u003e\u003cp\u003eWhile the initial vectors are different, the execution is the same and it is done by invoking msiexec with URL to DropBox.\u003c/p\u003e\u003cp\u003eUsing a Linux file command or msitools it seems that the MSI files were created by “MSI Wrapper” \u003ca href=\"https://www.exemsi.com/\" target=\"_blank\"\u003ehttps://www.exemsi.com/\u003c/a\u003e, which is often used by threat actors to drop malicious files.\u003c/p\u003e\u003cp\u003eThe MSI installers are dropping and executing the Rust implant along with a decoy file and xml file for scheduled task.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 8: MSI Metadata\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt9a1c244f60882ab6/650291e21709f57bfebf53c1/fig8-msi-metadata.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 8: MSI Metadata\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eRust Implant Analysis:\u003c/h5\u003e\u003cp\u003eEach attack had its unique file names and metadata. One of the file Rust Implants named “WinDefenderHealth.exe” is written in Rust. It is expected to gather information and send it to the attacker server, which is still active at the time of this research.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg asset_uid=\"blte9120922332ab068\" alt=\"Figure 9: Metadata of the Rust malware\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blte9120922332ab068/6502913d3a3d4841e1f6efba/fig9-Rust-defender-healthCheckmetadataVT.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 9: Metadata of the Rust malware\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 10: Rust compiler\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt9e4e043348197e65/65029386f4133504258918f5/fig10-Rust-malware-compiler.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 10: Rust compiler\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eRust is becoming more popular among malware authors. Security products are not yet detecting Rust malware accurately, and the reverse engineering process is more complex. The Rust standard library is not familiar to tools like IDA and Ghidra. It results in tagging large portions of the code as unknown, and it is difficult to differentiate the code of the standard library from the code of the malware. To overcome this, the plugin GhidRust was used, but it didn't detect the functions of the standard library. In addition, BinDiff was used. A simple Rust binary was compiled and compared against the malware, but very little code was shared. Some open projects for Rust were used in the malware such as Tokio (a runtime for writing reliable, asynchronous, and slim applications with the Rust programming language), hyper (a fast and correct HTTP implementation for Rust) and Serde JSON (a framework for serializing and deserializing Rust data structures efficiently and generically). After that part, we moved on to dynamic analysis.\u003c/p\u003e\u003cp\u003eOnce the file is executed it goes to sleep for 12 minutes. This is a known method to avoid security researchers and sandbox’s easy analysis.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 11: “Sleep” for 12 minutes\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt70fbe3ef467a938d/650293edeb5afe09bc4a7884/fig11-sleep-12-minutes-to-avoid-easy-reversing.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 11: “Sleep” for 12 minutes\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThen it starts collecting information about the infected machine:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 12: “Collect” information\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt43287626dd55bb8c/650321cc796098004ab2e260/fig12-Collect-information.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 12: “Collect” information\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 13: Processes collecting information about the PC\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt3d7dc9d84a471c52/650295df1c72d858748b1217/fig13-ExfilProccesses.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 13: Processes collecting information about the PC\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe malware then reads the output of the above executions by redirecting their StdOut to a named pipe. It is notable that the values of StdIn, StdOut, and StdErr match the handles of the processes to the named pipes.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 14: “Read” the collected information\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/bltbb4b1a45002b971a/650297073a3d489d5af6efd7/fig14-tsdoutNamedPipes.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 14: “Read” the collected information\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe information is gathered leveraging the following template:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 15: Sample of the collected info before encryption\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt6497946a4527cebe/6502975576c8e45ee3b5f637/fig15-collected-info.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 15: Sample of the collected info before encryption\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eThe above information is then encrypted and sent to the attacker server using an uncommon, hardcoded port \u003cstrong\u003e35667\u003c/strong\u003e:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 16: Encrypted information being sent to the server\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt474685ab5f698b32/6502977d9bf26140fd6bcd01/fig16-encrypted-information-sent-toC2.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 16: Encrypted information being sent to the server\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWe have built a script to decrypt the information, available in our \u003ca href=\"https://github.com/deepinstinct/Rusty-Flag-DecryptData\" target=\"_blank\"\u003eGit\u003c/a\u003e, that the malware is sending.\u003c/p\u003e\u003cp\u003eAll analyzed files above have a low detection rate on VT at the time. There are zero detections on first seen and most of the detections are generic ones.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 17: Detections of the RUST implant in VT. All detections are generic.\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt831a4c472c34a419/650297c50433c0d28e25462b/fig17-VT_Detections.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 17: Detections of the RUST implant in VT. All detections are generic.\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003eWhile the other Rust implant still has zero detections:\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cfigure style = \"margin: auto; text-align: center;width: auto;\"\u003e\u003cimg alt=\"Figure 18: 2nd Rust implant VT detections\" src=\"https://images.contentstack.io/v3/assets/blt1ec077b6b53d6b3e/blt3926fc166ca5accf/65029808a8cf8b810b3e0b3f/fig18-sengforVTDet.png\" style=\"margin: auto;text-align: center;width: autopx;\" /\u003e\u003cfigcaption  style = \"text-align: center;\" style=\"text-align: center;\"\u003eFigure 18: 2nd Rust implant VT detections\u003c/figcaption\u003e\u003c/figure\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eConclusion:\u003c/h5\u003e\u003cp\u003eDeep Instinct Threat Lab could not attribute these attacks to any known threat actor. There is a possibility that these files are part of a red team exercise.\u003c/p\u003e\u003cp\u003eRegardless of the above statement, the fact that both Rust implants had zero detections when first uploaded to VirusTotal shows that writing malware in esoteric languages can bypass many security solutions.\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eMITRE:\u003c/h5\u003e\u003cp\u003e\u003c/p\u003e\u003ctable\u003e\u003cthead class=\"bg-grey\"\u003e\u003ctr\u003e\u003cth\u003e\u003cspan\u003eTactic\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eTechnique\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eDescription\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eObservable\u003c/span\u003e\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1082 System Information Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eThe malware executes systeminfo.exe to gain information about the infected computer\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003esysteminfo.exe\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1016 System Network Configuration Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain detailed information about the network interfaces on the system\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eipconfig.exe /all\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1033 System Owner/User Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain user, group, and privileges information for the users\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eWhoami.exe /all\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1087 Account Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain information about local or domain accounts on a system\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eNet.exe user\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eDiscovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1057 Process Discovery\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eGain a list of currently running processes, including detailed information about each one\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eTasklist.exe /v\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003ePersistence\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1053 Scheduled Task/Job\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eCreate a scheduled task using the xml file\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eSchtasks.exe\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eCommand and Control\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eT1132 Data Encoding\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eEncrypted communication\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eEncrypted information sent to the C2. A tool for decrypting the information is provided in our Git.\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003cp\u003e\u003c/p\u003e\u003ch5\u003eIOC:\u003c/h5\u003e\u003cp\u003e78.135.73[.]140\u003c/p\u003e\u003cp\u003e\u003c/p\u003e\u003ctable\u003e\u003cthead class=\"bg-grey\"\u003e\u003ctr\u003e\u003cth\u003e\u003cspan\u003eSHA256\u003c/span\u003e\u003c/th\u003e\u003cth\u003e\u003cspan\u003eDescription\u003c/span\u003e\u003c/th\u003e\u003c/tr\u003e\u003c/thead\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e463183002d558ec6f4f12475cc81ac2cb8da21549959f587e0fb93bd3353e13e\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eArchive containing malicious Office file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003eedc531d255b9ae8ae6902dc676f24e95a478576cad297e08e2bbc0b8fe03e4ce\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMalicious Office file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e1546bb5bfc25741434148b77fe51fed7618432a232049b3f6f7210e7fb1f3f0e\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMSI file from hxxps://t[.]ly/8CYQW\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e387304b50852736281a29d00ed2d8cdb3368d171215f1099b41c404e7e099193\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eSangforUD.EXE Rust implant\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e0742cd9b92661f23f6b294cc29c814de027b5b64b045e4807fc03123b153bcd5\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eDecoy PDF file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e04725fb5a9e878d68e03176364f3b1057a5c54cca06ec988013a508d6bb29b42\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMalicious LNK file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e35f2f7cd7945f43d9692b6ea39d82c4fc9b86709b18164ad295ce66ac20fd8e5\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eMSI file from LNK vector\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003e5327308fee51fc6bb95996c4185c4cfcbac580b747d79363c7cf66505f3ff6db\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eWinDefenderHealth.EXE Rust implant\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003ctr\u003e\u003ctd\u003e\u003cspan\u003ee508cafa5c45847ecea35539e836dc9370699d21522839342c3f3573bf550555\u003c/span\u003e\u003c/td\u003e\u003ctd\u003e\u003cspan\u003eDecoy JPEG file\u003c/span\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003cp\u003e\u003c/p\u003e\u003cp\u003e\u003c/p\u003e"}}]},"preview":false,"headerTheme":{"theme":"white"},"headerMenu":{"main":[{"id":"cs9d6eb1ca84ab5529","text":"Products","column_layout":"75_25","subMenu":[{"menuColumn":{"link":{"title":"EXPLORE THE PREDICTIVE PREVENTION PLATFORM","url":""},"menuItems":[{"title":"Prevention Platform","url":"/platform","id":"cs9fa3612e2431ca92","indent":false,"description":"End-to-end predictive prevention platform built on a deep learning framework that protects storage, applications, and endpoints."},{"title":"Prevention for Storage","url":"/prevention-for-storage","id":"cs131597e8802151fa","indent":false,"description":"Prevent \u003e99% of zero-day exploits, ransomware, and unknown threats in your NAS and cloud storage repositories."},{"title":"Prevention for Applications","url":"/prevention-for-applications","id":"csdde7d7af5d13f027","indent":false,"description":"Proactively prevent malicious files from entering your storage environment through application uploads by customers, employees, and third parties."},{"title":"Prevention for Endpoints","url":"/endpoint-security","id":"cs410b32f532434327","indent":false,"description":"Prevent known and unknown malware, zero-day exploits, ransomware, and script-based attacks before they execute on the endpoint – faster than a blink of an eye."},{"title":"DIANNA - AI Cyber Companion","url":"/dianna-ai-cyber-companion","id":"csb60f3f40b53c2a68","indent":false,"description":"AI cyber companion providing expert-level malware analysis for unknown threats. Simplify investigations, enhance visibility, and solidify a prevention-first strategy."}]}},{"menuColumn":{"link":{"title":"","url":""},"menuItems":[{"title":"Data Security: Powered By Deep Instinct","url":"/data-security","id":"cs6c48a03f36654b19","indent":false,"description":"Leverage advanced predictive prevention technology to protect data across your entire environment."},{"title":"Deep Learning: Prevention-First Cybersecurity","url":"/why-deep-instinct","id":"cs3277355a1c5f7bd6","indent":false,"description":"Deep Instinct is the only deep learning framework in the world built from the ground up for cybersecurity."}]}}]},{"id":"cs0b135af0b713e8bd","text":"Why Deep Instinct","column_layout":"50_50","subMenu":[{"menuColumn":{"link":{"title":"Unparalleled Prevention","url":""},"menuItems":[{"title":"\u003e99% Threat Accuracy","url":"/endpoint-protection-platforms","id":"csfe705dbf0cca06ec","indent":false,"description":"Leverage deep learning to deliver highly accurate threat detection and reduce false positives in a rapidly evolving threat landscape."},{"title":"Prevent Ransomware","url":"/ransomware-protection-solution","id":"csb80c8d530b4ea6b8","indent":false,"description":"Stop threats using real-time classification and prevention techniques to ensure robust and efficient cybersecurity."},{"title":"Prevent Zero-Day Attacks","url":"/zero-day-attacks","id":"cscb35501e2dc2945a","indent":false,"description":"Proactively stop zero-day threats in \u003c20ms with unparalleled accuracy and minimal false positives."}]}},{"menuColumn":{"link":{"title":"Enhance Existing Cyber Tools","url":""},"menuItems":[{"title":"Extend \u0026 Enhance EDR/XDR","url":"/endpoint-detection-response","id":"cs68603a6f9d219103","indent":false,"description":"EDR is not enough — enhance existing cybersecurity tools with advanced, real-time threat prevention using deep learning to produce defense in depth."},{"title":"+ MICROSOFT DEFENDER","url":"/vs-microsoft-defender","id":"csa6d661a8c90401b4","indent":false,"description":"Deep Instinct complements Microsoft Defender with advanced threat prevention to stop threats before they enter your environment."},{"title":"+ TANIUM","url":"/deep-instinct-tanium","id":"csfcc638de3a687e1c","indent":false,"description":"Deep Instinct and Tanium deliver prevention-first endpoint security to reduce risk and boost productivity."},{"title":"LEGACY AV","url":"/deep-instinct-vs-competitors","id":"cs06c3280dfce0c82a","indent":false,"description":"Replace outdated, legacy AV solutions with prevention-first, deep-learning-based protection purpose-built for cybersecurity."},{"title":"REPLACE TRELLIX","url":"/deep-instinct-versus-trellix","id":"cs516d380b56582fc7","indent":false,"description":"Faster and more accurate – Deep Instinct safeguards your data and protects your NAS storage better than Trellix."}]}}]},{"id":"cs9a1685332616ab04","text":"Resources","column_layout":"single","subMenu":[{"menuColumn":{"link":{"title":"","url":""},"menuItems":[{"title":"Asset Library","url":"/resources","id":"cs7a31018d4de08f4e","indent":false,"description":""},{"title":"Threat Research","url":"/cyber-threat-reports","id":"cs12f5fd632003499f","indent":false,"description":""},{"title":"Voice Of SecOps","url":"/voice-of-secops-reports","id":"cs936ea2e4f0c84408","indent":false,"description":""},{"title":"Blog","url":"/blog","id":"cs1c561d1aa853b2a3","indent":false,"description":""},{"title":"Videos","url":"/videos","id":"cs59d61494e24b98d1","indent":false,"description":""},{"title":"Events \u0026 Webinars","url":"/events-webinars","id":"cs252bd6790d094b06","indent":false,"description":""},{"title":"Training","url":"/deep-instinct-training","id":"csf91b0953931eb246","indent":false,"description":""}]}}]},{"id":"csc64757ccf4d2c9c8","text":"Company","column_layout":"single","subMenu":[{"menuColumn":{"link":{"title":"","url":""},"menuItems":[{"title":"About Deep Instinct","url":"/about-us","id":"cs015ea2b646946fb3","indent":false,"description":""},{"title":"Our Customers","url":"/customers","id":"cs856925787b9bb093","indent":false,"description":""},{"title":"Leadership Team","url":"/company/leadership-team","id":"cs19c86badbe85fe86","indent":false,"description":""},{"title":"Board of Directors","url":"/company/board-of-directors","id":"cs42440c18ad998967","indent":false,"description":""},{"title":"Newsroom","url":"/newsroom","id":"cs26c3af4216f35f16","indent":false,"description":""},{"title":"Careers","url":"/careers","id":"cs423626cb5ec6ce5f","indent":false,"description":""},{"title":"Contact Us","url":"/contact-us","id":"cs764c5e9dc04978ad","indent":false,"description":""}]}}]},{"id":"csd58f79895273e8bc","text":"Request Demo","column_layout":"single","url":"https:/info.deepinstinct.com/request-a-demo"}],"secondary":[{"title":"Partners","url":"/partners","id":"sub-0"},{"title":"Login","url":"https://portal.deepinstinct.com","id":"sub-1"}]},"footerMenu":{"sections":[{"title":"Products","links":[{"title":"Prevention Platform","url":"/platform","id":"cs778c0921797e2796","indent":false,"description":""},{"title":"Prevention for Storage","url":"/prevention-for-storage","id":"cs51bfef75d2368389","indent":false,"description":""},{"title":"Prevention for Applications","url":"/prevention-for-applications","id":"csdba3cab8bdda7742","indent":false,"description":""},{"title":"Prevention for Endpoints","url":"/endpoint-security","id":"csa70948fea32fbbf2","indent":false,"description":""},{"title":"DIANNA - AI Cyber Companion","url":"/dianna-ai-cyber-companion","id":"cs816fed13b30b938d","indent":false,"description":""},{"title":"Data Security: Powered by Deep Instinct","url":"/data-security","id":"cs91605ed0a1ddd694","indent":false,"description":""},{"title":"Deep Learning: Prevention-First Cybersecurity","url":"/why-deep-instinct","id":"csdc567797e15923fe","indent":false,"description":""}]},{"title":"Why Deep Instinct","links":[{"title":"\u003e99% Threat Accuracy","url":"/endpoint-protection-platforms","id":"cs63692d7a9c0a28a4","indent":false,"description":""},{"title":"Prevent Ransomware","url":"/ransomware-protection-solution","id":"csccdc950f667cfd87","indent":false,"description":""},{"title":"Prevent Zero-Day Attacks","url":"/zero-day-attacks","id":"cs742e867275ddb106","indent":false,"description":""}]},{"title":"Enhance Existing Cyber Tools","links":[{"title":"Extend \u0026 Enhance EDR/XDR","url":"/endpoint-detection-response","id":"cs5bc994a7a81c036b","indent":false,"description":""},{"title":"+ Microsoft Defender","url":"/vs-microsoft-defender","id":"cs9278f4b9e9ad1680","indent":false,"description":""},{"title":"+ Tanium","url":"/deep-instinct-tanium","id":"cs7bc1106cd2cdf1a1","indent":false,"description":""},{"title":"Legacy AV","url":"/deep-instinct-vs-competitors","id":"cs1380322651d1ca0f","indent":false,"description":""},{"title":"Replace Trellix","url":"/deep-instinct-versus-trellix","id":"cs2941285b6394584d","indent":false,"description":""}]},{"title":"Company","links":[{"title":"About Deep Instinct","url":"/about-us","id":"csc6b43b0e74f8d5b9","indent":false,"description":""},{"title":"Our Customers","url":"/customers","id":"csb2959da90522d746","indent":false,"description":""},{"title":"Newsroom","url":"/newsroom","id":"cs4c0d16a30b844a3a","indent":false,"description":""},{"title":"Careers","url":"/careers","id":"cs0067fb583a95b6f5","indent":false,"description":""},{"title":"Contact Us","url":"/contact-us","id":"cs77bdd8a50eaccb34","indent":false,"description":""}]},{"title":"Resources","links":[{"title":"Asset Library","url":"/resources","id":"cs153459fa2c69b5fa","indent":false,"description":""},{"title":"Blog","url":"/blog","id":"csd71fc821e3188000","indent":false,"description":""},{"title":"Videos","url":"/videos","id":"csb2971784354462d7","indent":false,"description":""},{"title":"Events \u0026 Webinars","url":"/events-webinars","id":"cs2352c64271ced2e4","indent":false,"description":""}]},{"title":"Quick links","links":[{"title":"Request Demo","url":"https://info.deepinstinct.com/request-a-demo","id":"csaa8b34ab12cb5cd8","indent":false,"description":""},{"title":"Customer Portal","url":"https://portal.deepinstinct.com/","id":"cs2f3b3980139db7ea","indent":false,"description":""},{"title":"Integrations and Compliance","url":"/compliance-certification-evaluation","id":"cs700479e71aace5c7","indent":false,"description":""},{"title":"Training","url":"/deep-instinct-training","id":"csb97de0d53ad00587","indent":false,"description":""}]}],"socialLinks":[{"text":"youtube","url":"https://www.youtube.com/channel/UCYerfisJf3hc9QOWmic1G9Q"},{"text":"linkedin","url":"https://www.linkedin.com/company/deep-instinct"},{"text":"twitter","url":"https://twitter.com/DeepInstinctSec"},{"text":"facebook","url":"https://www.facebook.com/DeepInstinctInc"}],"secondaryLinks":[{"text":"Privacy Policy","url":"/privacy-policy"},{"text":"Candidate Privacy Policy","url":"/candidate-privacy-policy"},{"text":"Cookie Policy","url":"/cookies-policy"},{"text":"Terms of use","url":"/terms-of-use"}],"hideFooterMenu":false},"hideHeaderMenu":false,"hideFooterMenu":false,"hideSitewideAlert":false,"disableStickyHeader":false,"pageBackground":false,"siteWideAlert":{"title":"Discover how Deep Instinct Prevention for Storage (DPS) protects your NAS storage more effectively than Trellix.","cta":{"text":"Learn More","url":"/deep-instinct-versus-trellix"}},"meta":{"title":"Operation Rusty Flag – A Malicious Campaign Against Azerbaijanian Targets | Deep Instinct","keywords":"","description":"The Deep Instinct Threat Lab has discovered a new operation against Azerbaijanian targets. The operation is not associated with a known threat actor, and the operation was instead named because of their novel malware written in the Rust programming language.","image":"https://www.deepinstinct.com/image/blt2eeaeef7f7e6bc32/65032de5eb5afe5a044a7c05/blog-image-rusty-flag.jpg","created":"2023-09-14T16:00:00.000Z","updated":"2023-09-18T17:00:20.445Z","hide":false},"url":"blog/operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets","translations":[],"lang":"en"},"__N_SSG":true},"page":"/blog/[pid]","query":{"pid":"operation-rusty-flag-a-malicious-campaign-against-azerbaijanian-targets"},"buildId":"nHrLbpBAijfh0TcvFHHAo","runtimeConfig":{"baseUrl":"https://www.deepinstinct.com","locales":{"en":"en-us","ja":"ja","fr":"fr"},"defaultLocale":"en","contentTypes":{"modularPage":{"name":"di_modular_page","revalidate":600,"sitemap":{"changefreq":"daily","priority":0.5},"prefix":"modular","options":{"include":["modular_blocks.others.components.list_featured_resources.resources","modular_blocks.others.components.list_featured_resources.featured_resources"]}},"author":{"name":"di_author"},"blogPost":{"name":"di_blog_post","revalidate":600,"prefix":"blog","modularUrl":"blog/all","sortings":{"desc":"publication_date"},"author":true,"rss":{"title":"Deep Instinct Blog: Breaking News and Updates","description":"Deep Instinct prevents more advanced threats than any EPP or EDR in the world."},"listingLimit":10,"sitemap":{"changefreq":"monthly","priority":0.5}},"pressRelease":{"name":"di_press_release","prefix":"news","revalidate":60,"author":false,"sortings":{"desc":"publication_date"},"rss":{"title":"Deep Instinct News","description":"Deep Instinct prevents more advanced threats than any EPP or EDR in the world."},"sitemap":{"changefreq":"monthly","priority":0.5},"listingLimit":10},"newsCoverage":{"name":"di_news_coverage","prefix":"news-coverage","modularUrl":"news-coverage","revalidate":900,"sortings":{"desc":"date"},"listingLimit":12},"biosListing":{"name":"di_bios_listing","prefix":"company","revalidate":900},"pdfPage":{"name":"di_pdf_resources","prefix":"pdf","revalidate":600,"sitemap":{"changefreq":"monthly","priority":0.5}},"embedPage":{"name":"di_embed","prefix":"embed","revalidate":600},"videoPage":{"name":"di_video_page","prefix":"video","revalidate":900,"sitemap":{"changefreq":"monthly","priority":0.5}},"jobListing":{"name":"di_job_listing"},"glossaryTerm":{"name":"di_glossary_term","revalidate":1800,"prefix":"glossary","themeColors":"blue","sortings":{"desc":"publication_date"},"sitemap":{"changefreq":"monthly","priority":0.5}},"resource":{"name":"di_resource","sortings":{"desc":"created_at"}}},"revalidationByUrl":{"/blog":60,"/news":60},"menus":{"name":"di_menus","reference":["header_menu.menu_section.menu_columns.menu_column.menu_items.link_reference.reference","footer_menu.menu_section.menu_items.link_reference.reference"],"referenceFields":"url"},"meta":{"title":"The Deep Learning AI Cybersecurity Platform, Offering Cyber Threat Prevention Solutions.","siteName":"Deep Instinct","description":"","twitterSite":"@DeepInstinctSec"},"homePageUrl":"/index","themeColors":{"dark":"dark","blue":"blue","light":"light","white":"white"},"rss":{"limit":10,"authorFallback":"Deep Instinct"}},"isFallback":false,"isExperimentalCompile":false,"dynamicIds":[36839],"gsp":true,"locale":"en","locales":["en","ja","fr"],"defaultLocale":"en","scriptLoader":[]}</script></body></html>