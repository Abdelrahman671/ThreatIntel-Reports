<!DOCTYPE html>
<html lang="en-US" class="no-js no-svg">

	<head>
	    <meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
	    <link rel="profile" href="https://gmpg.org/xfn/11" />
	    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO plugin v23.6 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Yara: In Search Of Regular Expressions - Avast Engineering</title>
	<link rel="canonical" href="https://engineering.avast.io/yara-in-search-of-regular-expressions/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Yara: In Search Of Regular Expressions - Avast Engineering" />
	<meta property="og:description" content="This blog post is based on my paper Pattern Matching in YARA: Improved Aho-Corasick Algorithm and a pull request that I opened on the upstream version of Yara. My main goal is to describe the changes from a more practical point of view and also provide some updates and changes that were made from the [&hellip;]" />
	<meta property="og:url" content="https://engineering.avast.io/yara-in-search-of-regular-expressions/" />
	<meta property="og:site_name" content="Avast Engineering" />
	<meta property="article:published_time" content="2022-06-09T09:18:11+00:00" />
	<meta property="article:modified_time" content="2022-06-09T09:18:13+00:00" />
	<meta property="og:image" content="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-1024x576.jpg" />
	<meta name="author" content="Dominika Regéciová" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Dominika Regéciová" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="7 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://engineering.avast.io/yara-in-search-of-regular-expressions/","url":"https://engineering.avast.io/yara-in-search-of-regular-expressions/","name":"Yara: In Search Of Regular Expressions - Avast Engineering","isPartOf":{"@id":"https://engineering.avast.io/#website"},"primaryImageOfPage":{"@id":"https://engineering.avast.io/yara-in-search-of-regular-expressions/#primaryimage"},"image":{"@id":"https://engineering.avast.io/yara-in-search-of-regular-expressions/#primaryimage"},"thumbnailUrl":"https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-1024x576.jpg","datePublished":"2022-06-09T09:18:11+00:00","dateModified":"2022-06-09T09:18:13+00:00","author":{"@id":"https://engineering.avast.io/#/schema/person/45e75227452a8a0d4535a8de81d73a1a"},"breadcrumb":{"@id":"https://engineering.avast.io/yara-in-search-of-regular-expressions/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://engineering.avast.io/yara-in-search-of-regular-expressions/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://engineering.avast.io/yara-in-search-of-regular-expressions/#primaryimage","url":"https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-scaled.jpg","contentUrl":"https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-scaled.jpg","width":2560,"height":1440,"caption":"Photo taken in Hamburg, Germany"},{"@type":"BreadcrumbList","@id":"https://engineering.avast.io/yara-in-search-of-regular-expressions/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://engineering.avast.io/"},{"@type":"ListItem","position":2,"name":"Yara: In Search Of Regular Expressions"}]},{"@type":"WebSite","@id":"https://engineering.avast.io/#website","url":"https://engineering.avast.io/","name":"Avast Engineering","description":"","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://engineering.avast.io/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Person","@id":"https://engineering.avast.io/#/schema/person/45e75227452a8a0d4535a8de81d73a1a","name":"Dominika Regéciová","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://engineering.avast.io/#/schema/person/image/","url":"https://engineering.avast.io/wp-content/uploads/sites/3/nsl_avatars/24c2fbdb107979e12b90d020dbe00493.jpg","contentUrl":"https://engineering.avast.io/wp-content/uploads/sites/3/nsl_avatars/24c2fbdb107979e12b90d020dbe00493.jpg","caption":"Dominika Regéciová"},"url":"https://engineering.avast.io/author/dominikaregeciova/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//engineering.avast.io' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Avast Engineering &raquo; Feed" href="https://engineering.avast.io/feed/" />
<link rel="alternate" type="application/rss+xml" title="Avast Engineering &raquo; Comments Feed" href="https://engineering.avast.io/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Avast Engineering &raquo; Yara: In Search Of Regular Expressions Comments Feed" href="https://engineering.avast.io/yara-in-search-of-regular-expressions/feed/" />
		<!-- This site uses the Google Analytics by MonsterInsights plugin v9.1.1 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="//www.googletagmanager.com/gtag/js?id=G-NTCG96TNJG"  data-cfasync="false" data-wpfc-render="false" type="text/javascript" async></script>
			<script data-cfasync="false" data-wpfc-render="false" type="text/javascript">
				var mi_version = '9.1.1';
				var mi_track_user = true;
				var mi_no_track_reason = '';
								var MonsterInsightsDefaultLocations = {"page_location":"https:\/\/engineering.avast.io\/yara-in-search-of-regular-expressions\/"};
				if ( typeof MonsterInsightsPrivacyGuardFilter === 'function' ) {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsPrivacyGuardFilter( MonsterInsightsExcludeQuery ) : MonsterInsightsPrivacyGuardFilter( MonsterInsightsDefaultLocations );
				} else {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsExcludeQuery : MonsterInsightsDefaultLocations;
				}

								var disableStrs = [
										'ga-disable-G-NTCG96TNJG',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
						} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
					if ( MonsterInsightsLocations.page_location ) {
						__gtagTracker('set', MonsterInsightsLocations);
					}
										__gtagTracker('config', 'G-NTCG96TNJG', {"forceSSL":"true","link_attribution":"true"} );
															window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
									'referrer' : 'page_referrer',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/engineering.avast.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://engineering.avast.io/wp-includes/css/dist/block-library/style.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='syntax-highlighting-code-block-theme-css' href='https://engineering.avast.io/wp-content/plugins/syntax-highlighting-code-block/vendor/scrivo/highlight-php/styles/default.css?ver=1.5.0' type='text/css' media='all' />
<style id='syntax-highlighting-code-block-inline-css' type='text/css'>
.wp-block-code {
	border: 0;
	padding: 0;
	-webkit-text-size-adjust: 100%;
	text-size-adjust: 100%;
}

.wp-block-code > span {
	display: block;
	overflow: auto;
}

.shcb-language {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	-webkit-clip-path: inset(50%);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal;
	word-break: normal;
}

.hljs {
	box-sizing: border-box;
}

.hljs.shcb-code-table {
	display: table;
	width: 100%;
}

.hljs.shcb-code-table > .shcb-loc {
	color: inherit;
	display: table-row;
	width: 100%;
}

.hljs.shcb-code-table .shcb-loc > span {
	display: table-cell;
}

.wp-block-code code.hljs:not(.shcb-wrap-lines) {
	white-space: pre;
}

.wp-block-code code.hljs.shcb-wrap-lines {
	white-space: pre-wrap;
}

.hljs.shcb-line-numbers {
	border-spacing: 0;
	counter-reset: line;
}

.hljs.shcb-line-numbers > .shcb-loc {
	counter-increment: line;
}

.hljs.shcb-line-numbers .shcb-loc > span {
	padding-left: 0.75em;
}

.hljs.shcb-line-numbers .shcb-loc::before {
	border-right: 1px solid #ddd;
	content: counter(line);
	display: table-cell;
	padding: 0 0.75em;
	text-align: right;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	white-space: nowrap;
	width: 1%;
}

.hljs > mark.shcb-loc { background-color: #ddf6ff; }
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--johannes-acc: #ff7800;--wp--preset--color--johannes-meta: #989da2;--wp--preset--color--johannes-bg: #ffffff;--wp--preset--color--johannes-bg-alt-1: #f2f3f3;--wp--preset--color--johannes-bg-alt-2: #424851;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 12.8px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 40px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--huge: 52px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='johannes-fonts-css' href='https://fonts.googleapis.com/css?family=Muli%3A400%2C900%2C700&#038;ver=1.1.3' type='text/css' media='all' />
<link rel='stylesheet' id='johannes-main-css' href='https://engineering.avast.io/wp-content/themes/johannes/assets/css/min.css?ver=1.1.3' type='text/css' media='all' />
<style id='johannes-main-inline-css' type='text/css'>
body{font-family: 'Muli', Arial, sans-serif;font-weight: 400;color: #424851;background: #ffffff;}.johannes-header{font-family: 'Muli', Arial, sans-serif;font-weight: 700;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.h0,.display-1,.wp-block-cover .wp-block-cover-image-text, .wp-block-cover .wp-block-cover-text, .wp-block-cover h2, .wp-block-cover-image .wp-block-cover-image-text, .wp-block-cover-image .wp-block-cover-text, .wp-block-cover-image h2,.entry-category a,.single-md-content .entry-summary,p.has-drop-cap:not(:focus)::first-letter,.johannes_posts_widget .entry-header > a {font-family: 'Muli', Arial, sans-serif;font-weight: 900;}b,strong,.entry-tags a,.entry-category a,.entry-meta a,.wp-block-tag-cloud a{font-weight: 900; }.entry-content strong{font-weight: bold;}.header-top{background: #424851;color: #989da2;}.header-top nav > ul > li > a,.header-top .johannes-menu-social a{color: #989da2;}.header-top nav > ul > li:hover > a,.header-top nav > ul > li.current-menu-item > a,.header-top .johannes-menu-social li:hover a{color: #ffffff;}.header-middle,.header-mobile{color: #ffffff;background: #261c6a;}.header-middle > .container {height: 130px;}.header-middle a,.johannes-mega-menu .sub-menu li:hover a,.header-mobile a{color: #ffffff;}.header-middle li:hover > a,.header-middle .current-menu-item > a,.header-middle .johannes-mega-menu .sub-menu li a:hover,.header-middle .johannes-site-branding .site-title a:hover,.header-mobile .site-title a,.header-mobile a:hover{color: #ff7800;}.header-middle .johannes-site-branding .site-title a{color: #ffffff;}.header-middle .sub-menu{background: #261c6a;}.johannes-cover-indent .header-middle .johannes-menu>li>a:hover,.johannes-cover-indent .header-middle .johannes-menu-action a:hover{color: #ff7800;}.header-sticky-main{color: #ffffff;background: #261c6a;}.header-sticky-main a,.header-sticky-main .johannes-mega-menu .sub-menu li:hover a,.header-sticky-main .johannes-mega-menu .has-arrows .owl-nav > div{color: #ffffff;}.header-sticky-main li:hover > a,.header-sticky-main .current-menu-item > a,.header-sticky-main .johannes-mega-menu .sub-menu li a:hover,.header-sticky-main .johannes-site-branding .site-title a:hover{color: #ff7800;}.header-sticky-main .johannes-site-branding .site-title a{color: #ffffff;}.header-sticky-main .sub-menu{background: #261c6a;}.header-sticky-contextual{color: #261c6a;background: #ffffff;}.header-sticky-contextual,.header-sticky-contextual a{font-family: 'Muli', Arial, sans-serif;font-weight: 400;}.header-sticky-contextual a{color: #261c6a;}.header-sticky-contextual .meta-comments:after{background: #261c6a;}.header-sticky-contextual .meks_ess a:hover{color: #ff7800;background: transparent;}.header-bottom{color: #424851;background: #ffffff;border-top: 1px solid rgba(66,72,81,0.1);border-bottom: 1px solid rgba(66,72,81,0.1);}.johannes-header-bottom-boxed .header-bottom{background: transparent;border: none;}.johannes-header-bottom-boxed .header-bottom-slots{background: #ffffff;border-top: 1px solid rgba(66,72,81,0.1);border-bottom: 1px solid rgba(66,72,81,0.1);}.header-bottom-slots{height: 70px;}.header-bottom a,.johannes-mega-menu .sub-menu li:hover a,.johannes-mega-menu .has-arrows .owl-nav > div{color: #424851;}.header-bottom li:hover > a,.header-bottom .current-menu-item > a,.header-bottom .johannes-mega-menu .sub-menu li a:hover,.header-bottom .johannes-site-branding .site-title a:hover{color: #f13b3b;}.header-bottom .johannes-site-branding .site-title a{color: #424851;}.header-bottom .sub-menu{background: #ffffff;}.johannes-menu-action .search-form input[type=text]{background: #ffffff;}.johannes-header-multicolor .header-middle .slot-l,.johannes-header-multicolor .header-sticky .header-sticky-main .container > .slot-l,.johannes-header-multicolor .header-mobile .slot-l,.johannes-header-multicolor .slot-l .johannes-site-branding:after{background: #424851;}.johannes-cover-indent .johannes-cover{min-height: 450px;}.page.johannes-cover-indent .johannes-cover{min-height: 250px;}.single.johannes-cover-indent .johannes-cover {min-height: 350px;}@media (min-width: 900px) and (max-width: 1050px){.header-middle > .container {height: 100px;}.header-bottom > .container,.header-bottom-slots {height: 50px;}}.johannes-modal{background: #ffffff;}.johannes-modal .johannes-menu-social li a:hover,.meks_ess a:hover{background: #424851;}.johannes-modal .johannes-menu-social li:hover a{color: #fff;}.johannes-modal .johannes-modal-close{color: #424851;}.johannes-modal .johannes-modal-close:hover{color: #ff7800;}.meks_ess a:hover{color: #ffffff;}h1,h2,h3,h4,h5,h6,.h1,.h2,.h3,.h4,.h5,.h6,.h0,.display-1,.has-large-font-size {color: #424851;}.entry-title a,a{color: #424851;}.johannes-post .entry-title a{color: #424851;}.entry-content a:not([class*=button]),.comment-content a:not([class*=button]){color: #ff7800;}.entry-content a:not([class*=button]):hover,.comment-content a:not([class*=button]):hover{color: #424851;}.entry-title a:hover,a:hover,.entry-meta a,.written-by a,.johannes-overlay .entry-meta a:hover,body .johannes-cover .section-bg+.container .johannes-breadcrumbs a:hover,.johannes-cover .section-bg+.container .section-head a:not(.johannes-button):not(.cat-item):hover,.entry-content .wp-block-tag-cloud a:hover{color: #ff7800;}.entry-meta,.entry-content .entry-tags a,.entry-content .fn a,.comment-metadata,.entry-content .comment-metadata a,.written-by > span,.johannes-breadcrumbs{color: #989da2;}.entry-meta a:hover,.written-by a:hover,.entry-content .wp-block-tag-cloud a{color: #424851;}.entry-meta .meta-item + .meta-item:before{background:#424851;}.entry-format i{color: #ffffff;background:#424851;}.category-pill .entry-category a{background-color: #ff7800;color: #fff;}.category-pill .entry-category a:hover{background-color: #424851;color: #fff;}.johannes-overlay.category-pill .entry-category a:hover,.johannes-cover.category-pill .entry-category a:hover {background-color: #ffffff;color: #424851;}.white-bg-alt-2 .johannes-bg-alt-2 .category-pill .entry-category a:hover,.white-bg-alt-2 .johannes-bg-alt-2 .entry-format i{background-color: #ffffff;color: #424851;}.media-shadow:after{background: rgba(66,72,81,0.1);}.entry-content .entry-tags a:hover,.entry-content .fn a:hover{color: #ff7800;}.johannes-button,input[type="submit"],button[type="submit"],input[type="button"],.wp-block-button .wp-block-button__link,.comment-reply-link,#cancel-comment-reply-link,.johannes-pagination a,.johannes-pagination,.meks-instagram-follow-link .meks-widget-cta,.mks_autor_link_wrap a,.mks_read_more a,.category-pill .entry-category a{font-family: 'Muli', Arial, sans-serif;font-weight: 900;}.johannes-bg-alt-1,.has-arrows .owl-nav,.has-arrows .owl-stage-outer:after,.media-shadow:after {background-color: #f2f3f3}.johannes-bg-alt-2 {background-color: #424851}.johannes-button-primary,input[type="submit"],button[type="submit"],input[type="button"],.johannes-pagination a{box-shadow: 0 10px 15px 0 rgba(255,120,0,0.2);background: #ff7800;color: #fff;}.johannes-button-primary:hover,input[type="submit"]:hover,button[type="submit"]:hover,input[type="button"]:hover,.johannes-pagination a:hover{box-shadow: 0 0 0 0 rgba(255,120,0,0);color: #fff;}.johannes-button.disabled{background: #f2f3f3;color: #424851; box-shadow: none;}.johannes-button-secondary,.comment-reply-link,#cancel-comment-reply-link,.meks-instagram-follow-link .meks-widget-cta,.mks_autor_link_wrap a,.mks_read_more a{box-shadow: inset 0 0px 0px 1px #424851;color: #424851;opacity: .5;}.johannes-button-secondary:hover,.comment-reply-link:hover,#cancel-comment-reply-link:hover,.meks-instagram-follow-link .meks-widget-cta:hover,.mks_autor_link_wrap a:hover,.mks_read_more a:hover{box-shadow: inset 0 0px 0px 1px #ff7800; opacity: 1;color: #ff7800;}.johannes-breadcrumbs a,.johannes-action-close:hover,.single-md-content .entry-summary span,form label .required{color: #ff7800;}.johannes-breadcrumbs a:hover{color: #424851;}.section-title:after{background-color: #ff7800;}hr{background: rgba(66,72,81,0.2);}.wp-block-preformatted,.wp-block-verse,pre,code, kbd, pre, samp, address{background:#f2f3f3;}.entry-content ul li:before,.wp-block-quote:before,.comment-content ul li:before{color: #424851;}.wp-block-quote.is-large:before{color: #ff7800;}.wp-block-table.is-style-stripes tr:nth-child(odd){background:#f2f3f3;}.wp-block-table.is-style-regular tbody tr,.entry-content table tr,.comment-content table tr{border-bottom: 1px solid rgba(66,72,81,0.1);}.wp-block-pullquote:not(.is-style-solid-color){color: #424851;border-color: #ff7800;}.wp-block-pullquote{background: #ff7800;color: #ffffff;}.johannes-sidebar-none .wp-block-pullquote.alignfull.is-style-solid-color{box-shadow: -526px 0 0 #ff7800, -1052px 0 0 #ff7800,526px 0 0 #ff7800, 1052px 0 0 #ff7800;}.wp-block-button .wp-block-button__link{background: #ff7800;color: #fff;box-shadow: 0 10px 15px 0 rgba(255,120,0,0.2);}.wp-block-button .wp-block-button__link:hover{box-shadow: 0 0 0 0 rgba(255,120,0,0);}.is-style-outline .wp-block-button__link {background: 0 0;color:#ff7800;border: 2px solid currentcolor;}.entry-content .is-style-solid-color a:not([class*=button]){color:#ffffff;}.entry-content .is-style-solid-color a:not([class*=button]):hover{color:#424851;}input[type=color], input[type=date], input[type=datetime-local], input[type=datetime], input[type=email], input[type=month], input[type=number], input[type=password], input[type=range], input[type=search], input[type=tel], input[type=text], input[type=time], input[type=url], input[type=week], select, textarea{border: 1px solid rgba(66,72,81,0.3);}body .johannes-wrapper .meks_ess{border-color: rgba(66,72,81,0.1); }.widget_eu_cookie_law_widget #eu-cookie-law input, .widget_eu_cookie_law_widget #eu-cookie-law input:focus, .widget_eu_cookie_law_widget #eu-cookie-law input:hover{background: #ff7800;color: #fff;}.double-bounce1, .double-bounce2{background-color: #ff7800;}.johannes-pagination .page-numbers.current,.paginated-post-wrapper span{background: #f2f3f3;color: #424851;}.widget li{color: rgba(66,72,81,0.8);}.widget_calendar #today a{color: #fff;}.widget_calendar #today a{background: #ff7800;}.tagcloud a{border-color: rgba(66,72,81,0.5);color: rgba(66,72,81,0.8);}.tagcloud a:hover{color: #ff7800;border-color: #ff7800;}.rssSummary,.widget p{color: #424851;}.johannes-bg-alt-1 .count,.johannes-bg-alt-1 li a,.johannes-bg-alt-1 .johannes-accordion-nav{background-color: #f2f3f3;}.johannes-bg-alt-2 .count,.johannes-bg-alt-2 li a,.johannes-bg-alt-2 .johannes-accordion-nav,.johannes-bg-alt-2 .cat-item .count, .johannes-bg-alt-2 .rss-date, .widget .johannes-bg-alt-2 .post-date, .widget .johannes-bg-alt-2 cite{background-color: #424851;color: #FFF;}.white-bg-alt-1 .widget .johannes-bg-alt-1 select option,.white-bg-alt-2 .widget .johannes-bg-alt-2 select option{background: #424851;}.widget .johannes-bg-alt-2 li a:hover{color: #ff7800;}.widget_categories .johannes-bg-alt-1 ul li .dots:before,.widget_archive .johannes-bg-alt-1 ul li .dots:before{color: #424851;}.widget_categories .johannes-bg-alt-2 ul li .dots:before,.widget_archive .johannes-bg-alt-2 ul li .dots:before{color: #FFF;}.search-alt input[type=search], .search-alt input[type=text], .widget_search input[type=search], .widget_search input[type=text],.mc-field-group input[type=email], .mc-field-group input[type=text]{border-bottom: 1px solid rgba(66,72,81,0.2);}.johannes-sidebar-hidden{background: #ffffff;}.johannes-footer{background: #261c6a;color: #ffffff;}.johannes-footer a,.johannes-footer .widget-title{color: #ffffff;}.johannes-footer a:hover{color: #ff7800;}.johannes-footer-widgets + .johannes-copyright{border-top: 1px solid rgba(255,255,255,0.1);}.johannes-footer .widget .count,.johannes-footer .widget_categories li a,.johannes-footer .widget_archive li a,.johannes-footer .widget .johannes-accordion-nav{background-color: #261c6a;}.footer-divider{border-top: 1px solid rgba(255,255,255,0.1);}.johannes-footer .rssSummary,.johannes-footer .widget p{color: #ffffff;}.johannes-empty-message{background: #f2f3f3;}.error404 .h0{color: #ff7800;}.johannes-goto-top,.johannes-goto-top:hover{background: #424851;color: #ffffff;}.johannes-ellipsis div{background: #ff7800;}.white-bg-alt-2 .johannes-bg-alt-2 .section-subnav .johannes-button-secondary:hover{color: #ff7800;}.section-subnav a{color: #424851;}.johannes-cover .section-subnav a{color: #fff;}.section-subnav a:hover{color: #ff7800;}@media(min-width: 600px){.size-johannes-fa-a{ height: 450px !important;}.size-johannes-single-3{ height: 450px !important;}.size-johannes-single-4{ height: 540px !important;}.size-johannes-page-3{ height: 360px !important;}.size-johannes-page-4{ height: 405px !important;}.size-johannes-wa-3{ height: 450px !important;}.size-johannes-wa-4{ height: 540px !important;}.size-johannes-archive-2{ height: 360px !important;}.size-johannes-archive-3{ height: 405px !important;}}@media(min-width: 900px){.size-johannes-a{ height: 484px !important;}.size-johannes-b{ height: 491px !important;}.size-johannes-c{ height: 304px !important;}.size-johannes-d{ height: 194px !important;}.size-johannes-e{ height: 304px !important;}.size-johannes-f{ height: 214px !important;}.size-johannes-fa-a{ height: 500px !important;}.size-johannes-fa-b{ height: 635px !important;}.size-johannes-fa-c{ height: 540px !important;}.size-johannes-fa-d{ height: 344px !important;}.size-johannes-fa-e{ height: 442px !important;}.size-johannes-single-1{ height: 484px !important;}.size-johannes-single-2{ height: 484px !important;}.size-johannes-single-3{ height: 500px !important;}.size-johannes-single-4{ height: 600px !important;}.size-johannes-single-5{ height: 442px !important;}.size-johannes-page-1{ height: 484px !important;}.size-johannes-page-2{ height: 484px !important;}.size-johannes-page-3{ height: 400px !important;}.size-johannes-page-4{ height: 450px !important;}.size-johannes-wa-1{ height: 442px !important;}.size-johannes-wa-2{ height: 540px !important;}.size-johannes-wa-3{ height: 500px !important;}.size-johannes-wa-4{ height: 600px !important;}.size-johannes-archive-2{ height: 400px !important;}.size-johannes-archive-3{ height: 450px !important;}}@media(min-width: 900px){.has-small-font-size{ font-size: 1.3rem;}.has-normal-font-size{ font-size: 1.6rem;}.has-large-font-size{ font-size: 4.0rem;}.has-huge-font-size{ font-size: 5.2rem;}}.has-johannes-acc-background-color{ background-color: #ff7800;}.has-johannes-acc-color{ color: #ff7800;}.has-johannes-meta-background-color{ background-color: #989da2;}.has-johannes-meta-color{ color: #989da2;}.has-johannes-bg-background-color{ background-color: #ffffff;}.has-johannes-bg-color{ color: #ffffff;}.has-johannes-bg-alt-1-background-color{ background-color: #f2f3f3;}.has-johannes-bg-alt-1-color{ color: #f2f3f3;}.has-johannes-bg-alt-2-background-color{ background-color: #424851;}.has-johannes-bg-alt-2-color{ color: #424851;}body{font-size:1.6rem;}.johannes-header{font-size:1.4rem;}.display-1{font-size:3rem;}h1, .h1{font-size:2.6rem;}h2, .h2{font-size:2.4rem;}h3, .h3{font-size:2.2rem;}h4, .h4,.wp-block-cover .wp-block-cover-image-text,.wp-block-cover .wp-block-cover-text,.wp-block-cover h2,.wp-block-cover-image .wp-block-cover-image-text,.wp-block-cover-image .wp-block-cover-text,.wp-block-cover-image h2{font-size:2rem;}h5, .h5{font-size:1.8rem;}h6, .h6{font-size:1.6rem;}.entry-meta{font-size:1.2rem;}.section-title {font-size:2.4rem;}.widget-title{font-size:2.0rem;}.mks_author_widget h3{font-size:2.2rem;}.widget,.johannes-breadcrumbs{font-size:1.4rem;}.wp-block-quote.is-large p, .wp-block-quote.is-style-large p{font-size:2.2rem;}.johannes-site-branding .site-title.logo-img-none{font-size: 2.6rem;}.johannes-cover-indent .johannes-cover{margin-top: -70px;}.johannes-menu-social li a:after, .menu-social-container li a:after{font-size:1.6rem;}.johannes-modal .johannes-menu-social li>a:after,.johannes-menu-action .jf{font-size:2.4rem;}.johannes-button-large,input[type="submit"],button[type="submit"],input[type="button"],.johannes-pagination a,.page-numbers.current,.johannes-button-medium,.meks-instagram-follow-link .meks-widget-cta,.mks_autor_link_wrap a,.mks_read_more a,.wp-block-button .wp-block-button__link{font-size:1.3rem;}.johannes-button-small,.comment-reply-link,#cancel-comment-reply-link{font-size:1.2rem;}.category-pill .entry-category a,.category-pill-small .entry-category a{font-size:1.1rem;}@media (min-width: 600px){ .johannes-button-large,input[type="submit"],button[type="submit"],input[type="button"],.johannes-pagination a,.page-numbers.current,.wp-block-button .wp-block-button__link{font-size:1.4rem;}.category-pill .entry-category a{font-size:1.4rem;}.category-pill-small .entry-category a{font-size:1.1rem;}}@media (max-width: 374px){.johannes-overlay .h1,.johannes-overlay .h2,.johannes-overlay .h3,.johannes-overlay .h4,.johannes-overlay .h5{font-size: 2.2rem;}}@media (max-width: 600px){ .johannes-layout-fa-d .h5{font-size: 2.4rem;}.johannes-layout-f.category-pill .entry-category a{background-color: transparent;color: #ff7800;}.johannes-layout-c .h3,.johannes-layout-d .h5{font-size: 2.4rem;}.johannes-layout-f .h3{font-size: 1.8rem;}}@media (min-width: 600px) and (max-width: 1050px){ .johannes-layout-fa-c .h2{font-size:3.6rem;}.johannes-layout-fa-d .h5{font-size:2.4rem;}.johannes-layout-fa-e .display-1,.section-head-alt .display-1{font-size:4.8rem;}}@media (max-width: 1050px){ body.single-post .single-md-content{max-width: 668px;width: 100%;}body.page .single-md-content.col-lg-6,body.page .single-md-content.col-lg-6{flex: 0 0 100%}body.page .single-md-content{max-width: 570px;width: 100%;}}@media (min-width: 600px) and (max-width: 900px){ .display-1{font-size:4.6rem;}h1, .h1{font-size:4rem;}h2, .h2,.johannes-layout-fa-e .display-1,.section-head-alt .display-1{font-size:3.2rem;}h3, .h3,.johannes-layout-fa-c .h2,.johannes-layout-fa-d .h5,.johannes-layout-d .h5,.johannes-layout-e .h2{font-size:2.8rem;}h4, .h4,.wp-block-cover .wp-block-cover-image-text,.wp-block-cover .wp-block-cover-text,.wp-block-cover h2,.wp-block-cover-image .wp-block-cover-image-text,.wp-block-cover-image .wp-block-cover-text,.wp-block-cover-image h2{font-size:2.4rem;}h5, .h5{font-size:2rem;}h6, .h6{font-size:1.8rem;}.section-title {font-size:3.2rem;}.johannes-section.wa-layout .display-1{font-size: 3rem;}.johannes-layout-f .h3{font-size: 3.2rem}.johannes-site-branding .site-title.logo-img-none{font-size: 3rem;}}@media (min-width: 900px){ body{font-size:1.6rem;}.johannes-header{font-size:1.4rem;}.display-1{font-size:5.2rem;}h1, .h1 {font-size:4.8rem;}h2, .h2 {font-size:4.0rem;}h3, .h3 {font-size:3.6rem;}h4, .h4,.wp-block-cover .wp-block-cover-image-text,.wp-block-cover .wp-block-cover-text,.wp-block-cover h2,.wp-block-cover-image .wp-block-cover-image-text,.wp-block-cover-image .wp-block-cover-text,.wp-block-cover-image h2 {font-size:3.2rem;}h5, .h5 {font-size:2.8rem;}h6, .h6 {font-size:2.4rem;}.widget-title{font-size:2.0rem;}.section-title{font-size:4.0rem;}.wp-block-quote.is-large p, .wp-block-quote.is-style-large p{font-size:2.6rem;}.johannes-section-instagram .h2{font-size: 3rem;}.johannes-site-branding .site-title.logo-img-none{font-size: 4rem;}.entry-meta{font-size:1.4rem;}.johannes-cover-indent .johannes-cover {margin-top: -130px;}.johannes-cover-indent .johannes-cover .section-head{top: 32.5px;}}.section-description .search-alt input[type=text],.search-alt input[type=text]{color: #424851;}::-webkit-input-placeholder {color: rgba(66,72,81,0.5);}::-moz-placeholder {color: rgba(66,72,81,0.5);}:-ms-input-placeholder {color: rgba(66,72,81,0.5);}:-moz-placeholder{color: rgba(66,72,81,0.5);}.section-description .search-alt input[type=text]::-webkit-input-placeholder {color: #424851;}.section-description .search-alt input[type=text]::-moz-placeholder {color: #424851;}.section-description .search-alt input[type=text]:-ms-input-placeholder {color: #424851;}.section-description .search-alt input[type=text]:-moz-placeholder{color: #424851;}.section-description .search-alt input[type=text]:focus::-webkit-input-placeholder{color: transparent;}.section-description .search-alt input[type=text]:focus::-moz-placeholder {color: transparent;}.section-description .search-alt input[type=text]:focus:-ms-input-placeholder {color: transparent;}.section-description .search-alt input[type=text]:focus:-moz-placeholder{color: transparent;}
</style>
<link rel='stylesheet' id='meks_ess-main-css' href='https://engineering.avast.io/wp-content/plugins/meks-easy-social-share/assets/css/main.css?ver=1.3' type='text/css' media='all' />
<script type="text/javascript">
            window._nslDOMReady = function (callback) {
                if ( document.readyState === "complete" || document.readyState === "interactive" ) {
                    callback();
                } else {
                    document.addEventListener( "DOMContentLoaded", callback );
                }
            };
            </script><script type="text/javascript" src="https://engineering.avast.io/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend-gtag.min.js?ver=9.1.1" id="monsterinsights-frontend-script-js" async="async" data-wp-strategy="async"></script>
<script data-cfasync="false" data-wpfc-render="false" type="text/javascript" id='monsterinsights-frontend-script-js-extra'>/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/engineering.avast.io","hash_tracking":"false","v4_id":"G-NTCG96TNJG"};/* ]]> */
</script>
<script type="text/javascript" src="https://engineering.avast.io/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://engineering.avast.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://engineering.avast.io/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://engineering.avast.io/wp-json/wp/v2/posts/956" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://engineering.avast.io/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel='shortlink' href='https://engineering.avast.io/?p=956' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://engineering.avast.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fengineering.avast.io%2Fyara-in-search-of-regular-expressions%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://engineering.avast.io/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fengineering.avast.io%2Fyara-in-search-of-regular-expressions%2F&#038;format=xml" />
<meta name="generator" content="Redux 4.4.18" /><link rel="icon" href="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/cropped-Asset-1-32x32.png" sizes="32x32" />
<link rel="icon" href="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/cropped-Asset-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/cropped-Asset-1-180x180.png" />
<meta name="msapplication-TileImage" content="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/cropped-Asset-1-270x270.png" />
<style type="text/css">div.nsl-container[data-align="left"] {
    text-align: left;
}

div.nsl-container[data-align="center"] {
    text-align: center;
}

div.nsl-container[data-align="right"] {
    text-align: right;
}


div.nsl-container div.nsl-container-buttons a[data-plugin="nsl"] {
    text-decoration: none;
    box-shadow: none;
    border: 0;
}

div.nsl-container .nsl-container-buttons {
    display: flex;
    padding: 5px 0;
}

div.nsl-container.nsl-container-block .nsl-container-buttons {
    display: inline-grid;
    grid-template-columns: minmax(145px, auto);
}

div.nsl-container-block-fullwidth .nsl-container-buttons {
    flex-flow: column;
    align-items: center;
}

div.nsl-container-block-fullwidth .nsl-container-buttons a,
div.nsl-container-block .nsl-container-buttons a {
    flex: 1 1 auto;
    display: block;
    margin: 5px 0;
    width: 100%;
}

div.nsl-container-inline {
    margin: -5px;
    text-align: left;
}

div.nsl-container-inline .nsl-container-buttons {
    justify-content: center;
    flex-wrap: wrap;
}

div.nsl-container-inline .nsl-container-buttons a {
    margin: 5px;
    display: inline-block;
}

div.nsl-container-grid .nsl-container-buttons {
    flex-flow: row;
    align-items: center;
    flex-wrap: wrap;
}

div.nsl-container-grid .nsl-container-buttons a {
    flex: 1 1 auto;
    display: block;
    margin: 5px;
    max-width: 280px;
    width: 100%;
}

@media only screen and (min-width: 650px) {
    div.nsl-container-grid .nsl-container-buttons a {
        width: auto;
    }
}

div.nsl-container .nsl-button {
    cursor: pointer;
    vertical-align: top;
    border-radius: 4px;
}

div.nsl-container .nsl-button-default {
    color: #fff;
    display: flex;
}

div.nsl-container .nsl-button-icon {
    display: inline-block;
}

div.nsl-container .nsl-button-svg-container {
    flex: 0 0 auto;
    padding: 8px;
    display: flex;
    align-items: center;
}

div.nsl-container svg {
    height: 24px;
    width: 24px;
    vertical-align: top;
}

div.nsl-container .nsl-button-default div.nsl-button-label-container {
    margin: 0 24px 0 12px;
    padding: 10px 0;
    font-family: Helvetica, Arial, sans-serif;
    font-size: 16px;
    line-height: 20px;
    letter-spacing: .25px;
    overflow: hidden;
    text-align: center;
    text-overflow: clip;
    white-space: nowrap;
    flex: 1 1 auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-transform: none;
    display: inline-block;
}

div.nsl-container .nsl-button-google[data-skin="dark"] .nsl-button-svg-container {
    margin: 1px;
    padding: 7px;
    border-radius: 3px;
    background: #fff;
}

div.nsl-container .nsl-button-google[data-skin="light"] {
    border-radius: 1px;
    box-shadow: 0 1px 5px 0 rgba(0, 0, 0, .25);
    color: RGBA(0, 0, 0, 0.54);
}

div.nsl-container .nsl-button-apple .nsl-button-svg-container {
    padding: 0 6px;
}

div.nsl-container .nsl-button-apple .nsl-button-svg-container svg {
    height: 40px;
    width: auto;
}

div.nsl-container .nsl-button-apple[data-skin="light"] {
    color: #000;
    box-shadow: 0 0 0 1px #000;
}

div.nsl-container .nsl-button-facebook[data-skin="white"] {
    color: #000;
    box-shadow: inset 0 0 0 1px #000;
}

div.nsl-container .nsl-button-facebook[data-skin="light"] {
    color: #1877F2;
    box-shadow: inset 0 0 0 1px #1877F2;
}

div.nsl-container .nsl-button-spotify[data-skin="white"] {
    color: #191414;
    box-shadow: inset 0 0 0 1px #191414;
}

div.nsl-container .nsl-button-apple div.nsl-button-label-container {
    font-size: 17px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

div.nsl-container .nsl-button-slack div.nsl-button-label-container {
    font-size: 17px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

div.nsl-container .nsl-button-slack[data-skin="light"] {
    color: #000000;
    box-shadow: inset 0 0 0 1px #DDDDDD;
}

div.nsl-container .nsl-button-tiktok[data-skin="light"] {
    color: #161823;
    box-shadow: 0 0 0 1px rgba(22, 24, 35, 0.12);
}


div.nsl-container .nsl-button-kakao {
    color: rgba(0, 0, 0, 0.85);
}

.nsl-clear {
    clear: both;
}

.nsl-container {
    clear: both;
}

.nsl-disabled-provider .nsl-button {
    filter: grayscale(1);
    opacity: 0.8;
}

/*Button align start*/

div.nsl-container-inline[data-align="left"] .nsl-container-buttons {
    justify-content: flex-start;
}

div.nsl-container-inline[data-align="center"] .nsl-container-buttons {
    justify-content: center;
}

div.nsl-container-inline[data-align="right"] .nsl-container-buttons {
    justify-content: flex-end;
}


div.nsl-container-grid[data-align="left"] .nsl-container-buttons {
    justify-content: flex-start;
}

div.nsl-container-grid[data-align="center"] .nsl-container-buttons {
    justify-content: center;
}

div.nsl-container-grid[data-align="right"] .nsl-container-buttons {
    justify-content: flex-end;
}

div.nsl-container-grid[data-align="space-around"] .nsl-container-buttons {
    justify-content: space-around;
}

div.nsl-container-grid[data-align="space-between"] .nsl-container-buttons {
    justify-content: space-between;
}

/* Button align end*/

/* Redirect */

#nsl-redirect-overlay {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: fixed;
    z-index: 1000000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(1px);
    background-color: RGBA(0, 0, 0, .32);;
}

#nsl-redirect-overlay-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: white;
    padding: 30px;
    border-radius: 10px;
}

#nsl-redirect-overlay-spinner {
    content: '';
    display: block;
    margin: 20px;
    border: 9px solid RGBA(0, 0, 0, .6);
    border-top: 9px solid #fff;
    border-radius: 50%;
    box-shadow: inset 0 0 0 1px RGBA(0, 0, 0, .6), 0 0 0 1px RGBA(0, 0, 0, .6);
    width: 40px;
    height: 40px;
    animation: nsl-loader-spin 2s linear infinite;
}

@keyframes nsl-loader-spin {
    0% {
        transform: rotate(0deg)
    }
    to {
        transform: rotate(360deg)
    }
}

#nsl-redirect-overlay-title {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    font-size: 18px;
    font-weight: bold;
    color: #3C434A;
}

#nsl-redirect-overlay-text {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
    text-align: center;
    font-size: 14px;
    color: #3C434A;
}

/* Redirect END*/</style><style type="text/css">/* Notice fallback */
#nsl-notices-fallback {
    position: fixed;
    right: 10px;
    top: 10px;
    z-index: 10000;
}

.admin-bar #nsl-notices-fallback {
    top: 42px;
}

#nsl-notices-fallback > div {
    position: relative;
    background: #fff;
    border-left: 4px solid #fff;
    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, .1);
    margin: 5px 15px 2px;
    padding: 1px 20px;
}

#nsl-notices-fallback > div.error {
    display: block;
    border-left-color: #dc3232;
}

#nsl-notices-fallback > div.updated {
    display: block;
    border-left-color: #46b450;
}

#nsl-notices-fallback p {
    margin: .5em 0;
    padding: 2px;
}

#nsl-notices-fallback > div:after {
    position: absolute;
    right: 5px;
    top: 5px;
    content: '\00d7';
    display: block;
    height: 16px;
    width: 16px;
    line-height: 16px;
    text-align: center;
    font-size: 20px;
    cursor: pointer;
}</style><style id="kirki-inline-styles"></style>	</head>

	<body class="post-template-default single single-post postid-956 single-format-standard wp-embed-responsive johannes-sidebar-none johannes-header-window white-bg-alt-2 johannes-hamburger-hidden johannes-footer-margin johannes-v_1_1_3">

	<div class="johannes-wrapper">

	    		    
		    <header class="johannes-header johannes-header-main d-none d-lg-block">
		    	
		        <div class="header-middle header-layout-1">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="slot-l">
            <div class="johannes-site-branding">
    <span class="site-title h1 "><a href="https://engineering.avast.io/" rel="home"><picture class="johannes-logo"><source media="(min-width: 1050px)" srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png"><source srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png"><img src="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png" alt="Avast Engineering"></picture></a></span></div>        </div>
        <div class="slot-r">
        	            	    <nav class="menu-main-menu-container"><ul id="menu-main-menu" class="johannes-menu johannes-menu-primary"><li id="menu-item-165" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-165"><a href="https://avast.io">Avast.io</a></li>
<li id="menu-item-166" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-166"><a href="https://avast.com/careers">Careers</a></li>
</ul></nav>                                    	             		<ul class="johannes-menu-action johannes-modal-opener johannes-search">
	<li><a href="javascript:void(0);"><span class="header-el-label">Search</span><i class="jf jf-search"></i></a></li>
</ul>
<div class="johannes-modal search-alt">
	<a href="javascript:void(0);" class="johannes-modal-close"><i class="jf jf-close"></i></a>
	<div class="johannes-content">
	<div class="section-head">
        <h5 class="section-title h2">Search</h5>
	</div>	

	<form class="search-form" action="https://engineering.avast.io/" method="get">
	<input name="s" type="text" value="" placeholder="Type here to search..." />
		<button type="submit">Search</button>
</form>
	</div>
</div>
             	             		<ul class="johannes-menu-action johannes-hamburger">
	<li><a href="javascript:void(0);"><span class="header-el-label">Menu</span><i class="jf jf-menu"></i></a></li>
</ul>
             	                    </div>
    </div>
</div>		    	
		    </header>

		    <div class="johannes-header header-mobile d-lg-none">
    <div class="container d-flex justify-content-between align-items-center">
        <div class="slot-l">
            <div class="johannes-site-branding">
    <span class="site-title h1 "><a href="https://engineering.avast.io/" rel="home"><picture class="johannes-logo"><source media="(min-width: 1050px)" srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png"><source srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png"><img src="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png" alt="Avast Engineering"></picture></a></span></div>        </div>
        <div class="slot-r">
            <ul class="johannes-menu-action johannes-hamburger">
	<li><a href="javascript:void(0);"><span class="header-el-label">Menu</span><i class="jf jf-menu"></i></a></li>
</ul>
        </div>
    </div>
</div>
		    
	    

            
<div class="johannes-section johannes-section-margin-alt">
    <div class="container">
            </div>
</div>

<div class="johannes-section">
    <div class="container">
        <div class="section-content row justify-content-center">
            
            
            <div class="col-12 col-lg-7 single-md-content col-md-special johannes-order-1 ">
                 
                <article id="post-956" class="post-956 post type-post status-publish format-standard hentry category-open-source category-yara tag-performance tag-yara">

                    
                        <div class="category-pill section-head-alt single-layout-2">
                            <div class="entry-header">
                                                                                                <h1 class="entry-title">Yara: In Search Of Regular Expressions</h1>                                                                <div class="entry-meta">
                                    <span class="meta-item meta-date"><span class="updated">June 9, 2022</span></span><span class="meta-item meta-author"><span class="vcard author">by <a href="https://engineering.avast.io/author/dominikaregeciova/">Dominika Regéciová</a></span></span>                                </div>
                                                            </div>
                        </div>

                    
                    
                    
                    <div class="entry-content entry-single clearfix">
                        <div class="wp-block-image">
<figure class="aligncenter size-large"><img fetchpriority="high" decoding="async" width="1024" height="576" src="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-1024x576.jpg" alt="" class="wp-image-962" srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-1024x576.jpg 1024w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-300x169.jpg 300w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-768x432.jpg 768w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-1536x864.jpg 1536w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-2048x1152.jpg 2048w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-540x304.jpg 540w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-344x194.jpg 344w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1134722319-1128x635.jpg 1128w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>


<div class="wp-block-group"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">
<p>This blog post is based on my paper<a href="https://ieeexplore.ieee.org/document/9410267"> Pattern Matching in YARA: Improved Aho-Corasick Algorithm</a> and a <a href="https://github.com/VirusTotal/yara/pull/1379">pull request</a> that I opened on the upstream version of <a href="https://github.com/VirusTotal/yara">Yara</a>. My main goal is to describe the changes from a more practical point of view and also provide some updates and changes that were made from the initial design proposed in the paper, as practical usage in Avast showed me some additional ways how to improve my code.</p>



<p>Yara is a pattern-matching tool used mainly to classify and identify malware. It is also an open-source project with an active community that is working hard to improve this tool every day. In this post, I will not go into details about what Yara is and how it can be used. For that, you can visit my <a href="https://regeciova-dominika.medium.com/botconf-2022-388109f43387">personal blog</a> or watch my talk about Yara at <a href="https://www.youtube.com/watch?v=3G0xaJkIE3M&amp;list=PL8fFmUArVzKjQ6A1OLfN2nnob4KIz8aT-&amp;index=10">Botconf 2022</a>.</p>
</div></div>



<h3 class="wp-block-heading"><strong>Motivation</strong></h3>



<p>We use the Yara tool every day at Avast, and it is a critical help for our malware analysts. We are also trying to give back and bring as many of our improvements and additional features into the upstream version as possible.</p>



<p>The changes I am proposing address a problem faced by our analysts: the “<em>slowing down</em>” warning, where rules can generate the following:</p>


<pre class="wp-block-code" aria-describedby="shcb-language-1" data-shcb-language-name="Bash" data-shcb-language-slug="bash"><span><code class="hljs language-bash shcb-wrap-lines">$ ./yara yara_rule.yar -r /directory
warning: rule “can_be_slow” <span class="hljs-keyword">in</span> ../yara_rule.yar(4): string “<span class="hljs-variable">$slow_string</span>” may slow down scanning</code></span><small class="shcb-language" id="shcb-language-1"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Bash</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">bash</span><span class="shcb-language__paren">)</span></small></pre>


<p>Besides the fact that we should be aware of every warning, not just straight errors, this negatively influences the usability of rules. For example, the VT Hunting platform does not accept rules with warnings.</p>



<p>Most notably, one of our analysts was trying to create a rule that would detect Bitcoin addresses, as in the rule below, and had to combat this warning constantly.</p>


<pre class="wp-block-code" aria-describedby="shcb-language-2" data-shcb-language-name="PHP" data-shcb-language-slug="php"><span><code class="hljs language-php"><span class="hljs-comment">// btc.yar rule</span>
rule contains_btc_address
{
   strings:
       $btc = /&#91;<span class="hljs-number">13</span>]&#91;a-km-zA-HJ-NP-Z1<span class="hljs-number">-9</span>]{<span class="hljs-number">25</span>,<span class="hljs-number">34</span>}/ fullword ascii wide
   condition:
       $btc
}</code></span><small class="shcb-language" id="shcb-language-2"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>


<p>However, we would like to use some of these rules, so what is the solution? And what exactly is the reason that Yara is warning about low performance? Can this be changed or improved?</p>



<h3 class="wp-block-heading"><strong>Problem analysis</strong></h3>



<p>After analyzing the problem, I found the potential issue that decreased the number of primarily regular expressions that could be used in Yara rules without warnings.</p>



<p>To understand that, I will briefly explain how Yara works internally. For more details, you can visit an excellent summary in <a href="https://github.com/Neo23x0/YARA-Performance-Guidelines">Performance Guidelines</a>, where I also added a few of my notes, or&nbsp; look directly at the documentation and the code itself.</p>



<p>Yara firstly searches for potential matches with the help of the Aho-Corasick machine. In this step, it finds all possible places in input, where the whole strings can be found, and additionally, where rules can hit. Just after that, the bytecode engine is run to verify the matches, and then the conditions of the rules are also checked.</p>



<p>For this first step, short substrings, up to 4 bytes, are selected from strings. A series of heuristics are used to choose the unique sequences.</p>



<p>This is wanted as we do not want to search for the <code>00 00 00 00</code> sequence as it would hit too many times.</p>



<p>The main problem is that the heuristics strongly prefer text strings and cannot work with regular expressions very effectively.</p>



<p>In our case, the Bitcoin addresses let to zero-length atom. What does that mean? The bytecode engine must check every byte from the input because every position could be a potential match. And this is a truly time-consuming task, thus the warnings.</p>



<p>But what if we could help Yara better understand the regular expressions and help it narrow down the number of potential matches? Would the speed of scanning improve?</p>



<p>After creating the proof of concept, I can say yes, we can do it.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" width="1024" height="683" src="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-1024x683.jpg" alt="" class="wp-image-964" srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-1024x683.jpg 1024w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-300x200.jpg 300w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-768x512.jpg 768w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-1536x1024.jpg 1536w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-2048x1365.jpg 2048w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1138885208-736x491.jpg 736w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>


<h3 class="wp-block-heading"><strong>Proposed Changes</strong></h3>



<p>You can read about all the details and formal theory behind the changes in my paper, but I will try to describe the changes in a more practical way here.</p>



<p>First, I extended the definition of atoms from text strings to regular expressions. That means that they are able to represent the subclass of these languages. I kept the length of 4 bytes or rather a sequence of four classes. The class is a set of characters. It can be one character, that would be a literal, a collection of characters, like in <code>[a-d]</code> representing the set <code>{a, b, c, d}</code>. The last case is noted as a dot in regular expression as any character (sometimes without the new line, depending on the implementation).</p>



<p>In this version, the Bitcoin address would be represented as <code>[13][a-km-zA-HJ-NP-Z1-9]{2}</code>, noting the repetition of the second class. It also could be <code>[13][a-km-zA-HJ-NP-Z1-9]{3}</code>. Still, experiments showed that the additional class does not improve the speed as significantly as the repetition does not provide a substantial decrease in the number of potential matches.</p>



<p>The heuristics for selections of atoms were broadened and changed to prefer still simple text literals where they can be found and include more complex ones, as in our case at the same time.&nbsp;</p>



<p>This part underwent several changes, and in the end, I tried to keep the changes as minimal as possible. My goal is not only to improve the scanning of the regular expressions but also scanning of other cases the same in the worst scenario. Even a tiny change in heuristics can dramatically affect the number of potential matches and thus the scanning speed, so this had to be handled carefully.</p>



<p>The class itself is represented as a bitmap, an array of integers where individual characters are coded with a bit value set to 1 if the character is set, 0 otherwise. For example, for character <code>a</code>, the bit on position <code>bitmap[12][1]</code> is used, as its ASCII code (97) is divided by 8, and the resulting number is 12. The presence of the number is indicated by a bit with the value one on the position given by operation modulo 8.</p>



<p>The selected atoms are then inserted into the Aho-Corasick automaton, a prefix tree machine. It is an extended version of a general finite automaton, where we are adding strings from the root state and detecting the common prefixes as we create states only when necessary. In my proposed version, it can also accept the classes instead of just simple text strings. In this step, the same classes are detected in the common prefix in a similar fashion as before.</p>



<p>This leads to a problem because the Aho-Corasick contains so-called failure links that allow several matches (and even interleaving ones) to be detected at one pass from the input. This requires that the machine is deterministic even with failure links that return to previous states. My change, however, broke this determinism. Additional changes had to be made, and the machine was transformed into a deterministic one even for failure links.</p>



<p>With these changes, we detected a subset of potential matches again, and the bytecode engine is run less often, even with the use of regular expressions. Also, the Bitcoin address can be detected without warnings about the slowing down scanning with my proposed changes.</p>



<p>But what about the actual speed of the scanning? Was it improved?</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" width="1024" height="576" src="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-1024x576.jpg" alt="" class="wp-image-965" srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-1024x576.jpg 1024w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-300x169.jpg 300w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-768x432.jpg 768w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-1536x864.jpg 1536w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-2048x1152.jpg 2048w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-540x304.jpg 540w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-344x194.jpg 344w, https://engineering.avast.io/wp-content/uploads/sites/3/2022/06/GettyImages-1130490519-1128x635.jpg 1128w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>


<h3 class="wp-block-heading"><strong>Tests</strong></h3>



<p>For tests, I run both versions on the server with the Debian operating system in release 4.9.168 on a 64-bit architecture with a processor Intel Xeon 5–2697 v4 with a clock rate of 2.30GHz. The memory clock rate was 2.40GHz. As a compiler, the GCC in version 8.3.0 was used.</p>



<p>I selected two rules, one with the Bitcoin address and one from unit tests, to provide additional information on the overall effects of the proposed changes. More tests can be found in my paper.</p>



<p>To measure speed, I scanned two larger folders with various subfolders and files with 15 GB and 760 GB of data in total.</p>



<h5 class="wp-block-heading">BTC Address Rule</h5>


<pre class="wp-block-code" aria-describedby="shcb-language-3" data-shcb-language-name="PHP" data-shcb-language-slug="php"><span><code class="hljs language-php"><span class="hljs-comment">// btc.yar rule</span>
rule contains_btc_address
{
   strings:
       $btc = /&#91;<span class="hljs-number">13</span>]&#91;a-km-zA-HJ-NP-Z1<span class="hljs-number">-9</span>]{<span class="hljs-number">25</span>,<span class="hljs-number">34</span>}/ fullword ascii wide
   condition:
       $btc
}</code></span><small class="shcb-language" id="shcb-language-3"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>


<div class="wp-block-columns is-layout-flex wp-container-core-columns-is-layout-1 wp-block-columns-is-layout-flex">
<div class="wp-block-column is-layout-flow wp-block-column-is-layout-flow" style="flex-basis:100%">
<figure class="wp-block-table is-style-stripes"><table><tbody><tr><td><strong>The rule btc.yar</strong></td><td><strong>Set 1 (15 GB)</strong></td><td><strong>Set 2 (760 GB)</strong></td></tr><tr><td>The upstream version</td><td>1m 20.134s</td><td>8h 55m 21.727s</td></tr><tr><td>The classes version</td><td>6.683s</td><td>40m 22.879s</td></tr></tbody></table><figcaption>The results for btc.yar YARA rules</figcaption></figure>
</div>
</div>



<h5 class="wp-block-heading"><strong>Hex Value Rule</strong></h5>


<pre class="wp-block-code" aria-describedby="shcb-language-4" data-shcb-language-name="PHP" data-shcb-language-slug="php"><span><code class="hljs language-php"><span class="hljs-comment">// hex.yar rule</span>
rule hex_value_test
{
   strings:
       $hex = {<span class="hljs-number">61</span> <span class="hljs-number">6</span>? <span class="hljs-number">63</span> &#91;<span class="hljs-number">1</span>–<span class="hljs-number">5</span>] <span class="hljs-number">65</span> <span class="hljs-number">66</span>}
   condition:
       $hex
}</code></span><small class="shcb-language" id="shcb-language-4"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">PHP</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">php</span><span class="shcb-language__paren">)</span></small></pre>


<figure class="wp-block-table is-style-stripes"><table><tbody><tr><td><strong>The rule hex.yar</strong></td><td><strong>Set 1 (15 GB)</strong></td><td><strong>Set 2 (760 GB)</strong></td></tr><tr><td>The upstream version</td><td>6.399s</td><td>39m 7.329s</td></tr><tr><td>The classes version</td><td>6.285s</td><td>37m 43.513s</td></tr></tbody></table><figcaption>The results for hex.yar YARA rules</figcaption></figure>



<h3 class="wp-block-heading">Conclusion</h3>



<p>Yara is a fascinating tool for pattern matching, and I am happy that there is an online community that is very active and helpful.</p>



<p>At Avast, we want to give back as much as possible, and for that reason, I also published the changes that we have been using in the company for a while now.</p>



<p>Note that there will be a discussion with the authors of Yara about this commit, and there can be some additional updates and changes, so the updated version is the most suitable for general usage.</p>
                                            </div>

                </article>

                                    <div class="entry-tags clearfix">
                        <span>Tagged as</span><a href="https://engineering.avast.io/tag/performance/" rel="tag">performance</a>, <a href="https://engineering.avast.io/tag/yara/" rel="tag">yara</a>                    </div>
                
                
                               
		        

            </div>

            
        </div>
    </div>
</div>

    

    
    
    <footer id="johannes-footer" class="johannes-footer">
        <div class="container">

                            <div class="footer-divider"></div>
                
	<div class="row johannes-footer-widgets justify-content-center">
	    	        	            <div class="col-12 col-md-6 col-lg-4">
		            <div id="tag_cloud-3" class="widget widget_tag_cloud "><h5 class="widget-title">Tags</h5><div class="tagcloud"><a href="https://engineering.avast.io/tag/android/" class="tag-cloud-link tag-link-8 tag-link-position-1" style="font-size: 12.941176470588pt;" aria-label="Android (3 items)">Android</a>
<a href="https://engineering.avast.io/tag/anr/" class="tag-cloud-link tag-link-36 tag-link-position-2" style="font-size: 8pt;" aria-label="ANR (1 item)">ANR</a>
<a href="https://engineering.avast.io/tag/bot/" class="tag-cloud-link tag-link-34 tag-link-position-3" style="font-size: 10.964705882353pt;" aria-label="bot (2 items)">bot</a>
<a href="https://engineering.avast.io/tag/bulldozer/" class="tag-cloud-link tag-link-42 tag-link-position-4" style="font-size: 8pt;" aria-label="bulldozer (1 item)">bulldozer</a>
<a href="https://engineering.avast.io/tag/cmake/" class="tag-cloud-link tag-link-31 tag-link-position-5" style="font-size: 8pt;" aria-label="CMake (1 item)">CMake</a>
<a href="https://engineering.avast.io/tag/code-review/" class="tag-cloud-link tag-link-23 tag-link-position-6" style="font-size: 8pt;" aria-label="code-review (1 item)">code-review</a>
<a href="https://engineering.avast.io/tag/crash/" class="tag-cloud-link tag-link-40 tag-link-position-7" style="font-size: 8pt;" aria-label="crash (1 item)">crash</a>
<a href="https://engineering.avast.io/tag/dagger/" class="tag-cloud-link tag-link-39 tag-link-position-8" style="font-size: 8pt;" aria-label="Dagger (1 item)">Dagger</a>
<a href="https://engineering.avast.io/tag/dependabot/" class="tag-cloud-link tag-link-46 tag-link-position-9" style="font-size: 8pt;" aria-label="dependabot (1 item)">dependabot</a>
<a href="https://engineering.avast.io/tag/dependencies/" class="tag-cloud-link tag-link-32 tag-link-position-10" style="font-size: 10.964705882353pt;" aria-label="dependencies (2 items)">dependencies</a>
<a href="https://engineering.avast.io/tag/functional-programming/" class="tag-cloud-link tag-link-3 tag-link-position-11" style="font-size: 12.941176470588pt;" aria-label="functional-programming (3 items)">functional-programming</a>
<a href="https://engineering.avast.io/tag/genrex/" class="tag-cloud-link tag-link-60 tag-link-position-12" style="font-size: 8pt;" aria-label="genrex (1 item)">genrex</a>
<a href="https://engineering.avast.io/tag/http/" class="tag-cloud-link tag-link-20 tag-link-position-13" style="font-size: 8pt;" aria-label="http (1 item)">http</a>
<a href="https://engineering.avast.io/tag/hyperscan/" class="tag-cloud-link tag-link-54 tag-link-position-14" style="font-size: 8pt;" aria-label="hyperscan (1 item)">hyperscan</a>
<a href="https://engineering.avast.io/tag/ida/" class="tag-cloud-link tag-link-30 tag-link-position-15" style="font-size: 10.964705882353pt;" aria-label="IDA (2 items)">IDA</a>
<a href="https://engineering.avast.io/tag/jni/" class="tag-cloud-link tag-link-50 tag-link-position-16" style="font-size: 8pt;" aria-label="jni (1 item)">jni</a>
<a href="https://engineering.avast.io/tag/jvm/" class="tag-cloud-link tag-link-7 tag-link-position-17" style="font-size: 14.588235294118pt;" aria-label="jvm (4 items)">jvm</a>
<a href="https://engineering.avast.io/tag/kotlin/" class="tag-cloud-link tag-link-9 tag-link-position-18" style="font-size: 10.964705882353pt;" aria-label="Kotlin (2 items)">Kotlin</a>
<a href="https://engineering.avast.io/tag/machine-learning/" class="tag-cloud-link tag-link-18 tag-link-position-19" style="font-size: 8pt;" aria-label="machine learning (1 item)">machine learning</a>
<a href="https://engineering.avast.io/tag/merge-request/" class="tag-cloud-link tag-link-22 tag-link-position-20" style="font-size: 8pt;" aria-label="merge-request (1 item)">merge-request</a>
<a href="https://engineering.avast.io/tag/missinglink/" class="tag-cloud-link tag-link-47 tag-link-position-21" style="font-size: 8pt;" aria-label="missinglink (1 item)">missinglink</a>
<a href="https://engineering.avast.io/tag/open-source/" class="tag-cloud-link tag-link-55 tag-link-position-22" style="font-size: 8pt;" aria-label="open-source (1 item)">open-source</a>
<a href="https://engineering.avast.io/tag/performance/" class="tag-cloud-link tag-link-38 tag-link-position-23" style="font-size: 17.882352941176pt;" aria-label="performance (7 items)">performance</a>
<a href="https://engineering.avast.io/tag/policybot/" class="tag-cloud-link tag-link-43 tag-link-position-24" style="font-size: 8pt;" aria-label="policybot (1 item)">policybot</a>
<a href="https://engineering.avast.io/tag/programming/" class="tag-cloud-link tag-link-10 tag-link-position-25" style="font-size: 8pt;" aria-label="Programming (1 item)">Programming</a>
<a href="https://engineering.avast.io/tag/pull-request/" class="tag-cloud-link tag-link-21 tag-link-position-26" style="font-size: 10.964705882353pt;" aria-label="pull-request (2 items)">pull-request</a>
<a href="https://engineering.avast.io/tag/python/" class="tag-cloud-link tag-link-17 tag-link-position-27" style="font-size: 8pt;" aria-label="python (1 item)">python</a>
<a href="https://engineering.avast.io/tag/radare2/" class="tag-cloud-link tag-link-41 tag-link-position-28" style="font-size: 8pt;" aria-label="Radare2 (1 item)">Radare2</a>
<a href="https://engineering.avast.io/tag/renovate/" class="tag-cloud-link tag-link-45 tag-link-position-29" style="font-size: 10.964705882353pt;" aria-label="renovate (2 items)">renovate</a>
<a href="https://engineering.avast.io/tag/retdec/" class="tag-cloud-link tag-link-28 tag-link-position-30" style="font-size: 15.905882352941pt;" aria-label="retdec (5 items)">retdec</a>
<a href="https://engineering.avast.io/tag/reversing-tools/" class="tag-cloud-link tag-link-29 tag-link-position-31" style="font-size: 14.588235294118pt;" aria-label="reversing tools (4 items)">reversing tools</a>
<a href="https://engineering.avast.io/tag/rust/" class="tag-cloud-link tag-link-14 tag-link-position-32" style="font-size: 14.588235294118pt;" aria-label="rust (4 items)">rust</a>
<a href="https://engineering.avast.io/tag/sbt/" class="tag-cloud-link tag-link-49 tag-link-position-33" style="font-size: 10.964705882353pt;" aria-label="sbt (2 items)">sbt</a>
<a href="https://engineering.avast.io/tag/scala/" class="tag-cloud-link tag-link-2 tag-link-position-34" style="font-size: 14.588235294118pt;" aria-label="scala (4 items)">scala</a>
<a href="https://engineering.avast.io/tag/scala-steward/" class="tag-cloud-link tag-link-44 tag-link-position-35" style="font-size: 10.964705882353pt;" aria-label="scala-steward (2 items)">scala-steward</a>
<a href="https://engineering.avast.io/tag/server/" class="tag-cloud-link tag-link-4 tag-link-position-36" style="font-size: 10.964705882353pt;" aria-label="server (2 items)">server</a>
<a href="https://engineering.avast.io/tag/toolkit/" class="tag-cloud-link tag-link-5 tag-link-position-37" style="font-size: 10.964705882353pt;" aria-label="toolkit (2 items)">toolkit</a>
<a href="https://engineering.avast.io/tag/update/" class="tag-cloud-link tag-link-33 tag-link-position-38" style="font-size: 12.941176470588pt;" aria-label="update (3 items)">update</a>
<a href="https://engineering.avast.io/tag/yara/" class="tag-cloud-link tag-link-25 tag-link-position-39" style="font-size: 22pt;" aria-label="yara (13 items)">yara</a>
<a href="https://engineering.avast.io/tag/yaramod/" class="tag-cloud-link tag-link-26 tag-link-position-40" style="font-size: 8pt;" aria-label="yaramod (1 item)">yaramod</a></div>
</div>	            </div>
	        	    	        	            <div class="col-12 col-md-6 col-lg-4">
		            <div id="categories-4" class="widget widget_categories"><h5 class="widget-title">Categories</h5>
			<ul>
					<li class="cat-item cat-item-11"><a href="https://engineering.avast.io/category/android/">Android</a>
</li>
	<li class="cat-item cat-item-53"><a href="https://engineering.avast.io/category/hyperscan/">HyperScan</a>
</li>
	<li class="cat-item cat-item-59"><a href="https://engineering.avast.io/category/know-your-yara-rules/">Know Your YARA Rules</a>
</li>
	<li class="cat-item cat-item-16"><a href="https://engineering.avast.io/category/machine-learning/">Machine Learning</a>
</li>
	<li class="cat-item cat-item-27"><a href="https://engineering.avast.io/category/open-source/">Open-Source</a>
</li>
	<li class="cat-item cat-item-12"><a href="https://engineering.avast.io/category/rust/">Rust</a>
</li>
	<li class="cat-item cat-item-15"><a href="https://engineering.avast.io/category/scala/">Scala</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://engineering.avast.io/category/software-development/">Software Development</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://engineering.avast.io/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-52"><a href="https://engineering.avast.io/category/yara/">Yara</a>
</li>
			</ul>

			</div>	            </div>
	        	    	        	            <div class="col-12 col-md-6 col-lg-4">
		            <div id="text-3" class="widget widget_text"><h5 class="widget-title">Links</h5>			<div class="textwidget"><ul>
<li><a href="https://decoded.avast.io">Decoded Blog</a></li>
<li><a href="https://avast.io">Avast.io</a></li>
<li><a href="https://avast.com">Avast.com</a></li>
<li></li>
</ul>
</div>
		</div>	            </div>
	        	    	</div>
            
                            <div class="johannes-copyright">
                    <p>Avast Software s.r.o. · Copyright 2024 · All rights reserved</p>
                </div>
                    </div>
    </footer>

            <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>    

</div>



<div class="johannes-action-overlay">

</div><div class="johannes-sidebar johannes-sidebar-hidden">

	<div class="johannes-sidebar-branding">
	    <span class="site-title h1 "><a href="https://engineering.avast.io/" rel="home"><picture class="johannes-logo"><source media="(min-width: 1050px)" srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png"><source srcset="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png"><img src="https://engineering.avast.io/wp-content/uploads/sites/3/2021/09/Asset-5-1.png" alt="Avast Engineering"></picture></a></span>	    <span class="johannes-action-close"><i class="jf jf-close" aria-hidden="true"></i></span>
	</div>	

		<div class="johannes-menu-mobile widget d-md-block d-lg-none">
		<div class="widget-inside johannes-bg-alt-1">
		<h4 class="widget-title">Menu</h4>
			    <nav class="menu-main-menu-container"><ul id="menu-main-menu-1" class="johannes-menu johannes-menu-primary"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-165"><a href="https://avast.io">Avast.io</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-166"><a href="https://avast.com/careers">Careers</a></li>
</ul></nav>			                                    	                            		</div>
	</div>

		    <div id="search-2" class="widget widget_search"><div class="widget-inside johannes-bg-alt-1"><form class="search-form" action="https://engineering.avast.io/" method="get">
	<input name="s" type="text" value="" placeholder="Type here to search..." />
		<button type="submit">Search</button>
</form>
</div></div>
		<div id="recent-posts-2" class="widget widget_recent_entries"><div class="widget-inside johannes-bg-alt-1">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://engineering.avast.io/know-your-yara-rules-series-6-we-present-genrex-a-generator-of-regular-expressions/">Know Your YARA Rules Series: #6 We Present GenRex &#8211; A Generator of Regular Expressions </a>
									</li>
											<li>
					<a href="https://engineering.avast.io/know-your-yara-rules-series-5-everything-you-need-to-know-about-regular-expressions-in-yara/">Know Your YARA Rules Series: #5 Everything You Need to Know About Regular Expressions in YARA</a>
									</li>
											<li>
					<a href="https://engineering.avast.io/know-your-yara-rules-series-4-yara-x-the-next-generation/">Know Your YARA Rules Series: #4 YARA-X: The Next Generation</a>
									</li>
											<li>
					<a href="https://engineering.avast.io/know-your-yara-rules-series-3-watch-out-for-releases/">Know Your YARA Rules Series: #3 Watch Out For Releases</a>
									</li>
											<li>
					<a href="https://engineering.avast.io/know-your-yara-rules-series-2-rewrite-your-rules/">Know Your YARA Rules Series: #2 Rewrite Your Rules</a>
									</li>
					</ul>

		</div></div><div id="archives-2" class="widget widget_archive"><div class="widget-inside johannes-bg-alt-1"><h4 class="widget-title">Archives</h4>
			<ul>
					<li><a href='https://engineering.avast.io/2024/02/'>February 2024</a></li>
	<li><a href='https://engineering.avast.io/2023/12/'>December 2023</a></li>
	<li><a href='https://engineering.avast.io/2023/11/'>November 2023</a></li>
	<li><a href='https://engineering.avast.io/2023/10/'>October 2023</a></li>
	<li><a href='https://engineering.avast.io/2023/09/'>September 2023</a></li>
	<li><a href='https://engineering.avast.io/2023/08/'>August 2023</a></li>
	<li><a href='https://engineering.avast.io/2022/09/'>September 2022</a></li>
	<li><a href='https://engineering.avast.io/2022/08/'>August 2022</a></li>
	<li><a href='https://engineering.avast.io/2022/07/'>July 2022</a></li>
	<li><a href='https://engineering.avast.io/2022/06/'>June 2022</a></li>
	<li><a href='https://engineering.avast.io/2021/12/'>December 2021</a></li>
	<li><a href='https://engineering.avast.io/2021/05/'>May 2021</a></li>
	<li><a href='https://engineering.avast.io/2020/12/'>December 2020</a></li>
	<li><a href='https://engineering.avast.io/2020/08/'>August 2020</a></li>
	<li><a href='https://engineering.avast.io/2020/06/'>June 2020</a></li>
	<li><a href='https://engineering.avast.io/2020/05/'>May 2020</a></li>
	<li><a href='https://engineering.avast.io/2020/04/'>April 2020</a></li>
	<li><a href='https://engineering.avast.io/2020/03/'>March 2020</a></li>
	<li><a href='https://engineering.avast.io/2020/01/'>January 2020</a></li>
	<li><a href='https://engineering.avast.io/2019/12/'>December 2019</a></li>
	<li><a href='https://engineering.avast.io/2019/11/'>November 2019</a></li>
	<li><a href='https://engineering.avast.io/2019/10/'>October 2019</a></li>
			</ul>

			</div></div><div id="categories-2" class="widget widget_categories"><div class="widget-inside johannes-bg-alt-1"><h4 class="widget-title">Categories</h4>
			<ul>
					<li class="cat-item cat-item-11"><a href="https://engineering.avast.io/category/android/">Android</a>
</li>
	<li class="cat-item cat-item-53"><a href="https://engineering.avast.io/category/hyperscan/">HyperScan</a>
</li>
	<li class="cat-item cat-item-59"><a href="https://engineering.avast.io/category/know-your-yara-rules/">Know Your YARA Rules</a>
</li>
	<li class="cat-item cat-item-16"><a href="https://engineering.avast.io/category/machine-learning/">Machine Learning</a>
</li>
	<li class="cat-item cat-item-27"><a href="https://engineering.avast.io/category/open-source/">Open-Source</a>
</li>
	<li class="cat-item cat-item-12"><a href="https://engineering.avast.io/category/rust/">Rust</a>
</li>
	<li class="cat-item cat-item-15"><a href="https://engineering.avast.io/category/scala/">Scala</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://engineering.avast.io/category/software-development/">Software Development</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://engineering.avast.io/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-52"><a href="https://engineering.avast.io/category/yara/">Yara</a>
</li>
			</ul>

			</div></div>    
</div>
<style id='core-block-supports-inline-css' type='text/css'>
.wp-container-core-columns-is-layout-1{flex-wrap:nowrap;}
</style>
<script type="text/javascript" src="https://engineering.avast.io/wp-includes/js/imagesloaded.min.js?ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="https://engineering.avast.io/wp-includes/js/masonry.min.js?ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" src="https://engineering.avast.io/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b" id="jquery-masonry-js"></script>
<script type="text/javascript" id="johannes-main-js-extra">
/* <![CDATA[ */
var johannes_js_settings = {"rtl_mode":"","header_sticky":"","header_sticky_offset":"300","header_sticky_up":"","popup":"1","go_to_top":"","grid":{"column":50,"gutter":{"xs":15,"sm":15,"md":30,"lg":30,"xl":48},"breakpoint":{"xs":0,"sm":374,"md":600,"lg":900,"xl":1128}}};
/* ]]> */
</script>
<script type="text/javascript" src="https://engineering.avast.io/wp-content/themes/johannes/assets/js/min.js?ver=1.1.3" id="johannes-main-js"></script>
<script type="text/javascript" src="https://engineering.avast.io/wp-content/plugins/meks-easy-social-share/assets/js/main.js?ver=1.3" id="meks_ess-main-js"></script>
<script type="text/javascript" src="https://engineering.avast.io/wp-content/plugins/page-links-to/dist/new-tab.js?ver=3.3.7" id="page-links-to-js"></script>
<script type="text/javascript">(function (undefined) {let scriptOptions={"_localizedStrings":{"redirect_overlay_title":"Hold On","redirect_overlay_text":"You are being redirected to another page,<br>it may take a few seconds.","webview_notification_text":"The selected provider doesn't support embedded browsers!"},"_targetWindow":"prefer-popup","_redirectOverlay":"overlay-with-spinner-and-message","_unsupportedWebviewBehavior":""};
/**
 * Used when Cross-Origin-Opener-Policy blocked the access to the opener. We can't have a reference of the opened windows, so we should attempt to refresh only the windows that has opened popups.
 */
window._nslHasOpenedPopup = false;
window._nslWebViewNoticeElement = null;

window.NSLPopup = function (url, title, w, h) {
    const userAgent = navigator.userAgent,
        mobile = function () {
            return /\b(iPhone|iP[ao]d)/.test(userAgent) ||
                /\b(iP[ao]d)/.test(userAgent) ||
                /Android/i.test(userAgent) ||
                /Mobile/i.test(userAgent);
        },
        screenX = window.screenX !== undefined ? window.screenX : window.screenLeft,
        screenY = window.screenY !== undefined ? window.screenY : window.screenTop,
        outerWidth = window.outerWidth !== undefined ? window.outerWidth : document.documentElement.clientWidth,
        outerHeight = window.outerHeight !== undefined ? window.outerHeight : document.documentElement.clientHeight - 22,
        targetWidth = mobile() ? null : w,
        targetHeight = mobile() ? null : h,
        left = parseInt(screenX + (outerWidth - targetWidth) / 2, 10),
        right = parseInt(screenY + (outerHeight - targetHeight) / 2.5, 10),
        features = [];
    if (targetWidth !== null) {
        features.push('width=' + targetWidth);
    }
    if (targetHeight !== null) {
        features.push('height=' + targetHeight);
    }
    features.push('left=' + left);
    features.push('top=' + right);
    features.push('scrollbars=1');

    const newWindow = window.open(url, title, features.join(','));

    if (window.focus) {
        newWindow.focus();
    }

    window._nslHasOpenedPopup = true;

    return newWindow;
};

let isWebView = null;

function checkWebView() {
    if (isWebView === null) {
        function _detectOS(ua) {
            if (/Android/.test(ua)) {
                return "Android";
            } else if (/iPhone|iPad|iPod/.test(ua)) {
                return "iOS";
            } else if (/Windows/.test(ua)) {
                return "Windows";
            } else if (/Mac OS X/.test(ua)) {
                return "Mac";
            } else if (/CrOS/.test(ua)) {
                return "Chrome OS";
            } else if (/Firefox/.test(ua)) {
                return "Firefox OS";
            }
            return "";
        }

        function _detectBrowser(ua) {
            let android = /Android/.test(ua);

            if (/Opera Mini/.test(ua) || / OPR/.test(ua) || / OPT/.test(ua)) {
                return "Opera";
            } else if (/CriOS/.test(ua)) {
                return "Chrome for iOS";
            } else if (/Edge/.test(ua)) {
                return "Edge";
            } else if (android && /Silk\//.test(ua)) {
                return "Silk";
            } else if (/Chrome/.test(ua)) {
                return "Chrome";
            } else if (/Firefox/.test(ua)) {
                return "Firefox";
            } else if (android) {
                return "AOSP";
            } else if (/MSIE|Trident/.test(ua)) {
                return "IE";
            } else if (/Safari\//.test(ua)) {
                return "Safari";
            } else if (/AppleWebKit/.test(ua)) {
                return "WebKit";
            }
            return "";
        }

        function _detectBrowserVersion(ua, browser) {
            if (browser === "Opera") {
                return /Opera Mini/.test(ua) ? _getVersion(ua, "Opera Mini/") :
                    / OPR/.test(ua) ? _getVersion(ua, " OPR/") :
                        _getVersion(ua, " OPT/");
            } else if (browser === "Chrome for iOS") {
                return _getVersion(ua, "CriOS/");
            } else if (browser === "Edge") {
                return _getVersion(ua, "Edge/");
            } else if (browser === "Chrome") {
                return _getVersion(ua, "Chrome/");
            } else if (browser === "Firefox") {
                return _getVersion(ua, "Firefox/");
            } else if (browser === "Silk") {
                return _getVersion(ua, "Silk/");
            } else if (browser === "AOSP") {
                return _getVersion(ua, "Version/");
            } else if (browser === "IE") {
                return /IEMobile/.test(ua) ? _getVersion(ua, "IEMobile/") :
                    /MSIE/.test(ua) ? _getVersion(ua, "MSIE ")
                        :
                        _getVersion(ua, "rv:");
            } else if (browser === "Safari") {
                return _getVersion(ua, "Version/");
            } else if (browser === "WebKit") {
                return _getVersion(ua, "WebKit/");
            }
            return "0.0.0";
        }

        function _getVersion(ua, token) {
            try {
                return _normalizeSemverString(ua.split(token)[1].trim().split(/[^\w\.]/)[0]);
            } catch (o_O) {
            }
            return "0.0.0";
        }

        function _normalizeSemverString(version) {
            const ary = version.split(/[\._]/);
            return (parseInt(ary[0], 10) || 0) + "." +
                (parseInt(ary[1], 10) || 0) + "." +
                (parseInt(ary[2], 10) || 0);
        }

        function _isWebView(ua, os, browser, version, options) {
            switch (os + browser) {
                case "iOSSafari":
                    return false;
                case "iOSWebKit":
                    return _isWebView_iOS(options);
                case "AndroidAOSP":
                    return false;
                case "AndroidChrome":
                    return parseFloat(version) >= 42 ? /; wv/.test(ua) : /\d{2}\.0\.0/.test(version) ? true : _isWebView_Android(options);
            }
            return false;
        }

        function _isWebView_iOS(options) {
            const document = (window["document"] || {});

            if ("WEB_VIEW" in options) {
                return options["WEB_VIEW"];
            }
            return !("fullscreenEnabled" in document || "webkitFullscreenEnabled" in document || false);
        }

        function _isWebView_Android(options) {
            if ("WEB_VIEW" in options) {
                return options["WEB_VIEW"];
            }
            return !("requestFileSystem" in window || "webkitRequestFileSystem" in window || false);
        }

        const options = {},
            nav = window.navigator || {},
            ua = nav.userAgent || "",
            os = _detectOS(ua),
            browser = _detectBrowser(ua),
            browserVersion = _detectBrowserVersion(ua, browser);

        isWebView = _isWebView(ua, os, browser, browserVersion, options);
    }

    return isWebView;
}

function isAllowedWebViewForUserAgent(provider) {
    const facebookAllowedWebViews = [
        'Instagram',
        'FBAV',
        'FBAN'
    ];
    let whitelist = [];

    if (provider && provider === 'facebook') {
        whitelist = facebookAllowedWebViews;
    }

    const nav = window.navigator || {},
        ua = nav.userAgent || "";

    if (whitelist.length && ua.match(new RegExp(whitelist.join('|')))) {
        return true;
    }

    return false;
}

function disableButtonInWebView(providerButtonElement) {
    if (providerButtonElement) {
        providerButtonElement.classList.add('nsl-disabled-provider');
        providerButtonElement.setAttribute('href', '#');

        providerButtonElement.addEventListener('pointerdown', (e) => {
            if (!window._nslWebViewNoticeElement) {
                window._nslWebViewNoticeElement = document.createElement('div');
                window._nslWebViewNoticeElement.id = "nsl-notices-fallback";
                window._nslWebViewNoticeElement.addEventListener('pointerdown', function (e) {
                    this.parentNode.removeChild(this);
                    window._nslWebViewNoticeElement = null;
                });
                const webviewNoticeHTML = '<div class="error"><p>' + scriptOptions._localizedStrings.webview_notification_text + '</p></div>';

                window._nslWebViewNoticeElement.insertAdjacentHTML("afterbegin", webviewNoticeHTML);
                document.body.appendChild(window._nslWebViewNoticeElement);
            }
        });
    }

}

window._nslDOMReady(function () {

    window.nslRedirect = function (url) {
        if (scriptOptions._redirectOverlay) {
            const overlay = document.createElement('div');
            overlay.id = "nsl-redirect-overlay";
            let overlayHTML = '';
            const overlayContainer = "<div id='nsl-redirect-overlay-container'>",
                overlayContainerClose = "</div>",
                overlaySpinner = "<div id='nsl-redirect-overlay-spinner'></div>",
                overlayTitle = "<p id='nsl-redirect-overlay-title'>" + scriptOptions._localizedStrings.redirect_overlay_title + "</p>",
                overlayText = "<p id='nsl-redirect-overlay-text'>" + scriptOptions._localizedStrings.redirect_overlay_text + "</p>";

            switch (scriptOptions._redirectOverlay) {
                case "overlay-only":
                    break;
                case "overlay-with-spinner":
                    overlayHTML = overlayContainer + overlaySpinner + overlayContainerClose;
                    break;
                default:
                    overlayHTML = overlayContainer + overlaySpinner + overlayTitle + overlayText + overlayContainerClose;
                    break;
            }

            overlay.insertAdjacentHTML("afterbegin", overlayHTML);
            document.body.appendChild(overlay);
        }

        window.location = url;
    };

    let targetWindow = scriptOptions._targetWindow || 'prefer-popup',
        lastPopup = false;


    document.addEventListener('click', function (e) {
        if (e.target) {
            const buttonLinkElement = e.target.closest('a[data-plugin="nsl"][data-action="connect"]') || e.target.closest('a[data-plugin="nsl"][data-action="link"]');
            if (buttonLinkElement) {
                if (lastPopup && !lastPopup.closed) {
                    e.preventDefault();
                    lastPopup.focus();
                } else {

                    let href = buttonLinkElement.href,
                        success = false;
                    if (href.indexOf('?') !== -1) {
                        href += '&';
                    } else {
                        href += '?';
                    }

                    const redirectTo = buttonLinkElement.dataset.redirect;
                    if (redirectTo === 'current') {
                        href += 'redirect=' + encodeURIComponent(window.location.href) + '&';
                    } else if (redirectTo && redirectTo !== '') {
                        href += 'redirect=' + encodeURIComponent(redirectTo) + '&';
                    }

                    if (targetWindow !== 'prefer-same-window' && checkWebView()) {
                        targetWindow = 'prefer-same-window';
                    }

                    if (targetWindow === 'prefer-popup') {
                        lastPopup = NSLPopup(href + 'display=popup', 'nsl-social-connect', buttonLinkElement.dataset.popupwidth, buttonLinkElement.dataset.popupheight);
                        if (lastPopup) {
                            success = true;
                            e.preventDefault();
                        }
                    } else if (targetWindow === 'prefer-new-tab') {
                        const newTab = window.open(href + 'display=popup', '_blank');
                        if (newTab) {
                            if (window.focus) {
                                newTab.focus();
                            }
                            success = true;
                            window._nslHasOpenedPopup = true;
                            e.preventDefault();
                        }
                    }

                    if (!success) {
                        window.location = href;
                        e.preventDefault();
                    }
                }
            }
        }
    });

    let buttonCountChanged = false;

    const googleLoginButtons = document.querySelectorAll(' a[data-plugin="nsl"][data-provider="google"]');
    if (googleLoginButtons.length && checkWebView()) {
        googleLoginButtons.forEach(function (googleLoginButton) {
            if (scriptOptions._unsupportedWebviewBehavior === 'disable-button') {
                disableButtonInWebView(googleLoginButton);
            } else {
                googleLoginButton.remove();
                buttonCountChanged = true;
            }
        });
    }

    const facebookLoginButtons = document.querySelectorAll(' a[data-plugin="nsl"][data-provider="facebook"]');
    if (facebookLoginButtons.length && checkWebView() && /Android/.test(window.navigator.userAgent) && !isAllowedWebViewForUserAgent('facebook')) {
        facebookLoginButtons.forEach(function (facebookLoginButton) {
            if (scriptOptions._unsupportedWebviewBehavior === 'disable-button') {
                disableButtonInWebView(facebookLoginButton);
            } else {
                facebookLoginButton.remove();
                buttonCountChanged = true;
            }
        });
    }

    const separators = document.querySelectorAll('div.nsl-separator');
    if (buttonCountChanged && separators.length) {
        separators.forEach(function (separator) {
            const separatorParentNode = separator.parentNode;
            if (separatorParentNode) {
                const separatorButtonContainer = separatorParentNode.querySelector('div.nsl-container-buttons');
                if (separatorButtonContainer && !separatorButtonContainer.hasChildNodes()) {
                    separator.remove();
                }
            }
        })
    }
});

/**
 * Cross-Origin-Opener-Policy blocked the access to the opener
 */
if (typeof BroadcastChannel === "function") {
    const _nslLoginBroadCastChannel = new BroadcastChannel('nsl_login_broadcast_channel');
    _nslLoginBroadCastChannel.onmessage = (event) => {
        if (window?._nslHasOpenedPopup && event.data?.action === 'redirect') {
            window._nslHasOpenedPopup = false;

            const url = event.data?.href;
            _nslLoginBroadCastChannel.close();
            if (typeof window.nslRedirect === 'function') {
                window.nslRedirect(url);
            } else {
                window.opener.location = url;
            }
        }
    };
}})();</script></body>

</html>