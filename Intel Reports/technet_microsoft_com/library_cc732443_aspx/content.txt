<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Certutil" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732443(v=ws.11)" /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="author" content="Archiveddocs" />
<meta name="breadcrumb_path" content="/previous-versions/windows/it-pro/breadcrumb/toc.json" />
<meta name="current_version_url" content="https://docs.microsoft.com/windows-server/windows-server" />
<meta name="depot_name" content="MSDN.windows-server-2012-and-2012-R2" />
<meta name="document_id" content="2f405512-0cec-fd97-22c5-ea0ffe714cc2" />
<meta name="document_version_independent_id" content="2f405512-0cec-fd97-22c5-ea0ffe714cc2" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="" />
<meta name="feedback_system" content="None" />
<meta name="git_commit_id" content="31cf5b02099bbdd9723710db0a23b633d0943ae6" />
<meta name="gitcommit" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/windows-itpro-docs-archive-2-pr/commit/31cf5b02099bbdd9723710db0a23b633d0943ae6?path=/windows-server-2012-and-2012-R2/cc732443(v=ws.11).md&amp;_a=contents" />
<meta name="is_archived" content="true" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="Archiveddocs" />
<meta name="ms.date" content="08/31/2016" />
<meta name="ms.prod" content="windows-server-2012-R2-and-2012" />
<meta name="ms.topic" content="archived" />
<meta name="ms:assetid" content="c264ccf0-ba1e-412b-9dd3-d77dd9345ad9" />
<meta name="ms:contentKeyID" content="48766581" />
<meta name="ms:mtpsurl" content="https://technet.microsoft.com/en-us/library/Cc732443(v=WS.11)" />
<meta name="mtps_version" content="v=WS.11" />
<meta name="original_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/windows-itpro-docs-archive-2-pr?path=/windows-server-2012-and-2012-R2/cc732443(v=ws.11).md&amp;version=GBlive&amp;_a=contents" />
<meta name="page_type" content="conceptual" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="toc.json" />
<meta name="TOCTitle" content="Certutil" />
<meta name="uhfHeaderId" content="MSDocsHeader-Archive" />
<meta name="updated_at" content="2021-11-12 05:51 PM" />
<meta name="word_count" content="7421" />
<meta name="persistent_id" content="f7b407c9-70d9-84fa-4105-708422b18bff" />
	<meta name="scope" content="Server" /><meta name="github_feedback_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/windows-itpro-docs-archive-2-pr?path=/windows-server-2012-and-2012-R2/cc732443(v=ws.11).md&version=GBlive&_a=contents" /><link href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc732443(v=ws.11)" rel="canonical"><title>Certutil | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028546081/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: false,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',extendBreadcrumb: true,isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028546081/global/deprecation.js"></script><script src="/static/assets/0.4.028546081/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="certutil">Certutil</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li>
														<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2016-08-31T00:00:00.000Z" data-article-date-source="ms.date">08/31/2016</time>
													</li></ul>
										</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><p>&nbsp;</p>
<p>Applies To: Windows Server 2012, Windows 8</p>
<p>Certutil.exe is a command-line program that is installed as part of Certificate Services. You can use Certutil.exe to dump and display certification authority (CA) configuration information, configure Certificate Services, backup and restore CA components, and verify certificates, key pairs, and certificate chains.</p>
<p>When certutil is run on a certification authority without additional parameters, it displays the current certification authority configuration. When cerutil is run on a non-certification authority, the command defaults to running the certutil <a href="">-dump</a> verb.</p>
<div class="WARNING">
<p>Warning</p>
<p>Earlier versions of certutil may not provide all of the options that are described in this document. You can see all the options that a specific version of certutil provides by running the commands shown in the <a href="">Syntax notations</a> section.</p>
</div>
<h2 id="menu">Menu</h2>
<p>The major sections in this document are:</p>
<ul>
<li><p><a href="">Verbs</a></p>
</li>
<li><p><a href="">Syntax notations</a></p>
</li>
<li><p><a href="">Options</a></p>
</li>
<li><p><a href="">Additional certutil examples</a></p>
</li>
</ul>
<h2 id="verbs">Verbs</h2>
<p>The following table describes the verbs that can be used with the certutil command.</p>
<table>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr class="header">
<th><p>Verbs</p></th>
<th><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><a href="">-dump</a></p></td>
<td><p>Dump configuration information or files</p></td>
</tr>
<tr class="even">
<td><p><a href="">-asn</a></p></td>
<td><p>Parse ASN.1 file</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-decodehex</a>-decodehex</p></td>
<td><p>Decode hexadecimal-encoded file</p></td>
</tr>
<tr class="even">
<td><p><a href="">-decode</a></p></td>
<td><p>Decode a Base64-encoded file</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-encode</a></p></td>
<td><p>Encode a file to Base64</p></td>
</tr>
<tr class="even">
<td><p><a href="">-deny</a></p></td>
<td><p>Deny a pending certificate request</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-resubmit</a></p></td>
<td><p>Resubmit a pending certificate request</p></td>
</tr>
<tr class="even">
<td><p><a href="">-setattributes</a></p></td>
<td><p>Set attributes for a pending certificate request</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-setextension</a></p></td>
<td><p>Set an extension for a pending certificate request</p></td>
</tr>
<tr class="even">
<td><p><a href="">-revoke</a></p></td>
<td><p>Revoke a certificate</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-isvalid</a></p></td>
<td><p>Display the disposition of the current certificate</p></td>
</tr>
<tr class="even">
<td><p><a href="">-getconfig</a></p></td>
<td><p>Get the default configuration string</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-ping</a></p></td>
<td><p>Attempt to contact the Active Directory Certificate Services Request interface</p></td>
</tr>
<tr class="even">
<td><p>-pingadmin</p></td>
<td><p>Attempt to contact the Active Directory Certificate Services Admin interface</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-CAInfo</a></p></td>
<td><p>Display information about the certification authority</p></td>
</tr>
<tr class="even">
<td><p><a href="">-ca.cert</a></p></td>
<td><p>Retrieve the certificate for the certification authority</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-ca.chain</a></p></td>
<td><p>Retrieve the certificate chain for the certification authority</p></td>
</tr>
<tr class="even">
<td><p><a href="">-GetCRL</a></p></td>
<td><p>Get a certificate revocation list (CRL)</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-CRL</a></p></td>
<td><p>Publish new certificate revocation lists (CRLs) [or only delta CRLs]</p></td>
</tr>
<tr class="even">
<td><p><a href="">-shutdown</a></p></td>
<td><p>Shutdown Active Directory Certificate Services</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-installCert</a></p></td>
<td><p>Install a certification authority certificate</p></td>
</tr>
<tr class="even">
<td><p><a href="">-renewCert</a></p></td>
<td><p>Renew a certification authority certificate</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-schema</a></p></td>
<td><p>Dump the schema for the certificate</p></td>
</tr>
<tr class="even">
<td><p><a href="">-view</a></p></td>
<td><p>Dump the certificate view</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-db</a></p></td>
<td><p>Dump the raw database</p></td>
</tr>
<tr class="even">
<td><p><a href="">-deleterow</a></p></td>
<td><p>Delete a row from the server database</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-backup</a></p></td>
<td><p>Backup Active Directory Certificate Services</p></td>
</tr>
<tr class="even">
<td><p><a href="">-backupDB</a></p></td>
<td><p>Backup the Active Directory Certificate Services database</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-backupKey</a></p></td>
<td><p>Backup the Active Directory Certificate Services certificate and private key</p></td>
</tr>
<tr class="even">
<td><p><a href="">-restore</a></p></td>
<td><p>Restore Active Directory Certificate Services</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-restoreDB</a></p></td>
<td><p>Restore the Active Directory Certificate Services database</p></td>
</tr>
<tr class="even">
<td><p><a href="">-restoreKey</a></p></td>
<td><p>Restore the Active Directory Certificate Services certificate and private key</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-importPFX</a></p></td>
<td><p>Import certificate and private key</p></td>
</tr>
<tr class="even">
<td><p><a href="">-dynamicfilelist</a></p></td>
<td><p>Display a dynamic file list</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-databaselocations</a></p></td>
<td><p>Display database locations</p></td>
</tr>
<tr class="even">
<td><p><a href="">-hashfile</a></p></td>
<td><p>Generate and display a cryptographic hash over a file</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-store</a></p></td>
<td><p>Dump the certificate store</p></td>
</tr>
<tr class="even">
<td><p><a href="">-addstore</a></p></td>
<td><p>Add a certificate to the store</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-delstore</a></p></td>
<td><p>Delete a certificate from the store</p></td>
</tr>
<tr class="even">
<td><p><a href="">-verifystore</a></p></td>
<td><p>Verify a certificate in the store</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-repairstore</a></p></td>
<td><p>Repair a key association or update certificate properties or the key security descriptor</p></td>
</tr>
<tr class="even">
<td><p><a href="">-viewstore</a></p></td>
<td><p>Dump the certificates store</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-viewdelstore</a></p></td>
<td><p>Delete a certificate from the store</p></td>
</tr>
<tr class="even">
<td><p><a href="">-dsPublish</a></p></td>
<td><p>Publish a certificate or certificate revocation list (CRL) to Active Directory</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-ADTemplate</a></p></td>
<td><p>Display AD templates</p></td>
</tr>
<tr class="even">
<td><p><a href="">-Template</a></p></td>
<td><p>Display certificate templates</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-TemplateCAs</a></p></td>
<td><p>Display the certification authorities (CAs) for a certificate template</p></td>
</tr>
<tr class="even">
<td><p><a href="">-CATemplates</a></p></td>
<td><p>Display templates for CA</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-SetCASites</a></p></td>
<td><p>Manage Site Names for CAs</p></td>
</tr>
<tr class="even">
<td><p><a href="">-enrollmentServerURL</a></p></td>
<td><p>Display, add or delete enrollment server URLs associated with a CA</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-ADCA</a></p></td>
<td><p>Display AD CAs</p></td>
</tr>
<tr class="even">
<td><p><a href="">-CA</a></p></td>
<td><p>Display Enrollment Policy CAs</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-Policy</a></p></td>
<td><p>Display Enrollment Policy</p></td>
</tr>
<tr class="even">
<td><p><a href="">-PolicyCache</a></p></td>
<td><p>Display or delete Enrollment Policy Cache entries</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-CredStore</a></p></td>
<td><p>Display, add or delete Credential Store entries</p></td>
</tr>
<tr class="even">
<td><p><a href="">-InstallDefaultTemplates</a></p></td>
<td><p>Install default certificate templates</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-URLCache</a></p></td>
<td><p>Display or delete URL cache entries</p></td>
</tr>
<tr class="even">
<td><p><a href="">-pulse</a></p></td>
<td><p>Pulse auto enrollment events</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-MachineInfo</a></p></td>
<td><p>Display information about the Active Directory machine object</p></td>
</tr>
<tr class="even">
<td><p><a href="">-DCInfo</a></p></td>
<td><p>Display information about the domain controller</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-EntInfo</a></p></td>
<td><p>Display information about an enterprise CA</p></td>
</tr>
<tr class="even">
<td><p><a href="">-TCAInfo</a></p></td>
<td><p>Display information about the CA</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-SCInfo</a></p></td>
<td><p>Display information about the smart card</p></td>
</tr>
<tr class="even">
<td><p><a href="">-SCRoots</a></p></td>
<td><p>Manage smart card root certificates</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-verifykeys</a></p></td>
<td><p>Verify a public or private key set</p></td>
</tr>
<tr class="even">
<td><p><a href="">-verify</a></p></td>
<td><p>Verify a certificate, certificate revocation list (CRL), or certificate chain</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-verifyCTL</a></p></td>
<td><p>Verify AuthRoot or Disallowed Certificates CTL</p></td>
</tr>
<tr class="even">
<td><p><a href="">-sign</a></p></td>
<td><p>Re-sign a certificate revocation list (CRL) or certificate</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-vroot</a></p></td>
<td><p>Create or delete web virtual roots and file shares</p></td>
</tr>
<tr class="even">
<td><p><a href="">-vocsproot</a></p></td>
<td><p>Create or delete web virtual roots for an OCSP web proxy</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-addEnrollmentServer</a></p></td>
<td><p>Add an Enrollment Server application</p></td>
</tr>
<tr class="even">
<td><p><a href="">-deleteEnrollmentServer</a></p></td>
<td><p>Delete an Enrollment Server application</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-addPolicyServer</a></p></td>
<td><p>Add a Policy Server application</p></td>
</tr>
<tr class="even">
<td><p><a href="">-deletePolicyServer</a></p></td>
<td><p>Delete a Policy Server application</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-oid</a></p></td>
<td><p>Display the object identifier or set a display name</p></td>
</tr>
<tr class="even">
<td><p><a href="">-error</a></p></td>
<td><p>Display the message text associated with an error code</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-getreg</a></p></td>
<td><p>Display a registry value</p></td>
</tr>
<tr class="even">
<td><p><a href="">-setreg</a></p></td>
<td><p>Set a registry value</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-delreg</a></p></td>
<td><p>Delete a registry value</p></td>
</tr>
<tr class="even">
<td><p><a href="">-ImportKMS</a></p></td>
<td><p>Import user keys and certificates into the server database for key archival</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-ImportCert</a></p></td>
<td><p>Import a certificate file into the database</p></td>
</tr>
<tr class="even">
<td><p><a href="">-GetKey</a></p></td>
<td><p>Retrieve an archived private key recovery blob</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-RecoverKey</a></p></td>
<td><p>Recover an archived private key</p></td>
</tr>
<tr class="even">
<td><p><a href="">-MergePFX</a></p></td>
<td><p>Merge PFX files</p></td>
</tr>
<tr class="odd">
<td><p><a href="">-ConvertEPF</a></p></td>
<td><p>Convert a PFX file into an EPF file</p></td>
</tr>
<tr class="even">
<td><p>-?</p></td>
<td><p>Displays the list of verbs</p></td>
</tr>
<tr class="odd">
<td><p>-<em>&lt;verb&gt;</em>&nbsp;-?</p></td>
<td><p>Displays help for the verb specified.</p></td>
</tr>
<tr class="even">
<td><p>-? -v</p></td>
<td><p>Displays a full list of verbs and</p></td>
</tr>
</tbody>
</table>
<p>Return to <a href="">Menu</a></p>
<h2 id="syntax-notations">Syntax notations</h2>
<ul>
<li><p>For basic command line syntax, run certutil -?</p>
</li>
<li><p>For the syntax on using certutil with a specific verb, run <strong>certutil</strong>&nbsp;<em>&lt;verb&gt;</em>&nbsp;<strong>-?</strong></p>
</li>
<li><p>To send all of the certutil syntax into a text file, run the following commands:</p>
<ul>
<li><p>certutil -v -? &gt; certutilhelp.txt</p>
</li>
<li><p>notepad certutilhelp.txt</p>
</li>
</ul>
</li>
</ul>
<p>The following table describes the notation used to indicate command-line syntax.</p>
<table>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr class="header">
<th><p>Notation</p></th>
<th><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Text without brackets or braces</p></td>
<td><p>Items you must type as shown</p></td>
</tr>
<tr class="even">
<td><p>&lt;Text inside angle brackets&gt;</p></td>
<td><p>Placeholder for which you must supply a value</p></td>
</tr>
<tr class="odd">
<td><p>[Text inside square brackets]</p></td>
<td><p>Optional items</p></td>
</tr>
<tr class="even">
<td><p>{Text inside braces}</p></td>
<td><p>Set of required items; choose one</p></td>
</tr>
<tr class="odd">
<td><p>Vertical bar (|)</p></td>
<td><p>Separator for mutually exclusive items; choose one</p></td>
</tr>
<tr class="even">
<td><p>Ellipsis (â¦)</p></td>
<td><p>Items that can be repeated</p></td>
</tr>
</tbody>
</table>
<p>Return to <a href="">Menu</a></p>
<h2 id="-dump">-dump</h2>
<p>CertUtil [Options] [-dump]</p>
<p>CertUtil [Options] [-dump] File</p>
<p>Dump configuration information or files</p>
<p>[-f] [-silent] [-split] [-p Password] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-asn">-asn</h2>
<p>CertUtil [Options] -asn File [type]</p>
<p>Parse ASN.1 file</p>
<p>type: numeric CRYPT_STRING_* decoding type</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-decodehex">-decodehex</h2>
<p>CertUtil [Options] -decodehex InFile OutFile [type]</p>
<p>type: numeric CRYPT_STRING_* encoding type</p>
<p>[-f]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-decode">-decode</h2>
<p>CertUtil [Options] -decode InFile OutFile</p>
<p>Decode Base64-encoded file</p>
<p>[-f]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-encode">-encode</h2>
<p>CertUtil [Options] -encode InFile OutFile</p>
<p>Encode file to Base64</p>
<p>[-f] [-UnicodeText]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-deny">-deny</h2>
<p>CertUtil [Options] -deny RequestId</p>
<p>Deny pending request</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-resubmit">-resubmit</h2>
<p>CertUtil [Options] -resubmit RequestId</p>
<p>Resubmit pending request</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-setattributes">-setattributes</h2>
<p>CertUtil [Options] -setattributes RequestId AttributeString</p>
<p>Set attributes for pending request</p>
<p>RequestId -- numeric Request Id of pending request</p>
<p>AttributeString -- Request Attribute name and value pairs</p>
<ul>
<li><p>Names and values are colon separated.</p>
</li>
<li><p>Multiple name, value pairs are newline separated.</p>
</li>
<li><p>Example: "CertificateTemplate:User\nEMail:User@Domain.com"</p>
</li>
<li><p>Each "\n" sequence is converted to a newline separator.</p>
</li>
</ul>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-setextension">-setextension</h2>
<p>CertUtil [Options] -setextension RequestId ExtensionName Flags {Long | Date | String | <span class="no-loc" dir="ltr" lang="en-us">@InFile}</span></p>
<p>Set extension for pending request</p>
<p>RequestId -- numeric Request Id of a pending request</p>
<p>ExtensionName -- ObjectId string of the extension</p>
<p>Flags -- 0 is recommended. 1 makes the extension critical, 2 disables it, 3 does both.</p>
<p>If the last parameter is numeric, it is taken as a Long.</p>
<p>If it can be parsed as a date, it is taken as a Date.</p>
<p>If it starts with '@', the rest of the token is the filename containing binary data or an ascii-text hex dump.</p>
<p>Anything else is taken as a String.</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-revoke">-revoke</h2>
<p>CertUtil [Options] -revoke SerialNumber [Reason]</p>
<p>Revoke Certificate</p>
<p>SerialNumber: Comma separated list of certificate serial numbers to revoke</p>
<p>Reason: numeric or symbolic revocation reason</p>
<ul>
<li><p>0: CRL_REASON_UNSPECIFIED: Unspecified (default)</p>
</li>
<li><p>1: CRL_REASON_KEY_COMPROMISE: Key Compromise</p>
</li>
<li><p>2: CRL_REASON_CA_COMPROMISE: CA Compromise</p>
</li>
<li><p>3: CRL_REASON_AFFILIATION_CHANGED: Affiliation Changed</p>
</li>
<li><p>4: CRL_REASON_SUPERSEDED: Superseded</p>
</li>
<li><p>5: CRL_REASON_CESSATION_OF_OPERATION: Cessation of Operation</p>
</li>
<li><p>6: CRL_REASON_CERTIFICATE_HOLD: Certificate Hold</p>
</li>
<li><p>8: CRL_REASON_REMOVE_FROM_CRL: Remove From CRL</p>
</li>
<li><p>-1: Unrevoke: Unrevoke</p>
</li>
</ul>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-isvalid">-isvalid</h2>
<p>CertUtil [Options] -isvalid SerialNumber | CertHash</p>
<p>Display current certificate disposition</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-getconfig">-getconfig</h2>
<p>CertUtil [Options] -getconfig</p>
<p>Get default configuration string</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-ping">-ping</h2>
<p>CertUtil [Options] -ping [MaxSecondsToWait | CAMachineList]</p>
<p>Ping Active Directory Certificate Services Request interface</p>
<p>CAMachineList -- Comma-separated CA machine name list</p>
<ol>
<li><p>For a single machine, use a terminating comma</p>
</li>
<li><p>Displays the site cost for each CA machine</p>
</li>
</ol>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-cainfo">-CAInfo</h2>
<p>CertUtil [Options] -CAInfo [InfoName [Index | ErrorCode]]</p>
<p>Display CA Information</p>
<p>InfoName -- indicates the CA property to display (see below). Use "*" for all properties.</p>
<p>Index -- optional zero-based property index</p>
<p>ErrorCode -- numeric error code</p>
<p>[-f] [-split] [-config Machine\CAName]</p>
<p>InfoName argument syntax:</p>
<ul>
<li><p>file: File version</p>
</li>
<li><p>product: Product version</p>
</li>
<li><p>exitcount: Exit module count</p>
</li>
<li><p>exit [Index]: Exit module description</p>
</li>
<li><p>policy: Policy module description</p>
</li>
<li><p>name: CA name</p>
</li>
<li><p>sanitizedname: Sanitized CA name</p>
</li>
<li><p>dsname: Sanitized CA short name (DS name)</p>
</li>
<li><p>sharedfolder: Shared folder</p>
</li>
<li><p>error1 ErrorCode: Error message text</p>
</li>
<li><p>error2 ErrorCode: Error message text and error code</p>
</li>
<li><p>type: CA type</p>
</li>
<li><p>info: CA info</p>
</li>
<li><p>parent: Parent CA</p>
</li>
<li><p>certcount: CA cert count</p>
</li>
<li><p>xchgcount: CA exchange cert count</p>
</li>
<li><p>kracount: KRA cert count</p>
</li>
<li><p>kraused: KRA cert used count</p>
</li>
<li><p>propidmax: Maximum CA PropId</p>
</li>
<li><p>certstate [Index]: CA cert</p>
</li>
<li><p>certversion [Index]: CA cert version</p>
</li>
<li><p>certstatuscode [Index]: CA cert verify status</p>
</li>
<li><p>crlstate [Index]: CRL</p>
</li>
<li><p>krastate [Index]: KRA cert</p>
</li>
<li><p>crossstate+ [Index]: Forward cross cert</p>
</li>
<li><p>crossstate- [Index]: Backward cross cert</p>
</li>
<li><p>cert [Index]: CA cert</p>
</li>
<li><p>certchain [Index]: CA cert chain</p>
</li>
<li><p>certcrlchain [Index]: CA cert chain with CRLs</p>
</li>
<li><p>xchg [Index]: CA exchange cert</p>
</li>
<li><p>xchgchain [Index]: CA exchange cert chain</p>
</li>
<li><p>xchgcrlchain [Index]: CA exchange cert chain with CRLs</p>
</li>
<li><p>kra [Index]: KRA cert</p>
</li>
<li><p>cross+ [Index]: Forward cross cert</p>
</li>
<li><p>cross- [Index]: Backward cross cert</p>
</li>
<li><p>CRL [Index]: Base CRL</p>
</li>
<li><p>deltacrl [Index]: Delta CRL</p>
</li>
<li><p>crlstatus [Index]: CRL Publish Status</p>
</li>
<li><p>deltacrlstatus [Index]: Delta CRL Publish Status</p>
</li>
<li><p>dns: DNS Name</p>
</li>
<li><p>role: Role Separation</p>
</li>
<li><p>ads: Advanced Server</p>
</li>
<li><p>templates: Templates</p>
</li>
<li><p>ocsp [Index]: OCSP URLs</p>
</li>
<li><p>aia [Index]: AIA URLs</p>
</li>
<li><p>cdp [Index]: CDP URLs</p>
</li>
<li><p>localename: CA locale name</p>
</li>
<li><p>subjecttemplateoids: Subject Template OIDs</p>
</li>
</ul>
<p>Return to <a href="">Menu</a></p>
<h2 id="-cacert">-ca.cert</h2>
<p>CertUtil [Options] -ca.cert OutCACertFile [Index]</p>
<p>Retrieve the CA's certificate</p>
<p>OutCACertFile: output file</p>
<p>Index: CA certificate renewal index (defaults to most recent)</p>
<p>[-f] [-split] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-cachain">-ca.chain</h2>
<p>CertUtil [Options] -ca.chain OutCACertChainFile [Index]</p>
<p>Retrieve the CA's certificate chain</p>
<p>OutCACertChainFile: output file</p>
<p>Index: CA certificate renewal index (defaults to most recent)</p>
<p>[-f] [-split] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-getcrl">-GetCRL</h2>
<p>CertUtil [Options] -GetCRL OutFile [Index] [delta]</p>
<p>Get CRL</p>
<p>Index: CRL index or key index (defaults to CRL for newest key)</p>
<p>delta: delta CRL (default is base CRL)</p>
<p>[-f] [-split] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-crl">-CRL</h2>
<p>CertUtil [Options] -CRL [dd:hh | republish] [delta]</p>
<p>Publish new CRLs [or delta CRLs only]</p>
<p>dd:hh -- new CRL validity period in days and hours</p>
<p>republish -- republish most recent CRLs</p>
<p>delta -- delta CRLs only (default is base and delta CRLs)</p>
<p>[-split] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-shutdown">-shutdown</h2>
<p>CertUtil [Options] -shutdown</p>
<p>Shutdown Active Directory Certificate Services</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-installcert">-installCert</h2>
<p>CertUtil [Options] -installCert [CACertFile]</p>
<p>Install Certification Authority certificate</p>
<p>[-f] [-silent] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-renewcert">-renewCert</h2>
<p>CertUtil [Options] -renewCert [ReuseKeys] [Machine\ParentCAName]</p>
<p>Renew Certification Authority certificate</p>
<p>Use -f to ignore an outstanding renewal request, and generate a new request.</p>
<p>[-f] [-silent] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-schema">-schema</h2>
<p>CertUtil [Options] -schema [Ext | Attrib | CRL]</p>
<p>Dump Certificate Schema</p>
<p>Defaults to Request and Certificate table</p>
<p>Ext: Extension table</p>
<p>Attrib: Attribute table</p>
<p>CRL: CRL table</p>
<p>[-split] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-view">-view</h2>
<p>CertUtil [Options] -view [Queue | Log | LogFail | Revoked | Ext | Attrib | CRL] [csv]</p>
<p>Dump Certificate View</p>
<p>Queue: Request queue</p>
<p>Log: Issued or revoked certificates, plus failed requests</p>
<p>LogFail: Failed requests</p>
<p>Revoked: Revoked certificates</p>
<p>Ext: Extension table</p>
<p>Attrib: Attribute table</p>
<p>CRL: CRL table</p>
<p>csv: Output as Comma Separated Values</p>
<p>To display the StatusCode column for all entries: -out StatusCode</p>
<p>To display all columns for the last entry: -restrict "RequestId==$"</p>
<p>To display RequestId and Disposition for three requests: -restrict "RequestId&gt;=37,RequestId&lt;40" -out "RequestId,Disposition"</p>
<p>To display Row Ids and CRL Numbers for all Base CRLs: -restrict "CRLMinBase=0" -out "CRLRowId,CRLNumber" CRL</p>
<p>To display Base CRL Number 3: -v -restrict "CRLMinBase=0,CRLNumber=3" -out "CRLRawCRL" CRL</p>
<p>To display the entire CRL table: CRL</p>
<p>Use "Date[+|-dd:hh]" for date restrictions</p>
<p>Use "now+dd:hh" for a date relative to the current time</p>
<p>[-silent] [-split] [-config Machine\CAName] [-restrict RestrictionList] [-out ColumnList]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-db">-db</h2>
<p>CertUtil [Options] -db</p>
<p>Dump Raw Database</p>
<p>[-config Machine\CAName] [-restrict RestrictionList] [-out ColumnList]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-deleterow">-deleterow</h2>
<p>CertUtil [Options] -deleterow RowId | Date [Request | Cert | Ext | Attrib | CRL]</p>
<p>Delete server database row</p>
<p>Request: Failed and pending requests (submission date)</p>
<p>Cert: Expired and revoked certificates (expiration date)</p>
<p>Ext: Extension table</p>
<p>Attrib: Attribute table</p>
<p>CRL: CRL table (expiration date)</p>
<p>To delete failed and pending requests submitted by January 22, 2001: 1/22/2001 Request</p>
<p>To delete all certificates that expired by January 22, 2001: 1/22/2001 Cert</p>
<p>To delete the certificate row, attributes and extensions for RequestId 37: 37</p>
<p>To delete CRLs that expired by January 22, 2001: 1/22/2001 CRL</p>
<p>[-f] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-backup">-backup</h2>
<p>CertUtil [Options] -backup BackupDirectory [Incremental] [KeepLog]</p>
<p>Backup Active Directory Certificate Services</p>
<p>BackupDirectory: directory to store backed up data</p>
<p>Incremental: perform incremental backup only (default is full backup)</p>
<p>KeepLog: preserve database log files (default is to truncate log files)</p>
<p>[-f] [-config Machine\CAName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-backupdb">-backupDB</h2>
<p>CertUtil [Options] -backupDB BackupDirectory [Incremental] [KeepLog]</p>
<p>Backup Active Directory Certificate Services database</p>
<p>BackupDirectory: directory to store backed up database files</p>
<p>Incremental: perform incremental backup only (default is full backup)</p>
<p>KeepLog: preserve database log files (default is to truncate log files)</p>
<p>[-f] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-backupkey">-backupKey</h2>
<p>CertUtil [Options] -backupKey BackupDirectory</p>
<p>Backup Active Directory Certificate Services certificate and private key</p>
<p>BackupDirectory: directory to store backed up PFX file</p>
<p>[-f] [-config Machine\CAName] [-p Password] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-restore">-restore</h2>
<p>CertUtil [Options] -restore BackupDirectory</p>
<p>Restore Active Directory Certificate Services</p>
<p>BackupDirectory: directory containing data to be restored</p>
<p>[-f] [-config Machine\CAName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-restoredb">-restoreDB</h2>
<p>CertUtil [Options] -restoreDB BackupDirectory</p>
<p>Restore Active Directory Certificate Services database</p>
<p>BackupDirectory: directory containing database files to be restored</p>
<p>[-f] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-restorekey">-restoreKey</h2>
<p>CertUtil [Options] -restoreKey BackupDirectory | PFXFile</p>
<p>Restore Active Directory Certificate Services certificate and private key</p>
<p>BackupDirectory: directory containing PFX file to be restored</p>
<p>PFXFile: PFX file to be restored</p>
<p>[-f] [-config Machine\CAName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-importpfx">-importPFX</h2>
<p>CertUtil [Options] -importPFX [CertificateStoreName] PFXFile [Modifiers]</p>
<p>Import certificate and private key</p>
<p>CertificateStoreName: Certificate store name. See <a href="">-store</a>.</p>
<p>PFXFile: PFX file to be imported</p>
<p>Modifiers: Comma separated list of one or more of the following:</p>
<ol>
<li><p>AT_SIGNATURE: Change the KeySpec to Signature</p>
</li>
<li><p>AT_KEYEXCHANGE: Change the KeySpec to Key Exchange</p>
</li>
<li><p>NoExport: Make the private key non-exportable</p>
</li>
<li><p>NoCert: Do not import the certificate</p>
</li>
<li><p>NoChain: Do not import the certificate chain</p>
</li>
<li><p>NoRoot: Do not import the root certificate</p>
</li>
<li><p>Protect: Protect keys with password</p>
</li>
<li><p>NoProtect: Do not password protect keys</p>
</li>
</ol>
<p>Defaults to personal machine store.</p>
<p>[-f] [-user] [-p Password] [-csp Provider]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-dynamicfilelist">-dynamicfilelist</h2>
<p>CertUtil [Options] -dynamicfilelist</p>
<p>Display dynamic file List</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-databaselocations">-databaselocations</h2>
<p>CertUtil [Options] -databaselocations</p>
<p>Display database locations</p>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-hashfile">-hashfile</h2>
<p>CertUtil [Options] -hashfile InFile [HashAlgorithm]</p>
<p>Generate and display cryptographic hash over a file</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-store">-store</h2>
<p>CertUtil [Options] -store [CertificateStoreName [CertId [OutputFile]]]</p>
<p>Dump certificate store</p>
<p>CertificateStoreName: Certificate store name. Examples:</p>
<ul>
<li><p>"My", "CA" (default), "Root",</p>
</li>
<li><p>"ldap:///CN=Certification Authorities,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?one?objectClass=certificationAuthority" (View Root Certificates)</p>
</li>
<li><p>"ldap:///CN=CAName,CN=Certification Authorities,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?base?objectClass=certificationAuthority" (Modify Root Certificates)</p>
</li>
<li><p>"ldap:///CN=CAName,CN=MachineName,CN=CDP,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?certificateRevocationList?base?objectClass=cRLDistributionPoint" (View CRLs)</p>
</li>
<li><p>"ldap:///CN=NTAuthCertificates,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?base?objectClass=certificationAuthority" (Enterprise CA Certificates)</p>
</li>
<li><p>ldap: (AD computer object certificates)</p>
</li>
<li><p>-user ldap: (AD user object certificates)</p>
</li>
</ul>
<p>CertId: Certificate or CRL match token. This can be a serial number, an SHA-1 certificate, CRL, CTL or public key hash, a numeric cert index (0, 1, and so on), a numeric CRL index (.0, .1, and so on), a numeric CTL index (..0, ..1, and so on), a public key, signature or extension ObjectId, a certificate subject Common Name, an e-mail address, UPN or DNS name, a key container name or CSP name, a template name or ObjectId, an EKU or Application Policies ObjectId, or a CRL issuer Common Name. Many of these may result in multiple matches.</p>
<p>OutputFile: file to save matching cert</p>
<p>Use -user to access a user store instead of a machine store.</p>
<p>Use -enterprise to access a machine enterprise store.</p>
<p>Use -service to access a machine service store.</p>
<p>Use -grouppolicy to access a machine group policy store.</p>
<p>Examples:</p>
<ul>
<li><p>-enterprise NTAuth</p>
</li>
<li><p>-enterprise Root 37</p>
</li>
<li><p>-user My 26e0aaaf000000000004</p>
</li>
<li><p>CA .11</p>
</li>
</ul>
<p>[-f] [-enterprise] [-user] [-GroupPolicy] [-silent] [-split] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-addstore">-addstore</h2>
<p>CertUtil [Options] -addstore CertificateStoreName InFile</p>
<p>Add certificate to store</p>
<p>CertificateStoreName: Certificate store name. See <a href="">-store</a>.</p>
<p>InFile: Certificate or CRL file to add to store.</p>
<p>[-f] [-enterprise] [-user] [-GroupPolicy] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-delstore">-delstore</h2>
<p>CertUtil [Options] -delstore CertificateStoreName CertId</p>
<p>Delete certificate from store</p>
<p>CertificateStoreName: Certificate store name. See <a href="">-store</a>.</p>
<p>CertId: Certificate or CRL match token. See <a href="">-store</a>.</p>
<p>[-enterprise] [-user] [-GroupPolicy] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-verifystore">-verifystore</h2>
<p>CertUtil [Options] -verifystore CertificateStoreName [CertId]</p>
<p>Verify certificate in store</p>
<p>CertificateStoreName: Certificate store name. See <a href="">-store</a>.</p>
<p>CertId: Certificate or CRL match token. See <a href="">-store</a>.</p>
<p>[-enterprise] [-user] [-GroupPolicy] [-silent] [-split] [-dc DCName] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-repairstore">-repairstore</h2>
<p>CertUtil [Options] -repairstore CertificateStoreName CertIdList [PropertyInfFile | SDDLSecurityDescriptor]</p>
<p>Repair key association or update certificate properties or key security descriptor</p>
<p>CertificateStoreName: Certificate store name. See <a href="">-store</a>.</p>
<p>CertIdList: comma separated list of Certificate or CRL match tokens. See <a href="">-store</a> CertId description.</p>
<p>PropertyInfFile -- INF file containing external properties:</p>
<pre><code>[Properties]
     19 = Empty ; Add archived property, OR:
     19 =       ; Remove archived property

     11 = "{text}Friendly Name" ; Add friendly name property

     127 = "{hex}" ; Add custom hexadecimal property
         _continue_ = "00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f"
         _continue_ = "10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f"

     2 = "{text}" ; Add Key Provider Information property
       _continue_ = "Container=Container Name&amp;"
       _continue_ = "Provider=Microsoft Strong Cryptographic Provider&amp;"
       _continue_ = "ProviderType=1&amp;"
       _continue_ = "Flags=0&amp;"
       _continue_ = "KeySpec=2"

     9 = "{text}" ; Add Enhanced Key Usage property
       _continue_ = "1.3.6.1.5.5.7.3.2,"
       _continue_ = "1.3.6.1.5.5.7.3.1,"
</code></pre>
<p>[-f] [-enterprise] [-user] [-GroupPolicy] [-silent] [-split] [-csp Provider]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-viewstore">-viewstore</h2>
<p>CertUtil [Options] -viewdelstore [CertificateStoreName [CertId [OutputFile]]]</p>
<p>Dump certificate store</p>
<p>CertificateStoreName: Certificate store name. Examples:</p>
<ul>
<li><p>"My", "CA" (default), "Root",</p>
</li>
<li><p>"ldap:///CN=Certification Authorities,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?one?objectClass=certificationAuthority" (View Root Certificates)</p>
</li>
<li><p>"ldap:///CN=CAName,CN=Certification Authorities,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?base?objectClass=certificationAuthority" (Modify Root Certificates)</p>
</li>
<li><p>"ldap:///CN=CAName,CN=MachineName,CN=CDP,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?certificateRevocationList?base?objectClass=cRLDistributionPoint" (View CRLs)</p>
</li>
<li><p>"ldap:///CN=NTAuthCertificates,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?base?objectClass=certificationAuthority" (Enterprise CA Certificates)</p>
</li>
<li><p>ldap: (AD machine object certificates)</p>
</li>
<li><p>-user ldap: (AD user object certificates)</p>
</li>
</ul>
<p>CertId: Certificate or CRL match token. This can be a serial number, an SHA-1 certificate, CRL, CTL or public key hash, a numeric cert index (0, 1, and so on), a numeric CRL index (.0, .1, and so on), a numeric CTL index (..0, ..1, and so on), a public key, signature or extension ObjectId, a certificate subject Common Name, an e-mail address, UPN or DNS name, a key container name or CSP name, a template name or ObjectId, an EKU or Application Policies ObjectId, or a CRL issuer Common Name. Many of these may result in multiple matches.</p>
<p>OutputFile: file to save matching cert</p>
<p>Use -user to access a user store instead of a machine store.</p>
<p>Use -enterprise to access a machine enterprise store.</p>
<p>Use -service to access a machine service store.</p>
<p>Use -grouppolicy to access a machine group policy store.</p>
<p>Examples:</p>
<ol>
<li><p>-enterprise NTAuth</p>
</li>
<li><p>-enterprise Root 37</p>
</li>
<li><p>-user My 26e0aaaf000000000004</p>
</li>
<li><p>CA .11</p>
</li>
</ol>
<p>[-f] [-enterprise] [-user] [-GroupPolicy] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-viewdelstore">-viewdelstore</h2>
<p>CertUtil [Options] -viewdelstore [CertificateStoreName [CertId [OutputFile]]]</p>
<p>Delete certificate from store</p>
<p>CertificateStoreName: Certificate store name. Examples:</p>
<ul>
<li><p>"My", "CA" (default), "Root",</p>
</li>
<li><p>"ldap:///CN=Certification Authorities,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?one?objectClass=certificationAuthority" (View Root Certificates)</p>
</li>
<li><p>"ldap:///CN=CAName,CN=Certification Authorities,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?base?objectClass=certificationAuthority" (Modify Root Certificates)</p>
</li>
<li><p>"ldap:///CN=CAName,CN=MachineName,CN=CDP,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?certificateRevocationList?base?objectClass=cRLDistributionPoint" (View CRLs)</p>
</li>
<li><p>"ldap:///CN=NTAuthCertificates,CN=Public Key Services,CN=Services,CN=Configuration,DC=cpandl,DC=com?cACertificate?base?objectClass=certificationAuthority" (Enterprise CA Certificates)</p>
</li>
<li><p>ldap: (AD machine object certificates)</p>
</li>
<li><p>-user ldap: (AD user object certificates)</p>
</li>
</ul>
<p>CertId: Certificate or CRL match token. This can be a serial number, an SHA-1 certificate, CRL, CTL or public key hash, a numeric cert index (0, 1, and so on), a numeric CRL index (.0, .1, and so on), a numeric CTL index (..0, ..1, and so on), a public key, signature or extension ObjectId, a certificate subject Common Name, an e-mail address, UPN or DNS name, a key container name or CSP name, a template name or ObjectId, an EKU or Application Policies ObjectId, or a CRL issuer Common Name. Many of these may result in multiple matches.</p>
<p>OutputFile: file to save matching cert</p>
<p>Use -user to access a user store instead of a machine store.</p>
<p>Use -enterprise to access a machine enterprise store.</p>
<p>Use -service to access a machine service store.</p>
<p>Use -grouppolicy to access a machine group policy store.</p>
<p>Examples:</p>
<ol>
<li><p>-enterprise NTAuth</p>
</li>
<li><p>-enterprise Root 37</p>
</li>
<li><p>-user My 26e0aaaf000000000004</p>
</li>
<li><p>CA .11</p>
</li>
</ol>
<p>[-f] [-enterprise] [-user] [-GroupPolicy] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-dspublish">-dsPublish</h2>
<p>CertUtil [Options] -dsPublish CertFile [NTAuthCA | RootCA | SubCA | CrossCA | KRA | User | Machine]</p>
<p>CertUtil [Options] -dsPublish CRLFile [DSCDPContainer [DSCDPCN]]</p>
<p>Publish certificate or CRL to Active Directory</p>
<p>CertFile: certificate file to publish</p>
<p>NTAuthCA: Publish cert to DS Enterprise store</p>
<p>RootCA: Publish cert to DS Trusted Root store</p>
<p>SubCA: Publish CA cert to DS CA object</p>
<p>CrossCA: Publish cross cert to DS CA object</p>
<p>KRA: Publish cert to DS Key Recovery Agent object</p>
<p>User: Publish cert to User DS object</p>
<p>Machine: Publish cert to Machine DS object</p>
<p>CRLFile: CRL file to publish</p>
<p>DSCDPContainer: DS CDP container CN, usually the CA machine name</p>
<p>DSCDPCN: DS CDP object CN, usually based on the sanitized CA short name and key index</p>
<p>Use -f to create DS object.</p>
<p>[-f] [-user] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-adtemplate">-ADTemplate</h2>
<p>CertUtil [Options] -ADTemplate [Template]</p>
<p>Display AD templates</p>
<p>[-f] [-user] [-ut] [-mt] [-dc DCName]</p>
<h2 id="-template">-Template</h2>
<p>CertUtil [Options] -Template [Template]</p>
<p>Display Enrollment Policy templates</p>
<p>[-f] [-user] [-silent] [-PolicyServer URLOrId] [-Anonymous] [-Kerberos] [-ClientCertificate ClientCertId] [-UserName UserName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-templatecas">-TemplateCAs</h2>
<p>CertUtil [Options] -TemplateCAs Template</p>
<p>Display CAs for template</p>
<p>[-f] [-user] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-catemplates">-CATemplates</h2>
<p>CertUtil [Options] -CATemplates [Template]</p>
<p>Display templates for CA</p>
<p>[-f] [-user] [-ut] [-mt] [-config Machine\CAName] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-setcasites">-SetCASites</h2>
<p>CertUtil [Options] -SetCASites [set] [SiteName]</p>
<p>CertUtil [Options] -SetCASites verify [SiteName]</p>
<p>CertUtil [Options] -SetCASites delete</p>
<p>Set, Verify or Delete CA site names</p>
<ul>
<li><p>Use the -config option to target a single CA (Default is all CAs)</p>
</li>
<li><p><em>SiteName</em> is allowed only when targeting a single CA</p>
</li>
<li><p>Use -f to override validation errors for the specified <em>SiteName</em></p>
</li>
<li><p>Use -f to delete all CA site names</p>
</li>
</ul>
<p>[-f] [-config Machine\CAName] [-dc DCName]</p>
<div class="NOTE">
<p>Note</p>
<p>For more information on configuring CAs for Active Directory Domain Services (AD DS) site awareness, see <a href="https://social.technet.microsoft.com/wiki/contents/articles/14106.ad-ds-site-awareness-for-ad-cs-and-pki-clients.aspx" data-linktype="external">AD DS Site Awareness for AD CS and PKI clients</a>.</p>
</div>
<p>Return to <a href="">Menu</a></p>
<h2 id="-enrollmentserverurl">-enrollmentServerURL</h2>
<p>CertUtil [Options] -enrollmentServerURL [URL AuthenticationType [Priority] [Modifiers]]</p>
<p>CertUtil [Options] -enrollmentServerURL URL delete</p>
<p>Display, add or delete enrollment server URLs associated with a CA</p>
<p>AuthenticationType: Specify one of the following client authentication methods while adding a URL</p>
<ol>
<li><p>Kerberos: Use Kerberos SSL credentials</p>
</li>
<li><p>UserName: Use named account for SSL credentials</p>
</li>
<li><p>ClientCertificate: Use X.509 Certificate SSL credentials</p>
</li>
<li><p>Anonymous: Use anonymous SSL credentials</p>
</li>
</ol>
<p>delete: deletes the specified URL associated with the CA</p>
<p>Priority: defaults to '1' if not specified when adding a URL</p>
<p>Modifiers -- Comma separated list of one or more of the following:</p>
<ol>
<li><p>AllowRenewalsOnly: Only renewal requests can be submitted to this CA via this URL</p>
</li>
<li><p>AllowKeyBasedRenewal: Allows use of a certificate that has no associated account in the AD. This applies only with ClientCertificate and AllowRenewalsOnly Mode</p>
</li>
</ol>
<p>[-config Machine\CAName] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-adca">-ADCA</h2>
<p>CertUtil [Options] -ADCA [CAName]</p>
<p>Display AD CAs</p>
<p>[-f] [-split] [-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-ca">-CA</h2>
<p>CertUtil [Options] -CA [CAName | TemplateName]</p>
<p>Display Enrollment Policy CAs</p>
<p>[-f] [-user] [-silent] [-split] [-PolicyServer URLOrId] [-Anonymous] [-Kerberos] [-ClientCertificate ClientCertId] [-UserName UserName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-policy">-Policy</h2>
<p>Display Enrollment Policy</p>
<p>[-f] [-user] [-silent] [-split] [-PolicyServer URLOrId] [-Anonymous] [-Kerberos] [-ClientCertificate ClientCertId] [-UserName UserName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-policycache">-PolicyCache</h2>
<p>CertUtil [Options] -PolicyCache [delete]</p>
<p>Display or delete Enrollment Policy Cache entries</p>
<p>delete: delete Policy Server cache entries</p>
<p>-f: use -f to delete all cache entries</p>
<p>[-f] [-user] [-PolicyServer URLOrId]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-credstore">-CredStore</h2>
<p>CertUtil [Options] -CredStore [URL]</p>
<p>CertUtil [Options] -CredStore URL add</p>
<p>CertUtil [Options] -CredStore URL delete</p>
<p>Display, add or delete Credential Store entries</p>
<p>URL: target URL. Use * to match all entries. Use https://machine* to match a URL prefix.</p>
<p>add: add a Credential Store entry. SSL credentials must also be specified.</p>
<p>delete: delete Credential Store entries</p>
<p>-f: use -f to overwrite an entry or to delete multiple entries.</p>
<p>[-f] [-user] [-silent] [-Anonymous] [-Kerberos] [-ClientCertificate ClientCertId] [-UserName UserName] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-installdefaulttemplates">-InstallDefaultTemplates</h2>
<p>CertUtil [Options] -InstallDefaultTemplates</p>
<p>Install default certificate templates</p>
<p>[-dc DCName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-urlcache">-URLCache</h2>
<p>CertUtil [Options] -URLCache [URL | CRL | * [delete]]</p>
<p>Display or delete URL cache entries</p>
<p>URL: cached URL</p>
<p>CRL: operate on all cached CRL URLs only</p>
<p>*: operate on all cached URLs</p>
<p>delete: delete relevant URLs from the current user's local cache</p>
<p>Use -f to force fetching a specific URL and updating the cache.</p>
<p>[-f] [-split]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-pulse">-pulse</h2>
<p>CertUtil [Options] -pulse</p>
<p>Pulse autoenrollment events</p>
<p>[-user]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-machineinfo">-MachineInfo</h2>
<p>CertUtil [Options] -MachineInfo DomainName\MachineName$</p>
<p>Display Active Directory computer object information</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-dcinfo">-DCInfo</h2>
<p>CertUtil [Options] -DCInfo [Domain] [Verify | DeleteBad | DeleteAll]</p>
<p>Display domain controller information</p>
<p>Default is to display DC certs without verification</p>
<p>[-f] [-user] [-urlfetch] [-dc DCName] [-t Timeout]</p>
<div class="TIP">
<p>Tip</p>
<p>The ability to specify an Active Directory Domain Services (AD DS) domain <strong>[Domain]</strong> and to specify a domain controller (<strong>-dc</strong>) was added in Windows Server 2012. To successfully run the command, you must use an account that is a member of <strong>Domain Admins</strong> or <strong>Enterprise Admins</strong>. The behavior modifications of this command are as follows:
If a domain is not specified and a specific domain controller is not specified, this option returns a list of domain controllers to process from the default domain controller.
If a domain is not specified, but a domain controller is specified, a report of the certificates on the specified domain controller is generated.
If a domain is specified, but a domain controller is not specified, a list of domain controllers is generated along with reports on the certificates for each domain controller in the list.
If the domain and domain controller are specified, a list of domain controllers is generated from the targeted domain controller. A report of the certificates for each domain controller in the list is also generated.</p>
</div>
<p>For example, assume there is a domain named CPANDL with a domain controller named CPANDL-DC1. You could run the following command to a retrieve a list of domain controllers and their certificates that from CPANDL-DC1: certutil -dc cpandl-dc1 -dcinfo cpandl</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-entinfo">-EntInfo</h2>
<p>CertUtil [Options] -EntInfo DomainName\MachineName$</p>
<p>[-f] [-user]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-tcainfo">-TCAInfo</h2>
<p>CertUtil [Options] -TCAInfo [DomainDN | -]</p>
<p>Display CA information</p>
<p>[-f] [-enterprise] [-user] [-urlfetch] [-dc DCName] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-scinfo">-SCInfo</h2>
<p>CertUtil [Options] -SCInfo [ReaderName [CRYPT_DELETEKEYSET]]</p>
<p>Display smart card information</p>
<p>CRYPT_DELETEKEYSET: Delete all keys on the smart card</p>
<p>[-silent] [-split] [-urlfetch] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-scroots">-SCRoots</h2>
<p>CertUtil [Options] -SCRoots update [+][InputRootFile] [ReaderName]</p>
<p>CertUtil [Options] -SCRoots save <span class="no-loc" dir="ltr" lang="en-us">@OutputRootFile</span> [ReaderName]</p>
<p>CertUtil [Options] -SCRoots view [InputRootFile | ReaderName]</p>
<p>CertUtil [Options] -SCRoots delete [ReaderName]</p>
<p>Manage smart card root certificates</p>
<p>[-f] [-split] [-p Password]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-verifykeys">-verifykeys</h2>
<p>CertUtil [Options] -verifykeys [KeyContainerName CACertFile]</p>
<p>Verify public/private key set</p>
<p>KeyContainerName: key container name of the key to verify. Defaults to machine keys. Use -user for user keys.</p>
<p>CACertFile: signing or encryption certificate file</p>
<p>If no arguments are specified, each signing CA cert is verified against its private key.</p>
<p>This operation can only be performed against a local CA or local keys.</p>
<p>[-f] [-user] [-silent] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-verify">-verify</h2>
<p>CertUtil [Options] -verify CertFile [ApplicationPolicyList | - [IssuancePolicyList]]</p>
<p>CertUtil [Options] -verify CertFile [CACertFile [CrossedCACertFile]]</p>
<p>CertUtil [Options] -verify CRLFile CACertFile [IssuedCertFile]</p>
<p>CertUtil [Options] -verify CRLFile CACertFile [DeltaCRLFile]</p>
<p>Verify certificate, CRL or chain</p>
<p>CertFile: Certificate to verify</p>
<p>ApplicationPolicyList: optional comma separated list of required Application Policy ObjectIds</p>
<p>IssuancePolicyList: optional comma separated list of required Issuance Policy ObjectIds</p>
<p>CACertFile: optional issuing CA certificate to verify against</p>
<p>CrossedCACertFile: optional certificate cross-certified by CertFile</p>
<p>CRLFile: CRL to verify</p>
<p>IssuedCertFile: optional issued certificate covered by CRLFile</p>
<p>DeltaCRLFile: optional delta CRL</p>
<p>If ApplicationPolicyList is specified, chain building is restricted to chains valid for the specified Application Policies.</p>
<p>If IssuancePolicyList is specified, chain building is restricted to chains valid for the specified Issuance Policies.</p>
<p>If CACertFile is specified, fields in CACertFile are verified against CertFile or CRLFile.</p>
<p>If CACertFile is not specified, CertFile is used to build and verify a full chain.</p>
<p>If CACertFile and CrossedCACertFile are both specified, fields in CACertFile and CrossedCACertFile are verified against CertFile.</p>
<p>If IssuedCertFile is specified, fields in IssuedCertFile are verified against CRLFile.</p>
<p>If DeltaCRLFile is specified, fields in DeltaCRLFile are verified against CRLFile.</p>
<p>[-f] [-enterprise] [-user] [-silent] [-split] [-urlfetch] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-verifyctl">-verifyCTL</h2>
<p>CertUtil [Options] -verifyCTL CTLObject [CertDir] [CertFile]</p>
<p>Verify AuthRoot or Disallowed Certificates CTL</p>
<p>CTLObject: Identifies the CTL to verify:</p>
<ul>
<li><p>AuthRootWU: read AuthRoot CAB and matching certificates from the URL cache. Use -f to download from Windows Update instead.</p>
</li>
<li><p>DisallowedWU: read Disallowed Certificates CAB and disallowed certificate store file from the URL cache. Use -f to download from Windows Update instead.</p>
</li>
<li><p>AuthRoot: read registry cached AuthRoot CTL. Use with -f and a CertFile that is not already trusted to force updating the registry cached AuthRoot and Disallowed Certificate CTLs.</p>
</li>
<li><p>Disallowed: read registry cached Disallowed Certificates CTL. -f has the same behavior as with AuthRoot.</p>
</li>
<li><p>CTLFileName: file or http: path to CTL or CAB</p>
</li>
</ul>
<p>CertDir: folder containing certificates matching CTL entries. An http: folder path must end with a path separator. If a folder is not specified with AuthRoot or Disallowed, multiple locations will be searched for matching certificates: local certificate stores, crypt32.dll resources and the local URL cache. Use -f to download from Windows Update when necessary. Otherwise defaults to the same folder or web site as the CTLObject.</p>
<p>CertFile: file containing certificate(s) to verify. Certificates will be matched against CTL entries, and match results displayed. Suppresses most of the default output.</p>
<p>[-f] [-user] [-split]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-sign">-sign</h2>
<p>CertUtil [Options] -sign InFileList|SerialNumber|CRL OutFileList [StartDate+dd:hh] [+SerialNumberList | -SerialNumberList | -ObjectIdList | <span class="no-loc" dir="ltr" lang="en-us">@ExtensionFile\</span>]</p>
<p>CertUtil [Options] -sign InFileList|SerialNumber|CRL OutFileList [#HashAlgorithm] [+AlternateSignatureAlgorithm | -AlternateSignatureAlgorithm]</p>
<p>Re-sign CRL or certificate</p>
<p>InFileList: comma separated list of Certificate or CRL files to modify and re-sign</p>
<p>SerialNumber: Serial number of certificate to create. Validity period and other options must not be present.</p>
<p>CRL: Create an empty CRL. Validity period and other options must not be present.</p>
<p>OutFileList: comma separated list of modified Certificate or CRL output files. The number of files must match InFileList.</p>
<p>StartDate+dd:hh: new validity period: optional date plus; optional days and hours validity period; If both are specified, use a plus sign (+) separator. Use "now[+dd:hh]" to start at the current time. Use "never" to have no expiration date (for CRLs only).</p>
<p>SerialNumberList: comma separated serial number list to add or remove</p>
<p>ObjectIdList: comma separated extension ObjectId list to remove</p>
<p><span class="no-loc" dir="ltr" lang="en-us">@ExtensionFile</span>: INF file containing extensions to update or remove:</p>
<pre><code>[Extensions]
     2.5.29.31 = ; Remove CRL Distribution Points extension
     2.5.29.15 = "{hex}" ; Update Key Usage extension
     _continue_="03 02 01 86"
</code></pre>
<p>HashAlgorithm: Name of the hash algorithm preceded by a # sign</p>
<p>AlternateSignatureAlgorithm: alternate Signature algorithm specifier</p>
<p>A minus sign causes serial numbers and extensions to be removed. A plus sign causes serial numbers to be added to a CRL. When removing items from a CRL, the list may contain both serial numbers and ObjectIds. A minus sign before AlternateSignatureAlgorithm causes the legacy signature format to be used. A plus sign before AlternateSignatureAlgorithm causes the alternature signature format to be used. If AlternateSignatureAlgorithm is not specified then the signature format in the certificate or CRL is used.</p>
<p>[-nullsign] [-f] [-silent] [-Cert CertId]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-vroot">-vroot</h2>
<p>CertUtil [Options] -vroot [delete]</p>
<p>Create/delete web virtual roots and file shares</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-vocsproot">-vocsproot</h2>
<p>CertUtil [Options] -vocsproot [delete]</p>
<p>Create/delete web virtual roots for OCSP web proxy</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-addenrollmentserver">-addEnrollmentServer</h2>
<p>CertUtil [Options] -addEnrollmentServer Kerberos | UserName | ClientCertificate [AllowRenewalsOnly] [AllowKeyBasedRenewal]</p>
<p>Add an Enrollment Server application</p>
<p>Add an Enrollment Server application and application pool if necessary, for the specified CA. This command does not install binaries or packages. One of the following authentication methods with which the client connects to a Certificate Enrollment Server.</p>
<ul>
<li><p>Kerberos: Use Kerberos SSL credentials</p>
</li>
<li><p>UserName: Use named account for SSL credentials</p>
</li>
<li><p>ClientCertificate: Use X.509 Certificate SSL credentials</p>
</li>
<li><p>AllowRenewalsOnly: Only renewal requests can be submitted to this CA via this URL</p>
</li>
<li><p>AllowKeyBasedRenewal -- Allows use of a certificate that has no associated account in the AD. This applies only with ClientCertificate and AllowRenewalsOnly mode.</p>
</li>
</ul>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-deleteenrollmentserver">-deleteEnrollmentServer</h2>
<p>CertUtil [Options] -deleteEnrollmentServer Kerberos | UserName | ClientCertificate</p>
<p>Delete an Enrollment Server application</p>
<p>Delete an Enrollment Server application and application pool if necessary, for the specified CA. This command does not remove binaries or packages. One of the following authentication methods with which the client connects to a Certificate Enrollment Server.</p>
<ol>
<li><p>Kerberos: Use Kerberos SSL credentials</p>
</li>
<li><p>UserName: Use named account for SSL credentials</p>
</li>
<li><p>ClientCertificate: Use X.509 Certificate SSL credentials</p>
</li>
</ol>
<p>[-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-addpolicyserver">-addPolicyServer</h2>
<p>CertUtil [Options] -addPolicyServer Kerberos | UserName | ClientCertificate [KeyBasedRenewal]</p>
<p>Add a Policy Server application</p>
<p>Add a Policy Server application and application pool if necessary. This command does not install binaries or packages. One of the following authentication methods with which the client connects to a Certificate Policy Server:</p>
<ul>
<li><p>Kerberos: Use Kerberos SSL credentials</p>
</li>
<li><p>UserName: Use named account for SSL credentials</p>
</li>
<li><p>ClientCertificate: Use X.509 Certificate SSL credentials</p>
</li>
<li><p>KeyBasedRenewal: Only policies that contain KeyBasedRenewal templates are returned to the client. This flag applies only for UserName and ClientCertificate authentication.</p>
</li>
</ul>
<p>Return to <a href="">Menu</a></p>
<h2 id="-deletepolicyserver">-deletePolicyServer</h2>
<p>CertUtil [Options] -deletePolicyServer Kerberos | UserName | ClientCertificate [KeyBasedRenewal]</p>
<p>Delete a Policy Server application</p>
<p>Delete a Policy Server application and application pool if necessary. This command does not remove binaries or packages. One of the following authentication methods with which the client connects to a Certificate Policy Server:</p>
<ol>
<li><p>Kerberos: Use Kerberos SSL credentials</p>
</li>
<li><p>UserName: Use named account for SSL credentials</p>
</li>
<li><p>ClientCertificate: Use X.509 Certificate SSL credentials</p>
</li>
<li><p>KeyBasedRenewal: KeyBasedRenewal policy server</p>
</li>
</ol>
<p>Return to <a href="">Menu</a></p>
<h2 id="-oid">-oid</h2>
<p>CertUtil [Options] -oid ObjectId [DisplayName | delete [LanguageId [Type]]]</p>
<p>CertUtil [Options] -oid GroupId</p>
<p>CertUtil [Options] -oid AlgId | AlgorithmName [GroupId]</p>
<p>Display ObjectId or set display name</p>
<ul>
<li><p>ObjectId -- ObjectId to display or to add display name</p>
</li>
<li><p>GroupId -- decimal GroupId number for ObjectIds to enumerate</p>
</li>
<li><p>AlgId -- hexadecimal AlgId for ObjectId to look up</p>
</li>
<li><p>AlgorithmName -- Algorithm Name for ObjectId to look up</p>
</li>
<li><p>DisplayName -- Display Name to store in DS</p>
</li>
<li><p>delete -- delete display name</p>
</li>
<li><p>LanguageId -- Language Id (defaults to current: 1033)</p>
</li>
<li><p>Type -- DS object type to create: 1 for Template (default), 2 for Issuance Policy, 3 for Application Policy</p>
</li>
<li><p>Use -f to create DS object.</p>
</li>
</ul>
<p>[-f]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-error">-error</h2>
<p>CertUtil [Options] -error ErrorCode</p>
<p>Display error code message text</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-getreg">-getreg</h2>
<p>CertUtil [Options] -getreg [{ca|restore|policy|exit|template|enroll|chain|PolicyServers}\[ProgId\]][RegistryValueName]</p>
<p>Display registry value</p>
<p>ca: Use CA's registry key</p>
<p>restore: Use CA's restore registry key</p>
<p>policy: Use policy module's registry key</p>
<p>exit: Use first exit module's registry key</p>
<p>template: Use template registry key (use -user for user templates)</p>
<p>enroll: Use enrollment registry key (use -user for user context)</p>
<p>chain: Use chain configuration registry key</p>
<p>PolicyServers: Use Policy Servers registry key</p>
<p>ProgId: Use policy or exit module's ProgId (registry subkey name)</p>
<p>RegistryValueName: registry value name (use "Name*" to prefix match)</p>
<p>Value: new numeric, string or date registry value or filename. If a numeric value starts with "+" or "-", the bits specified in the new value are set or cleared in the existing registry value.</p>
<p>If a string value starts with "+" or "-", and the existing value is a REG_MULTI_SZ value, the string is added to or removed from the existing registry value. To force creation of a REG_MULTI_SZ value, add a "\n" to the end of the string value.</p>
<p>If the value starts with "@", the rest of the value is the name of the file containing the hexadecimal text representation of a binary value. If it does not refer to a valid file, it is instead parsed as [Date][+|-][dd:hh] -- an optional date plus or minus optional days and hours. If both are specified, use a plus sign (+) or minus sign (-) separator. Use "now+dd:hh" for a date relative to the current time.</p>
<p>Use "chain\ChainCacheResyncFiletime <span class="no-loc" dir="ltr" lang="en-us">@now</span>" to effectively flush cached CRLs.</p>
<p>[-f] [-user] [-GroupPolicy] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-setreg">-setreg</h2>
<p>CertUtil [Options] -setreg [{ca|restore|policy|exit|template|enroll|chain|PolicyServers}\[ProgId\]]RegistryValueName Value</p>
<p>Set registry value</p>
<p>ca: Use CA's registry key</p>
<p>restore: Use CA's restore registry key</p>
<p>policy: Use policy module's registry key</p>
<p>exit: Use first exit module's registry key</p>
<p>template: Use template registry key (use -user for user templates)</p>
<p>enroll: Use enrollment registry key (use -user for user context)</p>
<p>chain: Use chain configuration registry key</p>
<p>PolicyServers: Use Policy Servers registry key</p>
<p>ProgId: Use policy or exit module's ProgId (registry subkey name)</p>
<p>RegistryValueName: registry value name (use "Name*" to prefix match)</p>
<p>Value: new numeric, string or date registry value or filename. If a numeric value starts with "+" or "-", the bits specified in the new value are set or cleared in the existing registry value.</p>
<p>If a string value starts with "+" or "-", and the existing value is a REG_MULTI_SZ value, the string is added to or removed from the existing registry value. To force creation of a REG_MULTI_SZ value, add a "\n" to the end of the string value.</p>
<p>If the value starts with "@", the rest of the value is the name of the file containing the hexadecimal text representation of a binary value. If it does not refer to a valid file, it is instead parsed as [Date][+|-][dd:hh] -- an optional date plus or minus optional days and hours. If both are specified, use a plus sign (+) or minus sign (-) separator. Use "now+dd:hh" for a date relative to the current time.</p>
<p>Use "chain\ChainCacheResyncFiletime <span class="no-loc" dir="ltr" lang="en-us">@now</span>" to effectively flush cached CRLs.</p>
<p>[-f] [-user] [-GroupPolicy] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-delreg">-delreg</h2>
<p>CertUtil [Options] -delreg [{ca|restore|policy|exit|template|enroll|chain|PolicyServers}\[ProgId\]][RegistryValueName]</p>
<p>Delete registry value</p>
<p>ca: Use CA's registry key</p>
<p>restore: Use CA's restore registry key</p>
<p>policy: Use policy module's registry key</p>
<p>exit: Use first exit module's registry key</p>
<p>template: Use template registry key (use -user for user templates)</p>
<p>enroll: Use enrollment registry key (use -user for user context)</p>
<p>chain: Use chain configuration registry key</p>
<p>PolicyServers: Use Policy Servers registry key</p>
<p>ProgId: Use policy or exit module's ProgId (registry subkey name)</p>
<p>RegistryValueName: registry value name (use "Name*" to prefix match)</p>
<p>Value: new numeric, string or date registry value or filename. If a numeric value starts with "+" or "-", the bits specified in the new value are set or cleared in the existing registry value.</p>
<p>If a string value starts with "+" or "-", and the existing value is a REG_MULTI_SZ value, the string is added to or removed from the existing registry value. To force creation of a REG_MULTI_SZ value, add a "\n" to the end of the string value.</p>
<p>If the value starts with "@", the rest of the value is the name of the file containing the hexadecimal text representation of a binary value. If it does not refer to a valid file, it is instead parsed as [Date][+|-][dd:hh] -- an optional date plus or minus optional days and hours. If both are specified, use a plus sign (+) or minus sign (-) separator. Use "now+dd:hh" for a date relative to the current time.</p>
<p>Use "chain\ChainCacheResyncFiletime <span class="no-loc" dir="ltr" lang="en-us">@now</span>" to effectively flush cached CRLs.</p>
<p>[-f] [-user] [-GroupPolicy] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-importkms">-ImportKMS</h2>
<p>CertUtil [Options] -ImportKMS UserKeyAndCertFile [CertId]</p>
<p>Import user keys and certificates into server database for key archival</p>
<p>UserKeyAndCertFile -- Data file containing user private keys and certificates to be archived. This can be any of the following:</p>
<ul>
<li><p>Exchange Key Management Server (KMS) export file</p>
</li>
<li><p>PFX file</p>
</li>
</ul>
<p>CertId: KMS export file decryption certificate match token. See <a href="">-store</a>.</p>
<p>Use -f to import certificates not issued by the CA.</p>
<p>[-f] [-silent] [-split] [-config Machine\CAName] [-p Password] [-symkeyalg SymmetricKeyAlgorithm[,KeyLength]]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-importcert">-ImportCert</h2>
<p>CertUtil [Options] -ImportCert Certfile [ExistingRow]</p>
<p>Import a certificate file into the database</p>
<p>Use ExistingRow to import the certificate in place of a pending request for the same key.</p>
<p>Use -f to import certificates not issued by the CA.</p>
<p>The CA may also need to be configured to support foreign certificate import: certutil -setreg ca\KRAFlags +KRAF_ENABLEFOREIGN</p>
<p>[-f] [-config Machine\CAName]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-getkey">-GetKey</h2>
<p>CertUtil [Options] -GetKey SearchToken [RecoveryBlobOutFile]</p>
<p>CertUtil [Options] -GetKey SearchToken script OutputScriptFile</p>
<p>CertUtil [Options] -GetKey SearchToken retrieve | recover OutputFileBaseName</p>
<p>Retrieve archived private key recovery blob, generate a recovery script, or recover archived keys</p>
<p>script: generate a script to retrieve and recover keys (default behavior if multiple matching recovery candidates are found, or if the output file is not specified).</p>
<p>retrieve: retrieve one or more Key Recovery Blobs (default behavior if exactly one matching recovery candidate is found, and if the output file is specified)</p>
<p>recover: retrieve and recover private keys in one step (requires Key Recovery Agent certificates and private keys)</p>
<p>SearchToken: Used to select the keys and certificates to be recovered.</p>
<p>Can be any of the following:</p>
<ol>
<li><p>Certificate Common Name</p>
</li>
<li><p>Certificate Serial Number</p>
</li>
<li><p>Certificate SHA-1 hash (thumbprint)</p>
</li>
<li><p>Certificate KeyId SHA-1 hash (Subject Key Identifier)</p>
</li>
<li><p>Requester Name (domain\user)</p>
</li>
<li><p>UPN (user@domain)</p>
</li>
</ol>
<p>RecoveryBlobOutFile: output file containing a certificate chain and an associated private key, still encrypted to one or more Key Recovery Agent certificates.</p>
<p>OutputScriptFile: output file containing a batch script to retrieve and recover private keys.</p>
<p>OutputFileBaseName: output file base name. For retrieve, any extension is truncated and a certificate-specific string and the .rec extension are appended for each key recovery blob. Each file contains a certificate chain and an associated private key, still encrypted to one or more Key Recovery Agent certificates. For recover, any extension is truncated and the .p12 extension is appended. Contains the recovered certificate chains and associated private keys, stored as a PFX file.</p>
<p>[-f] [-UnicodeText] [-silent] [-config Machine\CAName] [-p Password] [-ProtectTo SAMNameAndSIDList] [-csp Provider]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-recoverkey">-RecoverKey</h2>
<p>CertUtil [Options] -RecoverKey RecoveryBlobInFile [PFXOutFile [RecipientIndex]]</p>
<p>Recover archived private key</p>
<p>[-f] [-user] [-silent] [-split] [-p Password] [-ProtectTo SAMNameAndSIDList] [-csp Provider] [-t Timeout]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-mergepfx">-MergePFX</h2>
<p>CertUtil [Options] -MergePFX PFXInFileList PFXOutFile [ExtendedProperties]</p>
<p>PFXInFileList: Comma separated PFX input file list</p>
<p>PFXOutFile: PFX output file</p>
<p>ExtendedProperties: Include extended properties</p>
<p>The password specified on the command line is a comma separated password list. If more than one password is specified, the last password is used for the output file. If only one password is provided or if the last password is "*", the user will be prompted for the output file password.</p>
<p>[-f] [-user] [-split] [-p Password] [-ProtectTo SAMNameAndSIDList] [-csp Provider]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="-convertepf">-ConvertEPF</h2>
<p>CertUtil [Options] -ConvertEPF PFXInFileList EPFOutFile [cast | cast-] [V3CACertId][,Salt]</p>
<p>Convert PFX files to EPF file</p>
<p>PFXInFileList: Comma separated PFX input file list</p>
<p>EPF: EPF output file</p>
<p>cast: Use CAST 64 encryption</p>
<p>cast-: Use CAST 64 encryption (export)</p>
<p>V3CACertId: V3 CA Certificate match token. See <a href="">-store</a> CertId description.</p>
<p>Salt: EPF output file salt string</p>
<p>The password specified on the command line is a comma separated password list. If more than one password is specified, the last password is used for the output file. If only one password is provided or if the last password is "*", the user will be prompted for the output file password.</p>
<p>[-f] [-silent] [-split] [-dc DCName] [-p Password] [-csp Provider]</p>
<p>Return to <a href="">Menu</a></p>
<h2 id="options">Options</h2>
<p>This section defines the options that you can specify with the command.</p>
<table>
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr class="header">
<th><p>Options</p></th>
<th><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>-nullsign</p></td>
<td><p>Use hash of data as signature</p></td>
</tr>
<tr class="even">
<td><p>-f</p></td>
<td><p>Force overwrite</p></td>
</tr>
<tr class="odd">
<td><p>-enterprise</p></td>
<td><p>Use local machine Enterprise registry certificate store</p></td>
</tr>
<tr class="even">
<td><p>-user</p></td>
<td><p>Use HKEY_CURRENT_USER keys or certificate store</p></td>
</tr>
<tr class="odd">
<td><p>-GroupPolicy</p></td>
<td><p>Use Group Policy certificate store</p></td>
</tr>
<tr class="even">
<td><p>-ut</p></td>
<td><p>Display user templates</p></td>
</tr>
<tr class="odd">
<td><p>-mt</p></td>
<td><p>Display machine templates</p></td>
</tr>
<tr class="even">
<td><p>-Unicode</p></td>
<td><p>Write redirected output in Unicode</p></td>
</tr>
<tr class="odd">
<td><p>-UnicodeText</p></td>
<td><p>Write output file in Unicode</p></td>
</tr>
<tr class="even">
<td><p>-gmt</p></td>
<td><p>Display times as GMT</p></td>
</tr>
<tr class="odd">
<td><p>-seconds</p></td>
<td><p>Display times with seconds and milliseconds</p></td>
</tr>
<tr class="even">
<td><p>-silent</p></td>
<td><p>Use silent flag to acquire crypt context</p></td>
</tr>
<tr class="odd">
<td><p>-split</p></td>
<td><p>Split embedded ASN.1 elements, and save to files</p></td>
</tr>
<tr class="even">
<td><p>-v</p></td>
<td><p>Verbose operation</p></td>
</tr>
<tr class="odd">
<td><p>-privatekey</p></td>
<td><p>Display password and private key data</p></td>
</tr>
<tr class="even">
<td><p>-pin PIN</p></td>
<td><p>Smart Card PIN</p></td>
</tr>
<tr class="odd">
<td><p>-urlfetch</p></td>
<td><p>Retrieve and verify AIA Certs and CDP CRLs</p></td>
</tr>
<tr class="even">
<td><p>-config Machine\CAName</p></td>
<td><p>CA and computer name string</p></td>
</tr>
<tr class="odd">
<td><p>-PolicyServer URLOrId</p></td>
<td><p>Policy Server URL or Id. For selection U/I, use -PolicyServer. For all Policy Servers, use -PolicyServer *</p></td>
</tr>
<tr class="even">
<td><p>-Anonymous</p></td>
<td><p>Use anonymous SSL credentials</p></td>
</tr>
<tr class="odd">
<td><p>-Kerberos</p></td>
<td><p>Use Kerberos SSL credentials</p></td>
</tr>
<tr class="even">
<td><p>-ClientCertificate ClientCertId</p></td>
<td><p>Use X.509 Certificate SSL credentials. For selection U/I, use -clientCertificate.</p></td>
</tr>
<tr class="odd">
<td><p>-UserName UserName</p></td>
<td><p>Use named account for SSL credentials. For selection U/I, use -UserName.</p></td>
</tr>
<tr class="even">
<td><p>-Cert CertId</p></td>
<td><p>Signing certificate</p></td>
</tr>
<tr class="odd">
<td><p>-dc DCName</p></td>
<td><p>Target a specific Domain Controller</p></td>
</tr>
<tr class="even">
<td><p>-restrict RestrictionList</p></td>
<td><p>Comma separated Restriction List. Each restriction consists of a column name, a relational operator and a constant integer, string or date. One column name may be preceded by a plus or minus sign to indicate the sort order. Examples:</p>
<p>"RequestId = 47"</p>
<p>"+RequesterName &gt;= a, RequesterName &lt; b"</p>
<p>"-RequesterName &gt; DOMAIN, Disposition = 21"</p></td>
</tr>
<tr class="odd">
<td><p>-out ColumnList</p></td>
<td><p>Comma separated Column List</p></td>
</tr>
<tr class="even">
<td><p>-p Password</p></td>
<td><p>Password</p></td>
</tr>
<tr class="odd">
<td><p>-ProtectTo SAMNameAndSIDList</p></td>
<td><p>Comma separated SAM Name/SID List</p></td>
</tr>
<tr class="even">
<td><p>-csp Provider</p></td>
<td><p>Provider</p></td>
</tr>
<tr class="odd">
<td><p>-t Timeout</p></td>
<td><p>URL fetch timeout in milliseconds</p></td>
</tr>
<tr class="even">
<td><p>-symkeyalg SymmetricKeyAlgorithm[,KeyLength]</p></td>
<td><p>Name of Symmetric Key Algorithm with optional key length, example: AES,128 or 3DES</p></td>
</tr>
</tbody>
</table>
<p>Return to <a href="">Menu</a></p>
<h2 id="additional-certutil-examples">Additional certutil examples</h2>
<p>For some examples of how to use this command, see</p>
<ol>
<li><p><a href="https://social.technet.microsoft.com/wiki/contents/articles/3063.certutil-examples-for-managing-active-directory-certificate-services-ad-cs-from-the-command-line.aspx" data-linktype="external">Certutil Examples for Managing Active Directory Certificate Services (AD CS) from the Command Line</a></p>
</li>
<li><p><a href="https://technet.microsoft.com/library/cc772898.aspx" data-linktype="external">Certutil tasks for managing certificates</a></p>
</li>
<li><p><a href="https://social.technet.microsoft.com/wiki/contents/articles/7573.active-directory-certificate-services-pki-key-archival-and-management.aspx" data-linktype="external">Binary Request Export Using the CertUtil.exe Command-Line Tool Walkthrough</a></p>
</li>
<li><p><a href="https://social.technet.microsoft.com/wiki/contents/articles/2016.root-ca-certificate-renewal.aspx" data-linktype="external">Root CA certificate renewal</a></p>
</li>
<li><p><a href="https://msdn.microsoft.com/subscriptions/cc773087.aspx" data-linktype="external">Certutil</a></p>
</li>
</ol>
<p>Return to <a href="">Menu</a></p>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>