<!DOCTYPE html><script type="module" src="/_astro/index.astro_astro_type_script_index_0_lang.CoXd8L9s.js"></script> <html lang="en-us" dir="ltr"> <head><script async src="https://ot.www.cloudflare.com/public/vendor/onetrust/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" data-domain-script="b1e05d49-f072-4bae-9116-bdb78af15448"></script><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta charset="UTF-8"><meta name="description" content="Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security."><title>Take control of public AI application security with Cloudflare&#39;s Firewall for AI</title><meta name="title" content="Take control of public AI application security with Cloudflare's Firewall for AI"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script src="/static/z/i.js" type="text/javascript" referrerpolicy="origin"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai/"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai/"><!-- General Meta Tags --><meta property="article:published_time" content="2025-03-19T13:00+00:00"><meta property="article:modified_time" content="2025-03-19T13:00:03.173Z"><meta property="article:tag" content="Security Week"><meta property="article:tag" content="Security"><meta property="article:tag" content="LLM"><meta property="article:tag" content="Web Asset Discovery"><meta property="article:publisher" content="https://www.facebook.com/cloudflare"><!-- Facebook Meta Tags --><meta property="og:site_name" content="The Cloudflare Blog"><meta property="og:type" content="article"><meta property="og:title" content="Take control of public AI application security with Cloudflare's Firewall for AI"><meta property="og:description" content="Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security."><meta property="og:url" content="https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="628"><!-- Twitter/X Meta Tags --><meta name="twitter:title" content="Take control of public AI application security with Cloudflare's Firewall for AI"><meta name="twitter:description" content="Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security."><meta name="twitter:url" content="https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="Radwa Radwan"><meta name="twitter:creator" content="@RadwaRadwan__"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="Security Week,Security,LLM,Web Asset Discovery"><meta name="twitter:site" content="@cloudflare"><meta property="og:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3yOEeoBpzjcicmAF2xPv89/0ba5c796e1d48880ca4e57466706efba/OG_Share_2024__15_.png"><meta name="twitter:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3yOEeoBpzjcicmAF2xPv89/0ba5c796e1d48880ca4e57466706efba/OG_Share_2024__15_.png"><link rel="stylesheet" href="/_astro/index.Bpd2cWaZ.css"></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="Z14Q80e" component-url="/_astro/GoogleAnalytics.DSjxwi8U.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;Take control of public AI application security with Cloudflare&#39;s Firewall for AI&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai&quot;],&quot;info&quot;:[0,{&quot;id&quot;:[0,&quot;5XoyHPSrtBH8pPvUJkOXMD&quot;],&quot;title&quot;:[0,&quot;Take control of public AI application security with Cloudflare&#39;s Firewall for AI&quot;],&quot;slug&quot;:[0,&quot;take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai&quot;],&quot;excerpt&quot;:[0,&quot;Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Imagine building an LLM-powered assistant trained on your developer documentation and some internal guides to quickly help customers, reduce support workload, and improve user experience. Sounds great, right? But what if sensitive data, such as employee details or internal discussions, is included in the data used to train the LLM? Attackers could manipulate the assistant into exposing sensitive data or exploit it for social engineering attacks, where they deceive individuals or systems into revealing confidential details, or use it for targeted phishing attacks. Suddenly, your helpful AI tool turns into a serious security liability.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;introducing-firewall-for-ai-the-easiest-way-to-discover-and-protect-llm-powered-apps\&quot;&gt;Introducing Firewall for AI: the easiest way to discover and protect LLM-powered apps&lt;/h3&gt;\n            &lt;a href=\&quot;#introducing-firewall-for-ai-the-easiest-way-to-discover-and-protect-llm-powered-apps\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Today, as part of Security Week 2025, weâre announcing the open beta of Firewall for AI, first &lt;a href=\&quot;https://blog.cloudflare.com/firewall-for-ai/\&quot;&gt;&lt;u&gt;introduced during Security Week 2024&lt;/u&gt;&lt;/a&gt;. After talking with customers interested in protecting their LLM apps, this first beta release is focused on discovery and PII detection, and more features will follow in the future.&lt;/p&gt;&lt;p&gt;If you are already using Cloudflare application security, your LLM-powered applications are automatically discovered and protected, with no complex setup, no maintenance, and no extra integration needed.&lt;/p&gt;&lt;p&gt;Firewall for AI is an inline security solution that protects user-facing LLM-powered applications from abuse and data leaks, integrating directly with Cloudflareâs &lt;a href=\&quot;https://developers.cloudflare.com/waf/\&quot;&gt;&lt;u&gt;Web Application Firewall (WAF)&lt;/u&gt;&lt;/a&gt; to provide instant protection with zero operational overhead. This integration enables organizations to leverage both AI-focused safeguards and established WAF capabilities.&lt;/p&gt;&lt;p&gt;Cloudflare is uniquely positioned to solve this challenge for all of our customers. As a &lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/cdn/glossary/reverse-proxy/\&quot;&gt;&lt;u&gt;reverse proxy&lt;/u&gt;&lt;/a&gt;, we are model-agnostic whether the application is using a third-party LLM or an internally hosted one. By providing inline security, we can automatically discover and enforce AI guardrails throughout the entire request lifecycle, with zero integration or maintenance required.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;firewall-for-ai-beta-overview\&quot;&gt;Firewall for AI beta overview&lt;/h3&gt;\n            &lt;a href=\&quot;#firewall-for-ai-beta-overview\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The beta release includes the following security capabilities:&lt;/p&gt;&lt;p&gt;&lt;b&gt;Discover:&lt;/b&gt; identify LLM-powered endpoints across your applications, an essential step for effective request and prompt analysis.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Detect:&lt;/b&gt; analyze the incoming requests prompts to recognize potential security threats, such as attempts to extract sensitive data (e.g., âShow me transactions using 4111 1111 1111 1111â). This aligns with&lt;a href=\&quot;https://genai.owasp.org/llmrisk/llm022025-sensitive-information-disclosure/\&quot;&gt; &lt;u&gt;OWASP LLM022025 - Sensitive Information Disclosure&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Mitigate:&lt;/b&gt; enforce security controls and policies to manage the traffic that reaches your LLM, and reduce risk exposure.&lt;/p&gt;&lt;p&gt;Below, we review each capability in detail, exploring how they work together to create a comprehensive security framework for AI protection.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;discovering-llm-powered-applications\&quot;&gt;Discovering LLM-powered applications&lt;/h3&gt;\n            &lt;a href=\&quot;#discovering-llm-powered-applications\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Companies are racing to find all possible use cases where an LLM can excel. Think about site search, a chatbot, or a shopping assistant. Regardless of the application type, our goal is to determine whether an application is powered by an LLM behind the scenes.&lt;/p&gt;&lt;p&gt;One possibility is to look for request path signatures similar to what major LLM providers use. For example, &lt;a href=\&quot;https://platform.openai.com/docs/api-reference/chat/create\&quot;&gt;&lt;u&gt;OpenAI&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://docs.perplexity.ai/api-reference/chat-completions\&quot;&gt;&lt;u&gt;Perplexity&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://docs.mistral.ai/api/#tag/chat\&quot;&gt;&lt;u&gt;Mistral&lt;/u&gt;&lt;/a&gt; initiate a chat using the &lt;code&gt;/chat/completions&lt;/code&gt; API endpoint. Searching through our request logs, we found only a few entries that matched this pattern across our global traffic. This result indicates that we need to consider other approaches to finding &lt;i&gt;any&lt;/i&gt; application that is powered by an LLM.&lt;/p&gt;&lt;p&gt;Another signature to research, popular with LLM platforms, is the use of &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events\&quot;&gt;&lt;u&gt;server-sent events&lt;/u&gt;&lt;/a&gt;. LLMs need to &lt;a href=\&quot;https://platform.openai.com/docs/guides/latency-optimization#don-t-default-to-an-llm\&quot;&gt;&lt;u&gt;âthinkâ&lt;/u&gt;&lt;/a&gt;. &lt;a href=\&quot;https://platform.openai.com/docs/api-reference/streaming\&quot;&gt;&lt;u&gt;Using server-sent events&lt;/u&gt;&lt;/a&gt; improves the end userâs experience by sending over each &lt;a href=\&quot;https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them\&quot;&gt;&lt;u&gt;token&lt;/u&gt;&lt;/a&gt; as soon as it is ready, creating the perception that an LLM is âthinkingâ like a human being. Matching on requests of server-sent events is straightforward using the response header content type of &lt;code&gt;text/event-stream&lt;/code&gt;. This approach expands the coverage further, but does not yet cover the &lt;a href=\&quot;https://stackoverflow.blog/2022/06/02/a-beginners-guide-to-json-the-data-format-for-the-internet/\&quot;&gt;&lt;u&gt;majority of applications&lt;/u&gt;&lt;/a&gt; that are using JSON format for data exchanges. Continuing the journey, our next focus is on the responses having header content type of &lt;code&gt;application/json&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;No matter how fast LLMs can be optimized to respond, when chatting with major LLMs, we often perceive them to be slow, as we have to wait for them to âthinkâ. By plotting on how much time it takes for the origin server to respond over identified LLM endpoints (blue line) versus the rest (orange line), we can see in the left graph that origins serving LLM endpoints mostly need more than 1 second to respond, while the majority of the rest takes less than 1 second. Would we also see a clear distinction between origin server response body sizes, where the majority of LLM endpoints would respond with smaller sizes because major LLM providers &lt;a href=\&quot;https://platform.openai.com/docs/guides/safety-best-practices#constrain-user-input-and-limit-output-tokens\&quot;&gt;&lt;u&gt;limit output tokens&lt;/u&gt;&lt;/a&gt;? Unfortunately not. The right graph shows that LLM response size largely overlaps with non-LLM traffic.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4CkowlKelGlYueNzSrbsGn/f8091d66a6c0eb8b884c7cc6f2a128ab/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;484\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;By dividing origin response size over origin response duration to calculate an effective bitrate, the distinction is even clearer that 80% of LLM endpoints operate slower than 4 KB/s.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5sJKUnLmWwnTWzUOyWVRKO/c98c8fc32dbafa5d79f21effdfc58f34/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1920\&quot; height=\&quot;1440\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Validating this assumption by using bitrate as a heuristic across Cloudflareâs traffic, we found that roughly 3% of all origin server responses have a bitrate lower than 4 KB/s. Are these responses all powered by LLMs? Our gut feeling tells us that it is unlikely that 3% of origin responses are LLM-powered!Â &lt;/p&gt;&lt;p&gt;Among the paths found in the 3% of matching responses, there are few patterns that stand out: 1) GraphQL endpoints, 2) device heartbeat or health check, 3) generators (for QR codes, one time passwords, invoices, etc.). Noticing this gave us the idea to filter out endpoints that have a low variance of response size over time â for instance, invoice generation is mostly based on the same template, while conversations in the LLM context have a higher variance.&lt;/p&gt;&lt;p&gt;A combination of filtering out known false positive patterns and low variance in response size gives us a satisfying result. These matching endpoints, approximately 30,000 of them, labelled &lt;code&gt;cf-llm&lt;/code&gt;, can now be found in API Shield or Web assets, depending on your dashboardâs version, for all customers. Now you can review your endpoints and decide how to best protect them.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;detecting-prompts-designed-to-leak-pii\&quot;&gt;Detecting prompts designed to leak PII&lt;/h3&gt;\n            &lt;a href=\&quot;#detecting-prompts-designed-to-leak-pii\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;There are multiple methods to detect PII in LLM prompts. A common method relies on &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions\&quot;&gt;&lt;u&gt;regular expressions (âregexesâ)&lt;/u&gt;&lt;/a&gt;, which is a method we have been using in the WAF for &lt;a href=\&quot;https://developers.cloudflare.com/waf/managed-rules/reference/sensitive-data-detection/\&quot;&gt;&lt;u&gt;Sensitive Data Detection&lt;/u&gt;&lt;/a&gt; on the body of the HTTP response from the web server Regexes offer low latency, easy customization, and straightforward implementation. However, regexes alone have limitations when applied to LLM prompts. They require frequent updates to maintain accuracy, and may struggle with more complex or implicit PII, where the information is spread across text rather than a fixed format.Â &lt;/p&gt;&lt;p&gt;For example, regexes work well for structured data like credit card numbers and addresses, but struggle with PII is embedded in natural language. For instance, âI just booked a flight using my Chase card, ending in 1111â wouldnât trigger a regex match as it lacks the expected pattern, even though it reveals a partial credit card number and financial institution.&lt;/p&gt;&lt;p&gt;To enhance detection, we rely on a &lt;a href=\&quot;https://www.ibm.com/think/topics/named-entity-recognition\&quot;&gt;&lt;u&gt;Named Entity Recognition (NER)&lt;/u&gt;&lt;/a&gt; model, which adds a layer of intelligence to complement regex-based detection. NER models analyze text to identify contextual PII data types, such as names, phone numbers, email addresses, and credit card numbers, making detection more flexible and accurate. Cloudflareâs detection utilizes &lt;a href=\&quot;https://microsoft.github.io/presidio/\&quot;&gt;&lt;u&gt;Presidio&lt;/u&gt;&lt;/a&gt;, an open-source PII detection framework, to further strengthen this approach.&lt;/p&gt;&lt;h4&gt;Using Workers AI to deploy Presidio&lt;/h4&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5ruqPkxJBgFCRdsoft1TO1/aa327b069569a0f952c8baea102955b8/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1121\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In our design, we leverage Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt; as the fastest way to deploy &lt;a href=\&quot;https://microsoft.github.io/presidio/\&quot;&gt;&lt;u&gt;Presidio&lt;/u&gt;&lt;/a&gt;. This integration allows us to process LLM app requests inline, ensuring that sensitive data is flagged before it reaches the model.&lt;/p&gt;&lt;p&gt;Hereâs how it works:&lt;/p&gt;&lt;p&gt;When Firewall for AI is enabled on an application and an end user sends a request to an LLM-powered application, we pass the request to Cloudflare Workers AI which runs the request through Presidioâs NER-based detection model to identify any potential PII from the available &lt;a href=\&quot;https://microsoft.github.io/presidio/supported_entities/\&quot;&gt;&lt;u&gt;entities&lt;/u&gt;&lt;/a&gt;. The output includes metadata like âWas PII found?â and âWhat type of PII entity?â. This output is then processed in our Firewall for AI module, and handed over to other systems, like &lt;a href=\&quot;https://developers.cloudflare.com/waf/analytics/security-analytics/\&quot;&gt;&lt;u&gt;Security Analytics&lt;/u&gt;&lt;/a&gt; for visibility, and the rules like &lt;a href=\&quot;https://developers.cloudflare.com/waf/custom-rules/\&quot;&gt;&lt;u&gt;Custom rules&lt;/u&gt;&lt;/a&gt; for enforcement. Custom rules allow customers to take appropriate actions on the requests based on the provided metadata.Â &lt;/p&gt;&lt;p&gt;If no terminating action, like blocking, is triggered, the request proceeds to the LLM. Otherwise, it gets blocked or the appropriate action is applied before reaching the origin.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;integrating-ai-security-into-the-waf-and-analytics\&quot;&gt;Integrating AI security into the WAF and Analytics&lt;/h3&gt;\n            &lt;a href=\&quot;#integrating-ai-security-into-the-waf-and-analytics\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Securing AI interactions shouldn&amp;#39;t require complex integrations. Firewall for AI is seamlessly built into Cloudflareâs WAF, allowing customers to enforce security policies before prompts reach LLM endpoints. With this integration, there are &lt;a href=\&quot;https://developers.cloudflare.com/waf/detections/firewall-for-ai/#fields\&quot;&gt;&lt;u&gt;new fields available&lt;/u&gt;&lt;/a&gt; in Custom and Rate limiting rules. The rules can be used to take immediate action, such as blocking or logging risky prompts in real time.&lt;/p&gt;&lt;p&gt;For example, security teams can filter LLM traffic to analyze requests containing PII-related prompts. Using Cloudflareâs WAF rules engine, they can create custom security policies tailored to their AI applications.&lt;/p&gt;&lt;p&gt;Hereâs what a rule to block detected PII prompts looks like:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cvlFU0sia6dZly2LZGG8l/670dbb1ad5068f0fd5d8f4afde9e9e02/4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;576\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Alternatively, if an organization wants to allow certain PII categories, such as location data, they can create an exception rule:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/wYFkoQyHFoFNwHmKtaaG3/94c7ae78dbabacf5dd8583af9e8eb071/5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1984\&quot; height=\&quot;600\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In addition to the rules, users can gain visibility into LLM interactions, detect potential risks, and enforce security controls using &lt;a href=\&quot;https://developers.cloudflare.com/waf/analytics/security-analytics/\&quot;&gt;&lt;u&gt;Security Analytics&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/waf/analytics/security-events/\&quot;&gt;&lt;u&gt;Security Events&lt;/u&gt;&lt;/a&gt;. You can find more details in our &lt;a href=\&quot;https://developers.cloudflare.com/waf/detections/firewall-for-ai/\&quot;&gt;&lt;u&gt;documentation&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next-token-counting-guardrails-and-beyond\&quot;&gt;What&#39;s next: token counting, guardrails, and beyond&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next-token-counting-guardrails-and-beyond\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Beyond PII detection and creating security rules, weâre developing additional capabilities to strengthen AI security for our customers. The next feature weâll release is token counting, which analyzes prompt structure and length. Customers can use the token count field in Rate Limiting and WAF Custom rules to prevent their users from sending very long prompts, which can impact third party model bills, or allow users to abuse the models. This will be followed by using AI to detect and allow content moderation, which will provide more flexibility in building guardrails in the rules.&lt;/p&gt;&lt;p&gt;If you&amp;#39;re an enterprise customer, join the Firewall for AI beta today! Contact your customer team to start monitoring traffic, building protection rules, and taking control of your LLM traffic.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.173Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1YKV76zTbFGfD2YQ3AVygP/9f31e788ebe8e0d76e1462f487b5e230/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;6gMpGK5HugYKaxJbvTMOHp&quot;],&quot;name&quot;:[0,&quot;LLM&quot;],&quot;slug&quot;:[0,&quot;llm&quot;]}],[0,{&quot;id&quot;:[0,&quot;7aiJ6fRFqrU0OyfOvaW264&quot;],&quot;name&quot;:[0,&quot;Web Asset Discovery&quot;],&quot;slug&quot;:[0,&quot;web-asset-discovery&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Radwa Radwan&quot;],&quot;slug&quot;:[0,&quot;radwa&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/26ps7sSkjvnatLHbGNWuI9/42c3618ee2392f7d7a0dc5f335615fda/radwa.jpg&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@RadwaRadwan__&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Zhiyuan Zheng&quot;],&quot;slug&quot;:[0,&quot;xmflsct&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1P7uGGL8VL5tDIimsTxWo1/5a08bf32629b5bab2ecee50b73ba8c61/xmflsct.jpg&quot;],&quot;location&quot;:[0,&quot;Netherlands&quot;],&quot;website&quot;:[0,&quot;https://xmflsct.com&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Take control of public AI application security with Cloudflare&#39;s Firewall for AI&quot;],&quot;description&quot;:[0,&quot;Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3yOEeoBpzjcicmAF2xPv89/0ba5c796e1d48880ca4e57466706efba/OG_Share_2024__15_.png&quot;]}]}],&quot;tagInfo&quot;:[0],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="Zwi28p" prefix="r3" component-url="/_astro/Navigation.CSu6dGvY.js" component-export="Navigation" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Post&quot;],&quot;slug&quot;:[0,&quot;take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai&quot;],&quot;translationsAvailable&quot;:[1,[]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:06:31.629Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,66],&quot;revision&quot;:[0,29],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:05:32.927Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,126],&quot;revision&quot;:[0,38],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:03:51.026Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,63],&quot;revision&quot;:[0,26],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:02:57.122Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,88],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:02:56.829Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,85],&quot;revision&quot;:[0,32],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:26.040Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-19T05:02:54.727Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,120],&quot;revision&quot;:[0,36],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-03-18T17:04:03.027Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,65],&quot;revision&quot;:[0,26],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:17:33.067Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,59],&quot;revision&quot;:[0,26],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:12:59.473Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,57],&quot;revision&quot;:[0,21],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;16yk8DVbNNifxov5cWvAov&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:56:23.848Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-01-29T05:03:35.958Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,63],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;name&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search/"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute w-90 ph3 z-1"><div class="pv3 ph2 tl"><a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/ai/" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/zero-trust/" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f4 fw7">Radar</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/partners/" class="no-underline gray1 f4 fw7">Partners</a></div><div class="pv3 ph2 tl"><a href="/tag/policy/" class="no-underline gray1 f4 fw7">Policy &amp; Legal</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai/" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust/" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="cloudflare-radar" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f2 fw5 pv3">Radar</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners/" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy/" class="no-underline gray1 f2 fw5 pv3">Policy &amp; Legal</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island><progress class="reading-progress" value="0" max="100" aria-label="Reading progress"></progress><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="Z2sUvVU" prefix="r1" component-url="/_astro/Post.CgzUE9si.js" component-export="Post" renderer-url="/_astro/client.DLO1yDVm.js" props="{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;5XoyHPSrtBH8pPvUJkOXMD&quot;],&quot;title&quot;:[0,&quot;Take control of public AI application security with Cloudflare&#39;s Firewall for AI&quot;],&quot;slug&quot;:[0,&quot;take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai&quot;],&quot;excerpt&quot;:[0,&quot;Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Imagine building an LLM-powered assistant trained on your developer documentation and some internal guides to quickly help customers, reduce support workload, and improve user experience. Sounds great, right? But what if sensitive data, such as employee details or internal discussions, is included in the data used to train the LLM? Attackers could manipulate the assistant into exposing sensitive data or exploit it for social engineering attacks, where they deceive individuals or systems into revealing confidential details, or use it for targeted phishing attacks. Suddenly, your helpful AI tool turns into a serious security liability.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;introducing-firewall-for-ai-the-easiest-way-to-discover-and-protect-llm-powered-apps\&quot;&gt;Introducing Firewall for AI: the easiest way to discover and protect LLM-powered apps&lt;/h3&gt;\n            &lt;a href=\&quot;#introducing-firewall-for-ai-the-easiest-way-to-discover-and-protect-llm-powered-apps\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Today, as part of Security Week 2025, weâre announcing the open beta of Firewall for AI, first &lt;a href=\&quot;https://blog.cloudflare.com/firewall-for-ai/\&quot;&gt;&lt;u&gt;introduced during Security Week 2024&lt;/u&gt;&lt;/a&gt;. After talking with customers interested in protecting their LLM apps, this first beta release is focused on discovery and PII detection, and more features will follow in the future.&lt;/p&gt;&lt;p&gt;If you are already using Cloudflare application security, your LLM-powered applications are automatically discovered and protected, with no complex setup, no maintenance, and no extra integration needed.&lt;/p&gt;&lt;p&gt;Firewall for AI is an inline security solution that protects user-facing LLM-powered applications from abuse and data leaks, integrating directly with Cloudflareâs &lt;a href=\&quot;https://developers.cloudflare.com/waf/\&quot;&gt;&lt;u&gt;Web Application Firewall (WAF)&lt;/u&gt;&lt;/a&gt; to provide instant protection with zero operational overhead. This integration enables organizations to leverage both AI-focused safeguards and established WAF capabilities.&lt;/p&gt;&lt;p&gt;Cloudflare is uniquely positioned to solve this challenge for all of our customers. As a &lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/cdn/glossary/reverse-proxy/\&quot;&gt;&lt;u&gt;reverse proxy&lt;/u&gt;&lt;/a&gt;, we are model-agnostic whether the application is using a third-party LLM or an internally hosted one. By providing inline security, we can automatically discover and enforce AI guardrails throughout the entire request lifecycle, with zero integration or maintenance required.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;firewall-for-ai-beta-overview\&quot;&gt;Firewall for AI beta overview&lt;/h3&gt;\n            &lt;a href=\&quot;#firewall-for-ai-beta-overview\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The beta release includes the following security capabilities:&lt;/p&gt;&lt;p&gt;&lt;b&gt;Discover:&lt;/b&gt; identify LLM-powered endpoints across your applications, an essential step for effective request and prompt analysis.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Detect:&lt;/b&gt; analyze the incoming requests prompts to recognize potential security threats, such as attempts to extract sensitive data (e.g., âShow me transactions using 4111 1111 1111 1111â). This aligns with&lt;a href=\&quot;https://genai.owasp.org/llmrisk/llm022025-sensitive-information-disclosure/\&quot;&gt; &lt;u&gt;OWASP LLM022025 - Sensitive Information Disclosure&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Mitigate:&lt;/b&gt; enforce security controls and policies to manage the traffic that reaches your LLM, and reduce risk exposure.&lt;/p&gt;&lt;p&gt;Below, we review each capability in detail, exploring how they work together to create a comprehensive security framework for AI protection.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;discovering-llm-powered-applications\&quot;&gt;Discovering LLM-powered applications&lt;/h3&gt;\n            &lt;a href=\&quot;#discovering-llm-powered-applications\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Companies are racing to find all possible use cases where an LLM can excel. Think about site search, a chatbot, or a shopping assistant. Regardless of the application type, our goal is to determine whether an application is powered by an LLM behind the scenes.&lt;/p&gt;&lt;p&gt;One possibility is to look for request path signatures similar to what major LLM providers use. For example, &lt;a href=\&quot;https://platform.openai.com/docs/api-reference/chat/create\&quot;&gt;&lt;u&gt;OpenAI&lt;/u&gt;&lt;/a&gt;, &lt;a href=\&quot;https://docs.perplexity.ai/api-reference/chat-completions\&quot;&gt;&lt;u&gt;Perplexity&lt;/u&gt;&lt;/a&gt; or &lt;a href=\&quot;https://docs.mistral.ai/api/#tag/chat\&quot;&gt;&lt;u&gt;Mistral&lt;/u&gt;&lt;/a&gt; initiate a chat using the &lt;code&gt;/chat/completions&lt;/code&gt; API endpoint. Searching through our request logs, we found only a few entries that matched this pattern across our global traffic. This result indicates that we need to consider other approaches to finding &lt;i&gt;any&lt;/i&gt; application that is powered by an LLM.&lt;/p&gt;&lt;p&gt;Another signature to research, popular with LLM platforms, is the use of &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events\&quot;&gt;&lt;u&gt;server-sent events&lt;/u&gt;&lt;/a&gt;. LLMs need to &lt;a href=\&quot;https://platform.openai.com/docs/guides/latency-optimization#don-t-default-to-an-llm\&quot;&gt;&lt;u&gt;âthinkâ&lt;/u&gt;&lt;/a&gt;. &lt;a href=\&quot;https://platform.openai.com/docs/api-reference/streaming\&quot;&gt;&lt;u&gt;Using server-sent events&lt;/u&gt;&lt;/a&gt; improves the end userâs experience by sending over each &lt;a href=\&quot;https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them\&quot;&gt;&lt;u&gt;token&lt;/u&gt;&lt;/a&gt; as soon as it is ready, creating the perception that an LLM is âthinkingâ like a human being. Matching on requests of server-sent events is straightforward using the response header content type of &lt;code&gt;text/event-stream&lt;/code&gt;. This approach expands the coverage further, but does not yet cover the &lt;a href=\&quot;https://stackoverflow.blog/2022/06/02/a-beginners-guide-to-json-the-data-format-for-the-internet/\&quot;&gt;&lt;u&gt;majority of applications&lt;/u&gt;&lt;/a&gt; that are using JSON format for data exchanges. Continuing the journey, our next focus is on the responses having header content type of &lt;code&gt;application/json&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;No matter how fast LLMs can be optimized to respond, when chatting with major LLMs, we often perceive them to be slow, as we have to wait for them to âthinkâ. By plotting on how much time it takes for the origin server to respond over identified LLM endpoints (blue line) versus the rest (orange line), we can see in the left graph that origins serving LLM endpoints mostly need more than 1 second to respond, while the majority of the rest takes less than 1 second. Would we also see a clear distinction between origin server response body sizes, where the majority of LLM endpoints would respond with smaller sizes because major LLM providers &lt;a href=\&quot;https://platform.openai.com/docs/guides/safety-best-practices#constrain-user-input-and-limit-output-tokens\&quot;&gt;&lt;u&gt;limit output tokens&lt;/u&gt;&lt;/a&gt;? Unfortunately not. The right graph shows that LLM response size largely overlaps with non-LLM traffic.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4CkowlKelGlYueNzSrbsGn/f8091d66a6c0eb8b884c7cc6f2a128ab/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1220\&quot; height=\&quot;484\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;By dividing origin response size over origin response duration to calculate an effective bitrate, the distinction is even clearer that 80% of LLM endpoints operate slower than 4 KB/s.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5sJKUnLmWwnTWzUOyWVRKO/c98c8fc32dbafa5d79f21effdfc58f34/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1920\&quot; height=\&quot;1440\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Validating this assumption by using bitrate as a heuristic across Cloudflareâs traffic, we found that roughly 3% of all origin server responses have a bitrate lower than 4 KB/s. Are these responses all powered by LLMs? Our gut feeling tells us that it is unlikely that 3% of origin responses are LLM-powered!Â &lt;/p&gt;&lt;p&gt;Among the paths found in the 3% of matching responses, there are few patterns that stand out: 1) GraphQL endpoints, 2) device heartbeat or health check, 3) generators (for QR codes, one time passwords, invoices, etc.). Noticing this gave us the idea to filter out endpoints that have a low variance of response size over time â for instance, invoice generation is mostly based on the same template, while conversations in the LLM context have a higher variance.&lt;/p&gt;&lt;p&gt;A combination of filtering out known false positive patterns and low variance in response size gives us a satisfying result. These matching endpoints, approximately 30,000 of them, labelled &lt;code&gt;cf-llm&lt;/code&gt;, can now be found in API Shield or Web assets, depending on your dashboardâs version, for all customers. Now you can review your endpoints and decide how to best protect them.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;detecting-prompts-designed-to-leak-pii\&quot;&gt;Detecting prompts designed to leak PII&lt;/h3&gt;\n            &lt;a href=\&quot;#detecting-prompts-designed-to-leak-pii\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;There are multiple methods to detect PII in LLM prompts. A common method relies on &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions\&quot;&gt;&lt;u&gt;regular expressions (âregexesâ)&lt;/u&gt;&lt;/a&gt;, which is a method we have been using in the WAF for &lt;a href=\&quot;https://developers.cloudflare.com/waf/managed-rules/reference/sensitive-data-detection/\&quot;&gt;&lt;u&gt;Sensitive Data Detection&lt;/u&gt;&lt;/a&gt; on the body of the HTTP response from the web server Regexes offer low latency, easy customization, and straightforward implementation. However, regexes alone have limitations when applied to LLM prompts. They require frequent updates to maintain accuracy, and may struggle with more complex or implicit PII, where the information is spread across text rather than a fixed format.Â &lt;/p&gt;&lt;p&gt;For example, regexes work well for structured data like credit card numbers and addresses, but struggle with PII is embedded in natural language. For instance, âI just booked a flight using my Chase card, ending in 1111â wouldnât trigger a regex match as it lacks the expected pattern, even though it reveals a partial credit card number and financial institution.&lt;/p&gt;&lt;p&gt;To enhance detection, we rely on a &lt;a href=\&quot;https://www.ibm.com/think/topics/named-entity-recognition\&quot;&gt;&lt;u&gt;Named Entity Recognition (NER)&lt;/u&gt;&lt;/a&gt; model, which adds a layer of intelligence to complement regex-based detection. NER models analyze text to identify contextual PII data types, such as names, phone numbers, email addresses, and credit card numbers, making detection more flexible and accurate. Cloudflareâs detection utilizes &lt;a href=\&quot;https://microsoft.github.io/presidio/\&quot;&gt;&lt;u&gt;Presidio&lt;/u&gt;&lt;/a&gt;, an open-source PII detection framework, to further strengthen this approach.&lt;/p&gt;&lt;h4&gt;Using Workers AI to deploy Presidio&lt;/h4&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5ruqPkxJBgFCRdsoft1TO1/aa327b069569a0f952c8baea102955b8/3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1121\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In our design, we leverage Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt; as the fastest way to deploy &lt;a href=\&quot;https://microsoft.github.io/presidio/\&quot;&gt;&lt;u&gt;Presidio&lt;/u&gt;&lt;/a&gt;. This integration allows us to process LLM app requests inline, ensuring that sensitive data is flagged before it reaches the model.&lt;/p&gt;&lt;p&gt;Hereâs how it works:&lt;/p&gt;&lt;p&gt;When Firewall for AI is enabled on an application and an end user sends a request to an LLM-powered application, we pass the request to Cloudflare Workers AI which runs the request through Presidioâs NER-based detection model to identify any potential PII from the available &lt;a href=\&quot;https://microsoft.github.io/presidio/supported_entities/\&quot;&gt;&lt;u&gt;entities&lt;/u&gt;&lt;/a&gt;. The output includes metadata like âWas PII found?â and âWhat type of PII entity?â. This output is then processed in our Firewall for AI module, and handed over to other systems, like &lt;a href=\&quot;https://developers.cloudflare.com/waf/analytics/security-analytics/\&quot;&gt;&lt;u&gt;Security Analytics&lt;/u&gt;&lt;/a&gt; for visibility, and the rules like &lt;a href=\&quot;https://developers.cloudflare.com/waf/custom-rules/\&quot;&gt;&lt;u&gt;Custom rules&lt;/u&gt;&lt;/a&gt; for enforcement. Custom rules allow customers to take appropriate actions on the requests based on the provided metadata.Â &lt;/p&gt;&lt;p&gt;If no terminating action, like blocking, is triggered, the request proceeds to the LLM. Otherwise, it gets blocked or the appropriate action is applied before reaching the origin.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;integrating-ai-security-into-the-waf-and-analytics\&quot;&gt;Integrating AI security into the WAF and Analytics&lt;/h3&gt;\n            &lt;a href=\&quot;#integrating-ai-security-into-the-waf-and-analytics\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Securing AI interactions shouldn&amp;#39;t require complex integrations. Firewall for AI is seamlessly built into Cloudflareâs WAF, allowing customers to enforce security policies before prompts reach LLM endpoints. With this integration, there are &lt;a href=\&quot;https://developers.cloudflare.com/waf/detections/firewall-for-ai/#fields\&quot;&gt;&lt;u&gt;new fields available&lt;/u&gt;&lt;/a&gt; in Custom and Rate limiting rules. The rules can be used to take immediate action, such as blocking or logging risky prompts in real time.&lt;/p&gt;&lt;p&gt;For example, security teams can filter LLM traffic to analyze requests containing PII-related prompts. Using Cloudflareâs WAF rules engine, they can create custom security policies tailored to their AI applications.&lt;/p&gt;&lt;p&gt;Hereâs what a rule to block detected PII prompts looks like:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cvlFU0sia6dZly2LZGG8l/670dbb1ad5068f0fd5d8f4afde9e9e02/4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;576\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Alternatively, if an organization wants to allow certain PII categories, such as location data, they can create an exception rule:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/wYFkoQyHFoFNwHmKtaaG3/94c7ae78dbabacf5dd8583af9e8eb071/5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1984\&quot; height=\&quot;600\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In addition to the rules, users can gain visibility into LLM interactions, detect potential risks, and enforce security controls using &lt;a href=\&quot;https://developers.cloudflare.com/waf/analytics/security-analytics/\&quot;&gt;&lt;u&gt;Security Analytics&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/waf/analytics/security-events/\&quot;&gt;&lt;u&gt;Security Events&lt;/u&gt;&lt;/a&gt;. You can find more details in our &lt;a href=\&quot;https://developers.cloudflare.com/waf/detections/firewall-for-ai/\&quot;&gt;&lt;u&gt;documentation&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next-token-counting-guardrails-and-beyond\&quot;&gt;What&#39;s next: token counting, guardrails, and beyond&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next-token-counting-guardrails-and-beyond\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Beyond PII detection and creating security rules, weâre developing additional capabilities to strengthen AI security for our customers. The next feature weâll release is token counting, which analyzes prompt structure and length. Customers can use the token count field in Rate Limiting and WAF Custom rules to prevent their users from sending very long prompts, which can impact third party model bills, or allow users to abuse the models. This will be followed by using AI to detect and allow content moderation, which will provide more flexibility in building guardrails in the rules.&lt;/p&gt;&lt;p&gt;If you&amp;#39;re an enterprise customer, join the Firewall for AI beta today! Contact your customer team to start monitoring traffic, building protection rules, and taking control of your LLM traffic.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.173Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1YKV76zTbFGfD2YQ3AVygP/9f31e788ebe8e0d76e1462f487b5e230/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;6gMpGK5HugYKaxJbvTMOHp&quot;],&quot;name&quot;:[0,&quot;LLM&quot;],&quot;slug&quot;:[0,&quot;llm&quot;]}],[0,{&quot;id&quot;:[0,&quot;7aiJ6fRFqrU0OyfOvaW264&quot;],&quot;name&quot;:[0,&quot;Web Asset Discovery&quot;],&quot;slug&quot;:[0,&quot;web-asset-discovery&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Radwa Radwan&quot;],&quot;slug&quot;:[0,&quot;radwa&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/26ps7sSkjvnatLHbGNWuI9/42c3618ee2392f7d7a0dc5f335615fda/radwa.jpg&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@RadwaRadwan__&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Zhiyuan Zheng&quot;],&quot;slug&quot;:[0,&quot;xmflsct&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1P7uGGL8VL5tDIimsTxWo1/5a08bf32629b5bab2ecee50b73ba8c61/xmflsct.jpg&quot;],&quot;location&quot;:[0,&quot;Netherlands&quot;],&quot;website&quot;:[0,&quot;https://xmflsct.com&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Take control of public AI application security with Cloudflare&#39;s Firewall for AI&quot;],&quot;description&quot;:[0,&quot;Firewall for AI discovers and protects your public LLM-powered applications, and is seamlessly integrated with Cloudflare WAF. Join the beta now and take control of your generative AI security.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3yOEeoBpzjcicmAF2xPv89/0ba5c796e1d48880ca4e57466706efba/OG_Share_2024__15_.png&quot;]}]}],&quot;initialReadingTime&quot;:[0,&quot;7&quot;],&quot;relatedPosts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;7lPwwGmoPaSddtdNRcq4Wv&quot;],&quot;title&quot;:[0,&quot;Cloudflare for AI: supporting AI adoption at scale with a security-first approach&quot;],&quot;slug&quot;:[0,&quot;cloudflare-for-ai-supporting-ai-adoption-at-scale-with-a-security-first-approach&quot;],&quot;excerpt&quot;:[0,&quot;With Cloudflare for AI, developers, security teams and content creators can leverage Cloudflareâs network and portfolio of tools to secure, observe and make AI applications resilient and safe to use.&quot;],&quot;featured&quot;:[0,true],&quot;html&quot;:[0,&quot;&lt;p&gt;AI is transforming businesses â from &lt;a href=\&quot;https://developers.cloudflare.com/agents/\&quot;&gt;&lt;u&gt;automated agents performing background workflows&lt;/u&gt;&lt;/a&gt;, to improved search, to easier access and summarization of knowledge.Â &lt;/p&gt;&lt;p&gt;While we are still early in what is likely going to be a substantial shift in how the world operates, two things are clear: the Internet, and how we interact with it, will change, and the boundaries of security and data privacy have never been more difficult to trace, making security an important topic in this shift.&lt;/p&gt;&lt;p&gt;At Cloudflare, we have a mission to help build a better Internet. And while we can only speculate on what AI will bring in the future, its success will rely on it being reliable and safe to use.&lt;/p&gt;&lt;p&gt;Today, we are introducing &lt;a href=\&quot;https://www.cloudflare.com/press-releases/2025/cloudflare-introduces-cloudflare-for-ai/\&quot;&gt;&lt;u&gt;Cloudflare for AI&lt;/u&gt;&lt;/a&gt;: a suite of tools aimed at helping businesses, developers, and content creators adopt, deploy, and secure AI technologies at scale safely.&lt;/p&gt;&lt;p&gt;Cloudflare for AI is not just a grouping of tools and features, some of which are new, but also a commitment to focus our future development work with AI in mind.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4s1CIOnpHnIdWPdFrzS6e1/a29e0ffa7123d69e855b3eac6d0a154f/1.png\&quot; alt=\&quot;Cloudflare for AI - tools that help users and business adopt AI technologies safely\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;904\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Letâs jump in to see what Cloudflare for AI can deliver for developers, security teams, and content creatorsâ¦&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;for-developers\&quot;&gt;For developers&lt;/h3&gt;\n            &lt;a href=\&quot;#for-developers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;If you are building an AI application, whether a fully custom application or a vendor-provided hosted or SaaS application, Cloudflare can help you deploy, store, control/observe, and protect your AI application from threats.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Build &amp;amp; deploy&lt;/b&gt;: &lt;a href=\&quot;https://www.cloudflare.com/en-gb/developer-platform/products/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt; and our new &lt;a href=\&quot;https://developers.cloudflare.com/agents/\&quot;&gt;&lt;u&gt;AI Agents SDK&lt;/u&gt;&lt;/a&gt; facilitates the scalable development &amp;amp; deployment of AI applications on Cloudflareâs network. Cloudflareâs network enhances user experience and efficiency by running AI closer to users, resulting in low-latency and high-performance AI applications. Customers are also using &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/r2/\&quot;&gt;&lt;u&gt;Cloudflareâs R2&lt;/u&gt;&lt;/a&gt; to store their AI training data with zero egress fees, in order to develop the next-gen AI models.Â &lt;/p&gt;&lt;p&gt;We are continually investing in not only our serverless AI inference infrastructure across the globe, but also in making Cloudflare the best place to &lt;a href=\&quot;https://blog.cloudflare.com/build-ai-agents-on-cloudflare/\&quot;&gt;&lt;u&gt;build AI Agents&lt;/u&gt;&lt;/a&gt;. Cloudflareâs composable AI architecture has all the primitives that enable AI applications to have real time communications, persist state, execute long-running tasks, and repeat them on a schedule.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2M1dOiI89ecQAb1y0SJ57E/dcc98c263ea9503aa0aacdf69326fa9d/2.png\&quot; alt=\&quot;Cloudflareâs AI developer platform suite that allows customers to build full-stack AI applications\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;639\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;b&gt;Protect and control&lt;/b&gt;: Once your application is deployed, be it directly on Cloudflare, using Workers AI, or running on your own infrastructure (cloud or on premise), Cloudflareâs &lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/\&quot;&gt;&lt;u&gt;AI Gateway&lt;/u&gt;&lt;/a&gt; lets you gain visibility into the cost, usage, latency, and overall performance of the application.&lt;/p&gt;&lt;p&gt;Additionally, &lt;a href=\&quot;https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai/\&quot;&gt;&lt;u&gt;Firewall for AI&lt;/u&gt;&lt;/a&gt; lets you layer security on top by automatically ensuring every prompt is clean from injection, and that personally identifiable information (PII) is neither submitted to nor (coming soon) extracted from, the application.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4dDiUMSKDoqyrPgzjiHfkx/22a2a9e159f8efcbf2b2a43f9bdf2a9b/3.png\&quot; alt=\&quot;Firewall for AI internal architecture\&quot; class=\&quot;kg-image\&quot; width=\&quot;1932\&quot; height=\&quot;748\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;for-security-teams\&quot;&gt;For security teams&lt;/h3&gt;\n            &lt;a href=\&quot;#for-security-teams\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Security teams have a growing new challenge: ensure AI applications are used securely, both in regard to internal usage by employees, as well as by users of externally-facing AI applications the business is responsible for. Ensuring PII data is handled correctly is also a growing major concern for CISOs.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Discover applications: &lt;/b&gt;You canât protect what you donât know about. Firewall for AIâs discovery capability lets security teams find AI applications that are being used within the organization without the need to perform extensive surveys.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Control PII flow and access: &lt;/b&gt;Once discovered, via Firewall for AI or other means, security teams can leverage &lt;a href=\&quot;https://www.cloudflare.com/learning/access-management/what-is-ztna/\&quot;&gt;&lt;u&gt;Zero Trust Network Access (ZTNA)&lt;/u&gt;&lt;/a&gt; to ensure only authorized employees are accessing the correct applications. Additionally, using Firewall for AI, they can ensure that, even if authorised, neither employees nor potentially external users, are submitting or extracting personally identifiable information (PII) to/from the application.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Protect against exploits: &lt;/b&gt;Malicious users are targeting AI applications with novel attack vectors, as these applications are often connected to internal data stores. With Firewall for AI and the broader Application Security portfolio, you can protect against a wide number of exploits highlighted in the &lt;a href=\&quot;https://genai.owasp.org/resource/owasp-top-10-for-llm-applications-2025/\&quot;&gt;&lt;u&gt;OWASP Top 10 for LLM applications&lt;/u&gt;&lt;/a&gt;, including, but not limited to, prompt injection, sensitive information disclosure, and improper output handling.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Safeguarding conversations: &lt;/b&gt;With &lt;a href=\&quot;https://blog.cloudflare.com/guardrails-in-ai-gateway/\&quot;&gt;&lt;u&gt;Llama Guard&lt;/u&gt;&lt;/a&gt; integrated into both AI Gateway and Firewall for AI, you can ensure both input and output of your AI application is not toxic, and follows topic and sentiment rules based on your internal business policies.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;for-content-creators\&quot;&gt;For content creators&lt;/h3&gt;\n            &lt;a href=\&quot;#for-content-creators\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The advent of AI is arguably putting content creators at risk, with sophisticated LLM models now generating both text, images, and videos of high quality. &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;u&gt;Weâve blogged in the past about AI Independence, our approach to safeguarding content creators&lt;/u&gt;&lt;/a&gt;, for both individuals and businesses. If you fall in this category, we have the right tools for you too.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Observe who is accessing your content:&lt;/b&gt; With our &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-ai-audit-control-ai-content-crawlers/\&quot;&gt;&lt;u&gt;AI Audit dashboard&lt;/u&gt;&lt;/a&gt;, you gain visibility (who, what, where and when) into the AI platforms crawling your site to retrieve content to use for AI training data. We are constantly classifying and adding new vendors as they create new crawlers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6s9WmTy7EQyOF6mCZd6KTc/1ba40dd811bb81de26da04155655e6d8/4.png\&quot; alt=\&quot;AI Audit analytics dashboard\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;974\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;b&gt;Block access: &lt;/b&gt;If AI crawlers do not follow robots.txt or other relevant standards, or are potentially unwanted, you can block access outright. Weâve &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;u&gt;provided a simple âone clickâ button&lt;/u&gt;&lt;/a&gt; for customers using Cloudflare on our self-serve plans to protect their website. Larger organizations can build fine tune rules using our &lt;a href=\&quot;https://www.cloudflare.com/en-gb/application-services/products/bot-management/\&quot;&gt;&lt;u&gt;Bot Management&lt;/u&gt;&lt;/a&gt; solution allowing them to target individual bots and create custom filters with ease.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;cloudflare-for-ai-making-ai-security-simple\&quot;&gt;Cloudflare for AI: making AI security simple&lt;/h3&gt;\n            &lt;a href=\&quot;#cloudflare-for-ai-making-ai-security-simple\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;If you are using Cloudflare already, or the deployment and security of AI applications is top of mind, &lt;a href=\&quot;https://www.cloudflare.com/lp/cloudflare-for-ai/\&quot;&gt;&lt;u&gt;reach out&lt;/u&gt;&lt;/a&gt;, and we can help guide you through our suite of AI tools to find the one that matches your needs.&lt;/p&gt;&lt;p&gt;Ensuring AI is scalable, safe and resilient, is a natural extension of Cloudflareâs mission, given so much of our success relies on a safe Internet.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.181Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6CafL9Ydv2WrHYYcsmt2vi/f98988b4715ad7c2c1e29d146b682447/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Michael Tremante&quot;],&quot;slug&quot;:[0,&quot;michael-tremante&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/61VxyepuDMgPc2YC1SLjzq/b40290be32d4c578dab2eb8ec1a3b6da/michael-tremante.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@MichaelTremante&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;With Cloudflare for AI, developers, security teams and content creators can leverage Cloudflareâs network and portfolio of tools to secure, observe and make AI applications resilient and safe to use.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/cloudflare-for-ai-supporting-ai-adoption-at-scale-with-a-security-first-approach&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Cloudflare for AI: supporting AI adoption at scale with a security-first approach&quot;],&quot;description&quot;:[0,&quot;With Cloudflare for AI, developers, security teams and content creators can leverage Cloudflareâs network and portfolio of tools to secure, observe and make AI applications resilient and safe to use.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6qiWTQ65zbWahFpFIdWIlw/0707935d4b781813f700a968d683ff9b/OG_Share_2024__14_.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;VxbhII1JF1Bnb4w9D1kEQ&quot;],&quot;title&quot;:[0,&quot;An early look at cryptographic watermarks for AI-generated content&quot;],&quot;slug&quot;:[0,&quot;an-early-look-at-cryptographic-watermarks-for-ai-generated-content&quot;],&quot;excerpt&quot;:[0,&quot;It&#39;s hard to tell the difference between web content produced by humans and web content produced by AI. We&#39;re taking new approach to making AI content distinguishable without impacting performance. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Generative AI is reshaping many aspects of our lives, from how we work and learn, to how we play and interact. Given that it&amp;#39;s Security Week, it&amp;#39;s a good time to think about some of the unintended consequences of this information revolution and the role that we play in bringing them about.&lt;/p&gt;&lt;p&gt;Today&amp;#39;s web is full of AI-generated content: text, code, images, audio, and video can all be generated by machines, normally based on a prompt from a human. Some models have become so sophisticated that distinguishing their artifacts â that is, the text, audio, and video they generate â from everything else can be quite difficult, &lt;a href=\&quot;https://originality.ai/blog/openai-text-classifier-review\&quot;&gt;&lt;u&gt;even for machines themselves&lt;/u&gt;&lt;/a&gt;. This difficulty creates a number of challenges. On the one hand, those who train and deploy generative AI need to be able to identify AI-created artifacts they scrape from websites in order &lt;a href=\&quot;https://www.nature.com/articles/s41586-024-07566-y\&quot;&gt;&lt;u&gt;to avoid polluting their training data&lt;/u&gt;&lt;/a&gt;. On the other hand, the origin of these artifacts may be intentionally misrepresented, creating &lt;a href=\&quot;https://www.gov.ca.gov/2024/09/19/governor-newsom-signs-bills-to-crack-down-on-sexually-explicit-deepfakes-require-ai-watermarking/\&quot;&gt;&lt;u&gt;myriad problems&lt;/u&gt;&lt;/a&gt; for society writ large.&lt;/p&gt;&lt;p&gt;Part of the solution to this problem might be &lt;b&gt;watermarking&lt;/b&gt;. The basic idea of watermarking is to modify the training process, the inference process, or both so that an artifact of the model embeds some identifying information of the model from which it originates. This way a model operator, or potentially the consumer of the content themselves, can determine whether some artifact came from the model by checking for the presence of the watermark.&lt;/p&gt;&lt;p&gt;Watermarking shares many of the same goals as the &lt;a href=\&quot;https://c2pa.org/\&quot;&gt;&lt;u&gt;C2PA initiative&lt;/u&gt;&lt;/a&gt;. C2PA seeks to add provenance of media from a variety of sources, not just AI. Think of it as a chain of digital signatures, where each link in the chain corresponds to some modification of the artifact. For example, if you&amp;#39;re a Cloudflare customer using &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/cloudflare-images/\&quot;&gt;&lt;u&gt;Images&lt;/u&gt;&lt;/a&gt; to serve C2PA-tagged content, &lt;a href=\&quot;https://blog.cloudflare.com/preserve-content-credentials-with-cloudflare-images/\&quot;&gt;&lt;u&gt;you can opt in to preserve the provenance&lt;/u&gt;&lt;/a&gt; by extending this signature chain, even after the image is compressed on our network.&lt;/p&gt;&lt;p&gt;The challenge of this approach is that it requires participation by each entity in the chain of custody of the artifact. Watermarking has the potential to make C2PA more robust by preserving the origin of the artifact even after unattributed modification. Whereas the C2PA signature is encoded in an imageâs metadata, a watermark is embedded in the pixels of the image itself.&lt;/p&gt;&lt;p&gt;In this post, we&amp;#39;re going to take a look at an emerging paradigm for AI watermarking. Based on cryptography, these new watermarks aim to provide rigorous, mathematical guarantees of quality preservation and robustness to modification of the content. This field is, as of 2025, only a couple of years old, and we don&amp;#39;t yet know if it will yield schemes that are practical to deploy. Nevertheless, we believe this is a promising area of research, and we hope this post inspires someone to come up with the next big idea.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-case-for-cryptography\&quot;&gt;The case for cryptography&lt;/h3&gt;\n            &lt;a href=\&quot;#the-case-for-cryptography\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;It&amp;#39;s often said that cryptography is necessary but not sufficient for security. In other words, cryptographers make certain assumptions about the state of the system, like that a key is kept secret from the attacker, or that some computational puzzle is hard to solve. When these assumptions hold, a good cryptosystem provides a mathematical proof of security against the class of attacks it is designed to prevent.&lt;/p&gt;&lt;p&gt;Artifact watermarking usually has three security goals:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Robustness: Users of the model should not be able to easily misrepresent the origin of its artifacts. The watermark should be verifiable even after the artifact is modified to some extent.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Undetectability: Watermarking should have negligible impact on the quality of the model output. In particular, watermarked artifacts should be indistinguishable from non-watermarked artifacts of the same model.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Unforgeability: It should be impossible for anyone but the model operator to produce watermarked artifacts. No one should be able to convince the model operator that an artifact was generated by the model when it wasn&amp;#39;t.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Today&amp;#39;s state-of-the-art watermarks, including Google&amp;#39;s &lt;a href=\&quot;https://deepmind.google/technologies/synthid/\&quot;&gt;&lt;u&gt;SynthID&lt;/u&gt;&lt;/a&gt; and Meta&amp;#39;s &lt;a href=\&quot;https://aidemos.meta.com/videoseal/\&quot;&gt;&lt;u&gt;Video Seal&lt;/u&gt;&lt;/a&gt;, are often based on &lt;a href=\&quot;https://link.springer.com/article/10.1007/s00034-024-02651-z\&quot;&gt;&lt;u&gt;deep learning&lt;/u&gt;&lt;/a&gt;. These schemes involve training a machine learning model, typically one with an encoderâdecoder architecture where the encoder encodes a signature into an artifact and the decoder decodes the signature:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/wk6vE9ArPOK7EXP2otytf/f847db73272c932ba546d8a6b3176480/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1608\&quot; height=\&quot;1032\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Figure 1: Illustration of the process of training an encoder-decoder watermarking model.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;The training process involves subjecting the watermarked artifact to a series of known attacks. The more attacks the model thwarts, the higher the model quality. For example, the trainer would alter the artifact in various ways and run the decoder on the outputs: the model scores high if the decoder manages to correctly output the signature most of the time.&lt;/p&gt;&lt;p&gt;This idea is quite beautiful. It&amp;#39;s like a scaled up version of penetration testing, an essential practice of security engineering whereby the system is subjected to a suite of known attacks until all known vulnerabilities are patched. Of course, there will always be new attack variants or new attack strategies that the model was not trained on and that may evade the model.&lt;/p&gt;&lt;p&gt;And so ensues the proverbial game of cat-and-mouse that consumes so much time in security engineering. Coping with new attacks on robustness, undetectability, or unforgeability of deep-learning based watermarks requires continual intelligence gathering and re-training of deployed models to keep up with attackers.&lt;/p&gt;&lt;p&gt;The promise of cryptography is that it helps us break out of these kinds of cat-and-mouse games. Cryptography reduces the attack surface by focusing the attacker&amp;#39;s attention on breaking some narrow aspect of the system that is easier to reason about. This might be gaining access to some secret key, or solving some (seemingly unrelated) computational puzzle that is believed to be impossible to solve.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;pseudorandom-codes\&quot;&gt;Pseudorandom codes&lt;/h3&gt;\n            &lt;a href=\&quot;#pseudorandom-codes\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;To the best of our knowledge, the first cryptographic AI watermark was proposed by Scott Aaronson &lt;a href=\&quot;https://scottaaronson.blog/?p=6823\&quot;&gt;&lt;u&gt;in the summer of 2022 while he was working at OpenAI&lt;/u&gt;&lt;/a&gt;. Tailored specifically for chatbots, Aaronson&amp;#39;s simple scheme was both undetectable and unforgeable. However, it was susceptible to some simple attacks on robustness.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4XcSE2infymYTGywob2XlS/b79819f48b58c26a7c1713a89879d412/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;778\&quot; height=\&quot;282\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Figure 2: The &amp;quot;emoji attack&amp;quot;: Ask the chatbot to embed a simple pattern in its response, then remove the pattern manually. This is sufficient to remove some cryptographic watermarks from the model output.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;In the year or so that followed, other cryptographic watermarks were proposed, all making different trade-offs between detectability and robustness. Two years later, in a paper that appeared at &lt;a href=\&quot;https://eprint.iacr.org/2024/235\&quot;&gt;&lt;u&gt;CRYPTO 2024&lt;/u&gt;&lt;/a&gt;, Miranda Christ and Sam Gunn articulated a new framework for watermarks that, if properly instantiated, would provide all three properties simultaneously.&lt;/p&gt;&lt;p&gt;Along with the prompt provided by the user, generative AI models typically take as input some randomness generated by the model operator. For many such models, it is often possible to run the model &amp;quot;in reverse&amp;quot; such that, given an artifact of the model, one can recover &lt;b&gt;an approximation of&lt;/b&gt; the initial randomness used to generate it. We&amp;#39;ll see why this is important in a moment.&lt;/p&gt;&lt;p&gt;The starting point for Christ-Gunn-2024 is a mathematical tool called an &lt;a href=\&quot;https://en.wikipedia.org/wiki/Error_correction_code\&quot;&gt;&lt;u&gt;error correcting code&lt;/u&gt;&lt;/a&gt;. These codes are normally used to transmit messages over noisy channels and are found in just about every system we rely on, including fiber optics, satellites, the data bus on your motherboard, and even quantum computers.&lt;/p&gt;&lt;p&gt;To transmit a message &lt;code&gt;m&lt;/code&gt;, one first encodes it into a &lt;b&gt;codeword&lt;/b&gt; &lt;code&gt;c=encode(m)&lt;/code&gt;. Then the receiver attempts to decode the codeword as &lt;code&gt;decode(c)&lt;/code&gt;. Error correcting codes are designed to tolerate some fraction of the codeword bits being flipped: if too many bits are flipped, then decoding will fail.&lt;/p&gt;&lt;p&gt;Now, ignoring undetectability and unforgeability for a moment, we can use an error correcting code to make a robust watermark as follows:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Generate the initial randomness.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Embed a codeword &lt;code&gt;c=encode(m)&lt;/code&gt; into the randomness in some manner, by overwriting bits of randomness with bits of &lt;code&gt;c&lt;/code&gt;. The message &lt;code&gt;m&lt;/code&gt; can be whatever we want, for example a short string identifying the version of our model.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Run the model with the modified randomness.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;To verify the watermark, we:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Run the model &amp;quot;in reverse&amp;quot; on the artifact, obtaining an approximation of the initial randomness.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Extract the codeword &lt;code&gt;c&lt;/code&gt;&lt;code&gt;&lt;sup&gt;*&lt;/sup&gt;&lt;/code&gt; from the randomness.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;If &lt;code&gt;decode(c&lt;/code&gt;&lt;code&gt;&lt;sup&gt;*&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;) &lt;/code&gt;succeeds, then the watermark is present.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;Why does this work? Since c is a codeword, we can verify the watermark even if our approximation of the initial randomness isn&amp;#39;t perfect. Some of the bits will be flipped, but the error correcting property of the code allows us to compensate for this. In fact, this is also what makes the watermark robust, since we can also tolerate bit flips caused by an attacker munging the artifact. Of course, the better our approximation of the initial randomness, the more robust our watermark will be, since we&amp;#39;ll be able to correct for more bit flips.&lt;/p&gt;&lt;p&gt;To see why this watermark is detectable, notice that overwriting bits of the randomness with a fixed codeword (&lt;code&gt;c=encode(m)&lt;/code&gt;) biases the randomness and thereby the output of the model. Thus, the distribution of watermarked artifacts will be slightly different from unwatermarked artifacts, perhaps even noticeably so. This watermark is also forgeable, since the encoding algorithm is public and can be run by anyone.&lt;/p&gt;&lt;p&gt;The challenge then is to design error-correcting codes for which codewords look random, and generating codewords requires knowledge of a secret key held by the model operator. Christ-Gunn-2024 names these &lt;b&gt;pseudorandom error-correcting codes&lt;/b&gt;, or simply &lt;b&gt;pseudorandom codes&lt;/b&gt;.&lt;/p&gt;&lt;p&gt;A pseudorandom code consists of three algorithms:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;k = key_gen()&lt;/code&gt;: the key generation algorithm. Let&amp;#39;s call &lt;code&gt;k&lt;/code&gt; the &lt;b&gt;watermarking key&lt;/b&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;c = encode(k,m)&lt;/code&gt;: the encoding algorithm takes in a message &lt;code&gt;m&lt;/code&gt; and outputs a codeword &lt;code&gt;c&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;code&gt;m = decode(k,c)&lt;/code&gt;: the decoding algorithm takes in a codeword &lt;code&gt;c&lt;/code&gt; and outputs the underlying message &lt;code&gt;m&lt;/code&gt;, or an indication that decoding failed.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The term &amp;quot;pseudorandom&amp;quot; refers to the fact that codewords aren&amp;#39;t technically random bit strings. Intuitively, an attacker can distinguish a codeword from a random string if it manages to guess the watermarking key. Thus, our goal is to choose parameters for the code such that distinguishing codewords from random â for example, by guessing the watermarking key â is hard for any computationally bounded attacker.&lt;/p&gt;&lt;p&gt;To use a pseudorandom code for watermarking, the operator first generates a watermarking key &lt;code&gt;k&lt;/code&gt;. Then each time it gets a prompt from a user, it generates the initial randomness, embeds &lt;code&gt;c=encode(k,m)&lt;/code&gt; into the initial randomness, and runs the model. To verify the watermark, the operator runs the model in reverse to get the inverted randomness, extracts the inverted codeword, &lt;code&gt;c&lt;/code&gt;&lt;code&gt;&lt;sup&gt;*&lt;/sup&gt;&lt;/code&gt;, and computes &lt;code&gt;decode(k,c&lt;/code&gt;&lt;code&gt;&lt;sup&gt;*&lt;/sup&gt;&lt;/code&gt;&lt;code&gt;)&lt;/code&gt;: if decoding succeeds, then the watermark is present.&lt;/p&gt;&lt;p&gt;In order for this watermark to be undetectable, we need to pick an embedding of the codeword that doesn&amp;#39;t change the distribution of the initial randomness. The details of this embedding depend on the model. Let&amp;#39;s take a look at &lt;a href=\&quot;https://en.wikipedia.org/wiki/Stable_Diffusion\&quot;&gt;&lt;u&gt;Stable Diffusion&lt;/u&gt;&lt;/a&gt; as an example.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;a-watermark-for-stable-diffusion\&quot;&gt;A watermark for Stable Diffusion&lt;/h3&gt;\n            &lt;a href=\&quot;#a-watermark-for-stable-diffusion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;&lt;a href=\&quot;https://en.wikipedia.org/wiki/Stable_Diffusion\&quot;&gt;&lt;u&gt;Stable Diffusion&lt;/u&gt;&lt;/a&gt; is a model used for image generation that takes as input a tensor of normally distributed floating point numbers called a &lt;b&gt;latent&lt;/b&gt;. The model uses the user&amp;#39;s prompt to &amp;quot;denoise&amp;quot; the latent tensor over a number of iterations, then converts the final version of the latent to an image.&lt;/p&gt;&lt;h4&gt;Approximating the initial latent&lt;/h4&gt;&lt;p&gt;Diffusion inversion is an iterative process that returns an exact or approximate initial latent by reversing the sampling process that generated an image. Inversion for text to image diffusion models is a relatively new area of research. A common application of diffusion inversion is &lt;a href=\&quot;https://arxiv.org/abs/2211.09794\&quot;&gt;&lt;u&gt;editing images by text prompts&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://arxiv.org/abs/2010.02502\&quot;&gt;&lt;u&gt;Denoising Diffusion Implicit Models (DDIMs)&lt;/u&gt;&lt;/a&gt; are iterative, implicit probabilistic models that can generate high quality images using a faster sampling process than other approaches, as it only requires a relatively small number of timesteps to generate a sample. This makes &lt;a href=\&quot;https://arxiv.org/abs/2211.09794\&quot;&gt;&lt;u&gt;DDIM Inversion&lt;/u&gt;&lt;/a&gt; a popular inversion technique because it is computationally fast, as it requires only a few timesteps to return an approximate initial latent of a generated image. Despite its popularity, it has some known limitations and can be &lt;a href=\&quot;https://arxiv.org/abs/2312.12540v5\&quot;&gt;&lt;u&gt;problematic to use for tasks where exact image reproduction is required&lt;/u&gt;&lt;/a&gt;. These limitations have led researchers to explore techniques that produce &lt;a href=\&quot;https://arxiv.org/abs/2311.18387\&quot;&gt;&lt;u&gt;exact initial latents&lt;/u&gt;&lt;/a&gt;. However, since watermarks based on pseudorandom codes can tolerate errors, it&amp;#39;s worth investigating whether DDIM Inversion suffices for our purposes.&lt;/p&gt;&lt;p&gt;Before we can generate an approximate initial latent, we need a generated image. To do this we use a pretrained Stable Diffusion model that uses a DDIM scheduler. The scheduler performs the âdenoisingâ process that generates an image from a random noise seed (initial latent). By default, the pipeline computes random latents; when embedding a watermark we will generate this latent ourselves as described in the next section. The Stable Diffusion pipelines in the code snippets below sets the number of inference steps to 50. This parameter controls the number of steps the denoising process takes. 50 steps provides a nice balance between speed and image quality.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;from stable_diffusion.utils import build_stable_diffusion_pipeline\nfrom stable_diffusion.schedulers import ddim_scheduler\n\n# Instantiate Stable Diffusion pipeline\nmodel_cache_path = &amp;#039;./model_cache&amp;#039;\nmodel = &amp;#039;stabilityai/stable-diffusion-2-1-base&amp;#039;\nscheduler, _ = ddim_scheduler()\npipe, device = build_stable_diffusion_pipeline(model, model_cache_path, scheduler)\n\n# Generate image\nprompt = &amp;#039;grainy photo of a UFO at night&amp;#039;\nimage, _ = pipe(prompt, num_inference_steps=50, return_dict=False)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To compute the approximate initial latent for the image we generated, we run the sampling process backwards. We could include the prompt, but in the case of verifying a watermark, we will usually not know the initial prompt, so we instead just set it to the empty string:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;from PIL import Image\nfrom stable_diffusion.utils import build_stable_diffusion_pipeline,   \n                                   convert_pil_to_latents\nfrom stable_diffusion.schedulers import ddim_inverse_scheduler\n\n# Load image\nimg = Image.open(image_path)\n\n# Instantiate Stable Diffusion pipeline with DDIM Inverse scheduler\nmodel_cache_path = &amp;#039;./model_cache&amp;#039;\nmodel = &amp;#039;stabilityai/stable-diffusion-2-1-base&amp;#039;\nscheduler, _= ddim_inverse_scheduler()\npipe, _ = build_stable_diffusion_pipeline(model, model_cache_path, scheduler)\n\n# Convert the input image to latent space\nimage_latent = convert_pil_to_latents(pipe, img)\n\n# Invert the sampling process that generated the image with an empty prompt\ninverted_latent, _ = pipe(&amp;#039;&amp;#039;, output_type=&amp;#039;latent&amp;#039;, latents=image_latent,  \n                          num_inference_steps=50, return_dict=False)&lt;/pre&gt;&lt;/code&gt;\n            &lt;h4&gt;Embedding the code&lt;/h4&gt;&lt;p&gt;The initial latent used for stable diffusion consists of a bunch of floating point numbers, each independently and &lt;a href=\&quot;https://en.wikipedia.org/wiki/Normal_distribution\&quot;&gt;&lt;u&gt;normally&lt;/u&gt;&lt;/a&gt; distributed with a mean of zero.&lt;/p&gt;&lt;p&gt;The following observation is from a &lt;a href=\&quot;https://arxiv.org/pdf/2410.07369\&quot;&gt;&lt;u&gt;recent evaluation&lt;/u&gt;&lt;/a&gt; of the watermark of Christ and Gunn for stable diffusion. (There they used a more sophisticated but expensive inversion method than DDIM.) Observe that the probability that each number is negative is equal to the probability that the number is positive. Likewise, if the code is indeed pseudorandom, then each bit of the codeword is computationally indistinguishable from a bit that is one with probability Â½ and zero with probability Â½.&lt;/p&gt;&lt;p&gt;To embed the codeword in the latent, we just set the sign of each number according to the corresponding bit of the codeword:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;from stable_diffusion.utils import build_stable_diffusion_pipeline\nfrom stable_diffusion.schedulers import ddim_scheduler\nimport numpy as np\nimport torch\n\n# Generate a normally distributed latent. For the default image\n# size of 512x512 pixels, the latent shape is `[1, 4, 64, 64]`.\ninitial_latent = np.abs(np.random.randn(*LATENTS_SHAPE))\n\nwith np.nditer(initial_latent, op_flags=[&amp;#039;readwrite&amp;#039;]) as it:\n    \tcodeword = encode(k, m)\n    \tfor (i, x) in enumerate(it):\n             # `codeword[i]` is a `bool` representing the `i`-th bit of\n             # the codeword.\n             x *= 1 if codeword[i] else -1\n\nwatermarked_latent = torch.from_numpy(initial_latent).to(dtype=torch.float32)\n\n# Instantiate Stable Diffusion pipeline\nmodel_cache_path = &amp;#039;./model_cache&amp;#039;\nmodel = &amp;#039;stabilityai/stable-diffusion-2-1-base&amp;#039;\nscheduler, _ = ddim_scheduler()\npipe, _ = build_stable_diffusion_pipeline(model, model_cache_path, scheduler)\n\n# Generate watermarked image\nprompt = &amp;#039;grainy photo of a UFO at night&amp;#039;\nwatermarked_image, _ = pipe(prompt, num_inference_steps=50,\n                                              latents=watermarked_latent, \n                                              return_dict=False)&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To verify this watermark, we compute the inverted latent, extract the codeword, and attempt to decode:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;from PIL import Image\nfrom stable_diffusion.utils import build_stable_diffusion_pipeline,   \n                                   convert_pil_to_latents\nfrom stable_diffusion.schedulers import ddim_inverse_scheduler\nimport numpy as np\n\n# Load image\nimg = Image.open(image_path)\n\n# Instantiate Stable Diffusion pipeline with DDIM Inverse scheduler\nmodel_cache_path = &amp;#039;./model_cache&amp;#039;\nmodel = &amp;#039;stabilityai/stable-diffusion-2-1-base&amp;#039;\nscheduler, _ = ddim_inverse_scheduler()\npipe, _ = build_stable_diffusion_pipeline(model, model_cache_path, scheduler)\n\n# Convert the input image to latent space\nimage_latent = convert_pil_to_latents(pipe, img)\n\n# Invert the sampling process that generated the image\ninverted_latent, _ = pipe(&amp;#039;&amp;#039;, output_type=&amp;#039;latent&amp;#039;, latents=image_latent,     \n                         num_inference_steps=50, return_dict=False)\n\nwatermark_verified = False\nwith np.nditer(inverted_latent.cpu().numpy()) as it:\n    inverted_codeword = []\n    for x in it:\n         inverted_codeword.append(x &amp;gt; 0)\n\n    if decode(k, inverted_codeword) == m:\n         watermark_verified = True&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This should work in theory given the error-correcting properties of the code. But does it work in practice?&lt;/p&gt;&lt;h4&gt;Evaluation&lt;/h4&gt;&lt;p&gt;A good approximate initial latent is one that is very similar to the original latent that generated an image.Â  Given our embedding of a codeword into the latent, we define similarity as latents that have a high percentage of overlapping or matching signs.&lt;/p&gt;&lt;p&gt;To get a feel for this difference, we can visualize it by comparing a generated image to the same image, but with the inverted latent (these images are unwatermarked):&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/ZFAAipEvnp6u79lcQrk5t/0d06e07468c05d707289a322937e9253/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;540\&quot; height=\&quot;540\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Figure 3: Image generated with prompt &amp;#39;grainy photo of a UFO at night&amp;#39; (left) and the same image generated using the inverted latent (right).&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;To evaluate how good the approximate latents are for preserving the robustness of watermarks, we randomly sampled 1,000 prompts from the &lt;a href=\&quot;https://github.com/google-research/parti?tab=readme-ov-file#partiprompts-benchmark\&quot;&gt;&lt;u&gt;PartiPrompts benchmark dataset&lt;/u&gt;&lt;/a&gt;. For each of these prompts we generated initial latent and inverted latent pairs. We then computed our similarity metric for each pair. We found that on average, 82% of the signs matched for all initial latent and inverted latent pairs, and at least 75% of signs matched for 90% of the pairs.&lt;/p&gt;&lt;p&gt;We were pleasantly surprised with how accurate the approximation was on average. If 75% of the signs are preserved, then this gives us a decent margin for correcting for errors introduced by an attacker attempting to remove the watermark. Of course a better approximation would give us a better robustness margin. More study is required to fully understand the strengths and limitations of using DDIM Inversion for watermark decoding.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;candidate-pseudorandom-codes\&quot;&gt;Candidate pseudorandom codes&lt;/h3&gt;\n            &lt;a href=\&quot;#candidate-pseudorandom-codes\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Now that we have a feel for how to apply pseudorandom codes, let&amp;#39;s take a look at how we actually build them. Although the field is barely a year old, we already have a handful of candidates.&lt;/p&gt;&lt;p&gt;One obvious idea to try is to compose a plain error-correcting code with some cryptographic primitive to make the code pseudorandom. For instance, we might use some standard authenticated encryption scheme, like &lt;a href=\&quot;https://datatracker.ietf.org/doc/html/rfc8452\&quot;&gt;&lt;u&gt;AES-GCM-SIV&lt;/u&gt;&lt;/a&gt;, to encrypt &lt;code&gt;m&lt;/code&gt;, then apply an error correcting code to the ciphertext. (The watermarking key would be the encryption key.) This &amp;quot;encrypt-then-encode&amp;quot; composition seems natural because encryption schemes are already designed so that their ciphertexts are pseudorandom. Unfortunately, error correcting codes are generally highly structured, and this structure would be betrayed by the codeword, even when applied to a (pseudo)random input.&lt;/p&gt;&lt;p&gt;The dual composition, &amp;quot;encode-then-encrypt&amp;quot;, also doesn&amp;#39;t work. If the ciphertext is non-malleable, as in AES-GCM-SIV, then we wouldn&amp;#39;t be able to tolerate any number of bit flips. On the other hand, if the ciphertext were malleable, as in &lt;a href=\&quot;https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_(CTR)\&quot;&gt;&lt;u&gt;AES-CTR&lt;/u&gt;&lt;/a&gt;, then the attacker would be able to forge codewords by manipulating a known codeword in a targeted manner.&lt;/p&gt;&lt;p&gt;The strategy of Christ-Gunn-2024 is to modify an existing error-correcting code to make it pseudorandom.&lt;/p&gt;&lt;h4&gt;Pseudorandom LDPC codes&lt;/h4&gt;&lt;p&gt;Their starting point is the widely used &lt;a href=\&quot;https://en.wikipedia.org/wiki/Low-density_parity-check_code\&quot;&gt;&lt;u&gt;Low-Density Parity-Check (LDPC) code&lt;/u&gt;&lt;/a&gt;. This code is defined by a &lt;b&gt;parity check&lt;/b&gt; matrix &lt;code&gt;P&lt;/code&gt; with and a corresponding &lt;b&gt;generator&lt;/b&gt; matrix &lt;code&gt;G&lt;/code&gt;. The parity check matrix has bit entries and might look something like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Python\&quot;&gt;&lt;code class=\&quot;language-Python\&quot;&gt;import numpy as np\nP = np.matrix([[1, 0, 1],\n               [0, 0, 1],\n               [0, 1, 1],\n               [1, 1, 1],\n               [1, 0, 0],\n               [0, 1, 0]])&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This matrix is used to check if a given bit string is a codeword. By definition, a codeword is any bit string c for which the weight of &lt;code&gt;P*c&lt;/code&gt; (the number ones in the output of &lt;code&gt;P*c&lt;/code&gt;) is small. (Note that arithmetic is modulo &lt;code&gt;2&lt;/code&gt; here.) The generator matrix &lt;code&gt;G&lt;/code&gt; is constructed from &lt;code&gt;P &lt;/code&gt;so that it can be used as the encoder. In particular, for any bit string &lt;code&gt;m&lt;/code&gt;, &lt;code&gt;c=G*m &lt;/code&gt;is a codeword. The performance of this code depends in large part on the sparsity of the parity check matrix: roughly speaking, the more zero entries the matrix has, the more the bit flips the code can tolerate.&lt;/p&gt;&lt;p&gt;The main idea of Christ-Gunn-2024 is to tune the parameters of the LDPC code (the dimensions of the parity check matrix and its density) so that when the parity-check matrix &lt;code&gt;P&lt;/code&gt; is chosen at random, the generator matrix &lt;code&gt;G&lt;/code&gt; is pseudorandom. This means that, intuitively, when we encode a random input &lt;code&gt;m&lt;/code&gt; as &lt;code&gt;c=G*m&lt;/code&gt;, the codeword &lt;code&gt;c&lt;/code&gt; is also pseudorandom. (There is a bit more that goes into constructing the input &lt;code&gt;m&lt;/code&gt;, but this is roughly the idea.)&lt;/p&gt;&lt;p&gt;It&amp;#39;s easy to see that a watermark based on this construction is robust, as it follows immediately from the capacity of LDPC to tolerate bit flips. Ensuring the watermark remains undetectable is more delicate, as it relies on relatively strong and understudied computational assumptions. As a result, it&amp;#39;s not clear today for what parameter ranges this scheme is concretely secure. (There has been some progress here: &lt;a href=\&quot;https://eprint.iacr.org/2024/1425\&quot;&gt;&lt;u&gt;a recent preprint&lt;/u&gt;&lt;/a&gt; by Surendra Ghentiyala and Venkatesan Guruswami showed that the pseudorandomness of Christ-Gunn-2024 can be proved with slightly weaker assumptions.)&lt;/p&gt;&lt;p&gt;To get a feel for how things might go wrong, consider what happens if the attacker manages to guess one of the rows of the parity check matrix&lt;code&gt; P&lt;/code&gt;. When we take the dot product of this row with a codeword, then the output will be 0 with high probability. (By definition, &lt;code&gt;c&lt;/code&gt; is a codeword if the sum of the dot products of &lt;code&gt;c &lt;/code&gt;with each row of &lt;code&gt;P&lt;/code&gt; is small.) But if we take the dot product of this row with a random bit string, then we should expect to see 0 with probability roughly Â½. This gives us a way of distinguishing codewords from random bit strings.&lt;/p&gt;&lt;p&gt;Guessing a row of &lt;code&gt;P&lt;/code&gt; is easy if the matrix is too sparse. In the extreme case, if each row has only one bit set, then there are only &lt;code&gt;n&lt;/code&gt; possible values for that row, where &lt;code&gt;n&lt;/code&gt; is the number of columns of &lt;code&gt;P&lt;/code&gt;. On the other hand, making &lt;code&gt;P&lt;/code&gt; too dense will degrade the code&amp;#39;s ability to detect bit flips.&lt;/p&gt;&lt;p&gt;Similarly, it may be easy to guess a row of &lt;code&gt;P&lt;/code&gt; if the length of the codeword itself (&lt;code&gt;n&lt;/code&gt;) is too small. Thus, in order for this code to be pseudorandom, it is necessary (but not sufficient) for the number of possible parity check matrices to be so large that exhaustively searching for &lt;code&gt;P&lt;/code&gt; is not feasible. This can be done by increasing the size of the codeword or tolerating fewer bit flips.&lt;/p&gt;&lt;h4&gt;Pseudorandom codes from PRFs&lt;/h4&gt;&lt;p&gt;Another approach to constructing pseudorandom codes comes from &lt;a href=\&quot;https://eprint.iacr.org/2024/898\&quot;&gt;&lt;u&gt;a 2024 preprint&lt;/u&gt;&lt;/a&gt; from Noah Golowich and Ankur Moitra. Their starting point is a common cryptographic primitive called a pseudorandom function (PRF). They require a PRF that takes as input a key &lt;code&gt;k&lt;/code&gt;, a bit string &lt;code&gt;x&lt;/code&gt; of length &lt;code&gt;m&lt;/code&gt; and outputs a bit, denoted &lt;code&gt;F(k,m)&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Suppose our codewords are &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/code&gt;, â£&lt;code&gt;w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/code&gt;&lt;code&gt;=F(k,x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/code&gt;&lt;code&gt;)&lt;/code&gt;, â¦,&lt;code&gt; x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;n&lt;/sub&gt;&lt;/code&gt;,&lt;code&gt; w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;n&lt;/sub&gt;&lt;/code&gt;&lt;code&gt;=F(k,x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;n&lt;/sub&gt;&lt;/code&gt;&lt;code&gt;) &lt;/code&gt;where &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/code&gt;, â¦, &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;n&lt;/sub&gt;&lt;/code&gt; are random &lt;code&gt;m&lt;/code&gt;-bit strings. (Notice that the codeword length is &lt;code&gt;(m+1)*n&lt;/code&gt;.) To verify if a string is a codeword, we parse the codeword into &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/code&gt;, &lt;code&gt;w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/code&gt;, â¦, &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;n&lt;/sub&gt;&lt;/code&gt;, &lt;code&gt;w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;n&lt;/sub&gt;&lt;/code&gt;&lt;code&gt; &lt;/code&gt;and check if &lt;code&gt;w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/code&gt;&lt;code&gt; = F(k,x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/code&gt;&lt;code&gt;)&lt;/code&gt; for all &lt;code&gt;i&lt;/code&gt;. If the number of checks that pass is sufficiently high, then the string is likely a codeword.&lt;/p&gt;&lt;p&gt;It&amp;#39;s easy to see that this code is pseudorandom if the output of &lt;code&gt;F&lt;/code&gt; is pseudorandom. However, it&amp;#39;s not very robust: to make the &lt;code&gt;i&lt;/code&gt;-th check fail, we just need to flip a single bit, &lt;code&gt;w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/code&gt;. The attacker just needs to flip a sufficient number of these bits to cause verification to fail. To defeat this attack, the encoder permutes the bits of the codeword with a secret, random permutation. That way the attacker has to guess the position of a sufficient number of &lt;code&gt;w&lt;/code&gt;&lt;code&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/code&gt;s in the permuted bit string. (A bit more is required to make this scheme provably robust, but this is the idea.)&lt;/p&gt;&lt;p&gt;Note that the number of bit flips we can tolerate with this scheme depends significantly on the number of PRF checks. This in turn determines the length of the codeword, so we may only get a reasonable degree of robustness for longer codewords. Note that we can increase the number of PRF checks by decreasing the length &lt;code&gt;m&lt;/code&gt; of the &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/code&gt;s, but making these strings too short is detrimental for pseudorandomness. (What happens if we happen to randomly pick &lt;code&gt;x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;i&lt;/sub&gt;&lt;/code&gt;&lt;code&gt;==x&lt;/code&gt;&lt;code&gt;&lt;sub&gt;j&lt;/sub&gt;&lt;/code&gt;&lt;code&gt; &lt;/code&gt;for &lt;code&gt;i!=j&lt;/code&gt;?)&lt;/p&gt;&lt;h4&gt;Are these schemes practical?&lt;/h4&gt;&lt;p&gt;In our own experiments with Stable Diffusion, we were able to tune the LDPC code to tolerate up to 33% of the codeword bits being mangled, which is likely more than sufficient for robustness in practice. However, achieving this required making the parity check matrix so sparse that the code is not strongly pseudorandom. Thus, the resulting watermark cannot be considered cryptographically undetectable. Among the parameter sets for which the code is plausibly pseudorandom, we didn&amp;#39;t find any for which the code tolerates more than 5% bit flips.&lt;/p&gt;&lt;p&gt;Our findings were similar for the PRF-based code: with plausibly pseudorandom parameters, we couldn&amp;#39;t tune the code to tolerate more than 1% bit flips. Like the LDPC code, we can crank this higher by sacrificing pseudorandomness, but we weren&amp;#39;t able to crack 5% with any parameters we tried.&lt;/p&gt;&lt;p&gt;There are a few ways to think about this.&lt;/p&gt;&lt;p&gt;First, for both codes, robustness improves as the codeword gets larger. In particular, if the latent space for Stable Diffusion were larger, then we&amp;#39;d expect to be able to tolerate more bit flips. In general, cryptographic watermarks of all kinds perform better when there is more randomness to work with. For example, short responses produced by chatbots are especially hard for any watermarking strategy, including pseudorandom codes.&lt;/p&gt;&lt;p&gt;Another takeaway is that we need a better approximation of the initial latent than provided by DDIM. Indeed, &lt;a href=\&quot;https://arxiv.org/abs/2410.07369\&quot;&gt;&lt;u&gt;in their own evaluation&lt;/u&gt;&lt;/a&gt; of the LDPC-based code, Sam Gunn, Xuandong Zhao, and Dawn Song chose a much more sophisticated inversion method, which exhibited better results, albeit at a higher computational cost.&lt;/p&gt;&lt;p&gt;A third view is that, as a practical matter, cryptographic undetectability might not be all that important for some applications. For instance, we might decide the watermark is good enough on the basis of statistical tests to check for biases within, or correlations across, codewords. Of course, such tests can&amp;#39;t rule out the possibility of perceptible differences between watermarked and unwatermarked artifacts.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7BVEy8oI4HZUU6u7zUgW9G/20c48669c252dfe99a689dd0860a54a7/2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;540\&quot; height=\&quot;540\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Figure 4: Images with verified LDPC watermarks generated with prompt &amp;#39;grainy photo of a UFO at night&amp;#39;.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;conclusion\&quot;&gt;Conclusion&lt;/h3&gt;\n            &lt;a href=\&quot;#conclusion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The sign of a good abstraction boundary is that it allows folks to collaborate across disciplines. With pseudorandom codes, it seems like we&amp;#39;ve landed on the right abstraction for AI watermarking: it&amp;#39;s up to cryptography experts to figure out how to instantiate them; and it&amp;#39;s up to AI/ML experts to figure out how to embed them in their applications. We believe this separation of concerns has the potential to make watermarking easier to deploy, especially for operators like Cloudflare&amp;#39;s &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt;, who don&amp;#39;t train and maintain the models themselves.&lt;/p&gt;&lt;p&gt;After spending a few weeks playing around with this stuff, we&amp;#39;re excited by the potential of pseudorandom codes to make strong watermarks for generative AI. However, we feel it will take some time for this field to yield practical schemes.&lt;/p&gt;&lt;p&gt;Existing candidates will require further study to determine the parameter ranges for which they provide good security. It is also worthwhile to investigate new approaches to building pseudorandom codes, perhaps starting with some other error correcting code besides LDPC. We should also examine what is even theoretically possible in this space: perhaps there is a fundamental tension between detectability and robustness that can&amp;#39;t be resolved for some parameter regimes.&lt;/p&gt;&lt;p&gt;It&amp;#39;s also going to be important for watermarks based on pseudorandom codes to be publicly verifiable, as some other cryptographic watermarks are. Concretely, the LDPC code is sort of analogous to public key encryption, where the ciphertext corresponds to a codeword. It might be possible to flip this paradigm around and make a digital signature where the signature is a codeword. Of course, this only works when the weights of the model are also publicly available.&lt;/p&gt;&lt;p&gt;On the AI/ML side, we need to look closer at methods of approximating the initial randomness for different types of models. This blog looked at what is perhaps the simplest possible method for Stable Diffusion, and while this seems to work pretty well, it&amp;#39;s obvious that we can do a lot better. It&amp;#39;s just a matter of keeping costs low. A good rule of thumb might be that verifying the watermark should not be more expensive than watermarked inference.&lt;/p&gt;&lt;p&gt;Pseudorandom codes may also have applications beyond watermarking. When we circulated this blog post internally, an idea that came up a lot was to somehow apply this technology to non-AI content, to embed in the content its provenance. Indeed, this is the idea behind the &lt;a href=\&quot;https://blog.cloudflare.com/preserve-content-credentials-with-cloudflare-images/\&quot;&gt;&lt;u&gt;C2PA integration&lt;/u&gt;&lt;/a&gt;. Pseudorandom codes aren&amp;#39;t immediately applicable, but may be in the future. Wherever you have a source of randomness in the process of generating some artifact, like digital photography, you can embed in that randomness a codeword.&lt;/p&gt;&lt;p&gt;Thanks for reading! We hope we&amp;#39;ve managed to pique your interest in this field. We certainly will be following along. If you&amp;#39;d like to play with the code we used to produce the numbers in this blog, or just make some cool watermarked AI content, you can find our demo on &lt;a href=\&quot;https://github.com/cloudflareresearch/poc-watermark\&quot;&gt;&lt;u&gt;GitHub&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.287Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3qaJH3smwhOnOoWKFqpgXb/719d23b2ecf3dad33a6138c6a867efef/Feature_Image.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1QsJUMpv0QBSLiVZLLQJ3V&quot;],&quot;name&quot;:[0,&quot;Cryptography&quot;],&quot;slug&quot;:[0,&quot;cryptography&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Teresa Brooks-Mejia&quot;],&quot;slug&quot;:[0,&quot;teresa-brooks-mejia&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/35abVYCxYHLlih4LkviBar/c87d5e5895ed4a2763f4d06b481b5017/Teresa_Brooks-Mejia.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Christopher Patton&quot;],&quot;slug&quot;:[0,&quot;christopher-patton&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4sRmXhNpfDUovdIUpP9Keq/8dfd4dfc04f8f6d45b0a69121edfa0e2/christopher-patton.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;It&#39;s becoming increasingly difficult to tell the difference between web content produced by humans and web content produced by AI. In this post, we&#39;re going to look at a promising new approach to making AI content distinguishable as such without impacting the performance of the model.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/an-early-look-at-cryptographic-watermarks-for-ai-generated-content&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;An early look at cryptographic watermarks for AI-generated content&quot;],&quot;description&quot;:[0,&quot;It&#39;s becoming increasingly difficult to tell the difference between web content produced by humans and web content produced by AI. In this post, we&#39;re going to look at a promising new approach to making AI content distinguishable as such without impacting the performance of the model.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/58DAG34uHa8FNZRtJmoLhT/b126c1e32d9640693e793a49b015bc21/OG_Share_2024__12_.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;4IkgXzyemEEsN7A6Cd18hb&quot;],&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;slug&quot;:[0,&quot;bots-heuristics&quot;],&quot;excerpt&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules and deploy new releases rapidly.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Within the Cloudflare Application Security team, every &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/what-is-machine-learning/\&quot;&gt;&lt;u&gt;machine learning&lt;/u&gt;&lt;/a&gt; model we use is underpinned by a rich set of static rules that serve as a ground truth and a baseline comparison for how our models are performing. These are called heuristics. Our Bot Management heuristics engine has served as an important part of eight global &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/#machine-learning\&quot;&gt;&lt;u&gt;machine learning (ML) models&lt;/u&gt;&lt;/a&gt;, but we needed a more expressive engine to increase our accuracy. In this post, weâll review how we solved this by moving our heuristics to the Cloudflare &lt;a href=\&quot;https://developers.cloudflare.com/ruleset-engine/\&quot;&gt;&lt;u&gt;Ruleset Engine&lt;/u&gt;&lt;/a&gt;. Not only did this provide the platform we needed to write more nuanced rules, it made our platform simpler and safer, and provided &lt;a href=\&quot;https://www.cloudflare.com/application-services/products/bot-management/\&quot;&gt;&lt;u&gt;Bot Management&lt;/u&gt;&lt;/a&gt; customers more flexibility and visibility into their bot traffic.Â Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;bot-detection-via-simple-heuristics\&quot;&gt;Bot detection via simple heuristics&lt;/h3&gt;\n            &lt;a href=\&quot;#bot-detection-via-simple-heuristics\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In Cloudflareâs bot detection, we build heuristics from attributes like software library fingerprints, HTTP request characteristics, and internal threat intelligence. Heuristics serve three separate purposes for bot detection:Â &lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Bot identification: If traffic matches a heuristic, we can identify the traffic as definitely automated traffic (with a &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/bot-score/\&quot;&gt;&lt;u&gt;bot score&lt;/u&gt;&lt;/a&gt; of 1) without the need of a machine learning model.Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Train ML models: When traffic matches our heuristics, we create labelled datasets of bot traffic to train new models. Weâll use many different sources of labelled bot traffic to train a new model, but our heuristics datasets are one of the highest confidence datasets available to us.Â Â Â &lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Validate models: We benchmark any new model candidateâs performance against our heuristic detections (among many other checks) to make sure it meets a required level of accuracy.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;While the existing heuristics engine has worked very well for us, as bots evolved we needed the flexibility to write increasingly complex rules. Unfortunately, such rules were not easily supported in the old engine. Customers have also been asking for more details about which specific heuristic caught a request, and for the flexibility to enforce different policies per heuristic ID.Â  We found that by building a new heuristics framework integrated into the Cloudflare Ruleset Engine, we could build a more flexible system to write rules and give Bot Management customers the granular explainability and control they were asking for.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-need-for-more-efficient-precise-rules\&quot;&gt;The need for more efficient, precise rules&lt;/h3&gt;\n            &lt;a href=\&quot;#the-need-for-more-efficient-precise-rules\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In our previous heuristics engine, we wrote rules in &lt;a href=\&quot;https://www.lua.org/\&quot;&gt;&lt;u&gt;Lua&lt;/u&gt;&lt;/a&gt; as part of our &lt;a href=\&quot;https://openresty.org/\&quot;&gt;&lt;u&gt;openresty&lt;/u&gt;&lt;/a&gt;-based reverse proxy. The Lua-based engine was limited to a very small number of characteristics in a rule because of the high engineering cost we observed with adding more complexity.&lt;/p&gt;&lt;p&gt;With Lua, we would write fairly simple logic to match on specific characteristics of a request (i.e. user agent). Creating new heuristics of an existing class was fairly straight forward. All weâd need to do is define another instance of the existing class in our database. However, if we observed malicious traffic that required more than two characteristics (as a simple example, user-agent and &lt;a href=\&quot;https://en.wikipedia.org/wiki/Autonomous_system_(Internet)\&quot;&gt;&lt;u&gt;ASN&lt;/u&gt;&lt;/a&gt;) to identify, weâd need to create bespoke logic for detections. Because our Lua heuristics engine was bundled with the code that ran ML models and other important logic, all changes had to go through the same review and release process. If we identified malicious traffic that needed a new heuristic class, and we were also blocked by pending changes in the codebase, weâd be forced to either wait or rollback the changes. If weâre writing a new rule for an âunder attackâ scenario, every extra minute it takes to deploy a new rule can mean an unacceptable impact to our customerâs business.Â &lt;/p&gt;&lt;p&gt;More critical than time to deploy is the complexity that the heuristics engine supports. The old heuristics engine only supported using specific request attributes when creating a new rule. As bots became more sophisticated, we found we had to reject an increasing number of new heuristic candidates because we werenât able to write precise enough rules. For example, we found a &lt;a href=\&quot;https://go.dev/\&quot;&gt;&lt;u&gt;Golang&lt;/u&gt;&lt;/a&gt; TLS fingerprint frequently used by bots and by a small number of corporate VPNs. We couldnât block the bots without also stopping the legitimate VPN usage as well, because the old heuristics platform lacked the flexibility to quickly compile sufficiently nuanced rules. Luckily, we already had the perfect solution with Cloudflare Ruleset Engine.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;our-new-heuristics-engine\&quot;&gt;Our new heuristics engine&lt;/h3&gt;\n            &lt;a href=\&quot;#our-new-heuristics-engine\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The Ruleset Engine is familiar to anyone who has written a WAF rule, Load Balancing rule, or Transform rule, &lt;a href=\&quot;https://blog.cloudflare.com/announcing-firewall-rules/\&quot;&gt;&lt;u&gt;just to name a few&lt;/u&gt;&lt;/a&gt;. For Bot Management, the Wireshark-inspired syntax allows us to quickly write heuristics with much greater flexibility to vastly improve accuracy. We can write a rule in &lt;a href=\&quot;https://yaml.org/\&quot;&gt;&lt;u&gt;YAML&lt;/u&gt;&lt;/a&gt; that includes arbitrary sub-conditions and inherit the same framework the WAF team uses to both ensure any new rule undergoes a rigorous testing process with the ability to rapidly release new rules to stop attacks in real-time.Â &lt;/p&gt;&lt;p&gt;Writing heuristics on the Cloudflare Ruleset Engine allows our engineers and analysts to write new rules in an easy to understand YAML syntax. This is critical to supporting a rapid response in under attack scenarios, especially as we support greater rule complexity. Hereâs a simple rule using the new engine, to detect empty user-agents restricted to a specific JA4 fingerprint (right), compared to the empty user-agent detection in the old Lua based system (left):Â &lt;/p&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;Old&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;b&gt;New&lt;/b&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;code&gt;local _M = {}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;local EmptyUserAgentHeuristic = {&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â heuristic = {},&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;}&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;EmptyUserAgentHeuristic.__index = EmptyUserAgentHeuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Creates and returns empty user agent heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param params table contains parameters injected into EmptyUserAgentHeuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @return EmptyUserAgentHeuristic table&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function _M.new(params)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â return setmetatable(params, EmptyUserAgentHeuristic)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Adds heuristic to be used for inference in `detect` method&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param heuristic schema.Heuristic table&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function EmptyUserAgentHeuristic:add(heuristic)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â self.heuristic = heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;--- Detect runs empty user agent heuristic detection&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @param ctx context of request&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;-- @return schema.Heuristic table on successful detection or nil otherwise&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;function EmptyUserAgentHeuristic:detect(ctx)&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â local ua = ctx.user_agent&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â if not ua or ua == &amp;#39;&amp;#39; then&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â return self.heuristic&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;end&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;return _M&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;code&gt;ref: empty-user-agent&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â description: Empty or missing &lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;User-Agent header&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â action: add_bot_detection&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â action_parameters:&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â Â Â active_mode: false&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Â Â Â Â Â Â expression: http.user_agent eq &lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;&amp;quot;&amp;quot; and cf.bot_management.ja4 = &amp;quot;t13d1516h2_8daaf6152771_b186095e22b6&amp;quot;&lt;/code&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;p&gt;The Golang heuristic that captured corporate proxy traffic as well (mentioned above) was one of the first to migrate to the new Ruleset engine. Before the migration, traffic matching on this heuristic had a false positive rate of 0.01%. While that sounds like a very small number, this means for every million bots we block, 100 real users saw a Cloudflare challenge page unnecessarily. At Cloudflare scale, even small issues can have real, negative impact.&lt;/p&gt;&lt;p&gt;When we analyzed the traffic caught by this heuristic rule in depth, we saw the vast majority of attack traffic came from a small number of abusive networks. After narrowing the definition of the heuristic to flag the Golang fingerprint only when itâs sourced by the abusive networks, the rule now has a false positive rate of 0.0001% (One out of 1 million).Â  Updating the heuristic to include the network context improved our accuracy, while still blocking millions of bots every week and giving us plenty of training data for our bot detection models. Because this heuristic is now more accurate, newer ML models make more accurate decisions on whatâs a bot and what isnât.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;new-visibility-and-flexibility-for-bot-management-customers\&quot;&gt;New visibility and flexibility for Bot Management customersÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#new-visibility-and-flexibility-for-bot-management-customers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;While the new heuristics engine provides more accurate detections for all customers and a better experience for our analysts, moving to the Cloudflare Ruleset Engine also allows us to deliver new functionality for Enterprise Bot Management customers, specifically by offering more visibility. This new visibility is via a new field for Bot Management customers called Bot Detection IDs. Every heuristic we use includes a unique Bot Detection ID. These are visible to Bot Management customers in analytics, logs, and firewall events, and they can be used in the firewall to write precise rules for individual bots.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3cYXHw8tFUjdJQGm93gFcE/0a3f6ab89a70410ebb7dd2c6f4f3a677/1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1043\&quot; height=\&quot;292\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/9d7L1r7yN9AEhO26H7SgQ/434f0f934dd4f4498a8d13e85a7660ae/2.png\&quot; alt=\&quot;Bot Detection IDs can be selected in HTTP Request LogPush job configurations\&quot; class=\&quot;kg-image\&quot; width=\&quot;1291\&quot; height=\&quot;485\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Detections also include a specific tag describing the class of heuristic. Customers see these plotted over time in their analytics. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2UlkGQ070UWsmU76IXYqDd/6bca8f28959a8fe8f3013792a17b348a/image4.png\&quot; alt=\&quot;Bot Detection tags plotted over time in customer analytics\&quot; class=\&quot;kg-image\&quot; width=\&quot;881\&quot; height=\&quot;509\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;To illustrate how this data can help give customers visibility into why we blocked a request, hereâs an example request flagged by Bot Management (with the IP address, ASN, and country changed):&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3i6k9ejsBVwlbXUrZFIFJG/4c9cddd11d9f7a8ddf10eb5ff30a027b/4.png\&quot; alt=\&quot; A Firewall Event from a request with an empty user-agent\&quot; class=\&quot;kg-image\&quot; width=\&quot;1574\&quot; height=\&quot;580\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Before, just seeing that our heuristics gave the request a score of 1 was not very helpful in understanding why it was flagged as a bot. Adding our Detection IDs to Firewall Events helps to paint a better picture for customers that weâve identified this request as a bot because that traffic used an empty user-agent. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UQd20VnXCnIav1skHiX6i/18e0cf01106601ae7faf18be50d43365/5.png\&quot; alt=\&quot;A Firewall Event from a request with an empty user-agent that now receives a detection ID described as âempty_ua\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1528\&quot; height=\&quot;938\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In addition to Analytics and Firewall Events, Bot Detection IDs are now available for Bot Management customers to use in Custom Rules, Rate Limiting Rules, Transform Rules, and Workers.Â &lt;/p&gt;&lt;h4&gt;Account takeover detection IDs&lt;/h4&gt;&lt;p&gt;One way weâre focused on improving Bot Management for our customers is by surfacing more attack-specific detections. During Birthday Week, we &lt;a href=\&quot;https://blog.cloudflare.com/a-safer-internet-with-cloudflare/\&quot;&gt;&lt;u&gt;launched Leaked Credentials Check&lt;/u&gt;&lt;/a&gt; for all customers so that security teams could help &lt;a href=\&quot;https://www.cloudflare.com/zero-trust/solutions/account-takeover-prevention/\&quot;&gt;&lt;u&gt;prevent account takeover (ATO) attacks&lt;/u&gt;&lt;/a&gt; by identifying accounts at risk due to leaked credentials. Weâve now added two more detections that can help Bot Management enterprise customers identify suspicious login activity via specific &lt;a href=\&quot;https://developers.cloudflare.com/bots/concepts/detection-ids/#account-takeover-detections\&quot;&gt;&lt;u&gt;detection IDs&lt;/u&gt;&lt;/a&gt; that monitor login attempts and failures on the zone. These detection IDs are not currently affecting the bot score, but will begin to later in 2025. Already, they can help many customers detect more account takeover events now.&lt;/p&gt;&lt;p&gt;Detection ID &lt;b&gt;201326592 &lt;/b&gt;monitors traffic on a customer website and looks for an anomalous rise in login failures (usually associated with brute force attacks), and ID &lt;b&gt;201326593 &lt;/b&gt;looks for an anomalous rise in login attempts (usually associated with credential stuffing).Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4a2LGgB1bXGwFgHQEKFSI9/ff4194a6a470e466274f7b7c51e9dc18/6.png\&quot; alt=\&quot;A new Account Abuse Insights Panel in Security Analytics provides quick filters for Detection IDs measuring suspicious login attempts and failures. These detection IDs can also be combined with other Account Abuse signals like Leaked Credentials.  \&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;714\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;protect-your-applications\&quot;&gt;Protect your applications&lt;/h3&gt;\n            &lt;a href=\&quot;#protect-your-applications\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;If you are a Bot Management customer, log in and head over to the Cloudflare dashboard and take a look in Security Analytics for bot detection IDs &lt;code&gt;201326592&lt;/code&gt; and &lt;code&gt;201326593&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;These will highlight ATO attempts targeting your site. If you spot anything suspicious, or would like to be protected against future attacks, create a rule that uses these detections to keep your application safe.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.157Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5dT9qTVfruhhuHXbJ2N880/792486605cb75cc693f4a64fd3675961/BLOG_1398.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4l3WDYLk6bXCyaRc9pRzXa&quot;],&quot;name&quot;:[0,&quot;Bots&quot;],&quot;slug&quot;:[0,&quot;bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;267TTPMscUWABgYgHSH4ye&quot;],&quot;name&quot;:[0,&quot;Bot Management&quot;],&quot;slug&quot;:[0,&quot;bot-management&quot;]}],[0,{&quot;id&quot;:[0,&quot;urEf9QllkDeGxTu3ysdlo&quot;],&quot;name&quot;:[0,&quot;Application Security&quot;],&quot;slug&quot;:[0,&quot;application-security&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;1QFszkvherAG520Xi1w4Ke&quot;],&quot;name&quot;:[0,&quot;Heuristics&quot;],&quot;slug&quot;:[0,&quot;heuristics&quot;]}],[0,{&quot;id&quot;:[0,&quot;4Hr4XSACbfTmrYAA7iESxH&quot;],&quot;name&quot;:[0,&quot;Edge Rules&quot;],&quot;slug&quot;:[0,&quot;edge-rules&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Curtis Lowder&quot;],&quot;slug&quot;:[0,&quot;curtis-lowder&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7nRYvsW2SrtTZfr9JeX3pL/cf30e6b9652d7d4e1c589cbed3961d60/Curtis_Lowder.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Brian Mitchell&quot;],&quot;slug&quot;:[0,&quot;brian-mitchell&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TRFlHnVIfXX2cQhjt7wuc/86f2173516450dfa1e035b04cd4671c6/Screenshot_2024-12-21_at_17.56.35.png&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Adam Martinetti&quot;],&quot;slug&quot;:[0,&quot;adam-martinetti&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@adamemcf&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/bots-heuristics&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Improved Bot Management flexibility and visibility with new high-precision heuristics&quot;],&quot;description&quot;:[0,&quot;By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules, deploy new releases rapidly, and give Bot Management customers the explainability and control they were asking for.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7aUOa73viLqPiL6maGTTBD/47488b4df31256d503af51b10bc3fcb2/OG_Share_2024__18_.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;1Zh4fm4BB1S3xuVwfETiTE&quot;],&quot;title&quot;:[0,&quot;Trapping misbehaving bots in an AI Labyrinth&quot;],&quot;slug&quot;:[0,&quot;ai-labyrinth&quot;],&quot;excerpt&quot;:[0,&quot;How Cloudflare uses generative AI to slow down, confuse, and waste the resources of AI Crawlers and other bots that donât respect âno crawlâ directives.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Today, weâre excited to announce AI Labyrinth, a new mitigation approach that uses AI-generated content to slow down, confuse, and waste the resources of AI Crawlers and other bots that donât respect âno crawlâ directives. When you opt in, Cloudflare will automatically deploy an AI-generated set of linked pages when we detect inappropriate bot activity, without the need for customers to create any custom rules.&lt;/p&gt;&lt;p&gt;AI Labyrinth is available on an opt-in basis to all customers, including the Free plan.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;using-generative-ai-as-a-defensive-weapon\&quot;&gt;Using Generative AI as a defensive weapon&lt;/h3&gt;\n            &lt;a href=\&quot;#using-generative-ai-as-a-defensive-weapon\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;AI-generated content has exploded, reportedly accounting for &lt;a href=\&quot;https://www.thetimes.co.uk/article/why-ai-content-everywhere-how-to-detect-l2m2kdx9p\&quot;&gt;&lt;u&gt;four of the top 20 Facebook posts&lt;/u&gt;&lt;/a&gt; last fall. Additionally, Medium estimates that &lt;a href=\&quot;https://www.wired.com/story/ai-generated-medium-posts-content-moderation/\&quot;&gt;&lt;u&gt;47% of all content&lt;/u&gt;&lt;/a&gt; on their platform is AI-generated. Like any newer tool it has both wonderful and &lt;a href=\&quot;https://www.npr.org/2024/12/24/nx-s1-5235265/how-to-protect-yourself-from-holiday-ai-scams\&quot;&gt;&lt;u&gt;malicious&lt;/u&gt;&lt;/a&gt; uses.&lt;/p&gt;&lt;p&gt;At the same time, weâve also seen an explosion of new crawlers used by AI companies to scrape data for model training. AI Crawlers generate more than 50 billion requests to the Cloudflare network every day, or just under 1% of all web requests we see. While Cloudflare has several tools for &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;u&gt;identifying and blocking unauthorized AI crawling&lt;/u&gt;&lt;/a&gt;, we have found that blocking malicious bots can alert the attacker that you are on to them, leading to a shift in approach, and a never-ending arms race. So, we wanted to create a new way to thwart these unwanted bots, without letting them know theyâve been thwarted.&lt;/p&gt;&lt;p&gt;To do this, we decided to use a new offensive tool in the bot creatorâs toolset that we havenât really seen used defensively: AI-generated content. When we detect unauthorized crawling, rather than blocking the request, we will link to a series of AI-generated pages that are convincing enough to entice a crawler to traverse them. But while real looking, this content is not actually the content of the site we are protecting, so the crawler wastes time and resources.Â &lt;/p&gt;&lt;p&gt;As an added benefit, AI Labyrinth also acts as a next-generation honeypot. No real human would go four links deep into a maze of AI-generated nonsense. Any visitor that does is very likely to be a bot, so this gives us a brand-new tool to identify and fingerprint bad bots, which we add to our list of known bad actors. Hereâs how we do itâ¦&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-we-built-the-labyrinth\&quot;&gt;How we built the labyrinthÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#how-we-built-the-labyrinth\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;When AI crawlers follow these links, they waste valuable computational resources processing irrelevant content rather than extracting your legitimate website data. This significantly reduces their ability to gather enough useful information to train their models effectively.&lt;/p&gt;&lt;p&gt;To generate convincing human-like content, we used &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/\&quot;&gt;&lt;u&gt;Workers AI&lt;/u&gt;&lt;/a&gt; with an open source model to create unique HTML pages on diverse topics. Rather than creating this content on-demand (which could impact performance), we implemented a pre-generation pipeline that sanitizes the content to prevent any XSS vulnerabilities, and stores it in R2 for faster retrieval. We found that generating a diverse set of topics first, then creating content for each topic, produced more varied and convincing results. It is important to us that we donât generate inaccurate content that contributes to the spread of misinformation on the Internet, so the content we generate is real and related to scientific facts, just not relevant or proprietary to the site being crawled.&lt;/p&gt;&lt;p&gt;This pre-generated content is seamlessly integrated as hidden links on existing pages via our custom HTML transformation process, without disrupting the original structure or content of the page. Each generated page includes appropriate meta directives to protect SEO by preventing search engine indexing. We also ensured that these links remain invisible to human visitors through carefully implemented attributes and styling. To further minimize the impact to regular visitors, we ensured that these links are presented only to suspected AI scrapers, while allowing legitimate users and verified crawlers to browse normally.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2PHSCXVMFipAhGJ5IheXW3/a46aad93f2e60f6d892d4c597a752a58/image4.png\&quot; alt=\&quot;A graph of daily requests over time, comparing different categories of AI Crawlers.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1000\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;A graph of daily requests over time, comparing different categories of AI Crawlers.&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;What makes this approach particularly effective is its role in our continuously evolving bot detection system. When these links are followed, we know with high confidence that it&amp;#39;s automated crawler activity, as human visitors and legitimate browsers would never see or click them. This provides us with a powerful identification mechanism, generating valuable data that feeds into our machine learning models. By analyzing which crawlers are following these hidden pathways, we can identify new bot patterns and signatures that might otherwise go undetected. This proactive approach helps us stay ahead of AI scrapers, continuously improving our detection capabilities without disrupting the normal browsing experience.&lt;/p&gt;&lt;p&gt;By building this solution on our developer platform, we&amp;#39;ve created a system that serves convincing decoy content instantly while maintaining consistent quality - all without impacting your site&amp;#39;s performance or user experience.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;how-to-use-ai-labyrinth-to-stop-ai-crawlers\&quot;&gt;How to use AI Labyrinth to stop AI crawlers&lt;/h3&gt;\n            &lt;a href=\&quot;#how-to-use-ai-labyrinth-to-stop-ai-crawlers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Enabling AI Labyrinth is simple and requires just a single toggle in your Cloudflare dashboard. Navigate to the bot management section within your zone, and toggle the new AI Labyrinth setting to on:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/q1ZQlnnMztSsK8PWD1h0S/ef02f081544dc751f754e9630f17261e/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1388\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/61qBVDv0WFh8YzrbVULtxq/13ec46d7651c59454f9fe3754e253b85/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1598\&quot; height=\&quot;1999\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Once enabled, the AI Labyrinth begins working immediately with no additional configuration needed.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;ai-honeypots-created-by-ai\&quot;&gt;AI honeypots, created by AI&lt;/h3&gt;\n            &lt;a href=\&quot;#ai-honeypots-created-by-ai\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The core benefit of AI Labyrinth is to confuse and distract bots. However, a secondary benefit is to serve as a next-generation honeypot. In this context, a honeypot is just an invisible link that a website visitor canât see, but a bot parsing HTML would see and click on, therefore revealing itself to be a bot. Honeypots have been used to catch hackers as early as the late &lt;a href=\&quot;https://medium.com/@jcart657/the-cuckoos-egg-9b502442ea67\&quot;&gt;&lt;u&gt;1986 Cuckooâs Egg incident&lt;/u&gt;&lt;/a&gt;. And in 2004, &lt;a href=\&quot;https://www.projecthoneypot.org/\&quot;&gt;&lt;u&gt;Project Honeypot&lt;/u&gt;&lt;/a&gt; was created by Cloudflare founders (prior to founding Cloudflare) to let everyone easily deploy free email honeypots, and receive lists of crawler IPs in exchange for contributing to the database. But as bots have evolved, they now proactively look for honeypot techniques like hidden links, making this approach less effective.&lt;/p&gt;&lt;p&gt;AI Labyrinth wonât simply add invisible links, but will eventually create whole networks of linked URLs that are much more realistic, and not trivial for automated programs to spot. The content on the pages is obviously content no human would spend time-consuming, but AI bots are programmed to crawl rather deeply to harvest as much data as possible. When bots hit these URLs, we can be confident they arenât actual humans, and this information is recorded and automatically fed to our machine learning models to help improve our bot identification. This creates a beneficial feedback loop where each scraping attempt helps protect all Cloudflare customers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next\&quot;&gt;Whatâs next&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;This is only the first iteration of using generative AI to thwart bots for us. Currently, while the content we generate is convincingly human, it wonât conform to the existing structure of every website. In the future, weâll continue to work to make these links harder to spot and make them fit seamlessly into the existing structure of the website theyâre embedded in. You can help us by opting in now.&lt;/p&gt;&lt;p&gt;To take the next step in the fight against bots, &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/detections/bot-traffic\&quot;&gt;&lt;u&gt;opt-in to AI Labyrinth&lt;/u&gt;&lt;/a&gt; today.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-03-19T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-03-19T13:00:03.222Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/67doCKRF2T1COUbZ4ZrKXX/f8fa915087f3981a78aab87c2459d1d6/image2.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3DmitkNK6euuD5BlhuvOLW&quot;],&quot;name&quot;:[0,&quot;Security Week&quot;],&quot;slug&quot;:[0,&quot;security-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;4l3WDYLk6bXCyaRc9pRzXa&quot;],&quot;name&quot;:[0,&quot;Bots&quot;],&quot;slug&quot;:[0,&quot;bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;267TTPMscUWABgYgHSH4ye&quot;],&quot;name&quot;:[0,&quot;Bot Management&quot;],&quot;slug&quot;:[0,&quot;bot-management&quot;]}],[0,{&quot;id&quot;:[0,&quot;3404RT2rd0b1M4ZCCIceXx&quot;],&quot;name&quot;:[0,&quot;AI Bots&quot;],&quot;slug&quot;:[0,&quot;ai-bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;6pD9OvooldcqcJ8z8Y6QQ1&quot;],&quot;name&quot;:[0,&quot;Generative AI&quot;],&quot;slug&quot;:[0,&quot;generative-ai&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Reid Tatoris&quot;],&quot;slug&quot;:[0,&quot;reid&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/66Vj67NlvjyTARmLiIWx62/c521fade26000bd9480cb3c6384bf757/reid.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@reidtatoris&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Harsh Saxena&quot;],&quot;slug&quot;:[0,&quot;harsh-saxena&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1eEVnuAy0vFvqrA4DuCOyI/56dcd6d40b152672d6a5a3bedae2f623/Harsh_S.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Luis Miglietti&quot;],&quot;slug&quot;:[0,&quot;luis-miglietti&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1tw979XLb2QgscTjk91Zn0/52cffd3a8cf0c6477c8bbac2b5705a29/Luis_Miglietti.webp&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}]]],&quot;meta_description&quot;:[0,&quot;How Cloudflare uses generative AI to slow down, confuse, and waste the resources of AI Crawlers and other bots that donât respect âno crawlâ directives.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/ai-labyrinth&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Trapping misbehaving bots in an AI Labyrinth&quot;],&quot;description&quot;:[0,&quot;How Cloudflare uses generative AI to slow down, confuse, and waste the resources of AI Crawlers and other bots that donât respect âno crawlâ directives.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4FUVtyRJDVLvzamo0jfTAh/6295cfdeabcf641dfd3e33398f50f2f1/Trapping_misbehaving_bots_in_an_AI_Labyrinth-OG.png&quot;]}]}]]],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}],&quot;localesAvailable&quot;:[1,[]],&quot;footerBlurb&quot;:[0,&quot;Cloudflare&#39;s connectivity cloud protects &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/network-services/&#39; rel=&#39;noreferrer&#39;&gt;entire corporate networks&lt;/a&gt;, helps customers build &lt;a target=&#39;_blank&#39; href=&#39;https://workers.cloudflare.com/&#39; rel=&#39;noreferrer&#39;&gt;Internet-scale applications efficiently&lt;/a&gt;, accelerates any &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/performance/accelerate-internet-applications/&#39; rel=&#39;noreferrer&#39;&gt;website or Internet application&lt;/a&gt;, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/ddos/&#39; rel=&#39;noreferrer&#39;&gt;wards off DDoS attacks&lt;/a&gt;, keeps &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/application-security/&#39; rel=&#39;noreferrer&#39;&gt;hackers at bay&lt;/a&gt;, and can help you on &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/products/zero-trust/&#39; rel=&#39;noreferrer&#39;&gt;your journey to Zero Trust&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;Visit &lt;a target=&#39;_blank&#39; href=&#39;https://one.one.one.one/&#39; rel=&#39;noreferrer&#39;&gt;1.1.1.1&lt;/a&gt; from any device to get started with our free app that makes your Internet faster and safer.&lt;br/&gt;&lt;br/&gt;To learn more about our mission to help build a better Internet, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/learning/what-is-cloudflare/&#39; rel=&#39;noreferrer&#39;&gt;start here&lt;/a&gt;. If you&amp;apos;re looking for a new career direction, check out &lt;a target=&#39;_blank&#39; href=&#39;http://www.cloudflare.com/careers&#39; rel=&#39;noreferrer&#39;&gt;our open positions&lt;/a&gt;.&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;Post&quot;,&quot;value&quot;:true}" await-children><main id="post" class="flex flex-row flex-wrap items-center justify-center pt2 pt4-l"><article class="post-full mw-100 ph3 ph0-l fs-20px"><h1 class="f6 f7-l fw4 gray1 pt1 pt3-l mb1">Take control of public AI application security with Cloudflare&#x27;s Firewall for AI</h1><p class="f3 fw5 gray5 db di-l mt2">2025-03-19</p><ul class="author-lists flex pl0 mt4"><li class="list flex items-center pr2 mb1-ns"><a href="/author/radwa/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/26ps7sSkjvnatLHbGNWuI9/42c3618ee2392f7d7a0dc5f335615fda/radwa.jpg" alt="Radwa Radwan" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/radwa/" class="fw4 f3 no-underline black mr3">Radwa Radwan</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/xmflsct/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1P7uGGL8VL5tDIimsTxWo1/5a08bf32629b5bab2ecee50b73ba8c61/xmflsct.jpg" alt="Zhiyuan Zheng" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/xmflsct/" class="fw4 f3 no-underline black mr3">Zhiyuan Zheng</a></div></li></ul><section class="post-full-content"><div class="mb2 gray5">7 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1YKV76zTbFGfD2YQ3AVygP/9f31e788ebe8e0d76e1462f487b5e230/Feature_Image.png" alt=""/><div class="post-content lh-copy gray1"><p>Imagine building an LLM-powered assistant trained on your developer documentation and some internal guides to quickly help customers, reduce support workload, and improve user experience. Sounds great, right? But what if sensitive data, such as employee details or internal discussions, is included in the data used to train the LLM? Attackers could manipulate the assistant into exposing sensitive data or exploit it for social engineering attacks, where they deceive individuals or systems into revealing confidential details, or use it for targeted phishing attacks. Suddenly, your helpful AI tool turns into a serious security liability.Â </p>
          <div class="flex anchor relative">
            <h3 id="introducing-firewall-for-ai-the-easiest-way-to-discover-and-protect-llm-powered-apps">Introducing Firewall for AI: the easiest way to discover and protect LLM-powered apps</h3>
            <a href="#introducing-firewall-for-ai-the-easiest-way-to-discover-and-protect-llm-powered-apps" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>Today, as part of Security Week 2025, weâre announcing the open beta of Firewall for AI, first <a href="https://blog.cloudflare.com/firewall-for-ai/"><u>introduced during Security Week 2024</u></a>. After talking with customers interested in protecting their LLM apps, this first beta release is focused on discovery and PII detection, and more features will follow in the future.</p><p>If you are already using Cloudflare application security, your LLM-powered applications are automatically discovered and protected, with no complex setup, no maintenance, and no extra integration needed.</p><p>Firewall for AI is an inline security solution that protects user-facing LLM-powered applications from abuse and data leaks, integrating directly with Cloudflareâs <a href="https://developers.cloudflare.com/waf/"><u>Web Application Firewall (WAF)</u></a> to provide instant protection with zero operational overhead. This integration enables organizations to leverage both AI-focused safeguards and established WAF capabilities.</p><p>Cloudflare is uniquely positioned to solve this challenge for all of our customers. As a <a href="https://www.cloudflare.com/en-gb/learning/cdn/glossary/reverse-proxy/"><u>reverse proxy</u></a>, we are model-agnostic whether the application is using a third-party LLM or an internally hosted one. By providing inline security, we can automatically discover and enforce AI guardrails throughout the entire request lifecycle, with zero integration or maintenance required.</p>
          <div class="flex anchor relative">
            <h3 id="firewall-for-ai-beta-overview">Firewall for AI beta overview</h3>
            <a href="#firewall-for-ai-beta-overview" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>The beta release includes the following security capabilities:</p><p><b>Discover:</b> identify LLM-powered endpoints across your applications, an essential step for effective request and prompt analysis.</p><p><b>Detect:</b> analyze the incoming requests prompts to recognize potential security threats, such as attempts to extract sensitive data (e.g., âShow me transactions using 4111 1111 1111 1111â). This aligns with<a href="https://genai.owasp.org/llmrisk/llm022025-sensitive-information-disclosure/"> <u>OWASP LLM022025 - Sensitive Information Disclosure</u></a>.</p><p><b>Mitigate:</b> enforce security controls and policies to manage the traffic that reaches your LLM, and reduce risk exposure.</p><p>Below, we review each capability in detail, exploring how they work together to create a comprehensive security framework for AI protection.</p>
          <div class="flex anchor relative">
            <h3 id="discovering-llm-powered-applications">Discovering LLM-powered applications</h3>
            <a href="#discovering-llm-powered-applications" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>Companies are racing to find all possible use cases where an LLM can excel. Think about site search, a chatbot, or a shopping assistant. Regardless of the application type, our goal is to determine whether an application is powered by an LLM behind the scenes.</p><p>One possibility is to look for request path signatures similar to what major LLM providers use. For example, <a href="https://platform.openai.com/docs/api-reference/chat/create"><u>OpenAI</u></a>, <a href="https://docs.perplexity.ai/api-reference/chat-completions"><u>Perplexity</u></a> or <a href="https://docs.mistral.ai/api/#tag/chat"><u>Mistral</u></a> initiate a chat using the <code>/chat/completions</code> API endpoint. Searching through our request logs, we found only a few entries that matched this pattern across our global traffic. This result indicates that we need to consider other approaches to finding <i>any</i> application that is powered by an LLM.</p><p>Another signature to research, popular with LLM platforms, is the use of <a href="https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events"><u>server-sent events</u></a>. LLMs need to <a href="https://platform.openai.com/docs/guides/latency-optimization#don-t-default-to-an-llm"><u>âthinkâ</u></a>. <a href="https://platform.openai.com/docs/api-reference/streaming"><u>Using server-sent events</u></a> improves the end userâs experience by sending over each <a href="https://help.openai.com/en/articles/4936856-what-are-tokens-and-how-to-count-them"><u>token</u></a> as soon as it is ready, creating the perception that an LLM is âthinkingâ like a human being. Matching on requests of server-sent events is straightforward using the response header content type of <code>text/event-stream</code>. This approach expands the coverage further, but does not yet cover the <a href="https://stackoverflow.blog/2022/06/02/a-beginners-guide-to-json-the-data-format-for-the-internet/"><u>majority of applications</u></a> that are using JSON format for data exchanges. Continuing the journey, our next focus is on the responses having header content type of <code>application/json</code>.</p><p>No matter how fast LLMs can be optimized to respond, when chatting with major LLMs, we often perceive them to be slow, as we have to wait for them to âthinkâ. By plotting on how much time it takes for the origin server to respond over identified LLM endpoints (blue line) versus the rest (orange line), we can see in the left graph that origins serving LLM endpoints mostly need more than 1 second to respond, while the majority of the rest takes less than 1 second. Would we also see a clear distinction between origin server response body sizes, where the majority of LLM endpoints would respond with smaller sizes because major LLM providers <a href="https://platform.openai.com/docs/guides/safety-best-practices#constrain-user-input-and-limit-output-tokens"><u>limit output tokens</u></a>? Unfortunately not. The right graph shows that LLM response size largely overlaps with non-LLM traffic.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4CkowlKelGlYueNzSrbsGn/f8091d66a6c0eb8b884c7cc6f2a128ab/1.png" alt="" class="kg-image" width="1220" height="484" loading="lazy"/>
          </figure><p>By dividing origin response size over origin response duration to calculate an effective bitrate, the distinction is even clearer that 80% of LLM endpoints operate slower than 4 KB/s.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5sJKUnLmWwnTWzUOyWVRKO/c98c8fc32dbafa5d79f21effdfc58f34/2.png" alt="" class="kg-image" width="1920" height="1440" loading="lazy"/>
          </figure><p>Validating this assumption by using bitrate as a heuristic across Cloudflareâs traffic, we found that roughly 3% of all origin server responses have a bitrate lower than 4 KB/s. Are these responses all powered by LLMs? Our gut feeling tells us that it is unlikely that 3% of origin responses are LLM-powered!Â </p><p>Among the paths found in the 3% of matching responses, there are few patterns that stand out: 1) GraphQL endpoints, 2) device heartbeat or health check, 3) generators (for QR codes, one time passwords, invoices, etc.). Noticing this gave us the idea to filter out endpoints that have a low variance of response size over time â for instance, invoice generation is mostly based on the same template, while conversations in the LLM context have a higher variance.</p><p>A combination of filtering out known false positive patterns and low variance in response size gives us a satisfying result. These matching endpoints, approximately 30,000 of them, labelled <code>cf-llm</code>, can now be found in API Shield or Web assets, depending on your dashboardâs version, for all customers. Now you can review your endpoints and decide how to best protect them.</p>
          <div class="flex anchor relative">
            <h3 id="detecting-prompts-designed-to-leak-pii">Detecting prompts designed to leak PII</h3>
            <a href="#detecting-prompts-designed-to-leak-pii" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>There are multiple methods to detect PII in LLM prompts. A common method relies on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions"><u>regular expressions (âregexesâ)</u></a>, which is a method we have been using in the WAF for <a href="https://developers.cloudflare.com/waf/managed-rules/reference/sensitive-data-detection/"><u>Sensitive Data Detection</u></a> on the body of the HTTP response from the web server Regexes offer low latency, easy customization, and straightforward implementation. However, regexes alone have limitations when applied to LLM prompts. They require frequent updates to maintain accuracy, and may struggle with more complex or implicit PII, where the information is spread across text rather than a fixed format.Â </p><p>For example, regexes work well for structured data like credit card numbers and addresses, but struggle with PII is embedded in natural language. For instance, âI just booked a flight using my Chase card, ending in 1111â wouldnât trigger a regex match as it lacks the expected pattern, even though it reveals a partial credit card number and financial institution.</p><p>To enhance detection, we rely on a <a href="https://www.ibm.com/think/topics/named-entity-recognition"><u>Named Entity Recognition (NER)</u></a> model, which adds a layer of intelligence to complement regex-based detection. NER models analyze text to identify contextual PII data types, such as names, phone numbers, email addresses, and credit card numbers, making detection more flexible and accurate. Cloudflareâs detection utilizes <a href="https://microsoft.github.io/presidio/"><u>Presidio</u></a>, an open-source PII detection framework, to further strengthen this approach.</p><h4>Using Workers AI to deploy Presidio</h4>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5ruqPkxJBgFCRdsoft1TO1/aa327b069569a0f952c8baea102955b8/3.png" alt="" class="kg-image" width="1999" height="1121" loading="lazy"/>
          </figure><p>In our design, we leverage Cloudflare <a href="https://developers.cloudflare.com/workers-ai/"><u>Workers AI</u></a> as the fastest way to deploy <a href="https://microsoft.github.io/presidio/"><u>Presidio</u></a>. This integration allows us to process LLM app requests inline, ensuring that sensitive data is flagged before it reaches the model.</p><p>Hereâs how it works:</p><p>When Firewall for AI is enabled on an application and an end user sends a request to an LLM-powered application, we pass the request to Cloudflare Workers AI which runs the request through Presidioâs NER-based detection model to identify any potential PII from the available <a href="https://microsoft.github.io/presidio/supported_entities/"><u>entities</u></a>. The output includes metadata like âWas PII found?â and âWhat type of PII entity?â. This output is then processed in our Firewall for AI module, and handed over to other systems, like <a href="https://developers.cloudflare.com/waf/analytics/security-analytics/"><u>Security Analytics</u></a> for visibility, and the rules like <a href="https://developers.cloudflare.com/waf/custom-rules/"><u>Custom rules</u></a> for enforcement. Custom rules allow customers to take appropriate actions on the requests based on the provided metadata.Â </p><p>If no terminating action, like blocking, is triggered, the request proceeds to the LLM. Otherwise, it gets blocked or the appropriate action is applied before reaching the origin.</p>
          <div class="flex anchor relative">
            <h3 id="integrating-ai-security-into-the-waf-and-analytics">Integrating AI security into the WAF and Analytics</h3>
            <a href="#integrating-ai-security-into-the-waf-and-analytics" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>Securing AI interactions shouldn&#39;t require complex integrations. Firewall for AI is seamlessly built into Cloudflareâs WAF, allowing customers to enforce security policies before prompts reach LLM endpoints. With this integration, there are <a href="https://developers.cloudflare.com/waf/detections/firewall-for-ai/#fields"><u>new fields available</u></a> in Custom and Rate limiting rules. The rules can be used to take immediate action, such as blocking or logging risky prompts in real time.</p><p>For example, security teams can filter LLM traffic to analyze requests containing PII-related prompts. Using Cloudflareâs WAF rules engine, they can create custom security policies tailored to their AI applications.</p><p>Hereâs what a rule to block detected PII prompts looks like:</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4cvlFU0sia6dZly2LZGG8l/670dbb1ad5068f0fd5d8f4afde9e9e02/4.png" alt="" class="kg-image" width="1999" height="576" loading="lazy"/>
          </figure><p>Alternatively, if an organization wants to allow certain PII categories, such as location data, they can create an exception rule:</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/wYFkoQyHFoFNwHmKtaaG3/94c7ae78dbabacf5dd8583af9e8eb071/5.png" alt="" class="kg-image" width="1984" height="600" loading="lazy"/>
          </figure><p>In addition to the rules, users can gain visibility into LLM interactions, detect potential risks, and enforce security controls using <a href="https://developers.cloudflare.com/waf/analytics/security-analytics/"><u>Security Analytics</u></a> and <a href="https://developers.cloudflare.com/waf/analytics/security-events/"><u>Security Events</u></a>. You can find more details in our <a href="https://developers.cloudflare.com/waf/detections/firewall-for-ai/"><u>documentation</u></a>.</p>
          <div class="flex anchor relative">
            <h3 id="whats-next-token-counting-guardrails-and-beyond">What's next: token counting, guardrails, and beyond</h3>
            <a href="#whats-next-token-counting-guardrails-and-beyond" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>Beyond PII detection and creating security rules, weâre developing additional capabilities to strengthen AI security for our customers. The next feature weâll release is token counting, which analyzes prompt structure and length. Customers can use the token count field in Rate Limiting and WAF Custom rules to prevent their users from sending very long prompts, which can impact third party model bills, or allow users to abuse the models. This will be followed by using AI to detect and allow content moderation, which will provide more flexibility in building guardrails in the rules.</p><p>If you&#39;re an enterprise customer, join the Firewall for AI beta today! Contact your customer team to start monitoring traffic, building protection rules, and taking control of your LLM traffic.</p></div></section><section class="post-full-content flex flex-row flex-wrap mw7 center mb4"><div class="post-content lh-copy w-100 gray1 bt b--gray8 pt4">Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href="https://www.cloudflare.com/careers" rel='noreferrer'>our open positions</a>.</div></section><div class="pv2 ph0-l mw7 center" id="social-buttons"><div class="mt5-l mt2 mb4 f2 flex flex-row-ns flex-column flex-wrap"><a id="social-button-hn" title="Discuss on Hacker News" href="https://news.ycombinator.com/submitlink?u=https://blog.cloudflare.com/take-control-of-public-ai-application-security-with-cloudflare-firewall-for-ai" target="_blank" rel="noreferrer" class="mr2-ns mb0-l white link b pv3 ph3 mb3 " style="background-color:#0055DC"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 512 512" class="mr2"><g><path d="M31,31v450h450V31H31z M270.1,287.6v94.9h-28.1v-94.9L165,143.5h31.9L256,254.3l59.1-110.8H347
C347,143.5,270.1,287.6,270.1,287.6z"></path></g></svg><span class="v-mid">Discuss on Hacker News</span></a></div></div><iframe sandbox="allow-scripts allow-popups allow-popups-to-escape-sandbox" title="cloudflare-tv-live-link" id="cloudflare-tv-embed" src="https://cloudflare.tv/embed/live.html" loading="lazy"></iframe><a href="/tag/security-week/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security Week</a><a href="/tag/security/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security</a><a href="/tag/llm/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">LLM</a><a href="/tag/web-asset-discovery/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Web Asset Discovery</a></article></main><div class="ph3 pv3"><div class=" flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="black fw5 f4 mt4">Follow on X</p></div><div class="w-100 pb2"><span>Radwa Radwan</span><span class="ph1">|</span><a href="https://x.com/@RadwaRadwan__" class="no-underline">@RadwaRadwan__</a></div><div class="w-100 pb2"><span>Cloudflare</span><span class="ph2">|</span><a href="https://x.com/@cloudflare" class="no-underline">@cloudflare</a></div></div></div><div data-testid="related-posts-section" class="pv4 ph3 ph0-l flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="orange fw5 f4 mt4 ttu">Related posts</p></div><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-19T13:00+00:00">March 19, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/cloudflare-for-ai-supporting-ai-adoption-at-scale-with-a-security-first-approach/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Cloudflare for AI: supporting AI adoption at scale with a security-first approach</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">With Cloudflare for AI, developers, security teams and content creators can leverage Cloudflareâs network and portfolio of tools to secure, observe and make AI applications resilient and safe to use.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/michael-tremante/" class="fw5 f2 black no-underline">Michael Tremante</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/ai/" class="no-underline f1 fw2 blue3 underline-hover">AI<!-- -->,</a>Â </span><span><a href="/tag/security/" class="no-underline f1 fw2 blue3 underline-hover">Security</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-19T13:00+00:00">March 19, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/an-early-look-at-cryptographic-watermarks-for-ai-generated-content/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">An early look at cryptographic watermarks for AI-generated content</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">It&#x27;s hard to tell the difference between web content produced by humans and web content produced by AI. We&#x27;re taking new approach to making AI content distinguishable without impacting performance. <!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/teresa-brooks-mejia/" class="fw5 f2 black no-underline">Teresa Brooks-Mejia</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/christopher-patton/" class="fw5 f2 black no-underline">Christopher Patton</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/ai/" class="no-underline f1 fw2 blue3 underline-hover">AI<!-- -->,</a>Â </span><span><a href="/tag/cryptography/" class="no-underline f1 fw2 blue3 underline-hover">Cryptography</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-19T13:00+00:00">March 19, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/bots-heuristics/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Improved Bot Management flexibility and visibility with new high-precision heuristics</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">By building and integrating a new heuristics framework into the Cloudflare Ruleset Engine, we now have a more flexible system to write rules and deploy new releases rapidly.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/curtis-lowder/" class="fw5 f2 black no-underline">Curtis Lowder</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/brian-mitchell/" class="fw5 f2 black no-underline">Brian Mitchell</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/adam-martinetti/" class="fw5 f2 black no-underline">Adam Martinetti</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/bots/" class="no-underline f1 fw2 blue3 underline-hover">Bots<!-- -->,</a>Â </span><span><a href="/tag/bot-management/" class="no-underline f1 fw2 blue3 underline-hover">Bot Management<!-- -->,</a>Â </span><span><a href="/tag/application-security/" class="no-underline f1 fw2 blue3 underline-hover">Application Security<!-- -->,</a>Â </span><span><a href="/tag/machine-learning/" class="no-underline f1 fw2 blue3 underline-hover">Machine Learning<!-- -->,</a>Â </span><span><a href="/tag/heuristics/" class="no-underline f1 fw2 blue3 underline-hover">Heuristics<!-- -->,</a>Â </span><span><a href="/tag/edge-rules/" class="no-underline f1 fw2 blue3 underline-hover">Edge Rules<!-- -->,</a>Â </span><span><a href="/tag/security/" class="no-underline f1 fw2 blue3 underline-hover">Security</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-03-19T13:00+00:00">March 19, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/ai-labyrinth/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Trapping misbehaving bots in an AI Labyrinth</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">How Cloudflare uses generative AI to slow down, confuse, and waste the resources of AI Crawlers and other bots that donât respect âno crawlâ directives.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/reid/" class="fw5 f2 black no-underline">Reid Tatoris</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/harsh-saxena/" class="fw5 f2 black no-underline">Harsh Saxena</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/luis-miglietti/" class="fw5 f2 black no-underline">Luis Miglietti</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/security-week/" class="no-underline f1 fw2 blue3 underline-hover">Security Week<!-- -->,</a>Â </span><span><a href="/tag/bots/" class="no-underline f1 fw2 blue3 underline-hover">Bots<!-- -->,</a>Â </span><span><a href="/tag/bot-management/" class="no-underline f1 fw2 blue3 underline-hover">Bot Management<!-- -->,</a>Â </span><span><a href="/tag/ai-bots/" class="no-underline f1 fw2 blue3 underline-hover">AI Bots<!-- -->,</a>Â </span><span><a href="/tag/ai/" class="no-underline f1 fw2 blue3 underline-hover">AI<!-- -->,</a>Â </span><span><a href="/tag/machine-learning/" class="no-underline f1 fw2 blue3 underline-hover">Machine Learning<!-- -->,</a>Â </span><span><a href="/tag/generative-ai/" class="no-underline f1 fw2 blue3 underline-hover">Generative AI</a>Â </span></div></article></div><!--astro:end--></astro-island><footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">Â© <!-- -->2025<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"923196b80c5a05af","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"2bc156e5f250476cb274d269511ffb57","b":1}' crossorigin="anonymous"></script>
