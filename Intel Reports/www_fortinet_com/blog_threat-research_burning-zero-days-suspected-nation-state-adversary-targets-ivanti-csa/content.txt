
    <!DOCTYPE HTML>
    <html lang="en" data-template="post-page">
    <head>
        
        
        
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/visitorapi.min.js"/>
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/at.js"/>
            <script>

                   ;(function(win, doc, style, timeout) {
                   var STYLE_ID = 'at-body-style';
                   function getParent() {
                      return doc.getElementsByTagName('head')[0];
                   }
                   function addStyle(parent, id, def) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.createElement('style');
                      style.id = id;
                      style.innerHTML = def;
                      parent.appendChild(style);
                   }
                   function removeStyle(parent, id) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.getElementById(id);
                      if (!style) {
                      return;
                      }
                      parent.removeChild(style);
                   }
                   addStyle(getParent(), STYLE_ID, style);
                   setTimeout(function() {
                      removeStyle(getParent(), STYLE_ID);
                   }, timeout);
                   }(window, document, "body {opacity: 0 !important}", 3000));
                </script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/visitorapi.min.js"></script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/at.js"></script>
        
        
    <meta charset="UTF-8"/>
    <title>Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA | FortiGuard Labs</title>
    <meta name="keywords" content="FortiGuard Labs Threat Research,zero-day vulnerability"/>
    <meta name="description" content="A case where an advanced adversary was observed exploiting three vulnerabilities affecting the Ivanti Cloud Services Appliance (CSA). This incident is a prime example of how threat actors chain zero-day vulnerabilities to gain initial access to a victim’s network. Learn more."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA | FortiGuard Labs"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A case where an advanced adversary was observed exploiting three vulnerabilities affecting the Ivanti Cloud Services Appliance (CSA). This incident is a prime example of how threat actors chain zer…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-heros/ivanti-hero.jpg"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Faisal Abdul Malik Qureshi, John Simmons, Jared Betts, Luca Pugliese, Trent Healy, Ken Evans, Robert Reyes"/>

    <meta property="article:section" content="FortiGuard Labs Threat Research"/>


    <meta property="article:published_time" content="2024-10-11T15:00:00.000Z"/>


    <meta property="article:tag" content="zero-day vulnerability"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>

<link rel="canonical" href="https://www.fortinet.com/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa"/>










    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.900b148ab7b87024003111a1245cca9c.css" type="text/css">





<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    



        <!-- BE IXF: BE IXF: Place getHeadOpen just inside of the head tag -->
        
        
<!-- be_ixf, sdk, gho-->
<meta name="be:sdk" content="java_sdk_1.6.7" />
<meta name="be:timer" content="34ms" />
<meta name="be:norm_url" content="https://www.fortinet.com/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa" />
<meta name="be:capsule_url" content="https://ixfd1-api.bc0a.com/api/ixf/1.0.0/get_capsule/f00000000310757/01164515105" />
<meta name="be:api_dt" content="pny_2024; pnm_10; pnd_22; pnh_11; pnmh_11; pn_epoch:1729620686854" />
<meta name="be:mod_dt" content="pny_1969; pnm_12; pnd_31; pnh_16; pnmh_00; pn_epoch:0" />
<meta name="be:orig_url" content="https://www.fortinet.com/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa?ref=thestack.technology" />
<meta name="be:messages" content="34432" /><script type='text/javascript'>
if (window.BEJSSDKObserver === undefined) {
  (function(BEJSSDKObserver, $, undefined) {
    var observer = void 0;
    var listeners = [];
    var readySet = [];
    var doc = window.document;
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

    function checkSelector(selector, fn, indexList) {
      var elements = doc.querySelectorAll(selector);
  /**
    issues on IE @see https://www.codesd.com/item/javascript-es6-not-a-function-error.html
    elements = Array.from(elements);

    */
    for (var i = 0, len = elements.length; i < len; i++) {
      /* -1 means all instances */
      if (indexList != -1 && !(i in indexList)) {
        continue;
      }
      var element = elements[i];
      for (var j = 0; j < readySet.length; j++) {
        if (readySet[j] == element.className || readySet[j] == element.id) {
          return;
        }
      }
      if (element.className) {
        readySet.push(element.className);
      }
      if (element.id) {
        readySet.push(element.id);
      }

      if (!element.ready || MutationObserver==null) {
        element.ready = true;
        fn.call(element, element);
      }
    }
  }

  function checkListeners() {
    listeners.forEach(function (listener) {
      return checkSelector(listener.selector, listener.fn, listener.indexList);
    });
  }

  function removeListener(selector, fn) {
    var i = listeners.length;
    while (i--) {
      var listener = listeners[i];
      if (listener.selector === selector && listener.fn === fn) {
        listeners.splice(i, 1);
        if (!listeners.length && observer) {
          observer.disconnect();
          observer = null;
        }
      }
    }
  }

/**
 * Fire event on first js selector
 * @param selector string to watch on
 * @param fn       callback function
 * @param index_list can be undefined which means only first one
 *                   or -1 which means all
 *                   or a list of allowable indexes
 */
 BEJSSDKObserver.jsElementReady = function(selector, fn, index_list) {
  if (index_list === undefined) {
    index_list = [];
    index_list.push(0);
  }

  if (MutationObserver != null) {
    if (!observer) {
      observer = new MutationObserver(checkListeners);
      observer.observe(doc.documentElement, {
        childList: true,
        subtree: true
      });
    }
    listeners.push({ selector: selector, fn: fn, indexList: index_list });
  } else {
    /* <= IE8 */
    if (!document.addEventListener) {
      /* log("<=IE8 attachEvent assignment"); */
      document.addEventListener = document.attachEvent;
    }
    document.addEventListener("DOMContentLoaded", function(event) {
      var elements = doc.querySelectorAll(selector);
      for (var i = 0, len = elements.length; i < len; i++) {
        /* -1 means all instances */
        if (index_list != -1 && !(i in index_list)) {
          continue;
        }
        var element = elements[i];
        element.ready = true;
        fn.call(element, element);
      }
    });
  }

  checkSelector(selector, fn, index_list);
  return function () {
    return removeListener(selector, fn);
  };
};
}(window.BEJSSDKObserver = window.BEJSSDKObserver || {}));
}
var jsElementReady = window.BEJSSDKObserver.jsElementReady;

if (window.BELinkBlockGenerator === undefined) {
  (function(BELinkBlockGenerator, $, undefined) {
    BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = 100;
    BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = 200;

    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE = 0;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE = 1;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE = 2;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE = 3;

    BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE = 0;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_POST_APPEND_ELEMENT = 1;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT = 2;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT = 3;

    BELinkBlockGenerator.setMaximumHeadlineLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = length;
    };

    BELinkBlockGenerator.setMaximumDescriptionLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = length;
    };

    BELinkBlockGenerator.generateIndividualLinks = function(parentElement, linkStructure, link) {
      var link_level_element_tag = linkStructure[0];
      var link_level_element = document.createElement(link_level_element_tag);
      var link_attribute_dictionary = linkStructure[1];
      var allowable_elements = linkStructure[2];
      var children_link_structures = linkStructure[3];
      for (var link_attribute_key in link_attribute_dictionary) {
        link_level_element.setAttribute(link_attribute_key, link_attribute_dictionary[link_attribute_key]);
      }

      var added_something = false;
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE)>=0) {
        link_level_element.setAttribute('href', link.url);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE)>=0 && link.h1) {
        var headline_text = link.h1;
        if (headline_text.length > BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) {
          headline_text = headline_text.substring(0, BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) + '...';
        }
        var text_node = document.createTextNode(headline_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE)>=0 && link.desc) {
        var desc_text = link.desc;
        if (desc_text.length > BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) {
          desc_text = desc_text.substring(0, BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) + '...';
        }
        var text_node = document.createTextNode(desc_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE)>=0 && link.image) {
        link_level_element.setAttribute('src', link.image);
        added_something = true;
      }
/**
    don't emit for empty links, desc, headline, image
    except for parent structures where allowable_length=0
    */
    if (!added_something && allowable_elements.length != 0) {

      return;
    }
    /* go depth first */
    for (var childrenIndex=0; childrenIndex<children_link_structures.length; childrenIndex++) {
      var childLinkStructure = children_link_structures[childrenIndex];
      BELinkBlockGenerator.generateIndividualLinks(link_level_element, childLinkStructure, link);
    }
    parentElement.appendChild(link_level_element);
  };

  BELinkBlockGenerator.insertLinkBlocks = function(targetElement, replacementStrategy, overallStructure, linkStructure, links,
                                                   titleStructure) {
    if (targetElement == null) {
      return;
    }

    if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE) {
      while (targetElement.firstChild) {
        targetElement.removeChild(targetElement.firstChild);
      }
    }

    var previousElement = targetElement;
    for (var i=0;i<overallStructure.length;i++) {
      var level_definition = overallStructure[i];
      var level_element_tag = level_definition[0];
      var level_element = document.createElement(level_element_tag);
      var attribute_dictionary = level_definition[1];
      for (var attribute_key in attribute_dictionary) {
        level_element.setAttribute(attribute_key, attribute_dictionary[attribute_key]);
      }

      /* need to place title structure */
      if (titleStructure && titleStructure[0] == i) {
        var title_element_tag = titleStructure[1];
        var title_element = document.createElement(title_element_tag);
        var title_attribute_dictionary = titleStructure[2];
        var title_text_content = titleStructure[3];
        for (var title_attribute_key in title_attribute_dictionary) {
          title_element.setAttribute(title_attribute_key, title_attribute_dictionary[title_attribute_key]);
        }

        var title_text_node = document.createTextNode(title_text_content);
        title_element.appendChild(title_text_node);


        level_element.appendChild(title_element);
      }

      /* last level place links */
      if (i == overallStructure.length-1) {
        for (var link_i=0; link_i < links.length; link_i++) {
          var link = links[link_i];
          for (var linkStructureIndex=0;linkStructureIndex < linkStructure.length; linkStructureIndex++) {
            BELinkBlockGenerator.generateIndividualLinks(level_element, linkStructure[linkStructureIndex], link)
          }
        }
      }

      /* first level child we need to check placement */
      if (previousElement == targetElement) {
        if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT) {
          /* 2 means insert right before */
          previousElement.insertBefore(level_element, targetElement.firstChild);
        } else if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT) {
          /* 3 means insert right before at parent level */
          var parentElement = previousElement.parentElement;
          parentElement.insertBefore(level_element, previousElement);
        } else {
          previousElement.appendChild(level_element);
        }
      } else {
        previousElement.appendChild(level_element);
      }
      previousElement = level_element;
    }
  };
}(window.BELinkBlockGenerator = window.BELinkBlockGenerator || {}))
};
</script>


        <!--BE IXF: Header End -->


    </head>
    <body class="table-of-content-body">
    



    
<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>FortiGuard Labs Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/life-at-fortinet">
                                <span>Life at Fortinet</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>FortiGuard Labs Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/life-at-fortinet">
                    <span>Life at Fortinet</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div id="blog-site-search" class="b1-header__search" aria-expanded="false"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <button class="b1-header__search-toggle" aria-controls="blog-site-search" aria-label="Search">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </button>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-heros/ivanti-hero.jpg);">
    <img class="ratio" alt="Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA | FortiGuard Labs" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">FortiGuard Labs Threat Research</p>
        
        
        

        <h1 class="b4-hero__headline">Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA</h1>
        
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=Faisal+Abdul+Malik+Qureshi">Faisal Abdul Malik Qureshi,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+John+Simmons"> John Simmons,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Jared+Betts"> Jared Betts,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Luca+Pugliese"> Luca Pugliese,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Trent+Healy"> Trent Healy,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                              <a href="/blog/search?author=+Ken+Evans"> Ken Evans</a> and
                                          
                                           
                                      
                                  
                          

                                  
                                      
                                            
                                              <a href="/blog/search?author=+Robert+Reyes"> Robert Reyes</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | October 11, 2024</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="Table-Content aem-GridColumn aem-GridColumn--default--12">
<div class="blog-toc">
    <div class="b3-blog-list__row ">
        <div class="b3-blog-list__column-left table-content-wrapper automatic">
            <ul class="table-of-content">
                <li class="header"><img class="toc-icon" src="/content/dam/fortinet/images/toc-icon.jpg" alt=""/>Article Contents</li>
                
            </ul>
        </div>
        <div class="aem-GridColumn aem-GridColumn--default--8 b3-blog-list__column-right scrolling-content automatic">
            

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=Faisal+Abdul+Malik+Qureshi">Faisal Abdul Malik Qureshi,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+John+Simmons"> John Simmons,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Jared+Betts"> Jared Betts,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Luca+Pugliese"> Luca Pugliese,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Trent+Healy"> Trent Healy,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                              <a href="/blog/search?author=+Ken+Evans"> Ken Evans</a> and
                                          
                                           
                                      
                                  
                          

                                  
                                      
                                            
                                              <a href="/blog/search?author=+Robert+Reyes"> Robert Reyes</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | October 11, 2024</span>
</div>

            




    
    
    <div class="cmp cmp-text">
  <p style="margin-left: 80.0px;"><b>Affected Platforms: </b>Ivanti Cloud Services Appliance version 4.6 and prior<br />
<b>Impacted Users:</b> Any organization<br />
<b>Impact:</b> Remote attackers gain control of the vulnerable systems<br />
<b>Severity Level:</b> Critical</p>
<p>Today FortiGuard Labs is releasing this blog post about a case where an advanced adversary was observed exploiting three vulnerabilities affecting the Ivanti Cloud Services Appliance (CSA). At the time of our investigation, two out of the three identified vulnerabilities were not publicly known. This incident is a prime example of how threat actors chain zero-day vulnerabilities to gain initial access to a victim’s network.</p>
<h2><span style="font-weight: normal;">Background</span></h2>
<p>In a recent incident response engagement, FortiGuard Incident Response (FGIR) services were engaged by a customer to investigate malicious communication originating from their network. During the investigation, FGIR came across an adversary who had gained access to the customer’s network by exploiting the CVE-2024-8190 and two previously unknown vulnerabilities affecting the PHP front end of the Ivanti CSA appliance.</p>
<p>The incident was detected by the customer on September 9, 2024, when some of its internal systems were found to be communicating to a malicious IP address, <i>206[.]189[.]156[.]69</i>. FGIR was engaged the next day.</p>
<h2><span style="font-weight: normal;">Vulnerabilities Overview and Disclosure</span></h2>
<p>During the IR investigation, FGIR observed that the threat actor exploited the vulnerability CVE-2024-8190 in conjunction with the following two previously publicly unknown vulnerabilities:</p>
<ul>
<li>A publicly unknown path traversal vulnerability on the resource <i>/client/index.php</i>, to gain unauthorized access to other resources like <i>users.php</i>, <i>reports.php</i> etc. <i>(CVE-2024-8963, disclosed September 19)</i></li>
<li>A publicly unknown command injection vulnerability affecting the resource <i>reports.php</i>. <i>(CVE-2024-9380, disclosed October 8)</i><br />
</li>
</ul>
<p>These resources are located under the root folder of the PHP web front, which serves as the management console of the CSA.</p>
<p>On September 19, 2024, FGIR disclosed to Ivanti’s security team the discovery of the two new vulnerabilities. During the meeting, the Ivanti team claimed that they were aware and tracking the two publicly unknown exploited vulnerabilities.</p>
<p>On September 19, Ivanti published the advisory for CVE-2024-8963, which addressed the path traversal vulnerability.</p>
<h2><span style="font-weight: normal;">Vulnerabilities Details</span></h2>
<p>On September 10, 2024, at 14:00:02, Ivanti published the security advisory <a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Cloud-Service-Appliance-CSA-CVE-2024-8190?language=de" target="_blank">CVE-2024-8190</a> on their forum. The advisory informed about the discovery of an authenticated command injection vulnerability in the <i>DateTimeTab.php</i> resource, affecting CSA 4.6 with patch 518 and earlier versions.</p>
<p>On September 13, 2024, the CVE-2024-8190 vulnerability was added to the CISA’s Known Exploited Vulnerabilities list. On the same date, Ivanti updated their security advisory to mention that, following public disclosure of the September 10<sup>th</sup>, exploitation of the command injection vulnerability had been observed in the wild.</p>
<p>On September 16, 2024, the research team at Horizon3.ai published <a href="https://www.horizon3.ai/attack-research/cisa-kev-cve-2024-8190-ivanti-csa-command-injection/" target="_blank">the details</a> related to the CVE-2024-8190 vulnerability and also released a proof of concept exploit code.</p>
<h4><span style="font-weight: normal;">Path Traversal Vulnerability – /client/index.php</span></h4>
<p>During the incident response investigation, FGIR observed that the threat actor exploited a path traversal vulnerability on the resource <i>/client/index.php</i> to gain unauthorized authenticated access to the resource <i>/gsb/users.php</i> by sending the following web request:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image.img.jpeg/1728620161388/ivanti-web-request-client-index.jpeg" data-title="gsb web request">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image.img.jpeg/1728620161388/ivanti-web-request-client-index.jpeg" alt="gsb web request" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The first of such requests was sent by the threat actor on September 4, 2024, at 06:53:14 UTC, right before the exploitation of the command injection vulnerability, affecting the resource <i>/gsb/reports.php</i>.</p>
<p>The resource <i>/client/index.php</i> on the PHP web front of the Ivanti CSA appliance can be accessed by unauthenticated users to download the “LANDESK Remote Assistance Client” software package.</p>
<p>The following picture shows how the resource <i>/client/index.php</i> looks when opened in a browser:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1172236801.img.jpeg/1728620210875/fig01-ivanti-gui-dl-landesk.jpeg" data-title="Figure 1: GUI to download LANDESK Remote assistance client">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1172236801.img.jpeg/1728620210875/fig01-ivanti-gui-dl-landesk.jpeg" alt="Figure 1: GUI to download LANDESK Remote assistance client" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 1: GUI to download LANDESK Remote assistance client</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Upon inspecting the /client/index.php’s code, FGIR discovered that, by clicking the “Install now” button present on it, the user is redirected to a resource called /client/download.php:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2006588417.img.jpeg/1728620263874/fig02-ivanti-redirection-download.jpeg" data-title="Figure 2: Redirection to Download.php">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2006588417.img.jpeg/1728620263874/fig02-ivanti-redirection-download.jpeg" alt="Figure 2: Redirection to Download.php" style="width: 400px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 2: Redirection to Download.php</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The resource <i>/client/download.php</i> redirects the user to the page <i>OnDemand.php</i> via the header function.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_184115790.img.jpeg/1728620317634/fig03-ivanti-redirection-ondemand.jpeg" data-title="Figure 3: Redirection to OnDemand.php">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_184115790.img.jpeg/1728620317634/fig03-ivanti-redirection-ondemand.jpeg" alt="Figure 3: Redirection to OnDemand.php" style="width: 250px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 3: Redirection to OnDemand.php</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The resource <i>/client/OnDemand.php</i> contains the code to open a local file called <i>LDSupport.exe</i>, using the php function <i>popen. The local file</i> is served to the user via the php <i>echo</i> command.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_853574561.img.jpeg/1728620365076/fig04-ivanti-code-vulnerable.jpeg" data-title="Figure 4: Code vulnerable to path traversal">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_853574561.img.jpeg/1728620365076/fig04-ivanti-code-vulnerable.jpeg" alt="Figure 4: Code vulnerable to path traversal" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 4: Code vulnerable to path traversal</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The threat actor sent a malformed URL to the resource <i>/client/index.php, </i>by inserting <i>%3F.php</i> at the end of the URI, and appended the URL with the location of the php resource to be accessed through path traversal. Using this technique, the threat actor managed to access the resource <i>/gsb/users.php</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_870303825.img.jpeg/1728620426185/ivanti-client-index-gsb-users.jpeg" data-title="ivanti client index gsb users">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_870303825.img.jpeg/1728620426185/ivanti-client-index-gsb-users.jpeg" alt="ivanti client index gsb users" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The appended resource, <i>/gsb/users.php</i>, was assigned to the variable <i>$filename</i> in the <i>/client/OnDemand.php </i>code, which led to the path traversal vulnerability, allowing the threat actor to view the list of users configured in the CSA appliance. FGIR simulated the exploitation of this vulnerability in its lab environment to understand what information could be acquired with it and the figure below shows the resulting output, which includes the list of users configured on the test appliance:<i></i></p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1543583598.img.jpeg/1728620510929/fig05-ivanti-path-traversal.jpeg" data-title="Figure 5: Path traversal to users.php">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1543583598.img.jpeg/1728620510929/fig05-ivanti-path-traversal.jpeg" alt="Figure 5: Path traversal to users.php" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 5: Path traversal to users.php</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The threat actor exploited this vulnerability several times over the course of their intrusion to access other resources as well, with connections originating from various IP addresses. As seen in the screenshot below, which has all times expressed using the timezone UTC-007, the threat actor used the same vulnerability to access the resource <i>/gsb/datetime.php</i> as well.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1413617697.img.jpeg/1728620553579/fig06-ivanti-path-traversal-vulnerability.jpeg" data-title="Figure 6: Path traversal vulnerability exploitations">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1413617697.img.jpeg/1728620553579/fig06-ivanti-path-traversal-vulnerability.jpeg" alt="Figure 6: Path traversal vulnerability exploitations" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 6: Path traversal vulnerability exploitations</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>FGIR states with medium confidence that the threat actor exploited this path traversal vulnerability to gain access to the resource <i>/gsb/users.php</i> not only to list users, but also to attempt to create rogue users and gain authenticated access to the CSA web front end.</p>
<p>The <i>messages</i> logs contain evidence of the threat actor creating two users: <i>aiadmin</i> and <i>services</i>, using the CSA utility called <i>dbtool</i>. This was likely performed to maintain persistent, authenticated access to the CSA management console.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2028077941.img.jpeg/1728620592057/ivanti-csa-management-console.jpeg" data-title="ivanti csa management console">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2028077941.img.jpeg/1728620592057/ivanti-csa-management-console.jpeg" alt="ivanti csa management console" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">CVE-2024-8190 Vulnerability Exploitation - /gsb/DateTimeTab.php</span></h4>
<p>After the threat actor exploited the path traversal vulnerability and enumerated users configured on the CSA appliance, they exploited CVE-2024-8190, the command injection vulnerability affecting the resource /gsb/<i>DateTimeTab.php</i>, to attempt to access the credentials of those users.</p>
<p>FGIR observed evidence of this exploitation in Ivanti’s broker logs, as seen in the snippet below. FGIR has high confidence that the threat actor exploited this vulnerability to gain access to the user, <i>admin</i>’s credentials and use these privileged credentials to carry out the authenticated exploitation of the command injection vulnerability in <i>/clients/reports.php</i> resource.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_288801384.img.jpeg/1728620655617/fig07-ivanti-sqli-vulnerabilty-exploitation.jpeg" data-title="Figure 7: SQLi vulnerability exploitation">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_288801384.img.jpeg/1728620655617/fig07-ivanti-sqli-vulnerabilty-exploitation.jpeg" alt="Figure 7: SQLi vulnerability exploitation" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 7: SQLi vulnerability exploitation</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>FGIR found the text “rewritten with new timezone” within the function <i>setPhpTimeZone($timezoneinfo)</i> of the resource <i>DateTimeTab.php</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_512758081.img.jpeg/1728620707132/fig08-ivanti-setting-timezone-value.jpeg" data-title="Figure 8: Setting timezone value in php.ini">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_512758081.img.jpeg/1728620707132/fig08-ivanti-setting-timezone-value.jpeg" alt="Figure 8: Setting timezone value in php.ini" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 8: Setting timezone value in php.ini</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>From the above systemLog function call, it is clear that the value of the variable, $timezone was the one that was manipulated by the threat actor. Tracing back the value of this variable shows that it was deduced from the parameter <i>$timezoneinfo</i>, which was passed to the function <i>setPhpTimeZone</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_156964748.img.jpeg/1728620764864/fig09-ivanti-vulnerabie-function.jpeg" data-title="Figure 9: Vulnerable function setPhpTimeZone">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_156964748.img.jpeg/1728620764864/fig09-ivanti-vulnerabie-function.jpeg" alt="Figure 9: Vulnerable function setPhpTimeZone" style="width: 500px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 9: Vulnerable function setPhpTimeZone</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Tracing back where the <i>setPhpTimeZone</i> was called, FGIR found that this happened within the function <i>handleDateTimeSubmit(&amp;$msg)</i>. This function is responsible for handling change submissions when the “Save” button is clicked, as depicted in the screenshot below.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_546641334.img.jpeg/1728620805020/fig10-ivanti-time-zone-change.jpeg" data-title="Figure 10: Time zone change submission">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_546641334.img.jpeg/1728620805020/fig10-ivanti-time-zone-change.jpeg" alt="Figure 10: Time zone change submission" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 10: Time zone change submission</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The value of a global variable, $TIMEZONE, which was passed as a variable to the function <i>setPhpTimeZone</i>, was received from the POST request variable <i>TIMEZONE</i>. This implies that the threat actor crafted and sent a malicious POST request to <i>DateTimeTab.php</i>, with the malicious command passed in the POST request variable <i>TIMEZONE</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_879745814.img.jpeg/1728620849864/fig11-ivanti-post-variable-timezone.jpeg" data-title="Figure 11: POST variable TIMEZONE contained the malicious command">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_879745814.img.jpeg/1728620849864/fig11-ivanti-post-variable-timezone.jpeg" alt="Figure 11: POST variable TIMEZONE contained the malicious command" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 11: POST variable TIMEZONE contained the malicious command</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Going back to the malicious command injected by the threat actor, FGIR decoded the base64 blob, which resulted in the following Python code:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1686730515.img.jpeg/1728620888293/fig12-ivanti-decoded-base64.jpeg" data-title="Figure 12: Decoded base64 blob">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1686730515.img.jpeg/1728620888293/fig12-ivanti-decoded-base64.jpeg" alt="Figure 12: Decoded base64 blob" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 12: Decoded base64 blob</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The script extracts the password of the user <i>gsbadmin</i> from the file <i>/opt/landesk/broker/broker.conf</i> and assigns its value to the environment variable <i>PGPASSWORD</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_658029349.img.jpeg/1728620938935/fig13-ivanti-broker-conf.jpeg" data-title="Figure 13: broker.conf contents">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_658029349.img.jpeg/1728620938935/fig13-ivanti-broker-conf.jpeg" alt="Figure 13: broker.conf contents" style="width: 400px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 13: broker.conf contents</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The code targets the latest backup file in the <i>/backups</i> directory and iterates through this directory to find the latest backup file. If it finds one, then it connects to the Postgres database using the <i>gsbadmin</i> credentials, extracts the password of the user <i>admin</i> from the table <i>user_info,</i> and assigns it to the environment variable <i>PGPASSWORD.</i></p>
<p>The script then decompresses the latest backup file, and then iterates through the files to search for a filename that satisfies the regular expression <i>php\w{6}</i>, basically looking for a filename containing the string <i>php</i> followed by six characters (letters or numbers only). In case it finds such a file, it changes the permissions of the file so that <i>everyone</i> has the right to read, write, and execute it. The script then reads the private key from the backup file of the user <i>root</i>, encodes it using base64, and then assigns the resultant value to the column <i>organization</i> in the Postgres database table, <i>user_info</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_669364972.img.jpeg/1728620991417/fig14-ivanti-root-user-private-key.jpeg" data-title="Figure 14: Root user’s private key accessed">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_669364972.img.jpeg/1728620991417/fig14-ivanti-root-user-private-key.jpeg" alt="Figure 14: Root user’s private key accessed" style="width: 250px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 14: Root user’s private key accessed</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>While assessing the backend Postgres database logs, FGIR found confirmation of successful exploitation of this command injection vulnerability, as seen in the screenshot below:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_801722592.img.jpeg/1728621025851/fig15-ivanti-postgres-database.jpeg" data-title="Figure 15: Postgres database error">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_801722592.img.jpeg/1728621025851/fig15-ivanti-postgres-database.jpeg" alt="Figure 15: Postgres database error" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 15: Postgres database error</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">Command Injection Vulnerability – /gsb/reports.php</span></h4>
<p>Once the threat actor extracted the credentials of the users <i>gsbadmin, admin</i>, and the private key of the user <i>root, </i>they used the stolen credentials to perform authenticated exploitation of the publicly unknown command injection vulnerability affecting the resource <i>/gsb/reports.php</i>. Some of the threat actor requests can be seen in the messages and audit logs below:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1841058103.img.jpeg/1728621069609/fig16-ivanti-command-injection.jpeg" data-title="Figure 16: Command injection vulnerability exploitations">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1841058103.img.jpeg/1728621069609/fig16-ivanti-command-injection.jpeg" alt="Figure 16: Command injection vulnerability exploitations" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 16: Command injection vulnerability exploitations</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Command injection was found to be exploited in the following format, where a php script <i>/subin/tripwire</i> was executed with the parameter <i>–update, </i>followed by a semicolon and a malicious command.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1382954794.img.jpeg/1728621104113/ivanti-malicious-command.jpeg" data-title="ivanti malicious command">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1382954794.img.jpeg/1728621104113/ivanti-malicious-command.jpeg" alt="ivanti malicious command" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The first malicious command injected by the threat actor was used to create a web shell called <i>help.php </i>in the CSA webroot folder under the <i>/gsb </i>directory.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_611292844.img.jpeg/1728621139581/fig17-ivanti-command-injected.jpeg" data-title="Figure 17: Command injected to create a webshell">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_611292844.img.jpeg/1728621139581/fig17-ivanti-command-injected.jpeg" alt="Figure 17: Command injected to create a webshell" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 17: Command injected to create a webshell</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>FGIR looked at the code of the resource <i>reports.php</i> and identified the vulnerability in the line highlighted below in yellow. The script accepts the value of the POST parameter <i>TW_ID</i> and passes it as a parameter to the script <i>/subin/tripwire</i>, without sanitization.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_115137765.img.jpeg/1728621184124/fig18-ivanti-code-vulnerable.jpeg" data-title="Figure 18: Code vulnerable to command injection">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_115137765.img.jpeg/1728621184124/fig18-ivanti-code-vulnerable.jpeg" alt="Figure 18: Code vulnerable to command injection" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 18: Code vulnerable to command injection</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The resource <i>/sbin/tripwire</i> is a PHP wrapper for the binary <i>/usr/sbin/tripwire</i>, which is used to create security reports, when initiated through the gsb/<i>reports.php</i> resource. This is a legitimate functionality of the Ivanti CSA portal.</p>
<p>FGIR inspected the tripwire PHP wrapper script and found the function <i>update</i> which passes the command directly to the installed tripwire binary without sanitization. Since the tripwire PHP wrapper runs with <i>sudo</i> privileges, the injected command also runs with elevated privileges.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2034876463.img.jpeg/1728621223395/fig19-ivanti-update-function.jpeg" data-title="Figure 19: Update function in Tripwire&#39;s php wrapper">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2034876463.img.jpeg/1728621223395/fig19-ivanti-update-function.jpeg" alt="Figure 19: Update function in Tripwire&#39;s php wrapper" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 19: Update function in Tripwire&#39;s php wrapper</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>FGIR acquired the patch for CVE-2024-8190, and while analyzing the functionality of the patch, FGIR assessed that the file, <i>reports.php</i> was not in the patch script, nor was it listed as a file in the patch folder, leading FGIR to conclude that the command injection vulnerability found in the resource <i>/gsb/reports.php</i> was not addressed in that patch.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_450058568.img.jpeg/1728621256835/fig20-ivanti-files-patch.jpeg" data-title="Figure 20: Files in the patch for CVE-2024-8190">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_450058568.img.jpeg/1728621256835/fig20-ivanti-files-patch.jpeg" alt="Figure 20: Files in the patch for CVE-2024-8190" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 20: Files in the patch for CVE-2024-8190</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1942091345.img.jpeg/1728621289333/fig21-ivanti-patch-script.jpeg" data-title="Figure 21: Patch script for CVE-2024-8190">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1942091345.img.jpeg/1728621289333/fig21-ivanti-patch-script.jpeg" alt="Figure 21: Patch script for CVE-2024-8190" style="width: 400px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 21: Patch script for CVE-2024-8190</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">Threat Actor Patching Vulnerabilities</span></h4>
<p>On September 10, 2024, when the advisory for CVE-2024-8190 was published by Ivanti, the threat actor, still active in the customer’s network, “patched” the command injection vulnerabilities in the resources <i>/gsb/DateTimeTab.php</i>, and <i>/gsb/reports.php</i>, making them unexploitable.</p>
<p>In the past, threat actors have been observed to patch vulnerabilities after having exploited them, and gained foothold into the victim’s network, to stop any other intruder from gaining access to the vulnerable asset(s), and potentially interfering with their attack operations.</p>
<p>In this case, the threat actor downloaded the patched version of the two vulnerable resources from <i>temp[.]sh</i> and saved them as <i>/tmp/1</i> on disk, before moving them to the webroot folder and overwriting the vulnerable version of the files with them. Below are the relevant commands:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_479439523.img.jpeg/1728621332478/ivanti-temp-tmp-command.jpeg" data-title="ivanti temp command">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_479439523.img.jpeg/1728621332478/ivanti-temp-tmp-command.jpeg" alt="ivanti temp command" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The modified timestamps of the resources <i>reports.php</i>, and <i>DateTimeTab.php</i> were September 10, 2024, at 12:37:23 UTC and 13:06:10 UTC, respectively, as seen in the screenshots below.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_280612408.img.jpeg/1728621400402/fig22-ivanti-patch-timestamp.jpeg" data-title="Figure 22: Patch timestamp of reports.php">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_280612408.img.jpeg/1728621400402/fig22-ivanti-patch-timestamp.jpeg" alt="Figure 22: Patch timestamp of reports.php" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 22: Patch timestamp of reports.php</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1121393809.img.jpeg/1728621473905/fig23-ivanti-patch-timestamp-datetimetab.jpeg" data-title="Figure 23: Patch timestamp of DateTimeTab.php">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1121393809.img.jpeg/1728621473905/fig23-ivanti-patch-timestamp-datetimetab.jpeg" alt="Figure 23: Patch timestamp of DateTimeTab.php" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 23: Patch timestamp of DateTimeTab.php</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Comparing the original vulnerable version of <i>reports.php</i> to the version patched by the threat actor, shows that the threat actor added a piece of code to replace the semicolon with an underscore in the POST parameter <i>TW_ID</i>, so that command injection using the semicolon is not possible anymore.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1656384028.img.jpeg/1728621510804/fig24-ivanti-comparison-code.jpeg" data-title="Figure 24: Comparison of original and threat actor&#39;s patched code">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1656384028.img.jpeg/1728621510804/fig24-ivanti-comparison-code.jpeg" alt="Figure 24: Comparison of original and threat actor&#39;s patched code" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 24: Comparison of original and threat actor&#39;s patched code</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>FGIR tested the patching in a lab environment and confirmed that the modification by the threat actor does indeed make the resource <i>reports.php</i> unexploitable after the patch. The screenshot below shows the directory <i>testwithoutfix</i> was successfully created by exploiting the command injection vulnerability on the original vulnerable version of <i>reports.php</i>. When the fix is applied to the <i>reports.php</i> file and the command injection is exploited again, the directory <i>testwithfix</i> is not created.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1136962043.img.jpeg/1728621561290/fig25-ivanti-exploitation-testing.jpeg" data-title="Figure 25: Exploitation testing of the original and the threat actor’s patched version">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1136962043.img.jpeg/1728621561290/fig25-ivanti-exploitation-testing.jpeg" alt="Figure 25: Exploitation testing of the original and the threat actor’s patched version" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 25: Exploitation testing of the original and the threat actor’s patched version</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The threat actor also patched the file <i>DateTimeTab.php</i> using the same <i>str_replace</i> function to replace any semicolon in the POST parameter <i>TIMEZONE</i>, with an underscore, rendering the command injection vulnerability using this parameter ineffective.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1958099435.img.jpeg/1728621691327/fig26-ivanti-testing-command-injection.jpeg" data-title="Figure 26: Testing command injection using the orignial and patched versions of DateTimeTab.php">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1958099435.img.jpeg/1728621691327/fig26-ivanti-testing-command-injection.jpeg" alt="Figure 26: Testing command injection using the orignial and patched versions of DateTimeTab.php" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 26: Testing command injection using the orignial and patched versions of DateTimeTab.php</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2><span style="font-weight: normal;">Other Findings</span></h2>
<h4><span style="font-weight: normal;">Lateral Movement</span></h4>
<p>After compromising the internet-facing Ivanti CSA appliance, the threat actor exploited the CVE-2024-29824 SQL Injection vulnerability on Ivanti’s backend SQL database server (SQLS). Sample malicious POST requests exploiting this vulnerability are depicted below.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2136686996.img.jpeg/1728621736636/ivanti-sample-malicious-post.jpeg" data-title="ivanti sample malicious post requests">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_2136686996.img.jpeg/1728621736636/ivanti-sample-malicious-post.jpeg" alt="ivanti sample malicious post requests" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The threat actor enabled the <i>xp_cmdshell</i> stored procedure via the exploitation and used this stored procedure to attain remote code execution on the SQLS system.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_958399012.img.jpeg/1728621780661/ivanti-sqls-remote-code-execution.jpeg" data-title="ivanti remote code execution on sqls system">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_958399012.img.jpeg/1728621780661/ivanti-sqls-remote-code-execution.jpeg" alt="ivanti remote code execution on sqls system" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The threat actor created an account called <i>mssqlsvc</i> on the compromised system SQLS and turned off the host firewall.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_133352251.img.jpeg/1728621923615/table01-ivanti-threat-actor-commands.jpeg" data-title="Table 1: Threat actor&#39;s commands">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_133352251.img.jpeg/1728621923615/table01-ivanti-threat-actor-commands.jpeg" alt="Table 1: threat actor&#39;s commands" style="width: 500px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Table 1: Threat actor&#39;s commands</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>FGIR also observed that the threat actor ran some basic reconnaissance commands on the <i>SQLS</i> system and attempted to exfiltrate the reconnaissance output using the following PowerShell command:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1877150742.img.jpeg/1728621963572/ivanti-powershell-command.jpeg" data-title="ivanti powershell command">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1877150742.img.jpeg/1728621963572/ivanti-powershell-command.jpeg" alt="ivanti powershell command" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>This is a technique used to exfiltrate data over the DNS protocol. The technique is also known as <i>DNS tunneling</i>. See below for the content of the file that the threat actor tried to exfiltrate:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1065565645.img.jpeg/1728622001838/fig27-ivanti-content-1log.jpeg" data-title="Figure 27: Content of 1.log">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1065565645.img.jpeg/1728622001838/fig27-ivanti-content-1log.jpeg" alt="Figure 27: Content of 1.log" style="width: 500px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 27: Content of 1.log</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">Threat Actor Commands</span></h4>
<p>FGIR discovered more tactics and techniques used by the threat actor during their intrusion. FGIR extracted and decoded some interesting commands executed by the threat actor from the Linux audit logs and other sources. A sample of those commands are shown in the table below:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_554353955.img.jpeg/1728661138131/table02a-ivanti-threat-actor-commands.jpeg" data-title="Table 2: Threat actor commands">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_554353955.img.jpeg/1728661138131/table02a-ivanti-threat-actor-commands.jpeg" alt="Table 2: Threat actor commands" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Table 2: Threat actor commands</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">Web Shells</span></h4>
<p>During the course of their operations, the threat actor created several webshells. They also modified the legitimate resource, <i>syslog.php, </i>and appended malicious code to it, to use it as a web shell. Some of the web shells found are shown in the table below.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1145145370.img.jpeg/1728622608310/table03-ivanti-web-shells.jpeg" data-title="Table 3: Web shells">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1145145370.img.jpeg/1728622608310/table03-ivanti-web-shells.jpeg" alt="Table 3: Web shells" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Table 3: Web shells</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">Brute Force Attack</span></h4>
<p>On September 11, at 04:12:00 UTC, the threat actor started an authentication brute force attack against the customer’s internal network assets, using a dictionary attack.</p>
<p>FGIR discovered that the threat actor downloaded a tar file called <i>u</i> from a <i>temp[.]sh</i> URL<a></a>. This tar file contained three files: <i>brokes, passdic.txt</i>, and<i> u.txt</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1202021139.img.jpeg/1728622643931/fig28-ivanti-brute-force-tooling.jpeg" data-title="Figure 28: Brute force tooling">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1202021139.img.jpeg/1728622643931/fig28-ivanti-brute-force-tooling.jpeg" alt="Figure 28: Brute force tooling" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 28: Brute force tooling</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The file <i>brokes</i> is a Linux ELF binary, which was used to perform the brute force attack on customer’s network assets. It is likely that <i>brokes </i>used as parameters the list of customer’s users, possibly harvested during a different campaign, in the form of the file <i>u.txt</i> and the password file <i>passdic.txt</i>.</p>
<p>The threat actor downloaded an unknown file called <i>target</i> from <i>temp[.]sh</i>, however this one was not found on the disk.</p>
<p>The threat actor also downloaded a shell script called <i>s.sh</i>, from the <i>temp[.]sh</i> site. This script was used to execute the <a></a><a>bruteforce</a> binary <i>brokes</i> and anonymous logins were attempted on LDAP’s port TCP 389 of the attacked assets with several passwords.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1841266866.img.jpeg/1728622674435/fig29-ivanti-content.jpeg" data-title="Figure 29: Content of s.sh">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1841266866.img.jpeg/1728622674435/fig29-ivanti-content.jpeg" alt="Figure 29: Content of s.sh" style="width: 400px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 29: Content of s.sh</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h4><span style="font-weight: normal;">ReverseSocks Proxy Tool</span></h4>
<p>During the memory analysis of the CSA appliance, FGIR discovered traces of the use of an open-source go-based proxy tool called <i>ReverseSocks5</i>, which was downloaded and used by the threat actor to perform scanning and brute force attacks on the customer’s internal network, while proxying the traffic through the CSA appliance. The string, which was created in the memory due to an error thrown by the tool, can be seen in the below snippet.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_16445584.img.jpeg/1728622709083/ivanti-csa-appliance.jpeg" data-title="ivanti csa appliance">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_16445584.img.jpeg/1728622709083/ivanti-csa-appliance.jpeg" alt="ivanti csa appliance" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Some other suspicious strings found during the analysis of the memory included some PHP variables found to be populated with suspicious values:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_421608083.img.jpeg/1728622739558/ivanti-php-variables.jpeg" data-title="ivanti php variables">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_421608083.img.jpeg/1728622739558/ivanti-php-variables.jpeg" alt="ivanti php variables" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p><i>ZjmgmXsB.php</i> was a webshell, which the threat actor was interacting with, while accessing it from the IP address <i>208[.]105[.]190[.]170</i>.</p>
<h4><span style="font-weight: normal;">Root Kit Discovery and Analysis</span></h4>
<p>During the investigation, FGIR discovered that on September 7, 2024, at 03:26:17 UTC, the threat actor attempted to deploy a rootkit in the form of a Linux kernel object (KO) module on the CSA appliance. This attempt was found in the audit logs as seen in the snippet below:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_38071269.img.jpeg/1728622775542/ivanti-linux-kernel.jpeg" data-title="ivanti linux kernel">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_38071269.img.jpeg/1728622775542/ivanti-linux-kernel.jpeg" alt="ivanti linux kernel" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The likely motive behind this was for the threat actor to maintain kernel-level persistence on the CSA device, which may survive even a factory reset. This activity is in line with the public reporting on the compromise of Ivanti CSA appliances, which is available <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-060b" target="_blank">here</a> and <a href="https://www.rapid7.com/blog/post/2024/01/11/etr-zero-day-exploitation-of-ivanti-connect-secure-and-policy-secure-gateways/" target="_blank">here</a>. FGIR decoded the hex string contained in the snippet above and obtained a base64 encoded blob. The initial part of the resultant base64 encoded blob indicates that this is a compressed archive file.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1621469609.img.jpeg/1728622837198/fig30a-ivanti-base64.jpeg" data-title="ivanti base64 encoded blob">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1621469609.img.jpeg/1728622837198/fig30a-ivanti-base64.jpeg" alt="ivanti base64 encoded blob" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Decompressing the tar file results in the following two files.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1244035500.img.jpeg/1728622869372/fig30b-malicious-tar-file-content.jpeg" data-title="Figure 30: Malicious tar file content">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1244035500.img.jpeg/1728622869372/fig30b-malicious-tar-file-content.jpeg" alt="Figure 30: Malicious tar file content" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 30: Malicious tar file content</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The file <i>install.sh</i> is a malicious bash script that installs a malicious kernel object called <i>sysinitd.ko</i>. The compressed archive file was corrupted and only the file <i>install.sh</i> could be retrieved successfully in its entirety, while the file <i>sysinitd</i> was truncated, and the file <i>sysinitd.ko</i> was missing.</p>
<p>FGIR pivoted to the disk image of the CSA appliance and found the <i>sysinitd</i> and <i>sysinitd.ko</i> files in the location <i>/usr/share/empty/init/</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_460351710.img.jpeg/1728622903847/fig31-ivanti-rootkit-files.jpeg" data-title="Figure 31: Rootkit files">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_460351710.img.jpeg/1728622903847/fig31-ivanti-rootkit-files.jpeg" alt="Figure 31: Rootkit files" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 31: Rootkit files</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h5><span style="font-weight: normal;">Analysis of Install.sh</span></h5>
<p>The script <i>install.sh</i> was meant to install the malicious rootkit <i>sysinitd.ko</i> on the affected system. The following variables were hard-coded in the script <i>install.sh</i>:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1397322820.img.jpeg/1728622948264/ivanti-script-start-param.jpeg" data-title="ivanti script start params">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1397322820.img.jpeg/1728622948264/ivanti-script-start-param.jpeg" alt="ivanti script start params" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The script starts with the following function call, which reads two parameters:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_281043642.img.jpeg/1728622982349/ivanti-script-second-param.jpeg" data-title="ivanti script start second param">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_281043642.img.jpeg/1728622982349/ivanti-script-second-param.jpeg" alt="ivanti script start second param" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The first parameter is the INSTALL_NAME string, which is used to rename the two files sysinitd and <i>sysinitd.ko</i> to INSTALL_NAME and INSTALL_NAME.ko respectively.</p>
<p>The second parameter is the path where the script copies the renamed version of <i>sysinitd</i> and <i>sysinitd.ko</i> to. In this case, the threat actor did not supply either of the two parameters. Therefore, the default names <i>sysinitd</i> and <i>sysinitd.ko</i> were used by the script.</p>
<p>The following snippet of code checks if the install path exists and if not, then it creates it:</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1062228048.img.jpeg/1728623065236/ivanti-code-snippet-path-exists.jpeg" data-title="ivanti code snippet checking path if exists">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_1062228048.img.jpeg/1728623065236/ivanti-code-snippet-path-exists.jpeg" alt="ivanti code snippet checking path if exists" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The script then removes any installed kernel object with the name INSTALL_NAME.ko, using the command <i>rmmod</i>, and then installs the malicious INSTALL_NAME.ko using the command <i>insmod</i>.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_651532223.img.jpeg/1728623117727/fig32-ivanti-installation-malicious-kernel.jpeg" data-title="Figure 32: Installation of malicious kernel object (rootkit)">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_651532223.img.jpeg/1728623117727/fig32-ivanti-installation-malicious-kernel.jpeg" alt="Figure 32: Installation of malicious kernel object (rootkit)" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 32: Installation of malicious kernel object (rootkit)</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The bash script <i>install.sh </i>installs a persistence mechanism using the technique of adding an entry to install the malicious kernel object in the <i>rc.local</i> and <i>rc.d/rc.local </i>files, if the malicious kernel object file is present on disk.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_948091254.img.jpeg/1728623149502/fig33-ivanti-establishing-rootkit.jpeg" data-title="Figure 33: Establishing rootkit persistence">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_948091254.img.jpeg/1728623149502/fig33-ivanti-establishing-rootkit.jpeg" alt="Figure 33: Establishing rootkit persistence" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 33: Establishing rootkit persistence</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_89044911.img.jpeg/1728623190397/fig34-ivanti-rootkit-persistence.jpeg" data-title="Figure 34: Rootkit persistence via RC script">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_89044911.img.jpeg/1728623190397/fig34-ivanti-rootkit-persistence.jpeg" alt="Figure 34: Rootkit persistence via RC script" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 34: Rootkit persistence via RC script</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h5><span style="font-weight: normal;">Analysis of the sysinitd and sysinitd.ko</span></h5>
<p>FGIR aims to analyze the rootkit in detail and publish the findings in a follow-up blog post.</p>
<h2><span style="font-weight: normal;">Conclusion</span></h2>
<p>The advanced adversaries were observed exploiting and chaining zero-day vulnerabilities to establish beachhead access in the victim’s network. You can read more about the Ivanti CSA zero-day attack in our Threat Signal Report: <a href="https://www.fortiguard.com/threat-signal-report/5556">https://www.fortiguard.com/threat-signal-report/5556</a>.</p>
<h3><span style="font-weight: normal;">Fortinet Protections</span></h3>
<p>The malware described in this report is detected and blocked by <a href="https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/antivirus?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=antivirus" title="AntiVirus">FortiGuard Antivirus</a> as:</p>
<p style="margin-left: 40.0px;">BASH/Agent.030E!tr<br />
ELF/Agent.69A0!tr <br />
ELF/Agent.7E02!tr <br />
ELF/Agent.BD!tr</p>
<p>FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus service. The FortiGuard antivirus engine is a part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.</p>
<p>Fortinet has also released the following IPS signatures to protect our customers from the threats contained in the report.</p>
<p>CVE-2024-8190; <a href="https://www.fortiguard.com/encyclopedia/ips/56651" title="FortiGuard Encyclopedia">https://www.fortiguard.com/encyclopedia/ips/56651</a></p>
<p>The interactsh related URLs are rated as “Malicious Websites” and “Malicious Activities Found” by the FortiGuard Web Filtering service.</p>
<p>FortiGuard IP Reputation and Anti-Botnet Security Service proactively blocks these attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.</p>
<p>If you believe this or any other cybersecurity threat has impacted your organization, please contact our Global <a href="https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/respond?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=incident-reposnse" title="FortiGuard Incident Response">FortiGuard Incident Response Team</a>.</p>
<h3><span style="font-weight: normal;">MITRE Mapping</span></h3>
<p>The MITRE ATT&amp;CK framework has been used to refer to the various tactics and techniques used by the threat actor.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_256695740.img.jpeg/1728661530772/table04-ivanti-mitre-mapping.jpeg" data-title="Table 4: MITRE Mapping">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                
                <img src="/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa/_jcr_content/root/responsivegrid/table_content/par/image_256695740.img.jpeg/1728661530772/table04-ivanti-mitre-mapping.jpeg" alt="Table 4: MITRE Mapping" class="custom"/>
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Table 4: MITRE Mapping</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2><span style="font-weight: normal;">IOCs</span></h2>
<h3><span style="font-weight: normal;">Network Based Indicators</span></h3>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="343" valign="top"><p><b>Network Indicator</b></p>
</td>
<td width="82" valign="top"><p><b>Protocol</b></p>
</td>
<td width="59" valign="top"><p><b>Port</b></p>
</td>
<td width="117" valign="top"><p><b>Notes</b></p>
</td>
</tr><tr><td width="343" valign="top"><p>apiv5[.]serverbks[.]xyz</p>
</td>
<td width="82" valign="top"><p> </p>
</td>
<td width="59" valign="top"><p>443</p>
</td>
<td width="117" valign="top"><p>Domain associated with IP 156[.]234[.]193[.]18</p>
</td>
</tr><tr><td width="343" valign="top"><p>74[.]62[.]81[.]162</p>
</td>
<td width="82" valign="top"><p> </p>
</td>
<td width="59" valign="top"><p>57532</p>
</td>
<td width="117" valign="top"><p>Threat actor’s C2</p>
</td>
</tr><tr><td width="343" valign="top"><p>189f31ed7d[.]ipv6[.]bypass[.]eu[.]org</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Seen in encoded PowerShell used by the threat actor</p>
</td>
</tr><tr><td width="343" valign="top"><p>iowxuintgredogzgblrsmr2cx2e471bor.oast[.]fun</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Seen in encoded PowerShell used by the threat actor</p>
</td>
</tr><tr><td width="343" valign="top"><p>o.lencr[.]org</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Let's Encrypt domain name</p>
</td>
</tr><tr><td width="343" valign="top"><p>c67f045c2f.ipv6.1433.eu[.]org</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Seen in encoded PowerShell used by the threat actor</p>
</td>
</tr><tr><td width="343" valign="top"><p>206[.]189[.]156[.]69</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>oast[.]fun domain IP</p>
</td>
</tr><tr><td width="343" valign="top"><p>51[.]91[.]79[.]17</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>temp[.]sh domain IP</p>
</td>
</tr><tr><td width="343" valign="top"><p>156[.]234[.]193[.]18</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>C2 IP found in the python reverse shell</p>
</td>
</tr><tr><td width="343" valign="top"><p>208[.]105[.]190[.]170</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>http://temp[.]sh/khkzg/DateTimeTab.php</p>
</td>
<td width="82" valign="top"><p>HTTP</p>
</td>
<td width="59" valign="top"><p>80</p>
</td>
<td width="117" valign="top"><p>Patched version of DateTimeTab.php downloaded by the threat actor from this URL to overwrite the vulnerable version.</p>
</td>
</tr><tr><td width="343" valign="top"><p>http://temp[.]sh/vQuoW/reports.php</p>
</td>
<td width="82" valign="top"><p>HTTP</p>
</td>
<td width="59" valign="top"><p>80</p>
</td>
<td width="117" valign="top"><p>Patched version reports.php downloaded by the threat actor from this URL to overwrite the vulnerable version.</p>
</td>
</tr><tr><td width="343" valign="top"><p>http://l8u6aolk4ejfsl9zeq6321zvwm2eq3[.]burpcollaborator.net</p>
</td>
<td width="82" valign="top"><p>HTTP</p>
</td>
<td width="59" valign="top"><p>80</p>
</td>
<td width="117" valign="top"><p>Accessed by the threat actor</p>
</td>
</tr><tr><td width="343" valign="top"><p>54[.]77[.]139[.]23</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>oastify[.].com subdomains</p>
</td>
</tr><tr><td width="343" valign="top"><p>34[.]250[.]195[.]30</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>portswigger[.]net domain IP, web app security &amp; testing</p>
</td>
</tr><tr><td width="343" valign="top"><p>216[.]131[.]75[.]52</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>24[.]166[.]100[.]255</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>67[.]217[.]228[.]92</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>69[.]49[.]88[.]235</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>45[.]61[.]136[.]189</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>3[.]248[.]33[.]252</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>38[.]207[.]159[.]76</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>193[.]189[.]100[.]197</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr><tr><td width="343" valign="top"><p>23[.]236[.]66[.]97</p>
</td>
<td width="82" valign="top"> </td>
<td width="59" valign="top"> </td>
<td width="117" valign="top"><p>Threat actor IP interacting with webshell</p>
</td>
</tr></tbody></table>
<figure class="table" style="width: 541.4pt;">
</figure>
<h3><span style="font-weight: normal;">Host Based Indicators</span></h3>
<table border="1" cellspacing="0" cellpadding="0">
<tbody><tr><td width="200" valign="top"><p><b>PATH</b></p>
</td>
<td width="130" valign="top"><p><b>FILE NAME</b></p>
</td>
<td width="113" valign="top"><p><b>SHA1 HASH</b></p>
</td>
<td width="157" valign="top"><p><b>NOTES</b></p>
</td>
</tr><tr><td width="200" valign="top"><p>\Device\HarddiskVolume2\ProgramData\1.log</p>
</td>
<td width="130" valign="top"><p>1.log</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Reconnaissance output</p>
</td>
</tr><tr><td width="200" valign="top"><p>\Device\HarddiskVolume2\ProgramData\bakeup.bat</p>
</td>
<td width="130" valign="top"><p>bakeup.bat</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Unknown batch file</p>
</td>
</tr><tr><td width="200" valign="top"><p>\Device\HarddiskVolume2\ProgramData\output</p>
</td>
<td width="130" valign="top"><p>output</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Reconnaissance output</p>
</td>
</tr><tr><td width="200" valign="top"><p>\Device\HarddiskVolume2\ProgramData\sess010981</p>
</td>
<td width="130" valign="top"><p>sess010981</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Reconnaissance output</p>
</td>
</tr><tr><td width="200" valign="top"><p>C:\inetpub\wwwroot\aspnet_client\read.txt</p>
</td>
<td width="130" valign="top"><p>read.txt</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Unknown text file</p>
</td>
</tr><tr><td width="200" valign="top"><p>https://10.10.11.31/client/site.php</p>
</td>
<td width="130" valign="top"><p>site.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>c:\programdata\output.hex</p>
</td>
<td width="130" valign="top"><p>output.hex</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Encoded reconnaissance output</p>
</td>
</tr><tr><td width="200" valign="top"><p>brokes</p>
</td>
<td width="130" valign="top"><p>brokes</p>
</td>
<td width="113" valign="top"><p>beb723a5f20a1a2c4375f9aa250d968d55155689</p>
</td>
<td width="157" valign="top"><p>Bruteforcer binary</p>
</td>
</tr><tr><td width="200" valign="top"><p>passdic.txt</p>
</td>
<td width="130" valign="top"><p>passdic.txt</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>List of passwords</p>
</td>
</tr><tr><td width="200" valign="top"><p>u.txt</p>
</td>
<td width="130" valign="top"><p>u.txt</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>List of harvested usernames</p>
</td>
</tr><tr><td width="200" valign="top"><p>/tmp/1</p>
</td>
<td width="130" valign="top"><p>1</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Files downloaded on the device are created as /tmp/1 on the CSA disk</p>
</td>
</tr><tr><td width="200" valign="top"><p>/tmp/systemd-private-2e4a6ea82da94a9b9fec37fe91c9b820-broker.service-asZTdm/tmp/.br/broke</p>
</td>
<td width="130" valign="top"><p>broke</p>
</td>
<td width="113" valign="top"><p>64efc1aad330ea9d98c0c705e16cd4b3af7e74f8</p>
</td>
<td width="157" valign="top"><p>Linux brute force binary</p>
</td>
</tr><tr><td width="200" valign="top"><p>/client/site.php</p>
</td>
<td width="130" valign="top"><p>site.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/client.php</p>
</td>
<td width="130" valign="top"><p>client.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/firewall.php</p>
</td>
<td width="130" valign="top"><p>firewall.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/reports.php</p>
</td>
<td width="130" valign="top"><p>reports.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/style.php</p>
</td>
<td width="130" valign="top"><p>style.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/syslog.php?a=phpinfo();</p>
</td>
<td width="130" valign="top"><p>syslog.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/users.php</p>
</td>
<td width="130" valign="top"><p>users.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/uSxhmgm.php</p>
</td>
<td width="130" valign="top"><p>uSxhmgm.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>/gsb/ZjmgmXsB.php</p>
</td>
<td width="130" valign="top"><p>ZjmgmXsB.php</p>
</td>
<td width="113" valign="top"><p> </p>
</td>
<td width="157" valign="top"><p>Web shell on CSA appliance</p>
</td>
</tr><tr><td width="200" valign="top"><p>install.sh</p>
</td>
<td width="130" valign="top"><p>install.sh</p>
</td>
<td width="113" valign="top"><p>8d016d02f8fbe25dce76481a90dd0b48630ce9e74e8c31ba007cf133e48b8526</p>
</td>
<td width="157" valign="top"><p>Rootkit installation script</p>
</td>
</tr><tr><td width="200" valign="top"><p>/usr/share/empty/init/sysinitd.ko</p>
</td>
<td width="130" valign="top"><p>sysinitd.ko</p>
</td>
<td width="113" valign="top"><p>6edd7b3123de985846a805931ca8ee5f6f7ed7b160144aa0e066967bc7c0423a</p>
</td>
<td width="157" valign="top"><p>Rootkit – Kernel Object Module</p>
</td>
</tr><tr><td width="200" valign="top"><p>/usr/share/empty/init/sysinitd</p>
</td>
<td width="130" valign="top"><p>sysinitd</p>
</td>
<td width="113" valign="top"><p>d57a2cac394a778e19ce9b926f2e0a71936510798f30d20f207f2a49b49ce7b1</p>
</td>
<td width="157" valign="top"><p>Malicious Linux binary</p>
</td>
</tr></tbody></table>


</div>


    
    
    <div class="raw-import">
<div class="text-container"><style>
table {
table-layout: fixed;
width: 750px;
}

th, td {
word-wrap: break-word;
}
</style></div>
</div>



        </div>
    </div>
</div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container" style="display:none">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=zero-dayvulnerability">zero-day vulnerability</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/fortiguard-labs-discovers-three-vulnerabilities-in-siemens-teamcenter" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/siemens-vuln-discovery-center-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="FortiGuard Labs Discovers Three Vulnerabilities in Siemens’ Teamcenter Solutions" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">FortiGuard Labs Discovers Three Vulnerabilities in Siemens’ Teamcenter Solutions</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/ransomware-roundup-new-variants" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/ransomware-roundup-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="Ransomware Roundup: LockBit, BlueSky, and More" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Ransomware Roundup: LockBit, BlueSky, and More</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/moveit-transfer-critical-vulnerability-cve-2023-34362-exploited-as-a-0-day" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/MOVEIT-THUMB.jpg.thumb.319.319.png);">
                <img class="ratio" alt="MOVEit Transfer Critical Vulnerability (CVE-2023-34362) Exploited as a 0-day" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">MOVEit Transfer Critical Vulnerability (CVE-2023-34362) Exploited as a 0-day</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  
  
 </div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.x.com/Fortinet" target="_blank">
                
    <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"/>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/channel/UCJHo4AuVomwMRzgkA5DQEOA?sub_confirmation=1" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/fortinet/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware Prevention</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="https://community.fortinet.com/" target="_blank">Fortinet Community</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/partners/partner-program/become-a-fortinet-partner" target="_blank">Partner Portal</a>
              </li>
            
              <li>
                <a href="https://investor.fortinet.com/" target="_blank">Investor Relations</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications" target="_blank">Product Certifications</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/nse-training" target="_self">Training</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards" target="_self">Industry Awards</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/corporate-social-responsibility" target="_self">Social Responsibility</a>
              </li>
            
              <li>
                <a href="/resources/cyberglossary" target="_self">CyberGlossary</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/sitemap" target="_self">Sitemap</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/blog/blog-sitemap" target="_self">Blog Sitemap</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2024 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>


    
    
    
    
    
<script src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.ba4f082a77dabb2c6baf715d9eb61c22.js"></script>





    


    

    <!-- BE IXF: The following <div> block needs to be placed in the location where the link block will be displayed
    BE IXF: For your website, the location is above/below ...-->
    <div class="be-ix-link-block">
        <!--
   be_sdkms_pub:bec-built-in; bec-built-in_1.0.0; bodystr;
   be_sdkms_date_modified:pn_tstr:Wed Oct 23 18:42:39 UTC 2024; pn_epoch:1729708959745;
   be_sdkms_timer: 1;
-->

        
    </div>
    <!-- BE IXF: Footer End -->
    </body>
    </html>
