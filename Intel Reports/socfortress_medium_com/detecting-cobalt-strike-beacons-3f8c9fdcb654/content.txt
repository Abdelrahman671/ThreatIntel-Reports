<!doctype html><html lang="en"><head><title data-rh="true">Detecting Cobalt Strike Beacons. Introduction | by SOCFortress | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2022-02-20T19:02:19.547Z"/><meta data-rh="true" name="title" content="Detecting Cobalt Strike Beacons. Introduction | by SOCFortress | Medium"/><meta data-rh="true" property="og:title" content="Detecting Cobalt Strike Beacons"/><meta data-rh="true" property="al:android:url" content="medium://p/3f8c9fdcb654"/><meta data-rh="true" property="al:ios:url" content="medium://p/3f8c9fdcb654"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Created by Raphael Mudge in 2012, Cobalt Strike was one of the first public red team command and control frameworks. It’s also used by threat actors and the first activity detected for malicious…"/><meta data-rh="true" property="og:description" content="Introduction"/><meta data-rh="true" property="og:url" content="https://socfortress.medium.com/detecting-cobalt-strike-beacons-3f8c9fdcb654"/><meta data-rh="true" property="al:web:url" content="https://socfortress.medium.com/detecting-cobalt-strike-beacons-3f8c9fdcb654"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*z9_8-93FyPoiXT7JAXpwZQ.png"/><meta data-rh="true" property="article:author" content="https://socfortress.medium.com"/><meta data-rh="true" name="author" content="SOCFortress"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Detecting Cobalt Strike Beacons"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/3f8c9fdcb654"/><meta data-rh="true" property="twitter:description" content="Introduction"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*z9_8-93FyPoiXT7JAXpwZQ.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="6 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://socfortress.medium.com"/><link data-rh="true" rel="canonical" href="https://socfortress.medium.com/detecting-cobalt-strike-beacons-3f8c9fdcb654"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/3f8c9fdcb654"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*z9_8-93FyPoiXT7JAXpwZQ.png"],"url":"https:\u002F\u002Fsocfortress.medium.com\u002Fdetecting-cobalt-strike-beacons-3f8c9fdcb654","dateCreated":"2022-02-20T08:06:32.081Z","datePublished":"2022-02-20T08:06:32.081Z","dateModified":"2022-02-26T02:47:04.918Z","headline":"Detecting Cobalt Strike Beacons - SOCFortress - Medium","name":"Detecting Cobalt Strike Beacons - SOCFortress - Medium","description":"Created by Raphael Mudge in 2012, Cobalt Strike was one of the first public red team command and control frameworks. It’s also used by threat actors and the first activity detected for malicious…","identifier":"3f8c9fdcb654","author":{"@type":"Person","name":"SOCFortress","url":"https:\u002F\u002Fsocfortress.medium.com"},"creator":["SOCFortress"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fsocfortress.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fsocfortress.medium.com\u002Fdetecting-cobalt-strike-beacons-3f8c9fdcb654"}</script><style type="text/css" data-fela-rehydration="574" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="574" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{margin-left:4px}.lb{margin-top:0px}.lc{opacity:1}.ld{padding:4px 0}.lg{width:16px}.li{display:inline-flex}.lo{max-width:100%}.lp{padding:8px 2px}.lq svg{color:#6B6B6B}.mh{line-height:1.12}.mi{letter-spacing:-0.022em}.mj{font-weight:600}.ne{margin-bottom:-0.28em}.nf{line-height:1.58}.ng{letter-spacing:-0.004em}.nh{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oc{margin-bottom:-0.46em}.oi{list-style-type:disc}.oj{margin-left:30px}.ok{padding-left:0px}.oq{margin-top:32px}.or{margin-bottom:14px}.os{padding-top:24px}.ot{padding-bottom:10px}.ou{background-color:#000000}.ov{height:3px}.ow{width:3px}.ox{margin-right:20px}.pd{text-decoration:underline}.pe{margin-left:auto}.pf{margin-right:auto}.pg{max-width:1355px}.pm{clear:both}.po{cursor:zoom-in}.pp{z-index:auto}.pr{height:auto}.ps{margin-top:10px}.pt{max-width:728px}.pw{max-width:1827px}.px{max-width:1835px}.py{max-width:1833px}.pz{line-height:1.18}.qn{margin-bottom:-0.31em}.qo{font-style:italic}.qp{max-width:1844px}.qq{max-width:1838px}.qr{max-width:1735px}.qs{max-width:1758px}.qt{max-width:1792px}.qu{max-width:1521px}.qv{max-width:1850px}.qw{max-width:1358px}.qx{margin-bottom:26px}.qy{margin-top:6px}.qz{margin-top:8px}.ra{margin-right:8px}.rb{padding:8px 16px}.rc{border-radius:100px}.rd{transition:background 300ms ease}.rf{white-space:nowrap}.rg{border-top:none}.rh{height:52px}.ri{max-height:52px}.rj{box-sizing:content-box}.rk{position:static}.rl{z-index:1}.rn{max-width:155px}.ry{height:0px}.rz{margin-bottom:40px}.so{height:64px}.sp{width:64px}.sq{align-self:flex-end}.sr{color:rgba(255, 255, 255, 1)}.ss{fill:rgba(255, 255, 255, 1)}.st{background:rgba(25, 25, 25, 1)}.su{border-color:rgba(25, 25, 25, 1)}.sx:disabled{opacity:0.1}.sy:disabled:hover{background:rgba(25, 25, 25, 1)}.sz:disabled:hover{border-color:rgba(25, 25, 25, 1)}.ta{flex:1 1 auto}.tg{padding-right:4px}.th{font-weight:500}.to{white-space:pre-wrap}.tp{margin-top:16px}.ty{gap:18px}.tz{fill:rgba(61, 61, 61, 1)}.ub{padding-bottom:6px}.uc{border-bottom:1px solid #F2F2F2}.ui{fill:#242424}.uj{background:0}.uk{border-color:#242424}.ul:disabled:hover{color:#242424}.um:disabled:hover{fill:#242424}.un:disabled:hover{border-color:#242424}.uy{border-bottom:solid 1px #E5E5E5}.uz{margin-top:72px}.va{padding:24px 0}.vb{margin-bottom:0px}.vc{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.le:hover{fill:#000000}.lf:hover p{color:#000000}.lh:hover{color:#000000}.lr:hover svg{color:#000000}.re:hover{background-color:#F2F2F2}.sn:hover{background-color:none}.sv:hover{background:#000000}.sw:hover{border-color:#242424}.ua:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.ls:focus svg{color:#000000}.pq:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.ln{margin:0}.na{font-size:24px}.nb{margin-top:1.95em}.nc{line-height:30px}.nd{letter-spacing:-0.016em}.ny{font-size:20px}.nz{margin-top:0.94em}.oa{line-height:32px}.ob{letter-spacing:-0.003em}.oh{margin-top:2.14em}.op{margin-top:1.14em}.pc{margin-top:1.25em}.pl{margin-top:56px}.qk{margin-top:1.72em}.ql{line-height:24px}.qm{letter-spacing:0}.rs{display:inline-block}.rx{margin-bottom:104px}.sa{flex-direction:row}.sd{margin-bottom:0}.se{margin-right:20px}.tb{max-width:500px}.tu{margin-bottom:88px}.tx{margin-bottom:72px}.uh{margin:40px 0 16px}.us{width:min-width}.ux{padding-top:72px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.pu{margin-left:auto}.pv{text-align:center}.rr{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.rq{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.lj{margin:0}.lt{border:1px solid #F2F2F2}.lu{border-radius:99em}.lv{padding:0px 16px 0px 12px}.lw{height:38px}.lx{align-items:center}.lz svg{margin-right:8px}.mk{font-size:20px}.ml{margin-top:1.2em}.mm{line-height:24px}.mn{letter-spacing:0}.ni{font-size:18px}.nj{margin-top:0.67em}.nk{line-height:28px}.nl{letter-spacing:-0.003em}.od{margin-top:1.56em}.ol{margin-top:1.34em}.oy{margin-top:0.93em}.ph{margin-top:40px}.qa{font-size:16px}.qb{margin-top:1.23em}.ro{display:inline-block}.rt{margin-bottom:96px}.sl{margin-bottom:20px}.sm{margin-right:0}.tf{max-width:100%}.ti{font-size:24px}.tj{line-height:30px}.tk{letter-spacing:-0.016em}.tq{margin-bottom:64px}.ud{margin:32px 0 16px}.uo{width:100%}.ut{padding-top:48px}.ly:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.lm{margin:0}.mw{font-size:24px}.mx{margin-top:1.95em}.my{line-height:30px}.mz{letter-spacing:-0.016em}.nu{font-size:20px}.nv{margin-top:0.94em}.nw{line-height:32px}.nx{letter-spacing:-0.003em}.og{margin-top:2.14em}.oo{margin-top:1.14em}.pb{margin-top:1.25em}.pk{margin-top:56px}.qh{margin-top:1.72em}.qi{line-height:24px}.qj{letter-spacing:0}.rw{margin-bottom:104px}.sb{flex-direction:row}.sf{margin-bottom:0}.sg{margin-right:20px}.tc{max-width:500px}.tt{margin-bottom:88px}.tw{margin-bottom:72px}.ug{margin:40px 0 16px}.ur{width:min-width}.uw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.ll{margin:0}.ms{font-size:24px}.mt{margin-top:1.95em}.mu{line-height:30px}.mv{letter-spacing:-0.016em}.nq{font-size:20px}.nr{margin-top:0.94em}.ns{line-height:32px}.nt{letter-spacing:-0.003em}.of{margin-top:2.14em}.on{margin-top:1.14em}.pa{margin-top:1.25em}.pj{margin-top:56px}.qe{margin-top:1.72em}.qf{line-height:24px}.qg{letter-spacing:0}.rv{margin-bottom:104px}.sc{flex-direction:row}.sh{margin-bottom:0}.si{margin-right:20px}.td{max-width:500px}.ts{margin-bottom:88px}.tv{margin-bottom:72px}.uf{margin:40px 0 16px}.uq{width:min-width}.uv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lk{margin:0}.ma{border:1px solid #F2F2F2}.mb{border-radius:99em}.mc{padding:0px 16px 0px 12px}.md{height:38px}.me{align-items:center}.mg svg{margin-right:8px}.mo{font-size:20px}.mp{margin-top:1.2em}.mq{line-height:24px}.mr{letter-spacing:0}.nm{font-size:18px}.nn{margin-top:0.67em}.no{line-height:28px}.np{letter-spacing:-0.003em}.oe{margin-top:1.56em}.om{margin-top:1.34em}.oz{margin-top:0.93em}.pi{margin-top:40px}.qc{font-size:16px}.qd{margin-top:1.23em}.ru{margin-bottom:96px}.sj{margin-bottom:20px}.sk{margin-right:0}.te{max-width:100%}.tl{font-size:24px}.tm{line-height:30px}.tn{letter-spacing:-0.016em}.tr{margin-bottom:64px}.ue{margin:32px 0 16px}.up{width:100%}.uu{padding-top:48px}.mf:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="print">.rm{display:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pn{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3f8c9fdcb654&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="9399" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle"><strong class="al">Detecting Cobalt Strike Beacons</strong></h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--3f8c9fdcb654--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="SOCFortress" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*cHP8DbSurq9-y7eiervxzw.png" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--3f8c9fdcb654--------------------------------">SOCFortress</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F36613248f635&amp;operation=register&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;user=SOCFortress&amp;userId=36613248f635&amp;source=post_page-36613248f635--byline--3f8c9fdcb654---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Feb 20, 2022</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F3f8c9fdcb654&amp;operation=register&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;user=SOCFortress&amp;userId=36613248f635&amp;source=---header_actions--3f8c9fdcb654---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk lc ld ab q fk le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv z du"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f8c9fdcb654&amp;operation=register&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;source=---header_actions--3f8c9fdcb654---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd li cn"><div class="l ae"><div class="ab cb"><div class="lj lk ll lm ln lo ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls lt lu lv lw s lx ly lz ma mb mc md u me mf mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls lt lu lv lw s lx ly lz ma mb mc md u me mf mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="1aa1" class="mh mi gu bf mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bk">Introduction</h1><p id="a80f" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk">Cobalt Strike is a commercial tool for adversary <strong class="nh gv">simulation</strong>.</p><p id="97e4" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Created by Raphael Mudge in 2012, Cobalt Strike was one of the first public red team command and control frameworks.</p><p id="007c" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">It’s also used by threat actors and the first activity detected for malicious purposes dates back to 2016.</p><p id="6084" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">The main components of Cobalt Strike are a <strong class="nh gv">C2</strong> server and a <strong class="nh gv">beacon</strong> installed on compromised machines.</p><p id="ea6b" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">The Cobalt Strike beacon comes with a number of capabilities, including a command-line interface. The beacon allows the execution of <strong class="nh gv">scripts</strong>, or commands native to the machine’s <strong class="nh gv">operating system</strong>.</p><p id="f4ef" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Cobalt strike for malicious purposes is known to be used by more than <strong class="nh gv">50</strong> threat actor groups. Its use is very common in <strong class="nh gv">ransomware</strong> attacks.</p><p id="8f35" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">In terms of beacon types and methods used for connecting to the C2 servers the most common are <strong class="nh gv">HTTP</strong> (~67%), <strong class="nh gv">HTTPS</strong> (~29%) and <strong class="nh gv">DNS</strong> (~3%). Including JITTER in the beacon trying to avoid detection has been detected in roughly 15% of all the beacons analysed.</p><p id="f6a3" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">When it comes to spawning, around 90% of all beacons analysed were spawning <strong class="nh gv">rundll32.exe</strong> as the main process for lateral movement.</p><p id="fe7b" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Sophisticated attacks using Cobalt strike beacons, like Nobelium usage of Cobalt strike linked to the <strong class="nh gv">SolarWinds</strong> campaign, try to evade detection by fine-tuning many of the configurable options.</p><h1 id="560b" class="mh mi gu bf mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bk">PREVENTION, DETECTION AND RESPONSE TOOLS</h1><ul class=""><li id="ed71" class="nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc oi oj ok bk">Static File Hash analysis: <strong class="nh gv">Windows Defender</strong>.</li><li id="c730" class="nf ng gu nh b ni ol nk nl nm om no np nq on ns nt nu oo nw nx ny op oa ob oc oi oj ok bk">Endpoint Telemetry: <strong class="nh gv">Sysmon</strong> (Sysinternals).</li><li id="8f7d" class="nf ng gu nh b ni ol nk nl nm om no np nq on ns nt nu oo nw nx ny op oa ob oc oi oj ok bk">EDR agent and SIEM: <strong class="nh gv">Wazuh</strong>.</li><li id="0cb7" class="nf ng gu nh b ni ol nk nl nm om no np nq on ns nt nu oo nw nx ny op oa ob oc oi oj ok bk">Threat Intel platform: <strong class="nh gv">MISP</strong></li></ul></div></div></div><div class="ab cb oq or os ot" role="separator"><span class="ou by bm ov ow ox"></span><span class="ou by bm ov ow ox"></span><span class="ou by bm ov ow"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="1ea8" class="mh mi gu bf mj mk oy mm mn mo oz mq mr ms pa mu mv mw pb my mz na pc nc nd ne bk">PREVENTION.</h1><p id="3007" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk">Many of the Cobalt Strike beacons in the wild and additional payloads downloaded as part of the attack chain are going to be flagged and removed by Windows Defender via local file analysis (file hash) or its real time analysis engine.</p><p id="e2b9" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">From a prevention point of view some key points are:</p><ul class=""><li id="b4cd" class="nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc oi oj ok bk">Collecting, reviewing and alerting on Windows Defender Settings not matching minimum criteria (Real Time, Enabled, Exclusion extensions, Excluded folders, removable media, etc.). Deploy an inventory collection script (more info <a class="af pd" href="https://github.com/juaromu/wazuh-windows_agent-inventory" rel="noopener ugc nofollow" target="_blank">here</a>) and alert on inadequate settings.</li></ul><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf pg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5dThRNB2YiFX0y-IfX0dfw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5dThRNB2YiFX0y-IfX0dfw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5dThRNB2YiFX0y-IfX0dfw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5dThRNB2YiFX0y-IfX0dfw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5dThRNB2YiFX0y-IfX0dfw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5dThRNB2YiFX0y-IfX0dfw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5dThRNB2YiFX0y-IfX0dfw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5dThRNB2YiFX0y-IfX0dfw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="460" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Windows Defender Settings</figcaption></figure><ul class=""><li id="232d" class="nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc oi oj ok bk">Ensuring that the antimalware platform is running and in a healthy state</li></ul><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0A_wVkptsQn4HAC3MDn60g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0A_wVkptsQn4HAC3MDn60g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0A_wVkptsQn4HAC3MDn60g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0A_wVkptsQn4HAC3MDn60g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0A_wVkptsQn4HAC3MDn60g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0A_wVkptsQn4HAC3MDn60g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0A_wVkptsQn4HAC3MDn60g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0A_wVkptsQn4HAC3MDn60g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="286" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Information level events — Process running and in healthy state</figcaption></figure><ul class=""><li id="c2a5" class="nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc oi oj ok bk">Ensuring that Windows Defender is successfully downloading and updating the latest file signatures</li></ul><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HugZuJN4KftWhNyCjGvRw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3HugZuJN4KftWhNyCjGvRw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3HugZuJN4KftWhNyCjGvRw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3HugZuJN4KftWhNyCjGvRw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3HugZuJN4KftWhNyCjGvRw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3HugZuJN4KftWhNyCjGvRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3HugZuJN4KftWhNyCjGvRw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3HugZuJN4KftWhNyCjGvRw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="289" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Information level events — Signatures Updated</figcaption></figure><ul class=""><li id="9ef9" class="nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc oi oj ok bk">Ensuring that periodic scans are run in all agents and completed successfully.</li></ul><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3IEqYos9MxLBZMKUSZgWsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3IEqYos9MxLBZMKUSZgWsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3IEqYos9MxLBZMKUSZgWsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3IEqYos9MxLBZMKUSZgWsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3IEqYos9MxLBZMKUSZgWsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3IEqYos9MxLBZMKUSZgWsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3IEqYos9MxLBZMKUSZgWsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3IEqYos9MxLBZMKUSZgWsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="287" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Information level events — Periodic scans</figcaption></figure></div></div></div><div class="ab cb oq or os ot" role="separator"><span class="ou by bm ov ow ox"></span><span class="ou by bm ov ow ox"></span><span class="ou by bm ov ow"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="25db" class="mh mi gu bf mj mk oy mm mn mo oz mq mr ms pa mu mv mw pb my mz na pc nc nd ne bk">DETECTION.</h1><h2 id="5fc4" class="pz mi gu bf mj qa qb dy mn qc qd ea mr nq qe qf qg nu qh qi qj ny qk ql qm qn bk">Network Activity</h2><p id="1d00" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk">Communication to C2 Server:</p><ul class=""><li id="7b63" class="nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc oi oj ok bk">Suspicious processes (“winlogon.exe”, “rundll32.exe”, etc.) opening network connections to public IP addresses.</li></ul><p id="a112" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv"><em class="qo">Detection Logic</em></strong></p><p id="28ec" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Keep track and alert on unusual processes (least seen) opening network connections. Special attention to HTTP, HTTPS and DNS outbound connections. Sysmon (event ID 3) provides all the required telemetry:</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zf4WfzB7COzTfY6-lIKbOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Zf4WfzB7COzTfY6-lIKbOA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Zf4WfzB7COzTfY6-lIKbOA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Zf4WfzB7COzTfY6-lIKbOA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Zf4WfzB7COzTfY6-lIKbOA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Zf4WfzB7COzTfY6-lIKbOA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Zf4WfzB7COzTfY6-lIKbOA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Zf4WfzB7COzTfY6-lIKbOA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="332" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Network Activity — Least Seen Processes</figcaption></figure><p id="a7e7" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv">Visualisations</strong> such as network maps linking Process — DST IP — Connection port can help to quickly identify anomalies:</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z9_8-93FyPoiXT7JAXpwZQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*z9_8-93FyPoiXT7JAXpwZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*z9_8-93FyPoiXT7JAXpwZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*z9_8-93FyPoiXT7JAXpwZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*z9_8-93FyPoiXT7JAXpwZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*z9_8-93FyPoiXT7JAXpwZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*z9_8-93FyPoiXT7JAXpwZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*z9_8-93FyPoiXT7JAXpwZQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="312" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Network Activity — Process Map</figcaption></figure><p id="e06d" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Keep track of downloaded payloads (.js files, .gif files, etc.). Sysmon (Event ID 15) provides this telemetry.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2E0deI_aCYKW0WY35FhTZQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*2E0deI_aCYKW0WY35FhTZQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2E0deI_aCYKW0WY35FhTZQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2E0deI_aCYKW0WY35FhTZQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2E0deI_aCYKW0WY35FhTZQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2E0deI_aCYKW0WY35FhTZQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2E0deI_aCYKW0WY35FhTZQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*2E0deI_aCYKW0WY35FhTZQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="179" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Network Activity — Sysmon Event 15</figcaption></figure><p id="18c9" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Send relevant observables (DNS requests, Destination IPs, files hashes of downloaded files) to security feeds/threat intel platform to identify IoCs related to these observables. More info <a class="af pd" href="https://github.com/juaromu/wazuh-misp" rel="noopener ugc nofollow" target="_blank">here</a>.</p><h2 id="932e" class="pz mi gu bf mj qa qb dy mn qc qd ea mr nq qe qf qg nu qh qi qj ny qk ql qm qn bk">Process Activity.</h2><p id="ccba" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk"><strong class="nh gv"><em class="qo">rundll32.exe:</em></strong></p><p id="dccc" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Used in Lateral Movement by Cobalt Strike beacons: rundll32.exe being spawned by another process(es) and its process execution included no arguments.</p><p id="008f" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv"><em class="qo">Detection Logic</em></strong></p><p id="b372" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Keep track and alert on <strong class="nh gv">unusual</strong> processes spawning rundll32.exe</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMKeBnWeOPm_tt8D4e6fFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hMKeBnWeOPm_tt8D4e6fFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hMKeBnWeOPm_tt8D4e6fFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hMKeBnWeOPm_tt8D4e6fFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hMKeBnWeOPm_tt8D4e6fFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hMKeBnWeOPm_tt8D4e6fFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hMKeBnWeOPm_tt8D4e6fFg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*hMKeBnWeOPm_tt8D4e6fFg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="317" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Processes Spawning Rundll32.exe</figcaption></figure><p id="3614" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Used in Post Exploitation in Cobalt strike related attacks: rundll32.exe spawning processes like <strong class="nh gv">Adfind.exe</strong>, Net.exe, or any other Windows processes used for systems, services or network discovery.</p><h2 id="afd0" class="pz mi gu bf mj qa qb dy mn qc qd ea mr nq qe qf qg nu qh qi qj ny qk ql qm qn bk">Parent Process Spoofing:</h2><p id="4395" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk">Parent process spoofing is a common technique used by Cobalt Strike beacons. With this technique the beacon tries to evade common detection methods such as processes related to the Office suite launching unusual child processes.</p><p id="88c1" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Cobalt strike beacons often spoof processes like “word.exe”, or “excel.exe” to “explorer.exe” so that when the child process is launched the telemetry reported by the EDR agent makes the detection of unusual process chains difficult.</p><p id="eaae" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv"><em class="qo">Detection Logic</em></strong></p><p id="fb19" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Keep track on unique file <strong class="nh gv">hashes</strong> (process image) and their mapping to file process image name and location. Spoofed processes will have same process name but different file hash and possibly executed from an unusual location.</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_kQnL2Ic0r43vu_GCe2evQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_kQnL2Ic0r43vu_GCe2evQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_kQnL2Ic0r43vu_GCe2evQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_kQnL2Ic0r43vu_GCe2evQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_kQnL2Ic0r43vu_GCe2evQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_kQnL2Ic0r43vu_GCe2evQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_kQnL2Ic0r43vu_GCe2evQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_kQnL2Ic0r43vu_GCe2evQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="262" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">UNIQUE RELATIONSHIP PROCESS FILE HASH — PROCESS EXECUTED</figcaption></figure><p id="4edf" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Send relevant observables (file hash of the executed file image) to security feeds/threat intel platform to identify IoCs related to these observables. More info <a class="af pd" href="https://github.com/juaromu/wazuh-misp" rel="noopener ugc nofollow" target="_blank">here</a>.</p><h2 id="5e01" class="pz mi gu bf mj qa qb dy mn qc qd ea mr nq qe qf qg nu qh qi qj ny qk ql qm qn bk">Powershell execution (and command line arguments).</h2><p id="9f03" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk">Suspicious command line arguments used:</p><p id="37b7" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">nop, hidden, <strong class="nh gv">encodedcommand</strong>, nologo, noprofile</p><p id="d2f2" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">The “encodedcommand” (base64) can be extracted and its literal content further analysed, looking for commands like “Net.Webclient”, “Invoke-WebRequest”, etc., commonly used for lateral movement on the source machine.</p><p id="b768" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">On the destination machine, a common detection is spotting powershell executions where the parent process = “<strong class="nh gv">wsmprovhost.exe</strong>” and with a command line = “-Version 5.1 -s -nologo -noprofile”</p><p id="6312" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv"><em class="qo">Detection Logic</em></strong></p><p id="47d8" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Detection rule to spot powershell executions with the <em class="qo">encodedcommand</em> command line and decode the content of the base64 string to “clear text”. Include the decoded command as an additional alert in Wazuh manager.</p><h2 id="8a46" class="pz mi gu bf mj qa qb dy mn qc qd ea mr nq qe qf qg nu qh qi qj ny qk ql qm qn bk">Memory artifacts / Process Injection.</h2><p id="9788" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk">Downloaded payloads try to be executed under the memory space of “Rundll32.exe”.</p><p id="e730" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv"><em class="qo">Detection Logic</em></strong></p><p id="5005" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Keep track and alert on <strong class="nh gv">unsigned</strong> DLLs or with no valid certificate loaded into memory. Sysmon (Event ID 7) provides this telemetry:</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-JwBRsRWsGGRvBmMCSoSUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-JwBRsRWsGGRvBmMCSoSUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-JwBRsRWsGGRvBmMCSoSUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-JwBRsRWsGGRvBmMCSoSUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-JwBRsRWsGGRvBmMCSoSUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-JwBRsRWsGGRvBmMCSoSUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-JwBRsRWsGGRvBmMCSoSUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-JwBRsRWsGGRvBmMCSoSUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="220" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Unsigned DLLs loaded in memory.</figcaption></figure><p id="f7e6" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Visualisations such as DLL side loading maps linking Process —DLL — DLL vendor can help to quickly identify anomalies:</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQLoEGkp5u0c2-GhWhoOoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IQLoEGkp5u0c2-GhWhoOoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IQLoEGkp5u0c2-GhWhoOoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IQLoEGkp5u0c2-GhWhoOoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IQLoEGkp5u0c2-GhWhoOoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IQLoEGkp5u0c2-GhWhoOoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IQLoEGkp5u0c2-GhWhoOoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*IQLoEGkp5u0c2-GhWhoOoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="329" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">Process and DLL side loading map.</figcaption></figure><p id="1332" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Send relevant observables (DLL file hash) to security feeds/threat intel platform to identify IoCs related to these observables. More info <a class="af pd" href="https://github.com/juaromu/wazuh-misp" rel="noopener ugc nofollow" target="_blank">here</a>.</p><h2 id="b71f" class="pz mi gu bf mj qa qb dy mn qc qd ea mr nq qe qf qg nu qh qi qj ny qk ql qm qn bk">Lateral Movement.</h2><p id="acd7" class="pw-post-body-paragraph nf ng gu nh b ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc gn bk"><strong class="nh gv">PSEXEC</strong> is one of the most common processes used by Cobalt strike beacons for lateral movement.</p><p id="ff61" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">PSEXEC is used to drop a payload in a shared folder (normally ADMIN$) and then to start a new service on the target machine that executes that payload. The payload will spawn another process and finally the remote service is removed.</p><p id="6fe5" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv"><em class="qo">Detection Logic</em></strong></p><p id="61d9" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Detection rules based on <strong class="nh gv">frequency</strong> alerting on service creation/modification/deletion activity:</p><figure class="ph pi pj pk pl pm pe pf paragraph-image"><div role="button" tabindex="0" class="pn po fj pp bh pq"><div class="pe pf qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MOFJl5GKoEV7mPRgvAEtBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MOFJl5GKoEV7mPRgvAEtBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MOFJl5GKoEV7mPRgvAEtBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MOFJl5GKoEV7mPRgvAEtBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MOFJl5GKoEV7mPRgvAEtBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MOFJl5GKoEV7mPRgvAEtBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MOFJl5GKoEV7mPRgvAEtBw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*MOFJl5GKoEV7mPRgvAEtBw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo pr c" width="700" height="238" loading="lazy" role="presentation"/></picture></div></div><figcaption class="ps ff pt pe pf pu pv bf b bg z du">System Services Activity and Telemetry.</figcaption></figure><p id="e6d2" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Keep track and alert on unusual executables launched by <strong class="nh gv">services.exe</strong>.</p><p id="7c86" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Send relevant observables (process file hash) to security feeds/threat intel platform to identify IoCs related to these observables. More info <a class="af pd" href="https://github.com/juaromu/wazuh-misp" rel="noopener ugc nofollow" target="_blank">here</a>.</p></div></div></div><div class="ab cb oq or os ot" role="separator"><span class="ou by bm ov ow ox"></span><span class="ou by bm ov ow ox"></span><span class="ou by bm ov ow"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="190d" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk"><strong class="nh gv">Need Help?</strong></p><p id="b9db" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">The functionality discussed in this post, and so much more, are available via the SOCFortress platform. Let SOCFortress help you and your team keep your infrastructure secure.</p><p id="8ea1" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Website: <a class="af pd" href="https://www.socfortress.co/" rel="noopener ugc nofollow" target="_blank">https://www.socfortress.co/</a></p><p id="f8f6" class="pw-post-body-paragraph nf ng gu nh b ni od nk nl nm oe no np nq of ns nt nu og nw nx ny oh oa ob oc gn bk">Platform Demo: <a class="af pd" href="https://www.socfortress.co/demo_access.html" rel="noopener ugc nofollow" target="_blank">https://www.socfortress.co/demo_access.html</a></p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qx qy ab iv"><div class="qz ab"><a class="ra ay am ao" href="https://medium.com/tag/edr?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Edr</div></a></div><div class="qz ab"><a class="ra ay am ao" href="https://medium.com/tag/cobalt-strike?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Cobalt Strike</div></a></div><div class="qz ab"><a class="ra ay am ao" href="https://medium.com/tag/wazuh?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Wazuh</div></a></div><div class="qz ab"><a class="ra ay am ao" href="https://medium.com/tag/soar?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Soar</div></a></div><div class="qz ab"><a class="ra ay am ao" href="https://medium.com/tag/threat-intelligence?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Threat Intelligence</div></a></div></div></div></div><div class="l"></div><footer class="rg or rh ri rj ab q rk rl c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rm"><div class="ab q ke"><div class="rn l"><span class="l ro rp rq e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F3f8c9fdcb654&amp;operation=register&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;user=SOCFortress&amp;userId=36613248f635&amp;source=---footer_actions--3f8c9fdcb654---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f rr rs"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F3f8c9fdcb654&amp;operation=register&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;user=SOCFortress&amp;userId=36613248f635&amp;source=---footer_actions--3f8c9fdcb654---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk lc ld ab q fk le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z du"><span class="pw-responses-count la lb">1</span></p></button></div></div></div></div><div class="ab q"><div class="ox l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F3f8c9fdcb654&amp;operation=register&amp;redirect=https%3A%2F%2Fsocfortress.medium.com%2Fdetecting-cobalt-strike-beacons-3f8c9fdcb654&amp;source=---footer_actions--3f8c9fdcb654---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="ox l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rt ru rv rw rx l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ry bh r rz"></div><div class="ab sa sb sc iu it"><div class="sd se sf sg sh si sj sk sl sm ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--3f8c9fdcb654--------------------------------"><div class="l fj"><img alt="SOCFortress" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*cHP8DbSurq9-y7eiervxzw.png" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sn"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--3f8c9fdcb654--------------------------------"><div class="l fj"><img alt="SOCFortress" class="l fd by so sp cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*cHP8DbSurq9-y7eiervxzw.png" width="64" height="64" loading="lazy"/><div class="fr by l so sp fs n ay sn"></div></div></a></div><div class="j i d sq is"><div class="ab"><span><button class="bf b bg z sr rb ss st su sv sw ev ew sx sy sz fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co ta"><div class="tb tc td te tf l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--3f8c9fdcb654--------------------------------"><h2 class="pw-author-name bf th ti tj tk tl tm tn nq qf qg nu qi qj ny ql qm bk"><span class="gn tg">Written by <!-- -->SOCFortress</span></h2></a><div class="qz ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--3f8c9fdcb654--------------------------------">3.7K Followers</a></span></div><div class="bf b bg z du ab to"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/following?source=post_page---post_author_info--3f8c9fdcb654--------------------------------">2 Following</a></div></div><div class="tp l"><p class="bf b bg z bk"><span class="gn">SOCFortress is a SaaS company that unifies Observability, Security Monitoring, Threat Intelligence and Security Orchestration, Automation, and Response (SOAR).</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sr rb ss st su sv sw ev ew sx sy sz fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tq tr ts tt tu l"><div class="ry bh r tq tr tv tw tx"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf th mk mm mn mo mq mr ms mu mv mw my mz na nc nd bk">Responses (<!-- -->1<!-- -->)</h2><div class="ab ty"><div><div class="bm" aria-hidden="false"><a class="tz ua" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--3f8c9fdcb654--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ub uc ud ue uf ug uh l"></div><div class="oq l"><button class="bf b bg z bk rb ui uj uk lh le sw ev ew ex ul um un fa uo up uq ur us fb fc fd bm fe ff">See all responses</button></div></div></div></div><div class="ut uu uv uw ux l bx"><div class="h k j"><div class="ry bh uy uz"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="va ab ke iv"><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vb l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----3f8c9fdcb654--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://socfortress.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-3f8c9fdcb654","user-36613248f635"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"36613248f635","explicit":true},"viewerIsBot":false},"debug":{"requestId":"8a42157d-885e-47c6-b3d7-38fa2a75bb4b","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-dd68dc3a190faa82b6fde5a7e5596a10-b2eab500064a1fd8-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fsocfortress.medium.com\u002Fdetecting-cobalt-strike-beacons-3f8c9fdcb654","host":"socfortress.medium.com","hostname":"socfortress.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"socfortress.medium.com\"})":null,"postResult({\"id\":\"3f8c9fdcb654\"})":{"__ref":"Post:3f8c9fdcb654"}},"LinkedAccounts:36613248f635":{"__typename":"LinkedAccounts","mastodon":null,"id":"36613248f635"},"Membership:f5247bebd7f3":{"__typename":"Membership","tier":"MEMBER","id":"f5247bebd7f3"},"User:36613248f635":{"__typename":"User","id":"36613248f635","linkedAccounts":{"__ref":"LinkedAccounts:36613248f635"},"isSuspended":false,"name":"SOCFortress","imageId":"1*cHP8DbSurq9-y7eiervxzw.png","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"socfortress.medium.com"}},"hasSubdomain":true,"username":"socfortress","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":3725,"followingCount":1,"collectionFollowingCount":1},"bio":"SOCFortress is a SaaS company that unifies Observability, Security Monitoring, Threat Intelligence and Security Orchestration, Automation, and Response (SOAR).","membership":{"__ref":"Membership:f5247bebd7f3"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:36613248f635-viewerId:lo_8e1f5a050396"},"twitterScreenName":""},"Paragraph:5958a4ddc884_0":{"__typename":"Paragraph","id":"5958a4ddc884_0","name":"9399","type":"H3","href":null,"layout":null,"metadata":null,"text":"Detecting Cobalt Strike Beacons","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_1":{"__typename":"Paragraph","id":"5958a4ddc884_1","name":"1aa1","type":"H3","href":null,"layout":null,"metadata":null,"text":"Introduction","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_2":{"__typename":"Paragraph","id":"5958a4ddc884_2","name":"a80f","type":"P","href":null,"layout":null,"metadata":null,"text":"Cobalt Strike is a commercial tool for adversary simulation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":49,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_3":{"__typename":"Paragraph","id":"5958a4ddc884_3","name":"97e4","type":"P","href":null,"layout":null,"metadata":null,"text":"Created by Raphael Mudge in 2012, Cobalt Strike was one of the first public red team command and control frameworks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_4":{"__typename":"Paragraph","id":"5958a4ddc884_4","name":"007c","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s also used by threat actors and the first activity detected for malicious purposes dates back to 2016.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_5":{"__typename":"Paragraph","id":"5958a4ddc884_5","name":"6084","type":"P","href":null,"layout":null,"metadata":null,"text":"The main components of Cobalt Strike are a C2 server and a beacon installed on compromised machines.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":43,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":59,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_6":{"__typename":"Paragraph","id":"5958a4ddc884_6","name":"ea6b","type":"P","href":null,"layout":null,"metadata":null,"text":"The Cobalt Strike beacon comes with a number of capabilities, including a command-line interface. The beacon allows the execution of scripts, or commands native to the machine’s operating system.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":133,"end":140,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":178,"end":194,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_7":{"__typename":"Paragraph","id":"5958a4ddc884_7","name":"f4ef","type":"P","href":null,"layout":null,"metadata":null,"text":"Cobalt strike for malicious purposes is known to be used by more than 50 threat actor groups. Its use is very common in ransomware attacks.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":70,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":120,"end":130,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_8":{"__typename":"Paragraph","id":"5958a4ddc884_8","name":"8f35","type":"P","href":null,"layout":null,"metadata":null,"text":"In terms of beacon types and methods used for connecting to the C2 servers the most common are HTTP (~67%), HTTPS (~29%) and DNS (~3%). Including JITTER in the beacon trying to avoid detection has been detected in roughly 15% of all the beacons analysed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":95,"end":99,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":108,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":125,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_9":{"__typename":"Paragraph","id":"5958a4ddc884_9","name":"f6a3","type":"P","href":null,"layout":null,"metadata":null,"text":"When it comes to spawning, around 90% of all beacons analysed were spawning rundll32.exe as the main process for lateral movement.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":76,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_10":{"__typename":"Paragraph","id":"5958a4ddc884_10","name":"fe7b","type":"P","href":null,"layout":null,"metadata":null,"text":"Sophisticated attacks using Cobalt strike beacons, like Nobelium usage of Cobalt strike linked to the SolarWinds campaign, try to evade detection by fine-tuning many of the configurable options.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":102,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_11":{"__typename":"Paragraph","id":"5958a4ddc884_11","name":"560b","type":"H3","href":null,"layout":null,"metadata":null,"text":"PREVENTION, DETECTION AND RESPONSE TOOLS","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_12":{"__typename":"Paragraph","id":"5958a4ddc884_12","name":"ed71","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Static File Hash analysis: Windows Defender.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":27,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_13":{"__typename":"Paragraph","id":"5958a4ddc884_13","name":"c730","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Endpoint Telemetry: Sysmon (Sysinternals).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":20,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_14":{"__typename":"Paragraph","id":"5958a4ddc884_14","name":"8f7d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"EDR agent and SIEM: Wazuh.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":20,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_15":{"__typename":"Paragraph","id":"5958a4ddc884_15","name":"0cb7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Threat Intel platform: MISP","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":23,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_16":{"__typename":"Paragraph","id":"5958a4ddc884_16","name":"1ea8","type":"H3","href":null,"layout":null,"metadata":null,"text":"PREVENTION.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_17":{"__typename":"Paragraph","id":"5958a4ddc884_17","name":"3007","type":"P","href":null,"layout":null,"metadata":null,"text":"Many of the Cobalt Strike beacons in the wild and additional payloads downloaded as part of the attack chain are going to be flagged and removed by Windows Defender via local file analysis (file hash) or its real time analysis engine.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_18":{"__typename":"Paragraph","id":"5958a4ddc884_18","name":"e2b9","type":"P","href":null,"layout":null,"metadata":null,"text":"From a prevention point of view some key points are:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_19":{"__typename":"Paragraph","id":"5958a4ddc884_19","name":"b4cd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Collecting, reviewing and alerting on Windows Defender Settings not matching minimum criteria (Real Time, Enabled, Exclusion extensions, Excluded folders, removable media, etc.). Deploy an inventory collection script (more info here) and alert on inadequate settings.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":228,"end":232,"href":"https:\u002F\u002Fgithub.com\u002Fjuaromu\u002Fwazuh-windows_agent-inventory","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5dThRNB2YiFX0y-IfX0dfw.png":{"__typename":"ImageMetadata","id":"1*5dThRNB2YiFX0y-IfX0dfw.png","originalHeight":889,"originalWidth":1355,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_20":{"__typename":"Paragraph","id":"5958a4ddc884_20","name":"63bb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5dThRNB2YiFX0y-IfX0dfw.png"},"text":"Windows Defender Settings","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_21":{"__typename":"Paragraph","id":"5958a4ddc884_21","name":"232d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ensuring that the antimalware platform is running and in a healthy state","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0A_wVkptsQn4HAC3MDn60g.png":{"__typename":"ImageMetadata","id":"1*0A_wVkptsQn4HAC3MDn60g.png","originalHeight":744,"originalWidth":1827,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_22":{"__typename":"Paragraph","id":"5958a4ddc884_22","name":"93d5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0A_wVkptsQn4HAC3MDn60g.png"},"text":"Information level events — Process running and in healthy state","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_23":{"__typename":"Paragraph","id":"5958a4ddc884_23","name":"c2a5","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ensuring that Windows Defender is successfully downloading and updating the latest file signatures","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3HugZuJN4KftWhNyCjGvRw.png":{"__typename":"ImageMetadata","id":"1*3HugZuJN4KftWhNyCjGvRw.png","originalHeight":755,"originalWidth":1835,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_24":{"__typename":"Paragraph","id":"5958a4ddc884_24","name":"7c7d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3HugZuJN4KftWhNyCjGvRw.png"},"text":"Information level events — Signatures Updated","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_25":{"__typename":"Paragraph","id":"5958a4ddc884_25","name":"9ef9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ensuring that periodic scans are run in all agents and completed successfully.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3IEqYos9MxLBZMKUSZgWsw.png":{"__typename":"ImageMetadata","id":"1*3IEqYos9MxLBZMKUSZgWsw.png","originalHeight":750,"originalWidth":1833,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_26":{"__typename":"Paragraph","id":"5958a4ddc884_26","name":"6453","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3IEqYos9MxLBZMKUSZgWsw.png"},"text":"Information level events — Periodic scans","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_27":{"__typename":"Paragraph","id":"5958a4ddc884_27","name":"25db","type":"H3","href":null,"layout":null,"metadata":null,"text":"DETECTION.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_28":{"__typename":"Paragraph","id":"5958a4ddc884_28","name":"5fc4","type":"H4","href":null,"layout":null,"metadata":null,"text":"Network Activity","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_29":{"__typename":"Paragraph","id":"5958a4ddc884_29","name":"1d00","type":"P","href":null,"layout":null,"metadata":null,"text":"Communication to C2 Server:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_30":{"__typename":"Paragraph","id":"5958a4ddc884_30","name":"7b63","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Suspicious processes (“winlogon.exe”, “rundll32.exe”, etc.) opening network connections to public IP addresses.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_31":{"__typename":"Paragraph","id":"5958a4ddc884_31","name":"a112","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection Logic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_32":{"__typename":"Paragraph","id":"5958a4ddc884_32","name":"28ec","type":"P","href":null,"layout":null,"metadata":null,"text":"Keep track and alert on unusual processes (least seen) opening network connections. Special attention to HTTP, HTTPS and DNS outbound connections. Sysmon (event ID 3) provides all the required telemetry:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Zf4WfzB7COzTfY6-lIKbOA.png":{"__typename":"ImageMetadata","id":"1*Zf4WfzB7COzTfY6-lIKbOA.png","originalHeight":872,"originalWidth":1844,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_33":{"__typename":"Paragraph","id":"5958a4ddc884_33","name":"aaec","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Zf4WfzB7COzTfY6-lIKbOA.png"},"text":"Network Activity — Least Seen Processes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_34":{"__typename":"Paragraph","id":"5958a4ddc884_34","name":"a7e7","type":"P","href":null,"layout":null,"metadata":null,"text":"Visualisations such as network maps linking Process — DST IP — Connection port can help to quickly identify anomalies:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*z9_8-93FyPoiXT7JAXpwZQ.png":{"__typename":"ImageMetadata","id":"1*z9_8-93FyPoiXT7JAXpwZQ.png","originalHeight":819,"originalWidth":1838,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_35":{"__typename":"Paragraph","id":"5958a4ddc884_35","name":"62d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*z9_8-93FyPoiXT7JAXpwZQ.png"},"text":"Network Activity — Process Map","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_36":{"__typename":"Paragraph","id":"5958a4ddc884_36","name":"e06d","type":"P","href":null,"layout":null,"metadata":null,"text":"Keep track of downloaded payloads (.js files, .gif files, etc.). Sysmon (Event ID 15) provides this telemetry.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2E0deI_aCYKW0WY35FhTZQ.png":{"__typename":"ImageMetadata","id":"1*2E0deI_aCYKW0WY35FhTZQ.png","originalHeight":442,"originalWidth":1735,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_37":{"__typename":"Paragraph","id":"5958a4ddc884_37","name":"019f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2E0deI_aCYKW0WY35FhTZQ.png"},"text":"Network Activity — Sysmon Event 15","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_38":{"__typename":"Paragraph","id":"5958a4ddc884_38","name":"18c9","type":"P","href":null,"layout":null,"metadata":null,"text":"Send relevant observables (DNS requests, Destination IPs, files hashes of downloaded files) to security feeds\u002Fthreat intel platform to identify IoCs related to these observables. More info here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":189,"end":193,"href":"https:\u002F\u002Fgithub.com\u002Fjuaromu\u002Fwazuh-misp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_39":{"__typename":"Paragraph","id":"5958a4ddc884_39","name":"932e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Process Activity.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_40":{"__typename":"Paragraph","id":"5958a4ddc884_40","name":"ccba","type":"P","href":null,"layout":null,"metadata":null,"text":"rundll32.exe:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_41":{"__typename":"Paragraph","id":"5958a4ddc884_41","name":"dccc","type":"P","href":null,"layout":null,"metadata":null,"text":"Used in Lateral Movement by Cobalt Strike beacons: rundll32.exe being spawned by another process(es) and its process execution included no arguments.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_42":{"__typename":"Paragraph","id":"5958a4ddc884_42","name":"008f","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection Logic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_43":{"__typename":"Paragraph","id":"5958a4ddc884_43","name":"b372","type":"P","href":null,"layout":null,"metadata":null,"text":"Keep track and alert on unusual processes spawning rundll32.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hMKeBnWeOPm_tt8D4e6fFg.png":{"__typename":"ImageMetadata","id":"1*hMKeBnWeOPm_tt8D4e6fFg.png","originalHeight":794,"originalWidth":1758,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_44":{"__typename":"Paragraph","id":"5958a4ddc884_44","name":"abc8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hMKeBnWeOPm_tt8D4e6fFg.png"},"text":"Processes Spawning Rundll32.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_45":{"__typename":"Paragraph","id":"5958a4ddc884_45","name":"3614","type":"P","href":null,"layout":null,"metadata":null,"text":"Used in Post Exploitation in Cobalt strike related attacks: rundll32.exe spawning processes like Adfind.exe, Net.exe, or any other Windows processes used for systems, services or network discovery.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":97,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_46":{"__typename":"Paragraph","id":"5958a4ddc884_46","name":"afd0","type":"H4","href":null,"layout":null,"metadata":null,"text":"Parent Process Spoofing:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_47":{"__typename":"Paragraph","id":"5958a4ddc884_47","name":"4395","type":"P","href":null,"layout":null,"metadata":null,"text":"Parent process spoofing is a common technique used by Cobalt Strike beacons. With this technique the beacon tries to evade common detection methods such as processes related to the Office suite launching unusual child processes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_48":{"__typename":"Paragraph","id":"5958a4ddc884_48","name":"88c1","type":"P","href":null,"layout":null,"metadata":null,"text":"Cobalt strike beacons often spoof processes like “word.exe”, or “excel.exe” to “explorer.exe” so that when the child process is launched the telemetry reported by the EDR agent makes the detection of unusual process chains difficult.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_49":{"__typename":"Paragraph","id":"5958a4ddc884_49","name":"eaae","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection Logic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_50":{"__typename":"Paragraph","id":"5958a4ddc884_50","name":"fb19","type":"P","href":null,"layout":null,"metadata":null,"text":"Keep track on unique file hashes (process image) and their mapping to file process image name and location. Spoofed processes will have same process name but different file hash and possibly executed from an unusual location.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":26,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_kQnL2Ic0r43vu_GCe2evQ.png":{"__typename":"ImageMetadata","id":"1*_kQnL2Ic0r43vu_GCe2evQ.png","originalHeight":669,"originalWidth":1792,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_51":{"__typename":"Paragraph","id":"5958a4ddc884_51","name":"a9f6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_kQnL2Ic0r43vu_GCe2evQ.png"},"text":"UNIQUE RELATIONSHIP PROCESS FILE HASH — PROCESS EXECUTED","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_52":{"__typename":"Paragraph","id":"5958a4ddc884_52","name":"4edf","type":"P","href":null,"layout":null,"metadata":null,"text":"Send relevant observables (file hash of the executed file image) to security feeds\u002Fthreat intel platform to identify IoCs related to these observables. More info here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":162,"end":166,"href":"https:\u002F\u002Fgithub.com\u002Fjuaromu\u002Fwazuh-misp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_53":{"__typename":"Paragraph","id":"5958a4ddc884_53","name":"5e01","type":"H4","href":null,"layout":null,"metadata":null,"text":"Powershell execution (and command line arguments).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_54":{"__typename":"Paragraph","id":"5958a4ddc884_54","name":"9f03","type":"P","href":null,"layout":null,"metadata":null,"text":"Suspicious command line arguments used:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_55":{"__typename":"Paragraph","id":"5958a4ddc884_55","name":"37b7","type":"P","href":null,"layout":null,"metadata":null,"text":"nop, hidden, encodedcommand, nologo, noprofile","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":13,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_56":{"__typename":"Paragraph","id":"5958a4ddc884_56","name":"d2f2","type":"P","href":null,"layout":null,"metadata":null,"text":"The “encodedcommand” (base64) can be extracted and its literal content further analysed, looking for commands like “Net.Webclient”, “Invoke-WebRequest”, etc., commonly used for lateral movement on the source machine.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_57":{"__typename":"Paragraph","id":"5958a4ddc884_57","name":"b768","type":"P","href":null,"layout":null,"metadata":null,"text":"On the destination machine, a common detection is spotting powershell executions where the parent process = “wsmprovhost.exe” and with a command line = “-Version 5.1 -s -nologo -noprofile”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":109,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_58":{"__typename":"Paragraph","id":"5958a4ddc884_58","name":"6312","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection Logic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_59":{"__typename":"Paragraph","id":"5958a4ddc884_59","name":"47d8","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection rule to spot powershell executions with the encodedcommand command line and decode the content of the base64 string to “clear text”. Include the decoded command as an additional alert in Wazuh manager.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":54,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_60":{"__typename":"Paragraph","id":"5958a4ddc884_60","name":"8a46","type":"H4","href":null,"layout":null,"metadata":null,"text":"Memory artifacts \u002F Process Injection.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_61":{"__typename":"Paragraph","id":"5958a4ddc884_61","name":"9788","type":"P","href":null,"layout":null,"metadata":null,"text":"Downloaded payloads try to be executed under the memory space of “Rundll32.exe”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_62":{"__typename":"Paragraph","id":"5958a4ddc884_62","name":"e730","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection Logic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_63":{"__typename":"Paragraph","id":"5958a4ddc884_63","name":"5005","type":"P","href":null,"layout":null,"metadata":null,"text":"Keep track and alert on unsigned DLLs or with no valid certificate loaded into memory. Sysmon (Event ID 7) provides this telemetry:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-JwBRsRWsGGRvBmMCSoSUQ.png":{"__typename":"ImageMetadata","id":"1*-JwBRsRWsGGRvBmMCSoSUQ.png","originalHeight":476,"originalWidth":1521,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_64":{"__typename":"Paragraph","id":"5958a4ddc884_64","name":"7718","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-JwBRsRWsGGRvBmMCSoSUQ.png"},"text":"Unsigned DLLs loaded in memory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_65":{"__typename":"Paragraph","id":"5958a4ddc884_65","name":"f7e6","type":"P","href":null,"layout":null,"metadata":null,"text":"Visualisations such as DLL side loading maps linking Process —DLL — DLL vendor can help to quickly identify anomalies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IQLoEGkp5u0c2-GhWhoOoA.png":{"__typename":"ImageMetadata","id":"1*IQLoEGkp5u0c2-GhWhoOoA.png","originalHeight":867,"originalWidth":1850,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_66":{"__typename":"Paragraph","id":"5958a4ddc884_66","name":"dc0f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IQLoEGkp5u0c2-GhWhoOoA.png"},"text":"Process and DLL side loading map.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_67":{"__typename":"Paragraph","id":"5958a4ddc884_67","name":"1332","type":"P","href":null,"layout":null,"metadata":null,"text":"Send relevant observables (DLL file hash) to security feeds\u002Fthreat intel platform to identify IoCs related to these observables. More info here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":139,"end":143,"href":"https:\u002F\u002Fgithub.com\u002Fjuaromu\u002Fwazuh-misp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_68":{"__typename":"Paragraph","id":"5958a4ddc884_68","name":"b71f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Lateral Movement.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_69":{"__typename":"Paragraph","id":"5958a4ddc884_69","name":"acd7","type":"P","href":null,"layout":null,"metadata":null,"text":"PSEXEC is one of the most common processes used by Cobalt strike beacons for lateral movement.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_70":{"__typename":"Paragraph","id":"5958a4ddc884_70","name":"ff61","type":"P","href":null,"layout":null,"metadata":null,"text":"PSEXEC is used to drop a payload in a shared folder (normally ADMIN$) and then to start a new service on the target machine that executes that payload. The payload will spawn another process and finally the remote service is removed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_71":{"__typename":"Paragraph","id":"5958a4ddc884_71","name":"6fe5","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection Logic","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_72":{"__typename":"Paragraph","id":"5958a4ddc884_72","name":"61d9","type":"P","href":null,"layout":null,"metadata":null,"text":"Detection rules based on frequency alerting on service creation\u002Fmodification\u002Fdeletion activity:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":25,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MOFJl5GKoEV7mPRgvAEtBw.png":{"__typename":"ImageMetadata","id":"1*MOFJl5GKoEV7mPRgvAEtBw.png","originalHeight":461,"originalWidth":1358,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5958a4ddc884_73":{"__typename":"Paragraph","id":"5958a4ddc884_73","name":"7f5e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MOFJl5GKoEV7mPRgvAEtBw.png"},"text":"System Services Activity and Telemetry.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_74":{"__typename":"Paragraph","id":"5958a4ddc884_74","name":"e6d2","type":"P","href":null,"layout":null,"metadata":null,"text":"Keep track and alert on unusual executables launched by services.exe.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":56,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_75":{"__typename":"Paragraph","id":"5958a4ddc884_75","name":"7c86","type":"P","href":null,"layout":null,"metadata":null,"text":"Send relevant observables (process file hash) to security feeds\u002Fthreat intel platform to identify IoCs related to these observables. More info here.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":143,"end":147,"href":"https:\u002F\u002Fgithub.com\u002Fjuaromu\u002Fwazuh-misp","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_76":{"__typename":"Paragraph","id":"5958a4ddc884_76","name":"190d","type":"P","href":null,"layout":null,"metadata":null,"text":"Need Help?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_77":{"__typename":"Paragraph","id":"5958a4ddc884_77","name":"b9db","type":"P","href":null,"layout":null,"metadata":null,"text":"The functionality discussed in this post, and so much more, are available via the SOCFortress platform. Let SOCFortress help you and your team keep your infrastructure secure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_78":{"__typename":"Paragraph","id":"5958a4ddc884_78","name":"8ea1","type":"P","href":null,"layout":null,"metadata":null,"text":"Website: https:\u002F\u002Fwww.socfortress.co\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":9,"end":36,"href":"https:\u002F\u002Fwww.socfortress.co\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5958a4ddc884_79":{"__typename":"Paragraph","id":"5958a4ddc884_79","name":"f8f6","type":"P","href":null,"layout":null,"metadata":null,"text":"Platform Demo: https:\u002F\u002Fwww.socfortress.co\u002Fdemo_access.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":15,"end":58,"href":"https:\u002F\u002Fwww.socfortress.co\u002Fdemo_access.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:36613248f635-viewerId:lo_8e1f5a050396":{"__typename":"UserViewerEdge","id":"userId:36613248f635-viewerId:lo_8e1f5a050396","isMuting":false},"PostViewerEdge:postId:3f8c9fdcb654-viewerId:lo_8e1f5a050396":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:3f8c9fdcb654-viewerId:lo_8e1f5a050396"},"Tag:edr":{"__typename":"Tag","id":"edr","displayTitle":"Edr","normalizedTagSlug":"edr"},"Tag:cobalt-strike":{"__typename":"Tag","id":"cobalt-strike","displayTitle":"Cobalt Strike","normalizedTagSlug":"cobalt-strike"},"Tag:wazuh":{"__typename":"Tag","id":"wazuh","displayTitle":"Wazuh","normalizedTagSlug":"wazuh"},"Tag:soar":{"__typename":"Tag","id":"soar","displayTitle":"Soar","normalizedTagSlug":"soar"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Post:3f8c9fdcb654":{"__typename":"Post","id":"3f8c9fdcb654","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e40e","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d1cf","startIndex":16,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"19fe","startIndex":27,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"1e82","startIndex":76,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:5958a4ddc884_0"},{"__ref":"Paragraph:5958a4ddc884_1"},{"__ref":"Paragraph:5958a4ddc884_2"},{"__ref":"Paragraph:5958a4ddc884_3"},{"__ref":"Paragraph:5958a4ddc884_4"},{"__ref":"Paragraph:5958a4ddc884_5"},{"__ref":"Paragraph:5958a4ddc884_6"},{"__ref":"Paragraph:5958a4ddc884_7"},{"__ref":"Paragraph:5958a4ddc884_8"},{"__ref":"Paragraph:5958a4ddc884_9"},{"__ref":"Paragraph:5958a4ddc884_10"},{"__ref":"Paragraph:5958a4ddc884_11"},{"__ref":"Paragraph:5958a4ddc884_12"},{"__ref":"Paragraph:5958a4ddc884_13"},{"__ref":"Paragraph:5958a4ddc884_14"},{"__ref":"Paragraph:5958a4ddc884_15"},{"__ref":"Paragraph:5958a4ddc884_16"},{"__ref":"Paragraph:5958a4ddc884_17"},{"__ref":"Paragraph:5958a4ddc884_18"},{"__ref":"Paragraph:5958a4ddc884_19"},{"__ref":"Paragraph:5958a4ddc884_20"},{"__ref":"Paragraph:5958a4ddc884_21"},{"__ref":"Paragraph:5958a4ddc884_22"},{"__ref":"Paragraph:5958a4ddc884_23"},{"__ref":"Paragraph:5958a4ddc884_24"},{"__ref":"Paragraph:5958a4ddc884_25"},{"__ref":"Paragraph:5958a4ddc884_26"},{"__ref":"Paragraph:5958a4ddc884_27"},{"__ref":"Paragraph:5958a4ddc884_28"},{"__ref":"Paragraph:5958a4ddc884_29"},{"__ref":"Paragraph:5958a4ddc884_30"},{"__ref":"Paragraph:5958a4ddc884_31"},{"__ref":"Paragraph:5958a4ddc884_32"},{"__ref":"Paragraph:5958a4ddc884_33"},{"__ref":"Paragraph:5958a4ddc884_34"},{"__ref":"Paragraph:5958a4ddc884_35"},{"__ref":"Paragraph:5958a4ddc884_36"},{"__ref":"Paragraph:5958a4ddc884_37"},{"__ref":"Paragraph:5958a4ddc884_38"},{"__ref":"Paragraph:5958a4ddc884_39"},{"__ref":"Paragraph:5958a4ddc884_40"},{"__ref":"Paragraph:5958a4ddc884_41"},{"__ref":"Paragraph:5958a4ddc884_42"},{"__ref":"Paragraph:5958a4ddc884_43"},{"__ref":"Paragraph:5958a4ddc884_44"},{"__ref":"Paragraph:5958a4ddc884_45"},{"__ref":"Paragraph:5958a4ddc884_46"},{"__ref":"Paragraph:5958a4ddc884_47"},{"__ref":"Paragraph:5958a4ddc884_48"},{"__ref":"Paragraph:5958a4ddc884_49"},{"__ref":"Paragraph:5958a4ddc884_50"},{"__ref":"Paragraph:5958a4ddc884_51"},{"__ref":"Paragraph:5958a4ddc884_52"},{"__ref":"Paragraph:5958a4ddc884_53"},{"__ref":"Paragraph:5958a4ddc884_54"},{"__ref":"Paragraph:5958a4ddc884_55"},{"__ref":"Paragraph:5958a4ddc884_56"},{"__ref":"Paragraph:5958a4ddc884_57"},{"__ref":"Paragraph:5958a4ddc884_58"},{"__ref":"Paragraph:5958a4ddc884_59"},{"__ref":"Paragraph:5958a4ddc884_60"},{"__ref":"Paragraph:5958a4ddc884_61"},{"__ref":"Paragraph:5958a4ddc884_62"},{"__ref":"Paragraph:5958a4ddc884_63"},{"__ref":"Paragraph:5958a4ddc884_64"},{"__ref":"Paragraph:5958a4ddc884_65"},{"__ref":"Paragraph:5958a4ddc884_66"},{"__ref":"Paragraph:5958a4ddc884_67"},{"__ref":"Paragraph:5958a4ddc884_68"},{"__ref":"Paragraph:5958a4ddc884_69"},{"__ref":"Paragraph:5958a4ddc884_70"},{"__ref":"Paragraph:5958a4ddc884_71"},{"__ref":"Paragraph:5958a4ddc884_72"},{"__ref":"Paragraph:5958a4ddc884_73"},{"__ref":"Paragraph:5958a4ddc884_74"},{"__ref":"Paragraph:5958a4ddc884_75"},{"__ref":"Paragraph:5958a4ddc884_76"},{"__ref":"Paragraph:5958a4ddc884_77"},{"__ref":"Paragraph:5958a4ddc884_78"},{"__ref":"Paragraph:5958a4ddc884_79"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:36613248f635"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fsocfortress.medium.com\u002Fdetecting-cobalt-strike-beacons-3f8c9fdcb654","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"5958a4ddc884","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":1},"clapCount":18,"allowResponses":true,"isLimitedState":false,"title":"Detecting Cobalt Strike Beacons","isSeries":false,"sequence":null,"uniqueSlug":"detecting-cobalt-strike-beacons-3f8c9fdcb654","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1645383739547,"readingTime":5.142452830188679,"previewContent":{"__typename":"PreviewContent","subtitle":"Introduction"},"previewImage":{"__ref":"ImageMetadata:1*z9_8-93FyPoiXT7JAXpwZQ.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1645344392081,"updatedAt":1645843624918,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:3f8c9fdcb654-viewerId:lo_8e1f5a050396"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:edr"},{"__ref":"Tag:cobalt-strike"},{"__ref":"Tag:wazuh"},{"__ref":"Tag:soar"},{"__ref":"Tag:threat-intelligence"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1005,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3b1640aff8e105',t:'MTczNDQ4MjI3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3b1640aff8e105","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>