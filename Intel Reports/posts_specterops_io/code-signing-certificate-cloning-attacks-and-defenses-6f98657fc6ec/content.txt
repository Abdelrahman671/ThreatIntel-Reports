<!doctype html><html lang="en"><head><title data-rh="true">Code Signing Certificate Cloning Attacks and Defenses | by Matt Graeber | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2019-10-10T18:05:37.409Z"/><meta data-rh="true" name="title" content="Code Signing Certificate Cloning Attacks and Defenses | by Matt Graeber | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="Code Signing Certificate Cloning Attacks and Defenses"/><meta data-rh="true" property="al:android:url" content="medium://p/6f98657fc6ec"/><meta data-rh="true" property="al:ios:url" content="medium://p/6f98657fc6ec"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any vendor for that matter)?” Imagine you’re working in a SOC…"/><meta data-rh="true" property="og:description" content="Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any…"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*fLrpueTtcZk_Gx5qOIxvsA.png"/><meta data-rh="true" property="article:author" content="https://mattifestation.medium.com"/><meta data-rh="true" name="author" content="Matt Graeber"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Code Signing Certificate Cloning Attacks and Defenses"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/6f98657fc6ec"/><meta data-rh="true" property="twitter:description" content="Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*fLrpueTtcZk_Gx5qOIxvsA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*D-FDlfkqivRBQZoESrwtqw.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://mattifestation.medium.com"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/6f98657fc6ec"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*fLrpueTtcZk_Gx5qOIxvsA.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","dateCreated":"2017-12-22T14:50:40.211Z","datePublished":"2017-12-22T14:50:40.211Z","dateModified":"2019-10-10T18:05:37.788Z","headline":"Code Signing Certificate Cloning Attacks and Defenses","name":"Code Signing Certificate Cloning Attacks and Defenses","description":"Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any vendor for that matter)?” Imagine you’re working in a SOC…","identifier":"6f98657fc6ec","author":{"@type":"Person","name":"Matt Graeber","url":"https:\u002F\u002Fmattifestation.medium.com"},"creator":["Matt Graeber"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:298\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"}</script><style type="text/css" data-fela-rehydration="535" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="535" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(128, 128, 183, 1)}.es{border-color:rgba(128, 128, 183, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(128, 128, 183, 1)}.ez:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(128, 128, 183, 1)}.iu{fill:rgba(128, 128, 183, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{margin-left:4px}.lr{margin-top:0px}.ls{opacity:1}.lt{padding:4px 0}.lw{width:16px}.ly{display:inline-flex}.me{max-width:100%}.mf{padding:8px 2px}.mg svg{color:#6B6B6B}.mx{line-height:1.58}.my{letter-spacing:-0.004em}.mz{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nu{margin-bottom:-0.46em}.nv{font-style:italic}.nw{line-height:1.12}.nx{letter-spacing:-0.022em}.ny{font-weight:600}.ot{margin-bottom:-0.28em}.oz{text-decoration:underline}.pf{overflow-x:auto}.pg{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.ph{padding:20px}.pi{border-radius:0}.pj{background:#F2F2F2}.pk{line-height:1.18}.pl{margin-top:-0.09em}.pm{margin-bottom:-0.09em}.pn{min-width:fit-content}.po{list-style-type:decimal}.pp{margin-left:30px}.pq{padding-left:0px}.pw{margin-top:32px}.px{margin-bottom:14px}.py{padding-top:24px}.pz{padding-bottom:10px}.qa{background-color:#000000}.qb{height:3px}.qc{width:3px}.qd{margin-right:20px}.qj{clear:both}.qk{margin:auto}.ql{padding-bottom:56.206088992974244%}.qm{height:0}.qn{margin-top:10px}.qo{max-width:728px}.qp{margin-left:auto}.qq{margin-right:auto}.qt{padding-bottom:100%}.qu{margin-top:0.91em}.qv{max-width:1197px}.qx{cursor:zoom-in}.qy{z-index:auto}.ra{height:auto}.rb{max-width:1596px}.rc{max-width:775px}.rd{margin-bottom:26px}.re{margin-top:6px}.rf{margin-top:8px}.rg{margin-right:8px}.rh{padding:8px 16px}.ri{border-radius:100px}.rj{transition:background 300ms ease}.rl{white-space:nowrap}.rm{border-top:none}.rs{height:52px}.rt{max-height:52px}.ru{box-sizing:content-box}.rv{position:static}.rx{max-width:155px}.si{align-items:flex-end}.sj{width:76px}.sk{height:76px}.sl{border:2px solid #F9F9F9}.sm{height:72px}.sn{width:72px}.so{margin-left:-16px}.sp{width:36px}.sq{height:36px}.sr{stroke:#F2F2F2}.ss{color:#F2F2F2}.st{fill:#F2F2F2}.su{border-color:#F2F2F2}.ta{font-weight:500}.tb{font-size:24px}.tc{line-height:30px}.td{letter-spacing:-0.016em}.te{margin-top:16px}.tf{height:0px}.tg{border-bottom:solid 1px #E5E5E5}.tm{margin-top:72px}.tn{padding:24px 0}.to{margin-bottom:0px}.tp{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(110, 110, 154, 1)}.eu:hover{border-color:rgba(110, 110, 154, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.iw:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.lu:hover{fill:#000000}.lv:hover p{color:#000000}.lx:hover{color:#000000}.mh:hover svg{color:#000000}.rk:hover{background-color:#F2F2F2}.sv:hover{background:#F2F2F2}.sw:hover{border-color:#F2F2F2}.sx:hover{cursor:wait}.sy:hover{color:#F2F2F2}.sz:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mi:focus svg{color:#000000}.qz:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.md{margin:0}.nq{font-size:20px}.nr{margin-top:2.14em}.ns{line-height:32px}.nt{letter-spacing:-0.003em}.op{font-size:24px}.oq{margin-top:1.95em}.or{line-height:30px}.os{letter-spacing:-0.016em}.oy{margin-top:0.94em}.pe{margin-top:56px}.pv{margin-top:1.14em}.qi{margin-top:1.25em}.rr{margin-bottom:88px}.sc{display:inline-block}.sh{padding-top:72px}.tl{margin-top:40px}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.qr{margin-left:auto}.qs{text-align:center}.sb{display:inline-block}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.sa{display:inline-block}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.rz{display:inline-block}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.lz{margin:0}.mj{border:1px solid #F2F2F2}.mk{border-radius:99em}.ml{padding:0px 16px 0px 12px}.mm{height:38px}.mn{align-items:center}.mp svg{margin-right:8px}.na{font-size:18px}.nb{margin-top:1.56em}.nc{line-height:28px}.nd{letter-spacing:-0.003em}.nz{font-size:20px}.oa{margin-top:1.2em}.ob{line-height:24px}.oc{letter-spacing:0}.ou{margin-top:0.67em}.pa{margin-top:40px}.pr{margin-top:1.34em}.qe{margin-top:0.93em}.rn{margin-bottom:80px}.ry{display:inline-block}.sd{padding-top:48px}.th{margin-top:32px}.mo:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mc{margin:0}.nm{font-size:20px}.nn{margin-top:2.14em}.no{line-height:32px}.np{letter-spacing:-0.003em}.ol{font-size:24px}.om{margin-top:1.95em}.on{line-height:30px}.oo{letter-spacing:-0.016em}.ox{margin-top:0.94em}.pd{margin-top:56px}.pu{margin-top:1.14em}.qh{margin-top:1.25em}.rq{margin-bottom:88px}.sg{padding-top:72px}.tk{margin-top:40px}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.mb{margin:0}.ni{font-size:20px}.nj{margin-top:2.14em}.nk{line-height:32px}.nl{letter-spacing:-0.003em}.oh{font-size:24px}.oi{margin-top:1.95em}.oj{line-height:30px}.ok{letter-spacing:-0.016em}.ow{margin-top:0.94em}.pc{margin-top:56px}.pt{margin-top:1.14em}.qg{margin-top:1.25em}.rp{margin-bottom:88px}.sf{padding-top:72px}.tj{margin-top:40px}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.ma{margin:0}.mq{border:1px solid #F2F2F2}.mr{border-radius:99em}.ms{padding:0px 16px 0px 12px}.mt{height:38px}.mu{align-items:center}.mw svg{margin-right:8px}.ne{font-size:18px}.nf{margin-top:1.56em}.ng{line-height:28px}.nh{letter-spacing:-0.003em}.od{font-size:20px}.oe{margin-top:1.2em}.of{line-height:24px}.og{letter-spacing:0}.ov{margin-top:0.67em}.pb{margin-top:40px}.ps{margin-top:1.34em}.qf{margin-top:0.93em}.ro{margin-bottom:80px}.se{padding-top:48px}.ti{margin-top:32px}.mv:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="print">.rw{display:none}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="535" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.qw{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F6f98657fc6ec&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="2be8" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Code Signing Certificate Cloning Attacks and Defenses</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a href="https://mattifestation.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="Matt Graeber" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*rzDEywT-rGMVud0vq03qfw.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener  ugc nofollow"><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><div class="l ii ij by id ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" href="https://mattifestation.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow">Matt Graeber</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=post_page-e8e64b89121----6f98657fc6ec---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Dec 22, 2017</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=-----6f98657fc6ec---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la ls lt ab q fk lu lv" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv z du"><span class="pw-responses-count lq lr">2</span></p></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lw k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=-----6f98657fc6ec---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lx" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd ly cn"><div class="l ae"><div class="ab cb"><div class="lz ma mb mc md me ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi mj mk ml mm s mn mo mp mq mr ms mt u mu mv mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi mj mk ml mm s mn mo mp mq mr ms mt u mu mv mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="5c00" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Before reading this post, ponder the following question: “What does it <em class="nv">actually </em>mean to you for something to be signed by Microsoft (or any vendor for that matter)?”</p><h1 id="9410" class="nw nx gu bf ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot bk">Introduction: SOC Analyst Autoruns Baselining Scenario</h1><p id="98e6" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">Imagine you’re working in a SOC and you’re tasked with baselining persistence entries across 40,000 hosts. You’re tasked specifically with inspecting run key persistence. You have <a class="af oz" href="https://docs.microsoft.com/en-us/sysinternals/" rel="noopener ugc nofollow" target="_blank">Sysinternals</a> deployed across the enterprise, you run <a class="af oz" href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns" rel="noopener ugc nofollow" target="_blank">Autoruns</a> across every system, and forward the results to a Splunk dashboard that allows you to easily interpret the results. The smart SOC analyst you are knows that signed Microsoft applications <a class="af oz" href="https://www.youtube.com/watch?v=AEmuhCwFL5I" rel="noopener ugc nofollow" target="_blank">can be abused</a>, so you make sure that “Microsoft” and “Windows” entries are not hidden when running autorunsc.exe. You cluster all of the common results together and start focusing on outliers in the data set. You find the following outlier on</p><p id="53b1" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">6 systems out of 40,000:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="436e" class="pk nx gu pg b io pl pm l jd pn">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run<br/>   SecurityAudit<br/>     C:\Windows Defender\MpCmdRun.exe<br/>     Microsoft Malware Protection Command Line Utility<br/>     (Verified) Microsoft Corporation<br/>     4.12.16299.15<br/>     c:\windows defender\mpcmdrun.exe<br/>     11/25/1912 5:39 AM</span></pre><p id="7a02" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">You apply the following process to determine whether the entry is benign or suspicious:</p><ol class=""><li id="3670" class="mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu po pp pq bk">You note that the binary is a verified “Microsoft Corporation” binary. Knowing that it is signed by Microsoft allows you to scrutinize it less since this particular signed binary is not known to have been abused by attackers.</li><li id="69e7" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">You Google MpCmdRun.exe and confirm that it is indeed associated with Windows Defender.</li><li id="730d" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">You enabled VirusTotal integration with Autoruns (assuming your organization has accepted that risk) and it comes back with 0 positive AV hits.</li><li id="2187" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">You’re still unsure as to why it’s an outlier but your enterprise is a large, heterogenous environment where the concept of a baselined gold image does not exist.</li><li id="62be" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">You accept that it’s an outlier but you are confident that MpCmdRun.exe isn’t being abused in the wild and you subsequently filter future hits of this hash. After all, you have many more outliers to wade through.</li></ol><p id="f53f" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Does this scenario sound familiar to anyone? Unfortunately, as much as I hate to say it, that Autoruns entry was positive evidence of compromise and you overlooked it and decided to overlook it in the future as well.</p></div></div></div><div class="ab cb pw px py pz" role="separator"><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="fa13" class="nw nx gu bf ny nz qe ob oc od qf of og oh qg oj ok ol qh on oo op qi or os ot bk">Certificate Chain Cloning and Cloned Root Trust Attacks</h1><p id="1454" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">What our SOC analyst failed to pick up on was the fact that MpCmdRun.exe was signed using a cloned Microsoft certificate chain where the attacker also trusted their cloned root certificate on the compromised victim systems. How might an attacker go about performing such an attack? The steps can be summarized as follows:</p><ol class=""><li id="20aa" class="mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu po pp pq bk">Export all certificates in a legitimate certificate chain to disk. These certificates are what you’ll be using as a template for your own cloned certificate chain.</li><li id="30e7" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Build a cloned certificate chain using the chain that was exported to disk. The <a class="af oz" href="https://docs.microsoft.com/en-us/powershell/module/pkiclient/new-selfsignedcertificate?view=win10-ps" rel="noopener ugc nofollow" target="_blank">New-SelfSignedCertificate</a> cmdlet in PowerShell has very convenient “-CloneCert” and “-Signer” parameters to enable this. Upon cloning the chain, you will be able to sign malicious code with the cloned certificate chain.</li><li id="dd21" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">You’ll also want to export the cloned root certificate as you will need to trust this certificate on the victim system in order for any of your signed, malicious code to verify properly and blend in with many security tools.</li></ol><p id="c1e2" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The following video shows the manual process of exporting the certificate chain used to sign kernel32.dll:</p><figure class="pa pb pc pd pe qj"><div class="qk jf l fj"><div class="ql qm l"></div></div><figcaption class="qn ff qo qp qq qr qs bf b bg z du">Manually exporting a legitimate Microsoft certificate chain to disk to use as a template for cloning.</figcaption></figure><p id="68b9" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Now that the Microsoft certificate chain has been exported to disk, you can now use it as a template for building a spoofed Microsoft certificate chain. The following code was used to achieve this:</p><figure class="pa pb pc pd pe qj"><div class="qk jf l fj"><div class="qt qm l"></div></div></figure><p id="f3da" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The following video demonstrates running the code above:</p><figure class="pa pb pc pd pe qj"><div class="qk jf l fj"><div class="ql qm l"></div></div></figure><p id="f7d9" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">So why does this attack work? Well, at a high level, digital signature validation relies upon the following:</p><ol class=""><li id="be56" class="mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu po pp pq bk">Integrity validation — Does the hash of the file match the signed hash in the signature? If not, the integrity of the file has been compromised and it should not be trusted.</li><li id="958f" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Certificate chain validation — Was each certificate in the chain properly issued by its parent?</li><li id="b832" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Certificate validity check — If each certificate in the chain is not timestamped, is each certificate within its stated validity time frame? If the digital signature is timestamped, validate the timestamping certificate counter-signature chain.</li><li id="366f" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Revocation check — Are any of the certificates in the chain revoked or explicitly untrusted by an administrator?</li><li id="da9e" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Root CA validation — Is the root certificate in the signer chain a trusted certificate?</li></ol><p id="3a76" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Technically, our cloned certificate chain passes all of these checks so any tool that performs signature validation (sigcheck, autoruns, procexp, AV?, etc.) will likely be fooled.</p><p id="172c" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">You may have noticed in the video, upon installation of the root certificate in the “CurrentUser” certificate store, a dialog popped up asking if you trust the certificate. If running in an elevated context, that popup will not occur. Why non-admin users are able to trust root CA certificates is beyond my comprehension. That should not be permitted in any organization.</p></div></div></div><div class="ab cb pw px py pz" role="separator"><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="8369" class="nw nx gu bf ny nz qe ob oc od qf of og oh qg oj ok ol qh on oo op qi or os ot bk">Attack Weaponization</h1><p id="53dc" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">The video above showed a demo of how to create and trust a cloned root certificate locally. Ideally, in a real-world attack scenario, you wouldn’t clone a certificate chain and sign your malicious file on a compromised system. Rather, you would build the cloned chain and sign your malicious code on an attacker system. Now, the problem remains however of how you would realistically trust the cloned CA certificate on the victim system. You could probably get away with dropping it to disk and installing it but if you wanted to be a bit stealthier, as an admin, you could install and trust the certificate directly in the registry. The following is an example of how you could use WMI to remotely install and trust a cloned root CA certificate:</p><figure class="pa pb pc pd pe qj"><div class="qk jf l fj"><div class="qt qm l"></div></div></figure><p id="bdab" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">In this example, $EncodedCertBlob is just the contents of the exported cloned root CA .cer file base64-encoded. $CertThumbprint is the thumbprint value (i.e. SHA1 hash of the certificate). So, upon installation of that certificate, any code signed with a certificate from that CA will properly validate. In this particular case, the code will additionally give the appearance of being Microsoft-signed code.</p></div></div></div><div class="ab cb pw px py pz" role="separator"><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="8a63" class="nw nx gu bf ny nz qe ob oc od qf of og oh qg oj ok ol qh on oo op qi or os ot bk">Detecting Malicious Root CA Certificate Installation</h1><p id="ffe9" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">Considering the root of this attack involves installation of a root CA certificate, this action will be the focus of building a detection. The installation of root CAs should be sufficiently uncommon such that a high-fidelity alert should be possible by monitoring the registry. Sysmon serves this purpose really well and what follows is an ideal config for catching root certificate installation:</p><figure class="pa pb pc pd pe qj"><div class="qk jf l fj"><div class="qt qm l"></div></div></figure><p id="cffb" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">When an event fires, it would look like the following:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="db70" class="pk nx gu pg b io pl pm l jd pn">Registry value set:<br/>EventType: SetValue<br/>UtcTime: 2017-12-20 17:12:11.999<br/>ProcessGuid: {7ed59fb9-99eb-5a3a-0000-00102ab1af06}<br/>ProcessId: 4404<br/>Image: C:\WINDOWS\system32\wbem\wmiprvse.exe<br/>TargetObject: HKLM\SOFTWARE\Microsoft\SystemCertificates\ROOT\Certificates\1F3D38F280635F275BE92B87CF83E40E40458400\Blob<br/>Details: Binary Data</span></pre><p id="0f5c" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Using this rule set, you will likely get a lot of CreateKey event false positives. The high-fidelity events to pay attention to are SetValue events where the TargetObject property ends with “&lt;THUMBPRINT_VALUE&gt;\Blob” as this indicates the direct installation or modification of a root certificate binary blob. Unfortunately, as of this writing, Sysmon configurations don’t allow sufficient granularity to constrain a set of registry events to a specific EventType nor are wildcards permitted in rule entries.</p><p id="1095" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">So the next question to ask yourself would be, “how do I know if this root certificate installation is ‘malicious’?” A logical first step would be to investigate the contents of the certificate to see if anything stands out. PowerShell makes inspecting certificates really easy.</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="9f87" class="pk nx gu pg b io pl pm l jd pn">Get-ChildItem -Path Cert:\ -Recurse | Where-Object { $_.Thumbprint -eq &#x27;1F3D38F280635F275BE92B87CF83E40E40458400&#x27; } | For<br/>mat-List *</span></pre><p id="7e22" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The result of running this command might produce the following output:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="d60f" class="pk nx gu pg b io pl pm l jd pn">PSPath                   : Microsoft.PowerShell.Security\Certificate::LocalMachine\Root\1F3D38F280635F275BE92B87CF83E40E40458400<br/>PSParentPath             : Microsoft.PowerShell.Security\Certificate::LocalMachine\Root<br/>PSChildName              : 1F3D38F280635F275BE92B87CF83E40E40458400<br/>PSDrive                  : Cert<br/>PSProvider               : Microsoft.PowerShell.Security\Certificate<br/>PSIsContainer            : False<br/>EnhancedKeyUsageList     : {}<br/>DnsNameList              : {Microsoft Root Certificate Authority 2010}<br/>SendAsTrustedIssuer      : False<br/>EnrollmentPolicyEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty<br/>EnrollmentServerEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty<br/>PolicyId                 :<br/>Archived                 : False<br/>Extensions               : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,<br/>                           System.Security.Cryptography.Oid}<br/>FriendlyName             :<br/>IssuerName               : System.Security.Cryptography.X509Certificates.X500DistinguishedName<br/>NotAfter                 : 11/30/2042 9:06:37 PM<br/>NotBefore                : 12/1/2017 1:55:14 PM<br/>HasPrivateKey            : False<br/>PrivateKey               :<br/>PublicKey                : System.Security.Cryptography.X509Certificates.PublicKey<br/>RawData                  : {48, 130, 5, 219...}<br/>SerialNumber             : 52761736EEA4458142453E2D73FA89B2<br/>SubjectName              : System.Security.Cryptography.X509Certificates.X500DistinguishedName<br/>SignatureAlgorithm       : System.Security.Cryptography.Oid<br/>Thumbprint               : 1F3D38F280635F275BE92B87CF83E40E40458400<br/>Version                  : 3<br/>Handle                   : 1849876297952<br/>Issuer                   : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US<br/>Subject                  : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US</span></pre><p id="e99d" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">To any observer, this certificate definitely has the “look and feel” of a legitimate certificate but what is it exactly that makes a certificate “legitimate” or trusted? That process will be described in the last section of the post.</p></div></div></div><div class="ab cb pw px py pz" role="separator"><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="74bb" class="nw nx gu bf ny nz qe ob oc od qf of og oh qg oj ok ol qh on oo op qi or os ot bk">Preventing Malicious “CurrentUser” Root CA Certificate Installation</h1><p id="2041" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">In the video demonstrating the root CA installation, it was performed in the current user context. While there may not be strong preventative mitigations for certificate installation as an admin, it is possible to prevent root certificate installation in the current user context by setting the following registry value:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="e49d" class="pk nx gu pg b io pl pm l jd pn">HKLM\SOFTWARE\Policies\Microsoft\SystemCertificates\Root\ProtectedRoots - Flags (REG_DWORD) - 1</span></pre><p id="42a8" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">While this registry key is not well documented <a class="af oz" href="https://technet.microsoft.com/en-us/library/cc783813(v=ws.10).aspx" rel="noopener ugc nofollow" target="_blank">online</a>, wincrypt.h in the Windows SDK provides some contextual clues regarding the options available to set in the “Flags” value. The following relevant flag values are documented in the header file:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="1bd8" class="pk nx gu pg b io pl pm l jd pn">// Set the following flag to inhibit the opening of the CurrentUser&#x27;s<br/>// .Default physical store when opening the CurrentUser&#x27;s &quot;Root&quot; system store.<br/>// The .Default physical store open&#x27;s the CurrentUser SystemRegistry &quot;Root&quot;<br/>// store.<br/>#define CERT_PROT_ROOT_DISABLE_CURRENT_USER_FLAG    0x1</span><span id="0cc6" class="pk nx gu pg b io qu pm l jd pn">// Set the following flag to inhibit the adding of roots from the<br/>// CurrentUser SystemRegistry &quot;Root&quot; store to the protected root list<br/>// when the &quot;Root&quot; store is initially protected.<br/>#define CERT_PROT_ROOT_INHIBIT_ADD_AT_INIT_FLAG     0x2</span></pre><p id="84b2" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">After setting this key, you will get an access denied error when attempting to install a root CA to the CurrentUser Root certificate store.</p><figure class="pa pb pc pd pe qj qp qq paragraph-image"><div role="button" tabindex="0" class="qw qx fj qy bh qz"><div class="qp qq qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pe1OeWP-UySRMW4aWa4jJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Pe1OeWP-UySRMW4aWa4jJQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Pe1OeWP-UySRMW4aWa4jJQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Pe1OeWP-UySRMW4aWa4jJQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Pe1OeWP-UySRMW4aWa4jJQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Pe1OeWP-UySRMW4aWa4jJQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Pe1OeWP-UySRMW4aWa4jJQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Pe1OeWP-UySRMW4aWa4jJQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me ra c" width="700" height="288" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5e6f" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">So while not the most robust of preventative techniques, preventing non-admin users from trusting their own root CAs is certainly a strong policy to enforce in your organization.</p><p id="4f51" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">As with any enforced preventative measure, an admin will need to consider “what might this break in my environment?” As with any preventative measure, it is important to roll them out in phases across an environment. If for whatever reason there is a business justification for permitting any user to trust a root certificate, you accept that an attacker or rogue software can trust arbitrary root certificates as well. Windows administrators will always have the ability to push trusted root certificates <a class="af oz" href="https://technet.microsoft.com/en-us/library/cc754841(v=ws.11).aspx" rel="noopener ugc nofollow" target="_blank">via Group Policy</a>. A recent case where software installed its own root certificate without alerting the user was a <a class="af oz" href="https://www.bleepingcomputer.com/news/security/popular-usb-audio-driver-ships-with-root-certificate-big-security-no-no/" rel="noopener ugc nofollow" target="_blank">Savitech audio driver</a>. In this case, you would have needed to be admin to trust this root certificate but arbitrary root certificates have no basis for the establishment of trust compared to the arduous steps required to get your root certificate <a class="af oz" href="https://technet.microsoft.com/en-us/library/cc751157.aspx" rel="noopener ugc nofollow" target="_blank">trusted by Microsoft</a>.</p></div></div></div><div class="ab cb pw px py pz" role="separator"><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="f682" class="nw nx gu bf ny nz qe ob oc od qf of og oh qg oj ok ol qh on oo op qi or os ot bk">Proper Validation of Root CA Trust</h1><p id="a45a" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">Until recently, I had actually never considered the way in which the trust of certificates could be validated until version 2.60 of <a class="af oz" href="https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck" rel="noopener ugc nofollow" target="_blank">sigcheck</a> was released and the introduced the -v switch for use with -t or -tu:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="a018" class="pk nx gu pg b io pl pm l jd pn">-t[u][v]   Dump contents of specified certificate store (&#x27;*&#x27; for all stores). Specify -tu to query the user store (machine store is the default). Append &#x27;-v&#x27; to have Sigcheck download the trusted Microsoft root certificate list and only output valid certificates not rooted to a certificate on that list. If the site is not accessible, authrootstl.cab or authroot.stl in the current directory are used instead, if present.</span></pre><p id="cd25" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Here is some example output:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="e7c1" class="pk nx gu pg b io pl pm l jd pn">sigcheck64.exe -tuv -nobanner</span><span id="30f5" class="pk nx gu pg b io qu pm l jd pn">User\Root:<br/>  Microsoft Root Certificate Authority 2010<br/>     Cert Status:    Valid<br/>     Valid Usage:    All<br/>     Cert Issuer:    Microsoft Root Certificate Authority 2010<br/>     Serial Number:  52 76 17 36 EE A4 45 81 42 45 3E 2D 73 FA 89 B2<br/>     Thumbprint:     1F3D38F280635F275BE92B87CF83E40E40458400<br/>     Algorithm:      sha256RSA<br/>     Valid from:     1:55 PM 12/1/2017<br/>     Valid to:       9:06 PM 11/30/2042</span></pre><p id="79f6" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">So why should this entry not be trusted? What is Microsoft’s basis for trust? The answer to that is <a class="af oz" href="http://unmitigatedrisk.com/?p=259" rel="noopener ugc nofollow" target="_blank">authroot.stl</a> — a signed, ASN.1 encoded file consisting of the root certificates that Microsoft has deemed to be trustworthy. This is equivalent to the set of root CAs that come installed by default in the operating system. Occasionally, Microsoft may update this list though (whether through addition or revocation) and distribute updates via <a class="af oz" href="http://www.download.windowsupdate.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab" rel="noopener ugc nofollow" target="_blank">this link</a>.</p><p id="2b47" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Wanting to understand the STL file format better and not necessarily wanting to rely upon sigcheck for performing root CA trust validation, I wrote a <a class="af oz" href="https://gist.github.com/mattifestation/c712e525109f786fbaf6ed576b8d2832" rel="noopener ugc nofollow" target="_blank">crude parser</a> that extracts all of the trusted certificate thumbprint values so that I could perform similar validation in a PowerShell script. In the screenshot below, you will see the “malicious” cloned root CA certificate highlighted:</p><figure class="pa pb pc pd pe qj qp qq paragraph-image"><div role="button" tabindex="0" class="qw qx fj qy bh qz"><div class="qp qq rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fLrpueTtcZk_Gx5qOIxvsA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fLrpueTtcZk_Gx5qOIxvsA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fLrpueTtcZk_Gx5qOIxvsA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fLrpueTtcZk_Gx5qOIxvsA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fLrpueTtcZk_Gx5qOIxvsA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fLrpueTtcZk_Gx5qOIxvsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fLrpueTtcZk_Gx5qOIxvsA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fLrpueTtcZk_Gx5qOIxvsA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me ra c" width="700" height="230" loading="lazy" role="presentation"/></picture></div></div></figure><p id="e1b3" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">It is also possible to parse authroot.stl with certutil.exe:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="c9e5" class="pk nx gu pg b io pl pm l jd pn">certutil -dump authroot.stl</span></pre><p id="5296" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Through parsing authroot.stl, you can also easily determine which Microsoft-specific roots are trustworthy for code signing:</p><pre class="pa pb pc pd pe pf pg ph pi ay pj bk"><span id="8cda" class="pk nx gu pg b io pl pm l jd pn">PS&gt; ls Cert:\LocalMachine\Root\ | Where-Object { ($TrustedRootHashes -contains $_.Thumbprint) -and ($_.Subject.StartsWith(&#x27;CN=Microsoft Root&#x27;)) }</span><span id="5886" class="pk nx gu pg b io qu pm l jd pn">Thumbprint : CDD4EEAE6000AC7F40C3802C171E30148030C072<br/>Subject    : CN=Microsoft Root Certificate Authority, DC=microsoft, DC=com</span><span id="ed43" class="pk nx gu pg b io qu pm l jd pn">Thumbprint : A43489159A520F0D93D032CCAF37E7FE20A8B419<br/>Subject    : CN=Microsoft Root Authority, OU=Microsoft Corporation, OU=Copyright (c) 1997 Microsoft Corp.</span><span id="c286" class="pk nx gu pg b io qu pm l jd pn">Thumbprint : 8F43288AD272F3103B6FB1428485EA3014C0BCFE<br/>Subject    : CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US</span><span id="ac59" class="pk nx gu pg b io qu pm l jd pn">Thumbprint : 3B1EFD3A66EA28B16697394703A72CA340A05BD5<br/>Subject    : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US</span></pre><p id="af6b" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">So the way in which Microsoft-signed code should ideally be validated (versus simply pulling the publisher name and validating that it chains to a “trusted” root) is to perform the following:</p><ol class=""><li id="c0a5" class="mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu po pp pq bk">Validate that the integrity of the binary has not been compromised.</li><li id="a4ad" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Validate that each certificate in the chain is valid.</li><li id="9f90" class="mx my gu mz b na pr nc nd ne ps ng nh ni pt nk nl nm pu no np nq pv ns nt nu po pp pq bk">Validate that the root certificate has one of the trusted thumbprints present in authroot.stl (listed above). An alternative to validating against authroot.stl is to call the <a class="af oz" href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa377163(v=vs.85).aspx" rel="noopener ugc nofollow" target="_blank">CertVerifyCertificateChainPolicy</a> function passing it the CERT_CHAIN_POLICY_MICROSOFT_ROOT value. Deep inside this function is basically the same array of certificate thumbprints that the root certificate will be validated against.</li></ol><p id="bbb6" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">One notable omission from authroot.stl is the Microsoft flight root certificate (thumbprint: F8DB7E1C16F1FFD4AAAD4AAD8DFF0F2445184AEB) — the issuer of certificates for Windows Insider Preview builds. Worth noting is the absence of a timestamp countersignature meaning that the signature will fail to validate beyond the certificate validity period. This was likely an intentional decision on the part of Microsoft. The lack of a MSFT timestamp would potentially make the Microsoft flight certificate chain a more viable candidate for cloning assuming a defender isn’t aware of what would be considered a “trusted” root certificate thumbprint. Here’s an example of kernel32.dll signed by a certificate issued by the Microsoft flight root:</p><figure class="pa pb pc pd pe qj qp qq paragraph-image"><div role="button" tabindex="0" class="qw qx fj qy bh qz"><div class="qp qq rc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3toLhPm3VGMpDEl36JE3dg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3toLhPm3VGMpDEl36JE3dg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3toLhPm3VGMpDEl36JE3dg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3toLhPm3VGMpDEl36JE3dg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3toLhPm3VGMpDEl36JE3dg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3toLhPm3VGMpDEl36JE3dg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3toLhPm3VGMpDEl36JE3dg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3toLhPm3VGMpDEl36JE3dg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh me ra c" width="700" height="1246" loading="lazy" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb pw px py pz" role="separator"><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc qd"></span><span class="qa by bm qb qc"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="a2df" class="nw nx gu bf ny nz qe ob oc od qf of og oh qg oj ok ol qh on oo op qi or os ot bk">Conclusion</h1><p id="1a3b" class="pw-post-body-paragraph mx my gu mz b na ou nc nd ne ov ng nh ni ow nk nl nm ox no np nq oy ns nt nu gn bk">Hopefully, by now you have a better appreciation of how attackers can appear to originate from the code signer of their choosing. This isn’t the only signing attack that would permit this, however. I’ve also published related research on how to <a class="af oz" href="https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf" rel="noopener ugc nofollow" target="_blank">hijack Subject Interface Packages</a> that effectively allows you to apply legitimate digital signatures to malicious code that passes integrity validation checks.</p><p id="e186" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">The purpose of all of this research is twofold: to help encourage defenders and security vendors to challenge assumptions made in their investigative processes but to also educate on the importance of proper code signing validation for the purposes of determining whether any given signed code <em class="nv">actually </em>originates from who it claims to originate from.</p><p id="4345" class="pw-post-body-paragraph mx my gu mz b na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu gn bk">Lastly, an astute reader will have noted that there may have been additional anomalies associated with the cloned certificate chain and signed code. I’ll leave discussion of these anomalies for another blog post. See you in 2018!</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rd re ab ja"><div class="rf ab"><a class="rg ay am ao" href="https://medium.com/tag/security?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><div class="rh fj cx ri ge rj rk bf b bg z bk rl">Security</div></a></div><div class="rf ab"><a class="rg ay am ao" href="https://medium.com/tag/code-signing?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><div class="rh fj cx ri ge rj rk bf b bg z bk rl">Code Signing</div></a></div></div></div></div><div class="l"></div><footer class="rm rn ro rp rq rr rs rt ru ab q rv ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rw"><div class="ab q kv"><div class="rx l"><span class="l ry rz sa e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=-----6f98657fc6ec---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f sb sc"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=-----6f98657fc6ec---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la ls lt ab q fk lu lv" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z du"><span class="pw-responses-count lq lr">2</span></p></button></div></div></div></div><div class="ab q"><div class="qd l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F6f98657fc6ec&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;source=--------------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lx" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qd l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al mf an ao ap ex mg mh lv mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sd se sf sg sh l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab si cp"><div class="ab ia"><a href="https://mattifestation.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><div class="l sj sk by sl ie"><div class="l fj"><img alt="Matt Graeber" class="l fd by sm sn cx" src="https://miro.medium.com/v2/resize:fill:144:144/1*rzDEywT-rGMVud0vq03qfw.jpeg" width="72" height="72" loading="lazy"/><div class="if by l sm sn fs n ig ft"></div></div></div></a><a href="https://posts.specterops.io/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><div class="so ab fj"><div><div class="bm" aria-hidden="false"><div class="l sp sq by sl ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*D-FDlfkqivRBQZoESrwtqw.png" width="32" height="32" loading="lazy"/><div class="if by l bz ca fs n ig ft"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><a class="bf b bg z ep rh eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=post_page-e8e64b89121----6f98657fc6ec---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7db304d15601&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;newsletterV3=e8e64b89121&amp;newsletterV3Id=7db304d15601&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=-----6f98657fc6ec---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z ss am st pj su sv sw sx sy sz ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="sr sq sp"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" href="https://mattifestation.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf ta tb tc td bk"><span class="gn jo">Written by <!-- -->Matt Graeber</span></h2></a></div><div class="rf ab"><div class="l ix"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://mattifestation.medium.com/followers?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow">634 Followers</a></span></div><div class="bf b bg z jf jg jh ab jj jk jl jm du jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><span class="l ix">Writer for </span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" href="https://posts.specterops.io/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div></div><div class="te l"><p class="bf b bg z bk"><span class="gn">Threat Researcher</span></p></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z ep rh eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fe8e64b89121&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=post_page-e8e64b89121----6f98657fc6ec---------------------follow_profile-----------" rel="noopener follow">Follow</a></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2F7db304d15601&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec&amp;newsletterV3=e8e64b89121&amp;newsletterV3Id=7db304d15601&amp;user=Matt+Graeber&amp;userId=e8e64b89121&amp;source=-----6f98657fc6ec---------------------subscribe_user-----------" rel="noopener follow"><button class="bf b bg z ss am st pj su sv sw sx sy sz ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="sr sq sp"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="tf bh tg th ti tj tk tl"></div></div></div><div class="h k j"><div class="tf bh tg tm"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="tn ab kv ja"><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="to tp l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="to l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----6f98657fc6ec--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-6f98657fc6ec","user-e8e64b89121","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"14f470f2-6ec7-4a3b-b470-44d31948c926","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-923862870d9173bd7aa1b71348358148-8c9e83ce45510906-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_indexeddb","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_nia_v01","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber"}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"postResult({\"id\":\"6f98657fc6ec\"})":{"__ref":"Post:6f98657fc6ec"}},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"googleAnalyticsId":"UA-102239211-2","editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:74ad66811b78"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:70f84c574024"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f4ab382d41"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1bb43103a9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b9c2df322eaf"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b206c297df42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d59f95c1ed1c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6e849bed7683"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9bef3c9a8b49"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:10eca8f7a844"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d248a36145f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:2562fc45d9a9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:645ffcef8682"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a041d7ac11fe"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:507d73de7b97"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:e7dfc7678b59"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ff850017e32a"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4d7214ceeaf8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:760e415ea3c9"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:f95d89c4ba81"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:59a56792287a"}}],"name":"Posts By SpecterOps Team Members","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"domain":"posts.specterops.io","slug":"specter-ops-posts","description":"Posts from SpecterOps team members on various topics relating information security","subscriberCount":4702,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__typename":"Post","title":"Closing the Gaps: How Attack Path Management Improves Vulnerability Management Programs","latestPublishedAt":1727878988539}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_7a5ba9904195"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"User:74ad66811b78":{"__typename":"User","id":"74ad66811b78"},"User:70f84c574024":{"__typename":"User","id":"70f84c574024"},"User:f4ab382d41":{"__typename":"User","id":"f4ab382d41"},"User:1bb43103a9a9":{"__typename":"User","id":"1bb43103a9a9"},"User:b9c2df322eaf":{"__typename":"User","id":"b9c2df322eaf"},"User:b206c297df42":{"__typename":"User","id":"b206c297df42"},"User:d59f95c1ed1c":{"__typename":"User","id":"d59f95c1ed1c"},"User:6e849bed7683":{"__typename":"User","id":"6e849bed7683"},"User:9bef3c9a8b49":{"__typename":"User","id":"9bef3c9a8b49"},"User:10eca8f7a844":{"__typename":"User","id":"10eca8f7a844"},"User:d248a36145f8":{"__typename":"User","id":"d248a36145f8"},"User:2562fc45d9a9":{"__typename":"User","id":"2562fc45d9a9"},"User:645ffcef8682":{"__typename":"User","id":"645ffcef8682"},"User:a041d7ac11fe":{"__typename":"User","id":"a041d7ac11fe"},"User:507d73de7b97":{"__typename":"User","id":"507d73de7b97"},"User:e7dfc7678b59":{"__typename":"User","id":"e7dfc7678b59"},"User:ff850017e32a":{"__typename":"User","id":"ff850017e32a"},"User:4d7214ceeaf8":{"__typename":"User","id":"4d7214ceeaf8"},"User:760e415ea3c9":{"__typename":"User","id":"760e415ea3c9"},"User:f95d89c4ba81":{"__typename":"User","id":"f95d89c4ba81"},"User:59a56792287a":{"__typename":"User","id":"59a56792287a"},"LinkedAccounts:e8e64b89121":{"__typename":"LinkedAccounts","mastodon":null,"id":"e8e64b89121"},"UserViewerEdge:userId:e8e64b89121-viewerId:lo_7a5ba9904195":{"__typename":"UserViewerEdge","id":"userId:e8e64b89121-viewerId:lo_7a5ba9904195","isFollowing":false,"isUser":false,"isMuting":false},"NewsletterV3:7db304d15601":{"__typename":"NewsletterV3","id":"7db304d15601","type":"NEWSLETTER_TYPE_AUTHOR","slug":"e8e64b89121","name":"e8e64b89121","collection":null,"user":{"__ref":"User:e8e64b89121"}},"User:e8e64b89121":{"__typename":"User","id":"e8e64b89121","name":"Matt Graeber","username":"mattifestation","newsletterV3":{"__ref":"NewsletterV3:7db304d15601"},"linkedAccounts":{"__ref":"LinkedAccounts:e8e64b89121"},"isSuspended":false,"imageId":"1*rzDEywT-rGMVud0vq03qfw.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":634},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"mattifestation.medium.com"}},"hasSubdomain":true,"bio":"Threat Researcher","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:e8e64b89121-viewerId:lo_7a5ba9904195"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":""},"Paragraph:907ef7ba0dfe_0":{"__typename":"Paragraph","id":"907ef7ba0dfe_0","name":"2be8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Code Signing Certificate Cloning Attacks and Defenses","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_1":{"__typename":"Paragraph","id":"907ef7ba0dfe_1","name":"5c00","type":"P","href":null,"layout":null,"metadata":null,"text":"Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any vendor for that matter)?”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":71,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_2":{"__typename":"Paragraph","id":"907ef7ba0dfe_2","name":"9410","type":"H3","href":null,"layout":null,"metadata":null,"text":"Introduction: SOC Analyst Autoruns Baselining Scenario","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_3":{"__typename":"Paragraph","id":"907ef7ba0dfe_3","name":"98e6","type":"P","href":null,"layout":null,"metadata":null,"text":"Imagine you’re working in a SOC and you’re tasked with baselining persistence entries across 40,000 hosts. You’re tasked specifically with inspecting run key persistence. You have Sysinternals deployed across the enterprise, you run Autoruns across every system, and forward the results to a Splunk dashboard that allows you to easily interpret the results. The smart SOC analyst you are knows that signed Microsoft applications can be abused, so you make sure that “Microsoft” and “Windows” entries are not hidden when running autorunsc.exe. You cluster all of the common results together and start focusing on outliers in the data set. You find the following outlier on","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":180,"end":192,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":233,"end":241,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fautoruns","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":429,"end":442,"href":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=AEmuhCwFL5I","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_4":{"__typename":"Paragraph","id":"907ef7ba0dfe_4","name":"53b1","type":"P","href":null,"layout":null,"metadata":null,"text":"6 systems out of 40,000:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_5":{"__typename":"Paragraph","id":"907ef7ba0dfe_5","name":"436e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n   SecurityAudit\n     C:\\Windows Defender\\MpCmdRun.exe\n     Microsoft Malware Protection Command Line Utility\n     (Verified) Microsoft Corporation\n     4.12.16299.15\n     c:\\windows defender\\mpcmdrun.exe\n     11\u002F25\u002F1912 5:39 AM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_6":{"__typename":"Paragraph","id":"907ef7ba0dfe_6","name":"7a02","type":"P","href":null,"layout":null,"metadata":null,"text":"You apply the following process to determine whether the entry is benign or suspicious:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_7":{"__typename":"Paragraph","id":"907ef7ba0dfe_7","name":"3670","type":"OLI","href":null,"layout":null,"metadata":null,"text":"You note that the binary is a verified “Microsoft Corporation” binary. Knowing that it is signed by Microsoft allows you to scrutinize it less since this particular signed binary is not known to have been abused by attackers.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_8":{"__typename":"Paragraph","id":"907ef7ba0dfe_8","name":"69e7","type":"OLI","href":null,"layout":null,"metadata":null,"text":"You Google MpCmdRun.exe and confirm that it is indeed associated with Windows Defender.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_9":{"__typename":"Paragraph","id":"907ef7ba0dfe_9","name":"730d","type":"OLI","href":null,"layout":null,"metadata":null,"text":"You enabled VirusTotal integration with Autoruns (assuming your organization has accepted that risk) and it comes back with 0 positive AV hits.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_10":{"__typename":"Paragraph","id":"907ef7ba0dfe_10","name":"2187","type":"OLI","href":null,"layout":null,"metadata":null,"text":"You’re still unsure as to why it’s an outlier but your enterprise is a large, heterogenous environment where the concept of a baselined gold image does not exist.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_11":{"__typename":"Paragraph","id":"907ef7ba0dfe_11","name":"62be","type":"OLI","href":null,"layout":null,"metadata":null,"text":"You accept that it’s an outlier but you are confident that MpCmdRun.exe isn’t being abused in the wild and you subsequently filter future hits of this hash. After all, you have many more outliers to wade through.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_12":{"__typename":"Paragraph","id":"907ef7ba0dfe_12","name":"f53f","type":"P","href":null,"layout":null,"metadata":null,"text":"Does this scenario sound familiar to anyone? Unfortunately, as much as I hate to say it, that Autoruns entry was positive evidence of compromise and you overlooked it and decided to overlook it in the future as well.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_13":{"__typename":"Paragraph","id":"907ef7ba0dfe_13","name":"fa13","type":"H3","href":null,"layout":null,"metadata":null,"text":"Certificate Chain Cloning and Cloned Root Trust Attacks","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_14":{"__typename":"Paragraph","id":"907ef7ba0dfe_14","name":"1454","type":"P","href":null,"layout":null,"metadata":null,"text":"What our SOC analyst failed to pick up on was the fact that MpCmdRun.exe was signed using a cloned Microsoft certificate chain where the attacker also trusted their cloned root certificate on the compromised victim systems. How might an attacker go about performing such an attack? The steps can be summarized as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_15":{"__typename":"Paragraph","id":"907ef7ba0dfe_15","name":"20aa","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Export all certificates in a legitimate certificate chain to disk. These certificates are what you’ll be using as a template for your own cloned certificate chain.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_16":{"__typename":"Paragraph","id":"907ef7ba0dfe_16","name":"30e7","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Build a cloned certificate chain using the chain that was exported to disk. The New-SelfSignedCertificate cmdlet in PowerShell has very convenient “-CloneCert” and “-Signer” parameters to enable this. Upon cloning the chain, you will be able to sign malicious code with the cloned certificate chain.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":80,"end":105,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fpowershell\u002Fmodule\u002Fpkiclient\u002Fnew-selfsignedcertificate?view=win10-ps","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_17":{"__typename":"Paragraph","id":"907ef7ba0dfe_17","name":"dd21","type":"OLI","href":null,"layout":null,"metadata":null,"text":"You’ll also want to export the cloned root certificate as you will need to trust this certificate on the victim system in order for any of your signed, malicious code to verify properly and blend in with many security tools.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_18":{"__typename":"Paragraph","id":"907ef7ba0dfe_18","name":"c1e2","type":"P","href":null,"layout":null,"metadata":null,"text":"The following video shows the manual process of exporting the certificate chain used to sign kernel32.dll:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:275b3e484a7237fec0d268e976cce2b8":{"__typename":"MediaResource","id":"275b3e484a7237fec0d268e976cce2b8","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2F5rjJnxl50Dg%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3D5rjJnxl50Dg&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2F5rjJnxl50Dg%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube","iframeHeight":480,"iframeWidth":854,"title":"Exporting a Certificate Chain to Disk"},"Paragraph:907ef7ba0dfe_19":{"__typename":"Paragraph","id":"907ef7ba0dfe_19","name":"cefb","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Manually exporting a legitimate Microsoft certificate chain to disk to use as a template for cloning.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:275b3e484a7237fec0d268e976cce2b8"}},"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_20":{"__typename":"Paragraph","id":"907ef7ba0dfe_20","name":"68b9","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that the Microsoft certificate chain has been exported to disk, you can now use it as a template for building a spoofed Microsoft certificate chain. The following code was used to achieve this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:7c50d8732cdf14b30f33ba8b6b60767b":{"__typename":"MediaResource","id":"7c50d8732cdf14b30f33ba8b6b60767b","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"The steps required to clone a legitimate certificate chain and sign code with it."},"Paragraph:907ef7ba0dfe_21":{"__typename":"Paragraph","id":"907ef7ba0dfe_21","name":"d1a5","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:7c50d8732cdf14b30f33ba8b6b60767b"}},"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_22":{"__typename":"Paragraph","id":"907ef7ba0dfe_22","name":"f3da","type":"P","href":null,"layout":null,"metadata":null,"text":"The following video demonstrates running the code above:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:999e8fd0af0d3fd8771ffa92bb19a3d7":{"__typename":"MediaResource","id":"999e8fd0af0d3fd8771ffa92bb19a3d7","iframeSrc":"https:\u002F\u002Fcdn.embedly.com\u002Fwidgets\u002Fmedia.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FqF6h2he5B7g%3Ffeature%3Doembed&url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DqF6h2he5B7g&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FqF6h2he5B7g%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07&type=text%2Fhtml&schema=youtube","iframeHeight":480,"iframeWidth":854,"title":"Cloning a Certificate Chain, Trusting the Cloned Root, and Signing Code"},"Paragraph:907ef7ba0dfe_23":{"__typename":"Paragraph","id":"907ef7ba0dfe_23","name":"8968","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:999e8fd0af0d3fd8771ffa92bb19a3d7"}},"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_24":{"__typename":"Paragraph","id":"907ef7ba0dfe_24","name":"f7d9","type":"P","href":null,"layout":null,"metadata":null,"text":"So why does this attack work? Well, at a high level, digital signature validation relies upon the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_25":{"__typename":"Paragraph","id":"907ef7ba0dfe_25","name":"be56","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Integrity validation — Does the hash of the file match the signed hash in the signature? If not, the integrity of the file has been compromised and it should not be trusted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_26":{"__typename":"Paragraph","id":"907ef7ba0dfe_26","name":"958f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Certificate chain validation — Was each certificate in the chain properly issued by its parent?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_27":{"__typename":"Paragraph","id":"907ef7ba0dfe_27","name":"b832","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Certificate validity check — If each certificate in the chain is not timestamped, is each certificate within its stated validity time frame? If the digital signature is timestamped, validate the timestamping certificate counter-signature chain.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_28":{"__typename":"Paragraph","id":"907ef7ba0dfe_28","name":"366f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Revocation check — Are any of the certificates in the chain revoked or explicitly untrusted by an administrator?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_29":{"__typename":"Paragraph","id":"907ef7ba0dfe_29","name":"da9e","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Root CA validation — Is the root certificate in the signer chain a trusted certificate?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_30":{"__typename":"Paragraph","id":"907ef7ba0dfe_30","name":"3a76","type":"P","href":null,"layout":null,"metadata":null,"text":"Technically, our cloned certificate chain passes all of these checks so any tool that performs signature validation (sigcheck, autoruns, procexp, AV?, etc.) will likely be fooled.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_31":{"__typename":"Paragraph","id":"907ef7ba0dfe_31","name":"172c","type":"P","href":null,"layout":null,"metadata":null,"text":"You may have noticed in the video, upon installation of the root certificate in the “CurrentUser” certificate store, a dialog popped up asking if you trust the certificate. If running in an elevated context, that popup will not occur. Why non-admin users are able to trust root CA certificates is beyond my comprehension. That should not be permitted in any organization.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_32":{"__typename":"Paragraph","id":"907ef7ba0dfe_32","name":"8369","type":"H3","href":null,"layout":null,"metadata":null,"text":"Attack Weaponization","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_33":{"__typename":"Paragraph","id":"907ef7ba0dfe_33","name":"53dc","type":"P","href":null,"layout":null,"metadata":null,"text":"The video above showed a demo of how to create and trust a cloned root certificate locally. Ideally, in a real-world attack scenario, you wouldn’t clone a certificate chain and sign your malicious file on a compromised system. Rather, you would build the cloned chain and sign your malicious code on an attacker system. Now, the problem remains however of how you would realistically trust the cloned CA certificate on the victim system. You could probably get away with dropping it to disk and installing it but if you wanted to be a bit stealthier, as an admin, you could install and trust the certificate directly in the registry. The following is an example of how you could use WMI to remotely install and trust a cloned root CA certificate:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:7c9690ac8588ca4a9f1c5e276c999457":{"__typename":"MediaResource","id":"7c9690ac8588ca4a9f1c5e276c999457","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"An example weaponization of trusting a cloned MSFT root CA certificate by installing directly into the registry"},"Paragraph:907ef7ba0dfe_34":{"__typename":"Paragraph","id":"907ef7ba0dfe_34","name":"d4bd","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:7c9690ac8588ca4a9f1c5e276c999457"}},"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_35":{"__typename":"Paragraph","id":"907ef7ba0dfe_35","name":"bdab","type":"P","href":null,"layout":null,"metadata":null,"text":"In this example, $EncodedCertBlob is just the contents of the exported cloned root CA .cer file base64-encoded. $CertThumbprint is the thumbprint value (i.e. SHA1 hash of the certificate). So, upon installation of that certificate, any code signed with a certificate from that CA will properly validate. In this particular case, the code will additionally give the appearance of being Microsoft-signed code.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_36":{"__typename":"Paragraph","id":"907ef7ba0dfe_36","name":"8a63","type":"H3","href":null,"layout":null,"metadata":null,"text":"Detecting Malicious Root CA Certificate Installation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_37":{"__typename":"Paragraph","id":"907ef7ba0dfe_37","name":"ffe9","type":"P","href":null,"layout":null,"metadata":null,"text":"Considering the root of this attack involves installation of a root CA certificate, this action will be the focus of building a detection. The installation of root CAs should be sufficiently uncommon such that a high-fidelity alert should be possible by monitoring the registry. Sysmon serves this purpose really well and what follows is an ideal config for catching root certificate installation:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:871f25e39be5a15e3421dd2158c2730e":{"__typename":"MediaResource","id":"871f25e39be5a15e3421dd2158c2730e","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":"A sample Sysmon config to detect root CA installation in both the LocalMachine and CurrentUser contexts"},"Paragraph:907ef7ba0dfe_38":{"__typename":"Paragraph","id":"907ef7ba0dfe_38","name":"bcc6","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:871f25e39be5a15e3421dd2158c2730e"}},"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_39":{"__typename":"Paragraph","id":"907ef7ba0dfe_39","name":"cffb","type":"P","href":null,"layout":null,"metadata":null,"text":"When an event fires, it would look like the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_40":{"__typename":"Paragraph","id":"907ef7ba0dfe_40","name":"db70","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Registry value set:\nEventType: SetValue\nUtcTime: 2017-12-20 17:12:11.999\nProcessGuid: {7ed59fb9-99eb-5a3a-0000-00102ab1af06}\nProcessId: 4404\nImage: C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe\nTargetObject: HKLM\\SOFTWARE\\Microsoft\\SystemCertificates\\ROOT\\Certificates\\1F3D38F280635F275BE92B87CF83E40E40458400\\Blob\nDetails: Binary Data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_41":{"__typename":"Paragraph","id":"907ef7ba0dfe_41","name":"0f5c","type":"P","href":null,"layout":null,"metadata":null,"text":"Using this rule set, you will likely get a lot of CreateKey event false positives. The high-fidelity events to pay attention to are SetValue events where the TargetObject property ends with “\u003CTHUMBPRINT_VALUE\u003E\\Blob” as this indicates the direct installation or modification of a root certificate binary blob. Unfortunately, as of this writing, Sysmon configurations don’t allow sufficient granularity to constrain a set of registry events to a specific EventType nor are wildcards permitted in rule entries.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_42":{"__typename":"Paragraph","id":"907ef7ba0dfe_42","name":"1095","type":"P","href":null,"layout":null,"metadata":null,"text":"So the next question to ask yourself would be, “how do I know if this root certificate installation is ‘malicious’?” A logical first step would be to investigate the contents of the certificate to see if anything stands out. PowerShell makes inspecting certificates really easy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_43":{"__typename":"Paragraph","id":"907ef7ba0dfe_43","name":"9f87","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Get-ChildItem -Path Cert:\\ -Recurse | Where-Object { $_.Thumbprint -eq '1F3D38F280635F275BE92B87CF83E40E40458400' } | For\nmat-List *","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_44":{"__typename":"Paragraph","id":"907ef7ba0dfe_44","name":"7e22","type":"P","href":null,"layout":null,"metadata":null,"text":"The result of running this command might produce the following output:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_45":{"__typename":"Paragraph","id":"907ef7ba0dfe_45","name":"d60f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"PSPath                   : Microsoft.PowerShell.Security\\Certificate::LocalMachine\\Root\\1F3D38F280635F275BE92B87CF83E40E40458400\nPSParentPath             : Microsoft.PowerShell.Security\\Certificate::LocalMachine\\Root\nPSChildName              : 1F3D38F280635F275BE92B87CF83E40E40458400\nPSDrive                  : Cert\nPSProvider               : Microsoft.PowerShell.Security\\Certificate\nPSIsContainer            : False\nEnhancedKeyUsageList     : {}\nDnsNameList              : {Microsoft Root Certificate Authority 2010}\nSendAsTrustedIssuer      : False\nEnrollmentPolicyEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty\nEnrollmentServerEndPoint : Microsoft.CertificateServices.Commands.EnrollmentEndPointProperty\nPolicyId                 :\nArchived                 : False\nExtensions               : {System.Security.Cryptography.Oid, System.Security.Cryptography.Oid,\n                           System.Security.Cryptography.Oid}\nFriendlyName             :\nIssuerName               : System.Security.Cryptography.X509Certificates.X500DistinguishedName\nNotAfter                 : 11\u002F30\u002F2042 9:06:37 PM\nNotBefore                : 12\u002F1\u002F2017 1:55:14 PM\nHasPrivateKey            : False\nPrivateKey               :\nPublicKey                : System.Security.Cryptography.X509Certificates.PublicKey\nRawData                  : {48, 130, 5, 219...}\nSerialNumber             : 52761736EEA4458142453E2D73FA89B2\nSubjectName              : System.Security.Cryptography.X509Certificates.X500DistinguishedName\nSignatureAlgorithm       : System.Security.Cryptography.Oid\nThumbprint               : 1F3D38F280635F275BE92B87CF83E40E40458400\nVersion                  : 3\nHandle                   : 1849876297952\nIssuer                   : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US\nSubject                  : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_46":{"__typename":"Paragraph","id":"907ef7ba0dfe_46","name":"e99d","type":"P","href":null,"layout":null,"metadata":null,"text":"To any observer, this certificate definitely has the “look and feel” of a legitimate certificate but what is it exactly that makes a certificate “legitimate” or trusted? That process will be described in the last section of the post.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_47":{"__typename":"Paragraph","id":"907ef7ba0dfe_47","name":"74bb","type":"H3","href":null,"layout":null,"metadata":null,"text":"Preventing Malicious “CurrentUser” Root CA Certificate Installation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_48":{"__typename":"Paragraph","id":"907ef7ba0dfe_48","name":"2041","type":"P","href":null,"layout":null,"metadata":null,"text":"In the video demonstrating the root CA installation, it was performed in the current user context. While there may not be strong preventative mitigations for certificate installation as an admin, it is possible to prevent root certificate installation in the current user context by setting the following registry value:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_49":{"__typename":"Paragraph","id":"907ef7ba0dfe_49","name":"e49d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"HKLM\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\ProtectedRoots - Flags (REG_DWORD) - 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_50":{"__typename":"Paragraph","id":"907ef7ba0dfe_50","name":"42a8","type":"P","href":null,"layout":null,"metadata":null,"text":"While this registry key is not well documented online, wincrypt.h in the Windows SDK provides some contextual clues regarding the options available to set in the “Flags” value. The following relevant flag values are documented in the header file:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":47,"end":53,"href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Flibrary\u002Fcc783813(v=ws.10).aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_51":{"__typename":"Paragraph","id":"907ef7ba0dfe_51","name":"1bd8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002F Set the following flag to inhibit the opening of the CurrentUser's\n\u002F\u002F .Default physical store when opening the CurrentUser's \"Root\" system store.\n\u002F\u002F The .Default physical store open's the CurrentUser SystemRegistry \"Root\"\n\u002F\u002F store.\n#define CERT_PROT_ROOT_DISABLE_CURRENT_USER_FLAG    0x1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_52":{"__typename":"Paragraph","id":"907ef7ba0dfe_52","name":"0cc6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u002F\u002F Set the following flag to inhibit the adding of roots from the\n\u002F\u002F CurrentUser SystemRegistry \"Root\" store to the protected root list\n\u002F\u002F when the \"Root\" store is initially protected.\n#define CERT_PROT_ROOT_INHIBIT_ADD_AT_INIT_FLAG     0x2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_53":{"__typename":"Paragraph","id":"907ef7ba0dfe_53","name":"84b2","type":"P","href":null,"layout":null,"metadata":null,"text":"After setting this key, you will get an access denied error when attempting to install a root CA to the CurrentUser Root certificate store.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Pe1OeWP-UySRMW4aWa4jJQ.png":{"__typename":"ImageMetadata","id":"1*Pe1OeWP-UySRMW4aWa4jJQ.png","originalHeight":491,"originalWidth":1197,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:907ef7ba0dfe_54":{"__typename":"Paragraph","id":"907ef7ba0dfe_54","name":"7bef","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Pe1OeWP-UySRMW4aWa4jJQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_55":{"__typename":"Paragraph","id":"907ef7ba0dfe_55","name":"5e6f","type":"P","href":null,"layout":null,"metadata":null,"text":"So while not the most robust of preventative techniques, preventing non-admin users from trusting their own root CAs is certainly a strong policy to enforce in your organization.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_56":{"__typename":"Paragraph","id":"907ef7ba0dfe_56","name":"4f51","type":"P","href":null,"layout":null,"metadata":null,"text":"As with any enforced preventative measure, an admin will need to consider “what might this break in my environment?” As with any preventative measure, it is important to roll them out in phases across an environment. If for whatever reason there is a business justification for permitting any user to trust a root certificate, you accept that an attacker or rogue software can trust arbitrary root certificates as well. Windows administrators will always have the ability to push trusted root certificates via Group Policy. A recent case where software installed its own root certificate without alerting the user was a Savitech audio driver. In this case, you would have needed to be admin to trust this root certificate but arbitrary root certificates have no basis for the establishment of trust compared to the arduous steps required to get your root certificate trusted by Microsoft.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":506,"end":522,"href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Flibrary\u002Fcc754841(v=ws.11).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":620,"end":641,"href":"https:\u002F\u002Fwww.bleepingcomputer.com\u002Fnews\u002Fsecurity\u002Fpopular-usb-audio-driver-ships-with-root-certificate-big-security-no-no\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":867,"end":887,"href":"https:\u002F\u002Ftechnet.microsoft.com\u002Fen-us\u002Flibrary\u002Fcc751157.aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_57":{"__typename":"Paragraph","id":"907ef7ba0dfe_57","name":"f682","type":"H3","href":null,"layout":null,"metadata":null,"text":"Proper Validation of Root CA Trust","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_58":{"__typename":"Paragraph","id":"907ef7ba0dfe_58","name":"a45a","type":"P","href":null,"layout":null,"metadata":null,"text":"Until recently, I had actually never considered the way in which the trust of certificates could be validated until version 2.60 of sigcheck was released and the introduced the -v switch for use with -t or -tu:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":132,"end":140,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fsigcheck","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_59":{"__typename":"Paragraph","id":"907ef7ba0dfe_59","name":"a018","type":"PRE","href":null,"layout":null,"metadata":null,"text":"-t[u][v]   Dump contents of specified certificate store ('*' for all stores). Specify -tu to query the user store (machine store is the default). Append '-v' to have Sigcheck download the trusted Microsoft root certificate list and only output valid certificates not rooted to a certificate on that list. If the site is not accessible, authrootstl.cab or authroot.stl in the current directory are used instead, if present.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_60":{"__typename":"Paragraph","id":"907ef7ba0dfe_60","name":"cd25","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is some example output:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_61":{"__typename":"Paragraph","id":"907ef7ba0dfe_61","name":"e7c1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sigcheck64.exe -tuv -nobanner","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_62":{"__typename":"Paragraph","id":"907ef7ba0dfe_62","name":"30f5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"User\\Root:\n  Microsoft Root Certificate Authority 2010\n     Cert Status:    Valid\n     Valid Usage:    All\n     Cert Issuer:    Microsoft Root Certificate Authority 2010\n     Serial Number:  52 76 17 36 EE A4 45 81 42 45 3E 2D 73 FA 89 B2\n     Thumbprint:     1F3D38F280635F275BE92B87CF83E40E40458400\n     Algorithm:      sha256RSA\n     Valid from:     1:55 PM 12\u002F1\u002F2017\n     Valid to:       9:06 PM 11\u002F30\u002F2042","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_63":{"__typename":"Paragraph","id":"907ef7ba0dfe_63","name":"79f6","type":"P","href":null,"layout":null,"metadata":null,"text":"So why should this entry not be trusted? What is Microsoft’s basis for trust? The answer to that is authroot.stl — a signed, ASN.1 encoded file consisting of the root certificates that Microsoft has deemed to be trustworthy. This is equivalent to the set of root CAs that come installed by default in the operating system. Occasionally, Microsoft may update this list though (whether through addition or revocation) and distribute updates via this link.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":100,"end":112,"href":"http:\u002F\u002Funmitigatedrisk.com\u002F?p=259","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":443,"end":452,"href":"http:\u002F\u002Fwww.download.windowsupdate.com\u002Fmsdownload\u002Fupdate\u002Fv3\u002Fstatic\u002Ftrustedr\u002Fen\u002Fauthrootstl.cab","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_64":{"__typename":"Paragraph","id":"907ef7ba0dfe_64","name":"2b47","type":"P","href":null,"layout":null,"metadata":null,"text":"Wanting to understand the STL file format better and not necessarily wanting to rely upon sigcheck for performing root CA trust validation, I wrote a crude parser that extracts all of the trusted certificate thumbprint values so that I could perform similar validation in a PowerShell script. In the screenshot below, you will see the “malicious” cloned root CA certificate highlighted:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":150,"end":162,"href":"https:\u002F\u002Fgist.github.com\u002Fmattifestation\u002Fc712e525109f786fbaf6ed576b8d2832","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fLrpueTtcZk_Gx5qOIxvsA.png":{"__typename":"ImageMetadata","id":"1*fLrpueTtcZk_Gx5qOIxvsA.png","originalHeight":523,"originalWidth":1596,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:907ef7ba0dfe_65":{"__typename":"Paragraph","id":"907ef7ba0dfe_65","name":"cb90","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fLrpueTtcZk_Gx5qOIxvsA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_66":{"__typename":"Paragraph","id":"907ef7ba0dfe_66","name":"e1b3","type":"P","href":null,"layout":null,"metadata":null,"text":"It is also possible to parse authroot.stl with certutil.exe:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_67":{"__typename":"Paragraph","id":"907ef7ba0dfe_67","name":"c9e5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"certutil -dump authroot.stl","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_68":{"__typename":"Paragraph","id":"907ef7ba0dfe_68","name":"5296","type":"P","href":null,"layout":null,"metadata":null,"text":"Through parsing authroot.stl, you can also easily determine which Microsoft-specific roots are trustworthy for code signing:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_69":{"__typename":"Paragraph","id":"907ef7ba0dfe_69","name":"8cda","type":"PRE","href":null,"layout":null,"metadata":null,"text":"PS\u003E ls Cert:\\LocalMachine\\Root\\ | Where-Object { ($TrustedRootHashes -contains $_.Thumbprint) -and ($_.Subject.StartsWith('CN=Microsoft Root')) }","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_70":{"__typename":"Paragraph","id":"907ef7ba0dfe_70","name":"5886","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Thumbprint : CDD4EEAE6000AC7F40C3802C171E30148030C072\nSubject    : CN=Microsoft Root Certificate Authority, DC=microsoft, DC=com","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_71":{"__typename":"Paragraph","id":"907ef7ba0dfe_71","name":"ed43","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Thumbprint : A43489159A520F0D93D032CCAF37E7FE20A8B419\nSubject    : CN=Microsoft Root Authority, OU=Microsoft Corporation, OU=Copyright (c) 1997 Microsoft Corp.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_72":{"__typename":"Paragraph","id":"907ef7ba0dfe_72","name":"c286","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Thumbprint : 8F43288AD272F3103B6FB1428485EA3014C0BCFE\nSubject    : CN=Microsoft Root Certificate Authority 2011, O=Microsoft Corporation, L=Redmond, S=Washington, C=US","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_73":{"__typename":"Paragraph","id":"907ef7ba0dfe_73","name":"ac59","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Thumbprint : 3B1EFD3A66EA28B16697394703A72CA340A05BD5\nSubject    : CN=Microsoft Root Certificate Authority 2010, O=Microsoft Corporation, L=Redmond, S=Washington, C=US","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_74":{"__typename":"Paragraph","id":"907ef7ba0dfe_74","name":"af6b","type":"P","href":null,"layout":null,"metadata":null,"text":"So the way in which Microsoft-signed code should ideally be validated (versus simply pulling the publisher name and validating that it chains to a “trusted” root) is to perform the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_75":{"__typename":"Paragraph","id":"907ef7ba0dfe_75","name":"c0a5","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Validate that the integrity of the binary has not been compromised.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_76":{"__typename":"Paragraph","id":"907ef7ba0dfe_76","name":"a4ad","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Validate that each certificate in the chain is valid.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_77":{"__typename":"Paragraph","id":"907ef7ba0dfe_77","name":"9f90","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Validate that the root certificate has one of the trusted thumbprints present in authroot.stl (listed above). An alternative to validating against authroot.stl is to call the CertVerifyCertificateChainPolicy function passing it the CERT_CHAIN_POLICY_MICROSOFT_ROOT value. Deep inside this function is basically the same array of certificate thumbprints that the root certificate will be validated against.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":175,"end":207,"href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fdesktop\u002Faa377163(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_78":{"__typename":"Paragraph","id":"907ef7ba0dfe_78","name":"bbb6","type":"P","href":null,"layout":null,"metadata":null,"text":"One notable omission from authroot.stl is the Microsoft flight root certificate (thumbprint: F8DB7E1C16F1FFD4AAAD4AAD8DFF0F2445184AEB) — the issuer of certificates for Windows Insider Preview builds. Worth noting is the absence of a timestamp countersignature meaning that the signature will fail to validate beyond the certificate validity period. This was likely an intentional decision on the part of Microsoft. The lack of a MSFT timestamp would potentially make the Microsoft flight certificate chain a more viable candidate for cloning assuming a defender isn’t aware of what would be considered a “trusted” root certificate thumbprint. Here’s an example of kernel32.dll signed by a certificate issued by the Microsoft flight root:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3toLhPm3VGMpDEl36JE3dg.png":{"__typename":"ImageMetadata","id":"1*3toLhPm3VGMpDEl36JE3dg.png","originalHeight":1379,"originalWidth":775,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:907ef7ba0dfe_79":{"__typename":"Paragraph","id":"907ef7ba0dfe_79","name":"5ba6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3toLhPm3VGMpDEl36JE3dg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_80":{"__typename":"Paragraph","id":"907ef7ba0dfe_80","name":"a2df","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_81":{"__typename":"Paragraph","id":"907ef7ba0dfe_81","name":"1a3b","type":"P","href":null,"layout":null,"metadata":null,"text":"Hopefully, by now you have a better appreciation of how attackers can appear to originate from the code signer of their choosing. This isn’t the only signing attack that would permit this, however. I’ve also published related research on how to hijack Subject Interface Packages that effectively allows you to apply legitimate digital signatures to malicious code that passes integrity validation checks.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":245,"end":278,"href":"https:\u002F\u002Fspecterops.io\u002Fassets\u002Fresources\u002FSpecterOps_Subverting_Trust_in_Windows.pdf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_82":{"__typename":"Paragraph","id":"907ef7ba0dfe_82","name":"e186","type":"P","href":null,"layout":null,"metadata":null,"text":"The purpose of all of this research is twofold: to help encourage defenders and security vendors to challenge assumptions made in their investigative processes but to also educate on the importance of proper code signing validation for the purposes of determining whether any given signed code actually originates from who it claims to originate from.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":294,"end":303,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:907ef7ba0dfe_83":{"__typename":"Paragraph","id":"907ef7ba0dfe_83","name":"4345","type":"P","href":null,"layout":null,"metadata":null,"text":"Lastly, an astute reader will have noted that there may have been additional anomalies associated with the cloned certificate chain and signed code. I’ll leave discussion of these anomalies for another blog post. See you in 2018!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_7a5ba9904195":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_7a5ba9904195","isEditor":false,"isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"PostViewerEdge:postId:6f98657fc6ec-viewerId:lo_7a5ba9904195":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:6f98657fc6ec-viewerId:lo_7a5ba9904195"},"Tag:security":{"__typename":"Tag","id":"security","displayTitle":"Security","normalizedTagSlug":"security"},"Tag:code-signing":{"__typename":"Tag","id":"code-signing","displayTitle":"Code Signing","normalizedTagSlug":"code-signing"},"Post:6f98657fc6ec":{"__typename":"Post","id":"6f98657fc6ec","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"3b1c","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"abc3","startIndex":13,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d387","startIndex":32,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"ad8c","startIndex":36,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"4b6c","startIndex":47,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"5fe7","startIndex":57,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"5cae","startIndex":80,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:907ef7ba0dfe_0"},{"__ref":"Paragraph:907ef7ba0dfe_1"},{"__ref":"Paragraph:907ef7ba0dfe_2"},{"__ref":"Paragraph:907ef7ba0dfe_3"},{"__ref":"Paragraph:907ef7ba0dfe_4"},{"__ref":"Paragraph:907ef7ba0dfe_5"},{"__ref":"Paragraph:907ef7ba0dfe_6"},{"__ref":"Paragraph:907ef7ba0dfe_7"},{"__ref":"Paragraph:907ef7ba0dfe_8"},{"__ref":"Paragraph:907ef7ba0dfe_9"},{"__ref":"Paragraph:907ef7ba0dfe_10"},{"__ref":"Paragraph:907ef7ba0dfe_11"},{"__ref":"Paragraph:907ef7ba0dfe_12"},{"__ref":"Paragraph:907ef7ba0dfe_13"},{"__ref":"Paragraph:907ef7ba0dfe_14"},{"__ref":"Paragraph:907ef7ba0dfe_15"},{"__ref":"Paragraph:907ef7ba0dfe_16"},{"__ref":"Paragraph:907ef7ba0dfe_17"},{"__ref":"Paragraph:907ef7ba0dfe_18"},{"__ref":"Paragraph:907ef7ba0dfe_19"},{"__ref":"Paragraph:907ef7ba0dfe_20"},{"__ref":"Paragraph:907ef7ba0dfe_21"},{"__ref":"Paragraph:907ef7ba0dfe_22"},{"__ref":"Paragraph:907ef7ba0dfe_23"},{"__ref":"Paragraph:907ef7ba0dfe_24"},{"__ref":"Paragraph:907ef7ba0dfe_25"},{"__ref":"Paragraph:907ef7ba0dfe_26"},{"__ref":"Paragraph:907ef7ba0dfe_27"},{"__ref":"Paragraph:907ef7ba0dfe_28"},{"__ref":"Paragraph:907ef7ba0dfe_29"},{"__ref":"Paragraph:907ef7ba0dfe_30"},{"__ref":"Paragraph:907ef7ba0dfe_31"},{"__ref":"Paragraph:907ef7ba0dfe_32"},{"__ref":"Paragraph:907ef7ba0dfe_33"},{"__ref":"Paragraph:907ef7ba0dfe_34"},{"__ref":"Paragraph:907ef7ba0dfe_35"},{"__ref":"Paragraph:907ef7ba0dfe_36"},{"__ref":"Paragraph:907ef7ba0dfe_37"},{"__ref":"Paragraph:907ef7ba0dfe_38"},{"__ref":"Paragraph:907ef7ba0dfe_39"},{"__ref":"Paragraph:907ef7ba0dfe_40"},{"__ref":"Paragraph:907ef7ba0dfe_41"},{"__ref":"Paragraph:907ef7ba0dfe_42"},{"__ref":"Paragraph:907ef7ba0dfe_43"},{"__ref":"Paragraph:907ef7ba0dfe_44"},{"__ref":"Paragraph:907ef7ba0dfe_45"},{"__ref":"Paragraph:907ef7ba0dfe_46"},{"__ref":"Paragraph:907ef7ba0dfe_47"},{"__ref":"Paragraph:907ef7ba0dfe_48"},{"__ref":"Paragraph:907ef7ba0dfe_49"},{"__ref":"Paragraph:907ef7ba0dfe_50"},{"__ref":"Paragraph:907ef7ba0dfe_51"},{"__ref":"Paragraph:907ef7ba0dfe_52"},{"__ref":"Paragraph:907ef7ba0dfe_53"},{"__ref":"Paragraph:907ef7ba0dfe_54"},{"__ref":"Paragraph:907ef7ba0dfe_55"},{"__ref":"Paragraph:907ef7ba0dfe_56"},{"__ref":"Paragraph:907ef7ba0dfe_57"},{"__ref":"Paragraph:907ef7ba0dfe_58"},{"__ref":"Paragraph:907ef7ba0dfe_59"},{"__ref":"Paragraph:907ef7ba0dfe_60"},{"__ref":"Paragraph:907ef7ba0dfe_61"},{"__ref":"Paragraph:907ef7ba0dfe_62"},{"__ref":"Paragraph:907ef7ba0dfe_63"},{"__ref":"Paragraph:907ef7ba0dfe_64"},{"__ref":"Paragraph:907ef7ba0dfe_65"},{"__ref":"Paragraph:907ef7ba0dfe_66"},{"__ref":"Paragraph:907ef7ba0dfe_67"},{"__ref":"Paragraph:907ef7ba0dfe_68"},{"__ref":"Paragraph:907ef7ba0dfe_69"},{"__ref":"Paragraph:907ef7ba0dfe_70"},{"__ref":"Paragraph:907ef7ba0dfe_71"},{"__ref":"Paragraph:907ef7ba0dfe_72"},{"__ref":"Paragraph:907ef7ba0dfe_73"},{"__ref":"Paragraph:907ef7ba0dfe_74"},{"__ref":"Paragraph:907ef7ba0dfe_75"},{"__ref":"Paragraph:907ef7ba0dfe_76"},{"__ref":"Paragraph:907ef7ba0dfe_77"},{"__ref":"Paragraph:907ef7ba0dfe_78"},{"__ref":"Paragraph:907ef7ba0dfe_79"},{"__ref":"Paragraph:907ef7ba0dfe_80"},{"__ref":"Paragraph:907ef7ba0dfe_81"},{"__ref":"Paragraph:907ef7ba0dfe_82"},{"__ref":"Paragraph:907ef7ba0dfe_83"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:e8e64b89121"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fcode-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"907ef7ba0dfe","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":2},"clapCount":229,"allowResponses":true,"isLimitedState":false,"title":"Code Signing Certificate Cloning Attacks and Defenses","isSeries":false,"sequence":null,"uniqueSlug":"code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1570730737409,"readingTime":10.202830188679245,"previewContent":{"__typename":"PreviewContent","subtitle":"Before reading this post, ponder the following question: “What does it actually mean to you for something to be signed by Microsoft (or any…"},"previewImage":{"__ref":"ImageMetadata:1*fLrpueTtcZk_Gx5qOIxvsA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1513954240211,"updatedAt":1570730737788,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:6f98657fc6ec-viewerId:lo_7a5ba9904195"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:security"},{"__ref":"Tag:code-signing"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":2558,"layerCake":0}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script></body></html>