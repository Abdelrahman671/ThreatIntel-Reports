<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8">  <title>Newly discovered: BadSpace backdoor delivered by high-ranking websites</title> <meta http-equiv="x-ua-compatible" content="IE=edge" /> <meta name="generator" content="TYPO3 CMS" /> <meta name="description" content="Threat actors deliver fake software updates on websites for popular browsers: Sites with a high search engine ranking are at an increased risk. " /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="application-name" content="G DATA | Trust in German Sicherheit" /> <meta http-equiv="content-language" content="en" /> <meta property="og:title" content="BadSpace: Backdoor hides in fake software update" /> <meta property="og:description" content="Imagine visiting your favorite website with the same address that you always use and it tells you that your browser needs an update. After downloading and executing the update, there&#039;s an unwelcome surprise: the BadSpace backdoor. What is this new threat capable of, and how is it eerily similar to a warm cookie? " /> <meta property="og:image" content="https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2024/06/G_DATA_Blog_Badspace_OGTag.jpg" /> <meta property="og:image:url" content="https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2024/06/G_DATA_Blog_Badspace_OGTag.jpg" /> <meta property="og:image:width" content="1200" /> <meta property="og:image:height" content="630" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="BadSpace: Backdoor hides in fake software update" /> <meta name="twitter:description" content="Imagine visiting your favorite website with the same address that you always use and it tells you that your browser needs an update. After downloading and executing the update, there&#039;s an unwelcome surprise: the BadSpace backdoor. What is this new threat capable of, and how is it eerily similar to a warm cookie? " /> <meta name="twitter:image" content="https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2024/06/G_DATA_Blog_Badspace_OGTag.jpg" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="msapplication-navbutton-color" content="#1e1e1e" /> <meta name="yandex-verification" content="4cf0234eb3af74fb" /> <meta name="dc.title" content="Newly discovered: BadSpace backdoor delivered by high-ranking websites" /> <meta name="date" content="2024-06-14T12:57:03" /> <meta name="dc.date" content="2024-06-14T12:57:03" /> <meta name="copyright" content="G DATA CyberDefense AG, 2024. All rights reserved." /> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/basic-styles.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/font/gcon.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/font/source-sans-pro.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/assets/prism.css?1729663114" media="all"> <link href="/typo3conf/ext/gd_sites/Resources/Public/Styles/elements/menu-2019.css?1729663114" rel="stylesheet" > <link href="/typo3conf/ext/gd_sites/Resources/Public/Styles/assets/blogpage.css?1729663114" rel="stylesheet" > <script type="text/javascript" data-cmp-ab="1" src="https://cdn.consentmanager.net/delivery/autoblocking/fe6daaf9c1a67.js" data-cmp-host="b.delivery.consentmanager.net" data-cmp-cdn="cdn.consentmanager.net" data-cmp-codesrc="0"></script> <script>
    function setOffline(e,o) {o.dontshow = 1;}
    if (window.location.href.indexOf('gd-ncb=2') !== -1 || window.sessionStorage.getItem('gd_no-tracking') === 'true') {
        __cmp("addEventListener",["init",setOffline,false],null);
        __cmp("addEventListener",["settings",setOffline,false],null);
        window.sessionStorage.setItem('gd_no-tracking', 'true');
    }
  </script> <link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" title="G DATA SecurityBlog (deutsch)" href="https://feeds.feedblitz.com/GDataSecurityBlog-DE&x=1" /> <link rel="alternate" type="application/atom+xml" title="G DATA SecurityBlog (english)" href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&x=1" /><meta name="author" content="Karsten Hahn, Anna Lvova"><meta name="DC.author" content="Karsten Hahn, Anna Lvova"> <link rel="dns-prefetch" href="//file.gdatasoftware.com"> <link rel="dns-prefetch" href="//static.gdatasoftware.com"> <link rel="dns-prefetch" href="//www.google-analytics.com"> <link rel="dns-prefetch" href="//www.googletagmanager.com"> <link rel="canonical" href="https://www.gdatasoftware.com/blog/2024/06/37947-badspace-backdoor"/>  <script type="application/ld+json">[{"@context":"https:\/\/www.schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.gdatasoftware.com\/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/www.gdatasoftware.com\/blog","name":"Blog (EN)"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.gdatasoftware.com\/blog\/2024\/06\/37947-badspace-backdoor","name":"Backdoor BadSpace delivered by high-ranking infected websites"}}]}]</script> </head> <body id="page-37947" class="fe-0 be-"> <div id="outer-wrap"> <header id="site-header" class="height-auto"> <div class="menu-overlay" data-menu-close></div> <div id="mobile-head" data-menu-website="blog" class="clearfix hide-for-large"> <a href="/blog" id="mobile-logo"> <div class="logo"> <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-dark.svg" alt="G DATA Logo" height="40""/> </div> </a> <a id="service-nav-trigger"><span>MENU</span> <div id="hamburger" class="hamburger-icon-container"> <span class="hamburger-icon"></span> </div> </a> </div> <div id="main-navi" data-menu-website="blog" class="logged-in main-navi-before"> <div class="level-1 flex-container"> <div class="logo show-for-large"> <a href="/blog" > <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-dark.svg" alt="G DATA Logo" height="40"/> </a> </div> <nav role="navigation"> <ul class="menu"> <li> <a class="effect-underline" href="/blog/awareness">Awareness</a> </li> <li> <a class="effect-underline" href="/blog/g-data-campues">G DATA Campus</a> </li> <li> <a class="effect-underline" href="/blog/smb-secuerity">SMB Security</a> </li> <li> <a class="effect-underline" href="/blog/tips-and-tricks">Tips and tricks</a> </li> <li> <a class="effect-underline" href="/blog/techblog">Techblog</a> </li> <li class="ar pop-up choose-language"> <a href="https://www.gdata.de/blog"> <img src="/typo3conf/ext/gd_sites/Resources/Public/Images/Flags/DE.svg" style="height:20px" alt="Switch to german version" /> </a> </li> <li class="ar pop-up rss"> <a href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&amp;x=1" target="_blank" rel="noreferrer"> <i class="icon-rss"></i><span class="title"></span> </a> </li> </ul> </nav> <div class="blog-subwrap"> <ul class="blog-subnavi"> <li> <a class="nav-link" href="/blog/ransomware">Ransomware</a> </li> <li> <a class="nav-link" href="/blog/warning">Warning</a> </li> <li> <a class="nav-link" href="/blog/malware">Malware</a> </li> <li> <a class="nav-link" href="/blog/cybercrime">CyberCrime</a> </li> <li> <a class="nav-link" href="/blog/exploits">Exploits</a> </li> <li> <a class="nav-link" href="/blog/phishing">Phishing</a> </li> <li> <a class="nav-link" href="/blog/bots-botnets">Bots &amp; Botnets</a> </li> </ul> <div class="searchbox"> <form action="/blog/search" method="GET"> <input type="text" name="tx_kesearch_pi1[sword]" placeholder="search phrase" /> <button data-trigger-searchinput type="button"><i class="icon-search"></i></button> </form> </div> </div> </div> </div> </header> <div id="inner-wrap"> <div id="main" role="main"> <div class="row expanded blog-head-container"> <div class="pagenews-header blogpage-header text-white bg-right bgm-left"> <div class="outer"> <div class="inner v-middle"> <header> <h1>Backdoor BadSpace delivered by high-ranking infected websites</h1> <span itemprop="dateCreated">06/12/2024 </span> </header> </div> </div> <span class="cat-title">G DATA <strong>Blog</strong></span> <span class="cat-icon"><i class="icon-blog has-top top"></i></span> </div> <style> .blogpage-header { background-image:url(/fileadmin/user_upload/Presse/Deutschland/2024/06/G_DATA_Blog_Badspace_Header.jpg); } @media only screen and (max-width: 767px) { .blogpage-header { background-image:url(/fileadmin/_processed_/0/d/G_DATA_Blog_Badspace_Header_08de8471d0.jpg); }} </style> </div> <div class="row"> <div class="column small-12 medium-12 large-9" id="blogpage-content-container"> <div class="row"> <div class="column fce small-12"> <p class="intro-text">Imagine visiting your favorite website with the same address that you always use and it tells you that your browser needs an update. After downloading and executing the update, there's an unwelcome surprise: the BadSpace backdoor. What is this new threat capable of, and how is it eerily similar to a warm cookie? </p> </div> </div> <div class="row hide-for-large"> <div class="column small-12"> <div class="pagenews-progress"> <div class="reading-time"> <span class="eta"></span> <span class="word-count"></span> </div> <div data-sticky-container id="mobile-progress-container" class="hide-on-large"> <progress value="0" class="sticky" data-sticky data-margin-top="0" data-sticky-on="small" data-margin-bottom="0" data-top-anchor="mobile-progress-container" data-btm-anchor="site-footer:top"></progress> </div> </div> <nav class="mobile-menu"> <ul class="pagenews-menu"> <li> <a href="#c233421" data-scroll-link> <span>The backstory</span> </a> </li> <li> <a href="#c233422" data-scroll-link> <span>Vectors in the infection chain</span> </a> </li> <li> <a href="#c233425" data-scroll-link> <span>JScript</span> </a> </li> <li> <a href="#c233427" data-scroll-link> <span>BadSpace string and API obfuscation</span> </a> </li> <li> <a href="#c233429" data-scroll-link> <span>BadSpace anti-sandbox and persistence</span> </a> </li> <li> <a href="#c233431" data-scroll-link> <span>C2 communication</span> </a> </li> <li> <a href="#c233437" data-scroll-link> <span>Indicators of compromise</span> </a> </li> </ul> </nav> </div> </div> <div class="row"> <div data-magellan-target="c233421" class="small-12 column"><div class="row"> <div id="c233421" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h2 class=" "> The backstory </h2></header><p>On the 19th of May, the threat intelligence analyst <a href="https://x.com/Gi7w0rm" target="_blank" class="Hyperlink SCXW54582154 BCX8" rel="noreferrer noopener"><u class="BCX8 SCXW54582154 TextRun Underlined" data-contrast="none">Gi7w0rm</u></a> drew the attention of the cybersecurity community to a new <a href="https://x.com/Gi7w0rm/status/1791970049772687797" target="_blank" class="Hyperlink SCXW54582154 BCX8" rel="noreferrer noopener"><u class="BCX8 SCXW54582154 TextRun Underlined" data-contrast="none">backdoor “BadSpace”</u></a> that was discovered by the researcher <a href="https://community.emergingthreats.net/t/sigs-w32-badspace-backdoor/1630" target="_blank" class="Hyperlink SCXW54582154 BCX8" rel="noreferrer noopener"><u class="BCX8 SCXW54582154 TextRun Underlined" data-contrast="none">@kevross33</u></a>&nbsp; several days earlier. We outline the infection chain and give an overview to the functionality of the backdoor.&nbsp;&nbsp;</p></div> </div></div> <div data-magellan-target="c233422" class="small-12 column"><div class="row"> <div id="c233422" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h2 class=" "> Vectors in the infection chain </h2></header><div class="media-object stack-for-small ce-vmiddle img-right "><div class="media-object-section middle clearfix"><div class="inner float-right"><p>Through collaborative research with the cybersecurity community, we identified that the threat actor employs a multi-stage attack chain involving an infected website, a command and control (C2) server, in some cases a fake browser update, and a JScript downloader to deploy a backdoor into the victim's system.</p><p>Threat Intelligence Analyst <a href="https://x.com/Gi7w0rm" target="_blank" rel="noreferrer noopener">Gi7w0rm</a> shared with us that BadSpace is delivered via infected websites. The reported scenarios slightly differ, but the basics are the same. The code from the infected website sets a cookie to track if the user has visited the page before. If it’s the user's first visit, it constructs a URL with query parameters including information about the user's device type, IP address, referrer, user agent, domain, and location. After that, it sends a GET request to the constructed URL. The response with a payload from this URL overwrites the webpage that initially was called by a user, unless it contains an error message indicating a page load error.</p></div></div><div class="media-object-section middle"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_InfectionChain.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_InfectionChain.png" width="1222" height="763" loading="lazy" alt="" /></a><figcaption class="image-caption"> Infection chain (click to enlarge) </figcaption></figure></div></div></div> <div id="c233435" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-image ce-center ce-above"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/9/8/GDATA_Badspace_Web_infection_058ca5197d.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_Web_infection.png" width="1369" height="159" loading="lazy" alt="" /></a><figcaption class="image-caption"> URL construction </figcaption></figure></div></div></div></div> <div id="c233424" class="fce column large-12 small-12 frame-layout-0 " ><p class="Paragraph SCXW91765508 BCX8">There is a tendency to infect WordPress websites and to inject the malicious code to the JavaScript libraries like jQuery<sup>[1]</sup> or in the index page itself<sup>[2]</sup>.&nbsp;</p><p class="Paragraph SCXW91765508 BCX8">We were able to acquire several JScript files that drop and run the BadSpace backdoor. Some of them use extension spoofing like “.pdf.js”<sup>[3][4]</sup>.</p><p class="Paragraph SCXW91765508 BCX8">Gi7w0rm also informed us that some of the websites show a window with a fake Google Chrome update and after downloading, it drops the malicious backdoor or the JScript onto the system.&nbsp;</p><p class="Paragraph SCXW91765508 BCX8">The domains that serve as C2 servers in the web attack<sup>[6][7] </sup>were <a href="https://x.com/GroupIB_TI/status/1790230873285242992" target="_blank" class="Hyperlink SCXW91765508 BCX8" rel="noreferrer noopener"><u class="BCX8 SCXW91765508 TextRun Underlined" data-contrast="none">mentioned</u></a> by Group-IB Threat intelligence. They associate them to the threat actor SocGholish. According to <a href="https://www.proofpoint.com/us/blog/threat-insight/part-1-socgholish-very-real-threat-very-fake-update" target="_blank" class="Hyperlink SCXW91765508 BCX8" rel="noreferrer noopener"><u class="BCX8 SCXW91765508 TextRun Underlined" data-contrast="none">a report</u></a> by Proofpoint, it is typical for SocGholish to use fake updates and JS files. The described attack has a lot of similarities in the way how the backdoor was delivered.&nbsp;</p></div> </div></div> <div data-magellan-target="c233425" class="small-12 column"><div class="row"> <div id="c233425" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> JScript </h2></header><p>The JScript file<sup>[3]</sup> employs different obfuscation techniques. The de-obfuscation starts with three functions and a strings array. For example, the first function shifts the given array 143,858 times (0x231f2), and another function after subtracting 383 (0x17f) points to the first element of a new array. The shift and subtract values are not fixed and are unique for each sample. This new array will replace obfuscated names of the variables and functions. However, for additional complexity, not all variables will be renamed after the execution of the mentioned functions. The rest of the variables are declared within the code. We suspect that the threat actor used service <a href="https://obfuscator.io" target="_blank" rel="noreferrer">obfuscator.io</a>. &nbsp;</p><p class="Paragraph SCXW186431872 BCX8">The third function at the end of the file is obfuscated with the help of <a href="http://dean.edwards.name/packer/" target="_blank" class="Hyperlink SCXW186431872 BCX8" rel="noreferrer noopener"><u class="BCX8 SCXW186431872 TextRun Underlined" data-contrast="none">JavaScript Compressor by Dean Edwards</u></a>. The result of this function will finish the construction of the PowerShell downloader.&nbsp;&nbsp;</p><p class="Paragraph SCXW186431872 BCX8">The PowerShell code silently downloads the BadSpace backdoor<sup>[5]</sup> and after ten seconds it executes the downloaded file using rundll32.exe.&nbsp;</p><p>&nbsp;</p></div><div class="ce-gallery row small-up-1 medium-up-2 large-up-2"><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/f/f/GDATA_Badspace_Deobfus._mechanism_f5351fd6fb.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/f/f/GDATA_Badspace_Deobfus._mechanism_cade696dcf.png" width="711" height="318" loading="lazy" alt="" /></a><figcaption class="image-caption"> Obfuscation mechanism of the JScript file (click to enlarge) </figcaption></figure></div><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_PowerShell_code.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_PowerShell_code.png" width="698" height="165" loading="lazy" alt="" /></a><figcaption class="image-caption"> PowerShell script that is executed by the obfuscated JScript file (click to enlarge) </figcaption></figure></div></div></div></div> </div></div> <div data-magellan-target="c233427" class="small-12 column"><div class="row"> <div id="c233427" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> BadSpace string and API obfuscation </h2></header><p class="Paragraph SCXW76770377 BCX8">The present BadSpace sample<sup>[5]</sup> is a PE32+ DLL that is not packed but obfuscated.&nbsp;</p><p class="Paragraph SCXW76770377 BCX8">The strings, Windows API DLL names, and Windows API function names that it uses are encrypted with RC4. Each string blob has the following buildup: four bytes length of encrypted data, followed by a four bytes RC4 key, followed by the encrypted data.</p></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><img class="image-embed-item " src="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_encryptedstrings.png" width="1216" height="482" loading="lazy" alt="" /><figcaption class="image-caption"> Buildup of encrypted string blob </figcaption></figure></div></div></div></div> <div id="c233428" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><p class="Paragraph SCXW153099653 BCX8">APIs are resolved dynamically via LoadLibraryW and GetProcAddress using the decrypted function names from the strings table.&nbsp;</p><p class="Paragraph SCXW153099653 BCX8">We created an <a href="https://github.com/struppigel/hedgehog-tools/blob/main/BadSpace/badspace_idapython_string_decrypter.py" target="_blank" rel="noreferrer">IDA Python script</a> to automatically decode strings and APIs in the IDA database. The script searches potential decryption function calls in the Ctree of the decompiler, decrypts the argument, changes the string reference label to the decrypted string, and adds comments.&nbsp;</p><p class="Paragraph SCXW153099653 BCX8">While discussing the case with other researchers, <a href="https://x.com/X__Junior" target="_blank" rel="noreferrer">Mohamed Ashraf</a> provided a standalone <a href="https://github.com/X-Junior/Malware-String-Decryptor-Scripts/blob/main/Badspace/badspace.py" target="_blank" rel="noreferrer">Python script</a> that also decrypts BadSpace strings. It works independently from IDA.&nbsp;</p></div><div class="ce-gallery row small-up-1 medium-up-2 large-up-2"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_IDAPython.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/e/4/GDATA_Badspace_IDAPython_2af05f3f5b.png" width="711" height="269" loading="lazy" alt="" /></a><figcaption class="image-caption"> IDAPython main string decryption code (click to enlarge) </figcaption></figure></div><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_APIResolve.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/e/a/GDATA_Badspace_APIResolve_8745d04314.png" width="711" height="283" loading="lazy" alt="" /></a><figcaption class="image-caption"> One of the API resolving functions after decrypting the strings and labelling them (click to enlarge) </figcaption></figure></div></div></div></div> </div></div> <div data-magellan-target="c233429" class="small-12 column"><div class="row"> <div id="c233429" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> BadSpace anti-sandbox and persistence </h2></header><p class="Paragraph SCXW158710411 BCX8">BadSpace<sup>[5]</sup> employs several anti-sandbox heuristics.&nbsp;&nbsp;</p><ul class="gcon-list-plus-green"><li class="OutlineElement Ltr SCXW158710411 BCX8" data-aria-level="1" data-aria-posinset="1" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="6"><p class="Paragraph SCXW158710411 BCX8">&nbsp;It counts the number of folders in the %TEMP% directory and the %APPDATA% and makes sure that these are above a certain threshold.</p></li><li class="OutlineElement Ltr SCXW158710411 BCX8" data-aria-level="1" data-aria-posinset="1" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="6"><p class="Paragraph SCXW158710411 BCX8">It queries the registry and counts how often DisplayName appears as a subkey of SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall.&nbsp;&nbsp;</p></li><li class="OutlineElement Ltr SCXW158710411 BCX8" data-aria-level="1" data-aria-posinset="3" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="6"><p class="Paragraph SCXW158710411 BCX8">It checks the number of processors and the global memory status.&nbsp;&nbsp;</p></li></ul><p class="Paragraph SCXW158710411 BCX8">The thresholds for all anti-sandbox heuristics are slightly different for each sample.&nbsp;</p></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_antisandbox.png" class="fancybox"><img class="image-embed-item " src="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_antisandbox.png" width="1210" height="420" loading="lazy" alt="" /></a><figcaption class="image-caption"> Anti-sandbox checks at the start of execution </figcaption></figure></div></div></div></div> <div id="c233430" class="fce column large-12 small-12 frame-layout-0 " ><p class="Paragraph SCXW199457209 BCX8">After the anti-sandbox checks it first creates the mutex “32ac0087-89d0-4ea5-89af-26a8d08e87ce"; this UUID value is different for each BadSpace sample.</p><p class="Paragraph SCXW199457209 BCX8">Then it persists via scheduled task creation and self-copying. The persistence function accounts for both, EXE and DLL files. Because the present sample is a DLL, the scheduled task uses the command:&nbsp;</p><p>&nbsp;</p><pre><code class="language-bash">Rundll32.exe %ALLUSERSPROFILE%\RtlUpd\RtlUpd.dll,Start /p </code></pre><p>&nbsp;</p><p class="Paragraph SCXW199457209 BCX8">If that fails, it tries a different folder:&nbsp;</p><p>&nbsp;</p><pre><code class="language-bash">Rundll32.exe %APPDATA%\RtlUpd\RtlUpd.dll,Start /p </code></pre><p>&nbsp;</p><p class="Paragraph SCXW199457209 BCX8">The arguments <i><strong>Start /p</strong></i> make sure that the persistence function is not executed again.</p></div> </div></div> <div data-magellan-target="c233431" class="small-12 column"><div class="row"> <div id="c233431" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> C2 communication </h2></header><p class="Paragraph SCXW189186435 BCX8">The initial request to the server sends a cookie, which contains encrypted information of the infected system. This cookie is most likely the reason for the malware’s alias name <i>WarmCookie</i>. The following data is sent to the server:&nbsp;</p><ul class="list-black-square"><li class="OutlineElement Ltr SCXW189186435 BCX8" data-aria-level="1" data-aria-posinset="4" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p class="Paragraph SCXW189186435 BCX8"><span id="cke_bm_216S" style="display:none">&nbsp;</span>computer name&nbsp;</p></li><li class="OutlineElement Ltr SCXW189186435 BCX8" data-aria-level="1" data-aria-posinset="5" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p class="Paragraph SCXW189186435 BCX8">DNS domain assigned to the local computer&nbsp;</p></li><li class="OutlineElement Ltr SCXW189186435 BCX8" data-aria-level="1" data-aria-posinset="6" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p class="Paragraph SCXW189186435 BCX8">crc32 hash of the Volume Serial Number for C: xored with the crc32 hash of 32ac0087-89d0-4ea5-89af-26a8d08e87ce (this UUID is different for each sample and it is the same value that is being used for the mutex)&nbsp;</p></li><li class="OutlineElement Ltr SCXW189186435 BCX8" data-aria-level="1" data-aria-posinset="7" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p class="Paragraph SCXW189186435 BCX8">OS version info&nbsp;</p></li><li class="OutlineElement Ltr SCXW189186435 BCX8" data-aria-level="1" data-aria-posinset="8" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p class="Paragraph SCXW189186435 BCX8">username&nbsp;</p></li><li class="OutlineElement Ltr SCXW189186435 BCX8" data-aria-level="1" data-aria-posinset="9" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="5"><p class="Paragraph SCXW189186435 BCX8">RC4 key&nbsp;<span id="cke_bm_216E" style="display:none">&nbsp;</span></p></li></ul></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/3/9/GDATA_Badspace_Cookie_efdbc16ec4.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/3/9/GDATA_Badspace_Cookie_dbd0bc48f1.png" width="1436" height="349" loading="lazy" alt="" /></a><figcaption class="image-caption"> Encrypted and Base64 encoded cookie via VMRay </figcaption></figure></div></div></div></div> <div id="c233432" class="fce column large-12 small-12 frame-layout-0 " ><div class="media-object stack-for-small ce-vmiddle img-right "><div class="media-object-section middle clearfix"><div class="inner float-right"><p class="Paragraph SCXW115940896 BCX8">The key is used to encrypt C2 communication. It is a hardcoded RC4 key that is different for every sample. In the present sample the key is “24de21a8dc08434c”.&nbsp;</p><p class="Paragraph SCXW115940896 BCX8">The user agent that the backdoor uses for C2 communication is responsible for the name BadSpace because it has additional spaces that are not present in Firefox user agents:&nbsp;</p><p class="Paragraph SCXW115940896 BCX8">Mozilla / 4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1;.NET CLR 1.0.3705)&nbsp;</p><p class="Paragraph SCXW115940896 BCX8">BadSpace was the prevalent malware name in discussions with other researchers and on X.com whereas WarmCookie only appeared in one of the detection names on VirusTotal. Hence, we decided to use the name BadSpace.&nbsp;</p></div></div><div class="media-object-section middle"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_C2_commands.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/user_upload/Presse/Deutschland/2024/06/GDATA_Badspace_C2_commands.png" width="1050" height="862" loading="lazy" alt="" /></a><figcaption class="image-caption"> Command loop for the C2 communication (click to enlarge) </figcaption></figure></div></div></div> <div id="c233433" class="fce column large-12 small-12 frame-layout-0 " ><p class="Paragraph SCXW115940896 BCX8">There are seven different commands that the server may issue towards the client. The command is determined by a number.&nbsp;</p><ul class="BulletListStyle1 SCXW115940896 BCX8"><li class="OutlineElement Ltr SCXW115940896 BCX8" data-aria-level="1" data-aria-posinset="7" data-font="Symbol" data-leveltext="" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-listid="8"><table><thead><tr><th scope="col">Command</th><th scope="col">Meaning</th></tr></thead><tbody><tr><td>0x1</td><td>query ProcessorNameString in HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor</td></tr><tr><td>0x2</td><td>take a screenshot</td></tr><tr><td>0x3</td><td>query DisplayName, DisplayVersion and InstallDate in HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall&nbsp;</td></tr><tr><td>0x4</td><td>execute cmd command&nbsp;</td></tr><tr><td>0x5</td><td>write file&nbsp;</td></tr><tr><td>0x6</td><td>read file&nbsp;</td></tr><tr><td>0xA</td><td>delete scheduled task persistence</td></tr></tbody></table></li></ul></div> </div></div> <div data-magellan-target="c233437" class="small-12 column"><div class="row"> <div id="c233437" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h2 class=" "> Indicators of compromise </h2></header><p class="Paragraph SCXW190892181 BCX8">The remaining section describes the SHA256 hashes, IPs and URLs that we analysed for this article. The square brackets [X] are references to the samples or URLs in the text.</p><h4 class="Paragraph SCXW190892181 BCX8"><strong class="BCX8 SCXW190892181 TextRun" data-contrast="auto">Java Script (Web infection)</strong></h4><p class="Paragraph SCXW190892181 BCX8"><strong>[1]</strong> 2b4d7ed8d12d34cbf5d57811ce32f9072845f5274a2934221dd53421c7b8762b</p><p class="Paragraph SCXW190892181 BCX8"><strong>[2]</strong> f3fed82131853a35ebb0060cb364c89f42f55e357099289ca22f7af651ee2c48</p><p class="Paragraph SCXW190892181 BCX8">255cc818a2e11d7485c1e6cc1722b72c1429b899304881cf36c95ae65af2e566</p><h4 class="Paragraph SCXW190892181 BCX8"><strong class="BCX8 SCXW190892181 TextRun" data-contrast="auto">JScript droppers</strong>&nbsp;</h4><p class="Paragraph SCXW190892181 BCX8"><strong>[3]</strong> c64cb9e0740c17b2561eed963a4d9cf452e84f462d5004ddbd0e0c021a8fdabc&nbsp;</p><p class="Paragraph SCXW190892181 BCX8"><strong>[4] </strong>9786569f7c5e5183f98986b78b8e6d7afcad78329c9e61fb881d3d0960bc6a15&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">c7fc0661c1dabd6efd61eaf6c11f724c573bb70510e1345911bdb68197e598e7&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">2a311dd5902d8c6654f2b50f3656201f4ceb98c829678834edaeae5c50c316f5&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">0da87bff1a95de9fc7467b9894a8d8e0486dfd868c2c7305e83951babacde642</p><h4 class="Paragraph SCXW190892181 BCX8"><strong class="BCX8 SCXW190892181 TextRun" data-contrast="auto">BadSpace</strong></h4><p class="Paragraph SCXW190892181 BCX8"><strong>[5] </strong>6a195e6111c9a4b8c874d51937b53cd5b4b78efc32f7bb255012d05087586d8f&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">2a5a12cc4ef2f0f527cc072243aa27d3e95e48402ef674e92c6709dc03a0836a&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">2a4451ef47b1f4b971539fb6916f7954f80a6735cf75333fa9d19b169c31de2e&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">9bc4c44b24f4ba71a1c7f5dd1c8135544218235ae58efa81898e55515938da6a&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">475edfbb2b03182ef7c42c1bc2cc4179b3060d882827029a6e67c045a0c1149b&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">676cbcaa74ee8e43abaf0a2767c7559a8f4a7c6720ecc5ae53101a16a3219b9a&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">770cafb3fe795c2f13eb44f0a6073b8fe4fb3ee08240b3243c747444592d85ff&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">84519a45da0535087202b576391d1952a4cc81213f0e470db65f1817b65ee9d7&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">a5f16fa960fe0461e2009bd748bc9057ef5cd31f05f48b12cfd7790fa741a24e&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">a725883bd1c39e48ab60b2c26b5692f7334a3e4544927057a9ffbdabfeedf432&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">ad2333e1403e3d8f5d9bd89d7178e85523fa7445e0a05b57fd9bc35547ec0d98&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">ba4c8be6a1eb92d79df396eea8658b778f4bc0f010da48e1d26e3fc55d83e9c7&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">b6ac7f6e3b03acd364123a07b2122d943c4111ac4786bb188d94eae0e5b22c02&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">bb74c6fc0323956dd140988372c412f8b32735fb0ed1ad416e367d29c06af9cc&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">c437e5caa4f644024014d40e62a5436c59046efc76c666ea3f83ab61df615314&nbsp;</p><h4 class="Paragraph SCXW190892181 BCX8"><strong class="BCX8 SCXW190892181 TextRun" data-contrast="auto">C2</strong></h4><p class="Paragraph SCXW190892181 BCX8">80.66.88.146&nbsp;</p><p class="Paragraph SCXW190892181 BCX8">185.49.69.41&nbsp;</p><p class="Paragraph SCXW190892181 BCX8"><strong>[6] </strong>uhsee[.]com&nbsp;</p><p class="Paragraph SCXW190892181 BCX8"><strong>[7]</strong> kongtuke[.]com&nbsp;</p></div> </div></div> </div> </div> <div class="column small-12 medium-12 large-3" id="blogpage-sidebar-container"> <div class="row"> <div class="column small-12 fce"> <div class="pagenews-authorbox"> <div class="media-object"> <div class="media-object-section middle"> <img src="/fileadmin/_processed_/3/7/anna_lvova_1936740544.jpg" srcset="/fileadmin/_processed_/3/7/anna_lvova_1936740544.jpg 1x, /fileadmin/_processed_/3/7/anna_lvova_8b8436f2a3.jpg 2x" width="100" height="100"> </div> <div class="media-object-section middle"> <p><strong>from Anna Lvova</strong><br/>Malware Analyst</p> </div> </div> </div> <div class="pagenews-authorbox"> <div class="media-object"> <div class="media-object-section middle"> <img src="/fileadmin/_processed_/0/d/hahn_karsten_abecee0563.jpg" srcset="/fileadmin/_processed_/0/d/hahn_karsten_abecee0563.jpg 1x, /fileadmin/_processed_/0/d/hahn_karsten_6868e98e82.jpg 2x" width="100" height="100"> </div> <div class="media-object-section middle"> <p><strong>Karsten Hahn</strong><br/>Principal Malware Researcher</p> </div> </div> </div> </div> </div> <div class="row"> <div id="pagenews-sticky-sidebar-container" class="column small-12" data-sticky-container> <div class="sticky" id="pagenews-sticky-sidebar" data-sticky data-margin-top="0" style="width:100%;" data-deep-linking data-sticky-on="large" data-margin-bottom="0" data-top-anchor="pagenews-sticky-sidebar-container" data-btm-anchor="blogpage-content-container:bottom"> <div class="show-for-large"> <div class="sidebar-socialshare margin-bottom"> <div class="shariff" data-button-style="icon" data-twitter-via="GDATA" data-orientation="horizontal" data-lang="en" data-services="[&quot;twitter&quot;,&quot;xing&quot;,&quot;linkedin&quot;,&quot;facebook&quot;,&quot;reddit&quot]"></div> </div> <div class="pagenews-progress"> <div class="reading-time"> <span class="eta"></span> <span class="word-count"></span> </div> <progress value="0"></progress> </div> <nav data-magellan> <ul class="pagenews-menu"> <li> <a href="#c233421"> <span>The backstory</span> </a> </li> <li> <a href="#c233422"> <span>Vectors in the infection chain</span> </a> </li> <li> <a href="#c233425"> <span>JScript</span> </a> </li> <li> <a href="#c233427"> <span>BadSpace string and API obfuscation</span> </a> </li> <li> <a href="#c233429"> <span>BadSpace anti-sandbox and persistence</span> </a> </li> <li> <a href="#c233431"> <span>C2 communication</span> </a> </li> <li> <a href="#c233437"> <span>Indicators of compromise</span> </a> </li> </ul> </nav> </div> <div class="row"> <div class="fce column small-12 blog-categories"> <ul> <li><a href="/blog/cybercrime"><span class="label label-default">CyberCrime</span></a></li> <li><a href="/blog/malware"><span class="label label-default">Malware</span></a></li> <li><a href="/blog/microsoft-windows"><span class="label label-default">Microsoft Windows</span></a></li> <li><a href="/blog/techblog"><span class="label label-default">Techblog</span></a></li> </ul> </div> </div> <div class="row"> </div> </div> </div> </div> </div> </div> <div class="row expanded pagenews-footer" id="blogpage-footer"> <div class="small-12 column"> <div class="row" > <div class="small-12 medium-6 large-3 column fce"> <a class="button expanded no-margin" href="/blog">back to list</a> </div> <div class="small-12 medium-6 large-3 column fce"> <div class="sidebar-socialshare"> <div class="shariff" data-button-style="icon" data-twitter-via="GDATA" data-orientation="horizontal" data-lang="en" data-services="[&quot;twitter&quot;,&quot;xing&quot;,&quot;linkedin&quot;,&quot;facebook&quot;,&quot;reddit&quot]"></div> </div> </div> <div class="small-12 medium-12 large-3 column fce last-update"> </div> </div> </div> </div> <div class="row"> </div> </div> <div class="row"><nav id="breadcrumb" class="small-12 columns"><ul class="breadcrumbs"><li class="info-text">You are here:</li><li><a href="/blog"><span>Blog (EN)</span></a></li><li><span>Backdoor BadSpace delivered by high-ranking infected websites</span></li></ul></nav></div> <footer id="site-footer"> <div class="row flexcontainer"> <div class="logo"> <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-light.svg" alt="G DATA Logo" height="50" style="height: 50px; margin:16px;"/> </div> <div class="socialbar"> <div class="social text-center"> <a href="https://de.linkedin.com/company/g-data-cyberdefense" title="G DATA CyberDefense AG on Linked-In" target="_blank" rel="noreferrer"><i class="icon-linkedin"></i></a><a href="https://www.facebook.com/gdatasoftwareag" title="G DATA CyberDefense AG on Facebook" target="_blank" rel="noreferrer"><i class="icon-facebook"></i></a><a href="https://www.threads.net/@gdatacyberdefense" title="G DATA CyberDefense AG on Threads" target="_blank" rel="noreferrer"><i class="icon-threads"></i></a><a href="https://www.instagram.com/gdatacyberdefense" title="G DATA CyberDefense AG on Instagram" target="_blank" rel="noreferrer"><i class="icon-instagram"></i></a><a href="https://www.youtube.com/user/GDataSoftwareAG" title="G DATA CyberDefense AG on Youtube" target="_blank" rel="noreferrer"><i class="icon-youtube"></i></a><a href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&amp;x=1" target="_blank" rel="noreferrer"><i class="icon-rss"></i></a> </div> </div> </div> <div class="sitemap row small-up-1 medium-up-2 large-up-4"> <div class="column"> <h5>G DATA</h5> <ul> <li> <a href="/about-g-data" data-event-action="click" data-event-category="Menu-Footer" data-event-label="About G DATA">About G DATA</a> </li> <li> <a href="/g-data/newsroom" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Newsroom">Newsroom</a> </li> <li> <a href="/about-g-data/jobs" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Jobs &amp; Career">Jobs &amp; Career</a> </li> <li> <a href="/about-g-data/awards" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Awards">Awards</a> </li> </ul> </div> <div class="column"> <h5>Services</h5> <ul> <li> <a href="/pc/free-trial" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Free Trial">Free Trial</a> </li> <li> <a href="https://www.gdata.de/help/en/business/HowToArtikel/Virenanalyse/DateiURLAppEinsenden/" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Submit a suspicious file, app or URL">Submit a suspicious file, app or URL</a> </li> </ul> </div> <div class="column"> <h5>G DATA Solutions</h5> <ul> <li> <a href="/pc" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Consumer">Consumer</a> </li> <li> <a href="/business" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Business">Business</a> </li> </ul> </div> </div> <div class="row"> <hr/> </div> <div class="footnav row"> <div class="large-7 medium-6 small-12 column imprint"> <a href="/privacy">Data Protection </a><a href="/support/contact">Contact </a><a href="/imprint">Imprint </a><a href="/">gdatasoftware.com </a> </div> <div class="large-5 medium-6 small-12 column copyright"> <span>&copy;&nbsp;2024&nbsp;G DATA CyberDefense AG. All rights reserved.</span> </div> </div> </footer> <a href="#" class="go-top"><i class="icon-angle-up-regular"></i></a> </div> </div> <script src="/typo3temp/assets/compressed/merged-f081765a3ed763d7fe90ca1c11ab5a25.js?1729664179"></script> <script src="/typo3conf/ext/gd_sites/Resources/Public/JavaScript/gd-mainmenu-2019.js?1729663114"></script> <script src="/typo3conf/ext/gd_pagenews/Resources/Public/JavaScript/gd-guidebook.js?1729663114"></script> <script>
            $(document).ready(function() {
				GdScrollIndicator.init('#blogpage-content-container','','');
				GdScrollIndicator.calculateReadingTime([$('#blogpage-content-container'),$('.pagenews-teaser')],{readingTimeTarget:'.eta',wordCountTarget:'.word-count', prependTimeString:'Reading time: ', lessThanAMinuteString:'less then a minute', prependWordString:'(',apendWordString:' words)'});
			});
		</script> <script>
    document.addEventListener( 'DOMContentLoaded', function(e) {
        window.GdTracking = new GdTrackingModule();
        GdTracking.initialize();
    });
</script> <script data-cmp-vendor="s905" type="text/plain" class="cmplazyload">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'analytics_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'wait_for_update': 500
        });

        dataLayer.push({
            'event': 'default_consent'
        });
    </script> <script data-cmp-vendor="s905" type="text/plain" class="cmplazyload">
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NQG4RJ');
    </script> </body> </html>