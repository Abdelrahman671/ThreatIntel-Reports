<!doctype html><html lang="en"><head><title data-rh="true">The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable | by Chen Erlich | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-04-09T15:07:55.614Z"/><meta data-rh="true" name="title" content="The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable | by Chen Erlich | Medium"/><meta data-rh="true" property="og:title" content="The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable"/><meta data-rh="true" property="al:android:url" content="medium://p/ac9b8b392767"/><meta data-rh="true" property="al:ios:url" content="medium://p/ac9b8b392767"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In May 2019, enSilo’s Threat Intelligence team observed activity by a cybercrime group, spreading Metamorfo — A Brazilian banking trojan. The variants we discovered abuse an executable digitally…"/><meta data-rh="true" property="og:description" content="Unveiling a new Brazilian banking campaign, abusing a legitimate Avast executable"/><meta data-rh="true" property="og:url" content="https://medium.com/@chenerlich/the-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@chenerlich/the-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:933/1*k5MIwsiJW3pkIWSipXZMoA.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@chenerlich"/><meta data-rh="true" name="author" content="Chen Erlich"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/ac9b8b392767"/><meta data-rh="true" property="twitter:description" content="Unveiling a new Brazilian banking campaign, abusing a legitimate Avast executable"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:933/1*k5MIwsiJW3pkIWSipXZMoA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="10 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@chenerlich"/><link data-rh="true" rel="canonical" href="https://medium.com/@chenerlich/the-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/ac9b8b392767"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*k5MIwsiJW3pkIWSipXZMoA.png"],"url":"https:\u002F\u002Fmedium.com\u002F@chenerlich\u002Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767","dateCreated":"2020-04-03T22:05:27.758Z","datePublished":"2020-04-03T22:05:27.758Z","dateModified":"2021-12-14T00:32:55.451Z","headline":"The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable","name":"The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable","description":"In May 2019, enSilo’s Threat Intelligence team observed activity by a cybercrime group, spreading Metamorfo — A Brazilian banking trojan. The variants we discovered abuse an executable digitally…","identifier":"ac9b8b392767","author":{"@type":"Person","name":"Chen Erlich","url":"https:\u002F\u002Fmedium.com\u002F@chenerlich"},"creator":["Chen Erlich"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@chenerlich\u002Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767"}</script><style type="text/css" data-fela-rehydration="563" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="563" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{line-height:1.58}.mh{letter-spacing:-0.004em}.mi{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nd{margin-bottom:-0.46em}.ne{text-decoration:underline}.nf{margin-left:auto}.ng{margin-right:auto}.nh{max-width:687px}.nn{clear:both}.no{height:auto}.np{line-height:1.12}.nq{letter-spacing:-0.022em}.nr{font-weight:600}.om{margin-bottom:-0.28em}.os{line-height:1.18}.pg{margin-bottom:-0.31em}.ph{max-width:933px}.pj{cursor:zoom-in}.pk{z-index:auto}.pm{margin-top:10px}.pn{max-width:728px}.pq{max-width:912px}.pr{list-style-type:decimal}.ps{margin-left:30px}.pt{padding-left:0px}.pu{max-width:916px}.pv{max-width:827px}.pw{max-width:950px}.px{margin:auto}.py{overflow:hidden}.pz{padding-bottom:100%}.qa{height:0}.qb{font-style:italic}.qc{max-width:860px}.qd{max-width:894px}.qe{max-width:793px}.qk{max-width:946px}.ql{max-width:869px}.qm{max-width:937px}.qn{max-width:849px}.qo{max-width:612px}.qp{max-width:930px}.qq{max-width:1054px}.qr{max-width:1177px}.qs{max-width:1020px}.qt{max-width:512px}.qu{max-width:964px}.qv{max-width:565px}.qw{font-style:inherit}.qx{list-style-type:disc}.qy{max-width:942px}.qz{margin-top:32px}.ra{margin-bottom:14px}.rb{padding-top:24px}.rc{padding-bottom:10px}.rd{background-color:#000000}.re{height:3px}.rf{width:3px}.rg{margin-right:20px}.rm{box-shadow:inset 0 0 0 1px #F2F2F2}.rn{padding:0px}.ro{padding:16px 20px}.rp{flex:1 1 auto}.rr{max-height:40px}.rs{text-overflow:ellipsis}.rt{display:-webkit-box}.ru{-webkit-line-clamp:2}.rv{-webkit-box-orient:vertical}.rx{margin-top:8px}.ry{margin-top:12px}.rz{width:160px}.sa{background-image:url(https://miro.medium.com/v2/da:true/resize:fit:320/0*5X3szIZsZ39R7lg8)}.sb{background-origin:border-box}.sc{background-size:cover}.sd{height:167px}.se{background-position:50% 50%}.sf{margin-bottom:26px}.sg{margin-top:6px}.sh{margin-right:8px}.si{padding:8px 16px}.sj{border-radius:100px}.sk{transition:background 300ms ease}.sm{white-space:nowrap}.sn{border-top:none}.st{height:52px}.su{max-height:52px}.sv{box-sizing:content-box}.sw{position:static}.sx{z-index:1}.sz{max-width:155px}.tk{align-items:flex-end}.tl{width:76px}.tm{height:76px}.tn{border:2px solid #F9F9F9}.to{height:72px}.tp{width:72px}.tq{stroke:#F2F2F2}.tr{height:36px}.ts{width:36px}.tt{color:#F2F2F2}.tu{fill:#F2F2F2}.tv{background:#F2F2F2}.tw{border-color:#F2F2F2}.uc{font-weight:500}.ud{font-size:24px}.ue{line-height:30px}.uf{letter-spacing:-0.016em}.ug{margin-top:16px}.uh{height:0px}.ui{border-bottom:solid 1px #E5E5E5}.uo{margin-top:72px}.up{padding:24px 0}.uq{margin-bottom:0px}.ur{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.sl:hover{background-color:#F2F2F2}.tx:hover{background:#F2F2F2}.ty:hover{border-color:#F2F2F2}.tz:hover{cursor:wait}.ua:hover{color:#F2F2F2}.ub:hover{fill:#F2F2F2}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.pl:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mz{font-size:20px}.na{margin-top:2.14em}.nb{line-height:32px}.nc{letter-spacing:-0.003em}.nm{margin-top:56px}.oi{font-size:24px}.oj{margin-top:1.95em}.ok{line-height:30px}.ol{letter-spacing:-0.016em}.or{margin-top:0.94em}.pd{margin-top:1.72em}.pe{line-height:24px}.pf{letter-spacing:0}.qj{margin-top:1.14em}.rl{margin-top:32px}.ss{margin-bottom:88px}.te{display:inline-block}.tj{padding-top:72px}.un{margin-top:40px}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.po{margin-left:auto}.pp{text-align:center}.td{display:inline-block}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.tc{display:inline-block}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.rq{padding:10px 12px 10px}.tb{display:inline-block}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{font-size:18px}.mk{margin-top:1.56em}.ml{line-height:28px}.mm{letter-spacing:-0.003em}.ni{margin-top:40px}.ns{font-size:20px}.nt{margin-top:1.2em}.nu{line-height:24px}.nv{letter-spacing:0}.on{margin-top:0.67em}.ot{font-size:16px}.ou{margin-top:1.23em}.qf{margin-top:1.34em}.rh{margin-top:24px}.so{margin-bottom:80px}.ta{display:inline-block}.tf{padding-top:48px}.uj{margin-top:32px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mv{font-size:20px}.mw{margin-top:2.14em}.mx{line-height:32px}.my{letter-spacing:-0.003em}.nl{margin-top:56px}.oe{font-size:24px}.of{margin-top:1.95em}.og{line-height:30px}.oh{letter-spacing:-0.016em}.oq{margin-top:0.94em}.pa{margin-top:1.72em}.pb{line-height:24px}.pc{letter-spacing:0}.qi{margin-top:1.14em}.rk{margin-top:32px}.sr{margin-bottom:88px}.ti{padding-top:72px}.um{margin-top:40px}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mr{font-size:20px}.ms{margin-top:2.14em}.mt{line-height:32px}.mu{letter-spacing:-0.003em}.nk{margin-top:56px}.oa{font-size:24px}.ob{margin-top:1.95em}.oc{line-height:30px}.od{letter-spacing:-0.016em}.op{margin-top:0.94em}.ox{margin-top:1.72em}.oy{line-height:24px}.oz{letter-spacing:0}.qh{margin-top:1.14em}.rj{margin-top:32px}.sq{margin-bottom:88px}.th{padding-top:72px}.ul{margin-top:40px}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mn{font-size:18px}.mo{margin-top:1.56em}.mp{line-height:28px}.mq{letter-spacing:-0.003em}.nj{margin-top:40px}.nw{font-size:20px}.nx{margin-top:1.2em}.ny{line-height:24px}.nz{letter-spacing:0}.oo{margin-top:0.67em}.ov{font-size:16px}.ow{margin-top:1.23em}.qg{margin-top:1.34em}.ri{margin-top:24px}.sp{margin-bottom:80px}.tg{padding-top:48px}.uk{margin-top:32px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="print">.sy{display:none}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pi{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="563" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.rw{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fac9b8b392767&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="7f01" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><a rel="noopener follow" href="/@chenerlich?source=post_page-----ac9b8b392767--------------------------------"><div><div class="bm" aria-hidden="false"><div class="l ib ic by id ie"><div class="l fj"><img alt="Chen Erlich" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*wa8EmI4fidGpDV1zC1K44g.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></div></div></a></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/@chenerlich?source=post_page-----ac9b8b392767--------------------------------">Chen Erlich</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F63409eb2f083&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;user=Chen+Erlich&amp;userId=63409eb2f083&amp;source=post_page-63409eb2f083----ac9b8b392767---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Apr 3, 2020</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fac9b8b392767&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;user=Chen+Erlich&amp;userId=63409eb2f083&amp;source=-----ac9b8b392767---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac9b8b392767&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;source=-----ac9b8b392767---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="8fb7" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Source</strong>: ensilo.com/BreakingMalware <br/><strong class="mi gv">Twitter</strong>: <a class="af ne" href="https://twitter.com/chen_erlich" rel="noopener ugc nofollow" target="_blank">@chen_erlich</a></p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng nh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1374/format:webp/1*kEOUNI0DgWIcec9FsG4NiQ.png 1374w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 687px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*kEOUNI0DgWIcec9FsG4NiQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kEOUNI0DgWIcec9FsG4NiQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kEOUNI0DgWIcec9FsG4NiQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kEOUNI0DgWIcec9FsG4NiQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kEOUNI0DgWIcec9FsG4NiQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kEOUNI0DgWIcec9FsG4NiQ.png 1100w, https://miro.medium.com/v2/resize:fit:1374/1*kEOUNI0DgWIcec9FsG4NiQ.png 1374w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 687px"/><img alt="" class="bh ln no c" width="687" height="199" loading="eager" role="presentation"/></picture></div></figure><h1 id="3a96" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk">SUMMARY</h1><p id="d5f7" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">In May 2019, enSilo’s Threat Intelligence team observed activity by a cybercrime group, spreading Metamorfo — A Brazilian banking trojan. The variants we discovered abuse an executable digitally signed by Avast, which is one of the most popular AV products in the world for consumers. We were able to connect this activity to a <a class="af ne" href="https://blog.trendmicro.com/trendlabs-security-intelligence/analysis-abuse-of-custom-actions-in-windows-installer-msi-to-run-malicious-javascript-vbscript-and-powershell-scripts/" rel="noopener ugc nofollow" target="_blank">campaign reported by TrendMicro</a> which targeted an executable by a different Anti-Virus vendor, Avira. This<br/>further highlights the Modus-Operandi of the group.</p><p id="d36c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This blog post describes in detail one of the variants used in this campaign and highlights unique Tactics, Techniques and Procedures (TTPs) used in this campaign which were not previously disclosed.</p><h1 id="1308" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk">TECHNICAL ANALYSIS</h1><p id="aada" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">In May 2019, enSilo detected a new activity by a Brazilian cybercrime group. Both loader variants and their respective payloads that were analyzed share similar TTPs and code associated with a Brazilian cybercrime group.</p><h2 id="bf2b" class="os nq gu bf nr ot ou dy nv ov ow ea nz mr ox oy oz mv pa pb pc mz pd pe pf pg bk">Execution Flow Overview</h2><p id="5061" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">On execution, the MSI downloader starts by checking if it is running in a virtual machine. If not, downloads a zip file, unzips it, deletes itself, establishes persistency and restarts the system.</p><p id="e46a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The zip file contains the following files:<br/>1. <strong class="mi gv">jesus.exe</strong> — Signed AVDump32 — Avast’s memory dump utility. Renamed to a random name.<br/>2. <strong class="mi gv">dbghelp.dll </strong>— Malicious file to be side loaded by AJWrDz.exe.</p><p id="5f73" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">3. <strong class="mi gv">jesus.dmp </strong>— Payload to be loaded by the injected Windows Media Player<br/>executable (wmplayer.exe). Later renamed to the same random name as<br/>jesus.exe with a .dmp extension.<br/>4.<strong class="mi gv"> ssleay64.dll </strong>— Known variant of Metamorfo. Will be loaded and used in the<br/>injected wmplayer.exe.<br/>5. <strong class="mi gv">ssleay32.dll </strong>— OpenSSL Shared Library.<br/>6. <strong class="mi gv">borlndmm.dll </strong>— Borland Memory Manager.<br/>7. <strong class="mi gv">libeay32.dll</strong> — OpenSSL Shared Library.</p><p id="785e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">During the rest of the analysis we will refer jesus.exe as “AJWrDz.exe” which is the random name generated in this execution. After the system reboots, the file “AJWrDz.exe” executes, which in turn triggers the side-loading of the malicious (and fake) DLL file “dbghelp.dll”. This malicious DLL file injects itself to Windows Media Player process — wmplayer.exe, and reflectively loads the renamed jesus.dmp file, “AJWrDz.dmp”.</p><p id="7a06" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The following diagram describes the high-level execution flow of the variants in this campaign:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng ph"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5MIwsiJW3pkIWSipXZMoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*k5MIwsiJW3pkIWSipXZMoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*k5MIwsiJW3pkIWSipXZMoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*k5MIwsiJW3pkIWSipXZMoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*k5MIwsiJW3pkIWSipXZMoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*k5MIwsiJW3pkIWSipXZMoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*k5MIwsiJW3pkIWSipXZMoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*k5MIwsiJW3pkIWSipXZMoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="388" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 1: Execution flow</strong></figcaption></figure><h1 id="ea50" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk">MSI DOWNLOADER</h1><p id="ee60" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">The following is the static characteristics of the <a class="af ne" href="https://docs.microsoft.com/en-us/windows/desktop/msi/windows-installer-portal" rel="noopener ugc nofollow" target="_blank">Windows Installer (MSI)</a> downloader which starts the infection, this MSI downloader is similar to the one used in the earlier part of the campaign:</p><p id="0d28" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">File Name</strong>: HNR-Not03958576535323.msi</p><p id="92c7" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">SHA1</strong>: F1498E679885389C32FDF5EC39813FE5D4D34F23</p><p id="7972" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Size</strong>: 287232 bytes</p><p id="a181" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Creation Time</strong>: 2009–12–11 11:47:44</p><p id="7b11" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">During the time of analysis this variant had very low detection rate in VirusTotal, as can be seen in figure 2:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWBfpqqzcn-2x76_scPOUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*eWBfpqqzcn-2x76_scPOUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eWBfpqqzcn-2x76_scPOUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eWBfpqqzcn-2x76_scPOUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eWBfpqqzcn-2x76_scPOUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eWBfpqqzcn-2x76_scPOUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eWBfpqqzcn-2x76_scPOUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eWBfpqqzcn-2x76_scPOUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="258" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 2: VirusTotal detection rate</strong></figcaption></figure><p id="474c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">All MSI files in this campaign have different names, but share unique characteristics:</p><ol class=""><li id="0fce" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd pr ps pt bk">Disguised as “<strong class="mi gv">Adobe Acrobat Reader Installer</strong>” to look legitimate as seen in figure 3:</li></ol><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng pu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mq-QXYZ6IWteivrWr4qE3A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mq-QXYZ6IWteivrWr4qE3A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mq-QXYZ6IWteivrWr4qE3A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mq-QXYZ6IWteivrWr4qE3A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mq-QXYZ6IWteivrWr4qE3A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mq-QXYZ6IWteivrWr4qE3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mq-QXYZ6IWteivrWr4qE3A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mq-QXYZ6IWteivrWr4qE3A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="317" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 3: Disguise as Adobe Acrobat Reader</strong></figcaption></figure><p id="63d9" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">2. Created using the “<strong class="mi gv">Advanced Installer</strong>” tool, which is imported in all of them, as shown in figure 4.</p><p id="4854" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">3. Contain a <strong class="mi gv">vmdetect.exe </strong>[MD5: 55FFEE241709AE96CF64CB0B9A96F0D7] to avoid detection, as shown in figure 4:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*gQ5fyh_fxkhE3nbmnY2z2Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="260" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 4: Embedded aicustact.dll and vmdetect.exe</strong></figcaption></figure><p id="8c4f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">4. Use the <a class="af ne" href="https://docs.microsoft.com/en-us/windows/win32/msi/customaction-table" rel="noopener ugc nofollow" target="_blank"><strong class="mi gv">CustomActions</strong> <strong class="mi gv">table</strong></a>. The CustomAction table enables integration of custom code and data into an installation. The source of the code that is executed can be a stream contained within the database, a recently installed file, or an existing executable file. The attackers abused this feature to add the malicious JavaScript/VBS payload as shown in figure 5.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fLRL1RVqeU_GqRx8ls4kTQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*fLRL1RVqeU_GqRx8ls4kTQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*fLRL1RVqeU_GqRx8ls4kTQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*fLRL1RVqeU_GqRx8ls4kTQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*fLRL1RVqeU_GqRx8ls4kTQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*fLRL1RVqeU_GqRx8ls4kTQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*fLRL1RVqeU_GqRx8ls4kTQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*fLRL1RVqeU_GqRx8ls4kTQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="210" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 5: Malicious JavaScript payload in CustomActions table</strong></figcaption></figure><h1 id="2cf6" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk"><strong class="al">The JavaScript payload</strong></h1><p id="2cfb" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">The downloader’s JavaScript payload is obfuscated:</p><figure class="ni nj nk nl nm nn"><div class="px py l fj"><div class="pz qa l"></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du">Figure 6: Obfuscated MSI payload</figcaption></figure><p id="d810" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">After deobfuscation:</p><figure class="ni nj nk nl nm nn"><div class="px py l fj"><div class="pz qa l"></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du">Figure 7: Deobfuscated MSI payload</figcaption></figure><p id="aea1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The samples in this campaign communicate with a URL in the following format: <em class="qb">https://s3-eu-west-1[.]amazonaws[.]com/{random}/image2[.]png.</em><br/> The ”{random}” part may change between different MSI downloaders. The image2.png file is actually a zip file which is downloaded and extracted to a target folder. In this variant it is extracted to <em class="qb">%APPDATA%\Macromedia</em>. Next, the MSI downloader creates in this location a <em class="qb">desktop.txt</em> file containing the string “NULL”.</p><p id="d1b0" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The purpose of the <em class="qb">desktop.txt</em> file is to indicate whether the system is infected by the malware. If it exists, the MSI will exit after it will open Adobe’s website to explain how to install updates. It does so by executing:</p><p id="c4d1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><em class="qb">“c:\Windows\System32\cmd.exe /C start /MAX https://helpx.adobe[.]com/</em><strong class="mi gv"><em class="qb">br</em></strong><em class="qb">/acrobat/kb/install-updates-reader-acrobat.html”</em></p><p id="d879" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Otherwise, it will open legal terms of use page in Adobe’s site and continue the payload execution. This following command executes to open the terms of use page:</p><p id="048c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">“<em class="qb">c:\Windows\System32\cmd.exe /C start /MAX https://adobe.ly/2RY5GJR</em>”</p><p id="87f7" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">which will redirect to “<em class="qb">https://www.adobe.com/</em><strong class="mi gv"><em class="qb">br</em></strong><em class="qb">/legal/terms.html”</em>.</p><p id="659f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Note that both URLs are with the Brazilian 2-letter abbreviation, suggesting the victims’ origin.</p><p id="9a37" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The files are extracted to a newly created folder with a randomized name under the same path, and the zip file is then deleted. The “AJWrDz.exe” executable path is written to the registry Run key “<em class="qb">HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</em>” to achieve persistency. As a final step the system is restarted to trigger its execution.</p><h1 id="694f" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk">THE AVAST ABUSE</h1><p id="d04f" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">After the system restart, the “AJWrDz.exe” file executes. Its static characteristics are:</p><p id="5869" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">File Name</strong>: AJWrDz.exe (renamed from jesus.exe)</p><p id="e9e7" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">SHA1</strong>: 2A1A5D7C85560924EDC434A1D2F23ED3445D86F4</p><p id="9dab" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Size</strong>: 814296 bytes</p><p id="3b13" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Creation Time</strong>: 2018–10–08 13:07:15</p><p id="9aaa" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This is a legitimate file, <strong class="mi gv">AVDump32.exe,</strong> digitally signed by<strong class="mi gv"> “AVAST Software</strong>” as shown in figure 8:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOB2620wD2ciN1H1kJBoGA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KOB2620wD2ciN1H1kJBoGA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KOB2620wD2ciN1H1kJBoGA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KOB2620wD2ciN1H1kJBoGA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KOB2620wD2ciN1H1kJBoGA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KOB2620wD2ciN1H1kJBoGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KOB2620wD2ciN1H1kJBoGA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*KOB2620wD2ciN1H1kJBoGA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="537" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 8: AJWrDz.exe VirusTotal details</strong></figcaption></figure><p id="8ce6" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">AvDump32.exe legitimate use is to create *.dmp files of Avast processes in case there is an unhandled exception. When Avast is installed legitimately on a system the file is located in Its original location: C:\Program Files\AVAST Software\Avast.</p><p id="adc4" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Figure 9 suggests that this file was submitted to VirusTotal as “jesus.exe”, which is the name of the file in the downloaded zip, before it’s being renamed in the MSI payload:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyGH8nVwclvyabrJykC7cw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*LyGH8nVwclvyabrJykC7cw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*LyGH8nVwclvyabrJykC7cw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*LyGH8nVwclvyabrJykC7cw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*LyGH8nVwclvyabrJykC7cw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*LyGH8nVwclvyabrJykC7cw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*LyGH8nVwclvyabrJykC7cw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*LyGH8nVwclvyabrJykC7cw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="326" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 9: AvDump32.exe name variations</strong></figcaption></figure><p id="ceed" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">AvDump32.exe is abused by the Metamorfo to side-load the “dbghelp.dll” by leveraging the DLL search order. Note that this is a common issue which makes it possible to leverage the DLL side-loading attack, often referred to as DLL Hijacking. Figure 10 shows the DLL files imported by this executable:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ayJSNBHL_HTde_H-pXXqlg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ayJSNBHL_HTde_H-pXXqlg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ayJSNBHL_HTde_H-pXXqlg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ayJSNBHL_HTde_H-pXXqlg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ayJSNBHL_HTde_H-pXXqlg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ayJSNBHL_HTde_H-pXXqlg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ayJSNBHL_HTde_H-pXXqlg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ayJSNBHL_HTde_H-pXXqlg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="240" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 10: ADWrDz.exe (AvDump32.exe) imports</strong></figcaption></figure><p id="5217" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">You can find another example of abusing the DLL search order in one of our previous <a class="af ne" href="https://blog.ensilo.com/ensilo-terminates-dll-search-order-hijacking" rel="noopener ugc nofollow" target="_blank">blog posts</a>.</p><p id="8d4b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The side loaded “dbghelp.dll” is a malicious file written in Delphi and compiled using the Embarcadero Delphi IDE with the following characteristics:</p><p id="162e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">File Name</strong>: dbghelp.dll</p><p id="e707" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">SHA1</strong>: 08823578841AEED044EAD81ED6DB16DD95B6FF4B</p><p id="4451" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Size</strong>: 5595136 bytes</p><p id="58b6" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Creation Time</strong>: 2019–04–27 22:17:17</p><p id="c216" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">After being side-loaded by AvDump32.exe, the DLL’s execution starts with the following steps:</p><ol class=""><li id="9989" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd pr ps pt bk">Resolves WINAPI functions</li><li id="c339" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd pr ps pt bk">Hides its GUI using <em class="qb">ShowWindow </em>WINAPI call</li><li id="45ca" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd pr ps pt bk">Compares if the DLL is being ran by wmplayer. More on this later.</li></ol><p id="c689" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Next, the DLL file creates the mutex — <em class="qb">[7F4HRE-375E-AEF3-BE9A-OBJT389F53]</em> and writes to <em class="qb">HKCU\Software\index (</em>as shown in figure 11) the name of the running process which is later used to know the name of the .dmp file that should be loaded. Finally, it injects itself to Windows Media Player executable — <strong class="mi gv">wmplayer.exe</strong>.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYMvJNN82fO44zKpD7EW3A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qYMvJNN82fO44zKpD7EW3A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qYMvJNN82fO44zKpD7EW3A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qYMvJNN82fO44zKpD7EW3A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qYMvJNN82fO44zKpD7EW3A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qYMvJNN82fO44zKpD7EW3A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qYMvJNN82fO44zKpD7EW3A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qYMvJNN82fO44zKpD7EW3A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="300" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 11: Registry artifact</strong></figcaption></figure><p id="eafd" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The process wmplayer.exe is a rather strange victim for injection given that various Windows distributions don’t come with Windows Media Player installed by default, so it can only be implied that this software is probably more common in the victim’s origin, and that it probably targets home users.</p><p id="9cb6" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Metamorfo uses a DLL injection technique with a twist. Instead of getting a handle to the victim process using <em class="qb">OpenProcess,</em> which relies on having a running process, the injection uses <em class="qb">CreateProcess</em> with CREATE_SUSPENDED flag. Then it creates a remote thread which loads the malicious DLL and executes it. The process’ main thread is never resumed and thus only the malware code executes. Figure 12 shows the <em class="qb">CreateProcess </em>call:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3AcMvBru3g0hEhXuSId4cQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3AcMvBru3g0hEhXuSId4cQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3AcMvBru3g0hEhXuSId4cQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3AcMvBru3g0hEhXuSId4cQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3AcMvBru3g0hEhXuSId4cQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3AcMvBru3g0hEhXuSId4cQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3AcMvBru3g0hEhXuSId4cQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*3AcMvBru3g0hEhXuSId4cQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="267" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 12: The start of the DLL injection</strong></figcaption></figure><p id="9986" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The injection flow is as follows:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQHTPWpEPEgZs7e2phx58w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*PQHTPWpEPEgZs7e2phx58w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PQHTPWpEPEgZs7e2phx58w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PQHTPWpEPEgZs7e2phx58w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PQHTPWpEPEgZs7e2phx58w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PQHTPWpEPEgZs7e2phx58w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PQHTPWpEPEgZs7e2phx58w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*PQHTPWpEPEgZs7e2phx58w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="56" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 13: DLL injection flow</strong></figcaption></figure><h1 id="9e30" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk">INJECTED PAYLOAD</h1><p id="fb16" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">Upon injection, the DLL validates that it runs under the wmplayer.exe process by checking the process name and goes on to execute its malicious activity. It creates a second mutex — <em class="qb">One-InstanceJes</em>, resolves more WINAPI functions, checks for the registry “index” key (which was previously written)the execution location and for the “ADWrDz.dmp” file. If this file exists, it extracts it in-memory using <em class="qb">RtlDecompressFragment</em> and reflectively loads it.</p><h2 id="798e" class="os nq gu bf nr ot ou dy nv ov ow ea nz mr ox oy oz mv pa pb pc mz pd pe pf pg bk"><strong class="al">No DEP</strong></h2><p id="cffc" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">dbghelp.dll is incompatible with <a class="af ne" href="https://docs.microsoft.com/en-us/windows/win32/memory/data-execution-prevention" rel="noopener ugc nofollow" target="_blank">DEP (Data Exception Prevention)</a>, as shown in Figure 14. Thus, when it loads the operating system will disable DEP for the injected wmplayer.exe process. This means that code can be executed from memory regions that are not marked as executable in the context of this process.</p><p id="9c6b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Metamorpho uses this to execute the reflectively loaded payload from a non-executable region. This makes the payload harder to detect by memory forensics toolkits and security products which many times look specifically for executable memory.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzF3L4Pec7xpfutZTEnStQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZzF3L4Pec7xpfutZTEnStQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZzF3L4Pec7xpfutZTEnStQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZzF3L4Pec7xpfutZTEnStQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZzF3L4Pec7xpfutZTEnStQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZzF3L4Pec7xpfutZTEnStQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZzF3L4Pec7xpfutZTEnStQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZzF3L4Pec7xpfutZTEnStQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="236" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 14: dbghelp.dll is incompatible with NX</strong></figcaption></figure><h2 id="3853" class="os nq gu bf nr ot ou dy nv ov ow ea nz mr ox oy oz mv pa pb pc mz pd pe pf pg bk"><strong class="al">Leveraging CreateTimerQueueTimer</strong></h2><p id="2c62" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">Once “ADWrDz.dmp” is loaded into memory Metamorfo leverages the <em class="qb">CreateTimerQueueTimer </em>WINAPI call to execute it (as shown in figure 14).</p><p id="5f0e" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><em class="qb">CreateTimerQueueTimer</em> is a WINAPI that creates a <a class="af ne" href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms686796(v=vs.85).aspx" rel="noopener ugc nofollow" target="_blank">queue for timers</a>. These timer objects allow the selection of a callback function at a specified time. The original function of the API is to be part of the process chain by creating a timer routine, but here, the callback function of the API is the entry point of the malware’s actual payload.</p><p id="4e26" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The use of <em class="qb">CreateTimerQueueTimer </em>makes detection harder since the payload will not run in the remote thread context.</p><p id="eb10" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">This kind of technique was previously used in malware variants such as Emotet and Hancitor.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 1100w, https://miro.medium.com/v2/resize:fit:1224/format:webp/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 1224w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 612px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 1100w, https://miro.medium.com/v2/resize:fit:1224/1*-Yk1FZBoz5Q4L6iuWvX6WA.png 1224w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 612px"/><img alt="" class="bh ln no c" width="612" height="199" loading="lazy" role="presentation"/></picture></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 15: CreateTimerQueueTimer exploit</strong></figcaption></figure><p id="1e83" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Throughout the “ADWrDz.dmp” execution, it outputs debug comments in Portuguese as shown in figure 16:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAp0E_LojGO0EEnNgiSJUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*qAp0E_LojGO0EEnNgiSJUA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*qAp0E_LojGO0EEnNgiSJUA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*qAp0E_LojGO0EEnNgiSJUA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*qAp0E_LojGO0EEnNgiSJUA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*qAp0E_LojGO0EEnNgiSJUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*qAp0E_LojGO0EEnNgiSJUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*qAp0E_LojGO0EEnNgiSJUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="55" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 16: Debugged output “Tela Azul” in Portugese which means “Blue Screen”</strong></figcaption></figure><p id="309b" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Entering the <em class="qb">CreateTimerQueueTimer </em>callback, Metamorfo creates another mutex — <em class="qb">libea54</em>, and starts checking for the existence of directories and files relevant for its execution. Since there are multiple variations of Metamorfo in this campaign, the attackers used different locations in the file system to drop their files, see IOCs section.</p><p id="727a" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Next, Metamorfo checks for the existence of “mreb.xml” and “mreboot”, as can be seen in figure 17. These artifacts were not available to us and we couldn’t verify their purpose.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-jo9R9mYA6GGDWhrTL6IA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*X-jo9R9mYA6GGDWhrTL6IA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*X-jo9R9mYA6GGDWhrTL6IA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*X-jo9R9mYA6GGDWhrTL6IA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*X-jo9R9mYA6GGDWhrTL6IA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*X-jo9R9mYA6GGDWhrTL6IA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*X-jo9R9mYA6GGDWhrTL6IA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*X-jo9R9mYA6GGDWhrTL6IA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="49" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 17: Metamorfo looks for mreb.xml &amp; mreboot folde</strong>r</figcaption></figure><p id="694d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If they aren’t found, it creates another mutex by the name — <em class="qb">[7F4HRE-375E-AEF3-BE9A-OBJT389F53]. </em>Then, it checks internet connection by trying to resolve “<em class="qb">goole.com</em>” (Misspelled) address. If internet connection is available,</p><p id="bea6" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">it sends a GET request to “<em class="qb">https://www.localizaip.com[.]br/api/iplocation.php” </em>to retrieve geo data.</p><p id="7074" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Metamorfo’s C&amp;C communication is encrypted using the dropped OpenSSL libraries libeay32.dll and ssleay32.dll.</p><p id="1b25" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Based on the gathered data, if the victim is not from Brazil or Portugal it will print the following output and send the collected data to the C&amp;C “<em class="qb">https://x1-lb12.internal[.]gocache.me”,</em> which resided in Brazil, and finish.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCSXuU-QqduOu6pmYjqMoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*GCSXuU-QqduOu6pmYjqMoA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GCSXuU-QqduOu6pmYjqMoA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GCSXuU-QqduOu6pmYjqMoA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GCSXuU-QqduOu6pmYjqMoA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GCSXuU-QqduOu6pmYjqMoA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GCSXuU-QqduOu6pmYjqMoA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*GCSXuU-QqduOu6pmYjqMoA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="38" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 18: Debug output of the collected dat</strong>a</figcaption></figure><p id="9f9f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If the victim is from Brazil or Portugal, it will start monitoring running applications in the system using a message loop:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PD0gEW-ZN575FcO8BVYhkA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*PD0gEW-ZN575FcO8BVYhkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PD0gEW-ZN575FcO8BVYhkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PD0gEW-ZN575FcO8BVYhkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PD0gEW-ZN575FcO8BVYhkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PD0gEW-ZN575FcO8BVYhkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PD0gEW-ZN575FcO8BVYhkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*PD0gEW-ZN575FcO8BVYhkA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="124" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 19: Debugging running application</strong></figcaption></figure><h1 id="93dc" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk"><strong class="al">The ssleay64.dll payload</strong></h1><p id="b0f6" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">If the malware identifies a file named “mreb.xml” or a folder named “mreboot”, it loads a malicious “ssleay64.dll”, also written in Delphi, compiled by Borland Delphi, which has the following characteristics:</p><p id="7130" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">File Name</strong>: ssleay64.dll</p><p id="c44f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">SHA1</strong>: F5E63580710E8FA884377A746FC822E5</p><p id="2a03" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Size</strong>: <a class="af ne" href="https://www.virustotal.com/gui/search/size%25253A1445888" rel="noopener ugc nofollow" target="_blank">1445888</a> bytes</p><p id="c2a3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Creation Time</strong>: 2019–04–08 12:15:27</p><p id="d11c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">The DLL holds various resources. Some of them are encrypted and will be used as payloads to steal victim’s data, while others are cursor related resources.</p><p id="e29f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Like samples from previous campaigns Metamorfo can display fake forms on targeted banking sites and steal credentials from the victims. On previous <a class="af ne" href="https://www.fireeye.com/blog/threat-research/2018/04/metamorfo-campaign-targeting-brazilian-users.html" rel="noopener ugc nofollow" target="_blank">campaigns</a> Metamorfo used Windows Update to hide its malicious activity. Similarly, in this campaign Metamorfo uses a fake “Blue Screen” window. It does so after disabling the taskbar as can be seen in Figures 20 and 21:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 1100w, https://miro.medium.com/v2/resize:fit:1024/format:webp/1*ZYQatoVhdI6Gjj8FBfhgNw.png 1024w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 512px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZYQatoVhdI6Gjj8FBfhgNw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZYQatoVhdI6Gjj8FBfhgNw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZYQatoVhdI6Gjj8FBfhgNw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZYQatoVhdI6Gjj8FBfhgNw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZYQatoVhdI6Gjj8FBfhgNw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZYQatoVhdI6Gjj8FBfhgNw.png 1100w, https://miro.medium.com/v2/resize:fit:1024/1*ZYQatoVhdI6Gjj8FBfhgNw.png 1024w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 512px"/><img alt="" class="bh ln no c" width="512" height="194" loading="lazy" role="presentation"/></picture></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 20: Disabling Taskbar</strong></figcaption></figure><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*w2esdM201pvIwGygjnHR_A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*w2esdM201pvIwGygjnHR_A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*w2esdM201pvIwGygjnHR_A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*w2esdM201pvIwGygjnHR_A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*w2esdM201pvIwGygjnHR_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*w2esdM201pvIwGygjnHR_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w2esdM201pvIwGygjnHR_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*w2esdM201pvIwGygjnHR_A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*w2esdM201pvIwGygjnHR_A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*w2esdM201pvIwGygjnHR_A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*w2esdM201pvIwGygjnHR_A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*w2esdM201pvIwGygjnHR_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*w2esdM201pvIwGygjnHR_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*w2esdM201pvIwGygjnHR_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="284" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 21: “Blue Screen”</strong></figcaption></figure><h2 id="5bcc" class="os nq gu bf nr ot ou dy nv ov ow ea nz mr ox oy oz mv pa pb pc mz pd pe pf pg bk"><strong class="al">Evading Banking Protection &amp; Anti-Fraud Products</strong></h2><p id="b207" class="pw-post-body-paragraph mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd gn bk">Metamorfo also makes efforts to evade banking protection and anti-fraud products by setting a hook on <em class="qb">LoadLibraryW </em>function and checking which DLL is loaded, the trampoline can be seen in Figure 22:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng qv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 1100w, https://miro.medium.com/v2/resize:fit:1130/format:webp/1*2KwWxKIMKETu9WRa0bNk9g.png 1130w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 565px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*2KwWxKIMKETu9WRa0bNk9g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2KwWxKIMKETu9WRa0bNk9g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2KwWxKIMKETu9WRa0bNk9g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2KwWxKIMKETu9WRa0bNk9g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2KwWxKIMKETu9WRa0bNk9g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2KwWxKIMKETu9WRa0bNk9g.png 1100w, https://miro.medium.com/v2/resize:fit:1130/1*2KwWxKIMKETu9WRa0bNk9g.png 1130w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 565px"/><img alt="" class="bh ln no c" width="565" height="143" loading="lazy" role="presentation"/></picture></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 22: Trampoline based hook in <em class="qw">LoadLibraryW</em></strong></figcaption></figure><p id="5745" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">With the help of this trampoline, for every <em class="qb">LoadLibraryW</em> call the attackers will check if the DLL to be loaded contains one of the following anti-fraud and banking protection strings:</p><ul class=""><li id="da8f" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qx ps pt bk">Gbpinj</li><li id="6a2d" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Scpbrad</li><li id="aa63" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Scpad</li><li id="d38a" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Trusteer</li><li id="73cc" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Warsaw</li><li id="7068" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Gblplugin</li><li id="ec2f" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Ipsbho</li><li id="042c" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Hook</li></ul><p id="5441" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">If one of them is matched, the DLL <em class="qb">LoadLibraryW </em>call is trying to load wouldn’t load.</p><p id="81a0" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Figure 23 shows a few searched strings:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="pi pj fj pk bh pl"><div class="nf ng qy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KOMcnV1aNn7f4ooP1FSxUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KOMcnV1aNn7f4ooP1FSxUA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KOMcnV1aNn7f4ooP1FSxUA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KOMcnV1aNn7f4ooP1FSxUA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KOMcnV1aNn7f4ooP1FSxUA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KOMcnV1aNn7f4ooP1FSxUA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KOMcnV1aNn7f4ooP1FSxUA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*KOMcnV1aNn7f4ooP1FSxUA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln no c" width="700" height="277" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pm ff pn nf ng po pp bf b bg z du"><strong class="bf nr">Figure 23: Some of the banking protection and anti-fraud searched strings</strong></figcaption></figure><h1 id="773d" class="np nq gu bf nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk"><strong class="al">IOCS</strong></h1><h2 id="0f93" class="os nq gu bf nr ot ou dy nv ov ow ea nz mr ox oy oz mv pa pb pc mz pd pe pf pg bk"><strong class="al">Hashes:</strong></h2><ul class=""><li id="1af7" class="mg mh gu mi b mj on ml mm mn oo mp mq mr op mt mu mv oq mx my mz or nb nc nd qx ps pt bk">MSI — F1498E679885389C32FDF5EC39813FE5D4D34F23</li><li id="4d0e" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Other related samples <a class="af ne" href="https://gist.github.com/chenerlich/4e7a22a6263383a4ce3810082a8ac991" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/chenerlich/4e7a22a6263383a4ce3810082a8ac991</a></li><li id="75bf" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">AvDump32.exe — 2A1A5D7C85560924EDC434A1D2F23ED3445D86F4</li><li id="2136" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Dbghelp.dll — 08823578841AEED044EAD81ED6DB16DD95B6FF4B</li><li id="33f9" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Other related samples <a class="af ne" href="https://gist.github.com/chenerlich/0095444e60ae4d04ab75721dec522287" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/chenerlich/0095444e60ae4d04ab75721dec522287</a></li><li id="414f" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">Ssleay64.dll -</li><li id="0ec3" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">F5E63580710E8FA884377A746FC822E5</li><li id="9297" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">C00BF102482C61E4CAB3C6B6666697779092FADC</li><li id="d83b" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">6242CC3009A96F97AB9586C970DB26EDE5512F9A</li><li id="b953" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">03A5BEF2B9DE1DF5C19C9F4D2AEC6F780F4749D0</li><li id="16c6" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">C15154D7323EA0C7A40912C799599DACCEB4E7CE</li></ul><p id="6d1c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">URLs:</strong></p><p id="e059" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://s3-eu-west-1[.]amazonaws.com/disenyrt3/image2.png</p><p id="cbcc" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://s3-eu-west-1[.]amazonaws.com/sharknadorki/image2.png</p><p id="b3d0" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://s3-eu-west-1[.]amazonaws.com/jasonrwk5wg/image2.png</p><p id="5fcd" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://s3-eu-west-1[.]amazonaws.com/frezaaaewrwty/image2.png</p><p id="a25c" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://s3-eu-west-1[.]amazonaws.com/cadeaadl54t4gw4/image2.png</p><p id="5870" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://s3-eu-west-1[.]amazonaws.com/sharknadorki/image2.png<br/> <!-- -->https://s3-eu-west-1[.]amazonaws.com/jooosan/image2.png<br/> <!-- -->https://s3-eu-west-1[.]amazonaws.com/shhakkr/image2.png</p><p id="b2b3" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">www.goole[.]com</p><p id="956f" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">https://www.localizaip.com[.]br/api/iplocation.php</p><p id="28dd" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">mrs04s09-in-f206.1e100[.]net</p><p id="37a7" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">lhr25s13-in-f78.1e100[.]net</p><p id="3b12" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">dub08s01-in-f14.1e100[.]net</p><p id="aca1" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">lhr25s11-in-f46.1e100[.]net</p><p id="eb0d" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Files:</strong></p><ul class=""><li id="2413" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qx ps pt bk">%APPDATA%\Macromedia</li><li id="fb5f" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\Macromedia\desktop.txt</li><li id="d4b3" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\TeamViewer</li><li id="2510" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\TeamViewer\desktop.txt</li><li id="a8ef" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\DMCache</li><li id="f789" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\DMCache\desktop.txt</li><li id="8dcc" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\AnyDesk</li><li id="f01e" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">%APPDATA%\AnyDesk\desktop.txt</li></ul><p id="8026" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Registry:</strong></p><ul class=""><li id="38b4" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qx ps pt bk">HKCU\Software\index</li></ul><p id="d4d5" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk"><strong class="mi gv">Mutexes:</strong></p><ul class=""><li id="bd3f" class="mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qx ps pt bk">[7F4HRE-375E-AEF3-BE9A-OBJT389F53]</li><li id="c248" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">libea54</li><li id="8ee0" class="mg mh gu mi b mj qf ml mm mn qg mp mq mr qh mt mu mv qi mx my mz qj nb nc nd qx ps pt bk">One-InstanceJes</li></ul></div></div></div><div class="ab cb qz ra rb rc" role="separator"><span class="rd by bm re rf rg"></span><span class="rd by bm re rf rg"></span><span class="rd by bm re rf"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="cd21" class="pw-post-body-paragraph mg mh gu mi b mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd gn bk">Thanks for reading. Follow me on Twitter for more posts like this one.</p><div class="rh ri rj rk rl rm"><a href="https://twitter.com/chen_erlich?source=post_page-----ac9b8b392767--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="rn ab is"><div class="ro ab co cb rp rq"><h2 class="bf gv ij z py rr rs rt ru rv rw gt bk">Chen Erlich</h2><div class="rx l"><h3 class="bf b ij z py rr rs rt ru rv rw du">The latest Tweets from Chen Erlich (@chen_erlich). Security Researcher. Opinions are on my own. #MalwareResearch…</h3></div><div class="ry l"><p class="bf b dv z py rr rs rt ru rv rw du">twitter.com</p></div></div><div class="rz l"><div class="sa l sb sc sd rz se ln rm"></div></div></div></a></div></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sf sg ab iv"><div class="rx ab"><a class="sh ay am ao" rel="noopener follow" href="/tag/metamorfo?source=post_page-----ac9b8b392767--------------------------------"><div class="si fj cx sj ge sk sl bf b bg z bk sm">Metamorfo</div></a></div><div class="rx ab"><a class="sh ay am ao" rel="noopener follow" href="/tag/trojan?source=post_page-----ac9b8b392767--------------------------------"><div class="si fj cx sj ge sk sl bf b bg z bk sm">Trojan</div></a></div><div class="rx ab"><a class="sh ay am ao" rel="noopener follow" href="/tag/avast?source=post_page-----ac9b8b392767--------------------------------"><div class="si fj cx sj ge sk sl bf b bg z bk sm">Avast</div></a></div><div class="rx ab"><a class="sh ay am ao" rel="noopener follow" href="/tag/dll-hijacking?source=post_page-----ac9b8b392767--------------------------------"><div class="si fj cx sj ge sk sl bf b bg z bk sm">Dll Hijacking</div></a></div><div class="rx ab"><a class="sh ay am ao" rel="noopener follow" href="/tag/brazilian?source=post_page-----ac9b8b392767--------------------------------"><div class="si fj cx sj ge sk sl bf b bg z bk sm">Brazilian</div></a></div></div></div></div><div class="l"></div><footer class="sn so sp sq sr ss st su sv ab q sw sx c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp sy"><div class="ab q ke"><div class="sz l"><span class="l ta tb tc e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fac9b8b392767&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;user=Chen+Erlich&amp;userId=63409eb2f083&amp;source=-----ac9b8b392767---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f td te"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fac9b8b392767&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;user=Chen+Erlich&amp;userId=63409eb2f083&amp;source=-----ac9b8b392767---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="rg l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fac9b8b392767&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;source=--------------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rg l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="tf tg th ti tj l bx"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="cl ab tk cp"><div class="ab ia"><a rel="noopener follow" href="/@chenerlich?source=post_page-----ac9b8b392767--------------------------------"><div class="l tl tm by tn ie"><div class="l fj"><img alt="Chen Erlich" class="l fd by to tp cx" src="https://miro.medium.com/v2/resize:fill:144:144/2*wa8EmI4fidGpDV1zC1K44g.jpeg" width="72" height="72" loading="lazy"/><div class="if by l to tp fs n ig ft"></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="bf b bg z ep si eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F63409eb2f083%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;user=Chen+Erlich&amp;userId=63409eb2f083&amp;source=-----ac9b8b392767---------------------subscribe_user-----------"><button class="bf b bg z tt am tu tv tw tx ty tz ua ub ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tq tr ts"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cn cp"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@chenerlich?source=post_page-----ac9b8b392767--------------------------------"><h2 class="pw-author-name bf uc ud ue uf bk"><span class="gn ix">Written by <!-- -->Chen Erlich</span></h2></a></div><div class="rx ab"><div class="l is"><span class="pw-follower-count bf b bg z bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@chenerlich/followers?source=post_page-----ac9b8b392767--------------------------------">33 Followers</a></span></div></div><div class="ug l"><p class="bf b bg z bk"><span class="gn">Senior Security Researcher. @chen_erlich on Twitter. #MalwareResearch #ThreatHunting #RE #IR #Forensics #Python</span></p></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ep si eq er es et eu ev ew ex ey ez fa au fb fc fd bm fe ff">Follow</button></span><div class="dt l"><div><div><div class="bm" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fusers%2F63409eb2f083%2Flazily-enable-writer-subscription&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40chenerlich%2Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767&amp;user=Chen+Erlich&amp;userId=63409eb2f083&amp;source=-----ac9b8b392767---------------------subscribe_user-----------"><button class="bf b bg z tt am tu tv tw tx ty tz ua ub ew ex ey ez fa fb fc fd bm fe ff" aria-label="Subscribe"><svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" fill="none" viewBox="0 0 38 38" class="tq tr ts"><rect width="0.5" height="6.5" x="26.25" y="9.25" rx="0.25"></rect><rect width="0.5" height="6.5" x="29.75" y="12.25" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5 19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="uh bh ui uj uk ul um un"></div></div></div><div class="h k j"><div class="uh bh ui uo"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="up ab ke iv"><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----ac9b8b392767--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----ac9b8b392767--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uq ur l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----ac9b8b392767--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----ac9b8b392767--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241017-182126-a0128a89d2"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-ac9b8b392767","user-63409eb2f083"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false,"publicationHierarchyEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":true,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"a1632120-4e43-4f0c-8448-52fbecb08fb7","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-ed69536d17cff53ca1a465943470d857-a2bb6474de532d6c-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@chenerlich\u002Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241017-182126-a0128a89d2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241017-182126-a0128a89d2","commit":"a0128a89d2d76bfa55b25492370b0bae4050224f"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"ac9b8b392767\"})":{"__ref":"Post:ac9b8b392767"}},"LinkedAccounts:63409eb2f083":{"__typename":"LinkedAccounts","mastodon":null,"id":"63409eb2f083"},"UserViewerEdge:userId:63409eb2f083-viewerId:lo_e27fccfa754c":{"__typename":"UserViewerEdge","id":"userId:63409eb2f083-viewerId:lo_e27fccfa754c","isFollowing":false,"isUser":false,"isMuting":false},"User:63409eb2f083":{"__typename":"User","id":"63409eb2f083","linkedAccounts":{"__ref":"LinkedAccounts:63409eb2f083"},"isSuspended":false,"imageId":"2*wa8EmI4fidGpDV1zC1K44g.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"name":"Chen Erlich","socialStats":{"__typename":"SocialStats","followerCount":33},"username":"chenerlich","customDomainState":null,"hasSubdomain":false,"bio":"Senior Security Researcher. @chen_erlich on Twitter. #MalwareResearch #ThreatHunting #RE #IR #Forensics #Python","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:63409eb2f083-viewerId:lo_e27fccfa754c"},"viewerIsUser":false,"newsletterV3":null,"postSubscribeMembershipUpsellShownAt":0,"userPostCounts({\"includeResponsesCount\":true})":null,"membership":null,"allowNotes":true,"twitterScreenName":""},"Paragraph:82e6dba47dd1_0":{"__typename":"Paragraph","id":"82e6dba47dd1_0","name":"7f01","type":"H3","href":null,"layout":null,"metadata":null,"text":"The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_1":{"__typename":"Paragraph","id":"82e6dba47dd1_1","name":"8fb7","type":"P","href":null,"layout":null,"metadata":null,"text":"Source: ensilo.com\u002FBreakingMalware \nTwitter: @chen_erlich","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":45,"end":57,"href":"https:\u002F\u002Ftwitter.com\u002Fchen_erlich","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":36,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*kEOUNI0DgWIcec9FsG4NiQ.png":{"__typename":"ImageMetadata","id":"1*kEOUNI0DgWIcec9FsG4NiQ.png","originalHeight":199,"originalWidth":687,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_2":{"__typename":"Paragraph","id":"82e6dba47dd1_2","name":"8cee","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*kEOUNI0DgWIcec9FsG4NiQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_3":{"__typename":"Paragraph","id":"82e6dba47dd1_3","name":"3a96","type":"H3","href":null,"layout":null,"metadata":null,"text":"SUMMARY","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_4":{"__typename":"Paragraph","id":"82e6dba47dd1_4","name":"d5f7","type":"P","href":null,"layout":null,"metadata":null,"text":"In May 2019, enSilo’s Threat Intelligence team observed activity by a cybercrime group, spreading Metamorfo — A Brazilian banking trojan. The variants we discovered abuse an executable digitally signed by Avast, which is one of the most popular AV products in the world for consumers. We were able to connect this activity to a campaign reported by TrendMicro which targeted an executable by a different Anti-Virus vendor, Avira. This\nfurther highlights the Modus-Operandi of the group.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":328,"end":359,"href":"https:\u002F\u002Fblog.trendmicro.com\u002Ftrendlabs-security-intelligence\u002Fanalysis-abuse-of-custom-actions-in-windows-installer-msi-to-run-malicious-javascript-vbscript-and-powershell-scripts\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_5":{"__typename":"Paragraph","id":"82e6dba47dd1_5","name":"d36c","type":"P","href":null,"layout":null,"metadata":null,"text":"This blog post describes in detail one of the variants used in this campaign and highlights unique Tactics, Techniques and Procedures (TTPs) used in this campaign which were not previously disclosed.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_6":{"__typename":"Paragraph","id":"82e6dba47dd1_6","name":"1308","type":"H3","href":null,"layout":null,"metadata":null,"text":"TECHNICAL ANALYSIS","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_7":{"__typename":"Paragraph","id":"82e6dba47dd1_7","name":"aada","type":"P","href":null,"layout":null,"metadata":null,"text":"In May 2019, enSilo detected a new activity by a Brazilian cybercrime group. Both loader variants and their respective payloads that were analyzed share similar TTPs and code associated with a Brazilian cybercrime group.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_8":{"__typename":"Paragraph","id":"82e6dba47dd1_8","name":"bf2b","type":"H4","href":null,"layout":null,"metadata":null,"text":"Execution Flow Overview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_9":{"__typename":"Paragraph","id":"82e6dba47dd1_9","name":"5061","type":"P","href":null,"layout":null,"metadata":null,"text":"On execution, the MSI downloader starts by checking if it is running in a virtual machine. If not, downloads a zip file, unzips it, deletes itself, establishes persistency and restarts the system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_10":{"__typename":"Paragraph","id":"82e6dba47dd1_10","name":"e46a","type":"P","href":null,"layout":null,"metadata":null,"text":"The zip file contains the following files:\n1. jesus.exe — Signed AVDump32 — Avast’s memory dump utility. Renamed to a random name.\n2. dbghelp.dll — Malicious file to be side loaded by AJWrDz.exe.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":46,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":134,"end":146,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_11":{"__typename":"Paragraph","id":"82e6dba47dd1_11","name":"5f73","type":"P","href":null,"layout":null,"metadata":null,"text":"3. jesus.dmp — Payload to be loaded by the injected Windows Media Player\nexecutable (wmplayer.exe). Later renamed to the same random name as\njesus.exe with a .dmp extension.\n4. ssleay64.dll — Known variant of Metamorfo. Will be loaded and used in the\ninjected wmplayer.exe.\n5. ssleay32.dll — OpenSSL Shared Library.\n6. borlndmm.dll — Borland Memory Manager.\n7. libeay32.dll — OpenSSL Shared Library.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":3,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":176,"end":190,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":277,"end":290,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":319,"end":332,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":361,"end":373,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_12":{"__typename":"Paragraph","id":"82e6dba47dd1_12","name":"785e","type":"P","href":null,"layout":null,"metadata":null,"text":"During the rest of the analysis we will refer jesus.exe as “AJWrDz.exe” which is the random name generated in this execution. After the system reboots, the file “AJWrDz.exe” executes, which in turn triggers the side-loading of the malicious (and fake) DLL file “dbghelp.dll”. This malicious DLL file injects itself to Windows Media Player process — wmplayer.exe, and reflectively loads the renamed jesus.dmp file, “AJWrDz.dmp”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_13":{"__typename":"Paragraph","id":"82e6dba47dd1_13","name":"7a06","type":"P","href":null,"layout":null,"metadata":null,"text":"The following diagram describes the high-level execution flow of the variants in this campaign:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*k5MIwsiJW3pkIWSipXZMoA.png":{"__typename":"ImageMetadata","id":"1*k5MIwsiJW3pkIWSipXZMoA.png","originalHeight":517,"originalWidth":933,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_14":{"__typename":"Paragraph","id":"82e6dba47dd1_14","name":"2466","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*k5MIwsiJW3pkIWSipXZMoA.png"},"text":"Figure 1: Execution flow","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_15":{"__typename":"Paragraph","id":"82e6dba47dd1_15","name":"ea50","type":"H3","href":null,"layout":null,"metadata":null,"text":"MSI DOWNLOADER","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_16":{"__typename":"Paragraph","id":"82e6dba47dd1_16","name":"ee60","type":"P","href":null,"layout":null,"metadata":null,"text":"The following is the static characteristics of the Windows Installer (MSI) downloader which starts the infection, this MSI downloader is similar to the one used in the earlier part of the campaign:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":51,"end":74,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fdesktop\u002Fmsi\u002Fwindows-installer-portal","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_17":{"__typename":"Paragraph","id":"82e6dba47dd1_17","name":"0d28","type":"P","href":null,"layout":null,"metadata":null,"text":"File Name: HNR-Not03958576535323.msi","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_18":{"__typename":"Paragraph","id":"82e6dba47dd1_18","name":"92c7","type":"P","href":null,"layout":null,"metadata":null,"text":"SHA1: F1498E679885389C32FDF5EC39813FE5D4D34F23","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_19":{"__typename":"Paragraph","id":"82e6dba47dd1_19","name":"7972","type":"P","href":null,"layout":null,"metadata":null,"text":"Size: 287232 bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_20":{"__typename":"Paragraph","id":"82e6dba47dd1_20","name":"a181","type":"P","href":null,"layout":null,"metadata":null,"text":"Creation Time: 2009–12–11 11:47:44","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_21":{"__typename":"Paragraph","id":"82e6dba47dd1_21","name":"7b11","type":"P","href":null,"layout":null,"metadata":null,"text":"During the time of analysis this variant had very low detection rate in VirusTotal, as can be seen in figure 2:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*eWBfpqqzcn-2x76_scPOUQ.png":{"__typename":"ImageMetadata","id":"1*eWBfpqqzcn-2x76_scPOUQ.png","originalHeight":336,"originalWidth":912,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_22":{"__typename":"Paragraph","id":"82e6dba47dd1_22","name":"9f00","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*eWBfpqqzcn-2x76_scPOUQ.png"},"text":"Figure 2: VirusTotal detection rate","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_23":{"__typename":"Paragraph","id":"82e6dba47dd1_23","name":"474c","type":"P","href":null,"layout":null,"metadata":null,"text":"All MSI files in this campaign have different names, but share unique characteristics:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_24":{"__typename":"Paragraph","id":"82e6dba47dd1_24","name":"0fce","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Disguised as “Adobe Acrobat Reader Installer” to look legitimate as seen in figure 3:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":14,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mq-QXYZ6IWteivrWr4qE3A.png":{"__typename":"ImageMetadata","id":"1*mq-QXYZ6IWteivrWr4qE3A.png","originalHeight":414,"originalWidth":916,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_25":{"__typename":"Paragraph","id":"82e6dba47dd1_25","name":"43f1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mq-QXYZ6IWteivrWr4qE3A.png"},"text":"Figure 3: Disguise as Adobe Acrobat Reader","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_26":{"__typename":"Paragraph","id":"82e6dba47dd1_26","name":"63d9","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Created using the “Advanced Installer” tool, which is imported in all of them, as shown in figure 4.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":22,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_27":{"__typename":"Paragraph","id":"82e6dba47dd1_27","name":"4854","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Contain a vmdetect.exe [MD5: 55FFEE241709AE96CF64CB0B9A96F0D7] to avoid detection, as shown in figure 4:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":13,"end":26,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*gQ5fyh_fxkhE3nbmnY2z2Q.png":{"__typename":"ImageMetadata","id":"1*gQ5fyh_fxkhE3nbmnY2z2Q.png","originalHeight":306,"originalWidth":827,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_28":{"__typename":"Paragraph","id":"82e6dba47dd1_28","name":"cb31","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*gQ5fyh_fxkhE3nbmnY2z2Q.png"},"text":"Figure 4: Embedded aicustact.dll and vmdetect.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":49,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_29":{"__typename":"Paragraph","id":"82e6dba47dd1_29","name":"8c4f","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Use the CustomActions table. The CustomAction table enables integration of custom code and data into an installation. The source of the code that is executed can be a stream contained within the database, a recently installed file, or an existing executable file. The attackers abused this feature to add the malicious JavaScript\u002FVBS payload as shown in figure 5.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":11,"end":30,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fmsi\u002Fcustomaction-table","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":11,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":25,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*fLRL1RVqeU_GqRx8ls4kTQ.png":{"__typename":"ImageMetadata","id":"1*fLRL1RVqeU_GqRx8ls4kTQ.png","originalHeight":285,"originalWidth":950,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_30":{"__typename":"Paragraph","id":"82e6dba47dd1_30","name":"b1fb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*fLRL1RVqeU_GqRx8ls4kTQ.png"},"text":"Figure 5: Malicious JavaScript payload in CustomActions table","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_31":{"__typename":"Paragraph","id":"82e6dba47dd1_31","name":"2cf6","type":"H3","href":null,"layout":null,"metadata":null,"text":"The JavaScript payload","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_32":{"__typename":"Paragraph","id":"82e6dba47dd1_32","name":"2cfb","type":"P","href":null,"layout":null,"metadata":null,"text":"The downloader’s JavaScript payload is obfuscated:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:8ad54c6d4573c4f946782d632f0dc36a":{"__typename":"MediaResource","id":"8ad54c6d4573c4f946782d632f0dc36a","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":""},"Paragraph:82e6dba47dd1_33":{"__typename":"Paragraph","id":"82e6dba47dd1_33","name":"5fff","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Figure 6: Obfuscated MSI payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:8ad54c6d4573c4f946782d632f0dc36a"}},"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_34":{"__typename":"Paragraph","id":"82e6dba47dd1_34","name":"d810","type":"P","href":null,"layout":null,"metadata":null,"text":"After deobfuscation:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"MediaResource:1fceb34c1f776018592c68f2a96a5f33":{"__typename":"MediaResource","id":"1fceb34c1f776018592c68f2a96a5f33","iframeSrc":"","iframeHeight":0,"iframeWidth":0,"title":""},"Paragraph:82e6dba47dd1_35":{"__typename":"Paragraph","id":"82e6dba47dd1_35","name":"2601","type":"IFRAME","href":null,"layout":"INSET_CENTER","metadata":null,"text":"Figure 7: Deobfuscated MSI payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":{"__typename":"Iframe","mediaResource":{"__ref":"MediaResource:1fceb34c1f776018592c68f2a96a5f33"}},"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_36":{"__typename":"Paragraph","id":"82e6dba47dd1_36","name":"aea1","type":"P","href":null,"layout":null,"metadata":null,"text":"The samples in this campaign communicate with a URL in the following format: https:\u002F\u002Fs3-eu-west-1[.]amazonaws[.]com\u002F{random}\u002Fimage2[.]png.\n The ”{random}” part may change between different MSI downloaders. The image2.png file is actually a zip file which is downloaded and extracted to a target folder. In this variant it is extracted to %APPDATA%\\Macromedia. Next, the MSI downloader creates in this location a desktop.txt file containing the string “NULL”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":77,"end":138,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws[.]com\u002F{random}\u002Fimage2[.]png.","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":77,"end":138,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":338,"end":358,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":412,"end":423,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_37":{"__typename":"Paragraph","id":"82e6dba47dd1_37","name":"d1b0","type":"P","href":null,"layout":null,"metadata":null,"text":"The purpose of the desktop.txt file is to indicate whether the system is infected by the malware. If it exists, the MSI will exit after it will open Adobe’s website to explain how to install updates. It does so by executing:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":19,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_38":{"__typename":"Paragraph","id":"82e6dba47dd1_38","name":"c4d1","type":"P","href":null,"layout":null,"metadata":null,"text":"“c:\\Windows\\System32\\cmd.exe \u002FC start \u002FMAX https:\u002F\u002Fhelpx.adobe[.]com\u002Fbr\u002Facrobat\u002Fkb\u002Finstall-updates-reader-acrobat.html”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":69,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":119,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_39":{"__typename":"Paragraph","id":"82e6dba47dd1_39","name":"d879","type":"P","href":null,"layout":null,"metadata":null,"text":"Otherwise, it will open legal terms of use page in Adobe’s site and continue the payload execution. This following command executes to open the terms of use page:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_40":{"__typename":"Paragraph","id":"82e6dba47dd1_40","name":"048c","type":"P","href":null,"layout":null,"metadata":null,"text":"“c:\\Windows\\System32\\cmd.exe \u002FC start \u002FMAX https:\u002F\u002Fadobe.ly\u002F2RY5GJR”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":1,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_41":{"__typename":"Paragraph","id":"82e6dba47dd1_41","name":"87f7","type":"P","href":null,"layout":null,"metadata":null,"text":"which will redirect to “https:\u002F\u002Fwww.adobe.com\u002Fbr\u002Flegal\u002Fterms.html”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":46,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":24,"end":66,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_42":{"__typename":"Paragraph","id":"82e6dba47dd1_42","name":"659f","type":"P","href":null,"layout":null,"metadata":null,"text":"Note that both URLs are with the Brazilian 2-letter abbreviation, suggesting the victims’ origin.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_43":{"__typename":"Paragraph","id":"82e6dba47dd1_43","name":"9a37","type":"P","href":null,"layout":null,"metadata":null,"text":"The files are extracted to a newly created folder with a randomized name under the same path, and the zip file is then deleted. The “AJWrDz.exe” executable path is written to the registry Run key “HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run” to achieve persistency. As a final step the system is restarted to trigger its execution.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":197,"end":247,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_44":{"__typename":"Paragraph","id":"82e6dba47dd1_44","name":"694f","type":"H3","href":null,"layout":null,"metadata":null,"text":"THE AVAST ABUSE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_45":{"__typename":"Paragraph","id":"82e6dba47dd1_45","name":"d04f","type":"P","href":null,"layout":null,"metadata":null,"text":"After the system restart, the “AJWrDz.exe” file executes. Its static characteristics are:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_46":{"__typename":"Paragraph","id":"82e6dba47dd1_46","name":"5869","type":"P","href":null,"layout":null,"metadata":null,"text":"File Name: AJWrDz.exe (renamed from jesus.exe)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_47":{"__typename":"Paragraph","id":"82e6dba47dd1_47","name":"e9e7","type":"P","href":null,"layout":null,"metadata":null,"text":"SHA1: 2A1A5D7C85560924EDC434A1D2F23ED3445D86F4","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_48":{"__typename":"Paragraph","id":"82e6dba47dd1_48","name":"9dab","type":"P","href":null,"layout":null,"metadata":null,"text":"Size: 814296 bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_49":{"__typename":"Paragraph","id":"82e6dba47dd1_49","name":"3b13","type":"P","href":null,"layout":null,"metadata":null,"text":"Creation Time: 2018–10–08 13:07:15","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_50":{"__typename":"Paragraph","id":"82e6dba47dd1_50","name":"9aaa","type":"P","href":null,"layout":null,"metadata":null,"text":"This is a legitimate file, AVDump32.exe, digitally signed by “AVAST Software” as shown in figure 8:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":27,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":60,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KOB2620wD2ciN1H1kJBoGA.png":{"__typename":"ImageMetadata","id":"1*KOB2620wD2ciN1H1kJBoGA.png","originalHeight":659,"originalWidth":860,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_51":{"__typename":"Paragraph","id":"82e6dba47dd1_51","name":"80ce","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KOB2620wD2ciN1H1kJBoGA.png"},"text":"Figure 8: AJWrDz.exe VirusTotal details","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_52":{"__typename":"Paragraph","id":"82e6dba47dd1_52","name":"8ce6","type":"P","href":null,"layout":null,"metadata":null,"text":"AvDump32.exe legitimate use is to create *.dmp files of Avast processes in case there is an unhandled exception. When Avast is installed legitimately on a system the file is located in Its original location: C:\\Program Files\\AVAST Software\\Avast.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_53":{"__typename":"Paragraph","id":"82e6dba47dd1_53","name":"adc4","type":"P","href":null,"layout":null,"metadata":null,"text":"Figure 9 suggests that this file was submitted to VirusTotal as “jesus.exe”, which is the name of the file in the downloaded zip, before it’s being renamed in the MSI payload:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*LyGH8nVwclvyabrJykC7cw.png":{"__typename":"ImageMetadata","id":"1*LyGH8nVwclvyabrJykC7cw.png","originalHeight":416,"originalWidth":894,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_54":{"__typename":"Paragraph","id":"82e6dba47dd1_54","name":"2887","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*LyGH8nVwclvyabrJykC7cw.png"},"text":"Figure 9: AvDump32.exe name variations","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_55":{"__typename":"Paragraph","id":"82e6dba47dd1_55","name":"ceed","type":"P","href":null,"layout":null,"metadata":null,"text":"AvDump32.exe is abused by the Metamorfo to side-load the “dbghelp.dll” by leveraging the DLL search order. Note that this is a common issue which makes it possible to leverage the DLL side-loading attack, often referred to as DLL Hijacking. Figure 10 shows the DLL files imported by this executable:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ayJSNBHL_HTde_H-pXXqlg.png":{"__typename":"ImageMetadata","id":"1*ayJSNBHL_HTde_H-pXXqlg.png","originalHeight":271,"originalWidth":793,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_56":{"__typename":"Paragraph","id":"82e6dba47dd1_56","name":"970f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ayJSNBHL_HTde_H-pXXqlg.png"},"text":"Figure 10: ADWrDz.exe (AvDump32.exe) imports","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_57":{"__typename":"Paragraph","id":"82e6dba47dd1_57","name":"5217","type":"P","href":null,"layout":null,"metadata":null,"text":"You can find another example of abusing the DLL search order in one of our previous blog posts.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":84,"end":94,"href":"https:\u002F\u002Fblog.ensilo.com\u002Fensilo-terminates-dll-search-order-hijacking","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_58":{"__typename":"Paragraph","id":"82e6dba47dd1_58","name":"8d4b","type":"P","href":null,"layout":null,"metadata":null,"text":"The side loaded “dbghelp.dll” is a malicious file written in Delphi and compiled using the Embarcadero Delphi IDE with the following characteristics:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_59":{"__typename":"Paragraph","id":"82e6dba47dd1_59","name":"162e","type":"P","href":null,"layout":null,"metadata":null,"text":"File Name: dbghelp.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_60":{"__typename":"Paragraph","id":"82e6dba47dd1_60","name":"e707","type":"P","href":null,"layout":null,"metadata":null,"text":"SHA1: 08823578841AEED044EAD81ED6DB16DD95B6FF4B","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_61":{"__typename":"Paragraph","id":"82e6dba47dd1_61","name":"4451","type":"P","href":null,"layout":null,"metadata":null,"text":"Size: 5595136 bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_62":{"__typename":"Paragraph","id":"82e6dba47dd1_62","name":"58b6","type":"P","href":null,"layout":null,"metadata":null,"text":"Creation Time: 2019–04–27 22:17:17","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_63":{"__typename":"Paragraph","id":"82e6dba47dd1_63","name":"c216","type":"P","href":null,"layout":null,"metadata":null,"text":"After being side-loaded by AvDump32.exe, the DLL’s execution starts with the following steps:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_64":{"__typename":"Paragraph","id":"82e6dba47dd1_64","name":"9989","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Resolves WINAPI functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_65":{"__typename":"Paragraph","id":"82e6dba47dd1_65","name":"c339","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Hides its GUI using ShowWindow WINAPI call","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":20,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_66":{"__typename":"Paragraph","id":"82e6dba47dd1_66","name":"45ca","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Compares if the DLL is being ran by wmplayer. More on this later.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_67":{"__typename":"Paragraph","id":"82e6dba47dd1_67","name":"c689","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, the DLL file creates the mutex — [7F4HRE-375E-AEF3-BE9A-OBJT389F53] and writes to HKCU\\Software\\index (as shown in figure 11) the name of the running process which is later used to know the name of the .dmp file that should be loaded. Finally, it injects itself to Windows Media Player executable — wmplayer.exe.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":305,"end":317,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":39,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":88,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qYMvJNN82fO44zKpD7EW3A.png":{"__typename":"ImageMetadata","id":"1*qYMvJNN82fO44zKpD7EW3A.png","originalHeight":405,"originalWidth":946,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_68":{"__typename":"Paragraph","id":"82e6dba47dd1_68","name":"02f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qYMvJNN82fO44zKpD7EW3A.png"},"text":"Figure 11: Registry artifact","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_69":{"__typename":"Paragraph","id":"82e6dba47dd1_69","name":"eafd","type":"P","href":null,"layout":null,"metadata":null,"text":"The process wmplayer.exe is a rather strange victim for injection given that various Windows distributions don’t come with Windows Media Player installed by default, so it can only be implied that this software is probably more common in the victim’s origin, and that it probably targets home users.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_70":{"__typename":"Paragraph","id":"82e6dba47dd1_70","name":"9cb6","type":"P","href":null,"layout":null,"metadata":null,"text":"Metamorfo uses a DLL injection technique with a twist. Instead of getting a handle to the victim process using OpenProcess, which relies on having a running process, the injection uses CreateProcess with CREATE_SUSPENDED flag. Then it creates a remote thread which loads the malicious DLL and executes it. The process’ main thread is never resumed and thus only the malware code executes. Figure 12 shows the CreateProcess call:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":111,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":185,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":409,"end":423,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3AcMvBru3g0hEhXuSId4cQ.png":{"__typename":"ImageMetadata","id":"1*3AcMvBru3g0hEhXuSId4cQ.png","originalHeight":331,"originalWidth":869,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_71":{"__typename":"Paragraph","id":"82e6dba47dd1_71","name":"36e4","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3AcMvBru3g0hEhXuSId4cQ.png"},"text":"Figure 12: The start of the DLL injection","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_72":{"__typename":"Paragraph","id":"82e6dba47dd1_72","name":"9986","type":"P","href":null,"layout":null,"metadata":null,"text":"The injection flow is as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PQHTPWpEPEgZs7e2phx58w.png":{"__typename":"ImageMetadata","id":"1*PQHTPWpEPEgZs7e2phx58w.png","originalHeight":74,"originalWidth":937,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_73":{"__typename":"Paragraph","id":"82e6dba47dd1_73","name":"256e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*PQHTPWpEPEgZs7e2phx58w.png"},"text":"Figure 13: DLL injection flow","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_74":{"__typename":"Paragraph","id":"82e6dba47dd1_74","name":"9e30","type":"H3","href":null,"layout":null,"metadata":null,"text":"INJECTED PAYLOAD","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_75":{"__typename":"Paragraph","id":"82e6dba47dd1_75","name":"fb16","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon injection, the DLL validates that it runs under the wmplayer.exe process by checking the process name and goes on to execute its malicious activity. It creates a second mutex — One-InstanceJes, resolves more WINAPI functions, checks for the registry “index” key (which was previously written)the execution location and for the “ADWrDz.dmp” file. If this file exists, it extracts it in-memory using RtlDecompressFragment and reflectively loads it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":182,"end":197,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":403,"end":424,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_76":{"__typename":"Paragraph","id":"82e6dba47dd1_76","name":"798e","type":"H4","href":null,"layout":null,"metadata":null,"text":"No DEP","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_77":{"__typename":"Paragraph","id":"82e6dba47dd1_77","name":"cffc","type":"P","href":null,"layout":null,"metadata":null,"text":"dbghelp.dll is incompatible with DEP (Data Exception Prevention), as shown in Figure 14. Thus, when it loads the operating system will disable DEP for the injected wmplayer.exe process. This means that code can be executed from memory regions that are not marked as executable in the context of this process.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":33,"end":64,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fmemory\u002Fdata-execution-prevention","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_78":{"__typename":"Paragraph","id":"82e6dba47dd1_78","name":"9c6b","type":"P","href":null,"layout":null,"metadata":null,"text":"Metamorpho uses this to execute the reflectively loaded payload from a non-executable region. This makes the payload harder to detect by memory forensics toolkits and security products which many times look specifically for executable memory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZzF3L4Pec7xpfutZTEnStQ.png":{"__typename":"ImageMetadata","id":"1*ZzF3L4Pec7xpfutZTEnStQ.png","originalHeight":286,"originalWidth":849,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_79":{"__typename":"Paragraph","id":"82e6dba47dd1_79","name":"15d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZzF3L4Pec7xpfutZTEnStQ.png"},"text":"Figure 14: dbghelp.dll is incompatible with NX","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_80":{"__typename":"Paragraph","id":"82e6dba47dd1_80","name":"3853","type":"H4","href":null,"layout":null,"metadata":null,"text":"Leveraging CreateTimerQueueTimer","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_81":{"__typename":"Paragraph","id":"82e6dba47dd1_81","name":"2c62","type":"P","href":null,"layout":null,"metadata":null,"text":"Once “ADWrDz.dmp” is loaded into memory Metamorfo leverages the CreateTimerQueueTimer WINAPI call to execute it (as shown in figure 14).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":64,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_82":{"__typename":"Paragraph","id":"82e6dba47dd1_82","name":"5f0e","type":"P","href":null,"layout":null,"metadata":null,"text":"CreateTimerQueueTimer is a WINAPI that creates a queue for timers. These timer objects allow the selection of a callback function at a specified time. The original function of the API is to be part of the process chain by creating a timer routine, but here, the callback function of the API is the entry point of the malware’s actual payload.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":49,"end":65,"href":"https:\u002F\u002Fmsdn.microsoft.com\u002Fen-us\u002Flibrary\u002Fwindows\u002Fdesktop\u002Fms686796(v=vs.85).aspx","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_83":{"__typename":"Paragraph","id":"82e6dba47dd1_83","name":"4e26","type":"P","href":null,"layout":null,"metadata":null,"text":"The use of CreateTimerQueueTimer makes detection harder since the payload will not run in the remote thread context.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":11,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_84":{"__typename":"Paragraph","id":"82e6dba47dd1_84","name":"eb10","type":"P","href":null,"layout":null,"metadata":null,"text":"This kind of technique was previously used in malware variants such as Emotet and Hancitor.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-Yk1FZBoz5Q4L6iuWvX6WA.png":{"__typename":"ImageMetadata","id":"1*-Yk1FZBoz5Q4L6iuWvX6WA.png","originalHeight":199,"originalWidth":612,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_85":{"__typename":"Paragraph","id":"82e6dba47dd1_85","name":"b9f2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-Yk1FZBoz5Q4L6iuWvX6WA.png"},"text":"Figure 15: CreateTimerQueueTimer exploit","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_86":{"__typename":"Paragraph","id":"82e6dba47dd1_86","name":"1e83","type":"P","href":null,"layout":null,"metadata":null,"text":"Throughout the “ADWrDz.dmp” execution, it outputs debug comments in Portuguese as shown in figure 16:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qAp0E_LojGO0EEnNgiSJUA.png":{"__typename":"ImageMetadata","id":"1*qAp0E_LojGO0EEnNgiSJUA.png","originalHeight":72,"originalWidth":930,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_87":{"__typename":"Paragraph","id":"82e6dba47dd1_87","name":"ea62","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qAp0E_LojGO0EEnNgiSJUA.png"},"text":"Figure 16: Debugged output “Tela Azul” in Portugese which means “Blue Screen”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_88":{"__typename":"Paragraph","id":"82e6dba47dd1_88","name":"309b","type":"P","href":null,"layout":null,"metadata":null,"text":"Entering the CreateTimerQueueTimer callback, Metamorfo creates another mutex — libea54, and starts checking for the existence of directories and files relevant for its execution. Since there are multiple variations of Metamorfo in this campaign, the attackers used different locations in the file system to drop their files, see IOCs section.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":13,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":79,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_89":{"__typename":"Paragraph","id":"82e6dba47dd1_89","name":"727a","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, Metamorfo checks for the existence of “mreb.xml” and “mreboot”, as can be seen in figure 17. These artifacts were not available to us and we couldn’t verify their purpose.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*X-jo9R9mYA6GGDWhrTL6IA.png":{"__typename":"ImageMetadata","id":"1*X-jo9R9mYA6GGDWhrTL6IA.png","originalHeight":73,"originalWidth":1054,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_90":{"__typename":"Paragraph","id":"82e6dba47dd1_90","name":"5119","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*X-jo9R9mYA6GGDWhrTL6IA.png"},"text":"Figure 17: Metamorfo looks for mreb.xml & mreboot folder","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_91":{"__typename":"Paragraph","id":"82e6dba47dd1_91","name":"694d","type":"P","href":null,"layout":null,"metadata":null,"text":"If they aren’t found, it creates another mutex by the name — [7F4HRE-375E-AEF3-BE9A-OBJT389F53]. Then, it checks internet connection by trying to resolve “goole.com” (Misspelled) address. If internet connection is available,","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":61,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":155,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_92":{"__typename":"Paragraph","id":"82e6dba47dd1_92","name":"bea6","type":"P","href":null,"layout":null,"metadata":null,"text":"it sends a GET request to “https:\u002F\u002Fwww.localizaip.com[.]br\u002Fapi\u002Fiplocation.php” to retrieve geo data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":27,"end":79,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_93":{"__typename":"Paragraph","id":"82e6dba47dd1_93","name":"7074","type":"P","href":null,"layout":null,"metadata":null,"text":"Metamorfo’s C&C communication is encrypted using the dropped OpenSSL libraries libeay32.dll and ssleay32.dll.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_94":{"__typename":"Paragraph","id":"82e6dba47dd1_94","name":"1b25","type":"P","href":null,"layout":null,"metadata":null,"text":"Based on the gathered data, if the victim is not from Brazil or Portugal it will print the following output and send the collected data to the C&C “https:\u002F\u002Fx1-lb12.internal[.]gocache.me”, which resided in Brazil, and finish.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":148,"end":187,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*GCSXuU-QqduOu6pmYjqMoA.png":{"__typename":"ImageMetadata","id":"1*GCSXuU-QqduOu6pmYjqMoA.png","originalHeight":63,"originalWidth":1177,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_95":{"__typename":"Paragraph","id":"82e6dba47dd1_95","name":"e5f7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*GCSXuU-QqduOu6pmYjqMoA.png"},"text":"Figure 18: Debug output of the collected data","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_96":{"__typename":"Paragraph","id":"82e6dba47dd1_96","name":"9f9f","type":"P","href":null,"layout":null,"metadata":null,"text":"If the victim is from Brazil or Portugal, it will start monitoring running applications in the system using a message loop:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PD0gEW-ZN575FcO8BVYhkA.png":{"__typename":"ImageMetadata","id":"1*PD0gEW-ZN575FcO8BVYhkA.png","originalHeight":180,"originalWidth":1020,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_97":{"__typename":"Paragraph","id":"82e6dba47dd1_97","name":"0178","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*PD0gEW-ZN575FcO8BVYhkA.png"},"text":"Figure 19: Debugging running application","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_98":{"__typename":"Paragraph","id":"82e6dba47dd1_98","name":"93dc","type":"H3","href":null,"layout":null,"metadata":null,"text":"The ssleay64.dll payload","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_99":{"__typename":"Paragraph","id":"82e6dba47dd1_99","name":"b0f6","type":"P","href":null,"layout":null,"metadata":null,"text":"If the malware identifies a file named “mreb.xml” or a folder named “mreboot”, it loads a malicious “ssleay64.dll”, also written in Delphi, compiled by Borland Delphi, which has the following characteristics:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_100":{"__typename":"Paragraph","id":"82e6dba47dd1_100","name":"7130","type":"P","href":null,"layout":null,"metadata":null,"text":"File Name: ssleay64.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_101":{"__typename":"Paragraph","id":"82e6dba47dd1_101","name":"c44f","type":"P","href":null,"layout":null,"metadata":null,"text":"SHA1: F5E63580710E8FA884377A746FC822E5","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_102":{"__typename":"Paragraph","id":"82e6dba47dd1_102","name":"2a03","type":"P","href":null,"layout":null,"metadata":null,"text":"Size: 1445888 bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":13,"href":"https:\u002F\u002Fwww.virustotal.com\u002Fgui\u002Fsearch\u002Fsize%25253A1445888","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_103":{"__typename":"Paragraph","id":"82e6dba47dd1_103","name":"c2a3","type":"P","href":null,"layout":null,"metadata":null,"text":"Creation Time: 2019–04–08 12:15:27","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_104":{"__typename":"Paragraph","id":"82e6dba47dd1_104","name":"d11c","type":"P","href":null,"layout":null,"metadata":null,"text":"The DLL holds various resources. Some of them are encrypted and will be used as payloads to steal victim’s data, while others are cursor related resources.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_105":{"__typename":"Paragraph","id":"82e6dba47dd1_105","name":"e29f","type":"P","href":null,"layout":null,"metadata":null,"text":"Like samples from previous campaigns Metamorfo can display fake forms on targeted banking sites and steal credentials from the victims. On previous campaigns Metamorfo used Windows Update to hide its malicious activity. Similarly, in this campaign Metamorfo uses a fake “Blue Screen” window. It does so after disabling the taskbar as can be seen in Figures 20 and 21:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":148,"end":157,"href":"https:\u002F\u002Fwww.fireeye.com\u002Fblog\u002Fthreat-research\u002F2018\u002F04\u002Fmetamorfo-campaign-targeting-brazilian-users.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZYQatoVhdI6Gjj8FBfhgNw.png":{"__typename":"ImageMetadata","id":"1*ZYQatoVhdI6Gjj8FBfhgNw.png","originalHeight":194,"originalWidth":512,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_106":{"__typename":"Paragraph","id":"82e6dba47dd1_106","name":"470b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZYQatoVhdI6Gjj8FBfhgNw.png"},"text":"Figure 20: Disabling Taskbar","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*w2esdM201pvIwGygjnHR_A.png":{"__typename":"ImageMetadata","id":"1*w2esdM201pvIwGygjnHR_A.png","originalHeight":390,"originalWidth":964,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_107":{"__typename":"Paragraph","id":"82e6dba47dd1_107","name":"e451","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*w2esdM201pvIwGygjnHR_A.png"},"text":"Figure 21: “Blue Screen”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_108":{"__typename":"Paragraph","id":"82e6dba47dd1_108","name":"5bcc","type":"H4","href":null,"layout":null,"metadata":null,"text":"Evading Banking Protection & Anti-Fraud Products","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_109":{"__typename":"Paragraph","id":"82e6dba47dd1_109","name":"b207","type":"P","href":null,"layout":null,"metadata":null,"text":"Metamorfo also makes efforts to evade banking protection and anti-fraud products by setting a hook on LoadLibraryW function and checking which DLL is loaded, the trampoline can be seen in Figure 22:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":102,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2KwWxKIMKETu9WRa0bNk9g.png":{"__typename":"ImageMetadata","id":"1*2KwWxKIMKETu9WRa0bNk9g.png","originalHeight":143,"originalWidth":565,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_110":{"__typename":"Paragraph","id":"82e6dba47dd1_110","name":"14db","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2KwWxKIMKETu9WRa0bNk9g.png"},"text":"Figure 22: Trampoline based hook in LoadLibraryW","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":36,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_111":{"__typename":"Paragraph","id":"82e6dba47dd1_111","name":"5745","type":"P","href":null,"layout":null,"metadata":null,"text":"With the help of this trampoline, for every LoadLibraryW call the attackers will check if the DLL to be loaded contains one of the following anti-fraud and banking protection strings:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":44,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_112":{"__typename":"Paragraph","id":"82e6dba47dd1_112","name":"da8f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Gbpinj","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_113":{"__typename":"Paragraph","id":"82e6dba47dd1_113","name":"6a2d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Scpbrad","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_114":{"__typename":"Paragraph","id":"82e6dba47dd1_114","name":"aa63","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Scpad","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_115":{"__typename":"Paragraph","id":"82e6dba47dd1_115","name":"d38a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Trusteer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_116":{"__typename":"Paragraph","id":"82e6dba47dd1_116","name":"73cc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Warsaw","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_117":{"__typename":"Paragraph","id":"82e6dba47dd1_117","name":"7068","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Gblplugin","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_118":{"__typename":"Paragraph","id":"82e6dba47dd1_118","name":"ec2f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ipsbho","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_119":{"__typename":"Paragraph","id":"82e6dba47dd1_119","name":"042c","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Hook","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_120":{"__typename":"Paragraph","id":"82e6dba47dd1_120","name":"5441","type":"P","href":null,"layout":null,"metadata":null,"text":"If one of them is matched, the DLL LoadLibraryW call is trying to load wouldn’t load.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":35,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_121":{"__typename":"Paragraph","id":"82e6dba47dd1_121","name":"81a0","type":"P","href":null,"layout":null,"metadata":null,"text":"Figure 23 shows a few searched strings:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KOMcnV1aNn7f4ooP1FSxUA.png":{"__typename":"ImageMetadata","id":"1*KOMcnV1aNn7f4ooP1FSxUA.png","originalHeight":372,"originalWidth":942,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:82e6dba47dd1_122":{"__typename":"Paragraph","id":"82e6dba47dd1_122","name":"1094","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KOMcnV1aNn7f4ooP1FSxUA.png"},"text":"Figure 23: Some of the banking protection and anti-fraud searched strings","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_123":{"__typename":"Paragraph","id":"82e6dba47dd1_123","name":"773d","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCS","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_124":{"__typename":"Paragraph","id":"82e6dba47dd1_124","name":"0f93","type":"H4","href":null,"layout":null,"metadata":null,"text":"Hashes:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_125":{"__typename":"Paragraph","id":"82e6dba47dd1_125","name":"1af7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"MSI — F1498E679885389C32FDF5EC39813FE5D4D34F23","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_126":{"__typename":"Paragraph","id":"82e6dba47dd1_126","name":"4d0e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Other related samples https:\u002F\u002Fgist.github.com\u002Fchenerlich\u002F4e7a22a6263383a4ce3810082a8ac991","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":22,"end":89,"href":"https:\u002F\u002Fgist.github.com\u002Fchenerlich\u002F4e7a22a6263383a4ce3810082a8ac991","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_127":{"__typename":"Paragraph","id":"82e6dba47dd1_127","name":"75bf","type":"ULI","href":null,"layout":null,"metadata":null,"text":"AvDump32.exe — 2A1A5D7C85560924EDC434A1D2F23ED3445D86F4","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_128":{"__typename":"Paragraph","id":"82e6dba47dd1_128","name":"2136","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Dbghelp.dll — 08823578841AEED044EAD81ED6DB16DD95B6FF4B","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_129":{"__typename":"Paragraph","id":"82e6dba47dd1_129","name":"33f9","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Other related samples https:\u002F\u002Fgist.github.com\u002Fchenerlich\u002F0095444e60ae4d04ab75721dec522287","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":22,"end":89,"href":"https:\u002F\u002Fgist.github.com\u002Fchenerlich\u002F0095444e60ae4d04ab75721dec522287","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_130":{"__typename":"Paragraph","id":"82e6dba47dd1_130","name":"414f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Ssleay64.dll -","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_131":{"__typename":"Paragraph","id":"82e6dba47dd1_131","name":"0ec3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"F5E63580710E8FA884377A746FC822E5","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_132":{"__typename":"Paragraph","id":"82e6dba47dd1_132","name":"9297","type":"ULI","href":null,"layout":null,"metadata":null,"text":"C00BF102482C61E4CAB3C6B6666697779092FADC","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_133":{"__typename":"Paragraph","id":"82e6dba47dd1_133","name":"d83b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"6242CC3009A96F97AB9586C970DB26EDE5512F9A","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_134":{"__typename":"Paragraph","id":"82e6dba47dd1_134","name":"b953","type":"ULI","href":null,"layout":null,"metadata":null,"text":"03A5BEF2B9DE1DF5C19C9F4D2AEC6F780F4749D0","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_135":{"__typename":"Paragraph","id":"82e6dba47dd1_135","name":"16c6","type":"ULI","href":null,"layout":null,"metadata":null,"text":"C15154D7323EA0C7A40912C799599DACCEB4E7CE","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_136":{"__typename":"Paragraph","id":"82e6dba47dd1_136","name":"6d1c","type":"P","href":null,"layout":null,"metadata":null,"text":"URLs:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_137":{"__typename":"Paragraph","id":"82e6dba47dd1_137","name":"e059","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fdisenyrt3\u002Fimage2.png","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":57,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fdisenyrt3\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_138":{"__typename":"Paragraph","id":"82e6dba47dd1_138","name":"cbcc","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fsharknadorki\u002Fimage2.png","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":60,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fsharknadorki\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_139":{"__typename":"Paragraph","id":"82e6dba47dd1_139","name":"b3d0","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fjasonrwk5wg\u002Fimage2.png","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":59,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fjasonrwk5wg\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_140":{"__typename":"Paragraph","id":"82e6dba47dd1_140","name":"5fcd","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Ffrezaaaewrwty\u002Fimage2.png","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":61,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Ffrezaaaewrwty\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_141":{"__typename":"Paragraph","id":"82e6dba47dd1_141","name":"a25c","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fcadeaadl54t4gw4\u002Fimage2.png","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":63,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fcadeaadl54t4gw4\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_142":{"__typename":"Paragraph","id":"82e6dba47dd1_142","name":"5870","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fsharknadorki\u002Fimage2.png\n https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fjooosan\u002Fimage2.png\n https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fshhakkr\u002Fimage2.png","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":60,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fsharknadorki\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":62,"end":117,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fjooosan\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":119,"end":174,"href":"https:\u002F\u002Fs3-eu-west-1[.]amazonaws.com\u002Fshhakkr\u002Fimage2.png","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_143":{"__typename":"Paragraph","id":"82e6dba47dd1_143","name":"b2b3","type":"P","href":null,"layout":null,"metadata":null,"text":"www.goole[.]com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":15,"href":"http:\u002F\u002Fwww.goole[.]com","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_144":{"__typename":"Paragraph","id":"82e6dba47dd1_144","name":"956f","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.localizaip.com[.]br\u002Fapi\u002Fiplocation.php","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":50,"href":"https:\u002F\u002Fwww.localizaip.com[.]br\u002Fapi\u002Fiplocation.php","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_145":{"__typename":"Paragraph","id":"82e6dba47dd1_145","name":"28dd","type":"P","href":null,"layout":null,"metadata":null,"text":"mrs04s09-in-f206.1e100[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_146":{"__typename":"Paragraph","id":"82e6dba47dd1_146","name":"37a7","type":"P","href":null,"layout":null,"metadata":null,"text":"lhr25s13-in-f78.1e100[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_147":{"__typename":"Paragraph","id":"82e6dba47dd1_147","name":"3b12","type":"P","href":null,"layout":null,"metadata":null,"text":"dub08s01-in-f14.1e100[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_148":{"__typename":"Paragraph","id":"82e6dba47dd1_148","name":"aca1","type":"P","href":null,"layout":null,"metadata":null,"text":"lhr25s11-in-f46.1e100[.]net","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_149":{"__typename":"Paragraph","id":"82e6dba47dd1_149","name":"eb0d","type":"P","href":null,"layout":null,"metadata":null,"text":"Files:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_150":{"__typename":"Paragraph","id":"82e6dba47dd1_150","name":"2413","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\Macromedia","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_151":{"__typename":"Paragraph","id":"82e6dba47dd1_151","name":"fb5f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\Macromedia\\desktop.txt","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_152":{"__typename":"Paragraph","id":"82e6dba47dd1_152","name":"d4b3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\TeamViewer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_153":{"__typename":"Paragraph","id":"82e6dba47dd1_153","name":"2510","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\TeamViewer\\desktop.txt","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_154":{"__typename":"Paragraph","id":"82e6dba47dd1_154","name":"a8ef","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\DMCache","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_155":{"__typename":"Paragraph","id":"82e6dba47dd1_155","name":"f789","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\DMCache\\desktop.txt","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_156":{"__typename":"Paragraph","id":"82e6dba47dd1_156","name":"8dcc","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\AnyDesk","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_157":{"__typename":"Paragraph","id":"82e6dba47dd1_157","name":"f01e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"%APPDATA%\\AnyDesk\\desktop.txt","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_158":{"__typename":"Paragraph","id":"82e6dba47dd1_158","name":"8026","type":"P","href":null,"layout":null,"metadata":null,"text":"Registry:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":9,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_159":{"__typename":"Paragraph","id":"82e6dba47dd1_159","name":"38b4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"HKCU\\Software\\index","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_160":{"__typename":"Paragraph","id":"82e6dba47dd1_160","name":"d4d5","type":"P","href":null,"layout":null,"metadata":null,"text":"Mutexes:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_161":{"__typename":"Paragraph","id":"82e6dba47dd1_161","name":"bd3f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"[7F4HRE-375E-AEF3-BE9A-OBJT389F53]","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_162":{"__typename":"Paragraph","id":"82e6dba47dd1_162","name":"c248","type":"ULI","href":null,"layout":null,"metadata":null,"text":"libea54","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_163":{"__typename":"Paragraph","id":"82e6dba47dd1_163","name":"8ee0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"One-InstanceJes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_164":{"__typename":"Paragraph","id":"82e6dba47dd1_164","name":"cd21","type":"P","href":null,"layout":null,"metadata":null,"text":"Thanks for reading. Follow me on Twitter for more posts like this one.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:82e6dba47dd1_165":{"__typename":"Paragraph","id":"82e6dba47dd1_165","name":"1fd6","type":"MIXTAPE_EMBED","href":null,"layout":null,"metadata":null,"text":"Chen Erlich\nThe latest Tweets from Chen Erlich (@chen_erlich). Security Researcher. Opinions are on my own. #MalwareResearch…twitter.com","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":136,"href":"https:\u002F\u002Ftwitter.com\u002Fchen_erlich","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":12,"end":125,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":{"__typename":"MixtapeMetadata","href":"https:\u002F\u002Ftwitter.com\u002Fchen_erlich","mediaResource":{"__typename":"MediaResource","mediumCatalog":null},"thumbnailImageId":"0*5X3szIZsZ39R7lg8"}},"PostViewerEdge:postId:ac9b8b392767-viewerId:lo_e27fccfa754c":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:ac9b8b392767-viewerId:lo_e27fccfa754c"},"Tag:metamorfo":{"__typename":"Tag","id":"metamorfo","displayTitle":"Metamorfo","normalizedTagSlug":"metamorfo"},"Tag:trojan":{"__typename":"Tag","id":"trojan","displayTitle":"Trojan","normalizedTagSlug":"trojan"},"Tag:avast":{"__typename":"Tag","id":"avast","displayTitle":"Avast","normalizedTagSlug":"avast"},"Tag:dll-hijacking":{"__typename":"Tag","id":"dll-hijacking","displayTitle":"Dll Hijacking","normalizedTagSlug":"dll-hijacking"},"Tag:brazilian":{"__typename":"Tag","id":"brazilian","displayTitle":"Brazilian","normalizedTagSlug":"brazilian"},"User:d43c46db5b92":{"__typename":"User","id":"d43c46db5b92"},"Collection:f5af2b715248":{"__typename":"Collection","id":"f5af2b715248","creator":{"__ref":"User:d43c46db5b92"},"name":"The Startup"},"Post:ac9b8b392767":{"__typename":"Post","id":"ac9b8b392767","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e3cf","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"f5b8","startIndex":164,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:82e6dba47dd1_0"},{"__ref":"Paragraph:82e6dba47dd1_1"},{"__ref":"Paragraph:82e6dba47dd1_2"},{"__ref":"Paragraph:82e6dba47dd1_3"},{"__ref":"Paragraph:82e6dba47dd1_4"},{"__ref":"Paragraph:82e6dba47dd1_5"},{"__ref":"Paragraph:82e6dba47dd1_6"},{"__ref":"Paragraph:82e6dba47dd1_7"},{"__ref":"Paragraph:82e6dba47dd1_8"},{"__ref":"Paragraph:82e6dba47dd1_9"},{"__ref":"Paragraph:82e6dba47dd1_10"},{"__ref":"Paragraph:82e6dba47dd1_11"},{"__ref":"Paragraph:82e6dba47dd1_12"},{"__ref":"Paragraph:82e6dba47dd1_13"},{"__ref":"Paragraph:82e6dba47dd1_14"},{"__ref":"Paragraph:82e6dba47dd1_15"},{"__ref":"Paragraph:82e6dba47dd1_16"},{"__ref":"Paragraph:82e6dba47dd1_17"},{"__ref":"Paragraph:82e6dba47dd1_18"},{"__ref":"Paragraph:82e6dba47dd1_19"},{"__ref":"Paragraph:82e6dba47dd1_20"},{"__ref":"Paragraph:82e6dba47dd1_21"},{"__ref":"Paragraph:82e6dba47dd1_22"},{"__ref":"Paragraph:82e6dba47dd1_23"},{"__ref":"Paragraph:82e6dba47dd1_24"},{"__ref":"Paragraph:82e6dba47dd1_25"},{"__ref":"Paragraph:82e6dba47dd1_26"},{"__ref":"Paragraph:82e6dba47dd1_27"},{"__ref":"Paragraph:82e6dba47dd1_28"},{"__ref":"Paragraph:82e6dba47dd1_29"},{"__ref":"Paragraph:82e6dba47dd1_30"},{"__ref":"Paragraph:82e6dba47dd1_31"},{"__ref":"Paragraph:82e6dba47dd1_32"},{"__ref":"Paragraph:82e6dba47dd1_33"},{"__ref":"Paragraph:82e6dba47dd1_34"},{"__ref":"Paragraph:82e6dba47dd1_35"},{"__ref":"Paragraph:82e6dba47dd1_36"},{"__ref":"Paragraph:82e6dba47dd1_37"},{"__ref":"Paragraph:82e6dba47dd1_38"},{"__ref":"Paragraph:82e6dba47dd1_39"},{"__ref":"Paragraph:82e6dba47dd1_40"},{"__ref":"Paragraph:82e6dba47dd1_41"},{"__ref":"Paragraph:82e6dba47dd1_42"},{"__ref":"Paragraph:82e6dba47dd1_43"},{"__ref":"Paragraph:82e6dba47dd1_44"},{"__ref":"Paragraph:82e6dba47dd1_45"},{"__ref":"Paragraph:82e6dba47dd1_46"},{"__ref":"Paragraph:82e6dba47dd1_47"},{"__ref":"Paragraph:82e6dba47dd1_48"},{"__ref":"Paragraph:82e6dba47dd1_49"},{"__ref":"Paragraph:82e6dba47dd1_50"},{"__ref":"Paragraph:82e6dba47dd1_51"},{"__ref":"Paragraph:82e6dba47dd1_52"},{"__ref":"Paragraph:82e6dba47dd1_53"},{"__ref":"Paragraph:82e6dba47dd1_54"},{"__ref":"Paragraph:82e6dba47dd1_55"},{"__ref":"Paragraph:82e6dba47dd1_56"},{"__ref":"Paragraph:82e6dba47dd1_57"},{"__ref":"Paragraph:82e6dba47dd1_58"},{"__ref":"Paragraph:82e6dba47dd1_59"},{"__ref":"Paragraph:82e6dba47dd1_60"},{"__ref":"Paragraph:82e6dba47dd1_61"},{"__ref":"Paragraph:82e6dba47dd1_62"},{"__ref":"Paragraph:82e6dba47dd1_63"},{"__ref":"Paragraph:82e6dba47dd1_64"},{"__ref":"Paragraph:82e6dba47dd1_65"},{"__ref":"Paragraph:82e6dba47dd1_66"},{"__ref":"Paragraph:82e6dba47dd1_67"},{"__ref":"Paragraph:82e6dba47dd1_68"},{"__ref":"Paragraph:82e6dba47dd1_69"},{"__ref":"Paragraph:82e6dba47dd1_70"},{"__ref":"Paragraph:82e6dba47dd1_71"},{"__ref":"Paragraph:82e6dba47dd1_72"},{"__ref":"Paragraph:82e6dba47dd1_73"},{"__ref":"Paragraph:82e6dba47dd1_74"},{"__ref":"Paragraph:82e6dba47dd1_75"},{"__ref":"Paragraph:82e6dba47dd1_76"},{"__ref":"Paragraph:82e6dba47dd1_77"},{"__ref":"Paragraph:82e6dba47dd1_78"},{"__ref":"Paragraph:82e6dba47dd1_79"},{"__ref":"Paragraph:82e6dba47dd1_80"},{"__ref":"Paragraph:82e6dba47dd1_81"},{"__ref":"Paragraph:82e6dba47dd1_82"},{"__ref":"Paragraph:82e6dba47dd1_83"},{"__ref":"Paragraph:82e6dba47dd1_84"},{"__ref":"Paragraph:82e6dba47dd1_85"},{"__ref":"Paragraph:82e6dba47dd1_86"},{"__ref":"Paragraph:82e6dba47dd1_87"},{"__ref":"Paragraph:82e6dba47dd1_88"},{"__ref":"Paragraph:82e6dba47dd1_89"},{"__ref":"Paragraph:82e6dba47dd1_90"},{"__ref":"Paragraph:82e6dba47dd1_91"},{"__ref":"Paragraph:82e6dba47dd1_92"},{"__ref":"Paragraph:82e6dba47dd1_93"},{"__ref":"Paragraph:82e6dba47dd1_94"},{"__ref":"Paragraph:82e6dba47dd1_95"},{"__ref":"Paragraph:82e6dba47dd1_96"},{"__ref":"Paragraph:82e6dba47dd1_97"},{"__ref":"Paragraph:82e6dba47dd1_98"},{"__ref":"Paragraph:82e6dba47dd1_99"},{"__ref":"Paragraph:82e6dba47dd1_100"},{"__ref":"Paragraph:82e6dba47dd1_101"},{"__ref":"Paragraph:82e6dba47dd1_102"},{"__ref":"Paragraph:82e6dba47dd1_103"},{"__ref":"Paragraph:82e6dba47dd1_104"},{"__ref":"Paragraph:82e6dba47dd1_105"},{"__ref":"Paragraph:82e6dba47dd1_106"},{"__ref":"Paragraph:82e6dba47dd1_107"},{"__ref":"Paragraph:82e6dba47dd1_108"},{"__ref":"Paragraph:82e6dba47dd1_109"},{"__ref":"Paragraph:82e6dba47dd1_110"},{"__ref":"Paragraph:82e6dba47dd1_111"},{"__ref":"Paragraph:82e6dba47dd1_112"},{"__ref":"Paragraph:82e6dba47dd1_113"},{"__ref":"Paragraph:82e6dba47dd1_114"},{"__ref":"Paragraph:82e6dba47dd1_115"},{"__ref":"Paragraph:82e6dba47dd1_116"},{"__ref":"Paragraph:82e6dba47dd1_117"},{"__ref":"Paragraph:82e6dba47dd1_118"},{"__ref":"Paragraph:82e6dba47dd1_119"},{"__ref":"Paragraph:82e6dba47dd1_120"},{"__ref":"Paragraph:82e6dba47dd1_121"},{"__ref":"Paragraph:82e6dba47dd1_122"},{"__ref":"Paragraph:82e6dba47dd1_123"},{"__ref":"Paragraph:82e6dba47dd1_124"},{"__ref":"Paragraph:82e6dba47dd1_125"},{"__ref":"Paragraph:82e6dba47dd1_126"},{"__ref":"Paragraph:82e6dba47dd1_127"},{"__ref":"Paragraph:82e6dba47dd1_128"},{"__ref":"Paragraph:82e6dba47dd1_129"},{"__ref":"Paragraph:82e6dba47dd1_130"},{"__ref":"Paragraph:82e6dba47dd1_131"},{"__ref":"Paragraph:82e6dba47dd1_132"},{"__ref":"Paragraph:82e6dba47dd1_133"},{"__ref":"Paragraph:82e6dba47dd1_134"},{"__ref":"Paragraph:82e6dba47dd1_135"},{"__ref":"Paragraph:82e6dba47dd1_136"},{"__ref":"Paragraph:82e6dba47dd1_137"},{"__ref":"Paragraph:82e6dba47dd1_138"},{"__ref":"Paragraph:82e6dba47dd1_139"},{"__ref":"Paragraph:82e6dba47dd1_140"},{"__ref":"Paragraph:82e6dba47dd1_141"},{"__ref":"Paragraph:82e6dba47dd1_142"},{"__ref":"Paragraph:82e6dba47dd1_143"},{"__ref":"Paragraph:82e6dba47dd1_144"},{"__ref":"Paragraph:82e6dba47dd1_145"},{"__ref":"Paragraph:82e6dba47dd1_146"},{"__ref":"Paragraph:82e6dba47dd1_147"},{"__ref":"Paragraph:82e6dba47dd1_148"},{"__ref":"Paragraph:82e6dba47dd1_149"},{"__ref":"Paragraph:82e6dba47dd1_150"},{"__ref":"Paragraph:82e6dba47dd1_151"},{"__ref":"Paragraph:82e6dba47dd1_152"},{"__ref":"Paragraph:82e6dba47dd1_153"},{"__ref":"Paragraph:82e6dba47dd1_154"},{"__ref":"Paragraph:82e6dba47dd1_155"},{"__ref":"Paragraph:82e6dba47dd1_156"},{"__ref":"Paragraph:82e6dba47dd1_157"},{"__ref":"Paragraph:82e6dba47dd1_158"},{"__ref":"Paragraph:82e6dba47dd1_159"},{"__ref":"Paragraph:82e6dba47dd1_160"},{"__ref":"Paragraph:82e6dba47dd1_161"},{"__ref":"Paragraph:82e6dba47dd1_162"},{"__ref":"Paragraph:82e6dba47dd1_163"},{"__ref":"Paragraph:82e6dba47dd1_164"},{"__ref":"Paragraph:82e6dba47dd1_165"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:63409eb2f083"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@chenerlich\u002Fthe-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"82e6dba47dd1","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":1,"allowResponses":true,"isLimitedState":false,"title":"The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable","isSeries":false,"sequence":null,"uniqueSlug":"the-avast-abuser-metamorfo-banking-malware-hides-by-abusing-avast-executable-ac9b8b392767","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1586444875614,"readingTime":9.616037735849057,"previewContent":{"__typename":"PreviewContent","subtitle":"Unveiling a new Brazilian banking campaign, abusing a legitimate Avast executable"},"previewImage":{"__ref":"ImageMetadata:1*k5MIwsiJW3pkIWSipXZMoA.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1585951527758,"updatedAt":1639441975451,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:ac9b8b392767-viewerId:lo_e27fccfa754c"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:metamorfo"},{"__ref":"Tag:trojan"},{"__ref":"Tag:avast"},{"__ref":"Tag:dll-hijacking"},{"__ref":"Tag:brazilian"}],"isNewsletter":false,"statusForCollection":"PENDING","pendingCollection":{"__ref":"Collection:f5af2b715248"},"detectedLanguage":"en","wordCount":2058,"layerCake":4}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.7e50e797.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.018e7ca9.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1386.6a7a21a1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.84e4bd5c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/719.ae4dd3e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6349.b071a958.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1443.598cb8b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3735.8c38ede2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.d10c9ba0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.08de95de.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1781.db373833.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.0330d157.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.ca7937c2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.d195c6f1.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.21ff89d3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.55c925ce.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2961.00a48598.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/230.4d7a2738.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.563d0db5.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8d764beb39e9df4e',t:'MTcyOTczNDQyMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>