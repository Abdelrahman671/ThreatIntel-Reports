<!doctype html><html lang="en"><head><title data-rh="true">NanoCore RAT Hunting Guide. Analysis and tools for hunting NanoCore… | by John F | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2022-09-14T06:03:25.332Z"/><meta data-rh="true" name="title" content="NanoCore RAT Hunting Guide. Analysis and tools for hunting NanoCore… | by John F | Medium"/><meta data-rh="true" property="og:title" content="NanoCore RAT Hunting Guide"/><meta data-rh="true" property="al:android:url" content="medium://p/cb185473c1e0"/><meta data-rh="true" property="al:ios:url" content="medium://p/cb185473c1e0"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="NanoCore is a prevalent RAT (Remote Access Trojan) which is used by threat actors to spy on victims and provide remote access to target computers. CISA identified NanoCore as a top malware strain of…"/><meta data-rh="true" property="og:description" content="Analysis and tools for hunting NanoCore command-and-control"/><meta data-rh="true" property="og:url" content="https://medium.com/@the_abjuri5t/nanocore-rat-hunting-guide-cb185473c1e0"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@the_abjuri5t/nanocore-rat-hunting-guide-cb185473c1e0"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:801/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg"/><meta data-rh="true" property="article:author" content="https://medium.com/@the_abjuri5t"/><meta data-rh="true" name="author" content="John F"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="NanoCore RAT Hunting Guide"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/cb185473c1e0"/><meta data-rh="true" property="twitter:description" content="Analysis and tools for hunting NanoCore command-and-control"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:801/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@Abjuri5t"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@the_abjuri5t"/><link data-rh="true" rel="canonical" href="https://medium.com/@the_abjuri5t/nanocore-rat-hunting-guide-cb185473c1e0"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/cb185473c1e0"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*DVdcHYCvKJIIj9zj1PLhkg.jpeg"],"url":"https:\u002F\u002Fmedium.com\u002F@the_abjuri5t\u002Fnanocore-rat-hunting-guide-cb185473c1e0","dateCreated":"2022-08-30T13:43:57.847Z","datePublished":"2022-08-30T13:43:57.847Z","dateModified":"2023-10-12T02:15:15.003Z","headline":"NanoCore RAT Hunting Guide - John F - Medium","name":"NanoCore RAT Hunting Guide - John F - Medium","description":"NanoCore is a prevalent RAT (Remote Access Trojan) which is used by threat actors to spy on victims and provide remote access to target computers. CISA identified NanoCore as a top malware strain of…","identifier":"cb185473c1e0","author":{"@type":"Person","name":"John F","url":"https:\u002F\u002Fmedium.com\u002F@the_abjuri5t"},"creator":["John F"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@the_abjuri5t\u002Fnanocore-rat-hunting-guide-cb185473c1e0"}</script><style type="text/css" data-fela-rehydration="557" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="557" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.hq{margin-bottom:-0.27em}.hr{line-height:1.394}.im{align-items:baseline}.in{width:48px}.io{height:48px}.ip{border:2px solid rgba(255, 255, 255, 1)}.iq{z-index:0}.ir{box-shadow:none}.is{border:1px solid rgba(0, 0, 0, 0.05)}.it{margin-bottom:2px}.iu{flex-wrap:nowrap}.iv{font-size:16px}.iw{line-height:24px}.iy{margin:0 8px}.iz{display:inline}.ja{color:#1A8917}.jb{fill:#1A8917}.je{flex:0 0 auto}.jh{flex-wrap:wrap}.ji{padding-left:8px}.jj{padding-right:8px}.kk> *{flex-shrink:0}.kl{overflow-x:scroll}.km::-webkit-scrollbar{display:none}.kn{scrollbar-width:none}.ko{-ms-overflow-style:none}.kp{width:74px}.kq{flex-direction:row}.kr{z-index:2}.ks{margin-right:4px}.kv{-webkit-user-select:none}.kw{border:0}.kx{fill:rgba(117, 117, 117, 1)}.la{outline:0}.lb{user-select:none}.lc> svg{pointer-events:none}.ll{cursor:progress}.lm{opacity:1}.ln{padding:4px 0}.lq{margin-top:0px}.lr{width:16px}.lt{display:inline-flex}.lz{max-width:100%}.ma{padding:8px 2px}.mb svg{color:#6B6B6B}.ms{line-height:1.58}.mt{letter-spacing:-0.004em}.mu{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nn{margin-bottom:-0.46em}.no{text-decoration:underline}.np{line-height:1.18}.nq{letter-spacing:-0.022em}.nr{font-weight:600}.oh{margin-bottom:-0.31em}.on{list-style-type:disc}.oo{margin-left:30px}.op{padding-left:0px}.ov{margin-left:auto}.ow{margin-right:auto}.ox{max-width:801px}.pd{clear:both}.pf{cursor:zoom-in}.pg{z-index:auto}.pi{height:auto}.pj{line-height:1.12}.qa{margin-bottom:-0.28em}.qb{max-width:1140px}.qc{margin-top:10px}.qd{max-width:728px}.qg{font-style:italic}.qh{max-width:1273px}.qi{max-width:953px}.qj{background:none}.qk{overflow-x:auto}.ql{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qm{padding:20px}.qn{border-radius:0}.qo{background:#F2F2F2}.qp{margin-top:-0.09em}.qq{margin-bottom:-0.09em}.qr{white-space:pre-wrap}.qs{min-width:fit-content}.qt{max-width:745px}.qu{margin-bottom:26px}.qv{margin-top:6px}.qw{margin-top:8px}.qx{margin-right:8px}.qy{padding:8px 16px}.qz{border-radius:100px}.ra{transition:background 300ms ease}.rc{white-space:nowrap}.rd{border-top:none}.re{margin-bottom:14px}.rf{height:52px}.rg{max-height:52px}.rh{box-sizing:content-box}.ri{position:static}.rj{z-index:1}.rl{max-width:155px}.rr{margin-right:20px}.rx{height:0px}.ry{margin-bottom:40px}.sn{height:64px}.so{width:64px}.sp{align-self:flex-end}.sq{color:rgba(255, 255, 255, 1)}.sr{fill:rgba(255, 255, 255, 1)}.ss{background:rgba(25, 25, 25, 1)}.st{border-color:rgba(25, 25, 25, 1)}.sw:disabled{opacity:0.1}.sx:disabled:hover{background:rgba(25, 25, 25, 1)}.sy:disabled:hover{border-color:rgba(25, 25, 25, 1)}.sz{flex:1 1 auto}.tf{padding-right:4px}.tg{font-weight:500}.tn{margin-top:16px}.to{margin-bottom:54px}.tu{gap:18px}.tv{fill:rgba(61, 61, 61, 1)}.uh{border-bottom:solid 1px #E5E5E5}.ui{margin-top:72px}.uj{padding:24px 0}.uk{margin-bottom:0px}.ul{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.ix:hover{text-decoration:underline}.jc:hover:not(:disabled){color:#156D12}.jd:hover:not(:disabled){fill:#156D12}.kz:hover{fill:rgba(8, 8, 8, 1)}.lo:hover{fill:#000000}.lp:hover p{color:#000000}.ls:hover{color:#000000}.mc:hover svg{color:#000000}.rb:hover{background-color:#F2F2F2}.sm:hover{background-color:none}.su:hover{background:#000000}.sv:hover{border-color:#242424}.tw:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.ky:focus{fill:rgba(8, 8, 8, 1)}.md:focus svg{color:#000000}.ph:focus{transform:scale(1.01)}.ld:active{border-style:none}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hm{font-size:42px}.hn{margin-top:1.19em}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.ie{font-size:22px}.if{margin-top:0.92em}.ig{line-height:28px}.il{align-items:center}.jw{border-top:solid 1px #F2F2F2}.jx{border-bottom:solid 1px #F2F2F2}.jy{margin:32px 0 0}.jz{padding:3px 8px}.ki> *{margin-right:24px}.kj> :last-child{margin-right:0}.lk{margin-top:0px}.ly{margin:0}.nj{font-size:20px}.nk{margin-top:2.14em}.nl{line-height:32px}.nm{letter-spacing:-0.003em}.oe{margin-top:1.72em}.of{line-height:24px}.og{letter-spacing:0}.om{margin-top:0.94em}.ou{margin-top:1.14em}.pc{margin-top:56px}.pw{font-size:24px}.px{margin-top:1.95em}.py{line-height:30px}.pz{letter-spacing:-0.016em}.rq{display:inline-block}.rw{margin-bottom:104px}.rz{flex-direction:row}.sc{margin-bottom:0}.sd{margin-right:20px}.ta{max-width:500px}.tt{margin-bottom:72px}.ub{margin:40px 0 0}.ug{padding-top:72px}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.lj{margin-top:0px}.qe{margin-left:auto}.qf{text-align:center}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.li{margin-top:0px}.ro{display:inline-block}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lg{margin-top:0px}.lh{margin-right:0px}.rn{display:inline-block}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{line-height:38px}.gz{letter-spacing:-0.014em}.hs{font-size:18px}.ht{margin-top:0.79em}.hu{line-height:24px}.ih{align-items:flex-start}.jf{flex-direction:column}.jk{margin:24px -24px 0}.jl{padding:0}.ka> *{margin-right:8px}.kb> :last-child{margin-right:24px}.kt{margin-left:0px}.le{margin-top:0px}.lf{margin-right:0px}.lu{margin:0}.me{border:1px solid #F2F2F2}.mf{border-radius:99em}.mg{padding:0px 16px 0px 12px}.mh{height:38px}.mi{align-items:center}.mk svg{margin-right:8px}.mv{margin-top:1.56em}.mw{line-height:28px}.mx{letter-spacing:-0.003em}.ns{font-size:16px}.nt{margin-top:1.23em}.nu{letter-spacing:0}.oi{margin-top:0.67em}.oq{margin-top:1.34em}.oy{margin-top:40px}.pk{font-size:20px}.pl{margin-top:1.2em}.rm{display:inline-block}.rs{margin-bottom:96px}.sk{margin-bottom:20px}.sl{margin-right:0}.te{max-width:100%}.th{font-size:24px}.ti{line-height:30px}.tj{letter-spacing:-0.016em}.tp{margin-bottom:64px}.tx{margin:32px 0 0}.uc{padding-top:48px}.mj:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hi{font-size:42px}.hj{margin-top:1.19em}.hk{line-height:52px}.hl{letter-spacing:-0.011em}.ib{font-size:22px}.ic{margin-top:0.92em}.id{line-height:28px}.ik{align-items:center}.js{border-top:solid 1px #F2F2F2}.jt{border-bottom:solid 1px #F2F2F2}.ju{margin:32px 0 0}.jv{padding:3px 8px}.kg> *{margin-right:24px}.kh> :last-child{margin-right:0}.lx{margin:0}.nf{font-size:20px}.ng{margin-top:2.14em}.nh{line-height:32px}.ni{letter-spacing:-0.003em}.ob{margin-top:1.72em}.oc{line-height:24px}.od{letter-spacing:0}.ol{margin-top:0.94em}.ot{margin-top:1.14em}.pb{margin-top:56px}.ps{font-size:24px}.pt{margin-top:1.95em}.pu{line-height:30px}.pv{letter-spacing:-0.016em}.rv{margin-bottom:104px}.sa{flex-direction:row}.se{margin-bottom:0}.sf{margin-right:20px}.tb{max-width:500px}.ts{margin-bottom:72px}.ua{margin:40px 0 0}.uf{padding-top:72px}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.he{font-size:42px}.hf{margin-top:1.19em}.hg{line-height:52px}.hh{letter-spacing:-0.011em}.hy{font-size:22px}.hz{margin-top:0.92em}.ia{line-height:28px}.ij{align-items:center}.jo{border-top:solid 1px #F2F2F2}.jp{border-bottom:solid 1px #F2F2F2}.jq{margin:32px 0 0}.jr{padding:3px 8px}.ke> *{margin-right:24px}.kf> :last-child{margin-right:0}.lw{margin:0}.nb{font-size:20px}.nc{margin-top:2.14em}.nd{line-height:32px}.ne{letter-spacing:-0.003em}.ny{margin-top:1.72em}.nz{line-height:24px}.oa{letter-spacing:0}.ok{margin-top:0.94em}.os{margin-top:1.14em}.pa{margin-top:56px}.po{font-size:24px}.pp{margin-top:1.95em}.pq{line-height:30px}.pr{letter-spacing:-0.016em}.ru{margin-bottom:104px}.sb{flex-direction:row}.sg{margin-bottom:0}.sh{margin-right:20px}.tc{max-width:500px}.tr{margin-bottom:72px}.tz{margin:40px 0 0}.ue{padding-top:72px}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.ha{font-size:32px}.hb{margin-top:1.01em}.hc{line-height:38px}.hd{letter-spacing:-0.014em}.hv{font-size:18px}.hw{margin-top:0.79em}.hx{line-height:24px}.ii{align-items:flex-start}.jg{flex-direction:column}.jm{margin:24px 0 0}.jn{padding:0}.kc> *{margin-right:8px}.kd> :last-child{margin-right:8px}.ku{margin-left:0px}.lv{margin:0}.ml{border:1px solid #F2F2F2}.mm{border-radius:99em}.mn{padding:0px 16px 0px 12px}.mo{height:38px}.mp{align-items:center}.mr svg{margin-right:8px}.my{margin-top:1.56em}.mz{line-height:28px}.na{letter-spacing:-0.003em}.nv{font-size:16px}.nw{margin-top:1.23em}.nx{letter-spacing:0}.oj{margin-top:0.67em}.or{margin-top:1.34em}.oz{margin-top:40px}.pm{font-size:20px}.pn{margin-top:1.2em}.rt{margin-bottom:96px}.si{margin-bottom:20px}.sj{margin-right:0}.td{max-width:100%}.tk{font-size:24px}.tl{line-height:30px}.tm{letter-spacing:-0.016em}.tq{margin-bottom:64px}.ty{margin:32px 0 0}.ud{padding-top:48px}.mq:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="print">.rk{display:none}</style><style type="text/css" data-fela-rehydration="557" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pe{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fcb185473c1e0&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="ddc4" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq bk" data-testid="storyTitle">NanoCore RAT Hunting Guide</h1></div><div><h2 id="4ac5" class="pw-subtitle-paragraph hr gt gu bf b hs ht hu hv hw hx hy hz ia ib ic id ie if ig cq du">Analysis and tools for hunting NanoCore command-and-control</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="ih ii ij ik il ab"><div><div class="ab im"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@the_abjuri5t?source=post_page---byline--cb185473c1e0--------------------------------"><div class="l in io by ip iq"><div class="l fj"><img alt="John F" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*OApWCB-Hco86JId_R9cbdA.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="ir by l dd de fs n is ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="it ab q"><div class="ab q iu"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b iv iw bk"><a class="af ag ah ai aj ak al am an ao ap aq ar ix" data-testid="authorName" rel="noopener follow" href="/@the_abjuri5t?source=post_page---byline--cb185473c1e0--------------------------------">John F</a></p></div></div></div><span class="iy iz" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b iv iw du"><span><a class="ja jb ah ai aj ak al am an ao ap aq ar ex jc jd" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F3d056516eaf&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;user=John+F&amp;userId=3d056516eaf&amp;source=post_page-3d056516eaf--byline--cb185473c1e0---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l je"><span class="bf b bg z du"><div class="ab cn jf jg jh"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="ji jj l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Aug 30, 2022</span></div></span></div></span></div></div></div><div class="ab cp jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz"><div class="h k w fg fh q"><div class="kp l"><div class="ab q kq kr"><div class="pw-multi-vote-icon fj ks kt ku kv"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fcb185473c1e0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;user=John+F&amp;userId=3d056516eaf&amp;source=---header_actions--cb185473c1e0---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kw ao kx ky kz la am lb lc ld kv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l le lf lg lh li lj lk"><p class="bf b dv z du"><span class="ll">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kw lm ln ab q fk lo lp" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lq"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q ka kb kc kd ke kf kg kh ki kj kk kl km kn ko"><div class="lr k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb185473c1e0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;source=---header_actions--cb185473c1e0---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du ls" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lt cn"><div class="l ae"><div class="ab cb"><div class="lu lv lw lx ly lz ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al ma an ao ap ex mb mc lp md me mf mg mh s mi mj mk ml mm mn mo u mp mq mr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al ma an ao ap ex mb mc lp md me mf mg mh s mi mj mk ml mm mn mo u mp mq mr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="c79d" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">NanoCore is a prevalent RAT (Remote Access Trojan) which is used by threat actors to spy on victims and provide remote access to target computers. <a class="af no" href="https://www.cisa.gov/uscert/ncas/alerts/aa22-216a" rel="noopener ugc nofollow" target="_blank">CISA identified</a> NanoCore as a top malware strain of 2021 due to its prevalence among cyber criminals and potential to cause damage. I have researched NanoCore’s command-and-control framework and I wrote this blog post as a guide for hunting-down and blocking NanoCore.</p><h2 id="a402" class="np nq gu bf nr ns nt dy nu nv nw ea nx nb ny nz oa nf ob oc od nj oe of og oh bk">Table of Contents</h2><ul class=""><li id="282f" class="ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn on oo op bk"><a class="af no" href="#c2ec" rel="noopener ugc nofollow">Background and Functionality</a></li><li id="a1fe" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk"><a class="af no" href="#8ada" rel="noopener ugc nofollow">Command-and-Control Analysis</a></li><li id="afb3" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk"><a class="af no" href="#7094" rel="noopener ugc nofollow">Network Defenses</a></li><li id="e340" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk"><a class="af no" href="#44ed" rel="noopener ugc nofollow">Meta-Analysis of IOCs</a></li><li id="0cd0" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk"><a class="af no" href="#fad8" rel="noopener ugc nofollow">Hunting Summary</a></li><li id="1a50" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk"><a class="af no" href="#21c1" rel="noopener ugc nofollow">See Also</a></li></ul><figure class="oy oz pa pb pc pd ov ow paragraph-image"><div role="button" tabindex="0" class="pe pf fj pg bh ph"><div class="ov ow ox"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*DVdcHYCvKJIIj9zj1PLhkg.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lz pi c" width="700" height="362" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="c2ec" class="pj nq gu bf nr pk pl hu nu pm pn hx nx po pp pq pr ps pt pu pv pw px py pz qa bk">Background and Functionality</h1><p id="e3a5" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">In 2013, Taylor Huddleston (<a class="af no" href="https://www.fbi.gov/news/stories/malware-creator-sentenced-070518" rel="noopener ugc nofollow" target="_blank">arrested</a> in 2017) wrote NanoCore using the .NET framework. Despite its age, the RAT remains popular among cyber-criminals and malware-as-a-service markets because of its ease of use for non-technical threat actors and various plugin features. NanoCore is widely used today with <a class="af no" href="https://any.run/malware-trends/" rel="noopener ugc nofollow" target="_blank">ANY.RUN Trends</a> documenting it as the 8th most-common malware strain in July 2022.</p><p id="19ad" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">As a RAT, NanoCore is well-suited for providing initial access, stealing information, and spying on victims. Historically, NanoCore’s remote access and spyware capabilities have been used to attack businesses, stalk victims, and conduct espionage for nation-state groups<a class="af no" href="#29b8" rel="noopener ugc nofollow">¹</a>. There are multiple NanoCore plugins which can be purchased (or stolen/cracked) from cyber-crime forums to add new features and capabilities — though NanoCore’s base payload is already capable of:</p><ul class=""><li id="eed2" class="ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn on oo op bk">accessing files</li><li id="95a8" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk">executing programs</li><li id="a686" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk">stealing saved passwords</li><li id="96d1" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk">logging keystrokes</li><li id="2252" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk">and surveilling webcams</li></ul><p id="9ba9" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">NanoCore payloads are primarily controlled from a GUI installed on the threat actor’s computer. The GUI functions as both a payload builder and command-and-control panel. Using the GUI to create and operate NanoCore payloads requires limited technical knowledge as there is no shell involved and the interface provides guiding documentation. Once built and deployed, a threat actor can control single agents or an entire collection of bots from the panel.</p><figure class="oy oz pa pb pc pd ov ow paragraph-image"><div role="button" tabindex="0" class="pe pf fj pg bh ph"><div class="ov ow qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lz pi c" width="700" height="323" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qc ff qd ov ow qe qf bf b bg z du">Figure 1: Experiments with NanoCore platform included builder configurations and traffic analysis.</figcaption></figure><p id="a0ff" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><em class="qg">I downloaded cracked NanoCore platforms and used them to conduct experiments inside virtual machines. It’s disturbing to see the “community” which forms around malware-as-a-service capabilities…</em></p><h1 id="8ada" class="pj nq gu bf nr pk pl hu nu pm pn hx nx po pp pq pr ps pt pu pv pw px py pz qa bk">Command-and-Control Analysis</h1><p id="9f5c" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">At start-up, a NanoCore payload will query the domain name of its assigned C2 (Command-and-Control) server and then attempt to use the answered IP address for all of its communications<a class="af no" href="#213b" rel="noopener ugc nofollow">²</a>. NanoCore payloads are configured with 8.8.8.8 as their primary DNS server and 8.8.4.4 as a backup. Some payloads are also configured with primary and secondary C2 domains — though in practice, many threat actors just list the same C2 twice.</p><p id="d197" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">A NanoCore payload will then send an ‘introduction’ message to its C2 server with basic context about the payload configuration and the infected target host. Following an acceptance message from its C2 server, NanoCore will then begin sending a ‘heartbeat message’ to the C2 server in order to let the server know that the payload is still active and to request new tasks. NanoCore will encode these heartbeat messages to the C2 server as <em class="qg">0x00000600</em>. Experiments show that NanoCore will send these heartbeat messages almost immediately after processing the C2’s response — leading to a stream of communication (unlike other RATs/agents which may only communicate once every several minutes). The generic heartbeat messages are interspersed with commands and requests from the C2 server itself. Most often, these messages are automated requests for status updates though they will also include commands initiated by the threat actor.</p><figure class="oy oz pa pb pc pd ov ow paragraph-image"><div role="button" tabindex="0" class="pe pf fj pg bh ph"><div class="ov ow qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-E4jR3wvyfzCMEULjDRlQw.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lz pi c" width="700" height="314" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qc ff qd ov ow qe qf bf b bg z du">Figure 2: PCAP of server DNS request, C2 introduction message, and encrypted heartbeat</figcaption></figure><p id="cdef" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The content of the messages sent from NanoCore to its C2 server will be encrypted using a custom protocol over TCP. NanoCore uses DES to encrypt the contents of its messages (<em class="qg">curiously, the DES key and IV have the same value</em>). The length of the message ciphertext is then appended to the front of the TCP data payload and sent to the C2 server. I wrote a <a class="af no" href="https://gchq.github.io/CyberChef/#recipe=From_Hexdump()To_Hex(&#x27;Space&#x27;,0)Find_/_Replace(%7B&#x27;option&#x27;:&#x27;Regex&#x27;,&#x27;string&#x27;:&#x27;%5E%5B0-9a-fA-F%5D%5B08%5D%2000%2000%2000%20&#x27;%7D,&#x27;&#x27;,true,false,false,false)From_Hex(&#x27;Auto&#x27;)Comment(&#x27;%22722018788C294897%22%20is%20the%20most%20common%20Key/IV%20pair%20used%20by%20NanoCore%20in%20the%20wild&#x27;)DES_Decrypt(%7B&#x27;option&#x27;:&#x27;Hex&#x27;,&#x27;string&#x27;:&#x27;722018788C294897&#x27;%7D,%7B&#x27;option&#x27;:&#x27;Hex&#x27;,&#x27;string&#x27;:&#x27;722018788C294897&#x27;%7D,&#x27;CBC&#x27;,&#x27;Raw&#x27;,&#x27;Raw&#x27;)To_Hexdump(16,false,false,false)&amp;input=MDAwMCAgIDA4IDAwIDAwIDAwIGMxIGMzIGQwIDMyIDQzIDU5IGExIDc4" rel="noopener ugc nofollow" target="_blank">CyberChef recipe</a> to help explain NanoCore’s custom protocol and decrypt its messages.</p><figure class="oy oz pa pb pc pd ov ow paragraph-image"><div role="button" tabindex="0" class="pe pf fj pg bh ph"><div class="ov ow qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1400/1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lz pi c" width="700" height="435" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qc ff qd ov ow qe qf bf b bg z du">Figure 3: Debugging of NanoCore’s method for message encryption — including IV/Key values</figcaption></figure><p id="7c55" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><em class="qg">For more analysis of NanoCore’s actual code, check-out the awesome reverse engineering conducted by </em><span class="iz"><span class="iz" aria-hidden="false"><a class="qj ja fe" href="https://medium.com/u/88251f40a784?source=post_page---user_mention--cb185473c1e0--------------------------------" rel="noopener" target="_blank"><em class="qg">0xM3H51N</em></a></span></span><em class="qg"> and </em><span class="iz"><span class="iz" aria-hidden="false"><a class="qj ja fe" href="https://medium.com/u/79556bb72cbb?source=post_page---user_mention--cb185473c1e0--------------------------------" rel="noopener" target="_blank"><em class="qg">Mario Henkel</em></a></span></span><em class="qg">.</em></p><h1 id="7094" class="pj nq gu bf nr pk pl hu nu pm pn hx nx po pp pq pr ps pt pu pv pw px py pz qa bk">Network Defenses</h1><h2 id="7302" class="np nq gu bf nr ns nt dy nu nv nw ea nx nb ny nz oa nf ob oc od nj oe of og oh bk">Signature-Based Detection</h2><p id="ff2e" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">NanoCore’s encryption of its C2 communications makes PCAP analysis and signature mapping more difficult. The custom protocol which NanoCore implements, however, inadvertently creates patterns that can be leveraged to develop network signatures<a class="af no" href="#4e96" rel="noopener ugc nofollow">³</a>. There are a few DES Keys/IVs that have been hard-coded into NanoCore strains and are commonly used in different payloads — even those appearing to belong to unique threat actors. Accurate network signature rules for tools such as Snort can be written to monitor for NanoCore’s heartbeat message, as encrypted by these common keys.</p><pre class="oy oz pa pb pc qk ql qm qn ay qo bk"><span id="2ced" class="np nq gu ql b iv qp qq l qr qs"># NanoCore ’heartbeat’ signature (0x00000600) encrypted by common key<br/>alert tcp any any -&gt; any any (msg:&quot;NanoCore ’heartbeat’ signature&quot;;flags:PA;dsize:12;content:&quot;|08 00 00 00 c1 c3 d0 32 43 59 a1 78|&quot;;)</span></pre><p id="5632" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Several less-popular NanoCore strains have begun changing their DES Keys/IVs — making the encryption of the heartbeat message difficult to predict. The command-and-control messages from these rarer strains can still be detected by taking-advantage of NanoCore’s custom protocol. In the protocol, the first 4 bytes of a TCP payload are used to encode the length of a message and the possible lengths are limited due to the protocol’s reliance on DES. NanoCore’s custom C2 messaging protocol can still be detected regardless of Key/IV by searching the first 4 bytes of TCP data and matching the value to the message length.</p><pre class="oy oz pa pb pc qk ql qm qn ay qo bk"><span id="1c4d" class="np nq gu ql b iv qp qq l qr qs"># NanoCore command-and-control custom message protocol<br/>alert tcp any any -&gt; any any (msg:&quot;NanoCore DES length 08&quot;;flags:PA;dsize:12;content:&quot;|08 00 00 00|&quot;;depth:4;)<br/>alert tcp any any -&gt; any any (msg:”NanoCore DES length 40&quot;;flags:PA;dsize:68;content:&quot;|40 00 00 00|&quot;;depth:4;)</span></pre><p id="86f7" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">By implementing <a class="af no" href="https://github.com/Abjuri5t/Hunting-NanoCore/blob/main/NanoCore-C2-protocol.rules" rel="noopener ugc nofollow" target="_blank">these network signature rules</a> into a monitoring tool such as Snort or Suricata, you will be alerted to an infected host sending NanoCore’s ‘introduction’ to the C2 server, the encrypted ‘heartbeat’, and all subsequent communications which use its custom message protocol.</p><p id="a4f0" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><em class="qg">The rules have been released publicly in my GitHub repository NanoCore-Hunting. Additionally, I strongly encourage you to monitor for </em><strong class="mu gv"><em class="qg">incoming</em></strong><em class="qg"> C2 traffic as well as outgoing. I have worked with cloud services, small businesses, and others in the past to help them take-down malicious C2 servers that they were unknowingly hosting. It is better to handle hosting abuse before your infrastructure is used to harm others.</em></p><h2 id="b92e" class="np nq gu bf nr ns nt dy nu nv nw ea nx nb ny nz oa nf ob oc od nj oe of og oh bk">Infrastructure Blocking</h2><p id="ef2b" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">Traditional network blocking solutions can of course be used to deny access to NanoCore C2 servers — though these methods require constant updating. With a DNS sinkhole deployed<a class="af no" href="#4fff" rel="noopener ugc nofollow">⁴</a>, DNS requests from NanoCore can be answered with an incorrect IP address to redirect NanoCore from its real C2 server — though this redirection is only possible if the DNS sinkhole is configured with the payload’s domain name (for more information, see Palo Alto’s explanation of <a class="af no" href="https://docs.paloaltonetworks.com/pan-os/10-2/pan-os-admin/threat-prevention/use-dns-queries-to-identify-infected-hosts-on-the-network/dns-sinkholing" rel="noopener ugc nofollow" target="_blank">DNS sinkholes</a>). Simple firewalls can also be deployed to block<a class="af no" href="#3a11" rel="noopener ugc nofollow">⁵</a> connection attempts to known NanoCore IP addresses but again, this blocking solution only works if the C2 server’s address is known and added to the blocklist.</p><p id="9d5d" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><em class="qg">The following lists are based on the hundreds of recently-active NanoCore C2s I verified while researching the RAT. The lists likely do not include all active NanoCore C2s but they should block a decent amount of connections.</em></p><p id="d490" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><a class="af no" href="https://raw.githubusercontent.com/Abjuri5t/Hunting-NanoCore/master/IP-list.txt" rel="noopener ugc nofollow" target="_blank">IP-list.txt</a> <a class="af no" href="https://raw.githubusercontent.com/Abjuri5t/Hunting-NanoCore/master/domain-list.txt" rel="noopener ugc nofollow" target="_blank">domain-list.txt</a> <a class="af no" href="https://raw.githubusercontent.com/Abjuri5t/Hunting-NanoCore/master/Indicators-of-Compromise.csv" rel="noopener ugc nofollow" target="_blank">Indicators-of-Compromise.csv</a></p><p id="e6c2" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Those of you familiar with my SarlackLab project know that I track malicious infrastructure — not to look for specific IOCs but to gather intelligence and get a better picture of the Internet threat landscape.</p><h1 id="44ed" class="pj nq gu bf nr pk pl hu nu pm pn hx nx po pp pq pr ps pt pu pv pw px py pz qa bk">Meta-Analysis of IOCs</h1><p id="4a8a" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">I set my malware analysis lab to collect and analyze thousands of NanoCore samples throughout the Spring and Summer of 2022. By analyzing network traffic generated during sample detonation and cross-referencing apparent C2 traffic with <a class="af no" href="https://malwareconfig.com" rel="noopener ugc nofollow" target="_blank">malware configuration extractors</a>, I confirmed the existence of hundreds of NanoCore C2 servers.</p><h2 id="35dd" class="np nq gu bf nr ns nt dy nu nv nw ea nx nb ny nz oa nf ob oc od nj oe of og oh bk">Domain Patterns</h2><p id="ddcf" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">I analyzed trends among the NanoCore C2 servers I had identified and uncovered patterns for server domains as well as suspicious hosting providers. Almost all of the domain names I found are legible and do not appear to be high-entropy or randomized. Many of the Fully Qualified Domain Names (FQDNs) have the same second-level domains (see Figure 4) — of which most appear to be tied to dynamic record and redirection services.</p><figure class="oy oz pa pb pc pd ov ow paragraph-image"><div role="button" tabindex="0" class="pe pf fj pg bh ph"><div class="ov ow qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TL-XWMzuXxxht47Od-b1fw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*TL-XWMzuXxxht47Od-b1fw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TL-XWMzuXxxht47Od-b1fw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TL-XWMzuXxxht47Od-b1fw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TL-XWMzuXxxht47Od-b1fw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TL-XWMzuXxxht47Od-b1fw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TL-XWMzuXxxht47Od-b1fw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*TL-XWMzuXxxht47Od-b1fw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lz pi c" width="700" height="434" loading="lazy" role="presentation"/></picture></div></div><figcaption class="qc ff qd ov ow qe qf bf b bg z du">Figure 4: Second-Level Domains of NanoCore C2 Domain Names</figcaption></figure><p id="a728" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The second-level domains ddns[.]net, duckdns[.]org, hopto[.]org, bounceme[.]net, and 3utilities[.]com appeared in almost 80% of all NanoCore FQDNs. The listed second-level domains are tied to Dynamic DNS services which their FQDNs appear to be utilizing. The service ngrok[.]io, however, is a distributed reverse proxy that is commonly used as a network tunnel for hosting gaming servers or file shares — though it also has a history of abuse.</p><pre class="oy oz pa pb pc qk ql qm qn ay qo bk"><span id="f1ee" class="np nq gu ql b iv qp qq l qr qs"><strong class="ql gv">Dynamic DNS</strong> (abbreviated as DDNS) is built upon common <a class="af no" href="https://securedigitallife.com/index.php/tag/dns/" rel="noopener ugc nofollow" target="_blank">Domain Name System</a> (DNS) technology but uses special authoritative DNS servers. Unlike traditional DNS records, which have static IP addresses that can take up to 24 hours to update, Dynamic DNS records can be updated rapidly using their highly-responsive authoritative DNS servers (such as duckdns[.]org). Dynamic DNS can be used for the benign purpose of resolving dynamic IP addresses (ie addresses granted by a home ISP) - however Cybercriminals <a class="af no" href="https://urlhaus.abuse.ch/browse.php?search=duckdns.org" rel="noopener ugc nofollow" target="_blank">commonly use</a> Dynamic DNS to in an attempt to survive server take-downs and IP blocking.</span></pre><p id="c35e" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">I have used DNS sinkholes to great effect in denying access from hosts to various C2 servers — regardless of how threat actor modify their DNS or DDNS records. Personally, I recommend sinkholing<a class="af no" href="#4fff" rel="noopener ugc nofollow">⁴</a> DNS requests to all subdomains of the identified infrastructure and authoritative DDNS servers, then only allowing specific FQDNs as-needed<a class="af no" href="#4e8d" rel="noopener ugc nofollow">⁶</a>. By configuring such a sinkhole, many NanoCore payloads will be unable to resolve the IP address of the C2 server — even if the payload is attempting to connect to a novel subdomain, not yet identified as an IOC.</p><h2 id="ff58" class="np nq gu bf nr ns nt dy nu nv nw ea nx nb ny nz oa nf ob oc od nj oe of og oh bk">Part 2 — TLP:GREEN</h2><p id="80cc" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">There is a second part to this command-and-control meta-analysis which is labeled <a class="af no" href="https://www.cisa.gov/tlp" rel="noopener ugc nofollow" target="_blank">TLP:GREEN</a>. If you are interested, contact me via <a class="af no" href="https://twitter.com/Abjuri5t/" rel="noopener ugc nofollow" target="_blank">Twitter</a> and I will send you a copy of the research.</p><h1 id="fad8" class="pj nq gu bf nr pk pl hu nu pm pn hx nx po pp pq pr ps pt pu pv pw px py pz qa bk">Hunting Summary</h1><p id="54c4" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">NanoCore is a powerful remote access trojan that remains popular among cybercriminals today. To hunt-down NanoCore command-and-control communications in your network, look for the signature of its custom messaging protocol (see <a class="af no" href="https://github.com/Abjuri5t/Hunting-NanoCore/blob/main/NanoCore-C2-protocol.rules" rel="noopener ugc nofollow" target="_blank">published rules</a>). You can of course attempt blocking <a class="af no" href="https://raw.githubusercontent.com/Abjuri5t/Hunting-NanoCore/master/IP-list.txt" rel="noopener ugc nofollow" target="_blank">individual IPs</a> and sinkholing <a class="af no" href="https://raw.githubusercontent.com/Abjuri5t/Hunting-NanoCore/master/domain-list.txt" rel="noopener ugc nofollow" target="_blank">specific domains</a> — but I recommend considering the overall trends of malicious traffic on the Internet and denying access to commonly malicious infrastructure. Please contact me on <a class="af no" href="https://twitter.com/Abjuri5t" rel="noopener ugc nofollow" target="_blank">Twitter</a>, if you have any feedback or wish to contribute.</p><h1 id="21c1" class="pj nq gu bf nr pk pl hu nu pm pn hx nx po pp pq pr ps pt pu pv pw px py pz qa bk">See Also</h1><p id="4dc1" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">Other work on NanoCore analysis (technical deep-dives). Config extractor. Other places to watch.</p><ul class=""><li id="1553" class="ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn on oo op bk">Full break-down of IOCs available at <a class="af no" href="https://github.com/Abjuri5t/Hunting-NanoCore/" rel="noopener ugc nofollow" target="_blank">https://github.com/Abjuri5t/Hunting-NanoCore/</a></li><li id="0a35" class="ms mt gu mu b hs oq mw mx hv or mz na nb os nd ne nf ot nh ni nj ou nl nm nn on oo op bk">CyberChef recipe <a class="af no" href="https://gchq.github.io/CyberChef/#recipe=From_Hexdump()To_Hex(&#x27;Space&#x27;,0)Find_/_Replace(%7B&#x27;option&#x27;:&#x27;Regex&#x27;,&#x27;string&#x27;:&#x27;%5E%5B0-9a-fA-F%5D%5B08%5D%2000%2000%2000%20&#x27;%7D,&#x27;&#x27;,true,false,false,false)From_Hex(&#x27;Auto&#x27;)Comment(&#x27;%22722018788C294897%22%20is%20the%20most%20common%20Key/IV%20pair%20used%20by%20NanoCore%20in%20the%20wild&#x27;)DES_Decrypt(%7B&#x27;option&#x27;:&#x27;Hex&#x27;,&#x27;string&#x27;:&#x27;722018788C294897&#x27;%7D,%7B&#x27;option&#x27;:&#x27;Hex&#x27;,&#x27;string&#x27;:&#x27;722018788C294897&#x27;%7D,&#x27;CBC&#x27;,&#x27;Raw&#x27;,&#x27;Raw&#x27;)To_Hexdump(16,false,false,false)&amp;input=MDAwMCAgIDA4IDAwIDAwIDAwIGMxIGMzIGQwIDMyIDQzIDU5IGExIDc4" rel="noopener ugc nofollow" target="_blank">https://gchq.github.io/CyberChef/#recipe=…</a></li></ul><h2 id="cf71" class="np nq gu bf nr ns nt dy nu nv nw ea nx nb ny nz oa nf ob oc od nj oe of og oh bk">Footnotes</h2><p id="29b8" class="pw-post-body-paragraph ms mt gu mu b hs oi mw mx hv oj mz na nb ok nd ne nf ol nh ni nj om nl nm nn gn bk">[1] According to <a class="af no" href="https://attack.mitre.org/software/S0336/#groups" rel="noopener ugc nofollow" target="_blank">research</a> compiled by MITRE ATT&amp;CK, groups back by nation-states have been attributed to the use of NanoCore.</p><p id="213b" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">[2] In my research, I found a couple of NanoCore payloads which used hard-coded IP addresses. The overwhelming trend among threat actors, however, appears to be relying on domain names because the hosting IP addresses may change.</p><p id="4e96" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">[3] I work for Vectra AI as a Network MDR Analyst. I honestly believe that network metadata and AI models (ya, I said it) are the best indicators of malicious activity in a network. That being said, signatures and IOCs are useful as part of a complete balanced b̶r̶e̶a̶k̶f̶a̶s̶t̶ defense. I wrote a Vectra <a class="af no" href="https://github.com/Abjuri5t/Hunting-NanoCore/tree/main/Vectra-Custom-Model/" rel="noopener ugc nofollow" target="_blank">custom model</a> based on these IDS signatures which Recall customers can install.</p><p id="4fff" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">[4] When configuring your DNS sinkhole, remember to re-direct all DNS requests to your local server. Otherwise, NanoCore’s DNS requests will just go to 8.8.8.8 and the sinkhole will fail.</p><p id="3a11" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">[5] Make sure you log these connection attempts as well and consider setting an alert for them. Just because you have blocked a C2 server does not mean that you have completely managed the threat.</p><p id="4e8d" class="pw-post-body-paragraph ms mt gu mu b hs mv mw mx hv my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">[6] Check your SIEM and/or firewall logs before applying these restrictions. Depending on how locked-down your network is, you may accidentally block an important service that happens to be using ngrok or similar.</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qu qv ab jh"><div class="qw ab"><a class="qx ay am ao" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----cb185473c1e0--------------------------------"><div class="qy fj cx qz ge ra rb bf b bg z bk rc">Malware Analysis</div></a></div><div class="qw ab"><a class="qx ay am ao" rel="noopener follow" href="/tag/cybersecurity?source=post_page-----cb185473c1e0--------------------------------"><div class="qy fj cx qz ge ra rb bf b bg z bk rc">Cybersecurity</div></a></div><div class="qw ab"><a class="qx ay am ao" rel="noopener follow" href="/tag/nanocore?source=post_page-----cb185473c1e0--------------------------------"><div class="qy fj cx qz ge ra rb bf b bg z bk rc">Nanocore</div></a></div><div class="qw ab"><a class="qx ay am ao" rel="noopener follow" href="/tag/threat-hunting?source=post_page-----cb185473c1e0--------------------------------"><div class="qy fj cx qz ge ra rb bf b bg z bk rc">Threat Hunting</div></a></div><div class="qw ab"><a class="qx ay am ao" rel="noopener follow" href="/tag/networking?source=post_page-----cb185473c1e0--------------------------------"><div class="qy fj cx qz ge ra rb bf b bg z bk rc">Networking</div></a></div></div></div></div><div class="l"></div><footer class="rd re rf rg rh ab q ri rj c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rk"><div class="ab q kq"><div class="rl l"><span class="l rm rn ro e d"><div class="ab q kq kr"><div class="pw-multi-vote-icon fj ks kt ku kv"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fcb185473c1e0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;user=John+F&amp;userId=3d056516eaf&amp;source=---footer_actions--cb185473c1e0---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kw ao kx ky kz la am lb lc ld kv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l le lf lg lh li lj lk"><p class="bf b dv z du"><span class="ll">--</span></p></div></div></span><span class="l h g f rp rq"><div class="ab q kq kr"><div class="pw-multi-vote-icon fj ks kt ku kv"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fcb185473c1e0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;user=John+F&amp;userId=3d056516eaf&amp;source=---footer_actions--cb185473c1e0---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kw ao kx ky kz la am lb lc ld kv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l le lf lg lh li lj lk"><p class="bf b dv z du"><span class="ll">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kw lm ln ab q fk lo lp" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lq"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="rr l je"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fcb185473c1e0&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40the_abjuri5t%2Fnanocore-rat-hunting-guide-cb185473c1e0&amp;source=---footer_actions--cb185473c1e0---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du ls" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="rr l je"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al ma an ao ap ex mb mc lp md"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rs rt ru rv rw l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rx bh r ry"></div><div class="ab rz sa sb jg jf"><div class="sc sd se sf sg sh si sj sk sl ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@the_abjuri5t?source=post_page---post_author_info--cb185473c1e0--------------------------------"><div class="l fj"><img alt="John F" class="l fd by io in cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*OApWCB-Hco86JId_R9cbdA.jpeg" width="48" height="48" loading="lazy"/><div class="fr by l io in fs n ay sm"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@the_abjuri5t?source=post_page---post_author_info--cb185473c1e0--------------------------------"><div class="l fj"><img alt="John F" class="l fd by sn so cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*OApWCB-Hco86JId_R9cbdA.jpeg" width="64" height="64" loading="lazy"/><div class="fr by l sn so fs n ay sm"></div></div></a></div><div class="j i d sp je"><div class="ab"><span><button class="bf b bg z sq qy sr ss st su sv ev ew sw sx sy fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co sz"><div class="ta tb tc td te l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@the_abjuri5t?source=post_page---post_author_info--cb185473c1e0--------------------------------"><h2 class="pw-author-name bf tg th ti tj tk tl tm nb nz oa nf oc od nj of og bk"><span class="gn tf">Written by <!-- -->John F</span></h2></a><div class="qw ab im"><div class="l je"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar ix" rel="noopener follow" href="/@the_abjuri5t/followers?source=post_page---post_author_info--cb185473c1e0--------------------------------">75 Followers</a></span></div><div class="bf b bg z du ab qr"><span class="iy l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar ix" rel="noopener follow" href="/@the_abjuri5t/following?source=post_page---post_author_info--cb185473c1e0--------------------------------">10 Following</a></div></div><div class="tn l"><p class="bf b bg z bk"><span class="gn">Incident Responder &amp;&amp; Command-and-Control Researcher</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sq qy sr ss st su sv ev ew sw sx sy fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="to l"><div class="rx bh r tp tq tr ts tt"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf tg pk hu nu pm hx nx po pq pr ps pu pv pw py pz bk">No responses yet</h2><div class="ab tu"><div><div class="bm" aria-hidden="false"><a class="tv tw" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--cb185473c1e0--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="tx ty tz ua ub l"></div></div></div></div><div class="uc ud ue uf ug l bx"><div class="h k j"><div class="rx bh uh ui"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uj ab kq jh"><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----cb185473c1e0--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----cb185473c1e0--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uk ul l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----cb185473c1e0--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uk l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----cb185473c1e0--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-cb185473c1e0","user-3d056516eaf"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"665241e4-1953-4b10-b19f-cc3fbadd06dd","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-1f53634d9b95899c5b7b34e172d0dc06-56ef37e23ee94eb5-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@the_abjuri5t\u002Fnanocore-rat-hunting-guide-cb185473c1e0","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"cb185473c1e0\"})":{"__ref":"Post:cb185473c1e0"}},"LinkedAccounts:3d056516eaf":{"__typename":"LinkedAccounts","mastodon":null,"id":"3d056516eaf"},"User:3d056516eaf":{"__typename":"User","id":"3d056516eaf","linkedAccounts":{"__ref":"LinkedAccounts:3d056516eaf"},"isSuspended":false,"name":"John F","imageId":"1*OApWCB-Hco86JId_R9cbdA.jpeg","customDomainState":null,"hasSubdomain":false,"username":"the_abjuri5t","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":75,"followingCount":10,"collectionFollowingCount":0},"bio":"Incident Responder && Command-and-Control Researcher","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:3d056516eaf-viewerId:lo_9bbff110215d"},"twitterScreenName":"Abjuri5t"},"Topic:d4e7f4144ac5":{"__typename":"Topic","slug":"cybersecurity","id":"d4e7f4144ac5","name":"Cybersecurity"},"Paragraph:ae3699c79d3e_0":{"__typename":"Paragraph","id":"ae3699c79d3e_0","name":"ddc4","type":"H3","href":null,"layout":null,"metadata":null,"text":"NanoCore RAT Hunting Guide","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_1":{"__typename":"Paragraph","id":"ae3699c79d3e_1","name":"4ac5","type":"H4","href":null,"layout":null,"metadata":null,"text":"Analysis and tools for hunting NanoCore command-and-control","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_2":{"__typename":"Paragraph","id":"ae3699c79d3e_2","name":"c79d","type":"P","href":null,"layout":null,"metadata":null,"text":"NanoCore is a prevalent RAT (Remote Access Trojan) which is used by threat actors to spy on victims and provide remote access to target computers. CISA identified NanoCore as a top malware strain of 2021 due to its prevalence among cyber criminals and potential to cause damage. I have researched NanoCore’s command-and-control framework and I wrote this blog post as a guide for hunting-down and blocking NanoCore.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":147,"end":162,"href":"https:\u002F\u002Fwww.cisa.gov\u002Fuscert\u002Fncas\u002Falerts\u002Faa22-216a","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_3":{"__typename":"Paragraph","id":"ae3699c79d3e_3","name":"a402","type":"H4","href":null,"layout":null,"metadata":null,"text":"Table of Contents","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_4":{"__typename":"Paragraph","id":"ae3699c79d3e_4","name":"282f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Background and Functionality","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":28,"href":"#c2ec","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_5":{"__typename":"Paragraph","id":"ae3699c79d3e_5","name":"a1fe","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Command-and-Control Analysis","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":28,"href":"#8ada","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_6":{"__typename":"Paragraph","id":"ae3699c79d3e_6","name":"afb3","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Network Defenses","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":16,"href":"#7094","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_7":{"__typename":"Paragraph","id":"ae3699c79d3e_7","name":"e340","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Meta-Analysis of IOCs","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":21,"href":"#44ed","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_8":{"__typename":"Paragraph","id":"ae3699c79d3e_8","name":"0cd0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Hunting Summary","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":15,"href":"#fad8","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_9":{"__typename":"Paragraph","id":"ae3699c79d3e_9","name":"1a50","type":"ULI","href":null,"layout":null,"metadata":null,"text":"See Also","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":8,"href":"#21c1","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*DVdcHYCvKJIIj9zj1PLhkg.jpeg":{"__typename":"ImageMetadata","id":"1*DVdcHYCvKJIIj9zj1PLhkg.jpeg","originalHeight":414,"originalWidth":801,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ae3699c79d3e_10":{"__typename":"Paragraph","id":"ae3699c79d3e_10","name":"f5c3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*DVdcHYCvKJIIj9zj1PLhkg.jpeg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_11":{"__typename":"Paragraph","id":"ae3699c79d3e_11","name":"c2ec","type":"H3","href":null,"layout":null,"metadata":null,"text":"Background and Functionality","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_12":{"__typename":"Paragraph","id":"ae3699c79d3e_12","name":"e3a5","type":"P","href":null,"layout":null,"metadata":null,"text":"In 2013, Taylor Huddleston (arrested in 2017) wrote NanoCore using the .NET framework. Despite its age, the RAT remains popular among cyber-criminals and malware-as-a-service markets because of its ease of use for non-technical threat actors and various plugin features. NanoCore is widely used today with ANY.RUN Trends documenting it as the 8th most-common malware strain in July 2022.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":28,"end":36,"href":"https:\u002F\u002Fwww.fbi.gov\u002Fnews\u002Fstories\u002Fmalware-creator-sentenced-070518","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":306,"end":320,"href":"https:\u002F\u002Fany.run\u002Fmalware-trends\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_13":{"__typename":"Paragraph","id":"ae3699c79d3e_13","name":"19ad","type":"P","href":null,"layout":null,"metadata":null,"text":"As a RAT, NanoCore is well-suited for providing initial access, stealing information, and spying on victims. Historically, NanoCore’s remote access and spyware capabilities have been used to attack businesses, stalk victims, and conduct espionage for nation-state groups¹. There are multiple NanoCore plugins which can be purchased (or stolen\u002Fcracked) from cyber-crime forums to add new features and capabilities — though NanoCore’s base payload is already capable of:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":270,"end":271,"href":"#29b8","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_14":{"__typename":"Paragraph","id":"ae3699c79d3e_14","name":"eed2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"accessing files","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_15":{"__typename":"Paragraph","id":"ae3699c79d3e_15","name":"95a8","type":"ULI","href":null,"layout":null,"metadata":null,"text":"executing programs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_16":{"__typename":"Paragraph","id":"ae3699c79d3e_16","name":"a686","type":"ULI","href":null,"layout":null,"metadata":null,"text":"stealing saved passwords","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_17":{"__typename":"Paragraph","id":"ae3699c79d3e_17","name":"96d1","type":"ULI","href":null,"layout":null,"metadata":null,"text":"logging keystrokes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_18":{"__typename":"Paragraph","id":"ae3699c79d3e_18","name":"2252","type":"ULI","href":null,"layout":null,"metadata":null,"text":"and surveilling webcams","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_19":{"__typename":"Paragraph","id":"ae3699c79d3e_19","name":"9ba9","type":"P","href":null,"layout":null,"metadata":null,"text":"NanoCore payloads are primarily controlled from a GUI installed on the threat actor’s computer. The GUI functions as both a payload builder and command-and-control panel. Using the GUI to create and operate NanoCore payloads requires limited technical knowledge as there is no shell involved and the interface provides guiding documentation. Once built and deployed, a threat actor can control single agents or an entire collection of bots from the panel.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg":{"__typename":"ImageMetadata","id":"1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg","originalHeight":526,"originalWidth":1140,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ae3699c79d3e_20":{"__typename":"Paragraph","id":"ae3699c79d3e_20","name":"79dd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4AqCuwI0mL3ne-Ux48WQnQ.jpeg"},"text":"Figure 1: Experiments with NanoCore platform included builder configurations and traffic analysis.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_21":{"__typename":"Paragraph","id":"ae3699c79d3e_21","name":"a0ff","type":"P","href":null,"layout":null,"metadata":null,"text":"I downloaded cracked NanoCore platforms and used them to conduct experiments inside virtual machines. It’s disturbing to see the “community” which forms around malware-as-a-service capabilities…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":194,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_22":{"__typename":"Paragraph","id":"ae3699c79d3e_22","name":"8ada","type":"H3","href":null,"layout":null,"metadata":null,"text":"Command-and-Control Analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_23":{"__typename":"Paragraph","id":"ae3699c79d3e_23","name":"9f5c","type":"P","href":null,"layout":null,"metadata":null,"text":"At start-up, a NanoCore payload will query the domain name of its assigned C2 (Command-and-Control) server and then attempt to use the answered IP address for all of its communications². NanoCore payloads are configured with 8.8.8.8 as their primary DNS server and 8.8.4.4 as a backup. Some payloads are also configured with primary and secondary C2 domains — though in practice, many threat actors just list the same C2 twice.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":184,"end":185,"href":"#213b","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_24":{"__typename":"Paragraph","id":"ae3699c79d3e_24","name":"d197","type":"P","href":null,"layout":null,"metadata":null,"text":"A NanoCore payload will then send an ‘introduction’ message to its C2 server with basic context about the payload configuration and the infected target host. Following an acceptance message from its C2 server, NanoCore will then begin sending a ‘heartbeat message’ to the C2 server in order to let the server know that the payload is still active and to request new tasks. NanoCore will encode these heartbeat messages to the C2 server as 0x00000600. Experiments show that NanoCore will send these heartbeat messages almost immediately after processing the C2’s response — leading to a stream of communication (unlike other RATs\u002Fagents which may only communicate once every several minutes). The generic heartbeat messages are interspersed with commands and requests from the C2 server itself. Most often, these messages are automated requests for status updates though they will also include commands initiated by the threat actor.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":439,"end":449,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-E4jR3wvyfzCMEULjDRlQw.jpeg":{"__typename":"ImageMetadata","id":"1*-E4jR3wvyfzCMEULjDRlQw.jpeg","originalHeight":571,"originalWidth":1273,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ae3699c79d3e_25":{"__typename":"Paragraph","id":"ae3699c79d3e_25","name":"5681","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-E4jR3wvyfzCMEULjDRlQw.jpeg"},"text":"Figure 2: PCAP of server DNS request, C2 introduction message, and encrypted heartbeat","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_26":{"__typename":"Paragraph","id":"ae3699c79d3e_26","name":"cdef","type":"P","href":null,"layout":null,"metadata":null,"text":"The content of the messages sent from NanoCore to its C2 server will be encrypted using a custom protocol over TCP. NanoCore uses DES to encrypt the contents of its messages (curiously, the DES key and IV have the same value). The length of the message ciphertext is then appended to the front of the TCP data payload and sent to the C2 server. I wrote a CyberChef recipe to help explain NanoCore’s custom protocol and decrypt its messages.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":355,"end":371,"href":"https:\u002F\u002Fgchq.github.io\u002FCyberChef\u002F#recipe=From_Hexdump()To_Hex('Space',0)Find_\u002F_Replace(%7B'option':'Regex','string':'%5E%5B0-9a-fA-F%5D%5B08%5D%2000%2000%2000%20'%7D,'',true,false,false,false)From_Hex('Auto')Comment('%22722018788C294897%22%20is%20the%20most%20common%20Key\u002FIV%20pair%20used%20by%20NanoCore%20in%20the%20wild')DES_Decrypt(%7B'option':'Hex','string':'722018788C294897'%7D,%7B'option':'Hex','string':'722018788C294897'%7D,'CBC','Raw','Raw')To_Hexdump(16,false,false,false)&input=MDAwMCAgIDA4IDAwIDAwIDAwIGMxIGMzIGQwIDMyIDQzIDU5IGExIDc4","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":175,"end":224,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg":{"__typename":"ImageMetadata","id":"1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg","originalHeight":591,"originalWidth":953,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ae3699c79d3e_27":{"__typename":"Paragraph","id":"ae3699c79d3e_27","name":"3855","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*c2GmbFFY1jPZEAoS2XaJ_A.jpeg"},"text":"Figure 3: Debugging of NanoCore’s method for message encryption — including IV\u002FKey values","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_28":{"__typename":"Paragraph","id":"ae3699c79d3e_28","name":"7c55","type":"P","href":null,"layout":null,"metadata":null,"text":"For more analysis of NanoCore’s actual code, check-out the awesome reverse engineering conducted by 0xM3H51N and Mario Henkel.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":100,"end":108,"href":null,"anchorType":"USER","userId":"88251f40a784","linkMetadata":null},{"__typename":"Markup","type":"A","start":113,"end":125,"href":null,"anchorType":"USER","userId":"79556bb72cbb","linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_29":{"__typename":"Paragraph","id":"ae3699c79d3e_29","name":"7094","type":"H3","href":null,"layout":null,"metadata":null,"text":"Network Defenses","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_30":{"__typename":"Paragraph","id":"ae3699c79d3e_30","name":"7302","type":"H4","href":null,"layout":null,"metadata":null,"text":"Signature-Based Detection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_31":{"__typename":"Paragraph","id":"ae3699c79d3e_31","name":"ff2e","type":"P","href":null,"layout":null,"metadata":null,"text":"NanoCore’s encryption of its C2 communications makes PCAP analysis and signature mapping more difficult. The custom protocol which NanoCore implements, however, inadvertently creates patterns that can be leveraged to develop network signatures³. There are a few DES Keys\u002FIVs that have been hard-coded into NanoCore strains and are commonly used in different payloads — even those appearing to belong to unique threat actors. Accurate network signature rules for tools such as Snort can be written to monitor for NanoCore’s heartbeat message, as encrypted by these common keys.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":243,"end":244,"href":"#4e96","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_32":{"__typename":"Paragraph","id":"ae3699c79d3e_32","name":"2ced","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# NanoCore ’heartbeat’ signature (0x00000600) encrypted by common key\nalert tcp any any -\u003E any any (msg:\"NanoCore ’heartbeat’ signature\";flags:PA;dsize:12;content:\"|08 00 00 00 c1 c3 d0 32 43 59 a1 78|\";)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_33":{"__typename":"Paragraph","id":"ae3699c79d3e_33","name":"5632","type":"P","href":null,"layout":null,"metadata":null,"text":"Several less-popular NanoCore strains have begun changing their DES Keys\u002FIVs — making the encryption of the heartbeat message difficult to predict. The command-and-control messages from these rarer strains can still be detected by taking-advantage of NanoCore’s custom protocol. In the protocol, the first 4 bytes of a TCP payload are used to encode the length of a message and the possible lengths are limited due to the protocol’s reliance on DES. NanoCore’s custom C2 messaging protocol can still be detected regardless of Key\u002FIV by searching the first 4 bytes of TCP data and matching the value to the message length.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_34":{"__typename":"Paragraph","id":"ae3699c79d3e_34","name":"1c4d","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# NanoCore command-and-control custom message protocol\nalert tcp any any -\u003E any any (msg:\"NanoCore DES length 08\";flags:PA;dsize:12;content:\"|08 00 00 00|\";depth:4;)\nalert tcp any any -\u003E any any (msg:”NanoCore DES length 40\";flags:PA;dsize:68;content:\"|40 00 00 00|\";depth:4;)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_35":{"__typename":"Paragraph","id":"ae3699c79d3e_35","name":"86f7","type":"P","href":null,"layout":null,"metadata":null,"text":"By implementing these network signature rules into a monitoring tool such as Snort or Suricata, you will be alerted to an infected host sending NanoCore’s ‘introduction’ to the C2 server, the encrypted ‘heartbeat’, and all subsequent communications which use its custom message protocol.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":16,"end":45,"href":"https:\u002F\u002Fgithub.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fblob\u002Fmain\u002FNanoCore-C2-protocol.rules","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_36":{"__typename":"Paragraph","id":"ae3699c79d3e_36","name":"a4f0","type":"P","href":null,"layout":null,"metadata":null,"text":"The rules have been released publicly in my GitHub repository NanoCore-Hunting. Additionally, I strongly encourage you to monitor for incoming C2 traffic as well as outgoing. I have worked with cloud services, small businesses, and others in the past to help them take-down malicious C2 servers that they were unknowingly hosting. It is better to handle hosting abuse before your infrastructure is used to harm others.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":134,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":418,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_37":{"__typename":"Paragraph","id":"ae3699c79d3e_37","name":"b92e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Infrastructure Blocking","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_38":{"__typename":"Paragraph","id":"ae3699c79d3e_38","name":"ef2b","type":"P","href":null,"layout":null,"metadata":null,"text":"Traditional network blocking solutions can of course be used to deny access to NanoCore C2 servers — though these methods require constant updating. With a DNS sinkhole deployed⁴, DNS requests from NanoCore can be answered with an incorrect IP address to redirect NanoCore from its real C2 server — though this redirection is only possible if the DNS sinkhole is configured with the payload’s domain name (for more information, see Palo Alto’s explanation of DNS sinkholes). Simple firewalls can also be deployed to block⁵ connection attempts to known NanoCore IP addresses but again, this blocking solution only works if the C2 server’s address is known and added to the blocklist.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":177,"end":178,"href":"#4fff","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":459,"end":472,"href":"https:\u002F\u002Fdocs.paloaltonetworks.com\u002Fpan-os\u002F10-2\u002Fpan-os-admin\u002Fthreat-prevention\u002Fuse-dns-queries-to-identify-infected-hosts-on-the-network\u002Fdns-sinkholing","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":521,"end":522,"href":"#3a11","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_39":{"__typename":"Paragraph","id":"ae3699c79d3e_39","name":"9d5d","type":"P","href":null,"layout":null,"metadata":null,"text":"The following lists are based on the hundreds of recently-active NanoCore C2s I verified while researching the RAT. The lists likely do not include all active NanoCore C2s but they should block a decent amount of connections.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":225,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_40":{"__typename":"Paragraph","id":"ae3699c79d3e_40","name":"d490","type":"P","href":null,"layout":null,"metadata":null,"text":"IP-list.txt domain-list.txt Indicators-of-Compromise.csv","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":11,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fmaster\u002FIP-list.txt","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":12,"end":27,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fmaster\u002Fdomain-list.txt","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":28,"end":56,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fmaster\u002FIndicators-of-Compromise.csv","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_41":{"__typename":"Paragraph","id":"ae3699c79d3e_41","name":"e6c2","type":"P","href":null,"layout":null,"metadata":null,"text":"Those of you familiar with my SarlackLab project know that I track malicious infrastructure — not to look for specific IOCs but to gather intelligence and get a better picture of the Internet threat landscape.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_42":{"__typename":"Paragraph","id":"ae3699c79d3e_42","name":"44ed","type":"H3","href":null,"layout":null,"metadata":null,"text":"Meta-Analysis of IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_43":{"__typename":"Paragraph","id":"ae3699c79d3e_43","name":"4a8a","type":"P","href":null,"layout":null,"metadata":null,"text":"I set my malware analysis lab to collect and analyze thousands of NanoCore samples throughout the Spring and Summer of 2022. By analyzing network traffic generated during sample detonation and cross-referencing apparent C2 traffic with malware configuration extractors, I confirmed the existence of hundreds of NanoCore C2 servers.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":236,"end":268,"href":"https:\u002F\u002Fmalwareconfig.com","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_44":{"__typename":"Paragraph","id":"ae3699c79d3e_44","name":"35dd","type":"H4","href":null,"layout":null,"metadata":null,"text":"Domain Patterns","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_45":{"__typename":"Paragraph","id":"ae3699c79d3e_45","name":"ddcf","type":"P","href":null,"layout":null,"metadata":null,"text":"I analyzed trends among the NanoCore C2 servers I had identified and uncovered patterns for server domains as well as suspicious hosting providers. Almost all of the domain names I found are legible and do not appear to be high-entropy or randomized. Many of the Fully Qualified Domain Names (FQDNs) have the same second-level domains (see Figure 4) — of which most appear to be tied to dynamic record and redirection services.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TL-XWMzuXxxht47Od-b1fw.png":{"__typename":"ImageMetadata","id":"1*TL-XWMzuXxxht47Od-b1fw.png","originalHeight":461,"originalWidth":745,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:ae3699c79d3e_46":{"__typename":"Paragraph","id":"ae3699c79d3e_46","name":"e218","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TL-XWMzuXxxht47Od-b1fw.png"},"text":"Figure 4: Second-Level Domains of NanoCore C2 Domain Names","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_47":{"__typename":"Paragraph","id":"ae3699c79d3e_47","name":"a728","type":"P","href":null,"layout":null,"metadata":null,"text":"The second-level domains ddns[.]net, duckdns[.]org, hopto[.]org, bounceme[.]net, and 3utilities[.]com appeared in almost 80% of all NanoCore FQDNs. The listed second-level domains are tied to Dynamic DNS services which their FQDNs appear to be utilizing. The service ngrok[.]io, however, is a distributed reverse proxy that is commonly used as a network tunnel for hosting gaming servers or file shares — though it also has a history of abuse.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_48":{"__typename":"Paragraph","id":"ae3699c79d3e_48","name":"f1ee","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Dynamic DNS (abbreviated as DDNS) is built upon common Domain Name System (DNS) technology but uses special authoritative DNS servers. Unlike traditional DNS records, which have static IP addresses that can take up to 24 hours to update, Dynamic DNS records can be updated rapidly using their highly-responsive authoritative DNS servers (such as duckdns[.]org). Dynamic DNS can be used for the benign purpose of resolving dynamic IP addresses (ie addresses granted by a home ISP) - however Cybercriminals commonly use Dynamic DNS to in an attempt to survive server take-downs and IP blocking.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":55,"end":73,"href":"https:\u002F\u002Fsecuredigitallife.com\u002Findex.php\u002Ftag\u002Fdns\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":505,"end":517,"href":"https:\u002F\u002Furlhaus.abuse.ch\u002Fbrowse.php?search=duckdns.org","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_49":{"__typename":"Paragraph","id":"ae3699c79d3e_49","name":"c35e","type":"P","href":null,"layout":null,"metadata":null,"text":"I have used DNS sinkholes to great effect in denying access from hosts to various C2 servers — regardless of how threat actor modify their DNS or DDNS records. Personally, I recommend sinkholing⁴ DNS requests to all subdomains of the identified infrastructure and authoritative DDNS servers, then only allowing specific FQDNs as-needed⁶. By configuring such a sinkhole, many NanoCore payloads will be unable to resolve the IP address of the C2 server — even if the payload is attempting to connect to a novel subdomain, not yet identified as an IOC.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":194,"end":195,"href":"#4fff","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":335,"end":336,"href":"#4e8d","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_50":{"__typename":"Paragraph","id":"ae3699c79d3e_50","name":"ff58","type":"H4","href":null,"layout":null,"metadata":null,"text":"Part 2 — TLP:GREEN","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_51":{"__typename":"Paragraph","id":"ae3699c79d3e_51","name":"80cc","type":"P","href":null,"layout":null,"metadata":null,"text":"There is a second part to this command-and-control meta-analysis which is labeled TLP:GREEN. If you are interested, contact me via Twitter and I will send you a copy of the research.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":82,"end":91,"href":"https:\u002F\u002Fwww.cisa.gov\u002Ftlp","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":131,"end":138,"href":"https:\u002F\u002Ftwitter.com\u002FAbjuri5t\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_52":{"__typename":"Paragraph","id":"ae3699c79d3e_52","name":"fad8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hunting Summary","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_53":{"__typename":"Paragraph","id":"ae3699c79d3e_53","name":"54c4","type":"P","href":null,"layout":null,"metadata":null,"text":"NanoCore is a powerful remote access trojan that remains popular among cybercriminals today. To hunt-down NanoCore command-and-control communications in your network, look for the signature of its custom messaging protocol (see published rules). You can of course attempt blocking individual IPs and sinkholing specific domains — but I recommend considering the overall trends of malicious traffic on the Internet and denying access to commonly malicious infrastructure. Please contact me on Twitter, if you have any feedback or wish to contribute.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":228,"end":243,"href":"https:\u002F\u002Fgithub.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fblob\u002Fmain\u002FNanoCore-C2-protocol.rules","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":281,"end":295,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fmaster\u002FIP-list.txt","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":311,"end":327,"href":"https:\u002F\u002Fraw.githubusercontent.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Fmaster\u002Fdomain-list.txt","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":492,"end":499,"href":"https:\u002F\u002Ftwitter.com\u002FAbjuri5t","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_54":{"__typename":"Paragraph","id":"ae3699c79d3e_54","name":"21c1","type":"H3","href":null,"layout":null,"metadata":null,"text":"See Also","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_55":{"__typename":"Paragraph","id":"ae3699c79d3e_55","name":"4dc1","type":"P","href":null,"layout":null,"metadata":null,"text":"Other work on NanoCore analysis (technical deep-dives). Config extractor. Other places to watch.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_56":{"__typename":"Paragraph","id":"ae3699c79d3e_56","name":"1553","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Full break-down of IOCs available at https:\u002F\u002Fgithub.com\u002FAbjuri5t\u002FHunting-NanoCore\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":37,"end":82,"href":"https:\u002F\u002Fgithub.com\u002FAbjuri5t\u002FHunting-NanoCore\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_57":{"__typename":"Paragraph","id":"ae3699c79d3e_57","name":"0a35","type":"ULI","href":null,"layout":null,"metadata":null,"text":"CyberChef recipe https:\u002F\u002Fgchq.github.io\u002FCyberChef\u002F#recipe=…","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":17,"end":59,"href":"https:\u002F\u002Fgchq.github.io\u002FCyberChef\u002F#recipe=From_Hexdump()To_Hex('Space',0)Find_\u002F_Replace(%7B'option':'Regex','string':'%5E%5B0-9a-fA-F%5D%5B08%5D%2000%2000%2000%20'%7D,'',true,false,false,false)From_Hex('Auto')Comment('%22722018788C294897%22%20is%20the%20most%20common%20Key\u002FIV%20pair%20used%20by%20NanoCore%20in%20the%20wild')DES_Decrypt(%7B'option':'Hex','string':'722018788C294897'%7D,%7B'option':'Hex','string':'722018788C294897'%7D,'CBC','Raw','Raw')To_Hexdump(16,false,false,false)&input=MDAwMCAgIDA4IDAwIDAwIDAwIGMxIGMzIGQwIDMyIDQzIDU5IGExIDc4","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_58":{"__typename":"Paragraph","id":"ae3699c79d3e_58","name":"cf71","type":"H4","href":null,"layout":null,"metadata":null,"text":"Footnotes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_59":{"__typename":"Paragraph","id":"ae3699c79d3e_59","name":"29b8","type":"P","href":null,"layout":null,"metadata":null,"text":"[1] According to research compiled by MITRE ATT&CK, groups back by nation-states have been attributed to the use of NanoCore.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":17,"end":25,"href":"https:\u002F\u002Fattack.mitre.org\u002Fsoftware\u002FS0336\u002F#groups","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_60":{"__typename":"Paragraph","id":"ae3699c79d3e_60","name":"213b","type":"P","href":null,"layout":null,"metadata":null,"text":"[2] In my research, I found a couple of NanoCore payloads which used hard-coded IP addresses. The overwhelming trend among threat actors, however, appears to be relying on domain names because the hosting IP addresses may change.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_61":{"__typename":"Paragraph","id":"ae3699c79d3e_61","name":"4e96","type":"P","href":null,"layout":null,"metadata":null,"text":"[3] I work for Vectra AI as a Network MDR Analyst. I honestly believe that network metadata and AI models (ya, I said it) are the best indicators of malicious activity in a network. That being said, signatures and IOCs are useful as part of a complete balanced b̶r̶e̶a̶k̶f̶a̶s̶t̶ defense. I wrote a Vectra custom model based on these IDS signatures which Recall customers can install.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":306,"end":318,"href":"https:\u002F\u002Fgithub.com\u002FAbjuri5t\u002FHunting-NanoCore\u002Ftree\u002Fmain\u002FVectra-Custom-Model\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_62":{"__typename":"Paragraph","id":"ae3699c79d3e_62","name":"4fff","type":"P","href":null,"layout":null,"metadata":null,"text":"[4] When configuring your DNS sinkhole, remember to re-direct all DNS requests to your local server. Otherwise, NanoCore’s DNS requests will just go to 8.8.8.8 and the sinkhole will fail.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_63":{"__typename":"Paragraph","id":"ae3699c79d3e_63","name":"3a11","type":"P","href":null,"layout":null,"metadata":null,"text":"[5] Make sure you log these connection attempts as well and consider setting an alert for them. Just because you have blocked a C2 server does not mean that you have completely managed the threat.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:ae3699c79d3e_64":{"__typename":"Paragraph","id":"ae3699c79d3e_64","name":"4e8d","type":"P","href":null,"layout":null,"metadata":null,"text":"[6] Check your SIEM and\u002For firewall logs before applying these restrictions. Depending on how locked-down your network is, you may accidentally block an important service that happens to be using ngrok or similar.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:3d056516eaf-viewerId:lo_9bbff110215d":{"__typename":"UserViewerEdge","id":"userId:3d056516eaf-viewerId:lo_9bbff110215d","isMuting":false},"PostViewerEdge:postId:cb185473c1e0-viewerId:lo_9bbff110215d":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:cb185473c1e0-viewerId:lo_9bbff110215d"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:nanocore":{"__typename":"Tag","id":"nanocore","displayTitle":"Nanocore","normalizedTagSlug":"nanocore"},"Tag:threat-hunting":{"__typename":"Tag","id":"threat-hunting","displayTitle":"Threat Hunting","normalizedTagSlug":"threat-hunting"},"Tag:networking":{"__typename":"Tag","id":"networking","displayTitle":"Networking","normalizedTagSlug":"networking"},"Post:cb185473c1e0":{"__typename":"Post","id":"cb185473c1e0","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"c269","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:ae3699c79d3e_0"},{"__ref":"Paragraph:ae3699c79d3e_1"},{"__ref":"Paragraph:ae3699c79d3e_2"},{"__ref":"Paragraph:ae3699c79d3e_3"},{"__ref":"Paragraph:ae3699c79d3e_4"},{"__ref":"Paragraph:ae3699c79d3e_5"},{"__ref":"Paragraph:ae3699c79d3e_6"},{"__ref":"Paragraph:ae3699c79d3e_7"},{"__ref":"Paragraph:ae3699c79d3e_8"},{"__ref":"Paragraph:ae3699c79d3e_9"},{"__ref":"Paragraph:ae3699c79d3e_10"},{"__ref":"Paragraph:ae3699c79d3e_11"},{"__ref":"Paragraph:ae3699c79d3e_12"},{"__ref":"Paragraph:ae3699c79d3e_13"},{"__ref":"Paragraph:ae3699c79d3e_14"},{"__ref":"Paragraph:ae3699c79d3e_15"},{"__ref":"Paragraph:ae3699c79d3e_16"},{"__ref":"Paragraph:ae3699c79d3e_17"},{"__ref":"Paragraph:ae3699c79d3e_18"},{"__ref":"Paragraph:ae3699c79d3e_19"},{"__ref":"Paragraph:ae3699c79d3e_20"},{"__ref":"Paragraph:ae3699c79d3e_21"},{"__ref":"Paragraph:ae3699c79d3e_22"},{"__ref":"Paragraph:ae3699c79d3e_23"},{"__ref":"Paragraph:ae3699c79d3e_24"},{"__ref":"Paragraph:ae3699c79d3e_25"},{"__ref":"Paragraph:ae3699c79d3e_26"},{"__ref":"Paragraph:ae3699c79d3e_27"},{"__ref":"Paragraph:ae3699c79d3e_28"},{"__ref":"Paragraph:ae3699c79d3e_29"},{"__ref":"Paragraph:ae3699c79d3e_30"},{"__ref":"Paragraph:ae3699c79d3e_31"},{"__ref":"Paragraph:ae3699c79d3e_32"},{"__ref":"Paragraph:ae3699c79d3e_33"},{"__ref":"Paragraph:ae3699c79d3e_34"},{"__ref":"Paragraph:ae3699c79d3e_35"},{"__ref":"Paragraph:ae3699c79d3e_36"},{"__ref":"Paragraph:ae3699c79d3e_37"},{"__ref":"Paragraph:ae3699c79d3e_38"},{"__ref":"Paragraph:ae3699c79d3e_39"},{"__ref":"Paragraph:ae3699c79d3e_40"},{"__ref":"Paragraph:ae3699c79d3e_41"},{"__ref":"Paragraph:ae3699c79d3e_42"},{"__ref":"Paragraph:ae3699c79d3e_43"},{"__ref":"Paragraph:ae3699c79d3e_44"},{"__ref":"Paragraph:ae3699c79d3e_45"},{"__ref":"Paragraph:ae3699c79d3e_46"},{"__ref":"Paragraph:ae3699c79d3e_47"},{"__ref":"Paragraph:ae3699c79d3e_48"},{"__ref":"Paragraph:ae3699c79d3e_49"},{"__ref":"Paragraph:ae3699c79d3e_50"},{"__ref":"Paragraph:ae3699c79d3e_51"},{"__ref":"Paragraph:ae3699c79d3e_52"},{"__ref":"Paragraph:ae3699c79d3e_53"},{"__ref":"Paragraph:ae3699c79d3e_54"},{"__ref":"Paragraph:ae3699c79d3e_55"},{"__ref":"Paragraph:ae3699c79d3e_56"},{"__ref":"Paragraph:ae3699c79d3e_57"},{"__ref":"Paragraph:ae3699c79d3e_58"},{"__ref":"Paragraph:ae3699c79d3e_59"},{"__ref":"Paragraph:ae3699c79d3e_60"},{"__ref":"Paragraph:ae3699c79d3e_61"},{"__ref":"Paragraph:ae3699c79d3e_62"},{"__ref":"Paragraph:ae3699c79d3e_63"},{"__ref":"Paragraph:ae3699c79d3e_64"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:3d056516eaf"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@the_abjuri5t\u002Fnanocore-rat-hunting-guide-cb185473c1e0","primaryTopic":{"__ref":"Topic:d4e7f4144ac5"},"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"ae3699c79d3e","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":33,"allowResponses":true,"isLimitedState":false,"title":"NanoCore RAT Hunting Guide","isSeries":false,"sequence":null,"uniqueSlug":"nanocore-rat-hunting-guide-cb185473c1e0","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1663135405332,"readingTime":8.369182389937107,"previewContent":{"__typename":"PreviewContent","subtitle":"Analysis and tools for hunting NanoCore command-and-control"},"previewImage":{"__ref":"ImageMetadata:1*DVdcHYCvKJIIj9zj1PLhkg.jpeg"},"isShortform":false,"seoTitle":"","firstPublishedAt":1661867037847,"updatedAt":1697076915003,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:cb185473c1e0-viewerId:lo_9bbff110215d"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:nanocore"},{"__ref":"Tag:threat-hunting"},{"__ref":"Tag:networking"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1997,"layerCake":3,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3d174edef8cb59',t:'MTczNDUwMzI4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3d174edef8cb59","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>