<!DOCTYPE html>
<html lang="en">
<head>

    <title>GTPDOOR - A novel backdoor tailored for covert access over the roaming exchange</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link rel="preload" as="style" href="https://doubleagent.net/assets/built/screen.css?v=3dbcffd4a6" />
    <link rel="preload" as="script" href="https://doubleagent.net/assets/built/casper.js?v=3dbcffd4a6" />

    <link rel="stylesheet" type="text/css" href="https://doubleagent.net/assets/built/screen.css?v=3dbcffd4a6" />

    <meta name="description" content="Discovery and analysis of a magic packet type implant that communicates C2 traffic over the GTP-C 3GPP protocol.">
    <link rel="icon" href="https://doubleagent.net/content/images/size/w256h256/2024/04/logo2.png" type="image/png">
    <link rel="canonical" href="https://doubleagent.net/gtpdoor-a-novel-backdoor-tailored-for-covert-access-over-the-roaming-exchange/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="doubleagent.net">
    <meta property="og:type" content="article">
    <meta property="og:title" content="GTPDOOR - A novel backdoor tailored for covert access over the roaming exchange">
    <meta property="og:description" content="Discovery and analysis of a magic packet type implant that communicates C2 traffic over the GTP-C 3GPP protocol.">
    <meta property="og:url" content="https://doubleagent.net/gtpdoor-a-novel-backdoor-tailored-for-covert-access-over-the-roaming-exchange/">
    <meta property="og:image" content="https://doubleagent.net/content/images/2024/04/GRX.jpg">
    <meta property="article:published_time" content="2024-02-27T00:00:00.000Z">
    <meta property="article:modified_time" content="2024-04-08T20:45:15.000Z">
    <meta property="article:tag" content="malware">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="GTPDOOR - A novel backdoor tailored for covert access over the roaming exchange">
    <meta name="twitter:description" content="Discovery and analysis of a magic packet type implant that communicates C2 traffic over the GTP-C 3GPP protocol.">
    <meta name="twitter:url" content="https://doubleagent.net/gtpdoor-a-novel-backdoor-tailored-for-covert-access-over-the-roaming-exchange/">
    <meta name="twitter:image" content="https://doubleagent.net/content/images/2024/04/GRX.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="haxrob">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="malware">
    <meta name="twitter:site" content="@haxrob">
    <meta property="og:image:width" content="497">
    <meta property="og:image:height" content="354">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "doubleagent.net",
        "url": "https://doubleagent.net/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://doubleagent.net/content/images/size/w256h256/2024/04/logo2.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "haxrob",
        "image": {
            "@type": "ImageObject",
            "url": "https://doubleagent.net/content/images/2024/04/TXPejNZ1_400x400.jpg",
            "width": 208,
            "height": 208
        },
        "url": "https://doubleagent.net/author/haxrob/",
        "sameAs": []
    },
    "headline": "GTPDOOR - A novel backdoor tailored for covert access over the roaming exchange",
    "url": "https://doubleagent.net/gtpdoor-a-novel-backdoor-tailored-for-covert-access-over-the-roaming-exchange/",
    "datePublished": "2024-02-27T00:00:00.000Z",
    "dateModified": "2024-04-08T20:45:15.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://doubleagent.net/content/images/2024/04/GRX.jpg",
        "width": 497,
        "height": 354
    },
    "keywords": "malware",
    "description": "Discovery and analysis of a magic packet type implant that communicates C2 traffic over the GTP-C 3GPP protocol.",
    "mainEntityOfPage": "https://doubleagent.net/gtpdoor-a-novel-backdoor-tailored-for-covert-access-over-the-roaming-exchange/"
}
    </script>

    <meta name="generator" content="Ghost 5.97">
    <link rel="alternate" type="application/rss+xml" title="doubleagent.net" href="https://doubleagent.net/rss/">
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.44/umd/portal.min.js" data-i18n="false" data-ghost="https://doubleagent.net/" data-key="a952a68b24bb1716a990186c72" data-api="https://doubleagent.ghost.io/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.3/umd/sodo-search.min.js" data-key="a952a68b24bb1716a990186c72" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.3/umd/main.css" data-sodo-search="https://doubleagent.ghost.io/" data-locale="en" crossorigin="anonymous"></script>
    
    <link href="https://doubleagent.net/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=3dbcffd4a6"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=3dbcffd4a6">
    <script defer src="/public/member-attribution.min.js?v=3dbcffd4a6"></script><style>:root {--ghost-accent-color: #464646;}</style>
    <script>
  var _paq = window._paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//svs.doubleagent.net/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>

<!-- https://ghostfam.com/en/create-a-table-of-contents-for-ghost/ -->
<script src="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css" rel="stylesheet">
<style>.gh-content{position:relative}.gh-toc>.toc-list{position:relative}.toc-list{overflow:hidden;list-style:none}@media (min-width:1300px){.gh-sidebar{position:absolute;top:0;bottom:0;margin-top:4vmin;grid-column:wide-start / main-start}.gh-toc{position:sticky;top:4vmin}li.toc-list-item{font-size:1.8rem}}.gh-toc .is-active-link::before{background-color:var(--ghost-accent-color)}a.toc-link{display:inline-flex;font-weight:400;height:100%;line-height:1.2em;padding:6px 0;text-decoration:none;transition:.4s ease;font-size:100%!important}li.toc-list-item{color:#738a94!important}a.toc-link:hover{color:#15171a!important}.is-collapsible a.is-active-link,a.is-active-link{color:#15171a!important;font-weight:500}@media (max-width:1400px){.gh-toc{background:#fff;border-radius:1em;box-shadow:0 10px 50px rgba(25,37,52,.14),0 2px 5px rgba(25,37,52,.03);padding:30px;width:100%}}</style>

</head>
<body class="post-template tag-malware is-head-left-logo has-sans-body has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo no-image" href="https://doubleagent.net">
                        doubleagent.net
                </a>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger" aria-label="Main Menu"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="https://doubleagent.net/">Home</a></li>
    <li class="nav-x-twitter"><a href="https://x.com/haxrob">X / Twitter</a></li>
    <li class="nav-about"><a href="https://doubleagent.net/about/">About</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                    <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-malware featured image-small">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-primary-tag">
                    <a href="/tag/malware/">malware</a>
                </span>
                <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
        </div>

        <h1 class="article-title">GTPDOOR - A novel backdoor tailored for covert access over the roaming exchange</h1>

            <p class="article-excerpt">Discovery and analysis of a magic packet type implant that communicates C2 traffic over the GTP-C 3GPP protocol.</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list instapaper_ignore">
                <li class="author-list-item">
                    <a href="/author/haxrob/" class="author-avatar" aria-label="Read more of haxrob">
                        <img class="author-profile-image" src="/content/images/size/w100/2024/04/TXPejNZ1_400x400.jpg" alt="haxrob" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/haxrob/">haxrob</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2024-02-27">Feb 27, 2024</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 13 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="/content/images/size/w300/2024/04/GRX.jpg 300w,
                            /content/images/size/w600/2024/04/GRX.jpg 600w,
                            /content/images/size/w1000/2024/04/GRX.jpg 1000w,
                            /content/images/size/w2000/2024/04/GRX.jpg 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="/content/images/size/w2000/2024/04/GRX.jpg"
                    alt="GTPDOOR - A novel backdoor tailored for covert access over the roaming exchange"
                />
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <div class="kg-card kg-callout-card kg-callout-card-green"><div class="kg-callout-text">This page was updated on the 17th of March 2024 with clarification on the&nbsp;<a href="https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR.html#more-on-the-probing-feature">probe/beaconing behaviour</a>&nbsp;and referencing&nbsp;<a href="https://github.com/haxrob/gtpdoor-scan/?ref=doubleagent.net">gtpdoor-scan</a>, a tool to attempt presence of GTPDOOR on a remote host or network.</div></div><h2 id="introduction">Introduction</h2><p>GTPDOOR is the name of Linux based malware that is intended to be deployed on systems in telco networks adjacent to the GRX (GRPS eXchange Network) with the novel feature of communicating C2 traffic over&nbsp;<a href="https://en.wikipedia.org/wiki/GPRS_Tunnelling_Protocol?ref=doubleagent.net">GTP-C (GPRS Tunnelling Protocol</a>&nbsp;- Control Plane) signalling messages. This allows the C2 traffic to blend in with normal traffic and to reuse already permitted ports that maybe open and exposed to the&nbsp;<a href="https://en.wikipedia.org/wiki/GPRS_roaming_exchange?ref=doubleagent.net">GRX network</a>.</p><p>The following diagram illustrates a foreseen use of GTPDOOR. Here the actor already has established persistence on the roaming exchange network and access a compromised host by sending GTP-C Echo Request messages with a malicious payload:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/1.png" class="kg-image" alt="" loading="lazy" width="1039" height="417" srcset="https://doubleagent.net/content/images/size/w600/2024/04/1.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/1.png 1000w, https://doubleagent.net/content/images/2024/04/1.png 1039w" sizes="(min-width: 720px) 720px"></figure><p>In addition to remote code execution capability, GTPDOOR can be beaconed by sending arbitrary TCP packets to a host the implant resides on. Supporting it’s stealth capability, the beacon response message hides particular information in a TCP header flag.</p><h2 id="naming">Naming</h2><p>I have given this malware the name GTPDOOR as it uses a similar “port knocking / magic packet” technique as BPFDOOR as described&nbsp;<a href="https://sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/?ref=doubleagent.net">here</a>&nbsp;and&nbsp;<a href="https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor?ref=doubleagent.net">here</a>. Both use raw sockets to intercept packets on the network interface. Unlike BPDDOOR, GTPDOOR explicitly uses GTP-C echo request/response messages and does not utilize BFP / pcap filters, but rather filters on UDP and GTP header values through simple&nbsp;<code>cmp</code>&nbsp;instructions. At the time of writing, I am not aware of this malware being documented anywhere else.</p><h2 id="attribution">Attribution</h2><p>GTPDOOR is likely attributed to UNC1945 (<a href="https://www.mandiant.com/resources/blog/live-off-the-land-an-overview-of-unc1945?ref=doubleagent.net">Mandiant</a>) / LightBasin (<a href="https://www.crowdstrike.com/blog/an-analysis-of-lightbasin-telecommunications-attacks/?ref=doubleagent.net">CrowdStrike</a>)</p><p>As described in the&nbsp;<a href="https://www.crowdstrike.com/blog/an-analysis-of-lightbasin-telecommunications-attacks/?ref=doubleagent.net">CrowdStrike article</a>&nbsp;this threat actor has been documented to use the GTP protocol for encapsulating tinyshell traffic in a valid PDP context session by employing an SGSN emulator to tunnel traffic to an external GGSN in another operator network. Here, GTPDOOR is leveraging not off a PDP context (GTP-U, userplane) but specific GTP-C signalling messages with it’s own extended message structure.</p><p>As we will see below, both binaries contain the name of the original c source file,&nbsp;<code>dnsd.c</code>. A google search links to a&nbsp;<a href="https://www.bsidesdub.ie/past/media/2023/Stuart_Davis_LightBasin.pdf?ref=doubleagent.net">presentation</a>&nbsp;by CrowdStrike about this threat actor that contains text from a process listing originating from what looks like a Solaris machine. In that listing is a process with the name&nbsp;<code>dnsd</code>:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/21.png" class="kg-image" alt="" loading="lazy" width="850" height="71" srcset="https://doubleagent.net/content/images/size/w600/2024/04/21.png 600w, https://doubleagent.net/content/images/2024/04/21.png 850w" sizes="(min-width: 720px) 720px"></figure><p>If the attribution is correct, then given the discovery of this screenshot, it is likely that in addition to the two Linux binaries documented in this blog post, a third version exists which targets Sun Solaris systems.</p><h2 id="background-information">Background information</h2><p>In order to provide connectivity between telecommunication network operators around the globe, a “closed” network exists that provides interconnectivity between various systems. These network elements / functions need to have direct connectivity to the GRX network in order to route / forawrd roaming related signalling and user plane traffic. Examples of these systems are:</p><ul><li>eDNS - External DNS to resolve APN names, select packet gateway for routing the subscribers traffic</li><li>SGSN, GGSN - 2G/3G packet core network elements for packet switched data</li><li>P-GW (Packet Data Network Gateway) - 4G version of the GGSN</li><li>STP - Signalling gateways for circuit switched routing (e.g. authentication to HLR/HSS) - specifically for SS7 signalling.</li><li>DRA (Diameter Routing Agent) - 4G version of the STP, rather then SS7, the signalling traffic is over diameter.</li></ul><p>These functions are listed as to give examples of&nbsp;where&nbsp;GTPDOOR could be placed as they may require direct connectivity to the GRX network. That is - providing opportunity for direct access into a telco’s core network. It is more likely that it would be placed on systems that support GTP-C over GRX, such as SGSN, GGSN, PGW (which don’t run some esoteric operating system). That said, if the GRX firewall is not configured right, there would be opportunities to place this type of implant elsewhere, or even within the internal core network.</p><div class="kg-card kg-callout-card kg-callout-card-blue"><div class="kg-callout-emoji">💡</div><div class="kg-callout-text">A GSMA document called the&nbsp;<code spellcheck="false" style="white-space: pre-wrap;">IR.21</code>&nbsp;is used for network providers to publish the details of these systems such as the GT (global titles), IP addresses, APNs etc. This list is used for other companies that have roaming agreements to configure their network accordingly. Alternatively, they may exchange this information directly.</div></div><h2 id="summary-of-functionality">Summary of functionality</h2><p>GTPDOOR supports the following:</p><ul><li>Listens for “magic” wakeup packet, a GTP-C echo request message (GTP type&nbsp;<code>0x01</code>). The host does not need to have a listening sockets / listening services active, as all UDP packets are received into the user space via opening a raw socket</li><li>Executes a command on the host which is specified in the magic packet and returns the output to the remote host, supporting a “reverse shell” type functionality. Both request/responses are&nbsp;<code>GTP_ECHO_REQUEST</code>&nbsp;/&nbsp;<code>GTP_ECHO_RESPONSE</code>&nbsp;messages accordingly.</li><li>Can be covertly probed from an external network to illicit a response by sending a TCP packet to any port number. If the implant is active a crafted empty TCP packet is returned along with information if the destination port was open/responding on the host.</li><li>Authenticates and encrypts contents of magic GTP packet messages using a simple XOR cipher.</li><li>At runtime can be instructed to change it’s authentication + encryption key (rekeying). This prevents the default key hardcoded in the binary to be used by other actors</li><li>Blend in to environment by changing it’s process name to look like syslog process invoked as a kernel thread</li><li>Does not require ingress firewall changes if the target host is allowed to communicate over the GTP-C port.</li></ul><h2 id="versions">Versions</h2><p>At the time of writing two versions have been identified on Virustotal:</p><table>
<thead>
<tr>
<th>Version</th>
<th>Filename</th>
<th>Architecture</th>
<th>Hash</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>dbus-echo</td>
<td>x86-64</td>
<td><code>827f41fc1a6f8a4c8a8575b3e2349aeaba0dfc2c9390ef1cceeef1bb85c34161</code></td>
</tr>
<tr>
<td>2</td>
<td>pickup</td>
<td>i386</td>
<td><code>5cbafa2d562be0f5fa690f8d551cdb0bee9fc299959b749b99d44ae3fda782e4</code></td>
</tr>
</tbody>
</table>
<p><code>pickup</code>&nbsp;has additional enhancements/features to&nbsp;<code>dbus-echo</code>, and hence is assigned a higher version number.</p><p>At the time of writing, both samples have been uploaded to Virustotal in late 2023.</p><p><a href="https://www.virustotal.com/gui/file/827f41fc1a6f8a4c8a8575b3e2349aeaba0dfc2c9390ef1cceeef1bb85c34161?ref=doubleagent.net">Version 1</a>&nbsp;- 1 detection</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/3.png" class="kg-image" alt="" loading="lazy" width="918" height="390" srcset="https://doubleagent.net/content/images/size/w600/2024/04/3.png 600w, https://doubleagent.net/content/images/2024/04/3.png 918w" sizes="(min-width: 720px) 720px"></figure><p><a href="https://www.virustotal.com/gui/file/5cbafa2d562be0f5fa690f8d551cdb0bee9fc299959b749b99d44ae3fda782e4/?ref=doubleagent.net">Version 2</a>&nbsp;- 0 detections</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/2.png" class="kg-image" alt="" loading="lazy" width="905" height="399" srcset="https://doubleagent.net/content/images/size/w600/2024/04/2.png 600w, https://doubleagent.net/content/images/2024/04/2.png 905w" sizes="(min-width: 720px) 720px"></figure><div class="kg-card kg-callout-card kg-callout-card-grey"><div class="kg-callout-text">Note: as of the 17th of March, 2024, there is now 37 detections</div></div><p>Both binaries were targeted for a particularly old Linux distribution, “Red Hat Linux 4.1”. This is the equivalent to RHEL 5.x. The GCC date is marked 2008. It is quite likely the target network operator of this implant had quite poor patch / lifecycle management.</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/4.png" class="kg-image" alt="" loading="lazy" width="850" height="281" srcset="https://doubleagent.net/content/images/size/w600/2024/04/4.png 600w, https://doubleagent.net/content/images/2024/04/4.png 850w" sizes="(min-width: 720px) 720px"></figure><p><code>2024-03-17</code>&nbsp;- for maximum ABI compatibility, compiling against old glibc versions increases the chance of binaries working in newer releases, so the targetted version may not be exact, although it would be expected to be within proximity to ensure stability.</p><p>As the binaries are not stripped, source code’s original filename was likely&nbsp;<code>dnsd.c</code>:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/5-1.png" class="kg-image" alt="" loading="lazy" width="730" height="183" srcset="https://doubleagent.net/content/images/size/w600/2024/04/5-1.png 600w, https://doubleagent.net/content/images/2024/04/5-1.png 730w" sizes="(min-width: 720px) 720px"></figure><h2 id="technical-details">Technical Details</h2><h3 id="gtp-magic-packet-message-types">GTP magic packet message types</h3><p>The command instruction is sent in the GTP Echo Request message along with the associated data. As summarized:</p><p><strong>GTPDOOR v1</strong></p><table>
<thead>
<tr>
<th>Message Type</th>
<th>Function</th>
<th>Payload</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0x01</code></td>
<td>Set new encryption key</td>
<td>New key</td>
</tr>
<tr>
<td><code>0x02</code></td>
<td>Write data to <code>system.conf</code></td>
<td>File content</td>
</tr>
<tr>
<td><code>0x03</code> - <code>0xFF</code></td>
<td>Execute command and return output</td>
<td>Shell command to run</td>
</tr>
</tbody>
</table>
<p><strong>GTPDOOR v2</strong></p><table>
<thead>
<tr>
<th>Message Type</th>
<th>Function</th>
<th>Payload</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0x01</code></td>
<td>Set new encryption key</td>
<td>New key value</td>
</tr>
<tr>
<td><code>0x02</code></td>
<td>Write arbitrary data to <code>system.conf</code></td>
<td>File content</td>
</tr>
<tr>
<td><code>0x03</code>,<code>0x04</code>,<code>0x08</code>-<code>0xFF</code></td>
<td>Execute command and return output</td>
<td>Shell command to run</td>
</tr>
<tr>
<td><code>0x05</code></td>
<td>IP address or subnet to access control list.</td>
<td>Multiple subnets or single IPs (/32) can be separated by a comma, e.g. 192.168.0.1/24,10.0.0.1</td>
</tr>
<tr>
<td><code>0x06</code></td>
<td>Return ACL list</td>
<td></td>
</tr>
<tr>
<td><code>0x07</code></td>
<td>Clear ACL</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="magic-packet-format">Magic packet format</h3><p>The packet can be visually represented as followed:&nbsp;</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/15-1.png" class="kg-image" alt="" loading="lazy" width="573" height="819"></figure><p>As a “c-like struct”:</p><pre><code class="language-c">struct gtp_header
{
  uint8_t flags;
  uint8_t type;
  uint16_t length;
  uint32_t tei; // technically labelled spare if type == GTP_ECHO
};

struct gtpdoor_header
{
  uint8_t pad[5];
  int32_t key1;
  uint8_t cmdMsgType;
  uint16_t cmdLength;
};

struct gtpdoor_packet 
{
  ip_header iph;
  udp_header udph;
  gtp_header gtph;
  gtpdoor_header gtpdoorh;
  uint8_t payload[2020];
};
</code></pre><h3 id="operational-detail">Operational detail</h3><p><strong>Version 1 + 2:</strong></p><ul><li>Checks if the length of it’s filename is greater then 8 characters, and if so, process name stomps itself to become&nbsp;<code>[syslogd]</code>&nbsp;by overwriting&nbsp;<code>argv</code>. The length check is to ensure it does not corrupt the stack.</li><li>Tells the parent process to ignore signals from it’s child process be setting&nbsp;<code>SIG_IGN</code>&nbsp;for the&nbsp;<code>SIGCHLD</code>&nbsp;signal</li><li>Creates a raw socket listening for UDP packets on port 2123 (GTP-C)</li></ul><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/6.png" class="kg-image" alt="" loading="lazy" width="651" height="372" srcset="https://doubleagent.net/content/images/size/w600/2024/04/6.png 600w, https://doubleagent.net/content/images/2024/04/6.png 651w"></figure><ul><li>Accepts UDP packets on destination port&nbsp;<code>2123</code>&nbsp;with a GTP header field type value of&nbsp;<code>GTP_ECHO_REQUEST</code></li></ul><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/7.png" class="kg-image" alt="" loading="lazy" width="688" height="571" srcset="https://doubleagent.net/content/images/size/w600/2024/04/7.png 600w, https://doubleagent.net/content/images/2024/04/7.png 688w"></figure><ul><li>Checks that the 32 bit symmetric key is correct in order to authenticate the message. The hardcoded value in the binary is&nbsp;<code>135798642</code>, representative of someone typing odd numbers up the length of a keyboard even numbers back down again:</li></ul><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/8.png" class="kg-image" alt="" loading="lazy" width="746" height="455" srcset="https://doubleagent.net/content/images/size/w600/2024/04/8.png 600w, https://doubleagent.net/content/images/2024/04/8.png 746w" sizes="(min-width: 720px) 720px"></figure><ul><li>Decrypts payload in GTP message using the same authentication key using a simple XOR at fixed blocks of the key size.</li></ul><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/18.png" class="kg-image" alt="" loading="lazy" width="442" height="222"></figure><p>An equivalent implementation of the decryption routine in python:</p><pre><code class="language-python">def decrypt(key, ciphertext):
    key_idx = 0
    strlen = len(ciphertext)
    plaintext = bytearray(strlen)
    for i in range(strlen):
        if key_idx &gt;= len(key):
            key_idx = 0
        plaintext[i] = key[key_idx] ^ ciphertext[i]
        key_idx += 1
    return plaintext
</code></pre><ul><li>Executes a function specified message type with the primary function to execute a shell command and return the result to the remote client via a&nbsp;<code>GTP_ECHO_RESPONSE</code>&nbsp;message</li></ul><p>If the message type number is not explicitly defined, the action will fall back to the remote code execution function:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/20.png" class="kg-image" alt="" loading="lazy" width="620" height="241" srcset="https://doubleagent.net/content/images/size/w600/2024/04/20.png 600w, https://doubleagent.net/content/images/2024/04/20.png 620w"></figure><p>The above image also shows the approximate code for the “rekeying” message type.</p><ul><li>Can write arbitrary contents to a file,&nbsp;<code>system.conf</code>. It’s exact purpose is unknown.</li></ul><p><strong>Specific to version 2</strong>:</p><ul><li>Multithreaded (GTP magic packet handler and TCP probe beacon handler)</li></ul><p>As the binary was not stripped and debug symbols left in, we can see the original function names&nbsp;<code>tcpMethod</code>&nbsp;and&nbsp;<code>gtpMethod</code>&nbsp;which run in two pthreads:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/9.png" class="kg-image" alt="" loading="lazy" width="742" height="632" srcset="https://doubleagent.net/content/images/size/w600/2024/04/9.png 600w, https://doubleagent.net/content/images/2024/04/9.png 742w" sizes="(min-width: 720px) 720px"></figure><ul><li>Creates a mutex&nbsp;<code>/var/run/daemon.pid</code>&nbsp;to prevent more then once instance running. The mutex file contains the PID of the process</li><li>Acknowledge it is alive by responding to any TCP packet on any port number with an empty TCP packet with both the&nbsp;<code>RST</code>&nbsp;and&nbsp;<code>ACK</code>&nbsp;flags set.</li></ul><p>On “remote command execution”, the process is&nbsp;<code>forked()</code>&nbsp;and&nbsp;<code>popen()</code>&nbsp;is utilized to execute a subprocess on the host.</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/20-1.png" class="kg-image" alt="" loading="lazy" width="620" height="241" srcset="https://doubleagent.net/content/images/size/w600/2024/04/20-1.png 600w, https://doubleagent.net/content/images/2024/04/20-1.png 620w"></figure><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/10.png" class="kg-image" alt="" loading="lazy" width="791" height="302" srcset="https://doubleagent.net/content/images/size/w600/2024/04/10.png 600w, https://doubleagent.net/content/images/2024/04/10.png 791w" sizes="(min-width: 720px) 720px"></figure><p>All <code>printf</code> statements such as those observed above are emitted to&nbsp;<code>stdout</code>. As such it is likely GTPDOOR would be invoked similar to the following (redirecting&nbsp;<code>stdin</code>&nbsp;and&nbsp;<code>stderr</code>&nbsp;to&nbsp;<code>/dev/null</code>&nbsp;and detaching from the parent process):</p><p><code>nohup ./gtpdoor 2&gt;&amp;1 2&gt;/dev/null &amp;</code></p><h2 id="more-on-the-probing-feature">More on the probing feature</h2><p>The TCP probe is a feature that allows an external host to probe the GRX listening address for TCP packets. A subnet filter is checked against the source IP address of the “client” and if it does&nbsp;<strong>NOT</strong>&nbsp;match, a reply beacon is sent to the (scanning) client. A crafted TCP&nbsp;<code>RST/ACK</code>&nbsp;response packet with the urgent pointer field set to&nbsp;<code>0x01</code>&nbsp;indicates the implant is running.</p><p>Based on the analysis of the behaviour, it appears that two types of scans are supported:</p><ul><li>TCP connect scan (simple TCP three way handshake)</li><li>ACK scans (client sending an ACK message with no initial SYN)</li></ul><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/24.png" class="kg-image" alt="" loading="lazy" width="1489" height="764" srcset="https://doubleagent.net/content/images/size/w600/2024/04/24.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/24.png 1000w, https://doubleagent.net/content/images/2024/04/24.png 1489w" sizes="(min-width: 720px) 720px"></figure><p><strong>TCP Connect Scan</strong></p><p>For a TCP connect scan to work, there must be a service listening and port exposed on the host, either from a permissive firewall or no firewall at all. GTPDOOR will send a “decoy” TCP&nbsp;<code>ACK/RST</code>&nbsp;response on the initial TCP&nbsp;<code>SYN</code>&nbsp;from the client but with no identifying information to indicate GTPDOOR is running. It is the second TCP&nbsp;<code>ACK/RST</code>&nbsp;that is sent on the client’s ACK that has the urgent pointer set to signal GTPDOOR is running on the remote host.</p><p><strong>ACK Scan</strong></p><p>For an ACK scan to work, the condition would be no firewall or a non stateful firewall (so the TCP&nbsp;<code>ACK</code>&nbsp;is not dropped due to no initial&nbsp;<code>SYN</code>&nbsp;packet from the client). No service needs to listen the TCP beaconing port with an ACK scan: as with the GTP message handler, a raw socket is used to “intercept” all TCP packets.</p><p>The beacon response packet that is sent back to the probing host is manually assembled, copying the incoming packet’s relevant IP and TCP header fields into the outgoing beacon packet.</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/11.png" class="kg-image" alt="" loading="lazy" width="613" height="379" srcset="https://doubleagent.net/content/images/size/w600/2024/04/11.png 600w, https://doubleagent.net/content/images/2024/04/11.png 613w"></figure><p>The probe response packets will always have the&nbsp;<code>ACK/RST</code>&nbsp;flags set and the urgent pointer flags set according to if an&nbsp;<code>TCP ACK</code>&nbsp;was observed. This is a covert way of encoding messages by bit manipulation in the TCP header.</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/25.png" class="kg-image" alt="" loading="lazy" width="657" height="403" srcset="https://doubleagent.net/content/images/size/w600/2024/04/25.png 600w, https://doubleagent.net/content/images/2024/04/25.png 657w"></figure><p>It is assumed that packets of this combination would be rare or non-existent in normal TCP/IP communication as the URG flag is set to 0, while the urgent pointer specifies a value. Additionally, this is occurring with the RST flag set.</p><p><a href="https://datatracker.ietf.org/doc/html/rfc0793?ref=doubleagent.net">RFC0793</a>&nbsp;states that the urgent pointer has no meaning if the URG flag is not set:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/27.png" class="kg-image" alt="" loading="lazy" width="861" height="460" srcset="https://doubleagent.net/content/images/size/w600/2024/04/27.png 600w, https://doubleagent.net/content/images/2024/04/27.png 861w" sizes="(min-width: 720px) 720px"></figure><p>We can observe the differences in a tcpdump. In the following a TCP connect() from the probe “client” on a non existing port&nbsp;<code>22222</code>&nbsp;has a probe response&nbsp;<code>RST/ACK</code>&nbsp;with the urgent pointer flat set to&nbsp;<code>0</code>. The assumption here is that this is a “decoy” response to blend in&nbsp;<code>RST/ACK</code>&nbsp;responses for closed or open ports on the remote host.</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/12.png" class="kg-image" alt="" loading="lazy" width="1163" height="558" srcset="https://doubleagent.net/content/images/size/w600/2024/04/12.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/12.png 1000w, https://doubleagent.net/content/images/2024/04/12.png 1163w" sizes="(min-width: 720px) 720px"></figure><p>&nbsp;On the other hand, when the client connects to an open port&nbsp;<code>22 (SSH)</code>, the probe response includes a&nbsp;<code>RST/ACK</code>&nbsp;but this time with the urgent pointer set to&nbsp;<code>1</code></p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/13.png" class="kg-image" alt="" loading="lazy" width="1171" height="662" srcset="https://doubleagent.net/content/images/size/w600/2024/04/13.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/13.png 1000w, https://doubleagent.net/content/images/2024/04/13.png 1171w" sizes="(min-width: 720px) 720px"></figure><h2 id="acl-functionality">ACL functionality</h2><p>It is not known if the ACL is intended to be a deny list or allow list - there are pros and cons of explicitly denying IP subnets from probing:</p><ul><li>Avoid keeping threat actor C2 infrastructure network/IPs resident in memory</li><li>Specify internal victim networks or host IPs to prevent causing traffic disruption from beaconed TCP reset messages.</li></ul><p>Based on analysis of the samples alone, the author assumes this behaviour is intentional. The threat actor can change their C2 infrastructure or intermediate transit hosts without loosing the ability to send probe messages.</p><p>It is likely that the&nbsp;<code>RST/ACK</code>&nbsp;responses from an initial&nbsp;<code>SYN</code>&nbsp;packet is there as a decoy - a casual review of a network capture would result in one assuming that this is normal behaviour of the firewall or hosts TCP/IP stack. One would have to notice that the&nbsp;<code>RST/ACK</code>&nbsp;packet has the urgent pointer field set only for incoming&nbsp;<code>ACK</code>&nbsp;packets. Tricky indeed!</p><p>An approximation of the ACL filtering. Note the&nbsp;<code>!</code>&nbsp;on line&nbsp;<code>118</code>:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/14.png" class="kg-image" alt="" loading="lazy" width="826" height="513" srcset="https://doubleagent.net/content/images/size/w600/2024/04/14.png 600w, https://doubleagent.net/content/images/2024/04/14.png 826w" sizes="(min-width: 720px) 720px"></figure><p>Notably one condition before TCP packets are “intercepted” by the process is the global variable&nbsp;<code>local_grx_addr</code>&nbsp;must be set first. This is set based on the destination IP address in any GTP-C packet that is received.</p><p>Another condition is that the ACL must have at least one subnet or IP defined for the probe feature to be operational.</p><h2 id="detection">Detection</h2><ul><li>GTPDOOR can be identified by listing raw sockets open on the system, e.g. via&nbsp;<code>lsof</code>, looking for&nbsp;<code>SOCK_RAW</code>&nbsp;or&nbsp;<code>raw</code>.</li></ul><p><code>netstat -lp --raw</code>&nbsp;also shows listening sockets:</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/23.png" class="kg-image" alt="" loading="lazy" width="920" height="127" srcset="https://doubleagent.net/content/images/size/w600/2024/04/23.png 600w, https://doubleagent.net/content/images/2024/04/23.png 920w" sizes="(min-width: 720px) 720px"></figure><ul><li>Process name stomped files that are disguised as kernel threads can be identified by their parent process not being&nbsp;<code>kthreadd</code>. In the following screenshot the&nbsp;<code>PPID</code>&nbsp;of the backdoor is&nbsp;<code>1935</code>, while the other kernel thread parent IDs are&nbsp;<code>2</code>:</li></ul><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/22.png" class="kg-image" alt="" loading="lazy" width="748" height="171" srcset="https://doubleagent.net/content/images/size/w600/2024/04/22.png 600w, https://doubleagent.net/content/images/2024/04/22.png 748w" sizes="(min-width: 720px) 720px"></figure><ul><li>The presence of the mutex&nbsp;<code>/var/run/daemon.pid</code>&nbsp;could be an indicator.</li><li>The presence of the file&nbsp;<code>system.conf</code>&nbsp;could be an indicator.</li></ul><p>Yara rule for threat hunting:</p><pre><code>rule Linux_Malware_GTPDOOR_v1v2 
{
	meta:
		description = "Detects GTPDOOR"
		author = "@haxrob"
		data = "28/02/2024"
		reference = "https://doubleagent.net/telecommunications/backdoor/gtp/2024/02/27/GTPDOOR-COVERT-TELCO-BACKDOOR"
		hash1 = "827f41fc1a6f8a4c8a8575b3e2349aeaba0dfc2c9390ef1cceeef1bb85c34161"
		hash2 = "5cbafa2d562be0f5fa690f8d551cdb0bee9fc299959b749b99d44ae3fda782e4"
	strings:
		$s1 = "excute result is" ascii fullword
		$s2 = "idkey not correct" ascii fullword
		$s3 = "send ret message" ascii fullword
	condition:
		uint16(0) == 0x457f and
		2 of them and
		filesize &lt; 20KB
}
</code></pre><h2 id="defence">Defence</h2><p>GSMA has released two relevant guidelines:</p><ul><li><a href="https://www.gsma.com/security/wp-content/uploads/2020/02/FS.31-Baseline-Security-Controls-v3.0.pdf?ref=doubleagent.net">FS.31 GSMA Baseline Security Controls</a></li><li><a href="https://www.gsma.com/publicpolicy/wp-content/uploads/2012/03/ir77.pdf?ref=doubleagent.net">IR.77 Inter-Operator IP Backbone Security Requirements For Service Providers and Inter-operator IP backbone Providers</a></li></ul><h3 id="gtp-firewall">GTP Firewall</h3><p>GPTDOOR handles malformed GTP packets. In the following test, the GTP protocol type of&nbsp;<code>0</code>&nbsp;(GTP prime - charging related) is set in custom client. GTP’ does not work over the GTP-C port. Additionally the extension header is corrupt. The GTPDOOR message encrypted payload is appended on the GTP message. As such, a GTP capable firewall may detect and drop abnormal packets like this.</p><figure class="kg-card kg-image-card"><img src="https://doubleagent.net/content/images/2024/04/16.png" class="kg-image" alt="" loading="lazy" width="1186" height="500" srcset="https://doubleagent.net/content/images/size/w600/2024/04/16.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/16.png 1000w, https://doubleagent.net/content/images/2024/04/16.png 1186w" sizes="(min-width: 720px) 720px"></figure><h3 id="firewalling">Firewalling</h3><ul><li>The inbound UDP port is required to be open for systems that require it on the GRX network. Firewall rules should be explicit enough to drop these packets inbound for any system that does not use the GTP protocol</li><li>Aggressive rules to block inbound TCP connections via the GRX - There is not a lot that actually needs to be open</li><li>Probe TCP packets with RST/ACK flag set could be dropped on the GRX firewall</li></ul><h2 id="active-gtpdoor-network-scanner">Active GTPDOOR network scanner</h2><p>A multithreaded network scanner is available which can be used to scan remotes hosts in attempt to detect the presence of GTPDOOR:</p><p><a href="https://github.com/haxrob/gtpdoor-scan/?ref=doubleagent.net">https://github.com/haxrob/gtpdoor-scan/</a></p><p></p>
    </section>


</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post featured post-card-large">

    <a class="post-card-image-link" href="/fastcash-for-linux/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2024/10/penguincash3.jpg 300w,
                    /content/images/size/w600/2024/10/penguincash3.jpg 600w,
                    /content/images/size/w1000/2024/10/penguincash3.jpg 1000w,
                    /content/images/size/w2000/2024/10/penguincash3.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2024/10/penguincash3.jpg"
            alt="FASTCash for Linux"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/fastcash-for-linux/">
            <header class="post-card-header">
                <div class="post-card-tags">
                        <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
                </div>
                <h2 class="post-card-title">
                    FASTCash for Linux
                </h2>
            </header>
                <div class="post-card-excerpt">Analysis of a newly discovered Linux based variant of the DPRK attributed FASTCash malware along with background information on payment switches used in financial networks.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-10-13">Oct 13, 2024</time>
                <span class="post-card-meta-length">19 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post post-card-large">

    <a class="post-card-image-link" href="/hiding-in-plain-sight-part-2/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2024/07/solaros.webp 300w,
                    /content/images/size/w600/2024/07/solaros.webp 600w,
                    /content/images/size/w1000/2024/07/solaros.webp 1000w,
                    /content/images/size/w2000/2024/07/solaros.webp 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2024/07/solaros.webp"
            alt="Hiding in plain sight (part 2) - Abusing the dynamic linker"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/hiding-in-plain-sight-part-2/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Hiding in plain sight (part 2) - Abusing the dynamic linker
                </h2>
            </header>
                <div class="post-card-excerpt">A stealthy process stomping method compatible with UNIX-like systems with anti-forensic enhancements for Linux.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-08-02">Aug 2, 2024</time>
                <span class="post-card-meta-length">14 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post post-card-large">

    <a class="post-card-image-link" href="/process-name-stomping/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2024/04/morris.png 300w,
                    /content/images/size/w600/2024/04/morris.png 600w,
                    /content/images/size/w1000/2024/04/morris.png 1000w,
                    /content/images/size/w2000/2024/04/morris.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2024/04/morris.png"
            alt="Hiding in plain sight: Modifying process names in UNIX-like systems"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/process-name-stomping/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    Hiding in plain sight: Modifying process names in UNIX-like systems
                </h2>
            </header>
                <div class="post-card-excerpt">Exploring ways malware on Linux and other UNIX-like systems can disguise their process names.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2024-06-30">Jun 30, 2024</time>
                <span class="post-card-meta-length">16 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://doubleagent.net">doubleagent.net</a> &copy; 2024</section>
            <nav class="site-footer-nav">
                <ul class="nav">
    <li class="nav-sign-up"><a href="#/portal/">Sign up</a></li>
</ul>

            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="https://doubleagent.net/assets/built/casper.js?v=3dbcffd4a6"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<!--
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-core.min.js" integrity="sha512-9khQRAUBYEJDCDVP2yw3LRUQvjJ0Pjx0EShmaQjcHa6AXiOv6qHQu9lCAIR8O+/D8FtaCoJ2c0Tf9Xo7hYH01Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-fTl/qcO1VgvKtOMApX2PdZzkziyr2stM65GYPLGuYMnuMm1z2JLJG6XVU7C/mR+E7xBUqCivykuhlzfqxXBXbg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  // https://highlightjs.org/
activateHighlight = function() {
    document.querySelectorAll("pre code").forEach(
        function(currentValue, currentIndex, listObj) {
    		hljs.highlightBlock(currentValue);
        }
    );
}

if (window.attachEvent) {
    window.attachEvent('onload', loadHighlight);
} else {
    if (window.onload) {
		var originalOnload = window.onload;
    	var newOnload = function(evt) {
        	originalOnload(evt);
        	activateHighlight(evt);
    	};
    	window.onload = newOnload;
    } else {
        window.onload = activateHighlight;
    }
}
</script>
<style>
.gh-content pre {
      background: #ffffff00;
}
</style>
-->
<script>document.addEventListener('DOMContentLoaded',function(){var contentElement=document.querySelector('.gh-content');if(contentElement){var asideElement=document.createElement('aside');asideElement.className='gh-sidebar';asideElement.innerHTML='<div class="gh-toc"></div>';var firstChildElement=contentElement.firstElementChild;if(firstChildElement){firstChildElement.insertAdjacentElement('beforebegin',asideElement)}else{contentElement.appendChild(asideElement)}tocbot.init({tocSelector:'.gh-toc',contentSelector:'.gh-content',headingSelector:'h1,h2,h3,h4',hasInnerContainers:true, collapseDepth:1})}});</script>

</body>
</html>
