<!doctype html><html lang="en"><head><title data-rh="true">Exorcist Ransomware analysis writeup  | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-07-24T13:17:22.638Z"/><meta data-rh="true" name="title" content="Exorcist Ransomware analysis writeup  | Medium"/><meta data-rh="true" property="og:title" content="Exorcist Ransomware — From triaging to deep dive"/><meta data-rh="true" property="al:android:url" content="medium://p/5b7da4263d81"/><meta data-rh="true" property="al:ios:url" content="medium://p/5b7da4263d81"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Analysis of a newly introduced ransomware as a service called Exorcist"/><meta data-rh="true" property="og:description" content="TL;DR"/><meta data-rh="true" property="og:url" content="https://medium.com/@velasco.l.n/exorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@velasco.l.n/exorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:464/1*KxnGPBxfs0kuOq4dCVasyg.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@velasco.l.n"/><meta data-rh="true" name="author" content="Leandro Velasco"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Exorcist Ransomware — From triaging to deep dive"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/5b7da4263d81"/><meta data-rh="true" property="twitter:description" content="TL;DR"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:464/1*KxnGPBxfs0kuOq4dCVasyg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="11 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@velasco.l.n"/><link data-rh="true" rel="canonical" href="https://medium.com/@velasco.l.n/exorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/5b7da4263d81"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*KxnGPBxfs0kuOq4dCVasyg.png"],"url":"https:\u002F\u002Fmedium.com\u002F@velasco.l.n\u002Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81","dateCreated":"2020-07-24T12:18:43.272Z","datePublished":"2020-07-24T12:18:43.272Z","dateModified":"2021-12-15T08:00:19.639Z","headline":"Exorcist Ransomware analysis writeup  | Medium","name":"Exorcist Ransomware analysis writeup  | Medium","description":"Analysis of a newly introduced ransomware as a service called Exorcist","identifier":"5b7da4263d81","author":{"@type":"Person","name":"Leandro Velasco","url":"https:\u002F\u002Fmedium.com\u002F@velasco.l.n"},"creator":["Leandro Velasco"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@velasco.l.n\u002Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81"}</script><style type="text/css" data-fela-rehydration="589" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="589" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{line-height:1.12}.mh{letter-spacing:-0.022em}.mi{font-weight:600}.nd{margin-bottom:-0.28em}.ne{line-height:1.58}.nf{letter-spacing:-0.004em}.ng{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ob{margin-bottom:-0.46em}.oh{text-decoration:underline}.oi{font-style:italic}.oj{margin-left:auto}.ok{margin-right:auto}.ol{max-width:523px}.or{clear:both}.os{height:auto}.ot{margin-top:10px}.ou{max-width:728px}.ox{max-width:464px}.pd{max-width:1658px}.pe{padding-top:5px}.pf{padding-bottom:5px}.ph{cursor:zoom-in}.pi{z-index:auto}.pk{max-width:1644px}.pl{max-width:699px}.pm{line-height:1.18}.qa{margin-bottom:-0.31em}.qb{max-width:1222px}.qc{width:57.75%}.qd{margin-right:10px}.qe:last-of-type{margin-right:0}.qf{width:42.25%}.qg{max-width:1192px}.qh{list-style-type:decimal}.qi{margin-left:30px}.qj{padding-left:0px}.qp{max-width:535px}.qq{width:56.45%}.qr{width:43.55%}.qs{max-width:626px}.qt{max-width:683px}.qu{width:53.06%}.qv{width:46.94%}.qw{max-width:3507px}.qx{max-width:1530px}.qy{max-width:533px}.qz{max-width:1072px}.ra{max-width:1159px}.rb{max-width:1621px}.rc{max-width:1291px}.rd{max-width:1434px}.re{max-width:1112px}.rf{max-width:564px}.rg{list-style-type:disc}.rh{max-width:2329px}.ri{width:55.92%}.rj{width:44.08%}.rk{width:50.27%}.rl{width:49.73%}.rm{width:21.03%}.rn{width:78.97%}.ro{max-width:2058px}.rp{max-width:1439px}.rq{max-width:658px}.rr{max-width:1180px}.rs{max-width:1153px}.rt{overflow-x:auto}.ru{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.rv{padding:20px}.rw{border-radius:0}.rx{background:#F2F2F2}.ry{margin-top:-0.09em}.rz{margin-bottom:-0.09em}.sa{white-space:pre-wrap}.sb{min-width:fit-content}.sc{margin-bottom:26px}.sd{margin-top:6px}.se{margin-top:8px}.sf{margin-right:8px}.sg{padding:8px 16px}.sh{border-radius:100px}.si{transition:background 300ms ease}.sk{white-space:nowrap}.sl{border-top:none}.sm{margin-bottom:14px}.sn{height:52px}.so{max-height:52px}.sp{box-sizing:content-box}.sq{position:static}.sr{z-index:1}.st{max-width:155px}.sz{margin-right:20px}.tf{height:0px}.tg{margin-bottom:40px}.tv{height:64px}.tw{width:64px}.tx{align-self:flex-end}.ty{color:rgba(255, 255, 255, 1)}.tz{fill:rgba(255, 255, 255, 1)}.ua{background:rgba(25, 25, 25, 1)}.ub{border-color:rgba(25, 25, 25, 1)}.ue:disabled{opacity:0.1}.uf:disabled:hover{background:rgba(25, 25, 25, 1)}.ug:disabled:hover{border-color:rgba(25, 25, 25, 1)}.uh{flex:1 1 auto}.ul{padding-right:4px}.um{font-weight:500}.ut{margin-top:16px}.uu{margin-bottom:54px}.va{gap:18px}.vb{fill:rgba(61, 61, 61, 1)}.vn{border-bottom:solid 1px #E5E5E5}.vo{margin-top:72px}.vp{padding:24px 0}.vq{margin-bottom:0px}.vr{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.sj:hover{background-color:#F2F2F2}.tu:hover{background-color:none}.uc:hover{background:#000000}.ud:hover{border-color:#242424}.vc:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.pj:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mz{font-size:24px}.na{margin-top:1.95em}.nb{line-height:30px}.nc{letter-spacing:-0.016em}.nx{font-size:20px}.ny{margin-top:0.94em}.nz{line-height:32px}.oa{letter-spacing:-0.003em}.og{margin-top:2.14em}.oq{margin-top:56px}.pc{max-width:1192px}.px{margin-top:1.72em}.py{line-height:24px}.pz{letter-spacing:0}.qo{margin-top:1.14em}.sy{display:inline-block}.te{margin-bottom:104px}.th{flex-direction:row}.tk{margin-bottom:0}.tl{margin-right:20px}.ui{max-width:500px}.uz{margin-bottom:72px}.vh{margin:40px 0 0}.vm{padding-top:72px}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.ov{margin-left:auto}.ow{text-align:center}.sx{display:inline-block}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.sw{display:inline-block}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.sv{display:inline-block}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{font-size:20px}.mk{margin-top:1.2em}.ml{line-height:24px}.mm{letter-spacing:0}.nh{font-size:18px}.ni{margin-top:0.67em}.nj{line-height:28px}.nk{letter-spacing:-0.003em}.oc{margin-top:1.56em}.om{margin-top:40px}.oy{max-width:100%}.pn{font-size:16px}.po{margin-top:1.23em}.qk{margin-top:1.34em}.su{display:inline-block}.ta{margin-bottom:96px}.ts{margin-bottom:20px}.tt{margin-right:0}.un{font-size:24px}.uo{line-height:30px}.up{letter-spacing:-0.016em}.uv{margin-bottom:64px}.vd{margin:32px 0 0}.vi{padding-top:48px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mv{font-size:24px}.mw{margin-top:1.95em}.mx{line-height:30px}.my{letter-spacing:-0.016em}.nt{font-size:20px}.nu{margin-top:0.94em}.nv{line-height:32px}.nw{letter-spacing:-0.003em}.of{margin-top:2.14em}.op{margin-top:56px}.pb{max-width:1192px}.pu{margin-top:1.72em}.pv{line-height:24px}.pw{letter-spacing:0}.qn{margin-top:1.14em}.td{margin-bottom:104px}.ti{flex-direction:row}.tm{margin-bottom:0}.tn{margin-right:20px}.uj{max-width:500px}.uy{margin-bottom:72px}.vg{margin:40px 0 0}.vl{padding-top:72px}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mr{font-size:24px}.ms{margin-top:1.95em}.mt{line-height:30px}.mu{letter-spacing:-0.016em}.np{font-size:20px}.nq{margin-top:0.94em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.oe{margin-top:2.14em}.oo{margin-top:56px}.pa{max-width:100%}.pr{margin-top:1.72em}.ps{line-height:24px}.pt{letter-spacing:0}.qm{margin-top:1.14em}.tc{margin-bottom:104px}.tj{flex-direction:row}.to{margin-bottom:0}.tp{margin-right:20px}.uk{max-width:500px}.ux{margin-bottom:72px}.vf{margin:40px 0 0}.vk{padding-top:72px}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mn{font-size:20px}.mo{margin-top:1.2em}.mp{line-height:24px}.mq{letter-spacing:0}.nl{font-size:18px}.nm{margin-top:0.67em}.nn{line-height:28px}.no{letter-spacing:-0.003em}.od{margin-top:1.56em}.on{margin-top:40px}.oz{max-width:100%}.pp{font-size:16px}.pq{margin-top:1.23em}.ql{margin-top:1.34em}.tb{margin-bottom:96px}.tq{margin-bottom:20px}.tr{margin-right:0}.uq{font-size:24px}.ur{line-height:30px}.us{letter-spacing:-0.016em}.uw{margin-bottom:64px}.ve{margin:32px 0 0}.vj{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="print">.ss{display:none}</style><style type="text/css" data-fela-rehydration="589" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pg{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F5b7da4263d81&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="2c67" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Exorcist Ransomware — From triaging to deep dive</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@velasco.l.n?source=post_page---byline--5b7da4263d81--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Leandro Velasco" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/0*v2tYxgdxbDzC0bNz.jpg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/@velasco.l.n?source=post_page---byline--5b7da4263d81--------------------------------">Leandro Velasco</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F2f8ddcaa989f&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;user=Leandro+Velasco&amp;userId=2f8ddcaa989f&amp;source=post_page-2f8ddcaa989f--byline--5b7da4263d81---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jul 24, 2020</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5b7da4263d81&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;user=Leandro+Velasco&amp;userId=2f8ddcaa989f&amp;source=---header_actions--5b7da4263d81---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b7da4263d81&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;source=---header_actions--5b7da4263d81---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="a6bc" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">TL;DR</h1><p id="a095" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">On Monday 20th while hunting for some REvil samples I stumbled upon a newly introduced ransomware as a service called Exorcist. This ransomware is distributed via Pastebin embedded in a powershell script that loads it directly in memory. This script is based on “Invoke-ReflectivePEInjection.ps1” script by Joe Bialek (@JosephBialek), but it is optimised with an additional function to pass a base64 encoded executable to the main function. This powershell script is possibly generated using the Empire framework. The same technique is used by some of the Sodinokibi/REvil affiliates, and in the past by Buran.</p><p id="13d7" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">The ransomware is not obfuscated and the majority of the strings are in plaintext stored in the “.rdata” section of the executable. The first thing that the malware does is to check the geo location of the system using the language and the keyboard layout. If the results yield one of the Commonwealth of Independent States (CIS) it quits on the spot. Then the ransomware execute a series of commands to disable and remove backups and kill processes that might interfere with the system encryption. Once it is done with the commands, it writes to disk the RSA public key, the session private key and the extension. This information is not written into a file in a straightforward manner, instead it is written in different <a class="af oh" href="https://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/" rel="noopener ugc nofollow" target="_blank">Alternate Data Streams</a> on the file “<em class="oi">%temp%\\boot.sys”.</em>Then it extracts information from the system such as username, hostname, OS version, keyboard layout, etc. and sends them via http to the server “http://217.8.117[.]26/gateinfo”. Next it gets the amount of cpu on the systems and starts multiple threats to encrypt the system files. Some directories and file extensions are excluded to avoid rendering the system unusable. Once done with the encryption another http packet is sent to the same server this time to the url “http://217.8.117[.]26/gatedrivers”. Lastly, the wallpaper of the system is changed and the ransom notes are dropped in the form of hta scripts with the name convention “&lt;extension&gt;-decrypt.hta”. In these notes we can find the instructions to recover the system that consist of the urls “http://217.8.117[.]26/pay”. “http://4dnd3utjsmm2zcsb[.]onion/pay”, and the “Authorization Key”.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 1100w, https://miro.medium.com/v2/resize:fit:1046/format:webp/1*hBy-J9kLjBQvUcphjvMAEg.png 1046w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*hBy-J9kLjBQvUcphjvMAEg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*hBy-J9kLjBQvUcphjvMAEg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*hBy-J9kLjBQvUcphjvMAEg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*hBy-J9kLjBQvUcphjvMAEg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*hBy-J9kLjBQvUcphjvMAEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*hBy-J9kLjBQvUcphjvMAEg.png 1100w, https://miro.medium.com/v2/resize:fit:1046/1*hBy-J9kLjBQvUcphjvMAEg.png 1046w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px"/><img alt="" class="bh ln os c" width="523" height="147" loading="lazy" role="presentation"/></picture></div><figcaption class="ot ff ou oj ok ov ow bf b bg z du">Exorcist Ransom Note</figcaption></figure><p id="a6f5" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">This information will be needed to “sign in” the payment portal shown in the following screenshot:</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ox"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 1100w, https://miro.medium.com/v2/resize:fit:928/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 928w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 464px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KxnGPBxfs0kuOq4dCVasyg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KxnGPBxfs0kuOq4dCVasyg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KxnGPBxfs0kuOq4dCVasyg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KxnGPBxfs0kuOq4dCVasyg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KxnGPBxfs0kuOq4dCVasyg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KxnGPBxfs0kuOq4dCVasyg.png 1100w, https://miro.medium.com/v2/resize:fit:928/1*KxnGPBxfs0kuOq4dCVasyg.png 928w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 464px"/><img alt="" class="bh ln os c" width="464" height="424" loading="lazy" role="presentation"/></picture></div></figure><p id="43bb" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">For the IOCs go to the bottom of the page =D</p><h1 id="7fc2" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Exorcist Ransomware Triaging</h1><p id="0b94" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">Once the payload is extracted (base64 encoded) from the powershell loader, we get a PE32 executable. From a quick scan of the file using <a class="af oh" href="https://github.com/CybercentreCanada/assemblyline-core" rel="noopener ugc nofollow" target="_blank">Assemblyline</a> we get the following interesting insights:</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok pd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Z4nJ_Acr9ZIVo3q0dt6l-w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="262" loading="eager" role="presentation"/></picture></div></div></figure><figure class="le or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*pYpQIRdh9QPyZf7HV-pX4w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*pYpQIRdh9QPyZf7HV-pX4w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*pYpQIRdh9QPyZf7HV-pX4w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*pYpQIRdh9QPyZf7HV-pX4w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*pYpQIRdh9QPyZf7HV-pX4w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*pYpQIRdh9QPyZf7HV-pX4w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*pYpQIRdh9QPyZf7HV-pX4w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*pYpQIRdh9QPyZf7HV-pX4w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="308" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="cb0b" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">So at a first glance we can see that there are some well known executable names extracted, normally seen in ransomware and coin miners either to prevent processes from allowing access to files that will be encrypted or to free resources to mine more effectively.</p><p id="bd26" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Based on the API names extracted from the sample we can say it has some network capabilities as well as some cryptography ones. This is looking more and more like a ransomware!</p><p id="1fa1" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Lastly we see there is a url extracted from the sample “http://217.8.117[.]26/pay”. If we check what we found on that website (in a secure manner ;) ) we find the following:</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ox"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 1100w, https://miro.medium.com/v2/resize:fit:928/format:webp/1*KxnGPBxfs0kuOq4dCVasyg.png 928w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 464px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KxnGPBxfs0kuOq4dCVasyg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KxnGPBxfs0kuOq4dCVasyg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KxnGPBxfs0kuOq4dCVasyg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KxnGPBxfs0kuOq4dCVasyg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KxnGPBxfs0kuOq4dCVasyg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KxnGPBxfs0kuOq4dCVasyg.png 1100w, https://miro.medium.com/v2/resize:fit:928/1*KxnGPBxfs0kuOq4dCVasyg.png 928w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 464px"/><img alt="" class="bh ln os c" width="464" height="424" loading="eager" role="presentation"/></picture></div></figure><p id="11eb" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Our suspicion was correct, it was ransomware after all!! But what else does this ransomware do? Let’s take a look at its capabilities using the newest tool from <a class="af oh" href="https://github.com/fireeye/capa" rel="noopener ugc nofollow" target="_blank">Fireeye capa</a>.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok pl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 1100w, https://miro.medium.com/v2/resize:fit:1398/format:webp/1*g7w6BtkKQvjT4IQR0nL1Pw.png 1398w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 699px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*g7w6BtkKQvjT4IQR0nL1Pw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*g7w6BtkKQvjT4IQR0nL1Pw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*g7w6BtkKQvjT4IQR0nL1Pw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*g7w6BtkKQvjT4IQR0nL1Pw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*g7w6BtkKQvjT4IQR0nL1Pw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*g7w6BtkKQvjT4IQR0nL1Pw.png 1100w, https://miro.medium.com/v2/resize:fit:1398/1*g7w6BtkKQvjT4IQR0nL1Pw.png 1398w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 699px"/><img alt="" class="bh ln os c" width="699" height="811" loading="lazy" role="presentation"/></picture></div></div></figure><p id="ed16" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">So, it seems that indeed this ransomware sends data via http and executes some tricks to check the system to not run on the wrong country ;). Now we are ready for a more serious deep dive!</p><h1 id="6310" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Exorcist Ransomware Deep Dive</h1><p id="9f30" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">Now it is time to get into the details of this malware. First we are going to take a look at the file from a static point of view by analysing its strings, API calls, and code. And then to complete our analysis and better understand the inner workings of the malware we are going to study it from a dynamic point of view.</p><h2 id="90b5" class="pm mh gu bf mi pn po dy mm pp pq ea mq np pr ps pt nt pu pv pw nx px py pz qa bk">Static analysis</h2><p id="92d7" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">Loading the executable on PEstudio helps us to confirm some of the hypothesis we made during the triage and also shows us some interesting aspect of the sample that we haven’t seen so far.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*X3XKGIbMbtqJFExK4dii-A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*X3XKGIbMbtqJFExK4dii-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*X3XKGIbMbtqJFExK4dii-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*X3XKGIbMbtqJFExK4dii-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*X3XKGIbMbtqJFExK4dii-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*X3XKGIbMbtqJFExK4dii-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*X3XKGIbMbtqJFExK4dii-A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*X3XKGIbMbtqJFExK4dii-A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="482" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><div class="ab ke"><figure class="le or qc qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 1100w, https://miro.medium.com/v2/resize:fit:1156/format:webp/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 1156w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 578px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 1100w, https://miro.medium.com/v2/resize:fit:1156/1*dKoyG-nd6Mo-_Ut-VSIcXw.png 1156w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 578px"/><img alt="" class="bh ln os c" width="578" height="1029" loading="eager" role="presentation"/></picture></div></figure><figure class="le or qf qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 1100w, https://miro.medium.com/v2/resize:fit:846/format:webp/1*HoyfZy0lvKTuFIGXyWIWHA.png 846w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 423px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*HoyfZy0lvKTuFIGXyWIWHA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*HoyfZy0lvKTuFIGXyWIWHA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*HoyfZy0lvKTuFIGXyWIWHA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*HoyfZy0lvKTuFIGXyWIWHA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*HoyfZy0lvKTuFIGXyWIWHA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*HoyfZy0lvKTuFIGXyWIWHA.png 1100w, https://miro.medium.com/v2/resize:fit:846/1*HoyfZy0lvKTuFIGXyWIWHA.png 846w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 423px"/><img alt="" class="bh ln os c" width="423" height="1009" loading="eager" role="presentation"/></picture></div></figure></div></div></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="le or pe pf paragraph-image"><div class="oj ok qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 1100w, https://miro.medium.com/v2/resize:fit:1700/format:webp/1*1cL058CaRDqLcvT64u3ktg.png 1700w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 850px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*1cL058CaRDqLcvT64u3ktg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1cL058CaRDqLcvT64u3ktg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1cL058CaRDqLcvT64u3ktg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1cL058CaRDqLcvT64u3ktg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1cL058CaRDqLcvT64u3ktg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1cL058CaRDqLcvT64u3ktg.png 1100w, https://miro.medium.com/v2/resize:fit:1700/1*1cL058CaRDqLcvT64u3ktg.png 1700w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 850px"/><img alt="" class="bh ln os c" width="850" height="301" loading="eager" role="presentation"/></picture></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="19e9" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">So, some quick takeaways from the analysis so far:</p><ol class=""><li id="8ea2" class="ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob qh qi qj bk">Samples does not obfuscate strings.</li><li id="7839" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob qh qi qj bk">It will exclude given directories and files with the extensions shown above to not render the system unusable.</li><li id="407f" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob qh qi qj bk">As expected, the ransomware will get rid of the Shadow copies of the files to avoid the easy restoring of files.</li><li id="3501" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob qh qi qj bk">It most likely will attempt to stop processes in a predefined list.</li></ol><p id="8743" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Let’s get our hands dirty and look at the code to discover some more capabilities of this ransomware. For this we are going to load the sample to the free version of IDA.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 1100w, https://miro.medium.com/v2/resize:fit:1070/format:webp/1*cBFeafPEa8JlI1LLxxcdZg.png 1070w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 535px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cBFeafPEa8JlI1LLxxcdZg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cBFeafPEa8JlI1LLxxcdZg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cBFeafPEa8JlI1LLxxcdZg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cBFeafPEa8JlI1LLxxcdZg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cBFeafPEa8JlI1LLxxcdZg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cBFeafPEa8JlI1LLxxcdZg.png 1100w, https://miro.medium.com/v2/resize:fit:1070/1*cBFeafPEa8JlI1LLxxcdZg.png 1070w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 535px"/><img alt="" class="bh ln os c" width="535" height="869" loading="lazy" role="presentation"/></picture></div></figure><p id="2e23" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">So, one of the first thing is does is creating a mutex to avoid running multiple times on the system. Let’s check what else we find next to the hardcoded mutex string.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok ol"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 1100w, https://miro.medium.com/v2/resize:fit:1046/format:webp/1*GihLTvbjkzA3wROhlQRoFw.png 1046w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*GihLTvbjkzA3wROhlQRoFw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GihLTvbjkzA3wROhlQRoFw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GihLTvbjkzA3wROhlQRoFw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GihLTvbjkzA3wROhlQRoFw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GihLTvbjkzA3wROhlQRoFw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GihLTvbjkzA3wROhlQRoFw.png 1100w, https://miro.medium.com/v2/resize:fit:1046/1*GihLTvbjkzA3wROhlQRoFw.png 1046w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 523px"/><img alt="" class="bh ln os c" width="523" height="751" loading="lazy" role="presentation"/></picture></div></figure><p id="dfd4" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Here we can see some interesting strings that we have overlooked before. Seems that there are some countries listed that are most likely used together with the “get keyboard layout” capability seen before to decide if this sample should run or quit. Let’s confirm this theory!</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><div class="om on oo op oq ab ke"><figure class="le or qq qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 1100w, https://miro.medium.com/v2/resize:fit:1130/format:webp/1*iobxUma6o1zoCK6Ry4a7hw.png 1130w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 565px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*iobxUma6o1zoCK6Ry4a7hw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*iobxUma6o1zoCK6Ry4a7hw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*iobxUma6o1zoCK6Ry4a7hw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*iobxUma6o1zoCK6Ry4a7hw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*iobxUma6o1zoCK6Ry4a7hw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*iobxUma6o1zoCK6Ry4a7hw.png 1100w, https://miro.medium.com/v2/resize:fit:1130/1*iobxUma6o1zoCK6Ry4a7hw.png 1130w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 565px"/><img alt="" class="bh ln os c" width="565" height="710" loading="eager" role="presentation"/></picture></div></figure><figure class="le or qr qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 1100w, https://miro.medium.com/v2/resize:fit:872/format:webp/1*5hGzNQTDMFK3joraZdfrsA.png 872w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 436px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5hGzNQTDMFK3joraZdfrsA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5hGzNQTDMFK3joraZdfrsA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5hGzNQTDMFK3joraZdfrsA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5hGzNQTDMFK3joraZdfrsA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5hGzNQTDMFK3joraZdfrsA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5hGzNQTDMFK3joraZdfrsA.png 1100w, https://miro.medium.com/v2/resize:fit:872/1*5hGzNQTDMFK3joraZdfrsA.png 872w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 436px"/><img alt="" class="bh ln os c" width="436" height="828" loading="eager" role="presentation"/></picture></div></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="f861" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">The Ransomware uses the API “<a class="af oh" href="https://docs.microsoft.com/en-us/windows/win32/api/winnls/nf-winnls-getlocaleinfoa" rel="noopener ugc nofollow" target="_blank">GetLocaleInfo</a>” and “<a class="af oh" href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutlist" rel="noopener ugc nofollow" target="_blank">GetKeyboardLayoutList</a>” to determine the geo location of the system and check if it should continue running or not. Let’s verify another hypothesis we had. Does the ransomware kill the processes displayed in the strings before start encrypting? For this we are going to pivot from the un-obfuscated strings to the code.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 1100w, https://miro.medium.com/v2/resize:fit:1252/format:webp/1*GdLjdPio10lZi3XDy-ap3g.png 1252w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 626px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*GdLjdPio10lZi3XDy-ap3g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*GdLjdPio10lZi3XDy-ap3g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*GdLjdPio10lZi3XDy-ap3g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*GdLjdPio10lZi3XDy-ap3g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*GdLjdPio10lZi3XDy-ap3g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*GdLjdPio10lZi3XDy-ap3g.png 1100w, https://miro.medium.com/v2/resize:fit:1252/1*GdLjdPio10lZi3XDy-ap3g.png 1252w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 626px"/><img alt="" class="bh ln os c" width="626" height="407" loading="eager" role="presentation"/></picture></div></figure><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qt"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 1100w, https://miro.medium.com/v2/resize:fit:1366/format:webp/1*IIh2DpAODnP57ym8_49-fg.png 1366w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 683px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*IIh2DpAODnP57ym8_49-fg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*IIh2DpAODnP57ym8_49-fg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*IIh2DpAODnP57ym8_49-fg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*IIh2DpAODnP57ym8_49-fg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*IIh2DpAODnP57ym8_49-fg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*IIh2DpAODnP57ym8_49-fg.png 1100w, https://miro.medium.com/v2/resize:fit:1366/1*IIh2DpAODnP57ym8_49-fg.png 1366w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 683px"/><img alt="" class="bh ln os c" width="683" height="841" loading="eager" role="presentation"/></picture></div></figure><p id="d013" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">From analysing the routine we see that it is divided in two main sections, the first one running a set of predefined commands to disabled and remove shadow copies and backups, and a second one that goes through the list of processes and calls “taskkill” for each of them.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><div class="om on oo op oq ab ke"><figure class="le or qu qd pe pf qe paragraph-image"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 1100w, https://miro.medium.com/v2/resize:fit:816/format:webp/1*7-qRngHz4cuZlevT_fm6VQ.png 816w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 408px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7-qRngHz4cuZlevT_fm6VQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7-qRngHz4cuZlevT_fm6VQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7-qRngHz4cuZlevT_fm6VQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7-qRngHz4cuZlevT_fm6VQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7-qRngHz4cuZlevT_fm6VQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7-qRngHz4cuZlevT_fm6VQ.png 1100w, https://miro.medium.com/v2/resize:fit:816/1*7-qRngHz4cuZlevT_fm6VQ.png 816w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 408px"/><img alt="" class="bh ln os c" width="408" height="393" loading="eager" role="presentation"/></picture></figure><figure class="le or qv qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 1100w, https://miro.medium.com/v2/resize:fit:940/format:webp/1*t-btJ6IB83ziWvtPVSJ3PA.png 940w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 470px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*t-btJ6IB83ziWvtPVSJ3PA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*t-btJ6IB83ziWvtPVSJ3PA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*t-btJ6IB83ziWvtPVSJ3PA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*t-btJ6IB83ziWvtPVSJ3PA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*t-btJ6IB83ziWvtPVSJ3PA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*t-btJ6IB83ziWvtPVSJ3PA.png 1100w, https://miro.medium.com/v2/resize:fit:940/1*t-btJ6IB83ziWvtPVSJ3PA.png 940w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 470px"/><img alt="" class="bh ln os c" width="470" height="650" loading="eager" role="presentation"/></picture></div></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="1091" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Another way to browse through the code is to use the IDA feature Xref from graph. This can be done because the sample is not obfuscated, and the windows API calls are been referred explicitly. Using this tool we can guide our analysis following the Windows API calls of interest</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*lMWlhWZHesiWej20bUgSBA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*lMWlhWZHesiWej20bUgSBA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*lMWlhWZHesiWej20bUgSBA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*lMWlhWZHesiWej20bUgSBA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*lMWlhWZHesiWej20bUgSBA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*lMWlhWZHesiWej20bUgSBA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*lMWlhWZHesiWej20bUgSBA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*lMWlhWZHesiWej20bUgSBA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="176" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="5a19" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Well…I said we could use it, not that it was small nor easy ;). However, if we zoom into it, we can have a good understating of the different functions and have a gist of their purpose. For example:</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok qx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*3MJFSJu9AH3lcVwc_NS8fQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3MJFSJu9AH3lcVwc_NS8fQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3MJFSJu9AH3lcVwc_NS8fQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3MJFSJu9AH3lcVwc_NS8fQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3MJFSJu9AH3lcVwc_NS8fQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3MJFSJu9AH3lcVwc_NS8fQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3MJFSJu9AH3lcVwc_NS8fQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*3MJFSJu9AH3lcVwc_NS8fQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="151" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="1fbc" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Here we see the “ShellExecuteW ”API call (always interesting to see what the sample might try to execute) that is called right before exiting. If we go where it is called, we end up in the following routine :</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok qy"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 1100w, https://miro.medium.com/v2/resize:fit:1066/format:webp/1*u07LKeWPZyJ7S8zWGh3_4g.png 1066w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 533px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*u07LKeWPZyJ7S8zWGh3_4g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*u07LKeWPZyJ7S8zWGh3_4g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*u07LKeWPZyJ7S8zWGh3_4g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*u07LKeWPZyJ7S8zWGh3_4g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*u07LKeWPZyJ7S8zWGh3_4g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*u07LKeWPZyJ7S8zWGh3_4g.png 1100w, https://miro.medium.com/v2/resize:fit:1066/1*u07LKeWPZyJ7S8zWGh3_4g.png 1066w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 533px"/><img alt="" class="bh ln os c" width="533" height="659" loading="eager" role="presentation"/></picture></div></figure><p id="eba7" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">The routine consists of calling the API “<a class="af oh" href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamea" rel="noopener ugc nofollow" target="_blank">GetModuleFileName</a>” with “hmodule” Null to get the path of the executable file of the current process. Then, it prepares a command line that would look like <strong class="ng gv"><em class="oi">“cmd.exe open &lt;executable path&gt; /C timeout /T /NOBREAK &amp;&amp; del” &lt;executable path&gt;\” /F”,</em></strong> execute the command and then exits.</p><p id="4852" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">By looking at the XRef graph we also notice some classic Windows API calls used to send http packets over the network. If we follow the references we find the following routine :</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok qz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CYmaT_Nc2rfxfw9-vxIrrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CYmaT_Nc2rfxfw9-vxIrrg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CYmaT_Nc2rfxfw9-vxIrrg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CYmaT_Nc2rfxfw9-vxIrrg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CYmaT_Nc2rfxfw9-vxIrrg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CYmaT_Nc2rfxfw9-vxIrrg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CYmaT_Nc2rfxfw9-vxIrrg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CYmaT_Nc2rfxfw9-vxIrrg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln os c" width="700" height="761" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok ra"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ff-c0OPqVld0ckfm9w1L6g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ff-c0OPqVld0ckfm9w1L6g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ff-c0OPqVld0ckfm9w1L6g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ff-c0OPqVld0ckfm9w1L6g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ff-c0OPqVld0ckfm9w1L6g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ff-c0OPqVld0ckfm9w1L6g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ff-c0OPqVld0ckfm9w1L6g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ff-c0OPqVld0ckfm9w1L6g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln os c" width="700" height="705" loading="lazy" role="presentation"/></picture></div></div></figure><p id="83c8" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">By exploring this routine, we see that a post request is done. But now the question is what information is been sent. In the next section we are going to find out exactly what is been sent via the post http request.</p><p id="fdf1" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">In order to fast forward the analysis, confirm some hypothesis, and discover new functionality, we will start the sample in the <a class="af oh" href="https://x64dbg.com/#start" rel="noopener ugc nofollow" target="_blank">x32/64 debugger</a> while having <a class="af oh" href="https://docs.microsoft.com/en-us/sysinternals/downloads/procmon" rel="noopener ugc nofollow" target="_blank">Procmon</a> and <a class="af oh" href="https://github.com/fireeye/flare-fakenet-ng" rel="noopener ugc nofollow" target="_blank">FakeNet</a> running next to it to get more insights.</p><h2 id="125f" class="pm mh gu bf mi pn po dy mm pp pq ea mq np pr ps pt nt pu pv pw nx px py pz qa bk">Dynamic analysis</h2><p id="7b10" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">Now that our ransomware is running in a controlled environment we can see in more details how the different commands and processes are been killed by it.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*RLDjlN1ZLskCeymHgHyxiw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RLDjlN1ZLskCeymHgHyxiw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RLDjlN1ZLskCeymHgHyxiw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RLDjlN1ZLskCeymHgHyxiw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RLDjlN1ZLskCeymHgHyxiw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RLDjlN1ZLskCeymHgHyxiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RLDjlN1ZLskCeymHgHyxiw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*RLDjlN1ZLskCeymHgHyxiw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="426" loading="eager" role="presentation"/></picture></div></div></figure><figure class="le or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8de0jutRd5fvER-OxZPYew.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8de0jutRd5fvER-OxZPYew.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8de0jutRd5fvER-OxZPYew.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8de0jutRd5fvER-OxZPYew.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8de0jutRd5fvER-OxZPYew.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8de0jutRd5fvER-OxZPYew.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8de0jutRd5fvER-OxZPYew.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8de0jutRd5fvER-OxZPYew.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8de0jutRd5fvER-OxZPYew.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8de0jutRd5fvER-OxZPYew.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8de0jutRd5fvER-OxZPYew.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8de0jutRd5fvER-OxZPYew.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8de0jutRd5fvER-OxZPYew.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*8de0jutRd5fvER-OxZPYew.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="196" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="690d" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Let’s continue where we left trying to understand what is sent to the server over an http post request. In the following screenshot we can see how the IP and Port are decoded from the string stored in the “.rdata” section of the executable.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*sfQGSzC_0_PQDlw2oHSyWQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*sfQGSzC_0_PQDlw2oHSyWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sfQGSzC_0_PQDlw2oHSyWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sfQGSzC_0_PQDlw2oHSyWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sfQGSzC_0_PQDlw2oHSyWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sfQGSzC_0_PQDlw2oHSyWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sfQGSzC_0_PQDlw2oHSyWQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*sfQGSzC_0_PQDlw2oHSyWQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="323" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="0818" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Once it has that information the malware will start preparing the request. This means setting up the headers and the content that will be sent. Once done it will call the API call “HttpSendRequest” to send the http request. Using FakeNet we received that request and respond with a fake site to emulate the “C2”.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok re"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ZVwghTRFBB6dvoTxHQmag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-ZVwghTRFBB6dvoTxHQmag.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-ZVwghTRFBB6dvoTxHQmag.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-ZVwghTRFBB6dvoTxHQmag.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-ZVwghTRFBB6dvoTxHQmag.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-ZVwghTRFBB6dvoTxHQmag.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-ZVwghTRFBB6dvoTxHQmag.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-ZVwghTRFBB6dvoTxHQmag.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln os c" width="700" height="662" loading="eager" role="presentation"/></picture></div></div></figure><p id="85ab" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">As the picture shows the ransomware sends a big blob encoded in base64 to the c2 server at “http://217.8.117[.]26/gateinfo”. But where is this information coming from? For this we need to go back to the code an analyse what happened so far.</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok rf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 1100w, https://miro.medium.com/v2/resize:fit:1128/format:webp/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 1128w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 564px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 1100w, https://miro.medium.com/v2/resize:fit:1128/1*l1ZY5Gl4ASgDrKPOIQjL5Q.png 1128w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 564px"/><img alt="" class="bh ln os c" width="564" height="1069" loading="lazy" role="presentation"/></picture></div></figure><p id="8980" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">In this function we see that there is a template for a json file were some details about the system are gathered and later appended to the json temple string. Examples of details that are gathered include but are not limited to:</p><ul class=""><li id="6b0e" class="ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob rg qi qj bk">GetCurrentHwProfileA</li><li id="6cfb" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob rg qi qj bk">Gen_token (some crypto API calls are involved)</li><li id="7a07" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob rg qi qj bk">Query the registry key “<em class="oi">SOFTWARE\Microsoft\Windows NT\CurrentVersion</em>”</li><li id="f3b7" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob rg qi qj bk">GetUsername</li><li id="2d5b" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob rg qi qj bk">GetComputername</li><li id="b40d" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob rg qi qj bk">GetLocale</li><li id="3df0" class="ne nf gu ng b nh qk nj nk nl ql nn no np qm nr ns nt qn nv nw nx qo nz oa ob rg qi qj bk">Etc.</li></ul><p id="8658" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Once it finished querying the system it generates a json that looks as follows:</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*CCqdy0s44cnG28zNlmEWow.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CCqdy0s44cnG28zNlmEWow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CCqdy0s44cnG28zNlmEWow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CCqdy0s44cnG28zNlmEWow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CCqdy0s44cnG28zNlmEWow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CCqdy0s44cnG28zNlmEWow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CCqdy0s44cnG28zNlmEWow.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*CCqdy0s44cnG28zNlmEWow.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="261" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="57f2" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">After the information is gathered, we see that some encryption is initialised (creating encryption keys, specifying algorithms, etc) but some of the information used is queried from a file that was written in “%temp%\\boot.sys” in an earlier stage. The most interesting aspect of this, is that the information is not read from the file itself, instead it queries the file using the convention “filename.ext:string”. This means that this ransomware is using <a class="af oh" href="https://www.howtogeek.com/howto/windows-vista/stupid-geek-tricks-hide-data-in-a-secret-text-file-compartment/" rel="noopener ugc nofollow" target="_blank">Alternate Data Streams</a> to hide information. Using the <a class="af oh" href="https://www.bleepingcomputer.com/download/ads-spy/" rel="noopener ugc nofollow" target="_blank">ADS-spy</a> tool we can inspect the content that is been read by the malware.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><div class="om on oo op oq ab ke"><figure class="le or ri qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 1100w, https://miro.medium.com/v2/resize:fit:1120/format:webp/1*G8-jHRCwy_tZTStsV8utSw.png 1120w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 560px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*G8-jHRCwy_tZTStsV8utSw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*G8-jHRCwy_tZTStsV8utSw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*G8-jHRCwy_tZTStsV8utSw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*G8-jHRCwy_tZTStsV8utSw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*G8-jHRCwy_tZTStsV8utSw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*G8-jHRCwy_tZTStsV8utSw.png 1100w, https://miro.medium.com/v2/resize:fit:1120/1*G8-jHRCwy_tZTStsV8utSw.png 1120w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 560px"/><img alt="" class="bh ln os c" width="560" height="581" loading="eager" role="presentation"/></picture></div></figure><figure class="le or rj qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 1100w, https://miro.medium.com/v2/resize:fit:882/format:webp/1*jBiM3vSUakzxUbG_fZdBGQ.png 882w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 441px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*jBiM3vSUakzxUbG_fZdBGQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*jBiM3vSUakzxUbG_fZdBGQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*jBiM3vSUakzxUbG_fZdBGQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*jBiM3vSUakzxUbG_fZdBGQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*jBiM3vSUakzxUbG_fZdBGQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*jBiM3vSUakzxUbG_fZdBGQ.png 1100w, https://miro.medium.com/v2/resize:fit:882/1*jBiM3vSUakzxUbG_fZdBGQ.png 882w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 441px"/><img alt="" class="bh ln os c" width="441" height="603" loading="eager" role="presentation"/></picture></div></figure></div><div class="ab ke"><figure class="le or rk qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 1100w, https://miro.medium.com/v2/resize:fit:1006/format:webp/1*DsD9s-t-2lGpInhiDySnIA.png 1006w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 503px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*DsD9s-t-2lGpInhiDySnIA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*DsD9s-t-2lGpInhiDySnIA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*DsD9s-t-2lGpInhiDySnIA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*DsD9s-t-2lGpInhiDySnIA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*DsD9s-t-2lGpInhiDySnIA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*DsD9s-t-2lGpInhiDySnIA.png 1100w, https://miro.medium.com/v2/resize:fit:1006/1*DsD9s-t-2lGpInhiDySnIA.png 1006w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 503px"/><img alt="" class="bh ln os c" width="503" height="580" loading="eager" role="presentation"/></picture></div></figure><figure class="le or rl qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 1100w, https://miro.medium.com/v2/resize:fit:996/format:webp/1*V1h0N02EEjW52oSKNQ00uQ.png 996w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 498px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*V1h0N02EEjW52oSKNQ00uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*V1h0N02EEjW52oSKNQ00uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*V1h0N02EEjW52oSKNQ00uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*V1h0N02EEjW52oSKNQ00uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*V1h0N02EEjW52oSKNQ00uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*V1h0N02EEjW52oSKNQ00uQ.png 1100w, https://miro.medium.com/v2/resize:fit:996/1*V1h0N02EEjW52oSKNQ00uQ.png 996w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 498px"/><img alt="" class="bh ln os c" width="498" height="564" loading="eager" role="presentation"/></picture></div></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="4cc5" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Hidden in this file we can find the generated unique extension, the RSApublic key, and the Private Session Key. Once these values are retrieved the encryption of the json string takes place.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><div class="om on oo op oq ab ke"><figure class="le or rm qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 1100w, https://miro.medium.com/v2/resize:fit:422/format:webp/1*VMjjOaKx4tLrYiCTNmle5g.png 422w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 211px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VMjjOaKx4tLrYiCTNmle5g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VMjjOaKx4tLrYiCTNmle5g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VMjjOaKx4tLrYiCTNmle5g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VMjjOaKx4tLrYiCTNmle5g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VMjjOaKx4tLrYiCTNmle5g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VMjjOaKx4tLrYiCTNmle5g.png 1100w, https://miro.medium.com/v2/resize:fit:422/1*VMjjOaKx4tLrYiCTNmle5g.png 422w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 211px"/><img alt="" class="bh ln os c" width="211" height="1619" loading="eager" role="presentation"/></picture></div></figure><figure class="le or rn qd pe pf qe paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 1100w, https://miro.medium.com/v2/resize:fit:1580/format:webp/1*O-3JMdMj4Ftq7CVyFg-myA.png 1580w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 790px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*O-3JMdMj4Ftq7CVyFg-myA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*O-3JMdMj4Ftq7CVyFg-myA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*O-3JMdMj4Ftq7CVyFg-myA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*O-3JMdMj4Ftq7CVyFg-myA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*O-3JMdMj4Ftq7CVyFg-myA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*O-3JMdMj4Ftq7CVyFg-myA.png 1100w, https://miro.medium.com/v2/resize:fit:1580/1*O-3JMdMj4Ftq7CVyFg-myA.png 1580w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 790px"/><img alt="" class="bh ln os c" width="790" height="830" loading="eager" role="presentation"/></picture></div></figure></div></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="92db" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">The json string is encrypted with AES CBC and the symmetric key encrypted the with the public RSA key. In the following screenshot we can see the json string in plaintext and then encrypted.</p></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok ro"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*v6e3s3CXC3o7Iw6aNc6Ahg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="321" loading="eager" role="presentation"/></picture></div></div></figure><figure class="le or pe pf paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*pXmaETAutmgogRWxoqcjFg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*pXmaETAutmgogRWxoqcjFg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*pXmaETAutmgogRWxoqcjFg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*pXmaETAutmgogRWxoqcjFg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*pXmaETAutmgogRWxoqcjFg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*pXmaETAutmgogRWxoqcjFg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*pXmaETAutmgogRWxoqcjFg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*pXmaETAutmgogRWxoqcjFg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln os c" width="1000" height="360" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="d977" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">After encryption, the json is base6 4encoded and then added to the http post request as already shown.</p><p id="2941" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">What about the file encryption? After all, this is a ransomware, right? So once the first beacon is sent to the server the ransomware starts the file encryption in a multithreaded fashion. This can be seen in the following screenshots:</p><figure class="om on oo op oq or oj ok paragraph-image"><div class="oj ok rq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 1100w, https://miro.medium.com/v2/resize:fit:1316/format:webp/1*wdFnQ3Gl6StLCBpDBk6o3w.png 1316w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 658px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wdFnQ3Gl6StLCBpDBk6o3w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wdFnQ3Gl6StLCBpDBk6o3w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wdFnQ3Gl6StLCBpDBk6o3w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wdFnQ3Gl6StLCBpDBk6o3w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wdFnQ3Gl6StLCBpDBk6o3w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wdFnQ3Gl6StLCBpDBk6o3w.png 1100w, https://miro.medium.com/v2/resize:fit:1316/1*wdFnQ3Gl6StLCBpDBk6o3w.png 1316w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 658px"/><img alt="" class="bh ln os c" width="658" height="637" loading="eager" role="presentation"/></picture></div></figure></div></div><div class="or"><div class="ab cb"><div class="li oy lj oz lk pa cf pb cg pc ci bh"><figure class="om on oo op oq or pe pf paragraph-image"><div class="oj ok qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1626/format:webp/1*Ekop4QfbCdrAZ2G6yigMwQ.png 1626w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 813px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Ekop4QfbCdrAZ2G6yigMwQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Ekop4QfbCdrAZ2G6yigMwQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Ekop4QfbCdrAZ2G6yigMwQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Ekop4QfbCdrAZ2G6yigMwQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Ekop4QfbCdrAZ2G6yigMwQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Ekop4QfbCdrAZ2G6yigMwQ.png 1100w, https://miro.medium.com/v2/resize:fit:1626/1*Ekop4QfbCdrAZ2G6yigMwQ.png 1626w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 813px"/><img alt="" class="bh ln os c" width="813" height="856" loading="eager" role="presentation"/></picture></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EwoKGwGEkKYuWK-Y_BR4Qg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln os c" width="700" height="512" loading="eager" role="presentation"/></picture></div></div></figure><p id="08a5" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">Once it finished it sends yet again another beacon with data to the server but this time to “<em class="oi">http://217.8.117[.]26/gatedrivers</em>”. In the following picture we can find an example of a ransom note that is left in every directory. The name convention for them is “&lt;extension&gt;-decrypt.hta”</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="pg ph fj pi bh pj"><div class="oj ok rs"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxN1U0_hMDjnHrz97RWBsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RxN1U0_hMDjnHrz97RWBsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RxN1U0_hMDjnHrz97RWBsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RxN1U0_hMDjnHrz97RWBsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RxN1U0_hMDjnHrz97RWBsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RxN1U0_hMDjnHrz97RWBsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RxN1U0_hMDjnHrz97RWBsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RxN1U0_hMDjnHrz97RWBsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln os c" width="700" height="197" loading="eager" role="presentation"/></picture></div></div></figure><p id="934a" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">So this will be all for now, there are quite some more interesting aspects to research into like how the file encryption is performed at a cryptographic level, how are some of the other interesting strings (powershell get host by address) used, does this ransomware implement persistence mechanisms, etc. Feel free to contact me for comments and questions. Constructive feedback is always welcomed!</p><h1 id="e8df" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">IOCs</h1><p id="5e79" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">Samples:</p><pre class="om on oo op oq rt ru rv rw ay rx bk"><span id="04e6" class="pm mh gu ru b ij ry rz l sa sb"><a class="af oh" href="https://bazaar.abuse.ch/sample/027d99aaaa6803a07d07ce0ba1fa66964388129d3b26dcf8621a3310692b0a61/" rel="noopener ugc nofollow" target="_blank">https://bazaar.abuse.ch/sample/027d99aaaa6803a07d07ce0ba1fa66964388129d3b26dcf8621a3310692b0a61/</a><br/>https://bazaar.abuse.ch/sample/a7e27cc38a39ff242da39d05e04b95ea9b656829dfe2e90e8226351da8813d7d/<br/>https://bazaar.abuse.ch/sample/8d684a790a5683b8decde9fb5a819c4a164d3032723a151a30ff26d3c2b1aabf/<br/>https://bazaar.abuse.ch/sample/bf6e5f9d060ebc5bb70144ca6e795bfc249c6590ab9f45e258ec9b5f3d49eeb6/<br/>https://bazaar.abuse.ch/sample/8da469200a4b3899b23a34232eec537f12c621aa3c8766a9745d8ff721ef5296/<br/>https://bazaar.abuse.ch/sample/b1bcc54ef15f91d9291357eca02862174bd6158e95813eff1ab0c16ba48ff10e/</span></pre><p id="a598" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">MD5:</p><pre class="om on oo op oq rt ru rv rw ay rx bk"><span id="0633" class="pm mh gu ru b ij ry rz l sa sb">79385ed97732aee0036e67824de18e28<br/>f4009abe9f41da41e48340c96e29d62c<br/>fa4c4ac8b9c1b14951ae8add855f34e8<br/>f188cf267d209a0209a25bda4bb75b86<br/>5a63e7d371dd69c5625f5b48da426c14<br/>cb3a1463f4fd3e74b8f1ca5e73b81816<br/>7e415d5a1b1235491cb698eb14817d31</span></pre><p id="ac26" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">SHA256:</p><pre class="om on oo op oq rt ru rv rw ay rx bk"><span id="1488" class="pm mh gu ru b ij ry rz l sa sb">8d684a790a5683b8decde9fb5a819c4a164d3032723a151a30ff26d3c2b1aabf<br/>6db3aae21a6d80857c85f58c4c8b2cf9c6b7f8b8a9ab1d5496d18eaf9bd0bd01<br/>bf6e5f9d060ebc5bb70144ca6e795bfc249c6590ab9f45e258ec9b5f3d49eeb6<br/>027d99aaaa6803a07d07ce0ba1fa66964388129d3b26dcf8621a3310692b0a61<br/>b1bcc54ef15f91d9291357eca02862174bd6158e95813eff1ab0c16ba48ff10e<br/>8da469200a4b3899b23a34232eec537f12c621aa3c8766a9745d8ff721ef5296<br/>a7e27cc38a39ff242da39d05e04b95ea9b656829dfe2e90e8226351da8813d7d</span></pre><p id="f237" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">URLs:</p><pre class="om on oo op oq rt ru rv rw ay rx bk"><span id="c8c9" class="pm mh gu ru b ij ry rz l sa sb">http://217.8.117[.]26/pay<br/>http://217.8.117[.]26/gateinfo<br/>http://217.8.117[.]26/gatedrivers<br/>http://4dnd3utjsmm2zcsb[.]onion/pay</span></pre><p id="8a7d" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk">IPs:</p><pre class="om on oo op oq rt ru rv rw ay rx bk"><span id="ad89" class="pm mh gu ru b ij ry rz l sa sb">217.8.117[.]26</span></pre><p id="9826" class="pw-post-body-paragraph ne nf gu ng b nh oc nj nk nl od nn no np oe nr ns nt of nv nw nx og nz oa ob gn bk"><a class="af oh" href="https://tria.ge" rel="noopener ugc nofollow" target="_blank">Tria.ge </a>Sandbox reports:</p><pre class="om on oo op oq rt ru rv rw ay rx bk"><span id="fef9" class="pm mh gu ru b ij ry rz l sa sb">https://tria.ge/reports/200724-gmz55kbvr2/behavioral1<br/>https://tria.ge/reports/200724-2v2mzfsjwx/behavioral1<br/>https://tria.ge/reports/200724-kfjg2xf1b2/behavioral1<br/>https://tria.ge/reports/200724-64rls1gjl2/behavioral1<br/>https://tria.ge/reports/200724-b5zwteacds/behavioral1<br/>https://tria.ge/reports/200724-15z7parj4x/behavioral1<br/>https://tria.ge/reports/200724-zxydprrjys/behavioral1</span></pre><h1 id="d000" class="mg mh gu bf mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Acknowledgements:</h1><p id="5128" class="pw-post-body-paragraph ne nf gu ng b nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob gn bk">Special thanks to @<a class="af oh" href="https://twitter.com/rikvduijn" rel="noopener ugc nofollow" target="_blank">rikvduijn</a> and <a class="af oh" href="https://twitter.com/ValthekOn" rel="noopener ugc nofollow" target="_blank">@ValthekOn</a> for helping me figure some of the details out and my team at <a class="af oh" href="https://twitter.com/kpnsecurity" rel="noopener ugc nofollow" target="_blank">@</a>k<a class="af oh" href="https://twitter.com/kpnsecurity" rel="noopener ugc nofollow" target="_blank">pnsecurity</a> for supporting my crazy projects and reviewing this writeup =D</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sc sd ab iv"><div class="se ab"><a class="sf ay am ao" rel="noopener follow" href="/tag/malware-analysis?source=post_page-----5b7da4263d81--------------------------------"><div class="sg fj cx sh ge si sj bf b bg z bk sk">Malware Analysis</div></a></div><div class="se ab"><a class="sf ay am ao" rel="noopener follow" href="/tag/ransomware?source=post_page-----5b7da4263d81--------------------------------"><div class="sg fj cx sh ge si sj bf b bg z bk sk">Ransomware</div></a></div><div class="se ab"><a class="sf ay am ao" rel="noopener follow" href="/tag/threat-intelligence?source=post_page-----5b7da4263d81--------------------------------"><div class="sg fj cx sh ge si sj bf b bg z bk sk">Threat Intelligence</div></a></div><div class="se ab"><a class="sf ay am ao" rel="noopener follow" href="/tag/infosec?source=post_page-----5b7da4263d81--------------------------------"><div class="sg fj cx sh ge si sj bf b bg z bk sk">Infosec</div></a></div><div class="se ab"><a class="sf ay am ao" rel="noopener follow" href="/tag/reverse-engineering?source=post_page-----5b7da4263d81--------------------------------"><div class="sg fj cx sh ge si sj bf b bg z bk sk">Reverse Engineering</div></a></div></div></div></div><div class="l"></div><footer class="sl sm sn so sp ab q sq sr c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp ss"><div class="ab q ke"><div class="st l"><span class="l su sv sw e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5b7da4263d81&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;user=Leandro+Velasco&amp;userId=2f8ddcaa989f&amp;source=---footer_actions--5b7da4263d81---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f sx sy"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F5b7da4263d81&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;user=Leandro+Velasco&amp;userId=2f8ddcaa989f&amp;source=---footer_actions--5b7da4263d81---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="sz l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F5b7da4263d81&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40velasco.l.n%2Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81&amp;source=---footer_actions--5b7da4263d81---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="sz l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="ta tb tc td te l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="tf bh r tg"></div><div class="ab th ti tj iu it"><div class="tk tl tm tn to tp tq tr ts tt ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@velasco.l.n?source=post_page---post_author_info--5b7da4263d81--------------------------------"><div class="l fj"><img alt="Leandro Velasco" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/0*v2tYxgdxbDzC0bNz.jpg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay tu"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@velasco.l.n?source=post_page---post_author_info--5b7da4263d81--------------------------------"><div class="l fj"><img alt="Leandro Velasco" class="l fd by tv tw cx" src="https://miro.medium.com/v2/resize:fill:128:128/0*v2tYxgdxbDzC0bNz.jpg" width="64" height="64" loading="lazy"/><div class="fr by l tv tw fs n ay tu"></div></div></a></div><div class="j i d tx is"><div class="ab"><span><button class="bf b bg z ty sg tz ua ub uc ud ev ew ue uf ug fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co uh"><div class="ui uj uk oz oy l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@velasco.l.n?source=post_page---post_author_info--5b7da4263d81--------------------------------"><h2 class="pw-author-name bf um un uo up uq ur us np ps pt nt pv pw nx py pz bk"><span class="gn ul">Written by <!-- -->Leandro Velasco</span></h2></a><div class="se ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@velasco.l.n/followers?source=post_page---post_author_info--5b7da4263d81--------------------------------">13 Followers</a></span></div><div class="bf b bg z du ab sa"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@velasco.l.n/following?source=post_page---post_author_info--5b7da4263d81--------------------------------">15 Following</a></div></div><div class="ut l"><p class="bf b bg z bk"><span class="gn">Malware Reversing | Programming | Engineering | OSCPing | Cooking | D&amp;D | Bouldering | Threat Intel Analyst @ KPN Security @LeandroNVelasco</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ty sg tz ua ub uc ud ev ew ue uf ug fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="uu l"><div class="tf bh r uv uw ux uy uz"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf um mj ml mm mn mp mq mr mt mu mv mx my mz nb nc bk">No responses yet</h2><div class="ab va"><div><div class="bm" aria-hidden="false"><a class="vb vc" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--5b7da4263d81--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="vd ve vf vg vh l"></div></div></div></div><div class="vi vj vk vl vm l bx"><div class="h k j"><div class="tf bh vn vo"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="vp ab ke iv"><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----5b7da4263d81--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----5b7da4263d81--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vq vr l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----5b7da4263d81--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----5b7da4263d81--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-5b7da4263d81","user-2f8ddcaa989f"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"fed9fe9e-9f13-4b29-88ba-37b5645ce143","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-80bd918e9157c2aa98f5a3b7219cee51-9d4e433b02d6e2ba-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@velasco.l.n\u002Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"5b7da4263d81\"})":{"__ref":"Post:5b7da4263d81"}},"LinkedAccounts:2f8ddcaa989f":{"__typename":"LinkedAccounts","mastodon":null,"id":"2f8ddcaa989f"},"User:2f8ddcaa989f":{"__typename":"User","id":"2f8ddcaa989f","linkedAccounts":{"__ref":"LinkedAccounts:2f8ddcaa989f"},"isSuspended":false,"name":"Leandro Velasco","imageId":"0*v2tYxgdxbDzC0bNz.jpg","customDomainState":null,"hasSubdomain":false,"username":"velasco.l.n","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":13,"followingCount":10,"collectionFollowingCount":5},"bio":"Malware Reversing | Programming | Engineering | OSCPing | Cooking | D&D | Bouldering | Threat Intel Analyst @ KPN Security @LeandroNVelasco","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:2f8ddcaa989f-viewerId:lo_b4be9b8b81f3"},"twitterScreenName":""},"Paragraph:1b9baa9d0849_0":{"__typename":"Paragraph","id":"1b9baa9d0849_0","name":"2c67","type":"H3","href":null,"layout":null,"metadata":null,"text":"Exorcist Ransomware — From triaging to deep dive","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_1":{"__typename":"Paragraph","id":"1b9baa9d0849_1","name":"a6bc","type":"H3","href":null,"layout":null,"metadata":null,"text":"TL;DR","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_2":{"__typename":"Paragraph","id":"1b9baa9d0849_2","name":"a095","type":"P","href":null,"layout":null,"metadata":null,"text":"On Monday 20th while hunting for some REvil samples I stumbled upon a newly introduced ransomware as a service called Exorcist. This ransomware is distributed via Pastebin embedded in a powershell script that loads it directly in memory. This script is based on “Invoke-ReflectivePEInjection.ps1” script by Joe Bialek (@JosephBialek), but it is optimised with an additional function to pass a base64 encoded executable to the main function. This powershell script is possibly generated using the Empire framework. The same technique is used by some of the Sodinokibi\u002FREvil affiliates, and in the past by Buran.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_3":{"__typename":"Paragraph","id":"1b9baa9d0849_3","name":"13d7","type":"P","href":null,"layout":null,"metadata":null,"text":"The ransomware is not obfuscated and the majority of the strings are in plaintext stored in the “.rdata” section of the executable. The first thing that the malware does is to check the geo location of the system using the language and the keyboard layout. If the results yield one of the Commonwealth of Independent States (CIS) it quits on the spot. Then the ransomware execute a series of commands to disable and remove backups and kill processes that might interfere with the system encryption. Once it is done with the commands, it writes to disk the RSA public key, the session private key and the extension. This information is not written into a file in a straightforward manner, instead it is written in different Alternate Data Streams on the file “%temp%\\\\boot.sys”.Then it extracts information from the system such as username, hostname, OS version, keyboard layout, etc. and sends them via http to the server “http:\u002F\u002F217.8.117[.]26\u002Fgateinfo”. Next it gets the amount of cpu on the systems and starts multiple threats to encrypt the system files. Some directories and file extensions are excluded to avoid rendering the system unusable. Once done with the encryption another http packet is sent to the same server this time to the url “http:\u002F\u002F217.8.117[.]26\u002Fgatedrivers”. Lastly, the wallpaper of the system is changed and the ransom notes are dropped in the form of hta scripts with the name convention “\u003Cextension\u003E-decrypt.hta”. In these notes we can find the instructions to recover the system that consist of the urls “http:\u002F\u002F217.8.117[.]26\u002Fpay”. “http:\u002F\u002F4dnd3utjsmm2zcsb[.]onion\u002Fpay”, and the “Authorization Key”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":723,"end":745,"href":"https:\u002F\u002Fwww.howtogeek.com\u002Fhowto\u002Fwindows-vista\u002Fstupid-geek-tricks-hide-data-in-a-secret-text-file-compartment\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":759,"end":777,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*hBy-J9kLjBQvUcphjvMAEg.png":{"__typename":"ImageMetadata","id":"1*hBy-J9kLjBQvUcphjvMAEg.png","originalHeight":147,"originalWidth":523,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_4":{"__typename":"Paragraph","id":"1b9baa9d0849_4","name":"84a8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hBy-J9kLjBQvUcphjvMAEg.png"},"text":"Exorcist Ransom Note","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_5":{"__typename":"Paragraph","id":"1b9baa9d0849_5","name":"a6f5","type":"P","href":null,"layout":null,"metadata":null,"text":"This information will be needed to “sign in” the payment portal shown in the following screenshot:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KxnGPBxfs0kuOq4dCVasyg.png":{"__typename":"ImageMetadata","id":"1*KxnGPBxfs0kuOq4dCVasyg.png","originalHeight":424,"originalWidth":464,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_6":{"__typename":"Paragraph","id":"1b9baa9d0849_6","name":"5a06","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KxnGPBxfs0kuOq4dCVasyg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_7":{"__typename":"Paragraph","id":"1b9baa9d0849_7","name":"43bb","type":"P","href":null,"layout":null,"metadata":null,"text":"For the IOCs go to the bottom of the page =D","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_8":{"__typename":"Paragraph","id":"1b9baa9d0849_8","name":"7fc2","type":"H3","href":null,"layout":null,"metadata":null,"text":"Exorcist Ransomware Triaging","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_9":{"__typename":"Paragraph","id":"1b9baa9d0849_9","name":"0b94","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the payload is extracted (base64 encoded) from the powershell loader, we get a PE32 executable. From a quick scan of the file using Assemblyline we get the following interesting insights:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":137,"end":149,"href":"https:\u002F\u002Fgithub.com\u002FCybercentreCanada\u002Fassemblyline-core","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Z4nJ_Acr9ZIVo3q0dt6l-w.png":{"__typename":"ImageMetadata","id":"1*Z4nJ_Acr9ZIVo3q0dt6l-w.png","originalHeight":434,"originalWidth":1658,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_10":{"__typename":"Paragraph","id":"1b9baa9d0849_10","name":"04fd","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Z4nJ_Acr9ZIVo3q0dt6l-w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*pYpQIRdh9QPyZf7HV-pX4w.png":{"__typename":"ImageMetadata","id":"1*pYpQIRdh9QPyZf7HV-pX4w.png","originalHeight":505,"originalWidth":1644,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_11":{"__typename":"Paragraph","id":"1b9baa9d0849_11","name":"c173","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*pYpQIRdh9QPyZf7HV-pX4w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_12":{"__typename":"Paragraph","id":"1b9baa9d0849_12","name":"cb0b","type":"P","href":null,"layout":null,"metadata":null,"text":"So at a first glance we can see that there are some well known executable names extracted, normally seen in ransomware and coin miners either to prevent processes from allowing access to files that will be encrypted or to free resources to mine more effectively.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_13":{"__typename":"Paragraph","id":"1b9baa9d0849_13","name":"bd26","type":"P","href":null,"layout":null,"metadata":null,"text":"Based on the API names extracted from the sample we can say it has some network capabilities as well as some cryptography ones. This is looking more and more like a ransomware!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_14":{"__typename":"Paragraph","id":"1b9baa9d0849_14","name":"1fa1","type":"P","href":null,"layout":null,"metadata":null,"text":"Lastly we see there is a url extracted from the sample “http:\u002F\u002F217.8.117[.]26\u002Fpay”. If we check what we found on that website (in a secure manner ;) ) we find the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_15":{"__typename":"Paragraph","id":"1b9baa9d0849_15","name":"162f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KxnGPBxfs0kuOq4dCVasyg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_16":{"__typename":"Paragraph","id":"1b9baa9d0849_16","name":"11eb","type":"P","href":null,"layout":null,"metadata":null,"text":"Our suspicion was correct, it was ransomware after all!! But what else does this ransomware do? Let’s take a look at its capabilities using the newest tool from Fireeye capa.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":161,"end":173,"href":"https:\u002F\u002Fgithub.com\u002Ffireeye\u002Fcapa","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*g7w6BtkKQvjT4IQR0nL1Pw.png":{"__typename":"ImageMetadata","id":"1*g7w6BtkKQvjT4IQR0nL1Pw.png","originalHeight":810,"originalWidth":699,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_17":{"__typename":"Paragraph","id":"1b9baa9d0849_17","name":"da55","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*g7w6BtkKQvjT4IQR0nL1Pw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_18":{"__typename":"Paragraph","id":"1b9baa9d0849_18","name":"ed16","type":"P","href":null,"layout":null,"metadata":null,"text":"So, it seems that indeed this ransomware sends data via http and executes some tricks to check the system to not run on the wrong country ;). Now we are ready for a more serious deep dive!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_19":{"__typename":"Paragraph","id":"1b9baa9d0849_19","name":"6310","type":"H3","href":null,"layout":null,"metadata":null,"text":"Exorcist Ransomware Deep Dive","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_20":{"__typename":"Paragraph","id":"1b9baa9d0849_20","name":"9f30","type":"P","href":null,"layout":null,"metadata":null,"text":"Now it is time to get into the details of this malware. First we are going to take a look at the file from a static point of view by analysing its strings, API calls, and code. And then to complete our analysis and better understand the inner workings of the malware we are going to study it from a dynamic point of view.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_21":{"__typename":"Paragraph","id":"1b9baa9d0849_21","name":"90b5","type":"H4","href":null,"layout":null,"metadata":null,"text":"Static analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_22":{"__typename":"Paragraph","id":"1b9baa9d0849_22","name":"92d7","type":"P","href":null,"layout":null,"metadata":null,"text":"Loading the executable on PEstudio helps us to confirm some of the hypothesis we made during the triage and also shows us some interesting aspect of the sample that we haven’t seen so far.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*X3XKGIbMbtqJFExK4dii-A.png":{"__typename":"ImageMetadata","id":"1*X3XKGIbMbtqJFExK4dii-A.png","originalHeight":589,"originalWidth":1222,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_23":{"__typename":"Paragraph","id":"1b9baa9d0849_23","name":"b5f0","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*X3XKGIbMbtqJFExK4dii-A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dKoyG-nd6Mo-_Ut-VSIcXw.png":{"__typename":"ImageMetadata","id":"1*dKoyG-nd6Mo-_Ut-VSIcXw.png","originalHeight":1029,"originalWidth":768,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_24":{"__typename":"Paragraph","id":"1b9baa9d0849_24","name":"9775","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*dKoyG-nd6Mo-_Ut-VSIcXw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*HoyfZy0lvKTuFIGXyWIWHA.png":{"__typename":"ImageMetadata","id":"1*HoyfZy0lvKTuFIGXyWIWHA.png","originalHeight":1009,"originalWidth":551,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_25":{"__typename":"Paragraph","id":"1b9baa9d0849_25","name":"4b5d","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*HoyfZy0lvKTuFIGXyWIWHA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*1cL058CaRDqLcvT64u3ktg.png":{"__typename":"ImageMetadata","id":"1*1cL058CaRDqLcvT64u3ktg.png","originalHeight":301,"originalWidth":850,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_26":{"__typename":"Paragraph","id":"1b9baa9d0849_26","name":"dcc1","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1cL058CaRDqLcvT64u3ktg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_27":{"__typename":"Paragraph","id":"1b9baa9d0849_27","name":"19e9","type":"P","href":null,"layout":null,"metadata":null,"text":"So, some quick takeaways from the analysis so far:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_28":{"__typename":"Paragraph","id":"1b9baa9d0849_28","name":"8ea2","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Samples does not obfuscate strings.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_29":{"__typename":"Paragraph","id":"1b9baa9d0849_29","name":"7839","type":"OLI","href":null,"layout":null,"metadata":null,"text":"It will exclude given directories and files with the extensions shown above to not render the system unusable.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_30":{"__typename":"Paragraph","id":"1b9baa9d0849_30","name":"407f","type":"OLI","href":null,"layout":null,"metadata":null,"text":"As expected, the ransomware will get rid of the Shadow copies of the files to avoid the easy restoring of files.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_31":{"__typename":"Paragraph","id":"1b9baa9d0849_31","name":"3501","type":"OLI","href":null,"layout":null,"metadata":null,"text":"It most likely will attempt to stop processes in a predefined list.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_32":{"__typename":"Paragraph","id":"1b9baa9d0849_32","name":"8743","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s get our hands dirty and look at the code to discover some more capabilities of this ransomware. For this we are going to load the sample to the free version of IDA.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cBFeafPEa8JlI1LLxxcdZg.png":{"__typename":"ImageMetadata","id":"1*cBFeafPEa8JlI1LLxxcdZg.png","originalHeight":869,"originalWidth":535,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_33":{"__typename":"Paragraph","id":"1b9baa9d0849_33","name":"e71a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cBFeafPEa8JlI1LLxxcdZg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_34":{"__typename":"Paragraph","id":"1b9baa9d0849_34","name":"2e23","type":"P","href":null,"layout":null,"metadata":null,"text":"So, one of the first thing is does is creating a mutex to avoid running multiple times on the system. Let’s check what else we find next to the hardcoded mutex string.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*GihLTvbjkzA3wROhlQRoFw.png":{"__typename":"ImageMetadata","id":"1*GihLTvbjkzA3wROhlQRoFw.png","originalHeight":751,"originalWidth":523,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_35":{"__typename":"Paragraph","id":"1b9baa9d0849_35","name":"1adc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*GihLTvbjkzA3wROhlQRoFw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_36":{"__typename":"Paragraph","id":"1b9baa9d0849_36","name":"dfd4","type":"P","href":null,"layout":null,"metadata":null,"text":"Here we can see some interesting strings that we have overlooked before. Seems that there are some countries listed that are most likely used together with the “get keyboard layout” capability seen before to decide if this sample should run or quit. Let’s confirm this theory!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*iobxUma6o1zoCK6Ry4a7hw.png":{"__typename":"ImageMetadata","id":"1*iobxUma6o1zoCK6Ry4a7hw.png","originalHeight":710,"originalWidth":569,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_37":{"__typename":"Paragraph","id":"1b9baa9d0849_37","name":"8007","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*iobxUma6o1zoCK6Ry4a7hw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5hGzNQTDMFK3joraZdfrsA.png":{"__typename":"ImageMetadata","id":"1*5hGzNQTDMFK3joraZdfrsA.png","originalHeight":828,"originalWidth":512,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_38":{"__typename":"Paragraph","id":"1b9baa9d0849_38","name":"ad83","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*5hGzNQTDMFK3joraZdfrsA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_39":{"__typename":"Paragraph","id":"1b9baa9d0849_39","name":"f861","type":"P","href":null,"layout":null,"metadata":null,"text":"The Ransomware uses the API “GetLocaleInfo” and “GetKeyboardLayoutList” to determine the geo location of the system and check if it should continue running or not. Let’s verify another hypothesis we had. Does the ransomware kill the processes displayed in the strings before start encrypting? For this we are going to pivot from the un-obfuscated strings to the code.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":29,"end":42,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fapi\u002Fwinnls\u002Fnf-winnls-getlocaleinfoa","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":49,"end":70,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fapi\u002Fwinuser\u002Fnf-winuser-getkeyboardlayoutlist","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*GdLjdPio10lZi3XDy-ap3g.png":{"__typename":"ImageMetadata","id":"1*GdLjdPio10lZi3XDy-ap3g.png","originalHeight":407,"originalWidth":626,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_40":{"__typename":"Paragraph","id":"1b9baa9d0849_40","name":"47ff","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*GdLjdPio10lZi3XDy-ap3g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*IIh2DpAODnP57ym8_49-fg.png":{"__typename":"ImageMetadata","id":"1*IIh2DpAODnP57ym8_49-fg.png","originalHeight":841,"originalWidth":683,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_41":{"__typename":"Paragraph","id":"1b9baa9d0849_41","name":"bc38","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IIh2DpAODnP57ym8_49-fg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_42":{"__typename":"Paragraph","id":"1b9baa9d0849_42","name":"d013","type":"P","href":null,"layout":null,"metadata":null,"text":"From analysing the routine we see that it is divided in two main sections, the first one running a set of predefined commands to disabled and remove shadow copies and backups, and a second one that goes through the list of processes and calls “taskkill” for each of them.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7-qRngHz4cuZlevT_fm6VQ.png":{"__typename":"ImageMetadata","id":"1*7-qRngHz4cuZlevT_fm6VQ.png","originalHeight":393,"originalWidth":408,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_43":{"__typename":"Paragraph","id":"1b9baa9d0849_43","name":"5c48","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*7-qRngHz4cuZlevT_fm6VQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*t-btJ6IB83ziWvtPVSJ3PA.png":{"__typename":"ImageMetadata","id":"1*t-btJ6IB83ziWvtPVSJ3PA.png","originalHeight":650,"originalWidth":597,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_44":{"__typename":"Paragraph","id":"1b9baa9d0849_44","name":"fca6","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*t-btJ6IB83ziWvtPVSJ3PA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_45":{"__typename":"Paragraph","id":"1b9baa9d0849_45","name":"1091","type":"P","href":null,"layout":null,"metadata":null,"text":"Another way to browse through the code is to use the IDA feature Xref from graph. This can be done because the sample is not obfuscated, and the windows API calls are been referred explicitly. Using this tool we can guide our analysis following the Windows API calls of interest","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*lMWlhWZHesiWej20bUgSBA.png":{"__typename":"ImageMetadata","id":"1*lMWlhWZHesiWej20bUgSBA.png","originalHeight":616,"originalWidth":3507,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_46":{"__typename":"Paragraph","id":"1b9baa9d0849_46","name":"6873","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lMWlhWZHesiWej20bUgSBA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_47":{"__typename":"Paragraph","id":"1b9baa9d0849_47","name":"5a19","type":"P","href":null,"layout":null,"metadata":null,"text":"Well…I said we could use it, not that it was small nor easy ;). However, if we zoom into it, we can have a good understating of the different functions and have a gist of their purpose. For example:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3MJFSJu9AH3lcVwc_NS8fQ.png":{"__typename":"ImageMetadata","id":"1*3MJFSJu9AH3lcVwc_NS8fQ.png","originalHeight":231,"originalWidth":1530,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_48":{"__typename":"Paragraph","id":"1b9baa9d0849_48","name":"323d","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3MJFSJu9AH3lcVwc_NS8fQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_49":{"__typename":"Paragraph","id":"1b9baa9d0849_49","name":"1fbc","type":"P","href":null,"layout":null,"metadata":null,"text":"Here we see the “ShellExecuteW ”API call (always interesting to see what the sample might try to execute) that is called right before exiting. If we go where it is called, we end up in the following routine :","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*u07LKeWPZyJ7S8zWGh3_4g.png":{"__typename":"ImageMetadata","id":"1*u07LKeWPZyJ7S8zWGh3_4g.png","originalHeight":659,"originalWidth":533,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_50":{"__typename":"Paragraph","id":"1b9baa9d0849_50","name":"55ab","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*u07LKeWPZyJ7S8zWGh3_4g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_51":{"__typename":"Paragraph","id":"1b9baa9d0849_51","name":"eba7","type":"P","href":null,"layout":null,"metadata":null,"text":"The routine consists of calling the API “GetModuleFileName” with “hmodule” Null to get the path of the executable file of the current process. Then, it prepares a command line that would look like “cmd.exe open \u003Cexecutable path\u003E \u002FC timeout \u002FT \u002FNOBREAK && del” \u003Cexecutable path\u003E\\” \u002FF”, execute the command and then exits.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":41,"end":58,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fwindows\u002Fwin32\u002Fapi\u002Flibloaderapi\u002Fnf-libloaderapi-getmodulefilenamea","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":197,"end":284,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":197,"end":284,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_52":{"__typename":"Paragraph","id":"1b9baa9d0849_52","name":"4852","type":"P","href":null,"layout":null,"metadata":null,"text":"By looking at the XRef graph we also notice some classic Windows API calls used to send http packets over the network. If we follow the references we find the following routine :","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CYmaT_Nc2rfxfw9-vxIrrg.png":{"__typename":"ImageMetadata","id":"1*CYmaT_Nc2rfxfw9-vxIrrg.png","originalHeight":1164,"originalWidth":1072,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_53":{"__typename":"Paragraph","id":"1b9baa9d0849_53","name":"7526","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CYmaT_Nc2rfxfw9-vxIrrg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ff-c0OPqVld0ckfm9w1L6g.png":{"__typename":"ImageMetadata","id":"1*ff-c0OPqVld0ckfm9w1L6g.png","originalHeight":1167,"originalWidth":1159,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_54":{"__typename":"Paragraph","id":"1b9baa9d0849_54","name":"33aa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ff-c0OPqVld0ckfm9w1L6g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_55":{"__typename":"Paragraph","id":"1b9baa9d0849_55","name":"83c8","type":"P","href":null,"layout":null,"metadata":null,"text":"By exploring this routine, we see that a post request is done. But now the question is what information is been sent. In the next section we are going to find out exactly what is been sent via the post http request.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_56":{"__typename":"Paragraph","id":"1b9baa9d0849_56","name":"fdf1","type":"P","href":null,"layout":null,"metadata":null,"text":"In order to fast forward the analysis, confirm some hypothesis, and discover new functionality, we will start the sample in the x32\u002F64 debugger while having Procmon and FakeNet running next to it to get more insights.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":128,"end":143,"href":"https:\u002F\u002Fx64dbg.com\u002F#start","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":157,"end":164,"href":"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fsysinternals\u002Fdownloads\u002Fprocmon","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":169,"end":176,"href":"https:\u002F\u002Fgithub.com\u002Ffireeye\u002Fflare-fakenet-ng","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_57":{"__typename":"Paragraph","id":"1b9baa9d0849_57","name":"125f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Dynamic analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_58":{"__typename":"Paragraph","id":"1b9baa9d0849_58","name":"7b10","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that our ransomware is running in a controlled environment we can see in more details how the different commands and processes are been killed by it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RLDjlN1ZLskCeymHgHyxiw.png":{"__typename":"ImageMetadata","id":"1*RLDjlN1ZLskCeymHgHyxiw.png","originalHeight":689,"originalWidth":1621,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_59":{"__typename":"Paragraph","id":"1b9baa9d0849_59","name":"5d50","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RLDjlN1ZLskCeymHgHyxiw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8de0jutRd5fvER-OxZPYew.png":{"__typename":"ImageMetadata","id":"1*8de0jutRd5fvER-OxZPYew.png","originalHeight":252,"originalWidth":1291,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_60":{"__typename":"Paragraph","id":"1b9baa9d0849_60","name":"f993","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8de0jutRd5fvER-OxZPYew.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_61":{"__typename":"Paragraph","id":"1b9baa9d0849_61","name":"690d","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s continue where we left trying to understand what is sent to the server over an http post request. In the following screenshot we can see how the IP and Port are decoded from the string stored in the “.rdata” section of the executable.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*sfQGSzC_0_PQDlw2oHSyWQ.png":{"__typename":"ImageMetadata","id":"1*sfQGSzC_0_PQDlw2oHSyWQ.png","originalHeight":462,"originalWidth":1434,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_62":{"__typename":"Paragraph","id":"1b9baa9d0849_62","name":"389e","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sfQGSzC_0_PQDlw2oHSyWQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_63":{"__typename":"Paragraph","id":"1b9baa9d0849_63","name":"0818","type":"P","href":null,"layout":null,"metadata":null,"text":"Once it has that information the malware will start preparing the request. This means setting up the headers and the content that will be sent. Once done it will call the API call “HttpSendRequest” to send the http request. Using FakeNet we received that request and respond with a fake site to emulate the “C2”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-ZVwghTRFBB6dvoTxHQmag.png":{"__typename":"ImageMetadata","id":"1*-ZVwghTRFBB6dvoTxHQmag.png","originalHeight":1051,"originalWidth":1112,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_64":{"__typename":"Paragraph","id":"1b9baa9d0849_64","name":"c9bf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-ZVwghTRFBB6dvoTxHQmag.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_65":{"__typename":"Paragraph","id":"1b9baa9d0849_65","name":"85ab","type":"P","href":null,"layout":null,"metadata":null,"text":"As the picture shows the ransomware sends a big blob encoded in base64 to the c2 server at “http:\u002F\u002F217.8.117[.]26\u002Fgateinfo”. But where is this information coming from? For this we need to go back to the code an analyse what happened so far.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*l1ZY5Gl4ASgDrKPOIQjL5Q.png":{"__typename":"ImageMetadata","id":"1*l1ZY5Gl4ASgDrKPOIQjL5Q.png","originalHeight":1069,"originalWidth":564,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_66":{"__typename":"Paragraph","id":"1b9baa9d0849_66","name":"639f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*l1ZY5Gl4ASgDrKPOIQjL5Q.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_67":{"__typename":"Paragraph","id":"1b9baa9d0849_67","name":"8980","type":"P","href":null,"layout":null,"metadata":null,"text":"In this function we see that there is a template for a json file were some details about the system are gathered and later appended to the json temple string. Examples of details that are gathered include but are not limited to:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_68":{"__typename":"Paragraph","id":"1b9baa9d0849_68","name":"6b0e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetCurrentHwProfileA","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_69":{"__typename":"Paragraph","id":"1b9baa9d0849_69","name":"6cfb","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Gen_token (some crypto API calls are involved)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_70":{"__typename":"Paragraph","id":"1b9baa9d0849_70","name":"7a07","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Query the registry key “SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":24,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_71":{"__typename":"Paragraph","id":"1b9baa9d0849_71","name":"f3b7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetUsername","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_72":{"__typename":"Paragraph","id":"1b9baa9d0849_72","name":"2d5b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetComputername","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_73":{"__typename":"Paragraph","id":"1b9baa9d0849_73","name":"b40d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"GetLocale","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_74":{"__typename":"Paragraph","id":"1b9baa9d0849_74","name":"3df0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Etc.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_75":{"__typename":"Paragraph","id":"1b9baa9d0849_75","name":"8658","type":"P","href":null,"layout":null,"metadata":null,"text":"Once it finished querying the system it generates a json that looks as follows:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CCqdy0s44cnG28zNlmEWow.png":{"__typename":"ImageMetadata","id":"1*CCqdy0s44cnG28zNlmEWow.png","originalHeight":607,"originalWidth":2329,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_76":{"__typename":"Paragraph","id":"1b9baa9d0849_76","name":"b5b6","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CCqdy0s44cnG28zNlmEWow.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_77":{"__typename":"Paragraph","id":"1b9baa9d0849_77","name":"57f2","type":"P","href":null,"layout":null,"metadata":null,"text":"After the information is gathered, we see that some encryption is initialised (creating encryption keys, specifying algorithms, etc) but some of the information used is queried from a file that was written in “%temp%\\\\boot.sys” in an earlier stage. The most interesting aspect of this, is that the information is not read from the file itself, instead it queries the file using the convention “filename.ext:string”. This means that this ransomware is using Alternate Data Streams to hide information. Using the ADS-spy tool we can inspect the content that is been read by the malware.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":457,"end":479,"href":"https:\u002F\u002Fwww.howtogeek.com\u002Fhowto\u002Fwindows-vista\u002Fstupid-geek-tricks-hide-data-in-a-secret-text-file-compartment\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":511,"end":518,"href":"https:\u002F\u002Fwww.bleepingcomputer.com\u002Fdownload\u002Fads-spy\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*G8-jHRCwy_tZTStsV8utSw.png":{"__typename":"ImageMetadata","id":"1*G8-jHRCwy_tZTStsV8utSw.png","originalHeight":581,"originalWidth":930,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_78":{"__typename":"Paragraph","id":"1b9baa9d0849_78","name":"809c","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*G8-jHRCwy_tZTStsV8utSw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*jBiM3vSUakzxUbG_fZdBGQ.png":{"__typename":"ImageMetadata","id":"1*jBiM3vSUakzxUbG_fZdBGQ.png","originalHeight":603,"originalWidth":761,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_79":{"__typename":"Paragraph","id":"1b9baa9d0849_79","name":"5004","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*jBiM3vSUakzxUbG_fZdBGQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*DsD9s-t-2lGpInhiDySnIA.png":{"__typename":"ImageMetadata","id":"1*DsD9s-t-2lGpInhiDySnIA.png","originalHeight":580,"originalWidth":920,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_80":{"__typename":"Paragraph","id":"1b9baa9d0849_80","name":"b68c","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*DsD9s-t-2lGpInhiDySnIA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*V1h0N02EEjW52oSKNQ00uQ.png":{"__typename":"ImageMetadata","id":"1*V1h0N02EEjW52oSKNQ00uQ.png","originalHeight":564,"originalWidth":885,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_81":{"__typename":"Paragraph","id":"1b9baa9d0849_81","name":"e970","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*V1h0N02EEjW52oSKNQ00uQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_82":{"__typename":"Paragraph","id":"1b9baa9d0849_82","name":"4cc5","type":"P","href":null,"layout":null,"metadata":null,"text":"Hidden in this file we can find the generated unique extension, the RSApublic key, and the Private Session Key. Once these values are retrieved the encryption of the json string takes place.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VMjjOaKx4tLrYiCTNmle5g.png":{"__typename":"ImageMetadata","id":"1*VMjjOaKx4tLrYiCTNmle5g.png","originalHeight":1619,"originalWidth":600,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_83":{"__typename":"Paragraph","id":"1b9baa9d0849_83","name":"84f1","type":"IMG","href":null,"layout":"OUTSET_ROW","metadata":{"__ref":"ImageMetadata:1*VMjjOaKx4tLrYiCTNmle5g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*O-3JMdMj4Ftq7CVyFg-myA.png":{"__typename":"ImageMetadata","id":"1*O-3JMdMj4Ftq7CVyFg-myA.png","originalHeight":830,"originalWidth":1155,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_84":{"__typename":"Paragraph","id":"1b9baa9d0849_84","name":"d36e","type":"IMG","href":null,"layout":"OUTSET_ROW_CONTINUE","metadata":{"__ref":"ImageMetadata:1*O-3JMdMj4Ftq7CVyFg-myA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_85":{"__typename":"Paragraph","id":"1b9baa9d0849_85","name":"92db","type":"P","href":null,"layout":null,"metadata":null,"text":"The json string is encrypted with AES CBC and the symmetric key encrypted the with the public RSA key. In the following screenshot we can see the json string in plaintext and then encrypted.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*v6e3s3CXC3o7Iw6aNc6Ahg.png":{"__typename":"ImageMetadata","id":"1*v6e3s3CXC3o7Iw6aNc6Ahg.png","originalHeight":660,"originalWidth":2058,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_86":{"__typename":"Paragraph","id":"1b9baa9d0849_86","name":"b0d6","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*v6e3s3CXC3o7Iw6aNc6Ahg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*pXmaETAutmgogRWxoqcjFg.png":{"__typename":"ImageMetadata","id":"1*pXmaETAutmgogRWxoqcjFg.png","originalHeight":517,"originalWidth":1439,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_87":{"__typename":"Paragraph","id":"1b9baa9d0849_87","name":"c9cc","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*pXmaETAutmgogRWxoqcjFg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_88":{"__typename":"Paragraph","id":"1b9baa9d0849_88","name":"d977","type":"P","href":null,"layout":null,"metadata":null,"text":"After encryption, the json is base6 4encoded and then added to the http post request as already shown.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_89":{"__typename":"Paragraph","id":"1b9baa9d0849_89","name":"2941","type":"P","href":null,"layout":null,"metadata":null,"text":"What about the file encryption? After all, this is a ransomware, right? So once the first beacon is sent to the server the ransomware starts the file encryption in a multithreaded fashion. This can be seen in the following screenshots:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wdFnQ3Gl6StLCBpDBk6o3w.png":{"__typename":"ImageMetadata","id":"1*wdFnQ3Gl6StLCBpDBk6o3w.png","originalHeight":637,"originalWidth":658,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_90":{"__typename":"Paragraph","id":"1b9baa9d0849_90","name":"dce9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wdFnQ3Gl6StLCBpDBk6o3w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Ekop4QfbCdrAZ2G6yigMwQ.png":{"__typename":"ImageMetadata","id":"1*Ekop4QfbCdrAZ2G6yigMwQ.png","originalHeight":856,"originalWidth":813,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_91":{"__typename":"Paragraph","id":"1b9baa9d0849_91","name":"4ffb","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Ekop4QfbCdrAZ2G6yigMwQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EwoKGwGEkKYuWK-Y_BR4Qg.png":{"__typename":"ImageMetadata","id":"1*EwoKGwGEkKYuWK-Y_BR4Qg.png","originalHeight":862,"originalWidth":1180,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_92":{"__typename":"Paragraph","id":"1b9baa9d0849_92","name":"4969","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EwoKGwGEkKYuWK-Y_BR4Qg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_93":{"__typename":"Paragraph","id":"1b9baa9d0849_93","name":"08a5","type":"P","href":null,"layout":null,"metadata":null,"text":"Once it finished it sends yet again another beacon with data to the server but this time to “http:\u002F\u002F217.8.117[.]26\u002Fgatedrivers”. In the following picture we can find an example of a ransom note that is left in every directory. The name convention for them is “\u003Cextension\u003E-decrypt.hta”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":93,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RxN1U0_hMDjnHrz97RWBsw.png":{"__typename":"ImageMetadata","id":"1*RxN1U0_hMDjnHrz97RWBsw.png","originalHeight":324,"originalWidth":1153,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1b9baa9d0849_94":{"__typename":"Paragraph","id":"1b9baa9d0849_94","name":"71f5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RxN1U0_hMDjnHrz97RWBsw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_95":{"__typename":"Paragraph","id":"1b9baa9d0849_95","name":"934a","type":"P","href":null,"layout":null,"metadata":null,"text":"So this will be all for now, there are quite some more interesting aspects to research into like how the file encryption is performed at a cryptographic level, how are some of the other interesting strings (powershell get host by address) used, does this ransomware implement persistence mechanisms, etc. Feel free to contact me for comments and questions. Constructive feedback is always welcomed!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_96":{"__typename":"Paragraph","id":"1b9baa9d0849_96","name":"e8df","type":"H3","href":null,"layout":null,"metadata":null,"text":"IOCs","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_97":{"__typename":"Paragraph","id":"1b9baa9d0849_97","name":"5e79","type":"P","href":null,"layout":null,"metadata":null,"text":"Samples:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_98":{"__typename":"Paragraph","id":"1b9baa9d0849_98","name":"04e6","type":"PRE","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002F027d99aaaa6803a07d07ce0ba1fa66964388129d3b26dcf8621a3310692b0a61\u002F\nhttps:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002Fa7e27cc38a39ff242da39d05e04b95ea9b656829dfe2e90e8226351da8813d7d\u002F\nhttps:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002F8d684a790a5683b8decde9fb5a819c4a164d3032723a151a30ff26d3c2b1aabf\u002F\nhttps:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002Fbf6e5f9d060ebc5bb70144ca6e795bfc249c6590ab9f45e258ec9b5f3d49eeb6\u002F\nhttps:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002F8da469200a4b3899b23a34232eec537f12c621aa3c8766a9745d8ff721ef5296\u002F\nhttps:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002Fb1bcc54ef15f91d9291357eca02862174bd6158e95813eff1ab0c16ba48ff10e\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":96,"href":"https:\u002F\u002Fbazaar.abuse.ch\u002Fsample\u002F027d99aaaa6803a07d07ce0ba1fa66964388129d3b26dcf8621a3310692b0a61\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_99":{"__typename":"Paragraph","id":"1b9baa9d0849_99","name":"a598","type":"P","href":null,"layout":null,"metadata":null,"text":"MD5:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_100":{"__typename":"Paragraph","id":"1b9baa9d0849_100","name":"0633","type":"PRE","href":null,"layout":null,"metadata":null,"text":"79385ed97732aee0036e67824de18e28\nf4009abe9f41da41e48340c96e29d62c\nfa4c4ac8b9c1b14951ae8add855f34e8\nf188cf267d209a0209a25bda4bb75b86\n5a63e7d371dd69c5625f5b48da426c14\ncb3a1463f4fd3e74b8f1ca5e73b81816\n7e415d5a1b1235491cb698eb14817d31","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_101":{"__typename":"Paragraph","id":"1b9baa9d0849_101","name":"ac26","type":"P","href":null,"layout":null,"metadata":null,"text":"SHA256:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_102":{"__typename":"Paragraph","id":"1b9baa9d0849_102","name":"1488","type":"PRE","href":null,"layout":null,"metadata":null,"text":"8d684a790a5683b8decde9fb5a819c4a164d3032723a151a30ff26d3c2b1aabf\n6db3aae21a6d80857c85f58c4c8b2cf9c6b7f8b8a9ab1d5496d18eaf9bd0bd01\nbf6e5f9d060ebc5bb70144ca6e795bfc249c6590ab9f45e258ec9b5f3d49eeb6\n027d99aaaa6803a07d07ce0ba1fa66964388129d3b26dcf8621a3310692b0a61\nb1bcc54ef15f91d9291357eca02862174bd6158e95813eff1ab0c16ba48ff10e\n8da469200a4b3899b23a34232eec537f12c621aa3c8766a9745d8ff721ef5296\na7e27cc38a39ff242da39d05e04b95ea9b656829dfe2e90e8226351da8813d7d","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_103":{"__typename":"Paragraph","id":"1b9baa9d0849_103","name":"f237","type":"P","href":null,"layout":null,"metadata":null,"text":"URLs:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_104":{"__typename":"Paragraph","id":"1b9baa9d0849_104","name":"c8c9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"http:\u002F\u002F217.8.117[.]26\u002Fpay\nhttp:\u002F\u002F217.8.117[.]26\u002Fgateinfo\nhttp:\u002F\u002F217.8.117[.]26\u002Fgatedrivers\nhttp:\u002F\u002F4dnd3utjsmm2zcsb[.]onion\u002Fpay","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":25,"href":"http:\u002F\u002F217.8.117[.]26\u002Fpay","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_105":{"__typename":"Paragraph","id":"1b9baa9d0849_105","name":"8a7d","type":"P","href":null,"layout":null,"metadata":null,"text":"IPs:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_106":{"__typename":"Paragraph","id":"1b9baa9d0849_106","name":"ad89","type":"PRE","href":null,"layout":null,"metadata":null,"text":"217.8.117[.]26","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_107":{"__typename":"Paragraph","id":"1b9baa9d0849_107","name":"9826","type":"P","href":null,"layout":null,"metadata":null,"text":"Tria.ge Sandbox reports:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":8,"href":"https:\u002F\u002Ftria.ge","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_108":{"__typename":"Paragraph","id":"1b9baa9d0849_108","name":"fef9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Ftria.ge\u002Freports\u002F200724-gmz55kbvr2\u002Fbehavioral1\nhttps:\u002F\u002Ftria.ge\u002Freports\u002F200724-2v2mzfsjwx\u002Fbehavioral1\nhttps:\u002F\u002Ftria.ge\u002Freports\u002F200724-kfjg2xf1b2\u002Fbehavioral1\nhttps:\u002F\u002Ftria.ge\u002Freports\u002F200724-64rls1gjl2\u002Fbehavioral1\nhttps:\u002F\u002Ftria.ge\u002Freports\u002F200724-b5zwteacds\u002Fbehavioral1\nhttps:\u002F\u002Ftria.ge\u002Freports\u002F200724-15z7parj4x\u002Fbehavioral1\nhttps:\u002F\u002Ftria.ge\u002Freports\u002F200724-zxydprrjys\u002Fbehavioral1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_109":{"__typename":"Paragraph","id":"1b9baa9d0849_109","name":"d000","type":"H3","href":null,"layout":null,"metadata":null,"text":"Acknowledgements:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1b9baa9d0849_110":{"__typename":"Paragraph","id":"1b9baa9d0849_110","name":"5128","type":"P","href":null,"layout":null,"metadata":null,"text":"Special thanks to @rikvduijn and @ValthekOn for helping me figure some of the details out and my team at @kpnsecurity for supporting my crazy projects and reviewing this writeup =D","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":19,"end":28,"href":"https:\u002F\u002Ftwitter.com\u002Frikvduijn","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":33,"end":43,"href":"https:\u002F\u002Ftwitter.com\u002FValthekOn","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":105,"end":106,"href":"https:\u002F\u002Ftwitter.com\u002Fkpnsecurity","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":107,"end":117,"href":"https:\u002F\u002Ftwitter.com\u002Fkpnsecurity","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:2f8ddcaa989f-viewerId:lo_b4be9b8b81f3":{"__typename":"UserViewerEdge","id":"userId:2f8ddcaa989f-viewerId:lo_b4be9b8b81f3","isMuting":false},"PostViewerEdge:postId:5b7da4263d81-viewerId:lo_b4be9b8b81f3":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:5b7da4263d81-viewerId:lo_b4be9b8b81f3"},"Tag:malware-analysis":{"__typename":"Tag","id":"malware-analysis","displayTitle":"Malware Analysis","normalizedTagSlug":"malware-analysis"},"Tag:ransomware":{"__typename":"Tag","id":"ransomware","displayTitle":"Ransomware","normalizedTagSlug":"ransomware"},"Tag:threat-intelligence":{"__typename":"Tag","id":"threat-intelligence","displayTitle":"Threat Intelligence","normalizedTagSlug":"threat-intelligence"},"Tag:infosec":{"__typename":"Tag","id":"infosec","displayTitle":"Infosec","normalizedTagSlug":"infosec"},"Tag:reverse-engineering":{"__typename":"Tag","id":"reverse-engineering","displayTitle":"Reverse Engineering","normalizedTagSlug":"reverse-engineering"},"Post:5b7da4263d81":{"__typename":"Post","id":"5b7da4263d81","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"f796","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:1b9baa9d0849_0"},{"__ref":"Paragraph:1b9baa9d0849_1"},{"__ref":"Paragraph:1b9baa9d0849_2"},{"__ref":"Paragraph:1b9baa9d0849_3"},{"__ref":"Paragraph:1b9baa9d0849_4"},{"__ref":"Paragraph:1b9baa9d0849_5"},{"__ref":"Paragraph:1b9baa9d0849_6"},{"__ref":"Paragraph:1b9baa9d0849_7"},{"__ref":"Paragraph:1b9baa9d0849_8"},{"__ref":"Paragraph:1b9baa9d0849_9"},{"__ref":"Paragraph:1b9baa9d0849_10"},{"__ref":"Paragraph:1b9baa9d0849_11"},{"__ref":"Paragraph:1b9baa9d0849_12"},{"__ref":"Paragraph:1b9baa9d0849_13"},{"__ref":"Paragraph:1b9baa9d0849_14"},{"__ref":"Paragraph:1b9baa9d0849_15"},{"__ref":"Paragraph:1b9baa9d0849_16"},{"__ref":"Paragraph:1b9baa9d0849_17"},{"__ref":"Paragraph:1b9baa9d0849_18"},{"__ref":"Paragraph:1b9baa9d0849_19"},{"__ref":"Paragraph:1b9baa9d0849_20"},{"__ref":"Paragraph:1b9baa9d0849_21"},{"__ref":"Paragraph:1b9baa9d0849_22"},{"__ref":"Paragraph:1b9baa9d0849_23"},{"__ref":"Paragraph:1b9baa9d0849_24"},{"__ref":"Paragraph:1b9baa9d0849_25"},{"__ref":"Paragraph:1b9baa9d0849_26"},{"__ref":"Paragraph:1b9baa9d0849_27"},{"__ref":"Paragraph:1b9baa9d0849_28"},{"__ref":"Paragraph:1b9baa9d0849_29"},{"__ref":"Paragraph:1b9baa9d0849_30"},{"__ref":"Paragraph:1b9baa9d0849_31"},{"__ref":"Paragraph:1b9baa9d0849_32"},{"__ref":"Paragraph:1b9baa9d0849_33"},{"__ref":"Paragraph:1b9baa9d0849_34"},{"__ref":"Paragraph:1b9baa9d0849_35"},{"__ref":"Paragraph:1b9baa9d0849_36"},{"__ref":"Paragraph:1b9baa9d0849_37"},{"__ref":"Paragraph:1b9baa9d0849_38"},{"__ref":"Paragraph:1b9baa9d0849_39"},{"__ref":"Paragraph:1b9baa9d0849_40"},{"__ref":"Paragraph:1b9baa9d0849_41"},{"__ref":"Paragraph:1b9baa9d0849_42"},{"__ref":"Paragraph:1b9baa9d0849_43"},{"__ref":"Paragraph:1b9baa9d0849_44"},{"__ref":"Paragraph:1b9baa9d0849_45"},{"__ref":"Paragraph:1b9baa9d0849_46"},{"__ref":"Paragraph:1b9baa9d0849_47"},{"__ref":"Paragraph:1b9baa9d0849_48"},{"__ref":"Paragraph:1b9baa9d0849_49"},{"__ref":"Paragraph:1b9baa9d0849_50"},{"__ref":"Paragraph:1b9baa9d0849_51"},{"__ref":"Paragraph:1b9baa9d0849_52"},{"__ref":"Paragraph:1b9baa9d0849_53"},{"__ref":"Paragraph:1b9baa9d0849_54"},{"__ref":"Paragraph:1b9baa9d0849_55"},{"__ref":"Paragraph:1b9baa9d0849_56"},{"__ref":"Paragraph:1b9baa9d0849_57"},{"__ref":"Paragraph:1b9baa9d0849_58"},{"__ref":"Paragraph:1b9baa9d0849_59"},{"__ref":"Paragraph:1b9baa9d0849_60"},{"__ref":"Paragraph:1b9baa9d0849_61"},{"__ref":"Paragraph:1b9baa9d0849_62"},{"__ref":"Paragraph:1b9baa9d0849_63"},{"__ref":"Paragraph:1b9baa9d0849_64"},{"__ref":"Paragraph:1b9baa9d0849_65"},{"__ref":"Paragraph:1b9baa9d0849_66"},{"__ref":"Paragraph:1b9baa9d0849_67"},{"__ref":"Paragraph:1b9baa9d0849_68"},{"__ref":"Paragraph:1b9baa9d0849_69"},{"__ref":"Paragraph:1b9baa9d0849_70"},{"__ref":"Paragraph:1b9baa9d0849_71"},{"__ref":"Paragraph:1b9baa9d0849_72"},{"__ref":"Paragraph:1b9baa9d0849_73"},{"__ref":"Paragraph:1b9baa9d0849_74"},{"__ref":"Paragraph:1b9baa9d0849_75"},{"__ref":"Paragraph:1b9baa9d0849_76"},{"__ref":"Paragraph:1b9baa9d0849_77"},{"__ref":"Paragraph:1b9baa9d0849_78"},{"__ref":"Paragraph:1b9baa9d0849_79"},{"__ref":"Paragraph:1b9baa9d0849_80"},{"__ref":"Paragraph:1b9baa9d0849_81"},{"__ref":"Paragraph:1b9baa9d0849_82"},{"__ref":"Paragraph:1b9baa9d0849_83"},{"__ref":"Paragraph:1b9baa9d0849_84"},{"__ref":"Paragraph:1b9baa9d0849_85"},{"__ref":"Paragraph:1b9baa9d0849_86"},{"__ref":"Paragraph:1b9baa9d0849_87"},{"__ref":"Paragraph:1b9baa9d0849_88"},{"__ref":"Paragraph:1b9baa9d0849_89"},{"__ref":"Paragraph:1b9baa9d0849_90"},{"__ref":"Paragraph:1b9baa9d0849_91"},{"__ref":"Paragraph:1b9baa9d0849_92"},{"__ref":"Paragraph:1b9baa9d0849_93"},{"__ref":"Paragraph:1b9baa9d0849_94"},{"__ref":"Paragraph:1b9baa9d0849_95"},{"__ref":"Paragraph:1b9baa9d0849_96"},{"__ref":"Paragraph:1b9baa9d0849_97"},{"__ref":"Paragraph:1b9baa9d0849_98"},{"__ref":"Paragraph:1b9baa9d0849_99"},{"__ref":"Paragraph:1b9baa9d0849_100"},{"__ref":"Paragraph:1b9baa9d0849_101"},{"__ref":"Paragraph:1b9baa9d0849_102"},{"__ref":"Paragraph:1b9baa9d0849_103"},{"__ref":"Paragraph:1b9baa9d0849_104"},{"__ref":"Paragraph:1b9baa9d0849_105"},{"__ref":"Paragraph:1b9baa9d0849_106"},{"__ref":"Paragraph:1b9baa9d0849_107"},{"__ref":"Paragraph:1b9baa9d0849_108"},{"__ref":"Paragraph:1b9baa9d0849_109"},{"__ref":"Paragraph:1b9baa9d0849_110"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:2f8ddcaa989f"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@velasco.l.n\u002Fexorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"1b9baa9d0849","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":27,"allowResponses":true,"isLimitedState":false,"title":"Exorcist Ransomware — From triaging to deep dive","isSeries":false,"sequence":null,"uniqueSlug":"exorcist-ransomware-from-triaging-to-deep-dive-5b7da4263d81","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1595596642638,"readingTime":10.067924528301887,"previewContent":{"__typename":"PreviewContent","subtitle":"TL;DR"},"previewImage":{"__ref":"ImageMetadata:1*KxnGPBxfs0kuOq4dCVasyg.png"},"isShortform":false,"seoTitle":"Exorcist Ransomware analysis writeup ","firstPublishedAt":1595593123272,"updatedAt":1639555219639,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"Analysis of a newly introduced ransomware as a service called Exorcist","viewerEdge":{"__ref":"PostViewerEdge:postId:5b7da4263d81-viewerId:lo_b4be9b8b81f3"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:malware-analysis"},{"__ref":"Tag:ransomware"},{"__ref":"Tag:threat-intelligence"},{"__ref":"Tag:infosec"},{"__ref":"Tag:reverse-engineering"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1926,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3d4c2d4a80cb61',t:'MTczNDUwNTQ1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3d4c2d4a80cb61","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>