<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://googleprojectzero.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Project Zero - RSS" href="https://googleprojectzero.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Project Zero - Atom" href="https://www.blogger.com/feeds/4838136820032157985/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Project Zero - Atom" href="https://googleprojectzero.blogspot.com/feeds/5634534606665421566/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s958/image2%20%285%29.png' rel='image_src'/>
<meta content='https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html' property='og:url'/>
<meta content='Windows Exploitation Tricks: Relaying DCOM Authentication' property='og:title'/>
<meta content='  Posted by James Forshaw, Project Zero     In my previous blog post Â I discussed the possibility of relaying Kerberos authentication from a...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/w1200-h630-p-k-no-nu/image2%20%285%29.png' property='og:image'/>
<title>Project Zero: Windows Exploitation Tricks: Relaying DCOM Authentication</title>
<style type='text/css'>@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4taVIGxA.woff2)format('woff2');unicode-range:U+0460-052F,U+1C80-1C8A,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4kaVIGxA.woff2)format('woff2');unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4saVIGxA.woff2)format('woff2');unicode-range:U+1F00-1FFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4jaVIGxA.woff2)format('woff2');unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4iaVIGxA.woff2)format('woff2');unicode-range:U+0307-0308,U+0590-05FF,U+200C-2010,U+20AA,U+25CC,U+FB1D-FB4F;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5caVIGxA.woff2)format('woff2');unicode-range:U+0302-0303,U+0305,U+0307-0308,U+0310,U+0312,U+0315,U+031A,U+0326-0327,U+032C,U+032F-0330,U+0332-0333,U+0338,U+033A,U+0346,U+034D,U+0391-03A1,U+03A3-03A9,U+03B1-03C9,U+03D1,U+03D5-03D6,U+03F0-03F1,U+03F4-03F5,U+2016-2017,U+2034-2038,U+203C,U+2040,U+2043,U+2047,U+2050,U+2057,U+205F,U+2070-2071,U+2074-208E,U+2090-209C,U+20D0-20DC,U+20E1,U+20E5-20EF,U+2100-2112,U+2114-2115,U+2117-2121,U+2123-214F,U+2190,U+2192,U+2194-21AE,U+21B0-21E5,U+21F1-21F2,U+21F4-2211,U+2213-2214,U+2216-22FF,U+2308-230B,U+2310,U+2319,U+231C-2321,U+2336-237A,U+237C,U+2395,U+239B-23B7,U+23D0,U+23DC-23E1,U+2474-2475,U+25AF,U+25B3,U+25B7,U+25BD,U+25C1,U+25CA,U+25CC,U+25FB,U+266D-266F,U+27C0-27FF,U+2900-2AFF,U+2B0E-2B11,U+2B30-2B4C,U+2BFE,U+3030,U+FF5B,U+FF5D,U+1D400-1D7FF,U+1EE00-1EEFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B5OaVIGxA.woff2)format('woff2');unicode-range:U+0001-000C,U+000E-001F,U+007F-009F,U+20DD-20E0,U+20E2-20E4,U+2150-218F,U+2190,U+2192,U+2194-2199,U+21AF,U+21E6-21F0,U+21F3,U+2218-2219,U+2299,U+22C4-22C6,U+2300-243F,U+2440-244A,U+2460-24FF,U+25A0-27BF,U+2800-28FF,U+2921-2922,U+2981,U+29BF,U+29EB,U+2B00-2BFF,U+4DC0-4DFF,U+FFF9-FFFB,U+10140-1018E,U+10190-1019C,U+101A0,U+101D0-101FD,U+102E0-102FB,U+10E60-10E7E,U+1D2C0-1D2D3,U+1D2E0-1D37F,U+1F000-1F0FF,U+1F100-1F1AD,U+1F1E6-1F1FF,U+1F30D-1F30F,U+1F315,U+1F31C,U+1F31E,U+1F320-1F32C,U+1F336,U+1F378,U+1F37D,U+1F382,U+1F393-1F39F,U+1F3A7-1F3A8,U+1F3AC-1F3AF,U+1F3C2,U+1F3C4-1F3C6,U+1F3CA-1F3CE,U+1F3D4-1F3E0,U+1F3ED,U+1F3F1-1F3F3,U+1F3F5-1F3F7,U+1F408,U+1F415,U+1F41F,U+1F426,U+1F43F,U+1F441-1F442,U+1F444,U+1F446-1F449,U+1F44C-1F44E,U+1F453,U+1F46A,U+1F47D,U+1F4A3,U+1F4B0,U+1F4B3,U+1F4B9,U+1F4BB,U+1F4BF,U+1F4C8-1F4CB,U+1F4D6,U+1F4DA,U+1F4DF,U+1F4E3-1F4E6,U+1F4EA-1F4ED,U+1F4F7,U+1F4F9-1F4FB,U+1F4FD-1F4FE,U+1F503,U+1F507-1F50B,U+1F50D,U+1F512-1F513,U+1F53E-1F54A,U+1F54F-1F5FA,U+1F610,U+1F650-1F67F,U+1F687,U+1F68D,U+1F691,U+1F694,U+1F698,U+1F6AD,U+1F6B2,U+1F6B9-1F6BA,U+1F6BC,U+1F6C6-1F6CF,U+1F6D3-1F6D7,U+1F6E0-1F6EA,U+1F6F0-1F6F3,U+1F6F7-1F6FC,U+1F700-1F7FF,U+1F800-1F80B,U+1F810-1F847,U+1F850-1F859,U+1F860-1F887,U+1F890-1F8AD,U+1F8B0-1F8BB,U+1F8C0-1F8C1,U+1F900-1F90B,U+1F93B,U+1F946,U+1F984,U+1F996,U+1F9E9,U+1FA00-1FA6F,U+1FA70-1FA7C,U+1FA80-1FA89,U+1FA8F-1FAC6,U+1FACE-1FADC,U+1FADF-1FAE9,U+1FAF0-1FAF8,U+1FB00-1FBFF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4vaVIGxA.woff2)format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4uaVIGxA.woff2)format('woff2');unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF;}@font-face{font-family:'Open Sans';font-style:normal;font-weight:400;font-stretch:100%;font-display:swap;src:url(//fonts.gstatic.com/s/opensans/v40/memSYaGs126MiZpBA-UvWbX2vVnXBbObj2OVZyOOSr4dVJWUgsjZ0B4gaVI.woff2)format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}</style>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Variable definitions
====================
<Variable name="keycolor" description="Main Color" type="color" default="#66bbdd"/>
<Group description="Page Text" selector="body">
<Variable name="body.font" description="Font" type="font"
default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="body.text.color" description="Text Color" type="color" default="#222222"/>
</Group>
<Group description="Backgrounds" selector=".body-fauxcolumns-outer">
<Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd"/>
<Variable name="content.background.color" description="Main Background" type="color" default="#ffffff"/>
<Variable name="header.background.color" description="Header Background" type="color" default="transparent"/>
</Group>
<Group description="Links" selector=".main-outer">
<Variable name="link.color" description="Link Color" type="color" default="#2288bb"/>
<Variable name="link.visited.color" description="Visited Color" type="color" default="#888888"/>
<Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff"/>
</Group>
<Group description="Blog Title" selector=".header h1">
<Variable name="header.font" description="Font" type="font"
default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="header.text.color" description="Title Color" type="color" default="#3399bb" />
</Group>
<Group description="Blog Description" selector=".header .description">
<Variable name="description.text.color" description="Description Color" type="color"
default="#777777" />
</Group>
<Group description="Tabs Text" selector=".tabs-inner .widget li a">
<Variable name="tabs.font" description="Font" type="font"
default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="tabs.text.color" description="Text Color" type="color" default="#999999"/>
<Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000"/>
</Group>
<Group description="Tabs Background" selector=".tabs-outer .PageList">
<Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5"/>
<Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Post Title" selector="h3.post-title, .comments h4">
<Variable name="post.title.font" description="Font" type="font"
default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
</Group>
<Group description="Date Header" selector=".date-header">
<Variable name="date.header.color" description="Text Color" type="color"
default="#000000"/>
<Variable name="date.header.background.color" description="Background Color" type="color"
default="transparent"/>
<Variable name="date.header.font" description="Text Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit"/>
<Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit"/>
<Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit"/>
</Group>
<Group description="Post Footer" selector=".post-footer">
<Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666"/>
<Variable name="post.footer.background.color" description="Background Color" type="color"
default="#f9f9f9"/>
<Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee"/>
</Group>
<Group description="Gadgets" selector="h2">
<Variable name="widget.title.font" description="Title Font" type="font"
default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/>
<Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000"/>
<Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999"/>
</Group>
<Group description="Images" selector=".main-inner">
<Variable name="image.background.color" description="Background Color" type="color" default="#ffffff"/>
<Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee"/>
<Variable name="image.text.color" description="Caption Text Color" type="color" default="#000000"/>
</Group>
<Group description="Accents" selector=".content-inner">
<Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee"/>
<Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="transparent"/>
</Group>
<Variable name="body.background" description="Body Background" type="background"
color="#eeeeee" default="$(color) none repeat scroll top left"/>
<Variable name="body.background.override" description="Body Background Override" type="string" default=""/>
<Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)"/>
<Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner"/>
<Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="10px" min="0" max="100px"/>
<Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px"/>
<Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px"/>
<Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px"/>
<Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px"/>
<Variable name="header.background.gradient" description="Header Gradient" type="url" default="none"/>
<Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px"/>
<Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px"/>
<Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px"/>
<Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="1px" min="0" max="10px"/>
<Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px"/>
<Variable name="description.text.size" description="Description Text Size" type="string" default="140%"/>
<Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px"/>
<Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px"/>
<Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)"/>
<Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px"/>
<Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px"/>
<Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px"/>
<Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px"/>
<Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner"/>
<Variable name="page.width" description="Page Width" type="string" default="auto"/>
<Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px"/>
<Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px"/>
<Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px"/>
<Variable name="paging.background"
color="#ffffff"
description="Background of blog paging area" type="background"
default="transparent none no-repeat scroll top center"/>
<Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px"/>
<Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
default="transparent none repeat scroll top left"/>
<Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto"/>
<Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff" />
<Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/>
<Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/>
*/
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Open Sans;
color: #000000;
background: #eeeeee none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px Open Sans;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px Open Sans;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Open Sans;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #000000;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1120px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1120px;
max-width: 1120px;
_width: 1120px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-240546891-1', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=c1451b08-9812-4261-87ca-6e00994495b4' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4838136820032157985&amp;zx=c1451b08-9812-4261-87ca-6e00994495b4' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4838136820032157985\x26blogName\x3dProject+Zero\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://googleprojectzero.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://googleprojectzero.blogspot.com/\x26targetPostID\x3d5634534606665421566\x26blogPostOrPageUrl\x3dhttps://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html\x26vt\x3d-5733718653393582953',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe",
              messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
              messageHandlers: {
                'blogger-ping': function() {}
              }
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://googleprojectzero.blogspot.com/'>
Project Zero
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>News and updates from the Project Zero team at Google</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Wednesday, October 20, 2021</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s958/image2%20%285%29.png' itemprop='image_url'/>
<meta content='4838136820032157985' itemprop='blogId'/>
<meta content='5634534606665421566' itemprop='postId'/>
<a name='5634534606665421566'></a>
<h3 class='post-title entry-title' itemprop='name'>
Windows Exploitation Tricks: Relaying DCOM Authentication
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-5634534606665421566' itemprop='description articleBody'>
<style type="text/css">.lst-kix_21eii7u3d36d-6>li:before{content:"" counter(lst-ctn-kix_21eii7u3d36d-6,decimal) ". "}.lst-kix_4h5ag0d3tyrp-4>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-4}ol.lst-kix_21eii7u3d36d-8{list-style-type:none}ol.lst-kix_21eii7u3d36d-7{list-style-type:none}ol.lst-kix_21eii7u3d36d-0.start{counter-reset:lst-ctn-kix_21eii7u3d36d-0 0}ol.lst-kix_21eii7u3d36d-6{list-style-type:none}ol.lst-kix_21eii7u3d36d-5{list-style-type:none}.lst-kix_21eii7u3d36d-3>li:before{content:"(" counter(lst-ctn-kix_21eii7u3d36d-3,decimal) ") "}ol.lst-kix_21eii7u3d36d-4{list-style-type:none}.lst-kix_21eii7u3d36d-7>li:before{content:"" counter(lst-ctn-kix_21eii7u3d36d-7,lower-latin) ". "}ol.lst-kix_21eii7u3d36d-3{list-style-type:none}ol.lst-kix_4h5ag0d3tyrp-6.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-6 0}.lst-kix_21eii7u3d36d-2>li:before{content:"" counter(lst-ctn-kix_21eii7u3d36d-2,lower-roman) ") "}ol.lst-kix_21eii7u3d36d-2{list-style-type:none}ol.lst-kix_21eii7u3d36d-1{list-style-type:none}ol.lst-kix_21eii7u3d36d-7.start{counter-reset:lst-ctn-kix_21eii7u3d36d-7 0}ol.lst-kix_21eii7u3d36d-0{list-style-type:none}.lst-kix_21eii7u3d36d-0>li:before{content:"" counter(lst-ctn-kix_21eii7u3d36d-0,decimal) ") "}ol.lst-kix_21eii7u3d36d-3.start{counter-reset:lst-ctn-kix_21eii7u3d36d-3 0}.lst-kix_21eii7u3d36d-8>li:before{content:"" counter(lst-ctn-kix_21eii7u3d36d-8,lower-roman) ". "}.lst-kix_21eii7u3d36d-1>li:before{content:"" counter(lst-ctn-kix_21eii7u3d36d-1,lower-latin) ") "}.lst-kix_21eii7u3d36d-3>li{counter-increment:lst-ctn-kix_21eii7u3d36d-3}.lst-kix_4h5ag0d3tyrp-5>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-5}ol.lst-kix_21eii7u3d36d-6.start{counter-reset:lst-ctn-kix_21eii7u3d36d-6 0}ol.lst-kix_4h5ag0d3tyrp-3.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-3 0}ol.lst-kix_4h5ag0d3tyrp-7.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-7 0}.lst-kix_21eii7u3d36d-2>li{counter-increment:lst-ctn-kix_21eii7u3d36d-2}.lst-kix_21eii7u3d36d-5>li{counter-increment:lst-ctn-kix_21eii7u3d36d-5}.lst-kix_21eii7u3d36d-8>li{counter-increment:lst-ctn-kix_21eii7u3d36d-8}ol.lst-kix_4h5ag0d3tyrp-0.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-0 0}ol.lst-kix_21eii7u3d36d-8.start{counter-reset:lst-ctn-kix_21eii7u3d36d-8 0}ol.lst-kix_4h5ag0d3tyrp-4.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-4 0}ol.lst-kix_21eii7u3d36d-2.start{counter-reset:lst-ctn-kix_21eii7u3d36d-2 0}.lst-kix_4h5ag0d3tyrp-0>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-0}.lst-kix_21eii7u3d36d-4>li:before{content:"(" counter(lst-ctn-kix_21eii7u3d36d-4,lower-latin) ") "}.lst-kix_4h5ag0d3tyrp-6>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-6}.lst-kix_21eii7u3d36d-5>li:before{content:"(" counter(lst-ctn-kix_21eii7u3d36d-5,lower-roman) ") "}.lst-kix_4h5ag0d3tyrp-3>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-3}ol.lst-kix_4h5ag0d3tyrp-6{list-style-type:none}ol.lst-kix_4h5ag0d3tyrp-7{list-style-type:none}ol.lst-kix_21eii7u3d36d-5.start{counter-reset:lst-ctn-kix_21eii7u3d36d-5 0}ol.lst-kix_4h5ag0d3tyrp-4{list-style-type:none}ol.lst-kix_4h5ag0d3tyrp-1.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-1 0}ol.lst-kix_4h5ag0d3tyrp-5{list-style-type:none}.lst-kix_4h5ag0d3tyrp-7>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-7,lower-latin) ". "}.lst-kix_21eii7u3d36d-6>li{counter-increment:lst-ctn-kix_21eii7u3d36d-6}ol.lst-kix_4h5ag0d3tyrp-8.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-8 0}.lst-kix_4h5ag0d3tyrp-1>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-1}ol.lst-kix_4h5ag0d3tyrp-8{list-style-type:none}.lst-kix_4h5ag0d3tyrp-4>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-4,lower-latin) ". "}.lst-kix_4h5ag0d3tyrp-8>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-8,lower-roman) ". "}.lst-kix_21eii7u3d36d-0>li{counter-increment:lst-ctn-kix_21eii7u3d36d-0}.lst-kix_4h5ag0d3tyrp-3>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-3,decimal) ". "}ol.lst-kix_4h5ag0d3tyrp-2{list-style-type:none}ol.lst-kix_4h5ag0d3tyrp-3{list-style-type:none}ol.lst-kix_4h5ag0d3tyrp-0{list-style-type:none}ol.lst-kix_4h5ag0d3tyrp-1{list-style-type:none}.lst-kix_4h5ag0d3tyrp-2>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-2,lower-roman) ". "}.lst-kix_4h5ag0d3tyrp-7>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-7}ol.lst-kix_21eii7u3d36d-1.start{counter-reset:lst-ctn-kix_21eii7u3d36d-1 0}.lst-kix_4h5ag0d3tyrp-5>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-5,lower-roman) ". "}.lst-kix_4h5ag0d3tyrp-8>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-8}.lst-kix_4h5ag0d3tyrp-6>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-6,decimal) ". "}ol.lst-kix_21eii7u3d36d-4.start{counter-reset:lst-ctn-kix_21eii7u3d36d-4 0}.lst-kix_4h5ag0d3tyrp-2>li{counter-increment:lst-ctn-kix_4h5ag0d3tyrp-2}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_4h5ag0d3tyrp-5.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-5 0}.lst-kix_21eii7u3d36d-4>li{counter-increment:lst-ctn-kix_21eii7u3d36d-4}.lst-kix_21eii7u3d36d-7>li{counter-increment:lst-ctn-kix_21eii7u3d36d-7}.lst-kix_4h5ag0d3tyrp-1>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-1,lower-latin) ". "}.lst-kix_21eii7u3d36d-1>li{counter-increment:lst-ctn-kix_21eii7u3d36d-1}.lst-kix_4h5ag0d3tyrp-0>li:before{content:"" counter(lst-ctn-kix_4h5ag0d3tyrp-0,decimal) ". "}ol.lst-kix_4h5ag0d3tyrp-2.start{counter-reset:lst-ctn-kix_4h5ag0d3tyrp-2 0}ol{margin:0;padding:0}table td,table th{padding:0}.c31{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:1pt;border-right-width:1pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:1pt;border-top-style:solid;border-left-style:solid;border-bottom-width:1pt;width:468pt;border-top-color:#000000;border-bottom-style:solid}.c9{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c23{padding-top:18pt;padding-bottom:6pt;line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left;height:11pt}.c6{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Courier New";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.5;orphans:2;widows:2;text-align:left}.c10{background-color:#ffffff;font-size:10pt;font-family:"Courier New";color:#8000ff;font-weight:400}.c3{background-color:#ffffff;font-size:10pt;font-family:"Courier New";color:#000080;font-weight:700}.c20{border-spacing:0;border-collapse:collapse;margin-right:auto}.c16{background-color:#ffffff;font-size:10pt;font-family:"Courier New";font-weight:700}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c11{background-color:#ffffff;font-size:10pt;font-family:"Courier New";font-weight:400}.c25{color:#000000;font-weight:400;font-size:16pt;font-family:"Arial"}.c22{color:#000000;font-weight:400;font-size:11pt;font-family:"Courier New"}.c2{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c8{font-size:10pt;font-family:"Courier New";color:#a82d00;font-weight:400}.c7{font-size:10pt;font-family:"Courier New";color:#696969;font-weight:400}.c12{font-size:10pt;font-family:"Courier New";font-weight:400}.c17{text-decoration:none;vertical-align:baseline;font-style:normal}.c29{padding:0;margin:0}.c34{margin-left:36pt;padding-left:0pt}.c35{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c21{color:inherit;text-decoration:inherit}.c14{color:#8b0000}.c13{color:#0000ff}.c19{height:11pt}.c15{color:#800000}.c4{font-style:italic}.c18{color:#800080}.c24{color:#006161}.c33{background-color:#ffffff}.c32{color:#000080}.c27{color:#a31515}.c30{color:#00008b}.c26{height:0pt}.c28{color:#8a2be2}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.5;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c33 c35">
 <p class="c5"><span class="c9">Posted by James Forshaw, Project Zero</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>In my </span><span class="c2"><a class="c211" href="https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html">previous blog post</a></span><span>&nbsp;I discussed the possibility of relaying Kerberos authentication from a DCOM connection. I was originally going to provide a more in-depth explanation of how that works, but as it&#39;s quite involved I thought it was worthy of its own blog post. This is primarily a technique to get relay authentication from another user on the same machine and forward that to a network service such as LDAP. You could use this to escalate privileges on a host using a technique similar to a </span><span class="c2"><a class="c211" href="https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html#case-study-2-windows-1020162019-lpe">blog post</a></span><span>&nbsp;from Shenanigans Labs</span><span class="c9">&nbsp;but removing the requirement for the WebDAV service. Let&#39;s get straight to it.</span></p><h2 class="c23" id="h.5xga9tje7jcd"><span class="c25 c17">Background</span></h2>
 <p class="c5"><span>The technique to locally relay authentication for DCOM was something I originally reported back in 2015 (</span><span class="c2"><a class="c211" href="https://bugs.chromium.org/p/project-zero/issues/detail?id=325">issue 325</a></span><span>). This issue was fixed as CVE-2015-2370, however the underlying authentication relay using DCOM remained. This was repurposed and expanded upon by various others for local and remote privilege escalation in the </span><span class="c2"><a class="c211" href="https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/">RottenPotato</a></span><span>&nbsp;series of exploits, the latest in that line being </span><span class="c2"><a class="c211" href="https://github.com/antonioCoco/RemotePotato0">RemotePotato</a></span><span>&nbsp;which is currently unpatched as of October 2021.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The key feature that the exploit abused is standard COM marshaling. Specifically when a COM object is marshaled so that it can be used by a different process or host, the COM runtime generates an </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/fe6c5e46-adf8-4e34-a8de-3f756c875f31">OBJREF structure</a></span><span>, most commonly the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/51312511-36e1-4ab6-993c-523643b11a29">OBJREF_STANDARD</a></span><span class="c9">&nbsp;form. This structure contains all the information necessary to establish a connection between a COM client and the original object in the COM server.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Connecting to the original object from the OBJREF is a two part process:</span></p><ol class="c29 lst-kix_4h5ag0d3tyrp-0 start" start="1"><li style="margin-left: 46pt;" class="c5 c34 li-bullet-0"><span>The client extracts the </span><span class="c4">Object Exporter ID (OXID)</span><span class="c9">&nbsp;from the structure and contacts the OXID resolver service specified by the RPC binding information in the OBJREF.</span></li><li style="margin-left: 46pt;" class="c5 c34 li-bullet-0"><span class="c9">The client uses the OXID resolver service to find the RPC binding information of the COM server which hosts the object and establishes a connection to the RPC endpoint to access the object&#39;s interfaces.</span></li></ol>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Both of these steps require establishing an MSRPC connection to an endpoint. Commonly this is either locally over ALPC, or remotely via TCP. If a TCP connection is used then the client will also authenticate to the RPC server using NTLM or Kerberos based on the security bindings in the OBJREF.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The first key insight I had for </span><span class="c2"><a class="c211" href="https://bugs.chromium.org/p/project-zero/issues/detail?id=325">issue 325</a></span><span class="c9">&nbsp;is that you can construct an OBJREF which will always establish a connection to the OXID resolver service over TCP, even if the service was on the local machine. To do this you specify the hostname as an IP address and an arbitrary TCP port for the client to connect to. This allows you to listen locally and when the RPC connection is made the authentication can be relayed or repurposed. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This isn&#39;t yet a privilege escalation, since you need to convince a privileged user to unmarshal the OBJREF. This was the second key insight: you could get a privileged service to unmarshal an arbitrary OBJREF easily using the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/objbase/nf-objbase-cogetinstancefromistorage">CoGetInstanceFromIStorage</a></span><span class="c9">&nbsp;API and activating a privileged COM service. This marshals a COM object, creates the privileged COM server and then unmarshals the object in the server&#39;s security context. This results in an RPC call to the fake OXID resolver authenticated using a privileged user&#39;s credentials. From there the authentication could be relayed to the local system for privilege escalation.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"></p>
  
 <p class="c5"><span class="c4"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s958/image2%20%285%29.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Diagram of an DCOM authentication relay attack from issue 325" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s958/image2%20%285%29.png" style="max-height: 750px; max-width: 600px;" /></a></span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Being able to redirect the OXID resolver RPC connection locally to a different TCP port was not by design and Microsoft eventually fixed this in Windows 10 1809/Server 2019. The underlying issue prior to Windows 10 1809 was the string containing the host returned as part of the OBJREF was directly concatenated into an </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/rpc/string-binding">RPC string binding</a></span><span class="c9">. Normally the RPC string binding should have been in the form of:</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.e77594769c6122f6cc07295f638fefdcc6db828e"></a><a id="t.0"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c5"><span class="c6">ncacn_ip_tcp:ADDRESS[135]</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Where </span><span class="c4">ncacn_ip_tcp</span><span>&nbsp;is the protocol sequence for RPC over TCP, </span><span class="c4">ADDRESS </span><span>is the target address which would come from the string binding, and </span><span class="c4">[135]</span><span class="c9">&nbsp;is the well-known TCP port for the OXID resolver appended by RPCSS. However, as the ADDRESS value is inserted manually into the binding then the OBJREF could specify its own port, resulting in the string binding:</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.97aa81be1b3e01eee48e6be87e60b7c9ec811e04"></a><a id="t.1"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c5"><span class="c6">ncacn_ip_tcp:ADDRESS[9999][135]</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The RPC runtime would just pick the first port in the binding string to connect to, in this case 9999, and would ignore the second port 135. This behavior was fixed by calling the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/rpcdce/nf-rpcdce-rpcstringbindingcomposew">RpcStringBindingCompose</a></span><span class="c9">&nbsp;API which will correctly escape the additional port number which ensures it&#39;s ignored when making the RPC connection.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This is where the </span><span class="c2"><a class="c211" href="https://www.sentinelone.com/labs/relaying-potatoes-another-unexpected-privilege-escalation-vulnerability-in-windows-rpc-protocol/">RemotePotato exploit</a></span><span>, developed by </span><span class="c2"><a class="c211" href="https://twitter.com/splinter_code">Antonio Cocomazzi</a></span><span>&nbsp;and </span><span class="c2"><a class="c211" href="https://twitter.com/decoder_it">Andrea Pierini</a></span><span>, comes into the picture. While it was no longer possible to redirect the OXID resolving to a local TCP server, you could redirect the initial connection to an external server. A call is made to the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/65292e10-ef0c-43ee-bce7-788e271cc794">IObjectExporter::ResolveOxid2</a></span><span class="c9">&nbsp;method which can return an arbitrary RPC binding string for a fake COM object. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Unlike the OXID resolver binding string, the one for the COM object is allowed to contain an arbitrary TCP port. By returning a binding string for the original host on an arbitrary TCP port, the second part of the connection process can be relayed rather than the first. The relayed authentication can then be sent to a domain server, such as LDAP or SMB, as long as they don&#39;t enforce signing.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"></p>
  
 <p class="c5"><span class="c4"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyrByRoxwgw3esO67XtK4FiB9Ee14So3I32nGdQJ_ZY1hLVjCPANB7jeGeUHiyi4GZ8LcHjr8UizWip0KoOhWF7pyPIN5Wi_zRzZGWeHI4RgUeiALaZOgesnzd5LVFq_gnU-_hOMo6s6J3Nm9xAp_zWtibxbjq5uQwUDb0lFNde1mJw3GC3OdGc-nU/s1302/image5%20%282%29.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Diagram of an DCOM authentication relay attack from Remote Potato" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhyrByRoxwgw3esO67XtK4FiB9Ee14So3I32nGdQJ_ZY1hLVjCPANB7jeGeUHiyi4GZ8LcHjr8UizWip0KoOhWF7pyPIN5Wi_zRzZGWeHI4RgUeiALaZOgesnzd5LVFq_gnU-_hOMo6s6J3Nm9xAp_zWtibxbjq5uQwUDb0lFNde1mJw3GC3OdGc-nU/s1200/image5%20%282%29.png" style="max-height: 750px; max-width: 600px;" /></a></span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">This exploit has the clear disadvantage of requiring an external machine to act as the target of the initial OXID resolving. While investigating the Kerberos authentication relay attacks for DCOM, could I find a way to do everything on the same machine?</span></p><h2 class="c23" id="h.ifb7mhiinb48"><span class="c17 c25">Remote &#10140; Local Potato</span></h2>
 <p class="c5"><span class="c9">If we&#39;re relaying the authentication for the second RPC connection, could we get the local OXID resolver to do the work for us and resolve to a local COM server on a randomly selected port? One of my goals is to write the least amount of code, which is why we&#39;ll do everything in C# and .NET.</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.78af739dc60f8ded5f3815bfc652d7621558437e"></a><a id="t.2"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c12 c13">byte</span><span class="c6">[] ba = GetMarshalledObject(new object());</span></p>
 <p class="c1"><span class="c12 c13">var</span><span class="c6">&nbsp;std = COMObjRefStandard.FromArray(ba);</span></p>
 <p class="c1"><span class="c12">Console.WriteLine(</span><span class="c12 c27">&quot;IPID: {0}&quot;</span><span class="c6">, std.Ipid);</span></p>
 <p class="c1"><span class="c12">Console.WriteLine(</span><span class="c12 c27">&quot;OXID: {0:X08}&quot;</span><span class="c6">, std.Oxid);</span></p>
 <p class="c1"><span class="c12">Console.WriteLine(</span><span class="c12 c27">&quot;OID : {0:X08}&quot;</span><span class="c6">, std.Oid);</span></p>
 <p class="c1"><span class="c6">std.StringBindings.Clear();</span></p>
 <p class="c1"><span class="c12">std.StringBindings.Add(RpcTowerId.Tcp, </span><span class="c12 c27">&quot;127.0.0.1&quot;</span><span class="c6">);</span></p>
 <p class="c1"><span class="c12">Console.WriteLine(</span><span class="c12 c27">$&quot;objref:</span><span class="c12">{0}</span><span class="c12 c27">:&quot;</span><span class="c12">, Convert.ToBase64String(std.ToArray());</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This code creates a basic .NET object and COM marshals it to a standard OBJREF. I&#39;ve left out the code for the marshalling and parsing of the OBJREF, but much of that is already present in the linked </span><span class="c2"><a class="c211" href="https://bugs.chromium.org/p/project-zero/issues/detail?id=325">issue 325</a></span><span class="c9">. We then modify the list of string bindings to only include a TCP binding for 127.0.0.1, forcing the OXID resolver to use TCP. If you specify a computer&#39;s hostname then the OXID resolver will use ALPC instead. Note that the string bindings in the OBJREF are only for binding to the OXID resolver, not the COM server itself.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>We can then convert the modified OBJREF into an </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/objbase/nf-objbase-createobjrefmoniker">objref moniker</a></span><span>. This </span><span>format is useful as it allows us to trivially unmarshal the object in another process by calling the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.marshal.bindtomoniker">Marshal::BindToMoniker</a></span><span class="c9">&nbsp;API in .NET and passing the moniker string. For example to bind to the COM object in PowerShell you can run the following command:</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.aa280acd79392ba85d8386c23bd09616ceb0921a"></a><a id="t.3"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c7">[</span><span class="c12 c24">Runtime.InteropServices.Marshal</span><span class="c7">]::</span><span class="c12">BindToMoniker(</span><span class="c12 c14">&quot;objref:TUVP...:&quot;</span><span class="c12">)</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Immediately after binding to the moniker a firewall dialog is likely to appear as shown:</span></p>
 <p class="c5"></p>
  
  
 <p class="c5"><span class="c4"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5k-8HEb-Iw-6zAMqoicT-dV3S7M6SoG2KtLaksWCOLvt3PYRSsV0n3jLa4pjb9NgoJ0HuTOslYPUbVO0hi-Nnf5gIWEfp7Hqy8aa8YwGhnjUs-slWihaWlPPCMOSny-31V-6hyRNQwi78Ddh1Y-T2187oK3KWEvRdGXsLqsjaXFTRGZbNET_8-Dgi/s790/image4%20%283%29.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Firewall dialog for the COM server when a TCP binding is created" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg5k-8HEb-Iw-6zAMqoicT-dV3S7M6SoG2KtLaksWCOLvt3PYRSsV0n3jLa4pjb9NgoJ0HuTOslYPUbVO0hi-Nnf5gIWEfp7Hqy8aa8YwGhnjUs-slWihaWlPPCMOSny-31V-6hyRNQwi78Ddh1Y-T2187oK3KWEvRdGXsLqsjaXFTRGZbNET_8-Dgi/s790/image4%20%283%29.png" style="max-height: 750px; max-width: 600px;" /></a></span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">This is requesting the user to allow our COM server process access to listen on all network interfaces for incoming connections. This prompt only appears when the client tries to resolve the OXID as DCOM supports dynamic RPC endpoints. Initially when the COM server starts it only listens on ALPC, but the RPCSS service can ask the server to bind to additional endpoints.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This request is made through an internal RPC interface that every COM server implements for use by the RPCSS service. One of the functions on this interface is </span><span class="c4">UseProtSeq</span><span>, which requests that the COM server enables a TCP endpoint. When the COM server receives the </span><span class="c4">UseProtSeq </span><span class="c9">call it tries to bind a TCP server to all interfaces, which subsequently triggers the Windows Defender Firewall to prompt the user for access. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Enabling the firewall permission requires administrator privileges. However, as we only need to listen for connections via localhost we shouldn&#39;t need to modify the firewall so the dialog can be dismissed safely. However, going back to the COM client we&#39;ll see an error reported.</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.f650b0d01b77aecef2325462507e753c659f0187"></a><a id="t.4"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c6">Exception calling &quot;BindToMoniker&quot; with &quot;1&quot; argument(s): </span></p>
 <p class="c1"><span class="c6">&quot;The RPC server is unavailable. (Exception from HRESULT: 0x800706BA)&quot;</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">If we allow our COM server executable through the firewall, the client is able to connect over TCP successfully. Clearly the firewall is affecting the behavior of the COM client in some way even though it shouldn&#39;t. Tracing through the unmarshalling process in the COM client, the error is being returned from RPCSS when trying to resolve the OXID&#39;s binding information. This would imply that no connection attempt is made, and RPCSS is detecting that the COM server wouldn&#39;t be allowed through the firewall and refusing to return any binding information for TCP.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Further digging into RPCSS led me to the following function:</span></p><a id="t.adfd20381e0d0a060d62f6d9e908c9386f1297f0"></a><a id="t.5"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c11">BOOL IsPortOpen</span><span class="c3">(</span><span class="c11">LPWSTR ImageFileName</span><span class="c3">,</span><span class="c11">&nbsp;</span><span class="c10">int</span><span class="c11">&nbsp;PortNumber</span><span class="c3">)</span><span class="c11">&nbsp;</span><span class="c3 c17">{</span></p>
 <p class="c1"><span class="c11">&nbsp; INetFwMgr</span><span class="c3">*</span><span class="c11">&nbsp;mgr</span><span class="c3 c17">;</span></p>
 <p class="c1"><span class="c6 c33">&nbsp; </span></p>
 <p class="c1"><span class="c11">&nbsp; CoCreateInstance</span><span class="c3">(</span><span class="c11">CLSID_FwMgr</span><span class="c3">,</span><span class="c11">&nbsp;</span><span class="c16 c13">NULL</span><span class="c3">,</span><span class="c11">&nbsp;CLSCTX_INPROC_SERVER</span><span class="c3">,</span><span class="c6 c33">&nbsp;</span></p>
 <p class="c1"><span class="c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;IID_PPV_ARGS</span><span class="c3">(&amp;</span><span class="c11">mgr</span><span class="c3 c17">));</span></p>
 <p class="c1"><span class="c11">&nbsp; VARIANT Allowed</span><span class="c3 c17">;</span></p>
 <p class="c1"><span class="c11">&nbsp; VARIANT Restricted</span><span class="c3 c17">;</span></p>
 <p class="c1"><span class="c11">&nbsp; mgr</span><span class="c3">-&gt;</span><span class="c11">IsPortAllowed</span><span class="c3">(</span><span class="c11">ImageFileName</span><span class="c3">,</span><span class="c11">&nbsp;NET_FW_IP_VERSION_ANY</span><span class="c3">,</span><span class="c6 c33">&nbsp;</span></p>
 <p class="c1"><span class="c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PortNumber</span><span class="c3">,</span><span class="c11">&nbsp;</span><span class="c16 c13">NULL</span><span class="c3">,</span><span class="c11">&nbsp;NET_FW_IP_PROTOCOL_TCP</span><span class="c3 c17">,</span></p>
 <p class="c1"><span class="c11">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c3">&amp;</span><span class="c11">Allowed</span><span class="c3">,</span><span class="c11">&nbsp;</span><span class="c3">&amp;</span><span class="c11">Restricted</span><span class="c3 c17">);</span></p>
 <p class="c1"><span class="c11">&nbsp; </span><span class="c16 c13">if</span><span class="c11">&nbsp;</span><span class="c3">(</span><span class="c11">VT_BOOL </span><span class="c3">!=</span><span class="c11">&nbsp;Allowed</span><span class="c3">.</span><span class="c11">vt</span><span class="c3 c17">)</span></p>
 <p class="c1"><span class="c11">&nbsp; &nbsp; </span><span class="c13 c16">return</span><span class="c11">&nbsp;FALSE</span><span class="c3 c17">;</span></p>
 <p class="c1 c19"><span class="c3 c17"></span></p>
 <p class="c1"><span class="c11">&nbsp; </span><span class="c16 c13">return</span><span class="c11">&nbsp;Allowed</span><span class="c3">.</span><span class="c11">boolVal </span><span class="c3">==</span><span class="c11">&nbsp;VARIANT_TRUE</span><span class="c3 c17">;</span></p>
 <p class="c1"><span class="c3">}</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This function uses the </span><span class="c4">HNetCfg.FwMgr</span><span>&nbsp;COM object, and calls </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/netfw/nf-netfw-inetfwmgr-isportallowed">INetFwMgr::IsPortAllowed</a></span><span class="c9">&nbsp;to determine if the process is allowed to listen on the specified TCP port. This function is called for every TCP binding when enumerating the COM server&#39;s bindings to return to the client. RPCSS passes the full path to the COM server&#39;s executable and the listening TCP port. If the function returns FALSE then RPCSS doesn&#39;t consider it valid and won&#39;t add it to the list of potential bindings. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>If the OXID resolving process doesn&#39;t have any binding at the end of the lookup process it will return the </span><span class="c4">RPC_S_SERVER_UNAVAILABLE</span><span class="c9">&nbsp;error and the COM client will fail to bind to the server. How can we get around this limitation without needing administrator privileges to allow our server through the firewall? We can convert this C++ code into a small PowerShell function to test the behavior of the function to see what would grant access.</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.8dadc02f2dd955da5d84ce378d816be40d1bf022"></a><a id="t.6"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c12 c30">function</span><span class="c12">&nbsp;</span><span class="c12 c28">Test-IsPortOpen</span><span class="c6">&nbsp;{</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c30">param</span><span class="c6">(</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c7">[</span><span class="c12 c24">string</span><span class="c7">]</span><span class="c8">$Name</span><span class="c7 c17">,</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c7">[</span><span class="c12 c24">int</span><span class="c7">]</span><span class="c8 c17">$Port</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; )</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c8">$mgr</span><span class="c12">&nbsp;</span><span class="c7">=</span><span class="c12">&nbsp;</span><span class="c12 c13">New-Object</span><span class="c12">&nbsp;</span><span class="c12 c32">-ComObject</span><span class="c12">&nbsp;</span><span class="c12 c17 c14">&quot;HNetCfg.FwMgr&quot;</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c8">$allow</span><span class="c12">&nbsp;</span><span class="c7">=</span><span class="c12">&nbsp;</span><span class="c8 c17">$null</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c8">$mgr</span><span class="c7">.</span><span class="c12">IsPortAllowed(</span><span class="c8">$Name</span><span class="c7">,</span><span class="c12">&nbsp;</span><span class="c12 c18">2</span><span class="c7">,</span><span class="c12">&nbsp;</span><span class="c8">$Port</span><span class="c7">,</span><span class="c12">&nbsp;</span><span class="c12 c14">&quot;&quot;</span><span class="c7">,</span><span class="c12">&nbsp;</span><span class="c12 c18">6</span><span class="c7">,</span><span class="c12">&nbsp;</span><span class="c7">[</span><span class="c12 c24">ref</span><span class="c7">]</span><span class="c8">$allow</span><span class="c7">,</span><span class="c12">&nbsp;</span><span class="c8">$null</span><span class="c6">)</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c8 c17">$allow</span></p>
 <p class="c1"><span class="c6">}</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12 c30">foreach</span><span class="c12">(</span><span class="c8">$f</span><span class="c12">&nbsp;</span><span class="c12 c30">in</span><span class="c12">&nbsp;$(</span><span class="c12 c13">ls</span><span class="c12">&nbsp;</span><span class="c12 c14">&quot;$env:WINDIR\system32\*.exe&quot;</span><span class="c6">)) { &nbsp; &nbsp;</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c30">if</span><span class="c12">&nbsp;(</span><span class="c12 c13">Test-IsPortOpen</span><span class="c12">&nbsp;</span><span class="c8">$f</span><span class="c7">.</span><span class="c12">FullName </span><span class="c12 c18">12345</span><span class="c6">) {</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c13">Write-Host</span><span class="c12">&nbsp;</span><span class="c8">$f</span><span class="c7">.</span><span class="c6">Fullname</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; }</span></p>
 <p class="c1"><span class="c12">}</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This script enumerates all executable files in system32 and checks if they&#39;d be allowed to connect to TCP port 12345. Normally the TCP port would be selected automatically, however the COM server can use the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/rpcdce/nf-rpcdce-rpcserveruseprotseqep">RpcServerUseProtseqEp</a></span><span class="c9">&nbsp;API to pre-register a known TCP port for RPC communication, so we&#39;ll just pick port 12345.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The only executable in system32 that returns true from </span><span class="c4">Test-IsPortOpen</span><span>&nbsp;is </span><span class="c4">svchost.exe</span><span class="c9">. That makes some sense, the default firewall rules usually permit a limited number of services to be accessible through the firewall, the majority of which are hosted in a shared service process.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This check doesn&#39;t guarantee a COM server will be allowed through the firewall, just that it&#39;s potentially accessible in order to return a TCP binding string. As the connection will be via localhost we don&#39;t need to be allowed through the firewall, only that </span><span class="c4">IsPortOpen </span><span class="c9">thinks we could be open. How can we spoof the image filename?</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The obvious trick would be to create a </span><span class="c4">svchost.exe</span><span>&nbsp;process and inject our own code in there. However, that is harder to achieve through pure .NET code and also injecting into an </span><span class="c4">svchost </span><span class="c9">executable is a bit of a red flag if something is monitoring for malicious code which might make the exploit unreliable. Instead, perhaps we can influence the image filename used by RPCSS?</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Digging into the COM runtime, when a COM server registers itself with RPCSS it passes its own image filename as part of the registration information. The runtime gets the image filename through a call to </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulefilenamew">GetModuleFileName</a></span><span>, which gets the value from the </span><span class="c4">ImagePathName</span><span class="c9">&nbsp;field in the process parameters block referenced by the PEB. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">We can modify this string in our own process to be anything we like, then when COM is initialized, that will be sent to RPCSS which will use it for the firewall check. Once the check passes, RPCSS will return the TCP string bindings for our COM server when unmarshalling the OBJREF and the client will be able to connect. This can all be done with only minor in-process modifications from .NET and no external servers required.</span></p><h2 class="c23" id="h.87n38litfqxj"><span class="c25 c17">Capturing Authentication</span></h2>
 <p class="c5"><span class="c9">At this point a new RPC connection will be made to our process to communicate with the marshaled COM object. During that process the COM client must authenticate, so we can capture and relay that authentication to another service locally or remotely. What&#39;s the best way to capture that authentication traffic?</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Before we do anything we need to select what authentication we want to receive, and this will be reflected in the OBJREF&#39;s security bindings. As we&#39;re doing everything using the existing COM runtime we can register what RPC authentication services to use when calling </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity">CoInitializeSecurity</a></span><span>&nbsp;in the COM server through the </span><span class="c4">asAuthSvc</span><span class="c9">&nbsp;parameter.</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.5188af134394dbd4e93278caa48ce70cc2e7b4b8"></a><a id="t.7"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c12 c13">var</span><span class="c12">&nbsp;svcs = </span><span class="c12 c13">new</span><span class="c6">&nbsp;SOLE_AUTHENTICATION_SERVICE[] { </span></p>
 <p class="c1"><span class="c12 c13">&nbsp; &nbsp; new</span><span class="c6">&nbsp;SOLE_AUTHENTICATION_SERVICE() { </span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; dwAuthnSvc = RpcAuthenticationType.Kerberos,</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; pPrincipalName = </span><span class="c12 c27">&quot;HOST/DC.domain.com&quot;</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; }</span></p>
 <p class="c1"><span class="c6">};</span></p>
 <p class="c1"><span class="c12 c13">var</span><span class="c12">&nbsp;str = SetProcessModuleName(</span><span class="c12 c27">&quot;System&quot;</span><span class="c6">);</span></p>
 <p class="c1"><span class="c12 c17 c13">try</span></p>
 <p class="c1"><span class="c6">{</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp;CoInitializeSecurity(IntPtr.Zero, svcs.Length, svcs, </span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; IntPtr.Zero, AuthnLevel.RPC_C_AUTHN_LEVEL_DEFAULT,</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; ImpLevel.RPC_C_IMP_LEVEL_IMPERSONATE, IntPtr.Zero,</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; EOLE_AUTHENTICATION_CAPABILITIES.EOAC_DYNAMIC_CLOAKING,</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; IntPtr.Zero);</span></p>
 <p class="c1"><span class="c6">}</span></p>
 <p class="c1"><span class="c12 c13 c17">finally</span></p>
 <p class="c1"><span class="c6">{</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; SetProcessModuleName(str);</span></p>
 <p class="c1"><span class="c12">}</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>In the above code, we register to only receive Kerberos authentication and we can also specify an arbitrary SPN as I described in the </span><span class="c2"><a class="c211" href="https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html">previous blog post</a></span><span>. One thing to note is that the call to </span><span class="c4">CoInitializeSecurity</span><span class="c9">&nbsp;will establish the connection to RPCSS and pass the executable filename. Therefore we need to modify the filename before calling the API as we can&#39;t change it after the connection has been established. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>For </span><span>swag</span><span>&nbsp;points I specify the filename </span><span class="c4">System</span><span>&nbsp;rather than build the full path to </span><span class="c4">svchost.exe</span><span>. This is the </span><span>name assigned to the kernel which is also granted access through the firewall. We restore the original filename after the call to </span><span class="c4">CoInitializeSecurity </span><span class="c9">to reduce the risk of it breaking something unexpectedly.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">That covers the selection of the authentication service to use, but doesn&#39;t help us actually capture that authentication. My first thought to capture the authentication was to find the socket handle for the TCP server, close it and create a new socket in its place. Then I could directly process the RPC protocol and parse out the authentication. This felt somewhat risky as the RPC runtime would still think it has a valid TCP server socket and might fail in unexpected ways. Also it felt like a lot of work, when I have a perfectly good RPC protocol parser built into Windows.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>I then resigned myself to hooking the SSPI APIs, although ideally I&#39;d prefer not to do so. However, once I started looking at the RPC runtime library there weren&#39;t any imports for the SSPI APIs to hook into and I really didn&#39;t want to patch the functions themselves. It turns out that the RPC runtime loads security packages dynamically, based on the authentication service requested and the configuration of the </span><span class="c4">HKLM\SOFTWARE\Microsoft\Rpc\SecurityService</span><span class="c9">&nbsp;registry key.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"></p>
  
 <p class="c5"><span class="c4"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiooNt9vGeuuGX-qWowAPJv7twW2ASFXiXwvwVb9QQimr6U2WnzYWPcRQKHXDdnn8mXuNaC0l0Fvs9fvHbYbh72r4G2_AnCLjaVC2HtnzoL2sgb8hOiw-EJyldnejADOu8ddBamYLMOP0d-Km3g1HX02MOhi033j7usXaJJ8MeSHKWJBK4C3gcY426H/s877/image1%20%286%29.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Screenshot of the Registry Editor showing HKLM\SOFTWARE\Microsoft\Rpc\SecurityService key" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiooNt9vGeuuGX-qWowAPJv7twW2ASFXiXwvwVb9QQimr6U2WnzYWPcRQKHXDdnn8mXuNaC0l0Fvs9fvHbYbh72r4G2_AnCLjaVC2HtnzoL2sgb8hOiw-EJyldnejADOu8ddBamYLMOP0d-Km3g1HX02MOhi033j7usXaJJ8MeSHKWJBK4C3gcY426H/s877/image1%20%286%29.png" style="max-height: 750px; max-width: 600px;" /></a></span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The key, shown in the above screenshot has a list of values. The value&#39;s name is the number </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/com/com-authentication-service-constants">assigned</a></span><span>&nbsp;to the authentication service, for example 16 is </span><span class="c4">RPC_C_AUTHN_GSS_KERBEROS</span><span>. The value&#39;s data is then the name of the DLL to load which provides the API, for Kerberos this is </span><span class="c4">sspicli.dll</span><span class="c9">.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The RPC runtime then loads a table of security functions from the DLL by calling its exported </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/sspi/nf-sspi-initsecurityinterfacew">InitSecurityInterface</a></span><span>&nbsp;method. At least for </span><span class="c4">sspicli</span><span>&nbsp;the table is always the same and is a pre-initialized structure in the DLL&#39;s data section. This is perfect, we can just call </span><span class="c4">InitSecurityInterface</span><span class="c9">&nbsp;before the RPC runtime is initialized to get a pointer to the table then modify its function pointers to point to our own implementation of the API. As an added bonus the table is in a writable section of the DLL so we don&#39;t even need to modify the memory protection.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Of course implementing the hooks is non-trivial. This is made more complex because RPC uses the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-kile/190ab8de-dc42-49cf-bf1b-ea5705b7a087">DCE style Kerberos authentication</a></span><span class="c9">&nbsp;which requires two tokens from the client before the server considers the authentication complete. This requires maintaining more state to keep the RPC server and client implementations happy. I&#39;ll leave this as an exercise for the reader.</span></p><h2 class="c23" id="h.dkczv6jimbo9"><span class="c25 c17">Choosing a Relay Target Service</span></h2>
 <p class="c5"><span>The next step is to choose a suitable target service to relay the authentication to. For </span><span class="c2"><a class="c211" href="https://bugs.chromium.org/p/project-zero/issues/detail?id=325">issue 325</a></span><span class="c9">&nbsp;I relayed the authentication to the same machine&#39;s DCOM activator RPC service and was able to achieve an arbitrary file write.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>I thought that maybe I could do so again, so I modified my </span><span class="c2"><a class="c211" href="https://googleprojectzero.blogspot.com/2019/12/calling-local-windows-rpc-servers-from.html">.NET RPC client</a></span><span class="c9">&nbsp;to handle the relayed authentication and tried accessing local RPC services. No matter what RPC server or function I called, I always got an access denied error. Even if I wrote my own RPC server which didn&#39;t have any checks, it would fail.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Digging into the failure it turned out that at some point (I don&#39;t know specifically when), Microsoft added a mitigation into the RPC runtime to make it very difficult to relay authentication back to the same system. </span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.d16597b280dba3c3840bf804233cdcf3fbce3cb7"></a><a id="t.8"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c10">void</span><span class="c11">&nbsp;SSECURITY_CONTEXT</span><span class="c3">::</span><span class="c11">ValidateUpgradeCriteria</span><span class="c3 c17">() {</span></p>
 <p class="c1"><span class="c11">&nbsp; </span><span class="c16 c13">if</span><span class="c11">&nbsp;</span><span class="c3">(</span><span class="c16 c13">this</span><span class="c3">-&gt;</span><span class="c11">AuthnLevel </span><span class="c3">&lt;</span><span class="c11">&nbsp;RPC_C_AUTHN_LEVEL_PKT_INTEGRITY</span><span class="c3 c17">) {</span></p>
 <p class="c1"><span class="c11">&nbsp; &nbsp; </span><span class="c16 c13">if</span><span class="c11">&nbsp;</span><span class="c3">(</span><span class="c11">IsLoopback</span><span class="c3 c17">())</span></p>
 <p class="c1"><span class="c11">&nbsp; &nbsp; &nbsp; </span><span class="c16 c13">this</span><span class="c3">-&gt;</span><span class="c11">UnsafeLoopbackAuth </span><span class="c3">=</span><span class="c11">&nbsp;TRUE</span><span class="c3 c17">;</span></p>
 <p class="c1"><span class="c11">&nbsp; </span><span class="c3 c17">}</span></p>
 <p class="c1"><span class="c3">}</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The </span><span class="c4">SSECURITY_CONTEXT::ValidateUpgradeCriteria</span><span>&nbsp;method is called when receiving RPC authentication packets. If the authentication level for the RPC connection is less than </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_INTEGRITY</span><span>&nbsp;such as </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_CONNECT</span><span>&nbsp;and the authentication was from the same system then a flag is set to true in the security context. The </span><span class="c4">IsLoopback </span><span>function calls the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/secauthn/querycontextattributes--general">QueryContextAttributes</a></span><span>&nbsp;API for the undocumented </span><span class="c4">SECPKG_ATTR_IS_LOOPBACK</span><span class="c9">&nbsp;attribute value from the server security context. This attribute indicates if the authentication was from the local system.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>When an RPC call is made the server will check if the flag is true, if it is then the call will be immediately rejected before any code is called in the server including the RPC interface&#39;s security callback. The only way to pass this check is either the authentication doesn&#39;t come from the local system or the authentication level is </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_INTEGRITY</span><span class="c9">&nbsp;or above which then requires the client to know the session key for signing or encryption. The RPC client will also check for local authentication and will increase the authentication level if necessary. This is an effective way of preventing the relay of local authentication to elevate privileges.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span class="c9">Instead as I was focussing on Kerberos, I came to the conclusion that relaying the authentication to an enterprise network service was more useful. As the default settings for a domain controller&#39;s LDAP service still do not enforce signing, it would seem a reasonable target. As we&#39;ll see, this provides a limitation of the source of the authentication, as it must not enable Integrity otherwise the LDAP server will enforce signing.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The problem with LDAP is I didn&#39;t have any code which implemented the protocol. I&#39;m sure there is some .NET code to do it somewhere, but the fewer dependencies I have the better. As I mentioned in the </span><span class="c2"><a class="c211" href="https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html">previous blog post</a></span><span>, Windows has a builtin </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/_ldap/">LDAP library</a></span><span>&nbsp;in </span><span class="c4">wldap32.dll</span><span class="c9">. Could I repurpose its API but convert it into using relayed authentication?</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Unsurprisingly the library doesn&#39;t have a &quot;Enable relayed authentication&quot; mode, but after a few minutes in a disassembler, it was clear it was also delay-loading the SSPI interfaces through the </span><span class="c4">InitSecurityInterface </span><span>method. I could repurpose my code for capturing the authentication for relaying the authentication. There was initially a minor issue, accidentally or on purpose there was a stray call to </span><span class="c4">QueryContextAttributes</span><span class="c4">&nbsp;</span><span>which was directly imported, so I needed to patch that through an </span><span class="c4">Import Address Table (IAT)</span><span class="c9">&nbsp;hook as distasteful as that was.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>There was still a problem however. When the client connects it always tries to enable LDAP signing, as we are relaying authentication with no access to the session key this causes the connection to fail. Setting the option value </span><span class="c4">LDAP_OPT_SIGN</span><span>&nbsp;in the library to false didn&#39;t change this behavior. I needed to set the </span><span class="c4">LdapClientIntegrity </span><span>registry value to 0 in the LDAP service&#39;s key before initializing the library. Unfortunately that key is only modifiable by administrators. I could have modified the library itself, but as it was checking the key during </span><span class="c4">DllMain </span><span class="c9">it would be a complex dance to patch the DLL in the middle of loading.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>Instead I decided to override the </span><span class="c4">HKEY_LOCAL_MACHINE</span><span>&nbsp;key. This is possible for the Win32 APIs by using the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/api/winreg/nf-winreg-regoverridepredefkey">RegOverridePredefKey</a></span><span>&nbsp;API. The purpose of the API is to allow installers to redirect administrator-only modifications to the registry into a writable location, however for our purposes we can also use it to redirect the reading of the </span><span class="c4">LdapClientIntegrity </span><span class="c9">registry value.</span></p>
 <p class="c0"><span class="c9"></span></p><a id="t.701cb52d2a1d8adec608337c8e749b549cee1cf3"></a><a id="t.9"></a><table class="c20"><tbody><tr class="c26"><td class="c31" colspan="1" rowspan="1">
 <p class="c1"><span class="c12">[DllImport(</span><span class="c12 c27">&quot;Advapi32.dll&quot;</span><span class="c6">)]</span></p>
 <p class="c1"><span class="c12 c13">static</span><span class="c12">&nbsp;</span><span class="c12 c13">extern</span><span class="c12">&nbsp;</span><span class="c12 c13">int</span><span class="c6">&nbsp;RegOverridePredefKey(</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; IntPtr hKey,</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; IntPtr hNewHKey</span></p>
 <p class="c1"><span class="c6">);</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12">[DllImport(</span><span class="c12 c27">&quot;kernel32.dll&quot;</span><span class="c12">, CharSet = CharSet.Unicode, SetLastError = </span><span class="c12 c13">true</span><span class="c6">)]</span></p>
 <p class="c1"><span class="c12 c13">static</span><span class="c12">&nbsp;</span><span class="c12 c13">extern</span><span class="c12">&nbsp;IntPtr LoadLibrary(</span><span class="c12 c13">string</span><span class="c6">&nbsp;libname);</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12 c13">static</span><span class="c12">&nbsp;</span><span class="c12 c13">readonly</span><span class="c12">&nbsp;IntPtr HKEY_LOCAL_MACHINE = </span><span class="c12 c13">new</span><span class="c6">&nbsp;IntPtr(-2147483646);</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12 c13">static</span><span class="c12">&nbsp;</span><span class="c12 c13">void</span><span class="c6">&nbsp;OverrideLocalMachine(RegistryKey key)</span></p>
 <p class="c1"><span class="c6">{</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c13">int</span><span class="c6">&nbsp;res = RegOverridePredefKey(HKEY_LOCAL_MACHINE, </span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; key?.Handle.DangerousGetHandle() ?? IntPtr.Zero);</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c13">if</span><span class="c6">&nbsp;(res != 0)</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c13">throw</span><span class="c12">&nbsp;</span><span class="c12 c13">new</span><span class="c6">&nbsp;Win32Exception(res);</span></p>
 <p class="c1"><span class="c6">}</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12 c13">static</span><span class="c12">&nbsp;</span><span class="c12 c13">void</span><span class="c6">&nbsp;LoadLDAPLibrary()</span></p>
 <p class="c1"><span class="c6">{</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c13">string</span><span class="c12">&nbsp;dummy = </span><span class="c12 c15">@&quot;SOFTWARE\DUMMY&quot;</span><span class="c6">;</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c13">string</span><span class="c12">&nbsp;target = </span><span class="c12 c15">@&quot;System\CurrentControlSet\Services\LDAP&quot;</span><span class="c6">;</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; </span><span class="c12 c13">using</span><span class="c12">&nbsp;(</span><span class="c12 c13">var</span><span class="c12">&nbsp;key = Registry.CurrentUser.CreateSubKey(dummy, </span><span class="c12 c13">true</span><span class="c6">))</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; {</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c13">using</span><span class="c12">&nbsp;(</span><span class="c12 c13">var</span><span class="c12">&nbsp;okey = key.CreateSubKey(target, </span><span class="c12 c13">true</span><span class="c6">))</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; okey.SetValue(</span><span class="c12 c27">&quot;LdapClientIntegrity&quot;</span><span class="c6">, 0, </span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RegistryValueKind.DWord);</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OverrideLocalMachine(key);</span></p>
 <p class="c1 c19"><span class="c6"></span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c17 c13">try</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IntPtr lib = LoadLibrary(</span><span class="c12 c27">&quot;wldap32.dll&quot;</span><span class="c6">);</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c13">if</span><span class="c6">&nbsp;(lib == IntPtr.Zero)</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c13">throw</span><span class="c12">&nbsp;</span><span class="c12 c13">new</span><span class="c6">&nbsp;Win32Exception();</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c17 c13">finally</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</span></p>
 <p class="c1"><span class="c12">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OverrideLocalMachine(</span><span class="c12 c13">null</span><span class="c6">);</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Registry.CurrentUser.DeleteSubKeyTree(dummy);</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p>
 <p class="c1"><span class="c6">&nbsp; &nbsp; }</span></p>
 <p class="c1"><span class="c12">}</span></p></td></tr></tbody></table>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This code redirects the </span><span class="c4">HKEY_LOCAL_MACHINE</span><span class="c9">&nbsp;key and then loads the LDAP library. Once it&#39;s loaded we can then revert the override so that everything else works as expected. We can now repurpose the built-in LDAP library to relay Kerberos authentication to the domain controller. For the final step, we need a privileged COM service to unmarshal the OBJREF to start the process.</span></p><h2 class="c23" id="h.dwt9lb67za71"><span class="c25 c17">Choosing a COM Unmarshaller </span></h2>
 <p class="c5"><span>The </span><span class="c4">RemotePotato </span><span>attack assumes that a more privileged user is authenticated on the same machine. However I wanted to see what I could do </span><span class="c4">without</span><span class="c9">&nbsp;that requirement. Realistically the only thing that can be done is to relay the computer&#39;s domain account to the LDAP server. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>To get access to authentication for the computer account, we need to unmarshal the OBJREF inside a process running as either </span><span class="c4">SYSTEM</span><span>&nbsp;or </span><span class="c4">NETWORK SERVICE</span><span class="c9">. These local accounts are mapped to the computer account when authenticating to another machine on the network. </span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>We do have one big limitation on the selection of a suitable COM server: it must make the RPC connection using the </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_CONNECT</span><span>&nbsp;authentication level. Anything above that will enable Integrity on the authentication which will prevent us relaying to LDAP. Fortunately </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_CONNECT</span><span>&nbsp;is the default setting for DCOM, but unfortunately all services which use the </span><span class="c4">svchost </span><span>process change that default to </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT</span><span class="c9">&nbsp;which enables Integrity.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>After a bit of hunting around with </span><span class="c2"><a class="c211" href="http://oleview.net">OleViewDotNet</a></span><span>, I found a good candidate class, </span><span class="c4">CRemoteAppLifetimeManager</span><span>&nbsp;(CLSID: 0bae55fc-479f-45c2-972e-e951be72c0c1) which is hosted in its own executable, runs as </span><span class="c4">NETWORK SERVICE</span><span class="c9">, and doesn&#39;t change any default settings as shown below.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"></p>
  
 <p class="c5"><span class="c4"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjY0GTONUmsfjcV_gBc77i0Cvy_4WgZ_89837ArCqW3GfvyXBsIinDGdcZxxo5Sj6WWjTd0DsNFt7O95UMjb_-QiwHrzdvJo3y9HWH6oxQVnBeKjwLUqnVGmwh9kqOsvM9YfZsIiSgCdX3io1tg31NwkHUMfS3KTEGoJxbRrtC15Z5n72WuCSS92zOb/s945/image3%20%283%29.png" style="display: block; padding: 1em 0;text-align: center;"><img alt="Screenshot of the OleViewDotNet showing the security flags of the CRemoteAppLifetimeManager COM server" border="0" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjY0GTONUmsfjcV_gBc77i0Cvy_4WgZ_89837ArCqW3GfvyXBsIinDGdcZxxo5Sj6WWjTd0DsNFt7O95UMjb_-QiwHrzdvJo3y9HWH6oxQVnBeKjwLUqnVGmwh9kqOsvM9YfZsIiSgCdX3io1tg31NwkHUMfS3KTEGoJxbRrtC15Z5n72WuCSS92zOb/s945/image3%20%283%29.png" style="max-height: 750px; max-width: 600px;" /></a></span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>The server doesn&#39;t change the default impersonation level from </span><span class="c4">RPC_C_IMP_LEVEL_IDENTIFY</span><span>, which means the negotiated token will only be at </span><span class="c4">SecurityIdentification</span><span>&nbsp;level. For LDAP, this doesn&#39;t matter as it only uses the token for access checking, not to open resources. However, this would prevent using the same authentication to access something like the SMB server. I&#39;m confident that given enough effort, a COM server with both </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_CONNECT</span><span>&nbsp;and </span><span class="c4">RPC_C_IMP_LEVEL_IMPERSONATE</span><span class="c9">&nbsp;could be found, but it wasn&#39;t necessary for my exploit.</span></p><h2 class="c23" id="h.38szqoyv0vag"><span class="c25 c17">Wrapping Up</span></h2>
 <p class="c5"><span>That&#39;s a somewhat complex exploit. However, it does allow for authentication relay, with arbitrary Kerberos tokens from a local user to LDAP on a default Windows 10 system. Hopefully it might provide some ideas of how to implement something similar without always needing to write your protocol servers and clients and just use what&#39;s already available.</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>This exploit is very similar to the existing RemotePotato exploit that Microsoft have already stated will not be fixed. This is because Microsoft considers authentication relay attacks to be an issue with the configuration of the Windows network, such as not enforcing signing on LDAP, rather than the particular technique used to generate the authentication relay. As I mentioned in the </span><span class="c2"><a class="c211" href="https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html">previous blog post</a></span><span class="c9">, at most this would be assessed as a Moderate severity issue which does not reach the bar for fixing as part of regular updates (or potentially, not being fixed at all).</span></p>
 <p class="c0"><span class="c9"></span></p>
 <p class="c5"><span>As for mitigating this issue without it being fixed by Microsoft, a system administrator should follow Microsoft&#39;s recommendations to enable signing and/or encryption on any sensitive service in the domain, especially LDAP. They can also enable Extended Protection for Authentication where the service is protected by TLS. They can also configure the </span><span class="c2"><a class="c211" href="https://docs.microsoft.com/en-us/windows/win32/com/setting-machine-wide-security-using-dcomcnfg#setting-system-wide-default-authentication-level">default DCOM authentication level</a></span><span>&nbsp;to be </span><span class="c4">RPC_C_AUTHN_LEVEL_PKT_INTEGRITY</span><span class="c9">&nbsp;or above. These changes would make the relay of Kerberos, or NTLM significantly less useful.</span></p>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<span itemprop='name'>Anonymous</span>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html' itemprop='url'/>
<a class='timestamp-link' href='https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2021-10-20T09:38:00-07:00'>9:38&#8239;AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-145400864'>
<a href='https://www.blogger.com/post-edit.g?blogID=4838136820032157985&postID=5634534606665421566&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5634534606665421566&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5634534606665421566&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5634534606665421566&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5634534606665421566&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=5634534606665421566&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/4838136820032157985?po=5634534606665421566&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2315299244-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/java                   '>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://googleprojectzero.blogspot.com/2021/12/this-shouldnt-have-happened.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://googleprojectzero.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://googleprojectzero.blogspot.com/feeds/5634534606665421566/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://googleprojectzero.blogspot.com/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://googleprojectzero.blogspot.com/p/about-project-zero.html'>About Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/working-at-project-zero.html'>Working at Project Zero</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/0day.html'>0day "In the Wild"</a>
</li>
<li>
<a href='https://googleprojectzero.github.io/0days-in-the-wild/rca.html'>0day Exploit Root Cause Analyses</a>
</li>
<li>
<a href='https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html'>Vulnerability Disclosure FAQ</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Archives</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/'>
2024
</a>
<span class='post-count' dir='ltr'>(8)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2024/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/'>
2023
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/08/'>
August
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2023/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/'>
2022
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/11/'>
November
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2022/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(24)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='posts'>
<li><a href='https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html'>Windows Exploitation Tricks: Relaying DCOM Authent...</a></li>
<li><a href='https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html'>Using Kerberos for Authentication Relay Attacks</a></li>
<li><a href='https://googleprojectzero.blogspot.com/2021/10/how-simple-linux-kernel-memory.html'>How a simple Linux kernel memory corruption bug ca...</a></li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2021/01/'>
January
</a>
<span class='post-count' dir='ltr'>(10)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/'>
2020
</a>
<span class='post-count' dir='ltr'>(36)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/08/'>
August
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/07/'>
July
</a>
<span class='post-count' dir='ltr'>(8)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/06/'>
June
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/02/'>
February
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2020/01/'>
January
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(27)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/08/'>
August
</a>
<span class='post-count' dir='ltr'>(11)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/04/'>
April
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2019/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/'>
2018
</a>
<span class='post-count' dir='ltr'>(22)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/12/'>
December
</a>
<span class='post-count' dir='ltr'>(7)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/10/'>
October
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/08/'>
August
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/06/'>
June
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2018/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/'>
2017
</a>
<span class='post-count' dir='ltr'>(19)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/10/'>
October
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/04/'>
April
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2017/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/'>
2016
</a>
<span class='post-count' dir='ltr'>(17)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/11/'>
November
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/09/'>
September
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/07/'>
July
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/06/'>
June
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/03/'>
March
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/02/'>
February
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2016/01/'>
January
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/'>
2015
</a>
<span class='post-count' dir='ltr'>(33)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/12/'>
December
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/09/'>
September
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/08/'>
August
</a>
<span class='post-count' dir='ltr'>(6)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/07/'>
July
</a>
<span class='post-count' dir='ltr'>(5)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/06/'>
June
</a>
<span class='post-count' dir='ltr'>(4)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/05/'>
May
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/04/'>
April
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/03/'>
March
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/02/'>
February
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2015/01/'>
January
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/'>
2014
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/10/'>
October
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/09/'>
September
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/08/'>
August
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://googleprojectzero.blogspot.com/2014/07/'>
July
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<script type='text/javascript'>
//<![CDATA[
(function(){
  let archive_list = document.getElementById('ArchiveList');
  if (archive_list == null) return;
  let cur_year = archive_list.querySelector('.post-count-link').innerText.trim() - 0;
  let last_year = 2014;
  let elements = [];
  const MONTHS = ',Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec'.split(',');

  let parent = document.getElementById('ArchiveList');
  while (parent.childNodes.length) parent.removeChild(parent.childNodes[0]);

  function fetch_next_year() {
    let url = 'https://googleprojectzero.blogspot.com/?action=getTitles&widgetId=BlogArchive1&widgetType=BlogArchive&responseType=js&path=https%3A%2F%2Fgoogleprojectzero.blogspot.com%2F'+cur_year;
    fetch(url).then(resp => {
      if (!resp.ok) {
        console.log('http error');
        return;
      }
      resp.text().then(text => {
        let scope = {
          _WidgetManager: {
            _HandleControllerResult: (name, method, results) => {
              elements.push(document.createElement('hr'));
              let year_header = document.createElement('div');
              year_header.appendChild(document.createTextNode(cur_year));
              year_header.style.fontSize = 'large';
              elements.push(year_header);

              let list = document.createElement('ul');
              elements.push(list);

              for (let obj of results.posts) {
                let link_parts = obj.url.split('/');
                let year = link_parts[3];
                let month = link_parts[4];

                let el = document.createElement(/*'div'*/'li');
                el.style.listStyleType = 'square';
                el.style.listStylePosition = 'inside';
                let link = document.createElement('a');
                el.appendChild(link);
                link.appendChild(document.createTextNode(obj.title));
                link.href = obj.url;
                let date_trailer = document.createElement('span');
                el.appendChild(date_trailer);
                //date_trailer.appendChild(document.createTextNode(' ('+year+'-'+month+')'));
                date_trailer.appendChild(document.createTextNode(' ('+MONTHS[parseInt(month, 10)]+')'));
                //date_trailer.style.textAlign = 'right';
                //elements.push(el);
                list.appendChild(el);
              }
            }
          }
        };
        with (scope) { eval(text); }
        if (cur_year == last_year) {
          finish();
        } else {
          cur_year--;
          fetch_next_year();
        }
      });
    });
  }
  fetch_next_year();
  function finish() {
    for (let obj of elements) {
      parent.appendChild(obj);
    }
    console.log(elements);
  }
})();
//]]>
</script>
<div class='clear'></div>
</div>
</div></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-1'></div>
</td>
<td class='columns-cell'>
<div class='sidebar no-items section' id='sidebar-right-2-2'></div>
</td>
</tr>
</tbody>
</table>
<div class='sidebar no-items section' id='sidebar-right-3'></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/984859869-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY4y4UTxxCi-76diUsLkUVisuoHhyQ:1731692223078';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4838136820032157985','//googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html','4838136820032157985');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4838136820032157985', 'title': 'Project Zero', 'url': 'https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html', 'canonicalUrl': 'https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html', 'homepageUrl': 'https://googleprojectzero.blogspot.com/', 'searchUrl': 'https://googleprojectzero.blogspot.com/search', 'canonicalHomepageUrl': 'https://googleprojectzero.blogspot.com/', 'blogspotFaviconUrl': 'https://googleprojectzero.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-240546891-1', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Project Zero - RSS\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4838136820032157985/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Project Zero - Atom\x22 href\x3d\x22https://googleprojectzero.blogspot.com/feeds/5634534606665421566/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/3d970d7188fc7945', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '5634534606665421566', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s72-c/image2%20%285%29.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s958/image2%20%285%29.png', 'pageName': 'Windows Exploitation Tricks: Relaying DCOM Authentication', 'pageTitle': 'Project Zero: Windows Exploitation Tricks: Relaying DCOM Authentication'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Windows Exploitation Tricks: Relaying DCOM Authentication', 'description': '  Posted by James Forshaw, Project Zero     In my previous blog post \xa0I discussed the possibility of relaying Kerberos authentication from a...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEidf0_fh87eJd499r4V31gq2EoxkP1fptUl5KU9lwkDp87pFnA3qdmY3eGRB2HqY878TZp7JhPF7F_LpNcl0ax6g6bsSWgv9sSBUx-SFUXZGssDtAFvL_P_ROZPAZW9tdiUz_06DNaFgIUsqBit5HpztFCv67tZF8EILTkQmONHwZ9U7H5G0D5Dg079/s958/image2%20%285%29.png', 'url': 'https://googleprojectzero.blogspot.com/2021/10/windows-exploitation-tricks-relaying.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 5634534606665421566}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2784278825-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'sidebar-right-1', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/about-project-zero.html', 'id': '4384467920505278144', 'title': 'About Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/working-at-project-zero.html', 'id': '2459334498880008057', 'title': 'Working at Project Zero'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/0day.html', 'id': '3414239791814532209', 'title': '0day \x22In the Wild\x22'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.github.io/0days-in-the-wild/rca.html', 'title': '0day Exploit Root Cause Analyses'}, {'isCurrentPage': false, 'href': 'https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html', 'id': '2935252455704572784', 'title': 'Vulnerability Disclosure FAQ'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>