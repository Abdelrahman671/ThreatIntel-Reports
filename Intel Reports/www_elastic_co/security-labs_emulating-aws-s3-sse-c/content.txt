<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Emulating AWS S3 SSE-C Ransom for Threat Detection — Elastic Security Labs</title><meta name="description" content="In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations."/><meta property="og:title" content="Emulating AWS S3 SSE-C Ransom for Threat Detection — Elastic Security Labs"/><meta property="og:description" content="In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations."/><meta property="og:image" content="https://www.elastic.co/security-labs/assets/images/emulating-aws-s3-sse-c/Security Labs Images 11.jpg?91185baea9ec07fc21a8bc045f0afe5f"/><meta property="og:image:alt" content="In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations."/><meta property="og:site_name"/><meta property="og:url" content="https://www.elastic.co/security-labs/emulating-aws-s3-sse-c"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Emulating AWS S3 SSE-C Ransom for Threat Detection — Elastic Security Labs"/><meta name="twitter:description" content="In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations."/><meta name="twitter:image" content="https://www.elastic.co/security-labs/assets/images/emulating-aws-s3-sse-c/Security Labs Images 11.jpg?91185baea9ec07fc21a8bc045f0afe5f"/><meta name="twitter:image:alt" content="In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations."/><link rel="canonical" href="https://www.elastic.co/security-labs/emulating-aws-s3-sse-c"/><link rel="preload" href="/security-labs/logo.svg" as="image" fetchpriority="high"/><link rel="preload" as="image" imageSrcSet="/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=640&amp;q=75 640w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=750&amp;q=75 750w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=828&amp;q=75 828w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=1080&amp;q=75 1080w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=1200&amp;q=75 1200w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=1920&amp;q=75 1920w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=2048&amp;q=75 2048w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=3840&amp;q=75 3840w" imageSizes="100vw" fetchpriority="high"/><meta name="next-head-count" content="19"/><script src="https://play.vidyard.com/embed/v4.js" type="text/javascript" async=""></script><link rel="icon" href="/security-labs/favicon.svg"/><link rel="mask-icon" href="/security-labs/favicon.svg" color="#1C1E23"/><link rel="apple-touch-icon" href="/security-labs/favicon.svg"/><meta name="theme-color" content="#1C1E23"/><link rel="preload" href="/security-labs/_next/static/media/6d93bde91c0c2823-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/369c6e283c5acc6e-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/92f44bb82993d879-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/ee71530a747ff30b-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/9fac010bc1f02be0-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/security-labs/_next/static/media/cbf5fbad4d73afac-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><script id="google-tag-manager" data-nscript="beforeInteractive">
          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
          })(window,document,'script','dataLayer','GTM-KNJMG2M');
          </script><link rel="preload" href="/security-labs/_next/static/css/265ed7605fd03477.css" as="style"/><link rel="stylesheet" href="/security-labs/_next/static/css/265ed7605fd03477.css" data-n-g=""/><link rel="preload" href="/security-labs/_next/static/css/1007ff9e696f6f88.css" as="style"/><link rel="stylesheet" href="/security-labs/_next/static/css/1007ff9e696f6f88.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/security-labs/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/security-labs/_next/static/chunks/webpack-7987c6fda769d510.js" defer=""></script><script src="/security-labs/_next/static/chunks/framework-7a7e500878b44665.js" defer=""></script><script src="/security-labs/_next/static/chunks/main-ebd33a9f1cae5951.js" defer=""></script><script src="/security-labs/_next/static/chunks/pages/_app-cb8664d1d3df2511.js" defer=""></script><script src="/security-labs/_next/static/chunks/fec483df-43ee602fabdfe3a4.js" defer=""></script><script src="/security-labs/_next/static/chunks/877-34f408271ef44c22.js" defer=""></script><script src="/security-labs/_next/static/chunks/511-d08fe0fdd6f8a984.js" defer=""></script><script src="/security-labs/_next/static/chunks/683-a5053c37fe5bd0c9.js" defer=""></script><script src="/security-labs/_next/static/chunks/402-1225fd8dad6f0767.js" defer=""></script><script src="/security-labs/_next/static/chunks/616-0b017b9cfa597392.js" defer=""></script><script src="/security-labs/_next/static/chunks/pages/%5Bslug%5D-b0c191de1a3710e4.js" defer=""></script><script src="/security-labs/_next/static/33NkrIW0P_Do4IVDT5kFX/_buildManifest.js" defer=""></script><script src="/security-labs/_next/static/33NkrIW0P_Do4IVDT5kFX/_ssgManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next"><main class="__variable_0351a5 __variable_1f211e __variable_a5b5f5 flex flex-col min-h-screen"><div class="scroll-percentage-container"><div class="scroll-percentage-bar" style="width:0%"></div></div><nav class="fixed w-full z-40" data-headlessui-state=""><div class="bg-gradient-to-b from-zinc-900 from-20% h-[200%] to-transparent absolute inset-0 z-0 pointer-events-none"></div><div class="container relative z-10"><div class="flex h-16 items-center justify-between"><div class="flex items-center justify-start w-full"><div><a class="hover:opacity-50 transition" href="/security-labs"><img alt="elastic security labs logo" fetchpriority="high" width="200" height="30" decoding="async" data-nimg="1" style="color:transparent" src="/security-labs/logo.svg"/></a></div><div class="hidden lg:ml-6 lg:block"><div class="flex space-x-4"><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/about"><span>About</span></a><div class="relative" data-headlessui-state=""><div><button class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" id="headlessui-menu-button-:R2kpm:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="">Topics<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="ml-1 -mr-1 h-4 w-4 text-zinc-400 relative top-[1px]"><path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path></svg></button></div></div><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/category/vulnerability-updates"><span>Vulnerability updates</span></a><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/category/reports"><span>Reports</span></a><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="/security-labs/category/tools"><span>Tools</span></a></div></div><div class="hidden lg:ml-auto lg:block"><div class="flex items-center space-x-4"><a class="rounded flex items-center p-4 text-white focus:outline-none focus:ring-0 focus:ring-offset-1 focus:ring-offset-zinc-600 group" href="https://search.elastic.co/?location%5B0%5D=Security%20Labs&amp;referrer=https://www.elastic.co/security-labs/emulating-aws-s3-sse-c"><div class="flex items-center relative font-display"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></a><a class="flex lg:inline-flex font-light my-1 py-1 px-2 font-display font-semibold lg:text-sm xl:text-base items-center transition hover:hover-link hover:text-white focus:accessible-link-focus" href="https://www.elastic.co/security-labs/rss/feed.xml"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="h-4 w-4 mr-1"><path d="M3.75 3a.75.75 0 00-.75.75v.5c0 .414.336.75.75.75H4c6.075 0 11 4.925 11 11v.25c0 .414.336.75.75.75h.5a.75.75 0 00.75-.75V16C17 8.82 11.18 3 4 3h-.25z"></path><path d="M3 8.75A.75.75 0 013.75 8H4a8 8 0 018 8v.25a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75V16a6 6 0 00-6-6h-.25A.75.75 0 013 9.25v-.5zM7 15a2 2 0 11-4 0 2 2 0 014 0z"></path></svg><span class="hidden xl:block">Subscribe</span></a><a class="font-display inline-flex items-center justify-center rounded font-semibold disabled:!select-none disabled:!bg-gray-400 bg-blue-600 text-white hover:bg-blue-500 enabled:hover:text-white/80 transition-colors px-4 py-2 text-sm flex-1 lg:flex-auto" href="https://cloud.elastic.co/registration?cta=cloud-registration&amp;tech=trial&amp;plcmt=navigation&amp;pg=security-labs">Start free trial</a><a class="font-display inline-flex items-center justify-center rounded font-semibold text-white disabled:!select-none disabled:!bg-gray-400 button px-4 py-2 text-sm flex-1 lg:flex-auto" href="https://www.elastic.co/contact">Contact sales</a></div></div></div><div class="-mr-2 flex lg:hidden"><a class="rounded flex items-center p-4 text-white focus:outline-none focus:ring-0 focus:ring-offset-1 focus:ring-offset-zinc-600 group" href="https://search.elastic.co/?location%5B0%5D=Security%20Labs&amp;referrer=https://www.elastic.co/security-labs/emulating-aws-s3-sse-c"><div class="flex items-center relative font-display"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"></path></svg></div></a><button class="inline-flex items-center justify-center rounded-md p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white" id="headlessui-disclosure-button-:R59m:" type="button" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open navigation menu</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="block h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path></svg></button></div></div></div></nav><main class="mb-20 flex-1 flex flex-col"><div class="h-48 md:h-64"><div class="after:absolute after:block after:bg-blue-400 after:blur-3xl after:content-[&#x27; &#x27;] after:h-96 after:opacity-5 after:right-0 after:rounded-full after:top-20 after:w-1/2 after:z-0 before:absolute before:block before:blur-3xl before:bg-orange-400 before:content-[&#x27; &#x27;] before:h-96 before:left-0 before:opacity-5 before:rounded-full before:w-1/2 before:z-0 w-full h-full relative"><div class="relative z-10 w-full h-[125%] -top-[25%] bg-no-repeat bg-cover bg-bottom flex items-center justify-center" style="background-image:url(/security-labs/grid.svg)"></div></div></div><article class="px-4"><div class="max-w-7xl mx-auto relative z-10 flex flex-col space-y-4"><div class="eyebrow break-words"><time class="block mb-2 md:mb-0 md:inline-block article-published-date" dateTime="2025-02-20T00:00:00.000Z">20 February 2025</time><span class="hidden md:inline-block md:mx-2">•</span><a class="hover:text-blue-400 text-xs md:text-sm whitespace-nowrap author-name" href="/security-labs/author/terrance-dejesus">Terrance DeJesus</a></div><h1 class="font-bold leading-tighter text-3xl md:text-5xl"><span>Emulating AWS S3 SSE-&nbsp;C Ransom for Threat&nbsp;Detection</span></h1><p class="text-zinc-200 text-base md:text-xl">Understanding and Detecting Ransom Using AWS S3’ SSE-C Service</p><div class="flex items-center mt-4 text-zinc-200 text-sm space-x-4 border-t border-white/25 pt-4"><span class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-4 w-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>21 min read</span></span><span class="flex items-center space-x-1"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="h-4 w-4 text-zinc-400"><path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z"></path></svg><span><a class="hover:text-blue-400 whitespace-nowrap" href="/security-labs/category/security-research">Security research</a></span></span></div></div><div class="max-w-7xl mx-auto"><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 sm:p-8 md:p-10 rounded-3xl mt-5 md:mt-10"><div class="relative w-full rounded-lg overflow-hidden aspect-video"><img alt="Emulating AWS S3 SSE-C Ransom for Threat Detection" fetchpriority="high" decoding="async" data-nimg="fill" class="object-cover absolute h-full w-full" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent" sizes="100vw" srcSet="/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=640&amp;q=75 640w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=750&amp;q=75 750w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=828&amp;q=75 828w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=1080&amp;q=75 1080w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=1200&amp;q=75 1200w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=1920&amp;q=75 1920w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=2048&amp;q=75 2048w, /security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=3840&amp;q=75 3840w" src="/security-labs/_next/image?url=%2Fsecurity-labs%2Fassets%2Fimages%2Femulating-aws-s3-sse-c%2FSecurity%20Labs%20Images%2011.jpg&amp;w=3840&amp;q=75"/><div class="absolute border border-white/50 inset-0 mix-blend-overlay rounded-lg z-10"></div></div></div></div><div class="lg:max-w-7xl mx-auto relative mt-12 lg:grid lg:grid-cols-4 lg:gap-8 items-start"><div class="flex justify-center lg:col-span-3"><div class="prose lg:prose-lg prose-invert w-full article-content"><div><h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="preamble" class="absolute -top-32"></span>Preamble</h1>
<p>Welcome to another installment of AWS detection engineering with Elastic. You can read the previous installment on <a href="https://www.elastic.co/security-labs/exploring-aws-sts-assumeroot">STS AssumeRoot here</a>.</p>
<p>In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations. This contemporary abuse tactic demonstrates the creative ways adversaries can exploit native cloud services to achieve their monetary goals.</p>
<p>As a reader, you’ll gain insights into the inner workings of S3, SSE-C workflows, and bucket configurations. We’ll also walk through the steps of this technique, discuss best practices for securing S3 buckets, and provide actionable guidance for crafting detection logic to identify SSE-C abuse in your environment.</p>
<p>This research builds on a recent <a href="https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c">publication</a> by the Halcyon Research Team, which documented the first publicly known case of in-the-wild (ItW) abuse of SSE-C for ransomware behavior. Join us as we dive deeper into this emerging threat and demonstrate how to stay ahead of adversaries.</p>
<p>We have published a <a href="https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9">gist</a> containing the Terraform code and emulation script referenced in this blog. This content is provided for educational and research purposes only. Please use it responsibly and in accordance with applicable laws and guidelines. Elastic assumes no liability for any unintended consequences or misuse.</p>
<p>Do enjoy!</p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="understanding-aws-s3-key-security-concepts-and-features" class="absolute -top-32"></span>Understanding AWS S3: Key Security Concepts and Features</h1>
<p>Before we dive directly into emulation and these tactics, techniques, and procedures (TTPs), let’s briefly review what AWS S3 includes.</p>
<p>S3 is AWS’ common storage service that allows users to store any unstructured or structured data in “buckets”. These buckets are similar to folders that one would find locally on their computer system. The data stored in these buckets are called <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingObjects.html">objects</a>, and each object is uniquely identified by an object key, which functions like a filename. S3 supports many data formats, from JSON to media files and much more, making it ideal for a variety of organizational use cases.</p>
<p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html">Buckets</a> can be <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/creating-buckets-s3.html">set up</a> to store objects from various AWS S3 services, but they can also be populated manually or programmatically depending on the use case. Additionally, buckets can leverage versioning to maintain multiple versions of objects, which provides resilience against accidental deletions or overwrites. However, versioning is not always enabled by default, leaving data vulnerable to certain types of attacks, such as those involving ransomware or bulk deletions.
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html">Buckets</a> can be <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/creating-buckets-s3.html">set up</a> to store objects from various AWS S3 services, but they can also be populated manually or programmatically depending on the use case. Additionally, buckets can leverage versioning to maintain multiple versions of objects, which provides resilience against accidental deletions or overwrites. However, versioning is not always enabled by default, leaving data vulnerable to certain types of attacks, such as those involving ransomware or bulk deletions.</p>
<p>Access to these buckets depends heavily on their access policies, typically defined during creation. These policies include settings such as disabling public access to prevent unintended exposure of bucket contents. Configuration doesn’t stop there, though; buckets also have their own unique Amazon Resource Name (ARN), which allows further granular access policies to be defined via identity access management (IAM) roles or policies. For example, if user “Alice” needs access to a bucket and its objects, specific permissions such as <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:GetObject</code>, must be assigned to their IAM role. That role can either be applied directly to Alice as a permission policy or to an associated group they belong to.</p>
<p>While these mechanisms seem foolproof, misconfigurations in access controls (e.g., overly permissive bucket policies or access control lists) are a common cause of security incidents. For example, as of this writing, approximately 325.8k buckets are publicly available according to <a href="http://buckets.grayhatwarfare.com">buckets.grayhatwarfare.com</a>. Elastic Security Labs also observed that 30% of failed AWS posture checks were connected to S3 in the <a href="https://www.elastic.co/resources/security/report/global-threat-report">2024 Elastic Global Threat Report</a>.</p>
<p><strong>Server-Side Encryption in S3</strong><br/>
<!-- -->S3 provides <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html">multiple encryption options</a> for securing data at rest. These include:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingServerSideEncryption.html">SSE-S3</a>: Encryption keys are fully managed by AWS.</li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html">SSE-KMS</a>: Keys are managed through AWS Key Management Service (KMS), allowing for more custom key policies and access control — see how these are <a href="https://www.elastic.co/blog/encryption-at-rest-elastic-cloud-aws-kms">implemented in Elastic</a>.</li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html">SSE-C</a>: Customers provide their own encryption keys for added control. This option is often used for compliance or specific security requirements but introduces additional operational overhead, such as securely managing and storing keys. Importantly, AWS does not store SSE-C keys; instead, a key’s HMAC (hash-based message authentication code) is logged for verification purposes.</li>
</ul>
<p>In the case of SSE-C, mismanagement of encryption keys or intentional abuse (e.g., ransomware) can render data permanently inaccessible.</p>
<p><strong>Lifecycle Policies</strong></p>
<p>S3 buckets can also utilize <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html">lifecycle policies</a>, which automate actions such as transitioning objects to cheaper storage classes (e.g., Glacier) or deleting objects after a specified time. While these policies are typically used for cost optimization, they can be exploited by attackers to schedule the deletion of critical data, increasing pressure during a ransom incident.</p>
<p><strong>Storage Classes</strong></p>
<p>Amazon S3 provides multiple <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/storage-class-intro.html">storage classes</a>, each designed for different access patterns and frequency needs. While storage classes are typically chosen for cost optimization, understanding them is crucial when considering how encryption and security interact with data storage.</p>
<p>For example, S3 Standard and Intelligent-Tiering ensure frequent access with minimal latency, making them suitable for live applications. On the other hand, archival classes like Glacier Flexible Retrieval and Deep Archive introduce delays before data can be accessed, which can complicate incident response in security scenarios.</p>
<p>This becomes particularly relevant when encryption is introduced. Server-Side Encryption (SSE) works across all storage classes, but SSE-C (Customer-Provided Keys) shifts the responsibility of key management to the user or adversary. Unlike AWS-managed encryption (SSE-S3, SSE-KMS), SSE-C requires that every retrieval operation supplies the original encryption key — and if that key is lost or not given by an adversary, the data is permanently unrecoverable.</p>
<p>With this understanding, a critical question arises about the implications of SSE-C abuse observed in the wild: What happens when an attacker gains access to publicly exposed or misconfigured S3 buckets and has control over both the storage policy and encryption keys?</p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="thus-begins-sse-c-abuse-for-ransom-operations" class="absolute -top-32"></span>Thus Begins: SSE-C Abuse for Ransom Operations</h1>
<p>In the following section, we will share a hands-on approach to emulating this behavior in our sandbox AWS environment by completing the following:</p>
<ol>
<li>Deploy vulnerable infrastructure via Infrastructure-as-Code (IaC) provider Terraform</li>
<li>Explore how to craft SSE-C requests in Python</li>
<li>Detonate a custom script to emulate the ransom behavior described in the Halcyon blog</li>
</ol>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="pre-requisites" class="absolute -top-32"></span>Pre-requisites</h2>
<p>This article is about recreating a specific scenario for detection engineering. If this is your goal, the following needs to be established first.</p>
<ul>
<li><a href="https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli">Terraform</a> must be installed locally</li>
<li>Python 3.9+ must also be installed locally to be used for the virtual environment and to run an emulation script</li>
<li><a href="https://aws.amazon.com/cli/">AWS CLI</a> profile must be set up with administrative privileges to be used by Terraform during infrastructure deployment</li>
</ul>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="deploying-vulnerable-infrastructure" class="absolute -top-32"></span>Deploying Vulnerable Infrastructure</h1>
<p>For our whitebox emulation, it is important to replicate an S3 configuration that an organization might have in a real-world scenario. Below is a summary of the infrastructure deployed:</p>
<ul>
<li><strong>Region</strong>: us-east-1 (default deployment region)</li>
<li><strong>S3 Bucket</strong>: A uniquely named payroll data bucket that contains sensitive data and allows adversary-controlled encryption</li>
<li><strong>Bucket Ownership Controls</strong>: Enforces &quot;BucketOwnerEnforced&quot; to prevent ACL-based permissions</li>
<li><strong>Public Access Restrictions</strong>: Public access is fully blocked to prevent accidental exposure</li>
<li><strong>IAM User</strong>: A compromised adversary-controlled IAM user with excessive S3 permissions;no login profile is assigned, as access key credentials are used programmatically elsewhere for automated tasks</li>
<li><strong>IAM Policy</strong>: At both bucket and object levels, adversaries have authorization to:<!-- -->
<ul>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:GetObject</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:PutObject</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:DeleteObject</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:PutLifecycleConfiguration</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:ListObjects</code></li>
<li><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:ListBucket</code></li>
</ul>
</li>
<li>Applied at both bucket and object levels</li>
<li><strong>IAM Access Keys</strong>: Access keys are generated for the adversary user, allowing programmatic access</li>
<li><strong>Dummy Data</strong>: Simulated sensitive data (<code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">customer_data.csv</code>) is uploaded to the bucket</li>
</ul>
<p>Understanding the infrastructure is critical for assessing how this type of attack unfolds. The Halcyon blog describes the attack methodology but provides little detail on the specific AWS configuration of the affected organizations. These details are essential for determining the feasibility of such an attack and the steps required for successful execution.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="bucket-accessibility-and-exposure" class="absolute -top-32"></span>Bucket Accessibility and Exposure</h2>
<p>For an attack of this nature to occur, an adversary must gain access to an S3 bucket through one of two primary methods:</p>
<p><strong>Publicly Accessible Buckets</strong>: If a bucket is misconfigured with a public access policy, an adversary can directly interact with it, provided the bucket’s permission policy allows actions such as <em><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:PutObject</code></em>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:DeleteObject</code>, or <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:PutLifecycleConfiguration</code>. These permissions are often mistakenly assigned using a wildcard (*) principal, meaning anyone can execute these operations.</p>
<p><strong>Compromised Credentials</strong>: If an attacker obtains AWS credentials (via credential leaks, phishing, or malware), they can authenticate as a legitimate IAM user and interact with S3 as if they were the intended account owner.</p>
<p>In our emulation, we assume the bucket is not public, meaning the attack relies on compromised credentials. This requires the adversary to have obtained valid AWS access keys and to have performed cloud infrastructure discovery to identify accessible S3 buckets. This is commonly done using AWS API calls, such as <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:ListAllMyBuckets</code>, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:ListBuckets</code>, or <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3:ListObjects</code>, which reveal buckets and their contents in specific regions.</p>
<p><strong>Required IAM Permissions for Attack Execution:</strong> To encrypt files using SSE-C and enforce a deletion policy successfully, the adversary must have appropriate IAM permissions. In our emulation, we configured explicit permissions for the compromised IAM user, but in a real-world scenario, multiple permission models could allow this attack:</p>
<ul>
<li><strong>Custom Overly-Permissive Policies</strong>: Organizations may unknowingly grant broad S3 permissions without strict constraints.</li>
<li><strong>AWS-Managed Policies:</strong> The adversary may have obtained credentials associated with a user or role that has <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">AmazonS3FullAccess</code> or <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">AdministratorAccess</code>.</li>
<li><strong>Partial Object-Level Permissions</strong>: If the IAM user had <em><code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">AllObjectActions</code></em>, this would only allow object-level actions but would not grant lifecycle policy modifications or bucket listing, which are necessary to retrieve objects and then iterate them to encrypt and overwrite.</li>
</ul>
<p>The Halcyon blog does not specify which permissions were abused, but our whitebox emulation ensures that the minimum necessary permissions are in place for the attack to function as described.</p>
<p><strong>The Role of the Compromised IAM User</strong><br/>
<!-- -->Another critical factor is the type of IAM user whose credentials were compromised. In AWS, an adversary does not necessarily need credentials for a user that has an interactive login profile. Many IAM users are created exclusively for programmatic access and do not require an AWS Management Console password or Multi-Factor Authentication (MFA), both of which could serve as additional security blockers.</p>
<p>This means that if the stolen credentials belonging to an IAM user are used for automation or service integration, the attacker would have an easier time executing API requests without additional authentication challenges.</p>
<p>While the Halcyon blog effectively documents the technique used in this attack, it does not include details about the victim&#x27;s underlying AWS configuration. Understanding the infrastructure behind the attacks — such as bucket access, IAM permissions, and user roles — is essential to assessing how these ransom operations unfold in practice. Since these details are not provided, we must make informed assumptions to better understand the conditions that allowed the attack to succeed.</p>
<p>Our emulation is designed to replicate the minimum necessary conditions for this type of attack, ensuring a realistic assessment of defensive strategies and threat detection capabilities. By exploring the technical aspects of the infrastructure, we can provide deeper insights into potential mitigations and how organizations can proactively defend against similar threats.</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="setting-up-infrastructure" class="absolute -top-32"></span>Setting Up Infrastructure</h2>
<p>For our infrastructure deployment, we utilize Terraform as our IaC framework. To keep this publication streamlined, we have stored both the Terraform configuration and the atomic emulation script in a downloadable <a href="https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9">gist</a> for easy access. Below is the expected local file structure once these files are downloaded.</p>
<p></p>
<p>After setting up the required files locally, you can create a Python virtual environment for this scenario and install the necessary dependencies. Once the environment is configured, the following command will initialize Terraform and deploy the infrastructure:</p>
<p>Command: <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">python3 s3\_sse\_c\_ransom.py deploy</code></p>
<p></p>
<p>Once deployment is complete, the required AWS infrastructure will be in place to proceed with the emulation and execution of the attack. It’s important to note that public access is blocked, and the IAM policy is only applied to the dynamically generated IAM user for security reasons. However, we strongly recommend tearing down the infrastructure once testing is complete or after capturing the necessary data.</p>
<p>If you happen to log in to your AWS console or use the CLI, you can verify that the bucket in the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">us-east-1</code> region exists and contains <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">customer_data.csv,</code> which, when downloaded, will be in plaintext. You will also note that no “ransom.note” exists either.</p>
<p></p>
<p></p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="explore-how-to-craft-s3-sse-c-requests-in-python" class="absolute -top-32"></span>Explore How to Craft S3 SSE-C Requests in Python</h2>
<p>Before executing the atomic emulation, it is important to explore the underlying tradecraft that enables an adversary to successfully carry out this attack ItW.</p>
<p>For those familiar with AWS, S3 operations — such as accessing buckets, listing objects, or encrypting data — are typically straightforward when using the AWS SDKs or AWS CLI. These tools abstract much of the complexity, allowing users to execute operations without needing a deep understanding of the underlying API mechanics. This also lowers the knowledge barrier for an adversary attempting to abuse these functionalities.</p>
<p>However, the Halcyon blog notes a critical technical detail about the attack execution:</p>
<p>“<em>The attacker initiates the encryption process by calling the x-amz-server-side-encryption-customer-algorithm header, utilizing an AES-256 encryption key they generate and store locally.</em>”</p>
<p>The key distinction here is the use of the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">x-amz-server-side-encryption-customer-algorithm</code> header, which is required for encryption operations in this attack. According to AWS <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html#ssec-and-presignedurl">documentation</a>, this SSE-C header is typically specified when creating pre-signed URLs and leveraging SSE-C in S3. This means that the attacker not only encrypts the victim&#x27;s data but does so in a way that AWS itself does not store the encryption key, rendering recovery impossible without the attacker&#x27;s cooperation.</p>
<h3 class="font-bold leading-tight text-xl md:text-3xl relative"><span id="pre-signed-urls-and-their-role-in-sse-c-abuse" class="absolute -top-32"></span>Pre-Signed URLs and Their Role in SSE-C Abuse</h3>
<p><strong>What are pre-signed URLs?</strong><br/>
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-presigned-url.html">Pre-signed URLs</a> are signed API requests that allow users to perform specific S3 operations for a limited time. These URLs are commonly used to securely share objects without exposing AWS credentials. A pre-signed URL grants temporary access to an S3 object and can be accessed through a browser or used programmatically in API requests.</p>
<p>In a typical AWS environment, users leverage SDKs or CLI wrappers for pre-signed URLs. However, when using SSE-C, AWS requires additional headers for encryption or decryption.</p>
<p><strong>SSE-C and Required HTTP Headers</strong><br/>
<!-- -->When making SSE-C requests — either via the AWS SDK or direct S3 REST API calls — the following headers must be included:</p>
<ul>
<li><strong>x-amz-server-side​-encryption​-customer-algorithm</strong>: Specify the encryption algorithm, but must be AES256 (Noted in Halcyon’s report)</li>
<li><strong>x-amz-server-side​-encryption​-customer-key</strong>: Provides a 256-bit, base64-encoded encryption key for S3 to use to encrypt or decrypt your data</li>
<li><strong>x-amz-server-side​-encryption​-customer-key-MD5</strong>: Provides a base64-encoded 128-bit MD5 digest of the encryption key; S3 uses this header for a message integrity check to ensure that the encryption key was transmitted without error or tampering</li>
</ul>
<p>When looking for detection opportunities, these details are crucial.</p>
<p><strong>AWS Signature Version 4 (SigV4) and Its Role</strong></p>
<p>Requests to S3 are either authenticated or anonymous. Since SSE-C encryption with pre-signed URLs requires <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html#signing-request-intro">authentication</a>, all requests must be cryptographically signed to prove their legitimacy. This is where AWS Signature Version 4 (SigV4) comes in.</p>
<p>AWS SigV4 is an authentication mechanism that ensures API requests to AWS services are signed and verified. This is particularly important for SSE-C operations, as modifying objects in S3 requires authenticated API calls.</p>
<p>For this attack, each encryption request must be signed by:</p>
<ol>
<li>Generating a cryptographic signature using AWS SigV4</li>
<li>Including the signature in the request headers</li>
<li>Attaching the necessary SSE-C encryption headers</li>
<li>Sending the request to S3 to overwrite the object with the encrypted version</li>
</ol>
<p>Without proper SigV4 signing, AWS would reject these requests. Attacks like the one described by Halcyon rely on compromised credentials, and we know that because the requests were not rejected in our testing. It also suggests that adversaries know they can abuse AWS S3 misconfigurations like improper signing requirements and understand the intricacies of buckets and their respect object access controls.This reinforces the assumption that the attack relied on compromised AWS credentials rather than an exposed, publicly accessible S3 bucket and that the adversaries were skilled enough to understand the nuances with not only S3 buckets and objects but also authentication and encryption in AWS.</p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="detonating-our-atomic-emulation" class="absolute -top-32"></span>Detonating our Atomic Emulation</h1>
<p>Our atomic emulation will use the “compromised” credentials of the IAM user with no login profile who has a permission policy attached that allows several S3 actions to our target bucket. As a reminder, the infrastructure and environment we are conducting this in was deployed from the “Setting Up Infrastructure” section referencing our shared gist.</p>
<p>Below is a step-by-step workflow of the emulation.</p>
<ol>
<li>Load stolen AWS credentials (Retrieved from environment variables)</li>
<li>Establish S3 client with compromised credentials</li>
<li>Generate S3 endpoint URL (Construct the bucket’s URL)</li>
<li>Enumerate S3 objects → s3:ListObjectsV2 (Retrieve object list)</li>
<li>Generate AES-256 encryption key (Locally generated)</li>
<li>Start Loop (For each object in bucket)<!-- -->
<ol>
<li>Generate GET request &amp; sign with AWS SigV4 (authenticate request)</li>
<li>Retrieve object from S3 → s3:GetObject (fetch unencrypted data)</li>
<li>Generate PUT request &amp; sign with AWS SigV4 (attach SSE-C headers)</li>
<li>Encrypt &amp; overwrite object in S3 → s3:PutObject (encrypt with SSE-C)</li>
</ol>
</li>
<li>End loop</li>
<li>Apply 7-Day deletion policy → s3:PutLifecycleConfiguration (time-restricted data destruction)</li>
<li>Upload ransom note to S3 → s3:PutObject (Extortion message left for victim)</li>
</ol>
<p>Below is a visual representation of this emulation workflow:</p>
<p></p>
<p>In our Python script, we have intentionally added prompts that require user interaction to confirm they agree to not abuse this script. Another prompt generated during detonation that stalls execution for the user to give time for AWS investigation if necessary before deleting the S3 objects. Since SSE-C is used, the objects are then encrypted with a key the terraform does not have acces to and thus would fail.</p>
<p>Command: <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">python s3\_sse\_c\_ransom.py detonate</code></p>
<p>After detonation, the objects in our S3 bucket will be encrypted with SSE-C, a ransom note will have been uploaded, and an expiration lifecycle will have been added.</p>
<p></p>
<p></p>
<p>If you try to access the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">customer_data.csv</code> object, AWS will reject the request because it was stored using server-side encryption. To retrieve the object, a signed request that includes the correct AES-256 encryption key is required.</p>
<p></p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="cleanup" class="absolute -top-32"></span>Cleanup</h1>
<p>Cleanup for this emulation is relatively simple. If you choose to keep the S3 objects, start with Step 1, otherwise go straight to step 5.</p>
<ol>
<li>Go to <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">us-east-1</code> region</li>
<li>navigate to S3</li>
<li>locate the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">s3-sse-c-ransomware-payroll-XX bucket</code></li>
<li>remove all objects</li>
<li>Command: <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">python s3\_sse\_c\_ransom.py cleanup</code></li>
</ol>
<p>Once completed, everything deployed initially will be removed.</p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="detection-and-hunting-strategies" class="absolute -top-32"></span>Detection and Hunting Strategies</h1>
<p>After our atomic emulation, it’s critical to share how we can effectively detect this ransom behavior based on the API event logs provided by AWS’ CloudTrail. Note that we will be leveraging <a href="https://www.elastic.co/elastic-stack">Elastic Stack</a> for data ingestion and initial query development; however, the query logic and context should be translatable to <a href="https://www.elastic.co/security/siem">your SIEM of choice</a>. It is also important to note that data events for S3 in your CloudTrail configuration should be set to “Log all events.”</p>
<h2 class="font-bold text-2xl md:text-4xl relative"><span id="unusual-aws-s3-object-encryption-with-sse-c" class="absolute -top-32"></span>Unusual AWS S3 Object Encryption with SSE-C</h2>
<p>The goal of this detection strategy is to identify PutObject requests that leverage SSE-C, as customer-provided encryption keys can be a strong indicator of anomalous activity — especially if an organization primarily uses AWS-managed encryption through KMS (SSE-KMS) or S3&#x27;s native encryption (SSE-S3).</p>
<p>In our emulation, <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">PutObject</code> requests were configured with the <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">x-amz-server-side-encryption-customer-algorithm</code> header set to <code class="px-1.5 py-1 rounded not-prose bg-[var(--tw-prose-invert-pre-bg)] whitespace-break-spaces text-[85%] text-emerald-600">AES256</code>, signaling to AWS that customer-provided keys were used for encryption (SSE-C).</p>
<p>Fortunately, AWS CloudTrail logs these encryption details within request parameters, allowing security teams to detect unusual SSE-C usage. Key CloudTrail attributes to monitor include:</p>
<ul>
<li><em>SignatureVersion</em>: SigV4 → Signals that this request was signed</li>
<li><em>SSEApplied: SSE_C</em> → Signals that server-side customer key encryption was used</li>
<li><em>bucketName: s3-sse-c-ransomware-payroll-96</em> → Signals which bucket this happened to</li>
<li><em>x-amz-server-side-encryption-customer-algorithm: AES256</em> → Signals which algorithm was used for the customer encryption key</li>
<li><em>key: customer_data.csv</em> → Indicates the name of the object this was applied to</li>
</ul>
<p></p>
<p>With these details we can already craft a threat detection query that would match these events and ultimately the threat reported in the original Halcyon blog.</p>
<div class="table-container"><table style="width:100%;table-layout:fixed;word-wrap:break-word"><thead><tr><th align="left">event.dataset: &quot;aws.cloudtrail&quot; and event.provider: &quot;s3.amazonaws.com&quot; and event.action: &quot;PutObject&quot; and event.outcome: &quot;success&quot; and aws.cloudtrail.flattened.request_parameters.x-amz-server-side-encryption-customer-algorithm: &quot;AES256&quot; and aws.cloudtrail.flattened.additional_eventdata.SSEApplied: &quot;SSE_C&quot;</th></tr></thead></table></div>
<p>While this detection is broad, organizations should tailor it to their environment by asking:</p>
<ul>
<li>Do we expect pre-signed URLs with SigV4 for S3 bucket or object operations?</li>
<li>Do we expect SSE-C to be used for <em>PutObject</em> operations in S3 or this specific bucket?</li>
</ul>
<p><strong>Reducing False-Positives With New Term Rule Types</strong><br/>
<!-- -->To minimize false positives (FPs), we can leverage Elastic’s <a href="https://www.elastic.co/guide/en/security/current/rules-ui-create.html#create-new-terms-rule">New Terms rule type</a>, which helps detect first-time occurrences of suspicious activity. Instead of alerting on every match, we track unique combinations of IAM users and affected S3 buckets, only generating an alert when this behavior is observed for the first time within a set period. Some of the unique combinations we watch for are:</p>
<ul>
<li>Unique IAM users (ARNs) performing SSE-C encryption in S3.</li>
<li>Specific buckets where SSE-C is applied.</li>
</ul>
<p>These alerts only trigger if this activity has been observed for the first time in the last 14 days.</p>
<p>This adaptive approach ensures that legitimate use cases are learned over time, preventing repeated alerts on expected operations. At the same time, it flags anomalous first-time occurrences of SSE-C in S3, aiding in early threat detection. As needed, rule exceptions can be added for specific user identity ARNs, buckets, objects, or even source IPs to refine detection logic. By incorporating historical context and behavioral baselines, this method enhances signal fidelity, improving both the effectiveness of detections and the actionability of alerts.</p>
<p><strong>Rule References</strong></p>
<p><a href="https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_unusual_object_encryption_with_sse_c.toml">Unusual AWS S3 Object Encryption with SSE-C</a><br/>
<a href="https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_excessive_object_encryption_with_sse_c.toml">Excessive AWS S3 Object Encryption with SSE-C</a></p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="conclusion" class="absolute -top-32"></span>Conclusion</h1>
<p>We sincerely appreciate you taking the time to read this publication and, if you did, for trying out the emulation yourself. Whitebox testing plays a crucial role in cloud security, enabling us to replicate real-world threats, analyze their behavioral patterns, and develop effective detection strategies. With cloud-based attacks becoming increasingly prevalent, it is essential to understand the tooling behind adversary tactics and to share research findings with the broader security community.</p>
<p>If you&#x27;re interested in exploring our AWS detection ruleset, you can find it here: <a href="https://github.com/elastic/detection-rules/tree/main/rules/integrations/aws">Elastic AWS Detection Rules</a>. We also welcome <a href="https://github.com/elastic/detection-rules/tree/main?tab=readme-ov-file#how-to-contribute">contributions</a> to enhance our ruleset—your efforts help strengthen collective defenses, and we greatly appreciate them!</p>
<p>We encourage anyone with interest to review Halcyon’s publication and thank them ahead of time for sharing their research!</p>
<p>Until next time.</p>
<h1 class="font-bold leading-tighter text-3xl md:text-5xl relative"><span id="important-references" class="absolute -top-32"></span>Important References:</h1>
<p><a href="https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c">Halcyon Research Blog on SSE-C ItW</a><br/>
<a href="https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9">Elastic Emulation Code for SSE-C in AWS</a><br/>
<a href="https://github.com/elastic/detection-rules/tree/main/rules/integrations/aws">Elastic Pre-built AWS Threat Detection Ruleset</a><br/>
<a href="https://github.com/elastic/detection-rules">Elastic Pre-built Detection Rules Repository</a><br/>
<!-- -->Rule: <a href="https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_unusual_object_encryption_with_sse_c.toml">Unusual AWS S3 Object Encryption with SSE-C</a><br/>
<!-- -->Rule: <a href="https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_excessive_object_encryption_with_sse_c.toml">Excessive AWS S3 Object Encryption with SSE-C</a></p></div></div></div><div class="hidden lg:flex lg:col-span-1 text-sm lg:flex-col lg:space-y-6"><div class="toc"><h4 class="font-bold leading-tight text-lg md:text-2xl mb-3">Jump to section</h4><ul class="flex flex-col space-y-2"><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/emulating-aws-s3-sse-c#pre-requisites"><span>Pre-&nbsp;requisites</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/emulating-aws-s3-sse-c#bucket-accessibility-and-exposure"><span>Bucket Accessibility and&nbsp;Exposure</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/emulating-aws-s3-sse-c#setting-up-infrastructure"><span>Setting Up&nbsp;Infrastructure</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/emulating-aws-s3-sse-c#explore-how-to-craft-s3-sse-c-requests-in-python"><span>Explore How to Craft S3 SSE-&nbsp;C Requests in&nbsp;Python</span></a></li><li><a class="flex items-center space-x-1 hover:text-white ml-4" href="/security-labs/emulating-aws-s3-sse-c#pre-signed-urls-and-their-role-in-sse-c-abuse"><span>Pre-&nbsp;Signed URLs and Their Role in SSE-&nbsp;C&nbsp;Abuse</span></a></li><li><a class="flex items-center space-x-1 hover:text-white" href="/security-labs/emulating-aws-s3-sse-c#unusual-aws-s3-object-encryption-with-sse-c"><span>Unusual AWS S3 Object Encryption with&nbsp;SSE-&nbsp;C</span></a></li></ul></div><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 md:p-2 sm:p-4 md:px-6 md:py-4 rounded-xl"><h4 class="font-bold leading-tight text-lg md:text-2xl mb-3">Elastic Security Labs Newsletter</h4><div><a target="_blank" class="button inline-flex" href="https://www.elastic.co/elastic-security-labs/newsletter?utm_source=security-labs">Sign Up</a></div></div></div></div><div class="bg-zinc-900 border border-zinc-800 drop-shadow-lg p-5 md:p-2 sm:p-4 md:px-6 md:py-4 rounded-xl my-5 md:my-10 max-w-3xl mx-auto flex flex-col items-center shadow-2xl"><h4 class="font-bold leading-tight text-lg md:text-2xl">Share this article</h4><div class="flex flex-wrap items-center justify-center mt-4 space-x-4"><a class="flex items-center space-x-2 button" href="https://twitter.com/intent/tweet?text=Emulating AWS S3 SSE-C Ransom for Threat Detection&amp;url=https://www.elastic.co/security-labs/emulating-aws-s3-sse-c" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Twitter" title="Share this article on Twitter"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M23.954 4.569c-.885.389-1.83.653-2.825.772a4.98 4.98 0 002.187-2.746 9.955 9.955 0 01-3.157 1.204 4.98 4.98 0 00-8.49 4.54A14.128 14.128 0 011.69 3.05a4.98 4.98 0 001.54 6.638A4.94 4.94 0 011.2 8.62v.06a4.98 4.98 0 004 4.87 4.94 4.94 0 01-2.24.086 4.98 4.98 0 004.64 3.45A9.97 9.97 0 010 20.35a14.075 14.075 0 007.59 2.22c9.16 0 14.17-7.583 14.17-14.17 0-.217-.005-.434-.015-.65a10.128 10.128 0 002.485-2.58l-.001-.001z"></path></svg><span>Twitter</span></a><a class="flex items-center space-x-2 button" href="https://www.facebook.com/sharer/sharer.php?u=https://www.elastic.co/security-labs/emulating-aws-s3-sse-c" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Facebook" title="Share this article on Facebook"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M22.5 12c0-5.799-4.701-10.5-10.5-10.5S1.5 6.201 1.5 12c0 5.301 3.901 9.699 9 10.401V14.4h-2.7v-2.7h2.7v-2.1c0-2.7 1.8-4.2 4.2-4.2 1.2 0 2.1.1 2.4.2v2.4h-1.5c-1.2 0-1.5.6-1.5 1.5v1.8h3l-.3 2.7h-2.7V22C18.599 21.3 22.5 17.301 22.5 12z"></path></svg><span>Facebook</span></a><a class="flex items-center space-x-2 button" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.elastic.co/security-labs/emulating-aws-s3-sse-c&amp;title=Emulating AWS S3 SSE-C Ransom for Threat Detection" target="_blank" rel="noopener noreferrer" aria-label="Share this article on LinkedIn" title="Share this article on LinkedIn"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="currentColor" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg><span>LinkedIn</span></a><a class="flex items-center space-x-2 button" href="https://reddit.com/submit?url=https://www.elastic.co/security-labs/emulating-aws-s3-sse-c&amp;title=Emulating AWS S3 SSE-C Ransom for Threat Detection" target="_blank" rel="noopener noreferrer" aria-label="Share this article on Reddit" title="Share this article on Reddit"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill-rule="evenodd" clip-rule="evenodd" d="M24 12C24 18.6274 18.6274 24 12 24C5.37258 24 0 18.6274 0 12C0 5.37258 5.37258 0 12 0C18.6274 0 24 5.37258 24 12ZM19.6879 11.0584C19.8819 11.3352 19.9916 11.6622 20.004 12C20.0091 12.3306 19.9205 12.656 19.7485 12.9384C19.5765 13.2208 19.3281 13.4488 19.032 13.596C19.0455 13.7717 19.0455 13.9483 19.032 14.124C19.032 16.812 15.9 18.996 12.036 18.996C8.172 18.996 5.04 16.812 5.04 14.124C5.02649 13.9483 5.02649 13.7717 5.04 13.596C4.80919 13.49 4.6042 13.335 4.43923 13.1419C4.27427 12.9487 4.15327 12.722 4.08462 12.4775C4.01598 12.2329 4.00133 11.9764 4.04169 11.7256C4.08205 11.4748 4.17646 11.2358 4.31837 11.0251C4.46028 10.8145 4.6463 10.6372 4.86354 10.5056C5.08078 10.3739 5.32404 10.2911 5.57646 10.2629C5.82889 10.2346 6.08444 10.2616 6.32541 10.3419C6.56638 10.4222 6.78701 10.5539 6.972 10.728C8.35473 9.79023 9.98146 9.27718 11.652 9.252L12.54 5.088C12.55 5.03979 12.5694 4.99405 12.5972 4.95341C12.625 4.91277 12.6605 4.87805 12.7018 4.85127C12.7431 4.82448 12.7894 4.80615 12.8378 4.79735C12.8862 4.78855 12.9359 4.78945 12.984 4.8L15.924 5.388C16.0676 5.14132 16.2944 4.9539 16.5637 4.85937C16.833 4.76484 17.1272 4.7694 17.3934 4.87222C17.6597 4.97505 17.8806 5.1694 18.0164 5.42041C18.1523 5.67141 18.1942 5.96262 18.1348 6.24177C18.0753 6.52092 17.9182 6.76972 17.6918 6.94352C17.4654 7.11732 17.1845 7.20473 16.8995 7.19006C16.6144 7.1754 16.3439 7.05962 16.1366 6.8635C15.9292 6.66738 15.7985 6.40378 15.768 6.12L13.2 5.58L12.42 9.324C14.0702 9.3594 15.6749 9.87206 17.04 10.8C17.2839 10.566 17.5902 10.4074 17.9221 10.3436C18.254 10.2797 18.5973 10.3132 18.9106 10.4401C19.2239 10.5669 19.4939 10.7817 19.6879 11.0584ZM8.20624 12.5333C8.07438 12.7307 8.004 12.9627 8.004 13.2C8.004 13.5183 8.13043 13.8235 8.35547 14.0485C8.58051 14.2736 8.88574 14.4 9.204 14.4C9.44134 14.4 9.67335 14.3296 9.87068 14.1978C10.068 14.0659 10.2218 13.8785 10.3127 13.6592C10.4035 13.4399 10.4272 13.1987 10.3809 12.9659C10.3346 12.7331 10.2204 12.5193 10.0525 12.3515C9.8847 12.1836 9.67089 12.0694 9.43811 12.0231C9.20533 11.9768 8.96405 12.0005 8.74478 12.0913C8.52551 12.1822 8.33809 12.336 8.20624 12.5333ZM12.012 17.424C13.0771 17.4681 14.1246 17.1416 14.976 16.5V16.548C15.0075 16.5173 15.0327 16.4806 15.05 16.4402C15.0674 16.3997 15.0766 16.3563 15.0772 16.3122C15.0777 16.2682 15.0696 16.2245 15.0533 16.1837C15.0369 16.1428 15.0127 16.1055 14.982 16.074C14.9513 16.0425 14.9146 16.0173 14.8742 16C14.8337 15.9826 14.7903 15.9734 14.7462 15.9728C14.7022 15.9723 14.6585 15.9804 14.6177 15.9967C14.5768 16.0131 14.5395 16.0373 14.508 16.068C13.7797 16.5904 12.895 16.8487 12 16.8C11.1061 16.8399 10.2255 16.5732 9.504 16.044C9.44182 15.993 9.36289 15.9669 9.28256 15.9708C9.20222 15.9748 9.12622 16.0085 9.06935 16.0653C9.01247 16.1222 8.97879 16.1982 8.97484 16.2786C8.97089 16.3589 8.99697 16.4378 9.048 16.5C9.89937 17.1416 10.9469 17.4681 12.012 17.424ZM14.0933 14.2458C14.2907 14.3776 14.5227 14.448 14.76 14.448L14.748 14.496C14.9107 14.4978 15.0721 14.4664 15.2223 14.4038C15.3725 14.3413 15.5084 14.2488 15.6218 14.1321C15.7352 14.0154 15.8236 13.8768 15.8818 13.7248C15.9399 13.5728 15.9665 13.4106 15.96 13.248C15.96 13.0107 15.8896 12.7787 15.7578 12.5813C15.6259 12.384 15.4385 12.2302 15.2192 12.1393C14.9999 12.0485 14.7587 12.0248 14.5259 12.0711C14.2931 12.1174 14.0793 12.2316 13.9115 12.3995C13.7436 12.5673 13.6294 12.7811 13.5831 13.0139C13.5368 13.2467 13.5605 13.4879 13.6513 13.7072C13.7422 13.9265 13.896 14.1139 14.0933 14.2458Z" fill="currentColor"></path></svg><span>Reddit</span></a></div></div></article></main><footer class="mt-auto text-xs md:text-sm"><div class="container py-6 flex flex-col md:flex-row gap-2 md:gap-0 justify-between items-center"><div class="text-zinc-300"><nav><ul class="flex space-x-4"><li><a class="hover:text-white font-medium" href="/security-labs/sitemap.xml">Sitemap</a></li><li><a class="hover:text-white font-medium flex items-center space-x-1" href="https://elastic.co?utm_source=elastic-search-labs&amp;utm_medium=referral&amp;utm_campaign=search-labs&amp;utm_content=footer"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" class="inline-block w-3 h-3"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg><span>Elastic.co</span></a></li><li><a class="hover:text-white font-medium flex items-center space-x-1" href="https://twitter.com/elasticseclabs"><svg class="w-4 h-4 inline-block w-3 h-3" viewBox="0 0 24 24"><path fill="currentColor" d="M23.954 4.569c-.885.389-1.83.653-2.825.772a4.98 4.98 0 002.187-2.746 9.955 9.955 0 01-3.157 1.204 4.98 4.98 0 00-8.49 4.54A14.128 14.128 0 011.69 3.05a4.98 4.98 0 001.54 6.638A4.94 4.94 0 011.2 8.62v.06a4.98 4.98 0 004 4.87 4.94 4.94 0 01-2.24.086 4.98 4.98 0 004.64 3.45A9.97 9.97 0 010 20.35a14.075 14.075 0 007.59 2.22c9.16 0 14.17-7.583 14.17-14.17 0-.217-.005-.434-.015-.65a10.128 10.128 0 002.485-2.58l-.001-.001z"></path></svg><span>@elasticseclabs</span></a></li></ul></nav></div><div class="flex flex-col space-y-1 text-zinc-300"><p>© <!-- -->2025<!-- -->. Elasticsearch B.V. All Rights Reserved.</p></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"title":"Emulating AWS S3 SSE-C Ransom for Threat Detection","slug":"emulating-aws-s3-sse-c","date":"2025-02-20","description":"In this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations.","image":"Security Labs Images 11.jpg","subtitle":"Understanding and Detecting Ransom Using AWS S3’ SSE-C Service","body":{"raw":"\n# Preamble\n\nWelcome to another installment of AWS detection engineering with Elastic. You can read the previous installment on [STS AssumeRoot here](https://www.elastic.co/security-labs/exploring-aws-sts-assumeroot). \n\nIn this article, we’ll explore how threat actors leverage Amazon S3’s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations. This contemporary abuse tactic demonstrates the creative ways adversaries can exploit native cloud services to achieve their monetary goals.\n\nAs a reader, you’ll gain insights into the inner workings of S3, SSE-C workflows, and bucket configurations. We’ll also walk through the steps of this technique, discuss best practices for securing S3 buckets, and provide actionable guidance for crafting detection logic to identify SSE-C abuse in your environment.\n\nThis research builds on a recent [publication](https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c) by the Halcyon Research Team, which documented the first publicly known case of in-the-wild (ItW) abuse of SSE-C for ransomware behavior. Join us as we dive deeper into this emerging threat and demonstrate how to stay ahead of adversaries. \n\nWe have published a [gist](https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9) containing the Terraform code and emulation script referenced in this blog. This content is provided for educational and research purposes only. Please use it responsibly and in accordance with applicable laws and guidelines. Elastic assumes no liability for any unintended consequences or misuse.\n\nDo enjoy!\n\n# Understanding AWS S3: Key Security Concepts and Features\n\nBefore we dive directly into emulation and these tactics, techniques, and procedures (TTPs), let’s briefly review what AWS S3 includes.\n\nS3 is AWS’ common storage service that allows users to store any unstructured or structured data in “buckets”. These buckets are similar to folders that one would find locally on their computer system. The data stored in these buckets are called [objects](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingObjects.html), and each object is uniquely identified by an object key, which functions like a filename. S3 supports many data formats, from JSON to media files and much more, making it ideal for a variety of organizational use cases.\n\n[Buckets](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html) can be [set up](https://docs.aws.amazon.com/AmazonS3/latest/userguide/creating-buckets-s3.html) to store objects from various AWS S3 services, but they can also be populated manually or programmatically depending on the use case. Additionally, buckets can leverage versioning to maintain multiple versions of objects, which provides resilience against accidental deletions or overwrites. However, versioning is not always enabled by default, leaving data vulnerable to certain types of attacks, such as those involving ransomware or bulk deletions.\n[Buckets](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html) can be [set up](https://docs.aws.amazon.com/AmazonS3/latest/userguide/creating-buckets-s3.html) to store objects from various AWS S3 services, but they can also be populated manually or programmatically depending on the use case. Additionally, buckets can leverage versioning to maintain multiple versions of objects, which provides resilience against accidental deletions or overwrites. However, versioning is not always enabled by default, leaving data vulnerable to certain types of attacks, such as those involving ransomware or bulk deletions.\n\nAccess to these buckets depends heavily on their access policies, typically defined during creation. These policies include settings such as disabling public access to prevent unintended exposure of bucket contents. Configuration doesn’t stop there, though; buckets also have their own unique Amazon Resource Name (ARN), which allows further granular access policies to be defined via identity access management (IAM) roles or policies. For example, if user “Alice” needs access to a bucket and its objects, specific permissions such as `s3:GetObject`, must be assigned to their IAM role. That role can either be applied directly to Alice as a permission policy or to an associated group they belong to.\n\nWhile these mechanisms seem foolproof, misconfigurations in access controls (e.g., overly permissive bucket policies or access control lists) are a common cause of security incidents. For example, as of this writing, approximately 325.8k buckets are publicly available according to [buckets.grayhatwarfare.com](http://buckets.grayhatwarfare.com). Elastic Security Labs also observed that 30% of failed AWS posture checks were connected to S3 in the [2024 Elastic Global Threat Report](https://www.elastic.co/resources/security/report/global-threat-report). \n\n**Server-Side Encryption in S3**  \nS3 provides [multiple encryption options](https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html) for securing data at rest. These include:\n\n* [SSE-S3](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingServerSideEncryption.html): Encryption keys are fully managed by AWS.  \n* [SSE-KMS](https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html): Keys are managed through AWS Key Management Service (KMS), allowing for more custom key policies and access control — see how these are [implemented in Elastic](https://www.elastic.co/blog/encryption-at-rest-elastic-cloud-aws-kms).  \n* [SSE-C](https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html): Customers provide their own encryption keys for added control. This option is often used for compliance or specific security requirements but introduces additional operational overhead, such as securely managing and storing keys. Importantly, AWS does not store SSE-C keys; instead, a key’s HMAC (hash-based message authentication code) is logged for verification purposes.\n\nIn the case of SSE-C, mismanagement of encryption keys or intentional abuse (e.g., ransomware) can render data permanently inaccessible.\n\n**Lifecycle Policies**\n\nS3 buckets can also utilize [lifecycle policies](https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html), which automate actions such as transitioning objects to cheaper storage classes (e.g., Glacier) or deleting objects after a specified time. While these policies are typically used for cost optimization, they can be exploited by attackers to schedule the deletion of critical data, increasing pressure during a ransom incident.\n\n**Storage Classes**\n\nAmazon S3 provides multiple [storage classes](https://docs.aws.amazon.com/AmazonS3/latest/userguide/storage-class-intro.html), each designed for different access patterns and frequency needs. While storage classes are typically chosen for cost optimization, understanding them is crucial when considering how encryption and security interact with data storage.\n\nFor example, S3 Standard and Intelligent-Tiering ensure frequent access with minimal latency, making them suitable for live applications. On the other hand, archival classes like Glacier Flexible Retrieval and Deep Archive introduce delays before data can be accessed, which can complicate incident response in security scenarios.\n\nThis becomes particularly relevant when encryption is introduced. Server-Side Encryption (SSE) works across all storage classes, but SSE-C (Customer-Provided Keys) shifts the responsibility of key management to the user or adversary. Unlike AWS-managed encryption (SSE-S3, SSE-KMS), SSE-C requires that every retrieval operation supplies the original encryption key — and if that key is lost or not given by an adversary, the data is permanently unrecoverable.\n\nWith this understanding, a critical question arises about the implications of SSE-C abuse observed in the wild: What happens when an attacker gains access to publicly exposed or misconfigured S3 buckets and has control over both the storage policy and encryption keys?\n\n# Thus Begins: SSE-C Abuse for Ransom Operations\n\nIn the following section, we will share a hands-on approach to emulating this behavior in our sandbox AWS environment by completing the following:\n\n1. Deploy vulnerable infrastructure via Infrastructure-as-Code (IaC) provider Terraform  \n2. Explore how to craft SSE-C requests in Python  \n3. Detonate a custom script to emulate the ransom behavior described in the Halcyon blog\n\n## Pre-requisites\n\nThis article is about recreating a specific scenario for detection engineering. If this is your goal, the following needs to be established first.\n\n* [Terraform](https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli) must be installed locally  \n* Python 3.9+ must also be installed locally to be used for the virtual environment and to run an emulation script  \n* [AWS CLI](https://aws.amazon.com/cli/) profile must be set up with administrative privileges to be used by Terraform during infrastructure deployment\n\n# Deploying Vulnerable Infrastructure\n\nFor our whitebox emulation, it is important to replicate an S3 configuration that an organization might have in a real-world scenario. Below is a summary of the infrastructure deployed:\n\n* **Region**: us-east-1 (default deployment region)  \n* **S3 Bucket**: A uniquely named payroll data bucket that contains sensitive data and allows adversary-controlled encryption  \n* **Bucket Ownership Controls**: Enforces \"BucketOwnerEnforced\" to prevent ACL-based permissions  \n* **Public Access Restrictions**: Public access is fully blocked to prevent accidental exposure  \n* **IAM User**: A compromised adversary-controlled IAM user with excessive S3 permissions;no login profile is assigned, as access key credentials are used programmatically elsewhere for automated tasks  \n* **IAM Policy**: At both bucket and object levels, adversaries have authorization to:  \n  * `s3:GetObject`  \n  * `s3:PutObject`  \n  * `s3:DeleteObject`  \n  * `s3:PutLifecycleConfiguration`  \n  * `s3:ListObjects`  \n  * `s3:ListBucket`  \n* Applied at both bucket and object levels  \n* **IAM Access Keys**: Access keys are generated for the adversary user, allowing programmatic access  \n* **Dummy Data**: Simulated sensitive data (`customer_data.csv`) is uploaded to the bucket\n\nUnderstanding the infrastructure is critical for assessing how this type of attack unfolds. The Halcyon blog describes the attack methodology but provides little detail on the specific AWS configuration of the affected organizations. These details are essential for determining the feasibility of such an attack and the steps required for successful execution.\n\n## Bucket Accessibility and Exposure\n\nFor an attack of this nature to occur, an adversary must gain access to an S3 bucket through one of two primary methods:\n\n**Publicly Accessible Buckets**: If a bucket is misconfigured with a public access policy, an adversary can directly interact with it, provided the bucket’s permission policy allows actions such as *`s3:PutObject`*, `s3:DeleteObject`, or `s3:PutLifecycleConfiguration`. These permissions are often mistakenly assigned using a wildcard (\\*) principal, meaning anyone can execute these operations.\n\n**Compromised Credentials**: If an attacker obtains AWS credentials (via credential leaks, phishing, or malware), they can authenticate as a legitimate IAM user and interact with S3 as if they were the intended account owner.\n\nIn our emulation, we assume the bucket is not public, meaning the attack relies on compromised credentials. This requires the adversary to have obtained valid AWS access keys and to have performed cloud infrastructure discovery to identify accessible S3 buckets. This is commonly done using AWS API calls, such as `s3:ListAllMyBuckets`, `s3:ListBuckets`, or `s3:ListObjects`, which reveal buckets and their contents in specific regions.\n\n**Required IAM Permissions for Attack Execution:** To encrypt files using SSE-C and enforce a deletion policy successfully, the adversary must have appropriate IAM permissions. In our emulation, we configured explicit permissions for the compromised IAM user, but in a real-world scenario, multiple permission models could allow this attack:\n\n* **Custom Overly-Permissive Policies**: Organizations may unknowingly grant broad S3 permissions without strict constraints.  \n* **AWS-Managed Policies:** The adversary may have obtained credentials associated with a user or role that has `AmazonS3FullAccess` or `AdministratorAccess`.  \n* **Partial Object-Level Permissions**: If the IAM user had *`AllObjectActions`*, this would only allow object-level actions but would not grant lifecycle policy modifications or bucket listing, which are necessary to retrieve objects and then iterate them to encrypt and overwrite.\n\nThe Halcyon blog does not specify which permissions were abused, but our whitebox emulation ensures that the minimum necessary permissions are in place for the attack to function as described.\n\n**The Role of the Compromised IAM User**  \nAnother critical factor is the type of IAM user whose credentials were compromised. In AWS, an adversary does not necessarily need credentials for a user that has an interactive login profile. Many IAM users are created exclusively for programmatic access and do not require an AWS Management Console password or Multi-Factor Authentication (MFA), both of which could serve as additional security blockers.\n\nThis means that if the stolen credentials belonging to an IAM user are used for automation or service integration, the attacker would have an easier time executing API requests without additional authentication challenges.\n\nWhile the Halcyon blog effectively documents the technique used in this attack, it does not include details about the victim's underlying AWS configuration. Understanding the infrastructure behind the attacks — such as bucket access, IAM permissions, and user roles — is essential to assessing how these ransom operations unfold in practice. Since these details are not provided, we must make informed assumptions to better understand the conditions that allowed the attack to succeed.\n\nOur emulation is designed to replicate the minimum necessary conditions for this type of attack, ensuring a realistic assessment of defensive strategies and threat detection capabilities. By exploring the technical aspects of the infrastructure, we can provide deeper insights into potential mitigations and how organizations can proactively defend against similar threats.\n\n## Setting Up Infrastructure\n\nFor our infrastructure deployment, we utilize Terraform as our IaC framework. To keep this publication streamlined, we have stored both the Terraform configuration and the atomic emulation script in a downloadable [gist](https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9) for easy access. Below is the expected local file structure once these files are downloaded.\n\n![Necessary folder structure when downloading gist](/assets/images/emulating-aws-s3-sse-c/image2.png)\n\nAfter setting up the required files locally, you can create a Python virtual environment for this scenario and install the necessary dependencies. Once the environment is configured, the following command will initialize Terraform and deploy the infrastructure:\n\nCommand: `python3 s3\\_sse\\_c\\_ransom.py deploy`\n\n![Expected console output after terraform initialized and deployed](/assets/images/emulating-aws-s3-sse-c/image7.png)\n\nOnce deployment is complete, the required AWS infrastructure will be in place to proceed with the emulation and execution of the attack. It’s important to note that public access is blocked, and the IAM policy is only applied to the dynamically generated IAM user for security reasons. However, we strongly recommend tearing down the infrastructure once testing is complete or after capturing the necessary data.\n\nIf you happen to log in to your AWS console or use the CLI, you can verify that the bucket in the `us-east-1` region exists and contains `customer_data.csv,` which, when downloaded, will be in plaintext. You will also note that no “ransom.note” exists either.\n\n![Example of infrastructure deployed with unencrypted customer data in our S3 bucket](/assets/images/emulating-aws-s3-sse-c/image6.png)\n\n![Another example of infrastructure deployed with no ransom.txt file yet](/assets/images/emulating-aws-s3-sse-c/image4.png)\n\n## Explore How to Craft S3 SSE-C Requests in Python\n\nBefore executing the atomic emulation, it is important to explore the underlying tradecraft that enables an adversary to successfully carry out this attack ItW.\n\nFor those familiar with AWS, S3 operations — such as accessing buckets, listing objects, or encrypting data — are typically straightforward when using the AWS SDKs or AWS CLI. These tools abstract much of the complexity, allowing users to execute operations without needing a deep understanding of the underlying API mechanics. This also lowers the knowledge barrier for an adversary attempting to abuse these functionalities.\n\nHowever, the Halcyon blog notes a critical technical detail about the attack execution:\n\n“*The attacker initiates the encryption process by calling the x-amz-server-side-encryption-customer-algorithm header, utilizing an AES-256 encryption key they generate and store locally.*”\n\nThe key distinction here is the use of the `x-amz-server-side-encryption-customer-algorithm` header, which is required for encryption operations in this attack. According to AWS [documentation](https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html#ssec-and-presignedurl), this SSE-C header is typically specified when creating pre-signed URLs and leveraging SSE-C in S3. This means that the attacker not only encrypts the victim's data but does so in a way that AWS itself does not store the encryption key, rendering recovery impossible without the attacker's cooperation.\n\n### Pre-Signed URLs and Their Role in SSE-C Abuse\n\n**What are pre-signed URLs?**  \n[Pre-signed URLs](https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-presigned-url.html) are signed API requests that allow users to perform specific S3 operations for a limited time. These URLs are commonly used to securely share objects without exposing AWS credentials. A pre-signed URL grants temporary access to an S3 object and can be accessed through a browser or used programmatically in API requests.\n\nIn a typical AWS environment, users leverage SDKs or CLI wrappers for pre-signed URLs. However, when using SSE-C, AWS requires additional headers for encryption or decryption.\n\n**SSE-C and Required HTTP Headers**  \nWhen making SSE-C requests — either via the AWS SDK or direct S3 REST API calls — the following headers must be included:\n\n* **x-amz-server-side​-encryption​-customer-algorithm**: Specify the encryption algorithm, but must be AES256 (Noted in Halcyon’s report)  \n* **x-amz-server-side​-encryption​-customer-key**: Provides a 256-bit, base64-encoded encryption key for S3 to use to encrypt or decrypt your data  \n* **x-amz-server-side​-encryption​-customer-key-MD5**: Provides a base64-encoded 128-bit MD5 digest of the encryption key; S3 uses this header for a message integrity check to ensure that the encryption key was transmitted without error or tampering\n\nWhen looking for detection opportunities, these details are crucial.\n\n**AWS Signature Version 4 (SigV4) and Its Role**\n\nRequests to S3 are either authenticated or anonymous. Since SSE-C encryption with pre-signed URLs requires [authentication](https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html#signing-request-intro), all requests must be cryptographically signed to prove their legitimacy. This is where AWS Signature Version 4 (SigV4) comes in.\n\nAWS SigV4 is an authentication mechanism that ensures API requests to AWS services are signed and verified. This is particularly important for SSE-C operations, as modifying objects in S3 requires authenticated API calls.\n\nFor this attack, each encryption request must be signed by:\n\n1. Generating a cryptographic signature using AWS SigV4  \n2. Including the signature in the request headers  \n3. Attaching the necessary SSE-C encryption headers  \n4. Sending the request to S3 to overwrite the object with the encrypted version\n\nWithout proper SigV4 signing, AWS would reject these requests. Attacks like the one described by Halcyon rely on compromised credentials, and we know that because the requests were not rejected in our testing. It also suggests that adversaries know they can abuse AWS S3 misconfigurations like improper signing requirements and understand the intricacies of buckets and their respect object access controls.This reinforces the assumption that the attack relied on compromised AWS credentials rather than an exposed, publicly accessible S3 bucket and that the adversaries were skilled enough to understand the nuances with not only S3 buckets and objects but also authentication and encryption in AWS.\n\n# Detonating our Atomic Emulation\n\nOur atomic emulation will use the “compromised” credentials of the IAM user with no login profile who has a permission policy attached that allows several S3 actions to our target bucket. As a reminder, the infrastructure and environment we are conducting this in was deployed from the “Setting Up Infrastructure” section referencing our shared gist.\n\nBelow is a step-by-step workflow of the emulation.\n\n1. Load stolen AWS credentials (Retrieved from environment variables)  \n2. Establish S3 client with compromised credentials  \n3. Generate S3 endpoint URL (Construct the bucket’s URL)  \n4. Enumerate S3 objects → s3:ListObjectsV2 (Retrieve object list)  \n5. Generate AES-256 encryption key (Locally generated)  \n6. Start Loop (For each object in bucket)  \n   1. Generate GET request \u0026 sign with AWS SigV4 (authenticate request)  \n   2. Retrieve object from S3 → s3:GetObject (fetch unencrypted data)  \n   3. Generate PUT request \u0026 sign with AWS SigV4 (attach SSE-C headers)  \n   4. Encrypt \u0026 overwrite object in S3 → s3:PutObject (encrypt with SSE-C)  \n7. End loop  \n8. Apply 7-Day deletion policy → s3:PutLifecycleConfiguration (time-restricted data destruction)  \n9. Upload ransom note to S3 → s3:PutObject (Extortion message left for victim)\n\nBelow is a visual representation of this emulation workflow:\n\n![Visual representation of emulation workflow](/assets/images/emulating-aws-s3-sse-c/image10.png)\n\nIn our Python script, we have intentionally added prompts that require user interaction to confirm they agree to not abuse this script. Another prompt generated during detonation that stalls execution for the user to give time for AWS investigation if necessary before deleting the S3 objects. Since SSE-C is used, the objects are then encrypted with a key the terraform does not have acces to and thus would fail.\n\nCommand: `python s3\\_sse\\_c\\_ransom.py detonate`\n\nAfter detonation, the objects in our S3 bucket will be encrypted with SSE-C, a ransom note will have been uploaded, and an expiration lifecycle will have been added.\n\n![Expected console output when detonating SSE-C ransom emulation](/assets/images/emulating-aws-s3-sse-c/image3.png)\n\n![Expected artifacts in S3 bucket after detonating SSE-C ransom emulation](/assets/images/emulating-aws-s3-sse-c/image5.png)\n\nIf you try to access the `customer_data.csv` object, AWS will reject the request because it was stored using server-side encryption. To retrieve the object, a signed request that includes the correct AES-256 encryption key is required.\n\n![Expected error when retrieving objects from S3 bucket after SSE-C encryption](/assets/images/emulating-aws-s3-sse-c/image1.png)\n\n# Cleanup\n\nCleanup for this emulation is relatively simple. If you choose to keep the S3 objects, start with Step 1, otherwise go straight to step 5\\. \n\n1. Go to `us-east-1` region  \n2. navigate to S3  \n3. locate the `s3-sse-c-ransomware-payroll-XX bucket`  \n4. remove all objects  \n5. Command: `python s3\\_sse\\_c\\_ransom.py cleanup`\n\nOnce completed, everything deployed initially will be removed.\n\n# Detection and Hunting Strategies\n\nAfter our atomic emulation, it’s critical to share how we can effectively detect this ransom behavior based on the API event logs provided by AWS’ CloudTrail. Note that we will be leveraging [Elastic Stack](https://www.elastic.co/elastic-stack) for data ingestion and initial query development; however, the query logic and context should be translatable to [your SIEM of choice](https://www.elastic.co/security/siem). It is also important to note that data events for S3 in your CloudTrail configuration should be set to “Log all events.”\n\n## Unusual AWS S3 Object Encryption with SSE-C\n\nThe goal of this detection strategy is to identify PutObject requests that leverage SSE-C, as customer-provided encryption keys can be a strong indicator of anomalous activity — especially if an organization primarily uses AWS-managed encryption through KMS (SSE-KMS) or S3's native encryption (SSE-S3).\n\nIn our emulation, `PutObject` requests were configured with the `x-amz-server-side-encryption-customer-algorithm` header set to `AES256`, signaling to AWS that customer-provided keys were used for encryption (SSE-C).\n\nFortunately, AWS CloudTrail logs these encryption details within request parameters, allowing security teams to detect unusual SSE-C usage. Key CloudTrail attributes to monitor include:\n\n* *SignatureVersion*: SigV4 → Signals that this request was signed  \n* *SSEApplied: SSE\\_C* → Signals that server-side customer key encryption was used  \n* *bucketName: s3-sse-c-ransomware-payroll-96* → Signals which bucket this happened to  \n* *x-amz-server-side-encryption-customer-algorithm: AES256* → Signals which algorithm was used for the customer encryption key  \n* *key: customer\\_data.csv* → Indicates the name of the object this was applied to\n\n![Partial Elastic document from CloudTrail ingestion showing SSE-C request from emulation](/assets/images/emulating-aws-s3-sse-c/image9.png)\n\nWith these details we can already craft a threat detection query that would match these events and ultimately the threat reported in the original Halcyon blog.\n\n| event.dataset: \"aws.cloudtrail\" and event.provider: \"s3.amazonaws.com\" and event.action: \"PutObject\" and event.outcome: \"success\" and aws.cloudtrail.flattened.request\\_parameters.x-amz-server-side-encryption-customer-algorithm: \"AES256\" and aws.cloudtrail.flattened.additional\\_eventdata.SSEApplied: \"SSE\\_C\" |\n| :---- |\n\nWhile this detection is broad, organizations should tailor it to their environment by asking:\n\n* Do we expect pre-signed URLs with SigV4 for S3 bucket or object operations?  \n* Do we expect SSE-C to be used for *PutObject* operations in S3 or this specific bucket?\n\n**Reducing False-Positives With New Term Rule Types**  \nTo minimize false positives (FPs), we can leverage Elastic’s [New Terms rule type](https://www.elastic.co/guide/en/security/current/rules-ui-create.html#create-new-terms-rule), which helps detect first-time occurrences of suspicious activity. Instead of alerting on every match, we track unique combinations of IAM users and affected S3 buckets, only generating an alert when this behavior is observed for the first time within a set period. Some of the unique combinations we watch for are:\n\n* Unique IAM users (ARNs) performing SSE-C encryption in S3.  \n* Specific buckets where SSE-C is applied.\n\nThese alerts only trigger if this activity has been observed for the first time in the last 14 days.\n\nThis adaptive approach ensures that legitimate use cases are learned over time, preventing repeated alerts on expected operations. At the same time, it flags anomalous first-time occurrences of SSE-C in S3, aiding in early threat detection. As needed, rule exceptions can be added for specific user identity ARNs, buckets, objects, or even source IPs to refine detection logic. By incorporating historical context and behavioral baselines, this method enhances signal fidelity, improving both the effectiveness of detections and the actionability of alerts.\n\n**Rule References**\n\n[Unusual AWS S3 Object Encryption with SSE-C](https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_unusual_object_encryption_with_sse_c.toml)  \n[Excessive AWS S3 Object Encryption with SSE-C](https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_excessive_object_encryption_with_sse_c.toml)\n\n# Conclusion\n\nWe sincerely appreciate you taking the time to read this publication and, if you did, for trying out the emulation yourself. Whitebox testing plays a crucial role in cloud security, enabling us to replicate real-world threats, analyze their behavioral patterns, and develop effective detection strategies. With cloud-based attacks becoming increasingly prevalent, it is essential to understand the tooling behind adversary tactics and to share research findings with the broader security community.\n\nIf you're interested in exploring our AWS detection ruleset, you can find it here: [Elastic AWS Detection Rules](https://github.com/elastic/detection-rules/tree/main/rules/integrations/aws). We also welcome [contributions](https://github.com/elastic/detection-rules/tree/main?tab=readme-ov-file#how-to-contribute) to enhance our ruleset—your efforts help strengthen collective defenses, and we greatly appreciate them!\n\nWe encourage anyone with interest to review Halcyon’s publication and thank them ahead of time for sharing their research!\n\nUntil next time.\n\n# Important References:\n\n[Halcyon Research Blog on SSE-C ItW](https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c)  \n[Elastic Emulation Code for SSE-C in AWS](https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9)  \n[Elastic Pre-built AWS Threat Detection Ruleset](https://github.com/elastic/detection-rules/tree/main/rules/integrations/aws)  \n[Elastic Pre-built Detection Rules Repository](https://github.com/elastic/detection-rules)  \nRule: [Unusual AWS S3 Object Encryption with SSE-C](https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_unusual_object_encryption_with_sse_c.toml)  \nRule: [Excessive AWS S3 Object Encryption with SSE-C](https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_excessive_object_encryption_with_sse_c.toml)\n","code":"var Component=(()=\u003e{var h=Object.create;var s=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var y=(i,e)=\u003e()=\u003e(e||i((e={exports:{}}).exports,e),e.exports),f=(i,e)=\u003e{for(var n in e)s(i,n,{get:e[n],enumerable:!0})},o=(i,e,n,a)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let r of p(e))!g.call(i,r)\u0026\u0026r!==n\u0026\u0026s(i,r,{get:()=\u003ee[r],enumerable:!(a=u(e,r))||a.enumerable});return i};var b=(i,e,n)=\u003e(n=i!=null?h(m(i)):{},o(e||!i||!i.__esModule?s(n,\"default\",{value:i,enumerable:!0}):n,i)),w=i=\u003eo(s({},\"__esModule\",{value:!0}),i);var l=y((C,c)=\u003e{c.exports=_jsx_runtime});var A={};f(A,{default:()=\u003ek,frontmatter:()=\u003eS});var t=b(l()),S={title:\"Emulating AWS S3 SSE-C Ransom for Threat Detection\",slug:\"emulating-aws-s3-sse-c\",date:\"2025-02-20\",subtitle:\"Understanding and Detecting Ransom Using AWS S3\\u2019 SSE-C Service\",description:\"In this article, we\\u2019ll explore how threat actors leverage Amazon S3\\u2019s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations.\",author:[{slug:\"terrance-dejesus\"}],image:\"Security Labs Images 11.jpg\",category:[{slug:\"security-research\"}]};function d(i){let e=Object.assign({h1:\"h1\",p:\"p\",a:\"a\",code:\"code\",strong:\"strong\",br:\"br\",ul:\"ul\",li:\"li\",ol:\"ol\",h2:\"h2\",em:\"em\",img:\"img\",h3:\"h3\",div:\"div\",table:\"table\",thead:\"thead\",tr:\"tr\",th:\"th\"},i.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h1,{id:\"preamble\",children:\"Preamble\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"Welcome to another installment of AWS detection engineering with Elastic. You can read the previous installment on \",(0,t.jsx)(e.a,{href:\"https://www.elastic.co/security-labs/exploring-aws-sts-assumeroot\",rel:\"nofollow\",children:\"STS AssumeRoot here\"}),\".\"]}),`\n`,(0,t.jsx)(e.p,{children:\"In this article, we\\u2019ll explore how threat actors leverage Amazon S3\\u2019s Server-Side Encryption with Customer-Provided Keys (SSE-C) for ransom/extortion operations. This contemporary abuse tactic demonstrates the creative ways adversaries can exploit native cloud services to achieve their monetary goals.\"}),`\n`,(0,t.jsx)(e.p,{children:\"As a reader, you\\u2019ll gain insights into the inner workings of S3, SSE-C workflows, and bucket configurations. We\\u2019ll also walk through the steps of this technique, discuss best practices for securing S3 buckets, and provide actionable guidance for crafting detection logic to identify SSE-C abuse in your environment.\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"This research builds on a recent \",(0,t.jsx)(e.a,{href:\"https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c\",rel:\"nofollow\",children:\"publication\"}),\" by the Halcyon Research Team, which documented the first publicly known case of in-the-wild (ItW) abuse of SSE-C for ransomware behavior. Join us as we dive deeper into this emerging threat and demonstrate how to stay ahead of adversaries.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"We have published a \",(0,t.jsx)(e.a,{href:\"https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9\",rel:\"nofollow\",children:\"gist\"}),\" containing the Terraform code and emulation script referenced in this blog. This content is provided for educational and research purposes only. Please use it responsibly and in accordance with applicable laws and guidelines. Elastic assumes no liability for any unintended consequences or misuse.\"]}),`\n`,(0,t.jsx)(e.p,{children:\"Do enjoy!\"}),`\n`,(0,t.jsx)(e.h1,{id:\"understanding-aws-s3-key-security-concepts-and-features\",children:\"Understanding AWS S3: Key Security Concepts and Features\"}),`\n`,(0,t.jsx)(e.p,{children:\"Before we dive directly into emulation and these tactics, techniques, and procedures (TTPs), let\\u2019s briefly review what AWS S3 includes.\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"S3 is AWS\\u2019 common storage service that allows users to store any unstructured or structured data in \\u201Cbuckets\\u201D. These buckets are similar to folders that one would find locally on their computer system. The data stored in these buckets are called \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingObjects.html\",rel:\"nofollow\",children:\"objects\"}),\", and each object is uniquely identified by an object key, which functions like a filename. S3 supports many data formats, from JSON to media files and much more, making it ideal for a variety of organizational use cases.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html\",rel:\"nofollow\",children:\"Buckets\"}),\" can be \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/creating-buckets-s3.html\",rel:\"nofollow\",children:\"set up\"}),` to store objects from various AWS S3 services, but they can also be populated manually or programmatically depending on the use case. Additionally, buckets can leverage versioning to maintain multiple versions of objects, which provides resilience against accidental deletions or overwrites. However, versioning is not always enabled by default, leaving data vulnerable to certain types of attacks, such as those involving ransomware or bulk deletions.\n`,(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingBucket.html\",rel:\"nofollow\",children:\"Buckets\"}),\" can be \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/creating-buckets-s3.html\",rel:\"nofollow\",children:\"set up\"}),\" to store objects from various AWS S3 services, but they can also be populated manually or programmatically depending on the use case. Additionally, buckets can leverage versioning to maintain multiple versions of objects, which provides resilience against accidental deletions or overwrites. However, versioning is not always enabled by default, leaving data vulnerable to certain types of attacks, such as those involving ransomware or bulk deletions.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"Access to these buckets depends heavily on their access policies, typically defined during creation. These policies include settings such as disabling public access to prevent unintended exposure of bucket contents. Configuration doesn\\u2019t stop there, though; buckets also have their own unique Amazon Resource Name (ARN), which allows further granular access policies to be defined via identity access management (IAM) roles or policies. For example, if user \\u201CAlice\\u201D needs access to a bucket and its objects, specific permissions such as \",(0,t.jsx)(e.code,{children:\"s3:GetObject\"}),\", must be assigned to their IAM role. That role can either be applied directly to Alice as a permission policy or to an associated group they belong to.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"While these mechanisms seem foolproof, misconfigurations in access controls (e.g., overly permissive bucket policies or access control lists) are a common cause of security incidents. For example, as of this writing, approximately 325.8k buckets are publicly available according to \",(0,t.jsx)(e.a,{href:\"http://buckets.grayhatwarfare.com\",rel:\"nofollow\",children:\"buckets.grayhatwarfare.com\"}),\". Elastic Security Labs also observed that 30% of failed AWS posture checks were connected to S3 in the \",(0,t.jsx)(e.a,{href:\"https://www.elastic.co/resources/security/report/global-threat-report\",rel:\"nofollow\",children:\"2024 Elastic Global Threat Report\"}),\".\"]}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"Server-Side Encryption in S3\"}),(0,t.jsx)(e.br,{}),`\n`,\"S3 provides \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html\",rel:\"nofollow\",children:\"multiple encryption options\"}),\" for securing data at rest. These include:\"]}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingServerSideEncryption.html\",rel:\"nofollow\",children:\"SSE-S3\"}),\": Encryption keys are fully managed by AWS.\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html\",rel:\"nofollow\",children:\"SSE-KMS\"}),\": Keys are managed through AWS Key Management Service (KMS), allowing for more custom key policies and access control \\u2014 see how these are \",(0,t.jsx)(e.a,{href:\"https://www.elastic.co/blog/encryption-at-rest-elastic-cloud-aws-kms\",rel:\"nofollow\",children:\"implemented in Elastic\"}),\".\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html\",rel:\"nofollow\",children:\"SSE-C\"}),\": Customers provide their own encryption keys for added control. This option is often used for compliance or specific security requirements but introduces additional operational overhead, such as securely managing and storing keys. Importantly, AWS does not store SSE-C keys; instead, a key\\u2019s HMAC (hash-based message authentication code) is logged for verification purposes.\"]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"In the case of SSE-C, mismanagement of encryption keys or intentional abuse (e.g., ransomware) can render data permanently inaccessible.\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:\"Lifecycle Policies\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"S3 buckets can also utilize \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html\",rel:\"nofollow\",children:\"lifecycle policies\"}),\", which automate actions such as transitioning objects to cheaper storage classes (e.g., Glacier) or deleting objects after a specified time. While these policies are typically used for cost optimization, they can be exploited by attackers to schedule the deletion of critical data, increasing pressure during a ransom incident.\"]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:\"Storage Classes\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"Amazon S3 provides multiple \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/storage-class-intro.html\",rel:\"nofollow\",children:\"storage classes\"}),\", each designed for different access patterns and frequency needs. While storage classes are typically chosen for cost optimization, understanding them is crucial when considering how encryption and security interact with data storage.\"]}),`\n`,(0,t.jsx)(e.p,{children:\"For example, S3 Standard and Intelligent-Tiering ensure frequent access with minimal latency, making them suitable for live applications. On the other hand, archival classes like Glacier Flexible Retrieval and Deep Archive introduce delays before data can be accessed, which can complicate incident response in security scenarios.\"}),`\n`,(0,t.jsx)(e.p,{children:\"This becomes particularly relevant when encryption is introduced. Server-Side Encryption (SSE) works across all storage classes, but SSE-C (Customer-Provided Keys) shifts the responsibility of key management to the user or adversary. Unlike AWS-managed encryption (SSE-S3, SSE-KMS), SSE-C requires that every retrieval operation supplies the original encryption key \\u2014 and if that key is lost or not given by an adversary, the data is permanently unrecoverable.\"}),`\n`,(0,t.jsx)(e.p,{children:\"With this understanding, a critical question arises about the implications of SSE-C abuse observed in the wild: What happens when an attacker gains access to publicly exposed or misconfigured S3 buckets and has control over both the storage policy and encryption keys?\"}),`\n`,(0,t.jsx)(e.h1,{id:\"thus-begins-sse-c-abuse-for-ransom-operations\",children:\"Thus Begins: SSE-C Abuse for Ransom Operations\"}),`\n`,(0,t.jsx)(e.p,{children:\"In the following section, we will share a hands-on approach to emulating this behavior in our sandbox AWS environment by completing the following:\"}),`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Deploy vulnerable infrastructure via Infrastructure-as-Code (IaC) provider Terraform\"}),`\n`,(0,t.jsx)(e.li,{children:\"Explore how to craft SSE-C requests in Python\"}),`\n`,(0,t.jsx)(e.li,{children:\"Detonate a custom script to emulate the ransom behavior described in the Halcyon blog\"}),`\n`]}),`\n`,(0,t.jsx)(e.h2,{id:\"pre-requisites\",children:\"Pre-requisites\"}),`\n`,(0,t.jsx)(e.p,{children:\"This article is about recreating a specific scenario for detection engineering. If this is your goal, the following needs to be established first.\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:\"https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli\",rel:\"nofollow\",children:\"Terraform\"}),\" must be installed locally\"]}),`\n`,(0,t.jsx)(e.li,{children:\"Python 3.9+ must also be installed locally to be used for the virtual environment and to run an emulation script\"}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:\"https://aws.amazon.com/cli/\",rel:\"nofollow\",children:\"AWS CLI\"}),\" profile must be set up with administrative privileges to be used by Terraform during infrastructure deployment\"]}),`\n`]}),`\n`,(0,t.jsx)(e.h1,{id:\"deploying-vulnerable-infrastructure\",children:\"Deploying Vulnerable Infrastructure\"}),`\n`,(0,t.jsx)(e.p,{children:\"For our whitebox emulation, it is important to replicate an S3 configuration that an organization might have in a real-world scenario. Below is a summary of the infrastructure deployed:\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"Region\"}),\": us-east-1 (default deployment region)\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"S3 Bucket\"}),\": A uniquely named payroll data bucket that contains sensitive data and allows adversary-controlled encryption\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"Bucket Ownership Controls\"}),': Enforces \"BucketOwnerEnforced\" to prevent ACL-based permissions']}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"Public Access Restrictions\"}),\": Public access is fully blocked to prevent accidental exposure\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"IAM User\"}),\": A compromised adversary-controlled IAM user with excessive S3 permissions;no login profile is assigned, as access key credentials are used programmatically elsewhere for automated tasks\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"IAM Policy\"}),\": At both bucket and object levels, adversaries have authorization to:\",`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:\"s3:GetObject\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:\"s3:PutObject\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:\"s3:DeleteObject\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:\"s3:PutLifecycleConfiguration\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:\"s3:ListObjects\"})}),`\n`,(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:\"s3:ListBucket\"})}),`\n`]}),`\n`]}),`\n`,(0,t.jsx)(e.li,{children:\"Applied at both bucket and object levels\"}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"IAM Access Keys\"}),\": Access keys are generated for the adversary user, allowing programmatic access\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"Dummy Data\"}),\": Simulated sensitive data (\",(0,t.jsx)(e.code,{children:\"customer_data.csv\"}),\") is uploaded to the bucket\"]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"Understanding the infrastructure is critical for assessing how this type of attack unfolds. The Halcyon blog describes the attack methodology but provides little detail on the specific AWS configuration of the affected organizations. These details are essential for determining the feasibility of such an attack and the steps required for successful execution.\"}),`\n`,(0,t.jsx)(e.h2,{id:\"bucket-accessibility-and-exposure\",children:\"Bucket Accessibility and Exposure\"}),`\n`,(0,t.jsx)(e.p,{children:\"For an attack of this nature to occur, an adversary must gain access to an S3 bucket through one of two primary methods:\"}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"Publicly Accessible Buckets\"}),\": If a bucket is misconfigured with a public access policy, an adversary can directly interact with it, provided the bucket\\u2019s permission policy allows actions such as \",(0,t.jsx)(e.em,{children:(0,t.jsx)(e.code,{children:\"s3:PutObject\"})}),\", \",(0,t.jsx)(e.code,{children:\"s3:DeleteObject\"}),\", or \",(0,t.jsx)(e.code,{children:\"s3:PutLifecycleConfiguration\"}),\". These permissions are often mistakenly assigned using a wildcard (*) principal, meaning anyone can execute these operations.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"Compromised Credentials\"}),\": If an attacker obtains AWS credentials (via credential leaks, phishing, or malware), they can authenticate as a legitimate IAM user and interact with S3 as if they were the intended account owner.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"In our emulation, we assume the bucket is not public, meaning the attack relies on compromised credentials. This requires the adversary to have obtained valid AWS access keys and to have performed cloud infrastructure discovery to identify accessible S3 buckets. This is commonly done using AWS API calls, such as \",(0,t.jsx)(e.code,{children:\"s3:ListAllMyBuckets\"}),\", \",(0,t.jsx)(e.code,{children:\"s3:ListBuckets\"}),\", or \",(0,t.jsx)(e.code,{children:\"s3:ListObjects\"}),\", which reveal buckets and their contents in specific regions.\"]}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"Required IAM Permissions for Attack Execution:\"}),\" To encrypt files using SSE-C and enforce a deletion policy successfully, the adversary must have appropriate IAM permissions. In our emulation, we configured explicit permissions for the compromised IAM user, but in a real-world scenario, multiple permission models could allow this attack:\"]}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"Custom Overly-Permissive Policies\"}),\": Organizations may unknowingly grant broad S3 permissions without strict constraints.\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"AWS-Managed Policies:\"}),\" The adversary may have obtained credentials associated with a user or role that has \",(0,t.jsx)(e.code,{children:\"AmazonS3FullAccess\"}),\" or \",(0,t.jsx)(e.code,{children:\"AdministratorAccess\"}),\".\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"Partial Object-Level Permissions\"}),\": If the IAM user had \",(0,t.jsx)(e.em,{children:(0,t.jsx)(e.code,{children:\"AllObjectActions\"})}),\", this would only allow object-level actions but would not grant lifecycle policy modifications or bucket listing, which are necessary to retrieve objects and then iterate them to encrypt and overwrite.\"]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"The Halcyon blog does not specify which permissions were abused, but our whitebox emulation ensures that the minimum necessary permissions are in place for the attack to function as described.\"}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"The Role of the Compromised IAM User\"}),(0,t.jsx)(e.br,{}),`\n`,\"Another critical factor is the type of IAM user whose credentials were compromised. In AWS, an adversary does not necessarily need credentials for a user that has an interactive login profile. Many IAM users are created exclusively for programmatic access and do not require an AWS Management Console password or Multi-Factor Authentication (MFA), both of which could serve as additional security blockers.\"]}),`\n`,(0,t.jsx)(e.p,{children:\"This means that if the stolen credentials belonging to an IAM user are used for automation or service integration, the attacker would have an easier time executing API requests without additional authentication challenges.\"}),`\n`,(0,t.jsx)(e.p,{children:\"While the Halcyon blog effectively documents the technique used in this attack, it does not include details about the victim's underlying AWS configuration. Understanding the infrastructure behind the attacks \\u2014 such as bucket access, IAM permissions, and user roles \\u2014 is essential to assessing how these ransom operations unfold in practice. Since these details are not provided, we must make informed assumptions to better understand the conditions that allowed the attack to succeed.\"}),`\n`,(0,t.jsx)(e.p,{children:\"Our emulation is designed to replicate the minimum necessary conditions for this type of attack, ensuring a realistic assessment of defensive strategies and threat detection capabilities. By exploring the technical aspects of the infrastructure, we can provide deeper insights into potential mitigations and how organizations can proactively defend against similar threats.\"}),`\n`,(0,t.jsx)(e.h2,{id:\"setting-up-infrastructure\",children:\"Setting Up Infrastructure\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"For our infrastructure deployment, we utilize Terraform as our IaC framework. To keep this publication streamlined, we have stored both the Terraform configuration and the atomic emulation script in a downloadable \",(0,t.jsx)(e.a,{href:\"https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9\",rel:\"nofollow\",children:\"gist\"}),\" for easy access. Below is the expected local file structure once these files are downloaded.\"]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image2.png\",alt:\"Necessary folder structure when downloading gist\",width:\"395\",height:\"277\"})}),`\n`,(0,t.jsx)(e.p,{children:\"After setting up the required files locally, you can create a Python virtual environment for this scenario and install the necessary dependencies. Once the environment is configured, the following command will initialize Terraform and deploy the infrastructure:\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"Command: \",(0,t.jsx)(e.code,{children:\"python3 s3\\\\_sse\\\\_c\\\\_ransom.py deploy\"})]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image7.png\",alt:\"Expected console output after terraform initialized and deployed\",width:\"1999\",height:\"681\"})}),`\n`,(0,t.jsx)(e.p,{children:\"Once deployment is complete, the required AWS infrastructure will be in place to proceed with the emulation and execution of the attack. It\\u2019s important to note that public access is blocked, and the IAM policy is only applied to the dynamically generated IAM user for security reasons. However, we strongly recommend tearing down the infrastructure once testing is complete or after capturing the necessary data.\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"If you happen to log in to your AWS console or use the CLI, you can verify that the bucket in the \",(0,t.jsx)(e.code,{children:\"us-east-1\"}),\" region exists and contains \",(0,t.jsx)(e.code,{children:\"customer_data.csv,\"}),\" which, when downloaded, will be in plaintext. You will also note that no \\u201Cransom.note\\u201D exists either.\"]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image6.png\",alt:\"Example of infrastructure deployed with unencrypted customer data in our S3 bucket\",width:\"1999\",height:\"1223\"})}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image4.png\",alt:\"Another example of infrastructure deployed with no ransom.txt file yet\",width:\"1388\",height:\"828\"})}),`\n`,(0,t.jsx)(e.h2,{id:\"explore-how-to-craft-s3-sse-c-requests-in-python\",children:\"Explore How to Craft S3 SSE-C Requests in Python\"}),`\n`,(0,t.jsx)(e.p,{children:\"Before executing the atomic emulation, it is important to explore the underlying tradecraft that enables an adversary to successfully carry out this attack ItW.\"}),`\n`,(0,t.jsx)(e.p,{children:\"For those familiar with AWS, S3 operations \\u2014 such as accessing buckets, listing objects, or encrypting data \\u2014 are typically straightforward when using the AWS SDKs or AWS CLI. These tools abstract much of the complexity, allowing users to execute operations without needing a deep understanding of the underlying API mechanics. This also lowers the knowledge barrier for an adversary attempting to abuse these functionalities.\"}),`\n`,(0,t.jsx)(e.p,{children:\"However, the Halcyon blog notes a critical technical detail about the attack execution:\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"\\u201C\",(0,t.jsx)(e.em,{children:\"The attacker initiates the encryption process by calling the x-amz-server-side-encryption-customer-algorithm header, utilizing an AES-256 encryption key they generate and store locally.\"}),\"\\u201D\"]}),`\n`,(0,t.jsxs)(e.p,{children:[\"The key distinction here is the use of the \",(0,t.jsx)(e.code,{children:\"x-amz-server-side-encryption-customer-algorithm\"}),\" header, which is required for encryption operations in this attack. According to AWS \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerSideEncryptionCustomerKeys.html#ssec-and-presignedurl\",rel:\"nofollow\",children:\"documentation\"}),\", this SSE-C header is typically specified when creating pre-signed URLs and leveraging SSE-C in S3. This means that the attacker not only encrypts the victim's data but does so in a way that AWS itself does not store the encryption key, rendering recovery impossible without the attacker's cooperation.\"]}),`\n`,(0,t.jsx)(e.h3,{id:\"pre-signed-urls-and-their-role-in-sse-c-abuse\",children:\"Pre-Signed URLs and Their Role in SSE-C Abuse\"}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"What are pre-signed URLs?\"}),(0,t.jsx)(e.br,{}),`\n`,(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-presigned-url.html\",rel:\"nofollow\",children:\"Pre-signed URLs\"}),\" are signed API requests that allow users to perform specific S3 operations for a limited time. These URLs are commonly used to securely share objects without exposing AWS credentials. A pre-signed URL grants temporary access to an S3 object and can be accessed through a browser or used programmatically in API requests.\"]}),`\n`,(0,t.jsx)(e.p,{children:\"In a typical AWS environment, users leverage SDKs or CLI wrappers for pre-signed URLs. However, when using SSE-C, AWS requires additional headers for encryption or decryption.\"}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"SSE-C and Required HTTP Headers\"}),(0,t.jsx)(e.br,{}),`\n`,\"When making SSE-C requests \\u2014 either via the AWS SDK or direct S3 REST API calls \\u2014 the following headers must be included:\"]}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"x-amz-server-side\\u200B-encryption\\u200B-customer-algorithm\"}),\": Specify the encryption algorithm, but must be AES256 (Noted in Halcyon\\u2019s report)\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"x-amz-server-side\\u200B-encryption\\u200B-customer-key\"}),\": Provides a 256-bit, base64-encoded encryption key for S3 to use to encrypt or decrypt your data\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:\"x-amz-server-side\\u200B-encryption\\u200B-customer-key-MD5\"}),\": Provides a base64-encoded 128-bit MD5 digest of the encryption key; S3 uses this header for a message integrity check to ensure that the encryption key was transmitted without error or tampering\"]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"When looking for detection opportunities, these details are crucial.\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:\"AWS Signature Version 4 (SigV4) and Its Role\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"Requests to S3 are either authenticated or anonymous. Since SSE-C encryption with pre-signed URLs requires \",(0,t.jsx)(e.a,{href:\"https://docs.aws.amazon.com/AmazonS3/latest/API/sig-v4-authenticating-requests.html#signing-request-intro\",rel:\"nofollow\",children:\"authentication\"}),\", all requests must be cryptographically signed to prove their legitimacy. This is where AWS Signature Version 4 (SigV4) comes in.\"]}),`\n`,(0,t.jsx)(e.p,{children:\"AWS SigV4 is an authentication mechanism that ensures API requests to AWS services are signed and verified. This is particularly important for SSE-C operations, as modifying objects in S3 requires authenticated API calls.\"}),`\n`,(0,t.jsx)(e.p,{children:\"For this attack, each encryption request must be signed by:\"}),`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Generating a cryptographic signature using AWS SigV4\"}),`\n`,(0,t.jsx)(e.li,{children:\"Including the signature in the request headers\"}),`\n`,(0,t.jsx)(e.li,{children:\"Attaching the necessary SSE-C encryption headers\"}),`\n`,(0,t.jsx)(e.li,{children:\"Sending the request to S3 to overwrite the object with the encrypted version\"}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"Without proper SigV4 signing, AWS would reject these requests. Attacks like the one described by Halcyon rely on compromised credentials, and we know that because the requests were not rejected in our testing. It also suggests that adversaries know they can abuse AWS S3 misconfigurations like improper signing requirements and understand the intricacies of buckets and their respect object access controls.This reinforces the assumption that the attack relied on compromised AWS credentials rather than an exposed, publicly accessible S3 bucket and that the adversaries were skilled enough to understand the nuances with not only S3 buckets and objects but also authentication and encryption in AWS.\"}),`\n`,(0,t.jsx)(e.h1,{id:\"detonating-our-atomic-emulation\",children:\"Detonating our Atomic Emulation\"}),`\n`,(0,t.jsx)(e.p,{children:\"Our atomic emulation will use the \\u201Ccompromised\\u201D credentials of the IAM user with no login profile who has a permission policy attached that allows several S3 actions to our target bucket. As a reminder, the infrastructure and environment we are conducting this in was deployed from the \\u201CSetting Up Infrastructure\\u201D section referencing our shared gist.\"}),`\n`,(0,t.jsx)(e.p,{children:\"Below is a step-by-step workflow of the emulation.\"}),`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Load stolen AWS credentials (Retrieved from environment variables)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Establish S3 client with compromised credentials\"}),`\n`,(0,t.jsx)(e.li,{children:\"Generate S3 endpoint URL (Construct the bucket\\u2019s URL)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Enumerate S3 objects \\u2192 s3:ListObjectsV2 (Retrieve object list)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Generate AES-256 encryption key (Locally generated)\"}),`\n`,(0,t.jsxs)(e.li,{children:[\"Start Loop (For each object in bucket)\",`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Generate GET request \u0026 sign with AWS SigV4 (authenticate request)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Retrieve object from S3 \\u2192 s3:GetObject (fetch unencrypted data)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Generate PUT request \u0026 sign with AWS SigV4 (attach SSE-C headers)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Encrypt \u0026 overwrite object in S3 \\u2192 s3:PutObject (encrypt with SSE-C)\"}),`\n`]}),`\n`]}),`\n`,(0,t.jsx)(e.li,{children:\"End loop\"}),`\n`,(0,t.jsx)(e.li,{children:\"Apply 7-Day deletion policy \\u2192 s3:PutLifecycleConfiguration (time-restricted data destruction)\"}),`\n`,(0,t.jsx)(e.li,{children:\"Upload ransom note to S3 \\u2192 s3:PutObject (Extortion message left for victim)\"}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"Below is a visual representation of this emulation workflow:\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image10.png\",alt:\"Visual representation of emulation workflow\",width:\"836\",height:\"705\"})}),`\n`,(0,t.jsx)(e.p,{children:\"In our Python script, we have intentionally added prompts that require user interaction to confirm they agree to not abuse this script. Another prompt generated during detonation that stalls execution for the user to give time for AWS investigation if necessary before deleting the S3 objects. Since SSE-C is used, the objects are then encrypted with a key the terraform does not have acces to and thus would fail.\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"Command: \",(0,t.jsx)(e.code,{children:\"python s3\\\\_sse\\\\_c\\\\_ransom.py detonate\"})]}),`\n`,(0,t.jsx)(e.p,{children:\"After detonation, the objects in our S3 bucket will be encrypted with SSE-C, a ransom note will have been uploaded, and an expiration lifecycle will have been added.\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image3.png\",alt:\"Expected console output when detonating SSE-C ransom emulation\",width:\"1510\",height:\"630\"})}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image5.png\",alt:\"Expected artifacts in S3 bucket after detonating SSE-C ransom emulation\",width:\"1702\",height:\"898\"})}),`\n`,(0,t.jsxs)(e.p,{children:[\"If you try to access the \",(0,t.jsx)(e.code,{children:\"customer_data.csv\"}),\" object, AWS will reject the request because it was stored using server-side encryption. To retrieve the object, a signed request that includes the correct AES-256 encryption key is required.\"]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image1.png\",alt:\"Expected error when retrieving objects from S3 bucket after SSE-C encryption\",width:\"1999\",height:\"429\"})}),`\n`,(0,t.jsx)(e.h1,{id:\"cleanup\",children:\"Cleanup\"}),`\n`,(0,t.jsx)(e.p,{children:\"Cleanup for this emulation is relatively simple. If you choose to keep the S3 objects, start with Step 1, otherwise go straight to step 5.\"}),`\n`,(0,t.jsxs)(e.ol,{children:[`\n`,(0,t.jsxs)(e.li,{children:[\"Go to \",(0,t.jsx)(e.code,{children:\"us-east-1\"}),\" region\"]}),`\n`,(0,t.jsx)(e.li,{children:\"navigate to S3\"}),`\n`,(0,t.jsxs)(e.li,{children:[\"locate the \",(0,t.jsx)(e.code,{children:\"s3-sse-c-ransomware-payroll-XX bucket\"})]}),`\n`,(0,t.jsx)(e.li,{children:\"remove all objects\"}),`\n`,(0,t.jsxs)(e.li,{children:[\"Command: \",(0,t.jsx)(e.code,{children:\"python s3\\\\_sse\\\\_c\\\\_ransom.py cleanup\"})]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"Once completed, everything deployed initially will be removed.\"}),`\n`,(0,t.jsx)(e.h1,{id:\"detection-and-hunting-strategies\",children:\"Detection and Hunting Strategies\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"After our atomic emulation, it\\u2019s critical to share how we can effectively detect this ransom behavior based on the API event logs provided by AWS\\u2019 CloudTrail. Note that we will be leveraging \",(0,t.jsx)(e.a,{href:\"https://www.elastic.co/elastic-stack\",rel:\"nofollow\",children:\"Elastic Stack\"}),\" for data ingestion and initial query development; however, the query logic and context should be translatable to \",(0,t.jsx)(e.a,{href:\"https://www.elastic.co/security/siem\",rel:\"nofollow\",children:\"your SIEM of choice\"}),\". It is also important to note that data events for S3 in your CloudTrail configuration should be set to \\u201CLog all events.\\u201D\"]}),`\n`,(0,t.jsx)(e.h2,{id:\"unusual-aws-s3-object-encryption-with-sse-c\",children:\"Unusual AWS S3 Object Encryption with SSE-C\"}),`\n`,(0,t.jsx)(e.p,{children:\"The goal of this detection strategy is to identify PutObject requests that leverage SSE-C, as customer-provided encryption keys can be a strong indicator of anomalous activity \\u2014 especially if an organization primarily uses AWS-managed encryption through KMS (SSE-KMS) or S3's native encryption (SSE-S3).\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"In our emulation, \",(0,t.jsx)(e.code,{children:\"PutObject\"}),\" requests were configured with the \",(0,t.jsx)(e.code,{children:\"x-amz-server-side-encryption-customer-algorithm\"}),\" header set to \",(0,t.jsx)(e.code,{children:\"AES256\"}),\", signaling to AWS that customer-provided keys were used for encryption (SSE-C).\"]}),`\n`,(0,t.jsx)(e.p,{children:\"Fortunately, AWS CloudTrail logs these encryption details within request parameters, allowing security teams to detect unusual SSE-C usage. Key CloudTrail attributes to monitor include:\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.em,{children:\"SignatureVersion\"}),\": SigV4 \\u2192 Signals that this request was signed\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.em,{children:\"SSEApplied: SSE_C\"}),\" \\u2192 Signals that server-side customer key encryption was used\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.em,{children:\"bucketName: s3-sse-c-ransomware-payroll-96\"}),\" \\u2192 Signals which bucket this happened to\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.em,{children:\"x-amz-server-side-encryption-customer-algorithm: AES256\"}),\" \\u2192 Signals which algorithm was used for the customer encryption key\"]}),`\n`,(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.em,{children:\"key: customer_data.csv\"}),\" \\u2192 Indicates the name of the object this was applied to\"]}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{src:\"/assets/images/emulating-aws-s3-sse-c/image9.png\",alt:\"Partial Elastic document from CloudTrail ingestion showing SSE-C request from emulation\",width:\"1922\",height:\"1272\"})}),`\n`,(0,t.jsx)(e.p,{children:\"With these details we can already craft a threat detection query that would match these events and ultimately the threat reported in the original Halcyon blog.\"}),`\n`,(0,t.jsx)(e.div,{className:\"table-container\",children:(0,t.jsx)(e.table,{children:(0,t.jsx)(e.thead,{children:(0,t.jsx)(e.tr,{children:(0,t.jsx)(e.th,{align:\"left\",children:'event.dataset: \"aws.cloudtrail\" and event.provider: \"s3.amazonaws.com\" and event.action: \"PutObject\" and event.outcome: \"success\" and aws.cloudtrail.flattened.request_parameters.x-amz-server-side-encryption-customer-algorithm: \"AES256\" and aws.cloudtrail.flattened.additional_eventdata.SSEApplied: \"SSE_C\"'})})})})}),`\n`,(0,t.jsx)(e.p,{children:\"While this detection is broad, organizations should tailor it to their environment by asking:\"}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Do we expect pre-signed URLs with SigV4 for S3 bucket or object operations?\"}),`\n`,(0,t.jsxs)(e.li,{children:[\"Do we expect SSE-C to be used for \",(0,t.jsx)(e.em,{children:\"PutObject\"}),\" operations in S3 or this specific bucket?\"]}),`\n`]}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:\"Reducing False-Positives With New Term Rule Types\"}),(0,t.jsx)(e.br,{}),`\n`,\"To minimize false positives (FPs), we can leverage Elastic\\u2019s \",(0,t.jsx)(e.a,{href:\"https://www.elastic.co/guide/en/security/current/rules-ui-create.html#create-new-terms-rule\",rel:\"nofollow\",children:\"New Terms rule type\"}),\", which helps detect first-time occurrences of suspicious activity. Instead of alerting on every match, we track unique combinations of IAM users and affected S3 buckets, only generating an alert when this behavior is observed for the first time within a set period. Some of the unique combinations we watch for are:\"]}),`\n`,(0,t.jsxs)(e.ul,{children:[`\n`,(0,t.jsx)(e.li,{children:\"Unique IAM users (ARNs) performing SSE-C encryption in S3.\"}),`\n`,(0,t.jsx)(e.li,{children:\"Specific buckets where SSE-C is applied.\"}),`\n`]}),`\n`,(0,t.jsx)(e.p,{children:\"These alerts only trigger if this activity has been observed for the first time in the last 14 days.\"}),`\n`,(0,t.jsx)(e.p,{children:\"This adaptive approach ensures that legitimate use cases are learned over time, preventing repeated alerts on expected operations. At the same time, it flags anomalous first-time occurrences of SSE-C in S3, aiding in early threat detection. As needed, rule exceptions can be added for specific user identity ARNs, buckets, objects, or even source IPs to refine detection logic. By incorporating historical context and behavioral baselines, this method enhances signal fidelity, improving both the effectiveness of detections and the actionability of alerts.\"}),`\n`,(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:\"Rule References\"})}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_unusual_object_encryption_with_sse_c.toml\",rel:\"nofollow\",children:\"Unusual AWS S3 Object Encryption with SSE-C\"}),(0,t.jsx)(e.br,{}),`\n`,(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_excessive_object_encryption_with_sse_c.toml\",rel:\"nofollow\",children:\"Excessive AWS S3 Object Encryption with SSE-C\"})]}),`\n`,(0,t.jsx)(e.h1,{id:\"conclusion\",children:\"Conclusion\"}),`\n`,(0,t.jsx)(e.p,{children:\"We sincerely appreciate you taking the time to read this publication and, if you did, for trying out the emulation yourself. Whitebox testing plays a crucial role in cloud security, enabling us to replicate real-world threats, analyze their behavioral patterns, and develop effective detection strategies. With cloud-based attacks becoming increasingly prevalent, it is essential to understand the tooling behind adversary tactics and to share research findings with the broader security community.\"}),`\n`,(0,t.jsxs)(e.p,{children:[\"If you're interested in exploring our AWS detection ruleset, you can find it here: \",(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/tree/main/rules/integrations/aws\",rel:\"nofollow\",children:\"Elastic AWS Detection Rules\"}),\". We also welcome \",(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/tree/main?tab=readme-ov-file#how-to-contribute\",rel:\"nofollow\",children:\"contributions\"}),\" to enhance our ruleset\\u2014your efforts help strengthen collective defenses, and we greatly appreciate them!\"]}),`\n`,(0,t.jsx)(e.p,{children:\"We encourage anyone with interest to review Halcyon\\u2019s publication and thank them ahead of time for sharing their research!\"}),`\n`,(0,t.jsx)(e.p,{children:\"Until next time.\"}),`\n`,(0,t.jsx)(e.h1,{id:\"important-references\",children:\"Important References:\"}),`\n`,(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.a,{href:\"https://www.halcyon.ai/blog/abusing-aws-native-services-ransomware-encrypting-s3-buckets-with-sse-c\",rel:\"nofollow\",children:\"Halcyon Research Blog on SSE-C ItW\"}),(0,t.jsx)(e.br,{}),`\n`,(0,t.jsx)(e.a,{href:\"https://gist.github.com/terrancedejesus/f703a4a37a70d005080950a418422ac9\",rel:\"nofollow\",children:\"Elastic Emulation Code for SSE-C in AWS\"}),(0,t.jsx)(e.br,{}),`\n`,(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/tree/main/rules/integrations/aws\",rel:\"nofollow\",children:\"Elastic Pre-built AWS Threat Detection Ruleset\"}),(0,t.jsx)(e.br,{}),`\n`,(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules\",rel:\"nofollow\",children:\"Elastic Pre-built Detection Rules Repository\"}),(0,t.jsx)(e.br,{}),`\n`,\"Rule: \",(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_unusual_object_encryption_with_sse_c.toml\",rel:\"nofollow\",children:\"Unusual AWS S3 Object Encryption with SSE-C\"}),(0,t.jsx)(e.br,{}),`\n`,\"Rule: \",(0,t.jsx)(e.a,{href:\"https://github.com/elastic/detection-rules/blob/main/rules/integrations/aws/impact_s3_excessive_object_encryption_with_sse_c.toml\",rel:\"nofollow\",children:\"Excessive AWS S3 Object Encryption with SSE-C\"})]})]})}function v(i={}){let{wrapper:e}=i.components||{};return e?(0,t.jsx)(e,Object.assign({},i,{children:(0,t.jsx)(d,i)})):d(i)}var k=v;return w(A);})();\n;return Component;"},"_id":"articles/emulating-aws-s3-sse-c.mdx","_raw":{"sourceFilePath":"articles/emulating-aws-s3-sse-c.mdx","sourceFileName":"emulating-aws-s3-sse-c.mdx","sourceFileDir":"articles","contentType":"mdx","flattenedPath":"articles/emulating-aws-s3-sse-c"},"type":"Article","imageUrl":"/assets/images/emulating-aws-s3-sse-c/Security Labs Images 11.jpg","readingTime":"21 min read","series":"","url":"/emulating-aws-s3-sse-c","headings":[{"level":2,"title":"Pre-requisites","href":"#pre-requisites"},{"level":2,"title":"Bucket Accessibility and Exposure","href":"#bucket-accessibility-and-exposure"},{"level":2,"title":"Setting Up Infrastructure","href":"#setting-up-infrastructure"},{"level":2,"title":"Explore How to Craft S3 SSE-C Requests in Python","href":"#explore-how-to-craft-s3-sse-c-requests-in-python"},{"level":3,"title":"Pre-Signed URLs and Their Role in SSE-C Abuse","href":"#pre-signed-urls-and-their-role-in-sse-c-abuse"},{"level":2,"title":"Unusual AWS S3 Object Encryption with SSE-C","href":"#unusual-aws-s3-object-encryption-with-sse-c"}],"author":[{"title":"Terrance DeJesus","slug":"terrance-dejesus","description":"Senior Security Research Engineer, Elastic","body":{"raw":"","code":"var Component=(()=\u003e{var x=Object.create;var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var l=(e,t)=\u003e()=\u003e(t||e((t={exports:{}}).exports,t),t.exports),_=(e,t)=\u003e{for(var n in t)o(e,n,{get:t[n],enumerable:!0})},c=(e,t,n,a)=\u003e{if(t\u0026\u0026typeof t==\"object\"||typeof t==\"function\")for(let s of f(t))!j.call(e,s)\u0026\u0026s!==n\u0026\u0026o(e,s,{get:()=\u003et[s],enumerable:!(a=d(t,s))||a.enumerable});return e};var p=(e,t,n)=\u003e(n=e!=null?x(g(e)):{},c(t||!e||!e.__esModule?o(n,\"default\",{value:e,enumerable:!0}):n,e)),D=e=\u003ec(o({},\"__esModule\",{value:!0}),e);var u=l((F,i)=\u003e{i.exports=_jsx_runtime});var C={};_(C,{default:()=\u003ey,frontmatter:()=\u003eM});var r=p(u()),M={title:\"Terrance DeJesus\",description:\"Senior Security Research Engineer, Elastic\",slug:\"terrance-dejesus\"};function m(e){return(0,r.jsx)(r.Fragment,{})}function h(e={}){let{wrapper:t}=e.components||{};return t?(0,r.jsx)(t,Object.assign({},e,{children:(0,r.jsx)(m,e)})):m(e)}var y=h;return D(C);})();\n;return Component;"},"_id":"authors/terrance-dejesus.mdx","_raw":{"sourceFilePath":"authors/terrance-dejesus.mdx","sourceFileName":"terrance-dejesus.mdx","sourceFileDir":"authors","contentType":"mdx","flattenedPath":"authors/terrance-dejesus"},"type":"Author","imageUrl":"","url":"/authors/terrance-dejesus"}],"category":[{"title":"Security research","slug":"security-research","body":{"raw":"","code":"var Component=(()=\u003e{var x=Object.create;var s=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var _=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var l=(t,e)=\u003e()=\u003e(e||t((e={exports:{}}).exports,e),e.exports),d=(t,e)=\u003e{for(var r in e)s(t,r,{get:e[r],enumerable:!0})},c=(t,e,r,a)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let o of _(e))!j.call(t,o)\u0026\u0026o!==r\u0026\u0026s(t,o,{get:()=\u003ee[o],enumerable:!(a=f(e,o))||a.enumerable});return t};var h=(t,e,r)=\u003e(r=t!=null?x(g(t)):{},c(e||!t||!t.__esModule?s(r,\"default\",{value:t,enumerable:!0}):r,t)),p=t=\u003ec(s({},\"__esModule\",{value:!0}),t);var i=l((X,u)=\u003e{u.exports=_jsx_runtime});var D={};d(D,{default:()=\u003eC,frontmatter:()=\u003ey});var n=h(i()),y={title:\"Security research\",slug:\"security-research\"};function m(t){return(0,n.jsx)(n.Fragment,{})}function M(t={}){let{wrapper:e}=t.components||{};return e?(0,n.jsx)(e,Object.assign({},t,{children:(0,n.jsx)(m,t)})):m(t)}var C=M;return p(D);})();\n;return Component;"},"_id":"categories/security-research.mdx","_raw":{"sourceFilePath":"categories/security-research.mdx","sourceFileName":"security-research.mdx","sourceFileDir":"categories","contentType":"mdx","flattenedPath":"categories/security-research"},"type":"Category","url":"/categories/security-research"}]},"seriesArticles":null},"__N_SSG":true},"page":"/[slug]","query":{"slug":"emulating-aws-s3-sse-c"},"buildId":"33NkrIW0P_Do4IVDT5kFX","assetPrefix":"/security-labs","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>