<!DOCTYPE html>
<!--[if lt IE 7]>      <html lang="en" class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if IE 7]>         <html lang="en" class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if IE 8]>         <html lang="en" class="no-js lt-ie9" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en" class="no-js" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/BlogPosting"> <!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Try not to stare - MedusaLocker at a glance</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Mystic but also a new(-ish) threat: Medusa ransomware. Let's take a quick peek, but don't look too close or you may need to fetch backups soon.">
<link rel="shortcut icon" href="https://dissectingmalwa.re/" type="">
<meta name="author" content="f0wL">
<meta name="copyright" content="f0wL">
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@f0wlsec" />
<meta property="og:site_name" content="~Dissecting Malware" />

<meta property="og:title" content="Try not to stare - medusalocker at a glance" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dissectingmalwa.re/try-not-to-stare-medusalocker-at-a-glance.html" />
<meta name="twitter:title" content="Try not to stare - medusalocker at a glance" />
<meta name="twitter:url" content="https://dissectingmalwa.re/try-not-to-stare-medusalocker-at-a-glance.html" />
<meta itemprop="url" content="https://dissectingmalwa.re/try-not-to-stare-medusalocker-at-a-glance.html" />
<meta property="og:description" content="Mystic but also a new(-ish) threat: Medusa ransomware. Let&#39;s take a quick peek, but don&#39;t look too close or you may need to fetch backups soon." />
<meta name="twitter:description" content="Mystic but also a new(-ish) threat: Medusa ransomware. Let&#39;s take a quick peek, but don&#39;t look too close or you may need to fetch backups soon." />
<meta property="og:article:published_time" content="2019-11-05" />
<meta property="og:article:author" content="f0wL" >

<link href="https://dissectingmalwa.re/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="~Dissecting Malware ATOM Feed"/>
<link href='//fonts.googleapis.com/css?family=Open+Sans:800italic' rel='stylesheet' type='text/css'>
<link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/uikit.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/css/components/search.min.css">
<link rel="stylesheet" href="https://dissectingmalwa.re/theme/css/tipuesearch.css">
<link rel="stylesheet" href="https://dissectingmalwa.re/theme/css/solarized.css">
<link rel="stylesheet" href="https://dissectingmalwa.re/theme/css/main.css">

<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
<script>
    function hybridana() {
      alert("I'm f0wL on Hybrid Analysis");
    }
    </script>
</head>
<body>
<!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

<header class=" mg-header uk-navbar uk-navbar-attached">

    <div class="uk-container uk-container-center">

        <a class="mg-brand uk-navbar-brand uk-hidden-small" href="https://dissectingmalwa.re">~Dissecting Malware</a>
        <div class="mg-tagline uk-navbar-content uk-hidden-small">f0wL's Blog about Malware Analysis and Reverse Engineering</div>
        <a class="uk-navbar-toggle uk-visible-small" href="#mg-offcanvas" data-uk-offcanvas></a>
        <a class="mg-brand uk-navbar-brand uk-navbar-center uk-visible-small" href="https://dissectingmalwa.re">~Dissecting Malware</a>

    </div>
</header>

<main class="mg-main">

<div class="uk-container uk-container-center">

    <div class="uk-grid" data-uk-grid-margin>

<div class="mg-container-social uk-width-medium-1-10 uk-hidden-small">


</div>

<div class="uk-width-medium-7-10">

    <article class="uk-article">
        <h1 class="uk-heading-large uk-article-title" itemprop="name">Try not to stare - MedusaLocker at a glance</h1>
        <p class="uk-article-meta"><time datetime="2019-11-05" itemprop="datePublished">Tue 05 November 2019</time> in <a href="https://dissectingmalwa.re/category/ransomware.html">Ransomware</a></p>


        <p class="uk-article-lead" itemprop="description">Mystic but also a new(-ish) threat: Medusa ransomware. Let's take a quick peek, but don't look too close or you may need to fetch backups soon.</p>
        <section itemprop="articleBody"><p><center><img alt="Logo" src="https://dissectingmalwa.re/img/myth.png"></center></p>
<h4><em>A general disclaimer as always: downloading and running the samples linked below will lead to the encryption of your personal data, so be f$cking careful. Also check with your local laws as owning malware binaries/ sources might be illegal depending on where you live.</em></h4>
<p>medusa.exe @ <a href="https://app.any.run/tasks/75bbf936-ab86-4a02-9512-290d130f4c2c/">AnyRun</a>
--&gt; <code>sha256 3a5b015655f3aad4b4fd647aa34fda4ce784d75a20d12a73f8dc0e0d866e7e01</code></p>
<p>dix_16.exe @ <a href="https://www.hybrid-analysis.com/sample/49da42d00cc3ad6379ead2e07fd5f09bd358b144a6e78aad4bb1a8298e2bb568">HybridAnalysis</a>
--&gt; <code>sha256 49da42d00cc3ad6379ead2e07fd5f09bd358b144a6e78aad4bb1a8298e2bb568</code></p>
<p></br></p>
<p>Taking a look at the stringdump that <a href="https://github.com/fireeye/stringsifter">stringsifter</a> produced one of the first things that stood out was this base64 encoded image:</p>
<p><center><img alt="Image Base64 String" src="https://dissectingmalwa.re/img/medusa-image.png"></center></p>
<p></br></p>
<p>After decoding it we get an image of a medieval pest doctor. Fun fact: They wore these masks because they thought it would protect them from the black death. One day someone will probably start selling these for endpoint protection. </p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-pngpest.png"></center></p>
<p></br></p>
<p>Another interesting extracted string is this PDB-Path: <em>C:\Users\Gh0St\Desktop\MedusaLockerInfo\MedusaLockerProject\MedusaLocker\Release\MedusaLocker.pdb</em></p>
<p>Running it through Detect it easy returns that MedusaLocker was built with Visual C++ and a (in malware-terms) relatively new Linker Version.
<center><img alt="Detect it easy" src="https://dissectingmalwa.re/img/medusa-die.png"></center></p>
<p>Entropy-wise it doesn't look like this sample is packed and the sections found don't look out of the ordinary either.</p>
<p><center><img alt="medusa.exe Entropy" src="https://dissectingmalwa.re/img/medusa-entropy.png"></center></p>
<p>After digging around in Ghidra for a bit I found <strong>FUN_00405bc0</strong> which seems to be the main program routine of MedusaLocker. The strings shown here match the output in the debug console present in the second sample discussed below.</p>
<p><center><img alt="Ghidra Main Function" src="https://dissectingmalwa.re/img/medusa-func.png"></center></p>
<p></br></p>
<p>Yet another mysterious CLSID that I can't make sense of at the moment: {8761ABBD-7F85-42EE-B272-A76179687C63}. Search results referencing it are around since October 21st and might make tracking Medusa a bit easier.</p>
<p><center><img alt="Running and CLSID" src="https://dissectingmalwa.re/img/medusa_running.png"></center></p>
<p></br></p>
<p>Next up the Locker will "initialize the crypto module" which uses <a href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptgenkey">CryptGenKey</a> provided by WinCrypt to derive a keypair. I'll have a closer look at the encryption routine later.</p>
<p><center><img alt="Initialization of the crypto module" src="https://dissectingmalwa.re/img/medusa_crypterInit.png"></center></p>
<p></br></p>
<p>It will skip files with the following suffixes:</p>
<p><center><code>exe, dll, sys, ini, lnk, rdp, encrypted</code></center></p>
<p></br></p>
<p>As it is very popular with Ransomware to disable the Automatic Startup Repair and delete System Restore Points plus shadow copies Medusa will do so as well. After that it will also relanch <strong>LanmanWorkstation</strong> to ensure that mapped network drives are available.</p>
<p><center><img alt="Deletion of system backups and shadow copies" src="https://dissectingmalwa.re/img/medusa-backups.png"></center></p>
<p></br></p>
<p><center><img alt="Process Kill" src="https://dissectingmalwa.re/img/medusa-kill.png"></center></p>
<p></br></p>
<p>After the "Adding to Autoload" debug message it will rename itself to svchost.exe and add it's Registry Key to the System startup.</p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa_startup.png"></center></p>
<p></br></p>
<p>MedusaLocker will try to terminate the following processes by their name. The List contains Security Software as well as Services commonly used in productive environments such as SQL or Webservers.</p>
<div class="highlight"><pre><span></span><span class="n">wrapper</span><span class="p">,</span> <span class="n">DefWatch</span><span class="p">,</span> <span class="n">ccEvtMgr</span><span class="p">,</span> <span class="n">ccSetMgr</span><span class="p">,</span> <span class="n">SavRoam</span><span class="p">,</span> <span class="n">sqlservr</span><span class="p">,</span> <span class="n">sqlagent</span><span class="p">,</span> <span class="n">sqladhlp</span><span class="p">,</span> <span class="n">Culserver</span><span class="p">,</span> <span class="n">RTVscan</span><span class="p">,</span> <span class="n">sqlbrowser</span><span class="p">,</span> <span class="n">SQLADHLP</span><span class="p">,</span> 
<span class="n">QBIDPService</span><span class="p">,</span> <span class="n">Intuit</span><span class="p">.</span><span class="n">QuickBooks</span><span class="p">.</span><span class="n">FCS</span><span class="p">,</span> <span class="n">QBCFMonitorService</span><span class="p">,</span> <span class="n">sqlwriter</span><span class="p">,</span> <span class="n">msmdsrv</span><span class="p">,</span> <span class="n">tomcat6</span><span class="p">,</span> <span class="n">zhudongfangyu</span><span class="p">,</span> <span class="n">SQLADHLP</span><span class="p">,</span> 
<span class="n">vmware</span><span class="o">-</span><span class="n">usbarbitator64</span><span class="p">,</span> <span class="n">vmware</span><span class="o">-</span><span class="n">converter</span><span class="p">,</span> <span class="n">dbsrv12</span><span class="p">,</span> <span class="n">dbeng8wxServer</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">wxServerView</span><span class="p">,</span> <span class="n">sqlservr</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">sqlmangr</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> 
<span class="n">RAgui</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">supervise</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">Culture</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">RTVscan</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">Defwatch</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">sqlbrowser</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">winword</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">QBW32</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">QBDBMgr</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> 
<span class="n">qbupdate</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">QBCFMonitorService</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">axlbridge</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">QBIDPService</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">httpd</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">fdlauncher</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">MsDtSrvr</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> 
<span class="n">tomcat6</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="mi">360</span><span class="n">se</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="mi">360</span><span class="n">doctor</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">wdswfsafe</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">fdlauncher</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">fdhost</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">GDscan</span><span class="p">.</span><span class="n">exe</span><span class="p">,</span> <span class="n">ZhuDongFangYu</span><span class="p">.</span><span class="n">exe</span>
</pre></div>


<p></br></p>
<p>It also copies itself to %APPDATA% after renaming to executable to "svchostt.exe".</p>
<p><center><img alt="Copy of the executable in Appdata" src="https://dissectingmalwa.re/img/medusa-appdata.png"></center></p>
<p></br></p>
<p>To check if an instance of MedusaLocker previously ran on the system it will create a Registry Key at <code>HKEY_CURRENT_USER\Software\Medusa</code></p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-medrec.png"></center></p>
<p></br></p>
<p>Furthermore it tries to read the State of EnableLinkedConnections via <strong>RegOpenKeyExW(HKEY_LOCAL_MACHINE, L"SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" ...</strong> and enables the key if necessary since Medusa tries to encrypt Shared Network Drives and removeable Media as well.</p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-reg1.png"></center></p>
<p></br></p>
<p>After terminating the encryption loop the Ransomware will wait for 60 seconds and start a new scan to check for new unencrypted files.</p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-sleep.png"></center></p>
<p></br></p>
<p>Running MedusaLocker in a VM yields us this UAC Prompt with a mysterious CLSID (<em>{3E5FC7F9-9A51-4367-9063-A120244FBEC7}</em>). A quick google search brings us to Wikileaks Page for the <a href="https://wikileaks.org/ciav7p1/cms/page_13762807.html">CIA Vault7 leaks</a> and the ID seems to be corresponding to <em>cmstplua.dll</em>. Turns out this is an UAC bypass known and implemented since August 2017 (mentioned <a href="https://twitter.com/hfiref0x/status/897662607544508417">here</a>).</p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-uac0.png"></center></p>
<p></br></p>
<p>The Ransomnote (which is dropped in every directory that contains files to encrypt) is delivered as a HTML file. In this early sample they seem to have messed up their text alignment. This was fixed in a later version (see below) and will make it easier to identify new samples as they may appear. </p>
<p><center><img alt="Original Ransomnote" src="https://dissectingmalwa.re/img/medusa-note0.png"></center></p>
<p></br></p>
<p>Looking at the section list compared to the </p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-entropy2.png"></center></p>
<p></br></p>
<p>This sample seems to have an enabled debug console which allows us to trace the steps of the infection.</p>
<p><center><img alt="Debug Console" src="https://dissectingmalwa.re/img/medusa-console.png"></center></p>
<p></br></p>
<p>Below you can see the new ransomnote. The Protonmail E-Mail address was exchanged for a cock.li one and the Victim ID blob was fitted to the textbox.</p>
<p><center><img alt="Ransomnote" src="https://dissectingmalwa.re/img/medusa-note.png"></center></p>
<p></br></p>
<p>BleepingComputer Forum User ttrifonov who was hit by the ransomware as well found suspicious files on his Desktop after the Infection took place. Fortunately for us Medusa skipped the executables.</p>
<p><center><img alt="Comment on BleepingCmputer" src="https://dissectingmalwa.re/img/medusa-bleep.png"></center></p>
<p></br></p>
<p>This would be a huge discovery infection vector-wise as this looks like the attacker gained access to the machine via RDP. (Yet another proof [if we would need any] that RDP exposed to the internet isn't a good idea)</p>
<p><center><img alt="Pest Doctor" src="https://dissectingmalwa.re/img/medusa-desktop.png"></center></p>
<p></br></p>
<p>Looks like the attacker left a few files related to Mimikatz as well...</p>
<p><center><img alt="Key Generation" src="https://dissectingmalwa.re/img/medusa-kami.png"></center></p>
<p></br></p>
<p>As I mentioned earlier the keypair is generated via CryptGenKey. I'm still trying to map out all the actions on the key material.</p>
<p><center><img alt="Key Generation" src="https://dissectingmalwa.re/img/medusa-genKey.png"></center></p>
<p></br></p>
<p>The encryption itself is done via the <a href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptencrypt">CryptEncrypt</a> function. It seems to use AES for the files and then encrypts the key with a RSA-2048 public key that is stored via a keyblob in the executable.</p>
<p></br></p>
<p><center><img alt="Encryption Routine" src="https://dissectingmalwa.re/img/medusa-rsa.png"></center></p>
<p></br></p>
<p><center><img alt="Encryption Routine" src="https://dissectingmalwa.re/img/medusa-cryptenc.png"></center></p>
<p></br></p>
<p>After the encryption routine is done the generated hKey is deleted via <a href="https://docs.microsoft.com/en-us/windows/win32/api/wincrypt/nf-wincrypt-cryptdestroykey">CryptDestroyKey</a>.</p>
<p><center><img alt="Key Deletion" src="https://dissectingmalwa.re/img/medusa-destroyKey.png"></center></p>
<p></br></p>
<h2><strong>Update 23.11.2019:</strong></h2>
<p>Now I want to take a closer look at the files left by the attacker on the Victim's Desktop as it was reported multiple times on the BleepingComputer Forum. Besides the Mimikatz files in the kamikadze directory there is a semi-legit tool called "<strong>Advanced Port Scanner</strong>" (<a href="https://app.any.run/tasks/727e8b8d-48ee-40cb-9c19-171ed5c32431">AnyRun</a>, which is basically just a garbage Zenmap alternative for Windows people) and another one called "<strong>NetworkShare.exe</strong>" (<a href="https://app.any.run/tasks/bfa0580d-7e16-4ea0-ab44-685f62ab9bd5">AnyRun</a>, seems to scan for reachable network shares and tries to mount them).</p>
<p><center><img alt="Networkshare Discovery Tool" src="https://dissectingmalwa.re/img/medusa-networkshare.png"></center></p>
<p></br></p>
<p>It also looks like there's a dedicated version of MedusaLocker for Windows XP called <em>dix_16_xp.exe</em>. As you can see below the Debug Messages start with <strong>[LockerXP]</strong> instead of <strong>[Locker]</strong>.</p>
<p><center><img alt="The XP Version of MedusaLocker" src="https://dissectingmalwa.re/img/medusa-lockerxp.png"></center></p>
<p></br></p>
<h3><strong>The Decryptor</strong> ð§</h3>
<p>The Decryptor is delivered per Machine with a 4 letter filename indicating to which victim ID it belongs. </p>
<p><center><img alt="SSDEEP Hashes of the decryptor samples" src="https://dissectingmalwa.re/img/medusa-decList.png"></center></p>
<p></br></p>
<p><center><img alt="CLI of the Deryptor" src="https://dissectingmalwa.re/img/medusa-decryptor.png"></center></p>
<p></br></p>
<p><center><img alt="Imports listed in PEBear" src="https://dissectingmalwa.re/img/medusa-decImports.png"></center></p>
<p></br></p>
<h2><em>IOCs</em></h2>
<h3>Medusa (SHA256)</h3>
<div class="highlight"><pre><span></span><span class="n">medusa</span><span class="p">.</span><span class="n">exe</span> <span class="c1">--&gt; SHA256: 3a5b015655f3aad4b4fd647aa34fda4ce784d75a20d12a73f8dc0e0d866e7e01</span>
               <span class="n">SSDEEP</span><span class="p">:</span> <span class="mi">12288</span><span class="p">:</span><span class="n">f</span><span class="o">+</span><span class="n">IZ</span><span class="o">+</span><span class="n">bobAyYFJPrsU4VwryxjpBx8ajiOhA8tsV1YRbRb7</span><span class="p">:</span><span class="mi">2</span><span class="o">++</span><span class="n">EMyYFJPoUecOh8aWdD1UB7</span> 

<span class="n">dix_16</span><span class="p">.</span><span class="n">exe</span> <span class="c1">--&gt; SHA256: 49da42d00cc3ad6379ead2e07fd5f09bd358b144a6e78aad4bb1a8298e2bb568</span>
               <span class="n">SSDEEP</span><span class="p">:</span> <span class="mi">24576</span><span class="p">:</span><span class="n">nJC1YAOp0eRaNaQgxPubcoiukAby3LV1jqjx9</span><span class="o">/</span><span class="n">WBRQ</span><span class="o">/</span><span class="mi">8</span><span class="n">PxS</span><span class="o">//</span><span class="n">lTQKJfF27</span><span class="p">:</span><span class="n">nw1OfMGxRoiuWZ1jUx9qrS3lsC27</span> 

<span class="n">dix_16_xp</span><span class="p">.</span><span class="n">exe</span> <span class="c1">--&gt; SHA256: 6c7eda3f5e9bbc685b0eefde2a51f0ccb06ad33805e617876a5124410cac9945</span>
                  <span class="n">SSDEEP</span><span class="p">:</span> <span class="mi">24576</span><span class="p">:</span><span class="n">Sx7USQ2bEdBF4XUCAdbpH7KYlvnIVGDDUWuXrO0VY</span><span class="o">/</span><span class="n">QjFdIkyoRn</span><span class="p">:</span><span class="n">MISXu5C47KMIaDWVY</span><span class="o">/</span><span class="n">QZdjpB</span>
</pre></div>


<h3>E-Mail Addresses</h3>
<div class="highlight"><pre><span></span><span class="n">Ctorsenoria</span><span class="nv">@tutanota</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">com</span><span class="w"></span>
<span class="n">Folieloi</span><span class="nv">@protonmail</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">com</span><span class="w"></span>
<span class="n">mrromber</span><span class="nv">@cock</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">li</span><span class="w"></span>
<span class="n">mrromber</span><span class="nv">@tutanota</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">com</span><span class="w"></span>
<span class="n">sambolero</span><span class="nv">@tutanoa</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">com</span><span class="w"></span>
<span class="n">rightcheck</span><span class="nv">@cock</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">li</span><span class="w"> </span>
<span class="n">fartcool</span><span class="nv">@protonmail</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">ch</span><span class="w"></span>
<span class="n">bestcool</span><span class="nv">@keemail</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">me</span><span class="w"></span>
<span class="n">tanoss</span><span class="nv">@protonmail</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">com</span><span class="w"></span>
<span class="n">sypress</span><span class="nv">@protonmail</span><span class="o">[</span><span class="n">.</span><span class="o">]</span><span class="n">com</span><span class="w"></span>
</pre></div>


<h3>Associated Files</h3>
<div class="highlight"><pre><span></span><span class="n">svchostt</span><span class="p">.</span><span class="n">exe</span>
<span class="n">HOW_TO_OPEN_FILES</span><span class="p">.</span><span class="n">html</span>
<span class="n">Advanced</span> <span class="n">Port</span> <span class="n">Scanner</span> <span class="mi">2</span><span class="p">.</span><span class="mi">4</span><span class="p">.</span><span class="mi">2750</span><span class="p">.</span><span class="n">exe</span>
<span class="n">d_upd1008</span><span class="p">.</span><span class="n">exe</span>
<span class="n">NetworkShare_pre2</span><span class="p">.</span><span class="n">exe</span>
<span class="n">PsExec64</span><span class="p">.</span><span class="n">exe</span> <span class="p">(</span><span class="n">legitimate</span><span class="p">)</span>
<span class="n">PsExec</span><span class="p">.</span><span class="n">exe</span> <span class="p">(</span><span class="n">legitimate</span><span class="p">)</span>
<span class="n">b</span><span class="p">.</span><span class="n">bat</span>
<span class="n">NetworkShare</span><span class="p">.</span><span class="n">exe</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="mi">32</span><span class="p">.</span><span class="n">exe</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="mi">64</span><span class="p">.</span><span class="n">exe</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="mi">64</span><span class="n">_log</span><span class="p">.</span><span class="n">txt</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="n">dump</span><span class="p">.</span><span class="n">bat</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="n">mimidrv</span> <span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">sys</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="n">mimilib</span> <span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">dll</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="mi">86</span><span class="n">_log</span><span class="p">.</span><span class="n">txt</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="n">mimidrv</span><span class="p">.</span><span class="n">sys</span>
<span class="n">kamikadze</span><span class="o">/</span><span class="n">mimilib</span><span class="p">.</span><span class="n">dll</span>
</pre></div>


<h3>Registry Keys</h3>
<div class="highlight"><pre><span></span><span class="n">HKCU</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">Medusa</span>
<span class="n">HKLM</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">Microsoft</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">CurrentVersion</span><span class="err">\</span><span class="n">Policies</span><span class="err">\</span><span class="k">System</span><span class="err">\</span> <span class="c1">--&gt; EnableLinkedConnections = 1</span>
<span class="n">HKEY_LOCAL_MACHINE</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">Microsoft</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">CurrentVersion</span><span class="err">\</span><span class="n">Policies</span><span class="err">\</span><span class="k">System</span> <span class="c1">--&gt; ConsentPromptBehaviorAdmin = 5</span>
<span class="n">HKEY_LOCAL_MACHINE</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">Microsoft</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">CurrentVersion</span><span class="err">\</span><span class="n">Policies</span><span class="err">\</span><span class="k">System</span> <span class="c1">--&gt; EnableLUA = 1</span>
</pre></div>


<h3>Ransomnote</h3>
<div class="highlight"><pre><span></span><span class="nv">All</span> <span class="nv">your</span> <span class="nv">data</span> <span class="nv">are</span> <span class="nv">encrypted</span><span class="o">!</span>
<span class="nv">What</span> <span class="nv">happened</span>?
<span class="nv">Your</span> <span class="nv">files</span> <span class="nv">are</span> <span class="nv">encrypted</span>, <span class="nv">and</span> <span class="nv">currently</span> <span class="nv">unavailable</span>.
<span class="nv">You</span> <span class="nv">can</span> <span class="nv">check</span> <span class="nv">it</span>: <span class="nv">all</span> <span class="nv">files</span> <span class="nv">on</span> <span class="nv">you</span> <span class="nv">computer</span> <span class="nv">has</span> <span class="nv">new</span> <span class="nv">expansion</span>.
<span class="nv">By</span> <span class="nv">the</span> <span class="nv">way</span>, <span class="nv">everything</span> <span class="nv">is</span> <span class="nv">possible</span> <span class="nv">to</span> <span class="nv">recover</span> <span class="ss">(</span><span class="nv">restore</span><span class="ss">)</span>, <span class="nv">but</span> <span class="nv">you</span> <span class="nv">need</span> <span class="nv">to</span> <span class="nv">buy</span> <span class="nv">a</span> <span class="nv">unique</span> <span class="nv">decryptor</span>.
<span class="nv">Otherwise</span>, <span class="nv">you</span> <span class="nv">never</span> <span class="nv">cant</span> <span class="k">return</span> <span class="nv">your</span> <span class="nv">data</span>.

<span class="k">For</span> <span class="nv">purchasing</span> <span class="nv">a</span> <span class="nv">decryptor</span> <span class="nv">contact</span> <span class="nv">us</span> <span class="nv">by</span> <span class="nv">email</span>:
<span class="nv">mrromber</span>@<span class="nv">cock</span>.<span class="nv">li</span>
<span class="k">If</span> <span class="nv">you</span> <span class="nv">will</span> <span class="nv">get</span> <span class="nv">no</span> <span class="nv">answer</span> <span class="nv">within</span> <span class="mi">24</span> <span class="nv">hours</span> <span class="nv">contact</span> <span class="nv">us</span> <span class="nv">by</span> <span class="nv">our</span> <span class="nv">alternate</span> <span class="nv">emails</span>:
<span class="nv">mrromber</span>@<span class="nv">tutanota</span>.<span class="nv">com</span>

<span class="nv">What</span> <span class="nv">guarantees</span>?
<span class="nv">Its</span> <span class="nv">just</span> <span class="nv">a</span> <span class="nv">business</span>. <span class="k">If</span> <span class="nv">we</span> <span class="k">do</span> <span class="nv">not</span> <span class="k">do</span> <span class="nv">our</span> <span class="nv">work</span> <span class="nv">and</span> <span class="nv">liabilities</span> <span class="o">-</span> <span class="nv">nobody</span> <span class="nv">will</span> <span class="nv">not</span> <span class="nv">cooperate</span> <span class="nv">with</span> <span class="nv">us</span>.
<span class="nv">To</span> <span class="nv">verify</span> <span class="nv">the</span> <span class="nv">possibility</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">recovery</span> <span class="nv">of</span> <span class="nv">your</span> <span class="nv">files</span> <span class="nv">we</span> <span class="nv">can</span> <span class="nv">decrypted</span> <span class="mi">1</span> <span class="nv">file</span> <span class="k">for</span> <span class="nv">free</span>.
<span class="nv">Attach</span> <span class="mi">1</span> <span class="nv">file</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">letter</span> <span class="ss">(</span><span class="nv">no</span> <span class="nv">more</span> <span class="nv">than</span> <span class="mi">10</span><span class="nv">Mb</span><span class="ss">)</span>. <span class="nv">Indicate</span> <span class="nv">your</span> <span class="nv">personal</span> <span class="nv">ID</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">letter</span>:
<span class="mi">54</span><span class="nv">E87CD3C1529DD06EB22FF80C49B5374ABB8E5B30D06E13BBE2E81411234A20DF1ADA53FDA68BD6294C96DAC3049B4BDC502706C0265B666946CD5ACB9E07D4</span>
<span class="nv">FE764BF468AF1A029B41162759D6164EB0652E95D3FAE3939773B505073E6090079C9C9243EE8B96AEB41A43B787B47DD01D7E192CEA0FB4FF72B5B6306C</span>
<span class="mi">425</span><span class="nv">E042C6CBDE89BB5F2E7F9CC6601BD9430E87B42A56BEEFF207F20F9E4E5E48FA3274AE0DE8D65EEC0F2BA2CC4AECB22A9E80DC26BA84A849794E54B67</span>
<span class="mi">6</span><span class="nv">FD2B21FF152A6A11BD86D063A965C1571078A439C97D52215738104F7B6EF7415CC4A2C03260BCB9A84E71E0883268747743893B2C334A38F9BCD34E5F9</span>
<span class="mi">39</span><span class="nv">CFF3002697B8AD04E01A6B6DC0A460F4273778429962A7AEECEE3BA16A577A6B1D6B67A7FAEFA5C9CB8BBCEFEDC3FF6B04E9FE1904B0EBCBC6B21719EB</span>
<span class="nv">BE5D37B69B42BBEE2EA0D00C7439858D2D9BD4A57B47F3E05EBF913F5FAB195AF0575DD345E84347A82010CDC4C0507C98687242FA147930BE75A4A14220</span>
<span class="nv">C61ED4091E4155585A687EAB73CBEA8ADA7B93B5EB67877CDD0E35C9116B8DCADD2038C4EEAC42302F3B787E54F8AD24012E4EB4D5A28F48C2450DD346C0</span>
<span class="nv">A89B3C32252BD438399FAE630A1E099E9D130E7EA7E042841B468FF00FCF86B9C07C054827EE76956211CE70FEB686EC19971816936EBF2F143F4C98F8B3</span>
<span class="mi">34</span><span class="nv">C96D1D35DD713CA33774C4D5D0</span>

<span class="nv">Attention</span><span class="o">!</span>
<span class="o">-</span> <span class="nv">Attempts</span> <span class="nv">of</span> <span class="nv">change</span> <span class="nv">files</span> <span class="nv">by</span> <span class="nv">yourself</span> <span class="nv">will</span> <span class="nb">result</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">loose</span> <span class="nv">of</span> <span class="nv">data</span>.
<span class="o">-</span> <span class="nv">Our</span> <span class="nv">e</span><span class="o">-</span><span class="nv">mail</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">blocked</span> <span class="nv">over</span> <span class="nv">time</span>. <span class="nv">Write</span> <span class="nv">now</span>, <span class="nv">loss</span> <span class="nv">of</span> <span class="nv">contact</span> <span class="nv">with</span> <span class="nv">us</span> <span class="nv">will</span> <span class="nb">result</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">loose</span> <span class="nv">of</span> <span class="nv">data</span>.
<span class="o">-</span> <span class="nv">Use</span> <span class="nv">any</span> <span class="nv">third</span> <span class="nv">party</span> <span class="nv">software</span> <span class="k">for</span> <span class="nv">restoring</span> <span class="nv">your</span> <span class="nv">data</span> <span class="nv">or</span> <span class="nv">antivirus</span> <span class="nv">solutions</span> <span class="nv">will</span> <span class="nb">result</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">loose</span> <span class="nv">of</span> <span class="nv">data</span>.
<span class="o">-</span> <span class="nv">Decryptors</span> <span class="nv">of</span> <span class="nv">other</span> <span class="nv">users</span> <span class="nv">are</span> <span class="nv">unique</span> <span class="nv">and</span> <span class="nv">will</span> <span class="nv">not</span> <span class="nv">fit</span> <span class="nv">your</span> <span class="nv">files</span> <span class="nv">and</span> <span class="nv">use</span> <span class="nv">of</span> <span class="nv">those</span> <span class="nv">will</span> <span class="nb">result</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">loose</span> <span class="nv">of</span> <span class="nv">data</span>.
<span class="o">-</span> <span class="k">If</span> <span class="nv">you</span> <span class="nv">will</span> <span class="nv">not</span> <span class="nv">cooperate</span> <span class="nv">with</span> <span class="nv">our</span> <span class="nv">service</span> <span class="o">-</span> <span class="k">for</span> <span class="nv">us</span>, <span class="nv">its</span> <span class="nv">does</span> <span class="nv">not</span> <span class="nv">matter</span>. <span class="nv">But</span> <span class="nv">you</span> <span class="nv">will</span> <span class="nv">lose</span> <span class="nv">your</span> <span class="nv">time</span> <span class="nv">and</span> <span class="nv">data</span>, <span class="nv">cause</span> <span class="nv">just</span> <span class="nv">we</span> <span class="nv">have</span> <span class="nv">the</span> <span class="nv">private</span> <span class="nv">key</span>.
</pre></div>


<p></br></p>
<p>Medusa Icon made by Freepik from www.flaticon.com</p></section>
        <hr class="uk-article-divider">
    </article>


</div>

        <div class="uk-width-medium-1-5 uk-hidden-small">

            <div class="uk-panel uk-panel-box">
                <form class="uk-search" action="search.html" data-uk-search>
                    <input class="uk-search-field tipue_search" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
                </form>
            </div>

            <div class="uk-panel uk-panel-box">
                <ul class="uk-nav uk-nav-side">
                    <li class="uk-nav-header">Categories</li>
                    <li ><a href="https://dissectingmalwa.re/category/banking-malware.html">Banking-Malware</a></li>
                    <li ><a href="https://dissectingmalwa.re/category/botnets.html">Botnets</a></li>
                    <li ><a href="https://dissectingmalwa.re/category/info.html">Info</a></li>
                    <li ><a href="https://dissectingmalwa.re/category/lab.html">Lab</a></li>
                    <li ><a href="https://dissectingmalwa.re/category/mobile.html">Mobile</a></li>
                    <li class="uk-active"><a href="https://dissectingmalwa.re/category/ransomware.html">Ransomware</a></li>
                    <li ><a href="https://dissectingmalwa.re/category/rats.html">RATs</a></li>
                    <li ><a href="https://dissectingmalwa.re/category/resources.html">Resources</a></li>
                    <li class="uk-nav-header">Pages</li>



                    <li class="uk-nav-divider"></li>
                    <li ><a href="https://dissectingmalwa.re/archives.html">Archives</a></li>
                </ul>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Receive Updates</h3>
                <a rel="alternate" type="application/atom+xml" href="https://dissectingmalwa.re/feeds/all.atom.xml" class="mg-feed"><i class="uk-icon-rss uk-icon-medium"></i> ATOM</a>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">About me</h3>
                <center><img src="https://dissectingmalwa.re/img/dm-logo.png" alt="DissectingMalwa.re Logo" height="86" width="196"></center>
                <p style="text-align: justify; font-size: 14px">Hey there! My Name is <b>Marius Genheimer</b> aka <b>f0wL</b> and I'm a Computer Science Student from Germany. As you can probably tell I like to analyse malware (especially Ransomware) in my spare time.</p>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title"><a style="font-size: 11pt;" href="https://ransomware.email"target="_blank">https://ransomware.email</a></h3>
                <center><img height="50px" width="50px" src="https://ransomware.email/img/howler.png"></center>
                <p style="text-align: justify; font-size: 14px">A searchable database of E-Mail addresses used in Ransomnotes plus facts and analysis</p>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">Contacts</h3>
                <a class="mg-icon-link" href="https://twitter.com/f0wlsec">
                    <i class="uk-icon-twitter uk-icon-medium"></i>
                </a>
                <a class="mg-icon-link" href="https://linkedin.com/in/marius-genheimer">
                    <i class="uk-icon-linkedin uk-icon-medium"></i>
                </a>
                <a class="mg-icon-link" href="https://github.com/f0wl">
                    <i class="uk-icon-github uk-icon-medium"></i>
                </a>
                <a class="mg-icon-link" href="mailto:hello@dissectingmalwa.re">
                    <i class="uk-icon-envelope uk-icon-medium"></i>
                </a>
                <a class="mg-icon-link uk-icon-medium" href="https://beta.virusbay.io/user/5de7f05bd9c7bc6d4d1f567a">
                    <img src="https://dissectingmalwa.re/img/vb.ico" alt="Virusbay" height="30" width="30"> 
                </a>
                <a class="mg-icon-link uk-icon-medium" href="https://www.bleepingcomputer.com/forums/u/1133218/f0wl/">
                    <img src="https://dissectingmalwa.re/img/bc.png" alt="Bleeping Computer" height="30" width="30"> 
                </a>
                <a class="mg-icon-link uk-icon-medium" onclick="hybridana()">
                    <img src="https://dissectingmalwa.re/img/ha.png" alt="Hybrid Analysis" height="30" width="30"> 
                </a>
                <a class="mg-icon-link" href="https://www.virustotal.com/gui/user/f0wL/">
                    <img src="https://dissectingmalwa.re/img/vt.png" alt="Virustotal" height="30" width="30"> 
                </a>
            </div>
            <div class="uk-panel uk-panel-box">
                <b><h3 style="font-size: 16px" class="uk-panel-title">"Security is #1 priority"</h3></b>
                <center>
                <img src="https://dissectingmalwa.re/img/icon-key.png" alt="Key" height="30" width="30">
                <a href="https://keys.openpgp.org/vks/v1/by-fingerprint/55CC3B4ADE43319C9085FA207B808A7101CD2234" style="font-size: 18px">OpenPGP Key</a>
                </center>
            </div>

            <div class="uk-panel uk-panel-box">
                <p style="text-align: justify; font-size: 14px">Some of my Blogposts are listed on Malpedia, an invaluable resource for Malware Research. Check it out!</p>
                <center><a href="https://malpedia.caad.fkie.fraunhofer.de/library?search=Dissecting+Malware"><img src="https://dissectingmalwa.re/img/malpedia.png" alt="Malpedia" height="40" width="120"></a></center>
            </div>

            <div class="uk-panel uk-panel-box">
                <h3 class="uk-panel-title">In the Media</h3>
                <a style="font-size: 16px;" href="https://www.zdnet.com/article/germanwiper-ransomware-hits-germany-hard-destroys-files-asks-for-ransom/">ZDnet: GermanWiper</a>
                <a style="font-size: 16px;" href="https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-december-20th-2019-attacks-everywhere/">BleepingComputer: 51/19</a>
                <a style="font-size: 16px;"href="https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-march-27th-2020-dont-attack-hospitals/">BleepingComputer: 13/20</a>
                <a style="font-size: 16px;" href="https://www.bleepingcomputer.com/news/security/new-wiper-malware-impersonates-security-researchers-as-prank/">BleepingComputer: MBR</a>
            </div>
        </div>

    </div>

</div>

</main>

<footer class="mg-footer">
    <div class="uk-container uk-container-center uk-text-center">

        <div class="mg-icons-small uk-subnav uk-visible-small">
            <li><a rel="alternate" type="application/atom+xml" href="https://dissectingmalwa.re/feeds/all.atom.xml" class="uk-icon-button uk-icon-rss"></a></li>
            <li>
                <a href="https://twitter.com/f0wlsec" class="uk-icon-button uk-icon-twitter"></a>
            </li>
            <li>
                <a href="https://linkedin.com/in/marius-genheimer" class="uk-icon-button uk-icon-linkedin"></a>
            </li>
            <li>
                <a href="https://github.com/f0wl" class="uk-icon-button uk-icon-github"></a>
            </li>
            <li>
                <a href="mailto:hello@dissectingmalwa.re" class="uk-icon-button uk-icon-envelope"></a>
            </li>
        </div>

        <div class="mg-author uk-panel">
            <p>Marius Genheimer 2019-2020 | https://f0wl.cc | Stay safe and always encrypt your offsite backups :)</p>
            <p style="font-size: 12px">Powered by <a href="http://blog.getpelican.com">Pelican</a>.<br class="uk-visible-small"> Theme <a href="https://github.com/lucachr/pelican-mg">mg</a> by <a href="https://github.com/lucachr">Luca Chiricozzi</a>.</p>
        </div>
    </div>
</footer>

<div id="mg-offcanvas" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">

        <form class="uk-search" action="search.html" data-uk-search>
            <input class="uk-search-field" type="search" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
        </form>

        <ul class="uk-nav uk-nav-offcanvas" data-uk-nav>
            <li class="uk-nav-header">Categories</li>
            <li ><a href="https://dissectingmalwa.re/category/banking-malware.html">Banking-Malware</a></li>
            <li ><a href="https://dissectingmalwa.re/category/botnets.html">Botnets</a></li>
            <li ><a href="https://dissectingmalwa.re/category/info.html">Info</a></li>
            <li ><a href="https://dissectingmalwa.re/category/lab.html">Lab</a></li>
            <li ><a href="https://dissectingmalwa.re/category/mobile.html">Mobile</a></li>
            <li class="uk-active"><a href="https://dissectingmalwa.re/category/ransomware.html">Ransomware</a></li>
            <li ><a href="https://dissectingmalwa.re/category/rats.html">RATs</a></li>
            <li ><a href="https://dissectingmalwa.re/category/resources.html">Resources</a></li>
            <li class="uk-nav-header">Pages</li>


            <li class="uk-nav-divider"></li>
            <li><a href="https://dissectingmalwa.re/">Archives</a></li>
        </ul>
    </div>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/uikit.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/uikit/2.23.0/js/components/search.min.js"></script>
<script src="https://dissectingmalwa.re/theme/js/tipuesearch_set.js"></script>
<script src="https://dissectingmalwa.re/theme/js/tipuesearch.js"></script>
<script src="https://dissectingmalwa.re/theme/js/jquery.sticky-kit.js"></script>
<script src="https://dissectingmalwa.re/theme/js/plugins.js"></script>
<script src="https://dissectingmalwa.re/theme/js/main-search.js"></script>



</body>
</html>
