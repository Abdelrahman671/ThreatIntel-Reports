<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<script type="text/javascript">
/* <![CDATA[ */
 var gform;gform||(document.addEventListener("gform_main_scripts_loaded",function(){gform.scriptsLoaded=!0}),window.addEventListener("DOMContentLoaded",function(){gform.domLoaded=!0}),gform={domLoaded:!1,scriptsLoaded:!1,initializeOnLoaded:function(o){gform.domLoaded&&gform.scriptsLoaded?o():!gform.domLoaded&&gform.scriptsLoaded?window.addEventListener("DOMContentLoaded",o):document.addEventListener("gform_main_scripts_loaded",o)},hooks:{action:{},filter:{}},addAction:function(o,n,r,t){gform.addHook("action",o,n,r,t)},addFilter:function(o,n,r,t){gform.addHook("filter",o,n,r,t)},doAction:function(o){gform.doHook("action",o,arguments)},applyFilters:function(o){return gform.doHook("filter",o,arguments)},removeAction:function(o,n){gform.removeHook("action",o,n)},removeFilter:function(o,n,r){gform.removeHook("filter",o,n,r)},addHook:function(o,n,r,t,i){null==gform.hooks[o][n]&&(gform.hooks[o][n]=[]);var e=gform.hooks[o][n];null==i&&(i=n+"_"+e.length),gform.hooks[o][n].push({tag:i,callable:r,priority:t=null==t?10:t})},doHook:function(n,o,r){var t;if(r=Array.prototype.slice.call(r,1),null!=gform.hooks[n][o]&&((o=gform.hooks[n][o]).sort(function(o,n){return o.priority-n.priority}),o.forEach(function(o){"function"!=typeof(t=o.callable)&&(t=window[t]),"action"==n?t.apply(null,r):r[0]=t.apply(null,r)})),"filter"==n)return r[0]},removeHook:function(o,n,t,i){var r;null!=gform.hooks[o][n]&&(r=(r=gform.hooks[o][n]).filter(function(o,n,r){return!!(null!=i&&i!=o.tag||null!=t&&t!=o.priority)}),gform.hooks[o][n]=r)}}); 
/* ]]> */
</script>

	<link rel="profile" href="http://gmpg.org/xfn/11" />
	<link rel="pingback" href="https://securelist.com/xmlrpc.php" />
	<link rel="apple-touch-icon" sizes="180x180" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon-16x16.png">
	<link rel="manifest" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/site.webmanifest">
	<link rel="shortcut icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/favicons/favicon.ico">
	<title>Kernel shellcode persistence technique in APT attacks and SAS CTF challenge | Securelist</title>

<!-- The SEO Framework by Sybre Waaijer -->
<meta name="keywords" content="APT,Microsoft Windows,SAS 2024,Virtualization,Vulnerabilities and exploits" />
<link rel="canonical" href="https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/" />
<meta name="description" content="In this article we solve the most difficult SAS CTF challenge based on the APT technique to introduce and persist a kernel shellcode on Windows 7." />
<meta property="og:type" content="article" />
<meta property="og:title" content="Kernel shellcode persistence technique in APT attacks and SAS CTF challenge" />
<meta property="og:description" content="In this article we solve the most difficult SAS CTF challenge based on the APT technique to introduce and persist a kernel shellcode on Windows 7." />
<meta property="og:url" content="https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/" />
<meta property="og:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured.jpg" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@Securelist" />
<meta name="twitter:creator" content="@Securelist" />
<meta name="twitter:title" content="Kernel shellcode persistence technique in APT attacks and SAS CTF challenge" />
<meta name="twitter:description" content="In this article we solve the most difficult SAS CTF challenge based on the APT technique to introduce and persist a kernel shellcode on Windows 7." />
<meta name="twitter:image" content="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured.jpg" />
<script type="application/ld+json">{"@context":"https://schema.org","@type":"NewsArticle","mainEntityOfPage":{"@type":"WebPage","@id":"https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/"},"headline":"SAS CTF and the many ways to persist a kernel shellcode on Windows 7","image":"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured.jpg","datePublished":"2024-10-17T10:00:17+00:00","dateModified":"2024-10-17T14:20:38+00:00","author":{"@type":"Person","name":"Igor Kuznetsov","url":"https://securelist.com/author/igorsoumenkov/"},"publisher":{"@type":"Organization","name":"Kaspersky","logo":{"@type":"ImageObject","url":"https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2019/06/04065705/article-logo-small_new.png","width":60,"height":60}},"description":"In this article we solve the most difficult SAS CTF challenge based on the APT technique to introduce and persist a kernel shellcode on Windows 7."}</script>
<!-- / The SEO Framework by Sybre Waaijer | 16.16ms meta | 0.17ms boot -->

<link rel='dns-prefetch' href='//kasperskycontenthub.com' />
<link rel='dns-prefetch' href='//securelist.com' />
<link rel='dns-prefetch' href='//www.google.com' />
<link rel='dns-prefetch' href='//media.kaspersky.com' />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Feed" href="https://securelist.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; Comments Feed" href="https://securelist.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Securelist - English - Global - securelist.com &raquo; SAS CTF and the many ways to persist a kernel shellcode on Windows 7 Comments Feed" href="https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/feed/" />
<link rel='stylesheet' id='crayon-group-css' href='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css,wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css,wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css,wp-includes/css/dist/block-library/style.min.css,wp-content/plugins/jquery-collapse-o-matic/css/core_style.css,wp-content/plugins/jquery-collapse-o-matic/css/light_style.css,wp-content/plugins/kspr_twitter_pullquote/css/style.css,wp-content/themes/securelist2020/assets/css/main.css,wp-content/plugins/kaspersky-social-sharing/assets/css/style.css,wp-content/plugins/kaspersky-social-sharing/assets/css/custom.css' type='text/css' media='all' />
<link rel='stylesheet' id='taxonomy-image-plugin-public-group-css' href='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/taxonomy-images/css/style.css' type='text/css' media='screen' />
<script type="text/javascript" src="https://securelist.com/wp-content/plugins/kaspersky-enable-jquery-migrate-helper/js/jquery/jquery-1.12.4-wp.js?ver=1.12.4-wp" id="jquery-core-js"></script>
<script type="text/javascript" id="kaspersky-sso-integration-js-extra">
/* <![CDATA[ */
var kasperskySSOIntegrationData = {"authorizationURL":"https:\/\/auth.ca.uis.kaspersky.com\/connect\/authorize?client_id=securelist&client_name=Securelist&redirect_uri=https%3A%2F%2Fsecurelist.com%2Fkaspersky-sso%2Flogin%2F&response_type=code&scope=openid email profile offline_access","endSessionURL":"https:\/\/auth.ca.uis.kaspersky.com\/connect\/endsession?id_token_hint=eyJhbGciOiJSUzI1NiIsImtpZCI6IkNCNzFGQTExMjc4MzgyMzQ3OTAxNzlENkJGMkVBNkFCRkZGOEQ5OUYiLCJ4NXQiOiJ5M0g2RVNlRGdqUjVBWG5Xdnk2bXFfXzQyWjgiLCJ0eXAiOiJKV1QifQ.eyJhdF9oYXNoIjoiZWU3allxekk1M0JqTWY1RkdXMlhYZyIsInNpZCI6IldBaWFkdUk4cFFqN2cyNXg0VEt4Q3ciLCJzdWIiOiJmOWQ5YmMzYy1lODVkLTQ3MzgtYTEzZS04ZjQzNDhlYzI1MDEiLCJhdXRoX3RpbWUiOiIxNzI5ODQzODg4IiwiaWRwIjoiS2FzcGVyc2t5SWQiLCJrYXNwZXJza3kuc3ViX3ZlcnNpb24iOiIyIiwia2FzcGVyc2t5LnN1c3BpY2lvdXNfYXV0aGVudGljYXRpb24iOiJmYWxzZSIsIm5iZiI6MTcyOTg0Mzg5MCwiZXhwIjoxNzI5OTMwMjkwLCJpYXQiOjE3Mjk4NDM4OTAsImlzcyI6Imh0dHBzOi8vYXV0aC5jYS51aXMua2FzcGVyc2t5LmNvbSIsImF1ZCI6InNlY3VyZWxpc3QifQ.AQRRGPPBViixzIYb5aL0789qgvybAb6MlDWuska8tMkM-3Rxb-R00-DDQd_w74XllVaVKqQZHc2f8u4vCHbxw3Cq39HsJNX7d52qOt57sZe1dTkriunQHIzuNkRpELacj2JdWpKrC-Gx5NWZycdlczSvBFKtSNMEhPMjxa1Qbfis_9uw-r2_m5SUp8WTX5NozH81iTgEqHROy_0PUk-pRXp0PuvEq1z05vgfaKFmdwR7OJjVOeWT5SFpIK5DeY_A6TiNyVywvgQJW3vnvsz75wwsNcDcsVZvjppvnFDJ269xFKJS-Jde76M_JbcDBOYjGKSvUsab5p66zAg2q1oF5Q&post_logout_redirect_uri=https:\/\/securelist.com\/kaspersky-sso\/logout\/?path=https:\/\/securelist.com\/webinars\/"};
/* ]]> */
</script>
<script type="text/javascript" id="kss_js-js-extra">
/* <![CDATA[ */
var kss = {"twitter_account":"Securelist"};
/* ]]> */
</script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/kaspersky-lazy-load/assets/js/lazyload.js,wp-content/plugins/kaspersky-sso-integration/assets/js/main.js,wp-content/plugins/kspr_twitter_pullquote/js/kaspersky-twitter-pullquote.js,wp-content/plugins/kaspersky-social-sharing/assets/js/social-share.js'></script>
<link rel="alternate" hreflang="x-default" href="https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/" />
		<script>
			window.dataLayer = window.dataLayer || [];
			window.dataLayer.push({
				'Author' : 'Igor Kuznetsov',
				'PostId' : '114180',
				'PublicationDate' : '2024-10-17',
				'Categories': 'SAS',
				'Tags': 'APT, Microsoft Windows, SAS 2024, Virtualization, Vulnerabilities and exploits',
			});
		</script>
						<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-5CGZ3HG');</script>
		<!-- End Google Tag Manager -->

		<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-WZ7LJ3');</script>
		<!-- End Google Tag Manager -->
		<link rel="https://api.w.org/" href="https://securelist.com/wp-json/" /><link rel="alternate" type="application/json" href="https://securelist.com/wp-json/wp/v2/posts/114180" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://securelist.com/xmlrpc.php?rsd" />
<link rel="alternate" type="application/json+oembed" href="https://securelist.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurelist.com%2Fsas-ctf-windows-7-challenge-explained%2F114180%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://securelist.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurelist.com%2Fsas-ctf-windows-7-challenge-explained%2F114180%2F&#038;format=xml" />
<script type="text/javascript">
var sNew = document.createElement("script");
sNew.async = true;
sNew.src = "https://kasperskycontenthub.com/?dm=ed1f9e435dc885292eab65620c51f3fb&action=load&blogid=43&siteid=1&t=1375853038&back=https%3A%2F%2Fsecurelist.com%2Fsas-ctf-windows-7-challenge-explained%2F114180%2F"
var s0 = document.getElementsByTagName('script')[0];
s0.parentNode.insertBefore(sNew, s0);
</script>
<script type="text/javascript">
document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>Munchkin.init('802-IJN-240');</script>
<meta name="google-site-verification" content="o48MojucKcP-DT5iCMR8AsvkVWP14fE78flHCqqjo50" />
        <script type="text/javascript">
            var jQueryMigrateHelperHasSentDowngrade = false;

			window.onerror = function( msg, url, line, col, error ) {
				// Break out early, do not processing if a downgrade reqeust was already sent.
				if ( jQueryMigrateHelperHasSentDowngrade ) {
					return true;
                }

				var xhr = new XMLHttpRequest();
				var nonce = 'd4039d0ad4';
				var jQueryFunctions = [
					'andSelf',
					'browser',
					'live',
					'boxModel',
					'support.boxModel',
					'size',
					'swap',
					'clean',
					'sub',
                ];
				var match_pattern = /\)\.(.+?) is not a function/;
                var erroredFunction = msg.match( match_pattern );

                // If there was no matching functions, do not try to downgrade.
                if ( typeof erroredFunction !== 'object' || typeof erroredFunction[1] === "undefined" || -1 === jQueryFunctions.indexOf( erroredFunction[1] ) ) {
                    return true;
                }

                // Set that we've now attempted a downgrade request.
                jQueryMigrateHelperHasSentDowngrade = true;

				xhr.open( 'POST', 'https://securelist.com/wp-admin/admin-ajax.php' );
				xhr.setRequestHeader( 'Content-Type', 'application/x-www-form-urlencoded' );
				xhr.onload = function () {
					var response,
                        reload = false;

					if ( 200 === xhr.status ) {
                        try {
                        	response = JSON.parse( xhr.response );

                        	reload = response.data.reload;
                        } catch ( e ) {
                        	reload = false;
                        }
                    }

					// Automatically reload the page if a deprecation caused an automatic downgrade, ensure visitors get the best possible experience.
					if ( reload ) {
						location.reload();
                    }
				};

				xhr.send( encodeURI( 'action=jquery-migrate-downgrade-version&_wpnonce=' + nonce ) );

				// Suppress error alerts in older browsers
				return true;
			}
        </script>

			<div id="fb-root"></div>
	<script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=160639043985664";fjs.parentNode.insertBefore(js,fjs);}(document,'script','facebook-jssdk'));</script>
	<script>(function(){var po=document.createElement('script');po.type='text/javascript';po.async=true;po.src='//apis.google.com/js/platform.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(po,s);})();</script>
	<link rel="icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" sizes="32x32" />
<link rel="icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" />
<meta name="msapplication-TileImage" content="https://securelist.com/wp-content/themes/securelist2020/assets/images/content/site-icon.png" />
</head>

<body class="post-template-default single single-post postid-114180 single-format-standard lang-en_US c-theme--light">
		<!-- Google Tag Manager (noscript) -->
		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5CGZ3HG" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->

		<!-- Google Tag Manager (noscript) -->
		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WZ7LJ3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->
		
<div id="site-top" class="site-top">
	<div class="container">
		<nav class="site-nav" data-element-id="product-menu">
			<div class="label">
				<p>Solutions for:</p>
			</div>
			<ul id="menu-product-menu-daily-nxgen" class="site-selector"><li><a target="_blank" href="https://www.kaspersky.com/home-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-home menu-item menu-item-type-custom menu-item-object-custom menu-item-87907">Home Products</a></li>
<li><a title="font-icons icon-small-business" target="_blank" href="https://www.kaspersky.com/small-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-small-business menu-item menu-item-type-custom menu-item-object-custom menu-item-87908">Small Business 1-50 employees</a></li>
<li><a target="_blank" href="https://www.kaspersky.com/small-to-medium-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-medium-business menu-item menu-item-type-custom menu-item-object-custom menu-item-87909">Medium Business 51-999 employees</a></li>
<li><a target="_blank" href="https://www.kaspersky.com/enterprise-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_prodmen_sm-team_______d5c53f9a5bd411f7" data-element-id="product-menu-link" class="font-icons icon-enterprise menu-item menu-item-type-custom menu-item-object-custom menu-item-87910">Enterprise 1000+ employees</a></li>
</ul>		</nav>
	</div>
</div>

<header id="site-header" class="site-header js-sticky-mobile-header">
	<div class="container">
		<a href="" class="c-page-nav-toggle js-mobile-menu-toggle">
			<span class="c-page-nav-toggle__icon">
				<span></span>
				<span></span>
				<span></span>
			</span>
		</a>
		<a href="" class="menu-toggle">
			<span></span>
			<span></span>
			<span></span>
		</a>
		<div class="c-site-title">
			<div class="c-site-logo__group">
				<a data-element-id="securelist-logo"  href="https://securelist.com/" class="c-site-logo c-site-logo--basic"></a>
								<span class="c-site-tagline">by Kaspersky</span>
			</div>
		</div>

		<ul id="menu-my-kaspersky" class="menu-utility sticky-utility"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87905"><a href="https://companyaccount.kaspersky.com/account/login?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="companyaccount">CompanyAccount</a>
<li class="sticky-item sticky-xl-only menu-item menu-item-type-custom menu-item-object-custom menu-item-87906"><a href="https://www.kaspersky.com/enterprise-security/contact?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="getintouch">Get In Touch</a>
<li class="securelist-theme-switcher menu-item menu-item-type-custom menu-item-object-custom menu-item-99824"><a data-element-id="dark-mode" href="#" class="js-theme-switcher"><i class="font-icons icon-moon"></i>Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
<li class="dropdown"><a data-element-id="lang-selector" href="#" class="">English</a><ul class="sub-menu-regular"><li><a href="https://securelist.ru">Russian</a></li><li><a href="https://securelist.lat">Spanish</a></li></ul>
</ul>
		<div class="c-page-search js-main-search">
			<form class="c-page-search__form c-page-search__form--small js-wizardinfosys_autosearch_form" full_search_url="https://securelist.com/?s=%q%" action="https://securelist.com/" method="get">
	<div class="c-form-element c-form-element--style-fill">
		<div class="c-form-element__field wp_autosearch_form_wrapper">
			<input name="s" class="c-form-element__text wp_autosearch_input ac_input" data-webinars="" type="text" value="" placeholder="Search..." autocomplete="off">
		</div>
	</div>
	<button class="c-button c-button--icon wp_autosearch_submit"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></button>
</form>
			<div class="c-page-search__toggle js-main-search-toggle"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></div>
		</div>
		<nav class="main-nav" data-element-id="nextgen-menu">
			<ul id="menu-corp-menu" class="main-menu"><li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87706"><a href="https://www.kaspersky.com/enterprise-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Solutions</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87707">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-iot-embed-security menu-item menu-item-type-custom menu-item-object-custom menu-item-87710"><figure><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/iot-embed-security.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Internet of Things &#038; Embedded Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/embedded-security-internet-of-things?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-transportation-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87712"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/transportation-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Industrial Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-fraud-prevention menu-item menu-item-type-custom menu-item-object-custom menu-item-87713"><figure><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/fraud-prevention.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Fraud Prevention</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/fraud-prevention?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-87711"><a href="https://www.kaspersky.com/enterprise-security/kasperskyos?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">KasperskyOS-based solutions</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/kasperskyos?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other solutions</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105615"><a href="https://www.kaspersky.com/enterprise-security/security-operations-center-soc?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky for Security Operations Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105614"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-iot-infrastructure-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky IoT Infrastructure Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112322"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-secure-remote-workspace?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Secure Remote Workspace</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87714"><a href="https://www.kaspersky.com/enterprise-security/industries?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Industries</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87715">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-national-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87716"><figure><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/national-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">National Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/national-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-industrial-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87717"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/industrial-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Industrial Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-financial-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87718"><figure><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/financial-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Finance Services Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/finance?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-healthcare-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87719"><figure><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/healthcare-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Healthcare Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/healthcare?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-transportation-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87720"><figure><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/transportation-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Transportation Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/transportation-cybersecurity-it-infrastructure?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-retail-cybersecurity menu-item menu-item-type-custom menu-item-object-custom menu-item-87721"><figure><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/retail-cybersecurity.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Retail Cybersecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/retail-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Industries</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87724"><a href="https://www.kaspersky.com/enterprise-security/telecom?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Telecom Cybersecurity</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87725"><a href="https://www.kaspersky.com/enterprise-security/industries?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">View all</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87726"><a href="https://www.kaspersky.com/enterprise-security/products?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Products</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87728">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112352"><a href="https://www.kaspersky.com/next?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><figure><img alt="" src="https://media.kasperskydaily.com/wp-content/uploads/sites/92/2024/04/10052437/k_Next_RGB_black_icon.png"></figure>Kaspersky Next <small class="label-inline red">NEW!</small></a><div class="desc"><p><a href="https://www.kaspersky.com/next?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112323"><a href="https://www.kaspersky.com/enterprise-security/xdr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>XDR</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/xdr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-endpoint-security_products menu-item menu-item-type-custom menu-item-object-custom menu-item-87727"><figure><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/endpoint-security_products.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Endpoint Security for Business</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/endpoint?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-endpoint-detection-and-response menu-item menu-item-type-custom menu-item-object-custom menu-item-112324"><figure><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/endpoint-detection-and-response.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>EDR Expert</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/endpoint-detection-response-edr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-hybrid-cloud-security_products menu-item menu-item-type-custom menu-item-object-custom menu-item-87730"><figure><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/hybrid-cloud-security_products.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>EDR Optimum</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/edr-security-software-solution?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-anti-targeted-attack-platform menu-item menu-item-type-custom menu-item-object-custom menu-item-87731"><figure><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/anti-targeted-attack-platform.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Anti Targeted Attack Platform</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/anti-targeted-attack-platform?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112325"><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Hybrid Cloud Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/cloud-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-112326"><a href="https://www.kaspersky.com/enterprise-security/sd-wan?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>SD-WAN</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/sd-wan?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-private-security-network menu-item menu-item-type-custom menu-item-object-custom menu-item-87732"><figure><a href="https://www.kaspersky.com/enterprise-security/industrial-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/private-security-network.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/industrial-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Industrial CyberSecurity</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/industrial-cybersecurity?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-embedded-systems-security menu-item menu-item-type-custom menu-item-object-custom menu-item-87733"><figure><a href="https://www.kaspersky.com/enterprise-security/container-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/embedded-systems-security.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/container-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Container Security</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/container-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Products</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112328"><a href="https://www.kaspersky.com/enterprise-security/products/internet-gateway?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Security for Internet Gateway</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112329"><a href="https://www.kaspersky.com/enterprise-security/embedded-systems?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Embedded Systems Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112330"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-iot-infrastructure-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky IoT Infrastructure Security</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112331"><a href="https://www.kaspersky.com/enterprise-security/kaspersky-secure-remote-workspace?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Secure Remote Workspace</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112332"><a href="https://www.kaspersky.com/enterprise-security/mail-server-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Security for Mail Server</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87740"><a target="_blank" href="https://www.kaspersky.com/enterprise-security/products?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">View All</a>
	</ul>

</ul>

<li class="dropdown mega menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87741"><a href="https://www.kaspersky.com/enterprise-security/services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Services</a>
<ul class="submenu">
<li class="first featured featured-smaller menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87742">
	<ul class="featured section-col-l-3 no-gutter">
<li class="show-figure smaller-item icon-cybersecurity-services menu-item menu-item-type-custom menu-item-object-custom menu-item-87743"><figure><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/cybersecurity-services.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Cybersecurity Services</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/cybersecurity-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item menu-item menu-item-type-custom menu-item-object-custom menu-item-105619"><a href="https://www.kaspersky.com/enterprise-security/security-awareness?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Security Awareness</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/security-awareness?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-premium-support menu-item menu-item-type-custom menu-item-object-custom menu-item-87745"><figure><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/premium-support.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Premium Support</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/premium-support?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-intelligence menu-item menu-item-type-custom menu-item-object-custom menu-item-87746"><figure><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-intelligence.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Threat Intelligence</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/threat-intelligence?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-incident-response menu-item menu-item-type-custom menu-item-object-custom menu-item-87748"><figure><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/incident-response.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Managed Detection and Response</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/managed-detection-and-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-hunting menu-item menu-item-type-custom menu-item-object-custom menu-item-87747"><figure><a href="https://www.kaspersky.com/enterprise-security/compromise-assessment?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-hunting.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/compromise-assessment?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>Compromise Assessment</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/compromise-assessment?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
<li class="show-figure smaller-item icon-threat-hunting menu-item menu-item-type-custom menu-item-object-custom menu-item-112333"><figure><a href="https://www.kaspersky.com/enterprise-security/soc-consulting?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/enterprise-menu-icons/threat-hunting.png"</a></figure><a href="https://www.kaspersky.com/enterprise-security/soc-consulting?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link"><span class="surtitle">Kaspersky</span>SOC Consulting</a><div class="desc"><p><a href="https://www.kaspersky.com/enterprise-security/soc-consulting?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f">Learn More</a></p></div>
	</ul>

<li>
	<ul class="regular">
<li class="title"><h6>Other Services</h6>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87751"><a href="https://www.kaspersky.com/enterprise-security/professional-services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Professional Services</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87752"><a href="https://www.kaspersky.com/enterprise-security/incident-response?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Incident Response</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87753"><a href="https://www.kaspersky.com/enterprise-security/cyber-security-training?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Cybersecurity Training</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87754"><a href="https://www.kaspersky.com/enterprise-security/cyber-incident-response-communication?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Incident Communications</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87744"><a href="https://www.kaspersky.com/enterprise-security/adaptive-online-awareness-training?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Kaspersky Adaptive Online Training</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87755"><a href="https://www.kaspersky.com/enterprise-security/services?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">View All</a>
	</ul>

</ul>

<li class="dropdown menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87756"><a href="https://www.kaspersky.com/enterprise-security/resources?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Resource Center</a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87757"><a href="https://www.kaspersky.com/enterprise-security/resources/case-studies?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Case Studies</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87758"><a href="https://www.kaspersky.com/enterprise-security/resources/white-papers?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">White Papers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87759"><a href="https://www.kaspersky.com/enterprise-security/resources/data-sheets?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Datasheets</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87760"><a href="https://www.kaspersky.com/enterprise-security/wiki-section/home?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Technologies</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105620"><a href="https://www.kaspersky.com/MITRE?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">MITRE ATT&#038;CK</a>
</ul>

<li class="dropdown menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-87761"><a href="https://www.kaspersky.com/about?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">About Us</a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105621"><a href="https://www.kaspersky.com/about/transparency?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Transparency</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105622"><a href="https://www.kaspersky.com/about/press-releases?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Corporate News</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105623"><a href="https://press.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Press Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105624"><a href="https://www.kaspersky.com/about/careers?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Careers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105625"><a href="https://www.kaspersky.com/ihub?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Innovation Hub</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105626"><a href="https://www.kaspersky.com/about/sponsorships/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Sponsorship</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105627"><a href="https://www.kaspersky.com/about/policy-blog?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Policy Blog</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105628"><a href="https://www.kaspersky.com/about/contact?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">Contacts</a>
</ul>

<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87762"><a href="https://www.kaspersky.com/gdpr?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="nextgen-menu-link">GDPR</a>
</ul>		</nav>
	</div>
</header>

<div class="mobile-menu-wrapper mobile-menu-wrapper--dark">
	<ul class="mobile-nav" data-back="Back">
		<li class="selector">
			<a data-element-id="subscribe-button" href="#modal-newsletter" class="button-link js-modal-open"><i class="font-icons icon-envelope"></i>Subscribe</a>
			<a href="#" class="button-link c-theme-switcher js-theme-switcher"><i class="font-icons icon-moon"></i> Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
							<a data-element-id="login-button" href="#" class="button-link js-kaspersky-sso-login"><svg class="o-icon o-svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-user"></use></svg>Login</a>
					</li>
		<li class="title">
			<span>Securelist menu</span>
		</li>
		<li class="parent" data-parent data-icon="top-item"><a data-element-id="lang-selector" href="#" class=""><i class="top-item"></i><span>English</span></a><ul class="submenu"><li class="menu-item"><a href="https://securelist.ru">Russian</a></li><li class="menu-item"><a href="https://securelist.lat">Spanish</a></li></ul>
<li class="parent" data-parent="Existing Customers" data-icon="font-icons top-item"><a rel="Existing Customers" href="#"><i class="font-icons top-item"></i><span>Existing Customers</span></a>
<ul class="submenu">
<li class="parent" data-parent="Personal" data-icon="top-item"><a rel="Personal" href="#"><i class="top-item"></i><span>Personal</span></a>
	<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87860"><a href="https://my.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">My Kaspersky</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105987"><a href="https://www.kaspersky.com/renewal-center/home?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Renew your product</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105988"><a href="https://www.kaspersky.com/downloads?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Update your product</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105989"><a href="https://support.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Customer support</a>
	</ul>

<li class="parent" data-parent="Business" data-icon="top-item"><a rel="Business" href="#"><i class="top-item"></i><span>Business</span></a>
	<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105991"><a href="https://ksos.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">KSOS portal</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105992"><a href="https://cloud.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Kaspersky Business Hub</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105993"><a href="https://support.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Technical Support</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105994"><a href="https://www.kaspersky.com/small-to-medium-business-security/resources?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Knowledge Base</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-105995"><a href="https://www.kaspersky.com/renewal-center/vsb?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Renew License</a>
	</ul>

</ul>

<li class="parent" data-parent="Home" data-icon="font-icons top-item"><a rel="Home" href="#"><i class="font-icons top-item"></i><span>Home</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87778"><a href="https://www.kaspersky.com/home-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Products</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87771"><a href="https://www.kaspersky.com/downloads?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Trials&#038;Update</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87859"><a href="https://www.kaspersky.com/resource-center?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Resource Center</a>
</ul>

<li class="parent" data-parent="Business" data-icon="top-item"><a rel="Business" href="#"><i class="top-item"></i><span>Business</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112353"><a href="https://www.kaspersky.com/next?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Kaspersky Next</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87776"><a href="https://www.kaspersky.com/small-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Small Business (1-50 employees)</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87782"><a href="https://www.kaspersky.com/small-to-medium-business-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Medium Business (51-999 employees)</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87783"><a href="https://www.kaspersky.com/enterprise-security?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Enterprise (1000+ employees)</a>
</ul>

<li class="splitter"></li>
<li class="title"><span>Securelist</span>
<li class="parent" data-parent="" data-icon="top-item"><a href="https://securelist.com/threat-categories/"><i class="top-item"></i><span>Threats</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89472"><a href="https://securelist.com/threat-category/financial-threats/">Financial threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89467"><a href="https://securelist.com/threat-category/mobile-threats/">Mobile threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89471"><a href="https://securelist.com/threat-category/web-threats/">Web threats</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89468"><a href="https://securelist.com/threat-category/secure-environment/">Secure environment (IoT)</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-89470"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/">Vulnerabilities and exploits</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89466"><a href="https://securelist.com/threat-category/spam-and-phishing/">Spam and Phishing</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89469"><a href="https://securelist.com/threat-category/industrial-threats/">Industrial threats</a>
</ul>

<li class="parent" data-parent="" data-icon="top-item"><a href="https://securelist.com/categories/"><i class="top-item"></i><span>Categories</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87880"><a href="https://securelist.com/category/apt-reports/">APT reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87881"><a href="https://securelist.com/category/incidents/">Incidents</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87886"><a href="https://securelist.com/category/research/">Research</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89476"><a href="https://securelist.com/category/malware-reports/">Malware reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89479"><a href="https://securelist.com/category/spam-and-phishing-reports/">Spam and phishing reports</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89477"><a href="https://securelist.com/category/publications/">Publications</a>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-87882"><a href="https://securelist.com/category/kaspersky-security-bulletin/">Kaspersky Security Bulletin</a>
</ul>

<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-101953"><a href="https://securelist.com/all/">Archive</a>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-87899"><a href="https://securelist.com/tags/">All Tags</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101954"><a href="https://apt.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">APT Logbook</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101955"><a href="https://securelist.com/webinars/">Webinars</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-102687"><a href="https://statistics.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Statistics</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87901"><a target="_blank" href="https://encyclopedia.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Encyclopedia</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87902"><a target="_blank" href="https://threats.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Threats descriptions</a>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-105984"><a href="https://securelist.com/ksb-2021/">KSB 2021</a>
<li class="splitter"></li>
<li class="parent" data-parent="About Us" data-icon="top-item"><a rel="About Us" href="#"><i class="top-item"></i><span>About Us</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87792"><a href="https://www.kaspersky.com/about/company?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Company</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87968"><a href="https://www.kaspersky.com/transparency?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Transparency</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87971"><a href="https://www.kaspersky.com/about/press-releases?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Corporate News</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87796"><a href="https://press.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Press Center</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87797"><a href="https://www.kaspersky.com/about/careers?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Careers</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87798"><a href="https://www.kaspersky.com/about/sponsorships/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Sponsorships</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87970"><a href="https://www.kaspersky.com/about/policy-blog?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Policy Blog</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87793"><a href="https://www.kaspersky.com/about/contact?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Contacts</a>
</ul>

<li class="parent" data-parent="Partners" data-icon="top-item"><a rel="Partners" href="#"><i class="top-item"></i><span>Partners</span></a>
<ul class="submenu">
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87768"><a href="https://www.kasperskypartners.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Find a Partner</a>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-87769"><a href="https://www.kaspersky.com/partners?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_mobmen_sm-team_______03880766cb97f3a8">Partner Program</a>
</ul>

	</ul>
	<div class="background-overlay"></div>
</div>

<div class="c-page">
	<section class="c-block c-block--bg-image c-page-header js-sticky-header" style="background-image: url(https://securelist.com/wp-content/themes/securelist2020/assets/images/content/bg-gradient-01.jpg);">
		<div class="o-container-fluid">
			<div class="c-page-header__wrapper u-mt-spacer-base-">
				<div class="o-row o-row--small-gutters">
					<div class="o-col-3@md u-mt-spacer-base-">
						<a data-element-id="content-menu" href="#" class="c-page-nav-toggle js-main-menu-toggle">
							<span class="c-page-nav-toggle__icon">
								<span></span>
								<span></span>
								<span></span>
							</span>
							<span class="c-page-nav-toggle__text">Content menu</span>
							<span class="c-page-nav-toggle__text c-page-nav-toggle__text--active">Close</span>
													</a>
					</div>
					<div class="o-col-6@md">
						<form class="c-page-search__form js-main-search-popup js-wizardinfosys_autosearch_form" full_search_url="https://securelist.com/?s=%q%" action="https://securelist.com/" method="get">
	<div class="c-form-element c-form-element--style-fill">
		<div class="c-form-element__field wp_autosearch_form_wrapper">
			<input name="s" class="c-form-element__text wp_autosearch_input ac_input" data-webinars="" type="text" value="" placeholder="Search..." autocomplete="off">
		</div>
	</div>
	<button class="c-button c-button--icon wp_autosearch_submit"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-search"></use></svg></button>
</form>
					</div>
					<div class="o-col-3@md c-page-header__utilities">
						<a  data-element-id="subscribe-button" href="#modal-newsletter" class="c-button c-subscribe-modal-toggle js-modal-open"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg><span>Subscribe</span></a>
						<div class="c-page-header__dropdown-wrapper">
															<button class="c-button c-button--icon c-user-button js-kaspersky-sso-login"><svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-user"></use></svg></button>
													</div>
					</div>
				</div>
			</div>
		</div>

		<nav class="c-page-nav c-color--invert">
			<div class="o-container-fluid">
				<div class="o-row o-row--small-gutters">
					<div class="o-col-3@md c-page-nav__info">
						<div class="c-site-logo__group">
							<a data-element-id="content-menu-securelist-logo" href="https://securelist.com/" class="c-site-logo c-site-logo--basic c-site-logo--sm"></a>
							<span class="c-site-tagline">by Kaspersky</span>
						</div>
						<a data-element-id="content-menu-dark-mode" href="#" class="c-theme-switcher js-theme-switcher"><i class="font-icons icon-moon"></i> Dark mode<span class="u-hidden u-inline--dark"> off</span></a>
					</div>
					<div class="o-col-9@md">
						<div class="c-page-menu">
							<div class="o-row c-page-menu__dividers">
								<div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p id="menu-item-226" class="menu-item-threats section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-226 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/threat-categories/" data-element-id="content-menu-link">Threats</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Threats</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li id="menu-item-99839" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-99839"><a href="https://securelist.com/threat-category/apt-targeted-attacks/" data-element-id="content-menu-link">APT (Targeted attacks)</a></li>
	<li id="menu-item-89457" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89457"><a href="https://securelist.com/threat-category/secure-environment/" data-element-id="content-menu-link">Secure environment (IoT)</a></li>
	<li id="menu-item-63231" class="topic-item vulnerabilities menu-item menu-item-type-custom menu-item-object-custom menu-item-63231"><a href="https://securelist.com/threat-category/mobile-threats/" data-element-id="content-menu-link">Mobile threats</a></li>
	<li id="menu-item-63229" class="topic-item detected menu-item menu-item-type-custom menu-item-object-custom menu-item-63229"><a href="https://securelist.com/threat-category/financial-threats/" data-element-id="content-menu-link">Financial threats</a></li>
	<li id="menu-item-89458" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89458"><a href="https://securelist.com/threat-category/spam-and-phishing/" data-element-id="content-menu-link">Spam and phishing</a></li>
	<li id="menu-item-99840" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-99840"><a href="https://securelist.com/threat-category/industrial-threats/" data-element-id="content-menu-link">Industrial threats</a></li>
	<li id="menu-item-89465" class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89465"><a href="https://securelist.com/threat-category/web-threats/" data-element-id="content-menu-link">Web threats</a></li>
	<li id="menu-item-89459" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89459"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/" data-element-id="content-menu-link">Vulnerabilities and exploits</a></li>
	<li id="menu-item-113855" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113855"><a href="https://securelist.com/threat-categories/" data-element-id="content-menu-link">All threats</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p id="menu-item-230" class="menu-item-categories section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-230 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/categories/" data-element-id="content-menu-link">Categories</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Categories</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li id="menu-item-84158" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84158"><a href="https://securelist.com/category/apt-reports/" data-element-id="content-menu-link">APT reports</a></li>
	<li id="menu-item-99841" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99841"><a href="https://securelist.com/category/malware-descriptions/" data-element-id="content-menu-link">Malware descriptions</a></li>
	<li id="menu-item-84160" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84160"><a href="https://securelist.com/category/kaspersky-security-bulletin/" data-element-id="content-menu-link">Security Bulletin</a></li>
	<li id="menu-item-84161" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84161"><a href="https://securelist.com/category/malware-reports/" data-element-id="content-menu-link">Malware reports</a></li>
	<li id="menu-item-89460" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89460"><a href="https://securelist.com/category/spam-and-phishing-reports/" data-element-id="content-menu-link">Spam and phishing reports</a></li>
	<li id="menu-item-99842" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99842"><a href="https://securelist.com/category/security-technologies/" data-element-id="content-menu-link">Security technologies</a></li>
	<li id="menu-item-84165" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84165"><a href="https://securelist.com/category/research/" data-element-id="content-menu-link">Research</a></li>
	<li id="menu-item-84164" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84164"><a href="https://securelist.com/category/publications/" data-element-id="content-menu-link">Publications</a></li>
	<li id="menu-item-113876" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113876"><a href="https://securelist.com/categories/" data-element-id="content-menu-link">All categories</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><p id="menu-item-277" class="menu-item-tags section-title after-accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-277 c-page-menu__title u-hidden u-block@md"><a data-element-id="content-menu-link">Other sections</a></p>
<ul class="sub-menu">
	<li id="menu-item-100526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-100526"><a href="https://securelist.com/all/" data-element-id="content-menu-link">Archive</a></li>
	<li id="menu-item-57837" class="show-all-tags menu-item menu-item-type-post_type menu-item-object-page menu-item-57837"><a href="https://securelist.com/tags/" data-element-id="content-menu-link">All tags</a></li>
	<li id="menu-item-101956" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101956"><a href="https://securelist.com/webinars/" data-element-id="content-menu-link">Webinars</a></li>
	<li id="menu-item-101126" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101126"><a target="_blank" rel="noopener noreferrer" href="https://apt.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">APT Logbook</a></li>
	<li id="menu-item-241" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-241"><a target="_blank" rel="noopener noreferrer" href="https://statistics.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">Statistics</a></li>
	<li id="menu-item-86643" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-86643"><a target="_blank" rel="noopener noreferrer" href="https://encyclopedia.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">Encyclopedia</a></li>
	<li id="menu-item-58141" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-58141"><a target="_blank" rel="noopener noreferrer" href="https://threats.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="content-menu-link">Threats descriptions</a></li>
	<li id="menu-item-111312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-111312"><a href="https://securelist.com/ksb-2023/" data-element-id="content-menu-link">KSB 2023</a></li>
</ul>
</li>
</div>							</div>
						</div>
					</div>
				</div>
			</div>
		</nav>
	</section>
			<section class="c-block c-block--spacing-t@md c-block--spacing-b-small@md c-block--divider-internal" style="z-index:10">
				<div class="o-container-fluid">
					<article class="c-article">
						<header class="c-article__header">
							<figure class="c-article__figure u-hidden@md">
								<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" fetchpriority="high" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured-800x450.jpg" data-srcset="" srcset="" />							</figure>
														<p class="c-article__headline u-hidden@md">
								<a href="https://securelist.com/category/sas/" class="c-tag c-tag--primary">SAS</a>
							</p>
														<h1 class="c-article__title">SAS CTF and the many ways to persist a kernel shellcode on Windows 7</h1>							<div class="c-article__info">
																<p class="c-article__headline u-hidden u-block@md">
									<a href="https://securelist.com/category/sas/" class="c-tag c-tag--primary">SAS</a>
								</p>
																<p class="u-uppercase"><time datetime="2024-10-17T10:00:17+00:00">17 Oct 2024</time></p>
								<p class="c-article__reading u-ml-auto@md">
									<svg class="o-icon o-svg-icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-hourglass"></use></svg> <span class="js-reading-time"></span> minute read								</p>
							</div>
						</header>

						<div class="c-article__wrapper">

							<div class="c-article__main">

																<div class="c-highlight c-highlight--overflow-down@md js-accordion u-hidden@md">
									<div class="c-accordion-toggle js-accordion-toggle">
										<div class="c-highlight__header">
											<div class="c-highlight__icon">
												<div class="u-block--theme-light u-hidden--theme-dark">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" />
												</div>
												<div class="u-block--theme-dark u-hidden--theme-light">
													<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" />
												</div>
											</div>
											<div class="c-highlight__title">
												<p>Table of Contents</p>
											</div>
										</div>
									</div>
									<div class="js-accordion-container">
										<div class="c-highlight__body">
											<ul class='c-list-links'><li><a href="#vulnerability-details">Vulnerability details</a></li><li><a href="#exploitation">Exploitation</a></li><li><a href="#the-sas-ctf-challenge">The SAS CTF challenge</a></li><ul class='c-list-links'><li><a href="#the-beginning">The beginning</a></li><li><a href="#identifying-the-vm-and-the-os">Identifying the VM and the OS</a></li><li><a href="#set-up-the-debugger">Set up the debugger</a></li><li><a href="#crash">Crash!</a></li><li><a href="#analyzing-the-crash">Analyzing the crash</a></li><li><a href="#the-shellcode">The shellcode</a></li><li><a href="#booting-with-the-shellcode">Booting with the shellcode</a></li><li><a href="#decrypting-the-second-stage">Decrypting the second stage</a></li><li><a href="#the-second-stage">The second stage</a></li><li><a href="#usermode-payload">Usermode payload</a></li></ul><li><a href="#the-sas-ctf-final-competition">The SAS CTF final competition</a></li></ul>										</div>
									</div>
								</div>
								
								<div class="o-row c-article__container">
									<div class="o-col c-article__content js-article-body">
										<div class="js-reading-wrapper">
											<figure class="c-article__figure u-hidden u-block@md">
												<img width="1200" height="600" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured-1200x600.jpg" class="attachment-securelist-2020-thumbnail-large size-securelist-2020-thumbnail-large wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured-1200x600.jpg" data-srcset="" srcset="" />											</figure>

											<div class="c-article__authors u-hidden u-block@md">
												<p class="c-block__title">Authors</p>
												<ul class="c-list-authors">
																<li>
			<a  href="https://securelist.com/author/igorsoumenkov/" >
								<img alt='' src='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21153607/Igor_Kuznetsov_Securelist_2023-30x30.jpg' srcset='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21153607/Igor_Kuznetsov_Securelist_2023-60x60.jpg 2x' class='avatar avatar-30 photo' height='30' width='30' loading='lazy' decoding='async'/>										<span>Igor Kuznetsov</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/borislarin/" >
								<img alt='' src='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-30x30.jpg' srcset='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-60x60.jpg 2x' class='avatar avatar-30 photo' height='30' width='30' loading='lazy' decoding='async'/>										<span>Boris Larin</span></a>
		</li>
														</ul>
											</div>

											
											<div class="js-reading-content">
												<div class="c-wysiwyg">
													<p>On May 18, 2024, Kaspersky&#8217;s Global Research &amp; Analysis Team (GReAT), with the help of its partners, held the qualifying stage of the SAS CTF, an international competition of cybersecurity experts held as part of the <a href="https://thesascon.com/" target="_blank" rel="noopener">Security Analyst Summit conference</a>. More than 800 teams from all over the world took part in the event, solving challenges based on real cases that Kaspersky GReAT encountered in its work, but a couple of challenges remained unsolved. One of those challenges was based on a security issue that allows kernel shellcode to be hidden in the system registry and executed during system boot on a fully updated Windows 7/Windows Server 2008 R2 due to an incomplete fix for the <a href="https://learn.microsoft.com/en-us/security-updates/securitybulletins/2011/ms11-011#driver-improper-interaction-with-windows-kernel-vulnerability---cve-2010-4398" target="_blank" rel="noopener">CVE-2010-4398</a> vulnerability. Although security updates and technical support for Windows 7 ended in early 2020, the fact that the released patch only partially addressed the issue was <a href="https://powerofcommunity.net/poc2012/mj0011.pdf" target="_blank" rel="noopener">known</a> long before that, and we saw this flaw exploited in a targeted attack in 2018. At the time, we notified Microsoft about the in-the-wild exploitation, but Microsoft refused to address it because using this technique requires attackers to have administrator privileges. In this blog post, we will provide technical details about this flaw and the SAS CTF task based on it.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-large wp-image-114184" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-1024x619.png" alt="" width="1024" height="619" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-1024x619.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-300x181.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-768x464.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-1536x928.png 1536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-330x200.png 330w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-579x350.png 579w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-740x447.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-463x280.png 463w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01-800x483.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123608/SAS_CTF_01.png 2044w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<h2 id="vulnerability-details">Vulnerability details</h2>
<p>There is a design flaw in older versions of Windows operating systems (Windows NT 4.0 through Windows 7) that allows a kernel shellcode to persist and be launched at system boot by writing specially crafted data to some of the many locations in the system registry.</p>
<p>Windows Kernel API has a function called <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-rtlqueryregistryvalues" target="_blank" rel="noopener">RtlQueryRegistryValues</a> that can be used to query multiple values from the registry subtree with a single call.</p>
		<div id="crayon-671b7b83c46c6137445906" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
NTSYSAPI NTSTATUS RtlQueryRegistryValues(
  [in]           ULONG                     RelativeTo,
  [in]           PCWSTR                    Path,
  [in, out]      PRTL_QUERY_REGISTRY_TABLE QueryTable,
  [in, optional] PVOID                     Context,
  [in, optional] PVOID                     Environment
);</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46c6137445906-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46c6137445906-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46c6137445906-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46c6137445906-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46c6137445906-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46c6137445906-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46c6137445906-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46c6137445906-1"><span class="crayon-e">NTSYSAPI </span><span class="crayon-e">NTSTATUS </span><span class="crayon-e">RtlQueryRegistryValues</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46c6137445906-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-st">in</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">RelativeTo</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46c6137445906-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-st">in</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">PCWSTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">Path</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46c6137445906-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-st">in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">out</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PRTL_QUERY_REGISTRY_TABLE </span><span class="crayon-i">QueryTable</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46c6137445906-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-st">in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">optional</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">Context</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46c6137445906-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">[</span><span class="crayon-st">in</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">optional</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-i">Environment</span></div><div class="crayon-line" id="crayon-671b7b83c46c6137445906-7"><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
<p style="text-align: center"><strong><em>RtlQueryRegistryValues syntax</em></strong></p>
<p>The values to be queried by this function are defined by the <em>QueryTable</em> parameter, which contains a pointer to a table consisting of <em>_RTL_QUERY_REGISTRY_TABLE</em> structures.</p>
		<div id="crayon-671b7b83c46d1342610705" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
typedef struct _RTL_QUERY_REGISTRY_TABLE {
    PRTL_QUERY_REGISTRY_ROUTINE QueryRoutine;
    ULONG Flags;
    PWSTR Name;
    PVOID EntryContext;
    ULONG DefaultType;
    PVOID DefaultData;
    ULONG DefaultLength;
} RTL_QUERY_REGISTRY_TABLE, *PRTL_QUERY_REGISTRY_TABLE;</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46d1342610705-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46d1342610705-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46d1342610705-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46d1342610705-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46d1342610705-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46d1342610705-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46d1342610705-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46d1342610705-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c46d1342610705-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46d1342610705-1"><span class="crayon-r">typedef</span><span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">_RTL_QUERY_REGISTRY_TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46d1342610705-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PRTL_QUERY_REGISTRY_ROUTINE </span><span class="crayon-i">QueryRoutine</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671b7b83c46d1342610705-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ULONG </span><span class="crayon-i">Flags</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46d1342610705-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PWSTR </span><span class="crayon-i">Name</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671b7b83c46d1342610705-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PVOID </span><span class="crayon-i">EntryContext</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46d1342610705-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ULONG </span><span class="crayon-i">DefaultType</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671b7b83c46d1342610705-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">PVOID </span><span class="crayon-i">DefaultData</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46d1342610705-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">ULONG </span><span class="crayon-i">DefaultLength</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-671b7b83c46d1342610705-9"><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-i">RTL_QUERY_REGISTRY_TABLE</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>*<span class="crayon-i">PRTL_QUERY_REGISTRY_TABLE</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
<p style="text-align: center"><strong><em>_RTL_QUERY_REGISTRY_TABLE structure definition</em></strong></p>
<p>Each table entry defines the name of the value to query, its default type (e.g., <em>REG_NONE</em>, <em>REG_BINARY</em>, <em>REG_DWORD</em>, <em>REG_SZ</em> etc.; this is optional) and default data, the address of the buffer to store the value or the address of the callback function, and flags that control how to query this value.</p>
<p>One of the supported flags, <em>RTL_QUERY_REGISTRY_DIRECT</em>, causes RtlQueryRegistryValues ​​not to execute a callback function (pointed to by the entry&#8217;s <em>QueryRoutine</em> field), but to store the queried value directly to the provided buffer (pointed to by the entry&#8217;s <em>EntryContext</em> field).</p>
<p>While writing data directly to the provided buffer instead of executing a callback may be more convenient, it leads to unexpected consequences if the requested value in the registry is for some reason of an unexpected type. For instance, if the code expects a value of type <em>REG_DWORD</em>, which has a fixed size of four bytes, but receives a value of type <em>REG_BINARY</em>, which is variable in size, the value may not fit fully into the prepared buffer. As a result, if RtlQueryRegistryValues returns more data than the calling function expected, a buffer overflow occurs that can be easily exploited on Windows 7 and older systems because of the lack of stack cookies.</p>
<p>To address this issue, Microsoft has implemented and encouraged developers to use an additional flag, <em>RTL_QUERY_REGISTRY_TYPECHECK</em>, which is intended to be used in conjunction with the <em>RTL_QUERY_REGISTRY_DIRECT</em> flag to check that the type of the requested value matches the type expected by the caller.</p>
<div id="attachment_114185" style="width: 1034px" class="wp-caption aligncenter"><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02.png" class="magnificImage"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-114185" class="size-large wp-image-114185" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-1024x314.png" alt="Note from RtlQueryRegistryValues documentation" width="1024" height="314" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-1024x314.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-300x92.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-768x235.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-1142x350.png 1142w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-740x227.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-913x280.png 913w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02-800x245.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123832/SAS_CTF_02.png 1256w" sizes="(max-width: 1024px) 100vw, 1024px" /></a><p id="caption-attachment-114185" class="wp-caption-text">Note from RtlQueryRegistryValues documentation</p></div>
<p>However, this is by no means a complete fix, and for Windows 7 Microsoft itself started using the new flag only where it was absolutely necessary to address possible privilege escalation vulnerabilities. As for the vulnerable registry/code paths that could be accessed with admin rights, they were not patched, giving attackers the opportunity to stealthily store and execute kernel shellcode.</p>
<p>In one of the attacks, we observed an APT actor using two DirectX drivers for exploitation – &#8220;dxgmms1.sys&#8221; and &#8220;dxgkrnl.sys&#8221; – but a quick look revealed about a dozen vulnerable drivers included in the Windows 7/Windows Server 2008 R2 base package.</p>
<h2 id="exploitation">Exploitation</h2>
<p>To execute kernel shellcode, attackers exploit multiple stack buffer overflows in two drivers using the RtlQueryRegistryValues function. This is done in two stages.</p>
<p>In the first stage, attackers exploit the insecure use of the RtlQueryRegistryValues function in the &#8220;dxgmms1.sys&#8221; driver. The vulnerable code queries several registry values from the path &#8220;HKLM\SYSTEM\ControlSet001\Control\GraphicsDrivers\MemoryManager&#8221;, and making these registry entries bigger than expected results in several buffer overflows. Attackers can use this to write the shellcode to a fixed location in the kernel memory at the address 0xfffff78000000800, which is an address of the <a href="https://msrc.microsoft.com/blog/2022/04/randomizing-the-kuser_shared_data-structure-on-windows/" target="_blank" rel="noopener">KUSER_SHARED_DATA</a> structure + 0x800.</p>
<div id="attachment_114186" style="width: 695px" class="wp-caption aligncenter"><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123917/SAS_CTF_03.png" class="magnificImage"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-114186" class="size-full wp-image-114186" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123917/SAS_CTF_03.png" alt="Exploitation of &quot;dxgmms1.sys&quot; driver" width="685" height="338" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123917/SAS_CTF_03.png 685w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123917/SAS_CTF_03-300x148.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123917/SAS_CTF_03-567x280.png 567w" sizes="(max-width: 685px) 100vw, 685px" /></a><p id="caption-attachment-114186" class="wp-caption-text">Exploitation of &#8220;dxgmms1.sys&#8221; driver</p></div>
<p>In the second stage, attackers exploit the insecure use of the RtlQueryRegistryValues function in the &#8220;dxgkrnl.sys&#8221; driver – the registry values ​​used by the vulnerable code are located at &#8220;HKLM\SYSTEM\ControlSet001\Control\GraphicsDrivers&#8221;. This allows attackers to overwrite the return address of one of the called functions with an address of 0xfffff78000000800, resulting in the execution of the shellcode written in the first stage of exploitation.</p>
<div id="attachment_114187" style="width: 704px" class="wp-caption aligncenter"><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123956/SAS_CTF_04.png" class="magnificImage"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-114187" class="size-full wp-image-114187" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123956/SAS_CTF_04.png" alt="Exploitation of &quot; dxgkrnl.sys&quot; driver" width="694" height="362" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123956/SAS_CTF_04.png 694w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123956/SAS_CTF_04-300x156.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123956/SAS_CTF_04-671x350.png 671w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15123956/SAS_CTF_04-537x280.png 537w" sizes="(max-width: 694px) 100vw, 694px" /></a><p id="caption-attachment-114187" class="wp-caption-text">Exploitation of &#8221; dxgkrnl.sys&#8221; driver</p></div>
<p>All registry values ​​used during exploitation are expected to be of type <em>REG_DWORD</em>, but the attackers have set them to malicious values ​​of type <em>REG_SZ</em>/<em>REG_BINARY</em>. Since the SYSTEM hive is explicitly trusted, the data type mismatch is ignored and this results in successful exploitation.</p>
<h2 id="the-sas-ctf-challenge">The SAS CTF challenge</h2>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-large wp-image-114188" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-1024x685.png" alt="" width="1024" height="685" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-1024x685.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-300x201.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-768x514.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-523x350.png 523w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-740x495.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-419x280.png 419w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05-800x535.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124042/SAS_CTF_05.png 1492w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<h3 id="the-beginning">The beginning</h3>
<p>You are presented with a README.txt note and three other files:</p>
		<div id="crayon-671b7b83c46d4838553441" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
README.txt  SOFTWARE  SYSTEM  traffic.pcapng</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46d4838553441-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46d4838553441-1"><span class="crayon-i">README</span><span class="crayon-sy">.</span><span class="crayon-e">txt&nbsp;&nbsp;</span><span class="crayon-e">SOFTWARE&nbsp;&nbsp;</span><span class="crayon-e">SYSTEM&nbsp;&nbsp;</span><span class="crayon-i">traffic</span><span class="crayon-sy">.</span><span class="crayon-i">pcapng</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The SOFTWARE and SYSTEM files are what they are supposed to be, and are the registry hives of a Windows system.</p>
		<div id="crayon-671b7b83c46db205555150" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ file *
README.txt:     ASCII text
SOFTWARE:       MS Windows registry file, NT/2000 or above
SYSTEM:         MS Windows registry file, NT/2000 or above
traffic.pcapng: pcapng capture file - version 1.0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46db205555150-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46db205555150-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46db205555150-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46db205555150-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46db205555150-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46db205555150-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e ">file *</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46db205555150-2"><span class="crayon-i">README</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span><span class="crayon-sy">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">ASCII </span><span class="crayon-e">text</span></div><div class="crayon-line" id="crayon-671b7b83c46db205555150-3"><span class="crayon-i">SOFTWARE</span><span class="crayon-sy">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MS </span><span class="crayon-e">Windows </span><span class="crayon-e">registry </span><span class="crayon-i">file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">NT</span>/<span class="crayon-cn">2000</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">above</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46db205555150-4"><span class="crayon-i">SYSTEM</span><span class="crayon-sy">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">MS </span><span class="crayon-e">Windows </span><span class="crayon-e">registry </span><span class="crayon-i">file</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">NT</span>/<span class="crayon-cn">2000</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-e">above</span></div><div class="crayon-line" id="crayon-671b7b83c46db205555150-5"><span class="crayon-i">traffic</span><span class="crayon-sy">.</span><span class="crayon-i">pcapng</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">pcapng </span><span class="crayon-e">capture </span><span class="crayon-i">file</span><span class="crayon-h"> </span>-<span class="crayon-h"> </span><span class="crayon-i">version</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Now, our first goal would be to find the piece of registry that is causing the VM to crash. This can be done in several ways, such as trying to find a piece of executable code in the registry hives (there is a NOP sled at offset 0x92D675 in the SYSTEM hive). But let&#8217;s try to reproduce the crash instead.</p>
<h3 id="identifying-the-vm-and-the-os">Identifying the VM and the OS</h3>
<p>We are going to use <a href="https://pypi.org/project/regipy/" target="_blank" rel="noopener">regipy</a> to parse and dump the registry hives. By dumping the SYSTEM hive, we can easily recognize the VirtualBox devices:</p>
		<div id="crayon-671b7b83c46dd987580189" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ regipy-dump -d SYSTEM  | grep VBo
    "subkey_name": "VBoxWddm",
    "path": "\\ControlSet001\\services\\eventlog\\System\\VBoxWddm",
    "subkey_name": "VBoxGuest",
    "path": "\\ControlSet001\\services\\VBoxGuest",
    "path": "\\ControlSet001\\services\\VBoxMouse\\DriverInfo",
    "subkey_name": "VBoxMouse",
...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46dd987580189-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46dd987580189-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46dd987580189-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46dd987580189-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46dd987580189-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46dd987580189-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46dd987580189-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46dd987580189-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46dd987580189-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">regipy</span>-<span class="crayon-i">dump</span><span class="crayon-h"> </span>-<span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-i">SYSTEM</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-e">grep </span><span class="crayon-i">VBo</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46dd987580189-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"subkey_name"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"VBoxWddm"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46dd987580189-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"path"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"\\ControlSet001\\services\\eventlog\\System\\VBoxWddm"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46dd987580189-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"subkey_name"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"VBoxGuest"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46dd987580189-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"path"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"\\ControlSet001\\services\\VBoxGuest"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46dd987580189-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"path"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"\\ControlSet001\\services\\VBoxMouse\\DriverInfo"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46dd987580189-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"subkey_name"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"VBoxMouse"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46dd987580189-8"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Just to be sure, we can even find the right version of the VirtualBox additions package, which is 6.1.46:</p>
		<div id="crayon-671b7b83c46df912474370" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ regipy-dump SOFTWARE  -p '\Microsoft\Windows\CurrentVersion\Uninstall' | 
grep racle
    "subkey_name": "Oracle VM VirtualBox Guest Additions",
    "path": "\\Oracle VM VirtualBox Guest Additions",
            "value": "Oracle VM VirtualBox Guest Additions 6.1.46",
            "value": "C:\\Program Files\\Oracle\\VirtualBox Guest 
Additions\\uninst.exe",
            "value": "Oracle Corporation",</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46df912474370-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46df912474370-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46df912474370-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46df912474370-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46df912474370-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46df912474370-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46df912474370-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46df912474370-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46df912474370-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">regipy</span>-<span class="crayon-e">dump </span><span class="crayon-i">SOFTWARE</span><span class="crayon-h">&nbsp;&nbsp;</span>-<span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-s">'\Microsoft\Windows\CurrentVersion\Uninstall'</span><span class="crayon-h"> </span><span class="crayon-sy">|</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46df912474370-2"><span class="crayon-e">grep </span><span class="crayon-i">racle</span></div><div class="crayon-line" id="crayon-671b7b83c46df912474370-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"subkey_name"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Oracle VM VirtualBox Guest Additions"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46df912474370-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"path"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"\\Oracle VM VirtualBox Guest Additions"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46df912474370-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"value"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Oracle VM VirtualBox Guest Additions 6.1.46"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46df912474370-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"value"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"C:\\Program Files\\Oracle\\VirtualBox Guest </span></div><div class="crayon-line" id="crayon-671b7b83c46df912474370-7"><span class="crayon-s">Additions\\uninst.exe"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46df912474370-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"value"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Oracle Corporation"</span><span class="crayon-sy">,</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
We also can identify the exact Windows build to run, which turns out to be Windows 7 SP1 x64:</p>
		<div id="crayon-671b7b83c46e1778120724" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ regipy-plugins-run -p winver_plugin -o output.txt SOFTWARE  &amp;&amp; cat output.txt
Loaded 52 plugins
INFO:regipy.plugins.software.winver:Started winver Plugin...
Finished: 1/52 plugins matched the hive type
{
    "winver_plugin": {
        "\\Microsoft\\Windows NT\\CurrentVersion": {
            "last_write": "2024-05-13T23:45:33.125000+00:00",
            "CurrentVersion": "6.1",
            "CurrentBuild": "7601",
            "InstallDate": "2024-05-13 05:14:05",
            "RegisteredOrganization": 0,
            "RegisteredOwner": "user",
            "InstallationType": "Client",
            "EditionID": "Enterprise",
            "ProductName": "Windows 7 Enterprise",
            "ProductId": "00392-918-5000002-85992",
            "CurrentBuildNumber": "7601",
            "BuildLab": "7601.win7sp1_gdr.130828-1532",
            "BuildLabEx": "7601.18247.amd64fre.win7sp1_gdr.130828-1532",
            "CSDVersion": "Service Pack 1"
        }
    }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-14">14</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-16">16</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-18">18</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-20">20</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e1778120724-22">22</div><div class="crayon-num" data-line="crayon-671b7b83c46e1778120724-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46e1778120724-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">regipy</span>-<span class="crayon-i">plugins</span>-<span class="crayon-i">run</span><span class="crayon-h"> </span>-<span class="crayon-i">p</span><span class="crayon-h"> </span><span class="crayon-i">winver_plugin</span><span class="crayon-h"> </span>-<span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-i">output</span><span class="crayon-sy">.</span><span class="crayon-e">txt </span><span class="crayon-i">SOFTWARE</span><span class="crayon-h">&nbsp;&nbsp;</span>&&<span class="crayon-h"> </span><span class="crayon-e">cat </span><span class="crayon-i">output</span><span class="crayon-sy">.</span><span class="crayon-e">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-2"><span class="crayon-i">Loaded</span><span class="crayon-h"> </span><span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-e">plugins</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-3"><span class="crayon-i">INFO</span><span class="crayon-sy">:</span><span class="crayon-i">regipy</span><span class="crayon-sy">.</span><span class="crayon-i">plugins</span><span class="crayon-sy">.</span><span class="crayon-i">software</span><span class="crayon-sy">.</span><span class="crayon-i">winver</span><span class="crayon-sy">:</span><span class="crayon-e">Started </span><span class="crayon-e">winver </span><span class="crayon-i">Plugin</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-4"><span class="crayon-i">Finished</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span>/<span class="crayon-cn">52</span><span class="crayon-h"> </span><span class="crayon-e">plugins</span><span class="crayon-h"> </span><span class="crayon-e">matched</span><span class="crayon-h"> </span><span class="crayon-e">the</span><span class="crayon-h"> </span><span class="crayon-e">hive</span><span class="crayon-h"> </span><span class="crayon-e">type</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-5"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"winver_plugin"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"\\Microsoft\\Windows NT\\CurrentVersion"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"last_write"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"2024-05-13T23:45:33.125000+00:00"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"CurrentVersion"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"6.1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"CurrentBuild"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"7601"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"InstallDate"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"2024-05-13 05:14:05"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"RegisteredOrganization"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"RegisteredOwner"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"user"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"InstallationType"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Client"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"EditionID"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Enterprise"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ProductName"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Windows 7 Enterprise"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"ProductId"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"00392-918-5000002-85992"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"CurrentBuildNumber"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"7601"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"BuildLab"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"7601.win7sp1_gdr.130828-1532"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"BuildLabEx"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"7601.18247.amd64fre.win7sp1_gdr.130828-1532"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"CSDVersion"</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">"Service Pack 1"</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e1778120724-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-671b7b83c46e1778120724-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Now let&#8217;s grab a Windows 7 SP1 VM or install a fresh one in a VirtualBox VM. While the VM is booting, let&#8217;s also build a timeline of the registry hive that we may need later:</p>
		<div id="crayon-671b7b83c46e3386869306" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ regipy-dump -t -o timeline-system.txt SYSTEM</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46e3386869306-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46e3386869306-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">regipy</span>-<span class="crayon-i">dump</span><span class="crayon-h"> </span>-<span class="crayon-i">t</span><span class="crayon-h"> </span>-<span class="crayon-i">o</span><span class="crayon-h"> </span><span class="crayon-i">timeline</span>-<span class="crayon-i">system</span><span class="crayon-sy">.</span><span class="crayon-e">txt </span><span class="crayon-i">SYSTEM</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Now download your favorite Live CD (for example, a vanilla <a href="https://ubuntu.com/download/desktop" target="_blank" rel="noopener">Ubuntu Desktop ISO</a> that we&#8217;ll boot to transplant the registry hives into the Windows system).</p>
<p>Install the VirtualBox guest additions from the official ISO to match what was installed in the original system. The clues in the README note (video driver!), the list of installed drivers and the shimcache (try &#8220;regipy-plugins-run -p shimcache -o output.txt SYSTEM &amp;&amp; cat output.txt&#8221;, it will mention running dxdiag.exe) suggest that the system should be configured with Direct3D support, and this is crucial to triggering the exploit.</p>
<p>Once installed, &#8220;dxdiag.exe&#8221; should show &#8220;Enabled&#8221; for Direct3D on the VM:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124711/SAS_CTF_06.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114189" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124711/SAS_CTF_06.png" alt="" width="740" height="536" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124711/SAS_CTF_06.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124711/SAS_CTF_06-300x217.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124711/SAS_CTF_06-483x350.png 483w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124711/SAS_CTF_06-387x280.png 387w" sizes="(max-width: 740px) 100vw, 740px" /></a></p>
<h3 id="set-up-the-debugger">Set up the debugger</h3>
<p>Before we continue, let&#8217;s turn on kernel debugging inside the VM. Since we know there should be a BSOD, we will need it. You can also do this later by backing up the original registry hives to boot into the system and run the proper commands.</p>
		<div id="crayon-671b7b83c46e7750541330" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
bcdedit /debug on
bcdedit /bootdebug {current} on
bcdedit /dbgsettings serial debugport:*port number* baudrate:115200</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46e7750541330-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46e7750541330-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46e7750541330-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46e7750541330-1"><span class="crayon-e">bcdedit</span><span class="crayon-h"> </span>/<span class="crayon-e">debug</span><span class="crayon-h"> </span><span class="crayon-e">on</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46e7750541330-2"><span class="crayon-e">bcdedit</span><span class="crayon-h"> </span>/<span class="crayon-e">bootdebug</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-i">current</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-e">on</span></div><div class="crayon-line" id="crayon-671b7b83c46e7750541330-3"><span class="crayon-i">bcdedit</span><span class="crayon-h"> </span>/<span class="crayon-e">dbgsettings </span><span class="crayon-e">serial </span><span class="crayon-i">debugport</span><span class="crayon-sy">:</span>*<span class="crayon-e">port </span><span class="crayon-e ">number*</span><span class="crayon-h"> </span><span class="crayon-i">baudrate</span><span class="crayon-sy">:</span><span class="crayon-cn">115200</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
We will also set up a second Windows VM with the Windows Debugger and connect it to our target VM using a pipe-based virtual COM port. Start WinDbg on the debugger system (&#8220;Kernel Debug&#8221;), reboot the VM and you should see the kernel debugger connect. If not, check the COM port connection between the machines. It is also possible to use the host machine to run the debugger.</p>
<h3 id="crash">Crash!</h3>
<p>Once it is working, replace the SOFTWARE and SYSTEM hives. Back up the original files, copy the hives (drag and drop, or via a share) to the VM and reboot into a Live CD, mount the NTFS volume, then copy the hives to &#8220;<em>mountpoint</em>/Windows/System32/config/&#8221;. Reboot and you should get an infinite BSOD loop/connection to the debugger.</p>
<p>Without the debugger it looks like this:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114190" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07.png" alt="" width="645" height="483" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07.png 645w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07-300x225.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07-200x150.png 200w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07-467x350.png 467w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124815/SAS_CTF_07-374x280.png 374w" sizes="(max-width: 645px) 100vw, 645px" /></a></p>
<p>With the debugger, WinDbg output looks like this:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114191" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08.png" alt="" width="806" height="194" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08.png 806w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08-300x72.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08-768x185.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08-800x193.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124841/SAS_CTF_08-740x178.png 740w" sizes="(max-width: 806px) 100vw, 806px" /></a></p>
<h3 id="analyzing-the-crash">Analyzing the crash</h3>
<p>We need to investigate this crash. Now, we can either extract the crash dump and inspect it offline, or debug live with our debugger machine (host, or a second VM) – let&#8217;s continue with the latter course. Make sure you can download the correct symbols, set up the symbol path, and execute &#8220;.reload /f&#8221; in WinDbg to force the download.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114192" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09.png" alt="" width="816" height="475" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09.png 816w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09-300x175.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09-768x447.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09-601x350.png 601w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09-740x431.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09-481x280.png 481w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124914/SAS_CTF_09-800x466.png 800w" sizes="(max-width: 816px) 100vw, 816px" /></a></p>
<p>By inspecting the addresses on the stack around the stack pointer we can find an address inside &#8220;dxgkrnl&#8221;:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124940/SAS_CTF_10.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114193" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124940/SAS_CTF_10.png" alt="" width="569" height="334" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124940/SAS_CTF_10.png 569w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124940/SAS_CTF_10-300x176.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124940/SAS_CTF_10-477x280.png 477w" sizes="(max-width: 569px) 100vw, 569px" /></a></p>
<p>Further on in the stack we see the return addresses from nt!ObCreateObject:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124959/SAS_CTF_11.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114194" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124959/SAS_CTF_11.png" alt="" width="582" height="463" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124959/SAS_CTF_11.png 582w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124959/SAS_CTF_11-300x239.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124959/SAS_CTF_11-440x350.png 440w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15124959/SAS_CTF_11-352x280.png 352w" sizes="(max-width: 582px) 100vw, 582px" /></a></p>
<p>Now we have a choice: either analyze the vulnerability in dxgkrnl and dxgmms1 until we understand exactly what is happening, or take a more hacky route, guided by the task note (&#8220;I tried to fix the registry but now it bluescreens all the time&#8221;):</p>
<ul>
<li>check the memory around the crash pointer. At the address +0x800 from the crash site you can clearly see a shellcode that doesn&#8217;t belong to any module and can be analyzed;<a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125047/SAS_CTF_12.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114195" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125047/SAS_CTF_12.png" alt="" width="700" height="402" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125047/SAS_CTF_12.png 700w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125047/SAS_CTF_12-300x172.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125047/SAS_CTF_12-609x350.png 609w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125047/SAS_CTF_12-488x280.png 488w" sizes="(max-width: 700px) 100vw, 700px" /></a></li>
<li>search for the crash pointer address in the registry, using the timeline we generated and looking for &#8220;recent&#8221; changes.<br />

		<div id="crayon-671b7b83c46e9583697808" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ grep -i fffff78000000000 timeline-system.txt</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46e9583697808-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46e9583697808-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">grep</span><span class="crayon-h"> </span>-<span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-e">fffff78000000000 </span><span class="crayon-i">timeline</span>-<span class="crayon-i">system</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
</li>
</ul>
<p>Nothing. Let&#8217;s reverse the byte order (it may be a binary string, little endian):</p>
		<div id="crayon-671b7b83c46ed190748288" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ grep -i 0000000080f7ffff timeline-system.txt
2024-05-16 
13:39:56.411698+00:00,\ControlSet001\Control\GraphicsDrivers,5,"[Value(name
='DxgKrnlVersion', value=8197, value_type='REG_DWORD', is_corrupted=False), 
Value(name='UseXPModel', value=0, value_type='REG_DWORD', 
is_corrupted=False), Value(name='TdrLevel', 
value='00000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000080f7ffff', 
value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDdiDelay', 
value='03000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000080f7ffff', 
value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDebugMode', 
value='02000000000000000500000000000000030000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000080f7ffff', value_type='REG_BINARY', is_corrupted=False)]"
2024-05-16 
13:41:27.599198+00:00,\ControlSet002\Control\GraphicsDrivers,5,"[Value(name
='DxgKrnlVersion', value=8197, value_type='REG_DWORD', is_corrupted=False), 
Value(name='UseXPModel', value=0, value_type='REG_DWORD', 
is_corrupted=False), Value(name='TdrLevel', 
value='00000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000080f7ffff', 
value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDdiDelay', 
value='03000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000080f7ffff', 
value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDebugMode', 
value='02000000000000000500000000000000030000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000080f7ffff', value_type='REG_BINARY', is_corrupted=False)]"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-14">14</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-16">16</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-18">18</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-20">20</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-22">22</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-24">24</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-26">26</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-28">28</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-30">30</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-32">32</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ed190748288-34">34</div><div class="crayon-num" data-line="crayon-671b7b83c46ed190748288-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46ed190748288-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">grep</span><span class="crayon-h"> </span>-<span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-cn">0000000080f7ffff</span><span class="crayon-h"> </span><span class="crayon-i">timeline</span>-<span class="crayon-i">system</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-2"><span class="crayon-cn">2024</span>-<span class="crayon-cn">05</span>-<span class="crayon-cn">16</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-3"><span class="crayon-cn">13</span><span class="crayon-sy">:</span><span class="crayon-cn">39</span><span class="crayon-sy">:</span><span class="crayon-cn">56.411698</span>+<span class="crayon-cn">00</span><span class="crayon-sy">:</span><span class="crayon-cn">00</span><span class="crayon-sy">,</span><span class="crayon-sy">\</span><span class="crayon-i">ControlSet001</span><span class="crayon-sy">\</span><span class="crayon-i">Control</span><span class="crayon-sy">\</span><span class="crayon-i">GraphicsDrivers</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-s">"[Value(name</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-4"><span class="crayon-s">='DxgKrnlVersion', value=8197, value_type='REG_DWORD', is_corrupted=False), </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-5"><span class="crayon-s">Value(name='UseXPModel', value=0, value_type='REG_DWORD', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-6"><span class="crayon-s">is_corrupted=False), Value(name='TdrLevel', </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-7"><span class="crayon-s">value='00000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-8"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-9"><span class="crayon-s">0000000000000000000000000000000000000000080f7ffff', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-10"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDdiDelay', </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-11"><span class="crayon-s">value='03000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-12"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-13"><span class="crayon-s">00000000000000000000000000000000000000000000000000000000080f7ffff', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-14"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDebugMode', </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-15"><span class="crayon-s">value='02000000000000000500000000000000030000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-16"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-17"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-18"><span class="crayon-s">0000000000000080f7ffff', value_type='REG_BINARY', is_corrupted=False)]"</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-19"><span class="crayon-cn">2024</span>-<span class="crayon-cn">05</span>-<span class="crayon-cn">16</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-20"><span class="crayon-cn">13</span><span class="crayon-sy">:</span><span class="crayon-cn">41</span><span class="crayon-sy">:</span><span class="crayon-cn">27.599198</span>+<span class="crayon-cn">00</span><span class="crayon-sy">:</span><span class="crayon-cn">00</span><span class="crayon-sy">,</span><span class="crayon-sy">\</span><span class="crayon-i">ControlSet002</span><span class="crayon-sy">\</span><span class="crayon-i">Control</span><span class="crayon-sy">\</span><span class="crayon-i">GraphicsDrivers</span><span class="crayon-sy">,</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-s">"[Value(name</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-21"><span class="crayon-s">='DxgKrnlVersion', value=8197, value_type='REG_DWORD', is_corrupted=False), </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-22"><span class="crayon-s">Value(name='UseXPModel', value=0, value_type='REG_DWORD', </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-23"><span class="crayon-s">is_corrupted=False), Value(name='TdrLevel', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-24"><span class="crayon-s">value='00000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-25"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-26"><span class="crayon-s">0000000000000000000000000000000000000000080f7ffff', </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-27"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDdiDelay', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-28"><span class="crayon-s">value='03000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-29"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-30"><span class="crayon-s">00000000000000000000000000000000000000000000000000000000080f7ffff', </span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-31"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), Value(name='TdrDebugMode', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-32"><span class="crayon-s">value='02000000000000000500000000000000030000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-33"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ed190748288-34"><span class="crayon-s">000000000000000000000000000000000000000000000000000000000000000000000000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ed190748288-35"><span class="crayon-s">0000000000000080f7ffff', value_type='REG_BINARY', is_corrupted=False)]"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Now there are three registry values that contain the crash address (&#8220;TdrDdiDelay&#8221;, &#8220;TdrDebugMode&#8221; and &#8220;TdrLevel&#8221;), and these *could* be controlling the return address of a dxgkrnl driver&#8217;s routine. Let&#8217;s see if the location of the shellcode can also be found in the registry:</p>
		<div id="crayon-671b7b83c46ef961679457" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
$ grep -i 0008000080f7ffff timeline-system.txt
2024-05-16 
12:30:09.856290+00:00,\ControlSet001\Control\GraphicsDrivers\MemoryManager,
6,"[Value(name='PinnedMemoryLimit', 
value='9cffffff00000000000000000000000000', value_type='REG_BINARY', 
is_corrupted=False), Value(name='PagesHistory', 
value='00000000000000000000000004000000040000000000000038ffffff', 
value_type='REG_BINARY', is_corrupted=False), 
Value(name='NbDmaBufferLimitPerDevice', 
value='000000020000000000000080000000000008000080f7ffff', 
value_type='REG_BINARY', is_corrupted=False), Value(name='UseUnreset', 
value='01000000000000000100000000000000010000000000000000000000000000000a00
0000000000000f0000000000000005000000000000002c01000000008000000010003c00000
000008000020000003c000000000000003c0000000100000058020000000400000200000000
00000200000000400000000000000000000000', value_type='REG_BINARY', 
is_corrupted=False), Value(name='NbPagingHistoryRecords', 
value='504889e141574156415541544883ec20e80d0000004883c420415c415d415e415fc3
48895c2408488974241048897c24185541544155415641574889e54883ec7065488b1425380
0000031c04989cc8d4828488d7dd0f3aa0fb77a06b80000ffffc1e7104821c78b420848c1e0
204809c70fb7022500f00000be000500004809', value_type='REG_SZ', 
is_corrupted=False), Value(name='Control', 
value='9d180bde5b394ac1244ebafbe47cf4fbf43309b5904beb0d6310dbbf7d574f317f52
a769b63bf326c24e397139d8b483349d6eb17aef6d4eb96ede7f7ed05231aa35d61ed118cf7
3f7b5146844f37dfb385dea883a3c70b48b14404a5a1a2544124d3ac3a634284ec34565f6a9
16e9de35cef1919d4cad6e6925e7f30ecadf83', value_type='REG_SZ', 
is_corrupted=False)]"
2024-05-16 
12:30:09.856290+00:00,\ControlSet002\Control\GraphicsDrivers\MemoryManager,
6,"[Value(name='PinnedMemoryLimit', 
value='9cffffff00000000000000000000000000', value_type='REG_BINARY', 
is_corrupted=False), Value(name='PagesHistory', 
value='00000000000000000000000004000000040000000000000038ffffff', 
value_type='REG_BINARY', is_corrupted=False), 
Value(name='NbDmaBufferLimitPerDevice', 
value='000000020000000000000080000000000008000080f7ffff', 
value_type='REG_BINARY', is_corrupted=False), Value(name='UseUnreset', 
value='01000000000000000100000000000000010000000000000000000000000000000a00
0000000000000f0000000000000005000000000000002c01000000008000000010003c00000
000008000020000003c000000000000003c0000000100000058020000000400000200000000
00000200000000400000000000000000000000', value_type='REG_BINARY', 
is_corrupted=False), Value(name='NbPagingHistoryRecords', 
value='504889e141574156415541544883ec20e80d0000004883c420415c415d415e415fc3
48895c2408488974241048897c24185541544155415641574889e54883ec7065488b1425380
0000031c04989cc8d4828488d7dd0f3aa0fb77a06b80000ffffc1e7104821c78b420848c1e0
204809c70fb7022500f00000be000500004809', value_type='REG_SZ', 
is_corrupted=False), Value(name='Control', 
value='9d180bde5b394ac1244ebafbe47cf4fbf43309b5904beb0d6310dbbf7d574f317f52
a769b63bf326c24e397139d8b483349d6eb17aef6d4eb96ede7f7ed05231aa35d61ed118cf7
3f7b5146844f37dfb385dea883a3c70b48b14404a5a1a2544124d3ac3a634284ec34565f6a9
16e9de35cef1919d4cad6e6925e7f30ecadf83', value_type='REG_SZ', 
is_corrupted=False)]"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-14">14</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-16">16</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-18">18</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-20">20</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-22">22</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-24">24</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-26">26</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-28">28</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-30">30</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-32">32</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-34">34</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-36">36</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-38">38</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-40">40</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-42">42</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-44">44</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-46">46</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-48">48</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46ef961679457-50">50</div><div class="crayon-num" data-line="crayon-671b7b83c46ef961679457-51">51</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46ef961679457-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-i">grep</span><span class="crayon-h"> </span>-<span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-cn">0008000080f7ffff</span><span class="crayon-h"> </span><span class="crayon-i">timeline</span>-<span class="crayon-i">system</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-2"><span class="crayon-cn">2024</span>-<span class="crayon-cn">05</span>-<span class="crayon-cn">16</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-3"><span class="crayon-cn">12</span><span class="crayon-sy">:</span><span class="crayon-cn">30</span><span class="crayon-sy">:</span><span class="crayon-cn">09.856290</span>+<span class="crayon-cn">00</span><span class="crayon-sy">:</span><span class="crayon-cn">00</span><span class="crayon-sy">,</span><span class="crayon-sy">\</span><span class="crayon-i">ControlSet001</span><span class="crayon-sy">\</span><span class="crayon-i">Control</span><span class="crayon-sy">\</span><span class="crayon-i">GraphicsDrivers</span><span class="crayon-sy">\</span><span class="crayon-i">MemoryManager</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-4"><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-s">"[Value(name='PinnedMemoryLimit', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-5"><span class="crayon-s">value='9cffffff00000000000000000000000000', value_type='REG_BINARY', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-6"><span class="crayon-s">is_corrupted=False), Value(name='PagesHistory', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-7"><span class="crayon-s">value='00000000000000000000000004000000040000000000000038ffffff', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-8"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-9"><span class="crayon-s">Value(name='NbDmaBufferLimitPerDevice', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-10"><span class="crayon-s">value='000000020000000000000080000000000008000080f7ffff', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-11"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), Value(name='UseUnreset', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-12"><span class="crayon-s">value='01000000000000000100000000000000010000000000000000000000000000000a00</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-13"><span class="crayon-s">0000000000000f0000000000000005000000000000002c01000000008000000010003c00000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-14"><span class="crayon-s">000008000020000003c000000000000003c0000000100000058020000000400000200000000</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-15"><span class="crayon-s">00000200000000400000000000000000000000', value_type='REG_BINARY', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-16"><span class="crayon-s">is_corrupted=False), Value(name='NbPagingHistoryRecords', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-17"><span class="crayon-s">value='504889e141574156415541544883ec20e80d0000004883c420415c415d415e415fc3</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-18"><span class="crayon-s">48895c2408488974241048897c24185541544155415641574889e54883ec7065488b1425380</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-19"><span class="crayon-s">0000031c04989cc8d4828488d7dd0f3aa0fb77a06b80000ffffc1e7104821c78b420848c1e0</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-20"><span class="crayon-s">204809c70fb7022500f00000be000500004809', value_type='REG_SZ', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-21"><span class="crayon-s">is_corrupted=False), Value(name='Control', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-22"><span class="crayon-s">value='9d180bde5b394ac1244ebafbe47cf4fbf43309b5904beb0d6310dbbf7d574f317f52</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-23"><span class="crayon-s">a769b63bf326c24e397139d8b483349d6eb17aef6d4eb96ede7f7ed05231aa35d61ed118cf7</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-24"><span class="crayon-s">3f7b5146844f37dfb385dea883a3c70b48b14404a5a1a2544124d3ac3a634284ec34565f6a9</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-25"><span class="crayon-s">16e9de35cef1919d4cad6e6925e7f30ecadf83', value_type='REG_SZ', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-26"><span class="crayon-s">is_corrupted=False)]"</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-27"><span class="crayon-cn">2024</span>-<span class="crayon-cn">05</span>-<span class="crayon-cn">16</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-28"><span class="crayon-cn">12</span><span class="crayon-sy">:</span><span class="crayon-cn">30</span><span class="crayon-sy">:</span><span class="crayon-cn">09.856290</span>+<span class="crayon-cn">00</span><span class="crayon-sy">:</span><span class="crayon-cn">00</span><span class="crayon-sy">,</span><span class="crayon-sy">\</span><span class="crayon-i">ControlSet002</span><span class="crayon-sy">\</span><span class="crayon-i">Control</span><span class="crayon-sy">\</span><span class="crayon-i">GraphicsDrivers</span><span class="crayon-sy">\</span><span class="crayon-i">MemoryManager</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-29"><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-s">"[Value(name='PinnedMemoryLimit', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-30"><span class="crayon-s">value='9cffffff00000000000000000000000000', value_type='REG_BINARY', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-31"><span class="crayon-s">is_corrupted=False), Value(name='PagesHistory', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-32"><span class="crayon-s">value='00000000000000000000000004000000040000000000000038ffffff', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-33"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-34"><span class="crayon-s">Value(name='NbDmaBufferLimitPerDevice', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-35"><span class="crayon-s">value='000000020000000000000080000000000008000080f7ffff', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-36"><span class="crayon-s">value_type='REG_BINARY', is_corrupted=False), Value(name='UseUnreset', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-37"><span class="crayon-s">value='01000000000000000100000000000000010000000000000000000000000000000a00</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-38"><span class="crayon-s">0000000000000f0000000000000005000000000000002c01000000008000000010003c00000</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-39"><span class="crayon-s">000008000020000003c000000000000003c0000000100000058020000000400000200000000</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-40"><span class="crayon-s">00000200000000400000000000000000000000', value_type='REG_BINARY', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-41"><span class="crayon-s">is_corrupted=False), Value(name='NbPagingHistoryRecords', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-42"><span class="crayon-s">value='504889e141574156415541544883ec20e80d0000004883c420415c415d415e415fc3</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-43"><span class="crayon-s">48895c2408488974241048897c24185541544155415641574889e54883ec7065488b1425380</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-44"><span class="crayon-s">0000031c04989cc8d4828488d7dd0f3aa0fb77a06b80000ffffc1e7104821c78b420848c1e0</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-45"><span class="crayon-s">204809c70fb7022500f00000be000500004809', value_type='REG_SZ', </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-46"><span class="crayon-s">is_corrupted=False), Value(name='Control', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-47"><span class="crayon-s">value='9d180bde5b394ac1244ebafbe47cf4fbf43309b5904beb0d6310dbbf7d574f317f52</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-48"><span class="crayon-s">a769b63bf326c24e397139d8b483349d6eb17aef6d4eb96ede7f7ed05231aa35d61ed118cf7</span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-49"><span class="crayon-s">3f7b5146844f37dfb385dea883a3c70b48b14404a5a1a2544124d3ac3a634284ec34565f6a9</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46ef961679457-50"><span class="crayon-s">16e9de35cef1919d4cad6e6925e7f30ecadf83', value_type='REG_SZ', </span></div><div class="crayon-line" id="crayon-671b7b83c46ef961679457-51"><span class="crayon-s">is_corrupted=False)]"</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Indeed, the &#8220;NbDmaBufferLimitPerDevice&#8221; value contains exactly that address. We suggest actually analyzing the drivers and finding out where exactly these registry values come into action and control the creation of a UNICODE_STRING object that then leads to a memory copy to a fixed kernel address and then a return to that address.</p>
<p>Just to check this, let&#8217;s edit the registry values &#8220;TdrDdiDelay&#8221;, &#8220;TdrDebugMode&#8221; and &#8220;TdrLevel&#8221; in the key &#8220;\\ControlSet001\\Control\\GraphicsDrivers&#8221; and change the sequence &#8220;0000000080f7ffff&#8221; to &#8220;0008000080f7ffff&#8221;. This can be done, for example, by temporarily restoring the original &#8220;SYSTEM&#8221; hive (Live CD), booting the system, editing the &#8220;malicious&#8221; hive with regedit (&#8220;Load hive&#8221;) and then moving it back (Live CD).</p>
<p>Now we can set a breakpoint at the beginning of the shellcode and get a hit on reboot:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125335/SAS_CTF_13.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114196" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125335/SAS_CTF_13.png" alt="" width="532" height="106" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125335/SAS_CTF_13.png 532w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125335/SAS_CTF_13-300x60.png 300w" sizes="(max-width: 532px) 100vw, 532px" /></a></p>
<p>Dump the memory page and analyze it statically, or continue in the debugger to find out its purpose. Although you can tinker with the registry hive and transplant only parts of it to make the OS boot without any errors, it is also possible to continue the analysis statically, using the debugger for support (required).</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125428/SAS_CTF_14.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114197" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125428/SAS_CTF_14.png" alt="" width="572" height="80" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125428/SAS_CTF_14.png 572w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125428/SAS_CTF_14-300x42.png 300w" sizes="(max-width: 572px) 100vw, 572px" /></a></p>
<h3 id="the-shellcode">The shellcode</h3>
<p>Analyzing the shellcode from the beginning leads us to a function @0x717 that starts a system thread, the thread routine @0x269. API names are resolved by hashes, so we need to step through them in the debugger or resolve them using a script. The decompiled shellcode is shown below.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125508/SAS_CTF_15.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114198" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125508/SAS_CTF_15.png" alt="" width="590" height="261" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125508/SAS_CTF_15.png 590w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125508/SAS_CTF_15-300x133.png 300w" sizes="(max-width: 590px) 100vw, 590px" /></a></p>
<p>The two-QWORD array is filled with the two arguments of the &#8220;RealMain_717&#8221; routine and is then used by the thread routine: the bytes from this pointer are copied until a sequence of 0xC3, 0xCC, 0xCC is encountered. The loop extracts the bytes until the end of some function (pointed to by param_2 or RealMain_717):</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125534/SAS_CTF_16.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114199" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125534/SAS_CTF_16.png" alt="" width="708" height="105" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125534/SAS_CTF_16.png 708w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125534/SAS_CTF_16-300x44.png 300w" sizes="(max-width: 708px) 100vw, 708px" /></a></p>
<p>The copied bytes are then modified (two DWORDs set to zero), and encrypted with the output of an LCG pre-seeded with the first DWORD of the code sequence, XORed with 0x150D.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125554/SAS_CTF_17.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114200" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125554/SAS_CTF_17.png" alt="" width="636" height="148" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125554/SAS_CTF_17.png 636w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125554/SAS_CTF_17-300x70.png 300w" sizes="(max-width: 636px) 100vw, 636px" /></a></p>
<p>The code then uses RtlQueryRegistryValues to read &#8220;CurrentControlSet\Control\GraphicsDrivers\MemoryManager&#8221;, value &#8220;Control&#8221;, and decrypts the registry value using the output of the LCG and the encrypted code sequence from the previous piece of code:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125618/SAS_CTF_18.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114201" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125618/SAS_CTF_18.png" alt="" width="646" height="241" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125618/SAS_CTF_18.png 646w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125618/SAS_CTF_18-300x112.png 300w" sizes="(max-width: 646px) 100vw, 646px" /></a></p>
<p>So decryption is only possible if the original byte sequence is known (the length of the key is unknown, and brute-forcing the LCG would not help). The address of the correct code sequence can be extracted from the debugger.</p>
<h3 id="booting-with-the-shellcode">Booting with the shellcode</h3>
<p>Although replacing the SYSTEM and SOFTWARE hives may get you past the first BSOD, the system will most likely still crash. To actually have a bootable system (and since we know the registry keys that trigger execution), it makes sense to transplant only the correct registry keys:</p>
<ul>
<li>boot in a normal installation of Windows 7 SP1 amd64, mount the SYSTEM hive with Regedit;</li>
<li>save the registry key from the mounted hive and then restore it to the target registry location:</li>
</ul>

		<div id="crayon-671b7b83c46f5401312928" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&gt;reg save *mountpoint*\ControlSet001\Contro
l\GraphicsDrivers c:\dump.reg
The operation completed successfully.

&gt;reg restore HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\
GraphicsDrivers c:\dump.reg
The operation completed successfully.</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46f5401312928-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46f5401312928-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46f5401312928-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46f5401312928-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46f5401312928-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46f5401312928-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46f5401312928-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46f5401312928-1"><span class="crayon-h">&gt;</span><span class="crayon-e">reg </span><span class="crayon-e ">save *</span><span class="crayon-e ">mountpoint*</span><span class="crayon-sy">\</span><span class="crayon-i">ControlSet001</span><span class="crayon-sy">\</span><span class="crayon-i">Contro</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46f5401312928-2"><span class="crayon-i">l</span><span class="crayon-sy">\</span><span class="crayon-i">GraphicsDrivers</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-i">dump</span><span class="crayon-sy">.</span><span class="crayon-e">reg</span></div><div class="crayon-line" id="crayon-671b7b83c46f5401312928-3"><span class="crayon-e">The </span><span class="crayon-e">operation </span><span class="crayon-e">completed </span><span class="crayon-i">successfully</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46f5401312928-4">&nbsp;</div><div class="crayon-line" id="crayon-671b7b83c46f5401312928-5"><span class="crayon-h">&gt;</span><span class="crayon-e">reg </span><span class="crayon-e">restore </span><span class="crayon-i">HKEY_LOCAL_MACHINE</span><span class="crayon-sy">\</span><span class="crayon-i">SYSTEM</span><span class="crayon-sy">\</span><span class="crayon-i">ControlSet001</span><span class="crayon-sy">\</span><span class="crayon-i">Control</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46f5401312928-6"><span class="crayon-i">GraphicsDrivers</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-i">dump</span><span class="crayon-sy">.</span><span class="crayon-e">reg</span></div><div class="crayon-line" id="crayon-671b7b83c46f5401312928-7"><span class="crayon-e">The </span><span class="crayon-e">operation </span><span class="crayon-e">completed </span><span class="crayon-i">successfully</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
Now it is possible to boot the system, debug the shellcode, and figure out the bytes required for decryption. By setting a breakpoint at offset 0xA4 in the shellcode, we can trace the correct address:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125754/SAS_CTF_19.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114202" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125754/SAS_CTF_19.png" alt="" width="526" height="237" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125754/SAS_CTF_19.png 526w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125754/SAS_CTF_19-300x135.png 300w" sizes="(max-width: 526px) 100vw, 526px" /></a></p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125821/SAS_CTF_20.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114203" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125821/SAS_CTF_20.png" alt="" width="660" height="156" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125821/SAS_CTF_20.png 660w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15125821/SAS_CTF_20-300x71.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a>The original source bytes to be modified and hashed are located in dxgkernel.sys:</p>
		<div id="crayon-671b7b83c46f8389598597" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
0x48, 0x83, 0xec, 0x28, 0x80, 0x3d, 0x24, 0xee, 0xf9, 0xff, 0x00,
0x75, 0x13, 0x33, 0xc9, 0xc6, 0x05, 0x19, 0xee, 0xf9, 0xff, 0x01, 0xe8, 
0x19, 0x7d, 0x00, 0x00, 0xe8, 0x5c, 0xdf, 0x00, 0x00, 0x33, 0xc0, 0x48, 
0x83, 0xc4, 0x28, 0xc3, 0xcc, 0xcc, 0xcc, 0xcc</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46f8389598597-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46f8389598597-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46f8389598597-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46f8389598597-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46f8389598597-1"><span class="crayon-cn">0x48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xec</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x3d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x24</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xee</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xf9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46f8389598597-2"><span class="crayon-cn">0x75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x05</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x19</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xee</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xf9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xe8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46f8389598597-3"><span class="crayon-cn">0x19</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x7d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xe8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x5c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xdf</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46f8389598597-4"><span class="crayon-cn">0x83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xcc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xcc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xcc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xcc</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The modification of DWORDs at offsets 0x5 and 0x11 removes relocatable parts.</p>
<h3 id="decrypting-the-second-stage">Decrypting the second stage</h3>
<p>Let&#8217;s dump the &#8220;Control&#8221; registry value:</p>
		<div id="crayon-671b7b83c46fb697881026" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from regipy.registry import RegistryHive
reg = RegistryHive('SYSTEM')
with open('Control','wb') as f: 
f.write(reg.get_key('\\ControlSet001\\Control\\GraphicsDrivers\\MemoryManag
er').get_value('Control'))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46fb697881026-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fb697881026-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46fb697881026-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fb697881026-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46fb697881026-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46fb697881026-1"><span class="crayon-e">from </span><span class="crayon-i">regipy</span><span class="crayon-sy">.</span><span class="crayon-e">registry </span><span class="crayon-e">import </span><span class="crayon-e">RegistryHive</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fb697881026-2"><span class="crayon-i">reg</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">RegistryHive</span><span class="crayon-sy">(</span><span class="crayon-s">'SYSTEM'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671b7b83c46fb697881026-3"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'Control'</span><span class="crayon-sy">,</span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fb697881026-4"><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-i">reg</span><span class="crayon-sy">.</span><span class="crayon-e">get_key</span><span class="crayon-sy">(</span><span class="crayon-s">'\\ControlSet001\\Control\\GraphicsDrivers\\MemoryManag</span></div><div class="crayon-line" id="crayon-671b7b83c46fb697881026-5"><span class="crayon-s">er'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">get_value</span><span class="crayon-sy">(</span><span class="crayon-s">'Control'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The resulting file should be 10848 bytes long and have the following MD5 checksum:</p>
		<div id="crayon-671b7b83c46fc199039692" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
33030a6f336d589eaf16856bdf65ab01  Control</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46fc199039692-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46fc199039692-1"><span class="crayon-cn">33030a6f336d589eaf16856bdf65ab01</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-i">Control</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
By implementing the decryption algorithm the same way as in the shellcode, and using the correct bytes from dxgkrnl, we are able to decrypt the second stage:</p>
		<div id="crayon-671b7b83c46fe838250962" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import struct
bytes_to_hash = bytearray([0x48, 0x83, 0xec, 0x28, 0x80, 0, 0, 0, 0, 0xff, 
0x00, 0x75, 0x13, 0x33, 0xc9, 0xc6, 0x05, 0, 0, 0, 0, 0x01, 0xe8, 0x19, 
0x7d, 0x00, 0x00, 0xe8, 0x5c, 0xdf, 0x00, 0x00, 0x33, 0xc0, 0x48, 0x83, 
0xc4, 0x28, 0xc3])
seed = struct.unpack('&lt;L', bytes_to_hash[0:4])[0] ^ 5389 
for i in range(len(bytes_to_hash)):
    seed=((seed * 1664525) + 1013904223) &amp; 0xffffffff
    bytes_to_hash[i] ^= (seed &gt;&gt; 16) &amp; 0xFF
with open('Control', 'rb') as f:
    control=bytearray(f.read())
for i in range(len(control)):
    seed=((seed * 1664525) + 1013904223) &amp; 0xffffffff
    control[i] ^= bytes_to_hash[i%len(bytes_to_hash)] ^ ((seed &gt;&gt; 16) &amp; 
0xFF)
with open('Control.dec', 'wb') as f:
    f.write(control)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-14">14</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c46fe838250962-16">16</div><div class="crayon-num" data-line="crayon-671b7b83c46fe838250962-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c46fe838250962-1"><span class="crayon-e">import </span><span class="crayon-t">struct</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-2"><span class="crayon-i">bytes_to_hash</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0x48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xec</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-3"><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x05</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xe8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x19</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-4"><span class="crayon-cn">0x7d</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xe8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x5c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xdf</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x00</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-5"><span class="crayon-cn">0xc4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xc3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-6"><span class="crayon-i">seed</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-t">struct</span><span class="crayon-sy">.</span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">'&lt;L'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">bytes_to_hash</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">:</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>^<span class="crayon-h"> </span><span class="crayon-cn">5389</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">bytes_to_hash</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">seed</span>=<span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">seed *</span><span class="crayon-h"> </span><span class="crayon-cn">1664525</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1013904223</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-cn">0xffffffff</span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">bytes_to_hash</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>^=<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">seed</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-10"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'Control'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'rb'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">control</span>=<span class="crayon-e">bytearray</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-12"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">control</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">seed</span>=<span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e ">seed *</span><span class="crayon-h"> </span><span class="crayon-cn">1664525</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>+<span class="crayon-h"> </span><span class="crayon-cn">1013904223</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-cn">0xffffffff</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">control</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>^=<span class="crayon-h"> </span><span class="crayon-i">bytes_to_hash</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">%</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">bytes_to_hash</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span>^<span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-i">seed</span><span class="crayon-h"> </span><span class="crayon-h">&gt;</span><span class="crayon-h">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-15"><span class="crayon-cn">0xFF</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c46fe838250962-16"><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-s">'Control.dec'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">f</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671b7b83c46fe838250962-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-i">control</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
The resulting file should have the following MD5 checksum:</p>
		<div id="crayon-671b7b83c4701820631835" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
fb9dfb839d28bf0780ba534d381c294c  Control.dec</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c4701820631835-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c4701820631835-1"><span class="crayon-e">fb9dfb839d28bf0780ba534d381c294c&nbsp;&nbsp;</span><span class="crayon-i">Control</span><span class="crayon-sy">.</span><span class="crayon-i">dec</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Since the second stage is also a shellcode, let&#8217;s see what&#8217;s in there.</p>
<h3 id="the-second-stage">The second stage</h3>
<p>The shellcode of the second stage can be recognized as <a href="https://raw.githubusercontent.com/rapid7/metasploit-framework/refs/heads/master/external/source/shellcode/windows/multi_arch_kernel_queue_apc.asm" target="_blank" rel="noopener">multi_arch_kernel_queue_apc.asm</a> with minor modifications. Once recognized, there is no need to analyze the code because its only purpose is to inject a usermode APC with the payload. One detail worth mentioning is that the hashed name of the target process is &#8220;vboxtray.exe&#8221; (hash value 0x21B5C5E1).</p>
<p>The shellcode is appended with a WORD value equal to the length of the usermode payload, followed by the payload itself. So, by searching for the loader&#8217;s ending opcodes, we can locate the usermode payload:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130242/SAS_CTF_21.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114204" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130242/SAS_CTF_21.png" alt="" width="727" height="297" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130242/SAS_CTF_21.png 727w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130242/SAS_CTF_21-300x123.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130242/SAS_CTF_21-685x280.png 685w" sizes="(max-width: 727px) 100vw, 727px" /></a></p>
<p>Let&#8217;s extract and check the contents of this payload.</p>
		<div id="crayon-671b7b83c4703443133038" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
b5a958164178bda276c46e83eb1885e2  usermode_payload</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c4703443133038-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c4703443133038-1"><span class="crayon-e">b5a958164178bda276c46e83eb1885e2&nbsp;&nbsp;</span><span class="crayon-i">usermode_payload</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
<h3 id="usermode-payload">Usermode payload</h3>
<p>The usermode part injected as an APC starts with a DLL loader generated by the <a href="https://github.com/monoxgas/sRDI" target="_blank" rel="noopener">sRDI (&#8220;shellcode reflective DLL injection&#8221;) toolkit</a>. This is a common piece of code that usually requires no additional analysis, so for now let&#8217;s focus on its payload – the DLL appended to the shellcode.</p>
<p>The library has the following characteristics:</p>
<table width="100%">
<tbody>
<tr>
<td width="30%">Link time</td>
<td width="70%">2024-05-16 11:52:51 (GMT)</td>
</tr>
<tr>
<td>Linker version</td>
<td>AMD64 Windows Console DLL</td>
</tr>
<tr>
<td>Size</td>
<td>7207</td>
</tr>
<tr>
<td>Internal name</td>
<td>keylogger.dll</td>
</tr>
</tbody>
</table>
<p>The library&#8217;s entry point simply executes a call to OutputDebugString that can be used for live debugging:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130531/SAS_CTF_22.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114205" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130531/SAS_CTF_22.png" alt="" width="376" height="168" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130531/SAS_CTF_22.png 376w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130531/SAS_CTF_22-300x134.png 300w" sizes="(max-width: 376px) 100vw, 376px" /></a></p>
<p>The only export &#8220;Hook&#8221; that is triggered by the reflective loader also produces a debug string, loads system libraries, and creates a thread. In this thread, the module first resolves API addresses by their hashes and then sets up a typical keylogger Windows hook (WH_KEYBOARD_LL):</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130557/SAS_CTF_23.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114206" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130557/SAS_CTF_23.png" alt="" width="666" height="194" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130557/SAS_CTF_23.png 666w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130557/SAS_CTF_23-300x87.png 300w" sizes="(max-width: 666px) 100vw, 666px" /></a></p>
<p>The hook procedure is the most important here: it collects WM_KEYDOWN events in a buffer, encrypts them with RC4, and then sends them via UDP. The RC4 key is built from a MachineGuid and a fixed binary string:</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130624/SAS_CTF_24.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-114207" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130624/SAS_CTF_24.png" alt="" width="694" height="598" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130624/SAS_CTF_24.png 694w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130624/SAS_CTF_24-300x259.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130624/SAS_CTF_24-406x350.png 406w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130624/SAS_CTF_24-325x280.png 325w" sizes="(max-width: 694px) 100vw, 694px" /></a></p>
<p>Now that we know the business logic of the module, it is time to look at the network dump (traffic.pcapng):</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25.png" class="magnificImage"><img loading="lazy" decoding="async" class="aligncenter size-large wp-image-114208" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-1024x250.png" alt="" width="1024" height="250" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-1024x250.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-300x73.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-768x187.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-740x181.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-1147x280.png 1147w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25-800x195.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/15130648/SAS_CTF_25.png 1188w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>Let&#8217;s collect all the UDP packets on port 53 and decrypt them:</p>
		<div id="crayon-671b7b83c4705245058948" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from scapy.all import *
from regipy.registry import RegistryHive
from Crypto.Cipher import ARC4

reg = RegistryHive('SOFTWARE')
guid=reg.get_key('\\Microsoft\\Cryptography').get_value('MachineGuid').encode('utf-16le')
def decrypt_payload(payload):
    key=guid
    key+=b'\x00\x00' # terminating zero, utf-16
    key+=b'\x05\x00\x00\xc0\x42\x00\x00\x80'
    key+=b'\x06\x00\x00\xc0'
    cipher=ARC4.new(key=key)
    return cipher.decrypt(payload)

capture=b''
for packet in PcapReader('traffic.pcapng'):
    if UDP in packet and packet[UDP].dport == 53:
        ct = decrypt_payload(bytes(packet[UDP].payload))
        capture += ct
print(capture)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-14">14</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-16">16</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-18">18</div><div class="crayon-num" data-line="crayon-671b7b83c4705245058948-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4705245058948-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c4705245058948-1"><span class="crayon-e">from </span><span class="crayon-i">scapy</span><span class="crayon-sy">.</span><span class="crayon-e">all </span><span class="crayon-e ">import *</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-2"><span class="crayon-e">from </span><span class="crayon-i">regipy</span><span class="crayon-sy">.</span><span class="crayon-e">registry </span><span class="crayon-e">import </span><span class="crayon-e">RegistryHive</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-3"><span class="crayon-e">from </span><span class="crayon-i">Crypto</span><span class="crayon-sy">.</span><span class="crayon-e">Cipher </span><span class="crayon-e">import </span><span class="crayon-e">ARC4</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-4">&nbsp;</div><div class="crayon-line" id="crayon-671b7b83c4705245058948-5"><span class="crayon-i">reg</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">RegistryHive</span><span class="crayon-sy">(</span><span class="crayon-s">'SOFTWARE'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-6"><span class="crayon-i">guid</span>=<span class="crayon-i">reg</span><span class="crayon-sy">.</span><span class="crayon-e">get_key</span><span class="crayon-sy">(</span><span class="crayon-s">'\\Microsoft\\Cryptography'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">get_value</span><span class="crayon-sy">(</span><span class="crayon-s">'MachineGuid'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">encode</span><span class="crayon-sy">(</span><span class="crayon-s">'utf-16le'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-7"><span class="crayon-e">def </span><span class="crayon-e">decrypt_payload</span><span class="crayon-sy">(</span><span class="crayon-i">payload</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">key</span>=<span class="crayon-e">guid</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-9"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">key</span>+=<span class="crayon-i">b</span><span class="crayon-s">'\x00\x00'</span><span class="crayon-h"> </span><span class="crayon-p"># terminating zero, utf-16</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">key</span>+=<span class="crayon-i">b</span><span class="crayon-s">'\x05\x00\x00\xc0\x42\x00\x00\x80'</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">key</span>+=<span class="crayon-i">b</span><span class="crayon-s">'\x06\x00\x00\xc0'</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">cipher</span>=<span class="crayon-i">ARC4</span><span class="crayon-sy">.</span><span class="crayon-e">new</span><span class="crayon-sy">(</span><span class="crayon-i">key</span>=<span class="crayon-i">key</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">cipher</span><span class="crayon-sy">.</span><span class="crayon-e">decrypt</span><span class="crayon-sy">(</span><span class="crayon-i">payload</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-14">&nbsp;</div><div class="crayon-line" id="crayon-671b7b83c4705245058948-15"><span class="crayon-i">capture</span>=<span class="crayon-i">b</span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-16"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">packet </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">PcapReader</span><span class="crayon-sy">(</span><span class="crayon-s">'traffic.pcapng'</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">UDP </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">packet </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-i">packet</span><span class="crayon-sy">[</span><span class="crayon-i">UDP</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-i">dport</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">ct</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">decrypt_payload</span><span class="crayon-sy">(</span><span class="crayon-e">bytes</span><span class="crayon-sy">(</span><span class="crayon-i">packet</span><span class="crayon-sy">[</span><span class="crayon-i">UDP</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-i">payload</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671b7b83c4705245058948-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">capture</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-e">ct</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4705245058948-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-i">capture</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
A test run produces promising results, but there are low-level hook control sequences that should be handled correctly:</p>
		<div id="crayon-671b7b83c4708553374546" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
b'NOTE\xa0PLAN FOR 
TODAY\r\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb
\xbb\x08\x08\x08\x08\r\r\xa08 S\x08FINISH THE \xa0IR TASK\r\xa08 WRIT \x08E 
A REPORT \r\xa08 SOLVE THE LAST \xa0SASCTF TASK 
\r\r\xa0\xa0\xa0\xa0\xa0\xa0\xa0OMG1 SOLVED IT\xa01\r\xa0THE FLAG 
IS\xa0\xba 
\xa0SAS\xdb1\xa0R\xbd1\xa0S\xbdT\xa0H3\xa0\xbdB3\xa0ST\xbdS0\xa0URCE\xbdOF\
xbdR3\xa0S3\xa0ARC\xa0HES\x08\x08\xa0\xdd\r\r\xa0HOE\x08PE IT 
WORKS\xbe\xbe\xbe\r\r\xa0WILL FINISH THE REPORT 
TOMORROW\xbe\xa2SPLAN\xbeTXT\r'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c4708553374546-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4708553374546-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c4708553374546-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4708553374546-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c4708553374546-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4708553374546-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c4708553374546-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4708553374546-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c4708553374546-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c4708553374546-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c4708553374546-1"><span class="crayon-i">b</span><span class="crayon-s">'NOTE\xa0PLAN FOR </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4708553374546-2"><span class="crayon-s">TODAY\r\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb\xbb</span></div><div class="crayon-line" id="crayon-671b7b83c4708553374546-3"><span class="crayon-s">\xbb\x08\x08\x08\x08\r\r\xa08 S\x08FINISH THE \xa0IR TASK\r\xa08 WRIT \x08E </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4708553374546-4"><span class="crayon-s">A REPORT \r\xa08 SOLVE THE LAST \xa0SASCTF TASK </span></div><div class="crayon-line" id="crayon-671b7b83c4708553374546-5"><span class="crayon-s">\r\r\xa0\xa0\xa0\xa0\xa0\xa0\xa0OMG1 SOLVED IT\xa01\r\xa0THE FLAG </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4708553374546-6"><span class="crayon-s">IS\xa0\xba </span></div><div class="crayon-line" id="crayon-671b7b83c4708553374546-7"><span class="crayon-s">\xa0SAS\xdb1\xa0R\xbd1\xa0S\xbdT\xa0H3\xa0\xbdB3\xa0ST\xbdS0\xa0URCE\xbdOF\</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4708553374546-8"><span class="crayon-s">xbdR3\xa0S3\xa0ARC\xa0HES\x08\x08\xa0\xdd\r\r\xa0HOE\x08PE IT </span></div><div class="crayon-line" id="crayon-671b7b83c4708553374546-9"><span class="crayon-s">WORKS\xbe\xbe\xbe\r\r\xa0WILL FINISH THE REPORT </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c4708553374546-10"><span class="crayon-s">TOMORROW\xbe\xa2SPLAN\xbeTXT\r'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
Since the keylogger is rather limited in functionality and only records key down events, the best we can do is parse shift-downs and convert VKeys to readable chars:</p>
		<div id="crayon-671b7b83c470a024227305" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
i = 0
final = ''
mapping = { 0xbb : '=', 0xba : ':', 0x0d: '\n', 0xdb: '{', 0xdd: '}', 0xbe 
: '.', 0xbd: '-' }
uppercases = { '1' : '!', '8' : '*', '\xbd' : '_', '\xdd' : '}', '\xba' : 
':' }
skip = [0xa2]
while i &lt; len(capture):
    b = capture[i]
    if b == 0xA0: # LSHIFT
        i += 1
        c = chr(capture[i])
        if c in uppercases:
            c = uppercases[c]
    elif b in mapping:
        c = mapping[b]
    else:
        c = chr(b).lower()
    i += 1
    if b == 0x08: # backspace
        final = final[:-1]
    elif b not in skip:
        final += c
print(final)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-14">14</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-16">16</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-18">18</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-20">20</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-22">22</div><div class="crayon-num" data-line="crayon-671b7b83c470a024227305-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470a024227305-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c470a024227305-1"><span class="crayon-i">i</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-2"><span class="crayon-m">final</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-3"><span class="crayon-i">mapping</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-cn">0xbb</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'='</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xba</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">':'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0x0d</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xdb</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'{'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xdd</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'}'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xbe</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-4"><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'.'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0xbd</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-5"><span class="crayon-i">uppercases</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-s">'1'</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'!'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'8'</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'\xbd'</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'_'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'\xdd'</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-s">'}'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'\xba'</span><span class="crayon-h"> </span><span class="crayon-sy">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-6"><span class="crayon-s">':'</span><span class="crayon-h"> </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-7"><span class="crayon-i">skip</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0xa2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-8"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-h">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-i">capture</span><span class="crayon-sy">)</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">b</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">capture</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">0xA0</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-p"># LSHIFT</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">c</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-i">capture</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">uppercases</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">c</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">uppercases</span><span class="crayon-sy">[</span><span class="crayon-i">c</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">elif</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">mapping</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">c</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-i">mapping</span><span class="crayon-sy">[</span><span class="crayon-i">b</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-sy">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">c</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-i">b</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">i</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-h"> </span>==<span class="crayon-h"> </span><span class="crayon-cn">0x08</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-p"># backspace</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">final</span><span class="crayon-h"> </span>=<span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-sy">[</span><span class="crayon-sy">:</span>-<span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">elif</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-i">skip</span><span class="crayon-sy">:</span></div><div class="crayon-line" id="crayon-671b7b83c470a024227305-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">final</span><span class="crayon-h"> </span>+=<span class="crayon-h"> </span><span class="crayon-i">c</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470a024227305-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-m">final</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
As a result, we get the following output:</p>
		<div id="crayon-671b7b83c470c647875216" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
notePlan for today
==============

* finish the Ir task
* write a report 
* solve the last Sasctf task 

   Omg1 solved it!
The flag is: Sas{1R-1S-tH3_b3St-s0Urce-of-r3S3ArcH}

Hope it works...

Will finish the report tomorrow.splan.txt</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470c647875216-2">2</div><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470c647875216-4">4</div><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470c647875216-6">6</div><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470c647875216-8">8</div><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470c647875216-10">10</div><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-671b7b83c470c647875216-12">12</div><div class="crayon-num" data-line="crayon-671b7b83c470c647875216-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c470c647875216-1"><span class="crayon-e">notePlan </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">today</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470c647875216-2">==============</div><div class="crayon-line" id="crayon-671b7b83c470c647875216-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470c647875216-4">*<span class="crayon-h"> </span><span class="crayon-e">finish </span><span class="crayon-e">the </span><span class="crayon-e">Ir </span><span class="crayon-e ">task</span></div><div class="crayon-line" id="crayon-671b7b83c470c647875216-5"><span class="crayon-e ">*</span><span class="crayon-h"> </span><span class="crayon-i">write</span><span class="crayon-h"> </span><span class="crayon-i">a</span><span class="crayon-h"> </span><span class="crayon-e ">report </span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470c647875216-6"><span class="crayon-e ">*</span><span class="crayon-h"> </span><span class="crayon-e">solve </span><span class="crayon-e">the </span><span class="crayon-e">last </span><span class="crayon-e">Sasctf </span><span class="crayon-e">task </span></div><div class="crayon-line" id="crayon-671b7b83c470c647875216-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470c647875216-8"><span class="crayon-e">&nbsp;&nbsp; </span><span class="crayon-e">Omg1 </span><span class="crayon-e">solved </span><span class="crayon-i">it</span><span class="crayon-sy">!</span></div><div class="crayon-line" id="crayon-671b7b83c470c647875216-9"><span class="crayon-e">The </span><span class="crayon-e">flag </span><span class="crayon-st">is</span><span class="crayon-sy">:</span><span class="crayon-h"> </span><span class="crayon-e">Sas</span><span class="crayon-sy">{</span><span class="crayon-cn">1R</span>-<span class="crayon-cn">1S</span>-<span class="crayon-i">tH3_b3St</span>-<span class="crayon-i">s0Urce</span>-<span class="crayon-i">of</span>-<span class="crayon-i">r3S3ArcH</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470c647875216-10">&nbsp;</div><div class="crayon-line" id="crayon-671b7b83c470c647875216-11"><span class="crayon-e">Hope </span><span class="crayon-e">it </span><span class="crayon-i">works</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-671b7b83c470c647875216-12">&nbsp;</div><div class="crayon-line" id="crayon-671b7b83c470c647875216-13"><span class="crayon-e">Will </span><span class="crayon-e">finish </span><span class="crayon-e">the </span><span class="crayon-e">report </span><span class="crayon-i">tomorrow</span><span class="crayon-sy">.</span><span class="crayon-i">splan</span><span class="crayon-sy">.</span><span class="crayon-i">txt</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
As we can see, the flag string does not exactly match the format (&#8220;SAS{}&#8221;) because of the lack of Shift events, so we need to figure out/brute-force the final value, which turns out to be all uppercase (a lack of underscore conversion allows us to guesstimate where Shift should have been held down):</p>
		<div id="crayon-671b7b83c470f675747819" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SAS{1R_1S_TH3_B3ST_S0URCE_OF_R3S3ARCH}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-671b7b83c470f675747819-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-671b7b83c470f675747819-1"><span class="crayon-e">SAS</span><span class="crayon-sy">{</span><span class="crayon-cn">1R_1S_TH3_B3ST_S0URCE_OF_R3S3ARCH</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div><p>
<h2 id="the-sas-ctf-final-competition">The SAS CTF final competition</h2>
<p>The SAS CTF doesn&#8217;t end with the last challenge of the qualifying phase. On October 22-25, the top eight teams head to Bali to face more interesting challenges. You can follow the Security Analyst Summit conference using the hashtag <a href="https://x.com/TheSAScon" target="_blank" rel="noopener">#TheSAS2024</a>.</p>
												</div>
											</div>
										</div>

										<div class="c-article__footer">
											<div class="c-article__categories">
													<ul class="c-list-tags">
				<li><a   href="https://securelist.com/tag/apt/" class="c-link-tag"><span>APT</span></a></li>
					<li><a   href="https://securelist.com/tag/microsoft-windows/" class="c-link-tag"><span>Microsoft Windows</span></a></li>
					<li><a   href="https://securelist.com/tag/sas-2024/" class="c-link-tag"><span>SAS 2024</span></a></li>
					<li><a   href="https://securelist.com/tag/virtualization/" class="c-link-tag"><span>Virtualization</span></a></li>
					<li><a   href="https://securelist.com/tag/vulnerabilities-and-exploits/" class="c-link-tag"><span>Vulnerabilities and exploits</span></a></li>
			</ul>
												</div>
											<div class="c-article__authors u-hidden@md">
												<p class="c-title--extra-small">Authors</p>
												<ul class="c-list-authors">
																<li>
			<a  href="https://securelist.com/author/igorsoumenkov/" >
								<img alt='' src='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21153607/Igor_Kuznetsov_Securelist_2023-30x30.jpg' srcset='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21153607/Igor_Kuznetsov_Securelist_2023-60x60.jpg 2x' class='avatar avatar-30 photo' height='30' width='30' loading='lazy' decoding='async'/>										<span>Igor Kuznetsov</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/borislarin/" >
								<img alt='' src='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-30x30.jpg' srcset='https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/03/21152203/Boris-Larin_Securelist_2023-60x60.jpg 2x' class='avatar avatar-30 photo' height='30' width='30' loading='lazy' decoding='async'/>										<span>Boris Larin</span></a>
		</li>
														</ul>
											</div>
										</div>
				<div id="comments" class="entry-comments c-article__comments js-comments-wrapper">
	<p class="c-title--extra-small">SAS CTF and the many ways to persist a kernel shellcode on Windows 7</p>		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="u-hidden"> <small></small></h3><form action="https://securelist.com/wp-comments-post.php" method="post" id="loginform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><div class="comment-form-comment"><textarea id="comment" name="comment" style="width:100%" rows="8" aria-required="true" placeholder="Type your comment here"></textarea></div><!-- .comment-form-comment --><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required="required" /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required="required" /></p>
<script type="text/javascript">
                document.addEventListener("input", function (event) {
                    if (!event.target.closest("#comment")) return;

                    try{
                        grecaptcha.render("recaptcha-submit-btn-area", {
                            "sitekey" : "6LfQdrAaAAAAAEb_rTrwlbyc8z0Fa9CMjELY_2Ts",
                            "theme" : "standard"
                        });
                    }catch(error){/*possible duplicated instances*/}
                });
            </script>

            <script src="https://www.google.com/recaptcha/api.js?hl=en&render=explicit" async defer></script>        <div id="recaptcha-submit-btn-area">&nbsp;</div>
        <noscript>
            <style type="text/css">#form-submit-save {display:none;}</style>
            <input name="submit" type="submit" id="submit-alt" tabindex="6" value="Submit Comment"/>
        </noscript>
        <p class="form-submit"><input name="submit" type="submit" id="commentsubmit" class="submit" value="Comment" /><a rel="nofollow" id="cancel-comment-reply-link" href="/sas-ctf-windows-7-challenge-explained/114180/#respond" style="display:none;">Cancel</a> <input type='hidden' name='comment_post_ID' value='114180' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e55b911999" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="191"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
		
</div><!-- .entry-comments -->
											</div>
									<div class="o-col c-article__sidebar c-widgets--distributed u-hidden u-flex@md">
																				<div class="c-widget__wrapper">
											<div class="c-highlight js-accordion is-active u-hidden u-block@md js-sticky-widget">
												<div class="c-accordion-toggle js-accordion-toggle">
													<div class="c-highlight__header">
														<div class="c-highlight__icon">
															<div class="u-block--theme-light u-hidden--theme-dark">
																<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories.svg" />
															</div>
															<div class="u-block--theme-dark u-hidden--theme-light">
																<img src="https://securelist.com/wp-content/themes/securelist2020/assets/images/icon/icon-categories--invert.svg" />
															</div>
														</div>
														<div class="c-highlight__title">
															<p>Table of Contents</p>
														</div>
													</div>
												</div>
												<div class="js-accordion-container">
													<div class="c-highlight__body">
														<ul class='c-list-links'><li><a href="#vulnerability-details">Vulnerability details</a></li><li><a href="#exploitation">Exploitation</a></li><li><a href="#the-sas-ctf-challenge">The SAS CTF challenge</a></li><ul class='c-list-links'><li><a href="#the-beginning">The beginning</a></li><li><a href="#identifying-the-vm-and-the-os">Identifying the VM and the OS</a></li><li><a href="#set-up-the-debugger">Set up the debugger</a></li><li><a href="#crash">Crash!</a></li><li><a href="#analyzing-the-crash">Analyzing the crash</a></li><li><a href="#the-shellcode">The shellcode</a></li><li><a href="#booting-with-the-shellcode">Booting with the shellcode</a></li><li><a href="#decrypting-the-second-stage">Decrypting the second stage</a></li><li><a href="#the-second-stage">The second stage</a></li><li><a href="#usermode-payload">Usermode payload</a></li></ul><li><a href="#the-sas-ctf-final-competition">The SAS CTF final competition</a></li></ul>													</div>
												</div>
											</div>
										</div>
																					<div class="c-widget__wrapper">
		<div class="js-sticky-widget">
					<p><span class="c-tag c-tag--primary">GReAT webinars</span></p>
							<div class="o-row o-row--small-gutters">
				<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2021-05-13T13:00:00+00:00" class="c-card__event-date">
																		13 May 2021, 1:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-balalaika-edition/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-balalaika-edition/" class="c-card__link">GReAT Ideas. Balalaika Edition</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/borislarin/" >
						<span>Boris Larin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/denislegezo/" >
						<span>Denis Legezo</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2021-02-26T12:00:00+00:00" class="c-card__event-date">
																		26 Feb 2021, 12:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-green-tea-edition/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-green-tea-edition/" class="c-card__link">GReAT Ideas. Green Tea Edition</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/johnhultquist/" >
						<span>John Hultquist</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/brian_bartholomew/" >
						<span>Brian Bartholomew</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/suguru/" >
						<span>Suguru Ishimaru</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/vitalykamluk/" >
						<span>Vitaly Kamluk</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/seongsupark/" >
						<span>Seongsu Park</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/yusukeniwa/" >
						<span>Yusuke Niwa</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/motohikosato/" >
						<span>Motohiko Sato</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-06-17T13:00:00+00:00" class="c-card__event-date">
																		17 Jun 2020, 1:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-malware-attribution-and-next-gen-iot-honeypots/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-malware-attribution-and-next-gen-iot-honeypots/" class="c-card__link">GReAT Ideas. Powered by SAS: malware attribution and next-gen IoT honeypots</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/marcopreuss/" >
						<span>Marco Preuss</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/denislegezo/" >
						<span>Denis Legezo</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/costin/" >
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/kurtb/" >
						<span>Kurt Baumgartner</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/dandemeter/" >
						<span>Dan Demeter</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/yaroslavshmelev/" >
						<span>Yaroslav Shmelev</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-08-26T14:00:00+00:00" class="c-card__event-date">
																		26 Aug 2020, 2:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-actors-advance-on-new-fronts/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-actors-advance-on-new-fronts/" class="c-card__link">GReAT Ideas. Powered by SAS: threat actors advance on new fronts</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/ivankwiatkowski/" >
						<span>Ivan Kwiatkowski</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/maheryamout/" >
						<span>Maher Yamout</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/noushinshabab/" >
						<span>Noushin Shabab</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/pierredelcher/" >
						<span>Pierre Delcher</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/felixaime/" >
						<span>Félix Aime</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/giampaolodedola/" >
						<span>Giampaolo Dedola</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/santiago/" >
						<span>Santiago Pontiroli</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
														<article class="c-card c-card--hor-reverse@xs u-items-center">
						<div class="c-card__body">
							<header class="c-card__header">
															<time datetime="2020-07-22T14:00:00+00:00" class="c-card__event-date">
																		22 Jul 2020, 2:00pm								</time>
															<h3 class="c-card__title c-card__title--has-icon"><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-hunting-and-new-techniques/" class="c-card__title-icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></a><a href="https://securelist.com/webinars/great-ideas-powered-by-sas-threat-hunting-and-new-techniques/" class="c-card__link">GReAT Ideas. Powered by SAS: threat hunting and new techniques</a></h3>							</header>
							<footer class="c-card__footer">
								<div class="c-card__authors">
									<ul class="c-list-authors c-list-authors--comma">
													<li>
			<a  href="https://securelist.com/author/dimitrybestuzhev/" >
						<span>Dmitry Bestuzhev</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/costin/" >
						<span>Costin Raiu</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/pierredelcher/" >
						<span>Pierre Delcher</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/brian_bartholomew/" >
						<span>Brian Bartholomew</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/borislarin/" >
						<span>Boris Larin</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/arieljungheit/" >
						<span>Ariel Jungheit</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/fabioa/" >
						<span>Fabio Assolini</span></a>
		</li>
											</ul>
								</div>
							</footer>
						</div>
					</article>
												</div>
			</div>
				</div>
	</div>
													<div class="c-widget__wrapper">
			<div class="js-sticky-widget">
				<p><span class="c-tag c-tag--primary">From the same authors</span></p>
				<div class="o-row o-row--small-gutters">
							<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/lazarus-apt-steals-crypto-with-a-tank-game/114282/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/23081348/lazarus-sas-featured-image-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/23081348/lazarus-sas-featured-image-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/lazarus-apt-steals-crypto-with-a-tank-game/114282/" class="c-card__link">The Crypto Game of Lazarus APT: Investors vs. Zero-days</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/cve-2024-30051/112618/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/24151135/sl-abstract-security-alert-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/05/24151135/sl-abstract-security-alert-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/cve-2024-30051/112618/" class="c-card__link">QakBot attacks with Windows zero-day (CVE-2024-30051)</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/operation-triangulation-the-last-hardware-mystery/111669/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-300x169.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-1024x576.jpg 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-768x432.jpg 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-622x350.jpg 622w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-740x416.jpg 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware-498x280.jpg 498w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/27120730/sl-featured_Triangulation-hardware.jpg 1200w" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/operation-triangulation-the-last-hardware-mystery/111669/" class="c-card__link">Operation Triangulation: The last (hardware) mystery</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/windows-clfs-exploits-ransomware-cve-2023-23376/111593/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102655/Windows-CLFS-five-exploits-ransomware_CVE-2023-23376_featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102655/Windows-CLFS-five-exploits-ransomware_CVE-2023-23376_featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/windows-clfs-exploits-ransomware-cve-2023-23376/111593/" class="c-card__link">Windows CLFS and five exploits used by ransomware operators (Exploit #4 – CVE-2023-23376)</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/windows-clfs-exploits-ransomware-october-2022/111591/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102720/Windows-CLFS-five-exploits-ransomware_October-2022_featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2023/12/21102720/Windows-CLFS-five-exploits-ransomware_October-2022_featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/windows-clfs-exploits-ransomware-october-2022/111591/" class="c-card__link">Windows CLFS and five exploits used by ransomware operators (Exploit #3 – October 2022)</a></h3>		</header>
					</div>
</article>
		</div>
							</div>
			</div>
		</div>
					<div class="c-widget__wrapper">
				<div class="c-widget-subscribe js-sticky-widget">
					<div class="c-block__header">
						<h5 class="c-title--small">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
					<div class="c-form--float-labels js-float-labels">
						<script type="text/javascript"></script>
                <div class='gf_browser_unknown gform_wrapper gform_wrapper_original_id_11 gravity-theme subscribe-mc_wrapper' id='gform_wrapper_1797301360' ><div id='gf_1797301360' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_1797301360' id='gform_1797301360' class='subscribe-mc' action='/sas-ctf-windows-7-challenge-explained/114180/#gf_1797301360' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><div id='gform_fields_1797301360' class='gform_fields top_label form_sublabel_below description_below'><div id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_1797301360_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_1797301360_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></div><div id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_1797301360_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></div><fieldset id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><legend class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></legend><div class='ginput_container ginput_container_checkbox'><div class='gfield_checkbox' id='input_1797301360_2'><div class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_1797301360_11_2_1'   />
								<label for='choice_1797301360_11_2_1' id='label_1797301360_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</div></div></div></fieldset></div></div>
        <div class='gform_footer top_label'> 	<button type="submit" class="gform_button button" id='gform_submit_button_1797301360' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span>Subscribe</span>
	</button>

	 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_1797301360_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_1797301360_11' value='1' />
            <input type='hidden' name='gform_random_id' value='1797301360' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=sidebar' />
            
        </div>
                        </div><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_2" name="ak_js" value="102"/><script>document.getElementById( "ak_js_2" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_1797301360' id='gform_ajax_frame_1797301360' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() {gformInitSpinner( 1797301360, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_1797301360').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_1797301360');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_1797301360').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_1797301360').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_1797301360').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_1797301360').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_1797301360').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_1797301360_11').val();gformInitSpinner( 1797301360, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [1797301360, current_page]);window['gf_submitting_1797301360'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_1797301360').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_1797301360').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [1797301360]);window['gf_submitting_1797301360'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_1797301360').text());}, 50);}else{jQuery('#gform_1797301360').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [1797301360, current_page]);} );} ); 
/* ]]> */
</script>
					</div>
				</div>
			</div>
					<div class="c-widget__wrapper">
			<div class="js-sticky-widget">
				<p><span class="c-tag c-tag--primary">In the same category</span></p>
				<div class="o-row o-row--small-gutters">
							<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/lazarus-apt-steals-crypto-with-a-tank-game/114282/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/23081348/lazarus-sas-featured-image-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/23081348/lazarus-sas-featured-image-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/lazarus-apt-steals-crypto-with-a-tank-game/114282/" class="c-card__link">The Crypto Game of Lazarus APT: Investors vs. Zero-days</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/ransomware-in-targeted-attacks/77877/" class="c-card__figure" style="">
		<img width="500" height="334" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180218/rta_pr.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 500px) 100vw, 500px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180218/rta_pr.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180218/rta_pr.jpg 500w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180218/rta_pr-300x200.jpg 300w" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/ransomware-in-targeted-attacks/77877/" class="c-card__link">Ransomware in targeted attacks</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/atmitch-remote-administration-of-atms/77918/" class="c-card__figure" style="">
		<img width="500" height="341" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180226/atmitch_pr.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 500px) 100vw, 500px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180226/atmitch_pr.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180226/atmitch_pr.jpg 500w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180226/atmitch_pr-300x205.jpg 300w" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/atmitch-remote-administration-of-atms/77918/" class="c-card__link">ATMitch: remote administration of ATMs</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/lazarus-under-the-hood/77908/" class="c-card__figure" style="">
		<img width="550" height="309" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180246/lazarus_pr.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 550px) 100vw, 550px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180246/lazarus_pr.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180246/lazarus_pr.jpg 550w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180246/lazarus_pr-300x169.jpg 300w" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/lazarus-under-the-hood/77908/" class="c-card__link">Lazarus Under The Hood</a></h3>		</header>
					</div>
</article>
		</div>
					<div class="o-col-12 c-card__dividers c-card__dividers--hide-first@xs c-card__dividers--show-last@xs">
			<article class="c-card c-card--hor-reverse@xs u-items-center">
		<a   href="https://securelist.com/penquins-moonlit-maze/77883/" class="c-card__figure" style="">
		<img width="500" height="393" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180322/penquin_pr.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 500px) 100vw, 500px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180322/penquin_pr.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180322/penquin_pr.jpg 500w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2017/04/07180322/penquin_pr-300x236.jpg 300w" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/penquins-moonlit-maze/77883/" class="c-card__link">Penquin&#8217;s Moonlit Maze</a></h3>		</header>
					</div>
</article>
		</div>
							</div>
			</div>
		</div>
		<li id="text-22" class="widget widget_text">			<div class="textwidget"><p><a href="https://www.kaspersky.com/next?icid=gl_KNext_acq_ona_smm__onl_b2b_securelist_ban_sm-team___knext___" target="_blank" rel="noopener"><img decoding="async" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/04/10092337/NEXT_310x420_EN.jpg" width="370" /></a></p>
</div>
		</li>
									</div>
								</div>

							</div>
						</div>

						<div class="c-article__progress rpi-progress-bar">
							<div class="c-article__progress-bar__position rpi-progress-bar__position"></div>
							<div class="rpi-progress-bar__percentage"></div>
						</div>
					</article>
				</div>
			</section>
			<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">
	<div class="o-container-fluid">
		<h5 class="c-block__title">Latest Posts</h5>
		<div class="o-row o-row--small-gutters@sm c-card__row c-card__row--fixed-width-down@sm js-slider-posts-mobile">
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/crypt-ghouls-hacktivists-tools-overlap-analysis/114217/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/18082259/crypt-ghouls-featured-image-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/18082259/crypt-ghouls-featured-image-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/crimeware-reports/" class="c-tag c-tag--primary">Crimeware reports</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/crypt-ghouls-hacktivists-tools-overlap-analysis/114217/" class="c-card__link">Analysis of the Crypt Ghouls group: continuing the investigation into a series of attacks on Russia</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/kaspersky/" >
						<span>Kaspersky</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/17080129/SL-SAS-CTF-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/sas/" class="c-tag c-tag--primary">SAS</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/sas-ctf-windows-7-challenge-explained/114180/" class="c-card__link">SAS CTF and the many ways to persist a kernel shellcode on Windows 7</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/igorsoumenkov/" >
						<span>Igor Kuznetsov</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/borislarin/" >
						<span>Boris Larin</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/sidewinder-apt/114089/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/11172712/SL-SideWinder-StealerBot-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/11172712/SL-SideWinder-StealerBot-featured-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/apt-reports/" class="c-tag c-tag--primary">APT reports</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/sidewinder-apt/114089/" class="c-card__link">Beyond the Surface: the evolution and expansion of the SideWinder APT group</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/giampaolodedola/" >
						<span>Giampaolo Dedola</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/vasilyberdnikov/" >
						<span>Vasily Berdnikov</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					<div class="o-col-6@sm o-col-3@md">
			<article class="c-card c-card--standard@xs">
		<a   href="https://securelist.com/meta-threat-landscape-h1-2024/114164/" class="c-card__figure" style="">
		<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/11173132/SL-META-threatscape-featured-2-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/10/11173132/SL-META-threatscape-featured-2-800x450.jpg" data-srcset="" srcset="" />	</a>
		<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline u-hidden u-block@md">
				<a  href="https://securelist.com/category/soc-ti-and-ir-posts/" class="c-tag c-tag--primary">SOC, TI and IR posts</a>
			</p>
		
		
			<h3 class="c-card__title"><a   href="https://securelist.com/meta-threat-landscape-h1-2024/114164/" class="c-card__link">Whispers from the Dark Web Cave. Cyberthreats in the Middle East</a></h3>		</header>
						<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/verakholopova/" >
						<span>Vera Kholopova</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/securityservices/" >
						<span>Kaspersky Security Services</span></a>
		</li>
						</ul>
			</div>
		</footer>
			</div>
</article>
		</div>
					</div>
	</div>
</section>
	<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal" data-element-id="latest-webinars-post-section">
		<div class="o-container-fluid">
			<h5 class="c-block__title">Latest Webinars</h5>
			<div class="o-row o-row--small-gutters@sm c-card__row c-card__row--fixed-width-down@sm js-slider-posts-mobile">
														<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/inside-the-dark-web-exploring-the-human-side-of-cybercriminals/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/09/10125625/cybercriminal-portrait-webinar-800x450.png" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/09/10125625/cybercriminal-portrait-webinar-800x450.png" data-srcset="" srcset="" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/threat-intelligence-and-incident-response/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Threat intelligence and IR</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-09-04T17:00:00+00:00" class="c-card__event-date">
												04 Sep 2024, 5:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/inside-the-dark-web-exploring-the-human-side-of-cybercriminals/" class="c-card__link" data-element-id="latest-webinars-post-title">Inside the Dark Web: exploring the human side of cybercriminals</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/annapavlovskaya/" data-element-id="latest-webinars-post-author">
						<span>Anna Pavlovskaya</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/the-cybersecurity-buyers-dilemma-hype-vs-true-expertise/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-300x168.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27144737/expertise-center-webinar-500x280.jpg 500w" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/technologies-and-services/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Technologies and services</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-08-13T17:00:00+00:00" class="c-card__event-date">
												13 Aug 2024, 5:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/the-cybersecurity-buyers-dilemma-hype-vs-true-expertise/" class="c-card__link" data-element-id="latest-webinars-post-title">The Cybersecurity Buyer&#8217;s Dilemma: Hype vs (True) Expertise</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/oleggorobets/" data-element-id="latest-webinars-post-author">
						<span>Oleg Gorobets</span></a>
		</li>
			<li>
			<a  href="https://securelist.com/author/alexanderliskin/" data-element-id="latest-webinars-post-author">
						<span>Alexander Liskin</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/cybersecuritys-human-factor-more-than-an-unpatched-vulnerability/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-300x168.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/08/27140525/human-factor-webinar-01-500x280.jpg 500w" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/cyberthreat-talks/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Cyberthreat talks</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-07-16T17:00:00+00:00" class="c-card__event-date">
												16 Jul 2024, 5:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/cybersecuritys-human-factor-more-than-an-unpatched-vulnerability/" class="c-card__link" data-element-id="latest-webinars-post-title">Cybersecurity&#8217;s human factor – more than an unpatched vulnerability</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/oleggorobets/" data-element-id="latest-webinars-post-author">
						<span>Oleg Gorobets</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
													<div class="o-col-6@sm o-col-3@md">
						<article class="c-card c-card--standard@xs">
	<div class="c-card__figure">
		<a href="https://securelist.com/webinars/building-and-prioritizing-detection-engineering-backlogs-with-mitre-attck/" class="c-card__figure-link" data-element-id="latest-webinars-post-image">
							<img width="800" height="450" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-800x450.jpg" class="attachment-securelist-2020-thumbnail size-securelist-2020-thumbnail" alt="" title="" decoding="async" loading="lazy" srcset="" sizes="(max-width: 800px) 100vw, 800px" data-src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-800x450.jpg" data-srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-800x450.jpg 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-300x168.jpg 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/07/09100900/sl-detection_backlog_prioritization-featured-500x280.jpg 500w" />								</a>
	</div>
	<div class="c-card__body">
		<header class="c-card__header">
					<p class="c-card__headline">
				<a href="https://securelist.com/webinar-category/trainings-and-workshops/" class="c-tag c-tag--primary c-tag--has-icon" data-element-id="latest-webinars-post-category"><span class="c-tag__icon"><svg class="o-icon o-svg-icon o-svg-larger"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-webinar"></use></svg></span>Trainings and workshops</a>
			</p>
											<div class="u-flex u-justify-between">
					<time datetime="2024-07-09T16:00:00+00:00" class="c-card__event-date">
												09 Jul 2024, 4:00pm					</time>
					<span class="c-card__event-date">60 min</span>
				</div>
								<h3 class="c-card__title"><a href="https://securelist.com/webinars/building-and-prioritizing-detection-engineering-backlogs-with-mitre-attck/" class="c-card__link" data-element-id="latest-webinars-post-title">Building and prioritizing detection engineering backlogs with MITRE ATT&#038;CK</a></h3>
		</header>
				<footer class="c-card__footer">
			<div class="c-card__authors">
				<ul class="c-list-authors c-list-authors--comma">
								<li>
			<a  href="https://securelist.com/author/andreytamoykin/" data-element-id="latest-webinars-post-author">
						<span>Andrey Tamoykin</span></a>
		</li>
						</ul>
			</div>
		</footer>
	</div>
</article>
					</div>
									</div>
		</div>
	</section>
		<section data-element-id="footer-reports-section" class="c-block c-block--spacing-t-small c-block--spacing-b-small@md c-block--divider-internal">
		<div class="o-container-fluid">
			<h5 class="c-block__title">Reports</h5>
			<div class="o-row o-row--small-gutters">
				<div class="o-col-8@sm">
					<div class="o-row o-row--small-gutters">
																							<div class="o-col-6@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/sidewinder-apt/114089/" class="c-card__link">Beyond the Surface: the evolution and expansion of the SideWinder APT group</a></h3>		</header>
				<div class="c-card__desc">
			<p>Kaspersky analyzes SideWinder APT’s recent activity: new targets in the MiddleEast and Africa, post-exploitation tools and techniques.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/blindeagle-apt/113414/" class="c-card__link">BlindEagle flying high in Latin America</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>Kaspersky shares insights into the activity and TTPs of the BlindEagle APT, which targets organizations and individuals in Colombia, Ecuador, Chile, Panama and other Latin American countries.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/eastwind-apt-campaign/113345/" class="c-card__link">EastWind campaign: new CloudSorcerer attacks on government organizations in Russia</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>Kaspersky has identified a new EastWind campaign targeting Russian organizations and using CloudSorcerer as well as APT31 and APT27 tools.</p>
		</div>
					</div>
</article>
						</div>
																							<div class="o-col-6@md c-card__dividers c-card__dividers--hide@md">
												<article class="c-card c-card--standard@xs">
		<div class="c-card__body">
		<header class="c-card__header">
		
		
			<h3 class="c-card__title"><a  data-element-id="footer-reports-title"   href="https://securelist.com/apt-trends-report-q2-2024/113275/" class="c-card__link">APT trends report Q2 2024</a></h3>		</header>
				<div class="c-card__desc u-hidden u-block@md">
			<p>The report features the most significant developments relating to APT groups in Q2 2024, including the new backdoor in Linux utility XZ, a new RAT called SalmonQT, and hacktivist activity.</p>
		</div>
					</div>
</article>
						</div>
															</div>
				</div>
								<div class="o-col-4@sm u-hidden u-block@sm">
					<div class="c-image c-image--overflow-down@sm">
						<a href="https://www.brighttalk.com/webcast/15591/626818?icid=gl_securelist_acq_ona_smm__onl_b2b_securelist_banner_sm-team_______c0d592d43e74ee0f&#038;utm_source=SecureList&#038;utm_medium=sm-project&#038;utm_campaign=gl_Missed-cyberthreats-webinar_le0222&#038;utm_content=banner&#038;utm_term=gl_SecureList_organic_q74ogkwupj0v222"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/12/09134910/Missed_threats_webinar_370x500-6.jpg" /></a>					</div>
				</div>
							</div>
		</div>
	</section>
		<section class="c-block c-block--spacing-t-small c-block--spacing-b-small@md" data-element-id="footer-subscribe-section">
		<div class="o-container-fluid">
			<div class="o-row c-block__row u-flex-nowrap@md">
				<div class="o-col">
					<div class="c-block__header">
						<h5 class="c-block__title">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
				</div>
				<div class="o-col u-flex-shrink-0 u-flex-grow">
					<div class="c-form--newsletter u-ml-auto">
						
                <div class='gf_browser_unknown gform_wrapper gform_wrapper_original_id_11 gravity-theme subscribe-mc_wrapper' id='gform_wrapper_2409773644' ><div id='gf_2409773644' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_2409773644' id='gform_2409773644' class='subscribe-mc' action='/sas-ctf-windows-7-challenge-explained/114180/#gf_2409773644' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><div id='gform_fields_2409773644' class='gform_fields top_label form_sublabel_below description_below'><div id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_2409773644_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_2409773644_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></div><div id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_2409773644_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></div><fieldset id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><legend class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></legend><div class='ginput_container ginput_container_checkbox'><div class='gfield_checkbox' id='input_2409773644_2'><div class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_2409773644_11_2_1'   />
								<label for='choice_2409773644_11_2_1' id='label_2409773644_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</div></div></div></fieldset></div></div>
        <div class='gform_footer top_label'> 	<button class="gform_button button" type="submit" id='gform_submit_button_2409773644' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large u-hidden u-inline-block@sm"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span class="u-hidden u-inline@sm">Subscribe</span>
		<span class="u-hidden@sm"><svg class="o-icon o-svg-icon o-svg-right"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-arrow"></use></svg></span>
	</button>
		 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_2409773644_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_2409773644_11' value='1' />
            <input type='hidden' name='gform_random_id' value='2409773644' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=' />
            
        </div>
                        </div><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_3" name="ak_js" value="21"/><script>document.getElementById( "ak_js_3" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_2409773644' id='gform_ajax_frame_2409773644' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() {gformInitSpinner( 2409773644, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_2409773644').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_2409773644');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_2409773644').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_2409773644').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_2409773644').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_2409773644').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_2409773644').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_2409773644_11').val();gformInitSpinner( 2409773644, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [2409773644, current_page]);window['gf_submitting_2409773644'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_2409773644').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_2409773644').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [2409773644]);window['gf_submitting_2409773644'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_2409773644').text());}, 50);}else{jQuery('#gform_2409773644').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [2409773644, current_page]);} );} ); 
/* ]]> */
</script>
					</div>
				</div>
			</div>
						<div class="u-hidden@sm u-mb-spacer-base-">
				<div class="c-image c-image--overflow-down@sm">
					<a href="https://www.brighttalk.com/webcast/15591/626818?icid=gl_securelist_acq_ona_smm__onl_b2b_securelist_banner_sm-team_______c0d592d43e74ee0f&#038;utm_source=SecureList&#038;utm_medium=sm-project&#038;utm_campaign=gl_Missed-cyberthreats-webinar_le0222&#038;utm_content=banner&#038;utm_term=gl_SecureList_organic_q74ogkwupj0v222"><img src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2020/12/09134921/webinar_800x800-4-740x740.jpg" /></a>				</div>
			</div>
					</div>
	</section>
	</div><!-- /.c-page -->

<section class="c-block c-block--spacing-t-small c-block--spacing-t-large@md c-block--spacing-b c-page-footer c-block--bg-image c-color--invert" style="background-image: url(https://securelist.com/wp-content/themes/securelist2020/assets/images/content/bg-gradient-02.jpg);">
	<div class="o-container-fluid">
		<div data-element-id="footer-content-block" class="c-page-footer__content">
			<div class="o-row o-row--reverse">
				<div class="o-col-9@md">
					<div class="c-page-menu">
						<div class="o-row c-page-menu__dividers">
							<div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p class="menu-item-threats section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-226 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/threat-categories/" data-element-id="footer-content-link">Threats</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Threats</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category current-post-ancestor current-menu-parent current-post-parent menu-item-99839"><a href="https://securelist.com/threat-category/apt-targeted-attacks/" data-element-id="footer-content-link">APT (Targeted attacks)</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89457"><a href="https://securelist.com/threat-category/secure-environment/" data-element-id="footer-content-link">Secure environment (IoT)</a></li>
	<li class="topic-item vulnerabilities menu-item menu-item-type-custom menu-item-object-custom menu-item-63231"><a href="https://securelist.com/threat-category/mobile-threats/" data-element-id="footer-content-link">Mobile threats</a></li>
	<li class="topic-item detected menu-item menu-item-type-custom menu-item-object-custom menu-item-63229"><a href="https://securelist.com/threat-category/financial-threats/" data-element-id="footer-content-link">Financial threats</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89458"><a href="https://securelist.com/threat-category/spam-and-phishing/" data-element-id="footer-content-link">Spam and phishing</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-99840"><a href="https://securelist.com/threat-category/industrial-threats/" data-element-id="footer-content-link">Industrial threats</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-threat-category menu-item-89465"><a href="https://securelist.com/threat-category/web-threats/" data-element-id="footer-content-link">Web threats</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-89459"><a href="https://securelist.com/threat-category/vulnerabilities-and-exploits/" data-element-id="footer-content-link">Vulnerabilities and exploits</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113855"><a href="https://securelist.com/threat-categories/" data-element-id="footer-content-link">All threats</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><div class="c-accordion js-accordion c-accordion--reset@md"><p class="menu-item-categories section-title accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-230 c-page-menu__title u-hidden u-block@md"><a href="https://securelist.com/categories/" data-element-id="footer-content-link">Categories</a></p><div class="c-accordion-toggle js-accordion-toggle"><p>Categories</p></div><div class="c-accordion-container js-accordion-container">
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84158"><a href="https://securelist.com/category/apt-reports/" data-element-id="footer-content-link">APT reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99841"><a href="https://securelist.com/category/malware-descriptions/" data-element-id="footer-content-link">Malware descriptions</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84160"><a href="https://securelist.com/category/kaspersky-security-bulletin/" data-element-id="footer-content-link">Security Bulletin</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84161"><a href="https://securelist.com/category/malware-reports/" data-element-id="footer-content-link">Malware reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-89460"><a href="https://securelist.com/category/spam-and-phishing-reports/" data-element-id="footer-content-link">Spam and phishing reports</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-99842"><a href="https://securelist.com/category/security-technologies/" data-element-id="footer-content-link">Security technologies</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84165"><a href="https://securelist.com/category/research/" data-element-id="footer-content-link">Research</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-84164"><a href="https://securelist.com/category/publications/" data-element-id="footer-content-link">Publications</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-113876"><a href="https://securelist.com/categories/" data-element-id="footer-content-link">All categories</a></li>
</ul>
</li>
</li></ul></div></div></div><div class="o-col-4@md"><p class="menu-item-tags section-title after-accordion menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-277 c-page-menu__title u-hidden u-block@md"><a data-element-id="footer-content-link">Other sections</a></p>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-100526"><a href="https://securelist.com/all/" data-element-id="footer-content-link">Archive</a></li>
	<li class="show-all-tags menu-item menu-item-type-post_type menu-item-object-page menu-item-57837"><a href="https://securelist.com/tags/" data-element-id="footer-content-link">All tags</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101956"><a href="https://securelist.com/webinars/" data-element-id="footer-content-link">Webinars</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-101126"><a target="_blank" rel="noopener noreferrer" href="https://apt.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">APT Logbook</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-241"><a target="_blank" rel="noopener noreferrer" href="https://statistics.securelist.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">Statistics</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-86643"><a target="_blank" rel="noopener noreferrer" href="https://encyclopedia.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">Encyclopedia</a></li>
	<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-58141"><a target="_blank" rel="noopener noreferrer" href="https://threats.kaspersky.com/?icid=gl_seclistheader_acq_ona_smm__onl_b2b_securelist_main-menu_sm-team_______001391deb99c290f" data-element-id="footer-content-link">Threats descriptions</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-111312"><a href="https://securelist.com/ksb-2023/" data-element-id="footer-content-link">KSB 2023</a></li>
</ul>
</li>
</div>						</div>
					</div>
				</div>
				<div class="o-col-3@md">
					<div class="c-site-logo c-site-logo--kaspersky"></div>
				</div>
			</div>
		</div>
		<div data-element-id="footer-menu-block" class="c-page-footer__wrapper">
			<div class="c-page-footer__info">
								<p>© 2024 AO Kaspersky Lab. All Rights Reserved.<br />
Registered trademarks and service marks are the property of their respective owners.</p>
							</div>
			<div class="c-page-footer__links">
				<ul>
																<li><a data-element-id="footer-menu-link" href="https://www.kaspersky.com/web-privacy-policy?icid=gl_seclistfooter_acq_ona_smm__onl_b2b_securelist_footer_sm-team_______11d7a8212d94123d">Privacy Policy</a></li>
																<li><a data-element-id="footer-menu-link" href="https://www.kaspersky.com/end-user-license-agreement?icid=gl_seclistfooter_acq_ona_smm__onl_b2b_securelist_footer_sm-team_______11d7a8212d94123d">License Agreement</a></li>
																<li><a data-element-id="footer-menu-link" href="javascript: void(0);" onclick="javascript: Cookiebot.renew()">Cookies</a></li>
									</ul>
			</div>
		</div>
	</div>
</section>

<div id="modal-newsletter" class="c-modal__wrapper c-modal__wrapper--sm mfp-hide">
	<div class="c-modal">
		<a href="#" class="c-modal-close js-modal-close"></a>
		<div class="c-modal__main">
			<div class="c-block c-block--spacing-t-small c-block--spacing-b-small">
				<div class="o-container-fluid">
					<div class="c-block__header">
						<h5 class="c-title--small">Subscribe to our weekly e-mails</h5>
						<p>The hottest research right in your inbox</p>
					</div>
					<div class="c-form--float-labels js-float-labels">
						
                <div class='gf_browser_unknown gform_wrapper gform_wrapper_original_id_11 gravity-theme subscribe-mc_wrapper' id='gform_wrapper_2540962617' ><div id='gf_2540962617' class='gform_anchor' tabindex='-1'></div><form method='post' enctype='multipart/form-data' target='gform_ajax_frame_2540962617' id='gform_2540962617' class='subscribe-mc' action='/sas-ctf-windows-7-challenge-explained/114180/#gf_2540962617' >
                        <div class="gform-content-wrapper"><div class='gform_body gform-body'><div id='gform_fields_2540962617' class='gform_fields top_label form_sublabel_below description_below'><div id="field_11_1" class="gfield gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><label class='gfield_label screen-reader-text' for='input_2540962617_1' >Email<span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></label><div class='ginput_container ginput_container_email'>
                            <input name='input_1' id='input_2540962617_1' type='text' value='' class='medium'   placeholder='Email' aria-required="true" aria-invalid="false"  />
                        </div></div><div id="field_11_3" class="gfield js-kaspersky-gform-recaptcha-placeholder gform_hidden field_sublabel_below field_description_below gfield_visibility_hidden" ><div class='ginput_container ginput_container_text'><input name='input_3' id='input_2540962617_3' type='hidden' class='gform_hidden'  aria-invalid="false" value='' /></div></div><fieldset id="field_11_2" class="gfield input-without-label label-gdpr gfield_contains_required field_sublabel_below field_description_below gfield_visibility_visible" ><legend class='gfield_label screen-reader-text gfield_label_before_complex'  ><span class="gfield_required"><span class="gfield_required gfield_required_text">(Required)</span></span></legend><div class='ginput_container ginput_container_checkbox'><div class='gfield_checkbox' id='input_2540962617_2'><div class='gchoice gchoice_11_2_1'>
								<input class='gfield-choice-input' name='input_2.1' type='checkbox'  value='I agree'  id='choice_2540962617_11_2_1'   />
								<label for='choice_2540962617_11_2_1' id='label_2540962617_11_2_1'>I agree to provide my email address to “AO Kaspersky Lab” to receive information about new posts on the site. I understand that I can withdraw this consent at any time via e-mail by clicking the “unsubscribe” link that I find at the bottom of any e-mail sent to me for the purposes mentioned above.</label>
							</div></div></div></fieldset></div></div>
        <div class='gform_footer top_label'> 	<button type="submit" class="gform_button button" id='gform_submit_button_2540962617' value="Sign up">
		<svg class="o-icon o-svg-icon o-svg-large"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://securelist.com/wp-content/themes/securelist2020/assets/sprite/icons.svg#icon-envelope"></use></svg>		<span>Subscribe</span>
	</button>

	 <input type='hidden' name='gform_ajax' value='form_id=11&amp;title=&amp;description=&amp;tabindex=0' />
            <input type='hidden' class='gform_hidden' name='is_submit_11' value='1' />
            <input type='hidden' class='gform_hidden' name='gform_submit' value='11' />
            
            <input type='hidden' class='gform_hidden' name='gform_unique_id' value='' />
            <input type='hidden' class='gform_hidden' name='state_11' value='WyJbXSIsImIwODQwZTA2ZGQ0NzYwODcyOTBkZjNmZDM1NDk2Y2ZkIl0=' />
            <input type='hidden' class='gform_hidden' name='gform_target_page_number_11' id='gform_target_page_number_2540962617_11' value='0' />
            <input type='hidden' class='gform_hidden' name='gform_source_page_number_11' id='gform_source_page_number_2540962617_11' value='1' />
            <input type='hidden' name='gform_random_id' value='2540962617' /><input type='hidden' name='gform_field_values' value='securelist_2020_form_location=sidebar' />
            
        </div>
                        </div><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_4" name="ak_js" value="93"/><script>document.getElementById( "ak_js_4" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>
                        </div>
                <iframe style='display:none;width:0px;height:0px;' src='about:blank' name='gform_ajax_frame_2540962617' id='gform_ajax_frame_2540962617' title='This iframe contains the logic required to handle Ajax powered Gravity Forms.'></iframe>
                <script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() {gformInitSpinner( 2540962617, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery('#gform_ajax_frame_2540962617').on('load',function(){var contents = jQuery(this).contents().find('*').html();var is_postback = contents.indexOf('GF_AJAX_POSTBACK') >= 0;if(!is_postback){return;}var form_content = jQuery(this).contents().find('#gform_wrapper_2540962617');var is_confirmation = jQuery(this).contents().find('#gform_confirmation_wrapper_2540962617').length > 0;var is_redirect = contents.indexOf('gformRedirect(){') >= 0;var is_form = form_content.length > 0 && ! is_redirect && ! is_confirmation;var mt = parseInt(jQuery('html').css('margin-top'), 10) + parseInt(jQuery('body').css('margin-top'), 10) + 100;if(is_form){jQuery('#gform_wrapper_2540962617').html(form_content.html());if(form_content.hasClass('gform_validation_error')){jQuery('#gform_wrapper_2540962617').addClass('gform_validation_error');} else {jQuery('#gform_wrapper_2540962617').removeClass('gform_validation_error');}setTimeout( function() { /* delay the scroll by 50 milliseconds to fix a bug in chrome */ jQuery(document).scrollTop(jQuery('#gform_wrapper_2540962617').offset().top - mt); }, 50 );if(window['gformInitDatepicker']) {gformInitDatepicker();}if(window['gformInitPriceFields']) {gformInitPriceFields();}var current_page = jQuery('#gform_source_page_number_2540962617_11').val();gformInitSpinner( 2540962617, 'https://securelist.com/wp-content/themes/securelist2020/assets/images/content/ajax-spinner-red.svg' );jQuery(document).trigger('gform_page_loaded', [2540962617, current_page]);window['gf_submitting_2540962617'] = false;}else if(!is_redirect){var confirmation_content = jQuery(this).contents().find('.GF_AJAX_POSTBACK').html();if(!confirmation_content){confirmation_content = contents;}setTimeout(function(){jQuery('#gform_wrapper_2540962617').replaceWith(confirmation_content);jQuery(document).scrollTop(jQuery('#gf_2540962617').offset().top - mt);jQuery(document).trigger('gform_confirmation_loaded', [2540962617]);window['gf_submitting_2540962617'] = false;wp.a11y.speak(jQuery('#gform_confirmation_message_2540962617').text());}, 50);}else{jQuery('#gform_2540962617').append(contents);if(window['gformRedirect']) {gformRedirect();}}jQuery(document).trigger('gform_post_render', [2540962617, current_page]);} );} ); 
/* ]]> */
</script>
					</div>
				</div>
			</div>
		</div><!-- /.c-modal__main -->
	</div><!-- /.c-modal -->
</div><!-- /.c-modal__wrapper -->
            <script type="text/javascript">
            if ( typeof _recaptcha_wordpress_savedcomment != 'undefined') {
                document.getElementById('comment').value =
                    _recaptcha_wordpress_savedcomment;
            }
            </script><script type="text/javascript" src="https://kasperskycontenthub.com/securelist/wp-content/plugins/kaspersky-embeds/js/scripts.js?ver=1.0" id="kspr_embeds-js"></script>
<script type="text/javascript" src="https://www.google.com/recaptcha/api.js?render=explicit&amp;ver=202124050927" id="kaspersky-dynamic-gravity-forms-google-recaptcha-js"></script>
<script type="text/javascript" id="kaspersky-omniture-js-extra">
/* <![CDATA[ */
var kaspersky = {"pageName":"Kaspersky Securelist","pageType":"blog","platformName":"Micro Site","businessType":"b2c","siteLocale":"en-GLOBAL"};
/* ]]> */
</script>
<script type="text/javascript" src="//media.kaspersky.com/tracking/omniture/s_code_single_suite.js?ver=6.5.5" id="kaspersky-omniture-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" id="kaspersky-dynamic-gravity-forms-main-js-extra">
/* <![CDATA[ */
var kasperskyDynamicaReCaptchaData = {"ajaxUrl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" id="wp-autosearch-script-js-extra">
/* <![CDATA[ */
var wp_autosearch_config = {"autocomplete_taxonomies":{"0":"category"},"split_results_by_type":"true","search_title":"true","search_content":"false","search_terms":"false","search_exactonly":"true","order_by":"title","order":"DESC","search_comments":"false","search_tags":"false","no_of_results":"5","description_limit":"100","title_limit":"50","excluded_ids":{},"excluded_cats":{"0":0},"full_search_url":"https:\/\/kasperskycontenthub.com\/securelist\/?s=%q%","min_chars":"3","ajax_delay":"200","cache_length":"200","autocomplete_sortorder":"posts","thumb_image_display":"false","thumb_image_width":"50","thumb_image_height":"50","get_first_image":"true","force_resize_first_image":"true","thumb_image_crop":"true","default_image":"https:\/\/kasperskycontenthub.com\/securelist\/wp-content\/plugins\/wp-autosearch\/assert\/image\/default.png","search_image":"","display_more_bar":"false","display_result_title":"false","enable_token":"true","custom_css":"","custom_js":"","try_full_search_text":"Search more...","no_results_try_full_search_text":"No Results!","show_author":"false","show_date":"false","description_result":"false","color":{"results_even_bar":"E8E8E8","results_odd_bar":"FFFFFF","results_even_text":"000000","results_odd_text":"000000","results_hover_bar":"5CCCB2","results_hover_text":"FFFFFF","seperator_bar":"2D8DA0","seperator_hover_bar":"6A81A0","seperator_text":"FFFFFF","seperator_hover_text":"FFFFFF","more_bar":"5286A0","more_hover_bar":"4682A0","more_text":"FFFFFF","more_hover_text":"FFFFFF","box_border":"57C297","box_background":"FFFFFF","box_text":"000000"},"title":{"page":"Pages","post":"Posts","webinars":"Webinars"},"post_types":{"0":"page","1":"post","2":"webinars"},"nonce":"3a14e33f71","ajax_url":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" id="securelist-script-js-extra">
/* <![CDATA[ */
var securelist2020Data = {"ajaxUrl":"https:\/\/securelist.com\/wp-admin\/admin-ajax.php","loading":"Loading...","marketoBaseURL":"","marketoVirtualForm":"27241","munchkinID":"802-IJN-240","reCaptcha_key":"6Lf2eUQUAAAAAC-GQSZ6R2pjePmmD6oA6F_3AV7j"};
/* ]]> */
</script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js,wp-content/plugins/kaspersky-gravity-forms-dynamic-recaptcha/assets/js/main.js,wp-content/plugins/kaspersky-lazy-load/assets/js/main.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/migrate.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/autocomplete.js,wp-content/plugins/kaspersky-wp-autosearch/assert/js/ajax-script.js,wp-content/plugins/wds-no-login-autocomplete/js/script.js,wp-content/themes/securelist2020/assets/js/main.js,wp-includes/js/comment-reply.min.js,wp-content/plugins/akismet/_inc/akismet-frontend.js'></script>
<script type='text/javascript' src='//assets.kasperskycontenthub.com/wp-content/plugins/bwp-minify/min/?f=wp-includes/js/dist/vendor/wp-polyfill-inert.min.js,wp-includes/js/dist/vendor/regenerator-runtime.min.js,wp-includes/js/dist/vendor/wp-polyfill.min.js,wp-includes/js/dist/dom-ready.min.js,wp-includes/js/dist/hooks.min.js,wp-includes/js/dist/i18n.min.js,wp-includes/js/dist/a11y.min.js'></script>
<script type="text/javascript" defer='defer' src="https://securelist.com/wp-content/plugins/gravityforms/js/jquery.json.min.js?ver=2.5.16.3" id="gform_json-js"></script>
<script type="text/javascript" id="gform_gravityforms-js-extra">
/* <![CDATA[ */
var gform_i18n = {"datepicker":{"days":{"monday":"Mon","tuesday":"Tue","wednesday":"Wed","thursday":"Thu","friday":"Fri","saturday":"Sat","sunday":"Sun"},"months":{"january":"January","february":"February","march":"March","april":"April","may":"May","june":"June","july":"July","august":"August","september":"September","october":"October","november":"November","december":"December"},"firstDay":1,"iconText":"Select date"}};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":""};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":""};
var gf_global = {"gf_currency_config":{"name":"U.S. Dollar","symbol_left":"$","symbol_right":"","symbol_padding":"","thousand_separator":",","decimal_separator":".","decimals":2,"code":"USD"},"base_url":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms","number_formats":[],"spinnerUrl":"https:\/\/securelist.com\/wp-content\/plugins\/gravityforms\/images\/spinner.svg","strings":{"newRowAdded":"New row added.","rowRemoved":"Row removed","formSaved":"The form has been saved.  The content contains the link to return and complete the form."}};
var gf_legacy_multi = {"11":""};
/* ]]> */
</script>
<script type="text/javascript" defer='defer' src="https://securelist.com/wp-content/plugins/gravityforms/js/gravityforms.min.js?ver=2.5.16.3" id="gform_gravityforms-js"></script>
<script type="text/javascript" defer='defer' src="https://securelist.com/wp-content/plugins/gravityforms/js/placeholders.jquery.min.js?ver=2.5.16.3" id="gform_placeholder-js"></script>
<script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() { jQuery(document).on('gform_post_render', function(event, formId, currentPage){if(formId == 11) {if(typeof Placeholders != 'undefined'){
                        Placeholders.enable();
                    }} } );jQuery(document).bind('gform_post_conditional_logic', function(event, formId, fields, isInit){} ) } ); 
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
 gform.initializeOnLoaded( function() { jQuery(document).trigger('gform_post_render', [11, 1]) } ); 
/* ]]> */
</script>

</body>
</html>
