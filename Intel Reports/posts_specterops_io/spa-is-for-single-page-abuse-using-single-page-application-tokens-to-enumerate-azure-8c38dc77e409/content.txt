<!doctype html><html lang="en"><head><title data-rh="true">SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure | by Lance B. Cain | Dec, 2024 | Posts By SpecterOps Team Members</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-12-10T17:58:53.256Z"/><meta data-rh="true" name="title" content="SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure | by Lance B. Cain | Dec, 2024 | Posts By SpecterOps Team Members"/><meta data-rh="true" property="og:title" content="SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure"/><meta data-rh="true" property="al:android:url" content="medium://p/8c38dc77e409"/><meta data-rh="true" property="al:ios:url" content="medium://p/8c38dc77e409"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Microsoft Azure is a leading cloud provider offering technology solutions to companies, governments, and other organizations around the globe. As such, many entities have begun adopting Azure for…"/><meta data-rh="true" property="og:description" content="Author: Lance B. Cain"/><meta data-rh="true" property="og:url" content="https://posts.specterops.io/spa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409"/><meta data-rh="true" property="al:web:url" content="https://posts.specterops.io/spa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:940/1*nI1tomeetNl9LEP8WrYtnQ.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@lbcain18"/><meta data-rh="true" name="author" content="Lance B. Cain"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure"/><meta data-rh="true" name="twitter:site" content="@specterops"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/8c38dc77e409"/><meta data-rh="true" property="twitter:description" content="Author: Lance B. Cain"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:940/1*nI1tomeetNl9LEP8WrYtnQ.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="8 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*D-FDlfkqivRBQZoESrwtqw.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@lbcain18"/><link data-rh="true" rel="canonical" href="https://posts.specterops.io/spa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/8c38dc77e409"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*nI1tomeetNl9LEP8WrYtnQ.png"],"url":"https:\u002F\u002Fposts.specterops.io\u002Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409","dateCreated":"2024-12-10T16:04:20.482Z","datePublished":"2024-12-10T16:04:20.482Z","dateModified":"2024-12-10T17:58:53.256Z","headline":"SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure","name":"SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure","description":"Microsoft Azure is a leading cloud provider offering technology solutions to companies, governments, and other organizations around the globe. As such, many entities have begun adopting Azure for…","identifier":"8c38dc77e409","author":{"@type":"Person","name":"Lance B. Cain","url":"https:\u002F\u002Fposts.specterops.io\u002F@lbcain18"},"creator":["Lance B. Cain"],"publisher":{"@type":"Organization","name":"Posts By SpecterOps Team Members","url":"posts.specterops.io","logo":{"@type":"ImageObject","width":149,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:298\u002F1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fposts.specterops.io\u002Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409"}</script><style type="text/css" data-fela-rehydration="570" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="570" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(128, 128, 183, 1)}.es{border-color:rgba(128, 128, 183, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(128, 128, 183, 1)}.ez:disabled:hover{border-color:rgba(128, 128, 183, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(128, 128, 183, 1)}.iu{fill:rgba(128, 128, 183, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{font-style:italic}.nv{background:none}.nw{line-height:1.12}.nx{letter-spacing:-0.022em}.ny{font-weight:600}.ot{margin-bottom:-0.28em}.oz{text-decoration:underline}.pa{list-style-type:disc}.pb{margin-left:30px}.pc{padding-left:0px}.pi{margin-left:auto}.pj{margin-right:auto}.pk{max-width:940px}.pq{clear:both}.ps{cursor:zoom-in}.pt{z-index:auto}.pv{height:auto}.pw{margin-top:10px}.px{max-width:728px}.qa{max-width:936px}.qb{list-style-type:decimal}.qc{overflow-x:auto}.qd{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qe{padding:32px}.qf{border:1px solid #E5E5E5}.qg{line-height:1.4}.qh{margin-top:-0.2em}.qi{margin-bottom:-0.2em}.qj{white-space:pre}.qk{min-width:fit-content}.ql{max-width:942px}.qm{max-width:946px}.qn{max-width:978px}.qo{max-width:944px}.qp{margin-top:32px}.qq{margin-bottom:14px}.qr{padding-top:24px}.qs{padding-bottom:10px}.qt{background-color:#000000}.qu{height:3px}.qv{width:3px}.qw{margin-right:20px}.rc{margin-bottom:26px}.rd{margin-top:6px}.re{margin-top:8px}.rf{margin-right:8px}.rg{padding:8px 16px}.rh{border-radius:100px}.ri{transition:background 300ms ease}.rk{white-space:nowrap}.rl{border-top:none}.rm{height:52px}.rn{max-height:52px}.ro{box-sizing:content-box}.rp{position:static}.rr{max-width:155px}.sc{height:0px}.sd{margin-bottom:40px}.se{margin-bottom:48px}.ss{border-radius:2px}.su{height:64px}.sv{width:64px}.sw{align-self:flex-end}.sx{color:rgba(255, 255, 255, 1)}.sy{fill:rgba(255, 255, 255, 1)}.sz{background:rgba(25, 25, 25, 1)}.ta{border-color:rgba(25, 25, 25, 1)}.td:disabled{opacity:0.1}.te:disabled:hover{background:rgba(25, 25, 25, 1)}.tf:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tg{flex:1 1 auto}.tm{padding-right:4px}.tn{font-weight:500}.ua{margin-top:16px}.ub{margin-bottom:54px}.uh{gap:18px}.ui{fill:rgba(61, 61, 61, 1)}.uu{border-bottom:solid 1px #E5E5E5}.uv{margin-top:72px}.uw{padding:24px 0}.ux{margin-bottom:0px}.uy{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(110, 110, 154, 1)}.eu:hover{border-color:rgba(110, 110, 154, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(110, 110, 154, 1)}.iw:hover:not(:disabled){fill:rgba(110, 110, 154, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.rj:hover{background-color:#F2F2F2}.st:hover{background-color:none}.tb:hover{background:#000000}.tc:hover{border-color:#242424}.uj:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.pu:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.op{font-size:24px}.oq{margin-top:1.95em}.or{line-height:30px}.os{letter-spacing:-0.016em}.oy{margin-top:0.94em}.ph{margin-top:1.14em}.pp{margin-top:56px}.rb{margin-top:1.25em}.rw{display:inline-block}.sb{margin-bottom:104px}.sf{flex-direction:row}.si{margin-bottom:0}.sj{margin-right:20px}.th{max-width:500px}.ty{line-height:24px}.tz{letter-spacing:0}.ug{margin-bottom:72px}.uo{margin:40px 0 0}.ut{padding-top:72px}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.py{margin-left:auto}.pz{text-align:center}.rv{display:inline-block}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.ru{display:inline-block}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.rt{display:inline-block}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.nz{font-size:20px}.oa{margin-top:1.2em}.ob{line-height:24px}.oc{letter-spacing:0}.ou{margin-top:0.67em}.pd{margin-top:1.34em}.pl{margin-top:40px}.qx{margin-top:0.93em}.rs{display:inline-block}.rx{margin-bottom:96px}.sq{margin-bottom:20px}.sr{margin-right:0}.tl{max-width:100%}.to{font-size:24px}.tp{line-height:30px}.tq{letter-spacing:-0.016em}.uc{margin-bottom:64px}.uk{margin:32px 0 0}.up{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.ol{font-size:24px}.om{margin-top:1.95em}.on{line-height:30px}.oo{letter-spacing:-0.016em}.ox{margin-top:0.94em}.pg{margin-top:1.14em}.po{margin-top:56px}.ra{margin-top:1.25em}.sa{margin-bottom:104px}.sg{flex-direction:row}.sk{margin-bottom:0}.sl{margin-right:20px}.ti{max-width:500px}.tw{line-height:24px}.tx{letter-spacing:0}.uf{margin-bottom:72px}.un{margin:40px 0 0}.us{padding-top:72px}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.oh{font-size:24px}.oi{margin-top:1.95em}.oj{line-height:30px}.ok{letter-spacing:-0.016em}.ow{margin-top:0.94em}.pf{margin-top:1.14em}.pn{margin-top:56px}.qz{margin-top:1.25em}.rz{margin-bottom:104px}.sh{flex-direction:row}.sm{margin-bottom:0}.sn{margin-right:20px}.tj{max-width:500px}.tu{line-height:24px}.tv{letter-spacing:0}.ue{margin-bottom:72px}.um{margin:40px 0 0}.ur{padding-top:72px}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.od{font-size:20px}.oe{margin-top:1.2em}.of{line-height:24px}.og{letter-spacing:0}.ov{margin-top:0.67em}.pe{margin-top:1.34em}.pm{margin-top:40px}.qy{margin-top:0.93em}.ry{margin-bottom:96px}.so{margin-bottom:20px}.sp{margin-right:0}.tk{max-width:100%}.tr{font-size:24px}.ts{line-height:30px}.tt{letter-spacing:-0.016em}.ud{margin-bottom:64px}.ul{margin:32px 0 0}.uq{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="print">.rq{display:none}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="570" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pr{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8c38dc77e409&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign up</a></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="fda3" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@lbcain18?source=post_page---byline--8c38dc77e409--------------------------------" rel="noopener follow"><div class="l ib ic by id ie"><div class="l fj"><img alt="Lance B. Cain" class="l fd by dd de cx" src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*v0d00TR4cFqVeADo" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://posts.specterops.io/?source=post_page---byline--8c38dc77e409--------------------------------" rel="noopener  ugc nofollow"><div class="l ii ij by id ik"><div class="l fj"><img alt="Posts By SpecterOps Team Members" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*D-FDlfkqivRBQZoESrwtqw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" href="https://medium.com/@lbcain18?source=post_page---byline--8c38dc77e409--------------------------------" rel="noopener follow">Lance B. Cain</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F040c3e09d079&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=post_page-040c3e09d079--byline--8c38dc77e409---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://posts.specterops.io/?source=post_page---byline--8c38dc77e409--------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">Posts By SpecterOps Team Members</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Dec 10, 2024</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F8c38dc77e409&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=---header_actions--8c38dc77e409---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8c38dc77e409&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;source=---header_actions--8c38dc77e409---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="2e06" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nu">Author: </em><span class="is"><span class="is" aria-hidden="false"><a class="nv it fe" href="https://medium.com/u/040c3e09d079?source=post_page---user_mention--8c38dc77e409--------------------------------" rel="noopener" target="_blank"><em class="nu">Lance B. Cain</em></a></span></span></p><h1 id="bef6" class="nw nx gu bf ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot bk">Overview</h1><p id="f42a" class="pw-post-body-paragraph mw mx gu my b mz ou nb nc nd ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt gn bk">Microsoft Azure is a leading cloud provider offering technology solutions to companies, governments, and other organizations around the globe. As such, many entities have begun adopting Azure for their technology needs to include identity, authentication, storage, application management, and web services. One of the most common methods for organizations to begin experimenting with and adopting Azure is by deploying web applications and an increasingly popular method for creating web applications is by designing Single-Page Applications (SPAs). Katie Lawson of <a class="af oz" href="https://www.bloomreach.com/en/blog/what-is-a-single-page-application" rel="noopener ugc nofollow" target="_blank">bloomreach.com</a> defines SPAs as, “a website or web application that dynamically rewrites a current web page with new data from the web server, instead of the default method of a web browser loading entire new pages”. SPAs typically utilize JavaScript integrations with API calls to dynamically update for a seamless user experience. Microsoft has multiple walkthroughs, guides, and documentation to aid organizations in deploying SPAs on Azure:</p><ul class=""><li id="bd8d" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt pa pb pc bk">Single-page application (SPA) documentation — <a class="af oz" href="https://learn.microsoft.com/en-us/entra/identity-platform/index-spa" rel="noopener ugc nofollow" target="_blank">https://learn.microsoft.com/en-us/entra/identity-platform/index-spa</a></li><li id="7035" class="mw mx gu my b mz pd nb nc nd pe nf ng nh pf nj nk nl pg nn no np ph nr ns nt pa pb pc bk">Single-page application: App registration — <a class="af oz" href="https://learn.microsoft.com/en-us/entra/identity-platform/scenario-spa-app-registration" rel="noopener ugc nofollow" target="_blank">https://learn.microsoft.com/en-us/entra/identity-platform/scenario-spa-app-registration</a></li><li id="8b2e" class="mw mx gu my b mz pd nb nc nd pe nf ng nh pf nj nk nl pg nn no np ph nr ns nt pa pb pc bk">Configure authentication in a sample single-page application by using Azure AD B2C — <a class="af oz" href="https://learn.microsoft.com/en-us/azure/active-directory-b2c/configure-authentication-sample-spa-app" rel="noopener ugc nofollow" target="_blank">https://learn.microsoft.com/en-us/azure/active-directory-b2c/configure-authentication-sample-spa-app</a></li></ul><p id="6a67" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">As a result, there are many new publicly hosted SPAs that communicate with Azure backend resources.</p><p id="b951" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">This blog post is intended to share insights learned from a prior security assessment about the attack surface of Single-Page Applications integrated with Azure, aid technology professionals in securing their Azure environments, and serve as a guide for enumerating Azure tenants using the additions of the pull request I submitted to Dirk-Jan’s <a class="af oz" href="https://github.com/dirkjanm/ROADtools" rel="noopener ugc nofollow" target="_blank">ROADTools</a> repository. This blog is not a comprehensive analysis of every SPA hosted on Azure, so your mileage may vary. Due to the widespread adoption of Microsoft’s Office products and web integrations for Azure, I will focus on two popular SPAs that Microsoft offers (i.e., <em class="nu">WWW.OFFICE.COM</em> and <em class="nu">PORTAL.AZURE.COM</em>); however, the workflow translates to many other SPAs as well.</p><h1 id="9d1d" class="nw nx gu bf ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot bk">A Brief Origin Story</h1><p id="dbe0" class="pw-post-body-paragraph mw mx gu my b mz ou nb nc nd ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt gn bk">My team and I were working on a collaborative cloud assessment for one of our clients targeting their Azure tenant. We were tasked with identifying methods of escalating privileges, assisting defenders in improving detections, and documenting attack paths in the client Azure environment using a compromised non-privileged user account on a Windows Virtual Desktop Image (VDI). We began by enumerating the available applications, Azure resources, Microsoft technologies, and client subscriptions. During the assessment, we learned that the client Azure environment was hardened with enforced multi-factor authentication (MFA), allow-listed MFA conditional access policies (CAPs), administrator restrictions on internal and external application enrollments, administrator approval for external invitations, <a class="af oz" href="https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-continuous-access-evaluation" rel="noopener ugc nofollow" target="_blank">continuous access evaluation</a>, blocked access to Entra ID in the Azure portal, browser extension host security checks, blocked command-line interface (CLI) and PowerShell access, and time limitations on issued tokens forcing expiration after one hour.</p><p id="0cd4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The defensive configurations in the client environment impeded our work obtaining access and refresh tokens to enumerate the target tenant. The team began looking at the resources our user account had access to. We had successfully authenticated as the non-privileged user to the Azure portal and administrator pre-approved Microsoft Office web applications like Excel or Word on <em class="nu">HTTPS://WWW.MICROSOFT365.COM</em>. Within the Azure portal, we discovered that the user account had access to the Azure cloud shell which the team used to obtain an access token using the built-in PowerShell cmdlet <a class="af oz" href="https://learn.microsoft.com/en-us/powershell/module/az.accounts/get-azaccesstoken?view=azps-13.0.0" rel="noopener ugc nofollow" target="_blank">Get-AzAccessToken</a> and initiate some cursory enumeration.</p><p id="a771" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Pro-Tip:</strong> If the cloud shell is available, it is possible to install pip Python modules, including ROADTools, in the Bash shell.</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3xI_BUK4G5UyBk59pRDuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_3xI_BUK4G5UyBk59pRDuw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_3xI_BUK4G5UyBk59pRDuw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_3xI_BUK4G5UyBk59pRDuw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_3xI_BUK4G5UyBk59pRDuw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_3xI_BUK4G5UyBk59pRDuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_3xI_BUK4G5UyBk59pRDuw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_3xI_BUK4G5UyBk59pRDuw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="543" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 1 — Installing ROADTools in the Azure Cloud Shell</figcaption></figure><p id="da79" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The team started collections to enumerate the client tenant using ROADTools and AzureHound with our initial access token; however, an hour later, we discovered that the tools had failed when the acquired token expired prior to completing their tasks. With the knowledge that the client tenant was so large that automated enumeration would exceed the one-hour lifetime for access tokens, we began looking into methods to update the access token for collections. After some research, we learned one of the likely intentional limitations of Get-AzAccessTokens for the Azure cloud shell that it would obtain access tokens, but it would not return a refresh token. My teammates started working on methods to script out obtaining a new access token in the cloud console, meanwhile I began looking at the access we had to authorized Microsoft web applications.</p><p id="8250" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">While investigating the Azure portal, I remembered something that <span class="is"><span class="is" aria-hidden="false"><a class="nv it fe" href="https://medium.com/u/b9c2df322eaf?source=post_page---user_mention--8c38dc77e409--------------------------------" rel="noopener" target="_blank">Andy Robbins</a></span></span> mentioned at SpecterOps’ <a class="af oz" href="https://specterops.io/azure-security-fundamentals/" rel="noopener ugc nofollow" target="_blank">Azure Security Fundamentals</a> training; specifically, that the Azure portal was essentially a web application frontend which communicates with the Azure Graph APIs. Thinking about the ROADTools implemented authentication flow to obtain tokens with a Selenium browser; despite not being an option during the assessment due to the required extensions, I opened the inspector panel in the VDI client Google Chrome web browser to look for any type of token exchanges that occurred during authentication. While reviewing the network traffic in the inspector panel, I observed some requests named “token”. I discovered when filtering and inspecting traffic for the term “token” that there were multiple access and refresh tokens contained in the request payloads for resources like <em class="nu">MANAGEMENT.CORE.WINDOWS.NET</em>, <em class="nu">GRAPH.MICROSOFT.COM</em>, and most interesting <em class="nu">GRAPH.MICROSOFT.NET</em>. The access tokens for the client environment still had the one-hour expiration limit, but the refresh tokens were valid for up to four hours. I also discovered that upon selecting the payload tab the client-id used for the request was also captured.</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nI1tomeetNl9LEP8WrYtnQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nI1tomeetNl9LEP8WrYtnQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nI1tomeetNl9LEP8WrYtnQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nI1tomeetNl9LEP8WrYtnQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nI1tomeetNl9LEP8WrYtnQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nI1tomeetNl9LEP8WrYtnQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nI1tomeetNl9LEP8WrYtnQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*nI1tomeetNl9LEP8WrYtnQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="459" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 2— Access and Refresh Tokens in SPA Network Traffic</figcaption></figure><p id="fc7d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Excited to have obtained a refresh token for our client environment, I attempted authentication over a proxied connection to the VDI with ROADTools using the refresh token, which resulted in the below error response from Azure regarding cross-origin requests.</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9HTxb2D7A29omNjmLeg4VA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*9HTxb2D7A29omNjmLeg4VA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*9HTxb2D7A29omNjmLeg4VA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*9HTxb2D7A29omNjmLeg4VA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*9HTxb2D7A29omNjmLeg4VA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*9HTxb2D7A29omNjmLeg4VA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*9HTxb2D7A29omNjmLeg4VA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*9HTxb2D7A29omNjmLeg4VA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="98" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 3— Cross-Origin Error Response</figcaption></figure><p id="72cb" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">I began researching the error message and quickly stumbled upon this Stack Overflow <a class="af oz" href="https://stackoverflow.com/questions/61231144/getting-access-tokens-from-postman-tokens-issued-for-the-single-page-applicati" rel="noopener ugc nofollow" target="_blank">post</a> where one of CajunCoding’s comments referenced a Microsoft page stating, “Microsoft identity platform returns an error if you attempt to use a spa redirect URI without an Origin header.”</p><p id="0c86" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Upon reviewing the <a class="af oz" href="https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-auth-code-flow#redirect-uris-for-single-page-apps-spas" rel="noopener ugc nofollow" target="_blank">Microsoft documentation</a>, I spent the next hour issuing multiple web API requests to <em class="nu">HTTPS://LOGIN.MICROSOFTONLINE.COM/{TENANT}/OAUTH2/V2.0/AUTHORIZE</em> using Burp Suite and curl commands with varying origin HTTP headers. An access token was eventually returned for the supplied refresh token when entering the originating application URL in the request origin header. Upon successfully obtaining a new access token by hand, I updated my local instance of ROADTools to accommodate supplying an origin value when performing authentication with refresh tokens, which resulted in the addition of the origin parameter. Afterwards, my team and I successfully enumerated the client tenant using the available SPA refresh tokens and continued with the assessment. Our client was pleased to learn about the attack path where users with granted access to SPAs like the Azure Portal and Microsoft Online Office Applications could potentially obtain new tokens to enumerate their Azure tenant.</p><h1 id="28ee" class="nw nx gu bf ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot bk">SPA Token Enumeration Workflow</h1><p id="97cc" class="pw-post-body-paragraph mw mx gu my b mz ou nb nc nd ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt gn bk">Now with the origin argument added to the latest version of ROADTools, the most basic process of using SPA tokens to enumerate an Azure tenant is:</p><ol class=""><li id="178b" class="mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qb pb pc bk">On an Azure client workstation, open the inspector panel in a web browser and filter network traffic for “tokens”</li><li id="cfce" class="mw mx gu my b mz pd nb nc nd pe nf ng nh pf nj nk nl pg nn no np ph nr ns nt qb pb pc bk">Authenticate to a SPA or re-open an existing browser session to an authenticated SPA</li></ol><p id="2bed" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Note:</strong> Take notice of the origin URL</p><p id="237e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">3. View exchanged tokens to obtain the refresh token contained in one of the <em class="nu">MICROSOFT.NET</em>, <em class="nu">MICROSOFT.COM</em>, or other Microsoft integrated resource token requests</p><p id="4a2c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Pro-Tip:</strong> For small tenants or tenants without short token expirations, access tokens for <em class="nu">GRAPH.MICROSOFT.NET</em> can be used from the browser instead of refresh tokens.</p><p id="eaa3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Pro-Tip:</strong> Some resource tokens have been found to provide only partial collections and will generate HTTP 403 errors like <em class="nu">MANAGEMENT.CORE.WINDOWS.NET</em> as demonstrated in the examples. I recommend targeting <em class="nu">GRAPH.WINDOWS.NET</em> or SharePoint resource tokens which have yielded the best results</p><p id="a291" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">4. Take note of the application client-id used to request tokens</p><p id="c9e6" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Pro-Tip:</strong> For first-party Microsoft Azure applications like <em class="nu">HTTPS://PORTAL.AZURE.COM</em>, bookmark this page to quickly lookup the client-id: <a class="af oz" href="https://learn.microsoft.com/en-us/troubleshoot/entra/entra-id/governance/verify-first-party-apps-sign-in#application-ids-of-commonly-used-microsoft-applications" rel="noopener ugc nofollow" target="_blank">https://learn.microsoft.com/en-us/troubleshoot/entra/entra-id/governance/verify-first-party-apps-sign-in#application-ids-of-commonly-used-microsoft-applications</a></p><p id="462b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">5. Authenticate to the Microsoft graph API by supplying all the captured values to ROADTools</p><pre class="pl pm pn po pp qc qd qe bp qf bb bk"><span id="7cc3" class="qg nx gu qd b bg qh qi l qj qk">roadrecon auth -c &lt;Client-ID&gt; --origin &lt;SPA Base URL&gt; --refresh-token &lt;Browser Refresh Token&gt;</span></pre><p id="e68a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><strong class="my gv">Pro-Tip:</strong> If Azure continuous access evaluation is enforced, execute the ROADTools authentication from the original workstation or SOCKs proxy the request through the workstation.</p><p id="c24e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">6. Execute your collection</p><pre class="pl pm pn po pp qc qd qe bp qf bb bk"><span id="29f8" class="qg nx gu qd b bg qh qi l qj qk">roadrecon gather</span></pre><p id="d823" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">7. Review the information</p><pre class="pl pm pn po pp qc qd qe bp qf bb bk"><span id="bfa9" class="qg nx gu qd b bg qh qi l qj qk">roadrecon gui</span></pre><h1 id="8ea3" class="nw nx gu bf ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot bk">Azure Portal Example — Partial Collection with MANAGEMENT.CORE.WINDOWS.NET Token</h1><ol class=""><li id="dda2" class="mw mx gu my b mz ou nb nc nd ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt qb pb pc bk">Inspect</li></ol><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPu8UffnM723yTIyYk-Bsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FPu8UffnM723yTIyYk-Bsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FPu8UffnM723yTIyYk-Bsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FPu8UffnM723yTIyYk-Bsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FPu8UffnM723yTIyYk-Bsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FPu8UffnM723yTIyYk-Bsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FPu8UffnM723yTIyYk-Bsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*FPu8UffnM723yTIyYk-Bsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="528" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 4— Web Inspection and Network Filtering</figcaption></figure><p id="f4e0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">2. Authenticate</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdNjE0AAxP1DuwGyAlP67A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*bdNjE0AAxP1DuwGyAlP67A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*bdNjE0AAxP1DuwGyAlP67A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*bdNjE0AAxP1DuwGyAlP67A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*bdNjE0AAxP1DuwGyAlP67A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*bdNjE0AAxP1DuwGyAlP67A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*bdNjE0AAxP1DuwGyAlP67A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*bdNjE0AAxP1DuwGyAlP67A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="727" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 5— Azure Portal Authentication to Testing Tenant</figcaption></figure><p id="8442" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">3. Obtain Tokens</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0CVF2r0ogN5hKiKQxyGPdg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0CVF2r0ogN5hKiKQxyGPdg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0CVF2r0ogN5hKiKQxyGPdg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0CVF2r0ogN5hKiKQxyGPdg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0CVF2r0ogN5hKiKQxyGPdg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0CVF2r0ogN5hKiKQxyGPdg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0CVF2r0ogN5hKiKQxyGPdg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0CVF2r0ogN5hKiKQxyGPdg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="382" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 6— Access and Refresh Tokens for MANAGEMENT.CORE.WINDOWS.NET</figcaption></figure><p id="0c9a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">4. Note Client ID</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XLuOxmwR-O9EWvTAtNfHg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5XLuOxmwR-O9EWvTAtNfHg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5XLuOxmwR-O9EWvTAtNfHg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5XLuOxmwR-O9EWvTAtNfHg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5XLuOxmwR-O9EWvTAtNfHg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5XLuOxmwR-O9EWvTAtNfHg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5XLuOxmwR-O9EWvTAtNfHg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5XLuOxmwR-O9EWvTAtNfHg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="435" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 7— Client ID in Request Payload</figcaption></figure><p id="9ec7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">5. Authenticate with ROADRecon</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tio2IwbauQWsSR44GfQZVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Tio2IwbauQWsSR44GfQZVg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Tio2IwbauQWsSR44GfQZVg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Tio2IwbauQWsSR44GfQZVg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Tio2IwbauQWsSR44GfQZVg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Tio2IwbauQWsSR44GfQZVg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Tio2IwbauQWsSR44GfQZVg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Tio2IwbauQWsSR44GfQZVg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="103" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 8— Successful Authentication with Refresh Token</figcaption></figure><p id="3d42" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">6. Gather — 403 Errors = Partial Collection</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0uh04mcyo8qXYOGl2evUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Y0uh04mcyo8qXYOGl2evUg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Y0uh04mcyo8qXYOGl2evUg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Y0uh04mcyo8qXYOGl2evUg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Y0uh04mcyo8qXYOGl2evUg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Y0uh04mcyo8qXYOGl2evUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Y0uh04mcyo8qXYOGl2evUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Y0uh04mcyo8qXYOGl2evUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="385" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 9— Gather with HTTP 403 Errors</figcaption></figure><p id="e1de" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">7. Review — roadrecon gui and browse to <em class="nu">HTTP://127.0.0.1:5000</em></p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t61j_8I31Kc_9Lx7Mtzpkw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*t61j_8I31Kc_9Lx7Mtzpkw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*t61j_8I31Kc_9Lx7Mtzpkw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*t61j_8I31Kc_9Lx7Mtzpkw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*t61j_8I31Kc_9Lx7Mtzpkw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*t61j_8I31Kc_9Lx7Mtzpkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*t61j_8I31Kc_9Lx7Mtzpkw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*t61j_8I31Kc_9Lx7Mtzpkw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="613" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 10— Partial Data Collection</figcaption></figure><h1 id="5989" class="nw nx gu bf ny nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot bk">Office 365 Example — Full Collection with SharePoint Token</h1><ol class=""><li id="34fd" class="mw mx gu my b mz ou nb nc nd ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt qb pb pc bk">Inspect</li></ol><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPfo-EJGYYqLjSgRw9p3uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QPfo-EJGYYqLjSgRw9p3uQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QPfo-EJGYYqLjSgRw9p3uQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QPfo-EJGYYqLjSgRw9p3uQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QPfo-EJGYYqLjSgRw9p3uQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QPfo-EJGYYqLjSgRw9p3uQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QPfo-EJGYYqLjSgRw9p3uQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*QPfo-EJGYYqLjSgRw9p3uQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="541" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 11— Web Inspection and Network Filtering</figcaption></figure><p id="79d2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">2. Authenticate</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Z5nfv_Btv7Y9aV5c8Mo-lw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="434" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 12— Office 365 Authentication for Testing Account</figcaption></figure><p id="b197" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">3. Obtain Tokens</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Rw1dw8xJw1Qgvk-tlWzN-A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="539" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 13— Access and Refresh Tokens for SPECTERDEV.SHAREPOINT.COM</figcaption></figure><p id="2bac" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">4. Note Client ID</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u2AcLG2mWtPsSRqX_XejLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*u2AcLG2mWtPsSRqX_XejLw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*u2AcLG2mWtPsSRqX_XejLw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*u2AcLG2mWtPsSRqX_XejLw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*u2AcLG2mWtPsSRqX_XejLw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*u2AcLG2mWtPsSRqX_XejLw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*u2AcLG2mWtPsSRqX_XejLw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*u2AcLG2mWtPsSRqX_XejLw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="490" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 14— Client ID in Request Payload</figcaption></figure><p id="1aab" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">5. Authenticate with ROADRecon</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33erbZaM0M4I772vJ_bDYA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*33erbZaM0M4I772vJ_bDYA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*33erbZaM0M4I772vJ_bDYA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*33erbZaM0M4I772vJ_bDYA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*33erbZaM0M4I772vJ_bDYA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*33erbZaM0M4I772vJ_bDYA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*33erbZaM0M4I772vJ_bDYA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*33erbZaM0M4I772vJ_bDYA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="135" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 15— Successful Authentication with Refresh Token</figcaption></figure><p id="baff" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">6. Gather</p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57SfMFww2BeCzqe7YYKJsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*57SfMFww2BeCzqe7YYKJsw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*57SfMFww2BeCzqe7YYKJsw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*57SfMFww2BeCzqe7YYKJsw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*57SfMFww2BeCzqe7YYKJsw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*57SfMFww2BeCzqe7YYKJsw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*57SfMFww2BeCzqe7YYKJsw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*57SfMFww2BeCzqe7YYKJsw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="175" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 16— Successful Tenant Enumeration</figcaption></figure><p id="10b5" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">7. Review — roadrecon gui and browse to <em class="nu">HTTP://127.0.0.1:5000</em></p><figure class="pl pm pn po pp pq pi pj paragraph-image"><div role="button" tabindex="0" class="pr ps fj pt bh pu"><div class="pi pj pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfii2pEieS3z2SbKHkahMw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*mfii2pEieS3z2SbKHkahMw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*mfii2pEieS3z2SbKHkahMw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*mfii2pEieS3z2SbKHkahMw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*mfii2pEieS3z2SbKHkahMw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*mfii2pEieS3z2SbKHkahMw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*mfii2pEieS3z2SbKHkahMw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*mfii2pEieS3z2SbKHkahMw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pv c" width="700" height="616" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pw ff px pi pj py pz bf b bg z du">Figure 17 — Full Data Collection</figcaption></figure></div></div></div><div class="ab cb qp qq qr qs" role="separator"><span class="qt by bm qu qv qw"></span><span class="qt by bm qu qv qw"></span><span class="qt by bm qu qv"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="f20b" class="nw nx gu bf ny nz qx ob oc od qy of og oh qz oj ok ol ra on oo op rb or os ot bk">About</h1><p id="594c" class="pw-post-body-paragraph mw mx gu my b mz ou nb nc nd ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt gn bk">Lance Cain is a Senior Consultant in Adversary Simulation at SpecterOps Inc. He has over eight years of experience in information technology with six of those focused on Red Teaming and Penetration Testing. Lance formerly served as the Engineering Cell Lead of the Marine Corps’ Red Team tasked with payload and command and control (C2) channel development. He now performs a variety of security assessments for SpecterOps clients and specializes in cloud and macOS technologies.</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rc rd ab ja"><div class="re ab"><a class="rf ay am ao" href="https://medium.com/tag/azure?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><div class="rg fj cx rh ge ri rj bf b bg z bk rk">Azure</div></a></div><div class="re ab"><a class="rf ay am ao" href="https://medium.com/tag/red-team-methodology?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><div class="rg fj cx rh ge ri rj bf b bg z bk rk">Red Team Methodology</div></a></div><div class="re ab"><a class="rf ay am ao" href="https://medium.com/tag/cybersecurity?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><div class="rg fj cx rh ge ri rj bf b bg z bk rk">Cybersecurity</div></a></div><div class="re ab"><a class="rf ay am ao" href="https://medium.com/tag/entra-id?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><div class="rg fj cx rh ge ri rj bf b bg z bk rk">Entra Id</div></a></div></div></div></div><div class="l"></div><footer class="rl qq rm rn ro ab q rp ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rq"><div class="ab q kv"><div class="rr l"><span class="l rs rt ru e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F8c38dc77e409&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=---footer_actions--8c38dc77e409---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f rv rw"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fspecter-ops-posts%2F8c38dc77e409&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=---footer_actions--8c38dc77e409---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qw l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F8c38dc77e409&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;source=---footer_actions--8c38dc77e409---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qw l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rx ry rz sa sb l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sc bh r sd"></div><div class="se l"><div class="ab sf sg sh iz iy"><div class="si sj sk sl sm sn so sp sq sr ab cp"><div class="h k"><a href="https://posts.specterops.io/?source=post_page---post_publication_info--8c38dc77e409--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Posts By SpecterOps Team Members" class="ss ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*D-FDlfkqivRBQZoESrwtqw.png" width="48" height="48" loading="lazy"/><div class="ss l ic ib fs n fr st"></div></div></a></div><div class="j i d"><a href="https://posts.specterops.io/?source=post_page---post_publication_info--8c38dc77e409--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="Posts By SpecterOps Team Members" class="ss sv su cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*D-FDlfkqivRBQZoESrwtqw.png" width="64" height="64" loading="lazy"/><div class="ss l su sv fs n fr st"></div></div></a></div><div class="j i d sw ix"><div class="ab"><span><a class="bf b bg z sx rg sy sz ta tb tc ev ew td te tf fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;collection=Posts+By+SpecterOps+Team+Members&amp;collectionId=f05f8696e3cc&amp;source=post_page---post_publication_info--8c38dc77e409---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab co tg"><div class="th ti tj tk tl l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://posts.specterops.io/?source=post_page---post_publication_info--8c38dc77e409--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf tn to tp tq tr ts tt nh tu tv nl tw tx np ty tz bk"><span class="gn tm">Published in <!-- -->Posts By SpecterOps Team Members</span></h2></a><div class="re ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/followers?source=post_page---post_publication_info--8c38dc77e409--------------------------------">4.8K Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/adfs-entra-lab-with-ludus-9bffbc51673f?source=post_page---post_publication_info--8c38dc77e409--------------------------------">Last published <!-- -->6 days ago</a></div></div><div class="ua l"><p class="bf b bg z bk"><span class="gn">Posts from SpecterOps team members on various topics relating information security</span></p></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z sx rg sy sz ta tb tc ev ew td te tf fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fspecter-ops-posts&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;collection=Posts+By+SpecterOps+Team+Members&amp;collectionId=f05f8696e3cc&amp;source=post_page---post_publication_info--8c38dc77e409---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div></div><div class="ab sf sg sh iz iy"><div class="si sj sk sl sm sn so sp sq sr ab cp"><div class="h k"><a tabindex="0" href="https://medium.com/@lbcain18?source=post_page---post_author_info--8c38dc77e409--------------------------------" rel="noopener follow"><div class="l fj"><img alt="Lance B. Cain" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/0*v0d00TR4cFqVeADo" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay st"></div></div></a></div><div class="j i d"><a tabindex="0" href="https://medium.com/@lbcain18?source=post_page---post_author_info--8c38dc77e409--------------------------------" rel="noopener follow"><div class="l fj"><img alt="Lance B. Cain" class="l fd by su sv cx" src="https://miro.medium.com/v2/resize:fill:128:128/0*v0d00TR4cFqVeADo" width="64" height="64" loading="lazy"/><div class="fr by l su sv fs n ay st"></div></div></a></div><div class="j i d sw ix"><div class="ab"><span><a class="bf b bg z sx rg sy sz ta tb tc ev ew td te tf fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F040c3e09d079&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=post_page-040c3e09d079--post_author_info--8c38dc77e409---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab co tg"><div class="th ti tj tk tl l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/@lbcain18?source=post_page---post_author_info--8c38dc77e409--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf tn to tp tq tr ts tt nh tu tv nl tw tx np ty tz bk"><span class="gn tm">Written by <!-- -->Lance B. Cain</span></h2></a><div class="re ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@lbcain18/followers?source=post_page---post_author_info--8c38dc77e409--------------------------------" rel="noopener follow">19 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" href="https://medium.com/@lbcain18/following?source=post_page---post_author_info--8c38dc77e409--------------------------------" rel="noopener follow">1 Following</a></div></div><div class="ua l"></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z sx rg sy sz ta tb tc ev ew td te tf fa fb fc fd bm fe ff" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F040c3e09d079&amp;operation=register&amp;redirect=https%3A%2F%2Fposts.specterops.io%2Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409&amp;user=Lance+B.+Cain&amp;userId=040c3e09d079&amp;source=post_page-040c3e09d079--post_author_info--8c38dc77e409---------------------follow_profile-----------" rel="noopener follow">Follow</a></span></div></div></div></div></div></div><div class="ub l"><div class="sc bh r uc ud ue uf ug"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf tn nz ob oc od of og oh oj ok ol on oo op or os bk">No responses yet</h2><div class="ab uh"><div><div class="bm" aria-hidden="false"><a class="ui uj" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--8c38dc77e409--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="uk ul um un uo l"></div></div></div></div><div class="up uq ur us ut l bx"><div class="h k j"><div class="sc bh uu uv"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uw ab kv ja"><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="ux uy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----8c38dc77e409--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241218-235912-1e3024e5b3"</script><script>window.__GRAPHQL_URI__ = "https://posts.specterops.io/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-8c38dc77e409","user-040c3e09d079","collection-f05f8696e3cc"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"f05f8696e3cc","explicit":true},"viewerIsBot":false},"debug":{"requestId":"6f54fec4-e3a6-4293-ac73-e77968fbe1b6","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-a9e1922be5b814d76e6434ecc137be32-5a43eb305e446e21-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fposts.specterops.io\u002Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409","host":"posts.specterops.io","hostname":"posts.specterops.io","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"?source=rss----f05f8696e3cc---4"},"config":{"nodeEnv":"production","version":"main-20241218-235912-1e3024e5b3","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241218-235912-1e3024e5b3","commit":"1e3024e5b30a200d8e607e363a93175b656225c2"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_nia_v01","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trust_service_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ranker_v10","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_publish_permission_check","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_cart_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_paywall_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_publication_hierarchy_web","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sms_verification_for_publish","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_input","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"goliath_externalsearch_enable_comment_deindexation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber","value":2}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_native","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cancellation_discount_v1_gate","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"num_post_bottom_responses_to_show","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_explicit_signals_updated_post_previews","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber","value":1000}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pub_featuring","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_winback_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_gift_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"posts.specterops.io\"})":{"__ref":"Collection:f05f8696e3cc"},"postResult({\"id\":\"8c38dc77e409\"})":{"__ref":"Post:8c38dc77e409"}},"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png":{"__typename":"ImageMetadata","id":"1*D-FDlfkqivRBQZoESrwtqw.png"},"Collection:f05f8696e3cc":{"__typename":"Collection","id":"f05f8696e3cc","favicon":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFF3F1FF","point":0},{"__typename":"ColorPoint","color":"#FFF1EFFF","point":0.1},{"__typename":"ColorPoint","color":"#FFEEEDFF","point":0.2},{"__typename":"ColorPoint","color":"#FFECEBFF","point":0.3},{"__typename":"ColorPoint","color":"#FFEAE9FF","point":0.4},{"__typename":"ColorPoint","color":"#FFE8E7FF","point":0.5},{"__typename":"ColorPoint","color":"#FFE5E4FF","point":0.6},{"__typename":"ColorPoint","color":"#FFE3E2FF","point":0.7},{"__typename":"ColorPoint","color":"#FFE1E0FF","point":0.8},{"__typename":"ColorPoint","color":"#FFDEDEFF","point":0.9},{"__typename":"ColorPoint","color":"#FFDCDCFF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF8080B7","point":0},{"__typename":"ColorPoint","color":"#FF7777A8","point":0.1},{"__typename":"ColorPoint","color":"#FF6E6E9A","point":0.2},{"__typename":"ColorPoint","color":"#FF65658B","point":0.3},{"__typename":"ColorPoint","color":"#FF5C5B7D","point":0.4},{"__typename":"ColorPoint","color":"#FF52526E","point":0.5},{"__typename":"ColorPoint","color":"#FF484860","point":0.6},{"__typename":"ColorPoint","color":"#FF3D3D51","point":0.7},{"__typename":"ColorPoint","color":"#FF323241","point":0.8},{"__typename":"ColorPoint","color":"#FF262632","point":0.9},{"__typename":"ColorPoint","color":"#FF191921","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF1E184B","colorPoints":[{"__typename":"ColorPoint","color":"#FF1E184B","point":0},{"__typename":"ColorPoint","color":"#FF3A3866","point":0.1},{"__typename":"ColorPoint","color":"#FF54537D","point":0.2},{"__typename":"ColorPoint","color":"#FF6C6C93","point":0.3},{"__typename":"ColorPoint","color":"#FF8383A6","point":0.4},{"__typename":"ColorPoint","color":"#FF9999B9","point":0.5},{"__typename":"ColorPoint","color":"#FFAEAECA","point":0.6},{"__typename":"ColorPoint","color":"#FFC3C2DB","point":0.7},{"__typename":"ColorPoint","color":"#FFD8D6EB","point":0.8},{"__typename":"ColorPoint","color":"#FFEBEAFA","point":0.9},{"__typename":"ColorPoint","color":"#FFFFFDFF","point":1}]}},"domain":"posts.specterops.io","slug":"specter-ops-posts","googleAnalyticsId":"UA-102239211-2","name":"Posts By SpecterOps Team Members","subscriberCount":4845,"description":"Posts from SpecterOps team members on various topics relating information security","avatar":{"__ref":"ImageMetadata:1*D-FDlfkqivRBQZoESrwtqw.png"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:9bffbc51673f"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_543485cc01cb"},"twitterUsername":"specterops","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg"}},"User:297bdc3a9260":{"__typename":"User","id":"297bdc3a9260","customDomainState":null,"hasSubdomain":false,"username":"beyviel.david"},"Post:9bffbc51673f":{"__typename":"Post","id":"9bffbc51673f","firstPublishedAt":1734622184551,"creator":{"__ref":"User:297bdc3a9260"},"collection":{"__ref":"Collection:f05f8696e3cc"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fadfs-entra-lab-with-ludus-9bffbc51673f","sequence":null,"uniqueSlug":"adfs-entra-lab-with-ludus-9bffbc51673f"},"LinkedAccounts:040c3e09d079":{"__typename":"LinkedAccounts","mastodon":null,"id":"040c3e09d079"},"User:040c3e09d079":{"__typename":"User","id":"040c3e09d079","linkedAccounts":{"__ref":"LinkedAccounts:040c3e09d079"},"isSuspended":false,"name":"Lance B. Cain","imageId":"0*v0d00TR4cFqVeADo","customDomainState":null,"hasSubdomain":false,"username":"lbcain18","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":19,"followingCount":1,"collectionFollowingCount":0},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:040c3e09d079-viewerId:lo_543485cc01cb"},"twitterScreenName":""},"Paragraph:1cabbfd3d97c_0":{"__typename":"Paragraph","id":"1cabbfd3d97c_0","name":"fda3","type":"H3","href":null,"layout":null,"metadata":null,"text":"SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_1":{"__typename":"Paragraph","id":"1cabbfd3d97c_1","name":"2e06","type":"P","href":null,"layout":null,"metadata":null,"text":"Author: Lance B. Cain","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":8,"end":21,"href":null,"anchorType":"USER","userId":"040c3e09d079","linkMetadata":null},{"__typename":"Markup","type":"EM","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_2":{"__typename":"Paragraph","id":"1cabbfd3d97c_2","name":"bef6","type":"H3","href":null,"layout":null,"metadata":null,"text":"Overview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_3":{"__typename":"Paragraph","id":"1cabbfd3d97c_3","name":"f42a","type":"P","href":null,"layout":null,"metadata":null,"text":"Microsoft Azure is a leading cloud provider offering technology solutions to companies, governments, and other organizations around the globe. As such, many entities have begun adopting Azure for their technology needs to include identity, authentication, storage, application management, and web services. One of the most common methods for organizations to begin experimenting with and adopting Azure is by deploying web applications and an increasingly popular method for creating web applications is by designing Single-Page Applications (SPAs). Katie Lawson of bloomreach.com defines SPAs as, “a website or web application that dynamically rewrites a current web page with new data from the web server, instead of the default method of a web browser loading entire new pages”. SPAs typically utilize JavaScript integrations with API calls to dynamically update for a seamless user experience. Microsoft has multiple walkthroughs, guides, and documentation to aid organizations in deploying SPAs on Azure:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":566,"end":580,"href":"https:\u002F\u002Fwww.bloomreach.com\u002Fen\u002Fblog\u002Fwhat-is-a-single-page-application","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_4":{"__typename":"Paragraph","id":"1cabbfd3d97c_4","name":"bd8d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Single-page application (SPA) documentation — https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity-platform\u002Findex-spa","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":46,"end":113,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity-platform\u002Findex-spa","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_5":{"__typename":"Paragraph","id":"1cabbfd3d97c_5","name":"7035","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Single-page application: App registration — https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity-platform\u002Fscenario-spa-app-registration","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":44,"end":131,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity-platform\u002Fscenario-spa-app-registration","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_6":{"__typename":"Paragraph","id":"1cabbfd3d97c_6","name":"8b2e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Configure authentication in a sample single-page application by using Azure AD B2C — https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fazure\u002Factive-directory-b2c\u002Fconfigure-authentication-sample-spa-app","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":85,"end":185,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fazure\u002Factive-directory-b2c\u002Fconfigure-authentication-sample-spa-app","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_7":{"__typename":"Paragraph","id":"1cabbfd3d97c_7","name":"6a67","type":"P","href":null,"layout":null,"metadata":null,"text":"As a result, there are many new publicly hosted SPAs that communicate with Azure backend resources.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_8":{"__typename":"Paragraph","id":"1cabbfd3d97c_8","name":"b951","type":"P","href":null,"layout":null,"metadata":null,"text":"This blog post is intended to share insights learned from a prior security assessment about the attack surface of Single-Page Applications integrated with Azure, aid technology professionals in securing their Azure environments, and serve as a guide for enumerating Azure tenants using the additions of the pull request I submitted to Dirk-Jan’s ROADTools repository. This blog is not a comprehensive analysis of every SPA hosted on Azure, so your mileage may vary. Due to the widespread adoption of Microsoft’s Office products and web integrations for Azure, I will focus on two popular SPAs that Microsoft offers (i.e., WWW.OFFICE.COM and PORTAL.AZURE.COM); however, the workflow translates to many other SPAs as well.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":346,"end":355,"href":"https:\u002F\u002Fgithub.com\u002Fdirkjanm\u002FROADtools","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":622,"end":636,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":641,"end":657,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_9":{"__typename":"Paragraph","id":"1cabbfd3d97c_9","name":"9d1d","type":"H3","href":null,"layout":null,"metadata":null,"text":"A Brief Origin Story","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_10":{"__typename":"Paragraph","id":"1cabbfd3d97c_10","name":"dbe0","type":"P","href":null,"layout":null,"metadata":null,"text":"My team and I were working on a collaborative cloud assessment for one of our clients targeting their Azure tenant. We were tasked with identifying methods of escalating privileges, assisting defenders in improving detections, and documenting attack paths in the client Azure environment using a compromised non-privileged user account on a Windows Virtual Desktop Image (VDI). We began by enumerating the available applications, Azure resources, Microsoft technologies, and client subscriptions. During the assessment, we learned that the client Azure environment was hardened with enforced multi-factor authentication (MFA), allow-listed MFA conditional access policies (CAPs), administrator restrictions on internal and external application enrollments, administrator approval for external invitations, continuous access evaluation, blocked access to Entra ID in the Azure portal, browser extension host security checks, blocked command-line interface (CLI) and PowerShell access, and time limitations on issued tokens forcing expiration after one hour.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":806,"end":834,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity\u002Fconditional-access\u002Fconcept-continuous-access-evaluation","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_11":{"__typename":"Paragraph","id":"1cabbfd3d97c_11","name":"0cd4","type":"P","href":null,"layout":null,"metadata":null,"text":"The defensive configurations in the client environment impeded our work obtaining access and refresh tokens to enumerate the target tenant. The team began looking at the resources our user account had access to. We had successfully authenticated as the non-privileged user to the Azure portal and administrator pre-approved Microsoft Office web applications like Excel or Word on HTTPS:\u002F\u002FWWW.MICROSOFT365.COM. Within the Azure portal, we discovered that the user account had access to the Azure cloud shell which the team used to obtain an access token using the built-in PowerShell cmdlet Get-AzAccessToken and initiate some cursory enumeration.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":590,"end":607,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fpowershell\u002Fmodule\u002Faz.accounts\u002Fget-azaccesstoken?view=azps-13.0.0","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":380,"end":408,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_12":{"__typename":"Paragraph","id":"1cabbfd3d97c_12","name":"a771","type":"P","href":null,"layout":null,"metadata":null,"text":"Pro-Tip: If the cloud shell is available, it is possible to install pip Python modules, including ROADTools, in the Bash shell.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_3xI_BUK4G5UyBk59pRDuw.png":{"__typename":"ImageMetadata","id":"1*_3xI_BUK4G5UyBk59pRDuw.png","originalHeight":728,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_13":{"__typename":"Paragraph","id":"1cabbfd3d97c_13","name":"1daa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_3xI_BUK4G5UyBk59pRDuw.png"},"text":"Figure 1 — Installing ROADTools in the Azure Cloud Shell","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_14":{"__typename":"Paragraph","id":"1cabbfd3d97c_14","name":"da79","type":"P","href":null,"layout":null,"metadata":null,"text":"The team started collections to enumerate the client tenant using ROADTools and AzureHound with our initial access token; however, an hour later, we discovered that the tools had failed when the acquired token expired prior to completing their tasks. With the knowledge that the client tenant was so large that automated enumeration would exceed the one-hour lifetime for access tokens, we began looking into methods to update the access token for collections. After some research, we learned one of the likely intentional limitations of Get-AzAccessTokens for the Azure cloud shell that it would obtain access tokens, but it would not return a refresh token. My teammates started working on methods to script out obtaining a new access token in the cloud console, meanwhile I began looking at the access we had to authorized Microsoft web applications.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_15":{"__typename":"Paragraph","id":"1cabbfd3d97c_15","name":"8250","type":"P","href":null,"layout":null,"metadata":null,"text":"While investigating the Azure portal, I remembered something that Andy Robbins mentioned at SpecterOps’ Azure Security Fundamentals training; specifically, that the Azure portal was essentially a web application frontend which communicates with the Azure Graph APIs. Thinking about the ROADTools implemented authentication flow to obtain tokens with a Selenium browser; despite not being an option during the assessment due to the required extensions, I opened the inspector panel in the VDI client Google Chrome web browser to look for any type of token exchanges that occurred during authentication. While reviewing the network traffic in the inspector panel, I observed some requests named “token”. I discovered when filtering and inspecting traffic for the term “token” that there were multiple access and refresh tokens contained in the request payloads for resources like MANAGEMENT.CORE.WINDOWS.NET, GRAPH.MICROSOFT.COM, and most interesting GRAPH.MICROSOFT.NET. The access tokens for the client environment still had the one-hour expiration limit, but the refresh tokens were valid for up to four hours. I also discovered that upon selecting the payload tab the client-id used for the request was also captured.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":66,"end":78,"href":null,"anchorType":"USER","userId":"b9c2df322eaf","linkMetadata":null},{"__typename":"Markup","type":"A","start":104,"end":131,"href":"https:\u002F\u002Fspecterops.io\u002Fazure-security-fundamentals\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":878,"end":905,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":907,"end":926,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":949,"end":968,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nI1tomeetNl9LEP8WrYtnQ.png":{"__typename":"ImageMetadata","id":"1*nI1tomeetNl9LEP8WrYtnQ.png","originalHeight":616,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_16":{"__typename":"Paragraph","id":"1cabbfd3d97c_16","name":"6644","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nI1tomeetNl9LEP8WrYtnQ.png"},"text":"Figure 2— Access and Refresh Tokens in SPA Network Traffic","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_17":{"__typename":"Paragraph","id":"1cabbfd3d97c_17","name":"fc7d","type":"P","href":null,"layout":null,"metadata":null,"text":"Excited to have obtained a refresh token for our client environment, I attempted authentication over a proxied connection to the VDI with ROADTools using the refresh token, which resulted in the below error response from Azure regarding cross-origin requests.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*9HTxb2D7A29omNjmLeg4VA.png":{"__typename":"ImageMetadata","id":"1*9HTxb2D7A29omNjmLeg4VA.png","originalHeight":130,"originalWidth":936,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_18":{"__typename":"Paragraph","id":"1cabbfd3d97c_18","name":"a41e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9HTxb2D7A29omNjmLeg4VA.png"},"text":"Figure 3— Cross-Origin Error Response","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_19":{"__typename":"Paragraph","id":"1cabbfd3d97c_19","name":"72cb","type":"P","href":null,"layout":null,"metadata":null,"text":"I began researching the error message and quickly stumbled upon this Stack Overflow post where one of CajunCoding’s comments referenced a Microsoft page stating, “Microsoft identity platform returns an error if you attempt to use a spa redirect URI without an Origin header.”","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":84,"end":88,"href":"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F61231144\u002Fgetting-access-tokens-from-postman-tokens-issued-for-the-single-page-applicati","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_20":{"__typename":"Paragraph","id":"1cabbfd3d97c_20","name":"0c86","type":"P","href":null,"layout":null,"metadata":null,"text":"Upon reviewing the Microsoft documentation, I spent the next hour issuing multiple web API requests to HTTPS:\u002F\u002FLOGIN.MICROSOFTONLINE.COM\u002F{TENANT}\u002FOAUTH2\u002FV2.0\u002FAUTHORIZE using Burp Suite and curl commands with varying origin HTTP headers. An access token was eventually returned for the supplied refresh token when entering the originating application URL in the request origin header. Upon successfully obtaining a new access token by hand, I updated my local instance of ROADTools to accommodate supplying an origin value when performing authentication with refresh tokens, which resulted in the addition of the origin parameter. Afterwards, my team and I successfully enumerated the client tenant using the available SPA refresh tokens and continued with the assessment. Our client was pleased to learn about the attack path where users with granted access to SPAs like the Azure Portal and Microsoft Online Office Applications could potentially obtain new tokens to enumerate their Azure tenant.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":19,"end":42,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Fentra\u002Fidentity-platform\u002Fv2-oauth2-auth-code-flow#redirect-uris-for-single-page-apps-spas","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":103,"end":167,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_21":{"__typename":"Paragraph","id":"1cabbfd3d97c_21","name":"28ee","type":"H3","href":null,"layout":null,"metadata":null,"text":"SPA Token Enumeration Workflow","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_22":{"__typename":"Paragraph","id":"1cabbfd3d97c_22","name":"97cc","type":"P","href":null,"layout":null,"metadata":null,"text":"Now with the origin argument added to the latest version of ROADTools, the most basic process of using SPA tokens to enumerate an Azure tenant is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_23":{"__typename":"Paragraph","id":"1cabbfd3d97c_23","name":"178b","type":"OLI","href":null,"layout":null,"metadata":null,"text":"On an Azure client workstation, open the inspector panel in a web browser and filter network traffic for “tokens”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_24":{"__typename":"Paragraph","id":"1cabbfd3d97c_24","name":"cfce","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Authenticate to a SPA or re-open an existing browser session to an authenticated SPA","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_25":{"__typename":"Paragraph","id":"1cabbfd3d97c_25","name":"2bed","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: Take notice of the origin URL","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_26":{"__typename":"Paragraph","id":"1cabbfd3d97c_26","name":"237e","type":"P","href":null,"layout":null,"metadata":null,"text":"3. View exchanged tokens to obtain the refresh token contained in one of the MICROSOFT.NET, MICROSOFT.COM, or other Microsoft integrated resource token requests","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":77,"end":90,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":92,"end":105,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_27":{"__typename":"Paragraph","id":"1cabbfd3d97c_27","name":"4a2c","type":"P","href":null,"layout":null,"metadata":null,"text":"Pro-Tip: For small tenants or tenants without short token expirations, access tokens for GRAPH.MICROSOFT.NET can be used from the browser instead of refresh tokens.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":89,"end":108,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_28":{"__typename":"Paragraph","id":"1cabbfd3d97c_28","name":"eaa3","type":"P","href":null,"layout":null,"metadata":null,"text":"Pro-Tip: Some resource tokens have been found to provide only partial collections and will generate HTTP 403 errors like MANAGEMENT.CORE.WINDOWS.NET as demonstrated in the examples. I recommend targeting GRAPH.WINDOWS.NET or SharePoint resource tokens which have yielded the best results","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":121,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":204,"end":221,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_29":{"__typename":"Paragraph","id":"1cabbfd3d97c_29","name":"a291","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Take note of the application client-id used to request tokens","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_30":{"__typename":"Paragraph","id":"1cabbfd3d97c_30","name":"c9e6","type":"P","href":null,"layout":null,"metadata":null,"text":"Pro-Tip: For first-party Microsoft Azure applications like HTTPS:\u002F\u002FPORTAL.AZURE.COM, bookmark this page to quickly lookup the client-id: https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Ftroubleshoot\u002Fentra\u002Fentra-id\u002Fgovernance\u002Fverify-first-party-apps-sign-in#application-ids-of-commonly-used-microsoft-applications","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":137,"end":297,"href":"https:\u002F\u002Flearn.microsoft.com\u002Fen-us\u002Ftroubleshoot\u002Fentra\u002Fentra-id\u002Fgovernance\u002Fverify-first-party-apps-sign-in#application-ids-of-commonly-used-microsoft-applications","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":59,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_31":{"__typename":"Paragraph","id":"1cabbfd3d97c_31","name":"462b","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Authenticate to the Microsoft graph API by supplying all the captured values to ROADTools","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_32":{"__typename":"Paragraph","id":"1cabbfd3d97c_32","name":"7cc3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"roadrecon auth -c \u003CClient-ID\u003E --origin \u003CSPA Base URL\u003E --refresh-token \u003CBrowser Refresh Token\u003E","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_33":{"__typename":"Paragraph","id":"1cabbfd3d97c_33","name":"e68a","type":"P","href":null,"layout":null,"metadata":null,"text":"Pro-Tip: If Azure continuous access evaluation is enforced, execute the ROADTools authentication from the original workstation or SOCKs proxy the request through the workstation.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_34":{"__typename":"Paragraph","id":"1cabbfd3d97c_34","name":"c24e","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Execute your collection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_35":{"__typename":"Paragraph","id":"1cabbfd3d97c_35","name":"29f8","type":"PRE","href":null,"layout":null,"metadata":null,"text":"roadrecon gather","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_36":{"__typename":"Paragraph","id":"1cabbfd3d97c_36","name":"d823","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Review the information","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_37":{"__typename":"Paragraph","id":"1cabbfd3d97c_37","name":"bfa9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"roadrecon gui","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_38":{"__typename":"Paragraph","id":"1cabbfd3d97c_38","name":"8ea3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Azure Portal Example — Partial Collection with MANAGEMENT.CORE.WINDOWS.NET Token","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_39":{"__typename":"Paragraph","id":"1cabbfd3d97c_39","name":"dda2","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Inspect","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FPu8UffnM723yTIyYk-Bsw.png":{"__typename":"ImageMetadata","id":"1*FPu8UffnM723yTIyYk-Bsw.png","originalHeight":708,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_40":{"__typename":"Paragraph","id":"1cabbfd3d97c_40","name":"3fbf","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FPu8UffnM723yTIyYk-Bsw.png"},"text":"Figure 4— Web Inspection and Network Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_41":{"__typename":"Paragraph","id":"1cabbfd3d97c_41","name":"f4e0","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Authenticate","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bdNjE0AAxP1DuwGyAlP67A.png":{"__typename":"ImageMetadata","id":"1*bdNjE0AAxP1DuwGyAlP67A.png","originalHeight":972,"originalWidth":936,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_42":{"__typename":"Paragraph","id":"1cabbfd3d97c_42","name":"97e5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*bdNjE0AAxP1DuwGyAlP67A.png"},"text":"Figure 5— Azure Portal Authentication to Testing Tenant","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_43":{"__typename":"Paragraph","id":"1cabbfd3d97c_43","name":"8442","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Obtain Tokens","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0CVF2r0ogN5hKiKQxyGPdg.png":{"__typename":"ImageMetadata","id":"1*0CVF2r0ogN5hKiKQxyGPdg.png","originalHeight":512,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_44":{"__typename":"Paragraph","id":"1cabbfd3d97c_44","name":"1213","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0CVF2r0ogN5hKiKQxyGPdg.png"},"text":"Figure 6— Access and Refresh Tokens for MANAGEMENT.CORE.WINDOWS.NET","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_45":{"__typename":"Paragraph","id":"1cabbfd3d97c_45","name":"0c9a","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Note Client ID","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5XLuOxmwR-O9EWvTAtNfHg.png":{"__typename":"ImageMetadata","id":"1*5XLuOxmwR-O9EWvTAtNfHg.png","originalHeight":584,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_46":{"__typename":"Paragraph","id":"1cabbfd3d97c_46","name":"f74e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5XLuOxmwR-O9EWvTAtNfHg.png"},"text":"Figure 7— Client ID in Request Payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_47":{"__typename":"Paragraph","id":"1cabbfd3d97c_47","name":"9ec7","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Authenticate with ROADRecon","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Tio2IwbauQWsSR44GfQZVg.png":{"__typename":"ImageMetadata","id":"1*Tio2IwbauQWsSR44GfQZVg.png","originalHeight":138,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_48":{"__typename":"Paragraph","id":"1cabbfd3d97c_48","name":"bc64","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Tio2IwbauQWsSR44GfQZVg.png"},"text":"Figure 8— Successful Authentication with Refresh Token","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_49":{"__typename":"Paragraph","id":"1cabbfd3d97c_49","name":"3d42","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Gather — 403 Errors = Partial Collection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Y0uh04mcyo8qXYOGl2evUg.png":{"__typename":"ImageMetadata","id":"1*Y0uh04mcyo8qXYOGl2evUg.png","originalHeight":516,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_50":{"__typename":"Paragraph","id":"1cabbfd3d97c_50","name":"25f6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Y0uh04mcyo8qXYOGl2evUg.png"},"text":"Figure 9— Gather with HTTP 403 Errors","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_51":{"__typename":"Paragraph","id":"1cabbfd3d97c_51","name":"e1de","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Review — roadrecon gui and browse to HTTP:\u002F\u002F127.0.0.1:5000","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":40,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*t61j_8I31Kc_9Lx7Mtzpkw.png":{"__typename":"ImageMetadata","id":"1*t61j_8I31Kc_9Lx7Mtzpkw.png","originalHeight":822,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_52":{"__typename":"Paragraph","id":"1cabbfd3d97c_52","name":"5311","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*t61j_8I31Kc_9Lx7Mtzpkw.png"},"text":"Figure 10— Partial Data Collection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_53":{"__typename":"Paragraph","id":"1cabbfd3d97c_53","name":"5989","type":"H3","href":null,"layout":null,"metadata":null,"text":"Office 365 Example — Full Collection with SharePoint Token","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_54":{"__typename":"Paragraph","id":"1cabbfd3d97c_54","name":"34fd","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Inspect","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QPfo-EJGYYqLjSgRw9p3uQ.png":{"__typename":"ImageMetadata","id":"1*QPfo-EJGYYqLjSgRw9p3uQ.png","originalHeight":728,"originalWidth":942,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_55":{"__typename":"Paragraph","id":"1cabbfd3d97c_55","name":"bc05","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QPfo-EJGYYqLjSgRw9p3uQ.png"},"text":"Figure 11— Web Inspection and Network Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_56":{"__typename":"Paragraph","id":"1cabbfd3d97c_56","name":"79d2","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Authenticate","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Z5nfv_Btv7Y9aV5c8Mo-lw.png":{"__typename":"ImageMetadata","id":"1*Z5nfv_Btv7Y9aV5c8Mo-lw.png","originalHeight":586,"originalWidth":946,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_57":{"__typename":"Paragraph","id":"1cabbfd3d97c_57","name":"d384","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Z5nfv_Btv7Y9aV5c8Mo-lw.png"},"text":"Figure 12— Office 365 Authentication for Testing Account","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_58":{"__typename":"Paragraph","id":"1cabbfd3d97c_58","name":"b197","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Obtain Tokens","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Rw1dw8xJw1Qgvk-tlWzN-A.png":{"__typename":"ImageMetadata","id":"1*Rw1dw8xJw1Qgvk-tlWzN-A.png","originalHeight":752,"originalWidth":978,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_59":{"__typename":"Paragraph","id":"1cabbfd3d97c_59","name":"52e8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Rw1dw8xJw1Qgvk-tlWzN-A.png"},"text":"Figure 13— Access and Refresh Tokens for SPECTERDEV.SHAREPOINT.COM","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_60":{"__typename":"Paragraph","id":"1cabbfd3d97c_60","name":"2bac","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Note Client ID","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*u2AcLG2mWtPsSRqX_XejLw.png":{"__typename":"ImageMetadata","id":"1*u2AcLG2mWtPsSRqX_XejLw.png","originalHeight":660,"originalWidth":944,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_61":{"__typename":"Paragraph","id":"1cabbfd3d97c_61","name":"9d9c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*u2AcLG2mWtPsSRqX_XejLw.png"},"text":"Figure 14— Client ID in Request Payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_62":{"__typename":"Paragraph","id":"1cabbfd3d97c_62","name":"1aab","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Authenticate with ROADRecon","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*33erbZaM0M4I772vJ_bDYA.png":{"__typename":"ImageMetadata","id":"1*33erbZaM0M4I772vJ_bDYA.png","originalHeight":180,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_63":{"__typename":"Paragraph","id":"1cabbfd3d97c_63","name":"11fd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*33erbZaM0M4I772vJ_bDYA.png"},"text":"Figure 15— Successful Authentication with Refresh Token","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_64":{"__typename":"Paragraph","id":"1cabbfd3d97c_64","name":"baff","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Gather","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*57SfMFww2BeCzqe7YYKJsw.png":{"__typename":"ImageMetadata","id":"1*57SfMFww2BeCzqe7YYKJsw.png","originalHeight":234,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_65":{"__typename":"Paragraph","id":"1cabbfd3d97c_65","name":"6bcd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*57SfMFww2BeCzqe7YYKJsw.png"},"text":"Figure 16— Successful Tenant Enumeration","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_66":{"__typename":"Paragraph","id":"1cabbfd3d97c_66","name":"10b5","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Review — roadrecon gui and browse to HTTP:\u002F\u002F127.0.0.1:5000","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":40,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*mfii2pEieS3z2SbKHkahMw.png":{"__typename":"ImageMetadata","id":"1*mfii2pEieS3z2SbKHkahMw.png","originalHeight":826,"originalWidth":940,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:1cabbfd3d97c_67":{"__typename":"Paragraph","id":"1cabbfd3d97c_67","name":"a5ba","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*mfii2pEieS3z2SbKHkahMw.png"},"text":"Figure 17 — Full Data Collection","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_68":{"__typename":"Paragraph","id":"1cabbfd3d97c_68","name":"f20b","type":"H3","href":null,"layout":null,"metadata":null,"text":"About","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:1cabbfd3d97c_69":{"__typename":"Paragraph","id":"1cabbfd3d97c_69","name":"594c","type":"P","href":null,"layout":null,"metadata":null,"text":"Lance Cain is a Senior Consultant in Adversary Simulation at SpecterOps Inc. He has over eight years of experience in information technology with six of those focused on Red Teaming and Penetration Testing. Lance formerly served as the Engineering Cell Lead of the Marine Corps’ Red Team tasked with payload and command and control (C2) channel development. He now performs a variety of security assessments for SpecterOps clients and specializes in cloud and macOS technologies.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:f05f8696e3cc-viewerId:lo_543485cc01cb":{"__typename":"CollectionViewerEdge","id":"collectionId:f05f8696e3cc-viewerId:lo_543485cc01cb","isEditor":false,"isMuting":false},"UserViewerEdge:userId:040c3e09d079-viewerId:lo_543485cc01cb":{"__typename":"UserViewerEdge","id":"userId:040c3e09d079-viewerId:lo_543485cc01cb","isMuting":false},"ImageMetadata:1*s-5BWBr8XsgtIU5azKNhZQ.jpeg":{"__typename":"ImageMetadata","id":"1*s-5BWBr8XsgtIU5azKNhZQ.jpeg","originalWidth":2000,"originalHeight":805},"PostViewerEdge:postId:8c38dc77e409-viewerId:lo_543485cc01cb":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:8c38dc77e409-viewerId:lo_543485cc01cb"},"Tag:azure":{"__typename":"Tag","id":"azure","displayTitle":"Azure","normalizedTagSlug":"azure"},"Tag:red-team-methodology":{"__typename":"Tag","id":"red-team-methodology","displayTitle":"Red Team Methodology","normalizedTagSlug":"red-team-methodology"},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:entra-id":{"__typename":"Tag","id":"entra-id","displayTitle":"Entra Id","normalizedTagSlug":"entra-id"},"Post:8c38dc77e409":{"__typename":"Post","id":"8c38dc77e409","collection":{"__ref":"Collection:f05f8696e3cc"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e5ed","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"e443","startIndex":68,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:1cabbfd3d97c_0"},{"__ref":"Paragraph:1cabbfd3d97c_1"},{"__ref":"Paragraph:1cabbfd3d97c_2"},{"__ref":"Paragraph:1cabbfd3d97c_3"},{"__ref":"Paragraph:1cabbfd3d97c_4"},{"__ref":"Paragraph:1cabbfd3d97c_5"},{"__ref":"Paragraph:1cabbfd3d97c_6"},{"__ref":"Paragraph:1cabbfd3d97c_7"},{"__ref":"Paragraph:1cabbfd3d97c_8"},{"__ref":"Paragraph:1cabbfd3d97c_9"},{"__ref":"Paragraph:1cabbfd3d97c_10"},{"__ref":"Paragraph:1cabbfd3d97c_11"},{"__ref":"Paragraph:1cabbfd3d97c_12"},{"__ref":"Paragraph:1cabbfd3d97c_13"},{"__ref":"Paragraph:1cabbfd3d97c_14"},{"__ref":"Paragraph:1cabbfd3d97c_15"},{"__ref":"Paragraph:1cabbfd3d97c_16"},{"__ref":"Paragraph:1cabbfd3d97c_17"},{"__ref":"Paragraph:1cabbfd3d97c_18"},{"__ref":"Paragraph:1cabbfd3d97c_19"},{"__ref":"Paragraph:1cabbfd3d97c_20"},{"__ref":"Paragraph:1cabbfd3d97c_21"},{"__ref":"Paragraph:1cabbfd3d97c_22"},{"__ref":"Paragraph:1cabbfd3d97c_23"},{"__ref":"Paragraph:1cabbfd3d97c_24"},{"__ref":"Paragraph:1cabbfd3d97c_25"},{"__ref":"Paragraph:1cabbfd3d97c_26"},{"__ref":"Paragraph:1cabbfd3d97c_27"},{"__ref":"Paragraph:1cabbfd3d97c_28"},{"__ref":"Paragraph:1cabbfd3d97c_29"},{"__ref":"Paragraph:1cabbfd3d97c_30"},{"__ref":"Paragraph:1cabbfd3d97c_31"},{"__ref":"Paragraph:1cabbfd3d97c_32"},{"__ref":"Paragraph:1cabbfd3d97c_33"},{"__ref":"Paragraph:1cabbfd3d97c_34"},{"__ref":"Paragraph:1cabbfd3d97c_35"},{"__ref":"Paragraph:1cabbfd3d97c_36"},{"__ref":"Paragraph:1cabbfd3d97c_37"},{"__ref":"Paragraph:1cabbfd3d97c_38"},{"__ref":"Paragraph:1cabbfd3d97c_39"},{"__ref":"Paragraph:1cabbfd3d97c_40"},{"__ref":"Paragraph:1cabbfd3d97c_41"},{"__ref":"Paragraph:1cabbfd3d97c_42"},{"__ref":"Paragraph:1cabbfd3d97c_43"},{"__ref":"Paragraph:1cabbfd3d97c_44"},{"__ref":"Paragraph:1cabbfd3d97c_45"},{"__ref":"Paragraph:1cabbfd3d97c_46"},{"__ref":"Paragraph:1cabbfd3d97c_47"},{"__ref":"Paragraph:1cabbfd3d97c_48"},{"__ref":"Paragraph:1cabbfd3d97c_49"},{"__ref":"Paragraph:1cabbfd3d97c_50"},{"__ref":"Paragraph:1cabbfd3d97c_51"},{"__ref":"Paragraph:1cabbfd3d97c_52"},{"__ref":"Paragraph:1cabbfd3d97c_53"},{"__ref":"Paragraph:1cabbfd3d97c_54"},{"__ref":"Paragraph:1cabbfd3d97c_55"},{"__ref":"Paragraph:1cabbfd3d97c_56"},{"__ref":"Paragraph:1cabbfd3d97c_57"},{"__ref":"Paragraph:1cabbfd3d97c_58"},{"__ref":"Paragraph:1cabbfd3d97c_59"},{"__ref":"Paragraph:1cabbfd3d97c_60"},{"__ref":"Paragraph:1cabbfd3d97c_61"},{"__ref":"Paragraph:1cabbfd3d97c_62"},{"__ref":"Paragraph:1cabbfd3d97c_63"},{"__ref":"Paragraph:1cabbfd3d97c_64"},{"__ref":"Paragraph:1cabbfd3d97c_65"},{"__ref":"Paragraph:1cabbfd3d97c_66"},{"__ref":"Paragraph:1cabbfd3d97c_67"},{"__ref":"Paragraph:1cabbfd3d97c_68"},{"__ref":"Paragraph:1cabbfd3d97c_69"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:040c3e09d079"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fposts.specterops.io\u002Fspa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"1cabbfd3d97c","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":16,"allowResponses":true,"isLimitedState":false,"title":"SPA is for Single-Page Abuse! - Using Single-Page Application Tokens to Enumerate Azure","isSeries":false,"sequence":null,"uniqueSlug":"spa-is-for-single-page-abuse-using-single-page-application-tokens-to-enumerate-azure-8c38dc77e409","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1733853533256,"readingTime":7.535849056603773,"previewContent":{"__typename":"PreviewContent","subtitle":"Author: Lance B. Cain"},"previewImage":{"__ref":"ImageMetadata:1*nI1tomeetNl9LEP8WrYtnQ.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1733846660482,"updatedAt":1733853533256,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:8c38dc77e409-viewerId:lo_543485cc01cb"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:azure"},{"__ref":"Tag:red-team-methodology"},{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:entra-id"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1573,"layerCake":6,"responsesLocked":false}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script></body></html>