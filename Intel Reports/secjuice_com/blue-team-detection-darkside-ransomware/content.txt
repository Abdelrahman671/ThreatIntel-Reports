<!DOCTYPE html>
<html lang="en">
<head>

    <title>Blue Team Detection: DarkSide Ransomware</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <link rel="preload" as="style" href="/assets/built/screen.css?v=885aa4a822" />
    <link rel="preload" as="script" href="/assets/built/casper.js?v=885aa4a822" />

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=885aa4a822" />

    <meta name="description" content="Malware write-ups can be found in abundance online, they are often written from the point of view of a malware researcher who focuses on the deep internals of how malicious software works.">
    <link rel="icon" href="https://www.secjuice.com/content/images/size/w256h256/2018/05/secjuice_icon.png" type="image/png">
    <link rel="canonical" href="https://www.secjuice.com/blue-team-detection-darkside-ransomware/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Secjuice">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Blue Team Detection: DarkSide Ransomware">
    <meta property="og:description" content="Malware write-ups can be found in abundance online, they are often written from the point of view of a malware researcher who focuses on the deep internals of how malicious software works.">
    <meta property="og:url" content="https://www.secjuice.com/blue-team-detection-darkside-ransomware/">
    <meta property="og:image" content="https://www.secjuice.com/content/images/2021/06/09f975117899917.607ec2d4602cd.jpg">
    <meta property="article:published_time" content="2021-06-13T15:44:53.000Z">
    <meta property="article:modified_time" content="2021-06-15T13:29:22.000Z">
    
    <meta property="article:publisher" content="https://www.facebook.com/secjuice">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Blue Team Detection: DarkSide Ransomware">
    <meta name="twitter:description" content="Malware write-ups can be found in abundance online, they are often written from the point of view of a malware researcher who focuses on the deep internals of how malicious software works.">
    <meta name="twitter:url" content="https://www.secjuice.com/blue-team-detection-darkside-ransomware/">
    <meta name="twitter:image" content="https://www.secjuice.com/content/images/2021/06/09f975117899917.607ec2d4602cd.jpg">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Secprentice">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="">
    <meta name="twitter:site" content="@secjuice">
    <meta name="twitter:creator" content="@secprentice">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="928">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Secjuice",
        "url": "https://www.secjuice.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.secjuice.com/content/images/2018/12/Logo-1.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "Secprentice",
        "image": {
            "@type": "ImageObject",
            "url": "https://www.secjuice.com/content/images/2019/01/qnO9KNGt_400x400.jpg",
            "width": 400,
            "height": 400
        },
        "url": "https://www.secjuice.com/author/secprentice/",
        "sameAs": [
            "https://twitter.com/secprentice"
        ]
    },
    "headline": "Blue Team Detection: DarkSide Ransomware",
    "url": "https://www.secjuice.com/blue-team-detection-darkside-ransomware/",
    "datePublished": "2021-06-13T15:44:53.000Z",
    "dateModified": "2021-06-15T13:29:22.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.secjuice.com/content/images/2021/06/09f975117899917.607ec2d4602cd.jpg",
        "width": 1200,
        "height": 928
    },
    "description": "Malware write-ups can be found in abundance online, they are often written from the point of view of a malware researcher who focuses on the deep internals of how malicious software works.",
    "mainEntityOfPage": "https://www.secjuice.com/blue-team-detection-darkside-ransomware/"
}
    </script>

    <meta name="generator" content="Ghost 5.75">
    <link rel="alternate" type="application/rss+xml" title="Secjuice" href="https://www.secjuice.com/rss/">
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.36/umd/portal.min.js" data-i18n="false" data-ghost="https://www.secjuice.com/" data-key="f5b1c0a3d569893404504e78bd" data-api="https://www.secjuice.com/ghost/api/content/" crossorigin="anonymous" type="6eaed754499a1bfffddfdcf6-text/javascript"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="f5b1c0a3d569893404504e78bd" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://www.secjuice.com/" crossorigin="anonymous" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
    
    <link href="https://www.secjuice.com/webmentions/receive/" rel="webmention">
    <script defer src="/public/cards.min.js?v=885aa4a822" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=885aa4a822">
    <script defer src="/public/member-attribution.min.js?v=885aa4a822" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119868006-1" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<script type="6eaed754499a1bfffddfdcf6-text/javascript">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119868006-1');
</script>

<style>.kg-image-card img { height: auto; }</style>

<meta name="google-site-verification" content="lvcUQXMrKXC7eYXXwae5JdMWrn1K6t5o1YjP_4IYcKs" />
<meta name="msvalidate.01" content="8B017FF6E735701B4A11D5540AC64494" />


<style type="text/css">
    body {
    	font-family: 'Roboto', sans-serif; 
    }
    
    ::selection {
  		background: #763375;
        color: white;
	}
    
	::-moz-selection {
  		background: #763375;
        color: white;
	}
    
    .post-full-content {
    	font-family: 'Roboto', sans-serif;
    }

    .post-card-excerpt {
    	font-family: 'Roboto', sans-serif;
    }
    
    .site-logo {
        max-height: 90px; /* where 45px is the current max height */
		padding-bottom: 25px;
    }

	.post-full-content pre {
        color: inherit;
    }
    
	.post-content,
    .post-content a {
        overflow-wrap: break-word;
        word-wrap: break-word;
        word-break: break-word;
        -ms-hyphens: auto;
        -moz-hyphens: auto;
        -webkit-hyphens: auto;
        hyphens: auto;
    }
</style>

<style>
.kg-card.kg-bookmark-card {
    border: solid grey 1px;
    padding: 0.5em;
}
.kg-bookmark-content,
.kg-bookmark-thumbnail {
    display: inline-block !important;
    vertical-align: top !important
}
.kg-bookmark-content {
    width: 75% !important;
    }
.kg-bookmark-thumbnail {
    width: 25% !important;
    }
.kg-bookmark-title,
.kg-bookmark-description,
.kg-bookmark-icon,
.kg-bookmark-author,
.kg-bookmark-publisher{
    font-size: 12pt !important;
    line-height: 1 !important;
}
.kg-bookmark-title {
    font-weight: bold !important;
}
.kg-bookmark-icon {
    max-width: 24px !important;
    max-height: 24px !important;
}
.kg-bookmark-thumbnail img {
    max-width: 100% !important;
    max-height: 100% !important;
    margin: 0 !important;
}
.kg-bookmark-icon {
    display: inline !important;
}
.kg-bookmark-author {
    font-weight: bold !important;
}
.kg-bookmark-icon,
.kg-bookmark-author,
.kg-bookmark-publisher {
    margin-right: 0.2em !important;
    font-size: 10pt !important;
}
.kg-bookmark-container {
    text-decoration: none !important;
    box-shadow: none !important;
}
</style><style>:root {--ghost-accent-color: #230530;}</style>

</head>
<body class="post-template tag-hash-import-2023-03-05-20-02 tag-hash-import-2024-01-14-17-06 is-head-left-logo has-sans-body has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo" href="https://www.secjuice.com">
                        <img src="https://www.secjuice.com/content/images/2018/12/Logo-1.png" alt="Secjuice">
                </a>
                <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-donate"><a href="https://opencollective.com/secjuice">Donate</a></li>
    <li class="nav-about-us"><a href="https://secjuice.com/about-us/">About Us</a></li>
    <li class="nav-technical"><a href="https://secjuice.com/tag/technical/">Technical</a></li>
    <li class="nav-osint"><a href="https://secjuice.com/tag/OSINT/">OSINT</a></li>
    <li class="nav-unusual-journeys"><a href="https://secjuice.com/tag/unusual-journeys-into-infosec/">Unusual Journeys</a></li>
    <li class="nav-hof"><a href="https://secjuice.com/secjuice-hall-of-fame/">HoF</a></li>
    <li class="nav-write-with-us"><a href="https://secjuice.com/join-secjuice-writing-team/">Write With Us</a></li>
    <li class="nav-hire-a-writer"><a href="https://secjuice.com/hire-infosec-cybersecurity-writer/">Hire A Writer</a></li>
    <li class="nav-rankings"><a href="https://secjuice.com/secjuice-writers-ranking/">Rankings</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                    <button class="gh-search gh-icon-btn" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                    <div class="gh-head-members">
                                <a class="gh-head-link" href="#/portal/signin" data-portal="signin">Sign in</a>
                                <a class="gh-head-button" href="#/portal/signup" data-portal="signup">Subscribe</a>
                    </div>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post tag-hash-import-2023-03-05-20-02 tag-hash-import-2024-01-14-17-06 featured image-small">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
                <span class="post-card-featured"><svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M4.49365 4.58752C3.53115 6.03752 2.74365 7.70002 2.74365 9.25002C2.74365 10.6424 3.29678 11.9778 4.28134 12.9623C5.26591 13.9469 6.60127 14.5 7.99365 14.5C9.38604 14.5 10.7214 13.9469 11.706 12.9623C12.6905 11.9778 13.2437 10.6424 13.2437 9.25002C13.2437 6.00002 10.9937 3.50002 9.16865 1.68127L6.99365 6.25002L4.49365 4.58752Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg> Featured</span>
        </div>

        <h1 class="article-title">Blue Team Detection: DarkSide Ransomware</h1>

            <p class="article-excerpt">Malware write-ups can be found in abundance online, they are often written from the point of view of a malware researcher who focuses on the deep internals of how malicious software works.</p>

        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="/author/secprentice/" class="author-avatar">
                        <img class="author-profile-image" src="/content/images/size/w100/2019/01/qnO9KNGt_400x400.jpg" alt="Secprentice" />
                    </a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="/author/secprentice/">Secprentice</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2021-06-13">Jun 13, 2021</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 8 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="/content/images/size/w300/2021/06/09f975117899917.607ec2d4602cd.jpg 300w,
                            /content/images/size/w600/2021/06/09f975117899917.607ec2d4602cd.jpg 600w,
                            /content/images/size/w1000/2021/06/09f975117899917.607ec2d4602cd.jpg 1000w,
                            /content/images/size/w2000/2021/06/09f975117899917.607ec2d4602cd.jpg 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="/content/images/size/w2000/2021/06/09f975117899917.607ec2d4602cd.jpg"
                    alt="Blue Team Detection: DarkSide Ransomware"
                />
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <p>Malware write-ups can be found in abundance online, they are often written from the point of view of a malware researcher who focuses on the deep internals of how malicious software works, in some cases the information provided cannot be used to derive actionable intelligence and defence mechanisms by cybersecurity blue teams. With that said, Researchers normally publish lists of hashes, file names, paths and IP addresses but these are easily rotated by attackers and therefore quickly become redundant for defenders. So, instead of looking for these fingerprints (which frequently change), we should instead look to detect malware by its <em>behaviours (which are relatively persistent and common across many malware flavours)</em>. In this post, I hope to take a recent popular strain of malware and pick it apart, not as a malware analyst but as a blue team defender to create intelligence that can be used to detect malware based on its generalised behaviours instead of a stagnant list of hashes, IPs or file names.</p><p>DarkSide Ransomware unleashed chaos on the Oil industry recently by demanding millions of dollars to decrypt critical infrastructure networks. Thankfully Fireye has written up a great report which illuminates some of the tactics employed by Darkside admins to inflict their cryptographic nightmare. Although it seems Darkside is making a swift exit the methods they use are common across many threat actors and therefore the advice below remains applicable to other ransomware flavours.</p><blockquote>Based on the evidence that DARKSIDE ransomware is distributed by multiple actors, we anticipate that the TTPs used throughout incidents associated with this ransomware will continue to vary somewhat</blockquote><p><a href="https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html?ref=secjuice.com">https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html</a></p><h2 id="detection-opportunities">Detection Opportunities</h2><p></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://www.secjuice.com/content/images/2021/05/fig3b-1.png" class="kg-image" alt loading="lazy" width="2000" height="1067" srcset="https://www.secjuice.com/content/images/size/w600/2021/05/fig3b-1.png 600w, https://www.secjuice.com/content/images/size/w1000/2021/05/fig3b-1.png 1000w, https://www.secjuice.com/content/images/size/w1600/2021/05/fig3b-1.png 1600w, https://www.secjuice.com/content/images/2021/05/fig3b-1.png 2250w" sizes="(min-width: 720px) 720px"><figcaption><a href="https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html?ref=secjuice.com">Image credit: Fireeye</a></figcaption></figure><h3 id="-1-password-attacks-at-the-perimeter">#1 Password attacks at the perimeter</h3><p>Consumers of security tools are often led to believe that Ransomware is a complex threat but for our first detection opportunity, we see quite the opposite.</p><blockquote>In multiple cases we have observed suspicious authentication attempts against corporate VPN infrastructure immediately prior to the start of interactive intrusion operations. The authentication patterns were consistent with a password spraying attack, though available forensic evidence was insufficient to definitively attribute this precursor activity to UNC2628. In cases where evidence was available, the threat actor appeared to obtain initial access through corporate VPN infrastructure using legitimate credentials.</blockquote><p>The attackers are simply logging into the victims VPN appliance and accessing the network where they assume the permissions of the user whose credentials they have stolen. This isn't a complex intrusion. It's just logging in. It could have been slowed or perhaps stopped by modernising password policy and enabling two-factor authentication on the VPN gateway.</p><p>Defenders can detect this stage of the attack by monitoring VPN authentication logs (normally Syslog directly from the VPN appliances or RADIUS) for multiple failed attempts. Also, multiple failed attempts followed by success. Alert fidelity can be achieved in modern SIEMs by applying baselining or machine learning to automatically detect anomalous authentication instead of relying on a static threshold such as X auth failures in Y minutes.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://www.secjuice.com/content/images/2021/05/Untitled-3.png" class="kg-image" alt loading="lazy" width="719" height="171" srcset="https://www.secjuice.com/content/images/size/w600/2021/05/Untitled-3.png 600w, https://www.secjuice.com/content/images/2021/05/Untitled-3.png 719w"><figcaption>Simplification of the attack for visual learners.&nbsp;</figcaption></figure><p>FireEye does also mention the attacker may have logged in with legitimate credentials, it could be argued that the attackers stole or were sold a working username/password combination. In this case, it's surely safe to assume that two-factor authentication would have slowed down the attackers. Implementing 2FA is initially time-consuming but a breeze to work with after the initial deployment hump. Some say that user workflow and productivity is hampered by having a two-factor authentication process but thanks to modern push notification solutions (like Duo and Azure) this simply isn't true. Your smartphone can send you a push notification that you tap and unlock with biometrics adding fractions of a second onto your login time. The pros of a more secure VPN outweigh the cons of a few extra seconds of logon time.</p><h3 id="-2-exploitation-of-edge-appliances-">#2 Exploitation of edge appliances.</h3><p><i>Admittedly</i><em> this section is only half a detection, the other half is patching advice.</em></p><p>FireEye noted that some Darkside attacks exploited <a href="https://www.tenable.com/blog/cve-2021-20016-zero-day-vulnerability-in-sonicwall-secure-mobile-access-sma-exploited?ref=secjuice.com">CVE-2021-20016</a> for initial access. This vulnerability allows unauthenticated remote commands to be executed against SonicWall appliances. Anyone with an internet connection and the right set of instructions (SQL queries in this case) can easily steal credentials from the SonicWall appliance and use them to break into a network from the outside. This low effort, high yield attack is made possible by the precarious location of edge networking appliances, bridging the internal and external network. </p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://www.secjuice.com/content/images/2021/05/Untitled--1-.png" class="kg-image" alt loading="lazy" width="691" height="221" srcset="https://www.secjuice.com/content/images/size/w600/2021/05/Untitled--1-.png 600w, https://www.secjuice.com/content/images/2021/05/Untitled--1-.png 691w"><figcaption>Simplification of VPN appliances on the internet.&nbsp;</figcaption></figure><p>If your network has any edge appliances (Citrix, VPNs or similar) they must be promptly patched when vulnerabilities are disclosed, the sooner the better. Failing to do so will undoubtedly allow attackers in eventually.<br>It's possible to detect such vulnerabilities with an external vulnerability scanner or simply by signing up for a notification service like <a href="https://secalerts.co/?ref=secjuice.com">https://secalerts.co</a>. </p><p>In some cases, it's also possible to detect appliance attacks via their logs although this varies by vendor and vulnerability. Knowing which logs to look at isn't always known until long after the vulnerability has been published. In most cases, the appliance will write a Syslog message or have a particular file in a particular location that shows the system has been compromised. It's probably best not to count on this method for detecting networking appliance intrusions. Prevention is better than the cure. </p><h3 id="-3-phishing">#3 Phishing </h3><p>A group that Fireye have dubbed UNC2465 snuck Darkside in via the "Hamhock" backdoor. It's hard to find much information about this backdoor other than what's provided in the Fireye write up but it's possible to make educated guesses about its tactics based on the snippets of information Fireye have included.</p><blockquote>During one incident, the threat actor appeared to establish a line of communication with the victim before sending a malicious Google Drive link delivering an archive containing an LNK downloader. More recent UNC2465 emails have used Dropbox links with a ZIP archive containing malicious LNK files that, when executed, would ultimately lead to SMOKEDHAM being downloaded onto the system</blockquote><p>So, UNC2465 delivered the Hamhock backdoor via phishing in two flavours. One using cloud storage services like Google Drive or Dropbox and the other by hiding malicious LNK files inside ZIPs and sending them directly to the victim. Fireeye has not shared many details about the phishing kill chain but we can safely assume it looks something like these Any.Run samples that abuse LNK files:<br><a href="https://app.any.run/tasks/2f776569-a3be-42e4-a6af-732982c9b2ed/?ref=secjuice.com">https://app.any.run/tasks/2f776569-a3be-42e4-a6af-732982c9b2ed/</a><br><a href="https://app.any.run/tasks/2f776569-a3be-42e4-a6af-732982c9b2ed/?ref=secjuice.com">https://app.any.run/tasks/2f776569-a3be-42e4-a6af-732982c9b2ed/</a><br><br>When boiled down this phishing attack is nothing more than delivering a shortcut file that points towards a malicious command. The shortcut file is put in front of the user inside of a ZIP file attachment or hidden behind a cloud file sharing link.<br><strong>This isn't anything new </strong>and certainly isn't anything to be concerned about because long kill chains like this grant many detection and prevention opportunities for us defenders. </p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://www.secjuice.com/content/images/2021/05/LNKKillchain.png" class="kg-image" alt loading="lazy" width="797" height="421" srcset="https://www.secjuice.com/content/images/size/w600/2021/05/LNKKillchain.png 600w, https://www.secjuice.com/content/images/2021/05/LNKKillchain.png 797w" sizes="(min-width: 720px) 720px"><figcaption>A rough outline of the LNK kill chain as per AnyRun samples.</figcaption></figure><p>To detect and prevent this phishing method defenders should consider some or all of the following actions:</p><ul><li>Do not allow LNK files to be delivered as eMail attachments. Block LNK files from being delivered to end-users. </li><li>Ensure that this block extends to LNK files inside of ZIPs. Most modern email gateways can look inside ZIP files for malicious files.</li><li>Ensure that this block extends to LNK files inside of encrypted ZIPs. Attackers sometimes password-protect ZIP files to stop eMail scanners from looking inside. This particular protection may interrupt normal business workflows and therefore is not suitable for everyone, your business should be consulted for appetite first.</li><li>Use EDR to monitor for archive software (WinZip, 7Zip, Unrar) writing .LNK files to disk aka being extracted.</li><li>User EDR to monitor for a suspicious parent to child process relationships as per any other malware. For example: CMD.exe &gt; MSHTA.exe &gt; PowerShell.exe. There's no special sauce here. Once the attackers are on the network they still rely on traditional code execution and foothold techniques, so stick to what you know and don't be distracted by the fact that a new scary ransomware flavour is involved. </li></ul><h3 id="-4-privilege-escalation-detection">#4 Privilege escalation detection</h3><p>After any hacker has gotten into her target network she will want to obtain high privileges so she can spread deep into the network and encrypt as many systems as possible. Again, there is no secret sauce here. The ransomware operators are using the same tried and true techniques. Specifically called out by FireEye are Mimikatz, CVE-2020-1472 and LSASS memory dumps. To detect and prevent these privilege escalation attacks, defenders should implement as many of the below initiatives as possible:</p><ul><li>Patch systems regularly and promptly. <a href="https://www.crowdstrike.com/blog/cve-2020-1472-zerologon-security-advisory/?ref=secjuice.com">CVE-2020-1472</a> can be avoided by installing patches. </li><li>Administrators must ensure that <a href="https://www.reliaquest.com/blog/credential-dumping-part-2-how-to-mitigate-windows-credential-stealing/?ref=secjuice.com">wdigest regkey is set to 0</a> on systems running Â Windows 7, 8, Server 2008, and Server 2012. This stops plain text credentials from being stored in memory. EDR tools should be used to monitor for modifications to the wdigest registry key as attackers may try to modify it to weaken system security</li><li>Administrators<a href="https://www.reliaquest.com/blog/credential-dumping-part-2-how-to-mitigate-windows-credential-stealing/?ref=secjuice.com"> should also ensure the <strong><strong>RunAsPPL</strong></strong></a><strong> </strong>registry key is set which stops tools like Mimikatz from dumping the LSASS process memory where credentials are stored in a hashed format.</li><li>As mentioned earlier, <a href="https://www.ncsc.gov.uk/collection/passwords/updating-your-approach?ref=secjuice.com#:~:text=The%20NCSC%20is%20working%20to,large%20numbers%20of%20complex%20passwords.&text=examine%20and%20(if%20necessary)%20challenge,made%20when%20determining%20password%20policy">password policies must be modernised</a> with length and longevity in mind.</li><li><a href="https://docs.microsoft.com/en-us/defender-for-identity/technical-faq?ref=secjuice.com">A large portion of common Microsoft domain attacks can be detected by Microsoft ATA, now renamed to Microsoft Defender For Identity.</a><br>The agent runs on domain controllers where it can monitor for suspicious behaviour in domain controller logs.</li></ul><h3 id="-5-monitoring-and-controlling-administrative-tools">#5 Monitoring and controlling administrative tools</h3><p>All of the hacking groups that deployed DarkSide were observed by Fireeye to be using system administrator tools that have no place on a network except in very particular circumstances. Defenders should look to strictly control access to the following tools:</p><ul><li>Teamviewer</li><li>rClone</li><li>PSExec</li></ul><p>FireEye directly calls out the fact that the attackers downloaded standard binaries for these tools directly from the vendor source. (For example dl.teamviewer.com) This is interesting because it highlights the fact that the attackers don't feel the need to hide this download, obviously because it often goes undetected. <br>Defenders can detect and control the use of these tools using EDR Watchlists, <a href="https://mediarealm.com.au/articles/block-teamviewer-network/?ref=secjuice.com">Firewalls</a> and application control tools like AppLocker. If a user starts any of these applications without proper permission or explanation their activity should be investigated. <br></p><h3 id="-5-protect-esxi">#5 Protect ESXi<br></h3><blockquote>Mandiant observed the threat actor navigate to ESXi administration interfaces and disable snapshot features prior to the ransomware encryptor deployment, which affected several VM images.</blockquote><p>I believe this claim to be profound because this isn't a commonly talked about attack vector and few organisations are properly monitoring their virtual machine management consoles. Defenders should work to implement as many of the following recommendations as possible to protect their ESXi hosts from attacks like this.</p><ul><li>Ensure that all virtual machine hosts are patched and running the latest software available from the vendor. If you don't have a vulnerability management platform then sign up to a service like <a href="https://secalerts.co/?ref=secjuice.com">https://secalerts.co/</a> for email alerts.</li><li>Control access to your ESXi hosts tightly, only share the credentials with employees who need to know. Be sure to rotate the passwords after key administrators leave the company.</li><li>Set long complex passwords for your ESXi server backends and store them in password vaults like Secret Server, KeePass or BitWarden. </li><li>Monitor ESXI Syslog for multiple authentication failure events in a short period of time. </li><li>Ingest your ESXi Syslog logs into a monitoring platform and configure alarms that will warn you of virtual machine snapshots being deleted in bulk.</li></ul><p><a href="https://www.behance.net/gallery/117084621/Snakesstars?ref=secjuice.com">This week's images were provided by Nina Z's digital art collection.</a></p><p></p><p></p>
    </section>


</article>
</main>

    <section class="footer-cta outer">
        <div class="inner">
            <h2 class="footer-cta-title">Sign up for more like this.</h2>
            <a class="footer-cta-button" href="#/portal" data-portal>
                <div class="footer-cta-input">Enter your email</div>
                <span>Subscribe</span>
            </a>
        </div>
    </section>



            <aside class="read-more-wrap outer">
                <div class="read-more inner">
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/secjuicecon2025/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/03/secjuicecon-logo1.jpg 300w,
                    /content/images/size/w600/2025/03/secjuicecon-logo1.jpg 600w,
                    /content/images/size/w1000/2025/03/secjuicecon-logo1.jpg 1000w,
                    /content/images/size/w2000/2025/03/secjuicecon-logo1.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/03/secjuicecon-logo1.jpg"
            alt="SecjuiceCON 2025"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/secjuicecon2025/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    SecjuiceCON 2025
                </h2>
            </header>
                <div class="post-card-excerpt">SecjuiceCON, our first virtual conference, will be held on March 30, 2025, starting at noon America/New_York timezone.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2025-03-16">Mar 16, 2025</time>
                <span class="post-card-meta-length">2 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/htb-escape-walkthrough/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/03/Romans-playing-mini-golf.png 300w,
                    /content/images/size/w600/2025/03/Romans-playing-mini-golf.png 600w,
                    /content/images/size/w1000/2025/03/Romans-playing-mini-golf.png 1000w,
                    /content/images/size/w2000/2025/03/Romans-playing-mini-golf.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/03/Romans-playing-mini-golf.png"
            alt="HTB Escape Walkthrough"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/htb-escape-walkthrough/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    HTB Escape Walkthrough
                </h2>
            </header>
                <div class="post-card-excerpt">A very specific Windows machine, in which I found myself stuck, persistently searching for an exploit that later revealed itself to be a straightforward clue that facilitated a trivial privilege escalation. The subsequent privilege escalation led me to the desired root flag.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2025-03-16">Mar 16, 2025</time>
                <span class="post-card-meta-length">29 min read</span>
        </footer>

    </div>

</article>
                        
<article class="post-card post">

    <a class="post-card-image-link" href="/htb-stocker-walkthrough/">

        <img class="post-card-image"
            srcset="/content/images/size/w300/2025/03/Romans-playing-tennis.png 300w,
                    /content/images/size/w600/2025/03/Romans-playing-tennis.png 600w,
                    /content/images/size/w1000/2025/03/Romans-playing-tennis.png 1000w,
                    /content/images/size/w2000/2025/03/Romans-playing-tennis.png 2000w"
            sizes="(max-width: 1000px) 400px, 800px"
            src="/content/images/size/w600/2025/03/Romans-playing-tennis.png"
            alt="HTB Stocker Walkthrough"
            loading="lazy"
        />


    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/htb-stocker-walkthrough/">
            <header class="post-card-header">
                <div class="post-card-tags">
                </div>
                <h2 class="post-card-title">
                    HTB Stocker Walkthrough
                </h2>
            </header>
                <div class="post-card-excerpt">Simple BOX on both flags, much more root than the user, still fun and great for beginners.</div>
        </a>

        <footer class="post-card-meta">
            <time class="post-card-meta-date" datetime="2025-03-16">Mar 16, 2025</time>
                <span class="post-card-meta-length">12 min read</span>
        </footer>

    </div>

</article>
                </div>
            </aside>



    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="https://www.secjuice.com">Secjuice</a> &copy; 2025</section>
            <nav class="site-footer-nav">
                <ul class="nav">
    <li class="nav-dog-friendly-hotels"><a href="https://rochdog.com">Dog Friendly Hotels</a></li>
    <li class="nav-dog-friendly-community"><a href="https://rochsociety.com">Dog Friendly Community</a></li>
    <li class="nav-dog-friendly-directory"><a href="https://rochdog.com">Dog Friendly Directory</a></li>
    <li class="nav-donate"><a href="https://opencollective.com/secjuice">Donate</a></li>
</ul>

            </nav>
            <div class="gh-powered-by"><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>

    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>

    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous" type="6eaed754499a1bfffddfdcf6-text/javascript">
</script>
<script src="/assets/built/casper.js?v=885aa4a822" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<script type="6eaed754499a1bfffddfdcf6-text/javascript">
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/prism.min.js" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/plugins/line-numbers/prism-line-numbers.min.js" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/plugins/line-numbers/prism-line-numbers.min.css" />
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism-coy.min.css" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-csharp.min.js" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-css.min.js" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-c.min.js" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-clike.min.js" type="6eaed754499a1bfffddfdcf6-text/javascript"></script>

<script type="6eaed754499a1bfffddfdcf6-text/javascript">
$(document).ready(function() {
    // comment out this for testing w/o codemirrror
    /* if(location.href == '') {
        return true;
    }*/
    
    $('iframe').each(function() {
    	console.log($(this).attr('src'));
    });
    
    $(document).ready(function() {
    	$('.post-full-content a').each(function() {
            if(!/^\#/.test($(this).attr('href'))) {
        		$(this).attr('target','_blank');
        	}
        });
    });
    
    /*$('code[class]').each(function() {

        // get code text and flush
    	var $this = $(this), $code = $.trim($this.text());
    	$this.empty();
        
        // parse language and theme
        var mode = 'htmlmixed';
        var theme = 'monokai';
        var numLines = $code.split('\n').length;
        var maxNumLinesShown = 50;
        var lineHeight = 25;
        var codeheight = (numLines > maxNumLinesShown ? maxNumLinesShown : numLines.length) * lineHeight;
        if(/^language\-[^\-]+\-.+$/.test($.trim($(this).attr('class')))) {
			langclass = /^language\-([^\-]+)\-(.+)$/.exec($.trim($(this).attr('class')));
			mode = langclass[1];
            if(/([^\_]+)\_([0-9]+)/.test(langclass[2])) {
                themeheight = /([^\_]+)\_([0-9]+)/.exec(langclass[2]);
				theme = themeheight[1];
                codeheight = themeheight[2];
            } else {
            	theme = langclass[2];
            }
            
            if(mode == 'c') { mode = 'text/x-csrc'; }
            if(mode == 'cpp') { mode = 'text/x-c++src'; }

            console.log('mode:'+mode+' theme:'+theme);
        } else if(/^language\-[^\-]+$/.test($.trim($(this).attr('class')))) {
			langclass = /^language\-([^\-]+)$/.exec($.trim($(this).attr('class')));
			mode = langclass[1];
			theme = 'default';
            
            if(mode == 'c') { mode = 'text/x-csrc'; }
            if(mode == 'cpp') { mode = 'text/x-c++src'; }
            
            console.log('mode:'+mode+' default-theme:'+theme);            
        } else {
            mode = 'htmlmixed';
            theme = 'default';
        	console.log('code class not recognized: '+$(this).attr('class'));
        }
        
        $(this).removeAttr('class');

    	var myCodeMirror = CodeMirror(this, {
        	value: $code,
			mode: mode,
			theme: theme,
			indent: false,
			lineNumbers: true,
        	readOnly: true
    	});
        
        myCodeMirror.setSize(null, codeheight);
        $(this).focus();
	});*/

	/* $('pre').each(function() {
        $(this).css('background-color','transparent');
        $(this).css('border','none');
        $(this).css('padding','0px');
        $(this).css('padding-left','10px');
        $(this).css('margin','0px');
        $(this).removeAttr('class');
    }); */
    
    /* $(".post-full-meta").css(
		"font-family",
        "secjuice-title"
    );
    
    $(".post-full-title").css(
		"font-family",
        "secjuice-title"
    );
    
    $(".post-full-content").css(
		"font-family",
        "secjuice-content"
    );
    
    $(".author-card-content").css(
		"font-family",
        "secjuice-content"
    );
    
    $(".floating-header").css(
        {
          "font-family":"secjuice-content",
          "font-weight":"normal"
        }
    ); */
});
</script>

<script type="6eaed754499a1bfffddfdcf6-text/javascript">
$(document).ready(function() {
  beforeOcf = "<section class='gh-content gh-canvas'><h2>Help Support Our Non-Profit Mission</h2><p>If you enjoyed this article or found it helpful, please consider <b>donating</b>. Secjuice is a 501(c)(6) non-profit and volunteer-based publication powered by donations. We will use your donation to cover our hosting costs and <b>keep Secjuice an advertisement and sponsor-free zone</b>.</p>";
  ocf = "<p style='text-align:center'><a href='https://opencollective.com/secjuice' target='blank' rel='norel' style='display:inline-block;width:fit-content;background:#230530;color:white;padding:0.5em;text-decoration:none;border-radius:999px'>Donate at Open Collective</a></p>";
  afterOcf = '</section>';
  document.getElementsByClassName('article')[0].innerHTML += beforeOcf + ocf + afterOcf;
});

/*
$(document).ready(function() {
  beforeCoffee = "<section class='gh-content gh-canvas'><h2>Help Support Our Non-Profit Mission</h2><p>If you enjoyed this article or found it helpful please consider buying us a coffee, Secjuice is a non-profit and volunteer-based publication powered by caffeine. We will use your coffee money to help cover our Ghost Pro <a href='https://ghost.org/pricing/'>hosting costs</a> and <b>keep Secjuice an advertisement and sponsor free zone</b>.</p>";
  coffee = "<iframe style='width:100%;height:75px;margin:0;' srcdoc=\"<html><body style='text-align:center'><style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#ffffff !important;background-color:#BB5794 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 0px 9px !important;font-size: 17px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#ffffff !important;}</style><link href='https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet'><a class='bmc-button' target='_blank' href='https://www.buymeacoffee.com/secjuice'><img src='https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/BMC-btn-logo.svg' alt='Buy Secjuice A Coffee'><span style='margin-left:5px'>Buy Secjuice A Coffee</span></a></body></html>\"><a href='https://www.buymeacoffee.com/secjuice'>Buy Secjuice a Coffee</a></iframe>";
  afterCoffee = "</section>";
  document.getElementsByClassName('article')[0].innerHTML += beforeCoffee + coffee + afterCoffee;
});
*/
</script>

<script type="6eaed754499a1bfffddfdcf6-text/javascript" src="https://apiv2.popupsmart.com/api/Bundle/398459" async></script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="6eaed754499a1bfffddfdcf6-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"924b17d38b2eaaac","version":"2025.1.0","r":1,"serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"e95e54ecf7074bd0818fb124ef4a348d","b":1}' crossorigin="anonymous"></script>
</body>
</html>
