<!DOCTYPE html> <html lang="en-us" dir="ltr"> <head><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta charset="UTF-8"><meta name="description" content="This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &#38; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities"><title>AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection</title><meta name="title" content="AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-NDGPDFZ');</script><script src="/static/z/i.js" type="text/javascript" referrerpolicy="origin"></script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/bringing-ai-to-cloudflare"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/bringing-ai-to-cloudflare"><link rel="alternate" hreflang="zh-cn" href="https://blog.cloudflare.com/zh-cn/bringing-ai-to-cloudflare"><link rel="alternate" hreflang="zh-tw" href="https://blog.cloudflare.com/zh-tw/bringing-ai-to-cloudflare"><link rel="alternate" hreflang="ja-jp" href="https://blog.cloudflare.com/ja-jp/bringing-ai-to-cloudflare"><link rel="alternate" hreflang="ko-kr" href="https://blog.cloudflare.com/ko-kr/bringing-ai-to-cloudflare"><!-- General Meta Tags --> <meta property="article:published_time" content="2024-09-27T14:00+01:00"> <meta property="article:modified_time" content="2024-10-22T01:49:14.466Z">  <meta property="article:tag" content="Birthday Week"><meta property="article:tag" content="Bot Management"><meta property="article:tag" content="Bots"><meta property="article:tag" content="AI Bots"><meta property="article:tag" content="AI"><meta property="article:tag" content="Machine Learning"><meta property="article:tag" content="Generative AI"><meta property="article:tag" content="Security"><meta property="article:tag" content="Developers"><meta property="article:tag" content="Agile Developer Services"><meta property="article:tag" content="Developer Platform"><meta property="article:tag" content="Application Services"><meta property="article:tag" content="Product News"> <meta property="article:publisher" content="https://www.facebook.com/cloudflare"> <!-- Facebook Meta Tags --> <meta property="og:site_name" content="The Cloudflare Blog"> <meta property="og:type" content="article"> <meta property="og:title" content="AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection"> <meta property="og:description" content="This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &#38; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities.  "> <meta property="og:url" content="https://blog.cloudflare.com/bringing-ai-to-cloudflare"> <meta property="og:image:width" content="1200"> <meta property="og:image:height" content="628"> <!-- Twitter/X Meta Tags --> <meta name="twitter:title" content="AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection"> <meta name="twitter:description" content="This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &#38; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities.  "> <meta name="twitter:url" content="https://blog.cloudflare.com/bringing-ai-to-cloudflare"> <meta name="twitter:card" content="summary_large_image">  <meta name="twitter:label1" content="Written by"> <meta name="twitter:data1" content="Adam Martinetti"> <meta name="twitter:creator" content="@adamemcf"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="Birthday Week,Bot Management,Bots,AI Bots,AI,Machine Learning,Generative AI,Security,Developers,Agile Developer Services,Developer Platform,Application Services,Product News"> <meta name="twitter:site" content="@cloudflare">  <meta property="og:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4wipGwjeGhBdS8jXcC3KTh/d0c08a22b6e93718e0b2d171adb845cb/AI_Everywhere_with_the_WAF_Rule_Builder_Assistant__Cloudflare_Radar_AI_Insights__and_updated_AI_bot_protection-OG.png"> <meta name="twitter:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4wipGwjeGhBdS8jXcC3KTh/d0c08a22b6e93718e0b2d171adb845cb/AI_Everywhere_with_the_WAF_Rule_Builder_Assistant__Cloudflare_Radar_AI_Insights__and_updated_AI_bot_protection-OG.png"> <link rel="stylesheet" href="/_astro/index.5BtHvQ-S.css" /><script type="module" src="/_astro/hoisted.Byv_OtGt.js"></script></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="ny58Q" component-url="/_astro/GoogleAnalytics.ZZb4yAx2.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.BQCS8AJJ.js" props="{&quot;title&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/bringing-ai-to-cloudflare&quot;],&quot;info&quot;:[0,{&quot;id&quot;:[0,&quot;6HqKUMoXg0wFIQg9howLMX&quot;],&quot;title&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection&quot;],&quot;slug&quot;:[0,&quot;bringing-ai-to-cloudflare&quot;],&quot;excerpt&quot;:[0,&quot;This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &amp; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;The continued growth of AI has fundamentally changed the Internet over the past 24 months. AI is increasingly ubiquitous, and Cloudflare is leaning into the new opportunities and challenges it presents in a big way. This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added AI bot traffic insights on Cloudflare Radar, and given customers new AI bot blocking capabilities.Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;ai-assistant-for-waf-rule-builder\&quot;&gt;AI Assistant for WAF Rule Builder&lt;/h2&gt;\n            &lt;a href=\&quot;#ai-assistant-for-waf-rule-builder\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5RYC4wmCDbs0axY92FfkFk/a728906cb6a902dd1c78ec93a0f650c2/BLOG-2564_1.png\&quot; alt=\&quot;BLOG-2564 1\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;501\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;At Cloudflare, weâre always listening to your feedback and striving to make our products as user-friendly and powerful as possible. One area where we&amp;#39;ve heard your feedback loud and clear is in the complexity of creating custom and rate-limiting rules for our Web Application Firewall (WAF). With this in mind, weâre excited to introduce a new feature that will make rule creation easier and more intuitive: the AI Assistant for WAF Rule Builder.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7avSjubqlfg7L8ymKEztgk/7c3c31e50879ec64bccc384bdfcd5524/BLOG-2564_2.png\&quot; alt=\&quot;BLOG-2564 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1056\&quot; height=\&quot;1460\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;By simply entering a natural language prompt, you can generate a custom or rate-limiting rule tailored to your needs. For example, instead of manually configuring a complex rule matching criteria, you can now type something like, &amp;quot;Match requests with low bot score,&amp;quot; and the assistant will generate the rule for you. Itâs not about creating the perfect rule in one step, but giving you a strong foundation that you can build on.Â &lt;/p&gt;&lt;p&gt;The assistant will be available in the Custom and Rate Limit Rule Builder for all WAF users. Weâre launching this feature in Beta for all customers, and we encourage you to give it a try. Weâre looking forward to hearing your feedback (via the UI itself) as we continue to refine and enhance this tool to meet your needs.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;ai-bot-traffic-insights-on-cloudflare-radar\&quot;&gt;AI bot traffic insights on Cloudflare Radar&lt;/h2&gt;\n            &lt;a href=\&quot;#ai-bot-traffic-insights-on-cloudflare-radar\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;AI platform providers use bots to crawl and scrape websites, vacuuming up data to use for model training. This is frequently done without the permission of, or a business relationship with, the content owners and providers. In July, Cloudflare urged content owners and providers to &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;u&gt;âdeclare their AIndependenceâ&lt;/u&gt;&lt;/a&gt;, providing them with a way to block AI bots, scrapers, and crawlers with a single click. In addition to this so-called âeasy buttonâ approach, sites can provide more specific guidance to these bots about what they are and are not allowed to access through directives in a &lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/bots/what-is-robots-txt/\&quot;&gt;&lt;u&gt;robots.txt&lt;/u&gt;&lt;/a&gt; file. Regardless of whether a customer chooses to block or allow requests from AI-related bots, Cloudflare has insight into request activity from these bots, and associated traffic trends over time.&lt;/p&gt;&lt;p&gt;Tracking traffic trends for AI bots can help us better understand their activity over time â which are the most aggressive and have the highest volume of requests, which launch crawls on a regular basis, etc. The new &lt;a href=\&quot;https://radar.cloudflare.com/traffic#ai-bot-crawler-traffic\&quot;&gt;&lt;b&gt;&lt;u&gt;AI bot &amp;amp; crawler traffic &lt;/u&gt;&lt;/b&gt;&lt;u&gt;graph on Radarâs Traffic page&lt;/u&gt;&lt;/a&gt; provides insight into these traffic trends gathered over the selected time period for the top known AI bots. The associated list of bots tracked here is based on the &lt;a href=\&quot;https://github.com/ai-robots-txt/ai.robots.txt\&quot;&gt;&lt;u&gt;ai.robots.txt list&lt;/u&gt;&lt;/a&gt;, and will be updated with new bots as they are identified. &lt;a href=\&quot;https://developers.cloudflare.com/api/operations/radar-get-ai-bots-timeseries-group-by-user-agent\&quot;&gt;&lt;u&gt;Time series&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/api/operations/radar-get-ai-bots-summary-by-user-agent\&quot;&gt;&lt;u&gt;summary&lt;/u&gt;&lt;/a&gt; data is available from the Radar API as well. (Traffic trends for the full set of AI bots &amp;amp; crawlers &lt;a href=\&quot;https://radar.cloudflare.com/explorer?dataSet=ai.bots\&quot;&gt;&lt;u&gt;can be viewed in the new Data Explorer&lt;/u&gt;&lt;/a&gt;.)&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5tYefQaBhTPYpqZPtE6KPu/f60694d0b24de2acba13fe0944589885/BLOG-2564_3.png\&quot; alt=\&quot;BLOG-2564 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;631\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;blocking-more-ai-bots\&quot;&gt;Blocking more AI bots&lt;/h2&gt;\n            &lt;a href=\&quot;#blocking-more-ai-bots\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/UiFu8l6K4Pm3ulxTK3XU0/541d109e29a9ae94e4792fdf94f7e4aa/BLOG-2564_4.png\&quot; alt=\&quot;BLOG-2564 4\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;501\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;For Cloudflareâs birthday, weâre following up on our previous blog post, &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;i&gt;&lt;u&gt;Declaring Your AIndependence&lt;/u&gt;&lt;/i&gt;&lt;/a&gt;, with an update on the new detections weâve added to stop AI bots. Customers who havenât already done so can simply &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/bots/configure\&quot;&gt;&lt;u&gt;click the button&lt;/u&gt;&lt;/a&gt; to block AI bots to gain more protection for their website.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;enabling-dynamic-updates-for-the-ai-bot-rule\&quot;&gt;Enabling dynamic updates for the AI bot rule&lt;/h3&gt;\n            &lt;a href=\&quot;#enabling-dynamic-updates-for-the-ai-bot-rule\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The old button allowed customers to block &lt;i&gt;verified&lt;/i&gt; AI crawlers, those that respect robots.txt and crawl rate, and donât try to hide their behavior. Weâve added new crawlers to that list, but weâve also expanded the previous rule to include 27 signatures (and counting) of AI bots that &lt;i&gt;donât &lt;/i&gt;follow the rules. We want to take time to say âthank youâ to everyone who took the time to use our â&lt;a href=\&quot;https://docs.google.com/forms/d/14bX0RJH_0w17_cAUiihff5b3WLKzfieDO4upRlo5wj8\&quot;&gt;&lt;u&gt;tip line&lt;/u&gt;&lt;/a&gt;â to point us towards new AI bots. These tips have been extremely helpful in finding some bots that would not have been on our radar so quickly.Â &lt;/p&gt;&lt;p&gt;For each bot weâve added, weâre also adding them to our âDefinitely automatedâ definition as well. So, if youâre a self-service plan customer using &lt;a href=\&quot;https://blog.cloudflare.com/super-bot-fight-mode/\&quot;&gt;&lt;u&gt;Super Bot Fight Mode&lt;/u&gt;&lt;/a&gt;, youâre already protected. Enterprise Bot Management customers will see more requests shift from the âLikely Botâ range to the âDefinitely automatedâ range, which weâll discuss more below.&lt;/p&gt;&lt;p&gt;Under the hood, weâve converted this rule logic to a &lt;a href=\&quot;https://developers.cloudflare.com/waf/managed-rules/\&quot;&gt;&lt;u&gt;Cloudflare managed rule&lt;/u&gt;&lt;/a&gt; (the same framework that powers our WAF). This enables our security analysts and engineers to safely push updates to the rule in real-time, similar to how new WAF rule changes are rapidly delivered to ensure our customers are protected against the latest CVEs. If you havenât logged back into the Bots dashboard since the previous version of our AI bot protection was announced, click the button again to update to the latest protection.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2tI8Yqxt1S0UPapImb32J4/6cb9e9bf423c370383edb820e5722929/BLOG-2564_5.png\&quot; alt=\&quot;BLOG-2564 5\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;522\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-impact-of-new-fingerprints-on-the-model\&quot;&gt;The impact of new fingerprints on the modelÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#the-impact-of-new-fingerprints-on-the-model\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;One hidden beneficiary of fingerprinting new AI bots is our ML model. &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more/\&quot;&gt;&lt;u&gt;As weâve discussed before&lt;/u&gt;&lt;/a&gt;, our global ML model uses supervised machine learning and greatly benefits from more sources of labeled bot data. Below, you can see how well our ML model recognized these requests as automated, before and after we updated the button, adding new rules. To keep things simple, we have shown only the top 5 bots by the volume of requests on the chart. With the introduction of our new managed rule, we have observed an improvement in our detection capabilities for the majority of these AI bots. Button v1 represents the old option that let customers block only verified AI crawlers, while Button v2 is the newly introduced feature that includes managed rule detections.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2CZVGyDCp9ZtMrZdIi49fE/aacd04d240e9348b5a9b65bad4b470e2/BLOG-2564_6.jpg\&quot; alt=\&quot;BLOG-2564 6\&quot; class=\&quot;kg-image\&quot; width=\&quot;1887\&quot; height=\&quot;1406\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;So how did we make our detections more robust? As we have mentioned before, sometimes &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more/\&quot;&gt;&lt;i&gt;&lt;u&gt;a single attribute can give a bot away&lt;/u&gt;&lt;/i&gt;&lt;/a&gt;. We developed a sophisticated set of heuristics tailored to these AI bots, enabling us to effortlessly and accurately classify them as such. Although our ML model was already detecting the vast majority of these requests, the integration of additional heuristics has resulted in a noticeable increase in detection rates for each bot, and ensuring we score every request correctly 100% of the time. Transitioning from a purely machine learning approach to incorporating heuristics offers several advantages, including faster detection times and greater certainty in classification. While deploying a machine learning model is complex and time-consuming, new heuristics can be created in minutes.Â &lt;/p&gt;&lt;p&gt;The initial launch of the AI bots block button was well-received and is now used by over 133,000 websites, with significant adoption even among our Free tier customers. The newly updated button, launched on August 20, 2024, is rapidly gaining traction. Over 90,000 zones have already adopted the new rule, with approximately 240 new sites integrating it every hour. Overall, we are now helping to protect the intellectual property of more than 146,000 sites from AI bots, and we are currently blocking 66 million requests daily with this new rule. Additionally, weâre excited to announce that support for configuring AI bots protection via Terraform will be available by the end of this year, providing even more flexibility and control for managing your bot protection settings.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;bot-behavior\&quot;&gt;Bot behavior&lt;/h3&gt;\n            &lt;a href=\&quot;#bot-behavior\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;With the enhancements to our detection capabilities, it is essential to assess the impact of these changes to bot activity on the Internet. Since the launch of the updated AI bots block button, we have been closely monitoring for any shifts in bot activity and adaptation strategies. The most basic fingerprinting technique we use to identify AI bot looking for simple user-agent matches. User-agent matches are important to monitor because they indicate the bot is transparently announcing who they are when theyâre crawling a website.Â &lt;/p&gt;&lt;p&gt;The graph below shows a volume of traffic we label as AI bot over the past two months. The blue line indicates the daily request count, while the red line represents the monthly average number of requests. In the past two months, we have seen an average reduction of nearly 30 million requests, with a decrease of 40 million in the most recent month.This decline coincides with the release of Button v1 and Button v2. Our hypothesis is that with the new AI bots blocking feature, Cloudflare is blocking a majority of these bots, which is discouraging them from crawling.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/23ULxmxBIRskEONlWVIvlA/1dbd3d03239047492c2d4f7307217d97/BLOG-2564_7.jpg\&quot; alt=\&quot;BLOG-2564 7\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1048\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This hypothesis is supported by the observed decline in requests from several top AI crawlers. Specifically, the Bytespider bot reduced its daily requests from approximately 100 million to just 50 million between the end of June and the end of August (see graph below). This reduction could be attributed to several factors, including our new AI bots block button and changes in the crawler&amp;#39;s strategy.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UwtyZSXULrVzIqLcICGKd/fdf02c15d17e1d7ed248ba5f8a97eb54/BLOG-2564_8.jpg\&quot; alt=\&quot;BLOG-2564 8\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;993\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;We have also observed an increase in the accountability of some AI crawlers. The most basic fingerprinting technique we use to identify AI bot looking for simple user-agent matches. User-agent matches are important to monitor because they indicate the bot is transparently announcing who they are when theyâre crawling a website. These crawlers are now more frequently using their agents, reflecting a shift towards more transparent and responsible behavior. Notably, there has been a dramatic surge in the number of requests from the Perplexity user agent. This increase might be linked to &lt;a href=\&quot;https://rknight.me/blog/perplexity-ai-is-lying-about-its-user-agent/\&quot;&gt;previous accusations&lt;u&gt; &lt;/u&gt;&lt;/a&gt;that Perplexity did not properly present its user agent, which could have prompted a shift in their approach to ensure better identification and compliance. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7Hq2vUMqqdNCyaxNTCg3JD/610ad53d57203203c5176229245c8086/BLOG-2564_9.jpg\&quot; alt=\&quot;BLOG-2564 9\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;991\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;These trends suggest that our updates are likely affecting how AI crawlers interact with content. We will continue to monitor AI bot activity to help users control who accesses their content and how. By keeping a close watch on emerging patterns, we aim to provide users with the tools and insights needed to make informed decisions about managing their traffic.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;wrap-up\&quot;&gt;Wrap up&lt;/h2&gt;\n            &lt;a href=\&quot;#wrap-up\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Weâre excited to continue to explore the AI landscape, whether weâre finding more ways to make the Cloudflare dashboard usable or new threats to guard against. Our AI insights on Radar update in near real-time, so please join us in watching as new trends emerge and discussing them in the &lt;a href=\&quot;https://community.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Community&lt;/u&gt;&lt;/a&gt;.Â &lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-09-27T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-22T01:49:14.466Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/32vnNHpfRqiOypOggowFgw/d075a178424e42324b9b7cb586a401f1/image3.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;267TTPMscUWABgYgHSH4ye&quot;],&quot;name&quot;:[0,&quot;Bot Management&quot;],&quot;slug&quot;:[0,&quot;bot-management&quot;]}],[0,{&quot;id&quot;:[0,&quot;4l3WDYLk6bXCyaRc9pRzXa&quot;],&quot;name&quot;:[0,&quot;Bots&quot;],&quot;slug&quot;:[0,&quot;bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;3404RT2rd0b1M4ZCCIceXx&quot;],&quot;name&quot;:[0,&quot;AI Bots&quot;],&quot;slug&quot;:[0,&quot;ai-bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;6pD9OvooldcqcJ8z8Y6QQ1&quot;],&quot;name&quot;:[0,&quot;Generative AI&quot;],&quot;slug&quot;:[0,&quot;generative-ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Efeqd1oZ7vy3xls0fdjHF&quot;],&quot;name&quot;:[0,&quot;Agile Developer Services&quot;],&quot;slug&quot;:[0,&quot;agile-developer-services&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;36Dg2NwTgUHhrlE0FRpSdJ&quot;],&quot;name&quot;:[0,&quot;Application Services&quot;],&quot;slug&quot;:[0,&quot;application-services&quot;]}],[0,{&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Adam Martinetti&quot;],&quot;slug&quot;:[0,&quot;adam-martinetti&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@adamemcf&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Harsh Saxena&quot;],&quot;slug&quot;:[0,&quot;harsh-saxena&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1eEVnuAy0vFvqrA4DuCOyI/56dcd6d40b152672d6a5a3bedae2f623/Harsh_S.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Gauri Baraskar&quot;],&quot;slug&quot;:[0,&quot;gauri-baraskar&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1x0TXREl9zWwQIqwIEeLIK/0eaa91581ceae8a561596e2f29257250/Gauri_B.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Carlos Azevedo&quot;],&quot;slug&quot;:[0,&quot;carlos&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2xzs8tkcfue8Y8BHqsqwIV/f3210160c003f0a7da3baa3c51f90511/carlos.png&quot;],&quot;location&quot;:[0,&quot;Lisbon&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;David Belson&quot;],&quot;slug&quot;:[0,&quot;david-belson&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/en7vkXf6rLBm4F8IcNHXT/645022bf841fabff7732aa3be3949808/david-belson.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@dbelson&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &amp; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection LOC&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;Translated for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/bringing-ai-to-cloudflare&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection&quot;],&quot;description&quot;:[0,&quot;This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &amp; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities.  &quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4wipGwjeGhBdS8jXcC3KTh/d0c08a22b6e93718e0b2d171adb845cb/AI_Everywhere_with_the_WAF_Rule_Builder_Assistant__Cloudflare_Radar_AI_Insights__and_updated_AI_bot_protection-OG.png&quot;]}]}],&quot;tagInfo&quot;:[0],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr="" client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var i=t=>{let e=async()=>{await(await t())()};"requestIdleCallback"in window?window.requestIdleCallback(e):setTimeout(e,200)};(self.Astro||(self.Astro={})).idle=i;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="ZARFt5" prefix="r3" component-url="/_astro/Navigation.ElaEfQ9R.js" component-export="Navigation" renderer-url="/_astro/client.BQCS8AJJ.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Post&quot;],&quot;slug&quot;:[0,&quot;bringing-ai-to-cloudflare&quot;],&quot;translationsAvailable&quot;:[1,[[0,&quot;zh-cn&quot;],[0,&quot;zh-tw&quot;],[0,&quot;ja-jp&quot;],[0,&quot;ko-kr&quot;]]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:31:56.525Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,5],&quot;revision&quot;:[0,3],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:30:18.450Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,9],&quot;revision&quot;:[0,5],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:27:43.433Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,7],&quot;revision&quot;:[0,4],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:24:27.531Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,11],&quot;revision&quot;:[0,6],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:19:10.215Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,9],&quot;revision&quot;:[0,5],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:14:33.876Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,13],&quot;revision&quot;:[0,7],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;7ibnRrkJ2kfMuo3JOo0Y69&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:47:23.765Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:12:33.734Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,5],&quot;revision&quot;:[0,3],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy&quot;],&quot;name&quot;:[0,&quot;Policy&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:08:03.099Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,10],&quot;revision&quot;:[0,5],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2024-10-10T07:05:21.343Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,9],&quot;revision&quot;:[0,5],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr="" client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children=""><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span><span class="f1 gray4 dn di-l pr1">|</span><div class="relative flex cf-dropdown"><div class="flex items-center" dir="ltr"><button type="button" class="f1 gray4 no-underline language-picker js-language-picker" style="background:transparent;border:none;padding:0"><span class="language-picker__globe-icon"></span><span class="language-picker__caret-icon ph1">â¼</span></button></div></div></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute w-90 ph3 z-1"><div class="pv3 ph2 tl"><a href="/tag/product-news" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/security" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/zero-trust" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/developers" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/ai" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/policy" class="no-underline gray1 f4 fw7">Policy</a></div><div class="pv3 ph2 tl"><a href="/tag/partners" class="no-underline gray1 f4 fw7">Partners</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy" class="no-underline gray1 f2 fw5 pv3">Policy</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island><progress class="reading-progress" value="0" max="100" aria-label="Reading progress"></progress><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="ZloyWn" prefix="r1" component-url="/_astro/Post.CntyhspV.js" component-export="Post" renderer-url="/_astro/client.BQCS8AJJ.js" props="{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;6HqKUMoXg0wFIQg9howLMX&quot;],&quot;title&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection&quot;],&quot;slug&quot;:[0,&quot;bringing-ai-to-cloudflare&quot;],&quot;excerpt&quot;:[0,&quot;This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &amp; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;The continued growth of AI has fundamentally changed the Internet over the past 24 months. AI is increasingly ubiquitous, and Cloudflare is leaning into the new opportunities and challenges it presents in a big way. This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added AI bot traffic insights on Cloudflare Radar, and given customers new AI bot blocking capabilities.Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;ai-assistant-for-waf-rule-builder\&quot;&gt;AI Assistant for WAF Rule Builder&lt;/h2&gt;\n            &lt;a href=\&quot;#ai-assistant-for-waf-rule-builder\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5RYC4wmCDbs0axY92FfkFk/a728906cb6a902dd1c78ec93a0f650c2/BLOG-2564_1.png\&quot; alt=\&quot;BLOG-2564 1\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;501\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;At Cloudflare, weâre always listening to your feedback and striving to make our products as user-friendly and powerful as possible. One area where we&amp;#39;ve heard your feedback loud and clear is in the complexity of creating custom and rate-limiting rules for our Web Application Firewall (WAF). With this in mind, weâre excited to introduce a new feature that will make rule creation easier and more intuitive: the AI Assistant for WAF Rule Builder.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7avSjubqlfg7L8ymKEztgk/7c3c31e50879ec64bccc384bdfcd5524/BLOG-2564_2.png\&quot; alt=\&quot;BLOG-2564 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1056\&quot; height=\&quot;1460\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;By simply entering a natural language prompt, you can generate a custom or rate-limiting rule tailored to your needs. For example, instead of manually configuring a complex rule matching criteria, you can now type something like, &amp;quot;Match requests with low bot score,&amp;quot; and the assistant will generate the rule for you. Itâs not about creating the perfect rule in one step, but giving you a strong foundation that you can build on.Â &lt;/p&gt;&lt;p&gt;The assistant will be available in the Custom and Rate Limit Rule Builder for all WAF users. Weâre launching this feature in Beta for all customers, and we encourage you to give it a try. Weâre looking forward to hearing your feedback (via the UI itself) as we continue to refine and enhance this tool to meet your needs.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;ai-bot-traffic-insights-on-cloudflare-radar\&quot;&gt;AI bot traffic insights on Cloudflare Radar&lt;/h2&gt;\n            &lt;a href=\&quot;#ai-bot-traffic-insights-on-cloudflare-radar\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;AI platform providers use bots to crawl and scrape websites, vacuuming up data to use for model training. This is frequently done without the permission of, or a business relationship with, the content owners and providers. In July, Cloudflare urged content owners and providers to &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;u&gt;âdeclare their AIndependenceâ&lt;/u&gt;&lt;/a&gt;, providing them with a way to block AI bots, scrapers, and crawlers with a single click. In addition to this so-called âeasy buttonâ approach, sites can provide more specific guidance to these bots about what they are and are not allowed to access through directives in a &lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/bots/what-is-robots-txt/\&quot;&gt;&lt;u&gt;robots.txt&lt;/u&gt;&lt;/a&gt; file. Regardless of whether a customer chooses to block or allow requests from AI-related bots, Cloudflare has insight into request activity from these bots, and associated traffic trends over time.&lt;/p&gt;&lt;p&gt;Tracking traffic trends for AI bots can help us better understand their activity over time â which are the most aggressive and have the highest volume of requests, which launch crawls on a regular basis, etc. The new &lt;a href=\&quot;https://radar.cloudflare.com/traffic#ai-bot-crawler-traffic\&quot;&gt;&lt;b&gt;&lt;u&gt;AI bot &amp;amp; crawler traffic &lt;/u&gt;&lt;/b&gt;&lt;u&gt;graph on Radarâs Traffic page&lt;/u&gt;&lt;/a&gt; provides insight into these traffic trends gathered over the selected time period for the top known AI bots. The associated list of bots tracked here is based on the &lt;a href=\&quot;https://github.com/ai-robots-txt/ai.robots.txt\&quot;&gt;&lt;u&gt;ai.robots.txt list&lt;/u&gt;&lt;/a&gt;, and will be updated with new bots as they are identified. &lt;a href=\&quot;https://developers.cloudflare.com/api/operations/radar-get-ai-bots-timeseries-group-by-user-agent\&quot;&gt;&lt;u&gt;Time series&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/api/operations/radar-get-ai-bots-summary-by-user-agent\&quot;&gt;&lt;u&gt;summary&lt;/u&gt;&lt;/a&gt; data is available from the Radar API as well. (Traffic trends for the full set of AI bots &amp;amp; crawlers &lt;a href=\&quot;https://radar.cloudflare.com/explorer?dataSet=ai.bots\&quot;&gt;&lt;u&gt;can be viewed in the new Data Explorer&lt;/u&gt;&lt;/a&gt;.)&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5tYefQaBhTPYpqZPtE6KPu/f60694d0b24de2acba13fe0944589885/BLOG-2564_3.png\&quot; alt=\&quot;BLOG-2564 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;631\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;blocking-more-ai-bots\&quot;&gt;Blocking more AI bots&lt;/h2&gt;\n            &lt;a href=\&quot;#blocking-more-ai-bots\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/UiFu8l6K4Pm3ulxTK3XU0/541d109e29a9ae94e4792fdf94f7e4aa/BLOG-2564_4.png\&quot; alt=\&quot;BLOG-2564 4\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;501\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;For Cloudflareâs birthday, weâre following up on our previous blog post, &lt;a href=\&quot;https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/\&quot;&gt;&lt;i&gt;&lt;u&gt;Declaring Your AIndependence&lt;/u&gt;&lt;/i&gt;&lt;/a&gt;, with an update on the new detections weâve added to stop AI bots. Customers who havenât already done so can simply &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/:zone/security/bots/configure\&quot;&gt;&lt;u&gt;click the button&lt;/u&gt;&lt;/a&gt; to block AI bots to gain more protection for their website.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;enabling-dynamic-updates-for-the-ai-bot-rule\&quot;&gt;Enabling dynamic updates for the AI bot rule&lt;/h3&gt;\n            &lt;a href=\&quot;#enabling-dynamic-updates-for-the-ai-bot-rule\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The old button allowed customers to block &lt;i&gt;verified&lt;/i&gt; AI crawlers, those that respect robots.txt and crawl rate, and donât try to hide their behavior. Weâve added new crawlers to that list, but weâve also expanded the previous rule to include 27 signatures (and counting) of AI bots that &lt;i&gt;donât &lt;/i&gt;follow the rules. We want to take time to say âthank youâ to everyone who took the time to use our â&lt;a href=\&quot;https://docs.google.com/forms/d/14bX0RJH_0w17_cAUiihff5b3WLKzfieDO4upRlo5wj8\&quot;&gt;&lt;u&gt;tip line&lt;/u&gt;&lt;/a&gt;â to point us towards new AI bots. These tips have been extremely helpful in finding some bots that would not have been on our radar so quickly.Â &lt;/p&gt;&lt;p&gt;For each bot weâve added, weâre also adding them to our âDefinitely automatedâ definition as well. So, if youâre a self-service plan customer using &lt;a href=\&quot;https://blog.cloudflare.com/super-bot-fight-mode/\&quot;&gt;&lt;u&gt;Super Bot Fight Mode&lt;/u&gt;&lt;/a&gt;, youâre already protected. Enterprise Bot Management customers will see more requests shift from the âLikely Botâ range to the âDefinitely automatedâ range, which weâll discuss more below.&lt;/p&gt;&lt;p&gt;Under the hood, weâve converted this rule logic to a &lt;a href=\&quot;https://developers.cloudflare.com/waf/managed-rules/\&quot;&gt;&lt;u&gt;Cloudflare managed rule&lt;/u&gt;&lt;/a&gt; (the same framework that powers our WAF). This enables our security analysts and engineers to safely push updates to the rule in real-time, similar to how new WAF rule changes are rapidly delivered to ensure our customers are protected against the latest CVEs. If you havenât logged back into the Bots dashboard since the previous version of our AI bot protection was announced, click the button again to update to the latest protection.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2tI8Yqxt1S0UPapImb32J4/6cb9e9bf423c370383edb820e5722929/BLOG-2564_5.png\&quot; alt=\&quot;BLOG-2564 5\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;522\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-impact-of-new-fingerprints-on-the-model\&quot;&gt;The impact of new fingerprints on the modelÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#the-impact-of-new-fingerprints-on-the-model\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;One hidden beneficiary of fingerprinting new AI bots is our ML model. &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more/\&quot;&gt;&lt;u&gt;As weâve discussed before&lt;/u&gt;&lt;/a&gt;, our global ML model uses supervised machine learning and greatly benefits from more sources of labeled bot data. Below, you can see how well our ML model recognized these requests as automated, before and after we updated the button, adding new rules. To keep things simple, we have shown only the top 5 bots by the volume of requests on the chart. With the introduction of our new managed rule, we have observed an improvement in our detection capabilities for the majority of these AI bots. Button v1 represents the old option that let customers block only verified AI crawlers, while Button v2 is the newly introduced feature that includes managed rule detections.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2CZVGyDCp9ZtMrZdIi49fE/aacd04d240e9348b5a9b65bad4b470e2/BLOG-2564_6.jpg\&quot; alt=\&quot;BLOG-2564 6\&quot; class=\&quot;kg-image\&quot; width=\&quot;1887\&quot; height=\&quot;1406\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;So how did we make our detections more robust? As we have mentioned before, sometimes &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more/\&quot;&gt;&lt;i&gt;&lt;u&gt;a single attribute can give a bot away&lt;/u&gt;&lt;/i&gt;&lt;/a&gt;. We developed a sophisticated set of heuristics tailored to these AI bots, enabling us to effortlessly and accurately classify them as such. Although our ML model was already detecting the vast majority of these requests, the integration of additional heuristics has resulted in a noticeable increase in detection rates for each bot, and ensuring we score every request correctly 100% of the time. Transitioning from a purely machine learning approach to incorporating heuristics offers several advantages, including faster detection times and greater certainty in classification. While deploying a machine learning model is complex and time-consuming, new heuristics can be created in minutes.Â &lt;/p&gt;&lt;p&gt;The initial launch of the AI bots block button was well-received and is now used by over 133,000 websites, with significant adoption even among our Free tier customers. The newly updated button, launched on August 20, 2024, is rapidly gaining traction. Over 90,000 zones have already adopted the new rule, with approximately 240 new sites integrating it every hour. Overall, we are now helping to protect the intellectual property of more than 146,000 sites from AI bots, and we are currently blocking 66 million requests daily with this new rule. Additionally, weâre excited to announce that support for configuring AI bots protection via Terraform will be available by the end of this year, providing even more flexibility and control for managing your bot protection settings.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;bot-behavior\&quot;&gt;Bot behavior&lt;/h3&gt;\n            &lt;a href=\&quot;#bot-behavior\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;With the enhancements to our detection capabilities, it is essential to assess the impact of these changes to bot activity on the Internet. Since the launch of the updated AI bots block button, we have been closely monitoring for any shifts in bot activity and adaptation strategies. The most basic fingerprinting technique we use to identify AI bot looking for simple user-agent matches. User-agent matches are important to monitor because they indicate the bot is transparently announcing who they are when theyâre crawling a website.Â &lt;/p&gt;&lt;p&gt;The graph below shows a volume of traffic we label as AI bot over the past two months. The blue line indicates the daily request count, while the red line represents the monthly average number of requests. In the past two months, we have seen an average reduction of nearly 30 million requests, with a decrease of 40 million in the most recent month.This decline coincides with the release of Button v1 and Button v2. Our hypothesis is that with the new AI bots blocking feature, Cloudflare is blocking a majority of these bots, which is discouraging them from crawling.Â &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/23ULxmxBIRskEONlWVIvlA/1dbd3d03239047492c2d4f7307217d97/BLOG-2564_7.jpg\&quot; alt=\&quot;BLOG-2564 7\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1048\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This hypothesis is supported by the observed decline in requests from several top AI crawlers. Specifically, the Bytespider bot reduced its daily requests from approximately 100 million to just 50 million between the end of June and the end of August (see graph below). This reduction could be attributed to several factors, including our new AI bots block button and changes in the crawler&amp;#39;s strategy.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UwtyZSXULrVzIqLcICGKd/fdf02c15d17e1d7ed248ba5f8a97eb54/BLOG-2564_8.jpg\&quot; alt=\&quot;BLOG-2564 8\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;993\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;We have also observed an increase in the accountability of some AI crawlers. The most basic fingerprinting technique we use to identify AI bot looking for simple user-agent matches. User-agent matches are important to monitor because they indicate the bot is transparently announcing who they are when theyâre crawling a website. These crawlers are now more frequently using their agents, reflecting a shift towards more transparent and responsible behavior. Notably, there has been a dramatic surge in the number of requests from the Perplexity user agent. This increase might be linked to &lt;a href=\&quot;https://rknight.me/blog/perplexity-ai-is-lying-about-its-user-agent/\&quot;&gt;previous accusations&lt;u&gt; &lt;/u&gt;&lt;/a&gt;that Perplexity did not properly present its user agent, which could have prompted a shift in their approach to ensure better identification and compliance. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7Hq2vUMqqdNCyaxNTCg3JD/610ad53d57203203c5176229245c8086/BLOG-2564_9.jpg\&quot; alt=\&quot;BLOG-2564 9\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;991\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;These trends suggest that our updates are likely affecting how AI crawlers interact with content. We will continue to monitor AI bot activity to help users control who accesses their content and how. By keeping a close watch on emerging patterns, we aim to provide users with the tools and insights needed to make informed decisions about managing their traffic.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;wrap-up\&quot;&gt;Wrap up&lt;/h2&gt;\n            &lt;a href=\&quot;#wrap-up\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Weâre excited to continue to explore the AI landscape, whether weâre finding more ways to make the Cloudflare dashboard usable or new threats to guard against. Our AI insights on Radar update in near real-time, so please join us in watching as new trends emerge and discussing them in the &lt;a href=\&quot;https://community.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Community&lt;/u&gt;&lt;/a&gt;.Â &lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-09-27T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-22T01:49:14.466Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/32vnNHpfRqiOypOggowFgw/d075a178424e42324b9b7cb586a401f1/image3.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1Cv5JjXzKWKEA10JdYbXu1&quot;],&quot;name&quot;:[0,&quot;Birthday Week&quot;],&quot;slug&quot;:[0,&quot;birthday-week&quot;]}],[0,{&quot;id&quot;:[0,&quot;267TTPMscUWABgYgHSH4ye&quot;],&quot;name&quot;:[0,&quot;Bot Management&quot;],&quot;slug&quot;:[0,&quot;bot-management&quot;]}],[0,{&quot;id&quot;:[0,&quot;4l3WDYLk6bXCyaRc9pRzXa&quot;],&quot;name&quot;:[0,&quot;Bots&quot;],&quot;slug&quot;:[0,&quot;bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;3404RT2rd0b1M4ZCCIceXx&quot;],&quot;name&quot;:[0,&quot;AI Bots&quot;],&quot;slug&quot;:[0,&quot;ai-bots&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1HAYmR545ufVxM2rQzz0SE&quot;],&quot;name&quot;:[0,&quot;Machine Learning&quot;],&quot;slug&quot;:[0,&quot;machine-learning&quot;]}],[0,{&quot;id&quot;:[0,&quot;6pD9OvooldcqcJ8z8Y6QQ1&quot;],&quot;name&quot;:[0,&quot;Generative AI&quot;],&quot;slug&quot;:[0,&quot;generative-ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Efeqd1oZ7vy3xls0fdjHF&quot;],&quot;name&quot;:[0,&quot;Agile Developer Services&quot;],&quot;slug&quot;:[0,&quot;agile-developer-services&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;36Dg2NwTgUHhrlE0FRpSdJ&quot;],&quot;name&quot;:[0,&quot;Application Services&quot;],&quot;slug&quot;:[0,&quot;application-services&quot;]}],[0,{&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Adam Martinetti&quot;],&quot;slug&quot;:[0,&quot;adam-martinetti&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@adamemcf&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Harsh Saxena&quot;],&quot;slug&quot;:[0,&quot;harsh-saxena&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1eEVnuAy0vFvqrA4DuCOyI/56dcd6d40b152672d6a5a3bedae2f623/Harsh_S.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Gauri Baraskar&quot;],&quot;slug&quot;:[0,&quot;gauri-baraskar&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1x0TXREl9zWwQIqwIEeLIK/0eaa91581ceae8a561596e2f29257250/Gauri_B.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Carlos Azevedo&quot;],&quot;slug&quot;:[0,&quot;carlos&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2xzs8tkcfue8Y8BHqsqwIV/f3210160c003f0a7da3baa3c51f90511/carlos.png&quot;],&quot;location&quot;:[0,&quot;Lisbon&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;David Belson&quot;],&quot;slug&quot;:[0,&quot;david-belson&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/en7vkXf6rLBm4F8IcNHXT/645022bf841fabff7732aa3be3949808/david-belson.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@dbelson&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &amp; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection LOC&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;Translated for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/bringing-ai-to-cloudflare&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection&quot;],&quot;description&quot;:[0,&quot;This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added new AI bot &amp; crawler traffic insights to Radar, and given customers new AI bot blocking capabilities.  &quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4wipGwjeGhBdS8jXcC3KTh/d0c08a22b6e93718e0b2d171adb845cb/AI_Everywhere_with_the_WAF_Rule_Builder_Assistant__Cloudflare_Radar_AI_Insights__and_updated_AI_bot_protection-OG.png&quot;]}]}],&quot;initialReadingTime&quot;:[0,&quot;7&quot;],&quot;relatedPosts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;5GK429XQHhFzVyKSXGZ2R6&quot;],&quot;title&quot;:[0,&quot;Elephants in tunnels: how Hyperdrive connects to databases inside your VPC networks&quot;],&quot;slug&quot;:[0,&quot;elephants-in-tunnels-how-hyperdrive-connects-to-databases-inside-your-vpc-networks&quot;],&quot;excerpt&quot;:[0,&quot;Hyperdrive (Cloudflareâs globally distributed SQL connection pooler and cache) recently added support for directing database traffic from Workers across Cloudflare Tunnels. We dive deep on what it took to add this feature.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;&lt;p&gt;With Septemberâs &lt;a href=\&quot;https://blog.cloudflare.com/builder-day-2024-announcements/#connect-to-private-databases-from-workers\&quot;&gt;&lt;u&gt;announcement&lt;/u&gt;&lt;/a&gt; of Hyperdriveâs ability to send database traffic from &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;Workers&lt;/u&gt;&lt;/a&gt; over &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/\&quot;&gt;&lt;u&gt;Cloudflare Tunnels&lt;/u&gt;&lt;/a&gt;, we wanted to dive into the details of what it took to make this happen.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;hyper-who\&quot;&gt;Hyper-who?&lt;/h2&gt;\n            &lt;a href=\&quot;#hyper-who\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Accessing your data from anywhere in Region Earth can be hard. Traditional databases are powerful, familiar, and feature-rich, but your users can be thousands of miles away from your database. This can cause slower connection startup times, slower queries, and connection exhaustion as everything takes longer to accomplish.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/workers/\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt; is an incredibly lightweight runtime, which enables our customers to deploy their applications globally by default and renders the &lt;a href=\&quot;https://en.wikipedia.org/wiki/Cold_start_(computing)\&quot;&gt;&lt;u&gt;cold start&lt;/u&gt;&lt;/a&gt; problem almost irrelevant. The trade-off for these light, ephemeral execution contexts is the lack of persistence for things like database connections. Database connections are also notoriously expensive to spin up, with many round trips required between client and server before any query or result bytes can be exchanged.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://blog.cloudflare.com/hyperdrive-making-regional-databases-feel-distributed\&quot;&gt;&lt;u&gt;Hyperdrive&lt;/u&gt;&lt;/a&gt; is designed to make the centralized databases you already have feel like theyâre global while keeping connections to those databases hot. We use our &lt;a href=\&quot;https://www.cloudflare.com/network/\&quot;&gt;&lt;u&gt;global network&lt;/u&gt;&lt;/a&gt; to get faster routes to your database, keep connection pools primed, and cache your most frequently run queries as close to users as possible.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;why-a-tunnel\&quot;&gt;Why a Tunnel?&lt;/h2&gt;\n            &lt;a href=\&quot;#why-a-tunnel\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;For something as sensitive as your database, exposing access to the public Internet can be uncomfortable. It is common to instead host your database on a private network, and allowlist known-safe IP addresses or configure &lt;a href=\&quot;https://www.cloudflare.com/learning/network-layer/what-is-gre-tunneling/\&quot;&gt;&lt;u&gt;GRE tunnels&lt;/u&gt;&lt;/a&gt; to permit traffic to it. This is complex, toilsome, and error-prone.Â &lt;/p&gt;&lt;p&gt;On Cloudflareâs &lt;a href=\&quot;https://www.cloudflare.com/en-gb/developer-platform/\&quot;&gt;&lt;u&gt;Developer Platform&lt;/u&gt;&lt;/a&gt;, we strive for simplicity and ease-of-use. We cannot expect all of our customers to be experts in configuring networking solutions, and so we went in search of a simpler solution. &lt;a href=\&quot;https://www.cloudflare.com/the-net/top-of-mind-security/customer-zero/\&quot;&gt;&lt;u&gt;Being your own customer&lt;/u&gt;&lt;/a&gt; is rarely a bad choice, and it so happens that Cloudflare offers an excellent option for this scenario: Tunnels.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://www.cloudflare.com/products/tunnel/\&quot;&gt;&lt;u&gt;Cloudflare Tunnel&lt;/u&gt;&lt;/a&gt; is a Zero Trust product that creates a secure connection between your private network and Cloudflare. Exposing services within your private network can be as simple as &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/downloads/\&quot;&gt;&lt;u&gt;running a &lt;/u&gt;&lt;code&gt;&lt;u&gt;cloudflared&lt;/u&gt;&lt;/code&gt;&lt;u&gt; binary&lt;/u&gt;&lt;/a&gt;, or deploying a Docker container running the &lt;a href=\&quot;https://hub.docker.com/r/cloudflare/cloudflared\&quot;&gt;&lt;code&gt;&lt;u&gt;cloudflared&lt;/u&gt;&lt;/code&gt;&lt;u&gt; image we distribute&lt;/u&gt;&lt;/a&gt;. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3182f43rbwdH9krF1xhdlC/d22430cdb1efa134031f94fea691c36e/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1000\&quot; height=\&quot;180\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;a-custom-handler-and-generic-streams\&quot;&gt;A custom handler and generic streams&lt;/h2&gt;\n            &lt;a href=\&quot;#a-custom-handler-and-generic-streams\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Integrating with Tunnels to support sending Postgres directly through them was a bit of a new challenge for us. Most of the time, when we use Tunnels internally (more on that later!), we rely on the excellent job &lt;code&gt;cloudflared&lt;/code&gt; does of handling all of the mechanics, and we just treat them as pipes. That wouldnât work for Hyperdrive, though, so we had to dig into how Tunnels actually ingress traffic to build a solution.&lt;/p&gt;&lt;p&gt;Hyperdrive handles Postgres traffic using an entirely custom implementation of the &lt;a href=\&quot;https://www.postgresql.org/docs/current/protocol.html\&quot;&gt;&lt;u&gt;Postgres message protocol&lt;/u&gt;&lt;/a&gt;. This is necessary, because we sometimes have to &lt;a href=\&quot;https://blog.cloudflare.com/postgres-named-prepared-statements-supported-hyperdrive\&quot;&gt;&lt;u&gt;alter the specific type or content&lt;/u&gt;&lt;/a&gt; of messages sent from client to server, or vice versa. Handling individual bytes gives us the flexibility to implement whatever logic any new feature might need.&lt;/p&gt;&lt;p&gt;An additional, perhaps less obvious, benefit of handling Postgres message traffic as just bytes is that we are not bound to the transport layer choices of some &lt;a href=\&quot;https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping\&quot;&gt;&lt;u&gt;ORM&lt;/u&gt;&lt;/a&gt; or library. One of the nuances of running services in Cloudflare is that we may want to egress traffic over different services or protocols, for a variety of different reasons. In this case, being able to egress traffic via a Tunnel would be pretty challenging if we were stuck with whatever raw TCP socket a library had established for us.&lt;/p&gt;&lt;p&gt;The way we accomplish this relies on a mainstay of Rust: &lt;a href=\&quot;https://doc.rust-lang.org/book/ch10-02-traits.html\&quot;&gt;&lt;u&gt;traits&lt;/u&gt;&lt;/a&gt; (which are how Rust lets developers apply logic across generic functions and types). In the Rust ecosystem, there are two traits that define the behavior Hyperdrive wants out of its transport layers: &lt;a href=\&quot;https://docs.rs/tokio/latest/tokio/io/trait.AsyncRead.html\&quot;&gt;&lt;code&gt;&lt;u&gt;AsyncRead&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; and &lt;a href=\&quot;https://docs.rs/tokio/latest/tokio/io/trait.AsyncWrite.html\&quot;&gt;&lt;code&gt;&lt;u&gt;AsyncWrite&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;. There are a couple of others we also need, but weâre going to focus on just these two. These traits enable us to code our entire custom handler against a generic stream of data, without the handler needing to know anything about the underlying protocol used to implement the stream. So, we can pass around a WebSocket connection as a generic I/O stream, wherever it might be needed.&lt;/p&gt;&lt;p&gt;As an example, the code to create a generic TCP stream and send a Postgres startup message across it might look like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;/// Send a startup message to a Postgres server, in the role of a PG client.\n/// https://www.postgresql.org/docs/current/protocol-message-formats.html#PROTOCOL-MESSAGE-FORMATS-STARTUPMESSAGE\npub async fn send_startup&amp;lt;S&amp;gt;(stream: &amp;amp;mut S, user_name: &amp;amp;str, db_name: &amp;amp;str, app_name: &amp;amp;str) -&amp;gt; Result&amp;lt;(), ConnectionError&amp;gt;\nwhere\n    S: AsyncWrite + Unpin,\n{\n    let protocol_number = 196608 as i32;\n    let user_str = &amp;amp;b&amp;quot;user\\0&amp;quot;[..];\n    let user_bytes = user_name.as_bytes();\n    let db_str = &amp;amp;b&amp;quot;database\\0&amp;quot;[..];\n    let db_bytes = db_name.as_bytes();\n    let app_str = &amp;amp;b&amp;quot;application_name\\0&amp;quot;[..];\n    let app_bytes = app_name.as_bytes();\n    let len = 4 + 4\n        + user_str.len() + user_bytes.len() + 1\n        + db_str.len() + db_bytes.len() + 1\n        + app_str.len() + app_bytes.len() + 1 + 1;\n\n    // Construct a BytesMut of our startup message, then send it\n    let mut startup_message = BytesMut::with_capacity(len as usize);\n    startup_message.put_i32(len as i32);\n    startup_message.put_i32(protocol_number);\n    startup_message.put(user_str);\n    startup_message.put_slice(user_bytes);\n    startup_message.put_u8(0);\n    startup_message.put(db_str);\n    startup_message.put_slice(db_bytes);\n    startup_message.put_u8(0);\n    startup_message.put(app_str);\n    startup_message.put_slice(app_bytes);\n    startup_message.put_u8(0);\n    startup_message.put_u8(0);\n\n    match stream.write_all(&amp;amp;startup_message).await {\n        Ok(_) =&amp;gt; Ok(()),\n        Err(err) =&amp;gt; {\n            error!(&amp;quot;Error writing startup to server: {}&amp;quot;, err.to_string());\n            ConnectionError::InternalError\n        }\n    }\n}\n\n/// Connect to a TCP socket\nlet stream = match TcpStream::connect((&amp;quot;localhost&amp;quot;, 5432)).await {\n    Ok(s) =&amp;gt; s,\n    Err(err) =&amp;gt; {\n        error!(&amp;quot;Error connecting to address: {}&amp;quot;, err.to_string());\n        return ConnectionError::InternalError;\n    }\n};\nlet _ = send_startup(&amp;amp;mut stream, &amp;quot;db_user&amp;quot;, &amp;quot;my_db&amp;quot;).await;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;With this approach, if we wanted to encrypt the stream using &lt;a href=\&quot;https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/#:~:text=Transport%20Layer%20Security%2C%20or%20TLS,web%20browsers%20loading%20a%20website.\&quot;&gt;&lt;u&gt;TLS&lt;/u&gt;&lt;/a&gt; before we write to it (upgrading our existing &lt;code&gt;TcpStream&lt;/code&gt; connection in-place, to an &lt;code&gt;SslStream&lt;/code&gt;), we would only have to change the code we use to create the stream, while generating and sending the traffic would remain unchanged. This is because &lt;code&gt;SslStream&lt;/code&gt; also implements &lt;code&gt;AsyncWrite&lt;/code&gt;!&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;/// We&amp;#039;re handwaving the SSL setup here. You&amp;#039;re welcome.\nlet conn_config = new_tls_client_config()?;\n\n/// Encrypt the TcpStream, returning an SslStream\nlet ssl_stream = match tokio_boring::connect(conn_config, domain, stream).await {\n    Ok(s) =&amp;gt; s,\n    Err(err) =&amp;gt; {\n        error!(&amp;quot;Error during websocket TLS handshake: {}&amp;quot;, err.to_string());\n        return ConnectionError::InternalError;\n    }\n};\nlet _ = send_startup(&amp;amp;mut ssl_stream, &amp;quot;db_user&amp;quot;, &amp;quot;my_db&amp;quot;).await;&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;whence-websocket\&quot;&gt;Whence WebSocket&lt;/h2&gt;\n            &lt;a href=\&quot;#whence-websocket\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;&lt;a href=\&quot;https://datatracker.ietf.org/doc/html/rfc6455\&quot;&gt;&lt;u&gt;WebSocket&lt;/u&gt;&lt;/a&gt; is an application layer protocol that enables bidirectional communication between a client and server. Typically, to establish a WebSocket connection, a client initiates an HTTP request and indicates they wish to upgrade the connection to WebSocket via the âUpgradeâ header. Then, once the client and server complete the handshake, both parties can send messages over the connection until one of them terminates it.&lt;/p&gt;&lt;p&gt;Now, it turns out that the way Cloudflare Tunnels work under the hood is that both ends of the tunnel want to speak WebSocket, and rely on a translation layer to convert all traffic to or from WebSocket. The &lt;code&gt;cloudflared&lt;/code&gt; daemon you spin up within your private network handles this for us! For Hyperdrive, however, we did not have a suitable translation layer to send Postgres messages across WebSocket, and had to write one.&lt;/p&gt;&lt;p&gt;One of the (many) fantastic things about Rust traits is that the contract they present is very clear. To be &lt;code&gt;AsyncRead&lt;/code&gt;, you just need to implement &lt;code&gt;poll_read&lt;/code&gt;. To be &lt;code&gt;AsyncWrite&lt;/code&gt;, you need to implement only three functions (&lt;code&gt;poll_write&lt;/code&gt;, &lt;code&gt;poll_flush&lt;/code&gt;, and &lt;code&gt;poll_shutdown&lt;/code&gt;). Further, there is excellent support for WebSocket in Rust built on top of the &lt;a href=\&quot;https://github.com/snapview/tungstenite-rs\&quot;&gt;&lt;u&gt;tungstenite-rs library&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Thus, building our custom WebSocket stream such that it can share the same machinery as all our other generic streams just means translating the existing WebSocket support into these poll functions. There are some existing OSS projects that do this, but for multiple reasons we could not use the existing options. The primary reason is that Hyperdrive operates across multiple threads (thanks to the &lt;a href=\&quot;https://docs.rs/tokio/latest/tokio/runtime/index.html\&quot;&gt;&lt;u&gt;tokio runtime&lt;/u&gt;&lt;/a&gt;), and so we rely on our connections to also handle &lt;a href=\&quot;https://doc.rust-lang.org/std/marker/trait.Send.html\&quot;&gt;&lt;code&gt;&lt;u&gt;Send&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, &lt;a href=\&quot;https://doc.rust-lang.org/std/marker/trait.Sync.html\&quot;&gt;&lt;code&gt;&lt;u&gt;Sync&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, and &lt;a href=\&quot;https://doc.rust-lang.org/std/marker/trait.Unpin.html\&quot;&gt;&lt;code&gt;&lt;u&gt;Unpin&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;. None of the available solutions had all five traits handled. It turns out that most of them went with the paradigm of &lt;a href=\&quot;https://docs.rs/futures/latest/futures/sink/trait.Sink.html\&quot;&gt;&lt;code&gt;&lt;u&gt;Sink&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; and &lt;a href=\&quot;https://docs.rs/futures/latest/futures/stream/trait.Stream.html\&quot;&gt;&lt;code&gt;&lt;u&gt;Stream&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;, which provide a solid base from which to translate to &lt;code&gt;AsyncRead&lt;/code&gt; and &lt;code&gt;AsyncWrite&lt;/code&gt;. In fact some of the functions overlap, and can be passed through almost unchanged. For example, &lt;code&gt;poll_flush&lt;/code&gt; and &lt;code&gt;poll_shutdown&lt;/code&gt; have 1-to-1 analogs, and require almost no engineering effort to convert from &lt;code&gt;Sink&lt;/code&gt; to &lt;code&gt;AsyncWrite&lt;/code&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;/// We use this struct to implement the traits we need on top of a WebSocketStream\npub struct HyperSocket&amp;lt;S&amp;gt;\nwhere\n    S: AsyncRead + AsyncWrite + Send + Sync + Unpin,\n{\n    inner: WebSocketStream&amp;lt;S&amp;gt;,\n    read_state: Option&amp;lt;ReadState&amp;gt;,\n    write_err: Option&amp;lt;Error&amp;gt;,\n}\n\nimpl&amp;lt;S&amp;gt; AsyncWrite for HyperSocket&amp;lt;S&amp;gt;\nwhere\n    S: AsyncRead + AsyncWrite + Send + Sync + Unpin,\n{\n    fn poll_flush(mut self: Pin&amp;lt;&amp;amp;mut Self&amp;gt;, cx: &amp;amp;mut Context&amp;lt;&amp;#039;_&amp;gt;) -&amp;gt; Poll&amp;lt;io::Result&amp;lt;()&amp;gt;&amp;gt; {\n        match ready!(Pin::new(&amp;amp;mut self.inner).poll_flush(cx)) {\n            Ok(_) =&amp;gt; Poll::Ready(Ok(())),\n            Err(err) =&amp;gt; Poll::Ready(Err(Error::new(ErrorKind::Other, err))),\n        }\n    }\n\n    fn poll_shutdown(mut self: Pin&amp;lt;&amp;amp;mut Self&amp;gt;, cx: &amp;amp;mut Context&amp;lt;&amp;#039;_&amp;gt;) -&amp;gt; Poll&amp;lt;io::Result&amp;lt;()&amp;gt;&amp;gt; {\n        match ready!(Pin::new(&amp;amp;mut self.inner).poll_close(cx)) {\n            Ok(_) =&amp;gt; Poll::Ready(Ok(())),\n            Err(err) =&amp;gt; Poll::Ready(Err(Error::new(ErrorKind::Other, err))),\n        }\n    }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;With that translation done, we can use an existing WebSocket library to upgrade our &lt;code&gt;SslStream&lt;/code&gt; connection to a Cloudflare Tunnel, and wrap the result in our &lt;code&gt;AsyncRead/AsyncWrite&lt;/code&gt; implementation. The result can then be used anywhere that our other transport streams would work, without any changes needed to the rest of our codebase!Â &lt;/p&gt;&lt;p&gt;That would look something like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;let websocket = match tokio_tungstenite::client_async(request, ssl_stream).await {\n    Ok(ws) =&amp;gt; Ok(ws),\n    Err(err) =&amp;gt; {\n        error!(&amp;quot;Error during websocket conn setup: {}&amp;quot;, err.to_string());\n        return ConnectionError::InternalError;\n    }\n};\nlet websocket_stream = HyperSocket::new(websocket));\nlet _ = send_startup(&amp;amp;mut websocket_stream, &amp;quot;db_user&amp;quot;, &amp;quot;my_db&amp;quot;).await;&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;access-granted\&quot;&gt;Access granted&lt;/h2&gt;\n            &lt;a href=\&quot;#access-granted\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;An observant reader might have noticed that in the code example above we snuck in a variable named request that we passed in when upgrading from an &lt;code&gt;SslStream to a WebSocketStream&lt;/code&gt;. This is for multiple reasons. The first reason is that Tunnels are assigned a hostname and use this hostname for routing. The second and more interesting reason is that (as mentioned above) when negotiating an upgrade from HTTP to WebSocket, a request must be sent to the server hosting the ingress side of the Tunnel to &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/HTTP/Protocol_upgrade_mechanism\&quot;&gt;&lt;u&gt;perform the upgrade&lt;/u&gt;&lt;/a&gt;. This is pretty universal, but we also add in an extra piece here.&lt;/p&gt;&lt;p&gt;At Cloudflare, we believe that &lt;a href=\&quot;https://blog.cloudflare.com/secure-by-default-understanding-new-cisa-guide/\&quot;&gt;&lt;u&gt;secure defaults&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://www.cloudflare.com/learning/security/glossary/what-is-defense-in-depth/\&quot;&gt;&lt;u&gt;defense in depth&lt;/u&gt;&lt;/a&gt; are the correct ways to build a better Internet. This is why traffic across Tunnels is encrypted, for example. However, that does not necessarily prevent unwanted traffic from being sent into your Tunnel, and therefore egressing out to your database. While Postgres offers a robust set of &lt;a href=\&quot;https://www.postgresql.org/docs/current/user-manag.html\&quot;&gt;&lt;u&gt;access control&lt;/u&gt;&lt;/a&gt; options for protecting your database, wouldnât it be best if unwanted traffic never got into your private network in the first place?Â &lt;/p&gt;&lt;p&gt;To that end, all &lt;a href=\&quot;https://developers.cloudflare.com/hyperdrive/configuration/connect-to-private-database/\&quot;&gt;&lt;u&gt;Tunnels set up for use with Hyperdrive&lt;/u&gt;&lt;/a&gt; should have a &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/applications/\&quot;&gt;&lt;u&gt;Zero Trust Access Application&lt;/u&gt;&lt;/a&gt; configured to protect them. These applications should use a &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/identity/service-tokens/\&quot;&gt;&lt;u&gt;Service Token&lt;/u&gt;&lt;/a&gt; to authorize connections. When setting up a new Hyperdrive, you have the option to provide the tokenâs ID and Secret, which will be encrypted and stored alongside the rest of your configuration. These will be presented as part of the WebSocket upgrade request to authorize the connection, allowing your database traffic through while preventing unwanted access.&lt;/p&gt;&lt;p&gt;This can be done within the requestâs headers, and might look something like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;let ws_url = format!(&amp;quot;wss://{}&amp;quot;, host);\nlet mut request = match ws_url.into_client_request() {\n    Ok(req) =&amp;gt; req,\n    Err(err) =&amp;gt; {\n        error!(\n            &amp;quot;Hostname {} could not be parsed into a valid request URL: {}&amp;quot;, \n            host,\n            err.to_string()\n        );\n        return ConnectionError::InternalError;\n    }\n};\nrequest.headers_mut().insert(\n    &amp;quot;CF-Access-Client-Id&amp;quot;,\n    http::header::HeaderValue::from_str(&amp;amp;client_id).unwrap(),\n);\nrequest.headers_mut().insert(\n    &amp;quot;CF-Access-Client-Secret&amp;quot;,\n    http::header::HeaderValue::from_str(&amp;amp;client_secret).unwrap(),\n);\n&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;building-for-customer-zero\&quot;&gt;Building for customer zero&lt;/h2&gt;\n            &lt;a href=\&quot;#building-for-customer-zero\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;If youâve been reading the blog for a long time, some of this might sound a bit familiar.Â  This isnât the first time that weâve &lt;a href=\&quot;https://blog.cloudflare.com/cloudflare-tunnel-for-postgres/\&quot;&gt;&lt;u&gt;sent Postgres traffic across a tunnel&lt;/u&gt;&lt;/a&gt;, itâs something most of us do from our laptops regularly.Â  This works very well for interactive use cases with low traffic volume and a high tolerance for latency, but historically most of our products have not been able to employ the same approach.&lt;/p&gt;&lt;p&gt;Cloudflare operates &lt;a href=\&quot;https://www.cloudflare.com/network/\&quot;&gt;&lt;u&gt;many data centers&lt;/u&gt;&lt;/a&gt; around the world, and most services run in every one of those data centers. There are some tasks, however, that make the most sense to run in a more centralized fashion. These include tasks such as managing control plane operations, or storing configuration state.Â  Nearly every Cloudflare product houses its control plane information in &lt;a href=\&quot;https://blog.cloudflare.com/performance-isolation-in-a-multi-tenant-database-environment/\&quot;&gt;&lt;u&gt;Postgres clusters&lt;/u&gt;&lt;/a&gt; run centrally in a handful of our data centers, and we use a variety of approaches for accessing that centralized data from elsewhere in our network. For example, many services currently use a push-based model to publish updates to &lt;a href=\&quot;https://blog.cloudflare.com/moving-quicksilver-into-production/\&quot;&gt;&lt;u&gt;Quicksilver&lt;/u&gt;&lt;/a&gt;, and work through the complexities implied by such a model. This has been a recurring challenge for any team looking to build a new product.&lt;/p&gt;&lt;p&gt;Hyperdriveâs entire reason for being is to make it easy to access such central databases from our global network. When we began exploring Tunnel integrations as a feature, many internal teams spoke up immediately and strongly suggested theyâd be interested in using it themselves. This was an excellent opportunity for Cloudflare to scratch its own itch, while also getting a lot of traffic on a new feature before releasing it directly to the public. As always, being âcustomer zeroâ means that we get fast feedback, more reliability over time, stronger connections between teams, and an overall better suite of products. We jumped at the chance.&lt;/p&gt;&lt;p&gt;As we rolled out early versions of Tunnel integration, we worked closely with internal teams to get them access to it, and fixed any rough spots they encountered. Weâre pleased to share that this first batch of teams have found great success building new or refactored products on Hyperdrive over Tunnels. For example: if youâve already tried out &lt;a href=\&quot;https://blog.cloudflare.com/builder-day-2024-announcements/#continuous-integration-and-delivery\&quot;&gt;&lt;u&gt;Workers Builds&lt;/u&gt;&lt;/a&gt;, or recently &lt;a href=\&quot;https://www.cloudflare.com/trust-hub/reporting-abuse/\&quot;&gt;&lt;u&gt;submitted an abuse report&lt;/u&gt;&lt;/a&gt;, youâre among our first users!Â  At the time of this writing, we have several more internal teams working to onboard, and we on the Hyperdrive team are very excited to see all the different ways in which fast and simple connections from Workers to a centralized database can help Cloudflare just as much as theyâve been helping our external customers.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;outro\&quot;&gt;Outro&lt;/h2&gt;\n            &lt;a href=\&quot;#outro\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Cloudflare is on a mission to make the Internet faster, safer, and more reliable. Hyperdrive was built to make connecting to centralized databases from the Workers runtime as quick and consistent as possible, and this latest development is designed to help all those who want to use Hyperdrive without directly exposing resources within their virtual private clouds (VPCs) on the public web.&lt;/p&gt;&lt;p&gt;To this end, we chose to build a solution around our suite of industry-leading &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/\&quot;&gt;&lt;u&gt;Zero Trust&lt;/u&gt;&lt;/a&gt; tools, and were delighted to find how simple it was to implement in our runtime given the power and extensibility of the Rust &lt;code&gt;trait&lt;/code&gt; system.Â &lt;/p&gt;&lt;p&gt;Without waiting for the ink to dry, multiple teams within Cloudflare have adopted this new feature to quickly and easily solve what have historically been complex challenges, and are happily operating it in production today.&lt;/p&gt;&lt;p&gt;And now, if you haven&amp;#39;t already, try &lt;a href=\&quot;https://developers.cloudflare.com/hyperdrive/configuration/connect-to-private-database/\&quot;&gt;&lt;u&gt;setting up Hyperdrive across a Tunnel&lt;/u&gt;&lt;/a&gt;, and let us know what you think in the &lt;a href=\&quot;https://discord.com/channels/595317990191398933/1150557986239021106\&quot;&gt;&lt;u&gt;Hyperdrive Discord channel&lt;/u&gt;&lt;/a&gt;!&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-10-25T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-29T13:01:27.233Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/24ic7s5StC7EDyqYne4WN6/02f061b0aef358ecc2d5da4150e5b0fc/image2.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;2UVIYusJwlvsmPYl2AvSuR&quot;],&quot;name&quot;:[0,&quot;Deep Dive&quot;],&quot;slug&quot;:[0,&quot;deep-dive&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5EP9xxxSTGvFx3RIxjqIgP&quot;],&quot;name&quot;:[0,&quot;Hyperdrive&quot;],&quot;slug&quot;:[0,&quot;hyperdrive&quot;]}],[0,{&quot;id&quot;:[0,&quot;5f5l99WZnbCCF9O6Emw56A&quot;],&quot;name&quot;:[0,&quot;Postgres&quot;],&quot;slug&quot;:[0,&quot;postgres&quot;]}],[0,{&quot;id&quot;:[0,&quot;1pPf2NNj9SXrC0A0ERKp9v&quot;],&quot;name&quot;:[0,&quot;SQL&quot;],&quot;slug&quot;:[0,&quot;sql&quot;]}],[0,{&quot;id&quot;:[0,&quot;w4e8pkoz9c8xNDVhy9eNe&quot;],&quot;name&quot;:[0,&quot;Rust&quot;],&quot;slug&quot;:[0,&quot;rust&quot;]}],[0,{&quot;id&quot;:[0,&quot;1aoMsyWESTqiSKzdHZXOKW&quot;],&quot;name&quot;:[0,&quot;WebSockets&quot;],&quot;slug&quot;:[0,&quot;websockets&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Andrew Repp&quot;],&quot;slug&quot;:[0,&quot;andrew-repp&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1moTBd0N5e74Bn9NWn2ksO/9642b164dcf16e501a79e56520548aa2/andrew-repp.jpg&quot;],&quot;location&quot;:[0,&quot;Chicago, IL, USA&quot;],&quot;website&quot;:[0,&quot;http://andrewrepp.com&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Emilio AssunÃ§Ã£o&quot;],&quot;slug&quot;:[0,&quot;emilio-assuncao&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3tOkImW4PKNYEyP4o7Pkhe/ee40249c46e72656a8e2352485ec7d5e/_tmp_mini_magick20221018-42-16be3qy.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Abhishek Chanda&quot;],&quot;slug&quot;:[0,&quot;abhishek-chanda&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3P0qYqbNeI32RV8dDNiWyr/851507446803b9f182229b98e512eb5f/_tmp_mini_magick20221012-43-o7wrnr.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0,&quot;@rony358&quot;],&quot;facebook&quot;:[0]}]]],&quot;meta_description&quot;:[0,&quot;Hyperdrive (Cloudflareâs globally distributed SQL connection pooler and cache) recently added support for directing database traffic from Workers across Cloudflare Tunnels. We dive deep on what it took to add this feature.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/elephants-in-tunnels-how-hyperdrive-connects-to-databases-inside-your-vpc-networks&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Elephants in tunnels: how Hyperdrive connects to databases inside your VPC networks&quot;],&quot;description&quot;:[0,&quot;Hyperdrive (Cloudflareâs globally distributed SQL connection pooler and cache) recently added support for directing database traffic from Workers across Cloudflare Tunnels. We dive deep on what it took to add this feature.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3ut6WBHomsRN0iP92D1hpp/ecdc9573ebc09c140c865494d029f54e/image2.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;1YRfz7LKvAGrEMbRGhNrFP&quot;],&quot;title&quot;:[0,&quot;Build durable applications on Cloudflare Workers: you write the Workflows, we take care of the rest&quot;],&quot;slug&quot;:[0,&quot;building-workflows-durable-execution-on-workers&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare Workflows is now in open beta! Workflows allows you to build reliable, repeatable, long-lived multi-step applications that can automatically retry, persist state, and scale out. Read on to learn how Workflows works, how we built it on top of Durable Objects, and how you can deploy your first Workflows application.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Workflows, Cloudflareâs durable execution engine that allows you to build reliable, repeatable multi-step applications that scale for you, is now in open beta. Any developer with a free or paid &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;Workers&lt;/u&gt;&lt;/a&gt; plan can build and deploy a Workflow right now: no waitlist, no sign-up form, no fake line around-the-block.&lt;/p&gt;&lt;p&gt;If you learn by doing, you can create your first Workflow via a single command (or &lt;a href=\&quot;https://developers.cloudflare.com/workflows/get-started/guide/\&quot;&gt;&lt;u&gt;visit the docs for the full guide)&lt;/u&gt;&lt;/a&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;npm create cloudflare@latest workflows-starter -- \\\n  --template &amp;quot;cloudflare/workflows-starter&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Open the &lt;code&gt;src/index.ts&lt;/code&gt; file, poke around, start extending it, and deploy it with a quick &lt;code&gt;wrangler deploy&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;If you want to learn more about how Workflows works, how you can use it to build applications, and how we built it, read on.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;workflows-durable-execution\&quot;&gt;Workflows? Durable Execution?&lt;/h2&gt;\n            &lt;a href=\&quot;#workflows-durable-execution\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Workflowsâwhich we &lt;a href=\&quot;https://blog.cloudflare.com/data-anywhere-events-pipelines-durable-execution-workflows/#durable-execution\&quot;&gt;&lt;u&gt;announced back during Developer Week&lt;/u&gt;&lt;/a&gt; earlier this yearâis our take on the concept of âDurable Executionâ: the ability to build and execute applications that are &lt;i&gt;durable&lt;/i&gt; in the face of errors, network issues, upstream API outages, rate limits, and (most importantly) infrastructure failure.&lt;/p&gt;&lt;p&gt;As &lt;a href=\&quot;https://cloudflare.tv/event/xvm4qdgm?startTime=8m5s\&quot;&gt;&lt;u&gt;over 2.4 million developers&lt;/u&gt;&lt;/a&gt; continue to build applications on top of Cloudflare Workers, R2, and Workers AI, weâve noticed more developers building multi-step applications and workflows that process user data, transform unstructured data into structured, export metrics, persist state as they progress, and automatically retry &amp;amp; restart. But writing any non-trivial application and making it &lt;i&gt;durable&lt;/i&gt; in the face of failure is hard: this is where Workflows comes in. Workflows manages the retries, emitting the metrics, and durably storing the state (without you having to stand up your own database) as the Workflow progresses.&lt;/p&gt;&lt;p&gt;What makes Workflows different from other takes on âDurable Executionâ is that we manage the underlying compute and storage infrastructure for you. Youâre not left managing a compute cluster and hoping it scales both up (on a Monday morning) and down (during quieter periods) to manage costs, or ensuring that you have compute running in the right locations. Workflows is built on Cloudflare Workers â our job is to run your code and operate the infrastructure for you.&lt;/p&gt;&lt;p&gt;As an example of how Workflows can help you build durable applications, assume you want to post-process file uploads from your users that were uploaded to an R2 bucket directly via &lt;a href=\&quot;https://developers.cloudflare.com/r2/api/s3/presigned-urls/\&quot;&gt;&lt;u&gt;a pre-signed URL&lt;/u&gt;&lt;/a&gt;. That post-processing could involve multiple actions: text extraction via a &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/models/\&quot;&gt;&lt;u&gt;Workers AI model&lt;/u&gt;&lt;/a&gt;, calls to a third-party API to validate data, updating or querying rows in a database once the file has been processedâ¦ the list goes on.&lt;/p&gt;&lt;p&gt;But what each of these actions has in common is that it could &lt;i&gt;fail&lt;/i&gt;. Maybe that upstream API is unavailable, maybe you get rate-limited, maybe your database is down. Having to write extensive retry logic around each action, manage backoffs, and (importantly) ensure your application doesnât have to start from scratch when a later &lt;i&gt;step&lt;/i&gt; fails is more boilerplate to write and more code to test and debug.&lt;/p&gt;&lt;p&gt;Whatâs a &lt;i&gt;step, &lt;/i&gt;you ask? The core building block of every Workflow is the step: an individually retriable component of your application that can optionally emit state. That state is then persisted, even if subsequent steps were to fail. This means that your application doesnât have to restart, allowing it to not only recover more quickly from failure scenarios, but it can also avoid doing redundant work. You donât want your application hammering an expensive third-party API (or getting you rate limited) because itâs naively retrying an API call that you donât have to.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export class MyWorkflow extends WorkflowEntrypoint&amp;lt;Env, Params&amp;gt; {\n\tasync run(event: WorkflowEvent&amp;lt;Params&amp;gt;, step: WorkflowStep) {\n\t\tconst files = await step.do(&amp;#039;my first step&amp;#039;, async () =&amp;gt; {\n\t\t\treturn {\n\t\t\t\tinputParams: event,\n\t\t\t\tfiles: [\n\t\t\t\t\t&amp;#039;doc_7392_rev3.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;report_x29_final.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;memo_2024_05_12.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;file_089_update.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;proj_alpha_v2.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;data_analysis_q2.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;notes_meeting_52.pdf&amp;#039;,\n\t\t\t\t\t&amp;#039;summary_fy24_draft.pdf&amp;#039;,\n\t\t\t\t],\n\t\t\t};\n\t\t});\n\n\t\t// Other steps...\n\t}\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Notably, a Workflow can have hundreds of steps: one of the &lt;a href=\&quot;https://developers.cloudflare.com/workflows/build/rules-of-workflows/\&quot;&gt;&lt;u&gt;Rules of Workflows&lt;/u&gt;&lt;/a&gt; is to encapsulate every API call or stateful action within your application into its own step. Each step can also define its own retry strategy, automatically backing off, adding a delay and/or (eventually) giving up after a set number of attempts.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;await step.do(\n\t&amp;#039;make a call to write that could maybe, just might, fail&amp;#039;,\n\t// Define a retry strategy\n\t{\n\t\tretries: {\n\t\t\tlimit: 5,\n\t\t\tdelay: &amp;#039;5 seconds&amp;#039;,\n\t\t\tbackoff: &amp;#039;exponential&amp;#039;,\n\t\t},\n\t\ttimeout: &amp;#039;15 minutes&amp;#039;,\n\t},\n\tasync () =&amp;gt; {\n\t\t// Do stuff here, with access to the state from our previous steps\n\t\tif (Math.random() &amp;gt; 0.5) {\n\t\t\tthrow new Error(&amp;#039;API call to $STORAGE_SYSTEM failed&amp;#039;);\n\t\t}\n\t},\n);\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;To illustrate this further, imagine you have an application that reads text files from an R2 storage bucket, pre-processes the text into chunks, generates text embeddings &lt;a href=\&quot;https://developers.cloudflare.com/workers-ai/models/bge-large-en-v1.5/\&quot;&gt;&lt;u&gt;using Workers AI&lt;/u&gt;&lt;/a&gt;, and then inserts those into a vector database (like &lt;a href=\&quot;https://developers.cloudflare.com/vectorize/\&quot;&gt;&lt;u&gt;Vectorize&lt;/u&gt;&lt;/a&gt;) for semantic search.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7b9m0rPDlGvIiTnhguyvzI/3f27678b141ce600f1f54eb999e9d671/WORKFLOWS.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;2324\&quot; height=\&quot;1000\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;In the Workflows programming model, each of those is a discrete step, and each can emit state. For example, each of the four actions below can be a discrete &lt;code&gt;step.do&lt;/code&gt; call in a Workflow:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;Reading the files from storage and emitting the list of filenames&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Chunking the text and emitting the results&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Generating text embeddings&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Upserting them into Vectorize and capturing the result of a test query&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;You can also start to imagine that some steps, such as chunking text or generating text embeddings, can be broken down into even more steps â a step per file that we chunk, or a step per API call to our text embedding model, so that our application is even more resilient to failure.&lt;/p&gt;&lt;p&gt;Steps can be created programmatically or conditionally based on input, allowing you to dynamically create steps based on the number of inputs your application needs to process. You do not need to define all steps ahead of time, and each instance of a Workflow may choose to conditionally create steps on the fly.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;building-cloudflare-on-cloudflare\&quot;&gt;Building Cloudflare on Cloudflare&lt;/h2&gt;\n            &lt;a href=\&quot;#building-cloudflare-on-cloudflare\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;As the Cloudflare Developer platform &lt;a href=\&quot;https://www.cloudflare.com/birthday-week/\&quot;&gt;&lt;u&gt;continues to grow&lt;/u&gt;&lt;/a&gt;, almost all of our own products are built on top of it. Workflows is yet another example of how we built a new product from scratch using nothing but Workers and its vast catalog of features and APIs. This section of the blog has two goals: to explain how we built it, and to demonstrate that anyone can create a complex application or platform with demanding requirements and multiple architectural layers on our stack, too.&lt;/p&gt;&lt;p&gt;If youâre wondering how Workflows manages to make durable execution easy, how it persists state, and how it automatically scales: itâs because we built it on Cloudflare Workers, including the brand-new &lt;a href=\&quot;https://blog.cloudflare.com/sqlite-in-durable-objects/\&quot;&gt;&lt;u&gt;zero-latency SQLite storage we recently introduced to Durable Objects&lt;/u&gt;&lt;/a&gt;.\n&lt;/p&gt;&lt;p&gt;To understand how Workflows uses Workers &amp;amp; Durable Objects, hereâs the high-level overview of our architecture:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7pknYk0Sshxka3iPbxBCRj/bb8b75986601e38b6b69fe8d849c0cbe/image9.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;895\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;There are three main blocks in this diagram:&lt;/p&gt;&lt;p&gt;The user-facing APIs are where the user interacts with the platform, creating and deploying new workflows or instances, controlling them, and accessing their state and activity logs. These operations can be executed through our public &lt;a href=\&quot;https://developers.cloudflare.com/api/\&quot;&gt;&lt;u&gt;API gateway&lt;/u&gt;&lt;/a&gt; using REST calls, a Worker script using bindings, &lt;a href=\&quot;https://blog.cloudflare.com/wrangler3\&quot;&gt;&lt;u&gt;Wrangler&lt;/u&gt;&lt;/a&gt; (Cloudflare&amp;#39;s developer platform command line tool), or via the &lt;a href=\&quot;https://dash.cloudflare.com/\&quot;&gt;&lt;u&gt;Dashboard&lt;/u&gt;&lt;/a&gt; user interface.&lt;/p&gt;&lt;p&gt;The managed platform holds the internal configuration APIs running on a Worker implementing a catalog of REST endpoints, the binding shim, which is supported by another dedicated Worker, every account controller, and their correspondent workflow engines, all powered by SQLite-backed Durable Objects. This is where all the magic happens and what we are sharing more details about in this technical blog.&lt;/p&gt;&lt;p&gt;Finally, there are the workflow instances, essentially independent clones of the workflow application. Instances are user account-owned and have a one-to-one relationship with a managed engine that powers them. You can run as many instances and engines as you want concurrently.&lt;/p&gt;&lt;p&gt;Let&amp;#39;s get into more detailâ¦&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;configuration-api-and-binding-shim\&quot;&gt;Configuration API and Binding Shim&lt;/h3&gt;\n            &lt;a href=\&quot;#configuration-api-and-binding-shim\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        \n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2qEGr9M8KwgPS66Ju8mELL/189db9764392c00ae34dd3a44eeb1ed7/image6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;984\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The Configuration API and the Binding Shim are two stateless Workers; one receives REST API calls from clients calling our &lt;a href=\&quot;https://developers.cloudflare.com/api/\&quot;&gt;&lt;u&gt;API Gateway&lt;/u&gt;&lt;/a&gt; directly, using &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/\&quot;&gt;&lt;u&gt;Wrangler&lt;/u&gt;&lt;/a&gt;, or navigating the &lt;a href=\&quot;https://dash.cloudflare.com/\&quot;&gt;&lt;u&gt;Dashboard&lt;/u&gt;&lt;/a&gt; UI, and the other is the endpoint for the Workflows &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/bindings/\&quot;&gt;&lt;u&gt;binding&lt;/u&gt;&lt;/a&gt;, an efficient and authenticated interface to interact with the Cloudflare Developer Platform resources from a Workers script.&lt;/p&gt;&lt;p&gt;The configuration API worker uses &lt;a href=\&quot;https://hono.dev/docs/getting-started/cloudflare-workers\&quot;&gt;&lt;u&gt;HonoJS&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://hono.dev/examples/zod-openapi\&quot;&gt;&lt;u&gt;Zod&lt;/u&gt;&lt;/a&gt; to implement the REST endpoints, which are declared in an &lt;a href=\&quot;https://swagger.io/specification/\&quot;&gt;&lt;u&gt;OpenAPI&lt;/u&gt;&lt;/a&gt; schema and exported to our API Gateway, thus adding our methods to the Cloudflare API &lt;a href=\&quot;https://developers.cloudflare.com/api/\&quot;&gt;&lt;u&gt;catalog&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { swaggerUI } from &amp;#039;@hono/swagger-ui&amp;#039;;\nimport { createRoute, OpenAPIHono, z } from &amp;#039;@hono/zod-openapi&amp;#039;;\nimport { Hono } from &amp;#039;hono&amp;#039;;\n\n...\n\nââapi.openapi(\n  createRoute({\n    method: &amp;#039;get&amp;#039;,\n    path: &amp;#039;/&amp;#039;,\n    request: {\n      query: PaginationParams,\n    },\n    responses: {\n      200: {\n        content: {\n          &amp;#039;application/json&amp;#039;: {\n             schema: APISchemaSuccess(z.array(WorkflowWithInstancesCountSchema)),\n          },\n        },\n        description: &amp;#039;List of all Workflows belonging to a account.&amp;#039;,\n      },\n    },\n  }),\n  async (ctx) =&amp;gt; {\n    ...\n  },\n);\n\n...\n\napi.route(&amp;#039;/:workflow_name&amp;#039;, routes.workflows);\napi.route(&amp;#039;/:workflow_name/instances&amp;#039;, routes.instances);\napi.route(&amp;#039;/:workflow_name/versions&amp;#039;, routes.versions);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;These Workers perform two different functions, but they share a large portion of their code and implement similar logic; once the request is authenticated and ready to travel to the next stage, they use the account ID to delegate the operation to a Durable Object called Account Controller.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;// env.ACCOUNTS is the Account Controllers Durable Objects namespace\nconst accountStubId = c.env.ACCOUNTS.idFromName(accountId.toString());\nconst accountStub = c.env.ACCOUNTS.get(accountStubId);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;As you can see, every account has its own Account Controller Durable Object.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;account-controllers\&quot;&gt;Account Controllers&lt;/h3&gt;\n            &lt;a href=\&quot;#account-controllers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The Account Controller is a dedicated persisted database that stores the list of all the accountâs workflows, versions, and instances. We scale to millions of account controllers, one per every Cloudflare account using Workflows, by leveraging the power of &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/best-practices/access-durable-objects-storage/#sqlite-storage-backend\&quot;&gt;&lt;u&gt;Durable Objects with SQLite backend&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/\&quot;&gt;&lt;u&gt;Durable Objects&lt;/u&gt;&lt;/a&gt; (DOs) are single-threaded singletons that run in our data centers and are bound to a stateful storage API, in this case, SQLite. They are also Workers, just a special kind, and have access to all of our other APIs. This makes it easy to build consistent, highly available distributed applications with them.&lt;/p&gt;&lt;p&gt;Hereâs what we get for free by using one Durable Object per Workflows account:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Sharding based on account boundaries aligns perfectly with the way we manage resources at Cloudflare internally. Also, due to the nature of DOs, there are other things that this model gets us for free: Not that we expect them, but eventual bugs or state inconsistencies during beta are confined to the affected account, and donât impact everyone.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;DO instances run close to the end user; Alice is in London and will call the config API through our &lt;a href=\&quot;https://www.cloudflare.com/en-gb/network/\&quot;&gt;&lt;u&gt;LHR data center&lt;/u&gt;&lt;/a&gt;, while Bob is in Lisbon and will connect to LIS.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Because every account is a Worker, we can gradually upgrade them to new versions, starting with the internal users, thus derisking real customers.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Before SQLite, our only option was to use the Durable Object&amp;#39;s &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/api/storage-api/#get\&quot;&gt;&lt;u&gt;key-value&lt;/u&gt;&lt;/a&gt; storage API, but having a relational database at our fingertips and being able to create tables and do complex queries is a significant enabler. For example, take a look at how we implement the internal method getWorkflow():&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;async function getWorkflow(accountId: number, workflowName: string) {\n  try {\n    const res = this.ctx.storage.transactionSync(() =&amp;gt; {\n      const cursor = Array.from(\n        this.ctx.storage.sql.exec(\n          `\n                    SELECT *,\n                    (SELECT class_name\n                        FROM   versions\n                        WHERE  workflow_id = w.id\n                        ORDER  BY created_on DESC\n                        LIMIT  1) AS class_name\n                    FROM   workflows w\n                    WHERE  w.name = ? \n                    `,\n          workflowName\n        )\n      )[0] as Workflow;\n\n      return cursor;\n    });\n\n    this.sendAnalytics(accountId, begin, &amp;quot;getWorkflow&amp;quot;);\n    return res as Workflow | undefined;\n  } catch (err) {\n    this.sendErrorAnalytics(accountId, begin, &amp;quot;getWorkflow&amp;quot;);\n    throw err;\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The other thing we take advantage of in Workflows is using the recently &lt;a href=\&quot;https://blog.cloudflare.com/javascript-native-rpc/\&quot;&gt;&lt;u&gt;announced&lt;/u&gt;&lt;/a&gt; JavaScript-native RPC feature when communicating between components.&lt;/p&gt;&lt;p&gt;Before &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/rpc/\&quot;&gt;&lt;u&gt;RPC&lt;/u&gt;&lt;/a&gt;, we had to &lt;code&gt;fetch()&lt;/code&gt; between components, make HTTP requests, and serialize and deserialize the parameters and the payload. Now, we can async call the remote object&amp;#39;s method as if it was local. Not only does this feel more natural and simplify our logic, but it&amp;#39;s also more efficient, and we can take advantage of TypeScript type-checking when writing code.&lt;/p&gt;&lt;p&gt;This is how the Configuration API would call the Account Controllerâs &lt;code&gt;countWorkflows()&lt;/code&gt; method before:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const resp = await accountStub.fetch(\n      &amp;quot;https://controller/count-workflows&amp;quot;,\n      {\n        method: &amp;quot;POST&amp;quot;,\n        headers: {\n          &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json; charset=utf-8&amp;quot;,\n        },\n        body: JSON.stringify({ accountId }),\n      },\n    );\n\nif (!resp.ok) {\n  return new Response(&amp;quot;Internal Server Error&amp;quot;, { status: 500 });\n}\n\nconst result = await resp.json();\nconst total_count = result.total_count;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This is how we do it using RPC:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;const total_count = await accountStub.countWorkflows(accountId);&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The other powerful feature of our RPC system is that it supports passing not only &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm#supported_types\&quot;&gt;&lt;u&gt;Structured Cloneable&lt;/u&gt;&lt;/a&gt; objects back and forth but also entire classes. More on this later.&lt;/p&gt;&lt;p&gt;Letâs move on to Engine.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;engine-and-instance\&quot;&gt;Engine and instance&lt;/h3&gt;\n            &lt;a href=\&quot;#engine-and-instance\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Every instance of a workflow runs alongside an Engine instance. The Engine is responsible for starting up the userâs workflow entry point, executing the steps on behalf of the user, handling their results, and tracking the workflow state until completion.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6yrKsuF501oRCDujckr3yM/bde40097ec5bedda07793375e53e99b9/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1080\&quot; height=\&quot;632\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;When we started thinking about the Engine, we thought about modeling it after a &lt;a href=\&quot;https://en.wikipedia.org/wiki/Finite-state_machine\&quot;&gt;&lt;u&gt;state machine&lt;/u&gt;&lt;/a&gt;, and that was what our initial prototypes looked like. However, state machines require an ahead-of-time understanding of the userland code, which implies having a build step before running them. This is costly at scale and introduces additional complexity.&lt;/p&gt;&lt;p&gt;A few iterations later, we had another idea. What if we could model the engine as a game loop?&lt;/p&gt;&lt;p&gt;Unlike other computer programs, games operate regardless of a user&amp;#39;s input. The game loop is essentially a sequence of tasks that implement the game&amp;#39;s logic and update the display, typically one loop per video frame. Hereâs an example of a game loop in pseudo-code:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;while (game in running)\n    check for user input\n    move graphics\n    play sounds\nend while&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Well, an oversimplified version of our Workflow engine would look like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;while (last step not completed)\n    iterate every step\n       use memoized cache as response if the step has run already\n       continue running step or timer if it hasn&amp;#039;t finished yet\nend while&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;A workflow is indeed a loop that keeps on going, performing the same sequence of logical tasks until the last step completes.&lt;/p&gt;&lt;p&gt;The Engine and the instance run hand-in-hand in a one-to-one relationship. The first is managed, and part of the platform. It uses SQLite and other platform APIs internally, and we can constantly add new features, fix bugs, and deploy new versions, while keeping everything transparent to the end user. The second is the actual account-owned Worker script that declares the Workflow steps.&lt;/p&gt;&lt;p&gt;For example, when someone passes a callback into &lt;code&gt;step.do()&lt;/code&gt;:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export class MyWorkflow extends WorkflowEntrypoint&amp;lt;Env, Params&amp;gt; {\n  async run(event: WorkflowEvent&amp;lt;Params&amp;gt;, step: WorkflowStep) {\n    step.do(&amp;#039;step1&amp;#039;, () =&amp;gt; { ... });\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;We switch execution over to the Engine. Again, this is possible because of the power of JS RPC. Besides passing Structured Cloneable objects back and forth, JS RPC allows us to &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/rpc/#send-functions-as-parameters-of-rpc-methods\&quot;&gt;&lt;u&gt;create and pass entire application-defined classes&lt;/u&gt;&lt;/a&gt; that extend the built-in RpcTarget. So this is what happens behind the scenes when your Instance calls &lt;code&gt;step.do()&lt;/code&gt; (simplified):&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export class Context extends RpcTarget {\n\n  async do&amp;lt;T&amp;gt;(name: string, callback: () =&amp;gt; Promise&amp;lt;T&amp;gt;): Promise&amp;lt;T&amp;gt; {\n\n    // First we check we have a cache of this step.do() already\n    const maybeResult = await this.#state.storage.get(name);\n\n    // We return the cache if it exists\n    if (maybeValue) { return maybeValue; }\n\n    // Else we run the user callback\n    return doWrapper(callback);\n  }\n\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Hereâs a more complete diagram of the Engineâs &lt;code&gt;step.do()&lt;/code&gt; lifecycle:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4MymVGS7BxwityCRlWcBOX/136d4dcf0affce04164f87b6bbe8b12a/image5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;702\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Again, this diagram only partially represents everything we do in the Engine; things like logging for observability or handling exceptions are missing, and we don&amp;#39;t get into the details of how queuing is implemented. However, it gives you a good idea of how the Engine abstracts and handles all the complexities of completing a step under the hood, allowing us to expose a simple-to-use API to end users.&lt;/p&gt;&lt;p&gt;Also, it&amp;#39;s worth reiterating that every workflow instance is an Engine behind the scenes, and every Engine is an SQLite-backed Durable Object. This ensures that every instance runtime and state are isolated and independent of each other and that we can effortlessly scale to run billions of workflow instances, a solved problem for Durable Objects.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4uEoEAtsjNquPCD3F50S9d/006556baf2a0478d1de10e4514843baa/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;853\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;durability\&quot;&gt;Durability&lt;/h3&gt;\n            &lt;a href=\&quot;#durability\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Durable Execution is all the rage now when we talk about workflow engines, and ours is no exception. Workflows are typically long-lived processes that run multiple functions in sequence where anything can happen. Those functions can time out or fail because of a remote server error or a network issue and need to be retried. A workflow engine ensures that your application runs smoothly and completes regardless of the problems it encounters.&lt;/p&gt;&lt;p&gt;Durability means that if and when a workflow fails, the Engine can re-run it, resume from the last recorded step, and deterministically re-calculate the state from all the successful steps&amp;#39; cached responses. This is possible because steps are stateful and idempotent; they produce the same result no matter how many times we run them, thus not causing unintended duplicate effects like sending the same invoice to a customer multiple times.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1R5UfQfNMKI7hB6QXJfCUr/242e85f2b5287394871e916844359bd4/image7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1074\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;We ensure durability and handle failures and retries by sharing the same technique we use for a &lt;code&gt;step.sleep()&lt;/code&gt; that requires sleeping for days or months: a combination of using &lt;code&gt;scheduler.wait()&lt;/code&gt;, a method of the &lt;a href=\&quot;https://github.com/WICG/scheduling-apis\&quot;&gt;&lt;u&gt;upcoming WICG Scheduling API&lt;/u&gt;&lt;/a&gt; that we already &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/changelog/historical-changelog/#2021-12-10\&quot;&gt;&lt;u&gt;support&lt;/u&gt;&lt;/a&gt;, and &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/api/alarms/\&quot;&gt;&lt;u&gt;Durable Objects alarms&lt;/u&gt;&lt;/a&gt;, which allow you to schedule the Durable Object to be woken up at a time in the future.&lt;/p&gt;&lt;p&gt;These two APIs allow us to overcome the lack of guarantees that a Durable Object runs forever, giving us complete control of its lifecycle. Since every state transition through userland code persists in the Engineâs strongly consistent SQLite, we track timestamps when a step begins execution, its attempts (if it needs retries), and its completion.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6FSCXRt9fO4EaaBP7hLV8x/a59de27dfbe18f39addd4eb8240b9df9/image10.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1800\&quot; height=\&quot;794\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This means that steps pending if a Durable Object is &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/reference/in-memory-state/\&quot;&gt;&lt;u&gt;evicted&lt;/u&gt;&lt;/a&gt; â perhaps due to a two-month-long timer â get rerun on the next lifetime of the Engine (with its cache from the previous lifetime hydrated) that is triggered by an alarm set with the timestamp of the next expected state transition.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;real-life-workflow-step-by-step\&quot;&gt;Real-life workflow, step by step&lt;/h2&gt;\n            &lt;a href=\&quot;#real-life-workflow-step-by-step\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Let&amp;#39;s walk through an example of a real-life application. You run an e-commerce website and would like to send email reminders to your customers for forgotten carts that haven&amp;#39;t been checked out in a few days.&lt;/p&gt;&lt;p&gt;What would typically have to be a combination of a queue, a cron job, and querying a database table periodically can now simply be a Workflow that we start on every new cart:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import {\n  WorkflowEntrypoint,\n  WorkflowEvent,\n  WorkflowStep,\n} from &amp;quot;cloudflare:workers&amp;quot;;\nimport { sendEmail } from &amp;quot;./legacy-email-provider&amp;quot;;\n\ntype Params = {\n  cartId: string;\n};\n\ntype Env = {\n  DB: D1Database;\n};\n\nexport class Purchase extends WorkflowEntrypoint&amp;lt;Env, Params&amp;gt; {\n  async run(\n    event: WorkflowEvent&amp;lt;Params&amp;gt;,\n    step: WorkflowStep\n  ): Promise&amp;lt;unknown&amp;gt; {\n    await step.sleep(&amp;quot;wait for three days&amp;quot;, &amp;quot;3 days&amp;quot;);\n\n    // Retrieve cart from D1\n    const cart = await step.do(&amp;quot;retrieve cart from database&amp;quot;, async () =&amp;gt; {\n      const { results } = await this.env.DB.prepare(`SELECT * FROM cart WHERE id = ?`)\n        .bind(event.payload.cartId)\n        .all();\n      return results[0];\n    });\n\n    if (!cart.checkedOut) {\n      await step.do(&amp;quot;send an email&amp;quot;, async () =&amp;gt; {\n        await sendEmail(&amp;quot;reminder&amp;quot;, cart);\n      });\n    }\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This works great. However, sometimes the &lt;code&gt;sendEmail&lt;/code&gt; function fails due to an upstream provider erroring out. While &lt;code&gt;step.do&lt;/code&gt; automatically retries with a reasonable default configuration, we can define our settings:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;if (cart.isComplete) {\n  await step.do(\n    &amp;quot;send an email&amp;quot;,\n    {\n      retries: {\n        limit: 5,\n        delay: &amp;quot;1 min&amp;quot;,\n        backoff: &amp;quot;exponential&amp;quot;,\n      },\n    },\n    async () =&amp;gt; {\n      await sendEmail(&amp;quot;reminder&amp;quot;, cart);\n    }\n  );\n}\n&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;managing-workflows\&quot;&gt;Managing Workflows&lt;/h3&gt;\n            &lt;a href=\&quot;#managing-workflows\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Workflows allows us to create and manage workflows using four different interfaces:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Using our REST HTTP API available on &lt;a href=\&quot;https://developers.cloudflare.com/api/\&quot;&gt;&lt;u&gt;Cloudflareâs API catalog&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Using &lt;a href=\&quot;https://developers.cloudflare.com/workers/wrangler/\&quot;&gt;&lt;u&gt;Wrangler&lt;/u&gt;&lt;/a&gt;, Cloudflare&amp;#39;s developer platform command-line tool&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Programmatically inside a Worker using &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/bindings/\&quot;&gt;&lt;u&gt;bindings&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Using our Web UI in the &lt;a href=\&quot;https://dash.cloudflare.com/\&quot;&gt;&lt;u&gt;dashboard&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;The HTTP API makes it easy to trigger new instances of workflows from any system, even if it isnât on Cloudflare, or from the command line. For example:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;curl --request POST \\\n  --url https://api.cloudflare.com/client/v4/accounts/$ACCOUNT_ID/workflows/purchase-workflow/instances/$CART_INSTANCE_ID \\\n  --header &amp;#039;Authorization: Bearer $ACCOUNT_TOKEN \\\n  --header &amp;#039;Content-Type: application/json&amp;#039; \\\n  --data &amp;#039;{\n\t&amp;quot;id&amp;quot;: &amp;quot;$CART_INSTANCE_ID&amp;quot;,\n\t&amp;quot;params&amp;quot;: {\n\t\t&amp;quot;cartId&amp;quot;: &amp;quot;f3bcc11b-2833-41fb-847f-1b19469139d1&amp;quot;\n\t}\n  }&amp;#039;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Wrangler goes one step further and gives us a friendlier set of commands to interact with workflows with fancy formatted outputs without needing to authenticate with tokens. Type &lt;code&gt;npx wrangler workflows&lt;/code&gt; for help, or:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;npx wrangler workflows trigger purchase-workflow &amp;#039;{ &amp;quot;cartId&amp;quot;: &amp;quot;f3bcc11b-2833-41fb-847f-1b19469139d1&amp;quot; }&amp;#039;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Furthermore, Workflows has first-party support in wrangler, and you can test your instances locally. A Workflow is similar to a regular&lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/bindings/service-bindings/rpc/\&quot;&gt;&lt;u&gt; WorkerEntrypoint&lt;/u&gt;&lt;/a&gt; in your Worker, which means that &lt;code&gt;wrangler dev&lt;/code&gt; just naturally works.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;â¯ npx wrangler dev\n\n âï¸ wrangler 3.82.0\n----------------------------\n\nYour worker has access to the following bindings:\n- Workflows:\n  - CART_WORKFLOW: EcommerceCartWorkflow\nâ Starting local server...\n[wrangler:inf] Ready on http://localhost:8787\nâ­ââââââââââââââââââââââââââââââââââââââââââââââââ®\nâ  [b] open a browser, [d] open devtools        â\nâ°ââââââââââââââââââââââââââââââââââââââââââââââââ¯\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Workflow APIs are also available as a Worker binding. You can interact with the platform programmatically from another Worker script in the same account without worrying about permissions or authentication. You can even have workflows that call and interact with other workflows.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;import { WorkerEntrypoint } from &amp;quot;cloudflare:workers&amp;quot;;\n\ntype Env = { DEMO_WORKFLOW: Workflow };\nexport default class extends WorkerEntrypoint&amp;lt;Env&amp;gt; {\n  async fetch() {\n    // Pass in a user defined name for this instance\n    // In this case, we use the same as the cartId\n    const instance = await this.env.DEMO_WORKFLOW.create({\n      id: &amp;quot;f3bcc11b-2833-41fb-847f-1b19469139d1&amp;quot;,\n      params: {\n          cartId: &amp;quot;f3bcc11b-2833-41fb-847f-1b19469139d1&amp;quot;,\n      }\n    });\n  }\n  async scheduled() {\n    // Restart errored out instances in a cron\n    const instance = await this.env.DEMO_WORKFLOW.get(\n      &amp;quot;f3bcc11b-2833-41fb-847f-1b19469139d1&amp;quot;\n    );\n    const status = await instance.status();\n    if (status.error) {\n      await instance.restart();\n    }\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;observability\&quot;&gt;ObservabilityÂ &lt;/h3&gt;\n            &lt;a href=\&quot;#observability\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Having good observability and data on often long-lived asynchronous tasks is crucial to understanding how we&amp;#39;re doing under normal operation and, more importantly, when things go south, and we need to troubleshoot problems or when we are iterating on code changes.&lt;/p&gt;&lt;p&gt;We designed Workflows around the philosophy that there is no such thing as too much logging. You can get all the SQLite data for your workflow and its instances by calling the REST APIs. Here is the output of an instance:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  &amp;quot;success&amp;quot;: true,\n  &amp;quot;errors&amp;quot;: [],\n  &amp;quot;messages&amp;quot;: [],\n  &amp;quot;result&amp;quot;: {\n    &amp;quot;status&amp;quot;: &amp;quot;running&amp;quot;,\n    &amp;quot;params&amp;quot;: {},\n    &amp;quot;trigger&amp;quot;: { &amp;quot;source&amp;quot;: &amp;quot;api&amp;quot; },\n    &amp;quot;versionId&amp;quot;: &amp;quot;ae042999-39ff-4d27-bbcd-22e03c7c4d02&amp;quot;,\n    &amp;quot;queued&amp;quot;: &amp;quot;2024-10-21 17:15:09.350&amp;quot;,\n    &amp;quot;start&amp;quot;: &amp;quot;2024-10-21 17:15:09.350&amp;quot;,\n    &amp;quot;end&amp;quot;: null,\n    &amp;quot;success&amp;quot;: null,\n    &amp;quot;steps&amp;quot;: [\n      {\n        &amp;quot;name&amp;quot;: &amp;quot;send email&amp;quot;,\n        &amp;quot;start&amp;quot;: &amp;quot;2024-10-21 17:15:09.411&amp;quot;,\n        &amp;quot;end&amp;quot;: &amp;quot;2024-10-21 17:15:09.678&amp;quot;,\n        &amp;quot;attempts&amp;quot;: [\n          {\n            &amp;quot;start&amp;quot;: &amp;quot;2024-10-21 17:15:09.411&amp;quot;,\n            &amp;quot;end&amp;quot;: &amp;quot;2024-10-21 17:15:09.678&amp;quot;,\n            &amp;quot;success&amp;quot;: true,\n            &amp;quot;error&amp;quot;: null\n          }\n        ],\n        &amp;quot;config&amp;quot;: {\n          &amp;quot;retries&amp;quot;: { &amp;quot;limit&amp;quot;: 5, &amp;quot;delay&amp;quot;: 1000, &amp;quot;backoff&amp;quot;: &amp;quot;constant&amp;quot; },\n          &amp;quot;timeout&amp;quot;: &amp;quot;15 minutes&amp;quot;\n        },\n        &amp;quot;output&amp;quot;: &amp;quot;celso@example.com&amp;quot;,\n        &amp;quot;success&amp;quot;: true,\n        &amp;quot;type&amp;quot;: &amp;quot;step&amp;quot;\n      },\n      {\n        &amp;quot;name&amp;quot;: &amp;quot;sleep-1&amp;quot;,\n        &amp;quot;start&amp;quot;: &amp;quot;2024-10-21 17:15:09.763&amp;quot;,\n        &amp;quot;end&amp;quot;: &amp;quot;2024-10-21 17:17:09.763&amp;quot;,\n        &amp;quot;finished&amp;quot;: false,\n        &amp;quot;type&amp;quot;: &amp;quot;sleep&amp;quot;,\n        &amp;quot;error&amp;quot;: null\n      }\n    ],\n    &amp;quot;error&amp;quot;: null,\n    &amp;quot;output&amp;quot;: null\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;As you can see, this is essentially a dump of the instance engine SQLite in JSON. You have the &lt;b&gt;errors&lt;/b&gt;, &lt;b&gt;messages&lt;/b&gt;, current &lt;b&gt;status&lt;/b&gt;, and what happened with &lt;b&gt;every step&lt;/b&gt;, all time stamped to the millisecond.&lt;/p&gt;&lt;p&gt;It&amp;#39;s one thing to get data about a specific workflow instance, but it&amp;#39;s another to zoom out and look at aggregated statistics of all your workflows and instances over time. Workflows data is available through our &lt;a href=\&quot;https://developers.cloudflare.com/analytics/graphql-api/\&quot;&gt;&lt;u&gt;GraphQL Analytics API&lt;/u&gt;&lt;/a&gt;, so you can query it in aggregate and generate valuable insights and reports. In this example we ask for aggregated analytics about the wall time of all the instances of the âe-commerce-cartsâ workflow:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  viewer {\n    accounts(filter: { accountTag: &amp;quot;febf0b1a15b0ec222a614a1f9ac0f0123&amp;quot; }) {\n      wallTime: workflowsAdaptiveGroups(\n        limit: 10000\n        filter: {\n          datetimeHour_geq: &amp;quot;2024-10-20T12:00:00.000Z&amp;quot;\n          datetimeHour_leq: &amp;quot;2024-10-21T12:00:00.000Z&amp;quot;\n          workflowName: &amp;quot;e-commerce-carts&amp;quot;\n        }\n        orderBy: [count_DESC]\n      ) {\n        count\n        sum {\n          wallTime\n        }\n        dimensions {\n          date: datetimeHour\n        }\n      }\n    }\n  }\n}\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;For convenience, you can evidently also use Wrangler to describe a workflow or an instance and get an instant and beautifully formatted response:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;sid ~ npx wrangler workflows instances describe purchase-workflow latest\n\n âï¸ wrangler 3.80.4\n\nWorkflow Name:         purchase-workflow\nInstance Id:           d4280218-7756-41d2-bccd-8d647b82d7ce\nVersion Id:            0c07dbc4-aaf3-44a9-9fd0-29437ed11ff6\nStatus:                â Completed\nTrigger:               ð API\nQueued:                14/10/2024, 16:25:17\nSuccess:               â Yes\nStart:                 14/10/2024, 16:25:17\nEnd:                   14/10/2024, 16:26:17\nDuration:              1 minute\nLast Successful Step:  wait for three days\nOutput:                false\nSteps:\n\n  Name:      wait for three days\n  Type:      ð¤ Sleeping\n  Start:     14/10/2024, 16:25:17\n  End:       17/10/2024, 16:25:17\n  Duration:  3 day&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;And finally, we worked really hard to get you the best dashboard UI experience when navigating Workflows data.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/64XUtBwldkSXUTJ5xEJBgo/2aa861583c8c56c19194cb0869a15a2a/image8.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1960\&quot; height=\&quot;1360\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;so-how-much-does-it-cost\&quot;&gt;So, how much does it cost?&lt;/h2&gt;\n            &lt;a href=\&quot;#so-how-much-does-it-cost\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Itâd be painful if we introduced a powerful new way to build Workers applications but made it cost prohibitive.&lt;/p&gt;&lt;p&gt;Workflows is &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/pricing/#workers\&quot;&gt;&lt;u&gt;priced&lt;/u&gt;&lt;/a&gt; just like Cloudflare Workers, where we &lt;a href=\&quot;https://blog.cloudflare.com/workers-pricing-scale-to-zero/\&quot;&gt;&lt;u&gt;introduced CPU-based pricing&lt;/u&gt;&lt;/a&gt;: only on active CPU time and requests, not duration (aka: wall time).&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/11WroT4xt0zPj6bsou4u3X/8f2775569f280107345322cb97603b3e/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;512\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Workers Standard pricing model&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;This is especially advantageous when building the long-running, multi-step applications that Workflows enables: if you had to pay while your Workflow was sleeping, waiting on an event, or making a network call to an API, writing the ârightâ code would be at odds with writing affordable code.&lt;/p&gt;&lt;p&gt;Thereâs also no need to keep a Kubernetes cluster or a group of virtual machines running (and burning a hole in your wallet): we manage the infrastructure, and you only pay for the compute your Workflows consume.Â Â Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;whats-next\&quot;&gt;Whatâs next?&lt;/h2&gt;\n            &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;Today, after months of developing the platform, we are announcing the open beta program, and we couldn&amp;#39;t be more excited to see how you will be using Workflows. Looking forward, we want to do things like triggering instances from queue messages and have other ideas, but at the same time, we are certain that your feedback will help us shape the roadmap ahead.&lt;/p&gt;&lt;p&gt;We hope that this blog post gets you thinking about how to use Workflows for your next application, but also that it inspires you on what you can build on top of Workers. Workflows as a platform is entirely built on top of Workers, its resources, and APIs. Anyone can do it, too.&lt;/p&gt;&lt;p&gt;To chat with the team and other developers building on Workflows, join the #workflows-beta channel on the&lt;a href=\&quot;https://discord.cloudflare.com/\&quot;&gt; &lt;u&gt;Cloudflare Developer Discord&lt;/u&gt;&lt;/a&gt;, and keep an eye on the&lt;a href=\&quot;https://developers.cloudflare.com/workflows/reference/changelog/\&quot;&gt; &lt;u&gt;Workflows changelog&lt;/u&gt;&lt;/a&gt; during the beta. Otherwise,&lt;a href=\&quot;https://developers.cloudflare.com/workflows/get-started/guide/\&quot;&gt; visit the Workflows tutorial&lt;/a&gt; to get started.&lt;/p&gt;&lt;p&gt;If you&amp;#39;re an engineer, &lt;a href=\&quot;https://www.cloudflare.com/en-gb/careers/jobs/\&quot;&gt;&lt;u&gt;look for opportunities&lt;/u&gt;&lt;/a&gt; to work with us and help us improve Workflows or build other products.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-10-24T14:05+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-25T06:06:55.297Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/Xlle0u2YPZdCmNhVUIiJi/bdc13b0043d9850fb4d68632c063aabf/unnamed.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5v2UZdTRX1Rw9akmhexnxs&quot;],&quot;name&quot;:[0,&quot;Durable Objects&quot;],&quot;slug&quot;:[0,&quot;durable-objects&quot;]}],[0,{&quot;id&quot;:[0,&quot;1KBFlaTf50eub8uvJ1pAt1&quot;],&quot;name&quot;:[0,&quot;Workflows&quot;],&quot;slug&quot;:[0,&quot;workflows&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Sid Chatterjee&quot;],&quot;slug&quot;:[0,&quot;sid&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/66pIfBfhDUadwWztfEDfXe/66d41b9c01e48856fd1deb323d9007a9/sid.jpg&quot;],&quot;location&quot;:[0,&quot;London, United Kingdom&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@chatsidhartha&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Matt Silverlock&quot;],&quot;slug&quot;:[0,&quot;silverlock&quot;],&quot;bio&quot;:[0,&quot;Director of Product at Cloudflare.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7xP5qePZD9eyVtwIesXYxh/e714aaa573161ec9eb48d59bd1aa6225/silverlock.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@elithrar&quot;],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Celso Martinho&quot;],&quot;slug&quot;:[0,&quot;celso&quot;],&quot;bio&quot;:[0,&quot;From when Mosaic took over Gopher. Engineering Director at Cloudflare.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2pzgat1zmt1oF1byi7hskH/7b25e8e00117ee44afe36ad27d7d8032/celso.png&quot;],&quot;location&quot;:[0,&quot;Portugal, Lisbon&quot;],&quot;website&quot;:[0,&quot;https://celso.io/&quot;],&quot;twitter&quot;:[0,&quot;@celso&quot;],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare Workflows is now in open beta! Workflows allows you to build reliable, repeatable, long-lived multistep applications that can automatically retry, persist state, and scale out. Read on to learn how Workflows works, how we built it on top of Durable Objects, and how you can deploy your first Workflows application.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/building-workflows-durable-execution-on-workers&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Build durable applications on Cloudflare Workers: you write the Workflows, we take care of the rest&quot;],&quot;description&quot;:[0,&quot;Cloudflare Workflows is now in open beta! Workflows allows you to build reliable, repeatable, long-lived multi-step applications that can automatically retry, persist state, and scale out. Read on to learn how Workflows works, how we built it on top of Durable Objects, and how you can deploy your first Workflows application.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2M5hbMGRUR4iun8HRKh5CT/df3a02f850b831c4910e76049292293d/Build_durable_applications_on_Cloudflare_Workers-_you_write_the_Workflows__we_take_care_of_the_rest-OG.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;2LUyKREpCJjJ5qGqwZyoAx&quot;],&quot;title&quot;:[0,&quot;Billions and billions (of logs): scaling AI Gateway with the Cloudflare Developer Platform&quot;],&quot;slug&quot;:[0,&quot;billions-and-billions-of-logs-scaling-ai-gateway-with-the-cloudflare&quot;],&quot;excerpt&quot;:[0,&quot;How we scaled AI Gateway to handle and store billions of requests, using Cloudflare Workers, D1, Durable Objects, and R2.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;With the rapid advancements occurring in the AI space, developers face significant challenges in keeping up with the ever-changing landscape. New models and providers are continuously emerging, and understandably, developers want to experiment and test these options to find the best fit for their use cases. This creates the need for a streamlined approach to managing multiple models and providers, as well as a centralized platform to efficiently monitor usage, implement controls, and gather data for optimization.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/\&quot;&gt;&lt;u&gt;AI Gateway&lt;/u&gt;&lt;/a&gt; is specifically designed to address these pain points. Since its launch in &lt;a href=\&quot;https://blog.cloudflare.com/announcing-ai-gateway\&quot;&gt;&lt;u&gt;September 2023&lt;/u&gt;&lt;/a&gt;, AI Gateway has empowered developers and organizations by successfully proxying over 2 billion requests in just one year, as we &lt;a href=\&quot;https://blog.cloudflare.com/workers-ai-bigger-better-faster/#optimizing-ai-workflows-with-ai-gateway\&quot;&gt;&lt;u&gt;highlighted during Septemberâs Birthday Week&lt;/u&gt;&lt;/a&gt;. With AI Gateway, developers can easily store, analyze, and optimize their AI &lt;a href=\&quot;https://www.cloudflare.com/learning/ai/inference-vs-training/\&quot;&gt;&lt;u&gt;inference&lt;/u&gt;&lt;/a&gt; requests and responses in real time.&lt;/p&gt;&lt;p&gt;With our initial architecture, AI Gateway faced a significant challenge: the logs, those critical trails of data interactions between applications and AI models, could only be retained for 30 minutes. This limitation was not just a minor inconvenience; it posed a substantial barrier for developers and businesses needing to analyze long-term patterns, ensure compliance, or simply debug over more extended periods.&lt;/p&gt;&lt;p&gt;In this post, we&amp;#39;ll explore the technical challenges and strategic decisions behind extending our log storage capabilities from 30 minutes to being able to store billions of logs indefinitely. We&amp;#39;ll discuss the challenges of scale, the intricacies of data management, and how we&amp;#39;ve engineered a system that not only meets the demands of today, but is also scalable for the future of AI development.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;background\&quot;&gt;Background&lt;/h2&gt;\n            &lt;a href=\&quot;#background\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;AI Gateway is built on &lt;a href=\&quot;https://workers.cloudflare.com\&quot;&gt;&lt;u&gt;Cloudflare Workers&lt;/u&gt;&lt;/a&gt;, a serverless platform that runs on the Cloudflare network, allowing developers to write small JavaScript functions that can execute at the point of need, near the user, on Cloudflare&amp;#39;s vast network of data centers, without worrying about platform scalability.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6jV3iKCN771ixU21Hixfpz/18086a52cfe05cd20f1c94bbba21e293/_BLOG-2593_2.png\&quot; alt=\&quot;BLOG-2593 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1954\&quot; height=\&quot;291\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Our customers use multiple providers and models and are always looking to optimize the way they do inference. And, of course, in order to evaluate their prompts, performance, cost, and to troubleshoot whatâs going on, AI Gatewayâs customers need to store requests and responses. New requests show up within 15 seconds and customers can check a requestâs cost, duration, number of tokens, and provide their feedback (thumbs up or down).&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/RBqZXnLJNCaQPbtbzjQmj/70aa2598f9b9294b67db8cd5712a6345/_BLOG-2593_3.png\&quot; alt=\&quot;BLOG-2593 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1080\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This scales in a way where an account can have multiple gateways and each gateway has its own settings. In our first implementation, a backend worker was responsible for storing Real Time Logs and other background tasks. However, in the rapidly evolving domain of artificial intelligence, where real-time data is as precious as the insights it provides, managing log data efficiently becomes paramount. We recognized that to truly empower our users, we needed to offer a solution where logs weren&amp;#39;t just transient records but could be stored permanently. Permanent log storage means developers can now track the performance, security, and operational insights of their AI applications over time, enabling not only immediate troubleshooting but also longitudinal studies of AI behavior, usage trends, and system health.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1TcC1ZdyNzT0xwFwme2oBt/a9202691a0a983fa3eafdf6c0ee92f2c/_BLOG-2593_4.png\&quot; alt=\&quot;BLOG-2593 4\&quot; class=\&quot;kg-image\&quot; width=\&quot;1173\&quot; height=\&quot;410\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The diagram above describes our old architecture, which could only store 30 minutes of data.&lt;/p&gt;&lt;p&gt;Tracing the path of a request through the AI Gateway, as depicted in the sequence above:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;A developer sends a new inference request, which is first received by our Gateway Worker.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Gateway Worker then performs several checks: it looks for cached results, enforces rate limits, and verifies any other configurations set by the user for their gateway. Provided all conditions are met, it forwards the request to the selected inference provider (in this diagram, OpenAI).&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The inference provider processes the request and sends back the response.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Simultaneously, as the response is relayed back to the developer, the request and response details are also dispatched to our Backend Worker. This worker&amp;#39;s role is to manage and store the log of this transaction.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;the-challenge-store-two-billion-logs\&quot;&gt;The challenge: Store two billion logs&lt;/h2&gt;\n            &lt;a href=\&quot;#the-challenge-store-two-billion-logs\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          \n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;first-step-real-time-logs\&quot;&gt;First step: real-time logs&lt;/h3&gt;\n            &lt;a href=\&quot;#first-step-real-time-logs\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;Initially, the AI Gateway project stored both request metadata and the actual request bodies in a &lt;a href=\&quot;https://developers.cloudflare.com/d1/\&quot;&gt;&lt;u&gt;D1 database&lt;/u&gt;&lt;/a&gt;. This approach facilitated rapid development in the project&amp;#39;s infancy. However, as customer engagement grew, the D1 database began to fill at an accelerating rate, eventually retaining logs for only 30 minutes at a time.&lt;/p&gt;&lt;p&gt;To mitigate this, we first optimized the database schema, which extended the log retention to one hour. However, we soon encountered diminishing returns due to the sheer volume of byte data from the request bodies. Post-launch, it became clear that a more scalable solution was necessary. We decided to migrate the request bodies to R2 storage, significantly alleviating the data load on D1. This adjustment allowed us to incrementally extend log retention to 24 hours.&lt;/p&gt;&lt;p&gt;Consequently, D1 functioned primarily as a log index, enabling users to search and filter logs efficiently. When users needed to view details or download a log, these actions were seamlessly proxied through to R2.&lt;/p&gt;&lt;p&gt;This dual-system approach provided us with the breathing room to contemplate and develop more sophisticated storage solutions for the future.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;second-step-persistent-logs-and-durable-object-transactional-storage\&quot;&gt;Second step: persistent logs and Durable Object transactional storage&lt;/h3&gt;\n            &lt;a href=\&quot;#second-step-persistent-logs-and-durable-object-transactional-storage\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;As our traffic surged, we encountered a growing number of requests from customers wanting to access and compare older logs.&lt;/p&gt;&lt;p&gt;Upon learning that the Durable Objects team was seeking beta testers for their new &lt;a href=\&quot;https://blog.cloudflare.com/sqlite-in-durable-objects/\&quot;&gt;&lt;u&gt;Durable Objects with SQLite&lt;/u&gt;&lt;/a&gt;, we eagerly signed up.&lt;/p&gt;&lt;p&gt;Originally, we considered Durable Objects as the ideal solution for expanding our log storage capacity, which required us to shard the logs by a unique string. Initially, this string was the account ID, but during a mid-development load test, we hit a cap at 10 million logs per Durable Object. This limitation meant that each account could only support up to this number of logs.&lt;/p&gt;&lt;p&gt;Given our commitment to the DO migration, we saw an opportunity rather than a constraint. To overcome the 10 million log limit per account, we refined our approach to shard by both account ID and gateway name. This adjustment effectively raised the storage ceiling from 10 million logs per account to 10 million per gateway. With the default setting allowing each account up to 10 gateways, the potential storage for each account skyrocketed to 100 million logs.&lt;/p&gt;&lt;p&gt;This strategic pivot not only enabled us to store a significantly larger number of logs. But also enhanced our flexibility in gateway management. Now, when a gateway is deleted, we can simply remove the corresponding Durable Object.&lt;/p&gt;&lt;p&gt;Additionally, this sharding method isolates high-volume request scenarios. If one customer&amp;#39;s heavy usage slows down log insertion, it only impacts their specific Durable Object, thereby preserving performance for other customers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3Q6degDA3V02dZFVugW2LO/ae121890a3d4493e5c01459c477f32d9/_BLOG-2593_5.png\&quot; alt=\&quot;BLOG-2593 5\&quot; class=\&quot;kg-image\&quot; width=\&quot;1173\&quot; height=\&quot;410\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Taking a glance at the revised architecture diagram, we replaced the Backend Worker with our newly integrated Durable Object. The rest of the request flow remains unchanged, including the concurrent response to the user and the interaction with the Durable Object, which occurs in the fourth step.&lt;/p&gt;&lt;p&gt;Leveraging Cloudflareâs network, our Gateway Worker operates near the user&amp;#39;s location, which in turn positions the user&amp;#39;s Durable Object close by. This proximity significantly enhances the speed of log insertion and query operations.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;third-step-managing-thousands-of-durable-objects\&quot;&gt;Third step: managing thousands of Durable Objects&lt;/h3&gt;\n            &lt;a href=\&quot;#third-step-managing-thousands-of-durable-objects\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;As the number of users and requests on AI Gateway grows, managing each unique Durable Object (DO) becomes increasingly complex. New customers join continuously, and we needed an efficient method to track each DO, ensure users stay within their 10 gateway limit, and manage the storage capacity for free users.&lt;/p&gt;&lt;p&gt;To address these challenges, we introduced another layer of control with a new Durable Object we&amp;#39;ve named the Account Manager. The primary function of the Account Manager is straightforward yet crucial: it keeps user activities in check.&lt;/p&gt;&lt;p&gt;Here&amp;#39;s how it works: before any Gateway commits a new log to permanent storage, it consults the Account Manager. This check determines whether the gateway is allowed to insert the log based on the user&amp;#39;s current usage and entitlements. The Account Manager uses its own SQLite database to verify the total number of rows a user has and their service level. If all checks pass, it signals the Gateway that the log can be inserted. It was paramount to guarantee that this entire validation process occurred in the background, ensuring that the user experience remains seamless and uninterrupted.&lt;/p&gt;&lt;p&gt;The Account Manager stays updated by periodically receiving data from each Gatewayâs Durable Object. Specifically, after every 1000 inference requests, the Gateway sends an update on its total rows to the Account Manager, which then updates its local records. This system ensures that the Account Manager has the most current data when making its decisions.&lt;/p&gt;&lt;p&gt;Additionally, the Account Manager is responsible for monitoring customer entitlements. It tracks whether an account is on a free or paid plan, how many gateways a user is permitted to create, and the log storage capacity allocated to each gateway.Â &lt;/p&gt;&lt;p&gt;Through these mechanisms, the Account Manager not only helps in maintaining system integrity but also ensures fair usage across all users of AI Gateway.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;ai-evaluations-and-durable-objects-sharding\&quot;&gt;AI evaluations and Durable Objects sharding&lt;/h2&gt;\n            &lt;a href=\&quot;#ai-evaluations-and-durable-objects-sharding\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;As we continue to develop evaluations to fully automatic and, in the future, use Large Language Models (LLMs),Â  we are now taking the first step towards this goal and launching the open beta phase of comprehensive &lt;a href=\&quot;https://blog.cloudflare.com/workers-ai-bigger-better-faster/#optimizing-ai-workflows-with-ai-gateway\&quot;&gt;&lt;u&gt;AI evaluations&lt;/u&gt;&lt;/a&gt;, centered on Human-in-the-Loop feedback.&lt;/p&gt;&lt;p&gt;This feature empowers users to create bespoke datasets from their application logs, thereby enabling them to score and evaluate the performance, speed, and cost-effectiveness of their models, with a primary focus on LLMs and automated scoring, analyzing the performance of LLMs, providing developers with objective, data-driven insights to refine their models.&lt;/p&gt;&lt;p&gt;To do this, developers require a reliable logging mechanism that persists logs from multiple gateways, storing up to 100 million logs in total (10 million logs per gateway, across 10 gateways). This represents a significant volume of data, as each request made through the AI Gateway generates a log entry, with some log entries potentially exceeding 50 MB in size.&lt;/p&gt;&lt;p&gt;This necessity leads us to work on the expansion of log storage capabilities. Since log storage is limited to 10 million logs per gateway, in future iterations, we aim to scale this capacity by implementing sharded Durable Objects (DO), allowing multiple Durable Objects per gateway to handle and store logs. This scaling strategy will enable us to store significantly larger volumes of logs, providing richer data for evaluations (using LLMs as a judge or from user input), all through AI Gateway.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7FLy2JEfvGFo8P7PCVBZYT/a4d6367341e9fc224dedaad3aa0f02e2/_BLOG-2593_6.png\&quot; alt=\&quot;BLOG-2593 6\&quot; class=\&quot;kg-image\&quot; width=\&quot;954\&quot; height=\&quot;751\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h2 id=\&quot;coming-soon\&quot;&gt;Coming Soon&lt;/h2&gt;\n            &lt;a href=\&quot;#coming-soon\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n          &lt;p&gt;We are working on improving our existing &lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/providers/universal/\&quot;&gt;&lt;u&gt;Universal Endpoint&lt;/u&gt;&lt;/a&gt;, the next step on an enhanced solution that builds on existing fallback mechanisms to offer greater resilience, flexibility, and intelligence in request management.&lt;/p&gt;&lt;p&gt;Currently, when a provider encounters an error or is unavailable, our system &lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/configuration/fallbacks/\&quot;&gt;&lt;u&gt;falls back&lt;/u&gt;&lt;/a&gt; to an alternative provider to ensure continuity. The improved Universal Endpoint takes this a step further by introducing automatic retry capabilities, allowing failed requests to be reattempted before fallback is triggered. This significantly improves reliability by handling transient errors and increasing the likelihood of successful request fulfillment. It will look something like this:&lt;/p&gt;\n            &lt;pre class=\&quot;language-RUST\&quot;&gt;&lt;code class=\&quot;language-RUST\&quot;&gt;curl --location &amp;#039;https://aig.example.com/&amp;#039; \\\n--header &amp;#039;CF-AIG-TOKEN: Bearer XXXX&amp;#039; \\\n--header &amp;#039;Content-Type: application/json&amp;#039; \\\n--data-raw &amp;#039;[\n    {\n        &amp;quot;id&amp;quot;: &amp;quot;0001&amp;quot;,\n        &amp;quot;provider&amp;quot;: &amp;quot;openai&amp;quot;,\n        &amp;quot;endpoint&amp;quot;: &amp;quot;chat/completions&amp;quot;,\n        &amp;quot;headers&amp;quot;: {\n            &amp;quot;Authorization&amp;quot;: &amp;quot;Bearer XXXX&amp;quot;,\n            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json&amp;quot;\n        },\n        &amp;quot;query&amp;quot;: {\n            &amp;quot;model&amp;quot;: &amp;quot;gpt-3.5-turbo&amp;quot;,\n            &amp;quot;messages&amp;quot;: [\n                {\n                    &amp;quot;role&amp;quot;: &amp;quot;user&amp;quot;,\n                    &amp;quot;content&amp;quot;: &amp;quot;generate a prompt to create cloudflare random images&amp;quot;\n                }\n            ]\n        },\n        &amp;quot;option&amp;quot;: {\n            &amp;quot;retry&amp;quot;: 2,\n            &amp;quot;delay&amp;quot;: 200,\n            &amp;quot;onComplete&amp;quot;: {\n                &amp;quot;provider&amp;quot;: &amp;quot;workers-ai&amp;quot;,\n                &amp;quot;endpoint&amp;quot;: &amp;quot;@cf/stabilityai/stable-diffusion-xl-base-1.0&amp;quot;,\n                &amp;quot;headers&amp;quot;: {\n                    &amp;quot;Authorization&amp;quot;: &amp;quot;Bearer A5UFQkHewHF1-sA3hTVQFaPxRuu5wmS0eJcCS_MC&amp;quot;,\n                    &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json&amp;quot;\n                },\n                &amp;quot;query&amp;quot;: {\n                    &amp;quot;messages&amp;quot;: [\n                        {\n                            &amp;quot;role&amp;quot;: &amp;quot;user&amp;quot;,\n                            &amp;quot;content&amp;quot;: &amp;quot;&amp;lt;prompt-response id=&amp;#039;\\&amp;#039;&amp;#039;0001&amp;#039;\\&amp;#039;&amp;#039; /&amp;gt;&amp;quot;\n                        }\n                    ]\n                }\n            }\n        }\n    },\n    {\n        &amp;quot;provider&amp;quot;: &amp;quot;workers-ai&amp;quot;,\n        &amp;quot;endpoint&amp;quot;: &amp;quot;@cf/stabilityai/stable-diffusion-xl-base-1.0&amp;quot;,\n        &amp;quot;headers&amp;quot;: {\n            &amp;quot;Authorization&amp;quot;: &amp;quot;Bearer XXXXXX&amp;quot;,\n            &amp;quot;Content-Type&amp;quot;: &amp;quot;application/json&amp;quot;\n        },\n        &amp;quot;query&amp;quot;: {\n            &amp;quot;messages&amp;quot;: [\n                {\n                    &amp;quot;role&amp;quot;: &amp;quot;user&amp;quot;,\n                    &amp;quot;content&amp;quot;: &amp;quot;create a image of a missing cat&amp;quot;\n                }\n            ]\n        }\n    }\n]&amp;#039;\n&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The request to the improved Universal Endpoint system demonstrates how it handles multiple providers with integrated retry mechanisms and fallback logic. In this example, the first request is sent to a provider like OpenAI, asking it to generate a text-to-image prompt. The âretryâ option ensures that transient issues donât result in immediate failure.&lt;/p&gt;&lt;p&gt;The systemâs ability to seamlessly switch between providers while applying retry strategies ensures higher reliability and robustness in managing requests. By leveraging fallback logic, the Improved Universal Endpoint can dynamically adapt to provider failures, ensuring that tasks are completed successfully even in complex, multi-step workflows.&lt;/p&gt;&lt;p&gt;In addition to retry logic, we will have the ability to inspect requests and responses and make dynamic decisions based on the content of the result. This enables developers to create conditional workflows where the system can adapt its behavior depending on the nature of the response, creating a highly flexible and intelligent decision-making process.&lt;/p&gt;&lt;p&gt;If you havenât yet used AI Gateway, check out our &lt;a href=\&quot;https://developers.cloudflare.com/ai-gateway/\&quot;&gt;&lt;u&gt;developer documentation&lt;/u&gt;&lt;/a&gt; on how to get started. If you have any questions, reach out on our &lt;a href=\&quot;http://discord.cloudflare.com/\&quot;&gt;&lt;u&gt;Discord channel&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-10-24T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-24T13:00:03.363Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/617BMsL3rCnCVbJka70swV/a6e1c03a1ee940a18b3c95c6c3d8642b/_BLOG-2593_1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;]}],[0,{&quot;id&quot;:[0,&quot;1GyUhE8o287lrdNSpdRUIe&quot;],&quot;name&quot;:[0,&quot;AI Gateway&quot;],&quot;slug&quot;:[0,&quot;ai-gateway&quot;]}],[0,{&quot;id&quot;:[0,&quot;5v2UZdTRX1Rw9akmhexnxs&quot;],&quot;name&quot;:[0,&quot;Durable Objects&quot;],&quot;slug&quot;:[0,&quot;durable-objects&quot;]}],[0,{&quot;id&quot;:[0,&quot;UKt2GEAUQsbObsNqZ3Pr7&quot;],&quot;name&quot;:[0,&quot;D1&quot;],&quot;slug&quot;:[0,&quot;d1&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;1Efeqd1oZ7vy3xls0fdjHF&quot;],&quot;name&quot;:[0,&quot;Agile Developer Services&quot;],&quot;slug&quot;:[0,&quot;agile-developer-services&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;7JpaihvGGjNhG2v4nTxeFV&quot;],&quot;name&quot;:[0,&quot;R2 Storage&quot;],&quot;slug&quot;:[0,&quot;cloudflare-r2&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Catarina Pires Mota&quot;],&quot;slug&quot;:[0,&quot;catarina-pires-mota&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1YWsahYr40z3FhQwupqAlX/a106b6fd29b4862193399b15022f45b3/_tmp_mini_magick20220926-42-fogz3a.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Gabriel Massadas&quot;],&quot;slug&quot;:[0,&quot;gabriel-massadas&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7oQXIEt6Jo1bGVuttPgl46/1c53697f20dec595f4a3f6a13303ff8c/gabriel-massadas.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Nelson Duarte&quot;],&quot;slug&quot;:[0,&quot;nelson-duarte&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/zaB3FkPTtktRWr9Quh4N6/fa2e9646d216cb8ad1719ad200623f00/nelson-duarte.jpg&quot;],&quot;location&quot;:[0,&quot;Portugal&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}]]],&quot;meta_description&quot;:[0,&quot;How we scaled AI Gateway to handle and store billions of requests, using Cloudflare Workers, D1, Durable Objects, and R2.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/billions-and-billions-of-logs-scaling-ai-gateway-with-the-cloudflare&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Billions and billions (of logs): scaling AI Gateway with the Cloudflare Developer Platform&quot;],&quot;description&quot;:[0,&quot;How we scaled AI Gateway to handle and store billions of requests, using Cloudflare Workers, D1, Durable Objects, and R2. \n&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2NAiCq0ZF8ACgg9x8jZwyj/04bfb998b306b58bb2c39a4942c7f71e/Billions_and_billions__of_logs_-_scaling_AI_Gateway_with_the_Cloudflare_Developer_Platform-OG.png&quot;]}]}],[0,{&quot;id&quot;:[0,&quot;41vXJNWrB0YHsKqSz6SGDS&quot;],&quot;title&quot;:[0,&quot;Durable Objects aren&#39;t just durable, they&#39;re fast: a 10x speedup for Cloudflare Queues&quot;],&quot;slug&quot;:[0,&quot;how-we-built-cloudflare-queues&quot;],&quot;excerpt&quot;:[0,&quot;Learn how we built Cloudflare Queues using our own Developer Platform and how it evolved to a geographically-distributed, horizontally-scalable architecture built on Durable Objects. Our new architecture supports over 10x more throughput and over 3x lower latency compared to the previous version.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://www.cloudflare.com/developer-platform/products/cloudflare-queues/\&quot;&gt;&lt;u&gt;Cloudflare Queues&lt;/u&gt;&lt;/a&gt; let a developer decouple their Workers into event-driven services. Producer Workers write events to a Queue, and consumer Workers are invoked to take actions on the events. For example, you can use a Queue to decouple an e-commerce website from a service which sends purchase confirmation emails to users. During 2024âs Birthday Week, we &lt;a href=\&quot;https://blog.cloudflare.com/builder-day-2024-announcements?_gl=1*18s1fwl*_gcl_au*MTgyNDA5NjE5OC4xNzI0MjgzMTQ0*_ga*OTgwZmE0YWUtZWJjMS00NmYxLTllM2QtM2RmY2I4ZjAwNzZk*_ga_SQCRB0TXZW*MTcyODkyOTU2OS4xNi4xLjE3Mjg5Mjk1NzcuNTIuMC4w/#queues-is-ga\&quot;&gt;&lt;u&gt;announced that Cloudflare Queues is now Generally Available&lt;/u&gt;&lt;/a&gt;, with significant performance improvements that enable larger workloads. To accomplish this, we switched to a new architecture for Queues that enabled the following improvements:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Median latency for sending messages has dropped from ~200ms to ~60ms&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Maximum throughput for each Queue has increased over 10x, from 400 to 5000 messages per second&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Maximum Consumer concurrency for each Queue has increased from 20 to 250 concurrent invocations&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5PvIsHfLwwIkp2LXVUDhmG/99f286f2f89d10b2a7e359d8d66f6dba/image5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;959\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Median latency drops from ~200ms to ~60ms as Queues are migrated to the new architecture&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;In this blog post, we&amp;#39;ll share details about how we built Queues using Durable Objects and the Cloudflare Developer Platform, and how we migrated from an initial Beta architecture to a geographically-distributed, horizontally-scalable architecture for General Availability.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;v1-beta-architecture\&quot;&gt;v1 Beta architecture&lt;/h3&gt;\n            &lt;a href=\&quot;#v1-beta-architecture\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;When initially designing Cloudflare Queues, we decided to build something simple that we could get into users&amp;#39; hands quickly. First, we considered leveraging an off-the-shelf messaging system such as Kafka or Pulsar. However, we decided that it would be too challenging to operate these systems at scale with the large number of isolated tenants that we wanted to support.&lt;/p&gt;&lt;p&gt;Instead of investing in new infrastructure, we decided to build on top of one of Cloudflare&amp;#39;s existing developer platform building blocks: &lt;b&gt;Durable Objects.&lt;/b&gt; &lt;a href=\&quot;https://www.cloudflare.com/developer-platform/durable-objects/\&quot;&gt;&lt;u&gt;Durable Objects&lt;/u&gt;&lt;/a&gt; are a simple, yet powerful building block for coordination and storage in a distributed system. In our initial &lt;i&gt;v1 &lt;/i&gt;architecture, each Queue was implemented using a single Durable Object. As shown below, clients would send messages to a Worker running in their region, which would be forwarded to the single Durable Object hosted in the WNAM (Western North America) region. We used a single Durable Object for simplicity, and hosted it in WNAM for proximity to our centralized configuration API service.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/yxj5Gut3usYa0mFbRddXU/881f5905f789bc2f910ee1b2dcadac92/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1100\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;One of a Queue&amp;#39;s main responsibilities is to accept and store incoming messages. Sending a message to a &lt;i&gt;v1&lt;/i&gt; Queue used the following flow:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;A client sends a POST request containing the message body to the Queues API at &lt;code&gt;/accounts/:accountID/queues/:queueID/messages&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The request is handled by an instance of the &lt;b&gt;Queue Broker Worker&lt;/b&gt; in a Cloudflare data center running near the client.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Worker performs authentication, and then uses Durable Objects &lt;code&gt;idFromName&lt;/code&gt; API to route the request to the &lt;b&gt;Queue Durable Object&lt;/b&gt; for the given &lt;code&gt;queueID&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Queue Durable Object persists the message to storage before returning a &lt;i&gt;success &lt;/i&gt;back to the client.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Durable Objects handled most of the heavy-lifting here: we did not need to set up any new servers, storage, or service discovery infrastructure. To route requests, we simply provided a &lt;code&gt;queueID&lt;/code&gt; and the platform handled the rest. To store messages, we used the Durable Object storage API to &lt;code&gt;put&lt;/code&gt; each message, and the platform handled reliably storing the data redundantly.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;consuming-messages\&quot;&gt;Consuming messages&lt;/h3&gt;\n            &lt;a href=\&quot;#consuming-messages\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;The other main responsibility of a Queue is to deliver messages to a Consumer. Delivering messages in a v1 Queue used the following process:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Each Queue Durable Object maintained an &lt;b&gt;alarm &lt;/b&gt;that was always set when there were undelivered messages in storage. The alarm guaranteed that the Durable Object would reliably wake up to deliver any messages in storage, even in the presence of failures. The alarm time was configured to fire after the user&amp;#39;s selected &lt;i&gt;max wait time&lt;/i&gt;&lt;b&gt;&lt;i&gt;, &lt;/i&gt;&lt;/b&gt;if only a partial batch of messages was available. Whenever one or more full batches were available in storage, the alarm was scheduled to fire immediately.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The alarm would wake the Durable Object, which continually looked for batches of messages in storage to deliver.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Each batch of messages was sent to a &amp;quot;Dispatcher Worker&amp;quot; that used &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/\&quot;&gt;&lt;u&gt;Workers for Platforms&lt;/u&gt;&lt;/a&gt; &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-for-platforms/workers-for-platforms/reference/how-workers-for-platforms-works/#dynamic-dispatch-worker\&quot;&gt;&lt;i&gt;&lt;u&gt;dynamic dispatch&lt;/u&gt;&lt;/i&gt;&lt;/a&gt; to pass the messages to the &lt;code&gt;queue()&lt;/code&gt; function defined in a user&amp;#39;s Consumer Worker&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4vAM17x3nN49JBMGNTblPp/6af391950df5f0fbc14faeccb351e38c/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;942\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This v1 architecture let us flesh out the initial version of the Queues Beta product and onboard users quickly. Using Durable Objects allowed us to focus on building application logic, instead of complex low-level systems challenges such as global routing and guaranteed durability for storage. Using a separate Durable Object for each Queue allowed us to host an essentially unlimited number of Queues, and provided isolation between them.&lt;/p&gt;&lt;p&gt;However, using &lt;i&gt;only&lt;/i&gt; one Durable Object per queue had some significant limitations:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Latency: &lt;/b&gt;we created all of our v1 Queue Durable Objects in Western North America. Messages sent from distant regions incurred significant latency when traversing the globe.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Throughput: &lt;/b&gt;A single Durable Object is not scalable: it is single-threaded and has a fixed capacity for how many requests per second it can process. This is where the previous 400 messages per second limit came from.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;b&gt;Consumer Concurrency: &lt;/b&gt;Due to &lt;a href=\&quot;https://developers.cloudflare.com/workers/platform/limits/#simultaneous-open-connections\&quot;&gt;&lt;u&gt;concurrent subrequest limits&lt;/u&gt;&lt;/a&gt;, a single Durable Object was limited in how many concurrent subrequests it could make to our Dispatcher Worker. This limited the number of &lt;code&gt;queue()&lt;/code&gt; handler invocations that it could run simultaneously.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;To solve these issues, we created a new v2 architecture that horizontally scales across &lt;b&gt;multiple&lt;/b&gt; Durable Objects to implement each single high-performance Queue.&lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;v2-architecture\&quot;&gt;v2 Architecture&lt;/h3&gt;\n            &lt;a href=\&quot;#v2-architecture\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;In the new v2 architecture for Queues, each Queue is implemented using multiple Durable Objects, instead of just one. Instead of a single region, we place &lt;i&gt;Storage Shard &lt;/i&gt;Durable Objects in &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/reference/data-location/#supported-locations-1\&quot;&gt;&lt;u&gt;all available regions&lt;/u&gt;&lt;/a&gt; to enable lower latency. Within each region, we create multiple Storage Shards and load balance incoming requests amongst them. Just like that, weâve multiplied message throughput.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2SJTb2UO8tKGrh26ixwLrA/7272e4eaf6f7e85f086a5ae08670387e/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1100\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Sending a message to a v2 Queue uses the following flow:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;A client sends a POST request containing the message body to the Queues API at &lt;code&gt;/accounts/:accountID/queues/:queueID/messages&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The request is handled by an instance of the &lt;b&gt;Queue Broker Worker&lt;/b&gt; running in a Cloudflare data center near the client.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Worker:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Performs authentication&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Reads from Workers KV to obtain a &lt;i&gt;Shard Map&lt;/i&gt; that lists available storage shards for the given &lt;code&gt;region&lt;/code&gt; and &lt;code&gt;queueID&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Picks one of the region&amp;#39;s Storage Shards at random, and uses Durable Objects &lt;code&gt;idFromName&lt;/code&gt; API to route the request to the chosen shard&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Storage Shard persists the message to storage before returning a &lt;i&gt;success &lt;/i&gt;back to the client.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;In this v2 architecture, messages are stored in the closest available Durable Object storage cluster near the user, greatly reducing latency since messages don&amp;#39;t need to be shipped all the way to WNAM. Using multiple shards within each region removes the bottleneck of a single Durable Object, and allows us to scale each Queue horizontally to accept even more messages per second. &lt;a href=\&quot;https://blog.cloudflare.com/tag/cloudflare-workers-kv/\&quot;&gt;&lt;u&gt;Workers KV&lt;/u&gt;&lt;/a&gt; acts as a fast metadata store: our Worker can quickly look up the shard map to perform load balancing across shards.&lt;/p&gt;&lt;p&gt;To improve the &lt;i&gt;Consumer&lt;/i&gt; side of v2 Queues, we used a similar &amp;quot;scale out&amp;quot; approach. A single Durable Object can only perform a limited number of concurrent subrequests. In v1 Queues, this limited the number of concurrent subrequests we could make to our Dispatcher Worker. To work around this, we created a new &lt;i&gt;Consumer Shard&lt;/i&gt; Durable Object class that we can scale horizontally, enabling us to execute many more concurrent instances of our users&amp;#39; &lt;code&gt;queue()&lt;/code&gt; handlers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2ujodUVBegDcWXi6DYJR41/5f31ba4da387df82613a496ff311f65f/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1243\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Consumer Durable Objects in v2 Queues use the following approach:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Each Consumer maintains an alarm that guarantees it will wake up to process any pending messages. &lt;i&gt;v2 &lt;/i&gt;Consumers are notified by the Queue&amp;#39;s &lt;i&gt;Coordinator &lt;/i&gt;(introduced below) when there are messages ready for consumption. Upon notification, the Consumer sets an alarm to go off immediately.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Consumer looks at the shard map, which contains information about the storage shards that exist for the Queue, including the number of available messages on each shard.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Consumer picks a random storage shard with available messages, and asks for a batch.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;The Consumer sends the batch to the Dispatcher Worker, just like for v1 Queues.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;After processing the messages, the Consumer sends another request to the Storage Shard to either &amp;quot;acknowledge&amp;quot; or &amp;quot;retry&amp;quot; the messages.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;This scale-out approach enabled us to work around the subrequest limits of a single Durable Object, and increase the maximum supported concurrency level of a Queue from 20 to 250.Â &lt;/p&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;the-coordinator-and-control-plane\&quot;&gt;The Coordinator and âControl Planeâ&lt;/h3&gt;\n            &lt;a href=\&quot;#the-coordinator-and-control-plane\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;p&gt;So far, we have primarily discussed the &amp;quot;Data Plane&amp;quot; of a v2 Queue: how messages are load balanced amongst Storage Shards, and how Consumer Shards read and deliver messages. The other main piece of a v2 Queue is the &amp;quot;Control Plane&amp;quot;, which handles creating and managing all the individual Durable Objects in the system. In our v2 architecture, each Queue has a single &lt;i&gt;Coordinator&lt;/i&gt; Durable Object that acts as the brain of the Queue. Requests to create a Queue, or change its settings, are sent to the Queue&amp;#39;s Coordinator.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7lYJs23oJ8ibtGgbuOk9JN/7ffa8073a4391602b67a0c6e134975bc/image7.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1100\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The Coordinator maintains a &lt;i&gt;Shard Map&lt;/i&gt; for the Queue, which includes metadata about all the Durable Objects in the Queue (including their region, number of available messages, current estimated load, etc.). The Coordinator periodically writes a fresh copy of the Shard Map into Workers KV, as pictured in step 1 of the diagram. Placing the shard map into Workers KV ensures that it is globally cached and available for our Worker to read quickly, so that it can pick a shard to accept the message.&lt;/p&gt;&lt;p&gt;Every shard in the system periodically sends a heartbeat to the Coordinator as shown in steps 2 and 3 of the diagram. Both Storage Shards and Consumer Shards send heartbeats, including information like the number of messages stored locally, and the current load (requests per second) that the shard is handling. The Coordinator uses this information to perform &lt;b&gt;&lt;i&gt;autoscaling. &lt;/i&gt;&lt;/b&gt;When it detects that the shards in a particular region are overloaded, it creates additional shards in the region, and adds them to the shard map in Workers KV. Our Worker sees the updated shard map and naturally load balances messages across the freshly added shards. Similarly, the Coordinator looks at the backlog of available messages in the Queue, and decides to add more Consumer shards to increase Consumer throughput when the backlog is growing. Consumer Shards pull messages from Storage Shards for processing as shown in step 4 of the diagram.&lt;/p&gt;&lt;p&gt;Switching to a new scalable architecture allowed us to meet our performance goals and take Queues to GA. As a recap, this new architecture delivered these significant improvements:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;P50 latency for writing to a Queue has dropped from ~200ms to ~60ms.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Maximum throughput for a Queue has increased from 400 to 5000 messages per second.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Maximum consumer concurrency has increased from 20 to 250 invocations.\t&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;\n          &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n            &lt;h3 id=\&quot;whats-next-for-queues\&quot;&gt;What&#39;s next for Queues&lt;/h3&gt;\n            &lt;a href=\&quot;#whats-next-for-queues\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n              &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n            &lt;/a&gt;\n          &lt;/div&gt;\n        &lt;ul&gt;&lt;li&gt;&lt;p&gt;We plan on leveraging the performance improvements in the new &lt;a href=\&quot;https://developers.cloudflare.com/durable-objects/\&quot;&gt;&lt;u&gt;beta version of Durable Objects&lt;/u&gt;&lt;/a&gt; which use SQLite to continue to improve throughput/latency in Queues.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;We will soon be adding message management features to Queues so that you can take actions to purge messages in a queue, pause consumption of messages, or âredriveâ/move messages from one queue to another (for example messages that have been sent to a Dead Letter Queue could be âredrivenâ or moved back to the original queue).&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Work to make Queues the &amp;quot;event hub&amp;quot; for the Cloudflare Developer Platform:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;Create a low-friction way for events emitted from other Cloudflare services with event schemas to be sent to Queues.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Build multi-Consumer support for Queues so that Queues are no longer limited to one Consumer per queue.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;To start using Queues, head over to our &lt;a href=\&quot;https://developers.cloudflare.com/queues/get-started/\&quot;&gt;&lt;u&gt;Getting Started&lt;/u&gt;&lt;/a&gt; guide.Â &lt;/p&gt;&lt;p&gt;Do distributed systems like Cloudflare Queues and Durable Objects interest you? Would you like to help build them at Cloudflare? &lt;a href=\&quot;https://boards.greenhouse.io/embed/job_app?token=5390243&amp;gh_src=b2e516a81us\&quot;&gt;&lt;u&gt;We&amp;#39;re Hiring!&lt;/u&gt;&lt;/a&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-10-24T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2024-10-24T13:00:03.392Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7jqMx0fPAknCu1pBfXvSG4/499662b35777f79347cb6ef96bdd97c1/image6.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;]}],[0,{&quot;id&quot;:[0,&quot;7p9V4sEnUw2qMWnn5Jzsp9&quot;],&quot;name&quot;:[0,&quot;Cloudflare Queues&quot;],&quot;slug&quot;:[0,&quot;cloudflare-queues&quot;]}],[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;5v2UZdTRX1Rw9akmhexnxs&quot;],&quot;name&quot;:[0,&quot;Durable Objects&quot;],&quot;slug&quot;:[0,&quot;durable-objects&quot;]}],[0,{&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;]}],[0,{&quot;id&quot;:[0,&quot;3JAY3z7p7An94s6ScuSQPf&quot;],&quot;name&quot;:[0,&quot;Developer Platform&quot;],&quot;slug&quot;:[0,&quot;developer-platform&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Josh Wheeler&quot;],&quot;slug&quot;:[0,&quot;josh&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6imiHQ1XAeb46hwiEvyfMd/ea89cdb2b823497aef6cd84a2b24cc89/josh.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Siddhant Sinha&quot;],&quot;slug&quot;:[0,&quot;siddhant&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1vq92TZAtrQDTkxRNUoh3u/896e53442514c2062d025a508205444c/siddhant.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null]}],[0,{&quot;name&quot;:[0,&quot;Todd Mantell&quot;],&quot;slug&quot;:[0,&quot;todd-mantell&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6EqvYtkgTeVJkuNFM3tk9d/762b1047d26a713451015fb92bc731e5/_tmp_mini_magick20240417-2-ql63l7.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}],[0,{&quot;name&quot;:[0,&quot;Pranshu Maheshwari&quot;],&quot;slug&quot;:[0,&quot;pranshu-maheshwari&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/uvyJ2RWjiLA25kglsiQBv/06acca0147686d8c076ff771cc923a57/IMG_7400.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0]}]]],&quot;meta_description&quot;:[0,&quot;Learn how we built Cloudflare Queues using our own Developer Platform and how it evolved to a geographically-distributed, horizontally-scalable architecture built on Durable Objects. Our new architecture supports over 10x more throughput and over 3x lower latency compared to the previous version.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/how-we-built-cloudflare-queues&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Durable Objects aren&#39;t just durable, they&#39;re fast: a 10x speedup for Cloudflare Queues&quot;],&quot;description&quot;:[0,&quot;Learn how we built Cloudflare Queues using our own Developer Platform and how it evolved to a geographically-distributed, horizontally-scalable architecture built on Durable Objects. Our new architecture supports over 10x more throughput and over 3x lower latency compared to the previous version.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5bvL18K4wXQlP76YGtO0x0/fd7e25d06fc3b1c74f385d08b00f2ba1/Durable_Objects_aren-t_just_durable__they-re_fast-_a_10x_speedup_for_Cloudflare_Queues-OG.png&quot;]}]}]]],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}],&quot;localesAvailable&quot;:[1,[[0,&quot;zh-cn&quot;],[0,&quot;zh-tw&quot;],[0,&quot;ja-jp&quot;],[0,&quot;ko-kr&quot;]]],&quot;footerBlurb&quot;:[0,&quot;Cloudflare&#39;s connectivity cloud protects &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/network-services/&#39; rel=&#39;noreferrer&#39;&gt;entire corporate networks&lt;/a&gt;, helps customers build &lt;a target=&#39;_blank&#39; href=&#39;https://workers.cloudflare.com/&#39; rel=&#39;noreferrer&#39;&gt;Internet-scale applications efficiently&lt;/a&gt;, accelerates any &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/performance/accelerate-internet-applications/&#39; rel=&#39;noreferrer&#39;&gt;website or Internet application&lt;/a&gt;, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/ddos/&#39; rel=&#39;noreferrer&#39;&gt;wards off DDoS attacks&lt;/a&gt;, keeps &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/application-security/&#39; rel=&#39;noreferrer&#39;&gt;hackers at bay&lt;/a&gt;, and can help you on &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/products/zero-trust/&#39; rel=&#39;noreferrer&#39;&gt;your journey to Zero Trust&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;Visit &lt;a target=&#39;_blank&#39; href=&#39;https://one.one.one.one/&#39; rel=&#39;noreferrer&#39;&gt;1.1.1.1&lt;/a&gt; from any device to get started with our free app that makes your Internet faster and safer.&lt;br/&gt;&lt;br/&gt;To learn more about our mission to help build a better Internet, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/learning/what-is-cloudflare/&#39; rel=&#39;noreferrer&#39;&gt;start here&lt;/a&gt;. If you&amp;apos;re looking for a new career direction, check out &lt;a target=&#39;_blank&#39; href=&#39;http://www.cloudflare.com/careers&#39; rel=&#39;noreferrer&#39;&gt;our open positions&lt;/a&gt;.&quot;]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;Post&quot;,&quot;value&quot;:true}" await-children=""><main id="post" class="flex flex-row flex-wrap items-center justify-center pt2 pt4-l"><article class="post-full mw-100 ph3 ph0-l fs-20px"><h1 class="f6 f7-l fw4 gray1 pt1 pt3-l mb1">AI Everywhere with the WAF Rule Builder Assistant, Cloudflare Radar AI Insights, and updated AI bot protection</h1><p class="f3 fw5 gray5 db di-l mt2">2024-09-27</p><ul class="author-lists flex pl0 mt4"><li class="list flex items-center pr2 mb1-ns"><a href="/author/adam-martinetti" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3sL65Jw7yfClw41pjnBfKp/75bfcc0615d0f01e0631ab0139900cd2/adam-martinetti.jpg" alt="Adam Martinetti" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/adam-martinetti" class="fw4 f3 no-underline black mr3">Adam Martinetti</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/harsh-saxena" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1eEVnuAy0vFvqrA4DuCOyI/56dcd6d40b152672d6a5a3bedae2f623/Harsh_S.jpg" alt="Harsh Saxena" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/harsh-saxena" class="fw4 f3 no-underline black mr3">Harsh Saxena</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/gauri-baraskar" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1x0TXREl9zWwQIqwIEeLIK/0eaa91581ceae8a561596e2f29257250/Gauri_B.jpg" alt="Gauri Baraskar" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/gauri-baraskar" class="fw4 f3 no-underline black mr3">Gauri Baraskar</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/carlos" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2xzs8tkcfue8Y8BHqsqwIV/f3210160c003f0a7da3baa3c51f90511/carlos.png" alt="Carlos Azevedo" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/carlos" class="fw4 f3 no-underline black mr3">Carlos Azevedo</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/david-belson" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/en7vkXf6rLBm4F8IcNHXT/645022bf841fabff7732aa3be3949808/david-belson.jpeg" alt="David Belson" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/david-belson" class="fw4 f3 no-underline black mr3">David Belson</a></div></li></ul><section class="post-full-content"><div class="mb2 gray5">7 min read</div><div class="mt4">This post is also available in <a href="/zh-cn/bringing-ai-to-cloudflare">ç®ä½ä¸­æ</a>, <a href="/ja-jp/bringing-ai-to-cloudflare">æ¥æ¬èª</a>, <a href="/ko-kr/bringing-ai-to-cloudflare">íêµ­ì´</a> and <a href="/zh-tw/bringing-ai-to-cloudflare">ç¹é«ä¸­æ</a>.</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/32vnNHpfRqiOypOggowFgw/d075a178424e42324b9b7cb586a401f1/image3.png" alt=""/><div class="post-content lh-copy gray1"><p>The continued growth of AI has fundamentally changed the Internet over the past 24 months. AI is increasingly ubiquitous, and Cloudflare is leaning into the new opportunities and challenges it presents in a big way. This year for Cloudflareâs birthday, weâve extended our AI Assistant capabilities to help you build new WAF rules, added AI bot traffic insights on Cloudflare Radar, and given customers new AI bot blocking capabilities.Â Â </p>
          <div class="flex anchor relative">
            <h2 id="ai-assistant-for-waf-rule-builder">AI Assistant for WAF Rule Builder</h2>
            <a href="#ai-assistant-for-waf-rule-builder" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
          
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5RYC4wmCDbs0axY92FfkFk/a728906cb6a902dd1c78ec93a0f650c2/BLOG-2564_1.png" alt="BLOG-2564 1" class="kg-image" width="1999" height="501" loading="lazy"/>
          </figure><p>At Cloudflare, weâre always listening to your feedback and striving to make our products as user-friendly and powerful as possible. One area where we&#39;ve heard your feedback loud and clear is in the complexity of creating custom and rate-limiting rules for our Web Application Firewall (WAF). With this in mind, weâre excited to introduce a new feature that will make rule creation easier and more intuitive: the AI Assistant for WAF Rule Builder.Â </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7avSjubqlfg7L8ymKEztgk/7c3c31e50879ec64bccc384bdfcd5524/BLOG-2564_2.png" alt="BLOG-2564 2" class="kg-image" width="1056" height="1460" loading="lazy"/>
          </figure><p>By simply entering a natural language prompt, you can generate a custom or rate-limiting rule tailored to your needs. For example, instead of manually configuring a complex rule matching criteria, you can now type something like, &quot;Match requests with low bot score,&quot; and the assistant will generate the rule for you. Itâs not about creating the perfect rule in one step, but giving you a strong foundation that you can build on.Â </p><p>The assistant will be available in the Custom and Rate Limit Rule Builder for all WAF users. Weâre launching this feature in Beta for all customers, and we encourage you to give it a try. Weâre looking forward to hearing your feedback (via the UI itself) as we continue to refine and enhance this tool to meet your needs.</p>
          <div class="flex anchor relative">
            <h2 id="ai-bot-traffic-insights-on-cloudflare-radar">AI bot traffic insights on Cloudflare Radar</h2>
            <a href="#ai-bot-traffic-insights-on-cloudflare-radar" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
          <p>AI platform providers use bots to crawl and scrape websites, vacuuming up data to use for model training. This is frequently done without the permission of, or a business relationship with, the content owners and providers. In July, Cloudflare urged content owners and providers to <a href="https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/"><u>âdeclare their AIndependenceâ</u></a>, providing them with a way to block AI bots, scrapers, and crawlers with a single click. In addition to this so-called âeasy buttonâ approach, sites can provide more specific guidance to these bots about what they are and are not allowed to access through directives in a <a href="https://www.cloudflare.com/en-gb/learning/bots/what-is-robots-txt/"><u>robots.txt</u></a> file. Regardless of whether a customer chooses to block or allow requests from AI-related bots, Cloudflare has insight into request activity from these bots, and associated traffic trends over time.</p><p>Tracking traffic trends for AI bots can help us better understand their activity over time â which are the most aggressive and have the highest volume of requests, which launch crawls on a regular basis, etc. The new <a href="https://radar.cloudflare.com/traffic#ai-bot-crawler-traffic"><b><u>AI bot &amp; crawler traffic </u></b><u>graph on Radarâs Traffic page</u></a> provides insight into these traffic trends gathered over the selected time period for the top known AI bots. The associated list of bots tracked here is based on the <a href="https://github.com/ai-robots-txt/ai.robots.txt"><u>ai.robots.txt list</u></a>, and will be updated with new bots as they are identified. <a href="https://developers.cloudflare.com/api/operations/radar-get-ai-bots-timeseries-group-by-user-agent"><u>Time series</u></a> and <a href="https://developers.cloudflare.com/api/operations/radar-get-ai-bots-summary-by-user-agent"><u>summary</u></a> data is available from the Radar API as well. (Traffic trends for the full set of AI bots &amp; crawlers <a href="https://radar.cloudflare.com/explorer?dataSet=ai.bots"><u>can be viewed in the new Data Explorer</u></a>.)</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5tYefQaBhTPYpqZPtE6KPu/f60694d0b24de2acba13fe0944589885/BLOG-2564_3.png" alt="BLOG-2564 3" class="kg-image" width="1999" height="631" loading="lazy"/>
          </figure>
          <div class="flex anchor relative">
            <h2 id="blocking-more-ai-bots">Blocking more AI bots</h2>
            <a href="#blocking-more-ai-bots" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
          
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/UiFu8l6K4Pm3ulxTK3XU0/541d109e29a9ae94e4792fdf94f7e4aa/BLOG-2564_4.png" alt="BLOG-2564 4" class="kg-image" width="1999" height="501" loading="lazy"/>
          </figure><p>For Cloudflareâs birthday, weâre following up on our previous blog post, <a href="https://blog.cloudflare.com/declaring-your-aindependence-block-ai-bots-scrapers-and-crawlers-with-a-single-click/"><i><u>Declaring Your AIndependence</u></i></a>, with an update on the new detections weâve added to stop AI bots. Customers who havenât already done so can simply <a href="https://dash.cloudflare.com/?to=/:account/:zone/security/bots/configure"><u>click the button</u></a> to block AI bots to gain more protection for their website.Â </p>
          <div class="flex anchor relative">
            <h3 id="enabling-dynamic-updates-for-the-ai-bot-rule">Enabling dynamic updates for the AI bot rule</h3>
            <a href="#enabling-dynamic-updates-for-the-ai-bot-rule" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>The old button allowed customers to block <i>verified</i> AI crawlers, those that respect robots.txt and crawl rate, and donât try to hide their behavior. Weâve added new crawlers to that list, but weâve also expanded the previous rule to include 27 signatures (and counting) of AI bots that <i>donât </i>follow the rules. We want to take time to say âthank youâ to everyone who took the time to use our â<a href="https://docs.google.com/forms/d/14bX0RJH_0w17_cAUiihff5b3WLKzfieDO4upRlo5wj8"><u>tip line</u></a>â to point us towards new AI bots. These tips have been extremely helpful in finding some bots that would not have been on our radar so quickly.Â </p><p>For each bot weâve added, weâre also adding them to our âDefinitely automatedâ definition as well. So, if youâre a self-service plan customer using <a href="https://blog.cloudflare.com/super-bot-fight-mode/"><u>Super Bot Fight Mode</u></a>, youâre already protected. Enterprise Bot Management customers will see more requests shift from the âLikely Botâ range to the âDefinitely automatedâ range, which weâll discuss more below.</p><p>Under the hood, weâve converted this rule logic to a <a href="https://developers.cloudflare.com/waf/managed-rules/"><u>Cloudflare managed rule</u></a> (the same framework that powers our WAF). This enables our security analysts and engineers to safely push updates to the rule in real-time, similar to how new WAF rule changes are rapidly delivered to ensure our customers are protected against the latest CVEs. If you havenât logged back into the Bots dashboard since the previous version of our AI bot protection was announced, click the button again to update to the latest protection.Â </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2tI8Yqxt1S0UPapImb32J4/6cb9e9bf423c370383edb820e5722929/BLOG-2564_5.png" alt="BLOG-2564 5" class="kg-image" width="1999" height="522" loading="lazy"/>
          </figure>
          <div class="flex anchor relative">
            <h3 id="the-impact-of-new-fingerprints-on-the-model">The impact of new fingerprints on the modelÂ </h3>
            <a href="#the-impact-of-new-fingerprints-on-the-model" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>One hidden beneficiary of fingerprinting new AI bots is our ML model. <a href="https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more/"><u>As weâve discussed before</u></a>, our global ML model uses supervised machine learning and greatly benefits from more sources of labeled bot data. Below, you can see how well our ML model recognized these requests as automated, before and after we updated the button, adding new rules. To keep things simple, we have shown only the top 5 bots by the volume of requests on the chart. With the introduction of our new managed rule, we have observed an improvement in our detection capabilities for the majority of these AI bots. Button v1 represents the old option that let customers block only verified AI crawlers, while Button v2 is the newly introduced feature that includes managed rule detections.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2CZVGyDCp9ZtMrZdIi49fE/aacd04d240e9348b5a9b65bad4b470e2/BLOG-2564_6.jpg" alt="BLOG-2564 6" class="kg-image" width="1887" height="1406" loading="lazy"/>
          </figure><p>So how did we make our detections more robust? As we have mentioned before, sometimes <a href="https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more/"><i><u>a single attribute can give a bot away</u></i></a>. We developed a sophisticated set of heuristics tailored to these AI bots, enabling us to effortlessly and accurately classify them as such. Although our ML model was already detecting the vast majority of these requests, the integration of additional heuristics has resulted in a noticeable increase in detection rates for each bot, and ensuring we score every request correctly 100% of the time. Transitioning from a purely machine learning approach to incorporating heuristics offers several advantages, including faster detection times and greater certainty in classification. While deploying a machine learning model is complex and time-consuming, new heuristics can be created in minutes.Â </p><p>The initial launch of the AI bots block button was well-received and is now used by over 133,000 websites, with significant adoption even among our Free tier customers. The newly updated button, launched on August 20, 2024, is rapidly gaining traction. Over 90,000 zones have already adopted the new rule, with approximately 240 new sites integrating it every hour. Overall, we are now helping to protect the intellectual property of more than 146,000 sites from AI bots, and we are currently blocking 66 million requests daily with this new rule. Additionally, weâre excited to announce that support for configuring AI bots protection via Terraform will be available by the end of this year, providing even more flexibility and control for managing your bot protection settings.</p>
          <div class="flex anchor relative">
            <h3 id="bot-behavior">Bot behavior</h3>
            <a href="#bot-behavior" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
        <p>With the enhancements to our detection capabilities, it is essential to assess the impact of these changes to bot activity on the Internet. Since the launch of the updated AI bots block button, we have been closely monitoring for any shifts in bot activity and adaptation strategies. The most basic fingerprinting technique we use to identify AI bot looking for simple user-agent matches. User-agent matches are important to monitor because they indicate the bot is transparently announcing who they are when theyâre crawling a website.Â </p><p>The graph below shows a volume of traffic we label as AI bot over the past two months. The blue line indicates the daily request count, while the red line represents the monthly average number of requests. In the past two months, we have seen an average reduction of nearly 30 million requests, with a decrease of 40 million in the most recent month.This decline coincides with the release of Button v1 and Button v2. Our hypothesis is that with the new AI bots blocking feature, Cloudflare is blocking a majority of these bots, which is discouraging them from crawling.Â </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/23ULxmxBIRskEONlWVIvlA/1dbd3d03239047492c2d4f7307217d97/BLOG-2564_7.jpg" alt="BLOG-2564 7" class="kg-image" width="1999" height="1048" loading="lazy"/>
          </figure><p>This hypothesis is supported by the observed decline in requests from several top AI crawlers. Specifically, the Bytespider bot reduced its daily requests from approximately 100 million to just 50 million between the end of June and the end of August (see graph below). This reduction could be attributed to several factors, including our new AI bots block button and changes in the crawler&#39;s strategy.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5UwtyZSXULrVzIqLcICGKd/fdf02c15d17e1d7ed248ba5f8a97eb54/BLOG-2564_8.jpg" alt="BLOG-2564 8" class="kg-image" width="1999" height="993" loading="lazy"/>
          </figure><p>We have also observed an increase in the accountability of some AI crawlers. The most basic fingerprinting technique we use to identify AI bot looking for simple user-agent matches. User-agent matches are important to monitor because they indicate the bot is transparently announcing who they are when theyâre crawling a website. These crawlers are now more frequently using their agents, reflecting a shift towards more transparent and responsible behavior. Notably, there has been a dramatic surge in the number of requests from the Perplexity user agent. This increase might be linked to <a href="https://rknight.me/blog/perplexity-ai-is-lying-about-its-user-agent/">previous accusations<u> </u></a>that Perplexity did not properly present its user agent, which could have prompted a shift in their approach to ensure better identification and compliance. </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7Hq2vUMqqdNCyaxNTCg3JD/610ad53d57203203c5176229245c8086/BLOG-2564_9.jpg" alt="BLOG-2564 9" class="kg-image" width="1999" height="991" loading="lazy"/>
          </figure><p>These trends suggest that our updates are likely affecting how AI crawlers interact with content. We will continue to monitor AI bot activity to help users control who accesses their content and how. By keeping a close watch on emerging patterns, we aim to provide users with the tools and insights needed to make informed decisions about managing their traffic.Â </p>
          <div class="flex anchor relative">
            <h2 id="wrap-up">Wrap up</h2>
            <a href="#wrap-up" aria-hidden="true" class="relative sm:absolute sm:-left-5">
              <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
            </a>
          </div>
          <p>Weâre excited to continue to explore the AI landscape, whether weâre finding more ways to make the Cloudflare dashboard usable or new threats to guard against. Our AI insights on Radar update in near real-time, so please join us in watching as new trends emerge and discussing them in the <a href="https://community.cloudflare.com/"><u>Cloudflare Community</u></a>.Â </p></div></section><section class="post-full-content flex flex-row flex-wrap mw7 center mb4"><div class="post-content lh-copy w-100 gray1 bt b--gray8 pt4">Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href="https://www.cloudflare.com/careers" rel='noreferrer'>our open positions</a>.</div></section><div class="pv2 ph0-l mw7 center" id="social-buttons"><div class="mt5-l mt2 mb4 f2 flex flex-row-ns flex-column flex-wrap"><a id="social-button-hn" title="Discuss on Hacker News" href="https://news.ycombinator.com/submitlink?u=https://blog.cloudflare.com/bringing-ai-to-cloudflare" target="_blank" rel="noreferrer" class="mr2-ns mb0-l white link b pv3 ph3 mb3 " style="background-color:#0055DC"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 512 512" class="mr2"><g><path d="M31,31v450h450V31H31z M270.1,287.6v94.9h-28.1v-94.9L165,143.5h31.9L256,254.3l59.1-110.8H347
C347,143.5,270.1,287.6,270.1,287.6z"></path></g></svg><span class="v-mid">Discuss on Hacker News</span></a></div></div><iframe sandbox="allow-scripts allow-popups" title="cloudflare-tv-live-link" id="cloudflare-tv-embed" src="https://cloudflare.tv/embed/live.html" loading="lazy"></iframe><a href="/tag/birthday-week" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Birthday Week</a><a href="/tag/bot-management" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Bot Management</a><a href="/tag/bots" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Bots</a><a href="/tag/ai-bots" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">AI Bots</a><a href="/tag/ai" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">AI</a><a href="/tag/machine-learning" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Machine Learning</a><a href="/tag/generative-ai" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Generative AI</a><a href="/tag/security" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security</a><a href="/tag/developers" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Developers</a><a href="/tag/agile-developer-services" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Agile Developer Services</a><a href="/tag/developer-platform" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Developer Platform</a><a href="/tag/application-services" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Application Services</a><a href="/tag/product-news" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Product News</a></article></main><div class="ph3 pv3"><div class=" flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="black fw5 f4 mt4">Follow on X</p></div><div class="w-100 pb2"><span>Adam Martinetti</span><span class="ph1">|</span><a href="https://x.com/@adamemcf" class="no-underline">@adamemcf</a></div><div class="w-100 pb2"><span>David Belson</span><span class="ph1">|</span><a href="https://x.com/@dbelson" class="no-underline">@dbelson</a></div><div class="w-100 pb2"><span>Cloudflare</span><span class="ph2">|</span><a href="https://x.com/@cloudflare" class="no-underline">@cloudflare</a></div></div></div><div data-testid="related-posts-section" class="pv4 ph3 ph0-l flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="orange fw5 f4 mt4 ttu">Related posts</p></div><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2024-10-25T14:00+01:00">October 25, 2024  1:00 PM</p><a data-testid="related-posts-article-title" href="/elephants-in-tunnels-how-hyperdrive-connects-to-databases-inside-your-vpc-networks" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Elephants in tunnels: how Hyperdrive connects to databases inside your VPC networks</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Hyperdrive (Cloudflareâs globally distributed SQL connection pooler and cache) recently added support for directing database traffic from Workers across Cloudflare Tunnels. We dive deep on what it took to add this feature.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/andrew-repp" class="fw5 f2 black no-underline">Andrew Repp</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/emilio-assuncao" class="fw5 f2 black no-underline">Emilio AssunÃ§Ã£o</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/abhishek-chanda" class="fw5 f2 black no-underline">Abhishek Chanda</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/developer-platform" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform<!-- -->,</a>Â </span><span><a href="/tag/deep-dive" class="no-underline f1 fw2 blue3 underline-hover">Deep Dive<!-- -->,</a>Â </span><span><a href="/tag/workers" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers<!-- -->,</a>Â </span><span><a href="/tag/hyperdrive" class="no-underline f1 fw2 blue3 underline-hover">Hyperdrive<!-- -->,</a>Â </span><span><a href="/tag/postgres" class="no-underline f1 fw2 blue3 underline-hover">Postgres<!-- -->,</a>Â </span><span><a href="/tag/sql" class="no-underline f1 fw2 blue3 underline-hover">SQL<!-- -->,</a>Â </span><span><a href="/tag/rust" class="no-underline f1 fw2 blue3 underline-hover">Rust<!-- -->,</a>Â </span><span><a href="/tag/websockets" class="no-underline f1 fw2 blue3 underline-hover">WebSockets</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2024-10-24T14:05+01:00">October 24, 2024  1:05 PM</p><a data-testid="related-posts-article-title" href="/building-workflows-durable-execution-on-workers" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Build durable applications on Cloudflare Workers: you write the Workflows, we take care of the rest</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Cloudflare Workflows is now in open beta! Workflows allows you to build reliable, repeatable, long-lived multi-step applications that can automatically retry, persist state, and scale out. Read on to learn how Workflows works, how we built it on top of Durable Objects, and how you can deploy your first Workflows application.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/sid" class="fw5 f2 black no-underline">Sid Chatterjee</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/silverlock" class="fw5 f2 black no-underline">Matt Silverlock</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/celso" class="fw5 f2 black no-underline">Celso Martinho</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/developer-platform" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform<!-- -->,</a>Â </span><span><a href="/tag/workers" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers<!-- -->,</a>Â </span><span><a href="/tag/durable-objects" class="no-underline f1 fw2 blue3 underline-hover">Durable Objects<!-- -->,</a>Â </span><span><a href="/tag/workflows" class="no-underline f1 fw2 blue3 underline-hover">Workflows</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2024-10-24T14:00+01:00">October 24, 2024  1:00 PM</p><a data-testid="related-posts-article-title" href="/billions-and-billions-of-logs-scaling-ai-gateway-with-the-cloudflare" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Billions and billions (of logs): scaling AI Gateway with the Cloudflare Developer Platform</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">How we scaled AI Gateway to handle and store billions of requests, using Cloudflare Workers, D1, Durable Objects, and R2.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/catarina-pires-mota" class="fw5 f2 black no-underline">Catarina Pires Mota</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/gabriel-massadas" class="fw5 f2 black no-underline">Gabriel Massadas</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/nelson-duarte" class="fw5 f2 black no-underline">Nelson Duarte</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/ai" class="no-underline f1 fw2 blue3 underline-hover">AI<!-- -->,</a>Â </span><span><a href="/tag/ai-gateway" class="no-underline f1 fw2 blue3 underline-hover">AI Gateway<!-- -->,</a>Â </span><span><a href="/tag/durable-objects" class="no-underline f1 fw2 blue3 underline-hover">Durable Objects<!-- -->,</a>Â </span><span><a href="/tag/d1" class="no-underline f1 fw2 blue3 underline-hover">D1<!-- -->,</a>Â </span><span><a href="/tag/developer-platform" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform<!-- -->,</a>Â </span><span><a href="/tag/developers" class="no-underline f1 fw2 blue3 underline-hover">Developers<!-- -->,</a>Â </span><span><a href="/tag/agile-developer-services" class="no-underline f1 fw2 blue3 underline-hover">Agile Developer Services<!-- -->,</a>Â </span><span><a href="/tag/workers" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-r2" class="no-underline f1 fw2 blue3 underline-hover">R2 Storage</a>Â </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2024-10-24T14:00+01:00">October 24, 2024  1:00 PM</p><a data-testid="related-posts-article-title" href="/how-we-built-cloudflare-queues" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Durable Objects aren&#x27;t just durable, they&#x27;re fast: a 10x speedup for Cloudflare Queues</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Learn how we built Cloudflare Queues using our own Developer Platform and how it evolved to a geographically-distributed, horizontally-scalable architecture built on Durable Objects. Our new architecture supports over 10x more throughput and over 3x lower latency compared to the previous version.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- -->Â </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/josh" class="fw5 f2 black no-underline">Josh Wheeler</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/siddhant" class="fw5 f2 black no-underline">Siddhant Sinha</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/todd-mantell" class="fw5 f2 black no-underline">Todd Mantell</a><span class="fw5 f2 black no-underline">,Â </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/pranshu-maheshwari" class="fw5 f2 black no-underline">Pranshu Maheshwari</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/product-news" class="no-underline f1 fw2 blue3 underline-hover">Product News<!-- -->,</a>Â </span><span><a href="/tag/cloudflare-queues" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Queues<!-- -->,</a>Â </span><span><a href="/tag/workers" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers<!-- -->,</a>Â </span><span><a href="/tag/durable-objects" class="no-underline f1 fw2 blue3 underline-hover">Durable Objects<!-- -->,</a>Â </span><span><a href="/tag/developers" class="no-underline f1 fw2 blue3 underline-hover">Developers<!-- -->,</a>Â </span><span><a href="/tag/developer-platform" class="no-underline f1 fw2 blue3 underline-hover">Developer Platform</a>Â </span></div></article></div><!--astro:end--></astro-island><footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">Â© <!-- -->2024<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8db30b957dd16d64","version":"2024.10.4","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"2bc156e5f250476cb274d269511ffb57","b":1}' crossorigin="anonymous"></script>
