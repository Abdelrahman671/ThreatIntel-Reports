<!doctype html><html lang="en"><head>
    <meta charset="utf-8">
    <title>Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2</title>
    
    <link rel="shortcut icon" href="https://www.hunters.security/hubfs/Youtube%20Profile%20Picture-2.png" sizes="16x16">
    
    <meta name="description" content="Discover how the latest cybersecurity threat research on VEILDrive exposes attackers exploiting Microsoft services for C2, bypassing defenses, and leveraging SaaS infrastructure.">
    <meta name="viewport" content="width=device-width">
    
<!--     <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="ffebe3a6-627f-4df7-9ea2-5ea145fcb580" type="text/javascript" async></script> -->
    
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.eot" as="font" type="font/embedded-opentype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.ttf" as="font" type="font/truetype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.svg" as="font" type="font/svg" crossorigin>

    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.eot" as="font" type="font/embedded-opentype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.ttf" as="font" type="font/truetype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.svg" as="font" type="font/svg" crossorigin>

    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.eot" as="font" type="font/embedded-opentype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.ttf" as="font" type="font/truetype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.svg" as="font" type="font/svg" crossorigin>

    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.eot" as="font" type="font/embedded-opentype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.ttf" as="font" type="font/truetype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.svg" as="font" type="font/svg" crossorigin>

    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.eot" as="font" type="font/embedded-opentype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.ttf" as="font" type="font/truetype" crossorigin>
    <link rel="preload" href="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.svg" as="font" type="font/svg" crossorigin>


    <style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');

      @font-face {
        font-family: 'F37 Judge';
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.eot');
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.eot') format('embedded-opentype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.woff2') format('woff2'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.woff') format('woff'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.ttf') format('truetype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/F37-Judge-Bold/F37JudgeBoldCompressed.svg') format('svg');
        font-weight: 700;
        font-style: normal;
        font-display: swap;
      }
      @font-face {
        font-family: 'Graphik';
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.eot');
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.eot') format('embedded-opentype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.woff2') format('woff2'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.woff') format('woff'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.ttf') format('truetype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Regular/GraphikRegularWeb.svg') format('svg');
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
      @font-face {
        font-family: 'Graphik';
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.eot');
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.eot') format('embedded-opentype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.woff2') format('woff2'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.woff') format('woff'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.ttf') format('truetype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Medium/GraphikMediumWeb.svg') format('svg');
        font-weight: 500;
        font-style: normal;
       font-display: swap;
      }
      @font-face {
        font-family: 'Graphik';
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.eot');
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.eot') format('embedded-opentype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.woff2') format('woff2'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.woff') format('woff'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.ttf') format('truetype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Semibold/GraphikSemiboldWeb.svg') format('svg');
        font-weight: 600;
        font-style: normal;
        font-display: swap;
      }
      @font-face {
        font-family: 'Graphik';
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.eot');
        src: url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.eot') format('embedded-opentype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.woff2') format('woff2'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.woff') format('woff'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.ttf') format('truetype'),
          url('https://www.hunters.security/hubfs/May%202022/Fonts/Graphik-Bold/GraphikBoldWeb.svg') format('svg');
        font-weight: 700;
        font-style: normal;
       font-display: swap;
      }

    </style>
    <link rel="preload" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/113858768455/1730201284054/Hunters_Theme_May_2023/css/main.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://www.unpkg.com/aos@2.3.1/dist/aos.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://www.hunters.security/hubfs/Theme%20-%202022/Coded_file/slick-theme.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/114002466428/1688126129748/Hunters_Theme_May_2023/css/easy-responsive-tabs.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
   <link rel="stylesheet" type="text/css" media="screen" href="https://www.hunters.security/hubfs/hunters_theme_files/coded_files/prism.css"> 
<!--     <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism-okaidia.min.css" rel="stylesheet" /> -->
    <noscript>
      <link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/113858768455/1730201284054/Hunters_Theme_May_2023/css/main.min.css">
    </noscript>
    

    
    
    
    
 
    
    
    
    
    
    
    <link rel="stylesheet" href="https://www.hunters.security/hubfs/Theme%20-%202022/Coded_file/slick.css">
    <link rel="stylesheet" href="https://www.hunters.security/hubfs/Theme%20-%202022/Coded_file/slick-theme.css">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="/hs/hsstatic/jquery-libs/static-1.4/jquery/jquery-1.11.2.js"></script>
<script src="/hs/hsstatic/jquery-libs/static-1.4/jquery-migrate/jquery-migrate-1.2.1.js"></script>
<script>hsjQuery = window['jQuery'];</script>
    <meta property="og:description" content="Discover how the latest cybersecurity threat research on VEILDrive exposes attackers exploiting Microsoft services for C2, bypassing defenses, and leveraging SaaS infrastructure.">
    <meta property="og:title" content="Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2">
    <meta name="twitter:description" content="Discover how the latest cybersecurity threat research on VEILDrive exposes attackers exploiting Microsoft services for C2, bypassing defenses, and leveraging SaaS infrastructure.">
    <meta name="twitter:title" content="Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/133487975192/1725515743800/Hunters_Theme_May_2023/css/blog.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/130719549746/1693291612591/Hunters_Theme_May_2023/css/magnific-popup.min.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/114002466428/1693291614672/Hunters_Theme_May_2023/css/easy-responsive-tabs.min.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/127041525412/1728555178550/Hunters_Theme_May_2023/css/style.min.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/127040996237/1704720085106/Hunters_Theme_May_2023/css/additional_style.min.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/113858809947/1693977471236/Hunters_Theme_May_2023/css/theme-overrides.min.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/module_assets/177021600416/1725602140791/module_177021600416_Blog_Table_of_Content_Sidebar.min.css">
<link rel="stylesheet" href="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/module_assets/127063834721/1725535151579/module_127063834721_related-post-listing-blog.min.css">
<style>
</style>

    <script type="application/ld+json">
{
  "mainEntityOfPage" : {
    "@type" : "WebPage",
    "@id" : "https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2"
  },
  "author" : {
    "name" : "Team Axon",
    "url" : "https://www.hunters.security/en/blog/author/team-axon",
    "@type" : "Person"
  },
  "headline" : "Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2",
  "datePublished" : "2024-11-04T17:15:43.000Z",
  "dateModified" : "2024-11-06T15:36:38.749Z",
  "publisher" : {
    "name" : "Cyber Hunters Ltd.",
    "logo" : {
      "url" : "https://f.hubspotusercontent30.net/hubfs/5765386/Hunters%20H%20Logo%20Reverse%20on%20white%20(1)%20(1).png",
      "@type" : "ImageObject"
    },
    "@type" : "Organization"
  },
  "@context" : "https://schema.org",
  "@type" : "BlogPosting",
  "image" : [ "https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/2.05-1200x800-Hunters-JFM-263107%20%281%29.jpg" ]
}
</script>


    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WQ56X32');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<meta name="facebook-domain-verification" content="rdtccdmeswwqacf71dorkxz5w1w2ao">

<!-- Site Schema -->
<script type="application/ld+json">
 {
     "@context": "http://schema.org",
     "@type": "Organization",
     "mainEntityOfPage":{
          "@type":"WebPage",
          "@id":"https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2",
          "description": "Discover how the latest cybersecurity threat research on VEILDrive exposes attackers exploiting Microsoft services for C2, bypassing defenses, and leveraging SaaS infrastructure."
     },
     "url": "/",
     "logo": "https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/Full_Logo_White.png",
     "image": "https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/Full_Logo_White.png",
     "name": "Hunters",
     "description": "Hunters SOC Platform",
     "address": {
          "@type": "PostalAddress",
          "streetAddress": "275 Grove St. ",
          "addressLocality": "Newton",
          "addressRegion": "Massachusetts",
          "addressCountry": "United States",
          "postalCode": "02466"
     },
     "telephone": ""
}
</script>
<!-- End Schema -->

<!--  Added by GoogleTagManager integration -->
<!-- commented out on 9 Feb 2023  <script>
  var scrollPos = 100;
  var counter = 0;
  $(window).scroll(function(){
    var scrollPosCur = $(this).scrollTop();
    if (scrollPosCur > scrollPos && counter == 0) {

      var _hsp = window._hsp = window._hsp || [];

      var hsLoadGtm = function loadGtm() {
        if(window._hsGtmLoadOnce) {
          return;
        }

        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                                                      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
              'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                            })(window,document,'script','dataLayer','GTM-WQ56X32');

        window._hsGtmLoadOnce = true;
      };

      var useGoogleConsentMode = false;

      if (!useGoogleConsentMode){
        _hsp.push(['addPrivacyConsentListener', function(consent){
          if(consent.allowed || (consent.categories && consent.categories.analytics)){
            hsLoadGtm();
          }
        }]);
      } else{
        if(!window._hsGoogleConsentRunOnce){
          window._hsGoogleConsentRunOnce=true;

          window.dataLayer=window.dataLayer||[];
          function gtag(){dataLayer.push(arguments);}

          gtag('consent','default',{
            'ad_storage':'denied',
            'analytics_storage':'denied'
          });

          gtag('set','developer_id.dZTQ1Zm',true);

          _hsp.push(['addPrivacyConsentListener',function(consent){
            var hasAnalyticsConsent=consent&&(consent.allowed||(consent.categories&&consent.categories.analytics));
            var hasAdsConsent=consent&&(consent.allowed||(consent.categories&&consent.categories.advertisement));

            gtag('consent','update',{
              'ad_storage':hasAdsConsent?'granted':'denied',
              'analytics_storage':hasAnalyticsConsent?'granted':'denied'
            });
          }]);
        }

        hsLoadGtm();
      }
      console.log("GoogleTagManager integration code");
      counter++; 
    }
  });
</script> -->

<!-- /Added by GoogleTagManager integration -->

<script>


</script>

<link rel="amphtml" href="https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2?hs_amp=true">

<meta property="og:image" content="https://www.hunters.security/hubfs/2.05-1200x800-Hunters-JFM-263107%20%281%29.jpg">
<meta property="og:image:alt" content="VIELDrive microsoft command and control">
<meta name="twitter:image" content="https://www.hunters.security/hubfs/2.05-1200x800-Hunters-JFM-263107%20%281%29.jpg">
<meta name="twitter:image:alt" content="VIELDrive microsoft command and control">

<meta property="og:url" content="https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.hunters.security/en/blog/rss.xml">
<meta name="twitter:domain" content="www.hunters.security">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">






  <meta name="generator" content="HubSpot"></head>
  <body>
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WQ56X32" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

   
    
    <div class="body-wrapper   hs-content-id-182226747037 hs-blog-post hs-blog-id-24463927651">
      
      <div data-global-resource-path="Hunters_Theme_May_2023/templates/partials/header.html"><header class="header black-text-header header-new-v2">

  
  <div class="container-fluid header__dnd--top">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

</div><!--end widget-span -->
</div>
</div>
</div>
  

  <div class="header__container">

    
    <div class="header__logo">
      <div id="hs_cos_wrapper_module_16831154321363" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">

<a href="https://www.hunters.security">
  
  
  
  
  <img src="https://www.hunters.security/hubfs/Imported%20images/black-logo.svg" alt="Hunters" width="176" height="27">
  
</a></div>
    </div>
    

    
    <div class="header__menu">
      <div class="header__navigation custom-menu-primary-new navigation-primary">
        <div id="hs_cos_wrapper_module_16462022640471" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<span id="hs_cos_wrapper_module_16462022640471_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_module_16462022640471_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="default" data-menu-id="67518999559" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="##" aria-haspopup="true" aria-expanded="false" role="menuitem">Product</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/product" role="menuitem">SOC Platform </a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/product-tour" role="menuitem">Product Tour</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/integrations" role="menuitem">Integrations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/why-hunters" role="menuitem">Why Hunters</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/faqs" role="menuitem">FAQs</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="##" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/solution/siem-replacement" role="menuitem">SIEM Replacement</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/mssp" role="menuitem">MSSPs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/solution/hunters-for-snowflake-data-lake" role="menuitem">Hunters for Snowflake</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/solution/hunters-for-databricks" role="menuitem">Hunters for Databricks</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/solution/hunters-for-aws" role="menuitem">Hunters for AWS</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="##" aria-haspopup="true" aria-expanded="false" role="menuitem">Services</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/team-axon" role="menuitem">Team Axon</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/customers" role="menuitem">Customers</a></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.hunters.security/en/blog" aria-haspopup="true" aria-expanded="false" role="menuitem">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/en/blog" role="menuitem">Blog</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/events" role="menuitem">Events</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="##" aria-haspopup="true" aria-expanded="false" role="menuitem">Company</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/about-us" role="menuitem">About us</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/careers" role="menuitem">Careers</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/partners" role="menuitem">Partners</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.hunters.security/newsroom" role="menuitem">Newsroom</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/watch-a-demo-hunters-soc-platform" role="menuitem">Get a Demo</a></li>
 </ul>
</div></span></div>
      </div>
    </div>
    

    
    
    

  </div>

  
  <div class="container-fluid header__dnd--bottom">
<div class="row-fluid-wrapper">
<div class="row-fluid">
<div class="span12 widget-span widget-type-cell " style="" data-widget-type="cell" data-x="0" data-w="12">

</div><!--end widget-span -->
</div>
</div>
</div>
  

  

</header>

<script>
  $(function() {
    /**
     * Mobile Nav
     *
     * Hubspot Standard Toggle Menu
     */
    $('.custom-menu-primary-new').addClass('js-enabled');
    $('.custom-menu-primary-new .hs-menu-wrapper').before('<a class="mobile-trigger-new cta_border_button"><span></span><i></i></a>');
    $('.custom-menu-primary-new .flyouts .hs-item-has-children > a').after(' <a class="child-trigger-new"><img src="https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/March2022/right-arrow.svg"></a>');
    $('.mobile-trigger-new').click(function() {
      $(this).next('.custom-menu-primary-new .hs-menu-wrapper').slideToggle(250);
      $('body').toggleClass('mobile-open');
      $('.child-trigger-new').removeClass('child-open');
      $('.hs-menu-children-wrapper').slideUp(250);
      return false;
    });
    $('.child-trigger-new').click(function() {
      $(this).parent().siblings('.hs-item-has-children').find('.child-trigger-new').removeClass('child-open');
      $(this).parent().siblings('.hs-item-has-children').find('.hs-menu-children-wrapper').slideUp(250);
      $(this).next('.hs-menu-children-wrapper').slideToggle(250);
      $(this).next('.hs-menu-children-wrapper').children('.hs-item-has-children').find('.hs-menu-children-wrapper').slideUp(250);
      $(this).next('.hs-menu-children-wrapper').children('.hs-item-has-children').find('.child-trigger-new').removeClass('child-open');
      $(this).toggleClass('child-open');
      return false;
    });
  });

  $(window).scroll(function() {    
    var scroll = $(window).scrollTop();

    if (scroll >= 25) {
      $(".header").addClass("darkHeader");
    } else {
      $(".header").removeClass("darkHeader");
    }
  });
</script></div>
      

      
<main class="body-container-wrapper blog-page blog-page-2024">
  <div class="body-container body-container--blog-post">
    <div class="content-wrapper">

      
      <article class="blog-post">

        

        <div class="blog-post-header-top-section" id="banner-module">
          <div class="page-center-wrapp">
            <div class="blog-post-header-top-inner banner-section-inner">
              <div class="blog-post-header-top-content">
                <p class="small headline" style="color: #6C38FF;"><strong>
                  
                  <a class="post-tag" href="https://www.hunters.security/en/blog/tag/team-axon">Team Axon</a>
                  
                  </strong></p>
                <h1 class="h3"><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2</span></h1>
                
               

              </div>
               <div class="post-inner-details">
                  <ul class="post-flex share-block">
                    <li class="social-icons">
                      <ul class="share-icons post-flex">
                        <li class="share">
                          <a class="icon-twitter" href="https://twitter.com/share?url=https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2&amp;via=gotosage" target="_blank">
<!--                             <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path
                                    d="M22.287 11.2235C21.7859 11.4474 21.2474 11.5982 20.6822 11.6662C21.2593 11.3183 21.7025 10.767 21.9108 10.11C21.3711 10.4322 20.773 10.6664 20.1363 10.7927C19.6273 10.2459 18.9004 9.9043 18.0969 9.9043C16.2929 9.9043 14.9673 11.5988 15.3748 13.3579C13.0533 13.2408 10.9946 12.121 9.61619 10.419C8.88417 11.6834 9.23656 13.3373 10.4804 14.1748C10.0231 14.16 9.59179 14.0337 9.21557 13.8229C9.18493 15.1261 10.1127 16.3453 11.4565 16.6166C11.0632 16.724 10.6325 16.7492 10.1944 16.6646C10.5497 17.7821 11.5813 18.5951 12.8048 18.6179C11.6301 19.5452 10.1502 19.9594 8.66797 19.7834C9.90446 20.5815 11.3736 21.0472 12.9512 21.0472C18.1389 21.0472 21.0698 16.6361 20.8928 12.6797C21.4387 12.2827 21.9125 11.7873 22.287 11.2235Z"
                                    fill="black" />
                              <circle cx="14.8571" cy="14.8571" r="14.5476" stroke="black" stroke-width="0.619048" />
                            </svg> -->
                            <svg xmlns="http://www.w3.org/2000/svg" height="30" width="30" viewbox="0 0 512 512" style="
                                                                                                                        border: 0.5px solid black;
                                                                                                                        border-radius: 50%;
                                                                                                                        padding: 5px;
                                                                                                                        "><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"></path></svg>
                          </a>
                        </li>
<!--                         <li class="share">
                          <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2&title=Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2&picture=https://5765386.fs1.hubspotusercontent-na1.net/hubfs/5765386/2.05-1200x800-Hunters-JFM-263107%20%281%29.jpg&description=Discover how the latest cybersecurity threat research on VEILDrive exposes attackers exploiting Microsoft services for C2, bypassing defenses, and leveraging SaaS infrastructure."
                             title="Share on Facebook" target="_blank" class="facebook">
                            <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path
                                    d="M13.0017 12.5239H11.1445V15.0001H13.0017V22.4287H16.0969V15.0001H18.3515L18.5731 12.5239H16.0969V11.492C16.0969 10.9008 16.2158 10.6668 16.7871 10.6668H18.5731V7.57153H16.2158C13.9897 7.57153 13.0017 8.55149 13.0017 10.4284V12.5239Z"
                                    fill="black" />
                              <circle cx="14.8571" cy="15" r="14.5476" stroke="black" stroke-width="0.619048" />
                            </svg>

                          </a>
                        </li> -->
                        <li class="share">
                          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2&amp;title=Unmasking%20VEILDrive:%20Threat%20Actors%20Exploit%20Microsoft%20Services%20for%20C2&amp;summary=Discover%20how%20the%20latest%20cybersecurity%20threat%20research%20on%20VEILDrive%20exposes%20attackers%20exploiting%20Microsoft%20services%20for%20C2,%20bypassing%20defenses,%20and%20leveraging%20SaaS%20infrastructure." target="_blank" title="Share on LinkedIn" class="linkedin">
                            <svg width="30" height="30" viewbox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path d="M11.8542 10.2311C11.8542 10.9373 11.2816 11.5096 10.5748 11.5096C9.86809 11.5096 9.29547 10.9373 9.29547 10.2311C9.29547 9.52539 9.86809 8.95264 10.5748 8.95264C11.2816 8.95264 11.8542 9.52539 11.8542 10.2311ZM11.8645 12.5323H9.28516V20.7145H11.8645V12.5323ZM15.9822 12.5323H13.4194V20.7145H15.9827V16.4194C15.9827 14.0312 19.0929 13.8359 19.0929 16.4194V20.7145H21.6661V15.5337C21.6661 11.5039 17.0635 11.6507 15.9822 13.6344V12.5323Z" fill="black" />
                              <circle cx="14.8571" cy="15.1428" r="14.5476" stroke="black" stroke-width="0.619048" />
                            </svg>

                          </a>
                        </li>
                        <li class="share">
                          <a href="mailto:?subject=Unmasking%20VEILDrive:%20Threat%20Actors%20Exploit%20Microsoft%20Services%20for%20C2&amp;body=Unmasking%20VEILDrive:%20Threat%20Actors%20Exploit%20Microsoft%20Services%20for%20C2%20https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2" title="Email">
                            <svg width="30" height="31" viewbox="0 0 30 31" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <circle cx="14.8571" cy="15.2856" r="14.5476" stroke="black" stroke-width="0.619048" />
                              <g clip-path="url(#clip0_1182_3760)">
                                <path d="M11.6092 13.6568C11.8653 13.4008 12.1494 13.1896 12.4516 13.0228C14.1356 12.0947 16.2951 12.5882 17.3778 14.2297L16.0676 15.5393C15.692 14.6823 14.7592 14.1947 13.8311 14.4023C13.4817 14.4805 13.1498 14.6549 12.8786 14.9262L10.3679 17.438C9.60548 18.2004 9.60548 19.4406 10.3679 20.203C11.1303 20.9654 12.3705 20.9654 13.1329 20.203L13.907 19.4289C14.6111 19.7083 15.3659 19.8198 16.1114 19.7643L14.4028 21.4729C12.9381 22.9377 10.5633 22.9377 9.09856 21.4729C7.63381 20.0082 7.63381 17.6334 9.09856 16.1687L11.6092 13.6568ZM15.5969 9.66917L13.8883 11.3778C14.6332 11.3218 15.3886 11.4338 16.0927 11.7126L16.8662 10.9391C17.6286 10.1767 18.8688 10.1767 19.6312 10.9391C20.3936 11.7015 20.3936 12.9417 19.6312 13.7041L17.12 16.2153C16.3552 16.9801 15.1133 16.9737 14.355 16.2153C14.1782 16.0386 14.026 15.8187 13.9309 15.6023L12.6207 16.9118C12.7584 17.1207 12.9013 17.3009 13.0851 17.4847C13.5587 17.9583 14.1619 18.3113 14.8561 18.4787C15.7556 18.6951 16.7192 18.5755 17.547 18.1188C17.8491 17.9519 18.1332 17.7408 18.3893 17.4847L20.9 14.9734C22.3653 13.5087 22.3653 11.1339 20.9006 9.66917C19.4358 8.205 17.0616 8.205 15.5969 9.66917Z" fill="black" />
                              </g>
                              <defs>
                                <clippath id="clip0_1182_3760">
                                  <rect width="14" height="14" fill="white" transform="translate(8 8.57104)" />
                                </clippath>
                              </defs>
                            </svg>

                          </a>
                        </li>
                      </ul>
                    </li>
                  </ul>
                  <span class="divider"></span>
                  <ul class="author-details">
                    <li>
                      <span class="blog_post_date">Nov 4, 2024 </span>
                    </li>

                    <li>
                     By <a class="blog-post__author-name" href="https://www.hunters.security/en/blog/author/team-axon">Team Axon</a>
                    </li>

                    <li class="read-time">
          
          
          
          
          35 minutes to read
          </li>
                  </ul>
                </div>
              <div class="bottom-arrow">
                <a href="#banner-module">
                  <svg width="19" height="38" viewbox="0 0 19 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.5 38L9.5 2M9.5 2L18 10.6582M9.5 2L1 10.6582" stroke="black" stroke-width="2"></path>
                  </svg>
                </a>
              </div>
            </div>
          </div>
        </div>



        

        <div class="blog-post__body_wrapp">
          <div class="blog-post-left-social-block"> 
            <div id="hs_cos_wrapper_module_17249147489002" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<div class="sidebar-sticky-nav-section module_17249147489002">
  <div class="sidebar-sticky-nav-wrapper">
    <div class="sidebar-sticky-nav-item">
      <ul>
        <li class="mobile-dropdown">
          <span class="menu-label active">Table of Contents <span class="arrow"></span></span>
          <ul class="dropdown-menu">

            <!-- Add more menu items as needed -->
          </ul>
        </li>
        <!-- For desktop regular menu -->

      </ul>
    </div>
  </div>
</div>



<style>
  .sidebar-sticky-nav-item .dropdown-menu li a{
    color: rgba(0, 0, 0,0.6) !important;
  }
  .sidebar-sticky-nav-item .dropdown-menu li a.active{
    color: rgba(0, 0, 0,1.0) !important;
  }
  .sidebar-sticky-nav-item .menu-label{
    color: #6c38ff;
  }
</style></div>
          </div>
          <div class="blog-post-right-body-content-block">
            <section class="blog-post__body">
              <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><h2 style="font-size: 48px;">TL;DR</h2>
<ul>
<li aria-level="1"><span style="color: #000000;">Hunters’ Team AXON has identified and is currently monitoring an ongoing threat campaign, dubbed “</span><strong><span style="color: #000000;">VEILDrive</span></strong><span style="color: #000000;">”</span></li>
<li aria-level="1"><span style="color: #000000;">The campaign was originally identified as part of an <a href="/team-axon" rel="noopener">AXON</a> engagement to address a malicious activity identified in one of our customers' infrastructure</span></li>
<li aria-level="1"><span style="color: #000000;">As part of the investigation, we identified different Microsoft infrastructure components of additional victim organizations that were compromised and used by the attacker</span></li>
<li aria-level="1"><span style="color: #000000;">The attacker leveraged different Microsoft SaaS services and applications as part of the campaign, including Microsoft Teams, SharePoint, Quick Assist, and OneDrive</span></li>
<li aria-level="1"><span style="color: #000000;">The attacker used a unique OneDrive-based Command &amp; Control (C&amp;C) method as part of the malware found in the victim’s infrastructure</span></li>
<li aria-level="1"><span style="color: #000000;">Based on the conclusions from our investigation, there is a significant probability that this campaign originates from Russia</span></li>
<li aria-level="1"><span style="color: #000000;">Team AXON reported its findings to Microsoft to assist in shutting down the actor’s infrastructure</span></li>
<li aria-level="1"><span style="color: #000000;">The team also reached out to multiple affected victims identified during our research<br><br></span></li>
</ul>
<h2 style="font-size: 48px;"><span style="color: #000000;">Executive Summary</span></h2>
<!--more-->
<p>Hunters’ Team AXON has uncovered and is actively monitoring an ongoing threat campaign dubbed "VEILDrive”. Initially discovered during an investigation of malicious activity in a customer's infrastructure, VEILDrive leverages Microsoft’s SaaS suite—particularly Teams, SharePoint, Quick Assist, and OneDrive—to execute its tactics. Uniquely, the threat actor utilizes a OneDrive-based Command &amp; Control (C&amp;C) method embedded within custom malware that is deployed on compromised environments. Our analysis indicates a probable Russian origin for this campaign, and Team AXON has since alerted both Microsoft and impacted organizations to mitigate further exploitation.</p>
<p>Our research began in September 2024 following a response to an attack on a critical infrastructure entity in the United States. VEILDrive’s attack techniques diverge distinctly from typical threat behavior. They heavily rely on Microsoft’s SaaS infrastructure to distribute spear-phishing campaigns and store malicious software. This SaaS-dependent strategy complicates real-time detection and bypasses conventional defenses.</p>
<p>The malware associated with VEILDrive is a Java-based .jar file that notably lacks obfuscation, making it unusually readable and well-structured. Despite its simplicity, the malware evaded detection by a top-tier Endpoint Detection and Response (EDR) tool and all security engines in VirusTotal. This highlights a critical risk: even non-obfuscated, straightforward code can evade modern detection mechanisms, suggesting a broader need to revisit detection strategies in high-risk environments.<br><br>This report provides insights into VEILDrive's methodologies and the limitations of current detection approaches to better equip the cybersecurity community against evolving threats.<br><br></p>
<h2 style="font-size: 48px;">Background</h2>
<p>In September 2024, Team AXON responded to an incident targeting a critical infrastructure company in the United States. This investigation revealed a unique threat campaign, "VEILDrive”, which displayed unusual tactics, techniques, and procedures (TTPs) that deviated significantly from those typically seen in similar incidents.</p>
<p>Based on our findings, we estimate that the VEILDrive campaign began in early August 2024 and remains active as of this report. Leveraging Microsoft SaaS services—including Teams, SharePoint, Quick Assist, and OneDrive—the attacker exploited the trusted infrastructures of previously compromised organizations to distribute spear-phishing attacks and store malware. This cloud-centric strategy allowed the threat actor to avoid detection by conventional monitoring systems.</p>
<p>Notably, VEILDrive introduced a novel OneDrive-based Command &amp; Control (C&amp;C) method embedded in Java-based malware deployed on compromised devices. The malware itself, a .jar file, exhibits two striking features:</p>
<ul>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Code Transparency:</span></strong><span style="color: #000000;"> With zero obfuscation and well-structured code, this malware defies the typical trend of evasion-focused design, making it unusually readable and straightforward.</span></li>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;"><strong>Stealth Effectiveness:</strong> Despite its simplicity, this malware remained undetected by both the top-tier Endpoint Detection and Response (EDR) solution deployed in the victim environment and all security engines in VirusTotal (see Figure 1 below):</span></li>
</ul>
<p><img src="https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=1305&amp;height=662&amp;name=VirusTotal%20Screenshot.png" width="1305" height="662" loading="lazy" alt="VirusTotal screenshot displaying Java malware with zero detections; undetected by all VirusTotal engines, highlighting evasion capabilities." style="height: auto; max-width: 100%; width: 1305px;" srcset="https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=653&amp;height=331&amp;name=VirusTotal%20Screenshot.png 653w, https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=1305&amp;height=662&amp;name=VirusTotal%20Screenshot.png 1305w, https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=1958&amp;height=993&amp;name=VirusTotal%20Screenshot.png 1958w, https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=2610&amp;height=1324&amp;name=VirusTotal%20Screenshot.png 2610w, https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=3263&amp;height=1655&amp;name=VirusTotal%20Screenshot.png 3263w, https://www.hunters.security/hs-fs/hubfs/VirusTotal%20Screenshot.png?width=3915&amp;height=1986&amp;name=VirusTotal%20Screenshot.png 3915w" sizes="(max-width: 1305px) 100vw, 1305px"><span style="font-size: 12px;"><em>Figure 1: VirusTotal screenshot showing undetected Java malware; no detections from any VirusTotal engines.</em></span></p>
<p>These characteristics highlight that even without sophisticated evasion techniques, carefully crafted, non-obfuscated malware can evade modern defenses. This investigation underscores a gap in current detection strategies and emphasizes the need for vigilance against less conventional attack approaches.</p>
<p>Team AXON has shared its findings with Microsoft and impacted organizations, offering actionable intelligence to mitigate this ongoing threat.<br><br></p>
<h2 style="font-size: 48px;">The VEILDrive Attack Path&nbsp;</h2>
<p>In early September 2024, one of Hunters' customers, referred to below as "Org C”, engaged Team AXON for support in handling an active incident. The case centered on a specific device within Org C that had been compromised via social engineering.<br><br>A suspiciously created scheduled task on an Org C employee’s device triggered an alert, prompting further investigation. By correlating logs and communicating with the affected user, the team clarified the method of initial access.</p>
<p>Below is an Attack Diagram that provides a high-level overview of the attack flow:&nbsp;</p>
<p><img src="https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=1094&amp;height=788&amp;name=VIELdrive%20attack%20diagram%20(13).png" width="1094" height="788" loading="lazy" alt="VIELdrive attack diagram" style="height: auto; max-width: 100%; width: 1094px;" srcset="https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=547&amp;height=394&amp;name=VIELdrive%20attack%20diagram%20(13).png 547w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=1094&amp;height=788&amp;name=VIELdrive%20attack%20diagram%20(13).png 1094w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=1641&amp;height=1182&amp;name=VIELdrive%20attack%20diagram%20(13).png 1641w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=2188&amp;height=1576&amp;name=VIELdrive%20attack%20diagram%20(13).png 2188w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=2735&amp;height=1970&amp;name=VIELdrive%20attack%20diagram%20(13).png 2735w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(13).png?width=3282&amp;height=2364&amp;name=VIELdrive%20attack%20diagram%20(13).png 3282w" sizes="(max-width: 1094px) 100vw, 1094px"></p>
<p>The sequence of events unfolded as follows:</p>
<p style="font-size: 20px;"><span style="color: #6c38ff;"><strong>Step 1</strong></span></p>
<ul>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">The malicious actor leveraged Microsoft Teams to message four selected employees at Org C, who, aside from being non-technical based on their roles, had no other apparent connection. The attacker impersonated an IT team member and requested access to each employee’s device via the </span><a href="https://support.microsoft.com/en-gb/windows/solve-pc-problems-remotely-using-quick-assist-b077e31a-16f4-2529-1a47-21f6a9040bf3"><span>Quick Assist</span></a><span style="color: #000000;"> remote utility tool.<br><br>Rather than using a newly created account for impersonation, the attacker utilized a compromised user account from a potential previous victim, referred to here as "Org A.”</span><br><br><strong style="color: #000000;">M365 Audit Logs</strong><span style="color: #000000;"> were used to identify the Microsoft Teams spear-phishing.&nbsp;</span></li>
</ul>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1">Multiple “<strong>MessageSent</strong>” and “<strong>ChatCreated</strong>” events were identified, all originating from the previously compromised user of <strong>Org</strong> <strong>A</strong>, owned by the threat actor.</li>
<li aria-level="1">While 4 employees were targeted, only one “<strong>MemberAdded</strong>” event was identified targeting the compromised user of <strong>Org</strong> <strong>A</strong>.</li>
</ul>
</li>
</ul>
<p style="line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=642&amp;height=748&amp;name=Figure%202.png" width="642" height="748" loading="lazy" alt=" Microsoft 365 audit logs entry from Org C - showing the &quot;MemberAdded&quot; event in which Org A's previously compromised user account was added to a One-On-One chat with the victim of Org C." style="height: auto; max-width: 100%; width: 642px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=321&amp;height=374&amp;name=Figure%202.png 321w, https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=642&amp;height=748&amp;name=Figure%202.png 642w, https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=963&amp;height=1122&amp;name=Figure%202.png 963w, https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=1284&amp;height=1496&amp;name=Figure%202.png 1284w, https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=1605&amp;height=1870&amp;name=Figure%202.png 1605w, https://www.hunters.security/hs-fs/hubfs/Figure%202.png?width=1926&amp;height=2244&amp;name=Figure%202.png 1926w" sizes="(max-width: 642px) 100vw, 642px"><em><span style="font-size: 12px;">Figure 2: Microsoft 365 audit logs entry from Org C - showing the "MemberAdded" event in which Org A's previously compromised user account was added to a One-On-One chat with the victim of Org C.</span></em></p>
<ul>
<li style="list-style-type: none;">
<ul>
<li aria-level="1">This “<strong>MemberAdded</strong>” event was conducted by the only user account of the 4 targeted users that accepted the threat actor access request, creating a one-on-one chat. This means this user was the only one who actively interacted with the incoming message.</li>
<li aria-level="1">This information aligned with data from the organization's EDR telemetry, confirming that the user not only accepted the request and received the message but also enabled the attacker to gain initial access due to successful social engineering.</li>
</ul>
</li>
</ul>
<p>The above insight was both intriguing and valuable, highlighting the increasing prevalence of phishing through Microsoft Teams and similar communication tools. Distinguishing between successful and failed phishing attempts using M365 audit logs, alongside correlation with EDR logs, can be highly significant for investigations.<br><br>The Microsoft Teams messages received by the targeted users of Org C were made possible by Microsoft Teams’ “<a href="https://learn.microsoft.com/en-us/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings" rel="noopener">External Access</a>” functionality, which allows One-on-One communication with any external organization by default.</p>
<p><span style="color: #6c38ff;"><strong>Step 2</strong></span></p>
<p>The attacker successfully lured the victim of Org C to execute Microsoft's Quick Assist tool and provided them with the access code via Microsoft Teams. This led to the threat actor's interactive access to the victim’s computer.</p>
<p><span style="color: #6c38ff;"><strong>Step 3</strong></span></p>
<p>The threat actor then shared a download link to the SharePoint of a separate organization (the victim belonged to a different tenant than the one used for phishing through Microsoft Teams chat, which we'll refer to as 'Org B'). This link contained a password-protected .zip file named Client_v8.16L.zip, which included various files, among them an additional RMM tool.<br><br>The file was downloaded, likely through interactive means, by the attacker—already equipped with remote access—operating under the context of explorer.exe, enabling them to click the link and download tools as needed.<br><br>It’s worth mentioning that during the investigation, we correlated M365 audit logs, which provided precise information about the incoming URLs in Microsoft Teams messages, with the EDR telemetry of the victim’s host to fully understand the attacker's TTPs.</p>
<p style="line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=1307&amp;height=732&amp;name=Figure%203.png" width="1307" height="732" loading="lazy" alt="Microsoft 365 audit logs from Org C showing a 'MessageSent' entry with a malicious URL sent by the attacker via an Org C user account. The URL directs to Org B's SharePoint, where malware files were hosted for download." style="height: auto; max-width: 100%; width: 1307px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=654&amp;height=366&amp;name=Figure%203.png 654w, https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=1307&amp;height=732&amp;name=Figure%203.png 1307w, https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=1961&amp;height=1098&amp;name=Figure%203.png 1961w, https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=2614&amp;height=1464&amp;name=Figure%203.png 2614w, https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=3268&amp;height=1830&amp;name=Figure%203.png 3268w, https://www.hunters.security/hs-fs/hubfs/Figure%203.png?width=3921&amp;height=2196&amp;name=Figure%203.png 3921w" sizes="(max-width: 1307px) 100vw, 1307px"><em><span style="font-size: 12px;">Figure 3: Microsoft 365 audit logs from Org C showing a 'MessageSent' entry with a malicious URL sent by the attacker via an Org C user account. The URL directs to Org B's SharePoint, where malware files were hosted for download.</span></em></p>
<p style="line-height: 1;"><span style="color: #6c38ff;"><strong>Step 4</strong></span></p>
<p style="line-height: 1.75;">Multiple attempts were made to carry out manual malicious operations via remote access. These activities primarily involved persistence efforts, such as creating scheduled tasks to repeatedly execute one of the attacker-downloaded files—an RMM tool called LiteManager ("ROMServer.exe").</p>
<p style="line-height: 1.75; font-size: 16px;"><code><span style="color: #0f173d;">schtasks /Create /TN "Perfomance monitoring" /SC MINUTE /TR C:\ProgramData\500000003\ROMServer.exe</span></code></p>
<p style="line-height: 1.75;"><span style="color: #6c38ff;"><strong>Step 5</strong></span></p>
<p style="line-height: 1.75;">Following the activities above, the actor manually downloads another .zip file named <code><span style="font-size: 16px;">Cliento.zip.</span><br></code><br>As before, the link was shared in the chat between the victim user and the threat actor. This .zip file included the main .JAR malware as well as the entire Java Development Kit to execute the .JAR malware.</p>
<p style="line-height: 1.75;"><span style="color: #6c38ff;"><strong>Step 6</strong></span></p>
<p style="line-height: 1.75;">The threat actor executed the .JAR malware using the following: <span style="font-size: 16px;"><code>C:\\ProgramData\\Cliento\\jdk-22_windows-x64_bin\\jdk-22.0.2\\bin\\javaw.exe -jar C:\\ProgramData\\Cliento\\Cliento.jar</code></span></p>
<p style="line-height: 1.75;"><span style="color: #6c38ff;"><strong>Step 7</strong></span></p>
<p style="line-height: 1.75; font-size: 18px;">Multiple network activities and command executions were identified under the context of the malicious .JAR file, including:</p>
<ul style="font-size: 18px;">
<li style="line-height: 1.75;">Several outgoing DNS Request/Network Activity to → safeshift390-my.sharepoint.com</li>
<li style="line-height: 1.75;">Several outgoing DNS Request/Network Activity to → graph.microsoft.com</li>
<li style="line-height: 1.75;">Several outgoing DNS Request/Network Activity to → login.microsoftonline.com</li>
<li style="line-height: 1.75;">Execution of local enumeration commands:
<ul style="font-size: 16px;">
<li style="line-height: 1.75;">Get system specs -<span style="font-size: 16px;"> <code>Systeminfo</code></span></li>
<li style="line-height: 1.75;">Get machine time information -<span style="font-size: 16px;"> <code>net time</code></span></li>
<li style="line-height: 1.75;">Get the UUID of the machine (<em>remember this one; we’ll discuss it later</em>) <span style="font-size: 16px;">- <code>Get-WmiObject -Class</code> <code>Win32_ComputerSystemProduct | Select-Object -ExpandProperty UUID</code></span></li>
<li style="line-height: 1.75;">Enumeration of USB devices -<span style="font-size: 16px;"> <code>{$_.interfacetype -eq \"USB\"}"</code></span><br><span style="font-size: 16px;"></span></li>
</ul>
</li>
</ul>
<p><span style="font-size: 16px;"><span style="font-size: 18px;">The following screenshot shows the main parts of the process tree related to malicious activities:</span><br></span></p>
<p style="font-size: 12px;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=1600&amp;height=749&amp;name=Figure%204.png" width="1600" height="749" loading="lazy" alt="Summarized process tree from Hunters' Next-Gen SIEM" style="height: auto; max-width: 100%; width: 1600px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=800&amp;height=375&amp;name=Figure%204.png 800w, https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=1600&amp;height=749&amp;name=Figure%204.png 1600w, https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=2400&amp;height=1124&amp;name=Figure%204.png 2400w, https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=3200&amp;height=1498&amp;name=Figure%204.png 3200w, https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=4000&amp;height=1873&amp;name=Figure%204.png 4000w, https://www.hunters.security/hs-fs/hubfs/Figure%204.png?width=4800&amp;height=2247&amp;name=Figure%204.png 4800w" sizes="(max-width: 1600px) 100vw, 1600px"><em>Figure 4: Summarized process tree from Hunters' Next-Gen SIEM</em></p>
<p style="font-size: 18px;"><span style="color: #6c38ff;"><strong>Step 8</strong></span></p>
<p style="font-size: 18px;"><span style="color: #6c38ff;"><span style="font-weight: normal; color: #000000;">The attacker also added a malicious JAR binary as a runkey in the registry for persistent execution of the Java malware.<br><br><span style="color: #6c38ff;"><span style="font-weight: normal; color: #000000;">Command line:</span></span></span><strong><br></strong></span></p>
<p style="font-size: 18px;"><span style="color: #6c38ff;"><span style="font-weight: normal; color: #000000;"><code><span style="font-size: 16px;">Set-ItemProperty -Path \"HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\" -Name \"current\" -Value \"C:\\ProgramData\\Cliento\\jdk-22_windows-x64_bin\\jdk-22.0.2\\bin\\javaw.exe -jar C:\\ProgramData\\Cliento\\Cliento.jar\" -ErrorAction Stop"</span></code><br></span></span></p>
<p style="font-size: 18px;"><span style="color: #6c38ff;"><span style="font-weight: normal; color: #000000;">The containment and eradication of this incident was very rapid and effective, and according to the forensics evidence we had, there was no indication that the attacker managed to cause any significant damage to the victim host and organization.<br><br>One key insight from the attack flow detailed above is that the attacker used different well-known and commonly used Microsoft services as part of his attack, both for hiding in plain sight and potentially also for their convenience.<br><br>Let’s quickly summarize the Microsoft services used by the threat actor by now using the following table:</span></span></p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 97.6434%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="width: 33.3285%; padding: 4px;"><strong>Service</strong></td>
<td style="width: 33.3285%; padding: 4px;"><strong>Tenant</strong></td>
<td style="width: 33.3308%; padding: 4px;"><strong>Purpose</strong></td>
</tr>
<tr>
<td style="width: 33.3285%; padding: 4px;">Microsoft Teams</td>
<td style="width: 33.3285%; padding: 4px;">From Org A to Org C</td>
<td style="width: 33.3308%; padding: 4px;">Spear Phishing Messages to lure the victim to download and execute the remote management tool&nbsp;</td>
</tr>
<tr>
<td style="width: 33.3285%; padding: 4px;">Quick Assist</td>
<td style="width: 33.3285%; padding: 4px;">Org C</td>
<td style="width: 33.3308%; padding: 4px;">The threat actor sends a Quick Assist code using a Microsoft Teams message to gain the initial remote control</td>
</tr>
<tr>
<td style="width: 33.3285%; padding: 4px;">SharePoint</td>
<td style="width: 33.3285%; padding: 4px;">From Org B to Org C</td>
<td style="width: 33.3308%; padding: 4px;">Malicious files are “hosted” in Org B's SharePoint tenant. Download links are shared with Org C via SharePoint messages and opened by the attacker using Quick Assist</td>
</tr>
<tr>
<td style="width: 33.3285%; padding: 4px;">Graph API</td>
<td style="width: 33.3285%; padding: 4px;">From Org C to N/A</td>
<td style="width: 33.3308%; padding: 4px;">We had indications of malicious access to Microsoft Graph (graph[.]microsoft[.]com) initiated by the malicious cliento.jar.</td>
</tr>
</tbody>
</table>
<p>At this stage, we had identified the four Microsoft services/apps mentioned above. While we understood the purpose of the first three, the activity directed toward the Graph API remained unclear. We had several assumptions about its potential purpose, but in incident response, assumptions alone are not sufficient, are they?<br><br>To gather more information and better understand the .JAR malware 'Cliento.jar' in OneDrive/SharePoint - both to assess potential actions taken by the attacker and to gain insight into their intentions - we proceeded with a detailed analysis of the malware.<br><br></p>
</div>
<h3 style="font-size: 24px;"><span style="font-family: Impact, Chicago, 'Arial Black', Arial, 'sans serif';">“ODC2” Java Malware - OneDrive as Command &amp; Control</span></h3>
<p style="font-size: 18px;">We used a Java Decompiler named “JDGUI” to decompile the Client.jar malware (we named “ODC2”).<br><br>Just from the initial high-level look at the malware, we could immediately correlate it with the PowerShell execution we saw in the incident investigation. This is due to the inclusion of the “<a href="https://github.com/profesorfalken/jPowerShell" rel="noopener">jPowerShell</a>” Java package - a PowerShell wrapper for Java.<br><br>In addition, we could see additional packages like “commands,” “connection,” “launcher,” “or connect,” etc. This provided us with a high-level understanding of the malware structure.</p>
<p style="font-size: 18px;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=586&amp;height=288&amp;name=Figure%205.png" width="586" height="288" loading="lazy" alt="Java decompiler screenshot" style="height: auto; max-width: 100%; width: 586px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=293&amp;height=144&amp;name=Figure%205.png 293w, https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=586&amp;height=288&amp;name=Figure%205.png 586w, https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=879&amp;height=432&amp;name=Figure%205.png 879w, https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=1172&amp;height=576&amp;name=Figure%205.png 1172w, https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=1465&amp;height=720&amp;name=Figure%205.png 1465w, https://www.hunters.security/hs-fs/hubfs/Figure%205.png?width=1758&amp;height=864&amp;name=Figure%205.png 1758w" sizes="(max-width: 586px) 100vw, 586px"><em><span style="font-size: 12px;">Figure 5: Screenshot of Java Decompiler showing the contents of Cliento.jar file</span></em></p>
<p style="font-size: 18px;"><span style="font-weight: bold;">1.</span> We started with the Main.class under the “launcher“ package and found a set of hard-coded credentials used by the malware. This was a bit surprising for us, but very interesting.</p>
<br>
<p style="font-size: 18px;"><img src="https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=800&amp;height=347&amp;name=VIELdrive%20attack%20diagram%20(14).png" width="800" height="347" loading="lazy" alt="Screenshot of Java Decompiler showing the contents of the Cliente.jar file with a focus on the 'Main.class' file" style="height: auto; max-width: 100%; width: 800px;" srcset="https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=400&amp;height=174&amp;name=VIELdrive%20attack%20diagram%20(14).png 400w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=800&amp;height=347&amp;name=VIELdrive%20attack%20diagram%20(14).png 800w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=1200&amp;height=521&amp;name=VIELdrive%20attack%20diagram%20(14).png 1200w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=1600&amp;height=694&amp;name=VIELdrive%20attack%20diagram%20(14).png 1600w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=2000&amp;height=868&amp;name=VIELdrive%20attack%20diagram%20(14).png 2000w, https://www.hunters.security/hs-fs/hubfs/VIELdrive%20attack%20diagram%20(14).png?width=2400&amp;height=1041&amp;name=VIELdrive%20attack%20diagram%20(14).png 2400w" sizes="(max-width: 800px) 100vw, 800px"><em><span style="font-size: 12px;">Figure 6: Screenshot of Java Decompiler showing the contents of the Cliente.jar file with a focus on the 'Main.class' file</span></em></p>
<p style="font-size: 18px;">By further analyzing the malware (as described in the detailed analysis below), we found that the malware used these credentials to conduct “on-behalf” authentication to Entra ID. To conduct this authentication, the hard-coded refresh token was used with the client ID and client Secret to request an access token.<br><br>The authentication allowed the malware to access the OneDrive of specific Entra ID users, in tenants supposedly owned by the actor, abusing this access for C2 purposes.</p>
<p style="font-size: 18px;"><span style="font-weight: bold;">2.</span> In the main function of Main.class we can see the entry point itself, which includes multiple threads. It includes the execution of functions “odThread1” and “mainThread1“.</p>
<p style="font-size: 18px; line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=929&amp;height=540&amp;name=Figure%207.png" width="929" height="540" loading="lazy" alt="Java code snippet showing the main method in a decompiled Java class, with multiple threads (odThread1, odThread2, mainThread1, mainThread2) initializing Controller objects" style="height: auto; max-width: 100%; width: 929px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=465&amp;height=270&amp;name=Figure%207.png 465w, https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=929&amp;height=540&amp;name=Figure%207.png 929w, https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=1394&amp;height=810&amp;name=Figure%207.png 1394w, https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=1858&amp;height=1080&amp;name=Figure%207.png 1858w, https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=2323&amp;height=1350&amp;name=Figure%207.png 2323w, https://www.hunters.security/hs-fs/hubfs/Figure%207.png?width=2787&amp;height=1620&amp;name=Figure%207.png 2787w" sizes="(max-width: 929px) 100vw, 929px"><em><span style="font-size: 12px;">Figure 7: Java code snippet showing the main method in a decompiled Java class, with multiple threads (odThread1, odThread2, mainThread1, mainThread2) initializing Controller objects</span></em></p>
<p><strong><span style="color: #000000;">“odThread1”</span></strong><span style="color: #000000;"> includes the execution of the </span><strong><span style="color: #000000;">Controller “odRun”</span></strong><span style="color: #000000;"> function that gets the first set of hardcoded credentials (Refresh Token, etc.) for authentication.</span></p>
<ul>
<li>It uses the <strong>“40.90.196.221“</strong> IP address for <strong>“odRun”</strong> connection setup</li>
<li>The “40.90.196.228” IP address for “Run” initializes the HTTPS socket to the attacker’s C2. This IP is Azure’s IP as well, and it is very likely to be a virtual machine. This C2 channel, as detailed below, is more “classic” and leads to the execution of PowerShell commands</li>
<li>To obtain more information about these IP addresses, we checked known resources like ipinfo.io and the Service Tags of Azure IP addresses published by Microsoft, as shown in the screenshot below</li>
</ul>
<p style="font-size: 18px; line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=795&amp;height=269&amp;name=Figure%208.png" width="795" height="269" loading="lazy" alt="The IP lookup on the right provides details for IP '40.90.196.228', associated with 'microsoft.com' under 'hosting' type, with no VPN, proxy, tor, or relay flags enabled" style="height: auto; max-width: 100%; width: 795px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=398&amp;height=135&amp;name=Figure%208.png 398w, https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=795&amp;height=269&amp;name=Figure%208.png 795w, https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=1193&amp;height=404&amp;name=Figure%208.png 1193w, https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=1590&amp;height=538&amp;name=Figure%208.png 1590w, https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=1988&amp;height=673&amp;name=Figure%208.png 1988w, https://www.hunters.security/hs-fs/hubfs/Figure%208.png?width=2385&amp;height=807&amp;name=Figure%208.png 2385w" sizes="(max-width: 795px) 100vw, 795px"><span style="font-size: 12px;"><em>Figure 8: The IP lookup on the right provides details for IP '40.90.196.228', associated with 'microsoft.com' under 'hosting' type, with no VPN, proxy, tor, or relay flags enabled</em></span></p>
<ul>
<li style="font-size: 18px; line-height: 1.75;">It is also worth mentioning that the additional hard-coded IP address found in this malware (38.180.136.85) seems to be owned by another service provider and is associated with hosting services. Based on our insights, this IP address was not actively used by the malware. We assume it was there for legacy reasons (previous C2 infrastructure).<br><br></li>
</ul>
<h3 style="font-size: 20px;"><span style="font-size: 24px; font-family: Impact, Chicago, 'Arial Black', Arial, 'sans serif';">HTTPS Socket C2</span></h3>
<p style="font-size: 18px;"><span style="font-weight: bold;">3.</span> By digging a bit deeper into the “mainThread1()“ &nbsp;which executes the “ctrl.run()” function, we can see that the run() function tries to create a connection and routinely checks if the connection is alive. It then tries to “parseCommand,” trimming irrelevant parts out of it.</p>
<p style="font-size: 18px;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=1023&amp;height=706&amp;name=Figure%209.png" width="1023" height="706" loading="lazy" alt="Java code snippet from the Controller class in a decompiled Java program" style="height: auto; max-width: 100%; width: 1023px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=512&amp;height=353&amp;name=Figure%209.png 512w, https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=1023&amp;height=706&amp;name=Figure%209.png 1023w, https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=1535&amp;height=1059&amp;name=Figure%209.png 1535w, https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=2046&amp;height=1412&amp;name=Figure%209.png 2046w, https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=2558&amp;height=1765&amp;name=Figure%209.png 2558w, https://www.hunters.security/hs-fs/hubfs/Figure%209.png?width=3069&amp;height=2118&amp;name=Figure%209.png 3069w" sizes="(max-width: 1023px) 100vw, 1023px"><span style="font-size: 12px;"><em>Figure 9: Java code snippet from the Controller class in a decompiled Java program</em></span></p>
<p style="font-size: 18px;"><span style="font-weight: bold;">4.</span> This “run” function uses “connect()” to setup/reset a connection. It creates a socket to the remote IP address we saw above - 40.90.196.228.<br><br><span style="font-weight: bold;">5.</span> This “run” function uses “CommandManager,” which includes different handlings for the different types of commands/capabilities this malware provides, including file transfer from client to server and from server to client, file compression, screenshots, closing network connections, and, of course, command execution.<br><br>It checks if the command received is empty or if an actual command was received from the C2 server.</p>
<p style="font-size: 18px;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=1035&amp;height=451&amp;name=Figure%2010.png" width="1035" height="451" loading="lazy" alt="Screenshot of Java code snippet from the CommandManager class in a decompiled Java program" style="height: auto; max-width: 100%; width: 1035px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=518&amp;height=226&amp;name=Figure%2010.png 518w, https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=1035&amp;height=451&amp;name=Figure%2010.png 1035w, https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=1553&amp;height=677&amp;name=Figure%2010.png 1553w, https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=2070&amp;height=902&amp;name=Figure%2010.png 2070w, https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=2588&amp;height=1128&amp;name=Figure%2010.png 2588w, https://www.hunters.security/hs-fs/hubfs/Figure%2010.png?width=3105&amp;height=1353&amp;name=Figure%2010.png 3105w" sizes="(max-width: 1035px) 100vw, 1035px"><span style="font-size: 12px;"><em>Figure 10: Java code snippet from the CommandManager class in a decompiled Java program</em></span></p>
<p style="font-size: 18px;"><span style="font-weight: bold;">6. </span>If a command is found, it parses it and executes it. The execution is basically under the context of PowerShell.<br><br>The execution of the incoming command as a PowerShell command is being conducted using the jPowerShell wrapper we mentioned earlier.</p>
<p style="font-size: 18px;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=615&amp;height=181&amp;name=Figure%2011.png" width="615" height="181" loading="lazy" alt="Java code snippet from the CommandManager class in a decompiled Java program" style="height: auto; max-width: 100%; width: 615px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=308&amp;height=91&amp;name=Figure%2011.png 308w, https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=615&amp;height=181&amp;name=Figure%2011.png 615w, https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=923&amp;height=272&amp;name=Figure%2011.png 923w, https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=1230&amp;height=362&amp;name=Figure%2011.png 1230w, https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=1538&amp;height=453&amp;name=Figure%2011.png 1538w, https://www.hunters.security/hs-fs/hubfs/Figure%2011.png?width=1845&amp;height=543&amp;name=Figure%2011.png 1845w" sizes="(max-width: 615px) 100vw, 615px"><span style="font-size: 12px;"><em>Figure 11: Java code snippet from the CommandManager class in a decompiled Java program</em></span></p>
<h3 style="font-size: 24px; font-weight: normal;"><span style="font-family: Impact, Chicago, 'Arial Black', Arial, 'sans serif';">OneDrive Command &amp; Control<br></span></h3>
<p>Before delving into the core of the OneDrive C2 functionality, it's important to note that critical parts of the malware's code rely heavily on three specific 'types' of OneDrive files: <span style="font-weight: bold;">UUID</span>, <span style="font-weight: bold;">cf_UUID</span>, and <span style="font-weight: bold;">rf_UUID</span>. As observed in our investigation, the command <span style="font-size: 16px;"><code>Get-WmiObject -Class Win32_ComputerSystemProduct | Select-Object -ExpandProperty UUID</code></span> was executed, revealing the UUID of the device hardware. This unique identifier serves to distinguish each victim in the VEILDrive campaign.<br><br>Each file type plays a distinct role in the malware’s operations. The following screenshot provides examples of these files and their primary roles in malware execution.</p>
<p><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=1051&amp;height=285&amp;name=Figure%2012.png" width="1051" height="285" loading="lazy" alt="Screenshot showing three files in a directory, each with a unique UUID" style="height: auto; max-width: 100%; width: 1051px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=526&amp;height=143&amp;name=Figure%2012.png 526w, https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=1051&amp;height=285&amp;name=Figure%2012.png 1051w, https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=1577&amp;height=428&amp;name=Figure%2012.png 1577w, https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=2102&amp;height=570&amp;name=Figure%2012.png 2102w, https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=2628&amp;height=713&amp;name=Figure%2012.png 2628w, https://www.hunters.security/hs-fs/hubfs/Figure%2012.png?width=3153&amp;height=855&amp;name=Figure%2012.png 3153w" sizes="(max-width: 1051px) 100vw, 1051px"><span style="font-size: 12px;"><em>Figure 12: Screenshot showing three files in a directory, each with a unique UUID</em></span></p>
<p>Let’s dive into the flow of the OneDrive C2 functionality and how those UUID files are being used in practice:<br><br><span style="font-weight: bold;">7.</span> In addition to the classic Remote Execution capabilities over PowerShell, the “odRun” function is responsible for another thread based on “OneDrive” as a communication channel. This is the unique part of this malware.<br><br>The “odRun” as we see it, is probably named after “OneDrive” (OneDriveRun), and includes the creation of a OneDrive connection using the “Odconnect” function as a first step:</p>
<p style="line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=1163&amp;height=739&amp;name=Figure%2013.png" width="1163" height="739" loading="lazy" alt="Java code snippet showing the odRun method, which takes parameters including tenantId, clientId, clientSecret, grantType, accessToken, and refreshToken" style="height: auto; max-width: 100%; width: 1163px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=582&amp;height=370&amp;name=Figure%2013.png 582w, https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=1163&amp;height=739&amp;name=Figure%2013.png 1163w, https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=1745&amp;height=1109&amp;name=Figure%2013.png 1745w, https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=2326&amp;height=1478&amp;name=Figure%2013.png 2326w, https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=2908&amp;height=1848&amp;name=Figure%2013.png 2908w, https://www.hunters.security/hs-fs/hubfs/Figure%2013.png?width=3489&amp;height=2217&amp;name=Figure%2013.png 3489w" sizes="(max-width: 1163px) 100vw, 1163px"><span style="font-size: 12px;"><em>Figure 13: Java code snippet showing the odRun method, which takes parameters including tenantId, clientId, clientSecret, grantType, accessToken, and refreshToken</em></span></p>
<p><span style="font-weight: bold;">8. </span>As you can see, first the “machineUUID” string is set as an empty string. Followed by the execution of the “getMachineUUID()” function, which is, as its name suggests, gets the Machine UUID of the victim device:</p>
<p><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=929&amp;height=76&amp;name=Figure%2014.png" width="929" height="76" loading="lazy" alt="Java code snippet showing the getMachineUUID method, which retrieves the machine's UUID. The method executes a PowerShell command, 'Get-WmiObject -Class Win32_ComputerSystemProduct | Select-Object -ExpandProperty UUID', and assigns the result to the machineUUID variable before returning it" style="height: auto; max-width: 100%; width: 929px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=465&amp;height=38&amp;name=Figure%2014.png 465w, https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=929&amp;height=76&amp;name=Figure%2014.png 929w, https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=1394&amp;height=114&amp;name=Figure%2014.png 1394w, https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=1858&amp;height=152&amp;name=Figure%2014.png 1858w, https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=2323&amp;height=190&amp;name=Figure%2014.png 2323w, https://www.hunters.security/hs-fs/hubfs/Figure%2014.png?width=2787&amp;height=228&amp;name=Figure%2014.png 2787w" sizes="(max-width: 929px) 100vw, 929px"><em><span style="font-size: 12px;">Figure 14: Java code snippet showing the getMachineUUID method, which retrieves the machine's UUID.&nbsp;</span></em></p>
<p><span style="font-weight: bold;">9.</span> We can then see that the OneDrive connection is being conducted using the “OdConnect” function—the connection is being made to “login[.]microsoftonline[.]com“ for the creation/update of a set of new access tokens and refresh tokens.</p>
<p><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=1029&amp;height=819&amp;name=Figure%2015.png" width="1029" height="819" loading="lazy" alt="Java code snippet showing the updateTokens method in the Odconnect class" style="height: auto; max-width: 100%; width: 1029px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=515&amp;height=410&amp;name=Figure%2015.png 515w, https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=1029&amp;height=819&amp;name=Figure%2015.png 1029w, https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=1544&amp;height=1229&amp;name=Figure%2015.png 1544w, https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=2058&amp;height=1638&amp;name=Figure%2015.png 2058w, https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=2573&amp;height=2048&amp;name=Figure%2015.png 2573w, https://www.hunters.security/hs-fs/hubfs/Figure%2015.png?width=3087&amp;height=2457&amp;name=Figure%2015.png 3087w" sizes="(max-width: 1029px) 100vw, 1029px"><span style="font-size: 12px;"><em>Figure 15: Java code snippet showing the updateTokens method in the Odconnect class</em></span></p>
<p><span style="font-weight: bold;">10.</span> The “WriteFileToOneDrive” function is the next one that is being called, as long as there is no file named as the current victim machine UUID in the target computer, based on a check conducted by the “checkFile“ function.</p>
<ul>
<li>”checkFile”: This function checks if there is a file named == machineUUID in the home folder of the current user OneDrive</li>
</ul>
<p style="line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=1024&amp;height=592&amp;name=Figure%2016.png" width="1024" height="592" loading="lazy" alt="Java code snippet showing the checkFile method in the Odconnect class. This method checks for the existence of a file in OneDrive by using Microsoft Graph API to list files in the root directory" style="height: auto; max-width: 100%; width: 1024px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=512&amp;height=296&amp;name=Figure%2016.png 512w, https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=1024&amp;height=592&amp;name=Figure%2016.png 1024w, https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=1536&amp;height=888&amp;name=Figure%2016.png 1536w, https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=2048&amp;height=1184&amp;name=Figure%2016.png 2048w, https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=2560&amp;height=1480&amp;name=Figure%2016.png 2560w, https://www.hunters.security/hs-fs/hubfs/Figure%2016.png?width=3072&amp;height=1776&amp;name=Figure%2016.png 3072w" sizes="(max-width: 1024px) 100vw, 1024px"><em><span style="font-size: 12px;">Figure 16: Java code snippet showing the checkFile method in the Odconnect class. This method checks for the existence of a file in OneDrive by using Microsoft Graph API to list files in the root directory</span></em></p>
<p><span style="font-weight: bold;">11. </span>If there is no such file, the “writeFileToOneDrive()” gets into the game, and creates a file named as the current victim Computer UUID without any prefix.</p>
<p style="line-height: 1;"><img src="https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=983&amp;height=402&amp;name=Figure%2017.png" width="983" height="402" loading="lazy" alt="Java code snippet showing the writeFileToOneDrive method in the Odconnect class. This method uploads a file to OneDrive by sending a PUT request to the Microsoft Graph API" style="height: auto; max-width: 100%; width: 983px;" srcset="https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=492&amp;height=201&amp;name=Figure%2017.png 492w, https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=983&amp;height=402&amp;name=Figure%2017.png 983w, https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=1475&amp;height=603&amp;name=Figure%2017.png 1475w, https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=1966&amp;height=804&amp;name=Figure%2017.png 1966w, https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=2458&amp;height=1005&amp;name=Figure%2017.png 2458w, https://www.hunters.security/hs-fs/hubfs/Figure%2017.png?width=2949&amp;height=1206&amp;name=Figure%2017.png 2949w" sizes="(max-width: 983px) 100vw, 983px"><span style="font-size: 12px;"><em>Figure 17: Java code snippet showing the writeFileToOneDrive method in the Odconnect class. This method uploads a file to OneDrive by sending a PUT request to the Microsoft Graph API</em></span></p>
<p><span style="font-weight: bold;">12.</span> The next part of “<span style="font-weight: bold;">odRun</span>” is the “<span style="font-weight: bold;">getFiles()</span>” function that gets the content of the UUID<br><br>OneDrive file that’s named by the machineUUID of the device (without prefixes).</p>
<ul>
<li>If the content of the file is not empty it checks if it <em><strong>starts</strong></em> with the word “send”<br>
<ul>
<li>If so, it conducts some normalization of the content, preparing it for the next checks - by removing the string “send “ and replacing “\”“ with “” (nothing) saving it in a variable named “<strong>filenameForDownload</strong>“</li>
<li><strong>filenameForDownload</strong> is being passed to <strong>getFileDownloadUrl</strong> function. This gets the file of the attacker’s choice. The attacker would specify the file name after the word “send” in the UUID file and save it to the specified destination path on the victim machine which is “user.home“\downloads (the downloads folder).</li>
<li>Following that, the “<strong>downloadFile</strong>” function is being called, downloading the remote file to the local victim device, based on the <strong>getFileDownloadUrl</strong> function output.</li>
<li>The attacker gets an indication about the execution of the file using “<strong>writeFileToOneDrive</strong>“ which is executed right after as part of “odRun” to write the following “rf_“ + “send file” + filenameForDownload + “done” → to let the attacker know that the execution was conducted.<br>Following that, there is another execution of “writeFileToOneDrive“, in which another file, named “cf_” + machineUUID is being written to OneDrive, without any content in it.</li>
</ul>
</li>
<li>If the content of the file is not empty but <em><strong>doesn’t</strong></em> start with “send”:
<ul>
<li>The content of the cf_MachineUUID file will be executed.</li>
<li>Followed again by writing a file to OneDrive, using “<strong>writeFileToOneDrive</strong>“, first “rf_“ + machineUUID, with the content of the response of execution.</li>
<li>And another usage of “<strong>writeFileToOneDrive</strong>“, to write and empty “cf_” file, basically preventing another execution of the same command (since the malware runs in a loop).</li>
</ul>
</li>
</ul>
<p>To shortly summarize, this malware seems to have two different C2 channels it can work with:</p>
<ul>
<li><strong>HTTPS Socket C2</strong>: a more classic approach, receiving commands from a remote <strong>Azure VM</strong> and executing them under the context of PowerShell.</li>
<li><strong>OneDrive-based C2</strong>: this is more unique, and the way it works is a bit more complex and creative. It includes three different files, all of which include the UUID of the victim device, some with prefixes (rf_ and cf_). To make it easy for the threat actor to send commands and receive them using Microsoft Graph.<br><br><strong>Note</strong>: It’s important to mention that this malware has additional capabilities besides the standard command execution, including file transfer. However, the detailed information above focuses on the command execution aspect only.<br><br></li>
</ul>
<h2 style="font-size: 48px;">Microsoft Services/Apps as Attacker's Infrastructure</h2>
<p>At this point, it’s clear that this attack skillfully combined simple techniques with sophisticated, unique tactics. One standout feature from our initial investigation was the extensive use of Microsoft infrastructure and services integrated throughout the campaign.<br><br>After analyzing the malware and correlating the new information with our investigation insights, we gained a clearer understanding of the attacker’s use of various services and their purposes. We discovered that the utilization of Microsoft services and infrastructure was even more extensive than initially realized.<br><br>See the table below for a short summary:</p>
<div data-hs-responsive-table="true" style="overflow-x: auto; max-width: 100%; width: 98.0364%; margin-left: auto; margin-right: auto;">
<table style="width: 100%; border-collapse: collapse; table-layout: fixed; border: 1px solid #99acc2;">
<tbody>
<tr>
<td style="width: 33.2901%; padding: 4px;"><strong>Service</strong></td>
<td style="width: 33.2901%; padding: 4px;"><strong>Tenant</strong></td>
<td style="width: 33.2912%; padding: 4px;"><strong>Purpose</strong></td>
</tr>
<tr>
<td style="width: 33.2901%; padding: 4px;">Microsoft Teams</td>
<td style="width: 33.2901%; padding: 4px;">From Org A to Org C<br><br></td>
<td style="width: 33.2912%; padding: 4px;">Spear Phishing Messages to lure the victim to download and execute a remote management tool&nbsp;</td>
</tr>
<tr>
<td style="width: 33.2901%; padding: 4px;">Quick Assist</td>
<td style="width: 33.2901%; padding: 4px;">Org C</td>
<td style="width: 33.2912%; padding: 4px;">The threat actor sends a Quick Assist code using a Microsoft Teams message to gain the initial remote control</td>
</tr>
<tr>
<td style="width: 33.2901%; padding: 4px;">SharePoint</td>
<td style="width: 33.2901%; padding: 4px;">From Org B to Org C</td>
<td style="width: 33.2912%; padding: 4px;">Malicious files are “hosted” in the SharePoint tenant of Org B. Download links are shared with Org C via SharePoint messages and opened by the attacker using Quick Assist</td>
</tr>
<tr>
<td style="width: 33.2901%; padding: 4px;">Azure VM</td>
<td style="width: 33.2901%; padding: 4px;">Attacker’s infrastructure<br><br></td>
<td style="width: 33.2912%; padding: 4px;">The malware communicated with an Azure Virtual Machine owned by the threat actor for HTTPS Socket C2 purposes</td>
</tr>
<tr>
<td style="width: 33.2901%; padding: 4px;">OneDrive (Graph API)</td>
<td style="width: 33.2901%; padding: 4px;">Between Attacker's OneDrive &amp; Org C host(s)</td>
<td style="width: 33.2912%; padding: 4px;">The threat actor used OneDrive as an additional C2 channel, to get capabilities like remote execution of commands, taking screenshots, downloading/upload files, etc. targeting Org C host(s)</td>
</tr>
<tr>
<td style="width: 33.2901%; padding: 4px;">Azure AD App Registration</td>
<td style="width: 33.2901%; padding: 4px;">Between Attacker's OneDrive &amp; Org C host(s</td>
<td style="width: 33.2912%; padding: 4px;">The application was used for authentication on behalf of an Azure AD user account owned by the actor, and access it’s OneDrive home folder</td>
</tr>
</tbody>
</table>
</div>
<h2 style="font-size: 48px;">Indicators of Compromise&nbsp; (IOCS)&nbsp;</h2>
<ul>
<li><span style="font-weight: bold;">Known Entra ID tenants owned by the attacker:</span>
<ul style="font-size: 14px;">
<li><code>C5f077f6-5f7e-41a3-8354-8e31d50ee4d</code></li>
<li><code>893e5862-3e08-434b-9067-3289bec85f7d</code></li>
</ul>
</li>
<li><span style="font-weight: bold;">Known applications’ registered by the attacker client IDs:</span>
<ul>
<li><code>B686e964-b479-4ff5-bef6-e360321a9b65</code></li>
<li><code>2c73cab1-a8ee-4073-96fd-38245d976882</code></li>
</ul>
</li>
<li><span style="font-weight: bold;">Entra ID tenants used by the attacker (Look for outgoing DNS request toward those domains):</span>
<ul>
<li><code>SafeShift390[.]onmicrosoft[.]com</code></li>
<li><code>GreenGuard036[.]onmicrosoft[.]com</code></li>
</ul>
</li>
<li><strong>File IOCs (SHA256) found as part of the investigation:</strong>
<ul>
<li><strong>ROMServer.exe<br></strong><code>a515634efa79685970e0930332233aee74ec95aed94271e674445712549dd254</code></li>
<li><strong>HookDrv.dll</strong> <code>1040aede16d944be8831518c68edb14ccbf255feae3ea200c9401186f62d2cc4</code></li>
<li><strong>ROMFUSClient.exe</strong> <code>7f61ff9dc6bea9dee11edfbc641550015270b2e8230b6196e3e9e354ff39da0e</code></li>
<li><strong>AledensoftIpcServer.dll</strong><br><code>d6af24a340fe1a0c6265399bfb2823ac01782e17fc0f966554e01b6a1110473f</code></li>
<li><strong>ROMwln.dll</strong> <code>7f33398b98e225f56cd287060beff6773abb92404afc21436b0a20124919fe05</code></li>
<li><strong>IP Addresses:</strong>
<ul>
<li><code>40.90.196[.]221</code></li>
<li><code>40.90.196[.]228</code></li>
<li><code>38.180.136[.]85</code></li>
<li><code>213.87.86[.]192&nbsp;</code><br><br></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 style="font-size: 48px;">Hunting Queries</h2>
<p>In addition to the specific IOCs mentioned above, we crafted multiple threat-hunting queries that can be used to detect attacks originated by the same actor, conducted under the same campaign, or sharing similar characteristics (TTPs).&nbsp;<br><br><em><span style="font-weight: bold;">Note</span>: The recommended hunting timeframe for VEILDrive is from July 2024.&nbsp;<br><br></em></p>
<p><strong><span style="color: #6c38ff;">HUNTING QUERY 1</span></strong><strong><span style="color: #6c38ff;">: <span style="color: #000000;">Javaw Spawning Powershell with Specific Flags - Unusual Behavior&nbsp;</span></span></strong></p>
<ul style="font-size: 18px;">
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query logic:</span></strong><span style="color: #000000;"> During our analysis, we identified that the attacker’s Remote Access Tool (RAT) used Powershell to fetch the machine's UUID as part of its execution process. This query detects unusual instances of Powershell being spawned by javaw.exe with the specific command line flags used by the threat actor.</span></li>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query:</span></strong></li>
</ul>
<pre><code class="language-sql">SELECT EVENT_TIME,
       AGENT_ID,
       PARENT_PROCESS_NAME,
       PARENT_PROCESS_COMMANDLINE,
       INITIATING_PROCESS_NAME,
       INITIATING_PROCESS_COMMANDLINE,
       TARGET_PROCESS_NAME,
       TARGET_PROCESS_COMMANDLINE,
       TARGET_PROCESS_OS_PID
  FROM INVESTIGATION.EDR_PROCESS_CREATION_EVENTS
 WHERE 1=1
   AND PARENT_PROCESS_NAME ILIKE '%javaw%'
   AND INITIATING_PROCESS_NAME ILIKE '%cmd%'
   AND TARGET_PROCESS_NAME ILIKE '%powershell%'
   AND TARGET_PROCESS_COMMANDLINE ILIKE 'powershell.exe  -ExecutionPolicy Bypass -NoExit -NoProfile %'
   AND EVENT_TIME &gt; current_timestamp - interval '60d'</code></pre>
<p><span style="font-size: 20px;"><strong><span style="color: #6c38ff;"><br>HUNTING QUERY 2</span></strong><strong>: ROM Tool Persistence via Scheduled Tasks</strong></span><strong><span style="font-size: 15px;"><br></span></strong></p>
<ul>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query logic:</span></strong><span style="color: #000000;"> This query detects instances of a scheduled task registering with the execution of a ROM tool used by the threat actor for persistence.&nbsp;</span></li>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query:</span></strong><strong style="color: #000000;"><span style="font-size: 15px;">&nbsp;</span></strong></li>
</ul>
<pre><code class="language-sql">
SELECT EVENT_TIME                   AS EVENT_TIME,
       AID                          AS AGENT_ID,
       CID                          AS COMPUTER_ID,
       EVENT_SIMPLE_NAME            AS EVENT_NAME,
       RAW:TaskName                 AS TASK_NAME,
       RAW:TaskExecCommand          AS TASK_EXEC_COMMAND,
       RAW:TaskAuthor               AS TASK_AUTHOR,
       RAW:UserName                 AS USER_NAME
  --- Adjust according to your EDR of choice
  FROM RAW.CROWDSTRIKE_RAW_EVENTS
 WHERE EVENT_SIMPLE_NAME = 'ScheduledTaskRegistered'
  AND TASK_EXEC_COMMAND ILIKE '%romserver%'
  AND EVENT_TIME &gt; CURRENT_TIMESTAMP - interval '60d'
    </code></pre>
<p style="font-size: 20px;"><strong><span style="color: #6c38ff;">HUNTING QUERY 3</span></strong><strong><span style="color: #6c38ff;">: <span style="color: #000000;">Non-Organizational Users Sharing Links to Third-Party Sharepoint Domains via Microsoft Teams</span><br></span></strong></p>
<ul>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query logic:</span></strong><span style="color: #000000;"> This query detects cases where a SharePoint link is shared in a Teams chat, but the domain of the SharePoint link does not belong to any of the chat participants. This could indicate a potential phishing attempt or data exfiltration, where an external domain is being used to share files or information with unsuspecting users within the organization.</span></li>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query:</span></strong></li>
</ul>
<pre><code class="language-sql">
SET YOUR_ORGANIZATION_NAME = 'hunters';

SELECT EVENT_TIME,
      ORGANIZATION_ID                                          AS ORG_ID,
      OPERATION                                                AS EVENT_TYPE,
      SPLIT_PART(LOWER(SPLIT_PART(USER_ID, '@', 2)), '.', 1)   AS SENDER_ORG_DOMAIN,
      RECORD_SPECIFIC_DETAILS:message_ur_ls                    AS MESSAGE_URLS,
      WORKLOAD                                                 AS WORKLOAD,
      USER_ID                                                  AS USER_ID,
      RECORD_SPECIFIC_DETAILS:chat_thread_id                   AS CHAT_THREAD_ID,
      RECORD_SPECIFIC_DETAILS:communication_type               AS COMMUNICATION_TYPE,
      RECORD_SPECIFIC_DETAILS:members[0].DisplayName           AS MEMBER_DISPLAY_NAME,
      RECORD_SPECIFIC_DETAILS:members[0].UPN                   AS MEMBER_UPN,
      RECORD_SPECIFIC_DETAILS:members[0]                       AS MEMBERS,
      RECORD_SPECIFIC_DETAILS:resource_tenant_id               AS RESOURCE_TENANT_ID,
      RECORD_SPECIFIC_DETAILS
FROM RAW.O365_AUDIT_LOGS
WHERE NOT USER_ID ILIKE '%' || $YOUR_ORGANIZATION_NAME || '%'
 AND (NOT (MESSAGE_URLS ILIKE '%' || SENDER_ORG_DOMAIN || '%') AND MESSAGE_URLS ILIKE '%sharepoint%')
 AND NOT MESSAGE_URLS ILIKE '%' || $YOUR_ORGANIZATION_NAME || '%'
 AND EVENT_TIME &gt; CURRENT_TIMESTAMP - interval '60d'
    </code></pre>
<p><strong><span style="color: #6c38ff;">HUNTING QUERY 4</span></strong><strong><span style="color: #6c38ff;">: <span style="color: #000000;">Microsoft Teams - Phishing Detection - Multiple DM’s from Non-Common Domains</span></span></strong></p>
<ul>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query logic:</span></strong><span style="color: #000000;"> The following query detects messages sent in a one-on-one chat by external users from non-common domains. The query filters out extensively used domains based on historical activity and identifies external members added to chats who may be conducting phishing attacks.</span></li>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">Query:</span></strong></li>
</ul>
<pre><code class="language-sql">SET YOUR_DOMAIN_NAME = 'hunters';

--- GET EXTERNAL TEAMS AND ONEDRIVE USERS OF THE LAST 3 MONTHS - TO CLEAN EXTENSIVELY USED DOMAINS
WITH COMMONLY_USED_DOMAINS AS (
   SELECT LOWER(SPLIT_PART(USER_ID , '@', 2))                      AS DOMAIN_COMMONLY_USED,
          MIN(EVENT_TIME)                  AS MIN_EVENT_TIME,
          MAX(EVENT_TIME)                  AS MAX_EVENT_TIME,
          ARRAY_AGG(DISTINCT OPERATION)    AS OPERATIONS,
          COUNT(*)                         AS COUNTER
   FROM RAW.O365_AUDIT_LOGS
   WHERE WORKLOAD IN ('MicrosoftTeams', 'OneDrive')
     AND EVENT_TIME &gt; CURRENT_TIMESTAMP - interval '90d'
     AND USER_ID ILIKE '%@%'
   GROUP BY DOMAIN_COMMONLY_USED
   HAVING COUNTER &gt; 20
),
---- Get List of External Domains that recently communicated with our organization using Microsoft Teams
    LATEST_EXTERNAL_DOMAINS AS (
        SELECT USER_ID                                                              AS LATEST_EXT_USERS,
               LOWER(SPLIT_PART(USER_ID , '@', 2))                                  AS USER_DOMAIN,
               MIN(EVENT_TIME)                                                      AS MIN_EVENT_TIME,
               MAX(EVENT_TIME)                                                      AS MAX_EVENT_TIME,
               ARRAY_AGG(DISTINCT OPERATION)                                        AS OPERATIONS,
               ARRAY_AGG(DISTINCT RECORD_SPECIFIC_DETAILS:communication_type)       AS COMMUNICATION_TYPE,
               COUNT(*)                                                             AS COUNTER
        FROM RAW.O365_AUDIT_LOGS
        WHERE EVENT_TIME &gt; CURRENT_TIMESTAMP - interval '50d'
          AND NOT USER_ID ILIKE '%' || $YOUR_DOMAIN_NAME || '%'
          AND NOT USER_ID IN ('app@sharepoint')
          AND USER_ID ILIKE '%@%'
          -- CLEAN-UP OF EXTENSIVELY USED DOMAINS
          AND USER_DOMAIN NOT IN (SELECT DISTINCT DOMAIN_COMMONLY_USED FROM COMMONLY_USED_DOMAINS)
          AND OPERATION IN ('MemberAdded', 'ChatCreated')
          AND RECORD_SPECIFIC_DETAILS:communication_type = 'OneOnOne'
        GROUP BY USER_ID
        HAVING COUNT(*) &gt; 5
    )

SELECT EVENT_TIME,
      ORGANIZATION_ID                                          AS ORG_ID,
      WORKLOAD                                                 AS WORKLOAD,
      OPERATION                                                AS OPERATION,
      USER_ID                                                  AS USER_ID,
      LOWER(SPLIT_PART(USER_ID , '@', 2))                      AS USER_DOMAIN,
      RECORD_SPECIFIC_DETAILS:chat_thread_id                   AS CHAT_THREAD_ID,
      RECORD_SPECIFIC_DETAILS:communication_type               AS COMMUNICATION_TYPE,
      RECORD_SPECIFIC_DETAILS:members[0].DisplayName           AS MEMBER_DISPLAY_NAME_0,
      RECORD_SPECIFIC_DETAILS:members[0].UPN                   AS MEMBER_UPN_0,
      RECORD_SPECIFIC_DETAILS:members[0]                       AS MEMBERS_0,
      RECORD_SPECIFIC_DETAILS:members[1].DisplayName           AS MEMBER_DISPLAY_NAME_2,
      RECORD_SPECIFIC_DETAILS:members[1].UPN                   AS MEMBER_UPN_2,
      RECORD_SPECIFIC_DETAILS:members[1]                       AS MEMBERS_2,
      RECORD_SPECIFIC_DETAILS:resource_tenant_id               AS RESOURCE_TENANT_ID,
      RECORD_SPECIFIC_DETAILS,
      RAW:ClientIP                                             AS CLIENT_IP
FROM RAW.O365_AUDIT_LOGS
WHERE 1=1
 AND RECORD_SPECIFIC_DETAILS:communication_type = 'OneOnOne'
 AND (
   RECORD_SPECIFIC_DETAILS:members[0].UPN IN (SELECT LATEST_EXT_USERS FROM LATEST_EXTERNAL_DOMAINS)
       OR RECORD_SPECIFIC_DETAILS:members[1].UPN IN (SELECT LATEST_EXT_USERS FROM LATEST_EXTERNAL_DOMAINS)
   )
 AND USER_ID ILIKE '%' || $YOUR_DOMAIN_NAME || '%'
 AND OPERATION = 'MemberAdded'
 AND EVENT_TIME &gt; CURRENT_TIMESTAMP - interval '50d';
    </code></pre>
<ul>
<li style="color: #6c38ff;" aria-level="1"><strong><span style="color: #000000;">In-depth query logic: </span></strong><span style="color: #000000;">Since this query is a little complex, here is an explanation of the logic. First, we use the “CTE” feature of Snowflake to construct two views:</span>
<ol>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">COMMONLY_USED_DOMAINS:<br></span>
<ul>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">We extract the domain names from the user ID by splitting the string after the '@'.</span></li>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">Count all events generated by each domain over the past 90 days</span></li>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">Keep domains that have more than 20 events and consider them common. You can adjust this according to your needs.</span><br><span style="color: #000000;"></span></li>
</ul>
<span style="color: #000000;"></span></li>
<li>LATEST_EXTERNAL_DOMAINS:<br>
<ul>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">Filter out internal domains and commonly used domains identified in the previous view from all events in the last 50 days</span></li>
<li style="color: #6c38ff;" aria-level="1"><span style="color: #000000;">Query all domains that have more than 5 events involving sending direct messages and member additions to Teams.</span></li>
</ul>
</li>
</ol>
<span style="color: #000000;">Finally, we retrieve detailed information about the user and their associated domain by querying the filtered results from LATEST_EXTERNAL_DOMAINS.</span></li>
</ul>
<h2 style="font-size: 48px;">Hygiene Nuggets</h2>
<p>We covered hunting and investigation aspects related to multiple attack techniques used by the actor. Some of those malicious methods and techniques are also known to be used in different campaigns.<br><br>Protecting your organization from those threats can significantly reduce the risk of successful attacks targeting different parts of your organizational infrastructure.<br><br>Here are a few Hygiene Nuggets that can be used to enhance your security posture:</p>
<ol>
<li>To reduce the chances of successful phishing attacks through Microsoft Teams, here are a few steps you can take:<br>
<ul>
<li>By default, Microsoft Teams allows “External Access,” which permits one-on-one chats with outside contacts. If this isn’t essential for your organization, consider disabling this option.</li>
<li>If external communication is necessary, limit it to trusted domains only.</li>
<li>Another way to communicate with external parties in Microsoft Teams is by adding them as guests or members. We strongly recommend restricting this feature, allowing only select, high-privileged users to manage it.</li>
</ul>
</li>
<li>The rise in cyber attacks using remote administration tools calls for clear distinctions between tools used legitimately and those exploited by threat actors. Here are a few recommendations:<br>
<ul>
<li>Limit remote administration tools to specific, approved applications required for business purposes. Quick Assist is easily downloadable from the Microsoft Store; consider blocking its use if it’s not on your organization’s whitelist. You can restrict access by applying measures like AppLocker, Windows Firewall rules, or MDM management.</li>
<li>Keep track of commonly used remote management tools and monitor for any unusual or unauthorized third-party tools. For example, if Quick Assist is used and your IT team doesn’t rely on it for remote support, it should trigger an alarm.</li>
</ul>
</li>
<li>Security Awareness Training—It may sound like a cliche, but human errors are consistently one of the main reasons for successful cyber attacks. Security awareness training can make a difference in this regard, protecting you from the next breach.&nbsp;<br>
<ul>
<li>We do recommend making it focused and relevant to the threats seen in the wild. For example, cases of IT impersonation via communication platforms like Microsoft Teams, Slack, or even classic phone calls are on the rise. Please make sure that your employees know how to deal with it.&nbsp;<br><br></li>
</ul>
</li>
</ol>
<h2 style="font-size: 48px;">Conclusion&nbsp;</h2>
<ul>
<li aria-level="1">VEILDrive combines simplicity and sophistication. It was interesting to witness the use of classic C2 characteristics in parallel with C2 over OneDrive, as well as the use of classic scheduled task-based persistence combined with malware execution that a top-notch EDR does not detect.&nbsp;</li>
<li aria-level="1">The characteristics identified as part of investigation and threat research were interesting, and they allowed us to better understand how this threat actor works, which known services it is abusing, how it is abusing them, and for what purpose.</li>
<li aria-level="1">The way OneDrive was abused for C2 communication in VEILDrive had unique characteristics. However, the general concept of OneDrive abuse for C2 purposes has been on the rise over the last months, and it is something to keep in mind.</li>
<li aria-level="1">Initial access through spear-phishing on communication platforms like Microsoft Teams, Slack, and similar services is increasingly common.</li>
<li aria-level="1">We forecast that it will become even more common as time goes by. Hence, hygiene and posture measures related to this aspect (as mentioned in the Hygiene Nuggets above) are crucial.</li>
<li aria-level="1">Remote Administration tools are already very popular among threat actors. Different approaches can be taken to minimize the potential for unauthorized access using such tools. From our point of view, the recommended approach in this area is whitelisting (allowlisting) combined with robust monitoring.</li>
<li aria-level="1">We anticipate that more campaigns of this nature will emerge, employing similar methods and characteristics. Therefore, continuous monitoring and proactive threat-hunting for this type of threat are strongly recommended.</li>
</ul>
<p><br><em>To stay updated on threat-hunting research, activities, and queries, follow Team Axon’s X/Twitter ac</em><span style="font-style: italic;">count (</span><a href="http://www.x.com/team__axon" rel="noopener" style="font-style: italic;">@team__axon</a><span style="font-style: italic;">).&nbsp;</span></p></span>
            </section>    
          </div>
        </div>
        

         

        
        <footer class="blog-post__footer">
          

          


        </footer>
        

      </article>
      

    </div>
    <div class="related-post-bottom-block ">
      <div id="hs_cos_wrapper_blog_related_posts" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="blog-related-posts-section customer-slider-section" style="background-color:#f4f4f4;">
  <div class="blog-heading-top-block">
    <div class="page-center">
      <div class="blog-heading-top-inner">
        <div class="blog-heading-top">
          <h3>Relevant posts </h3>
        </div>
        <div class="blog-heading-top-slider-arrow">
        </div>
      </div>
    </div>
  </div>
  <div class="blog-related-posts-block page-center">
    <div class="blog-related-posts-slider realted-post-slider-track">

      
       <!-- Set the max number of related posts to be output to the page here -->
      
      
      
      
      
      
      
      
      
      
      
      
    
        
        
        
        
        <div>
          <div class="blog-post-card-item">
            <div class="blog-post-card-item-inner">
              <div class="blog-post-card-tag-title-block">
                <span class="tag-list">
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/team-axon">Team Axon</a>
                  
                </span>
                <h5> <a href="https://www.hunters.security/en/blog/detect-threats-in-snowflake-unc5537"> Investigating UNC5537: Snowflake Database Threat Campaign </a> </h5>
              </div>
              <div class="blog-post-card-author-date-block">
                <span class="blog_post_author"> Team Axon </span>
                <span class="blog_post_date">Sep 11, 2024 </span>
                
              </div>
              <div class="blog-post-card-featured-image-block">
                <a href="https://www.hunters.security/en/blog/detect-threats-in-snowflake-unc5537">
                  <img src="https://www.hunters.security/hubfs/Detect%20and%20Investigate%20Threats%20in%20Snowflake%20%282%29.jpg" alt="Detect and investigate threats in snowflake database ">
                </a>
              </div>
            </div>
          </div>  
        </div>
        
        
        
        
        <div>
          <div class="blog-post-card-item">
            <div class="blog-post-card-item-inner">
              <div class="blog-post-card-tag-title-block">
                <span class="tag-list">
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/research">Research, </a>
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/team-axon">Team Axon</a>
                  
                </span>
                <h5> <a href="https://www.hunters.security/en/blog/protecting-postgres"> Protecting Postgres: Key Security Takeaways from a Postgres Honeypot </a> </h5>
              </div>
              <div class="blog-post-card-author-date-block">
                <span class="blog_post_author"> Team Axon </span>
                <span class="blog_post_date">Apr 10, 2024 </span>
                
              </div>
              <div class="blog-post-card-featured-image-block">
                <a href="https://www.hunters.security/en/blog/protecting-postgres">
                  <img src="https://www.hunters.security/hubfs/Featured%20images%20%289%29.png" alt="">
                </a>
              </div>
            </div>
          </div>  
        </div>
        
        
        
        
        <div>
          <div class="blog-post-card-item">
            <div class="blog-post-card-item-inner">
              <div class="blog-post-card-tag-title-block">
                <span class="tag-list">
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/research">Research, </a>
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/team-axon">Team Axon</a>
                  
                </span>
                <h5> <a href="https://www.hunters.security/en/blog/hunting-ransomware-in-onedrive"> Hunting Ransomware in OneDrive: Straightforward Tips for Unpredictable Threats </a> </h5>
              </div>
              <div class="blog-post-card-author-date-block">
                <span class="blog_post_author"> Team Axon </span>
                <span class="blog_post_date">Feb 19, 2024 </span>
                
              </div>
              <div class="blog-post-card-featured-image-block">
                <a href="https://www.hunters.security/en/blog/hunting-ransomware-in-onedrive">
                  <img src="https://www.hunters.security/hubfs/Featured%20images%20%287%29.png" alt="">
                </a>
              </div>
            </div>
          </div>  
        </div>
        
        
        
        
        <div>
          <div class="blog-post-card-item">
            <div class="blog-post-card-item-inner">
              <div class="blog-post-card-tag-title-block">
                <span class="tag-list">
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/research">Research, </a>
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/team-axon">Team Axon</a>
                  
                </span>
                <h5> <a href="https://www.hunters.security/en/blog/delefriend-a-newly-discovered-design-flaw-in-domain-wide-delegation-could-leave-google-workspace-vulnerable-for-takeover"> DeleFriend: Severe design flaw in Domain Wide Delegation could leave Google Workspace vulnerable for takeover </a> </h5>
              </div>
              <div class="blog-post-card-author-date-block">
                <span class="blog_post_author"> Team Axon </span>
                <span class="blog_post_date">Nov 28, 2023 </span>
                
              </div>
              <div class="blog-post-card-featured-image-block">
                <a href="https://www.hunters.security/en/blog/delefriend-a-newly-discovered-design-flaw-in-domain-wide-delegation-could-leave-google-workspace-vulnerable-for-takeover">
                  <img src="https://www.hunters.security/hubfs/Featured%20images%20%286%29.png" alt="">
                </a>
              </div>
            </div>
          </div>  
        </div>
        
        
        
        
        <div>
          <div class="blog-post-card-item">
            <div class="blog-post-card-item-inner">
              <div class="blog-post-card-tag-title-block">
                <span class="tag-list">
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/research">Research, </a>
                  
                  <a class="tag-list-link" href="https://www.hunters.security/en/blog/tag/team-axon">Team Axon</a>
                  
                </span>
                <h5> <a href="https://www.hunters.security/en/blog/human-friendly-guide-incident-response-microsoft-and-threat-hunting-azure-1"> The Human-Friendly Guide: Incident Response &amp; Threat Hunting in Microsoft Azure, Part 1 </a> </h5>
              </div>
              <div class="blog-post-card-author-date-block">
                <span class="blog_post_author"> Team Axon </span>
                <span class="blog_post_date">Oct 23, 2023 </span>
                
              </div>
              <div class="blog-post-card-featured-image-block">
                <a href="https://www.hunters.security/en/blog/human-friendly-guide-incident-response-microsoft-and-threat-hunting-azure-1">
                  <img src="https://www.hunters.security/hubfs/Featured%20images%20%285%29-2.png" alt="">
                </a>
              </div>
            </div>
          </div>  
        </div>
        
        
        
    
      
      
       



      

    </div>
  </div>
</div></div>
    </div>
  </div>
</main>
<script>
  $(function() {
    'use strict';
    /*Activate default tab contents*/
    var leftPos, newWidth, $magicLine;
    if($('.tabs').length > 0) {
      $('.tabs').append("<li id='magic-line'></li>");
      $magicLine = $('#magic-line');
      $magicLine.width($('.active').width())
        .css('left', $('.active a').position().left)
        .data('origLeft', $magicLine.position().left)
        .data('origWidth', $magicLine.width());

      $('.tabs li a').click(function() {
        var $this = $(this);
        $this.parent().addClass('active').siblings().removeClass('active');
        $magicLine
          .data('origLeft', $this.position().left)
          .data('origWidth', $this.parent().width());
        return false;
      });

      /*Magicline hover animation*/
      $('.tabs li').find('a').hover(function() {
        var $thisBar = $(this);
        leftPos = $thisBar.position().left;
        newWidth = $thisBar.parent().width();
        $magicLine.css({
          "left": leftPos,
          "width": newWidth
        });
      }, function() {
        $magicLine.css({
          "left": $magicLine.data('origLeft'),
          "width": $magicLine.data('origWidth')
        });
      });
    }
  });
  $( document ).ready(function() {
    $('.blog-post-right-body-content-block .blog-post__body table').wrap('<div class="table-wraper"></div>');
  });  



</script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882284593/1693291612618/Hunters_Theme_May_2023/js/magic-mouse.min.js"></script>
<!-- <script>
options = {
"cursorOuter": "circle-basic",
"hoverEffect": "circle-move",
"hoverItemMove": false,
"defaultCursor": false,
"outerWidth": 30,
"outerHeight": 30
};
magicMouse(options);

$(".blog-post-card-item").mouseover(function(){
$("#magicMouseCursor").addClass("change");
$("#magicPointer").addClass("change");
});
$(".blog-post-card-item").mouseleave(function(){
$("#magicMouseCursor").removeClass("change");
$("#magicPointer").removeClass("change");
});
</script> -->


      
      <div data-global-resource-path="Hunters_Theme_May_2023/templates/partials/footer.html"><footer class="footer footer--site-page new-footer">

  

  

  
  <div class="footer__container footer__container--static">

    
    <div class="footer__row footer__row--one">
      <div class="footer__navigation__container">
        
        <div class="footer__navigation footer__col_one">
          <div id="hs_cos_wrapper_footer_menu_header_one" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">



<span id="hs_cos_wrapper_footer_menu_header_one_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="header"><h6>PRODUCT</h6></span></div>
          <div id="hs_cos_wrapper_footer_menu_one" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_one_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_one_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/product" role="menuitem" target="_self">SOC Platform</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/product-tour" role="menuitem" target="_self">Product Tour</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/integrations" role="menuitem" target="_self">Integrations</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/why-hunters" role="menuitem" target="_self">Why Hunters</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/faqs" role="menuitem" target="_self">FAQs</a></li>
 </ul>
</div></span></div>
        </div>
        

        
        <div class="footer__navigation footer__col_two">
          <div id="hs_cos_wrapper_footer_menu_header_two" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">



<span id="hs_cos_wrapper_footer_menu_header_two_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="header"><h6>SOLUTIONS</h6></span></div>
          <div id="hs_cos_wrapper_footer_menu_two" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_two_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_two_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/solution/siem-replacement" role="menuitem" target="_self">SIEM Replacement</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/solution/hunters-for-snowflake-data-lake" role="menuitem" target="_self">Hunters for Snowflake</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/solution/hunters-for-databricks" role="menuitem" target="_self">Hunters For Databricks</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/solution/hunters-for-aws" role="menuitem" target="_self">Hunters for AWS</a></li>
 </ul>
</div></span></div>
        </div>
        

        
        <div class="footer__navigation footer__col_three footer__col_three">
          
          <div id="hs_cos_wrapper_footer_menu_header_three" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">



<span id="hs_cos_wrapper_footer_menu_header_three_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="header"><h6>SERVICES</h6></span></div>
          
          <div id="hs_cos_wrapper_footer_menu_three" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_three_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_three_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/team-axon" role="menuitem" target="_self">Team Axon</a></li>
 </ul>
</div></span></div>
        </div>
        

        
        <div class="footer__navigation footer__col_four footer__col_four-new">

          <div id="hs_cos_wrapper_footer_menu_four" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_four_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_four_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/customers" role="menuitem" target="_self">CUSTOMERS</a></li>
 </ul>
</div></span></div>
        </div>
        
        
        
        
                
           <div class="footer__navigation footer__col_mssp footer__col_mssp footer__col_four footer__col_four-new">
          
                 <div id="hs_cos_wrapper_footer_menu_mssp" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_mssp_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_mssp_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/mssp" role="menuitem" target="_self">MSSPs</a></li>
 </ul>
</div></span></div>
 
        </div>
        
        
        
        

        
        <div class="footer__navigation footer__col_five">
          <div id="hs_cos_wrapper_footer_menu_five" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_five_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_five_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/en/blog" role="menuitem" target="_self">BLOG</a></li>
 </ul>
</div></span></div>
          
        </div>
        
        
        
        <div class="footer__navigation footer__col_six">
          <div id="hs_cos_wrapper_footer_menu_header_six" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">



<span id="hs_cos_wrapper_footer_menu_header_six_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_header" style="" data-hs-cos-general-type="widget" data-hs-cos-type="header"><h6>COMPANY</h6></span></div>
          <div id="hs_cos_wrapper_footer_menu_six" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_footer_menu_six_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_simple_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="simple_menu"><div id="hs_menu_wrapper_footer_menu_six_" class="hs-menu-wrapper active-branch flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="" data-menu-id="" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/about-us" role="menuitem" target="_self">About Us</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/careers" role="menuitem" target="_self">Careers</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/partners" role="menuitem" target="_self">Partners</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/newsroom" role="menuitem" target="_self">Newsroom</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/events" role="menuitem" target="_self">Events</a></li>
  <li class="hs-menu-item hs-menu-depth-1" role="none"><a href="https://www.hunters.security/privacy-and-security" role="menuitem" target="_self">Privacy &amp; Security</a></li>
 </ul>
</div></span></div>
          <div id="hs_cos_wrapper_module_16830234841961" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<div class="footer-social-media-section">
  <ul>
    
    <li>
      
      
      <a href="https://www.linkedin.com/company/hunters-ai/" aria-label="Social Link" target="_blank" rel="noopener">
        <img src="https://www.hunters.security/hubfs/March2022/linkedin-icon.svg" alt="" loading="lazy" width="30" height="30">
      </a>
    </li>
    
    <li>
      
      
      <a href="https://www.youtube.com/channel/UCUufMdZ-6mS4dqEFI81IRKw" aria-label="Social Link" target="_blank" rel="noopener">
        <img src="https://www.hunters.security/hubfs/july2022/youtube-icon.svg" alt="" loading="lazy" width="30" height="30">
      </a>
    </li>
    
    <li>
      
      
      <a href="https://www.instagram.com/lifeathunters/" aria-label="Social Link" target="_blank" rel="noopener">
        <img src="https://www.hunters.security/hubfs/March2022/instagram-icon.svg" alt="" loading="lazy" width="30" height="30">
      </a>
    </li>
    
    <li>
      
      
      <a href="https://x.com/hunters_ai" aria-label="Social Link" target="_blank" rel="noopener">
        <img src="https://www.hunters.security/hubfs/March2022/twitter-icon.svg" alt="twitter-icon" loading="lazy" width="30" height="30">
      </a>
    </li>
    
  </ul>
</div>
</div>
        </div>
        

      </div>


    </div>
    

    
    <div class="footer__row footer__row--two">
      
      <div class="footer__copyright">
        <div id="hs_cos_wrapper_module_16462059846103" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-rich_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><span id="hs_cos_wrapper_module_16462059846103_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="rich_text"><p>HUNTERS © 2024 All rights reserved</p></span></div>
      </div>
      
      
      <div class="footer__bottom_links">
        <span id="hs_cos_wrapper_footer__bottom_links" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="widget" data-hs-cos-type="rich_text"><p><a href="https://www.hunters.security/terms-of-use?hsLang=en" rel="noopener">Terms and Conditions</a><a href="https://www.hunters.security/privacy-policy?hsLang=en" rel="noopener">Privacy Policy</a></p></span>
      </div>
      
    </div>
    

  </div>
  

  

</footer></div>
      
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
     
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
     
    
    
    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
    
    
    
     
    
       
   
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-sql.min.js"></script>
    

    

    
          
    
    <!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/114356373127/1693291620234/Hunters_Theme_May_2023/js/Owl-carousel.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/127662486200/1693291616579/Hunters_Theme_May_2023/js/js_plugins/magnific-popup.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/127662695006/1693291622639/Hunters_Theme_May_2023/js/js_plugins/mousewheel.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/127662486199/1693291612611/Hunters_Theme_May_2023/js/js_plugins/aos.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882575644/1693291613854/Hunters_Theme_May_2023/js/ScrollMagic.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882549514/1693291622778/Hunters_Theme_May_2023/js/debug.addIndicators.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/114370662982/1693291620440/Hunters_Theme_May_2023/js/easyResponsiveTabs.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882284039/1693291624252/Hunters_Theme_May_2023/js/slick.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882575404/1693291617490/Hunters_Theme_May_2023/js/jquery.matchHeight.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882549552/1693291622937/Hunters_Theme_May_2023/js/isotope.pkgd.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/127024241524/1727866885819/Hunters_Theme_May_2023/js/main.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/126882575241/1693291612623/Hunters_Theme_May_2023/js/custom_script.min.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/template_assets/176293618185/1724271074702/Hunters_Theme_May_2023/js/prism.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="/hs/hsstatic/keyboard-accessible-menu-flyouts/static-1.17/bundles/project.js"></script>
<script src="https://www.hunters.security/hs-fs/hub/5765386/hub_generated/module_assets/177021600416/1725602140089/module_177021600416_Blog_Table_of_Content_Sidebar.min.js"></script>
          
          
    
    <!-- Start of HubSpot Analytics Code -->
          
          
    
    <script type="text/javascript">
          
          
    
    var _hsq = _hsq || [];
          
          
    
    _hsq.push(["setContentType", "blog-post"]);
          
          
    
    _hsq.push(["setCanonicalUrl", "https:\/\/www.hunters.security\/en\/blog\/veildrive-microsoft-services-malware-c2"]);
          
          
    
    _hsq.push(["setPageId", "182226747037"]);
          
          
    
    _hsq.push(["setContentMetadata", {
          
          
    
    "contentPageId": 182226747037,
          
          
    
    "legacyPageId": "182226747037",
          
          
    
    "contentFolderId": null,
          
          
    
    "contentGroupId": 24463927651,
          
          
    
    "abTestId": null,
          
          
    
    "languageVariantId": 182226747037,
          
          
    
    "languageCode": "en",
          
          
    
    }]);
          
          
    
    </script>
          
          
          
          
    
    <!-- End of HubSpot Analytics Code -->
          
          
    
    <script type="text/javascript">
          
          
    
    var hsVars = {
          
          
    
    render_id: "4225cbbc-360f-43cb-b77d-6eee97d54cc5",
          
          
    
    ticks: 1731085378815,
          
          
    
    page_id: 182226747037,
          
          
    
    
          
          
    
    content_group_id: 24463927651,
          
          
    
    portal_id: 5765386,
          
          
    
    app_hs_base_url: "https://app.hubspot.com",
          
          
    
    cp_hs_base_url: "https://cp.hubspot.com",
          
          
    
    language: "en",
          
          
    
    analytics_page_type: "blog-post",
          
          
    
    scp_content_type: "",
          
          
    
    analytics_page_id: "182226747037",
          
          
    
    category_id: 3,
          
          
    
    folder_id: 0,
          
          
    
    is_hubspot_user: false
          
          
    
    }
          
          
    
    </script>
          
          
    
    
          
          
    
    <script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>
          
          
    
    <!-- zoominfo start -->
          
          
    
    <noscript>
          
          
    
    <img src="https://ws.zoominfo.com/pixel/VqKHtlHBiv3Lc8dabqWd" width="1" height="1" style="display: none;">
          
          
    
    </noscript>
          
          
    
    <!-- zoominfo stop -->
          
          
    
    <!-- cookiebot script
          
          
    
    <script type="text/javascript">
          
          
    
    var scrollPos = 100;
          
          
    
    var counter = 0;
          
          
    
    $(window).scroll(function(){
          
          
    
    var scrollPosCur = $(this).scrollTop();
          
          
    
    if (scrollPosCur > scrollPos && counter == 0) {
          
          
    
    var script = document.createElement('script');
          
          
    
    script.setAttribute('src', 'https://consent.cookiebot.com/uc.js');
          
          
    
    script.setAttribute('id', 'Cookiebot');
          
          
    
    script.setAttribute('type', 'text/javascript');
          
          
    
    script.setAttribute('data-cbid', 'ffebe3a6-627f-4df7-9ea2-5ea145fcb580');
          
          
    
    script.setAttribute('data-blockingmode', 'auto');
          
          
    
    document.getElementsByTagName('head')[0].appendChild(script);
          
          
    
    counter += 1;
          
          
    
    }
          
          
    
    //console.log("Scroll position = "+ scrollPosCur);
          
          
    
    })
          
          
    
    </script>
          
          
    
    -->
          
          
    
    <!-- end of cookiebot -->
          
          
    
    <!-- zoominfo start -->
          
          
    
    <script>
          
          
    
    (function () {
          
          
    
    var zi = document.createElement('script');
          
          
    
    zi.type = 'text/javascript';
          
          
    
    zi.async = true;
          
          
    
    zi.referrerPolicy = 'unsafe-url';
          
          
    
    zi.src = 'https://ws.zoominfo.com/pixel/VqKHtlHBiv3Lc8dabqWd';
          
          
    
    var s = document.getElementsByTagName('script')[0];
          
          
    
    s.parentNode.insertBefore(zi, s);
          
          
    
    })();
          
          
    
    </script>
          
          
    
    <!-- zoominfo stop -->
          
          
    
    <div id="fb-root"></div>
          
          
    
    <script>(function(d, s, id) {
          
          
    
    var js, fjs = d.getElementsByTagName(s)[0];
          
          
    
    if (d.getElementById(id)) return;
          
          
    
    js = d.createElement(s); js.id = id;
          
          
    
    js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
          
          
    
    fjs.parentNode.insertBefore(js, fjs);
          
          
    
    }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
          
    
  
</body></html>