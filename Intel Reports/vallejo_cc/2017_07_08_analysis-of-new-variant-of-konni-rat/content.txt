<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://www.vallejo.cc/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='http://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Vallejo.9090909090CC - Atom" href="https://www.vallejo.cc/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Vallejo.9090909090CC - RSS" href="https://www.vallejo.cc/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Vallejo.9090909090CC - Atom" href="https://www.blogger.com/feeds/7174982666252004806/posts/default" />

<link rel="alternate" type="application/atom+xml" title="Vallejo.9090909090CC - Atom" href="https://www.vallejo.cc/feeds/1470651475394948278/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s640/temp4+%25281%2529.jpg' rel='image_src'/>
<meta content='http://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html' property='og:url'/>
<meta content='Analysis of new variant of Konni RAT' property='og:title'/>
<meta content='These days TalosIntelligence commented about a new variant of Konni RAT . It is not a complicated malware, but it implements some interestin...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/w1200-h630-p-k-no-nu/temp4+%25281%2529.jpg' property='og:image'/>
<title>Vallejo.9090909090CC: Analysis of new variant of Konni RAT</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #303030;
background: #61608c none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #dd0700;
}
a:visited {
text-decoration:none;
color: #cc0000;
}
a:hover {
text-decoration:underline;
color: #cc0000;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #cccccc;
}
/* Header
----------------------------------------------- */
.header-outer {
background: #61608c none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #61608c;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #61608c;
}
.Header .description {
font-size: 140%;
color: #61608c;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #404040;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #404040;
border-left: 0 solid #404040;
border-right: 0 solid #404040;
}
.tabs-inner .widget ul {
background: #61608c none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #404040;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #cccccc;
border-left: 1px solid #cccccc;
border-right: 0 solid #404040;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #ffffff;
background-color: #303030;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #404040;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #404040;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #404040;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #ffffff;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: rgba(0, 0, 0, 0);
color: #cfcfcf;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 0;
background: #cccccc;
border: 1px solid #cccccc;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 1px;
}
.post-body .tr-caption-container {
color: #303030;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #888888;
background-color: #303030;
border-bottom: 1px solid #444444;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #404040;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #cccccc;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #303030;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #404040;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #cccccc;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #cccccc;
}
.mobile-index-contents {
color: #303030;
}
.mobile-link-button {
background-color: #dd0700;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #303030;
color: #ffffff;
border-top: 1px solid #404040;
border-bottom: 1px solid #404040;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #404040;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1030px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1030px;
max-width: 1030px;
_width: 1030px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 260px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 260px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("260px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 260px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 260px;
margin-right: -260px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7174982666252004806&amp;zx=5634c8a1-779d-400f-851a-115956d4683c' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=7174982666252004806&amp;zx=5634c8a1-779d-400f-851a-115956d4683c' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7246483392972123&host=ca-host-pub-1556223355139109" crossorigin="anonymous"></script>

<!-- data-ad-client=ca-pub-7246483392972123 -->

</head>
<body class='loading variant-dark'>
<div class='navbar no-items section' id='navbar' name='Navbar'>
</div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<a href='https://www.vallejo.cc/' style='display: block'>
<img alt='Vallejo.9090909090CC' height='367px; ' id='Header1_headerimg' src='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjFyu2vH4L-YHKtlEOGoNTVIm0UV-I64-cZGQetvBgYCcq8sZa2qA5__yemXqoLrUWWxgMT70wp-NQkbjzgR_DO4FNhLwJzLJVqqTzilbTe7cBFgIzkPm8QvBx7WA8gfTcTzob_grvoHq0/s1600/yo_y_suicidavirus.jpg' style='display: block' width='1009px; '/>
</a>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs section' id='crosscol' name='Cross-Column'><div class='widget PageList' data-version='1' id='PageList1'>
<h2>Pages</h2>
<div class='widget-content'>
<ul>
<li>
<a href='https://www.vallejo.cc/'>Home</a>
</li>
<li>
<a href='https://github.com/vallejocc'>Github</a>
</li>
<li>
<a href='https://twitter.com/vallejocc'>Twitter</a>
</li>
</ul>
<div class='clear'></div>
</div>
</div></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Saturday, July 8, 2017</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s640/temp4+%25281%2529.jpg' itemprop='image_url'/>
<meta content='7174982666252004806' itemprop='blogId'/>
<meta content='1470651475394948278' itemprop='postId'/>
<a name='1470651475394948278'></a>
<h3 class='post-title entry-title' itemprop='name'>
Analysis of new variant of Konni RAT
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-1470651475394948278' itemprop='description articleBody'>
These days TalosIntelligence commented about a <a href="http://blog.talosintelligence.com/2017/07/konni-references-north-korean-missile-capabilities.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+feedburner%2FTalos+%28Talos+Blog%29">new variant of Konni RAT</a>. It is not a complicated malware, but it implements some interesting tricks and functionality typical of RATs. I wanted to take a look at something different (there is more life after the ransomware &nbsp;) and in this post you can find a brief analysis of this RAT. I hope you enjoy it.<br />
<a name='more'></a><br />
Before startintg with the post, i would like to refer to you to the <a href="http://blog.talosintelligence.com/2017/05/konni-malware-under-radar-for-years.html">TalosIntelligence analysis of a previous variant of Konni.</a> New variant is similar to the variant analyzed in Talos post. However there are some different things. In addition i reversed different parts of the code, and i give other details. For this reason i recommend reading both posts if you are interesting in having a good knowledge about this RAT.<br />
<br />
<div>
<h2>
Modules</h2>
<br />
We have the sample <a href="https://www.hybrid-analysis.com/sample/33f828ad462c414b149f14f16615ce25bd078630eee36ad953950e0da2e2cc90?environmentId=100">f4abe28f3c35fa75481ae056d8637574</a>. It is a dropper that is able to drop different PE files depending on the architecture (32 / 64). If we unpack the dropper we can find it has two PE files and two DOCX files into resources:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s1600/temp4+%25281%2529.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="464" data-original-width="700" height="424" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s640/temp4+%25281%2529.jpg" width="640" /></a></div>
<br />
<br />
<br />
Docx file1: <a href="https://virustotal.com/es/file/63a43fe8874fbbf3adb1b9aeb03adb6bfaa2935a40bb1893e90e3ab762dd44bd/analysis/1499453050/">63a43fe8874fbbf3adb1b9aeb03adb6bfaa2935a40bb1893e90e3ab762dd44bd</a><br />
<br />
Docx file2: <a href="https://virustotal.com/es/file/a12db66cb7b7b991ac2ba736fb48e04566ffd2defdcb08fb9a8ab3781253f73c/analysis/1499453062/">a12db66cb7b7b991ac2ba736fb48e04566ffd2defdcb08fb9a8ab3781253f73c</a><br />
<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhthS8leoWI0SWH_En9r7Gh6TV0YHdUBqqMyW2WMMsxOItJahSiag-_Hq9I8s77StUpo45vrTo00vMjuQNLo7qOPT_pNlhUkQDFoq-gv9My54H9LMUNIuWSBgcgPnHFzU9niSTymGeWLiQ/s1600/temp5+%25281%2529.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="527" data-original-width="700" height="480" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhthS8leoWI0SWH_En9r7Gh6TV0YHdUBqqMyW2WMMsxOItJahSiag-_Hq9I8s77StUpo45vrTo00vMjuQNLo7qOPT_pNlhUkQDFoq-gv9My54H9LMUNIuWSBgcgPnHFzU9niSTymGeWLiQ/s640/temp5+%25281%2529.jpg" width="640" /></a></div>
<br />
<br />
PE file1: <a href="https://virustotal.com/es/file/290b1e2415f88fc3dd1d53db3ba90c4a760cf645526c8240af650751b1652b8a/analysis/">290b1e2415f88fc3dd1d53db3ba90c4a760cf645526c8240af650751b1652b8a</a><br />
<br />
PE file2: <a href="https://virustotal.com/es/file/8aef427aba54581f9c3dc923d8464a92b2d4e83cdf0fd6ace00e8035ee2936ad/analysis/">8aef427aba54581f9c3dc923d8464a92b2d4e83cdf0fd6ace00e8035ee2936ad</a><br />
<br />
PE files are packed with ASPack v2.12.<br />
<br />
We will analyze the 32 bit version.<br />
<br />
<br />
<h2>
RAT module</h2>
<br />
The 32 bits rat module is installed into this folder:<br />
<br />
<br />
C:\Users\&lt;user&gt;\AppData\Local\MFAData\event\errorevent.dll<br />
<br />
And the Run registry key is modified:<br />
<br />
<br />
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]<br />
&#8220;RTHDVCP&#8221;=&#8221;rundll32.exe C:\\Users\\javi\\AppData\\Local\\MFAData\\event\\errorevent.dll check&#8221;<br />
<br />
After removing the ASPack v2.12 layer, we take a look into the malware with IDA.<br />
<br />
The malware installs a windows hook and because of this, the errorevent.dll is loaded into machine&#8217;s running processes:<br />
<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjUx3QxOcsvH56j6ncDrV32gENEnNGucu13QVj3esD_23G_Fd_yl1IAhyP2lQrjiWKDI3RfM4iadL5ZKa1IgqvfRfVr4OA9le93bgeBTMc1XrzRvo-nUkDfV0R1kIaP_D4w0iaH6oqMbgE/s1600/temp6+%25281%2529.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="213" data-original-width="679" height="200" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjUx3QxOcsvH56j6ncDrV32gENEnNGucu13QVj3esD_23G_Fd_yl1IAhyP2lQrjiWKDI3RfM4iadL5ZKa1IgqvfRfVr4OA9le93bgeBTMc1XrzRvo-nUkDfV0R1kIaP_D4w0iaH6oqMbgE/s640/temp6+%25281%2529.jpg" width="640" /></a></div>
<br />
<br />
In the SetWindowsHookEx callback, it logs and queues keyboard events together with the window where they happened. Another thread analyzes the keyboard events, and it keeps to a file events happened in browser processes:<br />
<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvo05FkRitYri0GeFmH2gFI4B1vNVm4MPtzwJVnpNI5qDMAkT0iDybsN3akQfXVBr-pLGxfb6PYM97e5AGGN4raRhqxtwwcss0E-swiWh7I_iLDfajrRkAR7E6kr894oc8BtI2D3m3vQM/s1600/temp8+%25281%2529.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="467" data-original-width="665" height="448" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgvo05FkRitYri0GeFmH2gFI4B1vNVm4MPtzwJVnpNI5qDMAkT0iDybsN3akQfXVBr-pLGxfb6PYM97e5AGGN4raRhqxtwwcss0E-swiWh7I_iLDfajrRkAR7E6kr894oc8BtI2D3m3vQM/s640/temp8+%25281%2529.jpg" width="640" /></a></div>
<br />
<br />
It checks these processes names:<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsDx38JO1-q0si61_b5PfmAIj6gEfJ5WpENvGJae4L8gwHGUY5HskKGjm0JzlNNHQs4xXuQXg4VAlfFycKnbc1ez8r6ec58HwcX2fS54BakAlSBN1Y8xefcdamUd6iSnbcHsWc0IUhZLc/s1600/temp7+%25281%2529.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="76" data-original-width="700" height="68" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsDx38JO1-q0si61_b5PfmAIj6gEfJ5WpENvGJae4L8gwHGUY5HskKGjm0JzlNNHQs4xXuQXg4VAlfFycKnbc1ez8r6ec58HwcX2fS54BakAlSBN1Y8xefcdamUd6iSnbcHsWc0IUhZLc/s640/temp7+%25281%2529.jpg" width="640" /></a></div>
<br />
<br />
Interesting keyboard events are logged to the file:<br />
<br />
<br />
C:\Users\&lt;user&gt;\AppData\Local\Packages\microsoft\debug.tmp<br />
<br />
Other files are used by the RAT in the process of managing commands:<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiLwJL4xwtz0aTU_A74pNfyiqa7rkNK_YUtr73Q5m_WBsSCdzlII4ImYEmizMkfocOiN8hQa-7skYChu-o8gWZ8UmEq7iFMNJlvug51qAIWNaYWwOSGA5VO37yU6OICNiez8F1vpl07vFQ/s1600/a1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="355" data-original-width="677" height="334" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiLwJL4xwtz0aTU_A74pNfyiqa7rkNK_YUtr73Q5m_WBsSCdzlII4ImYEmizMkfocOiN8hQa-7skYChu-o8gWZ8UmEq7iFMNJlvug51qAIWNaYWwOSGA5VO37yU6OICNiez8F1vpl07vFQ/s640/a1.jpg" width="640" /></a></div>
<br />
<br />
Malware dll is injected into multiple processes. To monitor what malware files are created and written we can use this breakpoint with instructions (it is splitted in multiple lines for better reading):<br />
<br />
bp NtWriteFile  -&gt; when NtWriteFile hit, execute the next script<br />
&#8220;.foreach (tok { !handle (poi (esp+4)) }) -&gt; search &#8220;Packages&#8221; in the path<br />
{<br />
.if ($spat(\&#8221;${tok}\&#8221;, \&#8221;*Packages*\&#8221;) != 0)<br />
{<br />
da (poi (esp+18));.break; -&gt; if found, print the data written<br />
}<br />
};g;&#8221;<br />
<br />
<br />
<br />
bp NtWriteFile &#8220;.foreach (tok { !handle (poi (esp+4)) }) { .if ($spat(\&#8221;${tok}\&#8221;, \&#8221;*Packages*\&#8221;) != 0) { da (poi (esp+18));.break;}};g;&#8221;<br />
<br />
The other RAT functionality is executed under demand, as we will see it in the next section about communications.<br />
<br />
<br />
<h2>
Communications</h2>
<br />
The malware executes a thread for communications with the CnC. It asks for commands each 15 minutes. A file with commands is downloaded and parsed, and the commands are executed (and the results uploaded to the CnC):<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiGHsxovf1sVSEHtF_vP_J6sUIh9WGK_kuUZFK5WQbfanUM0Na_d3GYaKYurroyz8MpdYDGpLjOZ_X6yVSflen372j1tslD-HQ9hflo5_O3f18KNAI-oKIJzue_pwXPz3YHK3RfTJpcOWg/s1600/a.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="431" data-original-width="700" height="394" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiGHsxovf1sVSEHtF_vP_J6sUIh9WGK_kuUZFK5WQbfanUM0Na_d3GYaKYurroyz8MpdYDGpLjOZ_X6yVSflen372j1tslD-HQ9hflo5_O3f18KNAI-oKIJzue_pwXPz3YHK3RfTJpcOWg/s640/a.jpg" width="640" /></a></div>
<br />
<br />
The RAT calculates a value based on the installation time and infected computer info, and that value is used as bot_id to identify the current infected machine. In my case it generated CB5D234D.<br />
<br />
To download the commands it connects by http GET to:<br />
<br />
<br />
<a href="http://member-daumchk.netai.net/weget/download.php?file=CB5D234D_dropcom">http://member-daumchk.netai.net/weget/download.php?file=CB5D234D_dropcom</a><br />
<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0bCKximF-112wVhU2m4YP4467Y5ay0OHc5uliqL6eHD7I92zg8AgK4pW2yMqk5LOVL2u6tpuhspz9VG7YorNDNi0jQY3cS35Y7UB_-6dSH4IkQnryi7l-YM9d9sMtpWc4ji7tWGR1dTQ/s1600/a8.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="42" data-original-width="383" height="43" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj0bCKximF-112wVhU2m4YP4467Y5ay0OHc5uliqL6eHD7I92zg8AgK4pW2yMqk5LOVL2u6tpuhspz9VG7YorNDNi0jQY3cS35Y7UB_-6dSH4IkQnryi7l-YM9d9sMtpWc4ji7tWGR1dTQ/s400/a8.jpg" width="400" /></a></div>
<br />
<br />
It is:<br />
<br />
<a href="http://%3Cdomain%3E/weget/download.php?file=%3Cbodid%3E_dropcom">http://&lt;domain&gt;/weget/download.php?file=&lt;bodid&gt;_dropcom</a><br />
<br />
This new variant uses wininet api to connect CnC (Talos analysis about the previous variant says the RAT was using winsock api connect, send, recv,&#8230; instead of http specified api):<br />
<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBlIfSMG7c5RRZ3rdwjS_Zmc5vVf3qhZ3NK2fVp8lZdl_BOLScMw5ii08OGM2l05Uo4ArZz4fGn6JQH0HJStah_I6rBTFNApZL5uFU7GQgeO-SvcrvSOUVO99PvAhyphenhyphenqdbzaUC_KI5c14w/s1600/a9.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="738" data-original-width="519" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgBlIfSMG7c5RRZ3rdwjS_Zmc5vVf3qhZ3NK2fVp8lZdl_BOLScMw5ii08OGM2l05Uo4ArZz4fGn6JQH0HJStah_I6rBTFNApZL5uFU7GQgeO-SvcrvSOUVO99PvAhyphenhyphenqdbzaUC_KI5c14w/s640/a9.jpg" width="450" /></a></div>
<br />
<br />
After downloading the commands  they are decrypted (key &#8220;xzxzxz&#8221;) and parsed:<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgpeE43S-RTmVyV8TJ6xBb3AN_AVc61ZKCehS9FKDniz3nwW0tAvZSUwSsxsfjyviOjJTx0Q1cSKdSpSoMeQrw0ydoQeKMWa9n5W4_SrnM51ThJbrfp8D4n1wjocL2BiP2ayOQTsx1jIVU/s1600/a2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="348" data-original-width="342" height="320" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgpeE43S-RTmVyV8TJ6xBb3AN_AVc61ZKCehS9FKDniz3nwW0tAvZSUwSsxsfjyviOjJTx0Q1cSKdSpSoMeQrw0ydoQeKMWa9n5W4_SrnM51ThJbrfp8D4n1wjocL2BiP2ayOQTsx1jIVU/s320/a2.jpg" width="314" /></a></div>
<br />
<br />
The decryption function:<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEig7tQiKI2FnN8hXkZr8FGDyerahO8VBID-7iYgjpJ5Elzrw5SBDT2mYfw4XTy4Ac0vdUW6iireXoe7qlyO2sakzSf2uPc8f7mGPtmHgSRL8z0l94sUQbWWsDfiCTj_vc1rDUT3L7NCzkU/s1600/a7.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="506" data-original-width="700" height="460" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEig7tQiKI2FnN8hXkZr8FGDyerahO8VBID-7iYgjpJ5Elzrw5SBDT2mYfw4XTy4Ac0vdUW6iireXoe7qlyO2sakzSf2uPc8f7mGPtmHgSRL8z0l94sUQbWWsDfiCTj_vc1rDUT3L7NCzkU/s640/a7.jpg" width="640" /></a></div>
<br />
<br />
<br />
<br />
Seeing the communications code, it seems it would be not difficult to create a fake CnC to control a bot (not RSA keys or something like that are used to certify the command comes from the author).<br />
<br />
Once decrypted it starts to parse commands:<br />
<br />
<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQObqnmB9_1O-IgFXLGgLTsPmcbGYTTtO35hC9ZSZM4jsYOmQRYIuU14d_Pvzin1mvJwx3Hr5IbX-NZcdFlV0w0OqO0rXh59HyjUeYJCVmPwRSSGlB7KQOQNUlt6Ikv4JuTyGwg8Vi1Jk/s1600/a3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="159" data-original-width="700" height="144" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQObqnmB9_1O-IgFXLGgLTsPmcbGYTTtO35hC9ZSZM4jsYOmQRYIuU14d_Pvzin1mvJwx3Hr5IbX-NZcdFlV0w0OqO0rXh59HyjUeYJCVmPwRSSGlB7KQOQNUlt6Ikv4JuTyGwg8Vi1Jk/s640/a3.jpg" width="640" /></a></div>
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgClxtxUVbWWaVFlsCegTkhyphenhyphenlxtqNdN0lxGwRUsZtgxS9dJ6fv6N17aCYCprB-t2WGg_SS0suYGRHZCKPPzc_73Kk-oUK-UeoAMJayI0J5fvnWdg_O4dqN1zoNi_I3Mh04Zv0Whmyf37x0/s1600/a5.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="340" data-original-width="700" height="308" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgClxtxUVbWWaVFlsCegTkhyphenhyphenlxtqNdN0lxGwRUsZtgxS9dJ6fv6N17aCYCprB-t2WGg_SS0suYGRHZCKPPzc_73Kk-oUK-UeoAMJayI0J5fvnWdg_O4dqN1zoNi_I3Mh04Zv0Whmyf37x0/s640/a5.jpg" width="640" /></a></div>
<br />
<br />
<h2>
Command for collecting computer info</h2>
<br />
With this command the malware collects different information about the machine:<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgl7ob2Iw725MSMjPQSjT_IGT5F4rb23-yK9Cru-xDmgIL0rkWfmTwSf0v0b-lqXeSBB_NFCtzpDG6VxMrSK1JThtIT9w7a2jj71ZYF0JuvWXT9CczCtbwbMHsAI9TfVGVrYqcO-TzbE9Y/s1600/a4.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1035" data-original-width="620" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgl7ob2Iw725MSMjPQSjT_IGT5F4rb23-yK9Cru-xDmgIL0rkWfmTwSf0v0b-lqXeSBB_NFCtzpDG6VxMrSK1JThtIT9w7a2jj71ZYF0JuvWXT9CczCtbwbMHsAI9TfVGVrYqcO-TzbE9Y/s640/a4.jpg" width="382" /></a></div>
<br />
<br />
<br />
<h2>
Command for screen capturing</h2>
<br />
Capture of the screen it is done here:<br />
<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBF1xnNc33vcMeiI1XufkDUamRS4pcNqbitiWyS8VT5s-Uw1E9LNcZUNAhIyOZKKzP7JG2UqeZ-SSdZZfgyY90daznSHeBS6CH4mh2zDxl7-5vt8uk-DzPoWyRufH0ds3o4Y-ae7hhq7Q/s1600/a6.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="864" data-original-width="318" height="640" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiBF1xnNc33vcMeiI1XufkDUamRS4pcNqbitiWyS8VT5s-Uw1E9LNcZUNAhIyOZKKzP7JG2UqeZ-SSdZZfgyY90daznSHeBS6CH4mh2zDxl7-5vt8uk-DzPoWyRufH0ds3o4Y-ae7hhq7Q/s640/a6.jpg" width="234" /></a></div>
<br />
<br />
<h2>
References</h2>
<div>
<br /></div>
<ul>
<li><a href="http://blog.talosintelligence.com/2017/07/konni-references-north-korean-missile-capabilities.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+feedburner%2FTalos+(Talos+Blog)">New KONNI Campaign References North Korean Missile Capabilities</a></li>
<li><a href="http://blog.talosintelligence.com/2017/05/konni-malware-under-radar-for-years.html">KONNI: A Malware Under The Radar For Years</a></li>
<li><a href="https://otx.alienvault.com/pulse/595f5bdd6a52154a2872219f/">https://otx.alienvault.com/pulse/595f5bdd6a52154a2872219f/</a></li>
</ul>
</div>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/06290548883920195912' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/06290548883920195912' rel='author' title='author profile'>
<span itemprop='name'>vallejocc</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='http://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html' itemprop='url'/>
<a class='timestamp-link' href='https://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2017-07-08T13:02:00-07:00'>1:02&#8239;PM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-1398799567'>
<a href='https://www.blogger.com/post-edit.g?blogID=7174982666252004806&postID=1470651475394948278&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=7174982666252004806&postID=1470651475394948278&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=7174982666252004806&postID=1470651475394948278&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=7174982666252004806&postID=1470651475394948278&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=7174982666252004806&postID=1470651475394948278&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=7174982666252004806&postID=1470651475394948278&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://www.vallejo.cc/search/label/analysis' rel='tag'>analysis</a>,
<a href='https://www.vallejo.cc/search/label/CnC' rel='tag'>CnC</a>,
<a href='https://www.vallejo.cc/search/label/konni' rel='tag'>konni</a>,
<a href='https://www.vallejo.cc/search/label/malware' rel='tag'>malware</a>,
<a href='https://www.vallejo.cc/search/label/protocol' rel='tag'>protocol</a>,
<a href='https://www.vallejo.cc/search/label/rat' rel='tag'>rat</a>,
<a href='https://www.vallejo.cc/search/label/reverse%20engineering' rel='tag'>reverse engineering</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<a href='https://www.blogger.com/comment/frame/7174982666252004806?po=1470651475394948278&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/681870030-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://www.vallejo.cc/2018/05/analysis-of-poseidon-downloader-and.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://www.vallejo.cc/2017/07/copy-and-execute-file-to-remote-machine.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://www.vallejo.cc/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://www.vallejo.cc/feeds/1470651475394948278/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogSearch' data-version='1' id='BlogSearch1'>
<h2 class='title'>Search This Blog</h2>
<div class='widget-content'>
<div id='BlogSearch1_form'>
<form action='https://www.vallejo.cc/search' class='gsc-search-box' target='_top'>
<table cellpadding='0' cellspacing='0' class='gsc-search-box'>
<tbody>
<tr>
<td class='gsc-input'>
<input autocomplete='off' class='gsc-input' name='q' size='10' title='search' type='text' value=''/>
</td>
<td class='gsc-search-button'>
<input class='gsc-search-button' title='search' type='submit' value='Search'/>
</td>
</tr>
</tbody>
</table>
</form>
</div>
</div>
<div class='clear'></div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<select id='BlogArchive1_ArchiveMenu'>
<option value=''>Blog Archive</option>
<option value='https://www.vallejo.cc/2019_05_26_archive.html'>26/05/19 (1)</option>
<option value='https://www.vallejo.cc/2018_09_16_archive.html'>16/09/18 (1)</option>
<option value='https://www.vallejo.cc/2018_04_29_archive.html'>29/04/18 (1)</option>
<option value='https://www.vallejo.cc/2017_11_12_archive.html'>12/11/17 (1)</option>
<option value='https://www.vallejo.cc/2017_11_05_archive.html'>05/11/17 (1)</option>
<option value='https://www.vallejo.cc/2017_08_27_archive.html'>27/08/17 (1)</option>
<option value='https://www.vallejo.cc/2017_08_13_archive.html'>13/08/17 (1)</option>
<option value='https://www.vallejo.cc/2017_07_16_archive.html'>16/07/17 (1)</option>
<option value='https://www.vallejo.cc/2017_07_09_archive.html'>09/07/17 (1)</option>
<option value='https://www.vallejo.cc/2017_07_02_archive.html'>02/07/17 (2)</option>
<option value='https://www.vallejo.cc/2017_06_25_archive.html'>25/06/17 (1)</option>
<option value='https://www.vallejo.cc/2017_06_18_archive.html'>18/06/17 (2)</option>
<option value='https://www.vallejo.cc/2017_05_28_archive.html'>28/05/17 (1)</option>
<option value='https://www.vallejo.cc/2015_09_27_archive.html'>27/09/15 (1)</option>
<option value='https://www.vallejo.cc/2015_08_23_archive.html'>23/08/15 (1)</option>
<option value='https://www.vallejo.cc/2015_08_16_archive.html'>16/08/15 (1)</option>
<option value='https://www.vallejo.cc/2015_07_12_archive.html'>12/07/15 (1)</option>
<option value='https://www.vallejo.cc/2015_06_07_archive.html'>07/06/15 (1)</option>
<option value='https://www.vallejo.cc/2015_05_10_archive.html'>10/05/15 (1)</option>
<option value='https://www.vallejo.cc/2015_04_19_archive.html'>19/04/15 (1)</option>
<option value='https://www.vallejo.cc/2015_04_05_archive.html'>05/04/15 (1)</option>
<option value='https://www.vallejo.cc/2015_03_22_archive.html'>22/03/15 (1)</option>
<option value='https://www.vallejo.cc/2015_03_08_archive.html'>08/03/15 (3)</option>
</select>
</div>
</div>
<div class='clear'></div>
</div>
</div><div class='widget Followers' data-version='1' id='Followers1'>
<h2 class='title'>Followers</h2>
<div class='widget-content'>
<div id='Followers1-wrapper'>
<div style='margin-right:2px;'>
<div><script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<div id="followers-iframe-container"></div>
<script type="text/javascript">
    window.followersIframe = null;
    function followersIframeOpen(url) {
      gapi.load("gapi.iframes", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          window.followersIframe = gapi.iframes.getContext().openChild({
            url: url,
            where: document.getElementById("followers-iframe-container"),
            messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
            messageHandlers: {
              '_ready': function(obj) {
                window.followersIframe.getIframeEl().height = obj.height;
              },
              'reset': function() {
                window.followersIframe.close();
                followersIframeOpen("https://www.blogger.com/followers/frame/7174982666252004806?colors\x3dCgt0cmFuc3BhcmVudBILdHJhbnNwYXJlbnQaByMzMDMwMzAiByNkZDA3MDAqByNjY2NjY2MyByNmZmZmZmY6ByMzMDMwMzBCByNkZDA3MDBKByM5OTk5OTlSByNkZDA3MDBaC3RyYW5zcGFyZW50\x26pageSize\x3d21\x26hl\x3den\x26origin\x3dhttps://www.vallejo.cc");
              },
              'open': function(url) {
                window.followersIframe.close();
                followersIframeOpen(url);
              }
            }
          });
        }
      });
    }
    followersIframeOpen("https://www.blogger.com/followers/frame/7174982666252004806?colors\x3dCgt0cmFuc3BhcmVudBILdHJhbnNwYXJlbnQaByMzMDMwMzAiByNkZDA3MDAqByNjY2NjY2MyByNmZmZmZmY6ByMzMDMwMzBCByNkZDA3MDBKByM5OTk5OTlSByNkZDA3MDBaC3RyYW5zcGFyZW50\x26pageSize\x3d21\x26hl\x3den\x26origin\x3dhttps://www.vallejo.cc");
  </script></div>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Simple theme. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/1354223504-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY4GXF4CJYpqHzif6FPL50AgW27u_Q:1742187133308';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d7174982666252004806','//www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html','7174982666252004806');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '7174982666252004806', 'title': 'Vallejo.9090909090CC', 'url': 'https://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html', 'canonicalUrl': 'http://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html', 'homepageUrl': 'https://www.vallejo.cc/', 'searchUrl': 'https://www.vallejo.cc/search', 'canonicalHomepageUrl': 'http://www.vallejo.cc/', 'blogspotFaviconUrl': 'https://www.vallejo.cc/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Vallejo.9090909090CC - Atom\x22 href\x3d\x22https://www.vallejo.cc/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Vallejo.9090909090CC - RSS\x22 href\x3d\x22https://www.vallejo.cc/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Vallejo.9090909090CC - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/7174982666252004806/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Vallejo.9090909090CC - Atom\x22 href\x3d\x22https://www.vallejo.cc/feeds/1470651475394948278/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseClientId': 'ca-pub-7246483392972123', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': true, 'adsenseAutoAds': true, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/7cb7ae7e917ed807', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '1470651475394948278', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s72-c/temp4+%25281%2529.jpg', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s640/temp4+%25281%2529.jpg', 'pageName': 'Analysis of new variant of Konni RAT', 'pageTitle': 'Vallejo.9090909090CC: Analysis of new variant of Konni RAT'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'dark', 'variantId': 'dark'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Analysis of new variant of Konni RAT', 'description': 'These days TalosIntelligence commented about a new variant of Konni RAT . It is not a complicated malware, but it implements some interestin...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEguk-TlJwvs_EEfTLg4D2WMsQzNarXg_rCOWhIJTVA8y1fP5o7d6t3Lke3KUN9YPd36HRcHgX654oOoHVt74-Z7Zuhflva34TmU-bw2-kj9XfNCgvC5JhowsvLdbxTe85UUTMV_sioz5xA/s640/temp4+%25281%2529.jpg', 'url': 'https://www.vallejo.cc/2017/07/analysis-of-new-variant-of-konni-rat.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 1470651475394948278}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_PageListView', new _WidgetInfo('PageList1', 'crosscol', document.getElementById('PageList1'), {'title': 'Pages', 'links': [{'isCurrentPage': false, 'href': 'https://www.vallejo.cc/', 'title': 'Home'}, {'isCurrentPage': false, 'href': 'https://github.com/vallejocc', 'title': 'Github'}, {'isCurrentPage': false, 'href': 'https://twitter.com/vallejocc', 'title': 'Twitter'}], 'mobile': false, 'showPlaceholder': true, 'hasCurrentPage': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3736347198-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogSearchView', new _WidgetInfo('BlogSearch1', 'sidebar-right-1', document.getElementById('BlogSearch1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_FollowersView', new _WidgetInfo('Followers1', 'sidebar-right-1', document.getElementById('Followers1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>