<!doctype html>
<html lang="ko">

                                                                                <head>
                <script type="text/javascript">if (!window.T) { window.T = {} }
window.T.config = {"TOP_SSL_URL":"https://www.tistory.com","PREVIEW":false,"ROLE":"guest","PREV_PAGE":"","NEXT_PAGE":"","BLOG":{"id":1780531,"name":"suspected","title":"1q","isDormancy":false,"nickName":"1q","status":"open","profileStatus":"normal"},"NEED_COMMENT_LOGIN":true,"COMMENT_LOGIN_CONFIRM_MESSAGE":"이 블로그는 로그인한 사용자에게만 댓글 작성을 허용했습니다. 지금 로그인하시겠습니까?","LOGIN_URL":"https://www.tistory.com/auth/login/?redirectUrl=https://suspected.tistory.com/269","DEFAULT_URL":"https://suspected.tistory.com","USER":{"name":null,"homepage":null,"id":0,"profileImage":null},"SUBSCRIPTION":{"status":"none","isConnected":false,"isPending":false,"isWait":false,"isProcessing":false,"isNone":true},"IS_LOGIN":false,"HAS_BLOG":false,"IS_SUPPORT":false,"IS_SCRAPABLE":false,"TOP_URL":"http://www.tistory.com","JOIN_URL":"https://www.tistory.com/member/join","PHASE":"prod","ROLE_GROUP":"visitor"};
window.T.entryInfo = {"entryId":269,"isAuthor":false,"categoryId":642441,"categoryLabel":"리버싱/윈도우 악성코드 분석"};
window.appInfo = {"domain":"tistory.com","topUrl":"https://www.tistory.com","loginUrl":"https://www.tistory.com/auth/login","logoutUrl":"https://www.tistory.com/auth/logout"};
window.initData = {};

window.TistoryBlog = {
    basePath: "",
    url: "https://suspected.tistory.com",
    tistoryUrl: "https://suspected.tistory.com",
    manageUrl: "https://suspected.tistory.com/manage",
    token: "i9Cb3PQrY/0LRgePNc3bnh5apZ0Hm1QcROYLu/pd6tqkELAqyc9nfjT3iG2hHW/T"
};
var servicePath = "";
var blogURL = "";</script>

                
                
                
                        <!-- BusinessLicenseInfo - START -->
        
            <link href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/plugin/BusinessLicenseInfo/style.css" rel="stylesheet" type="text/css"/>

            <script>function switchFold(entryId) {
    var businessLayer = document.getElementById("businessInfoLayer_" + entryId);

    if (businessLayer) {
        if (businessLayer.className.indexOf("unfold_license") > 0) {
            businessLayer.className = "business_license_layer";
        } else {
            businessLayer.className = "business_license_layer unfold_license";
        }
    }
}
</script>

        
        <!-- BusinessLicenseInfo - END -->
        <!-- DaumShow - START -->
        <style type="text/css">#daumSearchBox {
    height: 21px;
    background-image: url(//i1.daumcdn.net/imgsrc.search/search_all/show/tistory/plugin/bg_search2_2.gif);
    margin: 5px auto;
    padding: 0;
}

#daumSearchBox input {
    background: none;
    margin: 0;
    padding: 0;
    border: 0;
}

#daumSearchBox #daumLogo {
    width: 34px;
    height: 21px;
    float: left;
    margin-right: 5px;
    background-image: url(//i1.daumcdn.net/img-media/tistory/img/bg_search1_2_2010ci.gif);
}

#daumSearchBox #show_q {
    background-color: transparent;
    border: none;
    font: 12px Gulim, Sans-serif;
    color: #555;
    margin-top: 4px;
    margin-right: 15px;
    float: left;
}

#daumSearchBox #show_btn {
    background-image: url(//i1.daumcdn.net/imgsrc.search/search_all/show/tistory/plugin/bt_search_2.gif);
    width: 37px;
    height: 21px;
    float: left;
    margin: 0;
    cursor: pointer;
    text-indent: -1000em;
}
</style>

        <!-- DaumShow - END -->

<!-- PreventCopyContents - START -->
<meta content="no" http-equiv="imagetoolbar"/>

<!-- PreventCopyContents - END -->

<!-- System - START -->

<!-- System - END -->

        <!-- TistoryProfileLayer - START -->
        <link href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/plugin/TistoryProfileLayer/style.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/plugin/TistoryProfileLayer/script.js"></script>

        <!-- TistoryProfileLayer - END -->

                
                <meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="format-detection" content="telephone=no">
<script src="//t1.daumcdn.net/tistory_admin/lib/jquery/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script type="text/javascript" src="//t1.daumcdn.net/tiara/js/v1/tiara.min.js"></script><meta name="referrer" content="always"/>
<meta name="google-adsense-platform-account" content="ca-host-pub-9691043933427338"/>
<meta name="google-adsense-platform-domain" content="tistory.com"/>
<meta name="description" content="[개요] [1] ASEC 분석팀은 &quot;전라남도 코로나바이러스 대응 긴급 조회.hwp&quot;로 위장한 악성 문서파일을 발견하고 패치했다. 해당 정보를 확인하고 [2] 무료 샌드박스 서비스(any.run)에서 파일을 다운로드 받아 분석을 수행하기로 했다. 해당 악성 문서파일(HWP)은 코로나19 관련 내용으로 정부기관으로 위장하여 유포한 파일이다. CVE-2017-8291 취약점을 이용해 만들어졌으며, Powershell을 이용해 C2 서버에 접근해 2차 유포 파일(EXE)을 다운로드 받은 뒤, 정보유출형 백도어 역할을 수행한다. 현재는 C2가 단절되어 Powershell에서 C2 서버에 접근하지 못하지만, 서버가 다시 살아날 수 있을 가능성도 있기에 주의가 필요하다. ※ 본 게시물에는 단계별로 한글 문서, 쉘코드.."/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="https://suspected.tistory.com/269"/>
<meta property="og.article.author" content="1q"/>
<meta property="og:site_name" content="1q"/>
<meta property="og:title" content="악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)"/>
<meta name="by" content="1q"/>
<meta property="og:description" content="[개요] [1] ASEC 분석팀은 &quot;전라남도 코로나바이러스 대응 긴급 조회.hwp&quot;로 위장한 악성 문서파일을 발견하고 패치했다. 해당 정보를 확인하고 [2] 무료 샌드박스 서비스(any.run)에서 파일을 다운로드 받아 분석을 수행하기로 했다. 해당 악성 문서파일(HWP)은 코로나19 관련 내용으로 정부기관으로 위장하여 유포한 파일이다. CVE-2017-8291 취약점을 이용해 만들어졌으며, Powershell을 이용해 C2 서버에 접근해 2차 유포 파일(EXE)을 다운로드 받은 뒤, 정보유출형 백도어 역할을 수행한다. 현재는 C2가 단절되어 Powershell에서 C2 서버에 접근하지 못하지만, 서버가 다시 살아날 수 있을 가능성도 있기에 주의가 필요하다. ※ 본 게시물에는 단계별로 한글 문서, 쉘코드.."/>
<meta property="og:image" content="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F991D28425E8DF2C501"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:site" content="@TISTORY"/>
<meta name="twitter:title" content="악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)"/>
<meta name="twitter:description" content="[개요] [1] ASEC 분석팀은 &quot;전라남도 코로나바이러스 대응 긴급 조회.hwp&quot;로 위장한 악성 문서파일을 발견하고 패치했다. 해당 정보를 확인하고 [2] 무료 샌드박스 서비스(any.run)에서 파일을 다운로드 받아 분석을 수행하기로 했다. 해당 악성 문서파일(HWP)은 코로나19 관련 내용으로 정부기관으로 위장하여 유포한 파일이다. CVE-2017-8291 취약점을 이용해 만들어졌으며, Powershell을 이용해 C2 서버에 접근해 2차 유포 파일(EXE)을 다운로드 받은 뒤, 정보유출형 백도어 역할을 수행한다. 현재는 C2가 단절되어 Powershell에서 C2 서버에 접근하지 못하지만, 서버가 다시 살아날 수 있을 가능성도 있기에 주의가 필요하다. ※ 본 게시물에는 단계별로 한글 문서, 쉘코드.."/>
<meta property="twitter:image" content="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F991D28425E8DF2C501"/>
<meta content="https://suspected.tistory.com/269" property="dg:plink" content="https://suspected.tistory.com/269"/>
<meta name="plink"/>
<meta name="title" content="악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)"/>
<meta name="article:media_name" content="1q"/>
<meta property="article:mobile_url" content="https://suspected.tistory.com/m/269"/>
<meta property="article:pc_url" content="https://suspected.tistory.com/269"/>
<meta property="article:mobile_view_url" content="https://suspected.tistory.com/m/269"/>
<meta property="article:pc_view_url" content="https://suspected.tistory.com/269"/>
<meta property="article:talk_channel_view_url" content="https://suspected.tistory.com/m/269"/>
<meta property="article:pc_service_home" content="https://www.tistory.com"/>
<meta property="article:mobile_service_home" content="https://www.tistory.com/m"/>
<meta property="article:txid" content="1780531_269"/>
<meta property="article:published_time" content="2020-04-09T00:50:54+09:00"/>
<meta property="og:regDate" content="20200409125054"/>
<meta property="article:modified_time" content="2020-04-09T17:51:19+09:00"/>
<script type="module" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/pc/dist/index.js" defer=""></script>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/pc/dist/index-legacy.js" defer="" nomodule="true"></script>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/pc/dist/polyfills-legacy.js" defer="" nomodule="true"></script>
<link rel="icon" sizes="any" href="https://t1.daumcdn.net/tistory_admin/favicon/tistory_favicon_32x32.ico"/>
<link rel="icon" type="image/svg+xml" href="https://t1.daumcdn.net/tistory_admin/top_v2/bi-tistory-favicon.svg"/>
<link rel="apple-touch-icon" href="https://t1.daumcdn.net/tistory_admin/top_v2/tistory-apple-touch-favicon.png"/>
<link rel="stylesheet" type="text/css" href="https://t1.daumcdn.net/tistory_admin/www/style/font.css"/>
<link rel="stylesheet" type="text/css" href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/style/content.css"/>
<link rel="stylesheet" type="text/css" href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/pc/dist/index.css"/>
<script type="text/javascript">(function() {
    var tjQuery = jQuery.noConflict(true);
    window.tjQuery = tjQuery;
    window.orgjQuery = window.jQuery; window.jQuery = tjQuery;
    window.jQuery = window.orgjQuery; delete window.orgjQuery;
})()</script>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/script/base.js"></script>
<script type="text/javascript" src="//developers.kakao.com/sdk/js/kakao.min.js"></script>

                
	<meta charset="UTF-8">
	<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width">
	<title>악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)</title>
	<link rel="alternate" type="application/rss+xml" title="1q" href="https://suspected.tistory.com/rss" />

	<link rel="stylesheet" href="https://tistory1.daumcdn.net/tistory/1780531/skin/style.css?_version_=1631100429">
	<link rel="stylesheet" href="https://tistory1.daumcdn.net/tistory/1780531/skin/images/font.css?_version_=1631100429">

	<!--[if lt IE 9]>
	<script src="//t1.daumcdn.net/tistory_admin/lib/jquery/jquery-1.12.4.min.js"></script>
	<![endif]-->
	<!--[if gte IE 9]><!-->
	<script src="//t1.daumcdn.net/tistory_admin/lib/jquery/jquery-3.2.1.min.js"></script>
	<!--<![endif]-->

                
                
                <style type="text/css">.another_category {
    border: 1px solid #E5E5E5;
    padding: 10px 10px 5px;
    margin: 10px 0;
    clear: both;
}

.another_category h4 {
    font-size: 12px !important;
    margin: 0 !important;
    border-bottom: 1px solid #E5E5E5 !important;
    padding: 2px 0 6px !important;
}

.another_category h4 a {
    font-weight: bold !important;
}

.another_category table {
    table-layout: fixed;
    border-collapse: collapse;
    width: 100% !important;
    margin-top: 10px !important;
}

* html .another_category table {
    width: auto !important;
}

*:first-child + html .another_category table {
    width: auto !important;
}

.another_category th, .another_category td {
    padding: 0 0 4px !important;
}

.another_category th {
    text-align: left;
    font-size: 12px !important;
    font-weight: normal;
    word-break: break-all;
    overflow: hidden;
    line-height: 1.5;
}

.another_category td {
    text-align: right;
    width: 80px;
    font-size: 11px;
}

.another_category th a {
    font-weight: normal;
    text-decoration: none;
    border: none !important;
}

.another_category th a.current {
    font-weight: bold;
    text-decoration: none !important;
    border-bottom: 1px solid !important;
}

.another_category th span {
    font-weight: normal;
    text-decoration: none;
    font: 10px Tahoma, Sans-serif;
    border: none !important;
}

.another_category_color_gray, .another_category_color_gray h4 {
    border-color: #E5E5E5 !important;
}

.another_category_color_gray * {
    color: #909090 !important;
}

.another_category_color_gray th a.current {
    border-color: #909090 !important;
}

.another_category_color_gray h4, .another_category_color_gray h4 a {
    color: #737373 !important;
}

.another_category_color_red, .another_category_color_red h4 {
    border-color: #F6D4D3 !important;
}

.another_category_color_red * {
    color: #E86869 !important;
}

.another_category_color_red th a.current {
    border-color: #E86869 !important;
}

.another_category_color_red h4, .another_category_color_red h4 a {
    color: #ED0908 !important;
}

.another_category_color_green, .another_category_color_green h4 {
    border-color: #CCE7C8 !important;
}

.another_category_color_green * {
    color: #64C05B !important;
}

.another_category_color_green th a.current {
    border-color: #64C05B !important;
}

.another_category_color_green h4, .another_category_color_green h4 a {
    color: #3EA731 !important;
}

.another_category_color_blue, .another_category_color_blue h4 {
    border-color: #C8DAF2 !important;
}

.another_category_color_blue * {
    color: #477FD6 !important;
}

.another_category_color_blue th a.current {
    border-color: #477FD6 !important;
}

.another_category_color_blue h4, .another_category_color_blue h4 a {
    color: #1960CA !important;
}

.another_category_color_violet, .another_category_color_violet h4 {
    border-color: #E1CEEC !important;
}

.another_category_color_violet * {
    color: #9D64C5 !important;
}

.another_category_color_violet th a.current {
    border-color: #9D64C5 !important;
}

.another_category_color_violet h4, .another_category_color_violet h4 a {
    color: #7E2CB5 !important;
}
</style>

                
                <link rel="stylesheet" type="text/css" href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/style/revenue.css"/>
<link rel="canonical" href="https://suspected.tistory.com/269"/>

<!-- BEGIN STRUCTURED_DATA -->
<script type="application/ld+json">
    {"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@id":"https://suspected.tistory.com/269","name":null},"url":"https://suspected.tistory.com/269","headline":"악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)","description":"[개요] [1] ASEC 분석팀은 &quot;전라남도 코로나바이러스 대응 긴급 조회.hwp&quot;로 위장한 악성 문서파일을 발견하고 패치했다. 해당 정보를 확인하고 [2] 무료 샌드박스 서비스(any.run)에서 파일을 다운로드 받아 분석을 수행하기로 했다. 해당 악성 문서파일(HWP)은 코로나19 관련 내용으로 정부기관으로 위장하여 유포한 파일이다. CVE-2017-8291 취약점을 이용해 만들어졌으며, Powershell을 이용해 C2 서버에 접근해 2차 유포 파일(EXE)을 다운로드 받은 뒤, 정보유출형 백도어 역할을 수행한다. 현재는 C2가 단절되어 Powershell에서 C2 서버에 접근하지 못하지만, 서버가 다시 살아날 수 있을 가능성도 있기에 주의가 필요하다. ※ 본 게시물에는 단계별로 한글 문서, 쉘코드..","author":{"@type":"Person","name":"1q","logo":null},"image":{"@type":"ImageObject","url":"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F991D28425E8DF2C501","width":"800px","height":"800px"},"datePublished":"2020-04-09T00:50:54+09:00","dateModified":"2020-04-09T17:51:19+09:00","publisher":{"@type":"Organization","name":"TISTORY","logo":{"@type":"ImageObject","url":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png","width":"800px","height":"800px"}}}
</script>
<!-- END STRUCTURED_DATA -->
<link rel="stylesheet" type="text/css" href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/style/dialog.css"/>
<link rel="stylesheet" type="text/css" href="//t1.daumcdn.net/tistory_admin/www/style/top/font.css"/>
<link rel="stylesheet" type="text/css" href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/style/postBtn.css"/>
<link rel="stylesheet" type="text/css" href="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/style/tistory.css"/>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/script/common.js"></script>

                
                </head>
	
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/lioshi.min.css">
<script>hljs.initHighlightingOnLoad();</script>
<!--Code Block Line Number-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
<script>
hljs.initLineNumbersOnLoad();
$(document).ready(function() {
$('code.hljs').each(function(i, block) {
hljs.lineNumbersBlock(block);
});
});
</script>
	
                                                <body id="tt-body-page">
                
                
                

	<div id="dkIndex">
		<a href="#dkBody">본문 바로가기</a>
		<a href="#dkGnb">메뉴 바로가기</a>
	</div>

	<div id="dkWrap" class="wrap_skin ">
		<div id="dkHead" role="banner" class="area_head ">
			<h1 class="screen_out">1q</h1>
			<div class="area_profile ">
				<a class="link_profile" href="/"><img src="https://t1.daumcdn.net/cfile/tistory/2103F235575E604712" width="50" height="50" class="img_profile" alt="프로필사진"></a>
				<div class="info_profile">
					<button type="button" class="btn_name">1q
						<span class="ico_skin ico_name"></span>
					</button>
					<ul class="list_name">
						<li><a href="https://suspected.tistory.com/manage/entry/post" class="link_name">글쓰기</a></li>
						<li><a href="https://suspected.tistory.com/manage" class="link_name">관리</a></li>
						<li class="box_division"><a href="https://suspected.tistory.com/tag" class="link_name">태그</a></li>
						<li><a href="https://suspected.tistory.com/guestbook" class="link_name">방명록</a></li>
						<li><a href="https://suspected.tistory.com/rss" class="link_name">RSS</a></li>
					</ul>
					<p class="txt_condition">1q</p>
				</div>
			</div>

			<button type="button" class="btn_menu">
				<span class="ico_skin ico_menu">카테고리 메뉴열기</span>
			</button>
		</div>

		<div class="dimmed_layer"></div>

		<button type="button" class="btn_close">
			<span class="ico_skin ico_close">닫기</span>
		</button>

		<div class="area_menu">
			
				<div class="area_search">
					<button type="button" class="btn_search">
						<span class="ico_skin ico_search">검색하기</span>
					</button>
					<form action="#" method="get" class="frm_search" onsubmit="try {
    window.location.href = '/search' + '/' + looseURIEncode(document.getElementsByName('search')[0].value);
    document.getElementsByName('search')[0].value = '';
    return false;
} catch (e) {}">
						<fieldset>
							<legend class="screen_out">검색하기 폼</legend>
							<label for="tfSearch" class="ico_skin lab_search">검색하기</label>
							<input type="text" name="search" value="" class="tf_search">
						</fieldset>
					</form>
				</div>
			

			<div role="navigation" class="area_navi">
				<button type="button" class="btn_cate">CATEGORY <span class="ico_skin ico_cate"></span></button>

				<div class="list_cate">
					<ul class="tt_category"><li class=""><a href="/category" class="link_tit"> 전체보기 <span class="c_cnt">(242)</span> </a>
  <ul class="category_list"><li class=""><a href="/category/Introduce%20myself" class="link_item"> Introduce myself <span class="c_cnt">(0)</span> </a></li>
<li class=""><a href="/category/%EC%95%88%EB%9E%A9%20QA%EC%97%B0%EC%88%98%EC%83%9D%2023%EA%B8%B0" class="link_item"> 안랩 QA연수생 23기 <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/Security%20%EA%B4%80%EB%A0%A8%20%EB%85%BC%EB%AC%B8%20%EB%B0%8F%20%EA%B8%B0%EA%B3%A0%20%EA%B8%80%20%EB%B6%84%EC%84%9D" class="link_item"> Security 관련 논문 및 기고 글 분석 <span class="c_cnt">(2)</span> </a></li>
<li class=""><a href="/category/%EB%A9%8B%EC%9F%81%EC%9D%B4%20%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC%204%EA%B8%B0" class="link_item"> 멋쟁이 사자처럼 4기 <span class="c_cnt">(7)</span> </a>
  <ul class="sub_category_list"><li class=""><a href="/category/%EB%A9%8B%EC%9F%81%EC%9D%B4%20%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC%204%EA%B8%B0/Ruby%20on%20Rails" class="link_sub_item"> Ruby on Rails <span class="c_cnt">(7)</span> </a></li>
</ul>
</li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D" class="link_item"> 프로그래밍 <span class="c_cnt">(82)</span> </a>
  <ul class="sub_category_list"><li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C" class="link_sub_item"> 안드로이드 <span class="c_cnt">(17)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/C%23" class="link_sub_item"> C# <span class="c_cnt">(2)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/Python" class="link_sub_item"> Python <span class="c_cnt">(52)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/Ruby" class="link_sub_item"> Ruby <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/Lua" class="link_sub_item"> Lua <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/%EC%9E%90%EB%B0%94" class="link_sub_item"> 자바 <span class="c_cnt">(2)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/Autoit" class="link_sub_item"> Autoit <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/Windows%20OS%2C%20API%20" class="link_sub_item"> Windows OS, API  <span class="c_cnt">(2)</span> </a></li>
<li class=""><a href="/category/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D/JSP%2C%20Servlet" class="link_sub_item"> JSP, Servlet <span class="c_cnt">(4)</span> </a></li>
</ul>
</li>
<li class=""><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1" class="link_item"> 리버싱 <span class="c_cnt">(56)</span> </a>
  <ul class="sub_category_list"><li class=""><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/%EC%9C%88%EB%8F%84%EC%9A%B0%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%20%EB%B6%84%EC%84%9D" class="link_sub_item"> 윈도우 악성코드 분석 <span class="c_cnt">(9)</span> </a></li>
<li class=""><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%20%EB%B6%84%EC%84%9D" class="link_sub_item"> 안드로이드 악성코드 분석 <span class="c_cnt">(6)</span> </a></li>
<li class=""><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/%EC%A0%95%EB%A6%AC" class="link_sub_item"> 정리 <span class="c_cnt">(25)</span> </a></li>
<li class=""><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/IDAPython" class="link_sub_item"> IDAPython <span class="c_cnt">(8)</span> </a></li>
<li class=""><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/Immunity%20Debugger%20PyCommands%20%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%20%EC%A0%95%EB%A6%AC" class="link_sub_item"> Immunity Debugger PyCommand.. <span class="c_cnt">(8)</span> </a></li>
</ul>
</li>
<li class=""><a href="/category/%EC%9B%B9" class="link_item"> 웹 <span class="c_cnt">(2)</span> </a>
  <ul class="sub_category_list"><li class=""><a href="/category/%EC%9B%B9/SQL%20Injection%20%EC%A0%95%EB%A6%AC" class="link_sub_item"> SQL Injection 정리 <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/%EC%9B%B9/%EB%AC%B8%EB%B2%95%20%EC%A0%95%EB%A6%AC" class="link_sub_item"> 문법 정리 <span class="c_cnt">(1)</span> </a></li>
</ul>
</li>
<li class=""><a href="/category/%EA%B8%B0%ED%83%80" class="link_item"> 기타 <span class="c_cnt">(18)</span> </a></li>
<li class=""><a href="/category/%ED%8F%AC%EB%A0%8C%EC%8B%9D" class="link_item"> 포렌식 <span class="c_cnt">(4)</span> </a></li>
<li class=""><a href="/category/%EC%8B%9C%EC%8A%A4%ED%85%9C%ED%95%B4%ED%82%B9" class="link_item"> 시스템해킹 <span class="c_cnt">(19)</span> </a>
  <ul class="sub_category_list"><li class=""><a href="/category/%EC%8B%9C%EC%8A%A4%ED%85%9C%ED%95%B4%ED%82%B9/FTZ" class="link_sub_item"> FTZ <span class="c_cnt">(11)</span> </a></li>
<li class=""><a href="/category/%EC%8B%9C%EC%8A%A4%ED%85%9C%ED%95%B4%ED%82%B9/%EC%A0%95%EB%A6%AC" class="link_sub_item"> 정리 <span class="c_cnt">(8)</span> </a></li>
</ul>
</li>
<li class=""><a href="/category/Wargame" class="link_item"> Wargame <span class="c_cnt">(46)</span> </a>
  <ul class="sub_category_list"><li class=""><a href="/category/Wargame/reversing.kr" class="link_sub_item"> reversing.kr <span class="c_cnt">(8)</span> </a></li>
<li class=""><a href="/category/Wargame/webhacking.kr" class="link_sub_item"> webhacking.kr <span class="c_cnt">(17)</span> </a></li>
<li class=""><a href="/category/Wargame/%ED%8F%AC%EB%A0%8C%EC%8B%9D" class="link_sub_item"> 포렌식 <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/Wargame/pwnable.kr" class="link_sub_item"> pwnable.kr <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/Wargame/codeengn" class="link_sub_item"> codeengn <span class="c_cnt">(19)</span> </a></li>
</ul>
</li>
<li class=""><a href="/category/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC" class="link_item"> 네트워크 <span class="c_cnt">(1)</span> </a></li>
<li class=""><a href="/category/%EC%84%9C%EB%B2%84%EA%B5%AC%EC%B6%95" class="link_item"> 서버구축 <span class="c_cnt">(2)</span> </a></li>
</ul>
</li>
</ul>


					<ul class="menu_profile">
						<li><a href="https://suspected.tistory.com/guestbook">방명록</a></li>
					</ul>
				</div>
			</div>
		</div>

		<hr class="hide">

		

		<div id="dkContent" class="cont_skin" role="main">
			<div id="cMain">

				

				

				

				            
                
	<div id="mArticle" class="article_skin">

		

		
			<div class="skin_view">
				<h2 id="dkBody" class="screen_out">티스토리 뷰</h2>
				<div class="area_title">
					<strong class="tit_category"><a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/%EC%9C%88%EB%8F%84%EC%9A%B0%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%20%EB%B6%84%EC%84%9D">리버싱/윈도우 악성코드 분석</a></strong>
					<h3 class="tit_post"><a href="/269">악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)</a></h3>
					<span class="txt_detail my_post">1q
						<span class="txt_bar"></span>2020. 4. 9. 00:50
						
					</span>
				</div>
				<div class="area_view">
					            <!-- System - START -->

<!-- System - END -->

            <div class="contents_style"><div>&nbsp;</div>
<div><b><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[개요]</span></span></b></div>
<div>[1] ASEC 분석팀은 "전라남도 코로나바이러스 대응 긴급 조회.hwp"로 위장한 악성 문서파일을 발견하고 패치했다. 해당 정보를 확인하고 [2] 무료 샌드박스 서비스(any.run)에서 파일을 다운로드 받아 분석을 수행하기로 했다.</div>
<div>해당 악성 문서파일(HWP)은 코로나19 관련 내용으로 정부기관으로 위장하여 유포한 파일이다. CVE-2017-8291 취약점을 이용해 만들어졌으며, Powershell을 이용해 C2 서버에 접근해 2차 유포 파일(EXE)을 다운로드 받은 뒤, 정보유출형 백도어 역할을 수행한다. 현재는 C2가 단절되어 Powershell에서 C2 서버에 접근하지 못하지만, 서버가 다시 살아날 수 있을 가능성도 있기에 주의가 필요하다.&nbsp;</div>
<p data-ke-size="size14"><b>※ 본 게시물에는 단계별로 한글 문서, 쉘코드, 다운로드된 PE 파일의 분석을 수행한 내용이 포함되며, 주관적인 의견이 있을 수 있으니 사실과 다른 내용이 있다면 피드백 부탁드립니다.</b><b></b></p>
<div>
<p data-ke-size="size14"><b>※ 참고 : 동일 날짜에 유포된 "인천광역시 코로나바이러스 대응 긴급 조회 (1).hwp", "경찰청 출석요구서.hwp" 2개의 파일과 본 게시물에서 분석하려고 하는 의심 문서와 내부 PostScript Hash 값이 동일한 것으로 보아 Decoy(미끼) 문서만 다르게 활용한 것으로 보임.&nbsp; </b></p>
</div>
<p data-ke-size="size14"><b>인천광역시 코로나바이러스 대응 긴급 조회 (1).hwp : c0bd35a36ea5227b9b981d7707dff0e2c5ca87453a5289dc4a5cd04c7e8b728c</b></p>
<p data-ke-size="size14"><b><b>경찰청 출석요구서.hwp : ff4ce7f350b0063c9683499e42028f129195f8d85c372b54f7b52380c64d5ac9</b></b></p>
<div>&nbsp;</div>
<div><b><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[Hash 값 채증]</span></span></b></div>
<div>총 5가지 파일의 Hash 값을 채증했다.</div>
<div>[1] 악성 문서파일(HWP)</div>
<div>[2] 취약점(CVE-2017-8291)이 존재하는 PostScript 파일</div>
<div>[3] 변환된 PostScript 파일</div>
<div>[4] PostScript 내부에 존재하는 쉘코드 바이너리</div>
<div>[5] 쉘코드에서 다운로드를 수행하는 PE 파일</div>
<p><figure class="imageblock alignCenter" width="642" height="134" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/991D28425E8DF2C501?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/991D28425E8DF2C501?original"><img src="https://t1.daumcdn.net/cfile/tistory/991D28425E8DF2C501" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F991D28425E8DF2C501" width="642" height="134" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div><b><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[악성 문서파일(HWP) 및 쉘코드 분석]</span></span></b></div>
<div>&nbsp;</div>
<div>문서파일에는 코로나19 확진자가 발생했다는 허위 내용으로 전라남도 감염병관리지원단을 사칭한 내용이 담겨있다. <span style="--en-highlight: green; background-color: #b7f7d1;">최근들어 공격자들은 코로나19 이슈를 활용해 피싱, 랜섬웨어, APT 등을 통해 악용하고 있어 주의가 필요하다.</span></div>
<p><figure class="imageblock alignCenter" width="423" height="644" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/998883355E8DF2C508?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/998883355E8DF2C508?original"><img src="https://t1.daumcdn.net/cfile/tistory/998883355E8DF2C508" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F998883355E8DF2C508" width="423" height="644" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>가상환경에서 한글 파일을 단순히 실행한 결과, 아래와 같이 gbb.exe 프로세스에서 cmd를 이용해 powershell을 직접 수행하는 것을 확인할 수 있다.</div>
<p><figure class="imageblock alignCenter" width="303" height="98" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99B87D4F5E8DF2C613?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99B87D4F5E8DF2C613?original"><img src="https://t1.daumcdn.net/cfile/tistory/99B87D4F5E8DF2C613" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99B87D4F5E8DF2C613" width="303" height="98" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>[3] hwpscan2를 활용해 문서 파일의 Summary 정보를 확인한 결과, <span style="--en-highlight: red; background-color: #fec1d0;">2020-04-01 15:56분 경</span>에 문서파일이 마지막으로 수정된 것을 확인할 수 있다.</div>
<p><figure class="imageblock alignCenter" width="579" height="273" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99429D505E8DF2C610?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99429D505E8DF2C610?original"><img src="https://t1.daumcdn.net/cfile/tistory/99429D505E8DF2C610" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99429D505E8DF2C610" width="579" height="273" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>BinData 스토리지의 BIN0005.ps 파일 내부에 "/image &lt;2F78~~~&gt;" 내용이 포함됐다.&nbsp; PostScript는 바이너리를 "&lt; &gt;"로 감싸기 때문에 해당 바이너리가 악성행위를 수행하는 쉘코드라고 의심해 볼 수 있다. 정확한 쉘코드를 얻기 위해서는 한글 파일 자체를 디버깅을 수행하여 추출하는 방법도 존재하지만, 본 게시물에서는 수동으로 진행하도록 하겠다.</div>
<p><figure class="imageblock alignCenter" width="820" height="326" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99A3F1485E8DF2C714?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99A3F1485E8DF2C714?original"><img src="https://t1.daumcdn.net/cfile/tistory/99A3F1485E8DF2C714" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99A3F1485E8DF2C714" width="820" height="326" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>위 바이너리를 추출하여 Hxd를 이용해 확인해보면 또 다른 PostScript 파일이 등장한다. 파일의 내용은 CVE-2017-8291 취약점에서 사용되는 것으로, 아래 드래그한 바이너리가 실제 쉘코드이며, 추출하여 분석을 진행하도록 하겠다.</div>
<p><figure class="imageblock alignCenter" width="616" height="317" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99B4C43C5E8DF2C838?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99B4C43C5E8DF2C838?original"><img src="https://t1.daumcdn.net/cfile/tistory/99B4C43C5E8DF2C838" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99B4C43C5E8DF2C838" width="616" height="317" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
<figure class="imageblock alignCenter" width="623" height="379" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/990FE3385E8DF2C90B?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/990FE3385E8DF2C90B?original"><img src="https://t1.daumcdn.net/cfile/tistory/990FE3385E8DF2C90B" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F990FE3385E8DF2C90B" width="623" height="379" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>위 바이너리를 확인한 결과, 텍스트(오른쪽) 화면을 육안상으로 봤을 때, Powershell의 DownloadFile API를 활용해 C2 서버에 접근하는 것을 확인할 수 있다.</div>
<p><figure class="imageblock alignCenter" width="635" height="385" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99DBBC4D5E8DF2CA1B?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99DBBC4D5E8DF2CA1B?original"><img src="https://t1.daumcdn.net/cfile/tistory/99DBBC4D5E8DF2CA1B" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99DBBC4D5E8DF2CA1B" width="635" height="385" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>자세한 내용을 알기 위해 디버깅을 통해 쉘코드를 분석한 결과 아래와 같은 순서로 진행됐다.</div>
<ol>
<li>
<div>msvcrt.dll을 로드</div>
</li>
<li>
<div>system() 함수 호출</div>
</li>
<li>
<div>system() 함수의 인자로, powershell의 DownloadFile API를 통해 특정 C2 서버에서 "h1.jpg" 파일을 %temp% 경로에 svchost.exe 파일로 다운로드 및 실행</div>
</li>
</ol>
<div>&nbsp;</div>
<div>※ 1차 C2 주소 : <span style="--en-highlight: yellow; background-color: #ffef9e;">http://www.sofa[.]rs/wp-content/themes/twentynineteen/sass/layout/h1[.]jpg</span> (워드프레스 서버 악용)</div>
<div>&nbsp;</div>
<p><figure class="imageblock alignCenter" width="820" height="259" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/992930435E8DF2CA10?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/992930435E8DF2CA10?original"><img src="https://t1.daumcdn.net/cfile/tistory/992930435E8DF2CA10" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F992930435E8DF2CA10" width="820" height="259" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>VirusTotal에서 해당 C2 주소를 확인한 결과, 2개의 파일(h1.jpg와 h2.jpg)이 스캔된 것을 확인할 수 있었다. 32bit와 64bit로 추정은 되지만, 확실하지는 않다. 본 게시물에서는 h2.jpg에 대한 분석을 진행한다.</div>
<p><figure class="imageblock alignCenter" width="761" height="126" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99F903385E8DF2CB15?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99F903385E8DF2CB15?original"><img src="https://t1.daumcdn.net/cfile/tistory/99F903385E8DF2CB15" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99F903385E8DF2CB15" width="761" height="126" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div><b><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[유포된 PE 파일 분석]</span></span></b></div>
<div>&nbsp;</div>
<div>※ IDA를 통해 정적분석에 치중한 분석 내용입니다.</div>
<div>&nbsp;</div>
<div>해당 파일은 C++로 컴파일된 32bit 파일로 확인됐다.</div>
<p><figure class="imageblock alignCenter" width="355" height="50" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99D14F375E8DF2CC2D?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99D14F375E8DF2CC2D?original"><img src="https://t1.daumcdn.net/cfile/tistory/99D14F375E8DF2CC2D" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99D14F375E8DF2CC2D" width="355" height="50" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>IDA를 이용해 스트링을 확인한 결과, 4개의 C2 주소를 발견할 수 있었다. 3개의 주소는 워드프레스 주소 하위의 server_test.php 파일로 동일했으며, 1개의 파일은 index.php가 존재했다. 이를 활용해 C2 통신을 수행할 수도 있겠다는 생각을 할 수도 있을 것이다.</div>
<p><figure class="imageblock alignCenter" width="741" height="185" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99A799405E8DF2CC15?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99A799405E8DF2CC15?original"><img src="https://t1.daumcdn.net/cfile/tistory/99A799405E8DF2CC15" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99A799405E8DF2CC15" width="741" height="185" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>"Microsoft\\Windows\\WinX\\config.txt" 경로의 파일이 존재하는지 확인 및 새로 생성하여 특정 데이터(0xCF 사이즈)를&nbsp; 덮어씌운다. (데이터가 어떻게 생성되는지는 상세 분석이 필요할 것으로 보임.. 상세 디버깅은 나중에 시간이 남으면 추가적으로...)</div>
<p><figure class="imageblock alignCenter" width="529" height="441" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/9976D1355E8DF2CD17?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/9976D1355E8DF2CD17?original"><img src="https://t1.daumcdn.net/cfile/tistory/9976D1355E8DF2CD17" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F9976D1355E8DF2CD17" width="529" height="441" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>위에서 작성한 config.txt 파일에 들어가는 내용이며, 특정 인코딩을 통해 평문을 변조한 것으로 보인다.</div>
<p><figure class="imageblock alignCenter" width="820" height="256" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/999C2C3E5E8DF2CD18?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/999C2C3E5E8DF2CD18?original"><img src="https://t1.daumcdn.net/cfile/tistory/999C2C3E5E8DF2CD18" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F999C2C3E5E8DF2CD18" width="820" height="256" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
<figure class="imageblock alignCenter" width="626" height="276" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99575F345E8DF2CE39?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99575F345E8DF2CE39?original"><img src="https://t1.daumcdn.net/cfile/tistory/99575F345E8DF2CE39" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99575F345E8DF2CE39" width="626" height="276" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>네트워크 행위는 IDA에서 잘 해석하지 못하여 디버깅을 통해 잠시 확인해본 결과, C2 서버(kingsvc.cc)에 id, content를 raw 데이터 형태로 timestamp 파라미터를 추가하여 POST 형식으로 전송하는 것을 보인다.</div>
<div>ex) hxxp://kingsvc[.]cc/index.php?timestamp={} | 전송하려는 raw 데이터 : &amp;id={}&amp;content={}</div>
<p><figure class="imageblock alignCenter" width="541" height="38" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/997C69385E8DF2CF12?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/997C69385E8DF2CF12?original"><img src="https://t1.daumcdn.net/cfile/tistory/997C69385E8DF2CF12" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F997C69385E8DF2CF12" width="541" height="38" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>WQL을 사용하여 "ROOT\\CIMV2"의 "Win32_OperatingSystem"에 존재하는 {Caption, CSName, MUILanguages, Version, OSArchitecture} 정보를 쿼리한다. 결과 값은 아래 로그 형태로 만들어진다.</div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">[Operating System Information] - 시스템 관련 정보 탈취</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">OS Name:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Host Name:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">MUI Lacale:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">OS Version:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">OS Type:{}</span></b></div>
<p><figure class="imageblock alignCenter" width="536" height="545" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99897C335E8DF2CF11?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99897C335E8DF2CF11?original"><img src="https://t1.daumcdn.net/cfile/tistory/99897C335E8DF2CF11" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99897C335E8DF2CF11" width="536" height="545" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>WQL을 사용하여 "ROOT\\CIMV2"의 "Win32_NetworkAdapterConfiguration"에 존재하는 {Description, DefaultIPGateway, DHCPEnabled, DNSServerSearchOrder, IPAddress, IPEnabled, IPSubnet} 정보를 쿼리한다. 결과 값은 아래 로그 형태로 만들어진다.</div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">[Network Information] - 네트워크 관련 정보 탈취</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Description:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Default Gateway:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">DHCP Enabled:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">DNS Server:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">IP Address:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">MAC Address:{}</span></b></div>
<p><figure class="imageblock alignCenter" width="603" height="608" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99A77B455E8DF2D002?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99A77B455E8DF2D002?original"><img src="https://t1.daumcdn.net/cfile/tistory/99A77B455E8DF2D002" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99A77B455E8DF2D002" width="603" height="608" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>WQL을 사용하여 "ROOT\\SecurityCenter2" or "ROOT\\SecurityCenter"의 "AntivirusProduct"에 존재하는 {DisplayName, TimeStamp} 정보를 쿼리한다. 결과 값은 아래 로그 형태로 만들어진다.</div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">[Installed Anti Virus Programs] - 설치된 백신 정보 탈취</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Name:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Update Date:{}</span></b></div>
<p><figure class="imageblock alignCenter" width="525" height="211" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/9965323D5E8DF2D11A?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/9965323D5E8DF2D11A?original"><img src="https://t1.daumcdn.net/cfile/tistory/9965323D5E8DF2D11A" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F9965323D5E8DF2D11A" width="525" height="211" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>WQL을 사용하여 "ROOT\\CIMV2"의 "Win32_Process"에 존재하는 {Caption, ProcessID, Description} 정보를 쿼리한다. 결과 값은 아래 로그 형태로 만들어진다.</div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">[Running Processes] - 실행되고 있는 프로세스 정보 탈취</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Caption:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Process ID Description:{}</span></b></div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">Command:{}</span></b></div>
<p><figure class="imageblock alignCenter" width="457" height="353" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99A7CD455E8DF2D302?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99A7CD455E8DF2D302?original"><img src="https://t1.daumcdn.net/cfile/tistory/99A7CD455E8DF2D302" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99A7CD455E8DF2D302" width="457" height="353" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>위 정보들은 아래 코드의 WQL을 통해 쿼리가 수행된다.</div>
<div>WQL : <span style="color: #222222;">Windows Management Instrumentation 쿼리 언어는 Microsoft의 CIM 쿼리 언어 구현으로, 분산 관리 태스크 포스의 공통 정보 모델 표준에 대한 쿼리 언어</span></div>
<p><figure class="imageblock alignCenter" width="395" height="97" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/9939913D5E8DF2D31B?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/9939913D5E8DF2D31B?original"><img src="https://t1.daumcdn.net/cfile/tistory/9939913D5E8DF2D31B" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F9939913D5E8DF2D31B" width="395" height="97" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div><b><span style="--en-highlight: yellow; background-color: #ffef9e;">사용자 계정, 컴퓨터 계정, 국가별지역 정보를 탈취</span></b></div>
<p><figure class="imageblock alignCenter" width="483" height="515" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/9957474A5E8DF2D50B?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/9957474A5E8DF2D50B?original"><img src="https://t1.daumcdn.net/cfile/tistory/9957474A5E8DF2D50B" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F9957474A5E8DF2D50B" width="483" height="515" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div>해당 악성코드에서 Thread 함수를 분석한 결과, 총 5개의 함수가 존재했다. 각 세부내용은 아래와 같다.</div>
<div>&nbsp;</div>
<div>StartAddress : ReadFile API를 통해 연결된 Pipe에서 데이터를 읽은 뒤 버퍼에 저장하고, SetEvent API를 통해 이벤트를 생성한다.</div>
<div>sub_40B530 : 인자로 받은 특정 스레드 핸들을 종료시킨 후, CreateToolhelp32Snapshot API 함수를 통해 특정 프로세스를 탐색한다.</div>
<div>sub_4021E0 : 4개의 C2 주소를 특정 버퍼에 저장한 후 kingsvc.cc 주소에 3개의 파라미터(id, content, timestamp)를 추가적으로 생성하고 POST 형태로 전송한다.</div>
<div>sub_40CAB0 : URLDownloadToFileW API 함수를 통해 C2 서버로부터 악성코드를 다운로드 받은 뒤, CreateProcessW API 함수를 통해 받은 파일을 실행한다. 그 이후 프로세스, 스레드 핸들 종료 및 파일을 삭제한다.</div>
<p><figure class="imageblock alignCenter" width="707" height="326" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/993ECF355E8DF2D602?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/993ECF355E8DF2D602?original"><img src="https://t1.daumcdn.net/cfile/tistory/993ECF355E8DF2D602" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F993ECF355E8DF2D602" width="707" height="326" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>sub_40E770 : GetAsyncKeyState, GetKeyState, GetWindowTextW API 함수를 통해 키로깅 관련 행위를 수행하는 것으로 예상된다.</div>
<p><figure class="imageblock alignCenter" width="682" height="308" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/99FB0B405E8DF2D613?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/99FB0B405E8DF2D613?original"><img src="https://t1.daumcdn.net/cfile/tistory/99FB0B405E8DF2D613" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99FB0B405E8DF2D613" width="682" height="308" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div><span style="color: #666666;">Exports 함수 확인결과, ReflectiveLoader, getVersion 함수가 확인됐다. ReflectiveLoader 함수는 파일로 존재하는 바이너리(보통 DLL)를 메모리에서 바로 실행하는 기능을 가지고 있다고 한다. 내/외부 벤더 보고서에도 악성코드에서 주로 사용하는 방법이라고 명시되어 있다. 주관적인 의견으로, C2 서버에서 추가적으로 추가 파일(DLL)을 다운로드 받아 해당 Exports 함수를 수행할 것으로 예상된다. </span></div>
<p><figure class="imageblock alignCenter" width="554" height="122" data-origin-width="0" data-origin-height="0"><span data-url="https://t1.daumcdn.net/cfile/tistory/995E31445E8DF2D710?original" data-phocus="https://t1.daumcdn.net/cfile/tistory/995E31445E8DF2D710?original"><img src="https://t1.daumcdn.net/cfile/tistory/995E31445E8DF2D710" srcset="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F995E31445E8DF2D710" width="554" height="122" data-origin-width="0" data-origin-height="0" onerror="this.onerror=null; this.src='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png'; this.srcset='//t1.daumcdn.net/tistory_admin/static/images/no-image-v1.png';"/></span></figure>
</p>
<div>&nbsp;</div>
<div><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[결론]</span></span></div>
<div>본 게시물에서는 "전라남도 코로나바이러스 대응 긴급 조회.hwp" 분석을 수행했다. 내부적으로 한글 문서 구조, PostScript, 쉘코드, PE 파일 등을 분석하는 시간을 가졌다. 5개의 C2 주소를 확인했으며, 2개의 주소만 이용됐다. 나머지 3개의 C2는 테스트 목적으로 만들어진 것인지는 확실하진 않다. 결론적으로, 정보유출형 백도어로 확인됐으며, 해당 내용 관련 메일을 수신 받았을 경우 주의할 필요가 있다.</div>
<div>&nbsp;</div>
<div><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[IOC]</span></span></div>
<ul>
<li>
<div><b><a href="http://www.sofa%5B.%5Drs/wp-content/themes/twentynineteen/sass/layout/h1%5B.%5Djpg" rev="en_rl_none">hxxp://www.sofa[.]rs/wp-content/themes/twentynineteen/sass/layout/h1[.]jpg</a></b></div>
</li>
<li>
<div><b><span style="color: #555555;">hxxp://www.kingsvc[.]cc/index[.]php</span></b></div>
</li>
<li>
<div><b><span style="color: #555555;">hxxp://www.sofa[.]rs/wp-admin/network/server_test[.]php</span></b></div>
</li>
<li>
<div><b><span style="color: #555555;">hxxp://www.afuocolento[.]it/wp-admin/network/server_test[.]php</span></b></div>
</li>
<li>
<div><b><span style="color: #555555;">hxxp://www.mbrainingevents[.]com/wp-admin/network/server_test[.]php</span></b></div>
</li>
<li>
<div><b>Microsoft\\Windows\\WinX\\config.txt</b></div>
</li>
<li>
<div><b>3edd95d6ecf200ecbafd259e15f321353e4c4b7b15a536b0b8066a2ad647460f</b></div>
</li>
<li>
<div><b>a1d59162664163a16502e33286cd8d54b9f5c713325b570e8db493edf55d99f9</b></div>
</li>
<li>
<div><b>88c168cd261dabea1b7223e8c05042be7e0505dedf6fd5effea90ae42e127968</b></div>
</li>
<li>
<div><b>7050af905f1696b2b8cdb4c6e6805a618addf5acfbd4edc3fc807a663016ab26</b></div>
</li>
<li>
<div><b>ca47eb3a62a19e378b15b5714fcf61cfec528d8e27a71ed414d1128658671c8c</b></div>
</li>
<li><b>c0bd35a36ea5227b9b981d7707dff0e2c5ca87453a5289dc4a5cd04c7e8b728c</b></li>
<li><b>ff4ce7f350b0063c9683499e42028f129195f8d85c372b54f7b52380c64d5ac9</b></li>
</ul>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div><span style="font-size: 20px;"><span style="--en-highlight: yellow; background-color: #ffef9e;">[Reference]</span></span></div>
<ul>
<li>
<div>[1] <a href="https://asec.ahnlab.com/1310" rev="en_rl_none">https://asec.ahnlab.com/1310</a></div>
</li>
<li>
<div>[2] <a href="https://any.run/" rev="en_rl_none">https://any.run/</a></div>
</li>
<li>
<div>[3] <a href="https://www.nurilab.com/products/hwpscan2" rev="en_rl_none">https://www.nurilab.com/products/hwpscan2</a></div>
</li>
</ul></div>
            <!-- System - START -->

<!-- System - END -->

                    <div class="container_postbtn #post_button_group">
  <div class="postbtn_like"><script>window.ReactionButtonType = 'reaction';
window.ReactionApiUrl = '//suspected.tistory.com/reaction';
window.ReactionReqBody = {
    entryId: 269
}</script>
<div class="wrap_btn" id="reaction-269" data-tistory-react-app="Reaction"></div><div class="wrap_btn wrap_btn_share"><button type="button" class="btn_post sns_btn btn_share" aria-expanded="false" data-thumbnail-url="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&amp;fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F991D28425E8DF2C501" data-title="악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)" data-description="[개요] [1] ASEC 분석팀은 &quot;전라남도 코로나바이러스 대응 긴급 조회.hwp&quot;로 위장한 악성 문서파일을 발견하고 패치했다. 해당 정보를 확인하고 [2] 무료 샌드박스 서비스(any.run)에서 파일을 다운로드 받아 분석을 수행하기로 했다. 해당 악성 문서파일(HWP)은 코로나19 관련 내용으로 정부기관으로 위장하여 유포한 파일이다. CVE-2017-8291 취약점을 이용해 만들어졌으며, Powershell을 이용해 C2 서버에 접근해 2차 유포 파일(EXE)을 다운로드 받은 뒤, 정보유출형 백도어 역할을 수행한다. 현재는 C2가 단절되어 Powershell에서 C2 서버에 접근하지 못하지만, 서버가 다시 살아날 수 있을 가능성도 있기에 주의가 필요하다. ※ 본 게시물에는 단계별로 한글 문서, 쉘코드.." data-profile-image="https://t1.daumcdn.net/cfile/tistory/2103F235575E604712" data-profile-name="1q" data-pc-url="https://suspected.tistory.com/269" data-relative-pc-url="/269" data-blog-title="1q"><span class="ico_postbtn ico_share">공유하기</span></button>
  <div class="layer_post" id="tistorySnsLayer"></div>
</div><div class="wrap_btn wrap_btn_etc" data-entry-id="269" data-entry-visibility="public" data-category-visibility="public"><button type="button" class="btn_post btn_etc2" aria-expanded="false"><span class="ico_postbtn ico_etc">게시글 관리</span></button>
  <div class="layer_post" id="tistoryEtcLayer"></div>
</div></div>
<button type="button" class="btn_menu_toolbar btn_subscription #subscribe" data-blog-id="1780531" data-url="https://suspected.tistory.com/269" data-device="web_pc" data-tiara-action-name="구독 버튼_클릭"><em class="txt_state"></em><strong class="txt_tool_id">1q</strong><span class="img_common_tistory ico_check_type1"></span></button><div class="postbtn_ccl" data-ccl-type="2" data-ccl-derive="1">
    <a href="https://creativecommons.org/licenses/by/4.0/deed.ko" target="_blank" class="link_ccl" rel="license">
        <span class="bundle_ccl">
            <span class="ico_postbtn ico_ccl1">저작자표시</span> 
        </span>
    </a>
</div>
<!--
<rdf:RDF xmlns="https://web.resource.org/cc/" xmlns:dc="https://purl.org/dc/elements/1.1/" xmlns:rdf="https://www.w3.org/1999/02/22-rdf-syntax-ns#">
    <Work rdf:about="">
        <license rdf:resource="https://creativecommons.org/licenses/by/4.0/deed.ko" />
    </Work>
    <License rdf:about="https://creativecommons.org/licenses/by/4.0/deed.ko">
        <permits rdf:resource="https://web.resource.org/cc/Reproduction"/>
        <permits rdf:resource="https://web.resource.org/cc/Distribution"/>
        <requires rdf:resource="https://web.resource.org/cc/Notice"/>
        <requires rdf:resource="https://web.resource.org/cc/Attribution"/>
        <permits rdf:resource="https://web.resource.org/cc/DerivativeWorks"/>

    </License>
</rdf:RDF>
-->  <div data-tistory-react-app="SupportButton"></div>
</div>

                    <!-- PostListinCategory - START -->
<div class="another_category another_category_color_gray">
  <h4>'<a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1">리버싱</a> &gt; <a href="/category/%EB%A6%AC%EB%B2%84%EC%8B%B1/%EC%9C%88%EB%8F%84%EC%9A%B0%20%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C%20%EB%B6%84%EC%84%9D">윈도우 악성코드 분석</a>' 카테고리의 다른 글</h4>
  <table>
    <tr>
      <th><a href="/275">악성코드 분석(암호화폐 거래소(플라이빗-Flybit) 타겟 스피어피싱 공격)</a>&nbsp;&nbsp;<span>(0)</span></th>
      <td>2020.04.29</td>
    </tr>
    <tr>
      <th><a href="/274">악성코드 분석(&quot;[조회]비트코인 투자 카페 강퇴&amp;활동정지&quot; 악성 한글문서)</a>&nbsp;&nbsp;<span>(0)</span></th>
      <td>2020.04.29</td>
    </tr>
    <tr>
      <th><a href="/273">악성코드 분석(2020 상반기 한국수력원자력 채용공고 사칭 악성 한글문서)</a>&nbsp;&nbsp;<span>(1)</span></th>
      <td>2020.04.28</td>
    </tr>
    <tr>
      <th><a href="/270">[위협정보 공유] 21대 국회의원 선거관련.docx</a>&nbsp;&nbsp;<span>(0)</span></th>
      <td>2020.04.10</td>
    </tr>
    <tr>
      <th><a href="/182">[SNSLocker] 랜섬웨어 샘플 분석보고서 by suspect</a>&nbsp;&nbsp;<span>(3)</span></th>
      <td>2016.07.15</td>
    </tr>
  </table>
</div>

<!-- PostListinCategory - END -->

				</div>
				<div class="area_etc">
					
				</div>


				<div class="area_reply ">


					<strong class="tit_reply">댓글
						<button type="button" class="btn_reply" onclick="$.Area.Comment.changeStatus();">
							<span id="commentCount269_0">0</span>
							<span class="ico_skin ico_reply">댓글펼치기</span>
						</button>
					</strong>



					<!-- 대체텍스트 댓글펼치기/댓글접기 변경 -->
					<div data-tistory-react-app="Namecard"></div><div id="entry269Comment">
						<button type="button" class="btn_replymore">이전 댓글 보기</button>
						
							<ul class="list_reply">
								            

            
							</ul>
						

						     <form method="post" action="/comment/add/269" onsubmit="return false" style="margin: 0">
         
<fieldset class="fld_reply">
	<legend class="screen_out">댓글쓰기 폼</legend>
	<div class="reply_write ">
		<label for="comment" class="lab_write"></label>
		<textarea id="comment" name="comment" class="tf_reply" placeholder="여러분의 소중한 댓글을 입력해주세요" tabindex="1"></textarea>
	</div>
	<div class="reply_writer">
		
			
				<div class="writer_info">
					<span class="info_name ">
						<span class="wrap_info">
							<input type="text" name="name" id="name" class="inp_info" placeholder="이름" value="" tabindex="2">
						</span>
					</span>
					<span class="info_pw ">
						<span class="wrap_info">
							<input type="password" name="password" id="password" class="inp_info" placeholder="비밀번호" tabindex="3">
						</span>
					</span>
				</div>
			
			<div class="writer_check">
				<span class="check_secret ">
					<input type="checkbox" name="secret" id="secret" class="inp_secret" tabindex="4">
					<label for="secret" class="lab_secret">
						<span class="ico_skin ico_check"></span>비밀글
					</label>
				</span>

			</div>

		

		<div class="writer_btn">
			<button type="submit" class="btn_enter" onclick="addComment(this, 269); return false;" tabindex="5">입력</button>
		</div>
	</div>
</fieldset>

     </form>

					</div>
<script type="text/javascript">loadedComments[269]=true;
findFragmentAndHighlight(269);</script>

				</div>
			</div>
		
	</div>

                
            

				

				


				


				<div id="mEtc" class="wrap_etc">
					<div class="inner_aside">
						
								<!-- 공지사항 -->
								
									<div class="box_aside">
										<strong>공지사항</strong>
										<ul class="list_board">
											
										</ul>
									</div>
								
							
								<!-- 최근에 올라온 글 -->
								<div class="box_aside">
									<strong>최근에 올라온 글</strong>
									<ul class="list_board">
										
											<li><a href="/281" class="link_board">Windbg로 dll 분석 세팅하기</a></li>
										
											<li><a href="/280" class="link_board">jse dropper 악성코드 분석 (Kimsuk⋯</a></li>
										
											<li><a href="/279" class="link_board">jse dropper 악성코드 분석 (Kimsuk⋯</a></li>
										
											<li><a href="/278" class="link_board">spactrack 파싱 및 엑셀 저장 개발</a></li>
										
									</ul>
								</div>
							
								<!-- 최근에 달린 댓글 -->
								<div class="box_aside">
									<strong>최근에 달린 댓글</strong>
									<ul class="list_board">
										
											<li><a href="/273#comment13774778" class="link_board">대단하시네요</a></li>
										
											<li><a href="/172#comment13344055" class="link_board">Exception Value:
no such colum⋯</a></li>
										
											<li><a href="/244#comment13282408" class="link_board">내용 출처 좀 혹시 알 수 있을까요..</a></li>
										
											<li><a href="/107#comment13128964" class="link_board">뭔가 어렵군요..ㅎ</a></li>
										
									</ul>
								</div>
							
								<!-- 방문자수 -->
								<div class="box_aside lst">
									<dl class="list_total">
										<dt>Total</dt>
										<dd>318,763</dd>
									</dl>
									<dl class="list_visitor">
										<dt>Today</dt>
										<dd>15</dd>
									</dl>
									<dl class="list_visitor">
										<dt>Yesterday</dt>
										<dd>25</dd>
									</dl>
								</div>
							
								<!-- 링크 -->
								<div class="box_aside">
									<strong>링크</strong>
									<ul class="list_board">
										
									</ul>
								</div>
							
								<!-- 태그 클라우드 -->
								<div class="box_aside">
									<strong>TAG</strong>
									<ul class="list_tag">
										
											<li><a href="/tag/Flybits" class="link_tag cloud5">Flybits</a></li>
										
											<li><a href="/tag/%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C" class="link_tag cloud1">악성코드</a></li>
										
											<li><a href="/tag/idapython" class="link_tag cloud5">idapython</a></li>
										
											<li><a href="/tag/MS-Office" class="link_tag cloud5">MS-Office</a></li>
										
											<li><a href="/tag/%EC%8A%A4%ED%94%BC%EC%96%B4%ED%94%BC%EC%8B%B1" class="link_tag cloud5">스피어피싱</a></li>
										
											<li><a href="/tag/Static%20Analysis%20Engine" class="link_tag cloud5">Static Analysis Engine</a></li>
										
											<li><a href="/tag/AMSI" class="link_tag cloud5">AMSI</a></li>
										
											<li><a href="/tag/%EB%B9%84%ED%8A%B8%EC%BD%94%EC%9D%B8" class="link_tag cloud1">비트코인</a></li>
										
											<li><a href="/tag/CVE-2018-0798" class="link_tag cloud5">CVE-2018-0798</a></li>
										
											<li><a href="/tag/Kimsuky" class="link_tag cloud5">Kimsuky</a></li>
										
											<li><a href="/tag/%ED%95%B4%ED%82%B9%EB%A9%94%EC%9D%BC" class="link_tag cloud5">해킹메일</a></li>
										
											<li><a href="/tag/Cisco%20Talos" class="link_tag cloud5">Cisco Talos</a></li>
										
											<li><a href="/tag/Bisonal" class="link_tag cloud5">Bisonal</a></li>
										
											<li><a href="/tag/Yara" class="link_tag cloud5">Yara</a></li>
										
											<li><a href="/tag/%EC%9C%84%ED%98%91%EC%A0%95%EB%B3%B4%EA%B3%B5%EC%9C%A0" class="link_tag cloud5">위협정보공유</a></li>
										
											<li><a href="/tag/cuckoo-sandbox" class="link_tag cloud5">cuckoo-sandbox</a></li>
										
											<li><a href="/tag/us-cert" class="link_tag cloud5">us-cert</a></li>
										
											<li><a href="/tag/infostealer" class="link_tag cloud5">infostealer</a></li>
										
											<li><a href="/tag/Decoding" class="link_tag cloud5">Decoding</a></li>
										
											<li><a href="/tag/vuln" class="link_tag cloud5">vuln</a></li>
										
											<li><a href="/tag/Servey" class="link_tag cloud5">Servey</a></li>
										
											<li><a href="/tag/%ED%95%9C%EA%B8%80%EC%95%85%EC%84%B1%EC%BD%94%EB%93%9C" class="link_tag cloud1">한글악성코드</a></li>
										
											<li><a href="/tag/CVE-2018-9375" class="link_tag cloud5">CVE-2018-9375</a></li>
										
											<li><a href="/tag/.wll" class="link_tag cloud5">.wll</a></li>
										
											<li><a href="/tag/VirusBulletin" class="link_tag cloud5">VirusBulletin</a></li>
										
											<li><a href="/tag/malware" class="link_tag cloud1">malware</a></li>
										
											<li><a href="/tag/%EB%A9%8B%EC%9F%81%EC%9D%B4%EC%82%AC%EC%9E%90%EC%B2%98%EB%9F%BC%204%EA%B8%B0" class="link_tag cloud5">멋쟁이사자처럼 4기</a></li>
										
											<li><a href="/tag/%EC%B6%9C%EC%B2%98%20%3A%20Do%20it%20%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C%20%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D" class="link_tag cloud5">출처 : Do it 안드로이드 프로그래밍</a></li>
										
											<li><a href="/tag/keylogger" class="link_tag cloud5">keylogger</a></li>
										
											<li><a href="/tag/koodous" class="link_tag cloud5">koodous</a></li>
										
									</ul>
									<a href="https://suspected.tistory.com/tag" class="link_more">more</a>
								</div>
							
								<!-- 달력 -->
								<div class="box_aside">
									<table class="tt-calendar" cellpadding="0" cellspacing="1" style="width: 100%; table-layout: fixed">
  <caption class="cal_month"><a href="/archive/202411" title="1개월 앞의 달력을 보여줍니다.">«</a> &nbsp; <a href="/archive/202412" title="현재 달의 달력을 보여줍니다.">2024/12</a> &nbsp; <a href="/archive/202501" title="1개월 뒤의 달력을 보여줍니다.">»</a></caption>
  <thead>
    <tr>
      <th class="cal_week2">일</th>
      <th class="cal_week1">월</th>
      <th class="cal_week1">화</th>
      <th class="cal_week1">수</th>
      <th class="cal_week1">목</th>
      <th class="cal_week1">금</th>
      <th class="cal_week1">토</th>
    </tr>
  </thead>
  <tbody>
    <tr class="cal_week cal_current_week">
      <td class="cal_day cal_day3 cal_day_sunday">1</td>
      <td class="cal_day cal_day3">2</td>
      <td class="cal_day cal_day3">3</td>
      <td class="cal_day cal_day3">4</td>
      <td class="cal_day cal_day3">5</td>
      <td class="cal_day cal_day3">6</td>
      <td class="cal_day cal_day3">7</td>
    </tr>
    <tr class="cal_week">
      <td class="cal_day cal_day3 cal_day_sunday">8</td>
      <td class="cal_day cal_day3">9</td>
      <td class="cal_day cal_day3">10</td>
      <td class="cal_day cal_day3">11</td>
      <td class="cal_day cal_day3">12</td>
      <td class="cal_day cal_day3">13</td>
      <td class="cal_day cal_day3">14</td>
    </tr>
    <tr class="cal_week">
      <td class="cal_day cal_day3 cal_day_sunday">15</td>
      <td class="cal_day cal_day3">16</td>
      <td class="cal_day cal_day3">17</td>
      <td class="cal_day cal_day4">18</td>
      <td class="cal_day cal_day3">19</td>
      <td class="cal_day cal_day3">20</td>
      <td class="cal_day cal_day3">21</td>
    </tr>
    <tr class="cal_week">
      <td class="cal_day cal_day3 cal_day_sunday">22</td>
      <td class="cal_day cal_day3">23</td>
      <td class="cal_day cal_day3">24</td>
      <td class="cal_day cal_day3">25</td>
      <td class="cal_day cal_day3">26</td>
      <td class="cal_day cal_day3">27</td>
      <td class="cal_day cal_day3">28</td>
    </tr>
    <tr class="cal_week">
      <td class="cal_day cal_day3 cal_day_sunday">29</td>
      <td class="cal_day cal_day3">30</td>
      <td class="cal_day cal_day3">31</td>
      <td class="cal_day1 cal_day2"> </td>
      <td class="cal_day1 cal_day2"> </td>
      <td class="cal_day1 cal_day2"> </td>
      <td class="cal_day1 cal_day2"> </td>
    </tr>
  </tbody>
</table>
								</div>
							
								<!-- 글 보관함 -->
								<div class="box_aside lst">
									<strong>글 보관함</strong>
									<ul class="list_keep">
										
											<li><a href="/archive/202109" class="link_keep">2021/09</a> (3)</li>
										
											<li><a href="/archive/202102" class="link_keep">2021/02</a> (1)</li>
										
											<li><a href="/archive/202006" class="link_keep">2020/06</a> (2)</li>
										
											<li><a href="/archive/202004" class="link_keep">2020/04</a> (7)</li>
										
									</ul>
								</div>
							
					</div>
				</div>
			</div>
		</div>
		<hr class="hide">
		<div id="dkFoot" role="contentinfo" class="area_foot">
			Blog is powered by
			<em class="emph_t">Tistory</em> / Designed by
			<em class="emph_t">Tistory</em>
		</div>
	</div>


<script src="https://tistory1.daumcdn.net/tistory/1780531/skin/images/script.js?_version_=1631100429"></script>
<script>
	(function($) {
		$.Area.init();
	})(jQuery);
</script>

<div class="#menubar menu_toolbar ">
  <h2 class="screen_out">티스토리툴바</h2>
</div>
<div class="#menubar menu_toolbar "></div>
<div class="layer_tooltip">
  <div class="inner_layer_tooltip">
    <p class="desc_g"></p>
  </div>
</div>
<div id="editEntry" style="position:absolute;width:1px;height:1px;left:-100px;top:-100px"></div>


                        <!-- CallBack - START -->
        <script>                    (function () { 
                        var blogTitle = '1q';
                        
                        (function () {
    function isShortContents () {
        return window.getSelection().toString().length < 30;
    }
    function isCommentLink (elementID) {
        return elementID === 'commentLinkClipboardInput'
    }

    function copyWithSource (event) {
        if (isShortContents() || isCommentLink(event.target.id)) {
            return;
        }
        var range = window.getSelection().getRangeAt(0);
        var contents = range.cloneContents();
        var temp = document.createElement('div');

        temp.appendChild(contents);

        var url = document.location.href;
        var decodedUrl = decodeURI(url);
        var postfix = ' [' + blogTitle + ':티스토리]';

        event.clipboardData.setData('text/plain', temp.innerText + '\n출처: ' + decodedUrl + postfix);
        event.clipboardData.setData('text/html', '<pre data-ke-type="codeblock">' + temp.innerHTML + '</pre>' + '출처: <a href="' + url + '">' + decodedUrl + '</a>' + postfix);
        event.preventDefault();
    }

    document.addEventListener('copy', copyWithSource);
})()

                    })()</script>

        <!-- CallBack - END -->

<!-- DragSearchHandler - START -->
<script src="//search1.daumcdn.net/search/statics/common/js/g/search_dragselection.min.js"></script>

<!-- DragSearchHandler - END -->

        <!-- PreventCopyContents - START -->
        <script type="text/javascript">document.oncontextmenu = new Function ('return false');
document.ondragstart = new Function ('return false');
document.onselectstart = new Function ('return false');
document.body.style.MozUserSelect = 'none';</script>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/plugin/PreventCopyContents/script.js"></script>

        <!-- PreventCopyContents - END -->

                
                <div style="margin:0; padding:0; border:none; background:none; float:none; clear:none; z-index:0"></div>
<script type="text/javascript" src="https://tistory1.daumcdn.net/tistory_admin/userblog/userblog-7329e6631edae0acef0eaa4d8e72a6da3b1977c0/static/script/common.js"></script>
<script type="text/javascript">window.roosevelt_params_queue = window.roosevelt_params_queue || [{channel_id: 'dk', channel_label: '{tistory}'}]</script>
<script type="text/javascript" src="//t1.daumcdn.net/midas/rt/dk_bt/roosevelt_dk_bt.js" async="async"></script>

                
                <script>window.tiara = {"svcDomain":"user.tistory.com","section":"글뷰","trackPage":"글뷰_보기","page":"글뷰","key":"1780531-269","customProps":{"userId":"0","blogId":"1780531","entryId":"269","role":"guest","trackPage":"글뷰_보기","filterTarget":false},"entry":{"entryId":"269","entryTitle":"악성코드 분석(전라남도 코로나바이러스 대응 긴급 조회.hwp)","entryType":"POST","categoryName":"리버싱/윈도우 악성코드 분석","categoryId":"642441","serviceCategoryName":null,"serviceCategoryId":null,"author":"1333998","authorNickname":"1q","blogNmae":"1q","image":"t/cfile@991D28425E8DF2C501","plink":"/269","tags":[]},"kakaoAppKey":"3e6ddd834b023f24221217e370daed18","appUserId":"null"}</script>
<script type="module" src="https://t1.daumcdn.net/tistory_admin/frontend/tiara/v1.0.5/index.js"></script>
<script src="https://t1.daumcdn.net/tistory_admin/frontend/tiara/v1.0.5/polyfills-legacy.js" nomodule="true" defer="true"></script>
<script src="https://t1.daumcdn.net/tistory_admin/frontend/tiara/v1.0.5/index-legacy.js" nomodule="true" defer="true"></script>

                </body>

</html>
