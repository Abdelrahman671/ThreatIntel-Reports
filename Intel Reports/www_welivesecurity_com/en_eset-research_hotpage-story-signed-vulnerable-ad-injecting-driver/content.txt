<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="canonical" href="https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/"><title>HotPage: Story of a signed, vulnerable, ad-injecting driver</title><meta content="article" property="og:type"><meta property="og:title" content="HotPage: Story of a signed, vulnerable, ad-injecting driver"><meta property="og:description" content="ESET Research uncovers a Chinese browser injector dubbed HotPage that poses as a security product blocking advertisements but actually introduces even more ads – all while leaving the door open for other threats to run code at the highest privilege level in Windows."><meta name="robots" content="index, follow, max-image-preview:large, max-video-preview:-1"><meta name="description" content="ESET Research uncovers a Chinese browser injector dubbed HotPage that poses as a security product blocking advertisements but actually introduces even more ads – all while leaving the door open for other threats to run code at the highest privilege level in Windows."><meta name="twitter:title" content="HotPage: Story of a signed, vulnerable, ad-injecting driver">
    
    <!-- Preloading resources -->
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BookLF-405f3258.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-BoldLF-31f4bc72.woff" as="font" type="font/woff" crossorigin>
    <link rel="preload" href="https://www.welivesecurity.com/build/assets/FedraSansAltPro-DemiLF-8885b886.woff" as="font" type="font/woff" crossorigin>
            <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x266/wls/2024/7-2024/hotpage/hotpage-ad-injecting-driver.jpeg" as="image" media="(max-width: 768px)">
        <link rel="preload" href="https://web-assets.esetstatic.com/tn/-x425/wls/2024/7-2024/hotpage/hotpage-ad-injecting-driver.jpeg" as="image" media="(min-width: 768.1px)">
                <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-header-995fa639.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-header-995fa639.js"></script>
    <script>
    window.addEventListener('pageLoaded', () => {
        window.dispatchEvent(new CustomEvent('postPageViewed', {
            detail: {
                'id': 18014,
                'publicationId': 30590,
                'name': 'HotPage: Story of a signed, vulnerable, ad-injecting driver',
                'author': 'Romain Dumont',
                'category': 'ESET Research',
                'section': null,
                'branch': 'en',
                'date': '2024/07/18'
            }
        }));
    });
    </script>

    <!-- Google Tag Manager -->
    <script type="module">
    window.addEventListener("pageLoaded", () => {
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PMDGSM');
    });
    </script>
    <!-- End Google Tag Manager -->

    <script type="module">
    window.dispatchEvent(new CustomEvent("pageLoaded"));
    </script>

    <!-- Styles -->
    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/app-22f82615.css" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/app-22f82615.css" />
    <!-- Others -->
            <script>
            window.$current_language = JSON.parse('{"id":1,"code":"en","name":"English","is_pblic":true,"is_active":true,"is_default":true,"is_rtl":false}');
        </script>
    
<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch","rua.ceh":"false","rua.ueh":"false","rua.ieh.st":"0"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="zck3q6accgti6zy3vawa-f-cd6fc07b2-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"39","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":31,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"65c3b5ce","ak.r":45483,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"200.149.184.0","ak.cport":27281,"ak.gh":"2.16.200.143","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.0rtt.ed":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1729865772","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==D0m+469Xi2vRgpGrp2/I44pEaKs+OuSdJiFWuwtMqs0jbtppwiuVAB2DEDp94KPeQ8/tx36wj6z2ucKACwNOXLINkdeSI8Bva47yl5PC88/XUIWmno4QjnxNRbgwEwWpF/lZNly1oErEkjRSZhSl1Lqn/Zdr+KBUgNgnIPL1+e7HfaM7Yd89H2totZHEG6gIQNu0DkrHKnYBy/8MlajIOr1lXn1jTpdBqQtPA2fM4K7yfn0sTem8wd8Ctt7SDgId47c+IumZGDNLhmbUOboBd6QuXNqUF9m1o0U2j7yqHoR5Qhewa0K0ydUMwutcmzMW5ozazBQ7vSpj2akfxIa4SzPAs8b6DuQuldf8hEbRTkCGv88Um+PQgAnYrp7Yk7KspTsgGRyBiHOp5rzY2hmi8UaUmpkmPcImDpjEL5c338Y=","ak.pv":"20","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.0rtt.ed","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src=https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="app" >
        <!-- navbar -->
        <header id="wls-nav-header" class="wls-header navbar sticky-top navbar-expand-lg has-shadow">
  <div class="container first-line">
    <a class="header-brand" href="/en/" title="WeLiveSecurity">
      <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>    </a>
    <p>
      Award-winning news, views, and insight from the ESET security community
    </p>
    <div class="ms-auto">
      <div class="language-picker dropdown"><div class="language-picker-wrapper"><button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown"aria-expanded="false">English</button><ul class="dropdown-menu dropdown-menu-center"><a class="dropdown-item" href="/es/" title="Español">Español</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Português">Português</a><a class="dropdown-item" href="/fr/" title="Français">Français</a></ul></div></div>    </div>
  </div>
  <div class="second-line">
    <div class="container">
      <div class="navbar-header">
        <a class="header-brand" href="/en/" title="WeLiveSecurity">
          <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>        </a>
        <div class="me-2">
          <button class=" navbar-toggler button-hamburger collapsed d-flex d-lg-none flex-column justify-content-around" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="This is toggle button"><span class="toggler-icon top-bar"></span><span class="toggler-icon middle-bar"></span><span class="toggler-icon bottom-bar"></span></button>        </div>
      </div>

      <nav id="navbarNavDropdown" class="collapse navbar-collapse page-navbar"><ul class="navbar-nav"><li class="nav-item d-lg-none"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component></div></li><li class="nav-item"><a class="nav-link" href="/en/tips-advice/" title="TIPS &amp; ADVICE"><span class="">TIPS &amp; ADVICE</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/business-security/" title="BUSINESS SECURITY"><span class="">BUSINESS SECURITY</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ESET RESEARCH" role="button" data-bs-toggle="dropdown"aria-expanded="false">ESET RESEARCH</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/about-eset-research/" title="About ESET Research"><span class="">About ESET Research</span></a><a class="dropdown-item" href="/en/eset-research/" title="Blogposts"><span class="">Blogposts</span></a><a class="dropdown-item" href="/en/podcasts/" title="Podcasts"><span class="">Podcasts</span></a><a class="dropdown-item" href="/en/white-papers/" title="White papers"><span class="">White papers</span></a><a class="dropdown-item" href="/en/threat-reports/" title="Threat reports"><span class="">Threat reports</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item"><a class="nav-link" href="/en/we-live-science/" title="WeLiveScience"><span class="button-link">WeLiveScience</span></a></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="FEATURED" role="button" data-bs-toggle="dropdown"aria-expanded="false">FEATURED</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/ukraine-crisis-digital-security-resource-center/" title="Ukraine crisis – Digital security resource center"><span class="">Ukraine crisis – Digital security resource center</span></a><a class="dropdown-item" href="/en/we-live-progress/" title="WeLiveProgress"><span class="">WeLiveProgress</span></a><a class="dropdown-item" href="/en/covid-19/" title="COVID-19"><span class="">COVID-19</span></a><a class="dropdown-item" href="/en/resources/" title="Resources"><span class="">Resources</span></a><a class="dropdown-item" href="/en/videos/" title="Videos"><span class="">Videos</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="TOPICS" role="button" data-bs-toggle="dropdown"aria-expanded="false">TOPICS</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/cybersecurity/" title="Digital Security"><span class="">Digital Security</span></a><a class="dropdown-item" href="/en/scams/" title="Scams"><span class="">Scams</span></a><a class="dropdown-item" href="/en/how-to/" title="How to"><span class="">How to</span></a><a class="dropdown-item" href="/en/privacy/" title="Privacy"><span class="">Privacy</span></a><a class="dropdown-item" href="/en/cybercrime/" title="Cybercrime"><span class="">Cybercrime</span></a><a class="dropdown-item" href="/en/kids-online/" title="Kids online"><span class="">Kids online</span></a><a class="dropdown-item" href="/en/social-media/" title="Social media"><span class="">Social media</span></a><a class="dropdown-item" href="/en/internet-of-things/" title="Internet of Things"><span class="">Internet of Things</span></a><a class="dropdown-item" href="/en/malware/" title="Malware"><span class="">Malware</span></a><a class="dropdown-item" href="/en/ransomware/" title="Ransomware"><span class="">Ransomware</span></a><a class="dropdown-item" href="/en/secure-coding/" title="Secure coding"><span class="">Secure coding</span></a><a class="dropdown-item" href="/en/mobile-security/" title="Mobile security"><span class="">Mobile security</span></a><a class="dropdown-item" href="/en/critical-infrastructure/" title="Critical infrastructure"><span class="">Critical infrastructure</span></a><a class="dropdown-item" href="/en/about-eset-research/" title="Threat research"><span class="">Threat research</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="" title="ABOUT US" role="button" data-bs-toggle="dropdown"aria-expanded="false">ABOUT US</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/en/company/about-us/" title="About WeLiveSecurity"><span class="">About WeLiveSecurity</span></a><a class="dropdown-item" href="/en/our-experts/" title="Our Experts"><span class="">Our Experts</span></a><a class="dropdown-item" href="/en/company/contact-us/" title="Contact Us"><span class="">Contact Us</span></a></div></div></li><hr class="articles-card-divider px-0 m-0" /><li class="nav-item dropdown d-lg-none"><a class="nav-link dropdown-toggle languages" href="/en/" title="English" role="button"data-bs-toggle="dropdown" aria-expanded="false">English</a><div class="dropdown-menu dropdown-menu-center"><div class="dropdown-items-wrapper"><a class="dropdown-item" href="/es/" title="Español">Español</a><a class="dropdown-item" href="/de/" title="Deutsch">Deutsch</a><a class="dropdown-item" href="/pt/" title="Português">Português</a><a class="dropdown-item" href="/fr/" title="Français">Français</a></div></div></li><li class="nav-item ms-auto d-none d-lg-block"><button class="nav-link ms-auto search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9485 19.9001" fill="#424D56"><path d="m19.5429,17.9473l-4.86-4.852c2.7034-3.5802,1.9927-8.674-1.5874-11.3774C9.5153-.9856,4.4214-.2749,1.718,3.3053-.9854,6.8854-.2747,11.9793,3.3055,14.6827c1.4094,1.0643,3.1273,1.6402,4.8934,1.6406,1.7749.0083,3.5023-.5739,4.91-1.655l4.883,4.829c.207.2113.4912.329.787.326.2948-.0022.5771-.1191.787-.326.4163-.4365.406-1.126-.023-1.55Zm-11.316-3.821c-3.2811-.0017-5.9396-2.663-5.9378-5.9442.0017-3.2811,2.663-5.9396,5.9442-5.9378,1.5726.0008,3.0806.6251,4.1937,1.736,1.1259,1.1056,1.7528,2.6221,1.736,4.2-.0007,1.5744-.6249,3.0845-1.736,4.2-1.1067,1.1254-2.6216,1.7552-4.2,1.746Z" /></svg></button></li></ul><div class="search-bar"><div class="collapse search-bar-wrapper"><div class="search-bar-input"><search-bar-component placeholder="Search WeLiveSecurity"class="search-bar-component-wrapper"></search-bar-component><button class="nav-link search-button-close" type="button" data-bs-toggle="collapse"data-bs-target=".search-bar-wrapper" aria-expanded="false"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.1065 18.0626"><polygon points="10.6883 9.0363 17.4683 15.8163 15.8383 17.4463 9.0583 10.6663 2.2683 17.4463 .6383 15.8163 7.4283 9.0363 .6383 2.2463 2.2683 .6163 9.0583 7.4063 15.8383 .6163 17.4683 2.2463 10.6883 9.0363" /></svg></button></div></div></div></nav>    </div>
  </div>
  <div class="additional-info d-none">
    <div class="container">
      <p>
        Award-winning news, views, and insight from the ESET security community
      </p>
    </div>
  </div>
</header>
        <!-- main content -->
        <div id="main">
                
    <div class="container article-page py-5">
        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                                    <div class="article-header">
    <p class="category text-uppercase">ESET Research</p>
    <h1 class="page-headline">HotPage: Story of a signed, vulnerable, ad-injecting driver</h1>    <p class="sub-title">A study of a sophisticated Chinese browser injector that leaves more doors open!</p>
    
    <div class="article-authors d-flex flex-wrap"><div class="article-author d-flex"><a href="/en/our-experts/romain-dumont/" title="Romain Dumont"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/romain-dumont.jpeg" media="(max-width: 768px)" /><img class="author-image me-3"  src="https://web-assets.esetstatic.com/tn/-x45/wls/romain-dumont.jpeg" alt="Romain Dumont"  /></picture></a><div class="author-text"><p><a href="/en/our-experts/romain-dumont/" title="Romain Dumont"><b>Romain Dumont</b></a></p></div></div></div>
    <p class="article-info mb-5">
        <span>18 Jul 2024</span>
        <span class="d-none d-lg-inline">&nbsp;&bull;&nbsp;</span>
        <span class="d-inline d-lg-none">, </span>
        <span>23 min. read</span>
    </p>

    <div class="hero-image-container">
        <picture><source srcset="https://web-assets.esetstatic.com/tn/-x266/wls/2024/7-2024/hotpage/hotpage-ad-injecting-driver.jpeg" media="(max-width: 768px)" /><source srcset="https://web-assets.esetstatic.com/tn/-x425/wls/2024/7-2024/hotpage/hotpage-ad-injecting-driver.jpeg" media="(max-width: 1120px)" /><img class="hero-image"  src="https://web-assets.esetstatic.com/tn/-x700/wls/2024/7-2024/hotpage/hotpage-ad-injecting-driver.jpeg" alt="HotPage: Story of a signed, vulnerable, ad-injecting driver"  /></picture>    </div>
</div>
                    <div class="article-body">
    <p>Malware research involves studying threat actor TTPs, mapping infrastructure, analyzing novel techniques&hellip; And while most of these investigations build on existing research, sometimes they start from a hunch, something that looks too simple. At the end of 2023, we stumbled upon an installer named <span style="font-family: courier new, courier, monospace;">HotPage.exe</span> that deploys a driver capable of injecting code into remote processes, and two libraries capable of intercepting and tampering with browsers&rsquo; network traffic. The malware can modify or replace the contents of a requested page, redirect the user to another page, or open a new page in a new tab based on certain conditions.</p>
<p>The installer was detected by most security products as an adware component but what really piqued our interest was the embedded driver signed by Microsoft. According to its signature, it was developed by a Chinese company named 湖北盾网网络科技有限公司 (machine translation: Hubei Dunwang Network Technology Co., Ltd), the lack of information about which was intriguing. The distribution method is still unclear but according to our research, this software was advertised as an &ldquo;Internet caf&eacute; security solution&rdquo; aimed at Chinese-speaking individuals. It purports to improve the web browsing experience by blocking ads and malicious websites, but the reality is quite different &ndash; it leverages its browser traffic interception and filtering capabilities to display game-related ads. It also sends some information about the computer to the company&rsquo;s server, most likely to gather installation statistics.</p>
<p>On top of its obvious mischievous behavior, this kernel component unintentionally leaves the door open for other threats to run code at the highest privilege level available in the Windows operating system: the <span style="font-family: courier new, courier, monospace;">SYSTEM</span> account. Due to improper access restrictions to this kernel component, any processes can communicate with it and leverage its code injection capability to target any non-protected processes.</p>
<p>We reported this driver to Microsoft on March 18<sup>th</sup>, 2024 and followed their coordinated vulnerability disclosure process. Microsoft Security Response Center (MSRC) determined that this is no longer a vulnerability as the offending driver was removed from the Windows Server Catalog on May 1<sup>st</sup>, 2024. ESET technologies detect this threat as <span style="font-family: courier new, courier, monospace;">Win{32|64}/HotPage.A</span> and <span style="font-family: courier new, courier, monospace;">Win{32|64}/HotPage.B</span>.</p>
<h2>Who is 湖北盾网网络科技有限公司 ?</h2>
<p>During its execution, the HotPage malware installs a driver, but before diving into the technical details of its inner workings, we wanted to learn more about the code-signing signature of this driver. What first caught our attention was the signing certificate&rsquo;s owner, as illustrated in Figure 1.</p>
<figure class="image"><img style="width: 65%; margin: 0 auto; display: block;" title="" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-1-owner-of-hotpage-driver-s-digital-signature.png" alt="Figure 1. Owner of HotPage driver&rsquo;s digital signature" width="" height="" />
<figcaption><em>Figure 1. Owner of HotPage driver&rsquo;s digital signature</em></figcaption>
</figure>
<p>Since the 64-bit version of Windows 7, kernel-mode drivers have been required to be signed to be loaded by the operating system. As previously detailed by <a href="https://www.mandiant.com/resources/blog/hunting-attestation-signed-malware" target="_blank" rel="noopener">Mandiant Intelligence</a>, <a href="https://www.sentinelone.com/labs/driving-through-defenses-targeted-attacks-leverage-signed-malicious-microsoft-drivers/" target="_blank" rel="noopener">SentinelLabs</a>, and <a href="https://www.gdatasoftware.com/blog/microsoft-signed-a-malicious-netfilter-rootkit" target="_blank" rel="noopener">G&nbsp;DATA</a> teams, the signing process is built on trust but there have been cases where this was abused. It seems that the Chinese company went through <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/dashboard/code-signing-reqs" target="_blank" rel="noopener">Microsoft&rsquo;s driver code-signing requirements</a> and managed to obtain an Extended Verification (EV) certificate as shown in Figure 2.</p>
<figure class="image"><img style="width: 65%; margin: 0 auto; display: block;" title="" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-2-hotpage-driver-s-certificate-extended-verification-and-code-signing-attributes.png" alt="Figure 2. HotPage driver&rsquo;s certificate Extended Verification and code-signing attributes" width="" height="" />
<figcaption><em>Figure 2. HotPage driver&rsquo;s certificate Extended Verification and code-signing attributes</em></figcaption>
</figure>
<p>In order to retrieve the company name associated with this signature, the extraction of the signers&rsquo; attributes was necessary. Figure 3 shows the <a href="https://learn.microsoft.com/en-us/openspecs/office_file_formats/ms-oshared/91755632-4b0d-44ca-89a9-9699afbbd268" target="_blank" rel="noopener">SpcSpOpusInfo</a> attribute identified by the object ID <span style="font-family: courier new, courier, monospace;">1.3.6.1.4.1.311.2.1.12</span>.</p>
<figure class="image"><img style="width: 65%; margin: 0 auto; display: block;" title="" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-3-hotpage-driver-s-certificate-spcspopusinfo-attribute.png" alt="Figure 3. HotPage driver&rsquo;s certificate SpcSpOpusInfo attribute" width="" height="" />
<figcaption><em>Figure 3. HotPage driver&rsquo;s certificate </em><span style="font-family: courier new, courier, monospace;">SpcSpOpusInfo</span> <em>attribute</em></figcaption>
</figure>
<p>Using the <a href="https://github.com/lief-project/LIEF">LIEF binary parser</a>, it is possible to extract the structure member <span style="font-family: courier new, courier, monospace;">programName</span> that identifies the company behind this signature, as displayed in Figure 4.</p>
<figure><img title="Figure 4. Extraction of the company name from the HotPage driver&rsquo;s certificate" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-4-extraction-of-the-company-name-from-the-hotpage-driver-s-certificate.png" alt="Figure 4. Extraction of the company name from the HotPage driver&rsquo;s certificate" width="" height="" />
<figcaption><em>Figure 4. Extraction of the company name from the HotPage driver&rsquo;s certificate</em></figcaption>
</figure>
<p>We found a reference to this company in the <a href="https://www.windowsservercatalog.com/results.aspx?&amp;bCatID=1283&amp;cpID=34251&amp;avc=10&amp;ava=0&amp;avt=0&amp;avq=0&amp;OR=1&amp;PGS=25" target="_blank" rel="noopener">Windows Server Catalog</a>, as shown in Figure 5. The company used various product categories when submitting its drivers for certification. Based on its name, it appears the company developed two network filtering programs: a <a href="https://netfiltersdk.com/" target="_blank" rel="noopener">netfilter</a> component and the <span style="font-family: courier new, courier, monospace;">HotPage</span> driver referred as <span style="font-family: courier new, courier, monospace;">adsafe</span><span style="font-family: courier new, courier, monospace;"> </span>or by its internal name <span style="font-family: courier new, courier, monospace;">KNewTalbeBase</span> (Note the [Tt]albe typo, which also occurs elsewhere in the HotPage code).</p>
<figure><img title="Figure 5. The Chinese company&rsquo;s certified products listed in the Windows Server Catalog" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-5-the-chinese-company-s-certified-products-listed-in-the-windows-server-catalog.png" alt="Figure 5. The Chinese company&rsquo;s certified products listed in the Windows Server Catalog" width="" height="" />
<figcaption><em>Figure 5. The Chinese company&rsquo;s certified products listed in the Windows Server Catalog</em></figcaption>
</figure>
<p>Investigating the company through search engines didn&rsquo;t yield many results. According to the company register <a href="https://dingtalk.com/qidian/company/1190156990002244544" target="_blank" rel="noopener">dingtalk</a>, we discovered that the company was created on January 6<sup>th</sup>, 2022 and provided the email address <span style="font-family: courier new, courier, monospace;">dwadsafe@mail[.]io</span>. The business scope includes: technology-related activities such as development, services, consulting, etc., but also advertising activities. As translated in Figure 6, the principal shareholder is now Wuhan Yishun Baishun Culture Media Co., Ltd, a very small company that looks to be specialized in advertising and marketing.</p>
<figure><img title="Figure 6. Translated executive and shareholder information about the company" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-6-translated-executive-and-shareholder-information-about-the-company.png" alt="Figure 6. Translated executive and shareholder information about the company" width="" height="" />
<figcaption><em>Figure 6. Translated executive and shareholder information about the company</em></figcaption>
</figure>
<p>From the Intellectual Property tab, we learned that in April and May 2022 the company applied for the trade name <span style="font-family: courier new, courier, monospace;">Shield Internet Caf&eacute; Security Defense</span> and the website <span style="font-family: courier new, courier, monospace;">dwadsafe[.]com</span> was created on February 22<sup>nd</sup>, 2022. The domain now resolves to localhost (<span style="font-family: courier new, courier, monospace;">127.0.0.1</span>) and is therefore inaccessible. However, a screenshot of the website was taken on November 10<sup>th</sup>, 2023 by a <a href="https://en.wikipedia.org/wiki/Web_crawler" target="_blank" rel="noopener">web crawler</a>, as seen in Figure 7.</p>
<figure class="image"><img style="width: 65%; margin: 0 auto; display: block;" title="" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-7-screenshot-of-the-dwadsafe-com-webpage-made-by-zhizhuyinqing-com.png" alt="Figure 7. Screenshot of the dwadsafe[.]com webpage made by zhizhuyinqing.com" width="" height="" />
<figcaption><em>Figure 7. Screenshot of the</em> <span style="font-family: courier new, courier, monospace;">dwadsafe[.]com</span> <em>webpage made by</em> <span style="font-family: courier new, courier, monospace;">zhizhuyinqing.com</span> <em>(watermarked in light blue)</em></figcaption>
</figure>
<p>The HTTP body of the URL <span style="font-family: courier new, courier, monospace;">https://www.dwadsafe[.]com/login/reg.html</span> (SHA-1: <span style="font-family: courier new, courier, monospace;">744FFC3D8ECE37898A0559B62CC9F814006A1218</span>) was also captured by VirusTotal. The source code contains the description 网吧主动防御云平台 (machine translation: Internet caf&eacute; active defense cloud platform). This page includes a license agreement that details the purpose of the software, albeit with contradictions. Table 1 lists some interesting bits of that information.</p>
<p style="text-align: center;"><em>Table 1. Translation of the relevant parts of the license agreement</em></p>
<table style="width: 781.828px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 301px;">
<p><strong>Original text</strong></p>
</td>
<td style="width: 473.828px;">
<p><strong>Translated text (via Google Translate; emphasis ours)</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 301px;">
<p><strong>6</strong><strong>、</strong><strong>DwAdsafe</strong><strong>作</strong>为一款主动防御系统，自身并不具有任何拦截功能，单独运行本软件不会对现有任何软件或者程序有拦截、破坏、修改等操作，也不会拦截任何病毒程序。用户只有在编写相关过滤规则后，才会开始生效；用户可以根据自己的实际需要，选择是否使用这些规则<strong>.</strong></p>
</td>
<td style="width: 473.828px;">
<p>6. As an active defense system, <strong>DwAdsafe does not have any interception function.</strong> Running this software alone will not intercept, destroy or modify any existing software or programs, nor will it intercept any virus programs. Only after users write relevant filtering rules will they take effect; users can choose whether to use these rules according to their actual needs.</p>
</td>
</tr>
<tr>
<td style="width: 301px;">
<p><strong>7</strong><strong>、</strong><strong>DwAdsafe</strong><strong>是</strong>应用户的强烈需求而开发的：目前，有部分软件和网站的广告对用户存在较大的骚扰和误导，严重影响用户的上网体验。应广大用户提出要求，本公司开发并提供网吧环境下的安全监视、监控、过滤等功能的软件&mdash;&mdash;<strong>DwAdsafe</strong><strong>。</strong><strong>DwAdsafe</strong><strong>中所有的</strong>过滤规则均由网友提供并共享，通过<strong>DwAdsafe</strong>发布。用户可以根据自己的实际需要，选择是否使用这些功能。</p>
</td>
<td style="width: 473.828px;">
<p>7. DwAdsafe was developed in response to the strong needs of users: At present, the <strong>advertisements of some software and websites are quite harassing and misleading to users, seriously affecting users&rsquo; online experience</strong>. In response to requests from users, <strong>our company develops and provides software for security monitoring, monitoring, filtering and other functions in Internet caf&eacute; environments</strong> &ndash; DwAdsafe. <strong>All filtering rules</strong> in DwAdsafe are provided and shared by netizens and <strong>published through DwAdsafe</strong>. Users can choose whether to use these functions according to their actual needs.</p>
</td>
</tr>
<tr>
<td style="width: 301px;">
<p><strong>8</strong><strong>、</strong><strong>DwAdsafe</strong><strong>是主</strong>动防御型软件，故包括但不限于拦截、监视、删除、结束等功能。使用<strong>DwAdsafe</strong><strong>会</strong>对计算机信息系统的部分或全部有对应的控制及处理权限<strong>,</strong></p>
</td>
<td style="width: 473.828px;">
<p>8. DwAdsafe is an active defense software, so <strong>it includes but is not limited to interception, monitoring, deletion, termination and other functions</strong>. Using DwAdsafe will have <strong>corresponding control and processing authority over part or all of the computer information system</strong>.</p>
</td>
</tr>
</tbody>
</table>
<p>According to the license agreement, the software is indeed marketed as a security solution for internet caf&eacute;s to block ads. However, despite the company&rsquo;s claims that DwAdsafe does not have any interception capability, our investigation revealed that the software does have a rather intrusive one and comes with pre-written, unmodifiable rules.</p>
<p>Apart from these bits of information, the company behind this malicious component remains a mystery.</p>
<h2>HotPage analysis</h2>
<p>In this section we describe how the different components are installed and interact with each other to achieve their purpose: injecting ads into the browser. So far, we haven&rsquo;t found out how the malware was distributed but we believe, with low confidence, that it might have been bundled with another software package or advertised as a security product due to the level of privileges needed to install the driver. A few references advertising the product were found in some forums in 2022; an example is seen in Figure 8.</p>
<figure><img title="Figure 8. Mention of dwadsafe[.]com in a forum dedicated to Internet caf&eacute; maintenance" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-8-mention-of-dwadsafe-com-in-a-forum-dedicated-to-internet-cafe-maintenance.png" alt="Figure 8. Mention of dwadsafe[.]com in a forum dedicated to Internet caf&eacute; maintenance" width="" height="" />
<figcaption><em>Figure 8. Mention of </em><span style="font-family: courier new, courier, monospace;">dwadsafe[.]com</span><em> in a forum dedicated to Internet caf&eacute; maintenance</em></figcaption>
</figure>
<p>The installer drops the driver on disk and starts a service to execute it. It decrypts its configuration file, which contains a list of target Chromium-based browsers and libraries. If such executables are found running or being loaded, the driver tries to inject one of the listed libraries into the browser process. After hooking network-based Windows API functions, the injected library checks the URL being accessed and under certain conditions, it displays another page to the user through diverse means.</p>
<h3>The installer</h3>
<p>The installer we analyzed (SHA-1: <span style="font-family: courier new, courier, monospace;">941F0D2D4589FB8ADF224C8969F74633267B2561</span>) is a UPX-compressed file that was uploaded to VirusTotal on 2023-08-26. Figure 9 provides a high-level overview of the driver installation.</p>
<figure class="image"><img style="width: 65%; margin: 0 auto; display: block;" title="" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-9-overview-of-the-installer-s-workflow.png" alt="Figure 9. Overview of the installer&rsquo;s workflow" width="" height="" />
<figcaption><em>Figure 9. Overview of the installer&rsquo;s workflow</em></figcaption>
</figure>
<p>The installer contains the encrypted versions (single-byte XOR operation with the key <span style="font-family: courier new, courier, monospace;">0xE3</span>) of the driver component, the libraries that will be injected into web browser processes, and three JSON-formatted configuration files:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">chromedll</span><span style="font-family: courier new, courier, monospace;"> </span>contains the names of the targeted browser libraries to hook and the targeted functions&rsquo; pattern for hooking them,</li>
<li><span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>(<em>unused</em>) contains the list of targeted browsers, allowlists of command line parameters and websites, and the homepage URL that could be used, and</li>
<li><span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>contains filtering rules, an API endpoint to send basic information about the compromised computer, and another one to manage configuration updates.</li>
</ul>
<p>The malware starts by executing the <span style="font-family: courier new, courier, monospace;">CPUID</span><span style="font-family: courier new, courier, monospace;"> </span>instruction (see <a href="https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/tlfs/feature-discovery#standard-hypervisor-cpuid-leaves">Hypervisor Discovery</a>), to check whether it&rsquo;s running within a virtualized environment. Then it checks if the driver&rsquo;s device filename <span style="font-family: courier new, courier, monospace;">\\.\KNewTableBaseIo</span> exists and if not, it decrypts the driver and stores it in <span style="font-family: courier new, courier, monospace;">C:\Windows\ShieldNetWork\Business\</span>. Its name is a randomly generated 7-character string followed by the <span style="font-family: courier new, courier, monospace;">.sys</span> extension. A service is created with the file path of the stored driver, and the random string is used as the service name. Since the start type is set to <span style="font-family: courier new, courier, monospace;">SERVICE_DEMAND_START</span>, the service needs to be explicitly started in order to load the driver. Oddly, this adware doesn&rsquo;t implement any persistence mechanisms, or at least not in this version.</p>
<p>The installer proceeds to communicate with and configure the driver via its device filename using I/O control codes in the following order:</p>
<ol>
<li><span style="font-family: courier new, courier, monospace;">0x9C4013FC</span><span style="font-family: courier new, courier, monospace;"> </span>&ndash; send the 32-bit hooking library that will be injected into target web browser processes.</li>
<li><span style="font-family: courier new, courier, monospace;">0x9C400FFC</span><span style="font-family: courier new, courier, monospace;"> </span>&ndash; send the 64-bit hooking library that will be injected into target web browser processes.</li>
<li><span style="font-family: courier new, courier, monospace;">0x9C40173C</span><span style="font-family: courier new, courier, monospace;"> </span>&ndash; send the <span style="font-family: courier new, courier, monospace;">chromedll</span><span style="font-family: courier new, courier, monospace;"> </span>configuration.</li>
</ol>
<p>The installer retrieves the registry key associated with the created service and checks to see if the values <span style="font-family: courier new, courier, monospace;">IP</span><span style="font-family: courier new, courier, monospace;"> </span>and <span style="font-family: courier new, courier, monospace;">port</span><span style="font-family: courier new, courier, monospace;"> </span>are present. These values are never set by this code so they are presumably created by another component. Without going into the details of the network protocol, the remote server should serve an update of the <span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>configuration. The communication is encrypted with RC4, using a key derived from the string <span style="font-family: courier new, courier, monospace; white-space: nowrap;">ID:f~WdH+K?KD)r*sD4mk</span> using the Windows <a href="https://learn.microsoft.com/en-us/windows/win32/api/bcrypt/nf-bcrypt-bcryptgeneratesymmetrickey" target="_blank" rel="noopener">BCryptGenerateSymmetricKey</a> function. Figure 10 shows the content of the configuration file.</p>
<figure><img title="Figure 10. newtalbe configuration" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-10-newtalbe-configuration.png" alt="Figure 10. newtalbe configuration" width="" height="" />
<figcaption><em>Figure 10. </em><span style="font-family: courier new, courier, monospace;">newtalbe</span> <em>configuration</em></figcaption>
</figure>
<p>Table 2 describes the important values used from this file, listed in the order that they appear in the configuration file (Figure 10).</p>
<p style="text-align: center;"><em>Table 2. </em><span style="font-family: courier new, courier, monospace;">newtalbe</span> <em>configuration description</em></p>
<table style="width: 780px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 85.5938px;">
<p><strong>Value</strong></p>
</td>
<td style="width: 692.406px;">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 85.5938px;">
<p><span style="font-family: courier new, courier, monospace;">cnz</span></p>
</td>
<td style="width: 692.406px;">
<p>URI pattern matching URLs used to collect statistics when visiting the URL specified by the <span style="font-family: courier new, courier, monospace;">url </span>value.</p>
</td>
</tr>
<tr>
<td style="width: 85.5938px;">
<p><span style="font-family: courier new, courier, monospace;">url</span> and <span style="font-family: courier new, courier, monospace;">dns</span></p>
</td>
<td style="width: 692.406px;">
<p>If one of the URLs listed in <span style="font-family: courier new, courier, monospace;">blist </span>is being accessed, a new tab pointing to the <span style="font-family: courier new, courier, monospace;">url </span>value will be opened. The <span style="font-family: courier new, courier, monospace;">dns </span>value is IP address of the domain.</p>
</td>
</tr>
<tr>
<td style="width: 85.5938px;">
<p><span style="font-family: courier new, courier, monospace;">hostapikey, hostapi,</span><br /><span style="font-family: courier new, courier, monospace;">hostlist</span></p>
</td>
<td style="width: 692.406px;">
<p>The URL value of <span style="font-family: courier new, courier, monospace;">hostapi</span> is used to update the <span style="font-family: courier new, courier, monospace;">hostlist</span>, a dictionary comprised of game-related domains along with their corresponding IP addresses. The <span style="font-family: courier new, courier, monospace;">hostapikey </span>is the decryption key.</p>
</td>
</tr>
<tr>
<td style="width: 85.5938px;">
<p><span style="font-family: courier new, courier, monospace;">apiurl</span></p>
</td>
<td style="width: 692.406px;">
<p>List of endpoints to send information about the compromised computer to.</p>
</td>
</tr>
<tr>
<td style="width: 85.5938px;">
<p><span style="font-family: courier new, courier, monospace;">Wlist,</span><br /><span style="font-family: courier new, courier, monospace;">blist,</span><br /><span style="font-family: courier new, courier, monospace;">jclist,</span><br /><span style="font-family: courier new, courier, monospace;">hblist</span></p>
</td>
<td style="width: 692.406px;">
<p>Lists of patterns (URI, domains, file extensions, HTML code, and HTTP response headers) to match to apply redirection rules (see the<em><a href="#Hooking NtDeviceIoControlFile and inspecting incoming and outgoing data"> Hooking NtDeviceIoControlFile and inspecting incoming and outgoing data</a></em> section).</p>
</td>
</tr>
</tbody>
</table>
<p>Using the <span style="font-family: courier new, courier, monospace;">hostapi</span><span style="font-family: courier new, courier, monospace;"> </span>URL value of this file, an HTTP GET request is made over TLS with a generic User-Agent string. The received data is decrypted using RC4 with the <span style="font-family: courier new, courier, monospace;">hostapikey</span><span style="font-family: courier new, courier, monospace;"> </span>value; it contains a dictionary of gaming-related hostnames with their corresponding resolved address.</p>
<p>Once these updates are done, the installer sends the updated <span style="font-family: courier new, courier, monospace;">newtalbe</span> configuration to the driver by issuing an I/O request with the control code <span style="font-family: courier new, courier, monospace;">0x9C400BFC</span><strong>.</strong></p>
<p>Finally, the malware iterates over the list of endpoints provided by the JSON element <span style="font-family: courier new, courier, monospace;">apiurl</span><span style="font-family: courier new, courier, monospace;"> </span>and for each one of them it creates a JSON-formatted string containing information about the compromised computer, encrypts it with RC4 using the key <span style="font-family: courier new, courier, monospace;">Abc123!@#&amp;XM</span> derived via the Windows API <span style="font-family: courier new, courier, monospace;">BcryptGenerateSymmetricKey</span>, and sends the collected information to the remote server via an HTTP POST request. The collected information includes the computer name, the network interface MAC address, the version of the operating system, and the dimensions of the screen.</p>
<h3>Injector driver</h3>
<p>The driver&rsquo;s main purpose is to inject libraries into browser applications and alter their execution flow to change the URL being accessed or open a page in a new tab. Two threads are created to handle requests for opening a new tab and injecting libraries using the publicly available <a href="https://github.com/DarthTon/Blackbone" target="_blank" rel="noopener">Blackbone</a> project. Additionally, <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetcreateprocessnotifyroutineex" target="_blank" rel="noopener">process creation</a> and <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/nf-ntddk-pssetloadimagenotifyroutineex" target="_blank" rel="noopener">image loading</a> notification routines are set to monitor newly created processes and executable images being loaded. The simplified logic of the driver is illustrated in Figure 11.</p>
<figure><img title="Figure 11. Simplified driver logic" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-11-simplified-driver-logic.png" alt="Figure 11. Simplified driver logic" width="" height="" />
<figcaption><em>Figure 11. Simplified driver logic</em></figcaption>
</figure>
<p>For an unknown reason, the driver starts by deleting its image from the disk. Afterwards it creates a device object named <span style="font-family: courier new, courier, monospace;">\\.\KNewTableBaseIo</span> and sets its <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/kernel/irp-mj-device-control">IRP_MJ_DEVICE_CONTROL</a> routine to handle the various I/O requests listed in Table 3. The control codes (IOCTL) used for configuration or setting the injected libraries can only be called once; therefore the settings cannot be updated. These special control codes are protected by checking that the caller&rsquo;s file path matches the regular expression <span style="font-family: courier new, courier, monospace;">*ShieldNetWork\\Business\\DwBusiness_*</span>.</p>
<p style="text-align: center;"><em>Table 3. List of available IOCTLs and their description</em></p>
<table style="width: 780px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 96.3125px;">
<p><strong>IOCTL</strong></p>
</td>
<td style="width: 588.688px;">
<p><strong>Action</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C400BFC</span></p>
</td>
<td style="width: 588.688px;">
<p>Parses the <span style="font-family: courier new, courier, monospace;">newtalbe </span>configuration passed as an argument.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C400FFC</span></p>
</td>
<td style="width: 588.688px;">
<p>Sets the 64-bit library to be injected.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C4013FC</span></p>
</td>
<td style="width: 588.688px;">
<p>Sets the 32-bit library to be injected.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C40173C</span></p>
</td>
<td style="width: 588.688px;">
<p>Parses the <span style="font-family: courier new, courier, monospace;">chromedll </span>configuration passed as an argument.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C401EC4</span></p>
</td>
<td style="width: 588.688px;">
<p>Receives a list of browser tabs (processes) to kill.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C4027A8</span></p>
</td>
<td style="width: 588.688px;">
<p>Returns the <span style="font-family: courier new, courier, monospace;">hotPage </span>configuration.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C4027AC</span></p>
</td>
<td style="width: 588.688px;">
<p>Returns the size of the <span style="font-family: courier new, courier, monospace;">hotPage </span>configuration.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C4027E8</span></p>
</td>
<td style="width: 588.688px;">
<p>Returns the <span style="font-family: courier new, courier, monospace;">newtalbe </span>configuration.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C4027EC</span></p>
</td>
<td style="width: 588.688px;">
<p>Returns the size of the <span style="font-family: courier new, courier, monospace;">newtalbe </span>configuration.</p>
</td>
</tr>
<tr>
<td style="width: 96.3125px;">
<p><span style="font-family: courier new, courier, monospace;">0x9C4027FC</span></p>
</td>
<td style="width: 588.688px;">
<p>Parses the <span style="font-family: courier new, courier, monospace;">hotPage </span>configuration passed as an argument.</p>
</td>
</tr>
</tbody>
</table>
<p>When handling the control codes <span style="font-family: courier new, courier, monospace;">0x9C400BFC</span><span style="font-family: courier new, courier, monospace;"> </span>and <span style="font-family: courier new, courier, monospace;">0x9C40173C</span>, the driver iterates over the loaded modules of all the running processes. If one of the targeted modules listed in the <span style="font-family: courier new, courier, monospace;">chromedll</span><span style="font-family: courier new, courier, monospace;"> </span>configuration is found, a request to inject a library into that process is queued.</p>
<p>Finally, the driver ends its initialization by creating two threads and setting the notification routines mentioned above.</p>
<p>It is important to note that the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration is never set. Any mentions of this file are solely made to describe how it would be used according to the driver&rsquo;s control flow. Essentially the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration is used to redirect the user to a specific page (or homepage) filled with ads when a targeted browser is launched.</p>
<p>The version of the software we analyzed relied only on the <span style="font-family: courier new, courier, monospace;">chromedll</span><span style="font-family: courier new, courier, monospace;"> </span>and <span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>configurations to achieve its ad injection.</p>
<h4>Library injection thread</h4>
<p>This thread checks the queued injection requests, and for each of them, it attaches itself to the targeted process via <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/nf-ntifs-kestackattachprocess">KeStackAttachProcess</a>, allocates chunks of memory, and copies its shellcode. Using the Blackbone library function <a href="https://github.com/DarthTon/Blackbone/blob/master/src/BlackBoneDrv/Private.c#L515">ZwCreateThreadEx</a>, the driver calls the shellcode, which implements its own PE loader and calls the entry point of the injected library.</p>
<h4>New tab thread</h4>
<p>The second thread uses the same logic; however, the injected shellcode is different. It calls the Windows API function <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessw">CreateProcessW</a> with the command line parameter being the process name of the targeted process concatenated with the URL that should be opened. The latter is made of the <span style="font-family: courier new, courier, monospace;">URL</span><span style="font-family: courier new, courier, monospace;"> </span>followed by the sum of the <span style="font-family: courier new, courier, monospace;">idindex</span><span style="font-family: courier new, courier, monospace;"> </span>and the <span style="font-family: courier new, courier, monospace;">userid</span><span style="font-family: courier new, courier, monospace;"> </span>variables from the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration. For instance, the configuration shown in Figure 12 would create the string <span style="font-family: courier new, courier, monospace;">https://www.hao774[.]com/?90386-00001</span>. Since Chromium-based browsers create a new process for each new tab, creating a process from the browser process will effectively create a new tab.</p>
<p>Figure 12 shows the content of the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration file.</p>
<figure><img title="Figure 12. The hotPage configuration" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-12-the-hotpage-configuration.png" alt="Figure 12. The hotPage configuration" width="" height="" />
<figcaption><em>Figure 12. The </em><span style="font-family: courier new, courier, monospace;">hotPage</span><em> configuration</em></figcaption>
</figure>
<p>This configuration file contains the list of targeted web browsers and command line parameters that determine whether the process should be injected. The domain names are either related to gaming ads or internet caf&eacute; maintenance.</p>
<h4 id="Process creation notification routine">Process creation notification routine</h4>
<p>Essentially, this routine makes sure the homepage of the new web browser instance is redirected to a specific URL present in the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration. This section describes how the driver implements this feature even if it&rsquo;s not used, since this version of the installer never sends this configuration to the driver.</p>
<p>Depending on the following conditions, the web browser process will be marked as eligible for opening the URL in the <span style="font-family: courier new, courier, monospace;">hotPage</span> configuration:</p>
<ul>
<li>this is the first instance of the browser and not a new tab being opened,</li>
<li>the process&rsquo;s file path matches one of the regular expressions in the <span style="font-family: courier new, courier, monospace;">browser</span><span style="font-family: courier new, courier, monospace;"> </span>list in the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration,</li>
<li>the command line of the process does not match any regular expression in the <span style="font-family: courier new, courier, monospace;">wlist</span><span style="font-family: courier new, courier, monospace;"> </span>list of the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration, and</li>
<li>if the process&rsquo;s command line includes its own file path, it must not match any regular expressions in the <span style="font-family: courier new, courier, monospace;">ppwlist</span><span style="font-family: courier new, courier, monospace;"> </span>list of the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration.</li>
</ul>
<p>As detailed in the next section, when the browser process starts loading the first executable images, a request to open a new tab is queued. Figure 13 and Figure 14, respectively, show the difference between the legitimate web directory <span style="font-family: courier new, courier, monospace;">2345[.]com</span> and the ad-riddled page displayed to the user.</p>
<figure><img title="Figure 13. Legitimate main page of the web directory 2345[.]com" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-13-legitimate-main-page-of-the-web-directory-2345-com.png" alt="Figure 13. Legitimate main page of the web directory 2345[.]com" width="" height="" />
<figcaption><em>Figure 13. Legitimate main page of the web directory </em><span style="font-family: courier new, courier, monospace;">2345[.]com</span></figcaption>
</figure>
<figure><img title="Figure 14. Ad-riddled page mimicking the homepage of 2345[.]com" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-14-ad-riddled-page-mimicking-the-homepage-of-2345-com.png" alt="Figure 14. Ad-riddled page mimicking the homepage of 2345[.]com" width="" height="" />
<figcaption><em>Figure 14. Ad-riddled page mimicking the homepage of </em><span style="font-family: courier new, courier, monospace;">2345[.]com</span></figcaption>
</figure>
<h4 id="Image loading notification routine">Image loading notification routine</h4>
<p>This routine essentially handles two types of scenarios. If the image being loaded is in the <span style="font-family: courier new, courier, monospace;">chromedll</span><span style="font-family: courier new, courier, monospace;"> </span>list, an <a href="https://learn.microsoft.com/en-us/windows/win32/sync/asynchronous-procedure-calls" target="_blank" rel="noopener">APC routine</a> is queued that will load one of the hooking libraries via its own PE loader.</p>
<p>Otherwise, if the process was marked eligible for opening a new page, the malware achieves this either by opening it in a new tab or in the current one. If the process filename matches one of the regular expressions in the <span style="font-family: courier new, courier, monospace;">browser1</span><span style="font-family: courier new, courier, monospace;"> </span>list of the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration, a request to open a new tab is queued and will be handled by the appropriate thread (note that the <span style="font-family: courier new, courier, monospace;">browser1</span><span style="font-family: courier new, courier, monospace;"> </span>list element was not present in the configuration file we retrieved). In the other case, the page will be opened in the tab being created by queuing a work item (via <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/wdm/nf-wdm-ioqueueworkitemex" target="_blank" rel="noopener">IoQueueWorkItemEx</a>) that will modify the command line of the process being created. The latter attaches itself to the process, finds the export address of <span style="font-family: courier new, courier, monospace;">GetCommandLineA</span><span style="font-family: courier new, courier, monospace;"> </span>and <span style="font-family: courier new, courier, monospace;">GetCommandlineW</span><span style="font-family: courier new, courier, monospace;"> </span>inside the <span style="font-family: courier new, courier, monospace;">kernelbase.dll</span> library, and modifies the Unicode string stored in <span style="font-family: courier new, courier, monospace;">BaseAnsiCommandLine</span>. The command line is replaced with the process&rsquo;s executable file path concatenated with the URL in the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>configuration. Figure 15 shows a side-by-side comparison of the code responsible for finding the command line buffer and the disassembly of the <span style="font-family: courier new, courier, monospace;">GetCommandLineA</span><span style="font-family: courier new, courier, monospace;"> </span>function.</p>
<figure><img title="Figure 15. Function that finds the command line buffer (left) and disassembly of the GetCommandlineA function (right)" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-15-function-that-finds-the-command-line-buffer-left-and-disassembly-of-the-getcommandlinea.png" alt="Figure 15. Function that finds the command line buffer (left) and disassembly of the GetCommandlineA" width="" height="" />
<figcaption><em>Figure 15. Function that finds the command line buffer (left) and disassembly of the </em><span style="font-family: courier new, courier, monospace;">GetCommandlineA </span><em>function (right)</em></figcaption>
</figure>
<h2>Injected library</h2>
<p>The first thing that the injected library does is to retrieve the <span style="font-family: courier new, courier, monospace;">hotPage</span><span style="font-family: courier new, courier, monospace;"> </span>and <span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>configurations by querying the driver. If the injected browser filename is 360Chrome, it deletes the registry key <span style="font-family: courier new, courier, monospace;">HKCU\Software\360chrome\Homepage</span> and patches the Preferences file (located under the browser&rsquo;s default directory <span style="font-family: courier new, courier, monospace; white-space: nowrap;">360chrome\chrome\User Data\Default\Preferences)</span> to make the homepage point to the URL value of the <span style="font-family: courier new, courier, monospace;">hotPage</span> configuration.</p>
<p>Using the <a href="https://www.microsoft.com/en-us/research/project/detours/" target="_blank" rel="noopener">Microsoft Detours hooking library</a>, the sample hooks <a href="https://learn.microsoft.com/fr-fr/windows/win32/api/processthreadsapi/nf-processthreadsapi-setprocessmitigationpolicy" target="_blank" rel="noopener">SetProcessMitigationPolicy</a> to make it return 1 in order to prevent security policies from being applied to the process, thereby allowing code injection. Then <a href="https://learn.microsoft.com/en-us/windows/win32/api/ws2tcpip/nf-ws2tcpip-getaddrinfo" target="_blank" rel="noopener">getaddrinfo</a> is hooked to force the browser to resolve certain hostnames to specific IP addresses to ensure the redirection is made to the right server in case the domain names do not exist anymore.</p>
<h4>Hooking SSL_read and SSL_write</h4>
<p>The malware hooks the <a href="https://www.openssl.org/docs/man1.1.1/man3/SSL_read.html" target="_blank" rel="noopener">SSL_read</a> and <a href="https://www.openssl.org/docs/man1.1.1/man3/SSL_write.html" target="_blank" rel="noopener">SSL_write</a> functions to allow the manipulation of the browser&rsquo;s decrypted TLS traffic; it does so by searching for specific patterns inside the loaded modules, since these functions are not exported. For instance, the <span style="font-family: courier new, courier, monospace;">chromewrite</span> dictionary inside the <span style="font-family: courier new, courier, monospace;">chromedll</span><span style="font-family: courier new, courier, monospace;"> </span>configuration contains two types of patterns, <span style="font-family: courier new, courier, monospace;">sslcode</span><span style="font-family: courier new, courier, monospace;"> </span>and <span style="font-family: courier new, courier, monospace;">oldchrome</span>, as seen in Figure 16. They are, respectively, used for finding newer and older versions of the <a href="https://chromium.googlesource.com/chromium/src/+/lkgr/net/socket/ssl_client_socket_impl.cc#1350" target="_blank" rel="noopener">DoPayloadWrite</a> function. We tested and confirmed that the patterns match the Microsoft Edge library <span style="font-family: courier new, courier, monospace;">msedge.dll</span> version <span style="font-family: courier new, courier, monospace;">122.0.2365.80</span>.</p>
<figure><img title="Figure 16. Patterns used to find the DoPayloadWrite function" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-16-patterns-used-to-find-the-dopayloadwrite-function.png" alt="Figure 16. Patterns used to find the DoPayloadWrite function" width="" height="" />
<figcaption><em>Figure 16. Patterns used to find the </em><span style="font-family: courier new, courier, monospace;">DoPayloadWrite</span><em> function</em></figcaption>
</figure>
<p>The <span style="font-family: courier new, courier, monospace;">mode</span> value is used to determine the version of the pattern, either 32-bit or 64-bit; the <span style="font-family: courier new, courier, monospace;">code</span> value is the actual byte pattern, and the <span style="font-family: courier new, courier, monospace;">offset</span> is the distance from the start of the pattern to the pointer to the <span style="font-family: courier new, courier, monospace;">SSL_write</span> function (see Figure 17).</p>
<figure><img title="Figure 17. Finding the pointer to the SSL_write function" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-17-finding-the-pointer-to-the-ssl-write-function.png" alt="Figure 17. Finding the pointer to the SSL_write function" width="" height="" />
<figcaption><em>Figure 17. Finding the pointer to the </em><span style="font-family: courier new, courier, monospace;">SSL_write</span> <em>function</em></figcaption>
</figure>
<p>Once <span style="font-family: courier new, courier, monospace;">SSL_write</span> and <span style="font-family: courier new, courier, monospace;">SSL_read</span> are found, they are hooked using the Detours library. For the former, the malware inspects the data and then calls the original function, which encrypts and sends it. As for the latter, the injected library does the opposite in order to manipulate decrypted data. For both functions, the data is inspected by the code that respectively handles the <span style="font-family: courier new, courier, monospace;">AFD_SEND</span> and <span style="font-family: courier new, courier, monospace;">AFD_RECV</span> control codes in the function hooking <span style="font-family: courier new, courier, monospace;">NtDeviceIoControlFile</span>.</p>
<h3 id="Hooking NtDeviceIoControlFile and inspecting incoming and outgoing data">Hooking NtDeviceIoControlFile and inspecting incoming and outgoing data</h3>
<p>The malicious library hooks the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/nf-winternl-ntdeviceiocontrolfile" target="_blank" rel="noopener">NtDeviceIoControlFile</a> function to handle specific IOCTL codes as seen in Figure 18.</p>
<figure><img title="Figure 18. Hook routine for NtDeviceIoControlFile API function" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-18-hook-routine-for-ntdeviceiocontrolfile-api-function.png" alt="Figure 18. Hook routine for NtDeviceIoControlFile API function" width="" height="" />
<figcaption><em>Figure 18. Hook routine for </em><span style="font-family: courier new, courier, monospace;">NtDeviceIoControlFile</span><em> API function</em></figcaption>
</figure>
<p>For the control code <span style="font-family: courier new, courier, monospace;">0x12023</span> (<span style="font-family: courier new, courier, monospace;">AFD_SEND_DATAGRAM</span> used when sending UDP packets), the malware cancels any DNS requests by returning <span style="font-family: courier new, courier, monospace;">STATUS_INVALID_PARAMETER</span> if the remote port number is 53. This ensures that the web browser only uses the hosts provided by the <span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>configuration.</p>
<p>The routine that handles the control code <span style="font-family: courier new, courier, monospace;">0x1201F</span><span style="font-family: courier new, courier, monospace;"> </span>(<span style="font-family: courier new, courier, monospace;">AFD_SEND</span>) starts by extracting the URL and the Referrer header from the request. Based on the URL matching certain values in the <span style="font-family: courier new, courier, monospace;">newtalbe</span> and <span style="font-family: courier new, courier, monospace;">hotPage</span> configurations, the malware performs assorted actions, as described in Table 4. In some cases, the request is sent but the response is modified in the routine handling the <span style="font-family: courier new, courier, monospace;">AFD_RECV</span><span style="font-family: courier new, courier, monospace;"> </span>control code by different redirection methods explained afterwards.</p>
<p style="text-align: center;"><em>Table 4. List of actions performed under certain conditions when sending HTTP requests</em></p>
<table style="width: 783.578px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 92px;">
<p><strong>Configuration</strong></p>
</td>
<td style="width: 117px;">
<p><strong>Matching&nbsp;value</strong></p>
</td>
<td style="width: 571.578px;">
<p><strong>Action</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">newtalbe</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">cnz</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends info about the compromised computer to the <span style="font-family: courier new, courier, monospace;">apiurl </span>(similar to the end of the installer).</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">hotPage</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">whomepage</span></p>
</td>
<td style="width: 571.578px;">
<p>Increases internal homepage hit counter.</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">hotPage</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">wjclist</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends the data without any modifications.</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">newtalbe</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">url or wlist</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends the data without any modifications.</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">newtalbe</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">blist</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends the data but modifies the response using redirection method&nbsp;<span style="font-family: courier new, courier, monospace;">0</span>. The response is opened in a new browser tab.</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">newtalbe</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">jclist</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends the data but modifies the response using redirection method&nbsp;<span style="font-family: courier new, courier, monospace;">1</span>.</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">newtalbe</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">bcnzlist</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends the data but modifies the response using redirection method&nbsp;<span style="font-family: courier new, courier, monospace;">2</span>.</p>
</td>
</tr>
<tr>
<td style="width: 92px;">
<p><span style="font-family: courier new, courier, monospace;">hotPage</span></p>
</td>
<td style="width: 117px;">
<p><span style="font-family: courier new, courier, monospace;">jclist</span></p>
</td>
<td style="width: 571.578px;">
<p>Sends the data but modifies the response using redirection method&nbsp;<span style="font-family: courier new, courier, monospace;">3</span>.</p>
</td>
</tr>
</tbody>
</table>
<p>For control code <span style="font-family: courier new, courier, monospace;">0x12017</span> (<span style="font-family: courier new, courier, monospace;">AFD_RECV</span>), the malware first retrieves the data received by the client and checks if the response was marked eligible for redirection. There are four types of redirections as described in Table 5. The <span style="font-family: courier new, courier, monospace;">xxx</span> string in the modified response is changed for the URL in the <span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>configuration.</p>
<p style="text-align: center;"><em>Table 5. Redirection methods</em></p>
<table style="width: 782px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 94px;">
<p><strong>Redirection method</strong></p>
</td>
<td style="width: 383.984px;">
<p><strong>Modified response</strong></p>
</td>
<td style="width: 299.016px;">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 94px;">
<p><span style="font-family: courier new, courier, monospace;">0</span></p>
</td>
<td style="width: 383.984px;">
<p style="margin-bottom: 0;"><span style="font-family: courier new, courier, monospace;">HTTP/1.1 302 Moved Temporarily</span></p>
<p style="margin-bottom: 0;"><span style="font-family: courier new, courier, monospace;">Server: nginx</span></p>
<p style="margin-bottom: 0;"><span style="font-family: courier new, courier, monospace;">Content-Type: text/html</span></p>
<p style="margin-bottom: 0;"><span style="font-family: courier new, courier, monospace;">Connection: close</span></p>
<p style="margin-bottom: 0;"><span style="font-family: courier new, courier, monospace;">Location: xxx</span></p>
</td>
<td style="width: 299.016px;">
<p>Redirect the user to another page using the <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.4.3">HTTP code 302</a>; an internal redirection counter is incremented.</p>
</td>
</tr>
<tr>
<td style="width: 94px;">
<p><span style="font-family: courier new, courier, monospace;">1</span></p>
</td>
<td style="width: 383.984px;">
<p><span style="font-family: courier new, courier, monospace;">&lt;html&gt;&lt;head&gt;&lt;meta charset="utf-8"&gt;&lt;meta content="always" name="referrer"&gt;&lt;/head&gt;&lt;body scroll=no style="margin:0;padding:0"&gt;&lt;iframe src="xxx" width=100% height=100% frameborder=0&gt;&lt;/iframe&gt;&lt;/body&gt;&lt;/html&gt;</span></p>
</td>
<td style="width: 299.016px;">
<p>Replace the content of the current page with an <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframe</a> pointing to a new URL.</p>
</td>
</tr>
<tr>
<td style="width: 94px;">
<p><span style="font-family: courier new, courier, monospace;">2</span></p>
</td>
<td style="width: 383.984px;">
<p><span style="font-family: courier new, courier, monospace;">location.replace("xxx")</span></p>
</td>
<td style="width: 299.016px;">
<p>Redirect the current page using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/replace">replace</a> method of the <span style="font-family: courier new, courier, monospace;">Location </span>interface.</p>
</td>
</tr>
<tr>
<td style="width: 94px;">
<p><span style="font-family: courier new, courier, monospace;">3</span></p>
</td>
<td style="width: 383.984px;">
<p><span style="font-family: courier new, courier, monospace;">HTTP/1.1 302 Moved Temporarily</span></p>
<p><span style="font-family: courier new, courier, monospace;">Server: nginx</span></p>
<p><span style="font-family: courier new, courier, monospace;">Content-Type: text/html</span></p>
<p><span style="font-family: courier new, courier, monospace;">Connection: close</span></p>
<p><span style="font-family: courier new, courier, monospace;">Location: xxx</span></p>
</td>
<td style="width: 299.016px;">
<p>Same as redirection <span style="font-family: courier new, courier, monospace;">0</span> but the redirection counter is not incremented.</p>
</td>
</tr>
</tbody>
</table>
<p>Figure 19 illustrates redirection method <span style="font-family: courier new, courier, monospace;">0</span> being applied after navigating to a URL matching one of the <span style="font-family: courier new, courier, monospace;">blist</span><span style="font-family: courier new, courier, monospace;"> </span>URL patterns of the <span style="font-family: courier new, courier, monospace;">newtalbe</span><span style="font-family: courier new, courier, monospace;"> </span>configuration (<span style="font-family: courier new, courier, monospace;">www.5zy[.]cn</span>). Another tab is opened and points to the <span style="font-family: courier new, courier, monospace;">url</span><span style="font-family: courier new, courier, monospace;"> </span>specified in the same configuration.</p>
<figure><img title="Figure 19. Redirection method 0" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-19-redirection-method-0.png" alt="Figure 19. Redirection method 0" width="" height="" />
<figcaption><em>Figure 19. Redirection method </em><span style="font-family: courier new, courier, monospace;">0</span></figcaption>
</figure>
<h3>Security issues and privilege escalation</h3>
<p>When initializing its device object, the driver does not specify any access control lists (<a href="https://github.com/MicrosoftDocs/windows-driver-docs/blob/staging/windows-driver-docs-pr/driversecurity/windows-security-model.md" target="_blank" rel="noopener">ACLs</a>) to restrict who can communicate with it; therefore, anyone can send I/O requests to it. As mentioned previously, some I/O control codes require the requesting process to be in a path matching the regex:</p>
<p><span style="font-family: courier new, courier, monospace;">*ShieldNetWork\\Business\\DwBusiness_*</span></p>
<p>This is clearly not sufficient to check whether the communicating process is one of the HotPage components and can easily be bypassed by creating the required directories under a user-writable folder.</p>
<p>We came up with two scenarios that would allow a user with the HotPage driver running on their system to run code as the <span style="font-family: courier new, courier, monospace;">NT AUTHORITY\System</span> account. We created a proof-of-concept (PoC) script in Python to achieve both scenarios.</p>
<h4>Scenario #1: Privilege escalation via arbitrary DLL injection in arbitrary processes</h4>
<p>In this first scenario, we assume that the driver was loaded but that the <span style="font-family: courier new, courier, monospace;">chromedll</span> configuration and the libraries to inject it were not set. In that case, it is possible to create and set our own library to inject. We created a small library that would simply log the PID of the injected process, whether it is running with administrator privileges, and the injected process&rsquo;s file path.</p>
<p>As seen in the screenshot of the log file in Figure 20, a lot of processes were injected with our library including processes with administrator privileges.</p>
<figure><img title="Figure 20. Log file of our injected library" src="https://web-assets.esetstatic.com/wls/2024/7-2024/hotpage/figure-20-log-file-of-our-injected-library.png" alt="Figure 20. Log file of our injected library" width="" height="" />
<figcaption><em>Figure 20. Log file of our injected library</em></figcaption>
</figure>
<p>It should be noted, however, that <a href="https://learn.microsoft.com/en-us/windows/win32/services/protecting-anti-malware-services-">protected processes</a> cannot be injected using this technique.</p>
<h4>Scenario #2: Privilege escalation via changing the command line of newly created processes</h4>
<p>In the first scenario, we relied on the fact that both the injected libraries and the <span style="font-family: courier new, courier, monospace;">chromedll</span> configuration were not set, but, as seen in the installer analysis, they are both set as soon as the driver is initially loaded. However, the <span style="font-family: courier new, courier, monospace;">hotPage</span> configuration never gets set. Based on the control flow analysis, we devised a way to leverage the driver&rsquo;s process creation and image loading notification routines&rsquo; logic to execute the same executable again but with a different command line.</p>
<p>Under certain conditions, as explained in the <em><a href="#Process creation notification routine">Process creation notification routine</a></em> and <a href="#Image loading notification routine"><em>Image loading notification routine</em></a> sections, the driver can open a new tab pointing to the URL present in the <span style="font-family: courier new, courier, monospace;">hotPage</span> configuration. This is achieved either by replacing the command line of the newly created browser process or by duplicating the browser process and changing its command line to the URL in the <span style="font-family: courier new, courier, monospace;">hotPage</span> configuration. If we specify which process can be duplicated and the new command line, we can achieve privilege escalation by targeting a process with <span style="font-family: courier new, courier, monospace;">SYSTEM</span> privileges, for instance.</p>
<h2>Conclusion</h2>
<p>The analysis of this rather generic-looking piece of malware has proven, once again, that adware developers are still willing to go the extra mile to achieve their goals. Not only that, these have developed a kernel component with a large set of techniques to manipulate processes, but they also went through the requirements imposed by Microsoft to obtain a code-signing certificate for their driver component.</p>
<p>The HotPage driver reminds us that abusing Extended Verification certificates is still a thing. As a lot of security models are at some point based on trust; threat actors are inclined to play along the line between legitimate and shady. Whether such software is advertised as a security solution or simply bundled with other software, the capabilities granted thanks to this trust expose users to security risks.</p>
<p>As annoying as adware can be, the vulnerabilities introduced by this malware leave the system open to even more dangerous threats. An attacker with a non-privileged account could leverage the vulnerable driver to obtain <span style="font-family: courier new, courier, monospace;">SYSTEM</span> privileges or inject libraries into remote processes to cause further damage, all while using a legitimate and signed driver.</p>
<p>ESET technologies detect this threat &ndash; which Microsoft removed from the Windows Server Catalog on May 1<sup>st</sup>, 2024 &ndash; as <span style="font-family: courier new, courier, monospace;">Win{32|64}/HotPage.A</span> and <span style="font-family: courier new, courier, monospace;">Win{32|64}/HotPage.B</span>.</p>
<blockquote>
<div><em>For any inquiries about our research published on WeLiveSecurity, please contact us at <a style="background-color: #f4f4f4;" href="mailto:threatintel@eset.com?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=autotagging&amp;utm_content=eset-research&amp;utm_term=en">threatintel@eset.com</a></em><em>. </em></div>
<div><em>ESET Research offers private APT intelligence reports and data feeds. For any inquiries about this service, visit the <a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=hotpage-story-signed-vulnerable-ad-injecting-driver&amp;sfdccampaignid=7011n0000017htTAAQ" target="_blank" rel="noopener">ESET Threat Intelligence</a> page.</em></div>
</blockquote>
<h2>IoCs</h2>
<p>A comprehensive list of IoCs and samples can be found in our <a title="https://github.com/eset/malware-ioc/tree/master/hotpage" href="https://github.com/eset/malware-ioc/tree/master/hotpage" target="_blank" rel="noopener">GitHub repository</a>.</p>
<h3>Files</h3>
<table style="width: 783px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 186.172px;">
<p><strong>SHA-1</strong></p>
</td>
<td style="width: 101.828px;">
<p><strong>Filename</strong></p>
</td>
<td style="width: 150px;">
<p><strong>Detection</strong></p>
</td>
<td style="width: 339px;">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 186.172px;">
<p><span style="font-family: courier new, courier, monospace;">0D1D298A3EBCA4ECE0BA</span><br /><span style="font-family: courier new, courier, monospace;">52828DD3B7676D884E7F</span></p>
</td>
<td style="width: 101.828px;">
<p>N/A</p>
</td>
<td style="width: 150px;">
<p>Win64/HotPage.B</p>
</td>
<td style="width: 339px;">
<p>HotPage driver.</p>
</td>
</tr>
<tr>
<td style="width: 186.172px;">
<p><span style="font-family: courier new, courier, monospace;">DDD82422D418FC8E8748</span><br /><span style="font-family: courier new, courier, monospace;">BCC7BD2E2BC468124A6B</span></p>
</td>
<td style="width: 101.828px;">
<p>N/A</p>
</td>
<td style="width: 150px;">
<p>Win32/HotPage.B</p>
</td>
<td style="width: 339px;">
<p>32-bit HotPage hooking library.</p>
</td>
</tr>
<tr>
<td style="width: 186.172px;">
<p><span style="font-family: courier new, courier, monospace;">D5D646B052E8B2572399</span><br /><span style="font-family: courier new, courier, monospace;">1CB4CAB51CB2F9D55906</span></p>
</td>
<td style="width: 101.828px;">
<p>N/A</p>
</td>
<td style="width: 150px;">
<p>Win64/HotPage.A</p>
</td>
<td style="width: 339px;">
<p>64-bit HotPage hooking library.</p>
</td>
</tr>
<tr>
<td style="width: 186.172px;">
<p><span style="font-family: courier new, courier, monospace;">941F0D2D4589FB8ADF22</span><br /><span style="font-family: courier new, courier, monospace;">4C8969F74633267B2561</span></p>
</td>
<td style="width: 101.828px;">
<p><span style="font-family: courier new, courier, monospace;">Hotpage.exe</span></p>
</td>
<td style="width: 150px;">
<p>Win32/HotPage.A</p>
</td>
<td style="width: 339px;">
<p>HotPage installer.</p>
</td>
</tr>
</tbody>
</table>
<h3>Network</h3>
<table style="width: 783.641px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 139px;">
<p><strong>IP</strong></p>
</td>
<td style="width: 109px;">
<p><strong>Domain</strong></p>
</td>
<td style="width: 131px;">
<p><strong>Hosting provider</strong></p>
</td>
<td style="width: 83px;">
<p><strong>First&nbsp;seen</strong></p>
</td>
<td style="width: 317.641px;">
<p><strong>Details</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 139px;">
<p><span style="font-family: courier new, courier, monospace;">61.147.93[.]49</span></p>
</td>
<td style="width: 109px;">
<p><span style="font-family: courier new, courier, monospace;">nnijs-f-9-9-1.nycpqx[.]top</span></p>
</td>
<td style="width: 131px;">
<p>CHINATELECOM JiangSu YangZhou IDC.</p>
</td>
<td style="width: 83px;">
<p>2023-10-06</p>
</td>
<td style="width: 317.641px;">
<p>Server used to obtain a list of game-related domains with their corresponding IP addresses.</p>
</td>
</tr>
<tr>
<td style="width: 139px;">
<p><span style="font-family: courier new, courier, monospace;">140.210.24[.]33</span></p>
</td>
<td style="width: 109px;">
<p><span style="font-family: courier new, courier, monospace;">tmrr-s-f-9-9-1.vosdzxhbv[.]top</span></p>
</td>
<td style="width: 131px;">
<p>CHINATELECOM JiangSu YangZhou IDC.</p>
</td>
<td style="width: 83px;">
<p>2023-10-06</p>
</td>
<td style="width: 317.641px;">
<p>Compromised users are redirected to this web server that hosts ad-riddled pages.</p>
</td>
</tr>
<tr>
<td style="width: 139px;">
<p><span style="font-family: courier new, courier, monospace;">202.189.5[.]222</span></p>
</td>
<td style="width: 109px;">
<p>N/A</p>
</td>
<td style="width: 131px;">
<p>Shandong eshinton Network Technology Co., Ltd.</p>
</td>
<td style="width: 83px;">
<p>2023-10-06</p>
</td>
<td style="width: 317.641px;">
<p>Former DwAdsafe domain used to collect information about installations.</p>
</td>
</tr>
</tbody>
</table>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/">version 15</a> of the MITRE ATT&amp;CK framework.</p>
<table style="width: 782.906px;" border="1" cellspacing="0" cellpadding="0">
<thead>
<tr>
<td style="width: 112px;">
<p><strong>Tactic</strong></p>
</td>
<td style="width: 112px;">
<p><strong>ID</strong></p>
</td>
<td style="width: 150px;">
<p><strong>Name</strong></p>
</td>
<td style="width: 404.906px;">
<p><strong>Description</strong></p>
</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 112px;">
<p><strong>Resource Development</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1588/003"><em>T1588.003</em></a></p>
</td>
<td style="width: 150px;">
<p>Obtain Capabilities: Code Signing Certificates</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver is signed with a valid code-signing certificate.</p>
</td>
</tr>
<tr>
<td style="width: 112px;" rowspan="2">
<p><strong>Execution</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1204/002"><em>T1204.002</em></a></p>
</td>
<td style="width: 150px;">
<p>User Execution: Malicious File</p>
</td>
<td style="width: 404.906px;">
<p>The installer component is an executable application.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1569/002"><em>T1569.002</em></a></p>
</td>
<td style="width: 150px;">
<p>System Services: Service Execution</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver is loaded by creating a service.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><strong>Persistence</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1574/013"><em>T1574.013</em></a></p>
</td>
<td style="width: 150px;">
<p>Hijack Execution Flow: KernelCallbackTable</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver installs kernel callbacks to monitor loaded images and process creation.</p>
</td>
</tr>
<tr>
<td style="width: 112px;" rowspan="7">
<p><strong>Defense Evasion</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1055/004"><em>T1055.004</em></a></p>
</td>
<td style="width: 150px;">
<p>Process Injection: Asynchronous Procedure Call</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver can use APC as an injection method.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1553/002"><em>T1553.002</em></a></p>
</td>
<td style="width: 150px;">
<p>Subvert Trust Controls: Code Signing</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver is signed with a valid code-signing certificate.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1140"><em>T1140</em></a></p>
</td>
<td style="width: 150px;">
<p>Deobfuscate/Decode Files or Information</p>
</td>
<td style="width: 404.906px;">
<p>The embedded configuration files are encrypted.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1055/001"><em>T1055.001</em></a></p>
</td>
<td style="width: 150px;">
<p>Process Injection: Dynamic-link Library Injection</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe can hijack web browser processes&rsquo; control flow by injecting DLLs.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1027/009"><em>T1027.009</em></a></p>
</td>
<td style="width: 150px;">
<p>Obfuscated Files or Information: Embedded Payloads</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver and hooking libraries are embedded inside the installer.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1070/004"><em>T1070.004</em></a></p>
</td>
<td style="width: 150px;">
<p>Indicator Removal: File Deletion</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s driver deletes itself from disk.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1027/002"><em>T1027.002</em></a></p>
</td>
<td style="width: 150px;">
<p>Obfuscated Files or Information: Software Packing</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s installer is packed with UPX.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><strong>Discovery</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1033"><em>T1033</em></a></p>
</td>
<td style="width: 150px;">
<p>System Owner/User Discovery</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s installer and the hooking libraries collect the victim&rsquo;s username.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><strong>Collection</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1185"><em>T1185</em></a></p>
</td>
<td style="width: 150px;">
<p>Browser Session Hijacking</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s hooking libraries can intercept and tamper with network traffic inside web browser processes.</p>
</td>
</tr>
<tr>
<td style="width: 112px;" rowspan="2">
<p><strong>Command and Control</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1071/001"><em>T1071.001</em></a></p>
</td>
<td style="width: 150px;">
<p>Application Layer Protocol: Web Protocols</p>
</td>
<td style="width: 404.906px;">
<p>The HTTP protocol is used to send collected information about the user and computer to the C&amp;C.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1573/001"><em>T1573.001</em></a></p>
</td>
<td style="width: 150px;">
<p>Encrypted Channel: Symmetric Cryptography</p>
</td>
<td style="width: 404.906px;">
<p>The RC4 encryption algorithm is used for encrypting communication with the C&amp;C.</p>
</td>
</tr>
<tr>
<td style="width: 112px;">
<p><strong>Impact</strong></p>
</td>
<td style="width: 112px;">
<p><a href="https://attack.mitre.org/versions/v15/techniques/T1565/002"><em>T1565.002</em></a></p>
</td>
<td style="width: 150px;">
<p>Data Manipulation: Transmitted Data Manipulation</p>
</td>
<td style="width: 404.906px;">
<p>DwAdsafe&rsquo;s hooking libraries can intercept and tamper with network traffic inside web browser processes.</p>
</td>
</tr>
</tbody>
</table>
<p><a href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=hotpage-story-signed-vulnerable-ad-injecting-driver&amp;sfdccampaignid=7011n0000017htTAAQ" target="_blank" rel="noopener"><img src="https://web-assets.esetstatic.com/wls/2023/2023-12/welivesecurity-eset-threat-intelligence.jpeg" alt="" width="915" height="296" /></a></p>
</div>                
                <div class="article-subscribe-form mb-4">
                    <hr />
                    <div class="form-wrapper">
  <div class="overlay">
    <h2 class="title">
      Let us keep you <br class='d-md-none'>up to date
    </h2>
    <p class="subtitle">
      Sign up for our newsletters
    </p>
    <div class="form">
        <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter px-0" target="_blank" method="post" role="search">
            <div class="search-input clearfix">
                <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Your Email Address" required>
                    <input type="checkbox" id="TOPIC" name="TOPIC" value="We Live Security Ukraine Newsletter">
                    <label for="TOPIC">Ukraine Crisis newsletter</label>
                    <input type="checkbox" id="NEWSLETTER" name="NEWSLETTER" value="We Live Security">
                    <label for="NEWSLETTER">Regular weekly newsletter</label>
                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="0">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                <button type="submit" class="redirect-button primary">Subscribe</button>
            </div>
        </form>
    </div>
  </div>
  <svg class="wave-overlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 201.7451"><g><path class="cls-1" d="m600,0v176.576c0,13.8934-11.2757,25.1691-25.1691,25.1691H25.1691c-13.9034,0-25.1691-11.2757-25.1691-25.1691v-110.6331c36.0722,38.8207,82.2223,71.8325,145.2255,88.6052.0402,0,.0805.0101.1107.0301,0,0,.0906,0,.1107.0302,108.7605,28.9444,198.3321-8.95,271.9366-49.865l29.5585-16.9537L600,0Z" /></g></svg></div>                </div>

                                    <div class="d-block">
                        <div class="post-related-articles">
        <h4 class="articles-title-divider py-4 my-2">
            Related Articles
        </h4>
            <div class="articles-card-grid row g-0 pb-2 pb-md-3"><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/podcasts/eset-research-podcast-cosmicbeetle/" title="ESET Research Podcast: CosmicBeetle"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">ESET Research Podcast: CosmicBeetle</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2024/10-2024/eset-research-podcast-cosmicbeetle.png" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2024/10-2024/eset-research-podcast-cosmicbeetle.png" alt="ESET Research Podcast: CosmicBeetle" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">ESET Research Podcast: CosmicBeetle</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/embargo-ransomware-rocknrust/" title="Embargo ransomware: Rock’n’Rust"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Embargo ransomware: Rock’n’Rust</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2024/10-2024/embargo-ransomware-rust.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2024/10-2024/embargo-ransomware-rust.jpeg" alt="Embargo ransomware: Rock’n’Rust" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Embargo ransomware: Rock’n’Rust</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div><div class="col-12 col-sm-12 col-md-6 col-lg-4 article"><div class="card-divider"><hr class="articles-card-divider px-0 m-0" /></div><div class="article-card"><a href="/en/eset-research/telekopye-hits-new-hunting-ground-hotel-booking-scams/" title="Telekopye transitions to targeting tourists via hotel booking scam"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="col-9 d-md-none pe-3"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Telekopye transitions to targeting tourists via hotel booking scam</p></div></div><div class="col-3 col-md-12"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x82/wls/2024/10-2024/telekopye/telekopye-booking-sites-fraud.jpeg" media="(max-width: 768px)" /><img class="article-list-image small-card mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x145/wls/2024/10-2024/telekopye/telekopye-booking-sites-fraud.jpeg" alt="Telekopye transitions to targeting tourists via hotel booking scam" loading="lazy" /></picture></div></div></div><div class="article-list-card-body col ps-0"><div class="d-none d-md-block pb-1"><div class="article-list-card-title"><p class="category text-uppercase">ESET Research</p><p class="title">Telekopye transitions to targeting tourists via hotel booking scam</p></div></div><div><div class="article-title-info"><p><b></b></p></div></div></div></div></a></div></div></div></div>                    </div>
                            </div>
            <div class="sidebar col col-lg-4 ps-5 d-none d-lg-block position-sticky">
                <div class="sticky-top sticky-top--container">

                                        <div class="short-articles-section">
    <h3 class="articles-title-divider short-aticles-title pb-4">
        Similar Articles
    </h3>
    <div class="articles">
            <div class="article-list-card"><a href="/2022/01/11/signed-kernel-drivers-unguarded-gateway-windows-core/" title="Signed kernel drivers – Unguarded gateway to Windows’ core"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Signed kernel drivers – Unguarded gateway to Windows’ core</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2022/01/signed-kernel-drivers-windows-vulnerabilities-1.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2022/01/signed-kernel-drivers-windows-vulnerabilities-1.jpg" alt="Signed kernel drivers – Unguarded gateway to Windows’ core"  /></picture></div></div></div></div></a></div>            <hr>
            <div class="article-list-card"><a href="/2018/07/09/certificates-stolen-taiwanese-tech-companies-plead-malware-campaign/" title="Certificates stolen from Taiwanese tech-companies misused in Plead malware campaign"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Certificates stolen from Taiwanese tech-companies misused in Plead malware campaign</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2018/06/DLink_Malware-1.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2018/06/DLink_Malware-1.jpg" alt="Certificates stolen from Taiwanese tech-companies misused in Plead malware campaign"  /></picture></div></div></div></div></a></div>            <hr>
            <div class="article-list-card"><a href="/2019/06/05/wajam-startup-massively-spread-adware/" title="Wajam: From start-up to massively-spread adware"><div class="row g-0 row-cols-1"><div class="article-list-card-header col"><div class="row g-0"><div class="text-card col-9 col-sm-10 col-md-9"><div class="article-list-card-title"><p class="category text-uppercase">ESET research</p><p class="title">Wajam: From start-up to massively-spread adware</p></div></div><div class="image-card col-3 col-sm-2 col-md-3"><picture><source srcset="https://web-assets.esetstatic.com/tn/-x45/wls/2019/06/Untitled-design-2-1.jpg" media="(max-width: 768px)" /><img class="article-list-image mt-1 mt-md-0 w-100"  src="https://web-assets.esetstatic.com/tn/-x82/wls/2019/06/Untitled-design-2-1.jpg" alt="Wajam: From start-up to massively-spread adware"  /></picture></div></div></div></div></a></div>            <hr>
    </div>
</div>
                                        <div class="pb-4">
                        <div class="share-article-card">
                            <div class="sidebar-card-media">
    <div class="mb-3">
        <h3 class="articles-title-divider">Share Article</h3>    </div>
    <div class="medias">
        <a href="https://www.facebook.com/sharer/sharer.php?u&#x3D;https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/" title="Facebook" >
            <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://www.linkedin.com/shareArticle?mini&#x3D;true&amp;url&#x3D;https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/" title="LinkedIn" >
            <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://twitter.com/intent/tweet?url&#x3D;https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/" title="Twitter" >
            <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="twitter"><g id="Layer_2-3"><g id="Research_icons"><path id="twitter-2" fill="white"d="m36.0847,16.9564c1.1786-.1395,2.3298-.4543,3.4153-.934-.7998,1.1935-1.8049,2.2357-2.9686,3.0783v.7675c0,7.8581-5.9779,16.9184-16.9184,16.9184-3.2314.004-6.3954-.9238-9.113-2.6722.4703.0571.9436.0856,1.4173.0853,2.6784.0044,5.2803-.8925,7.3871-2.5463-2.5446-.0467-4.7777-1.7068-5.5555-4.1301.3681.0703.742.1056,1.1168.1056.5293,0,1.0564-.0696,1.5676-.2071-2.775-.5608-4.7696-3.0006-4.7677-5.8317v-.0731c.826.4573,1.7488.712,2.6925.7432-2.6116-1.7476-3.4122-5.2258-1.8275-7.9394,3.0149,3.7157,7.4653,5.9771,12.2441,6.2215-.7617-3.1963,1.2119-6.4049,4.4082-7.1666,2.0894-.4979,4.285.1691,5.7444,1.7451,1.3319-.2639,2.6091-.7528,3.7768-1.4457-.4477,1.3745-1.3782,2.5402-2.6194,3.2813Z" /></g></g></g></g></svg>        </a>
        <a href="mailto:?&amp;subject&#x3D;I wanted you to see this site&amp;body&#x3D;https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/" title="mail" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path id="Path_7761" fill="white"d="m13.1593,14.9378c-.2808,0-.5616.0936-.8424.1872l11.8875,11.5131c.3744.468,1.0296.468,1.404.0936.0936,0,.0936-.0936.0936-.0936l12.0747-11.5131c-.2808-.0936-.5616-.1872-.7488-.1872H13.1593Zm-2.1529,1.9656v15.8188c-.0936,1.2168.8424,2.2465,2.0593,2.3401h23.8686c1.2168-.0936,2.1529-1.1232,2.0593-2.3401v-15.7252l-11.7939,11.3259c-1.2168,1.2168-3.1825,1.2168-4.3057,0l-11.8875-11.4195Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/" title="copy" class="copy-link" >
            <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m32.2813,27.4375l3.7-3.7c2.7-2.7,2.7-7,0-9.7-2.7-2.7-7-2.7-9.7,0h0l-5.3,5.3c-2.7,2.7-2.7,7,0,9.7.4.4.8.7,1.3,1l2.8-2.8c-.6-.1-1.1-.4-1.5-.8-1.2-1.2-1.2-3.2,0-4.4l5.3-5.3c1.3-1.2,3.2-1.1,4.4.1,1.1,1.2,1.1,3.1,0,4.3l-1.6,1.6c.7,1.4.9,3.1.6,4.7h0Zm-14.7-4.7l-3.6,3.6c-2.7,2.7-2.6,7,0,9.7,2.7,2.6,6.9,2.6,9.6,0l5.3-5.3c2.7-2.7,2.7-7,0-9.7-.4-.4-.8-.7-1.3-1l-2.8,2.8c1.7.4,2.7,2.1,2.3,3.7-.1.6-.4,1.1-.8,1.5l-5.3,5.4c-1.2,1.3-3.1,1.3-4.4.1-1.3-1.2-1.3-3.1-.1-4.4,0-.1.1-.1.1-.1l1.6-1.5c-.7-1.6-.9-3.2-.6-4.8h0Z" /></g></svg>        </a>
    </div>
</div>                        </div>
                    </div>
                    <div class="pb-4">
                        <a class="d-block sidebar-card-banner" href="https://www.welivesecurity.com/en/eset-research/eset-apt-activity-report-q4-2023-q1-2024/" title="Apt Activity Report" target="_blank">
    <img src="https://www.welivesecurity.com/build/assets/apt-activity-report-4523d00f.webp" alt="Apt Activity Report" class="w-100" >
</a>                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col col-lg-8 pe-lg-0">
                <div class="my-4">
                    <h3 class="articles-title-divider">Discussion</h3>
                </div>

                <div id="disqus_thread"></div>

            </div>
        </div>
    </div>
        </div>

        <!-- footer -->
        <footer class="page-footer">
  <div class="container">
    <div class="row g-0">
      <div class="col page-info-wrapper">
        <div class="logo-wrapper">
          <div class="logo">
            <a href="/en/" title="Welivesecurity">
              <?xml version="1.0" encoding="UTF-8"?><svg id="Layer_2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 31.7919"><defs><style>.cls-1{fill:#0b8690;}.cls-2{fill:#053b44;}</style></defs><g id="Layer_1-2"><g><path class="cls-2" d="M0,8.6081H5.1069l2.869,10.7299,3.3282-10.845h4.3616l3.3833,10.845,2.9261-10.7879h4.9947l-5.51,17.8465h-4.5336l-3.3833-10.903-3.5012,10.903H5.451L0,8.6081Zm26.6257,9.0093h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3955c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.8729,2.5259c-1.7441,2.1958-4.4284,3.4313-7.2306,3.3282-4.9064,.227-9.0678-3.5664-9.2947-8.4728-.0109-.236-.0124-.4724-.0045-.7085Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm57.842,7.9179l2.1266-3.3282c1.5999,1.2513,3.5393,1.9923,5.566,2.1267,1.4345,0,2.1266-.5162,2.1266-1.3195v-.057c0-1.0904-1.7216-1.4345-3.6733-2.0658-2.4679-.7463-5.2789-1.8937-5.2789-5.3369v-.057c0-3.6153,2.9261-5.6231,6.4843-5.6231,2.3553,.0234,4.6511,.742,6.5994,2.0658l-1.8937,3.5003c-1.4459-.9422-3.1015-1.5139-4.8207-1.6646-1.2054,0-1.8366,.5162-1.8366,1.2054v.057c0,.9754,1.6646,1.4345,3.6153,2.1267,2.4679,.8033,5.3369,2.0087,5.3369,5.2789v.057c0,3.9633-2.9261,5.7381-6.7666,5.7381-2.7543-.0573-5.4158-1.006-7.5854-2.7037Zm15.4356-6.4264h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3233,2.123,2.219,3.6443,4.3616,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3901,.001-9.3534-3.7835-9.3534-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7303-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5747Zm6.1412,1.4906h0c-.0992-5.0349,3.9019-9.197,8.9368-9.2964h.3596c2.6878-.1539,5.2947,.9485,7.0566,2.9841l-3.0991,3.3282c-.9721-1.2277-2.4505-1.9458-4.0165-1.9507-2.5249,0-4.3036,2.2378-4.3036,4.8198v.057c0,2.697,1.7787,4.8778,4.4756,4.8778,1.5606-.0446,3.0342-.7295,4.0745-1.8937l2.9261,2.9841c-1.7686,2.1577-4.4423,3.3673-7.2306,3.2712-5.0035,.0682-9.115-3.9326-9.1832-8.9361,0-.0009,0-.0017,0-.0026,.0026-.0806,.0038-.1614,.0039-.2426Zm17.9606,2.5249V8.6642h5.0498v9.8706c0,2.4099,1.1474,3.6153,3.0411,3.6153s3.1562-1.2054,3.1562-3.6153V8.6071h5.0498V26.3386h-5.0498v-2.5249c-1.1459,1.7743-3.1079,2.8527-5.22,2.869-3.7893,.001-6.0271-2.4669-6.0271-6.5414Zm18.4767-11.5342h5.0498v3.5573c1.0324-2.4679,2.697-4.0165,5.6811-3.9024v5.2789h-.29c-3.3282,0-5.3939,2.0087-5.3939,6.2543v6.5414h-5.047V8.6071Zm12.5666,0h5.0498V26.3386h-5.0498V8.6071Zm8.9561,12.7396V12.9117h-2.1267v-4.3036h2.1267V4.0745h5.0498v4.5336h4.1885v4.3036h-4.1924v7.5747c0,1.1474,.5162,1.7216,1.6066,1.7216,.8637,.0094,1.7148-.2083,2.4679-.6312v4.0165c-1.1964,.7132-2.571,1.0716-3.9633,1.0334-3.0952,.057-5.1571-1.2054-5.1571-5.2799Zm11.4153,9.1813l1.6646-3.6153c.6415,.4009,1.372,.6373,2.1267,.6883,.7821,.0558,1.5071-.4118,1.7787-1.1474l-6.9474-17.7885h5.3369l4.0165,12.1074,3.8444-12.1074h5.22l-6.7666,18.1326c-1.3775,3.6153-2.812,4.9928-5.8531,4.9928-1.5664,.0294-3.1059-.4102-4.4205-1.2625ZM182.4783,1.3195c1.3945,0,2.5249,1.1304,2.5249,2.5249s-1.1304,2.5249-2.5249,2.5249-2.5249-1.1304-2.5249-2.5249,1.1304-2.5249,2.5249-2.5249Zm38.8471,2.754v2.1267h-.6312v-2.1267h-.8603v-.5162h2.3528v.4592h-.8603l-.0009,.057Zm4.0755,2.1238v-1.7796l-.8033,1.7787h-.6312l-.7463-1.7787,.057,.3441v1.3775h-.5732V3.5573h.7463l.8603,2.0658,.9753-2.0658h.6883v2.6399h-.5732Z" /><path class="cls-1" d="M46.2508,2.2378h5.0498V26.3956h-5.0498V2.2378Zm7.9189,6.3693h5.0498V26.3386h-5.0498V8.6071Zm6.5414,0h5.3369l3.9633,11.8783,4.0126-11.8783h5.22l-7.0005,17.8465h-4.5907l-6.9416-17.8465Zm17.9035,9.0102h0c0-5.1069,3.6153-9.2964,8.7792-9.2964,5.9102,0,8.6651,4.5907,8.6651,9.6405,0,.4021-.057,.8603-.057,1.3195h-12.3375c.3232,2.1226,2.2184,3.6438,4.3606,3.5003,1.6303,.0269,3.1951-.6409,4.3036-1.8367l2.869,2.5249c-1.744,2.1959-4.4283,3.4315-7.2306,3.3282-5.3891,.001-9.3524-3.7835-9.3524-9.1804Zm12.5095-1.4916c-.29-2.2378-1.6066-3.7874-3.7294-3.7874s-3.4432,1.4916-3.8444,3.7874h7.5738ZM56.6366,0c-1.7746,0-3.2132,1.4386-3.2132,3.2132,0,1.7746,1.4386,3.2132,3.2132,3.2132,1.7746,0,3.2132-1.4386,3.2132-3.2132h0c-.0188-1.7667-1.4464-3.1943-3.2132-3.2132Zm0,4.5907c-.7567-.0094-1.3677-.6208-1.3765-1.3775-.0202-.7605,.58-1.3933,1.3405-1.4135,.7605-.0202,1.3933,.58,1.4135,1.3405,.0006,.0243,.0006,.0487,0,.073-.0089,.7571-.6204,1.3686-1.3775,1.3775Zm191.3425,4.0213c-2.2021-.0287-4.2611,1.0885-5.4375,2.9502-.9299,1.6095-1.1339,4.233-1.1339,5.9711s.2049,4.3596,1.1339,5.9691c1.1767,1.8615,3.2355,2.9785,5.4375,2.9502h34.4972c2.2018,.0283,4.2603-1.0888,5.4365-2.9502,.928-1.6095,1.1349-4.233,1.1349-5.9711s-.2069-4.3567-1.1349-5.9662c-1.1762-1.8615-3.2347-2.9786-5.4365-2.9502l-34.4972-.0029Zm22.9572,7.9392h2.9v-.0899c0-1.3272-.5326-1.4268-1.4896-1.4268-1.16,0-1.3794,.377-1.4133,1.5167m-20.3859-1.4297c.9512,0,1.4635,.0967,1.4635,1.3997v.0628h-2.8487c.0319-1.1165,.2591-1.4626,1.3852-1.4626m-4.0233,2.463c0,3.1262,.783,4.2533,4.0745,4.2533,1.0071,.0751,2.0175-.0927,2.9464-.4891,.7808-.4894,1.2122-1.3829,1.1097-2.2987h-2.5965c-.0271,.8903-.6322,.9821-1.4626,.9821-1.1996,0-1.4336-.4833-1.4336-1.9788v-.0638h5.4887v-.405c0-3.4123-.9231-4.2668-4.06-4.2668-3.3553,0-4.0745,1.044-4.0745,4.2668m9.8793-1.5621c0,1.6665,.5742,2.4476,4.0735,2.4476,.3744-.0275,.7508,.0097,1.1126,.1102,.2736,.1199,.4021,.3586,.4021,.7927,0,.726-.2658,.8043-1.5128,.8043-.6931,0-1.3987-.0155-1.4307-.9502h-2.6438c.0203,1.8425,.8932,2.4447,2.5085,2.5732,.4882,.0377,1.0188,.0348,1.565,.0348,2.2233,0,4.0735-.3712,4.0735-2.7849,0-2.2997-1.1996-2.463-4.0745-2.5288-1.4268-.0319-1.5109-.3316-1.5109-.8043,0-.5616,.0619-.7405,1.5119-.7405,.5317,0,1.0633,.0474,1.1822,.7086h2.4882v-.3393c0-2.001-2.0967-2.03-3.6733-2.03-2.3625,0-4.0735,.0532-4.0735,2.7066m21.6744-2.7066h6.5018v1.9005h-1.9333v6.525h-2.6274v-6.524h-1.9333l-.0077-1.9014Zm-9.7275,4.2059c0-3.2122,.7086-4.2398,4.0464-4.2398,3.1194,0,4.031,.842,4.031,4.2398v.376h-5.4896v.0909c0,1.4945,.2359,2.0058,1.4587,2.0058,.8226,0,1.45-.0909,1.4896-.9821h2.5413c.0948,.8946-.3269,1.7653-1.0875,2.2456-.9243,.3931-1.9294,.5588-2.9309,.4833-3.276,0-4.0464-1.1088-4.0464-4.2224m-23.7624,5.7874c-1.3214-1.421-1.6134-3.652-1.6134-5.7739s.29-4.35,1.6134-5.7758c1.0333-.9868,2.3994-1.5498,3.828-1.5776h17.7865v14.7048h-17.7865c-1.4285-.0278-2.7946-.5908-3.828-1.5776m43.7423-16.12c.0004-.036-.009-.0714-.0271-.1025-.0116-.0387-.0445-.0628-.086-.0899-.0385-.0194-.0807-.0303-.1237-.0319-.0559-.0087-.1126-.0123-.1692-.0106h-.1508v.5394h.115c.0678,.0013,.1357-.0022,.203-.0106,.0495-.0114,.0968-.0307,.1402-.057,.0317-.0265,.0574-.0594,.0754-.0967,.016-.0456,.0235-.0938,.0222-.1421m.8226,1.3533h-.61l-.5742-.7086h-.1933v.7066h-.4679v-1.913h.7269c.1085-.0031,.2172,.0024,.3248,.0164,.0855,.0088,.1681,.0355,.2426,.0783,.0789,.0405,.1456,.1012,.1933,.1759,.0425,.0819,.0625,.1737,.058,.2658,.0044,.1242-.0384,.2454-.1199,.3393-.0832,.0952-.1884,.1685-.3064,.2136l.7259,.8255Zm.4186-.9203c.0053-.4029-.1547-.7903-.4427-1.072-.2749-.2868-.6574-.4452-1.0546-.4369-.3998-.0086-.7851,.1497-1.0633,.4369-.5856,.5955-.5856,1.5505,0,2.146,.5715,.5851,1.5091,.5962,2.0942,.0247,.0083-.0081,.0166-.0164,.0247-.0247,.289-.2818,.4492-.6703,.4427-1.074m.4253,0c.0069,.5131-.1972,1.0066-.5645,1.3649-.7536,.747-1.9685,.747-2.7221,0-.3705-.3563-.5758-.851-.5665-1.3649-.0083-.5104,.1971-1.001,.5665-1.3533,.7441-.75,1.955-.7561,2.7066-.0135l.0135,.0135c.3662,.3543,.5704,.8438,.5645,1.3533m-64.0238,6.7637h2.1044c1.5563,0,2.32,.6206,2.32,1.74,.0109,.539-.2936,1.0349-.7791,1.2692v.0242c.7243,.1716,1.2395,.8131,1.2509,1.5573,0,1.16-.6767,1.9652-2.5133,1.9652h-2.3828v-6.5559Zm2.0483,2.7588c.7414,0,1.1126-.2591,1.1126-.8893,0-.6767-.4456-.899-1.2799-.899h-.6109v1.7883h.7782Zm.2127,2.7898c.87,0,1.362-.2223,1.362-.9261s-.5007-.9667-1.4829-.9667h-.87v1.8908l.9908,.0019Zm4.9406-1.248l-2.32-4.3007h1.4548l1.5418,3.2267,1.6433-3.2248h1.4084l-2.4659,4.2726v2.2775h-1.2566l-.0058-2.2514Z" /></g></g></svg>            </a>
          </div>
        </div>
        <div class="page-info">
          <p>
            Award-winning news, views, and insight from the ESET security community
          </p>
        </div>
      </div>
      <div class="col footer-links">
        <a href="/en/company/about-us/" title="About us" 
         >About us</a>
        <a href="https://www.eset.com" title="ESET" 
         >ESET</a>
        <a href="/en/company/contact-us/" title="Contact us" 
         >Contact us</a>
        <a href="/en/company/privacy/" title="Privacy Policy" 
         >Privacy Policy</a>
        <a href="/en/company/legal-information/" title="Legal Information" 
         >Legal Information</a>
        <a href="/en/#" title="Manage Cookies" id="manage-cookies" 
         onclick="event.preventDefault()" >Manage Cookies</a>
        <a href="/en/rss/feed/" title="RSS Feed" 
         >RSS Feed</a>
      </div>
      <div class="col social-networks">
        <a href="https://www.facebook.com/eset/" title="Join our facebook fan site!">
          <svg id="Layer_2" fill="#949ca1" class="facebook" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m30.9623,26.8125l.8054-5.2483h-5.0359v-3.4058c0-1.4358.7035-2.8354,2.9589-2.8354h2.2894v-4.4684s-2.0776-.3546-4.064-.3546c-4.1472,0-6.858,2.5137-6.858,7.0642v4h-4.61v5.2483h4.61v12.6875h5.6737v-12.6875h4.2305Z" /></g></svg>        </a>
        <a href="https://youtube.com/esetglobal" title="Watch our videos at YouTube Channel.">
          <svg id="Layer_2" fill="#949ca1" class="youtube" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="Layer_1-2"><g id="youtube"><g id="SOCIAL_MEDIA"><path id="youtube-2" fill="white"d="m39.3741,17.7792c-.3492-1.2938-1.3598-2.3044-2.6536-2.6536-2.3399-.625-11.7206-.625-11.7206-.625,0,0-9.3745,0-11.7206.625-1.2941.3485-2.305,1.3594-2.6536,2.6536-.4319,2.3823-.6412,4.7997-.6249,7.2208-.0162,2.4211.193,4.8385.625,7.2208.3478,1.2946,1.359,2.3058,2.6536,2.6536,2.3399.625,11.7206.625,11.7206.625,0,0,9.3807,0,11.7206-.625,1.2942-.3485,2.3051-1.3594,2.6536-2.6536.4315-2.3824.6408-4.7997.625-7.2208.0158-2.4211-.1934-4.8384-.625-7.2208h0Zm-17.374,11.7205v-8.9994l7.7933,4.4997-7.7933,4.4997Z" /></g></g></g></g></svg>        </a>
        <a href="https://twitter.com/ESET" title="Visit the official WLS Twitter page.">
          <svg id="Layer_2" fill="#949ca1" class="twitter" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="twitter"><g id="Layer_2-3"><g id="Research_icons"><path id="twitter-2" fill="white"d="m36.0847,16.9564c1.1786-.1395,2.3298-.4543,3.4153-.934-.7998,1.1935-1.8049,2.2357-2.9686,3.0783v.7675c0,7.8581-5.9779,16.9184-16.9184,16.9184-3.2314.004-6.3954-.9238-9.113-2.6722.4703.0571.9436.0856,1.4173.0853,2.6784.0044,5.2803-.8925,7.3871-2.5463-2.5446-.0467-4.7777-1.7068-5.5555-4.1301.3681.0703.742.1056,1.1168.1056.5293,0,1.0564-.0696,1.5676-.2071-2.775-.5608-4.7696-3.0006-4.7677-5.8317v-.0731c.826.4573,1.7488.712,2.6925.7432-2.6116-1.7476-3.4122-5.2258-1.8275-7.9394,3.0149,3.7157,7.4653,5.9771,12.2441,6.2215-.7617-3.1963,1.2119-6.4049,4.4082-7.1666,2.0894-.4979,4.285.1691,5.7444,1.7451,1.3319-.2639,2.6091-.7528,3.7768-1.4457-.4477,1.3745-1.3782,2.5402-2.6194,3.2813Z" /></g></g></g></g></svg>        </a>
        <a href="https://www.linkedin.com/company/eset" title="Follow us on LinkedIn.">
          <svg id="Layer_2" fill="#949ca1" class="linkedin" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><path fill="white"d="m18.7686,35.9995h-4.9757v-16.0232h4.9757v16.0232Zm-2.4905-18.2089c-1.5911,0-2.8816-1.3179-2.8816-2.9089.0002-1.5915,1.2906-2.8814,2.882-2.8812,1.5911.0002,2.881,1.29,2.8812,2.8812,0,1.5911-1.2911,2.9089-2.8816,2.9089Zm21.113,18.2089h-4.965v-7.8c0-1.8589-.0375-4.2429-2.587-4.2429-2.587,0-2.9834,2.0196-2.9834,4.1089v7.9339h-4.9704v-16.0232h4.7721v2.1857h.0696c.6643-1.2589,2.287-2.5875,4.7079-2.5875,5.0357,0,5.9614,3.3161,5.9614,7.6232v8.8018h-.0054Z" /></g></svg>        </a>
        <a href="https://www.welivesecurity.com/rss-configurator/" title="Don´t miss a single post!">
          <svg id="Layer_2" fill="#949ca1" class="social-icon" xmlns="http://www.w3.org/2000/svg" width="35" height="35" viewBox="0 0 50 50"><g id="Layer_2-2"><circle cx="25" cy="25" r="25" /><g id="rss"><g id="SOCIAL_MEDIA"><path id="rss-2" fill="white"d="m16.9299,36.9089c-1.8039-.0139-3.255-1.4876-3.2411-3.2915.0139-1.8039,1.4876-3.255,3.2915-3.2411,1.7931.0138,3.2398,1.4706,3.2412,3.2638-.006,1.8113-1.4791,3.2748-3.2904,3.2688-.0004,0-.0008,0-.0012,0Zm12.6168,0c-.0331-8.7521-7.1549-15.8203-15.907-15.7872h-.0014v4.6272c6.1869-.0232,11.2214,4.9731,11.2452,11.16h4.6632Zm8.0916,0c-.0503-13.2044-10.7953-23.8679-23.9997-23.8176-.0001,0-.0002,0-.0003,0v4.7628c10.5637-.0398,19.1597,8.4911,19.2,19.0548h4.8Z" /></g></g></g></svg>        </a>
      </div>
    </div>
    <div class="row g-0">
      <div class="col copyright">
        Copyright © ESET, All Rights Reserved
      </div>
    </div>
  </div>
</footer>    </div>

    <!-- scripts -->
    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/app-7a4ecde0.js"></script>    <link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/search-7d9f58b7.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><script type="module" src="https://www.welivesecurity.com/build/assets/search-7d9f58b7.js"></script>        
<script>

    var disqus_config = function () {
        this.page.url = "https://www.welivesecurity.com/en/eset-research/hotpage-story-signed-vulnerable-ad-injecting-driver/";
        this.page.identifier = "HotPage: Story of a signed, vulnerable, ad-injecting driver";
        this.page.title = "30590";
        this.language = "en";
    };
   
    (function() {
        var d = document, s = d.createElement('script');

        s.src = 'https://welivesecurity.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();

</script>

    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/_commonjsHelpers-042e6b4d.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/prism-40494b65.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/prism-40d1b0a4.js"></script>    <link rel="preload" as="style" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/article-98874652.js" /><link rel="modulepreload" href="https://www.welivesecurity.com/build/assets/table-wrapper-135558d1.js" /><link rel="stylesheet" href="https://www.welivesecurity.com/build/assets/article-e3625c4c.css" /><script type="module" src="https://www.welivesecurity.com/build/assets/article-98874652.js"></script></body>
</html>
