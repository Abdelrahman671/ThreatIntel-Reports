<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/new-cve-223-36584-discovered-in-attack-chain-used-by-russian-apt';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584</title>
	<meta name="description" content="In July 2023, pro-Russian APT Storm-0978 targeted support for Ukrainian NATO admission with an exploit chain. Analysis of it reveals the new CVE-2023-36584." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584" />
	<meta property="og:description" content="In July 2023, pro-Russian APT Storm-0978 targeted support for Ukrainian NATO admission with an exploit chain. Analysis of it reveals the new CVE-2023-36584." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2023-11-13T11:00:23+00:00" />
	<meta property="article:modified_time" content="2024-06-07T18:53:43+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Vulnerabilities_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Eli Birkan, Dan Yashnik, Oriel Cochavi, Bar Lahav, Mike Harbison" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584 Comments Feed" href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt";
webData.pageURL = "https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt";
webData.article_title = "In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584";
webData.author = "Eli Birkan,Dan Yashnik,Oriel Cochavi,Bar Lahav,Mike Harbison";
webData.published_time = "2023-11-13T03:00:23-08:00";
webData.description = "In July 2023, pro-Russian APT Storm-0978 targeted support for Ukrainian NATO admission with an exploit chain. Analysis of it reveals the new CVE-2023-36584.";
webData.keywords = "Malware,Threat Research,Vulnerabilities,CVE-2023-36584,CVE-2023-36884,exploit,Microsoft Office,Microsoft Vulnerability,Remote Code Execution,RomCom,Storm-0978,Ukraine";
webData.resourceAssetID = "896d94f66fc3241f481fd529982a4b39";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="79"/>
<meta property="og:readtime" content="18"/>
<meta property="og:views" content="12,671"/>
<meta property="og:date_created" content="November 13, 2023 at 3:00 AM"/>
<meta property="og:post_length" content="5062"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category" content="Vulnerabilities"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/vulnerabilities/"/>
<meta property="og:author" content="Eli Birkan"/>
<meta property="og:author" content="Dan Yashnik"/>
<meta property="og:author" content="Oriel Cochavi"/>
<meta property="og:author" content="Bar Lahav"/>
<meta property="og:author" content="Mike Harbison"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/mike-harbison/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="CVE-2023-36584,CVE-2023-36884,exploit,Microsoft Office,Microsoft Vulnerability,Remote Code Execution,RomCom,Storm-0978,Ukraine"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/Vulnerability-r3d2.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584","name":"In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584","description":"In July 2023, pro-Russian APT Storm-0978 targeted support for Ukrainian NATO admission with an exploit chain. Analysis of it reveals the new CVE-2023-36584.","url":"https:\/\/unit42.paloaltonetworks.com\/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt\/","datePublished":"November 13, 2023","articleBody":"Executive Summary\r\nDuring our analysis of a July 2023 campaign targeting groups supporting Ukraine's admission into NATO, we discovered a new vulnerability for bypassing Microsoft's Mark-of-the-Web (MotW) security feature. This activity has been attributed by the community to the pro-Russian APT group known as Storm-0978 (also known as the RomCom Group, in reference to their use of the RomCom backdoor). This group used a highly complex and well-developed exploit chain leveraging a remote code execution (RCE) vulnerability in Microsoft Office designated CVE-2023-36884 to infect its targets with malware.\r\n\r\nOur investigation revealed a new exploit method related to CVE-2023-36884 that can bypass MotW. Microsoft awarded our team a bug bounty and assigned CVE-2023-36584 (CVSS score 5) to this new vulnerability discovered during our investigation.\r\n\r\nThe lure for these attacks is a weaponized Microsoft Word document disguised as talking points for attendees of the July 2023 NATO Summit discussing Ukraine\u2019s entry into NATO. This article examines the file and provides technical insight into the attack\u2019s exploit chain that has not yet been publicly discussed.\r\n\r\nPalo Alto Networks customers receive protections from and mitigations for the threats discussed in this article. Cortex XDR and Prisma Cloud detect and prevent this exploit chain in its early and post-exploitation stages. Organizations can also engage the Unit 42 Incident Response team for specific assistance with this and other threats.\r\n\r\n\r\n\r\nRelated Unit 42 Topics\r\nCVE-2023-36884, CVE-2023-36584\r\n\r\n\r\n\r\nIntroduction to the Lure\r\nThis exploit chain begins with the following lure:\r\n\r\n\r\n\r\nFilename\r\nOverview_of_UWCs_UkraineInNATO_campaign.docx\r\n\r\n\r\nSHA256 hash\r\na61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f\r\n\r\n\r\n\r\nWhile monitoring Ukraine's threat landscape, our team observed an interesting Microsoft Word document (.docx file) first submitted to VirusTotal on July 3, 2023, named Overview_of_UWCs_UkraineInNATO_campaign.docx. The filename and content indicate it targeted participants at the July 2023 NATO Summit discussing Ukraine\u2019s entry into NATO.\r\n\r\nThis activity has been attributed by the community to a pro-Russian APT group known as Storm-0978 (also known as the RomCom Group, in reference to their use of the RomCom backdoor). Below, Figure 1 shows a screenshot of this document.\r\n\r\n[caption id=\"attachment_131216\" align=\"aligncenter\" width=\"887\"] Figure 1. Malicious Word document lure.[\/caption]\r\n\r\nVirusTotal indicates this document was hosted at the following URL:\r\n\r\nhxxps:\/\/www.ukrainianworldcongress[.]info\/sites\/default\/files\/document\/forms\/2023\/Overview_of_UWCs_UkraineInNATO_campaign.docx\r\n\r\nThe above link indicates this document was most likely distributed through email, with the email text containing a link to the .docx file. The document\u2019s creation date and the registration date of domain ukrainianworldcongress[.]info are both June 26, 2023. This timing suggests an email-based campaign with a link to the .docx file targeted organizations or individuals attending the July 2023 NATO Summit.\r\n\r\nWhen the file was initially submitted to VirusTotal, 27 of the 62 AV engines identified it as malicious. While we found no evidence this lure was sent to any of our customers, we conducted in-depth analysis to ensure coverage of any associated vulnerabilities.\r\n\r\nOur investigation revealed a new vulnerability for CVE-2023-36584. The next section of this article provides detailed technical analysis and fully explains each step of the full exploit chain.\r\nTechnical Analysis Leading to CVE-2023-36584\r\nOur investigation starts with a closer examination of Overview_of_UWCs_UkraineInNATO_campaign.docx, then we review the remaining steps of this exploit chain in further detail.\r\nA Closer Look at the Word Document\r\nMicrosoft Office documents have been a common attack method for criminals to distribute malware. In response to this threat, Microsoft implemented its MotW security feature that restricts various functions in Office documents from untrusted locations.\r\n\r\nWindows identifies these files as high-risk. A file tagged with MotW generates a SmartScreen prompt indicating it is potentially dangerous.\r\n\r\nIn our .docx file, successful exploitation occurs when the Word document is not tagged as MotW, which causes Protected View to be disabled. We investigated this document to explore the full exploit chain that includes CVE-2023-36884.\r\n\r\nTo understand how CVE-2023-36884 was exploited by this specific lure, we should first understand Microsoft Word\u2019s implementation of the Open XML file format, in this case for MS-DOCX (.docx) files.\r\n\r\nAn MS-DOCX file is a compressed ZIP archive containing multiple specification files used to display the Word document. One of those is an XML file at word\/document.xml. This is the core XML component of an MS-DOCX file, and it contains the document\u2019s text and formatting.\r\n\r\nWhen viewing an MS-DOCX file in Microsoft Word, much of the document's content is imported by word\/document.xml.\r\n\r\nIn our .docx lure, word\/document.xml imports content using the Anchor for Imported External Content element known as altChunk, shown below in Figure 2.\r\n\r\n[caption id=\"attachment_131218\" align=\"aligncenter\" width=\"287\"] Figure 2. Snippet from word\/document.xml.[\/caption]\r\n\r\nThis altChunk element can import content that uses another format, such as Rich Text Format (RTF). As shown above in Figure 2, word\/document.xml from our .docx file has an altChunk element that indicates a relationship (r) to external content using the identifier AltChunkId5. This identifier is defined in a relationship file at word\/_rels\/document.xml.rels.\r\n\r\n[caption id=\"attachment_131220\" align=\"aligncenter\" width=\"677\"] Figure 3. Snippet from word\/_rels\/document.xml.rels.[\/caption]\r\n\r\nThe snippet of document.xml.rels shown above in Figure 3 identifies the imported target as a file at word\/afchunk.rtf.\r\n\r\nThe RTF file afchunk.rtf contains two malicious Object Linking and Embedding (OLE) objects. The first OLE object uses type OLE autolink set with the objautlink RTF control word. After the objautlink control word, an objupdate control word forces the objects to update before they are displayed, as noted below in Figure 4.\r\n\r\n[caption id=\"attachment_131222\" align=\"aligncenter\" width=\"900\"] Figure 4. objautlink snippet from word\/afchunk.rtf.[\/caption]\r\n\r\nAs shown above in Figure 4, the object class is defined as Word.Document.8, and its data contains the LinkedObject structure in its header followed by ASCII text representing hexadecimal characters.\r\n\r\nWe used Didier Steven\u2019s rtfdump.py tool to further inspect afchunk.rtf. Below, Figure 5 shows hexadecimal (hex) output of the objautlink snippet shown previously in Figure 4. This output more clearly shows the LinkedObject structure.\r\n\r\n[caption id=\"attachment_131224\" align=\"aligncenter\" width=\"709\"] Figure 5. rtfdump.py output for first malicious OLE object.[\/caption]\r\n\r\nThis hex dump reveals \\\\104.234.239[.]26\\share1\\MSHTML_C7\\file001.url, a malicious URL that uses the Server Messenger Block (SMB) protocol.\r\n\r\nUsing rtfdump.py to review afchunk.rtf, we found another malicious OLE object using the xmlfile class, and its header contains the EmbeddedObject structure. The embedded object is a compound document that contains a URLMoniker that loads an XML file from the URL hxxp:\/\/74.50.94[.]156\/MSHTML_C7\/start.xml, noted in blue in Figure 6 below.\r\n\r\n[caption id=\"attachment_131226\" align=\"aligncenter\" width=\"713\"] Figure 6. rtfdump.py output for the second malicious OLE object.[\/caption]\r\nFirst Stage of the Exploit Chain\r\nInitial research on this exploit chain resulted in a flow chart created by @zcracga and shared by @r00tbsd on July 12, 2023 (Figure 7). This flow chart is helpful to visualize the different stages as we work our way through the exploit chain.\r\n\r\n[caption id=\"attachment_131228\" align=\"aligncenter\" width=\"900\"] Figure 7. Flow chart of the exploit chain. Source: @r00tbsd post, designed by @zcracga.[\/caption]\r\n\r\nOur initial area of concern is two URLs from the malicious OLE objects in afchunk.rtf. As noted previously, these OLE objects request content from the following URLs:\r\n\r\n \t\\\\104.234.239[.]26\\share1\\MSHTML_C7\\file001.url\r\n \thxxp:\/\/74.50.94[.]156\/MSHTML_C7\/start.xml\r\n\r\nWhen a Windows client connects to an SMB server, that client sends Windows NT LAN Manager (NTLM) credentials for authentication. Because of this, when the victim host accesses the URL at \\\\104.234.239[.]26\\share1\\MSHTML_C7\\file001.url, it leaks the victim's NTLM credentials along with its hostname and username to the attacker-controlled SMB server. The collected information is later used in the attack chain.\r\n\r\nFigure 8 reveals HTML code embedded inside file001.url.\r\n\r\n[caption id=\"attachment_131230\" align=\"aligncenter\" width=\"900\"] Figure 8. Snippet from file001.url.[\/caption]\r\n\r\nExamining file001.url, the UName variable contains the victim\u2019s username. This is the username collected by the attacker-controlled SMB server from the victim\u2019s leaked NTLM credentials. If variable d shown above in Figure 8 is not empty, the exploit chain concatenates the username with an attacker-passed value that is used to create a path to the CHM file named 2222.chm contained in a file named file001.zip.\r\n\r\nAt this stage in the exploit chain, 2222.chm doesn\u2019t exist, or it could be part of some other exploit used by the attackers. Further behaviors of file001.url will be explained later, as it closely relates to 2222.chm.\r\n\r\nThe second malicious OLE object in afchunk.rtf retrieves a file from hxxp:\/\/74.50.94[.]156\/MSHTML_C7\/start.xml. This start.xml file contains an iframe to load another file named RFile.asp, from the same server and directory path. Below, Figure 9 shows the iframe snippet from start.xml referencing RFile.asp.\r\n\r\n[caption id=\"attachment_131232\" align=\"aligncenter\" width=\"658\"] Figure 9. Snippet from start.xml.[\/caption]\r\n\r\nRFile.asp is responsible for loading another file with an attack-specific path on the server defined as:\r\n\r\n \tfile[:]\/\/104.234.239[.]26\/share1\/MSHTML_C7\/1\/&lt;ip&gt;_&lt;id&gt;_file001.htm?d=&lt;ip&gt;_&lt;id&gt;_\r\n\r\nThis path is assembled from the victim\u2019s public IP address for &lt;ip&gt; and a five-digit identifier for &lt;id&gt;. We refer to this file as file001.htm.\r\n\r\n[caption id=\"attachment_131234\" align=\"aligncenter\" width=\"900\"] Figure 10. Snippet from RFile.asp.[\/caption]\r\nAbusing the Windows Search Handler\r\nThe core behavior of file001.htm is the execution of JavaScript as seen below from the code snippet in Figure 11.\r\n\r\n[caption id=\"attachment_131236\" align=\"aligncenter\" width=\"900\"] Figure 11. Snippet from file001.htm.[\/caption]\r\n\r\nJavaScript from file001.htm uses iframes to load several files. It first loads a saved search file with a filename consisting of the victim\u2019s IP address and five-digit identifier that ends with the string file001.search-ms. We will refer to this file as the last part of its filename, file001.search-ms.\r\n\r\nThis is followed by three HTTP requests using the string .zip_k* in their URLs. This behavior has no apparent value besides performing a timing or no-op operation.\r\n\r\nFinally, MSHTML re-loads file001.search-ms and then loads redir_obj.htm.\r\n\r\nThe order of these requests stands out, because the intended purpose is not immediately apparent. Based on the timestamps from an example of the associated network traffic, we speculated this order of events achieved a bypass through server-side manipulation, where the requests to the .zip_k* files are used as a delay mechanism. Figure 12 shows a packet capture (pcap) of the traffic filtered in Wireshark, highlighting a two-second delay between one of the HTTP GET requests and its HTTP response.\r\n\r\n[caption id=\"attachment_131238\" align=\"aligncenter\" width=\"760\"] Figure 12. Delay in response to the request with zip_k.asp. Source: VirusTotal.[\/caption]\r\n\r\nWhen examining the file redir_obj.htm, we found a code snippet shown below in Figure 13. This code loads a file from a local path that uses the leaked hostname and username captured during the initial SMB connection as CompName and UName variables, respectively. This is used to open an HTML file named 1111.htm contained in file file001.zip.\r\n\r\n[caption id=\"attachment_131240\" align=\"aligncenter\" width=\"900\"] Figure 13. Snippet from redir_obj.htm.[\/caption]\r\nRecreating Windows Search Handler File\r\nWe used Windows File Explorer to create a blank saved search file with the .search-ms file extension to control where the ZIP file containing 2222.chm is extracted and illustrate how this exploit chain works. We initiated a search in File Explorer and saved the results, which created a .search-ms file. This saved search file is a blank template that can reproduce search handler file behaviors used in this exploit chain.\r\n\r\nThe Windows system file Windows.Storage.Search.dll processes .search-ms files. In order for the ZIP file to be successfully extracted into the directory specified in the redir_obj.htm file, loaded by the JavaScript iframe shown earlier in Figure 11, several changes need to be made.\r\n\r\nFirst, the include element must contain a local path as its network path and use FILE_ATTRIBUTE_NORMAL, implemented as the variable attributes=\"128\" shown below in Figure 14.\r\n\r\n[caption id=\"attachment_131242\" align=\"aligncenter\" width=\"900\"] Figure 14. Basic .search-ms file, altered to trigger ZIP extraction.[\/caption]\r\n\r\nNext, the autoListFlags attribute must have its second least significant bit turned on, implemented as shown below in Figure 15. This results in a complete search that also includes the content of any ZIP archives.\r\n\r\n[caption id=\"attachment_131244\" align=\"aligncenter\" width=\"838\"] Figure 15. Sample of .search-ms processing in Windows.Storage.Search.dll.[\/caption]\r\n\r\nProcessing the .search-ms file at this point would create a directory on the target machine in the following path:\r\n\r\n \tC:\\Users\\[USERNAME]\\AppData\\Local\\Temp\\[Temp1_zip_filename]\r\n\r\nThe contents of the ZIP file are then extracted into this directory.\r\n\r\nFile .search-ms handles the ZIP file placement and extraction of its contents based on the earlier SMB-leaked host information.\r\n\r\nOur results confirmed the two files extracted from the ZIP file: 1111.htm and 2222.chm.\r\n\r\nSimilar behavior was observed during an exploit for a previous RCE vulnerability in Office, CVE-2021-40444. In that attack, attackers would exploit a Microsoft Compressed Archive (CAB) path traversal extraction bug to achieve a similar objective: extracting an HTML file to a predictable path on the machine.\r\n\r\nBefore discussing our 1111.htm and 2222.chm files, we first should understand Windows Security Zones.\r\nWindows Security Zones and Other Obstacles\r\nAlso known as Internet Explorer Security Zones or URL Security Zones, Windows Security Zones are the mechanism Microsoft uses to determine permissions for files originating from various sources. Typically, files retrieved from the internet are identified as from the \u201cInternet Zone\u201d and tagged with MotW for restricted permissions.\r\n\r\nThis data is stored in the file\u2019s Alternate Data Stream (ADS) named Zone.Identifier to indicate the file\u2019s security zone. Files from the \u201cInternet Zone\u201d are identified with a ZoneId value of 3 (Security Zone 3).\r\n\r\nFor the rest of the exploit chain to succeed, the 1111.htm and 2222.chm files must both be identified with a ZoneId value of 1 in their Zone.Identifier ADS (Security Zone 1). However, this presents an obstacle, because ZIP content downloaded from a remote path and extracted by .search-ms has a ZoneId value of 3, and this content is automatically tagged with MotW.\r\n\r\nTwo other obstacles must also be addressed for successful exploitation:\r\n\r\n \tObstacle 1: When our Windows Search using .search-ms completes, it deletes the [Temp1_zip_filename] directory. This generates a race condition to load files inside the temporary directory.\r\n \tObstacle 2: By default, Windows will not search the contents of CHM files. Our 2222.chm file is required as part of this exploit chain, but it will not be extracted from the ZIP archive using default settings for Windows Search.\r\n\r\nNew MotW Bypass - CVE-2023-36584\r\nDuring our analysis of this exploit chain using CVE-2023-36884, our team discovered a different exploit vector, which Microsoft designated as CVE-2023-36584 and awarded us a bug bounty for.\r\n\r\nWindows Search iterates through all files inside a ZIP archive during its search. Windows Search checks the file extension of each file to determine if its contents also need to be searched. If so, Windows Search writes the file to a temporary directory and adds MotW to it.\r\n\r\nThis implementation generates an inherent race condition. There is a short time window between writing an extracted file to disk and marking it with MotW. If we delay Windows Search during this window, we can solve the race condition and ultimately bypass MotW.\r\n\r\nA previous technique exploiting CVE-2022-41049 bypassed MotW by adding a read-only attribute to files inside the ZIP archive. This avoided modifications to the Zone.Identifier ADS and prevented extracted files from receiving MotW. This technique inspired us and led to our discovery to bypass MotW.\r\nTechnique #1: Server Side ZIP Swap - Metadata TOCTOU\r\nServer-side manipulation enables us to solve these issues. We found a Time-Of-Check to Time-Of-Use (TOCTOU) vulnerability that is exploitable when the ZIP archive is downloaded from a remote server.\r\n\r\nWindows uses the system file zipfldr.dll to extract the content of ZIP archives. This Windows DLL file reads the ZIP file\u2019s header and caches the data in memory while the ZIP archive\u2019s content is extracted and saved to disk. Zipfldr.dll exposes an API, which can be used to extract a file by specifying its index in the ZIP archive.\r\n\r\nWhen using zipfldr.dll to extract contents of a ZIP archive, the extracted file\u2019s header is read from cached memory. This creates a scenario that can prevent extracted files from receiving MotW.\r\n\r\nOnce the file header is read and before it is decompressed using zipfldr.dll, we can replace the ZIP file on the remote server with a ZIP file that holds files with different names, leading to the MotW not being written.\r\n\r\nThis technique works because urlmon.dll uses the file path to write the MotW originally read from the ZIP\u2019s header cached in memory. This makes it possible to bypass writing the MotW to the file.\r\n\r\nThis technique solves the two obstacles mentioned earlier regarding the exploitation of CVE-2023-36884. The .chm file that otherwise would fail to extract is successfully extracted, and the files are not immediately deleted.\r\n\r\nBelow, Figure 16 shows a Process Monitor (procmon) view illustrating failed attempts to create a substitute file named 2222.txt. This condition allows the previously-saved 2222.chm to avoid MotW.\r\n\r\n[caption id=\"attachment_131246\" align=\"aligncenter\" width=\"900\"] Figure 16. Demonstration of MotW bypass using the TOCTOU vulnerability.[\/caption]\r\n\r\nWe cannot confirm this is the exact technique threat actors used in the original exploit chain. However, behavioral logs from VirusTotal\u2019s sandbox analysis of the initial .docx lure show the creation of a file named 1111.txt indicating a possible substitute filename mirroring 1111.htm, and this hints at the same method we discuss here for Technique #1.\r\nTechnique #2: Server Side Delay - Close Operation\r\nDiscovering the first technique opened the door to further research, and we discovered two additional techniques that can significantly delay the writing of the MotW. This scenario prevents the MotW attribute from being written and allows the files to be executed from another thread in Security Zone 1.\r\n\r\nAfter extracting files from the ZIP archive and before the MotW is added to the Zone.Identifier ADS, we can introduce a timing delay from the attacker-controlled SMB server. This is possible due to the SMB2 protocol\u2019s close operation, which consists of a close request and a close response that ends an SMB-based file transfer.\r\n\r\nWhen a client receives all data from the transferred file, it sends an SMB close request back to the server and waits for an SMB close response. The file has been transferred, but the transfer operation is not yet complete until the client receives a close response. This is a synchronic operation, which can be delayed for a significant period of time.\r\n\r\nBelow, the procmon list in Figure 17 shows a 30 second delay after an SMB server at 111.222.111[.]20 transferred a file named served.zip before the next operation. This indicates a 30-second delay between close request and close response.\r\n\r\nDuring this 30-second window, the 1111.htm file is a Security Zone 1 file without MotW. After a close response is finally sent 30 seconds later, the process continues, and it writes the MotW to 1111.htm.\r\n\r\n[caption id=\"attachment_131248\" align=\"aligncenter\" width=\"840\"] Figure 17. Demonstration of MotW bypass using delayed close.[\/caption]\r\nTechnique #3: Server Side Delay - Read Operation\r\nWhen transferring a large file from a ZIP archive, Windows reads portions of the file from the remote share, appends the data to a local file on disk, then reads additional portions from the remote share until the file is fully written to disk. If we append random data at the end of the file (keeping it usable), we can delay writing of the file from the SMB server before Windows adds MotW to the file. The file is usable during this writing process, since it is opened with a read\/write dwShareMode.\r\n\r\nWe tested this theory by introducing ten second delays in the process as shown below in Figure 18.\r\n\r\n[caption id=\"attachment_131250\" align=\"aligncenter\" width=\"759\"] Figure 18. Demonstration of MotW bypass using delayed read response.[\/caption]\r\nMicrosoft Security Updates Address CVE-2023-36884\r\nThe threat actors that developed this exploit chain knew the path for a temporarily-saved local file used during SMB file transfer was predictable. But after Microsoft\u2019s August 2023 security updates, researchers like Will Dorman reported a Universally Unique Identifier (UUID) has been added to the temporarily-saved local filename that makes the path random. We confirmed this, as shown below in Figure 19.\r\n\r\n[caption id=\"attachment_131252\" align=\"aligncenter\" width=\"864\"] Figure 19. Temporarily-saved local file path after Microsoft\u2019s August 2023 security updates.[\/caption]\r\n\r\nAs shown above in Figure 19 during our test run, the temporarily saved file includes the UUID string 90be3adb-6ec5-4f3f-bdd8-1e22ee6c326c in the directory path for the temporarily saved local file.\r\n\r\nDuring the SMB file transfer process for a ZIP archive, zipfldr.dll creates a temporary folder by calling the CTempFileNameArray::GetTempLocation function, which calls CTempFileNameArray::_TryCreatingInPath.\r\n\r\nUsing BinDiff to find changes in the patched version of zipfldr.dll, we spotted a notable new code block in the CTempFileNameArray::_TryCreatingInPath function, as shown below in Figure 20.\r\n\r\n[caption id=\"attachment_131254\" align=\"aligncenter\" width=\"900\"] Figure 20. Call to UuidCreate.[\/caption]\r\n\r\nMicrosoft added a call to UuidCreate, and extracting content from a ZIP archive fails if the path is not constructed with the new UUID.\r\n\r\nAnother interesting update in the patched version of zipfldr.dll is found in the ExtractZipToFile function. New code is added after extracting the file, which will append the MotW immediately after the file is written. If SetFileAttributes fails, the file is deleted, as shown in Figure 21.\r\n\r\n[caption id=\"attachment_131256\" align=\"aligncenter\" width=\"900\"] Figure 21. Call to DeleteFileW.[\/caption]\r\nContinuing the Exploit Chain\r\nAlthough Microsoft's August 2023 Security Updates mitigated this exploit chain, other steps of the chain remained unpatched.\r\nActiveX Attack Surface\r\nRunning a file in Security Zone 1 results in a more permissive policy toward ActiveX controls and provides a greater ActiveX attack surface. This allows executing old ActiveX code that could be exploited to execute malicious code.\r\n\r\nAn increased ActiveX attack surface allows us to trigger the next step in the exploit chain. Below, Figure 22 shows a code snippet from 1111.htm that leads to the next step.\r\n\r\n[caption id=\"attachment_131258\" align=\"aligncenter\" width=\"900\"] Figure 22. 1111.htm reloading in a WebBrowser control.[\/caption]\r\n\r\nThis code from 1111.htm creates a hidden popup and runs the ActiveX WebBrowser control within the hidden popup. The WebBrowser control is a wrapper that allows web browsing functionality in Windows-based applications. Developers often use this ActiveX control to embed an HTML viewer in an application.\r\nElevating Security Zones For Command Execution\r\nWhile Security Zone 1 allows us to avoid MotW and increase the ActiveX attack surface, we can elevate our files to Security Zone 0 for command execution. Files tagged as Security Zone 0 represent the \"Local Machine\" zone, which is the most trusted zone and provides maximum allowable permissions.\r\n\r\nAt this stage, the WebBrowser control redirects the page from a network path in Zone 1 to a local path of the same page. Now that file 1111.htm is loaded from a local path, it executes in Security Zone 0.\r\n\r\nNext, 1111.htm loads 2222.chm by invoking ms-its shown below in Figure 23.\r\n\r\n[caption id=\"attachment_131260\" align=\"aligncenter\" width=\"900\"] Figure 23. 1111.htm loading 2222.chm.[\/caption]\r\n\r\nWindows uses this ms-its handler to display Microsoft Compiled HTML Help (CHM) files. This function is implemented in module itss.dll, which loads the extracted 2222.chm file.\r\n\r\nFigure 24 below reveals the contents of 2222.chm when viewing the file in HTML Help Workshop.\r\n\r\n[caption id=\"attachment_131262\" align=\"aligncenter\" width=\"538\"] Figure 24. Contents of 2222.chm viewed in HTML Help Workshop.[\/caption]\r\n\r\nThe CHM file contains a file named file1.htm, which redirects to file1.mht (handled by inetcomm.dll, part of Microsoft's internet messaging API). Then file1.mht uses the showHelp method to load fileH.htm. Then FileH.htm redirects to fileH.mht, and finally fileH.mht executes the script shown below in Figure 25.\r\n\r\n[caption id=\"attachment_131264\" align=\"aligncenter\" width=\"763\"] Figure 25. Snippet of fileH.mht - code calls open function.[\/caption]\r\n\r\nThe code snippet from fileH.mht in Figure 25 uses the window.open method to invoke the ShellExecuteExW API to open a file at:\r\n\r\n \tfile[:]\/\/104.234.239[.]26\/share1\/MSHTML_C7\/ex001.url\r\n\r\nBypassing SmartScreen\r\nThe Internet Shortcut (URL) file named ex001.url from Figure 25 points to file[:]\/\/104.234.239[.]26\/share1\/MSHTML_C7\/ex001.zip\/file001.vbs.\r\n\r\nThe downloaded file001.vbs file contains malicious Visual Basic Script (VBS) designed to bypass SmartScreen protection.\r\n\r\nWhen a URL file points to a remote UNC path, the URL file downloads and runs content returned from that path. Executing the content calls the ShellExecuteW API which triggers the CheckSmartScreen function, prompting the user for confirmation, as shown below in Figure 26.\r\n\r\n[caption id=\"attachment_131268\" align=\"aligncenter\" width=\"466\"] Figure 26. SmartScreen warning.[\/caption]\r\n\r\nHowever, our file resides within a ZIP archive, so it triggers a slightly different behavioral flow. File file001.vbs is downloaded during the exploit chain and extracted to the user\u2019s local temp directory with MotW, but it is immediately executed without any popup warnings. This is illustrated below from the procmon list below in Figure 27.\r\n\r\n[caption id=\"attachment_131270\" align=\"aligncenter\" width=\"686\"] Figure 27. Wscript.exe is immediately launched, successfully bypassing SmartScreen.[\/caption]\r\n\r\nAs shown above in Figure 27, file ex001.zip is retrieved from a remote directory, then file001.vbs is extracted from the ZIP archive. Later in the process event list, we find a Process Create entry for wscript.exe to run the VBS file, as highlighted in blue.\r\n\r\nThis bypass was also described on Twitter by Will Dormann. This may be a regression, because Microsoft fixed a very similar issue in 2016.\r\nAn Initial Workaround\r\nBefore patching the CVE-2023-36884 vulnerability, Microsoft announced the following mitigation.\r\n\r\n \tDisable cross protocol navigation: Microsoft stated \u201corganizations who cannot take advantage of these protections can set the FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION registry key to avoid exploitation.\u201d\r\n\r\nDisabling cross protocol navigation prevents navigation between URI schemes. This mitigation stops the redirection from RFile.asp, discussed earlier with Figure 9 and Figure 10.\r\nConclusion\r\nStarting with the malicious .docx file, our analysis of the July 2023 campaign targeting groups supporting Ukraine's admission into NATO revealed a more complex exploit than originally reported. Our analysis of this chain revealed a chain of more than 20 steps that not only exploited CVE-2023-36884, but included additional vulnerabilities to bypass protections in Microsoft Office and Windows.\r\n\r\nMicrosoft awarded our team a bug bounty and assigned CVE-2023-36584 to a new vulnerability discovered in our research.\r\n\r\nPalo Alto Networks customers receive protection from and mitigation for these exploits the following ways:\r\n\r\n \tCortex XDR customers received protection from these exploit methods before they\u00a0were discovered.\r\n \tPrisma Cloud is capable of detecting and preventing cloud application deployment that contains exploits against either CVE-2023-36884 or CVE-2023-36584. Protection from these exploits was available out of the box.\r\n\r\nIf you think you may have been compromised or have an urgent matter, contact the Unit 42 Incident Response team or call:\r\n\r\n \tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\r\n \tEMEA: +31.20.299.3130\r\n \tAPAC: +65.6983.8730\r\n \tJapan: +81.50.1790.0200\r\n\r\nFor additional information about how Palo Alto Networks customers receive protection from this exploit chain, see our previous article about CVE-2023-36884.\r\n\r\nPalo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the Cyber Threat Alliance.\r\nIndicators of Compromise\r\nThe following files are associated with the July 2023 campaign lure Overview_of_UWCs_UkraineInNATO_campaign.docx and have been posted to VirusTotal. Of note, SHA256 hashes for some of these files are different for each infection.\r\n\r\nRead: SHA256 hash - Filename\r\n\r\n \ta61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f - Overview_of_UWCs_UkraineInNATO_campaign.docx\r\n \t0896e7c5433b2d426a30a43e7f4ef351fa870be8bd336952a0655392f8f8052d - word\/document.xml\r\n \tb5731baa7920b4649add429fc4a025142ce6a1e1adacb45850470ca4562d5e37 - word\/_rels\/document.xml.rels\r\n \te7cfeb023c3160a7366f209a16a6f6ea5a0bc9a3ddc16c6cba758114dfe6b539 - afchunk.rtf\r\n \t3d0dae359325e8e96cf46459c38d086279865457379bd6380523727db350de43 - file001.url\r\n \t48142dc7fe28a5d8a849fff11cb8206912e8382314a2f05e72abad0978b27e90 - start.xml\r\n \tbfe3ebcc92a4a7d294b63ce0d7eba6313980d982709a27b337abe32651b63856 - file001.zip\r\n \tc94e2bfd4e2241fed42113049c84ac333fcff340cc202afe8926f8e885d5fca3 - 2222.chm\r\n \tf08cc922c5dab73f6a2534f8ceec8525604814ae7541688b7f65ac9924ace855 - 1111.htm\r\n \tcdc39ce48f8f587c536450a3bd0feb58bf40b59b310569797c1c9ae8d28b2914 - RFile.asp\r\n \tfd4fd44ff26e84ce6587413271cf7ff3960471a55eb0d51b0a9870b577d66f4a - file001.htm\r\n \t4fc768476ee92230db5dbc4d8cbca49a71f8433542e62e093c3ad160f699c98d - redir_obj.htm\r\n \t0adb2734a1ca0ccaf27d8a46c08b2fd1e19cb1fbd3fea6d8307851c691011f0f - file1.htm\r\n \t7a1494839927c20a4b27be19041f2a2c2845600691aa9a2032518b81463f83be - file1.mht\r\n \t20f58bd5381509072e46ad79e859fb198335dcd49c2cb738bd76f1d37d24c0a7 - fileH.htm\r\n \tee46f8c9769858aad6fa02466c867d7341ebe8a59c21e06e9e034048013bf65a - fileH.mht\r\n \tc187aa84f92e4cb5b2d9714b35f5b892fa14fec52f2963f72b83c0b2d259449d - ex001.url\r\n\r\nThe following network paths referenced in this research are associated with the July 2023 lure:\r\n\r\n \t\\\\104.234.239[.]26\\share1\\MSHTML_C7\\file001.url\r\n \t\\\\104.234.239[.]26\\share1\\MSHTML_C7\\ex001.url\r\n \tfile[:]\/\/104.234.239[.]26\/share1\/MSHTML_C7\/1\/\r\n \tfile[:]\/\/104.234.239[.]26\/share1\/MSHTML_C7\/ex001.zip\/file001.vbs\r\n \thxxp:\/\/74.50.94[.]156\/MSHTML_C7\/start.xml\r\n \thxxp:\/\/74.50.94[.]156\/MSHTML_C7\/zip_k.asp?d=\r\n \thxxp:\/\/74.50.94[.]156\/MSHTML_C7\/zip_k2.asp?d=\r\n \thxxp:\/\/74.50.94[.]156\/MSHTML_C7\/zip_k3.asp?d=\r\n \thxxps:\/\/www.ukrainianworldcongress[.]info\/sites\/default\/files\/document\/forms\/2023\/Overview_of_UWCs_UkraineInNATO_campaign.docx\r\n\r\nAdditional Resources\r\n\r\n \tCVE-2023-36884 - Microsoft Office and Windows HTML Remote Code Execution: Threat Brief \u2013 Unit 42, Palo Alto Networks\r\n \tStorm-0978 attacks reveal financial and espionage motives \u2013 Microsoft Security\r\n \tThe Tale of Two Exploits \u2013 Breaking Down CVE-2023-36884 and the Infection Chain - Trellix\r\n \tWindows Search Remote Code Execution Vulnerability \u2013 vu.ls blog\r\n \tPost by @r00tbsd on X from thread about CVE-2023-36884 exploit - Post by @r00tbsd on X from thread about CVE-2023-36884 exploit\r\n","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/06\/01_Vulnerabilities_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Eli Birkan"},{"@type":"Person","name":"Dan Yashnik"},{"@type":"Person","name":"Oriel Cochavi"},{"@type":"Person","name":"Bar Lahav"},{"@type":"Person","name":"Mike Harbison"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":131215,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"c3b9727a80","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d123c4ca65"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/131215" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=131215' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-131215 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/01_Vulnerabilities_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/vulnerabilities/" role="link" title="Vulnerabilities" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:breadcrumb:Vulnerabilities">Vulnerabilities</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/vulnerabilities/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Vulnerabilities"><span class="ab-title__pre">Vulnerabilities</span></a> 
              <h1>In-Depth Analysis of July 2023 Exploit Chain Featuring CVE-2023-36884 and CVE-2023-36584</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 18</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/cortex-xdr/" style="--card-color: #00cc66" role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Cortex XDR"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png" alt="Cortex XDR icon">Cortex XDR</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/prisma-cloud/" style="--card-color: #00c0e8" role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Prisma Cloud"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/prisma_RGB_logo_Icon_Color.png" alt="Prisma Cloud icon">Prisma Cloud</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Eli Birkan" href="https://unit42.paloaltonetworks.com/author/eli-birkan/">Eli Birkan</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Dan Yashnik" href="https://unit42.paloaltonetworks.com/author/dan-yashnik/">Dan Yashnik</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Oriel Cochavi" href="https://unit42.paloaltonetworks.com/author/oriel-cochavi/">Oriel Cochavi</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Bar Lahav" href="https://unit42.paloaltonetworks.com/author/bar-lahav/">Bar Lahav</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Mike Harbison" href="https://unit42.paloaltonetworks.com/author/mike-harbison/">Mike Harbison</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>13 November, 2023 at 3:00 AM PST</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Vulnerabilities" href="https://unit42.paloaltonetworks.com/category/vulnerabilities/">Vulnerabilities</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:CVE-2023-36584" href="https://unit42.paloaltonetworks.com/tag/cve-2023-36584/">CVE-2023-36584</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:CVE-2023-36884" href="https://unit42.paloaltonetworks.com/tag/cve-2023-36884/">CVE-2023-36884</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:exploit" href="https://unit42.paloaltonetworks.com/tag/exploit/">Exploit</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Microsoft Office" href="https://unit42.paloaltonetworks.com/tag/microsoft-office/">Microsoft Office</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Microsoft Vulnerability" href="https://unit42.paloaltonetworks.com/tag/microsoft-vulnerability/">Microsoft Vulnerability</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Remote Code Execution" href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/">Remote Code Execution</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:RomCom" href="https://unit42.paloaltonetworks.com/tag/romcom/">RomCom</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Storm-0978" href="https://unit42.paloaltonetworks.com/tag/storm-0978/">Storm-0978</a></li><li><a data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:Ukraine" href="https://unit42.paloaltonetworks.com/tag/ukraine/">Ukraine</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/?pdf=download&#038;lg=en&#038;_wpnonce=dcff69efdc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/?pdf=print&#038;lg=en&#038;_wpnonce=dcff69efdc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" role="link" title="Copy link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=In-Depth%20Analysis%20of%20July%202023%20Exploit%20Chain%20Featuring%20CVE-2023-36884%20and%20CVE-2023-36584&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F&#038;title=In-Depth%20Analysis%20of%20July%202023%20Exploit%20Chain%20Featuring%20CVE-2023-36884%20and%20CVE-2023-36584" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F&#038;text=In-Depth%20Analysis%20of%20July%202023%20Exploit%20Chain%20Featuring%20CVE-2023-36884%20and%20CVE-2023-36584" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=In-Depth%20Analysis%20of%20July%202023%20Exploit%20Chain%20Featuring%20CVE-2023-36884%20and%20CVE-2023-36584%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2><a id="post-131215-_4lt92rr5muov"></a><strong>Executive Summary</strong></h2>
<p>During our analysis of a July 2023 campaign targeting groups supporting Ukraine's admission into NATO, we discovered a new vulnerability for bypassing Microsoft's Mark-of-the-Web (MotW) security feature. This activity has been attributed by the community to the pro-Russian APT group known as Storm-0978 (also known as the RomCom Group, in reference to their use of the RomCom backdoor). This group used a highly complex and well-developed exploit chain leveraging a remote code execution (RCE) vulnerability in Microsoft Office designated <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884" target="_blank" rel="noopener">CVE-2023-36884</a> to infect its targets with malware.</p>
<p>Our investigation revealed a new exploit method related to CVE-2023-36884 that can bypass MotW. Microsoft awarded our team a bug bounty and assigned <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36584" target="_blank" rel="noopener">CVE-2023-36584</a> (CVSS score 5) to this new vulnerability discovered during our investigation.</p>
<p>The lure for these attacks is a weaponized Microsoft Word document disguised as talking points for attendees of the July 2023 NATO Summit discussing Ukraine’s entry into NATO. This article examines the file and provides technical insight into the attack’s exploit chain that has not yet been publicly discussed.</p>
<p>Palo Alto Networks customers receive protections from and mitigations for the threats discussed in this article. <a href="https://docs-cortex.paloaltonetworks.com/p/XDR" target="_blank" rel="noopener">Cortex XDR</a> and <a href="https://docs.paloaltonetworks.com/prisma/prisma-cloud" target="_blank" rel="noopener">Prisma Cloud</a> detect and prevent this exploit chain in its early and post-exploitation stages. Organizations can also engage the <a href="https://start.paloaltonetworks.com/contact-unit42.html">Unit 42 Incident Response team</a> for specific assistance with this and other threats.</p>
<table style="width: 100%;">
<thead>
<tr>
<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>
<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/cve-2023-36884/" target="_blank" rel="noopener"><b>CVE-2023-36884</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/tag/cve-2023-36584/" target="_blank" rel="noopener">CVE-2023-36584</a></strong></td>
</tr>
</thead>
</table>
<h2><a id="post-131215-_tuutxqmk35v4"></a><strong>Introduction to the Lure</strong></h2>
<p>This exploit chain begins with the following lure:</p>
<table style="width: 105%;">
<tbody>
<tr>
<td style="width: 21.5947%;"><b>Filename</b></td>
<td style="width: 77.0764%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">Overview_of_UWCs_UkraineInNATO_campaign.docx</span></td>
</tr>
<tr>
<td style="width: 21.5947%;"><b>SHA256 hash</b></td>
<td style="width: 77.0764%;"><span style="font-weight: 400; font-family: 'courier new', courier, monospace;">a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f</span></td>
</tr>
</tbody>
</table>
<p>While monitoring Ukraine's threat landscape, our team observed an interesting Microsoft Word document (<span style="font-family: 'courier new', courier, monospace;">.docx</span> file) <a href="https://www.virustotal.com/gui/file/a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f" target="_blank" rel="noopener">first submitted to VirusTotal on July 3, 2023</a>, named <span style="font-family: 'courier new', courier, monospace;">Overview_of_UWCs_UkraineInNATO_campaign.docx</span>. The filename and content indicate it targeted participants at the <a href="https://www.nato.int/docu/review/articles/2023/07/27/the-2023-nato-summit-in-retrospect/index.html" target="_blank" rel="noopener">July 2023 NATO Summit</a> discussing Ukraine’s entry into NATO.</p>
<p>This activity has been attributed by the community to a pro-Russian APT group known as <a href="https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/" target="_blank" rel="noopener">Storm-0978</a> (also known as the RomCom Group, in reference to their use of the RomCom backdoor). Below, Figure 1 shows a screenshot of this document.</p>
<figure id="attachment_131216" aria-describedby="caption-attachment-131216" style="width: 887px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131216" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-1.png" alt="Image 1 is a screenshot of the malicious word document learn. A yellow warning ribbon warns the reader that the document isn't protected view. Enable editing button. Ukrainian World Congress logo. Text is in English and Ukrainian. Header of document: Talking points for UW sees Ukraine in NATO Campaign. The text talks about what Ukraine is fighting for." width="887" height="481" /><figcaption id="caption-attachment-131216" class="wp-caption-text">Figure 1. Malicious Word document lure.</figcaption></figure>
<p>VirusTotal indicates this document was hosted at the following URL:</p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxps://www.ukrainianworldcongress[.]info/sites/default/files/document/forms/2023/Overview_of_UWCs_UkraineInNATO_campaign.docx</span></p>
<p>The above link indicates this document was most likely distributed through email, with the email text containing a link to the <span style="font-family: 'courier new', courier, monospace;">.docx</span> file. The document’s creation date and the registration date of domain <span style="font-family: 'courier new', courier, monospace;">ukrainianworldcongress[.]info</span> are both June 26, 2023. This timing suggests an email-based campaign with a link to the <span style="font-family: 'courier new', courier, monospace;">.docx</span> file targeted organizations or individuals attending the July 2023 NATO Summit.</p>
<p>When the file was initially submitted to VirusTotal, 27 of the 62 AV engines identified it as malicious. While we found no evidence this lure was sent to any of our customers, we conducted in-depth analysis to ensure coverage of any associated vulnerabilities.</p>
<p>Our investigation revealed a new vulnerability for CVE-2023-36584. The next section of this article provides detailed technical analysis and fully explains each step of the full exploit chain.</p>
<h2><a id="post-131215-_oosskbwesgbx"></a><strong>Technical Analysis Leading to CVE-2023-36584</strong></h2>
<p>Our investigation starts with a closer examination of <span style="font-family: 'courier new', courier, monospace;">Overview_of_UWCs_UkraineInNATO_campaign.docx</span>, then we review the remaining steps of this exploit chain in further detail.</p>
<h3><a id="post-131215-_i1vh8iskj8dy"></a>A Closer Look at the Word Document</h3>
<p>Microsoft Office documents have been a <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/20-years-of-macro-malware-from-harmless-concept-to-targeted-attacks" target="_blank" rel="noopener">common attack method</a> for criminals to distribute malware. In response to this threat, Microsoft implemented its <a href="https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked#additional-information-about-mark-of-the-web" target="_blank" rel="noopener">MotW security feature</a> that restricts various functions in Office documents from untrusted locations.</p>
<p>Windows identifies these files as high-risk. A file tagged with MotW generates a SmartScreen prompt indicating it is potentially dangerous.</p>
<p>In our <span style="font-family: 'courier new', courier, monospace;">.docx</span> file, successful exploitation occurs when the Word document is not tagged as MotW, which causes <a href="https://support.microsoft.com/en-au/office/what-is-protected-view-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653" target="_blank" rel="noopener">Protected View</a> to be disabled. We investigated this document to explore the full exploit chain that includes CVE-2023-36884.</p>
<p>To understand how CVE-2023-36884 was exploited by this specific lure, we should first understand Microsoft Word’s implementation of the Open XML file format, in this case for <a href="https://msopenspecs.azureedge.net/files/MS-DOCX/%5bMS-DOCX%5d.pdf" target="_blank" rel="noopener">MS-DOCX</a> (<span style="font-family: 'courier new', courier, monospace;">.docx</span>) files.</p>
<p>An MS-DOCX file is a compressed ZIP archive containing multiple specification files used to display the Word document. One of those is an XML file at <span style="font-family: 'courier new', courier, monospace;">word/document.xml</span>. This is the core XML component of an MS-DOCX file, and it contains the document’s text and formatting.</p>
<p>When viewing an MS-DOCX file in Microsoft Word, much of the document's content is imported by <span style="font-family: 'courier new', courier, monospace;">word/document.xml</span>.</p>
<p>In our .docx lure, word/document.xml imports content using the <a href="https://learn.microsoft.com/en-us/dotnet/api/documentformat.openxml.wordprocessing.altchunk?view=openxml-2.8.1#:~:text=altChunk%20(Anchor%20for%20Imported%20External,into%20the%20main%20WordprocessingML%20document." target="_blank" rel="noopener">Anchor for Imported External Content</a> element known as <span style="font-family: 'courier new', courier, monospace;">altChunk</span>, shown below in Figure 2.</p>
<figure id="attachment_131218" aria-describedby="caption-attachment-131218" style="width: 287px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131218" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-2.png" alt="Image 2 is a screenshot snippet from the word document.XML. The ID is AltChunkId5." width="287" height="57" /><figcaption id="caption-attachment-131218" class="wp-caption-text">Figure 2. Snippet from <span style="font-family: 'courier new', courier, monospace;">word/document.xml</span>.</figcaption></figure>
<p>This <span style="font-family: 'courier new', courier, monospace;">altChunk</span> element can import content that uses another format, such as <a href="https://www.adobe.com/acrobat/hub/what-is-rich-text-format.html" target="_blank" rel="noopener">Rich Text Format</a> (RTF). As shown above in Figure 2, <span style="font-family: 'courier new', courier, monospace;">word/document.xml</span> from our <span style="font-family: 'courier new', courier, monospace;">.docx</span> file has an <span style="font-family: 'courier new', courier, monospace;">altChunk</span> element that indicates a relationship (<span style="font-family: 'courier new', courier, monospace;">r</span>) to external content using the identifier <span style="font-family: 'courier new', courier, monospace;">AltChunkId5</span>. This identifier is defined in a relationship file at <span style="font-family: 'courier new', courier, monospace;">word/_rels/document.xml.rels</span>.</p>
<figure id="attachment_131220" aria-describedby="caption-attachment-131220" style="width: 677px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131220" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-3.png" alt="Image 3 is a screenshot of the code declaring the relationship between the type target and the identifier of the word XML.rels." width="677" height="97" /><figcaption id="caption-attachment-131220" class="wp-caption-text">Figure 3. Snippet from <span style="font-family: 'courier new', courier, monospace;">word/_rels/document.xml.rels</span>.</figcaption></figure>
<p>The snippet of <span style="font-family: 'courier new', courier, monospace;">document.xml.rels</span> shown above in Figure 3 identifies the imported target as a file at <span style="font-family: 'courier new', courier, monospace;">word/afchunk.rtf</span>.</p>
<p>The RTF file <span style="font-family: 'courier new', courier, monospace;">afchunk.rtf</span> contains two malicious Object Linking and Embedding (OLE) objects. The first OLE object uses type <span style="font-family: 'courier new', courier, monospace;">OLE autolink</span> set with the <span style="font-family: 'courier new', courier, monospace;">objautlink</span> RTF control word. After the <span style="font-family: 'courier new', courier, monospace;">objautlink</span> control word, an <span style="font-family: 'courier new', courier, monospace;">objupdate</span> control word forces the objects to update before they are displayed, as noted below in Figure 4.</p>
<figure id="attachment_131222" aria-describedby="caption-attachment-131222" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131222" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-4.png" alt="Image 4 is a screenshot of the code that contains the control word to force objects to update. It is underlined in red." width="900" height="74" /><figcaption id="caption-attachment-131222" class="wp-caption-text">Figure 4. <span style="font-family: 'courier new', courier, monospace;">objautlink</span> snippet from <span style="font-family: 'courier new', courier, monospace;">word/afchunk.rtf</span>.</figcaption></figure>
<p>As shown above in Figure 4, the object class is defined as <span style="font-family: 'courier new', courier, monospace;">Word.Document.8</span>, and its data contains the <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/3d3cd59f-88c1-4db4-a4ae-5546fc829478" target="_blank" rel="noopener">LinkedObject</a></span> structure in its header followed by ASCII text representing hexadecimal characters.</p>
<p>We used Didier Steven’s <span style="font-family: 'courier new', courier, monospace;"><a href="https://blog.didierstevens.com/my-software/#rtfdump" target="_blank" rel="noopener">rtfdump.py</a></span> tool to further inspect <span style="font-family: 'courier new', courier, monospace;">afchunk.rtf</span>. Below, Figure 5 shows hexadecimal (hex) output of the <span style="font-family: 'courier new', courier, monospace;">objautlink</span> snippet shown previously in Figure 4. This output more clearly shows the <span style="font-family: 'courier new', courier, monospace;">LinkedObject</span> structure.</p>
<figure id="attachment_131224" aria-describedby="caption-attachment-131224" style="width: 709px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131224" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-5.png" alt="Image 5 is a screenshot of python code output for the first malicious OLE object. Highlighted in purple is the OLEVersion with the format ID. Highlighted in red is the class name. Highlighted in green is the topic name." width="709" height="225" /><figcaption id="caption-attachment-131224" class="wp-caption-text">Figure 5. <span style="font-family: 'courier new', courier, monospace;">rtfdump.py</span> output for first malicious OLE object.</figcaption></figure>
<p>This hex dump reveals <span style="font-family: 'courier new', courier, monospace;">\\104.234.239[.]26\share1\MSHTML_C7\file001.url</span>, a malicious URL that uses the Server Messenger Block (SMB) protocol.</p>
<p>Using <span style="font-family: 'courier new', courier, monospace;">rtfdump.py</span> to review <span style="font-family: 'courier new', courier, monospace;">afchunk.rtf</span>, we found another malicious OLE object using the xmlfile class, and its header contains the <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/3395d95d-97f0-49ff-b792-28d331f254f1" target="_blank" rel="noopener">EmbeddedObject</a></span> structure. The embedded object is a compound document that contains a <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/openspecs/office_file_formats/ms-oshared/4948a119-c4e4-46b6-9609-0525118552e8" target="_blank" rel="noopener">URLMoniker</a></span> that loads an XML file from the URL <span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/start.xml</span>, noted in blue in Figure 6 below.</p>
<figure id="attachment_131226" aria-describedby="caption-attachment-131226" style="width: 713px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131226" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-6.png" alt="Image 6 is a screenshot of the python code output for the second malicious OLE object. Highlighted in red is the embedded object. Highlighted in purple is the compound document magic. Highlighted in green is the URL moniker GUID. Highlighted in blue is the URL." width="713" height="412" /><figcaption id="caption-attachment-131226" class="wp-caption-text">Figure 6. <span style="font-family: 'courier new', courier, monospace;">rtfdump.py</span> output for the second malicious OLE object.</figcaption></figure>
<h3><a id="post-131215-_bcx5nhrzj8kw"></a>First Stage of the Exploit Chain</h3>
<p>Initial research on this exploit chain resulted in a flow chart created by <a href="https://twitter.com/zcracga" target="_blank" rel="noopener">@zcracga</a> <a href="https://twitter.com/r00tbsd/status/1679042071477338114" target="_blank" rel="noopener">and shared by @r00tbsd</a> on July 12, 2023 (Figure 7). This flow chart is helpful to visualize the different stages as we work our way through the exploit chain.</p>
<figure id="attachment_131228" aria-describedby="caption-attachment-131228" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131228" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-7.jpeg" alt="Image 7 is a flow chart of the exploit chain. It starts with a link to the remotely hosted OOXML. It continues through many layers until eventually the downloader VBScript is acquired." width="900" height="1435" /><figcaption id="caption-attachment-131228" class="wp-caption-text">Figure 7. Flow chart of the exploit chain. Source: <a href="https://twitter.com/r00tbsd/status/1679042071477338114" target="_blank" rel="noopener">@r00tbsd post</a>, designed by <a href="https://twitter.com/zcracga" target="_blank" rel="noopener">@zcracga</a>.</figcaption></figure>
<p>Our initial area of concern is two URLs from the malicious OLE objects in <span style="font-family: 'courier new', courier, monospace;">afchunk.rtf</span>. As noted previously, these OLE objects request content from the following URLs:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">\\104.234.239[.]26\share1\MSHTML_C7\file001.url</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/start.xml</span></li>
</ul>
<p>When a Windows client connects to an SMB server, that client sends Windows NT LAN Manager (NTLM) credentials for authentication. Because of this, when the victim host accesses the URL at <span style="font-family: 'courier new', courier, monospace;">\\104.234.239[.]26\share1\MSHTML_C7\file001.url</span>, it leaks the victim's NTLM credentials along with its hostname and username to the attacker-controlled SMB server. The collected information is later used in the attack chain.</p>
<p>Figure 8 reveals HTML code embedded inside <span style="font-family: 'courier new', courier, monospace;">file001.url</span>.</p>
<figure id="attachment_131230" aria-describedby="caption-attachment-131230" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131230" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-8.png" alt="Image 8 is a screenshot of HTML code contained in the file001.url." width="900" height="214" /><figcaption id="caption-attachment-131230" class="wp-caption-text">Figure 8. Snippet from <span style="font-family: 'courier new', courier, monospace;">file001.url</span>.</figcaption></figure>
<p>Examining <span style="font-family: 'courier new', courier, monospace;">file001.url</span>, the <span style="font-family: 'courier new', courier, monospace;">UName</span> variable contains the victim’s username. This is the username collected by the attacker-controlled SMB server from the victim’s leaked NTLM credentials. If variable <span style="font-family: 'courier new', courier, monospace;">d</span> shown above in Figure 8 is not empty, the exploit chain concatenates the username with an attacker-passed value that is used to create a path to the CHM file named <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> contained in a file named <span style="font-family: 'courier new', courier, monospace;">file001.zip</span>.</p>
<p>At this stage in the exploit chain, <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> doesn’t exist, or it could be part of some other exploit used by the attackers. Further behaviors of <span style="font-family: 'courier new', courier, monospace;">file001.url</span> will be explained later, as it closely relates to <span style="font-family: 'courier new', courier, monospace;">2222.chm</span>.</p>
<p>The second malicious OLE object in <span style="font-family: 'courier new', courier, monospace;">afchunk.rtf</span> retrieves a file from <span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/start.xml</span>. This <span style="font-family: 'courier new', courier, monospace;">start.xml</span> file contains an iframe to load another file named <span style="font-family: 'courier new', courier, monospace;">RFile.asp</span>, from the same server and directory path. Below, Figure 9 shows the iframe snippet from <span style="font-family: 'courier new', courier, monospace;">start.xml</span> referencing <span style="font-family: 'courier new', courier, monospace;">RFile.asp</span>.</p>
<figure id="attachment_131232" aria-describedby="caption-attachment-131232" style="width: 658px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131232" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-9.png" alt="Image 9 is a screenshot of a code snippet. It is the begin and end tags of an iframe and includes the RFile.asp." width="658" height="59" /><figcaption id="caption-attachment-131232" class="wp-caption-text">Figure 9. Snippet from <span style="font-family: 'courier new', courier, monospace;">start.xml</span>.</figcaption></figure>
<p><span style="font-family: 'courier new', courier, monospace;">RFile.asp</span> is responsible for loading another file with an attack-specific path on the server defined as:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">file[:]//104.234.239[.]26/share1/MSHTML_C7/1/&lt;ip&gt;_&lt;id&gt;_file001.htm?d=&lt;ip&gt;_&lt;id&gt;_</span></li>
</ul>
<p>This path is assembled from the victim’s public IP address for <span style="font-family: 'courier new', courier, monospace;">&lt;ip&gt;</span> and a five-digit identifier for <span style="font-family: 'courier new', courier, monospace;">&lt;id&gt;</span>. We refer to this file as <span style="font-family: 'courier new', courier, monospace;">file001.htm</span>.</p>
<figure id="attachment_131234" aria-describedby="caption-attachment-131234" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131234" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-10.png" alt="Image 10 is a screenshot of HTML code that includes the iframe beginning and end tags. The iframe includes a source file." width="900" height="49" /><figcaption id="caption-attachment-131234" class="wp-caption-text">Figure 10. Snippet from <span style="font-family: 'courier new', courier, monospace;">RFile.asp</span>.</figcaption></figure>
<h3><a id="post-131215-_xwpk0vx6639q"></a>Abusing the Windows Search Handler</h3>
<p>The core behavior of <span style="font-family: 'courier new', courier, monospace;">file001.htm</span> is the execution of JavaScript as seen below from the code snippet in Figure 11.</p>
<figure id="attachment_131236" aria-describedby="caption-attachment-131236" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131236" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-11.jpeg" alt="Image 11 is a screenshot of code that includes many functions, as well as the timeout command." width="900" height="704" /><figcaption id="caption-attachment-131236" class="wp-caption-text">Figure 11. Snippet from <span style="font-family: 'courier new', courier, monospace;">file001.htm</span>.</figcaption></figure>
<p>JavaScript from <span style="font-family: 'courier new', courier, monospace;">file001.htm</span> uses iframes to load several files. It first loads a <a href="https://learn.microsoft.com/en-us/windows/win32/search/-search-savedsearchfileformat" target="_blank" rel="noopener">saved search file</a> with a filename consisting of the victim’s IP address and five-digit identifier that ends with the string <span style="font-family: 'courier new', courier, monospace;">file001.search-ms</span>. We will refer to this file as the last part of its filename, <span style="font-family: 'courier new', courier, monospace;">file001.search-ms</span>.</p>
<p>This is followed by three HTTP requests using the string <span style="font-family: 'courier new', courier, monospace;">.zip_k*</span> in their URLs. This behavior has no apparent value besides performing a timing or no-op operation.</p>
<p>Finally, MSHTML re-loads <span style="font-family: 'courier new', courier, monospace;">file001.search-ms</span> and then loads <span style="font-family: 'courier new', courier, monospace;">redir_obj.htm</span>.</p>
<p>The order of these requests stands out, because the intended purpose is not immediately apparent. Based on the timestamps from an example of the associated network traffic, we speculated this order of events achieved a bypass through server-side manipulation, where the requests to the <span style="font-family: 'courier new', courier, monospace;">.zip_k*</span> files are used as a delay mechanism. Figure 12 shows a packet capture (pcap) of the traffic filtered in Wireshark, highlighting a two-second delay between one of the HTTP GET requests and its HTTP response.</p>
<figure id="attachment_131238" aria-describedby="caption-attachment-131238" style="width: 760px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131238" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-12.png" alt="Image 12 is a screenshot of a table. The columns are titled time, source, destination, protocol, length and information. Highlighted within a red rectangle are the timestamps in rows five and six." width="760" height="154" /><figcaption id="caption-attachment-131238" class="wp-caption-text">Figure 12. Delay in response to the request with <span style="font-family: 'courier new', courier, monospace;">zip_k.asp</span>. Source: <a href="https://virustotal.com/gui/file/a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f" target="_blank" rel="noopener">VirusTotal</a>.</figcaption></figure>
<p>When examining the file <span style="font-family: 'courier new', courier, monospace;">redir_obj.htm</span>, we found a code snippet shown below in Figure 13. This code loads a file from a local path that uses the leaked hostname and username captured during the initial SMB connection as <span style="font-family: 'courier new', courier, monospace;">CompName</span> and <span style="font-family: 'courier new', courier, monospace;">UName</span> variables, respectively. This is used to open an HTML file named <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> contained in file <span style="font-family: 'courier new', courier, monospace;">file001.zip</span>.</p>
<figure id="attachment_131240" aria-describedby="caption-attachment-131240" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131240" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-13.png" alt="Image 13 is a screenshot of a code snippet used to open an HTML file. " width="900" height="72" /><figcaption id="caption-attachment-131240" class="wp-caption-text">Figure 13. Snippet from <span style="font-family: 'courier new', courier, monospace;">redir_obj.htm</span>.</figcaption></figure>
<h3><a id="post-131215-_f6sycms1bklx"></a>Recreating Windows Search Handler File</h3>
<p>We used Windows File Explorer to create a blank saved search file with the <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> file extension to control where the ZIP file containing <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> is extracted and illustrate how this exploit chain works. We initiated a search in File Explorer and saved the results, which created a <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> file. This saved search file is a blank template that can reproduce search handler file behaviors used in this exploit chain.</p>
<p>The Windows system file <span style="font-family: 'courier new', courier, monospace;">Windows.Storage.Search.dll</span> processes <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> files. In order for the ZIP file to be successfully extracted into the directory specified in the <span style="font-family: 'courier new', courier, monospace;">redir_obj.htm</span> file, loaded by the JavaScript iframe shown earlier in Figure 11, several changes need to be made.</p>
<p>First, the include element must contain a local path as its network path and use <span style="font-family: 'courier new', courier, monospace;">FILE_ATTRIBUTE_NORMAL</span>, implemented as the variable <span style="font-family: 'courier new', courier, monospace;">attributes="128"</span> shown below in Figure 14.</p>
<figure id="attachment_131242" aria-describedby="caption-attachment-131242" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131242" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-14.png" alt="Image 14 is a screenshot of a coat snippet that triggers, the extraction of a zip file. " width="900" height="335" /><figcaption id="caption-attachment-131242" class="wp-caption-text">Figure 14. Basic <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> file, altered to trigger ZIP extraction.</figcaption></figure>
<p>Next, the <span style="font-family: 'courier new', courier, monospace;">autoListFlags</span> attribute must have its second least significant bit turned on, implemented as shown below in Figure 15. This results in a complete search that also includes the content of any ZIP archives.</p>
<figure id="attachment_131244" aria-describedby="caption-attachment-131244" style="width: 838px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131244" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-15.png" alt="Image 15 is a screenshot of code that allows searching within a zip archives. " width="838" height="403" /><figcaption id="caption-attachment-131244" class="wp-caption-text">Figure 15. Sample of <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> processing in <span style="font-family: 'courier new', courier, monospace;">Windows.Storage.Search.dll</span>.</figcaption></figure>
<p>Processing the <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> file at this point would create a directory on the target machine in the following path:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">C:\Users\[<strong>USERNAME</strong>]\AppData\Local\Temp\<em>[Temp1_zip_filename]</em></span></li>
</ul>
<p>The contents of the ZIP file are then extracted into this directory.</p>
<p>File <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> handles the ZIP file placement and extraction of its contents based on the earlier SMB-leaked host information.</p>
<p>Our results confirmed the two files extracted from the ZIP file: <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> and <span style="font-family: 'courier new', courier, monospace;">2222.chm</span>.</p>
<p>Similar behavior was observed during an exploit for a previous RCE vulnerability in Office, <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444" target="_blank" rel="noopener">CVE-2021-40444</a>. In that attack, attackers would exploit a Microsoft Compressed Archive (CAB) path traversal extraction bug to achieve a similar objective: extracting an HTML file to a predictable path on the machine.</p>
<p>Before discussing our <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> and <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> files, we first should understand Windows Security Zones.</p>
<h3><a id="post-131215-_5ezjvqy94ik7"></a>Windows Security Zones and Other Obstacles</h3>
<p>Also known as Internet Explorer Security Zones or URL Security Zones, <a href="https://learn.microsoft.com/en-us/deployedge/per-site-configuration-by-policy#windows-security-zones" target="_blank" rel="noopener">Windows Security Zones</a> are the mechanism Microsoft uses to determine permissions for files originating from various sources. Typically, files retrieved from the internet are identified as from the “Internet Zone” and tagged with MotW for restricted permissions.</p>
<p>This data is stored in the file’s <a href="https://www.malwarebytes.com/blog/news/2015/07/introduction-to-alternate-data-streams" target="_blank" rel="noopener">Alternate Data Stream</a> (ADS) named <a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/6e3f7352-d11c-4d76-8c39-2516a9df36e8" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span></a> to indicate the file’s security zone. Files from the “Internet Zone” are identified with a <a href="https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked#mark-of-the-web-and-zones" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">ZoneId</span> value of 3</a> (Security Zone 3).</p>
<p>For the rest of the exploit chain to succeed, the <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> and <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> files must both be identified with a <span style="font-family: 'courier new', courier, monospace;">ZoneId</span> value of 1 in their <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> ADS (Security Zone 1). However, this presents an obstacle, because ZIP content downloaded from a remote path and extracted by <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> has a <span style="font-family: 'courier new', courier, monospace;">ZoneId</span> value of 3, and this content is automatically tagged with MotW.</p>
<p>Two other obstacles must also be addressed for successful exploitation:</p>
<ul>
<li><strong>Obstacle 1:</strong> When our Windows Search using <span style="font-family: 'courier new', courier, monospace;">.search-ms</span> completes, it deletes the <em>[<span style="font-family: 'courier new', courier, monospace;">Temp1_zip_filename</span>] </em>directory. This generates a race condition to load files inside the temporary directory.</li>
<li><strong>Obstacle 2: </strong>By default, Windows <a href="https://learn.microsoft.com/en-us/windows/win32/search/-search-ifilter-implementations#filter-handlers-that-ship-with-windows" target="_blank" rel="noopener">will not search the contents of CHM files</a>. Our <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> file is required as part of this exploit chain, but it will not be extracted from the ZIP archive using default settings for Windows Search.</li>
</ul>
<h3><a id="post-131215-_l8q8587fnln5"></a>New MotW Bypass - CVE-2023-36584</h3>
<p>During our analysis of this exploit chain using CVE-2023-36884, our team discovered a different exploit vector, which Microsoft designated as <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36584" target="_blank" rel="noopener">CVE-2023-36584</a> and awarded us a bug bounty for.</p>
<p>Windows Search iterates through all files inside a ZIP archive during its search. Windows Search checks the file extension of each file to determine if its contents also need to be searched. If so, Windows Search writes the file to a temporary directory and adds MotW to it.</p>
<p>This implementation generates an inherent race condition. There is a short time window between writing an extracted file to disk and marking it with MotW. If we delay Windows Search during this window, we can solve the race condition and ultimately bypass MotW.</p>
<p>A previous technique exploiting <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-41049" target="_blank" rel="noopener">CVE-2022-41049</a> bypassed MotW by adding a read-only attribute to files inside the ZIP archive. This avoided modifications to the <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> ADS and prevented extracted files from receiving MotW. This technique inspired us and led to our discovery to bypass MotW.</p>
<h4><a id="post-131215-_9vboh7ebxwbb"></a><strong>Technique #1: Server Side ZIP Swap - Metadata TOCTOU</strong></h4>
<p>Server-side manipulation enables us to solve these issues. We found a Time-Of-Check to Time-Of-Use (TOCTOU) vulnerability that is exploitable when the ZIP archive is downloaded from a remote server.</p>
<p>Windows uses the system file <span style="font-family: 'courier new', courier, monospace;">zipfldr.dll</span> to extract the content of ZIP archives. This Windows DLL file reads the ZIP file’s header and caches the data in memory while the ZIP archive’s content is extracted and saved to disk. <span style="font-family: 'courier new', courier, monospace;">Zipfldr.dll</span> exposes an API, which can be used to extract a file by specifying its index in the ZIP archive.</p>
<p>When using <span style="font-family: 'courier new', courier, monospace;">zipfldr.dll</span> to extract contents of a ZIP archive, the extracted file’s header is read from cached memory. This creates a scenario that can prevent extracted files from receiving MotW.</p>
<p>Once the file header is read and before it is decompressed using <span style="font-family: 'courier new', courier, monospace;">zipfldr.dll</span>, we can replace the ZIP file on the remote server with a ZIP file that holds files with different names, leading to the MotW not being written.</p>
<p>This technique works because <span style="font-family: 'courier new', courier, monospace;">urlmon.dll</span> uses the file path to write the MotW originally read from the ZIP’s header cached in memory. This makes it possible to bypass writing the MotW to the file.</p>
<p>This technique solves the two obstacles mentioned earlier regarding the exploitation of <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884" target="_blank" rel="noopener">CVE-2023-36884</a>. The <span style="font-family: 'courier new', courier, monospace;">.chm</span> file that otherwise would fail to extract is successfully extracted, and the files are not immediately deleted.</p>
<p>Below, Figure 16 shows a <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procmon" target="_blank" rel="noopener">Process Monitor</a> (procmon) view illustrating failed attempts to create a substitute file named <span style="font-family: 'courier new', courier, monospace;">2222.txt</span>. This condition allows the previously-saved <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> to avoid MotW.</p>
<figure id="attachment_131246" aria-describedby="caption-attachment-131246" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131246" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-16.jpeg" alt="Image 16 is a screenshot of the MOTW bypass using the TOCTOU vulnerability. Highlighted in an a red rectangle are the WriteFiles, CloseFiles, SetBasicInformationFile rows." width="900" height="348" /><figcaption id="caption-attachment-131246" class="wp-caption-text">Figure 16. Demonstration of MotW bypass using the TOCTOU vulnerability.</figcaption></figure>
<p>We cannot confirm this is the exact technique threat actors used in the original exploit chain. However, <a href="https://www.virustotal.com/gui/file/a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f/behavior" target="_blank" rel="noopener">behavioral logs</a> from VirusTotal’s sandbox analysis of the initial <span style="font-family: 'courier new', courier, monospace;">.docx</span> lure show the creation of a file named <span style="font-family: 'courier new', courier, monospace;">1111.txt</span> indicating a possible substitute filename mirroring <span style="font-family: 'courier new', courier, monospace;">1111.htm</span>, and this hints at the same method we discuss here for Technique #1.</p>
<h4><a id="post-131215-_yrg5tgqrivmo"></a><strong>Technique #2: Server Side Delay - Close Operation</strong></h4>
<p>Discovering the first technique opened the door to further research, and we discovered two additional techniques that can significantly delay the writing of the MotW. This scenario prevents the MotW attribute from being written and allows the files to be executed from another thread in Security Zone 1.</p>
<p>After extracting files from the ZIP archive and before the MotW is added to the <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> ADS, we can introduce a timing delay from the attacker-controlled SMB server. This is possible due to the SMB2 protocol’s <a href="https://wiki.wireshark.org/SMB2/Close" target="_blank" rel="noopener">close operation</a>, which consists of a <a href="https://wiki.wireshark.org/SMB2/Close" target="_blank" rel="noopener">close request</a> and a <a href="https://wiki.wireshark.org/SMB2/Close#smb2-close-response" target="_blank" rel="noopener">close response</a> that ends an SMB-based file transfer.</p>
<p>When a client receives all data from the transferred file, it sends an SMB close request back to the server and waits for an SMB close response. The file has been transferred, but the transfer operation is not yet complete until the client receives a close response. This is a <a href="https://www.sciencedirect.com/topics/computer-science/synchronous-operation#:~:text=Synchronous%20operations%20require%20that%20one,it%20can%20begin." target="_blank" rel="noopener">synchronic operation</a>, which can be delayed for a significant period of time.</p>
<p>Below, the procmon list in Figure 17 shows a 30 second delay after an SMB server at <span style="font-family: 'courier new', courier, monospace;">111.222.111[.]20</span> transferred a file named <span style="font-family: 'courier new', courier, monospace;">served.zip</span> before the next operation. This indicates a 30-second delay between close request and close response.</p>
<p>During this 30-second window, the <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> file is a Security Zone 1 file without MotW. After a close response is finally sent 30 seconds later, the process continues, and it writes the MotW to <span style="font-family: 'courier new', courier, monospace;">1111.htm</span>.</p>
<figure id="attachment_131248" aria-describedby="caption-attachment-131248" style="width: 840px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131248" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-17.png" alt="Image 17 is a screenshot of the MOTW bypass delaying close. Highlighted in an a red rectangle are the CloseFile and CreateFile rows." width="840" height="312" /><figcaption id="caption-attachment-131248" class="wp-caption-text">Figure 17. Demonstration of MotW bypass using delayed close.</figcaption></figure>
<h4><a id="post-131215-_b9o44ex44deu"></a><strong>Technique #3: Server Side Delay - Read Operation</strong></h4>
<p>When transferring a large file from a ZIP archive, Windows reads portions of the file from the remote share, appends the data to a local file on disk, then reads additional portions from the remote share until the file is fully written to disk. If we append random data at the end of the file (keeping it usable), we can delay writing of the file from the SMB server before Windows adds MotW to the file. The file is usable during this writing process, since it is opened with a read/write <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea#:~:text=%5Bin%5D%20dwShareMode,not%20affected%20by%20this%20flag." target="_blank" rel="noopener">dwShareMode</a></span>.</p>
<p>We tested this theory by introducing ten second delays in the process as shown below in Figure 18.</p>
<figure id="attachment_131250" aria-describedby="caption-attachment-131250" style="width: 759px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131250" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-18.png" alt="Image 18 is a screenshot of the MOTW bypass delaying close. Highlighted in an a red rectangle are the ReadFile rows." width="759" height="161" /><figcaption id="caption-attachment-131250" class="wp-caption-text">Figure 18. Demonstration of MotW bypass using delayed read response.</figcaption></figure>
<h3><a id="post-131215-_39t3okxnupxr"></a>Microsoft Security Updates Address CVE-2023-36884</h3>
<p>The threat actors that developed this exploit chain knew the path for a temporarily-saved local file used during SMB file transfer was predictable. But after Microsoft’s August 2023 security updates, researchers like <a href="https://twitter.com/wdormann" target="_blank" rel="noopener">Will Dorman</a> reported <a href="https://twitter.com/wdormann/status/1694052566890385798" target="_blank" rel="noopener">a Universally Unique Identifier (UUID) has been added</a> to the temporarily-saved local filename that makes the path random. We confirmed this, as shown below in Figure 19.</p>
<figure id="attachment_131252" aria-describedby="caption-attachment-131252" style="width: 864px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131252" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-19.png" alt="Image 19 is a screenshot of of the temporarily-saved local file path after Microsoft, August 2023 security updates. The rows include create file, query, basic information, query all information, and others." width="864" height="110" /><figcaption id="caption-attachment-131252" class="wp-caption-text">Figure 19. Temporarily-saved local file path after Microsoft’s August 2023 security updates.</figcaption></figure>
<p>As shown above in Figure 19 during our test run, the temporarily saved file includes the UUID string <span style="font-family: 'courier new', courier, monospace;">90be3adb-6ec5-4f3f-bdd8-1e22ee6c326c</span> in the directory path for the temporarily saved local file.</p>
<p>During the SMB file transfer process for a ZIP archive, <span style="font-family: 'courier new', courier, monospace;">zipfldr.dll</span> creates a temporary folder by calling the <span style="font-family: 'courier new', courier, monospace;">CTempFileNameArray::GetTempLocation</span> function, which calls <span style="font-family: 'courier new', courier, monospace;">CTempFileNameArray::_TryCreatingInPath</span>.</p>
<p>Using <span style="font-family: 'courier new', courier, monospace;"><a href="https://www.zynamics.com/bindiff.html" target="_blank" rel="noopener">BinDiff</a></span> to find changes in the patched version of <span style="font-family: 'courier new', courier, monospace;">zipfldr.dll</span>, we spotted a notable new code block in the <span style="font-family: 'courier new', courier, monospace;">CTempFileNameArray::_TryCreatingInPath</span> function, as shown below in Figure 20.</p>
<figure id="attachment_131254" aria-describedby="caption-attachment-131254" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131254" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-20.png" alt="Image 20 is a block of code that calls to UuIDCreate." width="900" height="199" /><figcaption id="caption-attachment-131254" class="wp-caption-text">Figure 20. Call to <span style="font-family: 'courier new', courier, monospace;">UuidCreate</span>.</figcaption></figure>
<p>Microsoft added a call to <span style="font-family: 'courier new', courier, monospace;">UuidCreate</span>, and extracting content from a ZIP archive fails if the path is not constructed with the new UUID.</p>
<p>Another interesting update in the patched version of <span style="font-family: 'courier new', courier, monospace;">zipfldr.dll</span> is found in the <span style="font-family: 'courier new', courier, monospace;">ExtractZipToFile</span> function. New code is added after extracting the file, which will append the MotW immediately after the file is written. If <span style="font-family: 'courier new', courier, monospace;">SetFileAttributes</span> fails, the file is deleted, as shown in Figure 21.</p>
<figure id="attachment_131256" aria-describedby="caption-attachment-131256" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131256" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-21.png" alt="Image 21 is a screenshot of two blocks of code. It is the call to DeleteFileW." width="900" height="278" /><figcaption id="caption-attachment-131256" class="wp-caption-text">Figure 21. Call to <span style="font-family: 'courier new', courier, monospace;">DeleteFileW</span>.</figcaption></figure>
<h3><a id="post-131215-_901ymln9nmsr"></a>Continuing the Exploit Chain</h3>
<p>Although Microsoft's August 2023 Security Updates mitigated this exploit chain, other steps of the chain remained unpatched.</p>
<h4><a id="post-131215-_qq16jtppwn5z"></a><strong>ActiveX Attack Surface</strong></h4>
<p>Running a file in Security Zone 1 results in a more permissive policy toward ActiveX controls and provides a greater ActiveX attack surface. This allows executing old ActiveX code that could be exploited to execute malicious code.</p>
<p>An increased ActiveX attack surface allows us to trigger the next step in the exploit chain. Below, Figure 22 shows a code snippet from <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> that leads to the next step.</p>
<figure id="attachment_131258" aria-describedby="caption-attachment-131258" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131258" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-22.png" alt="Image 22 is a screenshot of a code snippet where 1111.HDM reloads in a web browser control. " width="900" height="83" /><figcaption id="caption-attachment-131258" class="wp-caption-text">Figure 22. <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> reloading in a <span style="font-family: 'courier new', courier, monospace;">WebBrowser</span> control.</figcaption></figure>
<p>This code from <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> creates a hidden popup and runs the ActiveX <span style="font-family: 'courier new', courier, monospace;">WebBrowser</span> control within the hidden popup. The <span style="font-family: 'courier new', courier, monospace;">WebBrowser</span> control is a <a href="https://learn.microsoft.com/en-us/dotnet/desktop/winforms/controls/webbrowser-control-overview?view=netframeworkdesktop-4.8" target="_blank" rel="noopener">wrapper</a> that allows web browsing functionality in Windows-based applications. Developers often use this ActiveX control to embed an HTML viewer in an application.</p>
<h4><a id="post-131215-_mxhz8847k0jp"></a><strong>Elevating Security Zones For Command Execution</strong></h4>
<p>While Security Zone 1 allows us to avoid MotW and increase the ActiveX attack surface, we can elevate our files to Security Zone 0 for command execution. Files tagged as Security Zone 0 represent the "Local Machine" zone, which is the most trusted zone and provides maximum allowable permissions.</p>
<p>At this stage, the <span style="font-family: 'courier new', courier, monospace;">WebBrowser</span> control redirects the page from a network path in Zone 1 to a local path of the same page. Now that file <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> is loaded from a local path, it executes in Security Zone 0.</p>
<p>Next, <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> loads <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> by invoking <span style="font-family: 'courier new', courier, monospace;">ms-its</span> shown below in Figure 23.</p>
<figure id="attachment_131260" aria-describedby="caption-attachment-131260" style="width: 900px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131260" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-23.png" alt="Image 23 is a screenshot of the code that loads to 222.CHM by 1111.htm. " width="900" height="90" /><figcaption id="caption-attachment-131260" class="wp-caption-text">Figure 23. <span style="font-family: 'courier new', courier, monospace;">1111.htm</span> loading <span style="font-family: 'courier new', courier, monospace;">2222.chm</span>.</figcaption></figure>
<p>Windows uses this <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/htmlhelp/about-html-help-urls" target="_blank" rel="noopener">ms-its handler</a></span> to display Microsoft Compiled HTML Help (CHM) files. This function is implemented in module <span style="font-family: 'courier new', courier, monospace;">itss.dll</span>, which loads the extracted <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> file.</p>
<p>Figure 24 below reveals the contents of <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> when viewing the file in <a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/htmlhelp/microsoft-html-help-downloads" target="_blank" rel="noopener">HTML Help Workshop</a>.</p>
<figure id="attachment_131262" aria-describedby="caption-attachment-131262" style="width: 538px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131262" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-24.png" alt="Image 24 is a screenshot of HTML Help Workshop program. Log1 displays the contents of 2222.CHM. It includes information such as the path, compiled version, and byte size for its components." width="538" height="327" /><figcaption id="caption-attachment-131262" class="wp-caption-text">Figure 24. Contents of <span style="font-family: 'courier new', courier, monospace;">2222.chm</span> viewed in HTML Help Workshop.</figcaption></figure>
<p>The CHM file contains a file named <span style="font-family: 'courier new', courier, monospace;">file1.htm</span>, which redirects to <span style="font-family: 'courier new', courier, monospace;">file1.mht</span> (handled by <span style="font-family: 'courier new', courier, monospace;">inetcomm.dll</span>, part of Microsoft's internet messaging API). Then <span style="font-family: 'courier new', courier, monospace;">file1.mht</span> uses the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.windows.forms.help.showhelp?view=windowsdesktop-7.0" target="_blank" rel="noopener"><span style="font-family: 'courier new', courier, monospace;">showHelp</span> method</a> to load <span style="font-family: 'courier new', courier, monospace;">fileH.htm</span>. Then <span style="font-family: 'courier new', courier, monospace;">FileH.htm</span> redirects to <span style="font-family: 'courier new', courier, monospace;">fileH.mht</span>, and finally <span style="font-family: 'courier new', courier, monospace;">fileH.mht</span> executes the script shown below in Figure 25.</p>
<figure id="attachment_131264" aria-describedby="caption-attachment-131264" style="width: 763px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131264" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-25.png" alt="Image 25 is an HTML code snippet to open up the file contained in the screenshot. It is a URL that executes a script." width="763" height="197" /><figcaption id="caption-attachment-131264" class="wp-caption-text">Figure 25. Snippet of <span style="font-family: 'courier new', courier, monospace;">fileH.mht</span> - code calls open function.</figcaption></figure>
<p>The code snippet from <span style="font-family: 'courier new', courier, monospace;">fileH.mht</span> in Figure 25 uses the <span style="font-family: 'courier new', courier, monospace;"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/open" target="_blank" rel="noopener">window.open</a></span> method to invoke the <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shellexecuteexw" target="_blank" rel="noopener">ShellExecuteExW</a></span> API to open a file at:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">file[:]//104.234.239[.]26/share1/MSHTML_C7/ex001.url</span></li>
</ul>
<h4><a id="post-131215-_zgc8jzfcejdf"></a><strong>Bypassing SmartScreen</strong></h4>
<p>The Internet Shortcut (URL) file named ex001.url from Figure 25 points to <span style="font-family: 'courier new', courier, monospace;">file[:]//104.234.239[.]26/share1/MSHTML_C7/ex001.zip/file001.vbs</span>.</p>
<p>The downloaded <span style="font-family: 'courier new', courier, monospace;">file001.vbs</span> file contains malicious Visual Basic Script (VBS) designed to bypass <a href="https://learn.microsoft.com/en-us/windows/security/operating-system-security/virus-and-threat-protection/microsoft-defender-smartscreen/" target="_blank" rel="noopener">SmartScreen</a> protection.</p>
<p>When a URL file points to a remote <a href="https://learn.microsoft.com/en-us/dotnet/standard/io/file-path-formats#unc-paths" target="_blank" rel="noopener">UNC path</a>, the URL file downloads and runs content returned from that path. Executing the content calls the <span style="font-family: 'courier new', courier, monospace;">ShellExecuteW</span> API which triggers the <span style="font-family: 'courier new', courier, monospace;">CheckSmartScreen</span> function, prompting the user for confirmation, as shown below in Figure 26.</p>
<figure id="attachment_131268" aria-describedby="caption-attachment-131268" style="width: 466px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131268" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-26.png" alt="Image 26 is a screenshot of a window security warning. Open file security warning. We can't verify who created this file. Are you sure you want to open this file? A warning icon. This file is in a location outside your local net work. Files from locations you don't recognize can harm your PC. Only open this file if you trust the location. Listed is the name, the type, which is a VBS script file. Where it is from and the options to open or cancel." width="466" height="300" /><figcaption id="caption-attachment-131268" class="wp-caption-text">Figure 26. SmartScreen warning.</figcaption></figure>
<p>However, our file resides within a ZIP archive, so it triggers a slightly different behavioral flow. File <span style="font-family: 'courier new', courier, monospace;">file001.vbs</span> is downloaded during the exploit chain and extracted to the user’s local temp directory with MotW, but it is immediately executed without any popup warnings. This is illustrated below from the <span style="font-family: 'courier new', courier, monospace;">procmon</span> list below in Figure 27.</p>
<figure id="attachment_131270" aria-describedby="caption-attachment-131270" style="width: 686px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-131270" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2023/11/word-image-131215-27.png" alt="Image 27 as a screenshot of the launch of W Scripps.ex EEXE. It is highlighted in blue among the rows. " width="686" height="321" /><figcaption id="caption-attachment-131270" class="wp-caption-text">Figure 27. <span style="font-family: 'courier new', courier, monospace;">Wscript.exe</span> is immediately launched, successfully bypassing SmartScreen.</figcaption></figure>
<p>As shown above in Figure 27, file <span style="font-family: 'courier new', courier, monospace;">ex001.zip</span> is retrieved from a remote directory, then <span style="font-family: 'courier new', courier, monospace;">file001.vbs</span> is extracted from the ZIP archive. Later in the process event list, we find a Process Create entry for <span style="font-family: 'courier new', courier, monospace;">wscript.exe</span> to run the VBS file, as highlighted in blue.</p>
<p>This bypass was also <a href="https://twitter.com/wdormann/status/1683855958886301696" target="_blank" rel="noopener">described on Twitter</a> by Will Dormann. This may be a regression, because <a href="https://blog.quarkslab.com/analysis-of-ms16-104-url-files-security-feature-bypass-cve-2016-3353.html" target="_blank" rel="noopener">Microsoft fixed a very similar issue in 2016</a>.</p>
<h3><a id="post-131215-_6x3is8u15qwa"></a>An Initial Workaround</h3>
<p>Before patching the CVE-2023-36884 vulnerability, Microsoft announced the following mitigation.</p>
<ul>
<li><a href="https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/" target="_blank" rel="noopener">Disable cross protocol navigation</a>: Microsoft stated “organizations who cannot take advantage of these protections can set the <span style="font-family: 'courier new', courier, monospace;"><a href="https://learn.microsoft.com/archive/blogs/ieinternals/internet-explorer-9-0-2-update#new-restrictions-on-use-ofthe-file-protocol" target="_blank" rel="noopener">FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION</a></span> registry key to avoid exploitation.”</li>
</ul>
<p>Disabling cross protocol navigation prevents navigation between URI schemes. This mitigation stops the redirection from <span style="font-family: 'courier new', courier, monospace;">RFile.asp</span>, discussed earlier with Figure 9 and Figure 10.</p>
<h2><a id="post-131215-_qvqt8jo6ehc0"></a><strong>Conclusion</strong></h2>
<p>Starting with the malicious .docx file, our analysis of the July 2023 campaign targeting groups supporting Ukraine's admission into NATO revealed a more complex exploit than originally reported. Our analysis of this chain revealed a chain of more than 20 steps that not only exploited <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884" target="_blank" rel="noopener">CVE-2023-36884</a>, but included additional vulnerabilities to bypass protections in Microsoft Office and Windows.</p>
<p>Microsoft awarded our team a bug bounty and assigned <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36584" target="_blank" rel="noopener">CVE-2023-36584</a> to a new vulnerability discovered in our research.</p>
<p>Palo Alto Networks customers receive protection from and mitigation for these exploits the following ways:</p>
<ul>
<li><a href="https://docs-cortex.paloaltonetworks.com/p/XDR" target="_blank" rel="noopener">Cortex XDR</a> customers received protection from these exploit methods before they were discovered.</li>
<li><a href="https://docs.paloaltonetworks.com/prisma/prisma-cloud" target="_blank" rel="noopener">Prisma Cloud</a> is capable of detecting and preventing cloud application deployment that contains exploits against either <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884" target="_blank" rel="noopener">CVE-2023-36884</a> or <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36584" target="_blank" rel="noopener">CVE-2023-36584</a>. Protection from these exploits was available out of the box.</li>
</ul>
<p>If you think you may have been compromised or have an urgent matter, contact the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a> or call:</p>
<ul>
<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>
<li>EMEA: +31.20.299.3130</li>
<li>APAC: +65.6983.8730</li>
<li>Japan: +81.50.1790.0200</li>
</ul>
<p>For additional information about how Palo Alto Networks customers receive protection from this exploit chain, <a href="https://unit42.paloaltonetworks.com/cve-2023-36884-rce/" target="_blank" rel="noopener">see our previous article about CVE-2023-36884</a>.</p>
<p>Palo Alto Networks has shared our findings with our fellow Cyber Threat Alliance (CTA) members. CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors. Learn more about the <a href="https://www.cyberthreatalliance.org/" target="_blank" rel="noopener">Cyber Threat Alliance</a>.</p>
<h2><a id="post-131215-_b5gcri6a6odq"></a><strong>Indicators of Compromise</strong></h2>
<p>The following files are associated with the July 2023 campaign lure <span style="font-family: 'courier new', courier, monospace;">Overview_of_UWCs_UkraineInNATO_campaign.docx</span> and have been posted to VirusTotal. Of note, SHA256 hashes for some of these files are different for each infection.</p>
<p>Read: SHA256 hash - Filename</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">a61b2eafcf39715031357df6b01e85e0d1ea2e8ee1dfec241b114e18f7a1163f - Overview_of_UWCs_UkraineInNATO_campaign.docx</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">0896e7c5433b2d426a30a43e7f4ef351fa870be8bd336952a0655392f8f8052d - word/document.xml</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">b5731baa7920b4649add429fc4a025142ce6a1e1adacb45850470ca4562d5e37 - word/_rels/document.xml.rels</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">e7cfeb023c3160a7366f209a16a6f6ea5a0bc9a3ddc16c6cba758114dfe6b539 - afchunk.rtf</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">3d0dae359325e8e96cf46459c38d086279865457379bd6380523727db350de43 - file001.url</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">48142dc7fe28a5d8a849fff11cb8206912e8382314a2f05e72abad0978b27e90 - start.xml</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">bfe3ebcc92a4a7d294b63ce0d7eba6313980d982709a27b337abe32651b63856 - file001.zip</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">c94e2bfd4e2241fed42113049c84ac333fcff340cc202afe8926f8e885d5fca3 - 2222.chm</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">f08cc922c5dab73f6a2534f8ceec8525604814ae7541688b7f65ac9924ace855 - 1111.htm</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">cdc39ce48f8f587c536450a3bd0feb58bf40b59b310569797c1c9ae8d28b2914 - RFile.asp</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">fd4fd44ff26e84ce6587413271cf7ff3960471a55eb0d51b0a9870b577d66f4a - file001.htm</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">4fc768476ee92230db5dbc4d8cbca49a71f8433542e62e093c3ad160f699c98d - redir_obj.htm</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">0adb2734a1ca0ccaf27d8a46c08b2fd1e19cb1fbd3fea6d8307851c691011f0f - file1.htm</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">7a1494839927c20a4b27be19041f2a2c2845600691aa9a2032518b81463f83be - file1.mht</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">20f58bd5381509072e46ad79e859fb198335dcd49c2cb738bd76f1d37d24c0a7 - fileH.htm</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">ee46f8c9769858aad6fa02466c867d7341ebe8a59c21e06e9e034048013bf65a - fileH.mht</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">c187aa84f92e4cb5b2d9714b35f5b892fa14fec52f2963f72b83c0b2d259449d - ex001.url</span></li>
</ul>
<p>The following network paths referenced in this research are associated with the July 2023 lure:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">\\104.234.239[.]26\share1\MSHTML_C7\file001.url</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">\\104.234.239[.]26\share1\MSHTML_C7\ex001.url</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">file[:]//104.234.239[.]26/share1/MSHTML_C7/1/</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">file[:]//104.234.239[.]26/share1/MSHTML_C7/ex001.zip/file001.vbs</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/start.xml</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/zip_k.asp?d=</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/zip_k2.asp?d=</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxp://74.50.94[.]156/MSHTML_C7/zip_k3.asp?d=</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">hxxps://www.ukrainianworldcongress[.]info/sites/default/files/document/forms/2023/Overview_of_UWCs_UkraineInNATO_campaign.docx</span></li>
</ul>
<h2><a id="post-131215-_g9zapy3spmed"></a><strong>Additional Resources</strong></h2>
<ul>
<li><a href="https://unit42.paloaltonetworks.com/cve-2023-36884-rce/" target="_blank" rel="noopener">CVE-2023-36884 - Microsoft Office and Windows HTML Remote Code Execution: Threat Brief</a> – Unit 42, Palo Alto Networks</li>
<li><a href="https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/" target="_blank" rel="noopener">Storm-0978 attacks reveal financial and espionage motives </a>– Microsoft Security</li>
<li><a href="https://www.trellix.com/about/newsroom/stories/research/breaking-down-cve-2023-36884-and-the-infection-chain/" target="_blank" rel="noopener">The Tale of Two Exploits – Breaking Down CVE-2023-36884 and the Infection Chain</a> - Trellix</li>
<li><a href="https://vu.ls/blog/windows-search/" target="_blank" rel="noopener">Windows Search Remote Code Execution Vulnerability</a> – vu.ls blog</li>
<li><a href="https://twitter.com/r00tbsd/status/1679042071477338114" target="_blank" rel="noopener">Post by @r00tbsd on X from thread about CVE-2023-36884 exploit</a> - Post by @r00tbsd on X from thread about CVE-2023-36884 exploit</li>
</ul>
      
              </div>
              <!--<span class="post__date">Updated 7 June, 2024 at 11:53 AM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/cve-2023-36584/" role="link" title="CVE-2023-36584" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:CVE-2023-36584">CVE-2023-36584</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/cve-2023-36884/" role="link" title="CVE-2023-36884" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:CVE-2023-36884">CVE-2023-36884</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/exploit/" role="link" title="exploit" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:exploit">Exploit</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/microsoft-office/" role="link" title="Microsoft Office" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:Microsoft Office">Microsoft Office</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/microsoft-vulnerability/" role="link" title="Microsoft Vulnerability" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:Microsoft Vulnerability">Microsoft Vulnerability</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/remote-code-execution/" role="link" title="Remote Code Execution" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:Remote Code Execution">Remote Code Execution</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/romcom/" role="link" title="RomCom" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:RomCom">RomCom</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/storm-0978/" role="link" title="Storm-0978" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:Storm-0978">Storm-0978</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/ukraine/" role="link" title="Ukraine" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:tags:Ukraine">Ukraine</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/dangers-of-clickbait-sites/" role="link" title="High Traffic + High Vulnerability = an Attractive Target for Criminals: The Dangers of Viewing Clickbait Sites" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:article-nav:High Traffic + High Vulnerability = an Attractive Target for Criminals: The Dangers of Viewing Clickbait Sites"> 
            <span>Next: High Traffic + High Vulnerability = an Attractive Target for Criminals: The Dangers of Viewing Clickbait Sites</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:sidebar:related-articles:Inside SnipBot: The Latest RomCom Malware Variant">
                      Inside SnipBot: The Latest RomCom Malware Variant                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/threat-brief-cve-2024-6387-openssh/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:sidebar:related-articles:Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability">
                      Threat Brief: CVE-2024-6387 OpenSSH RegreSSHion Vulnerability                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/unit-42-scpc-ssscip-uncover-smoke-loader-phishing/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:sidebar:related-articles:Unit 42 Collaborative Research With Ukraine’s Cyber Agency To Uncover the Smoke Loader Backdoor">
                      Unit 42 Collaborative Research With Ukraine’s Cyber Agency To Uncover the Smoke Loader Backdoor                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related  Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of jailbreaking a large language model. A glowing cube with the letters &quot;AI&quot; illuminated in blue, surrounded by a network of interconnected circuits and data lines, representing artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction">
                    <h4 class="post-title">Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/jailbroken/" title="jailbroken" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:jailbroken">Jailbroken</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/llm/" title="LLM" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:LLM">LLM</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/genai/" title="GenAI" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:GenAI">GenAI</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/jailbreak-llms-through-camouflage-distraction/" title="Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Deceptive Delight: Jailbreak LLMs Through Camouflage and Distraction:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/10_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of Gatekeeper Bypass. A person working intently at a computer in a modern office environment, with reflective digital graphs overlaid on the image suggesting data analysis." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/10_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/10_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/10_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/10_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/10_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gatekeeper Bypass: Uncovering Weaknesses in a macOS Security Mechanism:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/gatekeeper-bypass-macos/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gatekeeper Bypass: Uncovering Weaknesses in a macOS Security Mechanism">
                    <h4 class="post-title">Gatekeeper Bypass: Uncovering Weaknesses in a macOS Security Mechanism</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/apple/" title="Apple" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gatekeeper Bypass: Uncovering Weaknesses in a macOS Security Mechanism:Apple">Apple</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gatekeeper-bypass-macos/" title="Gatekeeper Bypass: Uncovering Weaknesses in a macOS Security Mechanism" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gatekeeper Bypass: Uncovering Weaknesses in a macOS Security Mechanism:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                    <h4 class="post-title">Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/social-engineering/" title="social engineering" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:social engineering">Social engineering</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Python">Python</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" title="Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider"  data-card-link="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-video-cta-tracking="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:card:video-modal:Read the article" data-video-title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
              <div class="card-media has-video" data-video="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg">
                              <figure>
                <img width="718" height="440" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg" class="attachment-medium size-medium" alt="A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg 718w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-1143x700.jpg 1143w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-768x470.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg 1505w" sizes="(max-width: 718px) 100vw, 718px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                    <h4 class="post-title">Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of keylogger malware like KLogEXE and FPSpy. Person working on a laptop with lines of code displayed on the screen, with a blurred effect indicating motion or activity, surrounded by a vivid blue and red lighting." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                    <h4 class="post-title">Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/keylogger/" title="Keylogger" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Keylogger">Keylogger</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" title="Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of SnipBot. Digital abstract background featuring binary code and technology symbols with a blue glow in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Inside SnipBot: The Latest RomCom Malware Variant">
                    <h4 class="post-title">Inside SnipBot: The Latest RomCom Malware Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/romcom/" title="RomCom" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:RomCom">RomCom</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" title="Inside SnipBot: The Latest RomCom Malware Variant" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of a red team tool like Splinter. A digital illustration showing a 3D brain model surrounded by rising data columns on a circuit board, representing advanced artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool">
                    <h4 class="post-title">Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/red-teaming-tool/" title="red teaming tool" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:red teaming tool">Red teaming tool</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pentest-tool/" title="pentest tool" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:pentest tool">Pentest tool</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" title="Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT groups from North Korea. The silhouette of two fish and the Pisces constellation inside an orange abstract planet, surrounded by two larger blue fish. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors">
                    <h4 class="post-title">Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Cryptocurrency">Cryptocurrency</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" title="Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Illustrative image featuring two fish and the Pisces constellation superimposed on a stylized, abstract background with flowing purple waves and a starry night sky." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Threat Assessment: North Korean Threat Groups:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Threat Assessment: North Korean Threat Groups">
                    <h4 class="post-title">Threat Assessment: North Korean Threat Groups</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Threat Assessment: North Korean Threat Groups:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-access-trojan/" title="Remote Access Trojan" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Threat Assessment: North Korean Threat Groups:Remote Access Trojan">Remote Access Trojan</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/finance/" title="Finance" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Threat Assessment: North Korean Threat Groups:Finance">Finance</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" title="Threat Assessment: North Korean Threat Groups" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Threat Assessment: North Korean Threat Groups:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of Stately Taurus&#039; updated TTPs. Illustration of a bull&#039;s head and the Taurus constellation inside a stylized orange moon, set against the profile of a much larger bull&#039;s head. Shooting stars are on the dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Chinese APT Abuses VSCode to Target Government in Asia">
                    <h4 class="post-title">Chinese APT Abuses VSCode to Target Government in Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" title="Chinese APT Abuses VSCode to Target Government in Asia" role="link" data-page-track="true" data-page-track-value="new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/new-cve-2023-36584-discovered-in-attack-chain-used-by-russian-apt/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
