<!DOCTYPE html>

<html lang="zh-Hans">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<link rel="profile" href="//gmpg.org/xfn/11" />
<link rel="pingback" href="https://blog.nsfocus.net/xmlrpc.php" />

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?a4b04904a9795ac7db74c3920f058bdb";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<title>APT Group系列——Darkhotel之窃密与RAT篇 &#8211; 绿盟科技技术博客</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//blog.nsfocus.net' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="绿盟科技技术博客 &raquo; Feed" href="https://blog.nsfocus.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="绿盟科技技术博客 &raquo; 评论 Feed" href="https://blog.nsfocus.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="绿盟科技技术博客 &raquo; APT Group系列——Darkhotel之窃密与RAT篇 评论 Feed" href="https://blog.nsfocus.net/darkhotel-3-0908/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.nsfocus.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://blog.nsfocus.net/wp-includes/css/dist/block-library/style.min.css?ver=6.7.1' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='contact-form-7-css' href='https://blog.nsfocus.net/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=6.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css' href='https://blog.nsfocus.net/wp-includes/css/dashicons.min.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://blog.nsfocus.net/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.8' type='text/css' media='all' />
<link rel='stylesheet' id='thinkup-google-fonts-css' href='//fonts.googleapis.com/css?family=Lato%3A300%2C400%2C600%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='prettyPhoto-css' href='https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/extentions/prettyPhoto/css/prettyPhoto.css?ver=3.1.6' type='text/css' media='all' />
<link rel='stylesheet' id='thinkup-bootstrap-css' href='https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/extentions/bootstrap/css/bootstrap.min.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css' href='https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/extentions/font-awesome/css/font-awesome.min.css?ver=4.7.0' type='text/css' media='all' />
<link rel='stylesheet' id='thinkup-shortcodes-css' href='https://blog.nsfocus.net/wp-content/themes/Melos_Pro/styles/style-shortcodes.css?ver=1.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='thinkup-style-css' href='https://blog.nsfocus.net/wp-content/themes/Melos_Pro/style.css?ver=1.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='thinkup-portfolio-css' href='https://blog.nsfocus.net/wp-content/themes/Melos_Pro/styles/style-portfolio.css?ver=1.5.0' type='text/css' media='all' />
<script type="text/javascript" id="post-views-counter-frontend-js-before">
/* <![CDATA[ */
var pvcArgsFrontend = {"mode":"js","postID":20159,"requestURL":"https:\/\/blog.nsfocus.net\/wp-admin\/admin-ajax.php","nonce":"760d3147a4","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.8" id="post-views-counter-frontend-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/sticky/jquery.sticky.js?ver=true" id="sticky-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/videoBG/jquery.videoBG.js?ver=0.2" id="videobg-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/retina.js?ver=0.0.2" id="retina-js"></script>
<script type="text/javascript" id="tweetscroll-js-extra">
/* <![CDATA[ */
var PiTweetScroll = {"ajaxrequests":"https:\/\/blog.nsfocus.net\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/widgets/twitterfeed/js/jquery.tweetscroll.js?ver=6.7.1" id="tweetscroll-js"></script>
<link rel="https://api.w.org/" href="https://blog.nsfocus.net/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://blog.nsfocus.net/wp-json/wp/v2/posts/20159" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.nsfocus.net/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://blog.nsfocus.net/darkhotel-3-0908/" />
<link rel='shortlink' href='https://blog.nsfocus.net/?p=20159' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://blog.nsfocus.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.nsfocus.net%2Fdarkhotel-3-0908%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://blog.nsfocus.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.nsfocus.net%2Fdarkhotel-3-0908%2F&#038;format=xml" />
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/plugins/si-captcha-for-wordpress/captcha/si_captcha.js?ver=1734486641"></script>
<!-- begin SI CAPTCHA Anti-Spam - login/register form style -->
<style type="text/css">
.si_captcha_small { width:175px; height:45px; padding-top:10px; padding-bottom:10px; }
.si_captcha_large { width:250px; height:60px; padding-top:10px; padding-bottom:10px; }
img#si_image_com { border-style:none; margin:0; padding-right:5px; float:left; }
img#si_image_reg { border-style:none; margin:0; padding-right:5px; float:left; }
img#si_image_log { border-style:none; margin:0; padding-right:5px; float:left; }
img#si_image_side_login { border-style:none; margin:0; padding-right:5px; float:left; }
img#si_image_checkout { border-style:none; margin:0; padding-right:5px; float:left; }
img#si_image_jetpack { border-style:none; margin:0; padding-right:5px; float:left; }
img#si_image_bbpress_topic { border-style:none; margin:0; padding-right:5px; float:left; }
.si_captcha_refresh { border-style:none; margin:0; vertical-align:bottom; }
div#si_captcha_input { display:block; padding-top:15px; padding-bottom:5px; }
label#si_captcha_code_label { margin:0; }
input#si_captcha_code_input { width:65px; }
p#si_captcha_code_p { clear: left; padding-top:10px; }
.si-captcha-jetpack-error { color:#DC3232; }
</style>
<!-- end SI CAPTCHA Anti-Spam - login/register form style -->
</head>

<body class="post-template-default single single-post postid-20159 single-format-standard layout-sidebar-none layout-fixed layout-wide pre-header-style1 header-style1 header-sticky scrollup-on group-blog">
<div id="body-core" class="hfeed site">

	<header>
	<div id="site-header">

			
		<div id="pre-header">
		<div class="wrap-safari">
		<div id="pre-header-core" class="main-navigation">
  
			
			
						<div id="pre-header-links-inner" class="header-links"><ul id="menu-%e7%bd%91%e7%ab%99%e5%8a%9f%e8%83%bd" class="menu"><li id="menu-item-19393" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19393"><a href="http://blog.nsfocus.net/wp-login.php">登录</a></li>
<li id="menu-item-19394" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-19394"><a href="http://blog.nsfocus.net/wp-login.php?action=register">注册</a></li>
</ul></div>			
		</div>
		</div>
		</div>
		<!-- #pre-header -->

				<div id="header">
		<div id="header-core">

			
			<div id="logo">
			<a rel="home" href="https://blog.nsfocus.net/"><img src="http://blog.nsfocus.net/wp-content/uploads/2020/07/blog-logo.png" alt="Logo"></a>			</div>

			
			
			<div id="header-links" class="main-navigation">
			<div id="header-links-inner" class="header-links">

				<ul id="menu-%e6%8a%80%e6%9c%af%e5%8d%9a%e5%ae%a2%e4%b8%bb%e9%a1%b5" class="menu"><li id="menu-item-6840" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/technology-product/"><span>技术产品</span></a></li>
<li id="menu-item-18083" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/digital-intelligence-secuirty/"><span>数智安全</span></a></li>
<li id="menu-item-4420" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/threat-alert/"><span>威胁通告</span></a></li>
<li id="menu-item-4418" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a target="_blank" href="https://blog.nsfocus.net/category/security-research/"><span>研究调研</span></a></li>
<li id="menu-item-18102" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/rsac/"><span>洞见RSA</span></a></li>
<li id="menu-item-18883" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.nsfocus.net/category/translation/"><span>公益译文</span></a></li>
<li id="menu-item-18123" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.nsfocus.net/category/security-sharing/"><span>安全分享</span></a></li>
</ul>				
				<div id="header-search"><a><div class="fa fa-search"></div></a>	<form method="get" class="searchform" action="https://blog.nsfocus.net/" role="search">
		<input type="text" class="search" name="s" value="" placeholder="Search" />
		<input type="submit" class="searchsubmit" name="submit" value="Search" />
	</form></div>
				
			</div>
			</div>
			<!-- #header-links .main-navigation -->
 	
			
		</div>
		</div>
		<!-- #header -->

		
				<div id="header-sticky">
		<div id="header-sticky-core">

			<div id="logo-sticky">
			<a rel="home" href="https://blog.nsfocus.net/"><img src="http://blog.nsfocus.net/wp-content/uploads/2020/07/blog-logo.png" alt="Logo"></a>			</div>

			<div id="header-sticky-links" class="main-navigation">
			<div id="header-sticky-links-inner" class="header-links">

				<ul id="menu-%e6%8a%80%e6%9c%af%e5%8d%9a%e5%ae%a2%e4%b8%bb%e9%a1%b5-1" class="menu"><li id="menu-item-6840" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/technology-product/"><span>技术产品</span></a></li>
<li id="menu-item-18083" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/digital-intelligence-secuirty/"><span>数智安全</span></a></li>
<li id="menu-item-4420" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/threat-alert/"><span>威胁通告</span></a></li>
<li id="menu-item-4418" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent"><a target="_blank" href="https://blog.nsfocus.net/category/security-research/"><span>研究调研</span></a></li>
<li id="menu-item-18102" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a target="_blank" href="https://blog.nsfocus.net/category/rsac/"><span>洞见RSA</span></a></li>
<li id="menu-item-18883" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.nsfocus.net/category/translation/"><span>公益译文</span></a></li>
<li id="menu-item-18123" class="menu-item menu-item-type-taxonomy menu-item-object-category"><a href="https://blog.nsfocus.net/category/security-sharing/"><span>安全分享</span></a></li>
</ul>				
				<div id="header-search"><a><div class="fa fa-search"></div></a>	<form method="get" class="searchform" action="https://blog.nsfocus.net/" role="search">
		<input type="text" class="search" name="s" value="" placeholder="Search" />
		<input type="submit" class="searchsubmit" name="submit" value="Search" />
	</form></div>			</div>
			</div><div class="clearboth"></div>
			<!-- #header-sticky-links .main-navigation -->

		</div>
		</div>
		<!-- #header-sticky -->
	
		
		<div id="intro" class="option1"><div class="wrap-safari"><div id="intro-core"><h1 class="page-title"><span>APT Group系列——Darkhotel之窃密与RAT篇</span></h1></div></div></div>
		
		
		
		
	</div>


	</header>
	<!-- header -->

		
	<div id="content">
	<div id="content-core">

		<div id="main">
		<div id="main-core">

			
				
		<article id="post-20159" class="post-20159 post type-post status-publish format-standard has-post-thumbnail hentry category-security-research tag-apt tag-darkhotel tag-rat tag-10395 format-nomedia">

				<header class="entry-header"><h3 class="post-title">APT Group系列——Darkhotel之窃密与RAT篇</h3><div class="entry-meta"><span class="date"><a href="https://blog.nsfocus.net/darkhotel-3-0908/" title="APT Group系列——Darkhotel之窃密与RAT篇"><time datetime="2020-09-08T18:37:23+08:00"><span class="date-month">2020-09-08</span></time></a></span><span class="author"><a href="https://blog.nsfocus.net/author/fuying-lab/" title="View all posts by 伏影实验室" rel="author">伏影实验室</a></span><span class="tags"><a href="https://blog.nsfocus.net/tag/apt/" rel="tag">APT</a>, <a href="https://blog.nsfocus.net/tag/darkhotel/" rel="tag">Darkhotel</a>, <a href="https://blog.nsfocus.net/tag/rat/" rel="tag">RAT</a>, <a href="https://blog.nsfocus.net/tag/%e7%aa%83%e5%af%86/" rel="tag">窃密</a></span></div><div class="clearboth"></div></header><!-- .entry-header -->
		<div class="entry-content">
			<div class="post-views content-post post-20159 entry-meta load-static">
				<span class="post-views-icon dashicons dashicons-visibility"></span> <span class="post-views-label">阅读：</span> <span class="post-views-count">1,914</span>
			</div>
<span id="more-20159"></span>



<h2 class="wp-block-heading">一、手法简述</h2>



<p> Darkhotel使用过的RAT与窃密工具类型多种多样。作为攻击链的末端，这些程序复杂性不一，其通信协议随着时间推移变化较大，使用的通信加密算法方式也没有统一标准，迭代较快。有的组件的行为丰富多样，甚至不惜安装驱动来达到目的，而组件功能相对更简单，主要进行文件与执行相关操作。</p>



<h2 class="wp-block-heading">二、窃密组件Nemim</h2>



<h3 class="wp-block-heading">2.1 功能性质</h3>



<p>2014年，Darkhotel使用了一类针对Windows XP用户的Nemim窃密组件，在搜集用户系统信息的同时，还会加载驱动以记录用户击键内容，写入本地文件。</p>



<h3 class="wp-block-heading">2.2 安装驱动</h3>



<p>若当前系统为Win9X、XP或2000，该组件会在当前目录下释放ndiskpro.inf文件以安装驱动。</p>



<p>对于Vista及更高版的Windows，组件将释放键盘记录驱动至C:\Windows\system32\drivers，并注册为系统级设备驱动：</p>



<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Ndiskpro</pre>



<p>然而之后相关线程就退出了，无法搜集任何信息，故此次事件中针对的是较低Windows版本的使用者。</p>



<h3 class="wp-block-heading">2.3 收集系统信息</h3>



<p>该组件会在当前目录生成日志文件，来加密保存搜集的信息，文件后缀为tmp，名称为”ffffz”加上时间戳。每次写日志时，若当前时间距当前时间超过1小时，则以新的时间戳为名称创建新的日志文件。</p>



<p>收集的信息分为两类，首先是只收集一次的内容，包括进程信息和用户正在操作的窗口信息。</p>



<p>1.收集进程的模块路径、PID和所属用户名。</p>



<p>2.访问下方注册表路径，以搜集安装程序的名称、版本号、发布者和安装目录：</p>



<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall</pre>



<p>搜集后信息在未加密时内容如下例所示：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img fetchpriority="high" decoding="async" width="866" height="254" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/01.窃密组件Nemim-收集系统信息1.png" alt="" class="wp-image-20202" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/01.窃密组件Nemim-收集系统信息1.png 866w, https://blog.nsfocus.net/wp-content/uploads/2020/09/01.窃密组件Nemim-收集系统信息1-300x88.png 300w, https://blog.nsfocus.net/wp-content/uploads/2020/09/01.窃密组件Nemim-收集系统信息1-768x225.png 768w" sizes="(max-width: 866px) 100vw, 866px" /></figure></div>



<p>其次是持续收集的内容，包括击键信息和顶层窗口信息，并记录时间。</p>



<p>首先是当前顶层窗口的标题、PID和模块路径，若顶层窗口为IE浏览器，则获取其输入栏文本，以记录用户浏览的网址。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="676" height="58" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/02.窃密组件Nemim-收集系统信息2.png" alt="" class="wp-image-20203" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/02.窃密组件Nemim-收集系统信息2.png 676w, https://blog.nsfocus.net/wp-content/uploads/2020/09/02.窃密组件Nemim-收集系统信息2-300x26.png 300w" sizes="(max-width: 676px) 100vw, 676px" /></figure></div>



<p>持续收集的内容还包括用户击键信息，通过安装的驱动组件收集。该组件首先向驱动设备发送控制码0x220004以清空驱动的击键信息内存，接着持续发送控制码0x220000来收集击键内容，解析后写入日志并加密。</p>



<h3 class="wp-block-heading">2.4 Rootkit收集击键内容</h3>



<p>Darkhotel的驱动组件设置了I/O读写断点，并Hook了int 0x1的中断处理回调和IofCallDriver，从而获取到PS/2键盘和USB键盘的击键信息。</p>



<h4 class="wp-block-heading">2.4.1 获得PS/2键盘击键内容</h4>



<p>该驱动则按CPU个数创建定时器，并设置DPC回调。</p>



<p>在DPC回调中，该驱动将键盘读写端口0x60和0x64分别写入dr0和dr1寄存器，并将dr7的对应位改为二进制10，以设置I/O硬件读写断点。同时为了防止断点在任务切换时失效，驱动设置了dr7的GD位，使得任何访问或修改调试寄存器的操作都会触发1号中断。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img decoding="async" width="546" height="271" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/03.窃密组件Nemim-Rootkit-1.png" alt="" class="wp-image-20204" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/03.窃密组件Nemim-Rootkit-1.png 546w, https://blog.nsfocus.net/wp-content/uploads/2020/09/03.窃密组件Nemim-Rootkit-1-300x149.png 300w" sizes="(max-width: 546px) 100vw, 546px" /></figure></div>



<p>接着将1号中断处理函数改为自己的函数。当I/O读写命中硬件断点时，会触发单步调试异常，从而进入1号中断回调函数。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="691" height="257" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/04.窃密组件Nemim-Rootkit-2.png" alt="" class="wp-image-20205" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/04.窃密组件Nemim-Rootkit-2.png 691w, https://blog.nsfocus.net/wp-content/uploads/2020/09/04.窃密组件Nemim-Rootkit-2-300x112.png 300w" sizes="auto, (max-width: 691px) 100vw, 691px" /></figure></div>



<p>在1号中断Hook函数中，检查当前异常是否由读写调试寄存器触发，若为写操作则重置调试寄存器为初始断点状态，防止I/O断点因任务切换而失效。</p>



<p>若该函数由I/O断点触发而进入，则获取触发异常的I/O指令。由于含立即数和不含立即数的I/O指令长度不同，需减去对应长度来获取到I/O指令的首地址。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="440" height="148" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/05.窃密组件Nemim-Rootkit-3.png" alt="" class="wp-image-20206" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/05.窃密组件Nemim-Rootkit-3.png 440w, https://blog.nsfocus.net/wp-content/uploads/2020/09/05.窃密组件Nemim-Rootkit-3-300x101.png 300w" sizes="auto, (max-width: 440px) 100vw, 440px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="621" height="630" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/06.窃密组件Nemim-Rootkit-4.png" alt="" class="wp-image-20207" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/06.窃密组件Nemim-Rootkit-4.png 621w, https://blog.nsfocus.net/wp-content/uploads/2020/09/06.窃密组件Nemim-Rootkit-4-296x300.png 296w" sizes="auto, (max-width: 621px) 100vw, 621px" /></figure></div>



<p>设置回传的内容，包括：</p>



<ol class="wp-block-list"><li>键盘码或状态码</li><li>I/O指令第一个字节</li><li>I/O端口号</li><li>读写标志，0代表读端口，1代表写端口</li><li>I/O指令汇编字符串（其OUT指令写法存在错误）</li></ol>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="766" height="397" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/07.窃密组件Nemim-Rootkit-5.png" alt="" class="wp-image-20208" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/07.窃密组件Nemim-Rootkit-5.png 766w, https://blog.nsfocus.net/wp-content/uploads/2020/09/07.窃密组件Nemim-Rootkit-5-300x155.png 300w" sizes="auto, (max-width: 766px) 100vw, 766px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="677" height="173" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/08.窃密组件Nemim-Rootkit-6.png" alt="" class="wp-image-20209" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/08.窃密组件Nemim-Rootkit-6.png 677w, https://blog.nsfocus.net/wp-content/uploads/2020/09/08.窃密组件Nemim-Rootkit-6-300x77.png 300w" sizes="auto, (max-width: 677px) 100vw, 677px" /></figure></div>



<h4 class="wp-block-heading">2.4.2 获得Hid-USB键盘击键内容</h4>



<p>驱动对IofCallDriver做了内联Hook，先调用Hook函数，再调用原始IofCallDriver。在Hook函数中，过滤出所属驱动名为”\Driver\usbhub”的USB设备，并将新遇到的Hid-USB设备保存在列表中。</p>



<p>同时，驱动开启一个线程，持续遍历加入列表的所有设备，通过函数is_keyboard_report_des_exist判断该设备是否为USB键盘设备，若是则设置其USB标志为1。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="710" height="405" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/09.窃密组件Nemim-Rootkit-7.png" alt="" class="wp-image-20210" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/09.窃密组件Nemim-Rootkit-7.png 710w, https://blog.nsfocus.net/wp-content/uploads/2020/09/09.窃密组件Nemim-Rootkit-7-300x171.png 300w" sizes="auto, (max-width: 710px) 100vw, 710px" /></figure></div>



<p>对于列表中的每个设备，该驱动特制一个内部IRP并传入URB来获得USB接口的报告描述，以检查该设备是否属于USB键盘。内部IRP为IRP_MJ_INTERNAL_DEVICE_CONTROL，功能码为IOCTL_INTERNAL_USB_SUBMIT_URB。Hook的IofCallDriver遇到该内部自制IRP会率先返回，把数据交给原始IofCallDriver去处理。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="657" height="368" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/10.窃密组件Nemim-Rootkit-8.png" alt="" class="wp-image-20212" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/10.窃密组件Nemim-Rootkit-8.png 657w, https://blog.nsfocus.net/wp-content/uploads/2020/09/10.窃密组件Nemim-Rootkit-8-300x168.png 300w" sizes="auto, (max-width: 657px) 100vw, 657px" /></figure></div>



<p>驱动为列表中的当前设备创建内部IRP，而IofCallDriver的Hook函数则会过滤驱动名称并检查自制IRP：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="610" height="122" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/11.窃密组件Nemim-Rootkit-9.png" alt="" class="wp-image-20213" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/11.窃密组件Nemim-Rootkit-9.png 610w, https://blog.nsfocus.net/wp-content/uploads/2020/09/11.窃密组件Nemim-Rootkit-9-300x60.png 300w" sizes="auto, (max-width: 610px) 100vw, 610px" /></figure></div>



<p>接着程序检查获得的报告描述是否为键盘相关：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="760" height="276" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/12.窃密组件Nemim-Rootkit-10.png" alt="" class="wp-image-20214" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/12.窃密组件Nemim-Rootkit-10.png 760w, https://blog.nsfocus.net/wp-content/uploads/2020/09/12.窃密组件Nemim-Rootkit-10-300x109.png 300w" sizes="auto, (max-width: 760px) 100vw, 760px" /></figure></div>



<p>此后，当Hook的IofCallDriver函数再次遇到某USB设备时，则在列表中查找其属性，</p>



<p>若为Hid-USB键盘，则设置自己的完成过程函数，并在函数中将获取的击键信息回传至用户层组件。</p>



<p>驱动在MJ_DEVICE_CONTROL回调中接收用户态组件下发的控制码。如前文所述，若控制码为0x220000，则将收集的击键信息回传至用户态组件。若控制码为0x220004，则清空对应缓存。</p>



<h2 class="wp-block-heading">三、凭据窃密组件</h2>



<h3 class="wp-block-heading">3.1 功能</h3>



<p>该组件由WinRar SFX自解压文件释放并运行，会窃取知名浏览器、本地邮件客户端、通讯工具的凭据，回传到C&amp;C。</p>



<h3 class="wp-block-heading">3.2 收集系统基本信息</h3>



<p>收集计算机名称、用户名、本机IP、MAC地址及其Hash。</p>



<p>访问注册表，收集CPU信息、计算机语言和操作系统名称版本。</p>



<p>这里的收集方式与Karba下载器非常相似。</p>



<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\CentralProcessor\0\
ProcessorNameString
Identifier

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\Language\InstallLanguage

HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CurrentVersion\
CSDVersion
ProductName
CurrentVersion</pre>



<p>这些信息随后被格式并进行加密和Base64编码。</p>



<h3 class="wp-block-heading">3.3 盗窃各类凭据</h3>



<p>以版本为7及以上的IE浏览器为例，该组件使用COM组件的IUrlHistoryStg2接口获得其浏览器历史记录中各个域名。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="549" height="114" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/13.凭据窃取-窃取各类凭据-1.png" alt="" class="wp-image-20215" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/13.凭据窃取-窃取各类凭据-1.png 549w, https://blog.nsfocus.net/wp-content/uploads/2020/09/13.凭据窃取-窃取各类凭据-1-300x62.png 300w" sizes="auto, (max-width: 549px) 100vw, 549px" /></figure></div>



<p>之后访问如下注册表路径：</p>



<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\IntelliForms\Storage2</pre>



<p>此处加密保存了自动填写的网站口令，需要借助对应URL来解密。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="979" height="253" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/14.凭据窃取-窃取各类凭据-2.png" alt="" class="wp-image-20216" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/14.凭据窃取-窃取各类凭据-2.png 979w, https://blog.nsfocus.net/wp-content/uploads/2020/09/14.凭据窃取-窃取各类凭据-2-300x78.png 300w, https://blog.nsfocus.net/wp-content/uploads/2020/09/14.凭据窃取-窃取各类凭据-2-768x198.png 768w" sizes="auto, (max-width: 979px) 100vw, 979px" /></figure></div>



<p>考虑到用户可能删除历史记录，导致当前历史记录中缺少某些URL，故该组件在获取当前历史记录的同时，还自备了一批网站列表，如下所示：</p>



<p><a href="http://twitter.com">http://twitter.com</a></p>



<p><a href="http://facebook.com">http://facebook.com</a></p>



<p><a href="http://passport.yandex.ru/passport">http://passport.yandex.ru/passport</a></p>



<p><a href="http://www.yandex.ru">http://www.yandex.ru</a></p>



<p><a href="http://qip.ru">http://qip.ru</a></p>



<p><a href="http://mail.qip.ru">http://mail.qip.ru</a></p>



<p><a href="https://login.nifty.com/service/login">https://login.nifty.com/service/login</a></p>



<p><a href="http://e.mail.ru/cgi-bin/login">http://e.mail.ru/cgi-bin/login</a></p>



<p><a href="http://mail.ru">http://mail.ru</a></p>



<p><a href="http://mail.126.com">http://mail.126.com</a></p>



<p><a href="http://secure.zapak.com/mail/zapakmail.php">http://secure.zapak.com/mail/zapakmail.php</a></p>



<p><a href="https://lavabit.com/apps/webmail/src/login.php">https://lavabit.com/apps/webmail/src/login.php</a></p>



<p><a href="http://www.bigstring.com">http://www.bigstring.com</a></p>



<p><a href="http://www.gmx.com">http://www.gmx.com</a></p>



<p><a href="http://passport.sohu.com/indexaction.action">http://passport.sohu.com/indexaction.action</a></p>



<p><a href="http://www.sohu.com">http://www.sohu.com</a></p>



<p><a href="https://www.zoho.com/login.html">https://www.zoho.com/login.html</a></p>



<p><a href="http://mail.sina.com.cn">http://mail.sina.com.cn</a></p>



<p><a href="http://members.sina.com/index.php">http://members.sina.com/index.php</a></p>



<p><a href="http://www.care2.com/passport/login.html">http://www.care2.com/passport/login.html</a></p>



<p><a href="http://www.mail.com/int">http://www.mail.com/int</a></p>



<p><a href="https://fastmail.fm/mail">https://fastmail.fm/mail</a></p>



<p><a href="https://www.inbox.com/login.aspx">https://www.inbox.com/login.aspx</a></p>



<p><a href="http://www.gawab.com">http://www.gawab.com</a></p>



<p><a href="http://mail.163.com">http://mail.163.com</a></p>



<p><a href="http://registration.lycos.com/login.php">http://registration.lycos.com/login.php</a></p>



<p><a href="http://www.mail.lycos.com">http://www.mail.lycos.com</a></p>



<p><a href="https://my.screenname.aol.com/_cqr/login/login.psp">https://my.screenname.aol.com/_cqr/login/login.psp</a></p>



<p><a href="https://edit.bjs.yahoo.com/config/login">https://edit.bjs.yahoo.com/config/login</a></p>



<p><a href="https://login.yahoo.co.jp/config/login">https://login.yahoo.co.jp/config/login</a></p>



<p><a href="https://login.yahoo.com/config/login_verify2">https://login.yahoo.com/config/login_verify2</a></p>



<p><a href="https://login.live.com/login.srf">https://login.live.com/login.srf</a></p>



<p><a href="https://www.google.com/accounts/servicelogin">https://www.google.com/accounts/servicelogin</a></p>



<p>可见，其中除了一些国际知名网站外，还包括国内的网易、搜狐和新浪相关站点，可见其攻击目标包含中国。</p>



<p>对于谷歌浏览器，该组件首先访问目录&#8230;\AppData\Local\Google\Chrome\Application，在该目录下找到如下图所示目录来确定版本号。</p>



<p>该组件根据不同版本访问谷歌浏览器的sqlite数据库，解密得到自动登录账号。</p>



<figure class="wp-block-table aligncenter"><table><tbody><tr><td class="has-text-align-center" data-align="center">6.0及其以上</td><td class="has-text-align-center" data-align="center">\Google\Chrome\User Data\Default\Login Data</td></tr><tr><td class="has-text-align-center" data-align="center">6.0以下</td><td class="has-text-align-center" data-align="center">\Google\Chrome\User Data\Default\Web Data</td></tr></tbody></table></figure>



<p>此外，该组件还收集以下客户端的凭据：</p>



<ul class="wp-block-list"><li>火狐浏览器</li><li>Outlook</li><li>Windows Mail</li><li>Windows Live Mail</li><li>MSN</li><li>Gmail</li><li>Google Desktop</li><li>Google Talk</li></ul>



<h3 class="wp-block-heading">3.4 收集近期文件和安装软件信息</h3>



<p>该组件会遍历Windows Recent目录和C:\Program Files目录，以收集用户近期处理文件和常用软件信息。组件对自制的命令行进行解析，其中ddir便代表遍历目录。</p>



<p>获取的内容包括命令行、当前时间、文件创建时间、文件大小和文件名。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="523" height="690" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/15.凭据窃取-收集近期文件.png" alt="" class="wp-image-20217" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/15.凭据窃取-收集近期文件.png 523w, https://blog.nsfocus.net/wp-content/uploads/2020/09/15.凭据窃取-收集近期文件-227x300.png 227w" sizes="auto, (max-width: 523px) 100vw, 523px" /></figure></div>



<p>此外，该组件还收集主机上的文档文件，并在通信第二阶段上传到C&amp;C。涉及类型包括：</p>



<p>doc, docx, xls, xlsx, ppt, pptx, gul, eml, pdf, ktx, ifa, if3, rtf</p>



<h3 class="wp-block-heading">3.5 与C&amp;C的通信</h3>



<p>组件连接C&amp;C，将收集的信息发回C&amp;C，分两个阶段。</p>



<p>第一阶段，向C&amp;C回传收集的系统版本信息，使用分号分割。第二阶段，回传之前获得的最近文件、软件目录和窃取的凭据内容，均经过加密和编码。</p>



<p>格式如下：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="558" height="145" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/16.凭据窃取-CC通信-1.png" alt="" class="wp-image-20218" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/16.凭据窃取-CC通信-1.png 558w, https://blog.nsfocus.net/wp-content/uploads/2020/09/16.凭据窃取-CC通信-1-300x78.png 300w" sizes="auto, (max-width: 558px) 100vw, 558px" /></figure></div>



<p>之后连接C&amp;C回传数据，返回的HTTP内容需包含字符串“minmei”方可有效，否则继续连接C&amp;C。对每个C&amp;C发起最多3次连接，若均失败则更换新的C&amp;C。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="697" height="185" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/16.凭据窃取-CC通信-2.png" alt="" class="wp-image-20219" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/16.凭据窃取-CC通信-2.png 697w, https://blog.nsfocus.net/wp-content/uploads/2020/09/16.凭据窃取-CC通信-2-300x80.png 300w" sizes="auto, (max-width: 697px) 100vw, 697px" /></figure></div>



<h2 class="wp-block-heading">四、RAT 2015</h2>



<h3 class="wp-block-heading">4.1 功能性质</h3>



<p>该RAT组件与C&amp;C通信，并根据C&amp;C指令执行信息搜集、文件、进程等操作。</p>



<h3 class="wp-block-heading">4.2 环境检测</h3>



<p>2015年的Darkhotel最终载荷显示出极强的针对性，会检测用户名，若为以下用户，则不会执行后续流程：</p>



<ul class="wp-block-list"><li>antonie</li><li>Antony</li><li>janettedoe</li><li>makrorechner</li><li>Dave</li><li>Hanuele Baser</li><li>Administrator</li><li>User</li></ul>



<h3 class="wp-block-heading">4.3 C&amp;C指令</h3>



<p>该组件与C&amp;C的通信指令如下：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="739" height="129" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/17.RAT-2015-CC指令.png" alt="" class="wp-image-20220" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/17.RAT-2015-CC指令.png 739w, https://blog.nsfocus.net/wp-content/uploads/2020/09/17.RAT-2015-CC指令-300x52.png 300w" sizes="auto, (max-width: 739px) 100vw, 739px" /></figure></div>



<p>值得一提的是，以上通讯均通过Dropbox Api完成，与APT37的组件类似。C&amp;C下发内容均经过LZNT1压缩并使用3DES加密。数据上传前同样经过LZNT1压缩，与xor加密。</p>



<p>此外，该组件会下载执行升级版或其他程序。</p>



<h2 class="wp-block-heading">五、RAT kbxxxxUpd.dll</h2>



<h3 class="wp-block-heading">5.1 功能性质</h3>



<p>该DLL由攻击者使用的lnk社工文件释放的下载器下载得来，属于最终阶段RAT程序，会与C&amp;C进行加密通信，并根据C&amp;C指令执行文件、进程、注册表操作。</p>



<p>该RAT与前文所述2015年的RAT有相似之处，但通信协议变化较大。</p>



<h3 class="wp-block-heading">5.2 初始化</h3>



<p>该dll程序的主要运行参数通过读取解密配置信息得到。配置信息可能保存在程序二进制文件的0x1DCC8~0x1E270位置处，或是程序运行目录下长度为0x5A8的文件内（可由dll程序与C&amp;C通信获得）。</p>



<p>配置信息内容包括：</p>



<ul class="wp-block-list"><li>C&amp;C域名和请求路径</li><li>缓存文件保存位置</li><li>二进制文件保存名称</li><li>加密后的通信键等</li></ul>



<p>随后，程序使用异或算法，对配置信息再次解密后从中中获取C&amp;C地址并尝试连接：</p>



<h3 class="wp-block-heading">5.3 加密通信</h3>



<p>木马通过使用windows api与自制的包结构实现与C&amp;C的加密通信。</p>



<p>原始流量包使用异或加密，异或键为首字节：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="433" height="38" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/18.RAT-kbxxxxUpd.dll-加密通信-1.png" alt="" class="wp-image-20221" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/18.RAT-kbxxxxUpd.dll-加密通信-1.png 433w, https://blog.nsfocus.net/wp-content/uploads/2020/09/18.RAT-kbxxxxUpd.dll-加密通信-1-300x26.png 300w" sizes="auto, (max-width: 433px) 100vw, 433px" /></figure></div>



<p>异或解密后，使用数据部分的指定参数进行第二次解密：</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/19.RAT-kbxxxxUpd.dll-加密通信-2.png" alt="" class="wp-image-20222" width="472" height="39" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/19.RAT-kbxxxxUpd.dll-加密通信-2.png 484w, https://blog.nsfocus.net/wp-content/uploads/2020/09/19.RAT-kbxxxxUpd.dll-加密通信-2-300x25.png 300w" sizes="auto, (max-width: 472px) 100vw, 472px" /></figure></div>



<p>第二次解密流程如下：</p>



<ol class="wp-block-list"><li>使用sha1算法，将8字节硬编码数值07 8F 63 D4 60 39 74 EB转换为hashkey;</li><li>使用3DES算法，由hashkey生成第一个解密键dec_key_1st;</li><li>使用RSA算法和解密键dec_key_1st，将600字节原始数据（由[encrypt type]指定来源）解密后得到第二个解密键dec_key_2nd;</li><li>使用RSA算法和解密键dec_key_2nd，将加密流量中140字节[encrypt key]解密后得到最终的解密键dec_key_final;</li><li>使用[encrypt type]指定的算法、[encrypt  IV]指定的IV值和解密键dec_key_final，对[encrypt data]进行解密。</li></ol>



<p>[encrypt type]字段的值与含义如下：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="579" height="92" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/20.RAT-kbxxxxUpd.dll-加密通信-3.png" alt="" class="wp-image-20223" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/20.RAT-kbxxxxUpd.dll-加密通信-3.png 579w, https://blog.nsfocus.net/wp-content/uploads/2020/09/20.RAT-kbxxxxUpd.dll-加密通信-3-300x48.png 300w, https://blog.nsfocus.net/wp-content/uploads/2020/09/20.RAT-kbxxxxUpd.dll-加密通信-3-570x92.png 570w" sizes="auto, (max-width: 579px) 100vw, 579px" /></figure></div>



<p>第二次解密完毕后，程序缓存解密后信息，根据命令的不同可能保存在三个位置：</p>



<ul class="wp-block-list"><li>配置文件指定的目录</li><li>命令指定的目录</li><li>程序原始目录</li></ul>



<h3 class="wp-block-heading">5.4 C&amp;C指令</h3>



<p>程序读取解密后[encrypt data]中的值，执行其所代表的命令。</p>



<p>每一条命令都分为两个部分，cmdcode与cmdbuf，对应的各指令作用如下：</p>



<p>[主指令]-cmdcode</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="706" height="109" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/21.RAT-kbxxxxUpd.dll-加密通信-4.png" alt="" class="wp-image-20224" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/21.RAT-kbxxxxUpd.dll-加密通信-4.png 706w, https://blog.nsfocus.net/wp-content/uploads/2020/09/21.RAT-kbxxxxUpd.dll-加密通信-4-300x46.png 300w" sizes="auto, (max-width: 706px) 100vw, 706px" /></figure></div>



<p>当cmdcode满足001??00的二进制序列形式时，程序进一步将cmdbuf解析为cmdkey-content的字典序列，通过cmdkey的值执行对应的扩展功能：</p>



<p>[扩展指令]-cmdkey</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="580" height="325" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/22.RAT-kbxxxxUpd.dll-加密通信-5.png" alt="" class="wp-image-20225" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/22.RAT-kbxxxxUpd.dll-加密通信-5.png 580w, https://blog.nsfocus.net/wp-content/uploads/2020/09/22.RAT-kbxxxxUpd.dll-加密通信-5-300x168.png 300w" sizes="auto, (max-width: 580px) 100vw, 580px" /></figure></div>



<h2 class="wp-block-heading">六、RAT 2018</h2>



<p>2018年，Darkhotel使用RAT针对我国贸易高管展开定向攻击。</p>



<h3 class="wp-block-heading">6.1 持久性</h3>



<p>RAT首先将自身复制至以下路径：</p>



<p>C:\Users\%USER%\AppData\Roaming\Microsoft\Windows\Templates\mscleaner.exe</p>



<p>之后通过powershell命令设置定时任务，启动复制后的样本。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="615" height="418" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/23.RAT-2018-持久性-1.png" alt="" class="wp-image-20226" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/23.RAT-2018-持久性-1.png 615w, https://blog.nsfocus.net/wp-content/uploads/2020/09/23.RAT-2018-持久性-1-300x204.png 300w" sizes="auto, (max-width: 615px) 100vw, 615px" /></figure></div>



<p>样本启动后，注册定时器并在定时事件的回调函数中实现与C2的通信功能，通过触发定时事件调用事件回调函数实现与C2的定期通信。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="619" height="417" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/24.RAT-2018-持久性-2.png" alt="" class="wp-image-20227" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/24.RAT-2018-持久性-2.png 619w, https://blog.nsfocus.net/wp-content/uploads/2020/09/24.RAT-2018-持久性-2-300x202.png 300w" sizes="auto, (max-width: 619px) 100vw, 619px" /></figure></div>



<h3 class="wp-block-heading">6.2 C&amp;C通信与指令</h3>



<p>步骤1，该RAT向C&amp;C发送命令请求，使用HTTP协议向C2发送请求，方法为GET, URL为/maro[数字]/article//[MAC地址]/article_service.html。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="521" height="84" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/25.RAT-2018-CC通信与指令-1.png" alt="" class="wp-image-20228" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/25.RAT-2018-CC通信与指令-1.png 521w, https://blog.nsfocus.net/wp-content/uploads/2020/09/25.RAT-2018-CC通信与指令-1-300x48.png 300w" sizes="auto, (max-width: 521px) 100vw, 521px" /></figure></div>



<p>步骤2，RAT向C&amp;C发送握手信息。方法为POST，URL为/maro[数字]/live[数字].php，内容为title=111&amp;dirname=[MAC地址的base64编码]</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="329" height="58" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/26.RAT-2018-CC通信与指令-2.png" alt="" class="wp-image-20229" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/26.RAT-2018-CC通信与指令-2.png 329w, https://blog.nsfocus.net/wp-content/uploads/2020/09/26.RAT-2018-CC通信与指令-2-300x53.png 300w" sizes="auto, (max-width: 329px) 100vw, 329px" /></figure></div>



<p>步骤3，之后接收并解析C2下发的命令，命令格式如下：</p>



<p>??[命令]##[参数1]&amp;&amp;[参数2]%%[参数3]@@</p>



<p>指令种类如下：</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="685" height="128" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/27.RAT-2018-CC通信与指令-3.png" alt="" class="wp-image-20230" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/27.RAT-2018-CC通信与指令-3.png 685w, https://blog.nsfocus.net/wp-content/uploads/2020/09/27.RAT-2018-CC通信与指令-3-300x56.png 300w" sizes="auto, (max-width: 685px) 100vw, 685px" /></figure></div>



<p>步骤四，命令执行完成后，使用与同样方法再次向C2发送握手信息。</p>



<p>在捕获到的变种中，在执行完原版的通信步骤之外，样本会继续向C2发送消息。其格式与步骤2、4类似，在’title’与’dirname’的字段基础上，新增加了‘value’字段；该字段使用统一的公钥加密。</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="531" height="110" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-4.png" alt="" class="wp-image-20231" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-4.png 531w, https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-4-300x62.png 300w" sizes="auto, (max-width: 531px) 100vw, 531px" /></figure></div>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1024" height="54" src="https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-5-1024x54.png" alt="" class="wp-image-20232" srcset="https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-5-1024x54.png 1024w, https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-5-300x16.png 300w, https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-5-768x40.png 768w, https://blog.nsfocus.net/wp-content/uploads/2020/09/28.RAT-2018-CC通信与指令-5.png 1122w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure></div>



<h2 class="wp-block-heading">七、总结</h2>



<p>Darkhotel的窃密组件与RAT工具经过攻击链层层下载和释放得到，手法已经非常成熟老练。某些工具对操作系统版本或用户名有着特殊要求，有着明显的定向性。这些工具不断在通信、加密、行为上不断迭代更新，几乎每一年都会出现新版本或完全迥异的版本，反映出Darkhotel在满足自身需求和提升组织识别难度方面一直在不断地挥力，对安全从业人员提出了新的要求。</p>
					</div><!-- .entry-content -->

		</article>

		<div class="clearboth"></div>
				
				<div id="sharepost"><div id="sharemessage"><p>Spread the word. Share this post!</p></div><div id="shareicons" class=""></div></div>
					<nav role="navigation" id="nav-below">
	
		<div class="nav-previous"><a href="https://blog.nsfocus.net/abb-yumi-security-assessment-0908/" rel="prev"><span class="meta-icon"><i class="fa fa-angle-left fa-lg"></i></span><span class="meta-nav">Previous</span></a></div>		<div class="nav-next"><a href="https://blog.nsfocus.net/xingyun-collaboration-project-0910/" rel="next"><span class="meta-nav">Next</span><span class="meta-icon"><i class="fa fa-angle-right fa-lg"></i></span></a></div>
	
	</nav><!-- #nav-below -->
	
				<div id="author-bio"><div id="author-header"><h3>Meet The Author</h3></div><div id="author-image"></div><div id="author-content"><div id="author-title"><p><a href="https://blog.nsfocus.net/author/fuying-lab/"/>伏影实验室</a></p></div><div id="author-text"><p>伏影实验室专注于安全威胁监测与对抗技术研究。<br />
研究目标包括Botnet、APT高级威胁，DDoS对抗，WEB对抗，流行服务系统脆弱利用威胁、身份认证威胁，数字资产威胁，黑色产业威胁及新兴威胁。通过掌控现网威胁来识别风险，缓解威胁伤害，为威胁对抗提供决策支撑。</p>
</div></div></div>
				

	<div id="comments">
	<div id="comments-core" class="comments-area">

	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave Comment</h3><p class="must-log-in">要发表评论，您必须先<a href="https://blog.nsfocus.net/wp-login.php?redirect_to=https%3A%2F%2Fblog.nsfocus.net%2Fdarkhotel-3-0908%2F">登录</a>。</p>	</div><!-- #respond -->
	</div>
</div><div class="clearboth"></div><!-- #comments .comments-area -->
			

		</div><!-- #main-core -->
		</div><!-- #main -->
			</div>
	</div><!-- #content -->

	
	<footer>
		<!-- #footer -->		
		<div id="sub-footer">

		
		<div id="sub-footer-core">
		
			<div class="copyright">
			咨询与合作：nsmagazine@nsfocus.com			</div>
			<!-- .copyright -->

						<div id="footer-menu" class="sub-footer-links"><ul id="menu-%e7%9b%b8%e5%85%b3%e9%93%be%e6%8e%a5" class="menu"><li id="menu-item-8155" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8155"><a target="_blank" href="https://www.nsfocus.com.cn">绿盟科技官网</a></li>
<li id="menu-item-12512" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12512"><a target="_blank" href="https://nti.nsfocus.com">绿盟威胁情报中心（NTI）</a></li>
<li id="menu-item-18030" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-18030"><a target="_blank" href="https://cloud.nsfocus.com">绿盟云</a></li>
</ul></div>						<!-- #footer-menu -->

			
		</div>
		</div>
	</footer><!-- footer -->

</div><!-- #body-core -->

<script type="text/javascript" src="https://blog.nsfocus.net/wp-includes/js/dist/hooks.min.js?ver=4d63a3d491d11ffd8ac6" id="wp-hooks-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-includes/js/dist/i18n.min.js?ver=5e580eb46a90c2b997e6" id="wp-i18n-js"></script>
<script type="text/javascript" id="wp-i18n-js-after">
/* <![CDATA[ */
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
/* ]]> */
</script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/plugins/contact-form-7/includes/swv/js/index.js?ver=6.0.1" id="swv-js"></script>
<script type="text/javascript" id="contact-form-7-js-translations">
/* <![CDATA[ */
( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "contact-form-7", {"translation-revision-date":"2024-12-09 02:48:04+0000","generator":"GlotPress\/4.0.1","domain":"messages","locale_data":{"messages":{"":{"domain":"messages","plural-forms":"nplurals=1; plural=0;","lang":"zh_CN"},"Error:":["\u62a5\u9519\uff1a"]}},"comment":{"reference":"includes\/js\/index.js"}} );
/* ]]> */
</script>
<script type="text/javascript" id="contact-form-7-js-before">
/* <![CDATA[ */
var wpcf7 = {
    "api": {
        "root": "https:\/\/blog.nsfocus.net\/wp-json\/",
        "namespace": "contact-form-7\/v1"
    }
};
/* ]]> */
</script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/plugins/contact-form-7/includes/js/index.js?ver=6.0.1" id="contact-form-7-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-includes/js/imagesloaded.min.js?ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/extentions/prettyPhoto/js/jquery.prettyPhoto.js?ver=3.1.6" id="prettyPhoto-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/modernizr.js?ver=2.6.2" id="modernizr-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/waypoints/waypoints.min.js?ver=2.0.3" id="waypoints-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/waypoints/waypoints-sticky.min.js?ver=2.0.3" id="waypoints-sticky-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/scrollup/jquery.scrollUp.min.js?ver=2.4.1" id="jquery-scrollup-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/extentions/bootstrap/js/bootstrap.js?ver=2.3.2" id="thinkup-bootstrap-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/main-frontend.js?ver=1.5.0" id="thinkup-frontend-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/carouFredSel/jquery.carouFredSel-6.2.1.js?ver=6.7.1" id="carouFredSel-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/ResponsiveSlides/responsiveslides.min.js?ver=1.54" id="responsiveslides-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/ResponsiveSlides/responsiveslides-call.js?ver=1.5.0" id="thinkup-responsiveslides-js"></script>
<script type="text/javascript" src="https://blog.nsfocus.net/wp-content/themes/Melos_Pro/lib/scripts/plugins/knob/jquery.knob.js?ver=1.2.8" id="knob-js"></script>

</body>
</html>