<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Michael Boelen"><meta name=description content="The Linux kernel can be configured to disallow loading new kernel modules. Learn how to configure this."><meta name=keywords content="integrity,kernel,linux"><meta property="og:site_name" content="Linux Audit"><meta property="og:title" content="Increase kernel integrity with disabled Linux kernel modules loading"><meta property="og:description" content="The Linux kernel can be configured to disallow loading new kernel modules. Learn how to configure this."><meta property="og:locale" content="en"><meta property="og:url" content="https://linux-audit.com/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading/"><title>Increase kernel integrity with disabled Linux kernel modules loading</title>
<link rel=canonical href=https://linux-audit.com/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading/><link rel=alternate href=https://linux-audit.com/atom.xml type=application/atom+xml title="Linux Audit"><meta property="og:type" content="article"><meta property="og:url" content="https://linux-audit.com/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading/"><meta property="og:locale" content="en"><meta property="og:image" content="https://linux-audit.com/opengraph/background_hu13962631492392299551.png"><meta property="article:published_time" content="2015-05-12T19:44:06+00:00"><meta property="article:modified_time" content="2024-06-11T14:07:37+00:00"><meta name=twitter:title content="Increase kernel integrity with disabled Linux kernel modules loading"><meta name=twitter:description content="The Linux kernel can be configured to disallow loading new kernel modules. Learn how to configure this."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://linux-audit.com/opengraph/background_hu13962631492392299551.png"><style>ï»¿html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:50%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type=button],[type=reset],[type=submit]{-webkit-appearance:button}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}*,*:after,*:before{box-sizing:inherit}html{box-sizing:border-box}body{color:#323232;background-color:#fefefe;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Roboto,noto,helvetica neue,helvetica,arial,sans-serif;font-size:1.2em;letter-spacing:.0625em;line-height:1.5em}a{font-weight:600;color:#000}a:focus,a:hover{text-decoration:underline;color:#36c}p a{color:#193366;text-underline-position:under}p a:focus,p a:hover{color:#36c}.navigation{height:6rem;width:100%}.navigation a{display:inline;font-size:1.6rem;text-transform:uppercase;line-height:6rem;letter-spacing:.1rem}@media only screen and (min-device-width:320px) and (max-device-width:768px){.navigation a{font-size:1.6rem}}.navigation ul{list-style:none;margin-bottom:0;margin-top:0}.navigation ul li{float:left;margin:0;position:relative}.navigation ul li a{margin-left:1rem;margin-right:1rem}@media only screen and (min-device-width:320px) and (max-device-width:768px){.navigation ul li{float:none!important}}@media only screen and (min-device-width:320px) and (max-device-width:768px){.navigation ul{visibility:hidden;opacity:0;max-height:0;z-index:5;top:5rem;right:0;width:100%;position:absolute;background-color:rgba(254,254,254,.98);padding:0;border-bottom:solid 2px #e2dfe1;transition:opacity .25s,max-height .15s linear}}#menu-control{display:none}.btn-mobile{display:none}.mobile-menu-lang-separator-centered{display:none}@media all and (max-width:1023px){.content{padding:10px}}@media all and (min-width:1200px){.content{max-width:1200px}}.content article header{margin-top:3.2rem;margin-bottom:3.2rem}.content article header h1,.content article header h2{margin:0}.content article header h2{margin-top:1rem;font-size:1.8rem;color:#323232}@media only screen and (min-device-width:320px) and (max-device-width:480px){.content article header h2{font-size:1.6rem}}.pagination{margin-top:6rem;text-align:center}.pagination li{display:inline;text-align:center}.pagination li span{margin:0;text-align:center;width:3.2rem}.pagination li a span{margin:0;text-align:center;width:3.2rem}.float-right{float:right}.float-left{float:left}.navigation{height:auto;box-shadow:0 0 1px rgba(0,0,0,8%);border-bottom:1px solid rgba(0,0,0,.15)}pre{overflow-x:auto}code{border-radius:3px;display:inline-block;background-color:#272822;color:#fefefe;padding:.2rem .4rem;font-size:.8em}blockquote{border-left:2px solid #dcdcdc;padding-left:1.6rem;font-style:italic}.breadcrumb{list-style:none;display:flex;flex-wrap:wrap;align-items:baseline}.breadcrumb li{display:inline;font-size:.9em}.breadcrumb li a{text-decoration:none}.breadcrumb li+li:before{content:"â­";content:"â¦";color:#408ee0;padding:.1rem}.hlbox img{float:right}.container{margin:0 auto;max-width:100%}.highlight pre{white-space:pre-wrap;word-break:break-word}.highlight-box{background-color:#e3f1ff;border:1px solid #0051a2;border-radius:4px;margin-bottom:5rem;margin-top:5rem;padding:10px}.cs{background-color:#408ee0;border:1px solid #1b75be;border-radius:4px;display:inline-block;margin-left:1rem;margin-top:2rem;padding:15px 30px}.cs p{color:#e3f1ff;font-size:1.2em;font-weight:bolder}.cs a{color:#e3f1ff}.fb{background-color:#408ee0;border-top:1px solid #1b75be;padding:5px 20px}.fb p{color:#e3f1ff;font-weight:bolder}.fb a{color:#e3f1ff}.footer{background-color:#0051a2;color:#e3f1ff;font-size:.9em;line-height:2rem;margin-top:2rem;width:100%}.footer a{color:#e3f1ff}.three-column-grid{display:block}.three-column-grid>*{padding:1rem}@media(min-width:768px){.three-column-grid{display:grid;grid-auto-rows:1fr;grid-template-columns:1fr 1fr 1fr}}.grid{display:grid;gap:0 0;grid-template-areas:"gr-header gr-header gr-header" ". gr-content ." "gr-footer gr-footer gr-footer";max-width:100%}@media all and (max-width:1023px){.grid{grid-template-areas:"gr-header" "gr-content" "gr-footer";grid-template-columns:1fr}}@media all and (min-width:1024px){.grid{grid-template-columns:.5fr 2fr .5fr}}.gr-content{grid-area:gr-content}.gr-header{grid-area:gr-header}.gr-footer{grid-area:gr-footer}h1{font-size:3rem;line-height:3.2rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h1{font-size:2.8rem;line-height:3rem}}h2{color:#1b75be;font-size:2.4rem;line-height:2.6rem;margin-top:4rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h2{font-size:2rem;line-height:2.2rem}}h3{color:#408ee0;font-size:1.6rem;line-height:1.8rem;margin-top:3rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h3{font-size:1.8rem;line-height:2rem}}h4{color:#408ee0;font-size:1.4rem;line-height:1.6rem;margin-top:2rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h4{font-size:1.6rem;line-height:1.8rem}}h5{font-size:1.2rem;line-height:1.4rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h5{font-size:1.6rem;line-height:1.6rem}}h6{font-size:1rem;line-height:1.2rem}figure{margin:0}img.max-width{max-width:100%;height:auto}.icon{filter:invert(19%)sepia(64%)saturate(973%)hue-rotate(209deg)brightness(83%)contrast(105%);margin:3px}.icon:link{text-decoration:none}.icon:visited{text-decoration:none}.icon:hover{filter:invert(32%)sepia(28%)saturate(906%)hue-rotate(201deg)brightness(91%)contrast(86%);text-decoration:none}.icon:active{text-decoration:none}.menuicon{filter:invert(93%)sepia(32%)saturate(4070%)hue-rotate(177deg)brightness(105%)contrast(104%)}a:before,a:after{bottom:-2px;display:inline-block;width:0;height:2px}a:before{left:50%}a:after{right:50%}a:hover{text-decoration:none}a:hover:before,a:hover:after{width:50%}.bts:link,.bts:visited{font-size:.9em;text-decoration:none}.btn:link,.btn:visited{border-radius:4px;color:#fff;padding:14px 25px;text-align:center;text-decoration:none;display:inline-block}.btn-cta:link,.btn-cta:visited{background-color:#1b75be}.btn-cta:hover,.btn-cta:active{background-color:#408ee0}.btn-cs:link,.btn-cs:visited{background-color:#0051a2}.btn-cs:hover,.btn-cs:active{background-color:#1b75be}ul li{list-style:square}ul li a{font-weight:500;text-decoration:none}ul li::marker{color:#0051a2}.inl-list span{font-size:.8em}.inl-list ul{display:inline-block;list-style:none;padding-left:.1em;margin:.1em}.inl-list ul li{display:inline-block;font-size:.8em}header{position:relative}.header-content{align-items:center;background-color:#0051a2}.logo{text-decoration:none;font-size:25px;color:inherit}label{padding:23px 20px;position:absolute;cursor:pointer;right:0;top:0}input[type=checkbox]{opacity:0;position:absolute;right:0}label span{background:#e3f1ff;display:block;height:3px;position:relative;width:20px}label span::after,label span::before{background:inherit;content:"";display:block;height:inherit;position:absolute;width:inherit}label span::before{top:8px}label span::after{bottom:8px}label::before{position:absolute;content:"";width:58px;height:49px;top:0;right:0}ul.menu li{color:#e3f1ff;font-size:18px;list-style:none}ul.menu li button{border:none;background-color:transparent;cursor:pointer;width:100%}ul.menu li a{color:#e3f1ff;display:block;text-decoration:none;font-family:inherit;font-size:inherit;font-weight:600}ul.menu li a,ul li button{padding:.7rem .8rem;text-align:left}.menus{background:#0051a2;left:0;position:absolute;right:0;top:2.6rem;visibility:hidden;transform:translateY(-1em);transition:transform ease .2s}input[type=checkbox]:checked~nav>ul{visibility:visible;transform:translateY(0)}.dropdown{padding:2px 1.5rem;height:0;overflow:hidden;transition:height ease .2s}li:focus-within .dropdown{height:auto}@media(max-width:360px){.logo img{visibility:collapse}}@media(max-width:480px){.logo img{max-width:300px}}@media(min-width:800px){.header-content{display:flex}.menus{position:static;visibility:visible;background:#fff;display:flex;transform:initial}label,input[type=checkbox]{display:none}ul.menu{background-color:#0051a2}ul.menu li{color:#e3f1ff;position:relative;font-size:1em}ul.menu li a:hover,ul.menu li button:hover{background-color:#1b75be;color:#e3f1ff}.dropdown{position:absolute;right:0;left:auto;box-shadow:0 10px 15px -3px rgba(46,41,51,8%),0 4px 6px -2px rgba(71,63,79,.16);z-index:99;min-width:10rem;padding:0;background-color:#408ee0;border-radius:0 0 .5rem .5rem}ul.menu li:hover .dropdown{height:auto}}table td,table th{border:2px solid #000}table tr:first-child th{border-top:0}table tr:last-child td{border-bottom:0}table tr td:first-child,table tr th:first-child{border-left:0}table tr td:last-child,table tr th:last-child{border-right:0}table{border-collapse:collapse;margin:20px 0;font-size:.9em;min-width:360px;box-shadow:0 0 20px rgba(0,0,0,.15)}table thead tr{text-align:left}table thead th{background:#1b75be;color:#fff}td,th{padding:12px 15px}tr:nth-child(even){background:#f8f8f8}tbody tr{border-bottom:1px solid #f8f8f8}tbody tr:hover{background-color:coral}tbody td:hover{background-color:#ff662e}tbody tr:last-of-type{border-bottom:2px solid #1b75be}.table-wrapper{overflow-x:auto}.fl-table{border-radius:5px;font-size:14px;font-weight:400;border:none;border-collapse:collapse;width:100%;max-width:100%;background-color:#fff}.fl-table td,.fl-table th{text-align:left;padding:8px;vertical-align:top}.fl-table td{border-right:1px solid #f8f8f8;font-size:14px}.fl-table thead th{color:#fff;background:#1b75be}.fl-table thead th:nth-child(odd){color:#fff;background:#1b75be}.fl-table tr:nth-child(even){background:#f8f8f8}.tags{display:flex;justify-content:space-between}.tags ul{padding:0;margin:0}.tags li{border-radius:4px;color:#fafaff;font-size:.8em;display:inline;margin:4px 2px;padding:4px 10px}.tags-def li{background-color:#1b75be}.tags li a{text-decoration:none;color:#fafaff}.b-c-c1{background-color:#006c84}.b-c-c2{background-color:#e8175d}.b-c-c3{background-color:#265c00}.b-c-c4{background-color:#f26b38}.b-c-c5{background-color:#a7226e}.b-c-c6{background-color:#336b87}.b-c-c7{background-color:#2a3132}.b-c-c8{background-color:#764626}dfn.help{cursor:help;text-decoration:underline dotted}.bold{font-weight:700}.false{color:#922b21}.generic{color:#34495e}.gray{color:#626262}.cap{color:#626262}.host{color:#7d3c98}.path{color:#4a235a}.true{color:#196f3d}.uri{color:#9a7d0a}.var{color:#8b008b}.value{color:#008c00}.i{font-style:italic}.ta-l{text-align:left}@media only screen and (max-width:1023px){.truncate{width:600px}.truncate .truncate:after{content:"â¦"}}@media only screen and (max-width:799px){.truncate{width:430px}}.two-column-grid{display:grid;grid-template-columns:1fr}.two-column-grid>*{padding:1rem}@media(min-width:1600px){.two-column-grid{display:grid;grid-template-columns:1fr 1fr}}.bg{color:#f8f8f2;background-color:#272822}.chroma{color:#f8f8f2;background-color:#272822}.chroma .err{color:#960050;background-color:#1e0010}.chroma .lnlinks{outline:none;text-decoration:none;color:inherit}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0}.chroma .hl{background-color:#3c3d38;background-color:#1d1e19;font-weight:bolder}.chroma .lnt{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .line{display:flex}.chroma .k{color:#66d9ef}.chroma .kc{color:#66d9ef}.chroma .kd{color:#66d9ef}.chroma .kn{color:#f92672}.chroma .kp{color:#66d9ef}.chroma .kr{color:#66d9ef}.chroma .kt{color:#66d9ef}.chroma .na{color:#a6e22e}.chroma .nc{color:#a6e22e}.chroma .no{color:#66d9ef}.chroma .nd{color:#a6e22e}.chroma .ne{color:#a6e22e}.chroma .nf{color:#a6e22e}.chroma .nx{color:#a6e22e}.chroma .nt{color:#f92672}.chroma .l{color:#ae81ff}.chroma .ld{color:#e6db74}.chroma .s{color:#e6db74}.chroma .sa{color:#e6db74}.chroma .sb{color:#e6db74}.chroma .sc{color:#e6db74}.chroma .dl{color:#e6db74}.chroma .sd{color:#e6db74}.chroma .s2{color:#e6db74}.chroma .se{color:#ae81ff}.chroma .sh{color:#e6db74}.chroma .si{color:#e6db74}.chroma .sx{color:#e6db74}.chroma .sr{color:#e6db74}.chroma .s1{color:#e6db74}.chroma .ss{color:#e6db74}.chroma .m{color:#ae81ff}.chroma .mb{color:#ae81ff}.chroma .mf{color:#ae81ff}.chroma .mh{color:#ae81ff}.chroma .mi{color:#ae81ff}.chroma .il{color:#ae81ff}.chroma .mo{color:#ae81ff}.chroma .o{color:#f92672}.chroma .ow{color:#f92672}.chroma .c{color:#75715e}.chroma .ch{color:#75715e}.chroma .cm{color:#75715e}.chroma .c1{color:#75715e}.chroma .cs{color:#75715e}.chroma .cp{color:#75715e}.chroma .cpf{color:#75715e}.chroma .gd{color:#f92672}.chroma .ge{font-style:italic}.chroma .gi{color:#a6e22e}.chroma .gs{font-weight:700}.chroma .gu{color:#75715e}</style></head><body><div class=grid><div class=gr-header><header><div class=header-content><a class=logo href=/ title aria-label=Logo><figure aria-label=Logo><picture><img class=max-width src=/images/logo/linux-audit-logo.svg alt=Logo decoding=async width=600 height=200></picture></figure></a><input type=checkbox id=hamburger aria-label="Menu button">
<label for=hamburger><span></span></label><nav aria-label="Main navigation menu"><ul class="menus menu" role=menubar aria-label="Menu top"><li role=none><a id=button-link-2 href=/linux-security/ role=menuitem aria-haspopup=true aria-expanded=true>Linux security</a><ul class=dropdown id=dropdown-2 role=menu><li role=none><a href=/malware/ role=menuitem>Malware</a></li><li role=none><a href=/lynis/ role=menuitem>Tool: Lynis</a></li></ul></li><li role=none><a id=button-link-3 href=/system-administration/ role=menuitem aria-haspopup=true aria-expanded=true>System administration</a><ul class=dropdown id=dropdown-3 role=menu><li role=none><a href=/filesystems/ role=menuitem>File systems</a></li><li role=none><a href=/hardware/ role=menuitem>Hardware</a></li><li role=none><a href=/kernel/ role=menuitem>Kernel</a></li><li role=none><a href=/networking/ role=menuitem>Networking</a></li><li role=none><a href=/processes/ role=menuitem>Processes</a></li><li role=none><a href=/shell-scripting/ role=menuitem>Shell scripting</a></li><li role=none><a href=/software/ role=menuitem>Software</a></li><li role=none><a href=/ssh/ role=menuitem>SSH</a></li><li role=none><a href=/system-performance/ role=menuitem>System performance</a></li><li role=none><a href=/systemd/ role=menuitem>Systemd</a></li><li role=none><a href=/web/ role=menuitem>Web</a></li></ul></li><li role=none><a id=button-link-4 href=# role=menuitem aria-haspopup=true aria-expanded=true>Content and overviews</a><ul class=dropdown id=dropdown-4 role=menu><li role=none><a href=/abbreviations/ role=menuitem>Abbreviations</a></li><li role=none><a href=/definitions/ role=menuitem>Definitions</a></li><li role=none><a href=/glossary/ role=menuitem>Glossary</a></li><li role=none><a href=/website/sitemap/ role=menuitem>Sitemap</a></li><li role=none><a href=/kernel/syscalls/ role=menuitem>Syscalls</a></li><li role=none><a href=/categories/ role=menuitem>Topics by category</a></li><li role=none><a href=/tags/ role=menuitem>Topics by tag</a></li></ul></li><li role=none><a id=button-link-5 href=/command-line/ role=menuitem aria-haspopup=true aria-expanded=true>Command line</a><ul class=dropdown id=dropdown-5 role=menu><li role=none><a href=/cheat-sheets/ role=menuitem>Cheat Sheets</a></li><li role=none><a href=/system-administration/commands/ role=menuitem>Commands</a></li></ul></li><li role=none><a id=button-link-6 href=/about/ role=menuitem aria-haspopup=true aria-expanded=true>About</a><ul class=dropdown id=dropdown-6 role=menu><li role=none><a href=/contact/ role=menuitem>Contact</a></li></ul></li><li role=none><a id=button-link-7 href=/search/ role=menuitem><img class=menuicon src=/images/icons/magnifying-glass.svg height=20 width=20 alt="Search icon">
Search</a></li></ul></nav></div></header><nav aria-label=Breadcrumbs><ol class=breadcrumb><li><img src=/images/icons/home.svg height=16 width=16 alt=Home>&nbsp;<a href=https://linux-audit.com/>Linux Audit</a></li><li class=active><a aria-current=page href=/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading/ class=truncate>Increase kernel integrity with disabled Linux kernel modules loading</a></li></ol></nav></div><div class=gr-content><main id=main><div class="content speakable"><div class="container page"><div class="tags tags-def"><ul><li><a href=/tags/integrity/>integrity</a></li><li><a href=/tags/kernel/>kernel</a></li><li><a href=/tags/linux/>linux</a></li></ul></div><article><header><h1>Increase kernel integrity with disabled Linux kernel modules loading</h1></header><nav id=TableOfContents><ul><li><a href=#disable-kernel-modules>Disable kernel modules</a></li><li><a href=#loading-modules>Loading modules</a></li><li><a href=#activating-kernelmodules_disabled>Activating kernel.modules_disabled</a></li><li><a href=#protection-against-re-enabling>Protection against re-enabling</a></li><li><a href=#disable-module-loading-after-boot-time>Disable module loading after boot time</a><ul><li><a href=#caveat-things-might-break>Caveat: Things might break</a></li><li><a href=#hybrid-option>Hybrid option</a></li></ul></li></ul></nav><p><em>Disable loading kernel module on Linux systems</em></p><p>The Linux kernel can be configured to disallow loading new kernel modules. This feature is especially useful for high secure systems, or if you care about securing your system to the fullest. In this article, we will have a look at the configuration of this option. At the same timeÂ allowing legitimate kernel modules to be loaded.</p><h2 id=disable-kernel-modules>Disable kernel modules</h2><p>Newer kernel modules have a sysctl variable named kernel.modules_disabled.</p><p>Sysctl is the tool which allows you to see and change kernel settings of a running system. The related /etc/sysctl.conf file is used to ensure that your settings are also used at the next boot of the system.</p><p>The sysctl key <strong>kernel.modules_disabled</strong> is very straightforward. If it contains a &ldquo;1&rdquo; it will disable loading new modules, where a &ldquo;0&rdquo; will still allow loading them.</p><p>Using this option will be a great protection against loading malicious kernel modules. For example, it may help to counter rootkits. Needless to say, but when someone was already been able to gain root access, you have a serious problem. Still, setting this security measure can be useful to achieve maximum hardening of your Linux system. An altered script or programÂ has no chance of loading things you didn&rsquo;t specificallyÂ approve.</p><h2 id=loading-modules>Loading modules</h2><p>To show this functionality, we first will load a module and then see how the related sysctl value works. For this demo purpose, we will use the XOR module, which is part of the crypto category.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># cd /lib/modules/3.13.0-24-generic/kernel/crypto/
</span></span><span class=line><span class=cl># ls -l
</span></span><span class=line><span class=cl>total 1012
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root  8516 may 3 2014 ablk_helper.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 20436 may 3 2014 af_alg.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 13892 may 3 2014 algif_hash.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 17748 may 3 2014 algif_skcipher.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 11772 may 3 2014 ansi_cprng.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 15756 may 3 2014 anubis.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root  6828 may 3 2014 arc4.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 17180 may 3 2014 authencesn.ko
</span></span><span class=line><span class=cl>..snip..
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 26076 may 3 2014 twofish_common.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 10028 may 3 2014 twofish_generic.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 13540 may 3 2014 vmac.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 31372 may 3 2014 wp512.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root  9028 may 3 2014 xcbc.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 21124 may 3 2014 xor.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 10596 may 3 2014 xts.ko
</span></span><span class=line><span class=cl>-rw-r--r-- 1 root root 16396 may 3 2014 zlib.ko
</span></span></code></pre></div><p><strong>Background information:</strong></p><p>The XOR kernel module uses the &ldquo;exclusive OR&rdquo; function, which returns True when an odd number of the given arguments equals to be true, and False when an evenÂ are true. Usually it is used with two arguments, so to return True, only 1 of the options can be positive.</p><p>Back to the loading of the module. First we ensure this module is not loaded:</p><p>Now we load the module with the insmodÂ command and then check if loading was successful:</p><p>The module is loaded, as expected. To show normal behavior, we now will remove the kernel module with the rmmod command.</p><p>The module is released. Time to disable this functionality, to increase protection against loading malicious modules.</p><h2 id=activating-kernelmodules_disabled>Activating kernel.modules_disabled</h2><p>By default, the sysctl key is set to &ldquo;0&rdquo;, which means new modules can be loaded. This is a safe default for systemsÂ but also allows malicious modules to be loaded.</p><p>Now we disable loading new modules, by using the sysctl key and set it to &ldquo;1&rdquo;. There are two ways of doing it, using sysctl directly or echo the value to a file on the pseudo file system /proc, which holds the kernel settings.</p><p>Now we try loading our XOR module again:</p><p>Loading the module is now no longer allowed, exactly what we wanted.</p><h2 id=protection-against-re-enabling>Protection against re-enabling</h2><p>You might think that loading a kernel module is as simple as re-enabling the option and then still load your kernel module. The kernel has a built-in protection, to avoid this from happening. Trying to set the value back to &ldquo;0&rdquo; will result in an &ldquo;invalid argument&rdquo; message.</p><p>As can be seen,Â sysctl will say the value is set to &ldquo;0&rdquo;. However, the value isn&rsquo;t applied, as this key is read-only. Slightly confusing, and therefore always good to check the value again.</p><p>As expected, the value is still set to &ldquo;1&rdquo;.</p><h2 id=disable-module-loading-after-boot-time>Disable module loading after boot time</h2><p>By configuring the /etc/sysctl.conf file we can disallow the loading of kernel modules at boot time. Simply add the related line, with the value &ldquo;1&rdquo; as shown in the example.</p><h3 id=caveat-things-might-break>Caveat: Things might break</h3><p>Depending on your environment, you might be careful with using this option. It may be working very well on servers, but not on desktop systems. The reason is the type of usage is different, especially when it comes with loading new kernel modules. For example inserting a USB drive, mouse or network functionality might break. So before deploying the option, make sure you test these common use cases.</p><h3 id=hybrid-option>Hybrid option</h3><p>Instead of enabling the option directly via /etc/sysctl.conf, it might be better to activate this setting after booting and loading required modules.</p><p>Your startup script could be looking like:</p><p>Usually to get iptables working, these are the related modules: <strong>iptables</strong>, <strong>x_tables</strong>, <strong>iptable_filter</strong>.</p><p>Depending on your Linux distribution, the startup should be loaded as late as possible. If you have /etc/rc.local available, that is usually a safe bet.</p><p>Do you use this option already? Or found some other caveats?Â Like to hear!</p></article></div><div><h2>Relevant commands in this article</h2><p>Like to learn more about the commands that were used in this article? Have a look, for some there is also a <a href=/cheat-sheets/>cheat sheet</a> available.</p><ul><li>insmod</li><li>rmmod</li><li>sysctl</li></ul></div><aside><div class="highlight-box two-column-grid"><div><h2>Take the next step!</h2><p class=bold>Want to learn more about Linux security? Have a look at the open source tool Lynis and become a Linux security expert yourself.</p><p>Lynis is a battle-tested technical security audit tool. It is open source, freely available, and used by system administrators all over the world. Other users include IT auditors, security professionals, like pentesters.</p><p>Lynis is not just for Linux security, but also supports BSD, macOS, busybox, and other Unix-based systems or environments.</p><h3>Tool Information</h3><ul><li>Cost: Free</li><li>License: GPLv3</li><li>Links<ul><li><a href=https://github.com/CISOfy/lynis>GitHub project</a></li><li><a href=https://packages.cisofy.com/>Packages (deb/rpm)</a></li><li><a href=https://cisofy.com/downloads/lynis/>Tarball</a></li></ul></li></ul><a href=https://cisofy.com/lynis/ class="btn btn-cta">Visit project page</a></div><div><img class=max-width src=/images/lynis-screenshot-800x600.webp loading=lazy alt="Screenshot of Lynis security tool"></div></div></aside><div><h2>Feedback</h2><img src=/authors/michael-boelen/images/michael-boelen-200x200.webp alt="Small picture of Michael Boelen" loading=lazy height=200 width=200 style=float:left;padding-right:20px><p>This article has been written by our Linux security expert Michael Boelen. With focus on creating high-quality articles and relevant examples, he wants to improve the field of Linux security. No more web full of copy-pasted blog posts.</p><p>Discovered outdated information or have a question? <a href=/contact/>Share your thoughts</a>. Thanks for your contribution!</p><a href=https://mastodon.social/@mboelen><img src=/images/icons/mastodon.svg height=32 width=32 loading=lazy alt="Mastodon icon" title="Follow Michael on Mastodon"></a></div><div class=container><aside id=meta><hr><p>â Previous article: <a class=previous href=https://linux-audit.com/logging-root-actions-by-capturing-execve-system-calls/>Logging root actions by capturing execve system calls</a>
âº Next article: <a class=next href=https://linux-audit.com/kernel-hardening-disable-and-blacklist-linux-modules/>Kernel hardening: Disable and blacklist Linux modules</a></p><hr><h2>Page details and related articles</h2><div><h3>Similar articles</h3><ul><li><a href=/linux-kernel-security-and-how-to-improve-it/>Linux kernel security and how to improve it</a></li><li><a href=/kernel-hardening-disable-and-blacklist-linux-modules/>Kernel hardening: Disable and blacklist Linux modules</a></li><li><a href=/how-to-check-arch-linux-system-needs-reboot/>How to check if your Arch Linux system needs a reboot</a></li><li><a href=/protect-ptrace-processes-kernel-yama-ptrace_scope/>Protect against ptrace of processes: kernel.yama.ptrace_scope</a></li><li><a href=/how-to-secure-linux-systems-auditing-hardening-and-security/>How to secure a Linux system</a></li></ul></div><div><h3>Page information</h3><p>This article has a word count of 904 and last changed or reviewed at <time datetime=2024-06-11>2024-06-11</time>.</p></div><div><h3>Topics</h3><ul id=topics><li><a href=/categories/hardening/>Hardening</a></li><li><a href=/categories/kernel-integrity/>Kernel Integrity</a></li><li><a href=/categories/linux/>Linux</a></li></ul></div></aside></div></div></main></div><div class=gr-footer><footer class=footer><div class=three-column-grid><div><p><a href=/privacy-policy/>Privacy first</a>, no tracking, no cookies!</p><p>Our green initiative: <a href=/sustainable-web-design/>Sustainable Web Design</a></p><img src=/images/icons/sustainable-green.svg height=64 width=64 loading=lazy alt="Sustainable website design icon" title="Learn more about the sustainable web design of this blog"></div><div><p>Stay up-to-date</p><ul><li><a href=https://mastodon.social/@mboelen>@mboelen at Mastodon</a></li><li><a href=https://linux-audit.com/atom.xml>RSS Atom feed</a> or <a href=https://linux-audit.com/feed.json>JSON Feed</a></li><li><a href=/website/sitemap/>Sitemap</a></li><li><a href=/website/latest-changes/>Latest changes</a></li></ul></div><div><p>Linux Audit is a blog with the focus on system administrators, security professionals, and auditors. The goal is to provide high-quality articles related to Linux security and system administration, so you can test and secure your systems.</p><a class="btn btn-cta" href=/contact/>Contact</a></div></div></footer></div></div><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","@id":"https:\/\/linux-audit.com\/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading\/#article","datePublished":"2015-05-12T19:44:06Z","dateModified":"2024-06-11T14:07:37.079704041Z","wordCount":904,"inLanguage":"en","isPartOf":{"@context":"https://schema.org","@type":"WebPage","@id":"https:\/\/linux-audit.com\/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading\/#webpage","name":"Increase kernel integrity with disabled Linux kernel modules loading","datePublished":"2015-05-12T19:44:06Z","dateModified":"2024-06-11T14:07:37.079704041Z","description":"The Linux kernel can be configured to disallow loading new kernel modules. Learn how to configure this.","inLanguage":"en","mainContentOfPage":{"@type":"WebPageElement","cssSelector":".content"},"speakable":{"@type":"SpeakableSpecification","cssSelector":".speakable"},"isPartOf":{"@type":"WebSite","@id":"https:\/\/linux-audit.com\/#website","url":"https:\/\/linux-audit.com\/","name":"Linux Audit"}}}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":"https:\/\/linux-audit.com\/","name":"Linux Audit"},{"@type":"ListItem","position":2,"item":"https:\/\/linux-audit.com\/increase-kernel-integrity-with-disabled-linux-kernel-modules-loading","name":"Increase kernel integrity with disabled linux kernel modules loading"}]}</script></body></html>