<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Cobalt Strike, a Defender&#8217;s Guide &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="827935a82e18836289f225e5-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/14.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.7.1' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/14.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/14.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="827935a82e18836289f225e5-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/3529" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel="canonical" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=3529' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2021%2F08%2F29%2Fcobalt-strike-a-defenders-guide%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2021%2F08%2F29%2Fcobalt-strike-a-defenders-guide%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="827935a82e18836289f225e5-text/javascript"></script>
		<script type="827935a82e18836289f225e5-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="827935a82e18836289f225e5-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=BEAC12F1746656028F030F09E16C8607');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Cobalt Strike, a Defender&#8217;s Guide" />
<meta property="og:url" content="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/" />
<meta property="og:description" content="Intro In our research, we expose adversarial Tactics, Techniques and Procedures (TTPs) as well as the tools they use to execute their mission objectives. In most of our cases, we see the threat act…" />
<meta property="article:published_time" content="2021-08-29T23:36:36+00:00" />
<meta property="article:modified_time" content="2024-08-22T23:14:10+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2021/08/1-10.png" />
<meta property="og:image:width" content="1140" />
<meta property="og:image:height" content="740" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Cobalt Strike, a Defender&#8217;s Guide" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2021/08/1-10.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-3529 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Wednesday, December 18, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-3529" class="post-3529 post type-post status-publish format-standard hentry category-cobaltstrike category-tools entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
		
			<a class="category-color-44" href="https://thedfirreport.com/category/tools/">Tools</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">Cobalt Strike, a Defender&#8217;s Guide</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/" rel="bookmark"><time class="entry-date published" datetime="2021-08-29T23:36:36+00:00">August 29, 2021</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 class="wp-block-heading">Intro</h2>



<p>In our research, we expose adversarial Tactics, Techniques and Procedures (TTPs) as well as the tools they use to execute their mission objectives. In most of our cases, we see the threat actors utilizing Cobalt Strike. Therefore, defenders should know how to detect Cobalt Strike in various stages of its execution. The primary purpose of this post is to expose the most common techniques that we see from the intrusions that we track and provide detections. Having said that, not all of Cobalt Strike&#8217;s features will be discussed.</p>
<p>As you have noticed from our reporting so far, Cobalt Strike is used as a post-exploitation tool with various malware droppers responsible for the initial infection stage. Some of the most common droppers we see are IcedID (a.k.a. BokBot), ZLoader, Qbot (a.k.a. QakBot), Ursnif, Hancitor, Bazar and TrickBot. Cobalt Strike is chosen for the second stage of the attack as it offers enhanced post-exploitation capabilities. Threat actors turn to Cobalt Strike for its ease of use and extensibility.</p>
<p>Thanks to <a class="link-complex" href="https://twitter.com/Kostastsale/" target="_blank" rel="noopener user" data-user-name="Kostastsale">@<span class="link-complex-target">Kostastsale</span></a> for helping put this guide together!</p>
<h2 class="wp-block-heading">The DFIR Report Services</h2>
<ul class="wp-block-list">
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-brief" target="_blank" rel="noreferrer noopener">Private Threat Briefs</a>: Over 20 private DFIR reports annually.</li>
<li><a href="https://thedfirreport.com/services/threat-intelligence/#threat-feed" target="_blank" rel="noreferrer noopener">Threat Feed</a>: Focuses on tracking Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, etc.</li>
<li><a href="https://thedfirreport.com/services/threat-intelligence/#all-intel" target="_blank" rel="noreferrer noopener">All Intel</a>: Includes everything from Private Threat Briefs and Threat Feed, plus private events, opendir reports, long-term tracking, data clustering, and other curated intel.</li>
<li><a href="https://thedfirreport.com/services/detection-rules/" target="_blank" rel="noreferrer noopener">Private Sigma Ruleset</a>: Features 100+ Sigma rules derived from 40+ cases, mapped to ATT&amp;CK with test examples.</li>
<li><a href="https://thedfirreport.com/services/dfir-labs/" target="_blank" rel="noreferrer noopener">DFIR Labs</a>: Offers cloud-based, hands-on learning experiences, using real data, from real intrusions. Interactive labs are available with different difficulty levels and can be accessed on-demand, accommodating various learning speeds.</li>
</ul>
<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noreferrer noopener">Contact us</a> today for pricing or a demo!</p>



<h2 class="wp-block-heading">Cobalt Strike Capabilities</h2>



<p>Cobalt Strike has many features, and it is under constant development by a team of developers at <a href="https://www.coresecurity.com/products/cobalt-strike" target="_blank" rel="noopener">Core Security</a> by Help Systems. Raphael Mudge was the primary maintainer for many years before the acquisition from Core Security. Raphael has an <a href="https://www.youtube.com/playlist?list=PL9HO6M_MU2nfQ4kHSCzAQMqxQxH47d1no" target="_blank" rel="noopener">extensive playlist on youtube</a> that demonstrates the many features of Cobalt Strike and step-by-step guides on how to use its full potential. His videos are handy to watch if you want to get a glimpse of all the features that Cobalt Strike has to offer in various phases of the intrusion. Below are some of the capabilities that we see being used by operators. This is not an exhaustive list of commands available, but it contains most of the built-in features that we encounter in most cases. In the table below, the &#8220;Documented Features&#8221; correspond to the Cobalt Strike execution commands via the interactive shell as per official <a href="https://www.cobaltstrike.com/help-beacon" target="_blank" rel="noopener">documentation</a>:</p>



<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td><strong>Capabilities</strong></td>
<td><strong>Documented features/commands</strong></td>
</tr>
<tr>
<td>Upload and Download payloads and files</td>
<td>
<p>Download &lt;file&gt;</p>
<p>Upload &lt;file&gt;</p>
</td>
</tr>
<tr>
<td>Running Commands</td>
<td>
<p>shell &lt;command&gt;</p>
<p>run &lt;command&gt;</p>
<p>powershell &lt;command&gt;</p>
</td>
</tr>
<tr>
<td>Process Injection</td>
<td>
<p>inject &lt;pid&gt;</p>
<p>dllinject &lt;pid&gt; <em>(for reflective dll injection)</em></p>
<p>dllload &lt;pid&gt; (<em>for loading an on-disk DLL to memory)</em></p>
<p>spawnto &lt;arch&gt; &lt;full-exe-path&gt; (<em>for process hollowing)</em></p>
</td>
</tr>
<tr>
<td>SOCKS Proxy</td>
<td>socks &lt;port number&gt;</td>
</tr>
<tr>
<td>Privilege Escalation</td>
<td>
<p>getsystem <em>(SYSTEM account impersonation using named pipes)</em></p>
<p>elevate svc-exe [listener] <em>(creates a services that runs a payload as SYSTEM)</em></p>
</td>
</tr>
<tr>
<td>Credential and Hash Harvesting</td>
<td>
<p>hashdump</p>
<p>logonpasswords <em>(Using Mimikatz)</em></p>
<p>chromedump <em>(Recover Google Chrome passwords from current user)</em></p>
</td>
</tr>
<tr>
<td>Network Enumeration</td>
<td>
<p>portscan [targets] [ports] [discovery method]</p>
<p>net &lt;commands&gt; <em>(commands to find targets on the domain)</em></p>
</td>
</tr>
<tr>
<td>Lateral Movement</td>
<td>
<p>jump psexec <em>(Run service EXE on remote host)</em></p>
<p>jump psexec_psh <em>(Run a PowerShell one-liner on remote host via a service)</em></p>
<p>jump winrm <em>(Run a PowerShell script via WinRM on remote host)</em></p>
<p><em>remote-exec &lt;any of the above&gt; (Run a single command using the above methods on remote host)</em></p>
</td>
</tr>
</tbody>
</table>
</figure>



<h2 class="wp-block-heading">Cobalt Strike Infrastructure</h2>



<p>Changing infrastructure will always be inconvenient for the threat actors, but it is not a difficult task. Additionally, Cobalt Strike is able to make use of &#8220;redirectors.&#8221; Therefore, some of these servers could be a redirector instead of the actual Cobalt Strike C2 server. <a href="https://blog.cobaltstrike.com/2014/01/14/cloud-based-redirectors-for-distributed-hacking/" target="_blank" rel="noopener">Redirectors</a> are hosts that do what the name implies, redirect traffic to the real C2 server. Threat actors can hide their infrastructure behind an army of redirectors and conceal the actual C2 server. This makes the malicious infrastructure harder for the defenders to discover and block.<br />Image taken from the <a href="https://blog.cobaltstrike.com/2014/01/14/cloud-based-redirectors-for-distributed-hacking/" target="_blank" rel="noopener">official</a> cobalt strike documentation:</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image.png"><img fetchpriority="high" decoding="async" class="alignnone wp-image-3530 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image.png" alt="" width="1404" height="1224" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image.png 1404w, https://thedfirreport.com/wp-content/uploads/2021/07/image-300x262.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-1024x893.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-768x670.png 768w" sizes="(max-width: 1404px) 100vw, 1404px" /></a></figure>



<p>Our Threat Feed service tracks hundreds of Cobalt Strike servers and other C2 infrastructure. More information on this service and others can be found <a href="https://thedfirreport.com/services/">here</a>.</p>
<p><img decoding="async" class="alignnone size-full wp-image-4001" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-13.png" alt="" width="915" height="703" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/1-13.png 915w, https://thedfirreport.com/wp-content/uploads/2021/08/1-13-300x230.png 300w, https://thedfirreport.com/wp-content/uploads/2021/08/1-13-768x590.png 768w" sizes="(max-width: 915px) 100vw, 915px" /></p>



<h3 class="wp-block-heading">Malleable C2 profiles</h3>



<p>Cobalt Strike has adopted Malleable profiles and allows the threat actors to customize almost every aspect of the C2 framework. This makes life harder for defenders as the footprint can change with each profile modification. The threat actors have the ability to change anything from the network communication (like user agent, headers, default URIs) to individual post-exploitation functions such as process injection and payload obfuscation capabilities.</p>
<p>Across many of our investigations the profiles used differ, but you can see that actors do often reuse or pattern emege among intrusion like in the following 3 cases:</p>



<ol class="wp-block-list">
<li><a href="https://thedfirreport.com/2021/03/08/bazar-drops-the-anchor/">Bazar Drops the Anchor </a>&#8211; March 8, 2021</li>
<li><a href="https://thedfirreport.com/2021/01/31/bazar-no-ryuk/">Bazar No Ryuk </a>&#8211; January 31, 2021</li>
<li><a href="https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/">TrickBot still alive and well</a> &#8211; January 11, 2021</li>
</ol>



<p>All the above intrusions made use of the same profile that mimics a legitimate jquery request. The self-signed certificates for intrusions 2 and 3 also contained the same fake attributes trying to pose as regular jquery traffic.<br />Common Cobalt Strike config:</p>
<pre><code>| grab_beacon_config: 
| x86 URI Response: 
| BeaconType: <span class="hljs-number">0</span> (HTTP)
| Port: <span class="hljs-number">80</span>
| Polling: <span class="hljs-number">45000</span>
| Jitter: <span class="hljs-number">37</span>
| Maxdns: <span class="hljs-number">255</span>
| C2 Server: <span class="hljs-number">195.123</span><span class="hljs-number">.217</span><span class="hljs-number">.45</span>,/jquery-<span class="hljs-number">3.3</span><span class="hljs-number">.1</span>.min.js
| User Agent: Mozilla/<span class="hljs-number">5.0</span> (Windows NT <span class="hljs-number">6.3</span>; Trident/<span class="hljs-number">7.0</span>; rv:<span class="hljs-number">11.0</span>) like Gecko
| HTTP Method Path <span class="hljs-number">2</span>: /jquery-<span class="hljs-number">3.3</span><span class="hljs-number">.2</span>.min.js
| Header1: 
| Header2: 
| PipeName: 
| DNS Idle: J}\xC4q
| DNS Sleep: <span class="hljs-number">0</span>
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: <span class="hljs-number">2</span> (<span class="hljs-keyword">Use</span> <span class="hljs-title">IE</span> <span class="hljs-title">settings</span>)
| 
| 
| <span class="hljs-title">x64</span> <span class="hljs-title">URI</span> <span class="hljs-title">Response</span>: 
| <span class="hljs-title">BeaconType</span>: 0 (<span class="hljs-title">HTTP</span>)
| <span class="hljs-title">Port</span>: 80
| <span class="hljs-title">Polling</span>: 45000
| <span class="hljs-title">Jitter</span>: 37
| <span class="hljs-title">Maxdns</span>: 255
| <span class="hljs-title">C2</span> <span class="hljs-title">Server</span>: 195.123.217.45,/<span class="hljs-title">jquery</span>-3.3.1.<span class="hljs-title">min</span>.<span class="hljs-title">js</span>
| <span class="hljs-title">User</span> <span class="hljs-title">Agent</span>: <span class="hljs-title">Mozilla</span>/5.0 (<span class="hljs-title">Windows</span> <span class="hljs-title">NT</span> 6.3; Trident/<span class="hljs-number">7.0</span>; rv:<span class="hljs-number">11.0</span>) like Gecko
| HTTP Method Path <span class="hljs-number">2</span>: /jquery-<span class="hljs-number">3.3</span><span class="hljs-number">.2</span>.min.js
| Header1: 
| Header2: 
| PipeName: 
| DNS Idle: J}\xC4q
| DNS Sleep: <span class="hljs-number">0</span>
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: <span class="hljs-number">2</span> (<span class="hljs-keyword">Use</span> <span class="hljs-title">IE</span> <span class="hljs-title">settings</span>)
|<span class="hljs-title">_</span>
443/<span class="hljs-title">tcp</span> <span class="hljs-title">open</span>  <span class="hljs-title">https</span>
| <span class="hljs-title">grab_beacon_config</span>: 
| <span class="hljs-title">x86</span> <span class="hljs-title">URI</span> <span class="hljs-title">Response</span>: 
| <span class="hljs-title">BeaconType</span>: 8 (<span class="hljs-title">HTTPS</span>)
| <span class="hljs-title">Port</span>: 443
| <span class="hljs-title">Polling</span>: 45000
| <span class="hljs-title">Jitter</span>: 37
| <span class="hljs-title">Maxdns</span>: 255
| <span class="hljs-title">C2</span> <span class="hljs-title">Server</span>: <span class="hljs-title">gloomix</span>.<span class="hljs-title">com</span>,/<span class="hljs-title">jquery</span>-3.3.1.<span class="hljs-title">min</span>.<span class="hljs-title">js</span>
| <span class="hljs-title">User</span> <span class="hljs-title">Agent</span>: <span class="hljs-title">Mozilla</span>/5.0 (<span class="hljs-title">Windows</span> <span class="hljs-title">NT</span> 6.3; Trident/<span class="hljs-number">7.0</span>; rv:<span class="hljs-number">11.0</span>) like Gecko
| HTTP Method Path <span class="hljs-number">2</span>: /jquery-<span class="hljs-number">3.3</span><span class="hljs-number">.2</span>.min.js
| Header1: 
| Header2: 
| PipeName: 
| DNS Idle: J}\xC4q
| DNS Sleep: <span class="hljs-number">0</span>
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: <span class="hljs-number">2</span> (<span class="hljs-keyword">Use</span> <span class="hljs-title">IE</span> <span class="hljs-title">settings</span>)
| 
| 
| <span class="hljs-title">x64</span> <span class="hljs-title">URI</span> <span class="hljs-title">Response</span>: 
| <span class="hljs-title">BeaconType</span>: 8 (<span class="hljs-title">HTTPS</span>)
| <span class="hljs-title">Port</span>: 443
| <span class="hljs-title">Polling</span>: 45000
| <span class="hljs-title">Jitter</span>: 37
| <span class="hljs-title">Maxdns</span>: 255
| <span class="hljs-title">C2</span> <span class="hljs-title">Server</span>: <span class="hljs-title">gloomix</span>.<span class="hljs-title">com</span>,/<span class="hljs-title">jquery</span>-3.3.1.<span class="hljs-title">min</span>.<span class="hljs-title">js</span>
| <span class="hljs-title">User</span> <span class="hljs-title">Agent</span>: <span class="hljs-title">Mozilla</span>/5.0 (<span class="hljs-title">Windows</span> <span class="hljs-title">NT</span> 6.3; Trident/<span class="hljs-number">7.0</span>; rv:<span class="hljs-number">11.0</span>) like Gecko
| HTTP Method Path <span class="hljs-number">2</span>: /jquery-<span class="hljs-number">3.3</span><span class="hljs-number">.2</span>.min.js
| Header1: 
| Header2: 
| PipeName: 
| DNS Idle: J}\xC4q
| DNS Sleep: <span class="hljs-number">0</span>
| Method1: GET
| Method2: POST
| Spawnto_x86: %windir%\syswow64\dllhost.exe
| Spawnto_x64: %windir%\sysnative\dllhost.exe
| Proxy_AccessType: <span class="hljs-number">2</span> (<span class="hljs-keyword">Use</span> <span class="hljs-title">IE</span> <span class="hljs-title">settings</span>)
|<span class="hljs-title">_</span></code></pre>
<pre id="panelHeader_1611058417051" class="wcd-text-overflow-ellipsis wcd-margin-small-bottom wcd-font-weight-bold header-height ng-star-inserted">195.123.222.23<br />JARM: 07d14d16d21d21d07c42d41d00041d24a458a375eef0c576d23a7bab9a9fb1<br />JA3s: <span class="small spi-bucket mr-1 no-wrap" data-v-3ab1c176=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">ae4edc6faf64d08308082ad26be60767</span></a>,</span></span><span class="small spi-bucket mr-1 no-wrap" data-v-3ab1c176=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">649d6810e8392f63dc311eecb6b7098b</span></a></span></span><br />JA3: <span class="small spi-bucket mr-1 no-wrap" data-v-3ab1c176=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">72a589da586844d7f0818ce684948eea</span></a>,</span></span><span class="small spi-bucket mr-1 no-wrap" data-v-3ab1c176=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">51c64c77e60f3980eea90869b68c58a8</span></a>,</span></span><span class="small spi-bucket mr-1 no-wrap" data-v-3ab1c176=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">613e01474d42ebe48ef52dff6a20f079</span></a>,</span></span><span class="small spi-bucket mr-1 no-wrap" data-v-3ab1c176=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">7dd50e112cd23734a310b90f6f44a7cd</span></a></span> </span><br />Certificate: [<span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">79:97:9a:e4:cb:ae:ae:32:d6:4a:e5:0e:f6:73:d0:69:e9:19:c1:54</span></a> </span></span>]<br />Not Before: <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2020/12/21 04:27:54 </span></a></span></span><br />Not After: <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">2021/12/21 04:27:54 </span></a></span></span><br />Issuer Org: <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">jQuery</span></a> </span></span><br />Subject Common: <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">jquery.com</span></a> </span></span><br />Subject Org: <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">jQuery</span></a> </span></span><br />Public Algorithm: <span class="detail-field" data-v-6144aac9=""><span class="field cursor-pointer" data-v-6144aac9=""><a class="value" data-v-6144aac9=""><span class="all-copy" data-v-6144aac9="">rsaEncryption</span></a></span></span></pre>
<p>Examples of malleable C2 profiles can be found on <a href="https://github.com/rsmudge/Malleable-C2-Profiles" target="_blank" rel="noopener">the official GitHub repository</a> of Raphael Mudge. There are a number of GitHub repositories that allow for generation of randomized malleable profiles. These randomized profiles could be either based on completely random values or values based on an existing collection of existing malleable profiles. Two of the most notable repos are:</p>



<ul class="wp-block-list">
<li>Malleable-C2-Randomizer <a href="https://github.com/bluscreenofjeff/Malleable-C2-Randomizer">https://github.com/bluscreenofjeff/Malleable-C2-Randomizer</a></li>
<li>C2concealer &#8211; <a href="https://github.com/FortyNorthSecurity/C2concealer">https://github.com/FortyNorthSecurity/C2concealer</a></li>
</ul>



<p>A couple of very recent examples where threat actors used customized malleable profiles were in the Solarwinds attack as well as in latest campaigns from Nobelium as attributed by <a href="https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/">Microsoft</a>.</p>



<figure class="wp-block-image size-large"><img decoding="async" width="701" height="1024" class="wp-image-3531" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-1-701x1024.png" alt="" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-1-701x1024.png 701w, https://thedfirreport.com/wp-content/uploads/2021/07/image-1-205x300.png 205w, https://thedfirreport.com/wp-content/uploads/2021/07/image-1-768x1122.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-1-1051x1536.png 1051w, https://thedfirreport.com/wp-content/uploads/2021/07/image-1.png 1102w" sizes="(max-width: 701px) 100vw, 701px" /></figure>



<p>In the case of the Solarwinds attack, the threat actors used several customized Cobalt Strike beacons to execute the second-stage payload on their victims. According to Microsoft, <em>&#8220;</em><em>No two Beacon instances shared the same C2 domain name, Watermark, or other aforementioned configuration values. Other than certain internal fields, most Beacon configuration fields are customizable via a Malleable C2 profile.</em><em>&#8221; </em>&#8211; <a href="https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/">Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop</a>.</p>



<h2 class="wp-block-heading">Cobalt Strike in Action</h2>



<h3 class="wp-block-heading">Execution</h3>



<p>A lot of the Cobalt Strike post-exploitation tools are implemented as windows DLLs. This means that every time a threat actor runs these built-in tools, Cobalt Strike spawns a temporary process and uses rundll32.exe to inject the malicious code into it and communicates the results back to the beacon using named pipes. Defenders should pay close attention to command line events that rundll32 is executing without any arguments.<br />Example execution:</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-2.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3532 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-2.png" alt="" width="1987" height="116" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-2.png 1987w, https://thedfirreport.com/wp-content/uploads/2021/07/image-2-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-2-1024x60.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-2-768x45.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-2-1536x90.png 1536w" sizes="auto, (max-width: 1987px) 100vw, 1987px" /></a></figure>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-3.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3533 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-3.png" alt="" width="439" height="459" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-3.png 439w, https://thedfirreport.com/wp-content/uploads/2021/07/image-3-287x300.png 287w" sizes="auto, (max-width: 439px) 100vw, 439px" /></a></figure>



<p>Named pipes are used to send the output of the post-exploitation tools to the beacon. Cobalt Strike is using default unique pipe names, which defenders can use for detection. However, Cobalt Strike allows the operators to change the name of the pipes to any name of their choosing by configuring the malleable C2 profile accordingly. Even though this is very easy to create, it is an inconvenience for the average attacker, and we do not see it being done often. For more information Cobalt Strike has an extensive documentation on named pipes <a href="https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/" target="_blank" rel="noopener">here</a>.<br />The default Cobalt Strike pipes are (the &#8220;*&#8221; symbolize the prefix/suffix):</p>



<ul class="wp-block-list">
<li>\postex_*</li>
<li>\postex_ssh_*</li>
<li>\status_*</li>
<li>\msagent_*</li>
<li>\MSSE-*</li>
<li>\*-server</li>
</ul>



<p>Sysmon event 17 and 18 are able to log named pipes. Note that Sysmon should be explicitly configured to log named pipes. F-Secure Labs created a great write up for detecting Cobalt Strike through named pipes: <a href="https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/" target="_blank" rel="noopener">Detecting Cobalt Strike Default Modules via Named Pipe Analysis</a>.</p>
<p>Additionally, we commonly see three methods regularly used by threat actors to download and execute the Cobalt Strike beacon.</p>



<ol class="wp-block-list">
<li><strong>Using PowerShell to load and inject shellcode directly into memory</strong></li>
</ol>



<p>Encrypted PowerShell command with embedded Cobalt Strike SMB beacons from the report: <a href="https://thedfirreport.com/2021/06/20/from-word-to-lateral-movement-in-1-hour/" target="_blank" rel="noopener">From word to lateral movement in 1 hour</a>.</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-4.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3534 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-4.png" alt="" width="1631" height="574" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-4.png 1631w, https://thedfirreport.com/wp-content/uploads/2021/07/image-4-300x106.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-4-1024x360.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-4-768x270.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-4-1536x541.png 1536w" sizes="auto, (max-width: 1631px) 100vw, 1631px" /></a></figure>



<p>The PowerShell is base64 encoded. Decoding the PowerShell command, we are presented with the shellcode that will be pushed into memory.</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-5.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3535 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-5.png" alt="" width="1032" height="314" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-5.png 1032w, https://thedfirreport.com/wp-content/uploads/2021/07/image-5-300x91.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-5-1024x312.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-5-768x234.png 768w" sizes="auto, (max-width: 1032px) 100vw, 1032px" /></a></figure>



<p>For a detailed analysis of this PowerShell stager, you can checkout the helpful blog post from @Paulsec4 <a href="https://newtonpaul.com/analysing-fileless-malware-cobalt-strike-beacon/#Injecting_into_memory_with_PowerShell" target="_blank" rel="noopener">here</a>.</p>



<ol class="wp-block-list" start="2">
<li><strong>Download to disk and execute manually on the target</strong></li>
</ol>



<p>In the example below, you can see the TrickBot process downloading to disk, and then loading the beacon into memory.</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-6.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3536 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-6.png" alt="" width="1630" height="287" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-6.png 1630w, https://thedfirreport.com/wp-content/uploads/2021/07/image-6-300x53.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-6-1024x180.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-6-768x135.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-6-1536x270.png 1536w" sizes="auto, (max-width: 1630px) 100vw, 1630px" /></a></figure>



<p>The event IDs in this case for Sysmon logs are:</p>
<ul>
<li>11 &#8211; File Creation</li>
<li>7 &#8211; Image Loaded</li>
<li>1 &#8211; Process Creation</li>
<li>3 &#8211; Network Connection</li>
</ul>
<p>And for windows Security logs:</p>
<ul>
<li>4663 &#8211; File Creation</li>
<li>4688 &#8211; Process Creation <em>(Command Line logging should be explicitly configured as it is not on by default</em>)</li>
<li>5156 &#8211; Network Connection</li>
</ul>
<p>A recent example of this activity can be found in one of our latest reports <a href="https://thedfirreport.com/2021/06/28/hancitor-continues-to-push-cobalt-strike/" target="_blank" rel="noopener">Hancitor Continues to Push Cobalt Strike </a>, where the malicious Hancitor injected process(svchost.exe) downloaded the Cobalt Strike DLL beacon to disk and then proceeded with allocating a new memory region inside the current rundll32.exe process and loaded it into the memory.</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-8.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3538 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-8.png" alt="" width="1382" height="215" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-8.png 1382w, https://thedfirreport.com/wp-content/uploads/2021/07/image-8-300x47.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-8-1024x159.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-8-768x119.png 768w" sizes="auto, (max-width: 1382px) 100vw, 1382px" /></a></figure>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-9.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3539 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-9.png" alt="" width="1172" height="67" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-9.png 1172w, https://thedfirreport.com/wp-content/uploads/2021/07/image-9-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-9-1024x59.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-9-768x44.png 768w" sizes="auto, (max-width: 1172px) 100vw, 1172px" /></a></figure>



<ol class="wp-block-list" start="3">
<li><strong>Executing the beacon in memory via the initial malware infection</strong></li>
</ol>



<p>This case is a little bit more difficult to capture, thankfully, we have plenty of examples from our reporting to demonstrate the execution flow. Below is an example from the case <a href="https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/" target="_blank" rel="noopener">Sodinokibi (aka REvil) Ransomware</a>.<br />IcedID reached out to two Cobalt Strike servers to download and execute the beacons in memory:</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-7.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3537 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-7.png" alt="" width="1150" height="664" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-7.png 1150w, https://thedfirreport.com/wp-content/uploads/2021/07/image-7-300x173.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-7-1024x591.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-7-768x443.png 768w" sizes="auto, (max-width: 1150px) 100vw, 1150px" /></a></figure>



<h3 class="wp-block-heading"> </h3>
<h3>Defense Evasion</h3>



<p>In every intrusion, we see <a href="https://thedfirreport.com/?s=process+injection" target="_blank" rel="noopener">process injection</a> taking place across the environment. It is mainly used to inject malicious code into a remote process and inject it into lsass.exe to extract credentials from memory. By injecting the malicious payload into a remote process, the threat actors are spawning a new session in the user context that the injected process belongs to. There are many ways in which process injection can be used. You can check out a helpful post by <a href="https://boschko.ca/cobalt-strike-process-injection/" target="_blank" rel="noopener">Boschko</a> that goes through all the various methods that Cobalt Strike uses. <br />Detect the Cobalt Strike default process injection with Sysmon by looking for the below EIDs in consecutive order:</p>



<ul class="wp-block-list">
<li>10 &#8211; Process accessed</li>
<li>8 &#8211; CreateRemoteThread detected</li>
<li>3/22 &#8211; Network query/DNS query</li>
</ul>



<p>Example process injection on remote process (RuntimeBroker.exe):</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-10.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3540 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-10.png" alt="" width="1675" height="152" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-10.png 1675w, https://thedfirreport.com/wp-content/uploads/2021/07/image-10-300x27.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-10-1024x93.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-10-768x70.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-10-1536x139.png 1536w" sizes="auto, (max-width: 1675px) 100vw, 1675px" /></a></figure>



<p>There are other ways to detect this activity. In other methods of process injection, such as process hollowing, EID 8 will not be present.  Unfortunately, it is very difficult to detect this process injection activity via security windows logs without Sysmon to monitor for the event IDs above.</p>



<p>An example from the Sodinokibi report, multiple process injections across the environment using Cobalt Strike Beacons (Sysmon EID 8):</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-11.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3541 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-11.png" alt="" width="544" height="259" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-11.png 544w, https://thedfirreport.com/wp-content/uploads/2021/07/image-11-300x143.png 300w" sizes="auto, (max-width: 544px) 100vw, 544px" /></a></figure>



<h3 class="wp-block-heading">Discovery</h3>



<p>In every Cobalt Strike occasion that we report, we see threat actors executing reconnaissance commands with the help of the &#8220;shell&#8221; command. The commands are based on native windows utilities such as nltest.exe, whoami.exe, and net.exe to help with discovery. Red Canary has a detailed article which goes through the reasons that adversaries use native windows tools for domain trust discovery, that article can be found <a href="https://redcanary.com/threat-detection-report/techniques/domain-trust-discovery/" target="_blank" rel="noopener">here</a>. Below are some recent examples from the Conti infection; however, these commands remain consistent with other intrusions we track.<br />Conti operators executing reconnaissance commands through Cobalt Strike:</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-12.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3542 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-12.png" alt="" width="618" height="323" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-12.png 618w, https://thedfirreport.com/wp-content/uploads/2021/07/image-12-300x157.png 300w" sizes="auto, (max-width: 618px) 100vw, 618px" /></a></figure>



<p>The most used tools for discovery purposes that threat actors are dropping with the help of Cobalt Strike are AdFind and BloodHound. <a href="https://thedfirreport.com/category/adfind/" target="_blank" rel="noopener">Adfind</a> is by far the most used among those two. It is also worth mentioning that PowerShell is also used for enumerating the network looking for interesting targets. When it comes to PowerShell, unmodified <a href="https://thedfirreport.com/?s=powersploit">PowerSploit</a> and <a href="https://thedfirreport.com/?s=powerview">PowerView</a> modules are a very common method threat actors are using to collect information.</p>



<h3 class="wp-block-heading">Privilege Escalation</h3>



<p>The most common technique that threat actors use to obtain SYSTEM level privileges is the <a href="https://thedfirreport.com/?s=getsystem">GetSystem</a> method via named-pipe impersonation. Example execution on a target system as observed in the <a href="https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/">TrickBot Still Alive and Well </a> report:</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-13.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3543 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-13.png" alt="" width="1379" height="389" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-13.png 1379w, https://thedfirreport.com/wp-content/uploads/2021/07/image-13-300x85.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-13-1024x289.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-13-768x217.png 768w" sizes="auto, (max-width: 1379px) 100vw, 1379px" /></a></figure>



<p>&nbsp;</p>
<p>There are also other methods for elevating privileges with Cobalt Strike, such as using the &#8220;<strong><em>elevate</em></strong>&#8221; command. The elevate command uses two options to escalate privileges. The first one is the <strong>svc-exe</strong>. It attempts to drop an executable under &#8220;c:\windows&#8221; and creates a service to run the payload as SYSTEM. The second one is the <strong>uac-token-duplication </strong>method, which attempts to spawn a new elevated process under the context of a non-privileged user with a stolen token of an existed elevated process. However, as mentioned above, the most used method is the name pipe impersonation escalation via &#8220;<strong><em>getsystem</em></strong>&#8221; command. A detailed explanation can be found at the bottom of <a href="https://www.cobaltstrike.com/help-beacon" target="_blank" rel="noopener">this</a> Cobalt Strike official documentation page.</p>
<p>As you can see below, Sysmon generates a lot more logs related to the successful privilege escalation using the &#8220;<em>elevate svc-exe</em>&#8221; option. In this case, spoolsv.exe is the executable that was dropped by Cobalt Strike to run a payload.<br />Sysmon Event IDs:</p>



<ul class="wp-block-list">
<li>11 &#8211; File Created</li>
</ul>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-14.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3544 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-14.png" alt="" width="1410" height="131" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-14.png 1410w, https://thedfirreport.com/wp-content/uploads/2021/07/image-14-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-14-1024x95.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-14-768x71.png 768w" sizes="auto, (max-width: 1410px) 100vw, 1410px" /></a></figure>



<ul class="wp-block-list">
<li>1 &#8211; Process Create</li>
</ul>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-15.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3545 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-15.png" alt="" width="1906" height="136" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-15.png 1906w, https://thedfirreport.com/wp-content/uploads/2021/07/image-15-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-15-1024x73.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-15-768x55.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-15-1536x110.png 1536w" sizes="auto, (max-width: 1906px) 100vw, 1906px" /></a></figure>



<ul class="wp-block-list">
<li>25 &#8211; Process tampering</li>
</ul>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-16.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3546 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-16.png" alt="" width="1509" height="105" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-16.png 1509w, https://thedfirreport.com/wp-content/uploads/2021/07/image-16-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-16-1024x71.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-16-768x53.png 768w" sizes="auto, (max-width: 1509px) 100vw, 1509px" /></a></figure>



<ul class="wp-block-list">
<li>12 &amp; 13 &#8211; Registry value set</li>
</ul>



<p>Windows Event IDs:</p>



<ul class="wp-block-list">
<li>Service installation: 4697(Security) and 7045(System)</li>
</ul>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-17.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3547 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-17.png" alt="" width="408" height="297" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-17.png 408w, https://thedfirreport.com/wp-content/uploads/2021/07/image-17-300x218.png 300w" sizes="auto, (max-width: 408px) 100vw, 408px" /></a></figure>



<ul class="wp-block-list">
<li> </li>
<li>Process Creation: 4688</li>
</ul>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-18.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3548 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-18.png" alt="" width="2186" height="78" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-18.png 2186w, https://thedfirreport.com/wp-content/uploads/2021/07/image-18-300x11.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-18-1024x37.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-18-768x27.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-18-1536x55.png 1536w, https://thedfirreport.com/wp-content/uploads/2021/07/image-18-2048x73.png 2048w" sizes="auto, (max-width: 2186px) 100vw, 2186px" /></a></figure>



<h3 class="wp-block-heading"> </h3>
<h3>Credential Access</h3>



<p>After getting access to the target using Cobalt Strike, one of the first tasks that operators take is to collect credentials and hashes from LSASS. There are a couple of ways to achieve this with Cobalt Strike. The first one uses the &#8220;<strong>hashdump</strong>&#8221; command to dump password hashes; the second one uses the command &#8220;<strong>logonpasswords</strong>&#8221; to dump plaintext credentials and NTLM hashes with Mimikatz.</p>
<p>Here&#8217;s an example of accessing LSASS to steal credentials from memory using &#8220;<strong>hashdump</strong>&#8221; command in Cobalt Strike:</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-19.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3549 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-19.png" alt="" width="2199" height="320" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-19.png 2199w, https://thedfirreport.com/wp-content/uploads/2021/07/image-19-300x44.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-19-1024x149.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-19-768x112.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-19-1536x224.png 1536w, https://thedfirreport.com/wp-content/uploads/2021/07/image-19-2048x298.png 2048w" sizes="auto, (max-width: 2199px) 100vw, 2199px" /></a></figure>



<p>Sysmon EIDs 1,8,10,17:<em>(Event ID 8 will not always be present depending on the technique used.)</em></p>
<p>As you can see below, the only Event IDs that we manage to capture using this technique are process creation and process termination events.</p>



<ul class="wp-block-list">
<li>4688 &#8211; Process Creation (Rundll32.exe is loading the DLL payload upon execution)</li>
<li>4689 &#8211; Process Termination</li>
</ul>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-20.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3550 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-20.png" alt="" width="2097" height="113" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-20.png 2097w, https://thedfirreport.com/wp-content/uploads/2021/07/image-20-300x16.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-20-1024x55.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-20-768x41.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-20-1536x83.png 1536w, https://thedfirreport.com/wp-content/uploads/2021/07/image-20-2048x110.png 2048w" sizes="auto, (max-width: 2097px) 100vw, 2097px" /></a></figure>



<p>We have also seen <a href="https://github.com/AlessandroZ/LaZagne" target="_blank" rel="noopener">Lazagne</a> being used on two <a href="https://thedfirreport.com/?s=lazagne" target="_blank" rel="noopener">occasions</a> to extract credentials from various applications on the target system.</p>
<div>
<div>Cobalt Strike has implemented the DCSync functionality as introduced by <a href="https://github.com/gentilkiwi/mimikatz" target="_blank" rel="noopener" rev="en_rl_none">mimikatz</a>. DCSync uses windows APIs for Active Directory replication to retrieve the NTLM hash for a specific user or all users. To achieve this, the threat actors must have access to a privileged account with domain replication rights (usually a Domain Administrator). By running the <a href="https://www.blacklanternsecurity.com/2020-12-04-DCSync" target="_blank" rel="noopener">DCSync</a> command, threat actors attempt to masquerade as a domain controller to sync with another domain controller to collect credentials.</div>
</div>
<h3> </h3>
<h3>Command and Control</h3>



<p>Cobalt Strike is using GET and POST requests to communicate with the C2 server. The threat actors can choose between HTTP, HTTPS and DNS network communication. When it comes to C2, we typically see HTTP and HTTPS beacons. By default, Cobalt Strike will use GET requests to retrieve information and POST requests to send information back to the server. As explained above, all the default configurations can change with the use of malleable profiles. Even though we don&#8217;t see this very often, the beacon could also be configured to send back information with GET requests in small chunks. If you want a deep dive into detecting Cobalt Strike CnC, this <a href="https://underdefense.com/how-to-detect-cobaltstrike-command-control-communication/">article</a> from UnderDefense is a great resource.<br />The metadata is encrypted with a public key that is injected into the beacon.<br />&#8220;<em>Example of a get request from our latest ransomware report on </em><a href="https://thedfirreport.com/2021/05/12/conti-ransomware/">Conti</a>&#8220;</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-21.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3551 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-21.png" alt="" width="1487" height="139" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-21.png 1487w, https://thedfirreport.com/wp-content/uploads/2021/07/image-21-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-21-1024x96.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-21-768x72.png 768w" sizes="auto, (max-width: 1487px) 100vw, 1487px" /></a></figure>



<p><em>&#8220;Results of executed commands are sent to the server using POST requests.&#8221;</em></p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-22.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3552 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-22.png" alt="" width="1513" height="212" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-22.png 1513w, https://thedfirreport.com/wp-content/uploads/2021/07/image-22-300x42.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-22-1024x143.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-22-768x108.png 768w" sizes="auto, (max-width: 1513px) 100vw, 1513px" /></a></figure>



<h2 class="wp-block-heading">Lateral Movement</h2>



<p>Once Cobalt Strike beacons are established, usually minutes later, we see operators moving laterally on servers of interest inside the network. Even though they are generally fast at picking their targets, we infer that their decisions are based on the results from the discovery phase. According to our reporting, the most frequent techniques that attackers use for pivoting are:</p>



<ul class="wp-block-list">
<li><strong>SMB/WMI executable transfer and exec</strong></li>
<li><strong>Pass the Hash</strong></li>
<li><strong>RDP</strong></li>
<li><strong>Remote service execution</strong></li>
</ul>



<p>Cobalt Strike can facilitate all the above techniques and even RDP using SOCKS proxy.</p>



<ul class="wp-block-list">
<li><strong>SMB/WMI executable transfer and exec</strong></li>
</ul>



<p>According to our telemetry, this method is used the most by threat actors. We see them uploading their executable to their desired host with the &#8220;<em>upload</em>&#8221; Cobalt Strike command and execute it using the &#8220;<em>remote-exec</em>&#8221; command as documented in the capabilities section above but it can use psexec, winrm or wmi to execute a command and/or a beacon.</p>
<p>This is what we see when the beacon is uploaded using the upload command.</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3960" src="https://thedfirreport.com/wp-content/uploads/2021/08/6.png" alt="" width="1374" height="771" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/6.png 1374w, https://thedfirreport.com/wp-content/uploads/2021/08/6-300x168.png 300w, https://thedfirreport.com/wp-content/uploads/2021/08/6-1024x575.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/08/6-768x431.png 768w" sizes="auto, (max-width: 1374px) 100vw, 1374px" /></p>



<p>The following EIDs are created when executing remote-exec:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3986" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-12.png" alt="" width="544" height="139" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/1-12.png 544w, https://thedfirreport.com/wp-content/uploads/2021/08/1-12-300x77.png 300w" sizes="auto, (max-width: 544px) 100vw, 544px" /></p>
<p>4697: A service was installed in the system</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3987" src="https://thedfirreport.com/wp-content/uploads/2021/08/2-1.png" alt="" width="490" height="396" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/2-1.png 490w, https://thedfirreport.com/wp-content/uploads/2021/08/2-1-300x242.png 300w" sizes="auto, (max-width: 490px) 100vw, 490px" /></p>
<div>4624: Account logged on</div>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3988" src="https://thedfirreport.com/wp-content/uploads/2021/08/3-2.png" alt="" width="469" height="595" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/3-2.png 469w, https://thedfirreport.com/wp-content/uploads/2021/08/3-2-236x300.png 236w" sizes="auto, (max-width: 469px) 100vw, 469px" /></p>
<ul class="wp-block-list">
<li><strong>Pass the Hash</strong></li>
</ul>



<p>Cobalt Strike can use Mimikatz to generate and impersonate a token that can later be used to accomplish tasks in the context of that chosen user resource. The Cobalt Strike beacon can also use this token to interact with network resources and run remote commands.</p>
<p>As you can see from the below execution example, executing Pass The Hash via Cobalt Strike will run cmd.exe to pass the token back to the beacon process via a named pipe :</p>
<pre>C:\Windows\system32\cmd.exe /c echo 0291f1e69dd &gt; \\.\pipe\82afc1</pre>
<p>We also see that the beacon interacts with LSASS (Sysmon EID 10). There are many detection opportunities that defenders can take advantage of with the proper endpoint visibility.</p>



<figure class="wp-block-image size-large"><a href="https://thedfirreport.com/wp-content/uploads/2021/07/image-24.png"><img loading="lazy" decoding="async" class="alignnone wp-image-3554 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/07/image-24.png" alt="" width="2522" height="162" srcset="https://thedfirreport.com/wp-content/uploads/2021/07/image-24.png 2522w, https://thedfirreport.com/wp-content/uploads/2021/07/image-24-300x19.png 300w, https://thedfirreport.com/wp-content/uploads/2021/07/image-24-1024x66.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/07/image-24-768x49.png 768w, https://thedfirreport.com/wp-content/uploads/2021/07/image-24-1536x99.png 1536w, https://thedfirreport.com/wp-content/uploads/2021/07/image-24-2048x132.png 2048w" sizes="auto, (max-width: 2522px) 100vw, 2522px" /></a></figure>



<p>Pass the hash can also be detected by looking for:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3984" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-11.png" alt="" width="791" height="708" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/1-11.png 791w, https://thedfirreport.com/wp-content/uploads/2021/08/1-11-300x269.png 300w, https://thedfirreport.com/wp-content/uploads/2021/08/1-11-768x687.png 768w" sizes="auto, (max-width: 791px) 100vw, 791px" /></p>
<pre>Windows EID 4624<br />Logon Type = 9<br />Authentication Package = Negotiate<br />Logon Process = seclogo</pre>
<p>You can read more about detecting Pass The Hash <a href="https://stealthbits.com/blog/how-to-detect-pass-the-hash-attacks/" target="_blank" rel="noopener">here</a> by Stealthbits and <a href="https://hausec.com/2021/07/26/cobalt-strike-and-tradecraft/" target="_blank" rel="noopener">here</a> by Hausec.</p>
<ul class="wp-block-list">
<li>
<p><strong>SMB remote service execution</strong></p>
</li>
</ul>
<div>In the below example, the threat actors executed the &#8220;jump psexec&#8221; command to create a remote service on the remote machine (DC) and execute the service exe beacon. Cobalt Strike specifies an executable to create the remote service. Before it can do that, it will have to transfer the service executable to the target host.  The name of the service executable is created with seven random alphanumeric -characters, e.g. &#8220;&lt;7-alphanumeric-characters&gt;.exe&#8221;. This was changed after version 4.1 of Cobalt Strike (<a href="https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/" rev="en_rl_none">Getting the Bacon from the Beacon</a>).</div>
<div> </div>
<div>The attacker must have administrative privileges to complete this task.</div>
<div><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3955" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-5.png" alt="" width="1107" height="1071" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/1-5.png 1107w, https://thedfirreport.com/wp-content/uploads/2021/08/1-5-300x290.png 300w, https://thedfirreport.com/wp-content/uploads/2021/08/1-5-1024x991.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/08/1-5-768x743.png 768w" sizes="auto, (max-width: 1107px) 100vw, 1107px" /></div>
<div>In the screenshots below you can see the Windows Event IDs that are being generated as a result of this execution. The first screenshot was from the security logs. However, defenders should pay close attention to service creation events as they will be created and deleted</div>
<div><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3956" src="https://thedfirreport.com/wp-content/uploads/2021/08/2.png" alt="" width="1537" height="583" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/2.png 1537w, https://thedfirreport.com/wp-content/uploads/2021/08/2-300x114.png 300w, https://thedfirreport.com/wp-content/uploads/2021/08/2-1024x388.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/08/2-768x291.png 768w" sizes="auto, (max-width: 1537px) 100vw, 1537px" /></div>
<div> </div>
<div><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3957" src="https://thedfirreport.com/wp-content/uploads/2021/08/3.png" alt="" width="729" height="344" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/3.png 729w, https://thedfirreport.com/wp-content/uploads/2021/08/3-300x142.png 300w" sizes="auto, (max-width: 729px) 100vw, 729px" /></div>
<div> </div>
<div><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3958" src="https://thedfirreport.com/wp-content/uploads/2021/08/4-2.png" alt="" width="518" height="210" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/4-2.png 518w, https://thedfirreport.com/wp-content/uploads/2021/08/4-2-300x122.png 300w" sizes="auto, (max-width: 518px) 100vw, 518px" /></div>
<div> </div>
<div><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3959" src="https://thedfirreport.com/wp-content/uploads/2021/08/5.png" alt="" width="498" height="156" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/5.png 498w, https://thedfirreport.com/wp-content/uploads/2021/08/5-300x94.png 300w" sizes="auto, (max-width: 498px) 100vw, 498px" /></div>
<div>
<pre>4624: Logon<br />4672: Special Logon<br />4673: Sensitive Privilege Use<br />4688: Process Creation<br />5140: File Share<br />4674: Sensitive Privilege Use<br /><br />Service Creation events<br />4697: A service was installed in the system. (security.evtx)<br />7045: A service was installed in the system. (system.evtx)<br />7034: A service terminated unexpectedly</pre>
</div>
<h2>Aggressor Scripts</h2>
<div>Even though Cobalt Strike has many features out of the box, it is also highly extensible thanks to the <a href="https://www.cobaltstrike.com/aggressor-script/index.html" target="_blank" rel="noopener">aggressor scripts</a>. Aggressor scripts allows the operators to script and modify many of Cobalt Strike&#8217;s features. Operators can quickly load various scripts via the GUI console.</div>
<div> </div>
<div>In most of the cases we are working on, we observe the execution of discovery commands after the first beacon check-in with its C2 server. These events are very likely to be automated by the threat actors. We have taken the below example as presented in the official Cobalt Strike documentation page to demonstrate this use case.</div>
<div>
<pre>on beacon_initial {<br />$user = beacon_data($1) ["user"];<br />bshell = ($1, "net group \"Domain Admins\" /domain")<br />        bshell = ($1, "nltest /domain_trusts /all_trusts")<br />        bshell = ($1, "net localgroup \"Administrators\"")<br />        bshell = ($1, "nltest /dclist")<br />}<br />(NOTE: The "$1" argument is the id for the beacon.)</pre>
</div>
<div>The above script uses the function &#8220;on beacon_initial&#8221; to run the specified discovery commands upon initial execution of the beacon. Cobalt Strike has comprehensive documentation on all available <a href="https://www.cobaltstrike.com/aggressor-script/functions.html#" target="_blank" rel="noopener">functions</a>. Another interesting function is the &#8220;alias&#8221; function. It creates an alias command in the Beacon console, which can override the default Cobalt Strike commands.</div>
<div> </div>
<div>Searching for &#8220;Cobalt Strike aggressor scripts&#8221; on google will result in multiple GitHub repositories. These repositories contain a collection of aggressor scripts to share with the open-source community. Threat actors are also utilizing these freely available resources for accomplishing their objectives. Some of the most popular are:</div>
<div> </div>
<ul>
<li><a href="https://github.com/harleyQu1nn/AggressorScripts">https://github.com/harleyQu1nn/AggressorScripts</a></li>
<li><a href="https://github.com/timwhitez/Cobalt-Strike-Aggressor-Scripts">https://github.com/timwhitez/Cobalt-Strike-Aggressor-Scripts</a></li>
<li><a href="https://github.com/Und3rf10w/Aggressor-scripts">https://github.com/Und3rf10w/Aggressor-scripts</a></li>
</ul>
<div>The recent <a href="https://twitter.com/TheDFIRReport/status/1423361119926816776" target="_blank" rel="noopener">Conti leak</a> was a great insight into their tooling, which included the use of aggressor scripts. One of the most notable scripts Conti is using is the <a href="https://github.com/rsmudge/ZeroLogon-BOF/blob/master/dist/zerologon.cna" target="_blank" rel="noopener">ZeroLogon BOF script</a> created by Raphael Mudge. The script compiles and runs the ZeroLogon exploit in memory.</div>
<div> </div>
<div>Another file that we noticed was a collection of multiple aggressor scripts into one. This file was named &#8220;enhancement_chain.cna&#8221; which included some of the most used aggressor scripts available on GitHub, like the <a href="https://github.com/harleyQu1nn/AggressorScripts/blob/master/AVQuery.cna" target="_blank" rel="noopener">AV_query</a> script by <a href="https://twitter.com/r3dQu1nn" target="_blank" rel="noopener">@r3dQu1nn</a>.</div>
<div><img loading="lazy" decoding="async" class="alignnone size-full wp-image-3961" src="https://thedfirreport.com/wp-content/uploads/2021/08/1-6.png" alt="" width="1240" height="662" srcset="https://thedfirreport.com/wp-content/uploads/2021/08/1-6.png 1240w, https://thedfirreport.com/wp-content/uploads/2021/08/1-6-300x160.png 300w, https://thedfirreport.com/wp-content/uploads/2021/08/1-6-1024x547.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/08/1-6-768x410.png 768w" sizes="auto, (max-width: 1240px) 100vw, 1240px" /></div>
<div> </div>
<div>You can find the file <a href="https://github.com/tsale/TA_tooling/blob/main/Conti_enhancement_chain.cna" target="_blank" rel="noopener">here</a>.</div>
<div><span style="color: #222222; font-family: Lato, serif; font-size: 36px;">Awesome Cobalt Strike Defense</span></div>
<div>
<div class="flex-1 d-flex flex-items-center ml-3 min-width-0">
<div class="css-truncate css-truncate-overflow color-text-secondary">To combat Cobalt Strike, the InfoSec community has come together to release tooling, research and detection rules. There are too many to add here, but we don&#8217;t have to, thanks to the <a href="https://github.com/MichaelKoczwara/Awesome-CobaltStrike-Defence" target="_blank" rel="noopener">Awesome-CobaltStrike-Defence</a> GitHub repository. It contains multiple sources that help defenders hunt, detect and prevent Cobalt Strike. The repository is maintained by <a href="https://twitter.com/MichalKoczwara" target="_blank" rel="noopener">MichaelKoczwara</a>, <a href="https://twitter.com/wlesicki" target="_blank" rel="noopener">WojciechLesicki</a> and <a href="https://twitter.com/bh4b3sh" target="_blank" rel="noopener">d4rk-d4nph3</a>.</div>
<div> </div>
</div>
</div>
<h2> </h2>
<h2>Part 2 of our Cobalt Strike guide</h2>
<p class="entry-title"><a href="https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/" target="_blank" rel="noopener">Cobalt Strike, a Defender’s Guide – Part 2</a></p>
<p>&nbsp;</p>
<h2>Useful Open Source Information</h2>
<p><a href="https://www.mandiant.com/resources/defining-cobalt-strike-components" target="_blank" rel="noopener">Defining Cobalt Strike Components So You Can BEA-CONfident in Your Analysis</a></p>
<h2>

</h2>
<p><a href="https://github.com/JPCERTCC/aa-tools/blob/master/cobaltstrikescan.py" target="_blank" rel="noopener">Volatility plugin for detecting Cobalt Strike Beacon and extracting its config</a></p>
<p><a href="https://blog.didierstevens.com/2020/11/07/1768-k/" target="_blank" rel="noopener">Didier Stevens &#8211; Python script to decode and dump the config of Cobalt Strike beacon</a></p>
<h2>

</h2>
<p><a href="https://redcanary.com/threat-detection-report/threats/cobalt-strike/" target="_blank" rel="noopener">Detection opportunities by Tony Lambert and Red Canary</a></p>
<h2 class="wp-block-heading">Sigma Rules</h2>



<p><a href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/process_creation/win_meterpreter_or_cobaltstrike_getsystem_service_start.yml" target="_blank" rel="noopener">Meterpreter or Cobalt Strike Getsystem Service Installation</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/sysmon_mal_cobaltstrike.yml" target="_blank" rel="noopener">CobaltStrike Named Pipe</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/process_creation/win_meterpreter_or_cobaltstrike_getsystem_service_start.yml" target="_blank" rel="noopener">Meterpreter or Cobalt Strike Getsystem Service Start</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_adfind.yml" target="_blank" rel="noopener">Suspicious AdFind Execution</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_powershell_enc_cmd.yml" target="_blank" rel="noopener">Suspicious Encoded PowerShell Command Line</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_rundll32_net_connections.yml" target="_blank" rel="noopener">Rundll32 Internet Connection</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/network/net_dns_c2_detection.yml" target="_blank" rel="noopener">Possible DNS Tunneling</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/builtin/win_overpass_the_hash.yml" target="_blank" rel="noopener">Successful Overpass the Hash Attempt</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/win_cobaltstrike_service_installs.yml" target="_blank" rel="noopener">Service Installs</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/sysmon_cobaltstrike_process_injection.yml" target="_blank" rel="noopener">Process Injection</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/process_creation_cobaltstrike_load_by_rundll32.yml" target="_blank" rel="noopener">Process Creation Cobalt Strike load by rundll32</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry_event/sysmon_cobaltstrike_service_installs.yml" target="_blank" rel="noopener">Sysmon Cobalt Strike Service Installs</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_susp_wmic_proc_create_rundll32.yml" target="_blank" rel="noopener">Suspicious WMI Execution Using Rundll32</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/sysmon_rundll32_net_connections.yml" target="_blank" rel="noopener">Rundll32 Internet Connection</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/e7d9f1b4279a235406b61cc9c16fde9d7ab5e3ba/rules/windows/create_remote_thread/sysmon_suspicious_remote_thread.yml" target="_blank" rel="noopener">Suspicious Remote Thread Created</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/7f071d785157dfe185d845fad994aa6ec05ac678/rules/windows/network_connection/sysmon_powershell_network_connection.yml" target="_blank" rel="noopener">PowerShell Network Connections</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_susp_powershell_hidden_b64_cmd.yml" target="_blank" rel="noopener">Malicious Base64 Encoded PowerShell Keywords in Command Lines</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/network/net_susp_dns_b64_queries.yml" target="_blank" rel="noopener">Suspicious DNS Query with B64 Encoded String</a></p>
<p><a class="ql-link" href="https://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/network/zeek/zeek_default_cobalt_strike_certificate.yml" target="_blank" rel="noopener noreferrer">Default Cobalt Strike Certificate</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/eb382c4a59b6d87e186ee269805fe2db2acf250e/rules/network/net_high_txt_records_requests_rate.yml" target="_blank" rel="noopener">High TXT Records Requests Rate</a></p>
<p><a class="ql-link" href="https://github.com/SigmaHQ/sigma/blob/master/rules/network/net_mal_dns_cobaltstrike.yml" target="_blank" rel="noopener noreferrer">Cobalt Strike DNS Beaconing</a></p>
<p><a class="ql-link" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_amazon.yml" target="_blank" rel="noopener noreferrer" data-void-detect="true">CobaltStrike Malleable Amazon Browsing Traffic Profile</a></p>
<p><a class="ql-link" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_malformed_uas.yml" target="_blank" rel="noopener noreferrer">CobaltStrike Malformed UAs in Malleable Profiles</a></p>
<p><a class="ql-link" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_ocsp.yml" target="_blank" rel="noopener noreferrer">CobaltStrike Malleable (OCSP) Profile</a></p>
<p><a class="ql-link" href="https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_cobalt_onedrive.yml" target="_blank" rel="noopener noreferrer">CobaltStrike Malleable OneDrive Browsing Traffic Profile</a></p>



<h2 class="wp-block-heading">Suricata</h2>



<p>ET INFO Suspicious Empty SSL Certificate &#8211; Observed in Cobalt Strike<br />ET MALWARE Cobalt Strike Beacon Activity (GET)<br />ET MALWARE Cobalt Strike Malleable C2 Profile wordpress_ Cookie Test<br />ETPRO TROJAN Cobalt Strike Beacon Observed<br />ETPRO TROJAN Cobalt Strike CnC Beacon<br />ETPRO TROJAN Cobalt Strike Covert DNS CnC Channel TXT Lookup (tcp)<br />ETPRO TROJAN Cobalt Strike Covert DNS CnC Channel TXT Lookup (udp)<br />ETPRO TROJAN Cobalt Strike DNS CnC Activity<br />ETPRO TROJAN CobaltStrike Malleable C2 Activity (OCSP Profile)<br />ETPRO TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile<br />ETPRO TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile M2<br />ETPRO TROJAN Cobalt Strike Malleable C2 (Unknown Profile)<br />ETPRO TROJAN Cobalt Strike Malleable JQuery Custom Profile M4<br />ETPRO TROJAN Cobalt Strike Trial HTTP Response Header (EICAR)<br />ETPRO TROJAN Cobalt Strike Trial HTTP Response Header (X-Malware)<br />ETPRO TROJAN Malicious Domain CStrike C2 (blockbitcoin .com in DNS Lookup)<br />ETPRO TROJAN Observed Cobalt Strike CnC Domain in TLS SNI<br />ETPRO TROJAN Observed CobaltStrike Style SSL Cert (Amazon Profile)<br />ETPRO TROJAN Observed Malicious SSL Cert (Cobalt Strike)<br />ETPRO TROJAN Observed Malicious SSL Cert (Cobalt Strike CnC)<br />ETPRO TROJAN Observed Malicious SSL Cert (CobaltStrike CnC)<br />ETPRO TROJAN Possible CobaltStrike CnC Beacon (Fake Safe Browsing)<br />ETPRO TROJAN Possible Cobalt Strike CnC via DNS TXT<br />ETPRO TROJAN Possible Cobalt Strike DNS Tunneling<br />ETPRO TROJAN Suspected Cobalt Strike Stager DNS Activity<br />ETPRO TROJAN W32/Unknown Dropper Downloading Cobalt Strike Beacon<br />ETPRO TROJAN Win32/Cobalt Strike CnC Activity (OCSP Spoof)<br />ETPRO TROJAN Winnti Possible Meterpreter or Cobalt Strike Downloader<br />ET TROJAN Cobalt Strike Activity<br />ET TROJAN Cobalt Strike Beacon Activity<br />ET TROJAN Cobalt Strike Beacon Activity (GET)<br />ET TROJAN Cobalt Strike Beacon Activity (UNC2447)<br />ET TROJAN Cobalt Strike Beacon Activity (WordPress Profile)<br />ET TROJAN Cobalt Strike Beacon (Amazon Profile) M2<br />ET TROJAN Cobalt Strike Beacon (Bing Profile)<br />ET TROJAN Cobalt Strike Beacon Observed (MASB UA)<br />ET TROJAN Cobalt Strike Beacon (WooCommerce Profile)<br />ET TROJAN Cobalt Strike C2 Profile (news_indexedimages)<br />ET TROJAN Cobalt Strike Malleable C2 (Adobe RTMP)<br />ET TROJAN Cobalt Strike Malleable C2 Amazon Profile<br />ET TROJAN Cobalt Strike Malleable C2 (Havex APT)<br />ET TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile M3<br />ET TROJAN Cobalt Strike Malleable C2 JQuery Custom Profile Response<br />ET TROJAN Cobalt Strike Malleable C2 (Meterpreter)<br />ET TROJAN Cobalt Strike Malleable C2 (Microsoft Update GET)<br />ET TROJAN Cobalt Strike Malleable C2 (MSDN Query Profile)<br />ET TROJAN Cobalt Strike Malleable C2 OCSP Profile<br />ET TROJAN Cobalt Strike Malleable C2 (OneDrive)<br />ET TROJAN Cobalt Strike Malleable C2 Profile (bg)<br />ET TROJAN Cobalt Strike Malleable C2 Profile (btn_bg)<br />ET TROJAN Cobalt Strike Malleable C2 Profile (extension.css)<br />ET TROJAN Cobalt Strike Malleable C2 Profile (__session__id Cookie)<br />ET TROJAN Cobalt Strike Malleable C2 Profile (Teams) M1<br />ET TROJAN Cobalt Strike Malleable C2 Profile (Teams) M2<br />ET TROJAN Cobalt Strike Malleable C2 (QiHoo Profile)<br />ET TROJAN Cobalt Strike Malleable C2 Request (Stackoverflow Profile)<br />ET TROJAN Cobalt Strike Malleable C2 (Safebrowse Profile) GET<br />ET TROJAN Cobalt Strike Malleable C2 (TrevorForget Profile)<br />ET TROJAN Cobalt Strike Malleable C2 (Unknown Profile)<br />ET TROJAN Cobalt Strike Malleable C2 Webbug Profile<br />ET TROJAN Cobalt Strike Malleable C2 (WooCommerce Profile)<br />ET TROJAN Cobalt Strike Stager Time Check M1<br />ET TROJAN Cobalt Strike Stager Time Check M2<br />ET TROJAN CopyKittens Cobalt Strike DNS Lookup (cloudflare-analyse . com)<br />ET TROJAN [eSentire] Cobalt Strike Beacon<br />ET TROJAN NOBELIUM Cobalt Strike CnC Domain in DNS Lookup<br />ET TROJAN Observed CobaltStrike CnC Domain (defendersecyrity .com in TLS SNI)<br />ET TROJAN Observed Cobalt Strike CnC Domain (dimentos .com in TLS SNI)<br />ET TROJAN Observed CobaltStrike CnC Domain in TLS SNI<br />ET TROJAN Observed Cobalt Strike CnC Domain in TLS SNI (cs .lg22l .com)<br />ET TROJAN Observed Cobalt Strike CnC Domain (security-desk .com in TLS SNI)<br />ET TROJAN Observed CobaltStrike Loader Domain (cybersecyrity .com in TLS SNI)<br />ET TROJAN Observed Cobalt Strike Stager Domain in DNS Query<br />ET TROJAN Observed CobaltStrike/TEARDROP CnC Domain Domain in DNS Query<br />ET TROJAN Observed CobaltStrike/TEARDROP CnC Domain Domain in TLS SNI (mobilnweb .com)<br />ET TROJAN Observed Cobalt Strike User-Agent<br />ET TROJAN Observed Default CobaltStrike SSL Certificate<br />ET TROJAN Observed Malicious SSL Cert (Cobalt Strike CnC)<br />ET TROJAN Observed Malicious SSL Cert (CobaltStrike CnC)<br />ET TROJAN Possible UNC1878 Cobalt Strike CnC SSL Cert Inbound (lol)<br />ET TROJAN Possible UNC1878 Cobalt Strike CnC SSL Cert Inbound (Mountainvew)<br />ET TROJAN Possible UNC1878 Cobalt Strike CnC SSL Cert Inbound (office)<br />ET TROJAN Possible UNC1878 Cobalt Strike CnC SSL Cert Inbound (Texsa)<br />ET TROJAN [PTsecurity] Possible Cobalt Strike payload<br />ET TROJAN [TGI] Cobalt Strike Malleable C2 Request (O365 Profile)<br />ET TROJAN [TGI] Cobalt Strike Malleable C2 Request (YouTube Profile)<br />ET TROJAN [TGI] Cobalt Strike Malleable C2 Response (O365 Profile) M2<br />ET TROJAN Observed Default CobaltStrike SSL Certificate</p>



<h2 class="wp-block-heading">Yara Rules</h2>
<p><a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike" target="_blank" rel="noopener">Malpedia Cobalt Strike information</a> and <a href="https://malpedia.caad.fkie.fraunhofer.de/yara/win.cobalt_strike" target="_blank" rel="noopener">yara rule</a> by Felix Bilstein</p>
<p><a href="https://github.com/Neo23x0/signature-base/blob/master/yara/apt_cobaltstrike.yar" target="_blank" rel="noopener">Rules from Elastic, Volexity, JPCERT</a></p>
<p><a href="https://github.com/advanced-threat-research/Yara-Rules/blob/master/malware/MALW_cobaltstrike.yar" target="_blank" rel="noopener">Rules from Marc Rivero with the McAfee ATR Team</a></p>
<p><a href="https://github.com/Neo23x0/signature-base/blob/master/yara/apt_cobaltstrike_evasive.yar" target="_blank" rel="noopener">Rules by <span class="__cf_email__" data-cfemail="1e677f6c7f5e6d2d7d30647f30707b6a">[email&#160;protected]</span></a></p>
<p><a href="https://github.com/avast/ioc/blob/master/CobaltStrike/yara_rules/cs_rules.yar" target="_blank" rel="noopener">Rules by Avast</a></p>
<p><a href="https://github.com/Te-k/cobaltstrike/blob/master/rules.yar"><span class="pl-c1"><span class="pl-s">Etienne Maynier <span class="__cf_email__" data-cfemail="6713020c27150609030f080a02490e08">[email&#160;protected]</span></span></span></a></p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-3529" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-3529" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-3529" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-3529 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2021/08/16/trickbot-leads-up-to-fake-1password-installation/" rel="prev">Trickbot Leads Up to Fake 1Password Installation</a></div><div class="nav-next"><a href="https://thedfirreport.com/2021/09/13/bazarloader-to-conti-ransomware-in-32-hours/" rel="next">BazarLoader to Conti Ransomware in 32 Hours</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="5f8e4cdff7" /><input type="hidden" name="_wp_http_referer" value="/2021/08/29/cobalt-strike-a-defenders-guide/" /><input type="hidden" name="post_id" value="3529"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="auto, (max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="827935a82e18836289f225e5-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2021\/08\/29\/cobalt-strike-a-defenders-guide\/":3529};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.7.1" id="freenews-navigation-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.7.1" id="freenews-skip-link-focus-fix-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.7.1" id="ResizeSensor-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.7.1" id="theia-sticky-sidebar-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.7.1" id="slick-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.7.1" id="freenews-slick-settings-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.7.1" id="jquery-sticky-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.7.1" id="freenews-sticky-settings-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.7.1" id="marquee-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.7.1" id="freenews-marquee-settings-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="827935a82e18836289f225e5-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"3529\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:14.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "3529" ]);
/* ]]> */
</script>
<script type="827935a82e18836289f225e5-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=14.1" id="google-translate-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.1" id="jetpack-block-subscriptions-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="827935a82e18836289f225e5-text/javascript" src="https://c0.wp.com/p/jetpack/14.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="827935a82e18836289f225e5-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="827935a82e18836289f225e5-|49" defer></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3de9230fe5cacb","version":"2024.10.5","r":1,"serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"e6611380fbbe475a97dc9cf0a0e9fd2b","b":1}' crossorigin="anonymous"></script>
</body>
</html>
