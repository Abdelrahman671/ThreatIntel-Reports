

<!DOCTYPE html>
<html class="no-js" lang="">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="profile" href="https://gmpg.org/xfn/11" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="google-site-verification" content="gT5R-9Y0-xVcHIORRNZrT8cpFo6sNoV0POeyWjsMNZE" />
    
    <title>CheckMesh: Hidden Threats in Your FW</title>
    <meta name="description" content="CheckMesh attack: APTs turning Check Point firewalls into Command &amp; Control nodes. Learn how we uncovered and mitigated this threat.">
    <!--<link rel="canonical" href="https://hackerseye.net/all-blog-items/checkmesh/">-->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="CheckMesh: Hidden Threats in Your FW">
    <meta property="og:description" content="CheckMesh attack: APTs turning Check Point firewalls into Command &amp; Control nodes. Learn how we uncovered and mitigated this threat.">
    <meta property="og:url" content="https://hackerseye.net/all-blog-items/checkmesh/">
    <meta property="og:site_name" content="HackersEye">
    <meta property="article:modified_time" content="5/25/2023 12:00:00 PM">
    <meta name="twitter:card" content="summary_large_image">
    
    <meta property="og:image" content="" />
    <meta property="og:image:secure_url" content="" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="400" />
    <meta property="og:image:height" content="300" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" color="#5bbad5" href="/safari-pinned-tab.svg" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />

    <link rel="stylesheet" href="/css/loadfonts.css" />
    <link rel="stylesheet" href="/css/navigation.css" />
    <link rel="stylesheet" href="/css/footer.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/blog.css" />
    <link rel="stylesheet" href="/css/test.css" />
    <link rel="stylesheet" href="/css/hackersrange.css" />
    <link rel="stylesheet" href="/css/about-us.css" />

    <script src="/static/jquery-3.6.0.min.js"></script>
    <script src="/scripts/jquery.validate.min.js"></script>
    <script src="/scripts/jquery.validate.unobtrusive.min.js"></script>
        
    <link rel="stylesheet" href="/static/slick/slick.css" />
    <script src="/static/slick/slick.js"></script>

    <link rel="stylesheet" href="/static/aos/aos.css" />
    <script src="/static/aos/aos.js"></script>
    
    <link rel="stylesheet" media="print" onload="this.media='all'" href="/static/cookieconsent/cookieconsent.css" />
    
    <!-- Google tag (gtag.js) -->
    <script type="text/plain" data-cookiecategory="analytics" async src="https://www.googletagmanager.com/gtag/js?id=G-FV6ET3EWSF"></script>
    <script type="text/plain" data-cookiecategory="analytics">
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-FV6ET3EWSF');
    </script>
    
    <script defer src="/static/cookieconsent/cookieconsent.js"></script>
    <script defer src="/static/cookieconsent/cookieconsent-init.js"></script>

  </head>
  <body data-aos-easing="ease" data-aos-duration="1200" data-aos-delay="0">
    <div id="page" class="site">
      <!-- Header -->
      
<header id="rehead" class="site-header">
        <div class="reheader-widgets">
          <div class="header-widgets-in">
            <a class="header-logo" href="/">
              <img loading="lazy" src="/assets/uploads/footer-logo.png" />
            </a>
            <div class="menu-header-nav-container">
              <ul id="menu-header-nav" class="menu">
                <li
                  id="menu-item-644"
                  class="reservicenav menu-item menu-item-has-children menu-item-644"
                >
                  <a>Services</a>
                  <ul class="sub-menu">
                    <li
                      id="menu-item-646"
                      class="menu-item menu-item-type-post_type menu-item-object-services menu-item-646"
                    >
                      <a href="/services/blue-team">Blue Team</a>
                    </li>
                    <li
                      id="menu-item-647"
                      class="menu-item menu-item-type-post_type menu-item-object-services menu-item-647"
                    >
                      <a href="/services/red-team">Red Team</a>
                    </li>
                    <li
                      id="menu-item-648"
                      class="menu-item menu-item-type-post_type menu-item-object-services menu-item-648"
                    >
                      <a href="/services/security-consulting"
                        >Security Consulting</a
                      >
                    </li>
                    <li
                      id="menu-item-649"
                      class="menu-item menu-item-type-post_type menu-item-object-services menu-item-649"
                    >
                      <a href="/services/soc-consulting">SOC Consulting</a>
                    </li>
                    <li
                      id="menu-item-650"
                      class="menu-item menu-item-type-post_type menu-item-object-services menu-item-650"
                    >
                      <a href="/services/cyber-intelligence"
                        >Cyber Intelligence</a
                      >
                    </li>
                    <li
                      id="menu-item-651"
                      class="menu-item menu-item-type-post_type menu-item-object-services menu-item-651"
                    >
                      <a href="/services/social-engineering"
                        >Social Engineering</a
                      >
                    </li>
                  </ul>
                </li>
                <li id="menu-item-1001" class="menu-item menu-item-1001">
                  <a href="/hackersrange">Hackers Range</a>
                </li>
                <li
                  id="menu-item-1038"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1038"
                >
                  <a href="/blog">Blog</a>
                </li>
                <li
                  id="menu-item-45"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-45"
                >
                  <a href="/about-us">About Us</a>
                </li>
                <li
                  id="menu-item-47"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-47"
                >
                  <a href="/contact">Contact</a>
                </li>
              </ul>
            </div>
          </div>
          <a
            href="https://wa.me/+972545423725"
            class="footer-demo-a"
            target="_blank"
            ><span>Under Attack</span></a
          >
          <div class="button_menu" id="touch-menu">
            <button type="button" class="btn-beetle-nav"></button>
          </div>
        </div>
      </header>
      <!-- Content Wrapper -->
      




<head>
    <meta property="og:image" content="/media/xomj5jdg/untitled-31.png" />
    <meta property="og:image:secure_url" content="/media/xomj5jdg/untitled-31.png" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:width" content="400" />
    <meta property="og:image:height" content="300" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="/media/xomj5jdg/untitled-31.png" />
    <style>
        
.blog-table-wrapper {
  overflow: scroll;
}

.blog-table-wrapper p {
  margin: 0 !important;
  padding: .5rem .8rem !important;
  word-wrap: anywhere;
}

.toc-wrapper-blog a {
  text-decoration: none !important;
  font-family: 'Titillium Web' !important;
  margin: 0 !important;
  font-size: 0.8rem;
  color: white !important;
}

.toc-wrapper-blog a:hover {
  text-decoration: underline !important;
}

.toc-wrapper-blog ul {
  margin-left: 1.3rem;
}

.toc-wrapper-blog ul li {
  display: flex;
  align-items: center;
  margin: 0;
}

.entry-content table p,
.entry-content table span {
  margin: 0;
  line-height: 1.1rem !important;
  font-size: 1rem !important;
  word-wrap: anywhere;
  font-family: 'Titillium Web';
}

.entry-content table {
  padding: 0.6rem;
  max-width: 100%;
  min-width: 300px;
}

@media (max-width: 900px) {
.entry-content table p,
.entry-content table span {
  margin: 0;
  line-height: 1.1rem !important;
  font-size: 1rem !important;
  word-wrap: anywhere !important;
}
}

    </style>
</head>

<div id="content" class="site-content">
<div id="primary" class="content-area">
  <main id="main" class="site-main">
    <div
      class="reblogone"
      style="background-image: url(/media/xomj5jdg/untitled-31.png)"
    >
      <div class="reblogone-out">
        <div class="single_b">
          <div id="breadcrumbs">
            <span>
              <span>
                <a href="/">Home</a>
                <i class="arrow"></i>
                <a href="/blog">Blog</a>
                <i class="arrow"></i>
                <span class="breadcrumb_last" aria-current="page"
                  >CheckMesh: Hidden Threats in Your FW</span
                >
              </span>
            </span>
          </div>
        </div>
        <div class="reblogone-in">
          <div class="textwidget custom-html-widget"></div>
          <div
            class="heateor_sss_sharing_container heateor_sss_horizontal_sharing"
            data-heateor-sss-href="https://hackerseye.net/all-blog-items/checkmesh/"
          >
            <h3>Share</h3>
            <div class="heateor_sss_sharing_ul">
              <a
                class="heateor_sss_facebook"
                href="https://www.facebook.com/sharer/sharer.php?u=https://hackerseye.net/all-blog-items/checkmesh/"
                title="Facebook"
                rel="nofollow noopener"
                target="_blank"
                style="
                  font-size: 32px !important;
                  box-shadow: none;
                  display: inline-block;
                  vertical-align: middle;
                "
                ><span
                  class="heateor_sss_svg"
                  ><svg
                    style="display: block; border-radius: 999px"
                    focusable="false"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    width="100%"
                    height="100%"
                    viewBox="-5 -5 42 42"
                  >
                    <path
                      d="M17.78 27.5V17.008h3.522l.527-4.09h-4.05v-2.61c0-1.182.33-1.99 2.023-1.99h2.166V4.66c-.375-.05-1.66-.16-3.155-.16-3.123 0-5.26 1.905-5.26 5.405v3.016h-3.53v4.09h3.53V27.5h4.223z"
                      fill="#fff"
                    ></path></svg></span></a
              ><a
                class="heateor_sss_whatsapp"
                href="https://api.whatsapp.com/send?text=CheckMesh: Hidden Threats in Your FW. https://hackerseye.net/all-blog-items/checkmesh/"
                title="Whatsapp"
                rel="nofollow noopener"
                target="_blank"
                style="
                  font-size: 32px !important;
                  box-shadow: none;
                  display: inline-block;
                  vertical-align: middle;
                "
                ><span
                  class="heateor_sss_svg"
                  ><svg
                    style="display: block; border-radius: 999px"
                    focusable="false"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    width="100%"
                    height="100%"
                    viewBox="-6 -5 40 40"
                  >
                    <path
                      class="heateor_sss_svg_stroke heateor_sss_no_fill"
                      stroke="#fff"
                      stroke-width="2"
                      fill="none"
                      d="M 11.579798566743314 24.396926207859085 A 10 10 0 1 0 6.808479557110079 20.73576436351046"
                    ></path>
                    <path
                      d="M 7 19 l -1 6 l 6 -1"
                      class="heateor_sss_no_fill heateor_sss_svg_stroke"
                      stroke="#fff"
                      stroke-width="2"
                      fill="none"
                    ></path>
                    <path
                      d="M 10 10 q -1 8 8 11 c 5 -1 0 -6 -1 -3 q -4 -3 -5 -5 c 4 -2 -1 -5 -1 -4"
                      fill="#fff"
                    ></path></svg></span></a
              ><a
                class="heateor_sss_button_twitter"
                href="https://twitter.com/intent/tweet?text=CheckMesh: Hidden Threats in Your FW.&amp;url=https://hackerseye.net/all-blog-items/checkmesh/"
                title="Twitter"
                rel="nofollow noopener"
                target="_blank"
                style="
                  font-size: 32px !important;
                  box-shadow: none;
                  display: inline-block;
                  vertical-align: middle;
                "
                ><span
                  class="heateor_sss_svg heateor_sss_s__default heateor_sss_s_twitter"
                  ><svg
                    style="display: block; border-radius: 999px"
                    focusable="false"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    width="100%"
                    height="100%"
                    viewBox="-4 -4 39 39"
                  >
                    <path
                      d="M28 8.557a9.913 9.913 0 0 1-2.828.775 4.93 4.93 0 0 0 2.166-2.725 9.738 9.738 0 0 1-3.13 1.194 4.92 4.92 0 0 0-3.593-1.55 4.924 4.924 0 0 0-4.794 6.049c-4.09-.21-7.72-2.17-10.15-5.15a4.942 4.942 0 0 0-.665 2.477c0 1.71.87 3.214 2.19 4.1a4.968 4.968 0 0 1-2.23-.616v.06c0 2.39 1.7 4.38 3.952 4.83-.414.115-.85.174-1.297.174-.318 0-.626-.03-.928-.086a4.935 4.935 0 0 0 4.6 3.42 9.893 9.893 0 0 1-6.114 2.107c-.398 0-.79-.023-1.175-.068a13.953 13.953 0 0 0 7.55 2.213c9.056 0 14.01-7.507 14.01-14.013 0-.213-.005-.426-.015-.637.96-.695 1.795-1.56 2.455-2.55z"
                      fill="#fff"
                    ></path></svg></span></a
              ><a
                class="heateor_sss_email"
                href="https://hackerseye.net/all-blog-items/checkmesh/"
                onclick="event.preventDefault();window.open('mailto:?subject=' + decodeURIComponent('CheckMesh: Hidden Threats in Your FW.').replace('&amp;', '%26') + '&amp;body=https://hackerseye.net/all-blog-items/checkmesh/', '_blank')"
                title="Email"
                rel="nofollow noopener"
                style="
                  font-size: 32px !important;
                  box-shadow: none;
                  display: inline-block;
                  vertical-align: middle;
                "
                ><span
                  class="heateor_sss_svg"
                  ><svg
                    style="display: block; border-radius: 999px"
                    focusable="false"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    width="100%"
                    height="100%"
                    viewBox="-4 -4 43 43"
                  >
                    <path
                      d="M 5.5 11 h 23 v 1 l -11 6 l -11 -6 v -1 m 0 2 l 11 6 l 11 -6 v 11 h -22 v -11"
                      stroke-width="1"
                      fill="#fff"
                    ></path></svg></span></a
              ><a
                class="heateor_sss_button_linkedin"
                href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://hackerseye.net/all-blog-items/checkmesh/&amp;title=CheckMesh: Hidden Threats in Your FW"
                title="Linkedin"
                rel="nofollow noopener"
                target="_blank"
                style="
                  font-size: 32px !important;
                  box-shadow: none;
                  display: inline-block;
                  vertical-align: middle;
                "
                ><span
                  class="heateor_sss_svg heateor_sss_s__default heateor_sss_s_linkedin"
                  ><svg
                    style="display: block; border-radius: 999px"
                    focusable="false"
                    aria-hidden="true"
                    xmlns="http://www.w3.org/2000/svg"
                    width="100%"
                    height="100%"
                    viewBox="0 0 32 32"
                  >
                    <path
                      d="M6.227 12.61h4.19v13.48h-4.19V12.61zm2.095-6.7a2.43 2.43 0 0 1 0 4.86c-1.344 0-2.428-1.09-2.428-2.43s1.084-2.43 2.428-2.43m4.72 6.7h4.02v1.84h.058c.56-1.058 1.927-2.176 3.965-2.176 4.238 0 5.02 2.792 5.02 6.42v7.395h-4.183v-6.56c0-1.564-.03-3.574-2.178-3.574-2.18 0-2.514 1.7-2.514 3.46v6.668h-4.187V12.61z"
                      fill="#fff"
                    ></path></svg></span
              ></a>
            </div>
            <div class="heateorSssClear"></div>
          </div>
        </div>

        <div class="reblogone-in2">
          <article
            id="post=1210"
            class="post=1210 post type-post status-publish format-standard has-post-thumbnail hentry category-blog"
          >
            <header class="entry-header">
              <h1 class="entry-title">
                CheckMesh: Hidden Threats in Your FW
              </h1>
              <div class="entry-meta">
                HackersEye <span class="redevider"></span>
                7/9/2024
                </br>
                <p><span style="margin-right: .6rem">Author:</span><span>Dean Bar, Co-founder And COO @HackersEye</span></p>
              </div>
              <!-- .entry-meta -->
            </header>
            <!-- .entry-header -->

            <div class="entry-content">
              <p>
                <h3 class="MsoTocHeading">Contents:<!-- [if supportFields]> TOC \o &quot;1-3&quot; \h \z \u <![endif]--><a href="#_Toc171429663"><span style="mso-tab-count: 1 dotted;"> </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429663 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">1<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600360033000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></h3>
<div class="toc-wrapper-blog">
<p class="MsoToc1"><a href="#_Toc171429664"><span style="mso-no-proof: yes;">CheckMesh: Unveiling the Hidden Threats in Your Firewall</span><span style="mso-tab-count: 1 dotted;"> </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429664 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">4<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600360034000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429666"><span style="mso-no-proof: yes;">1. Explaining the breach - The story in a nutshell</span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;"> </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429666 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">5<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600360036000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429667"><span style="mso-no-proof: yes;">2. Threat Actor Attribution, TTPs, and Motivation</span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429667 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">6<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600360037000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
<ul>
<li class="MsoToc3"><a href="#_Toc171429668">Threat Actor Attribution</a></li>
<li class="MsoToc3"><a href="#_Toc171429669">Motivation</a></li>
<li class="MsoToc3"><a href="#_Toc171429670">Understanding MeshAgent:</a></li>
<li class="MsoToc3"><a href="#_Toc171429671">Technical goodies: Dissecting the Attack</a></li>
<li class="MsoToc3"><a href="#_Toc171429672">The Initial Clues</a><a href="#_Toc171429672"><span style="mso-no-proof: yes;"></span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429672 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">10<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600370032000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></li>
</ul>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429673"><span style="mso-no-proof: yes;">3. Following the breadcrumbs</span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;"> </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429673 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">11<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600370033000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
<ul>
<li class="MsoToc2"><a href="#_Toc171429674">Finding the first execution:</a></li>
<li class="MsoToc2"><a href="#_Toc171429675"> Deployment and Execution</a><a href="#_Toc171429675"><span style="mso-no-proof: yes;"></span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429675 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">12<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600370035000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></li>
</ul>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429676"><span style="mso-no-proof: yes;">4. Technical Analysis: examining the ELF</span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429676 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">13<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600370036000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
<ul>
<li class="MsoToc3"><a href="#_Toc171429677"> Initial Discovery</a></li>
<li class="MsoToc3"><a href="#_Toc171429678">Delving Deeper: MeshAgent</a><a href="#_Toc171429678"><span style="mso-no-proof: yes;"></span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429678 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">14<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600370038000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></li>
</ul>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429679">5. Recommendations</a></p>
<ul>
<li class="MsoToc2"><a href="#_Toc171429679"><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429679 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">18<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600370039000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a><a href="#_Toc171429680">Incident Response Recommendations</a></li>
</ul>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429681"><span style="mso-no-proof: yes;">6. Detection, IOCs, and YARA rules:</span><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;"> </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429681 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">19<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600380031000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
<ul>
<li class="MsoToc3"><a href="#_Toc171429682">YARA Rules for Detection</a><a href="#_Toc171429682"><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429682 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">19<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600380032000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></li>
</ul>
<p style="tab-stops: right dotted 450.8pt;" class="MsoToc2">    <a href="#_Toc171429683">7. References<span style="mso-tab-count: 1 dotted;">. </span><!-- [if supportFields]><span style='mso-element:field-begin'>
 PAGEREF _Toc171429683 \h </span><![endif]--><span style="color: windowtext; display: none; mso-hide: screen; mso-no-proof: yes; text-decoration: none; text-underline: none;">22<!-- [if gte mso 9]><xml>
  <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003100370031003400320039003600380033000000</w:data>
 </xml><![endif]--></span><!-- [if supportFields]><span style='mso-element:field-end'></span><![endif]--></a></p>
</div>
<p class="MsoNormal"><!-- [if supportFields]><strong><span style='mso-no-proof:yes'></span></strong><![endif]--><strong> </strong></p>
<h3><a name="_Toc171429664"></a>CheckMesh: Unveiling the Hidden Threats in Your Firewall</h3>
<p>At HackersEye, tackling the most complex cybersecurity challenges is a daily routine and cornerstone of our operations. As Israel faces ongoing geopolitical tensions and an escalation in cyber incidents due to the current state of conflict, our team stands at the forefront, defending critical infrastructure against sophisticated and persistent threats.</p>
<p> </p>
<p>"Our highly skilled cybersecurity experts specialize in identifying and mitigating advanced persistent threats (APTs), utilizing state-of-the-art tools and methodologies to stay ahead of malicious actors," says Tal Raveh, CEO of HackersEye.</p>
<p> </p>
<p>Recently, we encountered an exceptionally advanced cyber-attack targeting an Israeli enterprise utilizing a Check Point firewall. Dubbed as CheckMesh, for obvious reason the attack successfully deploys &amp; executes a Mesh agent on the CheckPoint firewall Linux system. The Attacker transformed the CheckPoint firewall into a stealthy Command and Control (C2) node using a malicious MeshAgent-based ELF implant. </p>
<p> </p>
<p>"The sophistication and persistence of this threat actor, likely an APT group rather than mere hacktivists, demonstrated their advanced capabilities in maintaining covert control over compromised systems, explains Yaron Adika, HackersEye CTO. "This case study not only underscores the advanced techniques employed by the threat actors but also highlights our meticulous approach to incident response, crisis management, and remediation."</p>
<p> </p>
<p>Join us as we delve into the intricacies of this incident, uncovering the strategies employed by the attackers and the robust measures we implemented to safeguard our clients against such persistent threats.</p>
<p> </p>
<p>"Our team of cybersecurity experts, equipped with extensive technical knowledge and a relentless dedication to excellence, is prepared to defend against the continually evolving landscape of cyber threats," Raveh adds. "Through detailed forensic analysis, real-time detection, and comprehensive incident response, HackersEye continues to lead the charge in protecting organizations from the increasing cyber warfare in today’s digital battlefield."</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/0rsjwpzr/image.png?rmode=max&amp;width=342&amp;height=303" alt="" width="342" height="303"></p>
<p> </p>
<h3><a name="_Toc171429666"></a>Explaining the breach - The story in a nutshell</h3>
<p>The attack on this organization unfolded in a series of calculated steps, setting the stage for a significant breach:</p>
<ul>
<li class="MsoNormal" style="mso-list: l0 level1 lfo1; tab-stops: list .5in;"><span>Late June: Potential compromise of Admin access.</span><br>The attacker may have used one of several methods to gain admin access:<br>    <span>1. Brute forcing.</span><br>    <span>2. Password spraying.</span><br>    <span>3. Leaked credentials.</span><br>    <span>4. Exploiting a known CheckPoint vulnerability.</span><br>There is no conclusive evidence indicating a specific method used by the attacker in order to gain access.</li>
<li><span style="text-decoration: underline;">Initial Connection via GAIA HTTP:</span> In late June, the attacker began their operation by connecting to the GAIA web interface using the stolen credentials. This initial connection allowed them to gather more information and plan their next move.</li>
<li><span style="text-decoration: underline;">Upgrading to SSH CLI:</span> With enough reconnaissance done, the attacker upgraded their access by initiating an SSH CLI session on the firewall. This move provided them with a more powerful and flexible control interface.</li>
<li><span style="text-decoration: underline;">Installing the C2 Agent:</span> Once they had SSH access, the attacker deployed a malicious ELF implant. This C2 agent was installed and disguised as a legitimate process, enabling encrypted communication with their C2 server and ensuring persistent access.</li>
<li><span style="text-decoration: underline;">Operating as Root on the Linux Box:</span> With the C2 agent in place, the attacker operated as root on the firewall's Linux system. This high-level access allowed them to manipulate the firewall's functions, maintain their foothold, and further their objectives within the compromised network.</li>
<li><span style="text-decoration: underline;">Domain users and lateral movement:</span> with port forwarding abilities on the organizational FW, the attack obtained domain credentials via password spraying, Brute-Force, and other methods, and created a RDP tunnel to internal network servers and endpoints.</li>
</ul>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/3k3hqh4x/image.png?rmode=max&amp;width=489&amp;height=326" alt="" width="489" height="326"></p>
<h3><a name="_Toc171429667"></a>Threat Actor Attribution, TTPs, and Motivation</h3>
<h4><a name="_Toc171429668"></a>Threat Actor Attribution</h4>
<p class="MsoNormal">The attack on this organization shows significant similarities to the activities attributed to <a href="https://blog.talosintelligence.com/lilacsquid/">LilacSquid APT group</a>, Observed by CISCO Talos.</p>
<p>Below is a detailed comparison of the tactics, techniques, and procedures (TTPs) used in both cases, supporting the attribution of this sophisticated attack to LilacSquid.</p>
<p> </p>
<h4><em>Modus Operandi</em></h4>
<p>The modus operandi of the LilacSquid APT group involves a multi-stage approach to compromise and persist within targeted networks:</p>
<ol>
<li><strong>Initial Exploitation:</strong> Exploiting vulnerabilities in public-facing applications or devices to gain initial access.</li>
<li><strong>Persistence:</strong> Deploying persistent implants, such as MeshAgent, to maintain long-term access.</li>
<li><strong>Credential Theft and Lateral Movement:</strong> Stealing credentials to move laterally within the network and escalate privileges.</li>
<li><strong>C2 Communication:</strong> Establishing secure C2 channels using encrypted protocols like WebSocket over TLS (wss) to communicate with compromised devices.</li>
<li><strong>Service Control:</strong> Using Windows service control commands (sc create, sc start) to manage malicious services and ensure persistence.</li>
</ol>
<p> </p>
<h4><em>Tactics, Techniques, and Procedures (TTPs)</em></h4>
<div class="blog-table-wrapper">
<table border="1" style="border-collapse: collapse; width: 100%; border-width: 1px; margin-left: auto; margin-right: auto; height: 835px;">
<tbody>
<tr style="height: 45px;">
<td style="width: 33.3333%; height: 45px; border-width: 1px; text-align: center; padding: 8px;"><strong>Criteria</strong></td>
<td style="width: 33.3333%; height: 45px; border-width: 1px; text-align: center; padding: 8px;"><strong>Our recent incident</strong></td>
<td style="width: 33.3333%; height: 45px; border-width: 1px; text-align: center; padding: 8px;"><strong>LilacSquid APT Group</strong></td>
</tr>
<tr style="height: 124px;">
<td style="width: 33.3333%; height: 124px; border-width: 1px; text-align: center; padding: 8px;">Targeted Infrastructure</td>
<td style="width: 33.3333%; height: 124px; border-width: 1px; text-align: center; padding: 8px;">Check Point firewall of an<br>Israeli enterprise</td>
<td style="width: 33.3333%; height: 124px; border-width: 1px; text-align: center; padding: 8px;">Various high-profile targets, including public-facing apps and infrastructure (Cisco Talos Blog) (Buzzsprout)</td>
</tr>
<tr style="height: 86px;">
<td style="width: 33.3333%; height: 86px; border-width: 1px; text-align: center; padding: 8px;">Initial Exploitation</td>
<td style="width: 33.3333%; height: 86px; border-width: 1px; text-align: center; padding: 8px;">
<p>The attacker may have used one of several methods to gain admin access:<br>    1. Brute forcing.<br>    2. Password spraying.<br>    3. Leaked credentials.<br>    4. Exploiting a known CheckPoint vulnerability.</p>
</td>
<td style="width: 33.3333%; height: 86px; border-width: 1px; text-align: center; padding: 8px;">
<p>Known for exploiting vulnerabilities in public-facing applications (Cisco Talos Blog)</p>
</td>
</tr>
<tr style="height: 87px;">
<td style="width: 33.3333%; height: 87px; border-width: 1px; text-align: center; padding: 8px;">Persistence Mechanism</td>
<td style="width: 33.3333%; height: 87px; border-width: 1px; text-align: center; padding: 8px;">Malicious MeshAgent-based<br>ELF implant</td>
<td style="width: 33.3333%; height: 87px; border-width: 1px; text-align: center; padding: 8px;">Deployment of MeshAgent for persistence and control (Buzzsprout)</td>
</tr>
<tr style="height: 89px;">
<td style="width: 33.3333%; height: 89px; border-width: 1px; text-align: center; padding: 8px;">
<p>Command and Control (C2) Technique</p>
</td>
<td style="width: 33.3333%; height: 89px; border-width: 1px; text-align: center; padding: 8px;">Utilized MeshAgent to<br>establish C2 over WebSocket<br>(wss)</td>
<td style="width: 33.3333%; height: 89px; border-width: 1px; text-align: center; padding: 8px;">Use of MeshAgent and sophisticated C2 infrastructure (Buzzsprout)</td>
</tr>
<tr style="height: 101px;">
<td style="width: 33.3333%; height: 101px; border-width: 1px; text-align: center; padding: 8px;">Credential Theft</td>
<td style="width: 33.3333%; height: 101px; border-width: 1px; text-align: center; padding: 8px;">Gained access using stolen<br>credentials</td>
<td style="width: 33.3333%; height: 101px; border-width: 1px; text-align: center; padding: 8px;">Common tactic involving credential theft and lateral movement (Cisco Talos Blog)</td>
</tr>
<tr style="height: 112px;">
<td style="width: 33.3333%; height: 112px; border-width: 1px; text-align: center; padding: 8px;">Sophistication Level</td>
<td style="width: 33.3333%; height: 112px; border-width: 1px; text-align: center; padding: 8px;">High, involving advanced<br>stealth and persistence<br>mechanisms</td>
<td style="width: 33.3333%; height: 112px; border-width: 1px; text-align: center; padding: 8px;">High, employing advanced techniques and tools for sustained access (Cisco Talos Blog) (Buzzsprout)</td>
</tr>
<tr style="height: 70px;">
<td style="width: 33.3333%; height: 70px; border-width: 1px; text-align: center; padding: 8px;">Geopolitical Context</td>
<td style="width: 33.3333%; height: 70px; border-width: 1px; text-align: center; padding: 8px;">Targeted Israeli enterprise<br>during heightened regional<br>tensions</td>
<td style="width: 33.3333%; height: 70px; border-width: 1px; text-align: center; padding: 8px;">Often targets high-value entities in geopolitical contexts (Buzzsprout)</td>
</tr>
<tr style="height: 121px;">
<td style="width: 33.3333%; height: 121px; border-width: 1px; text-align: center; padding: 8px;">Observed Tactics,<br>Techniques, and<br>Procedures (TTPs)</td>
<td style="width: 33.3333%; height: 121px; border-width: 1px; text-align: center; padding: 8px;">Use of standard Linux utilities,<br>custom bash scripts,<br>MeshAgent, SSH root access</td>
<td style="width: 33.3333%; height: 121px; border-width: 1px; text-align: center; padding: 8px;">Use of public-facing exploits, custom scripts, MeshAgent, stealth C2 techniques (Cisco Talos Blog) (Buzzsprout)</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<h4><em>Example Comparison: SC Command</em></h4>
<p style="text-align: center;"><em>“SC” Execution on the internal network of the attacked organization:</em></p>
<p style="text-align: center;">Notice the service name is “IPSHelper”, that’s crucial for later on the investigation.</p>
<p style="text-align: center;"><img src="/media/klalwp1k/image.png?rmode=max&amp;width=667&amp;height=84" alt="" width="667" height="84"></p>
<p style="text-align: center;">“SC” Execution performed by LilacSquid observed by CISCO Talos:</p>
<p style="text-align: center;"><img src="/media/gb1j3pmo/image.png?rmode=max&amp;width=729&amp;height=89" alt="" width="729" height="89"></p>
<h4><a name="_Toc171429669"></a>Motivation</h4>
<p>The LilacSquid APT group is likely motivated by geopolitical and economic factors, aiming to gather intelligence and disrupt critical infrastructure. Their targeting of high-profile entities and use of sophisticated tools and techniques indicate a well-resourced and strategically driven operation, typical of state-sponsored actors. The similarity in TTPs between the recent Check Point firewall attack and known activities of LilacSquid suggests that the same motivations underpin both sets of activities, focusing on long-term access, data exfiltration, and potential sabotage of critical systems.</p>
<p> </p>
<h4><a name="_Toc171429670"></a>Understanding MeshAgent:</h4>
<h4><em>What is MeshAgent</em></h4>
<p>MeshAgent is an open-source project available on <span style="font-size: 11.0pt; line-height: 107%; font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: Arial; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;"><a href="https://github.com/Ylianst/MeshAgent">GitHub</a></span>, designed for legitimate remote management purposes. Its key functionalities include:</p>
<ul>
<li>Remote Shell Access: Allows administrators to execute shell commands remotely.</li>
<li>File Transfer: Facilitates the transfer of files between the server and the managed device.</li>
<li>Process Management: Enables remote monitoring and control of system processes.</li>
<li>System Information: Collects and reports system details back to the management server.</li>
</ul>
<p>These features, while useful for legitimate administration, also provide a powerful toolkit for an attacker once they gain control of the agent.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/m44lsxge/image.png?rmode=max&amp;width=623&amp;height=641" alt="" width="623" height="641"></p>
<h4><a name="_Toc171429671"></a>Technical goodies: Dissecting the Attack</h4>
<h4><a name="_Toc171429672"></a>The Initial Clues</h4>
<p>Our investigation began with an unusual observation: an RDP connection to the domain controller originating from a NAT IP address associated with the GAIA firewall.</p>
<p> </p>
<p>After a successful login, the user tried to install a service with a version of mesh-agent for windows, which was blocked by the crowdstrike edr.</p>
<p>Diving a bit more, we find that there is an external machine, not yet to be known, that is attacking our internal assets with credentials attacks such as password spraying, and brute force:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/2ubfimba/image.png?rmode=max&amp;width=500&amp;height=50" alt="" width="500" height="50"></p>
<p>A Host named “ADMIN4025” that is not known and is not a part of the client’s internal network, raising suspicious on our side, taking us to the only place that can explain this kind of behavior, the organizational FW. (checkpoint)</p>
<p> </p>
<p>These actions raised critical questions. Deciding to SSH into the firewall, we prepared to dissect it completely.</p>
<p> </p>
<h3><a name="_Toc171429673"></a>Following the breadcrumbs.</h3>
<p>Upon gaining access to the FW system, we conducted a series of standard diagnostic commands, including ls, ps -auxf, and netstat -antop.</p>
<p>These initial actions revealed the presence of a particularly noteworthy directory named /private located in the root (/) path of the firewall.</p>
<p>Within this directory, we identified an executable file named IPHelper, which warranted further investigation.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/2wvpzxqm/image.png?rmode=max&amp;width=500&amp;height=175" alt="" width="500" height="175"></p>
<p style="text-align: center;">The IPHelper folder, contained a bash script named meshinstall.sh</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/uxsf2slw/image.png?rmode=max&amp;width=500&amp;height=123" alt="" width="500" height="123"></p>
<p>We start by examining the bash script to understand its purpose and actions.</p>
<p>The script was designed to automate the installation and ensure the persistence of the malicious ELF implant (MeshAgent).</p>
<p>Here’s a detailed breakdown of the script and its functionality:</p>
<ul>
<li>Initialization Information: The script includes init information that describes the service, including dependencies and run levels.</li>
<li>Variables: Key variables like SCRIPT, RUNAS, PIDFILE, and LOGFILE are defined for later use.</li>
<li>Start Function: This function checks if the service is already running by verifying the presence of a PID file and then starts the service if it's not running. The CMD variable runs the meshagent in a persistent loop to ensure it automatically restarts if it stops unexpectedly.</li>
<li>Stop Function: This function stops the service by killing the process identified by the PID file.</li>
<li>Restart Function: This simply calls the stop and start functions sequentially.</li>
<li>Status Function: This checks if the service is running by verifying the process status through the PID file.</li>
<li>Case Statement: This handles the command-line arguments to start, stop, restart, or check the status of the service.</li>
</ul>
<p style="text-align: center;">Meshinstall.sh - b1b15e09ea98228203e110456d514327ce6b7438<br>“Usage: service meshagent {start|stop|restart|status}"</p>
<p> </p>
<h4><a name="_Toc171429674"></a>Finding the first execution:</h4>
<p>Executing the bash install script with the C2 address, and a token, for the installation of the agent itself.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/321jknmu/image.png?rmode=max&amp;width=700&amp;height=28" alt="" width="700" height="28"></p>
<h4><a name="_Toc171429675"></a>Deployment and Execution</h4>
<p>Upon discovering the IPSHelper executable on the Check Point firewall, our investigation quickly pivoted to focus on this binary. Notably, the same process name had been earlier detected on a Windows machine, where it was blocked by CrowdStrike. Recognizing that IPSHelper is typically associated with a different firewall platform (Fortigate), we prioritized the examination of this ELF binary to understand its role in the current incident and to determine the extent of its involvement. This examination led to the discovery of the ELF implant on the Check Point firewall, revealing a sophisticated and persistent threat.</p>
<p> </p>
<h3><a name="_Toc171429676"></a>Technical Analysis: examining the ELF</h3>
<p>During our investigation, we used several diagnostic commands to understand the state of the compromised firewall. Here’s a step-by-step breakdown of how we identified and analyzed the malicious ELF implant.</p>
<p> </p>
<h4><a name="_Toc171429677"></a><a name="_Toc171030035"></a>Initial Discovery</h4>
<ol>
<li><strong>Process Analysis with ps auxf:</strong> We began by listing all running processes to identify any anomalies. The command revealed one suspicious processes: IPSHelper with the “start” argument. – That defently took our attention, as we remember this process name from fortigates, not checkpoint.</li>
</ol>
<p>$ ps auxf</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/vvypdrxd/image.png?rmode=max&amp;width=700&amp;height=28" alt="" width="700" height="28"></p>
<p>Network Connections with netstat</p>
<p>Next, we examined the network connections to understand if these processes were communicating externally.</p>
<p>We execute “netstat -antop”:</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/vz1nejyu/image.png?rmode=max&amp;width=731&amp;height=19" alt="" width="731" height="19"></p>
<p>The IPSHelper process was listening on port 58885, which raised further suspicion, and had a live connection to the attacker-controlled server C2</p>
<h4><a name="_Toc171429678"></a><a name="_Toc171030038"></a>Delving Deeper: MeshAgent</h4>
<p>Within this directory, we found the IPSHelper ELF binary to confirm its legitimacy, we compared its hash with the official MeshAgent release from GitHub.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/21lgwzzn/image.png?rmode=max&amp;width=671&amp;height=98" alt="" width="671" height="98"></p>
<p>The hash matched the official release, indicating that the attacker utilized an unmodified version of MeshAgent.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/oxcl2ymx/image.png?rmode=max&amp;width=678&amp;height=156" alt="" width="678" height="156"></p>
<h4><em>Configuration File Inspection</em></h4>
<p>The IPSHelper.msh configuration file provided crucial details about the implant’s operation.</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/f2tb4i3t/image.png?rmode=max&amp;width=558&amp;height=117" alt="" width="558" height="117"></p>
<h4><em>Detailed Breakdown</em></h4>
<p style="margin-left: 31.5pt; text-indent: -.25in; mso-list: l0 level1 lfo1; tab-stops: list 31.5pt;" class="MsoNormal"><!-- [if !supportLists]--><span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;"><span style="mso-list: Ignore;">1. </span></span><!--[endif]--><strong>MeshName=Remote</strong></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Description</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: This parameter defines the name of the mesh network to which the agent belongs. In this instance, it is named "Remote".</span></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Significance</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: The name indicates the agent’s group or network, potentially used for organizational or categorization purposes within the attacker's infrastructure.</span></p>
<p style="margin-left: 31.5pt; text-indent: -.25in; mso-list: l0 level1 lfo1; tab-stops: list 31.5pt;" class="MsoNormal"><!-- [if !supportLists]--><span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;"><span style="mso-list: Ignore;">2. </span></span><!--[endif]--><strong>MeshType=2</strong></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Description</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: This parameter specifies the type of mesh network. The value 2 typically indicates a specific configuration or operational mode defined by the MeshAgent framework.</span></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]--><!--[endif]-->● <strong>Significance</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: Understanding the type helps in assessing the operational characteristics and capabilities of the deployed agent.</span></p>
<p style="margin-left: 31.5pt; text-indent: -.25in; mso-list: l0 level1 lfo1; tab-stops: list 31.5pt;" class="MsoNormal"><!-- [if !supportLists]--><span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;"><span style="mso-list: Ignore;">3. </span></span><!--[endif]--><strong>MeshID=0xAFEEB2DF3591A4320E1860B*****</strong></p>
<p style="margin-left: 31.5pt; text-indent: -.25in; mso-list: l0 level1 lfo1; tab-stops: list 31.5pt;" class="MsoNormal"><!-- [if !supportLists]--><span style="font-size: 10.0pt; mso-bidi-font-size: 11.0pt; line-height: 107%; font-family: 'Courier New'; mso-fareast-font-family: 'Courier New';"><span style="mso-list: Ignore;">      </span></span><strong>● Description</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: This is a unique identifier for the mesh network. It is represented as a hexadecimal string.</span></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]--> ● <!--[endif]--><strong>Significance</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: The MeshID uniquely identifies the network, allowing the attacker to manage and communicate with specific groups of compromised devices.</span></p>
<p style="margin-left: 31.5pt; text-indent: -.25in; mso-list: l0 level1 lfo1; tab-stops: list 31.5pt;" class="MsoNormal"><!-- [if !supportLists]--><span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;"><span style="mso-list: Ignore;">4. </span></span><!--[endif]--><strong>ServerID=310FB318A0A0FF51CF91DA3F5D6******</strong></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Description</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: This parameter provides a unique identifier for the C2 server managing the agent.</span></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Significance</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: The ServerID helps in distinguishing between different C2 servers, which could be crucial for load balancing or redundancy in the attacker’s infrastructure.</span></p>
<p style="margin-left: 31.5pt; text-indent: -.25in; mso-list: l0 level1 lfo1; tab-stops: list 31.5pt;" class="MsoNormal"><!-- [if !supportLists]--><span style="mso-ascii-font-family: Calibri; mso-fareast-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;"><span style="mso-list: Ignore;">5. </span></span><!--[endif]--><strong>MeshServer=wss://api.gupdate.net:443/agent.ashx</strong></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Description</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: This parameter specifies the WebSocket Secure (wss) URL for the Command and Control (C2) server. The agent communicates with the C2 server at api.gupdate.net on port 443, using the path /agent.ashx.</span></p>
<p style="margin-left: 67.5pt; text-indent: -.25in; mso-list: l0 level2 lfo1; tab-stops: list 67.5pt;" class="MsoNormal"><!-- [if !supportLists]-->● <!--[endif]--><strong>Significance</strong><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">: The use of a secure WebSocket (wss) connection ensures encrypted communication between the agent and the C2 server, making it more challenging to intercept and analyze the traffic. The specific URL indicates the endpoint used for managing the compromised device.</span></p>
<p><span style="font-size: 11.0pt; line-height: 107%; font-family: 'Calibri',sans-serif; mso-ascii-theme-font: minor-latin; mso-fareast-font-family: Calibri; mso-fareast-theme-font: minor-latin; mso-hansi-theme-font: minor-latin; mso-bidi-font-family: Arial; mso-bidi-theme-font: minor-bidi; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: AR-SA;"> </span></p>
<p class="MsoNormal">Reviewing the C2, redirected us to a login page, with mesh<span>-central, confirming our findings, and the C2:</span></p>
<p class="MsoNormal"><span><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/i5ldddff/image.png?rmode=max&amp;width=589&amp;height=356" alt="" width="589" height="356"></span></p>
<p class="MsoNormal"><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;">Detections in VirusTotal, for the domain and IP of the C2:</span></p>
<p class="MsoNormal"><span style="mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: Calibri;"><img style="display: block; margin-left: auto; margin-right: auto;" src="/media/1dmjg5rk/image.png?rmode=max&amp;width=563&amp;height=480" alt="" width="563" height="480"></span></p>
<p class="MsoNormal"> </p>
<h3><a name="_Toc171429679"></a>Recommendations</h3>
<h4><a name="_Toc171429680"></a>Incident Response Recommendations</h4>
<p>Tal Raveh, CEO of HackersEye, on the Importance of Specialized Incident Response Teams</p>
<p>"Dealing with advanced persistent threats (APTs) like those from the LilacSquid APT group requires a specialized Incident Response (IR) team," states Tal Raveh, CEO of HackersEye. "A dedicated IR team proficient in investigating Linux-based firewall systems is crucial for identifying, containing, and eradicating hidden threats. Their ability to perform comprehensive forensic analysis ensures a thorough understanding of an attack's scope, which is essential for effective remediation."</p>
<p>"An effective IR team must have advanced tools and methodologies for detection, containment, and eradication of threats," Raveh explains. "Their capability to quickly neutralize sophisticated threats is vital for protecting critical assets. This specialized expertise is indispensable in managing and mitigating complex cyber incidents."</p>
<p>"Engaging a specialized IR team significantly enhances an organization's security posture," Raveh concludes. "It ensures timely and effective response to cyber threats, reinforcing defenses against future attacks. Having a skilled IR team is fundamental for safeguarding against persistent and sophisticated cyber threats."</p>
<p> </p>
<h3><a name="_Toc171429681"></a>Detection, IOCs, and YARA rules:</h3>
<h4><a name="_Toc171429682"></a>YARA Rules for Detection</h4>
<p>To assist in the initial stages of this investigation, we developed YARA rules aimed at detecting the MeshAgent ELF binary and its configuration file out of the box. These rules are specifically tailored for the Check Point firewall's Linux environment. It is important to note that these YARA rules are rudimentary and can be easily evaded by sophisticated attackers. Their primary purpose was to quickly scan and identify potential indicators of compromise at the onset of the incident. As the investigation progressed, these initial detections guided our deeper and more detailed forensic analysis.</p>
<p>rule MeshAgent_ELF<br>{<br>meta:<br>description = "Detects the CheckMesh attack"<br>author = "HackersEye"<br>date = "2024-07-04"<br>strings:<br>$elf_magic = { 7f 45 4c 46 02 01 01 00 }<br>$mesh_string1 = "meshcore/KVM/Linux/linux_kvm.c" ascii<br>$mesh_string2 = "meshcore: %s" ascii<br>$mesh_string3 = "meshcore/agentcore.c" ascii<br>$mesh_string4 = "meshagent" ascii<br>$mesh_string5 = "--meshServiceName=" ascii<br>$mesh_string6 = "/var/run/meshagent.pid" ascii<br>condition:<br>uint32(0) == 0x464c457f and<br>filesize &lt; 10MB and<br>all of ($elf_magic, $mesh_string1, $mesh_string2, $mesh_string3, $mesh_string4,<br>$mesh_string5, $mesh_string6)<br>}</p>
<p> </p>
<h4><em>Msh configuration file yara:</em></h4>
<p>rule MeshAgent_Config<br>{<br>meta:<br>description = "Detects the CheckMesh configuration file"<br>author = "HackersEye"<br>date = "2024-07-04"<br>strings:<br>$config_string1 = "MeshName=Remote" ascii<br>$config_string2 = "MeshType=2" ascii<br>$config_string3 = "MeshID=0x" ascii<br>$config_string4 = "ServerID=" ascii<br>$config_string5 = "MeshServer=wss://" ascii<br>$config_string6 = "\"agent\":\"Agent\"" ascii<br>$config_string7 = "\"install\":\"Install\"" ascii<br>$config_string8 = "\"setup\":\"Setup\"" ascii<br>condition:<br>filesize &lt; 10KB and<br>all of ($config_string1, $config_string2, $config_string3, $config_string4, $config_string5) and<br>any of ($config_string6, $config_string7, $config_string8)<br>}</p>
<h4><em>IOCs:</em></h4>
<div class="blog-table-wrapper">
<table border="1" style="border-collapse: collapse; width: 100%; height: 250px; border-width: 1px; margin-left: auto; margin-right: auto;">
<tbody>
<tr style="height: 34px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 34px;">Type</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 34px;">Value</td>
<td width="634" valign="top" style="width: 32.4611%; border-width: 1px; border-style: solid; padding: 8px; height: 34px;">
<p style="margin-bottom: .0001pt; line-height: normal;" class="MsoNormal">Comments</p>
</td>
</tr>
<tr style="height: 54px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 54px;">IPv4</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 54px;">51[.]16.51.81</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 54px;">SSH Login and Deployment</td>
</tr>
<tr style="height: 36px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 36px;">IPv4</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 36px;">78[.]141.238.182</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 36px;">C2 - MeshCentral</td>
</tr>
<tr style="height: 36px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 36px;">DOMAIN</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 36px;">gupdate[.]net</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 36px;">C2 - MeshCentral</td>
</tr>
<tr style="height: 36px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 36px;">DOMAIN</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 36px;">api[.]gupdate.net</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 36px;">C2 - MeshCentral</td>
</tr>
<tr style="height: 18px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 18px;">MD5</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 18px;">277e376f8e521b5127d45da965a5a43d</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 18px;">MeshAgent</td>
</tr>
<tr style="height: 18px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 18px;">SHA<span>256</span></td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 18px;">1134af27bea8518c62444a56f4bd4bcc95db40a9bb6132688cf31515da08b9aa</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 18px;">Dllhost.exe</td>
</tr>
<tr style="height: 18px;">
<td style="width: 9.78005%; border-width: 1px; padding: 8px; height: 18px;">SHA256</td>
<td style="width: 57.8535%; border-width: 1px; padding: 8px; height: 18px;">3840ACB15880F6CB0A77347D4A3893C5A3FBFCC2167BD5E3F86E2CE0F7CDBF19</td>
<td style="width: 32.4611%; border-width: 1px; padding: 8px; height: 18px;">Dllhost.exe</td>
</tr>
</tbody>
</table>
</div>
<p> </p>
<h3><a name="_Toc171429683"></a>References</h3>
<ul style="margin-top: 0in;">
<li class="MsoNormal" style="mso-list: l0 level1 lfo1; tab-stops: list .5in;">Cisco Talos Blog on LilacSquid: LilacSquid: The stealthy trilogy of PurpleInk, InkBox and InkLoader (<a rel="noopener" href="https://blog.talosintelligence.com/category/apt/" target="_blank">Cisco Talos Blog</a>)​</li>
<li class="MsoNormal" style="mso-list: l0 level1 lfo1; tab-stops: list .5in;">Analysis of MeshAgent Usage: <a href="https://github.com/Ylianst/MeshCentral" target="_new">GitHub - MeshCentral</a></li>
<li class="MsoNormal" style="mso-list: l0 level1 lfo1; tab-stops: list .5in;">Detailed TTPs and Exploit Techniques: <a href="https://attack.mitre.org/">MITRE ATT&amp;CK Framework</a></li>
</ul>
              </p>
            </div>
            <!-- .entry-content -->
          </article>
          <!-- #post-1148 -->
        </div>

        <div class="reblogone-in3">
          <div class="blog-sidebar-title" id="bsbt-linkedin">
            <img loading="lazy"
              src="/assets/uploads/svg/bsb-linkedin.svg"
              alt="title-icon"
            />
            <span>OUR LINKEDIN</span>
          </div>
          <div class="blog-sidebar-linkedin">
            <div class="bsl-header">
              <div class="bsl-header-logo">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  viewBox="0 0 84 21"
                  preserveAspectRatio="xMinYMin meet"
                  version="1.1"
                  focusable="false"
                >
                  <g
                    class="inbug"
                    stroke="none"
                    stroke-width="1"
                    fill="none"
                    fill-rule="evenodd"
                  >
                    <path
                      d="M19.479,0 L1.583,0 C0.727,0 0,0.677 0,1.511 L0,19.488 C0,20.323 0.477,21 1.333,21 L19.229,21 C20.086,21 21,20.323 21,19.488 L21,1.511 C21,0.677 20.336,0 19.479,0"
                      class="bug-text-color"
                      transform="translate(63.000000, 0.000000)"
                    ></path>
                    <path
                      d="M82.479,0 L64.583,0 C63.727,0 63,0.677 63,1.511 L63,19.488 C63,20.323 63.477,21 64.333,21 L82.229,21 C83.086,21 84,20.323 84,19.488 L84,1.511 C84,0.677 83.336,0 82.479,0 Z M71,8 L73.827,8 L73.827,9.441 L73.858,9.441 C74.289,8.664 75.562,7.875 77.136,7.875 C80.157,7.875 81,9.479 81,12.45 L81,18 L78,18 L78,12.997 C78,11.667 77.469,10.5 76.227,10.5 C74.719,10.5 74,11.521 74,13.197 L74,18 L71,18 L71,8 Z M66,18 L69,18 L69,8 L66,8 L66,18 Z M69.375,4.5 C69.375,5.536 68.536,6.375 67.5,6.375 C66.464,6.375 65.625,5.536 65.625,4.5 C65.625,3.464 66.464,2.625 67.5,2.625 C68.536,2.625 69.375,3.464 69.375,4.5 Z"
                      class="background"
                      fill="#fff"
                    ></path>
                  </g>
                  <g class="linkedin-text">
                    <path
                      d="M60,18 L57.2,18 L57.2,16.809 L57.17,16.809 C56.547,17.531 55.465,18.125 53.631,18.125 C51.131,18.125 48.978,16.244 48.978,13.011 C48.978,9.931 51.1,7.875 53.725,7.875 C55.35,7.875 56.359,8.453 56.97,9.191 L57,9.191 L57,3 L60,3 L60,18 Z M54.479,10.125 C52.764,10.125 51.8,11.348 51.8,12.974 C51.8,14.601 52.764,15.875 54.479,15.875 C56.196,15.875 57.2,14.634 57.2,12.974 C57.2,11.268 56.196,10.125 54.479,10.125 L54.479,10.125 Z"
                      fill="#fff"
                    ></path>
                    <path
                      d="M47.6611,16.3889 C46.9531,17.3059 45.4951,18.1249 43.1411,18.1249 C40.0001,18.1249 38.0001,16.0459 38.0001,12.7779 C38.0001,9.8749 39.8121,7.8749 43.2291,7.8749 C46.1801,7.8749 48.0001,9.8129 48.0001,13.2219 C48.0001,13.5629 47.9451,13.8999 47.9451,13.8999 L40.8311,13.8999 L40.8481,14.2089 C41.0451,15.0709 41.6961,16.1249 43.1901,16.1249 C44.4941,16.1249 45.3881,15.4239 45.7921,14.8749 L47.6611,16.3889 Z M45.1131,11.9999 C45.1331,10.9449 44.3591,9.8749 43.1391,9.8749 C41.6871,9.8749 40.9121,11.0089 40.8311,11.9999 L45.1131,11.9999 Z"
                      fill="#fff"
                    ></path>
                    <polygon
                      fill="#fff"
                      points="38 8 34.5 8 31 12 31 3 28 3 28 18 31 18 31 13 34.699 18 38.241 18 34 12.533"
                    ></polygon>
                    <path
                      d="M16,8 L18.827,8 L18.827,9.441 L18.858,9.441 C19.289,8.664 20.562,7.875 22.136,7.875 C25.157,7.875 26,9.792 26,12.45 L26,18 L23,18 L23,12.997 C23,11.525 22.469,10.5 21.227,10.5 C19.719,10.5 19,11.694 19,13.197 L19,18 L16,18 L16,8 Z"
                      fill="#fff"
                    ></path>
                    <path
                      d="M11,18 L14,18 L14,8 L11,8 L11,18 Z M12.501,6.3 C13.495,6.3 14.3,5.494 14.3,4.5 C14.3,3.506 13.495,2.7 12.501,2.7 C11.508,2.7 10.7,3.506 10.7,4.5 C10.7,5.494 11.508,6.3 12.501,6.3 Z"
                      fill="#fff"
                    ></path>
                    <polygon
                      fill="#fff"
                      points="3 3 0 3 0 18 9 18 9 15 3 15"
                    ></polygon>
                  </g>
                </svg>
              </div>
            </div>
            <div class="bsl-body">
              <img loading="lazy"
                class="bsl-avatar"
                src="/assets/uploads/hackerseye-linkedin.jpeg"
                alt="linkedin avatar"
              />
              <span class="bsl-title">HackersEye</span>
              <span class="bsl-subtitle"
                >Computer and Network Security</span
              >
              <a
                target="_blank"
                href="https://il.linkedin.com/company/hackerseye?trk=public_profile_topcard-current-company"
                >View Profile</a
              >
            </div>
          </div>
          <div class="textwidget custom-html-widget">
            








  <div id="umbraco_form_256dbb3370c1487bb78248bc1b9b591f" class="umbraco-forms-form getcybersecuritynewsform cyber-contact-form umbraco-forms-">

<form action="/all-blog-items/checkmesh" enctype="multipart/form-data" id="form5e0edd58883e4c83b282e5d83ff1dabf" method="post"><input data-val="true" data-val-required="The FormId field is required." name="FormId" type="hidden" value="256dbb33-70c1-487b-b782-48bc1b9b591f" /><input data-val="true" data-val-required="The FormName field is required." name="FormName" type="hidden" value="Get Cyber Security News Form" /><input data-val="true" data-val-required="The RecordId field is required." name="RecordId" type="hidden" value="00000000-0000-0000-0000-000000000000" /><input name="PreviousClicked" type="hidden" value="" /><input name="Theme" type="hidden" value="" />      <input type="hidden" name="FormStep" value="0" />
      <input type="hidden" name="RecordState" value="Q2ZESjhGdVVfbE8tS0NwRW1sby1JQWNITHRWS0c5Z2ZfcXZNbW83TXVaT2pRbWVwYXVnZ0Nvc0ZTZzRscHZHSmRUWGYxS3BWcFg0TllOdGNidDNWMDZRZ1ZoNW91ZWJSVFgyRklyVzJDUmdSZEh4MnRiMkhnMmNkcVJwZGlRS2dJQkZYQkE=" />





<div class="umbraco-forms-page" id="092a3eed-d101-42ab-adc1-b32906e6e888">

        <h4 class="umbraco-forms-caption">Get Cyber Security News To Your Email</h4>



        <fieldset class="umbraco-forms-fieldset" id="9bd106bf-0f4a-4bc3-a74f-ea3942092994" >


            <div class="row-fluid">

                    <div class="umbraco-forms-container col-md-12">

                            <div class=" umbraco-forms-field email shortanswer mandatory" >

                                    <label for="c075a794-a3d8-48f9-87e3-03c32c5b4ee5" class="umbraco-forms-label">
                                        Email                                     </label>


                                <div class="umbraco-forms-field-wrapper">

                                    <input type="email" name="c075a794-a3d8-48f9-87e3-03c32c5b4ee5" id="c075a794-a3d8-48f9-87e3-03c32c5b4ee5" data-umb="c075a794-a3d8-48f9-87e3-03c32c5b4ee5" class="text " value="" maxlength="24"
        placeholder="Your email"  data-val="true"  data-val-required="Please provide a value for Email"  data-val-regex="Invalid email!" data-val-regex-pattern="^[a-zA-Z0-9_\.\+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-\.]+$"  />





<span class="field-validation-valid" data-valmsg-for="c075a794-a3d8-48f9-87e3-03c32c5b4ee5" data-valmsg-replace="true"></span>
                                </div>

                            </div>
                            <div class=" umbraco-forms-field recaptcha recaptchav3withscore mandatory alternating" >



                                <div class="umbraco-forms-field-wrapper">

                                    

        <input type="hidden" id="7b659051-5abd-4d84-fa9f-56c9ced56481" name="g-recaptcha-response" />
        <div class="umbraco-forms-recaptcha-v3-config"
            style="display: none"
            data-id="7b659051-5abd-4d84-fa9f-56c9ced56481"
            data-site-key="6Lf-sxkcAAAAAOF7TZ09-aLRyZDUu-nO6crdnJqh"></div>


<span class="field-validation-valid" data-valmsg-for="7b659051-5abd-4d84-fa9f-56c9ced56481" data-valmsg-replace="true"></span>
                                </div>

                            </div>

                    </div>
            </div>

        </fieldset>

    <div style="display: none" aria-hidden="true">
        <input type="text" name="256dbb3370c1487bb78248bc1b9b591f" />
    </div>


    <div class="umbraco-forms-navigation row-fluid">

        <div class="col-md-12">
                <input type="submit"
                       class="btn primary"
                       id="256dbb33-70c1-487b-b782-48bc1b9b591f"
                       value="SUBSCRIBE"
                       name="__next"
                       data-form-navigate="next"
                       data-umb="submit-forms-form" />
        </div>
    </div>
</div>


<div id="umbraco-forms-container">
</div>
<input name="__RequestVerificationToken" type="hidden" value="CfDJ8FuU_lO-KCpEmlo-IAcHLtXJSet9BxJkcVoksEqVCetIBAs-bTd0jktxovX2pxYGUgnBZbayPpU8zrf5pvBRzlKHO5PFTEVEUCFh4S7RTZcKDy26TJLgMXmJ5F1fw1AGnJen94LFLqIwUmqpuUZWIk8" /><input name="ufprt" type="hidden" value="CfDJ8FuU_lO-KCpEmlo-IAcHLtWDpEM7Us-PRQaa_jZXciqigvADnZCxGZvlNJvAo9kZZPlbHmOCDIm83fbcAb7pJdKe1Qn3TCL97GZvr97yshP9KiEzVn75QAIa0B9gTfFqIwVpYUKRUNpgr0qVBSoXLMg" /></form>




<div class="umbraco-forms-form-config"
     style="display: none"
     data-id="256dbb3370c1487bb78248bc1b9b591f"
     data-serialized-page-button-conditions="{}"
     data-serialized-fieldset-conditions="{}"
     data-serialized-field-conditions="{}"
     data-serialized-fields-not-displayed="{}"
     data-trigger-conditions-check-on="change"
     data-form-element-html-id-prefix=""></div>

<script type='application/javascript' src='https://www.google.com/recaptcha/api.js?render=6Lf-sxkcAAAAAOF7TZ09-aLRyZDUu-nO6crdnJqh' defer='defer'></script><script type='application/javascript' src='/App_Plugins/UmbracoForms/Assets/recaptcha.v3.init.min.js' defer='defer'></script><script type='application/javascript' src='/App_Plugins/UmbracoForms/Assets/themes/default/umbracoforms.min.js' defer='defer'></script>  </div>

          </div>
        </div>
      </div>
    </div>
  </main>
</div>
</div>


      <!-- Footer -->
      
      <footer id="colophon" class="site-footer">
        <div class="footer-settings-out"></div>
        <div class="footer-top-out">
          <section
            id="custom_html-2"
            class="widget_text widget widget_custom_html"
          >
            <div class="textwidget custom-html-widget">
              <div class="footer-contact-image">
                <img loading="lazy" src="/assets/uploads/footer-logo.png" />
              </div>
              <div class="footer-contact-1">
                <div class="footer-contact-1-title">Phone:</div>
                <p><a href="tel:+972545423725">+972 54 542 3725</a></p>
              </div>
              <div class="footer-contact-2">
                <div class="footer-contact-1-title">Email:</div>
                <p>
                  <a href="/cdn-cgi/l/email-protection#511e3737383234113930323a3423223428347f3f3425"><span class="__cf_email__" data-cfemail="024d64646b6167426a636169677071677b672c6c6776">[email&#160;protected]</span></a
                  >
                </p>
              </div>
              <div class="footer-contact-3">
                <div class="footer-contact-soc-1">
                  <a
                    href="https://il.linkedin.com/company/hackerseye"
                    target="_blank"
                  >
                    <img loading="lazy" src="/assets/uploads/footer-soc-in.png" />
                  </a>
                </div>
                <div class="footer-contact-soc-2">
                  <a href="https://twitter.com/hackerseye13" target="_blank">
                    <img loading="lazy" src="/assets/uploads/footer-soc-tw.png" />
                  </a>
                </div>
              </div>
              <div class="footer-contact-2">
                <div class="footer-contact-1-title">Memeber Of:</div>
                <p class="footer_bottom_image">
                  <img loading="lazy" src="/assets/uploads/Israel-cyber-white.png" />
                </p>
              </div>
            </div>
          </section>
          <section id="nav_menu-2" class="widget">
            <h2 class="widget-title">Site Map</h2>
            <div class="menu-sitemap-nav-container">
              <ul id="menu-sitemap-nav" class="menu">
                <li
                  id="menu-item-53"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-53"
                >
                  <a href="/hackersrange">Hackers Range</a>
                </li>
                <li
                  id="menu-item-52"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-52"
                >
                  <a href="/about-us">About Us</a>
                </li>
                <li
                  id="menu-item-51"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-51"
                >
                  <a href="/blog">Blog</a>
                </li>
                <li
                  id="menu-item-50"
                  class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"
                >
                  <a href="/contact">Contact</a>
                </li>
              </ul>
            </div>
          </section>
          <section id="nav_menu-3" class="widget">
            <h2 class="widget-title">Services</h2>
            <div class="menu-footer-services-nav-container">
              <ul id="menu-footer-services-nav" class="menu">
                <li
                  id="menu-item-56"
                  class="menu-item menu-item-type-post_type menu-item-object-services menu-item-56"
                >
                  <a href="/services/blue-team">Blue Team</a>
                </li>
                <li
                  id="menu-item-57"
                  class="menu-item menu-item-type-post_type menu-item-object-services menu-item-57"
                >
                  <a href="/services/cyber-intelligence"
                    >Cyber Intelligence</a
                  >
                </li>
                <li
                  id="menu-item-58"
                  class="menu-item menu-item-type-post_type menu-item-object-services menu-item-58"
                >
                  <a href="/services/red-team">Red Team</a>
                </li>
                <li
                  id="menu-item-59"
                  class="menu-item menu-item-type-post_type menu-item-object-services menu-item-59"
                >
                  <a href="/services/security-consulting"
                    >Security Consulting</a
                  >
                </li>
                <li
                  id="menu-item-60"
                  class="menu-item menu-item-type-post_type menu-item-object-services menu-item-60"
                >
                  <a href="/services/soc-consulting">SOC Consulting</a>
                </li>
                <li
                  id="menu-item-61"
                  class="menu-item menu-item-type-post_type menu-item-object-services menu-item-61"
                >
                  <a href="/services/social-engineering"
                    >Social Engineering</a
                  >
                </li>
              </ul>
            </div>
          </section>
          <section
            id="custom_html-5"
            class="widget_text widget widget_custom_html"
          >
            <h2 class="widget-title">Demo</h2>
            <div class="textwidget custom-html-widget">
              <div class="footer-demo-text-desc">
                Want to see our product in action? <br />Join us for a Demo!
              </div>
              <div class="footer-demo-text-button">
                <a href="/hackersrange" class="footer-demo-a">
                  <span>Get a Demo</span>
                  <img loading="lazy" src="/assets/uploads/form-send-arrow.png" />
                </a>
              </div>
            </div>
          </section>
        </div>
        <div class="footer-copyright">
          <div class="copycopy">
            <div>
              <div>
                2020-2024 All rights reserved. Hackers Eye.
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>
    <!-- Fixed menu Script -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="/js/fixedMenuScript.js"></script>
    <!-- Header script -->
    <script src="/js/shadeHeader.js"></script>
    <!-- AOS init script -->
    <script>
      AOS.init({
        duration: 1200,
      });
    </script>
    <script>
    $(document).ready(() => {
  
  function ourUmbracoFormsIntlTelInput(fieldId, enableIPBasedCountry, initialCountry, autoPlaceholder, ipInfoKey, placeholderType, preferredCountries, onlyCountries) {

      var input = document.getElementById(fieldId);
      var intlTelInputOptions = {};        
      intlTelInputOptions.utilsScript = "/App_Plugins/Our.Umbraco.Forms.IntlTelInput/js/utils.js";    
      intlTelInputOptions.initialCountry = initialCountry;
    
    
      if (autoPlaceholder) {
          intlTelInputOptions.autoPlaceholder = "aggressive";
      }
    
      if (placeholderType) {
          intlTelInputOptions.placeholderNumberType = placeholderType;
      }
    
      if (preferredCountries) {
          intlTelInputOptions.preferredCountries = preferredCountries;
      }
    
      if (onlyCountries) {
          intlTelInputOptions.onlyCountries = onlyCountries;
      }
    
      var iti = intlTelInput(input, intlTelInputOptions);
      var output = document.querySelector("#" + fieldId);    
    
      var handleChange = function () {
          // var number = (iti.isValidNumber()) ? iti.getNumber() : "";    
          var number = (iti.isValidNumber()) ;    
          var cc = iti.getSelectedCountryData().iso2;              
          input.setAttribute('data-intl-input-cc', cc);
          if(number != false){
          output.value = iti.getNumber().replace("+","");
          }
          
      };
      
      input.addEventListener('change', handleChange);
      input.addEventListener('countrychange', handleChange);
      input.addEventListener('keyup', handleChange);
    }

    function FixNumber() {
      const ipInfoKey = "71d027e08bc3d8";
      let geoIpLookupfix;
      const fieldIds = $('input[type="tel"]');
    
      // Load the country codes JSON file
      $.getJSON("/country.json")
        .done(function(countryCodes) {
          fieldIds.each(function() {
          let fieldId = this.id;
          let selectID; // Declare selectID here, within the each loop
          let selectElement = $(this).closest('form').find(".umbraco-forms-field-wrapper select");
          selectElement.each(function() {
            if (this.length > 235) {
              selectID = this.id;
            }
          });
            $.ajax({
              url: "https://ipinfo.io/json?token=" + ipInfoKey,
              dataType: "json"
            }).then(function(resp) {
              geoIpLookupfix = (resp.country) ? resp.country.toUpperCase() : "GB";
    
              // Search for the country name in the countryCodes array
              const countryCode = countryCodes.find(code => Object.keys(code)[0] === geoIpLookupfix);
              const countryName = (countryCode) ? countryCode[geoIpLookupfix] : "Select your country";
              $(`#${selectID}`).val(countryName);
              ourUmbracoFormsIntlTelInput(fieldId, false, geoIpLookupfix, false, "71d027e08bc3d8", '', null, null);
            }).catch(function() {
              // Handle the error if the request fails
              console.log("Error occurred during AJAX request.");
            });
          });
        })
        .fail(function() {
          // Handle the error if the JSON file fails to load
          console.log("Error occurred during loading country2.json.");
        });
    }
    
    FixNumber();
});
</script>
  </body>
</html>
