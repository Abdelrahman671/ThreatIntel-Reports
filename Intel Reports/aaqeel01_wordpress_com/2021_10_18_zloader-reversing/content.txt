<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://aaqeel01.wordpress.com/xmlrpc.php">

<title>Zloader Reversing &#8211; Malware Analysis</title>
<script type="text/javascript">
  WebFontConfig = {"google":{"families":["Courier+Prime:r:latin,latin-ext","Lato:r,i,b,bi:latin,latin-ext"]},"api_url":"https:\/\/fonts-api.wp.com\/css"};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active body, .wf-active button, .wf-active input, .wf-active select, .wf-active textarea{font-family:"Lato",sans-serif}.wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-weight:400;font-family:"Courier Prime",monospace;font-style:normal}.wf-active h1{font-style:normal;font-weight:400}.wf-active h2{font-style:normal;font-weight:400}.wf-active h3{font-style:normal;font-weight:400}.wf-active h4{font-style:normal;font-weight:400}.wf-active h5{font-style:normal;font-weight:400}.wf-active h6{font-style:normal;font-weight:400}.wf-active .entry-title{font-style:normal;font-weight:400}.wf-active .front-testimonials .hentry .entry-title{font-style:normal;font-weight:400}.wf-active .recent-posts .recent-posts-title{font-weight:400;font-style:normal}.wf-active .recent-posts .entry-title{font-style:normal;font-weight:400}.wf-active .site-title{font-family:"Courier Prime",monospace;font-weight:400;font-style:normal}.wf-active .comment-reply-title, .wf-active .comments-title{font-style:normal;font-weight:400}.wf-active .widget-title{font-style:normal;font-weight:400}.wf-active .site-content .full-width-widget-area .widget-title{font-weight:400;font-style:normal}@media screen and (min-width: 768px){.wf-active .site-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .front-testimonials .hentry .entry-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .recent-posts .recent-posts-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .recent-posts .entry-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .entry-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .widget-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .site-content .full-width-widget-area .widget-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .comment-reply-title, .wf-active .comments-title{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h1{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h2{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h3{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h4{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h5{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active h6{font-style:normal;font-weight:400}}@media screen and (min-width: 768px){.wf-active .sticking .site-title{font-style:normal;font-weight:400}}</style>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//wordpress.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel='dns-prefetch' href='//af.pubmine.com' />
<link rel='dns-prefetch' href='//s.pubmine.com' />
<link rel='dns-prefetch' href='//x.bidswitch.net' />
<link rel='dns-prefetch' href='//static.criteo.net' />
<link rel='dns-prefetch' href='//ib.adnxs.com' />
<link rel='dns-prefetch' href='//aax.amazon-adsystem.com' />
<link rel='dns-prefetch' href='//bidder.criteo.com' />
<link rel='dns-prefetch' href='//cas.criteo.com' />
<link rel='dns-prefetch' href='//gum.criteo.com' />
<link rel='dns-prefetch' href='//ads.pubmatic.com' />
<link rel='dns-prefetch' href='//gads.pubmatic.com' />
<link rel='dns-prefetch' href='//tpc.googlesyndication.com' />
<link rel='dns-prefetch' href='//ad.doubleclick.net' />
<link rel='dns-prefetch' href='//googleads.g.doubleclick.net' />
<link rel='dns-prefetch' href='//www.googletagservices.com' />
<link rel='dns-prefetch' href='//cdn.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.g.switchadhub.com' />
<link rel='dns-prefetch' href='//delivery.swid.switchadhub.com' />
<link rel='dns-prefetch' href='//a.teads.tv' />
<link rel='dns-prefetch' href='//prebid.media.net' />
<link rel='dns-prefetch' href='//adserver-us.adtech.advertising.com' />
<link rel='dns-prefetch' href='//fastlane.rubiconproject.com' />
<link rel='dns-prefetch' href='//prebid-server.rubiconproject.com' />
<link rel='dns-prefetch' href='//hb-api.omnitagjs.com' />
<link rel='dns-prefetch' href='//mtrx.go.sonobi.com' />
<link rel='dns-prefetch' href='//apex.go.sonobi.com' />
<link rel='dns-prefetch' href='//u.openx.net' />
<link rel="alternate" type="application/rss+xml" title="Malware Analysis &raquo; Feed" href="https://aaqeel01.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Malware Analysis &raquo; Comments Feed" href="https://aaqeel01.wordpress.com/comments/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s2.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1719498190i&ver=6.8-alpha-59438"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s0.wp.com/_static/??-eJx9zt0KwjAMBeAXsoZVRHYhPku2htI1/aHJGHt7qzc6BC+T8+UQ2KqZS1bKChMXbyqvPmSBrTSHTsBzmZDPs8gJvmxaPzI4TypAa09LDGQYN1BKlVFJQHRn+lfAIXa2kFaco3lPP/zwW8IWSUP2ZsIGnR43r+NHug83O17teBns8gRW61Vc&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJydzEEOAiEMheELCXUGE3VhPAswpOmIQNqi4faObty5cPny8v3wbCbWoqkotNyRigD2bYbEuD2c4DGd7cnuIXTKC4Rc481kCux5gOjIyUaRHfwMfZTAmrT5N/ejdjXItPybYK9UUL78er9MR+fcfHCzW185xE/S&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-6-1' href='https://s2.wp.com/wp-content/plugins/coblocks/2.18.1-simple-rev.4/dist/coblocks-style.css?m=1681832297i&cssminify=yes' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #333333;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--medium-gray: #999999;--wp--preset--color--light-gray: #dddddd;--wp--preset--color--purple: #6636cc;--wp--preset--color--dark-purple: #471e9e;--wp--preset--color--green: #85cc36;--wp--preset--color--dark-green: #609d1b;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s2.wp.com/_static/??-eJzTLy/QTc7PK0nNK9HPLdUtyClNz8wr1k/Oz80FCunmZGanAnnFaCJ6QBEd/Uz9vPySTKDuYjgDIoFkZklGai7QhILSJP3sxKLSvET94pLKnFQi1CXl5Cdngw20z7U1NDcyMTc2MDI1zAIAixJBiQ==&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='karuna-fonts-css' href='https://fonts-api.wp.com/css?family=Karla%3A400%2C400italic%2C700%2C700italic&#038;subset=latin%2Clatin-ext' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s0.wp.com/_static/??-eJx9jsEKwjAQRH/IuFSq6EH8FEnDGtMmuyG7ofj3puAhoHibB/OGgTUbx6RICqmaHKsPJDCjZuuWD0NiJrgHcuCRsIRmyO+4dyI76Eb1iQkFcp1gsaWShW1G9BXRrNlx+jK6GwWnyL5FD63V4T/JI5vIzmpop3swj2hD2dRbug6n83E4XMZxnN+TT2Ey&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
@import url('https://fonts-api.wp.com/css?family=Raleway:thin,extralight,light,regular,medium,semibold,bold,italic,bolditalic,extrabold,black|Cabin:thin,extralight,light,regular,medium,semibold,bold,italic,bolditalic,extrabold,black|');:root { --font-headings: Cabin; --font-base: Raleway; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-14-1' href='https://s2.wp.com/_static/??-eJyNjcEKwjAQRH/IuA1aehI/ReImJKmb3eAmFP9eW3oRL16GeTC8gaUaFG6BG5RuKvWYWWEOrTp87AxFZA3fKShocs/gnfevrWaOR1Q9wP+mW2YEFcyODEkU/YIfW0uhfH7TGSLJ3dE6uJaLneww2mkYT/MbUOlJHA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"187688745","postID":"822","siteURL":"http:\/\/aaqeel01.wordpress.com","xhrURL":"https:\/\/aaqeel01.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"c432faa6c1","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/pcHwpP-dg","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s1.wp.com/_static/??/wp-content/js/rlt-proxy.js,/wp-content/blog-plugins/wordads-classes/js/cmp/v2/cmp-non-gdpr.js?m=1720530689j'></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://aaqeel01.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/" />
<link rel='shortlink' href='https://wp.me/pcHwpP-dg' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Faaqeel01.wordpress.com%2F2021%2F10%2F18%2Fzloader-reversing%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Faaqeel01.wordpress.com%2F2021%2F10%2F18%2Fzloader-reversing%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Zloader Reversing" />
<meta property="og:url" content="https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/" />
<meta property="og:description" content="Aka: ZeusLoader, Deloader, Terdot, Zbot is a malware family that downloads Zeus OpenSSL. Parts of the source code of Zeus were leaked back in 2010 [1] and since couple of versions been forked. Each…" />
<meta property="article:published_time" content="2021-10-18T15:44:56+00:00" />
<meta property="article:modified_time" content="2021-10-18T20:14:21+00:00" />
<meta property="og:site_name" content="Malware Analysis" />
<meta property="og:image" content="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=1200" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="639" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:text:title" content="Zloader Reversing" />
<meta name="twitter:image" content="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel="search" type="application/opensearchdescription+xml" href="https://aaqeel01.wordpress.com/osd.xml" title="Malware Analysis" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="application-name" content="Malware Analysis" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="description" content="Aka: ZeusLoader, Deloader, Terdot, Zbot is a malware family that downloads Zeus OpenSSL. Parts of the source code of Zeus were leaked back in 2010 [1] and since couple of versions been forked. Each of the version has its malicious capabilities, but all in common do info stealing specially banking information. Zeus in its core&hellip;" />
<script type="text/javascript">
/* <![CDATA[ */
var wa_smart = { 'network_id': 3905, 'site_id': 474853, 'page_id': 1572546, 'blog_id': 187688745, 'post_id': 822, 'theme': 'pub/karuna', 'target': 'wp_blog_id=187688745;language=en', '_': { 'title': 'Advertisement', 'privacy_settings': 'Privacy Settings' }, 'top': { 'enabled': false, 'adflow_enabled': true, 'format_id': 135099 }, 'inline': { 'enabled': true, 'adflow_enabled': true, 'format_id': 110354, 'max_slots': 20, 'max_blaze_slots': 20 }, 'belowpost': { 'enabled': false, 'adflow_enabled': true, 'format_id': 134071 }, 'bottom_sticky': { 'enabled': false, 'adflow_enabled': true, 'format_id': 117571 }, 'sidebar': { 'enabled': false, 'adflow_enabled': true, 'format_id': 134686 }, 'sidebar_sticky_right': { 'enabled': false, 'adflow_enabled': true, 'format_id': 135281 }, 'gutenberg_rectangle': { 'enabled': false, 'adflow_enabled': true, 'format_id': 134788 }, 'gutenberg_leaderboard': { 'enabled': false, 'adflow_enabled': true, 'format_id': 135073 }, 'gutenberg_mobile_leaderboard': { 'enabled': false, 'adflow_enabled': true, 'format_id': 135098 }, 'gutenberg_skyscraper': { 'enabled': false, 'adflow_enabled': true, 'format_id': 135088 }, 'sidebar_widget_mediumrectangle': { 'enabled': false, 'adflow_enabled': true, 'format_id': 137624 }, 'sidebar_widget_leaderboard': { 'enabled': false, 'adflow_enabled': true, 'format_id': 137625 }, 'sidebar_widget_wideskyscraper': { 'enabled': false, 'adflow_enabled': true, 'format_id': 137626 } }; wa_smart.cmd = [];
/* ]]> */
</script>
		<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { 'pt': 1, 'ht': 0, 'tn': 'karuna', 'uloggedin': 0, 'amp': false, 'consent': __ATA_CC(), 'gdpr_applies': false, 'ad': { 'label': { 'text': 'Advertisements' }, 'reportAd': { 'text': 'Report this ad' } }, 'disabled_slot_formats': [ 'IAD' ], 'siteid': 8982, 'blogid': 187688745 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b&&b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;window.__ATA.cmd=v.cmd||[];v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script>	<script>
		var sas_fallback = sas_fallback || [];
		sas_fallback.push(
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 120,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'belowpost' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 310,formFactor: \'001\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'inline' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 140,formFactor: \'003\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'sidebar' },
			{ tag: "&lt;div id=&quot;atatags-26942-{{unique_id}}&quot;&gt;&lt;/div&gt;&lt;script&gt;__ATA.cmd.push(function() {__ATA.initDynamicSlot({id: \'atatags-26942-{{unique_id}}\',location: 110,formFactor: \'002\',label: {text: \'Advertisements\',},creative: {reportAd: {text: \'Report this ad\',},privacySettings: {text: \'Privacy\',}}});});&lt;/script&gt;", type: 'top' }
		);
	</script>		<script type="text/javascript">

			window.doNotSellCallback = function() {

				var linkElements = [
					'a[href="https://wordpress.com/?ref=footer_blog"]',
					'a[href="https://wordpress.com/?ref=footer_website"]',
					'a[href="https://wordpress.com/?ref=vertical_footer"]',
					'a[href^="https://wordpress.com/?ref=footer_segment_"]',
				].join(',');

				var dnsLink = document.createElement( 'a' );
				dnsLink.href = 'https://wordpress.com/advertising-program-optout/';
				dnsLink.classList.add( 'do-not-sell-link' );
				dnsLink.rel = 'nofollow';
				dnsLink.style.marginLeft = '0.5em';
				dnsLink.textContent = 'Do Not Sell or Share My Personal Information';

				var creditLinks = document.querySelectorAll( linkElements );

				if ( 0 === creditLinks.length ) {
					return false;
				}

				Array.prototype.forEach.call( creditLinks, function( el ) {
					el.insertAdjacentElement( 'afterend', dnsLink );
				});

				return true;
			};

		</script>
		<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_gat._anonymizeIp']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script>
</head>

<body class="post-template-default single single-post postid-822 single-format-standard wp-embed-responsive customizer-styles-applied no-sidebar jetpack-reblog-enabled has-marketing-bar has-marketing-bar-theme-karuna">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header" role="banner">

		<div class="top-bar">
	<div class="top-bar-wrapper">
		
			</div><!-- .top-bar-wrapper -->
</div><!-- .top-bar -->
		<div class="sticky-wrapper">
	<div class="site-branding-wrapper">
		<div class="site-branding">
										<p class="site-title"><a href="https://aaqeel01.wordpress.com/" rel="home">Malware Analysis</a></p>
					</div><!-- .site-branding -->

		<nav id="site-navigation" class="main-navigation" role="navigation">
	<button class="menu-toggle" aria-controls="top-menu" aria-expanded="false"><span class="genericon genericon-menu"></span>Menu</button>
	<div class="menu-primary-container"><ul id="top-menu" class="menu"><li id="menu-item-13" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-13"><a href="https://aaqeel01.wordpress.com/">Home</a></li>
<li id="menu-item-102" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-102"><a href="https://aaqeel01.wordpress.com/blog/posts/">Blog Posts</a></li>
</ul></div></nav><!-- #site-navigation -->
			</div><!-- .site-branding-wrapper -->
</div><!-- .sticky-wrapper -->
					<img width="1712" height="911" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=1712" class="attachment-karuna-hero size-karuna-hero wp-post-image" alt="" decoding="async" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png 1712w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=768 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=1024 1024w" sizes="(max-width: 1712px) 100vw, 1712px" data-attachment-id="907" data-permalink="https://aaqeel01.wordpress.com/zloader-malware/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png" data-orig-size="1712,911" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="zloader malware" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zloader-malware.png?w=685" />		
		
	</header>
	<div id="content" class="site-content">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-822" class="post-822 post type-post status-publish format-standard has-post-thumbnail hentry category-uncategorized tag-malware-analysis tag-reverse-engineering tag-zloader">
	
	<header class="entry-header">
		<h1 class="entry-title">Zloader Reversing</h1>				<div class="entry-meta">
			<span class="posted-on"><a href="https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/" rel="bookmark"><time class="entry-date published" datetime="2021-10-18T18:44:56+03:00">October 18, 2021</time><time class="updated" datetime="2021-10-18T23:14:21+03:00">October 18, 2021</time></a></span><span class="byline"> by <span class="author vcard"><a class="url fn n" href="https://aaqeel01.wordpress.com/author/alialmemar/">Ali Aqeel</a></span></span><span class="cat-links">, posted in <a href="https://aaqeel01.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a></span>		</div><!-- .entry-meta -->			</header>
	<div class="entry-content">
		
<p></p>



<p>Aka: ZeusLoader, Deloader, Terdot, Zbot is a malware family that downloads Zeus OpenSSL. Parts of the source code of Zeus were leaked back in 2010 <a rel="noreferrer noopener" href="https://github.com/Visgean/Zeus" target="_blank">[1]</a> and since couple of versions been forked. Each of the version has its malicious capabilities, but all in common do info stealing specially banking information. Zeus in its core does wild stuff from stealing HTTPS session before being encrypted; to split&nbsp; stolen data and send it in multiple channels over different C2 server based on the stolen info-type <a rel="noreferrer noopener" href="https://www.honeynet.it/wp-content/uploads/Papers/04-Titans%20revenge.pdf" target="_blank">[2]</a>. The sent data is being encrypted using RC4 algorithm. Given that major parts of the Zeus being well known and very detectable by almost every AV; Zloader is not just a loader/packer to Zeus core functionality. There are some complicated obfuscation techniques and visual encryption implemented on every single unpacked version of Zloader that bypass security and difficulty extracting configuration. Uncommon attack vector like using Google AdSense has been observed lately<a rel="noreferrer noopener" href="https://www.sentinelone.com/labs/hide-and-seek-new-zloader-infection-chain-comes-with-improved-stealth-and-evasion-mechanisms/" target="_blank"> [3]</a> also attacker signs Zloader with a certificate compromised from legitimate software in order to evade detection. In this post, we gonna take a look of common Zloader <em>123 botnet </em>attack that uses maldoc vector. Quickly analyze maldoc, downloader, and the well known unpacking technique with observed behavior which simple and not quite interesting. However, the second part is going to be deep dive into analyzing and reversing techniques of Zloader unpacked version.</p>



<p class="has-large-font-size"><strong>Maldoc</strong></p>



<p><strong>SHA256 </strong>500856ee3fc13326cad564894a0423e0583154ef10531de4ab6e6d5df90d4e31</p>



<p><strong>File Type</strong> Office Open XML Spreadsheet</p>



<p><strong>Name</strong> tn4598151.xlsm</p>



<p><strong>Size </strong>182.62 KB (187002 bytes)</p>



<p><strong>Creation Time </strong>2021-10-04 13:17:51</p>



<p><strong>Links </strong><a href="https://bazaar.abuse.ch/sample/500856ee3fc13326cad564894a0423e0583154ef10531de4ab6e6d5df90d4e31/" target="_blank" rel="noreferrer noopener">MalwareBazaar</a>,&nbsp;<a href="https://www.virustotal.com/gui/file/500856ee3fc13326cad564894a0423e0583154ef10531de4ab6e6d5df90d4e31/details" target="_blank" rel="noreferrer noopener">VirusTotal</a>, <a href="https://app.any.run/tasks/983208f5-e42d-4127-ab76-022f4e6ce4bb/" target="_blank" rel="noreferrer noopener">Any.run</a></p>



<p>In clear text on sheet2, the maldoc give away downloader URL, directory where it’s been dropped, and shell command to run a Dll which is the Zloader.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-1 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="824" data-permalink="https://aaqeel01.wordpress.com/2-figure-2-xlsx-sheet-2/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png" data-orig-size="1015,162" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2.-figure-2-xlsx-sheet-2-" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png?w=685" width="1015" height="162" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png" alt="" data-id="824" class="wp-image-824" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png 1015w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png?w=150&amp;h=24 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png?w=300&amp;h=48 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-xlsx-sheet-2-.png?w=768&amp;h=123 768w" sizes="(max-width: 1015px) 100vw, 1015px" /></figure></li></ul></figure>



<p>Enable macro is required to run the above in VBA script.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-2 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="826" data-permalink="https://aaqeel01.wordpress.com/1-figure-1-macro/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png" data-orig-size="1478,773" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1.-figure-1-macro" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png?w=685" loading="lazy" width="1478" height="773" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png" alt="" data-id="826" data-link="https://aaqeel01.wordpress.com/1-figure-1-macro/" class="wp-image-826" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png 1478w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png?w=150&amp;h=78 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png?w=300&amp;h=157 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png?w=768&amp;h=402 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1.-figure-1-macro.png?w=1024&amp;h=536 1024w" sizes="(max-width: 1478px) 100vw, 1478px" /></figure></li></ul></figure>



<p>Downloaded <em>test.dll</em> is just an HTML! that downloads <em>logs.php</em> which is a Zloader Dll file!</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-3 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="828" data-permalink="https://aaqeel01.wordpress.com/3-figure-3-downloader/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png" data-orig-size="931,712" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="3.-figure-3-downloader" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png?w=685" loading="lazy" width="931" height="712" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png" alt="" data-id="828" data-link="https://aaqeel01.wordpress.com/3-figure-3-downloader/" class="wp-image-828" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png 931w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png?w=150&amp;h=115 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png?w=300&amp;h=229 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-figure-3-downloader.png?w=768&amp;h=587 768w" sizes="(max-width: 931px) 100vw, 931px" /></figure></li></ul></figure>



<p class="has-large-font-size"><strong>Dll</strong> Zloader</p>



<p><strong>SHA256 </strong>c4ab81d7b7d44dd6dfc4f2b69dbe3f22fbf23c1ae49ab8edac2d26f85ae4514d</p>



<p><strong>File Type</strong> Win32 DLL</p>



<p><strong>Names</strong> suqyatda.dll, ewviv.dll, ehev.dll, cyvi.dll, logs.php</p>



<p><strong>Size </strong>1.13 MB (1189888 bytes)</p>



<p><strong>Compiler Time-stamp </strong>Mon Sep 23 01:29:14 2019</p>



<p><strong>First Submission </strong>2021-10-04 18:23:00</p>



<p><strong>Links </strong><a href="https://bazaar.abuse.ch/sample/c4ab81d7b7d44dd6dfc4f2b69dbe3f22fbf23c1ae49ab8edac2d26f85ae4514d/" target="_blank" rel="noreferrer noopener">MalwareBazaar</a>,&nbsp;<a href="https://www.virustotal.com/gui/file/c4ab81d7b7d44dd6dfc4f2b69dbe3f22fbf23c1ae49ab8edac2d26f85ae4514d">VirusTotal</a>, <a href="https://tria.ge/s?q=c4ab81d7b7d44dd6dfc4f2b69dbe3f22fbf23c1ae49ab8edac2d26f85ae4514d" target="_blank" rel="noreferrer noopener">Tria.ge</a></p>



<p>Zloader Dll file is been downloaded and runned in temp location. After Zloader runs:</p>



<ol class="wp-block-list" type="1"><li>Create new process <em>msiexec.exe</em> and inject its loader in it.</li><li>Loader sets new registry values using random hive and key names in: <ul><li>HKCU\Software\Mircosoft\<em>bbxk</em>\uuwk</li><li>HKCU\Software\Mircosoft\<em>bbxk</em>\ziox </li></ul></li><li>Deletes original downloader and copy itself to %AppData%\Roaming\*random name\*.dll</li></ol>



<p>The registry value calls the new directory for persistent in case of host rebooted.&nbsp; Both registry values are encrypted with RC4 but more to that in next section</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-4 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="830" data-permalink="https://aaqeel01.wordpress.com/3-behavior/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png" data-orig-size="1431,309" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="3.-behavior" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png?w=685" loading="lazy" width="1431" height="309" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png" alt="" data-id="830" class="wp-image-830" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png 1431w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png?w=150&amp;h=32 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png?w=300&amp;h=65 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png?w=768&amp;h=166 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.-behavior.png?w=1024&amp;h=221 1024w" sizes="(max-width: 1431px) 100vw, 1431px" /></figure></li></ul></figure>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-5 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="832" data-permalink="https://aaqeel01.wordpress.com/2-figure-2-delete-itself/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png" data-orig-size="1100,409" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2.-figure-2-delete-itself" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png?w=685" loading="lazy" width="1100" height="409" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png" alt="" data-id="832" data-link="https://aaqeel01.wordpress.com/2-figure-2-delete-itself/" class="wp-image-832" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png 1100w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png?w=150&amp;h=56 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png?w=300&amp;h=112 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png?w=768&amp;h=286 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.-figure-2-delete-itself.png?w=1024&amp;h=381 1024w" sizes="(max-width: 1100px) 100vw, 1100px" /></figure></li></ul></figure>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-2 is-cropped wp-block-gallery-6 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="833" data-permalink="https://aaqeel01.wordpress.com/4-process/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png" data-orig-size="1244,458" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="4.-process" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png?w=685" loading="lazy" width="1244" height="458" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png" alt="" data-id="833" data-link="https://aaqeel01.wordpress.com/4-process/" class="wp-image-833" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png 1244w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png?w=150&amp;h=55 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png?w=300&amp;h=110 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png?w=768&amp;h=283 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4.-process.png?w=1024&amp;h=377 1024w" sizes="(max-width: 1244px) 100vw, 1244px" /></figure></li><li class="blocks-gallery-item"><figure><img data-attachment-id="836" data-permalink="https://aaqeel01.wordpress.com/5-persistent/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png" data-orig-size="1081,466" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="5.-persistent" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png?w=685" loading="lazy" width="1081" height="466" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png" alt="" data-id="836" data-link="https://aaqeel01.wordpress.com/5-persistent/" class="wp-image-836" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png 1081w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png?w=150&amp;h=65 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png?w=300&amp;h=129 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png?w=768&amp;h=331 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.-persistent.png?w=1024&amp;h=441 1024w" sizes="(max-width: 1081px) 100vw, 1081px" /></figure></li></ul><figcaption class="blocks-gallery-caption">Running Process and Registry Value change</figcaption></figure>



<p>When checking memory strings for any forensics it spells out great number of C2 values. Noticed that 20 URLs has random name with fixed length. Those are called Domain Generated Algorithm DGA, unlike hardcode C2 URLs those are queried during running. More to that later in next section.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-7 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="837" data-permalink="https://aaqeel01.wordpress.com/urls/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png" data-orig-size="924,562" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="urls" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png?w=685" loading="lazy" width="924" height="562" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png" alt="" data-id="837" data-link="https://aaqeel01.wordpress.com/urls/" class="wp-image-837" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png 924w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png?w=150&amp;h=91 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png?w=300&amp;h=182 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/urls.png?w=768&amp;h=467 768w" sizes="(max-width: 924px) 100vw, 924px" /></figure></li></ul></figure>



<p>Using <em>pe-sieve64</em> tool is good way to dump the unpacked Zloader from the running process which is valid PE file to be analyzed. However, just a quick debugging would give same result. In SquirrelWaffle and QakBot recent analysis <a href="https://elis531989.medium.com/the-squirrel-strikes-back-analysis-of-the-newly-emerged-cobalt-strike-loader-squirrelwaffle-937b73dbd9f9" target="_blank" rel="noreferrer noopener">[4]</a> <a href="https://twitter.com/aaqeel87/status/1443255927000424449?s=20" target="_blank" rel="noreferrer noopener">[5]</a> it’s been observed that Zloader among other malwares are using same crypters/decryptor for unpacking mechanism for their loaders before injecting them in process. Following the same debugging method in <a href="https://elis531989.medium.com/the-squirrel-strikes-back-analysis-of-the-newly-emerged-cobalt-strike-loader-squirrelwaffle-937b73dbd9f9" target="_blank" rel="noreferrer noopener">[4]</a> would reveal the packed Zloader.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-8 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="839" data-permalink="https://aaqeel01.wordpress.com/loop/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png" data-orig-size="1212,849" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="loop" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png?w=685" loading="lazy" width="1212" height="849" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png" alt="" data-id="839" data-link="https://aaqeel01.wordpress.com/loop/" class="wp-image-839" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png 1212w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png?w=150&amp;h=105 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png?w=300&amp;h=210 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png?w=768&amp;h=538 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/loop.png?w=1024&amp;h=717 1024w" sizes="(max-width: 1212px) 100vw, 1212px" /></figure></li></ul></figure>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-9 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="840" data-permalink="https://aaqeel01.wordpress.com/decrypter/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png" data-orig-size="630,557" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="decrypter" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png?w=630" loading="lazy" width="630" height="557" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png" alt="" data-id="840" data-link="https://aaqeel01.wordpress.com/decrypter/" class="wp-image-840" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png 630w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png?w=150&amp;h=133 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/decrypter.png?w=300&amp;h=265 300w" sizes="(max-width: 630px) 100vw, 630px" /></figure></li></ul></figure>



<p class="has-large-font-size"><strong>Unpacked</strong> Zloader</p>



<p><strong>SHA256 </strong>3A4CA58B0A2E72A264466A240C6636F62B8742FFBC96CE14E2225F0E57012E96</p>



<p><strong>File Type</strong> Win32 DLL</p>



<p><strong>Name</strong> unpacked_zloader_21_10_4.dll,&nbsp;</p>



<p><strong>Size </strong>146.00 KB (149504 bytes)</p>



<p><strong>Compiler Time-stamp </strong>Wed Jul 14 08:04:16 2021</p>



<p><strong>First Submission </strong>2021-10-18 15:32:37</p>



<p><strong>Links </strong><a href="https://bazaar.abuse.ch/sample/3a4ca58b0a2e72a264466a240c6636f62b8742ffbc96ce14e2225f0e57012e96/">MalwareBazaar</a>,&nbsp;<a href="https://www.virustotal.com/gui/file/3a4ca58b0a2e72a264466a240c6636f62b8742ffbc96ce14e2225f0e57012e96/detection">VirusTotal</a>, <a href="https://tria.ge/211018-sym56aegfp">Tria.ge</a></p>



<p>The unpacked Zloader is a master piece of obfuscated functions that waste lots of analysis time to dig into. API strings among other static indicators would not be a good clue for analyzing Zloader. Beside, this malware family is known for API hashing, Visual Encryption using XOR, and RC4 encryption to encrypt strings.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-10 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="842" data-permalink="https://aaqeel01.wordpress.com/pestudio/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png" data-orig-size="1258,749" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="pestudio" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png?w=685" loading="lazy" width="1258" height="749" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png" alt="" data-id="842" data-link="https://aaqeel01.wordpress.com/pestudio/" class="wp-image-842" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png 1258w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png?w=150&amp;h=89 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png?w=300&amp;h=179 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png?w=768&amp;h=457 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/pestudio.png?w=1024&amp;h=610 1024w" sizes="(max-width: 1258px) 100vw, 1258px" /></figure></li></ul></figure>



<p>There are five main topics we are going to discuss in this section when reversing Zloader: API hashing, XORing string, extracting Configuration, DGA routine, and Zeus function.</p>



<p class="has-medium-font-size"><strong>API Hashing:</strong></p>



<p>Statically analyzing Zloader is a bit of a challenge. However, with a new amazing IDA plugin called <em>HashDB</em> from OpenAnalysis Labs <a href="https://hashdb.openanalysis.net/#section/Using-The-API/Hash-Format" target="_blank" rel="noreferrer noopener">[6]</a> it’s amazing how much obfuscated strings get out the way when reversing Zloader. Just to show a case of what HashDB can do before and after shots of hashed values in a random function. The hashes been checked among large database of hashes with good prediction of hashing algorithms been used.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-11 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="844" data-permalink="https://aaqeel01.wordpress.com/before/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png" data-orig-size="1272,721" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="before" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png?w=685" loading="lazy" width="1272" height="721" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png" alt="" data-id="844" data-link="https://aaqeel01.wordpress.com/before/" class="wp-image-844" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png 1272w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png?w=150&amp;h=85 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png?w=300&amp;h=170 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png?w=768&amp;h=435 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/before.png?w=1024&amp;h=580 1024w" sizes="(max-width: 1272px) 100vw, 1272px" /></figure></li></ul></figure>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-12 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="845" data-permalink="https://aaqeel01.wordpress.com/after/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png" data-orig-size="1205,712" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="after" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png?w=685" loading="lazy" width="1205" height="712" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png" alt="" data-id="845" data-link="https://aaqeel01.wordpress.com/after/" class="wp-image-845" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png 1205w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png?w=150&amp;h=89 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png?w=300&amp;h=177 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png?w=768&amp;h=454 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/after.png?w=1024&amp;h=605 1024w" sizes="(max-width: 1205px) 100vw, 1205px" /></figure></li></ul></figure>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-13 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="847" data-permalink="https://aaqeel01.wordpress.com/detected/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png" data-orig-size="368,232" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="detected" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png?w=368" loading="lazy" width="368" height="232" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png?w=368" alt="" data-id="847" data-link="https://aaqeel01.wordpress.com/detected/" class="wp-image-847" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png 368w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/detected.png?w=300 300w" sizes="(max-width: 368px) 100vw, 368px" /></figure></li></ul></figure>



<p class="has-medium-font-size"><strong>XORing Strings:</strong></p>



<p>With API hashing out of the way. It’s important to get reversing tricks to dig into the main functions and extract configurations. There’re very limited hardcode strings in Zloader that can be clues like those.</p>



<div class="wp-block-image"><figure class="alignleft size-large"><img data-attachment-id="848" data-permalink="https://aaqeel01.wordpress.com/rc4key/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png" data-orig-size="699,71" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="rc4key" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png?w=685" loading="lazy" width="699" height="71" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png?w=699" alt="" class="wp-image-848" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png 699w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/rc4key.png?w=300 300w" sizes="(max-width: 699px) 100vw, 699px" /></figure></div>



<div class="wp-block-image"><figure class="alignleft size-large"><img data-attachment-id="849" data-permalink="https://aaqeel01.wordpress.com/xor/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png" data-orig-size="563,92" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="xor" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png?w=563" loading="lazy" width="563" height="92" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png?w=563" alt="" class="wp-image-849" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png 563w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor.png?w=300 300w" sizes="(max-width: 563px) 100vw, 563px" /></figure></div>



<p></p>



<p></p>



<p></p>



<p>First, let’s look at <strong>Off_186010</strong> which is an offset of an offset of a memory location<strong> rdata:00183D80</strong> with literal string ( #uVTN7&#8217;GQ&#8217;rxUf5Ly ). When cross referencing this offset it’s been used 4 times in two different functions. And there’s some sort of XOR function in both subroutines which reveal this is the key literal string could be an XOR key value.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="851" data-permalink="https://aaqeel01.wordpress.com/xor_xorfunc1/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png" data-orig-size="368,136" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="xor_xorfunc1" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png?w=368" loading="lazy" width="368" height="136" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png?w=368" alt="" class="wp-image-851" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png 368w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xorfunc1.png?w=300 300w" sizes="(max-width: 368px) 100vw, 368px" /></figure></div>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-14 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="852" data-permalink="https://aaqeel01.wordpress.com/xore_xore_func2/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png" data-orig-size="1046,501" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="xore_xore_func2" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png?w=685" loading="lazy" width="1046" height="501" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png" alt="" data-id="852" data-link="https://aaqeel01.wordpress.com/xore_xore_func2/" class="wp-image-852" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png 1046w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png?w=150&amp;h=72 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png?w=300&amp;h=144 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png?w=768&amp;h=368 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xore_xore_func2.png?w=1024&amp;h=490 1024w" sizes="(max-width: 1046px) 100vw, 1046px" /></figure></li></ul></figure>



<figure class="wp-block-image size-large"><img data-attachment-id="854" data-permalink="https://aaqeel01.wordpress.com/xor_xref/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png" data-orig-size="784,226" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="xor_xref" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png?w=685" loading="lazy" width="784" height="226" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png?w=784" alt="" class="wp-image-854" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png 784w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/xor_xref.png?w=768 768w" sizes="(max-width: 784px) 100vw, 784px" /></figure>



<p>&nbsp;Cross referencing both <strong>sub_1658F0</strong> and <strong>sub_173C90</strong> routines would shows that over 120 times those functions has been called. Randomly checking any of the cross referencing like below</p>


<p>&#8230;.skipped lines&#8230;&#8230;..<br />
text:001610E0                 push    offset unk_183E8E<br />
.text:001610E5                 call    sub_1658F0<br />
&#8230;.skipped lines&#8230;&#8230;..<br />
text:0016444E                 push    offset unk_184310<br />
text:00164453                 call    sub_173C90<br />
&#8230;.. skipped lines&#8230;&#8230;<br />
text:00165685                 push    offset unk_184040<br />
text:0016568A                 call    sub_1658F0</p>



<p>We noticed both subrouties been called after a push of unknow offsets</p>



<p>Let’s use XOR key&nbsp;(#uVTN7&#8217;GQ&#8217;rxUf5Ly) with <strong>offset unk_184040</strong> value.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="857" data-permalink="https://aaqeel01.wordpress.com/exported-stings/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png" data-orig-size="500,573" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="exported-stings" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png?w=262" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png?w=500" loading="lazy" width="500" height="573" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png?w=500" alt="" class="wp-image-857" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png 500w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png?w=131 131w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/exported-stings.png?w=262 262w" sizes="(max-width: 500px) 100vw, 500px" /><figcaption>Shift+E over unknow offset location</figcaption></figure></div>


<p>Hex: 70 00 1A 00 30 00 20 00 39 00 56 00 55 00 22 00 0D 00 6A 00 1B 00 1B 00 27 00 09 00 46 00 23 00 1F 00 57 00 29 00 56 00<br />
key: #uVTN7&#8217;GQ&#8217;rxUf5Ly<br />
Result: SuLT~7.Gh&#8217;$x.f.Lt#.VON,&#8217;`Q.r&gt;UE5Sytu.T.7</p>



<p>The XORed value/result doesn’t make sense. If anything noticeable that the Hex values has zeros in sequence. Which indicate<strong> sub_1658F0</strong> is for wide character and this makes and <strong>sub_173C90</strong> for normal character. let&#8217;s try again deleting all repeated zeros and XOR with the key</p>


<p>Hex: 701A3020395655220D6A1B1B270946231F572956<br />
key: #uVTN7&#8217;GQ&#8217;rxUf5Ly<br />
Result: Software\Microsoft\</p>



<p></p>



<p>It’s not just strings that been obfuscated, some API calls been XORed too. Almost 120 offset being pushed in stack which means 120 strings are being XORed and to make it readable; <em>Appendix – A</em> contains all the strings with addresses after been XORed.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="859" data-permalink="https://aaqeel01.wordpress.com/api-xored/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png" data-orig-size="1061,148" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="api-xored" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=685" loading="lazy" width="1024" height="142" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=1024" alt="" class="wp-image-859" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=1024 1024w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=1018 1018w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png?w=768 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/api-xored.png 1061w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></div>



<p class="has-medium-font-size"><strong>Configuration:</strong></p>



<p>The other string ‘qhpacozsstaznupphhedjtuoww’ is 26 length. It’s crossed referenced twice in two separate routines.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="860" data-permalink="https://aaqeel01.wordpress.com/1-1/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png" data-orig-size="791,197" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="1-1" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png?w=685" loading="lazy" width="791" height="197" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png?w=791" alt="" class="wp-image-860" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png 791w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/1-1.png?w=768 768w" sizes="(max-width: 791px) 100vw, 791px" /></figure>



<p>snipped assembly from <strong>sub_161E40</strong> and <strong>sub_1673D0</strong> routines</p>


<p>.text:00161EE3                 push    offset aQhpacozsstaznu ; &#8220;qhpacozsstaznupphhedjtuoww&#8221;<br />
.text:00161EE8                 push    offset unk_184404<br />
&#8212;&#8212;-skipped lines&#8212;<br />
text:001673D0 sub_1673D0      proc near               ; CODE XREF: sub_171400+40↓p<br />
.text:001673D0                 push    ebp<br />
.text:001673D1                 mov     ebp, esp<br />
.text:001673D3                 push    edi<br />
.text:001673D4                 push    esi<br />
.text:001673D5                 mov     esi, ecx<br />
.text:001673D7                 call    sub_1809A0<br />
.text:001673DC                 mov     edi, [eax+30h]<br />
.text:001673DF                 mov     ecx, esi<br />
.text:001673E1                 call    sub_1809A0<br />
.text:001673E6                 add     eax, edi<br />
.text:001673E8                 push    36Fh<br />
.text:001673ED                 push    offset unk_184404<br />
.text:001673F2                 push    eax<br />
.text:001673F3                 call    sub_171D80<br />
.text:001673F8                 add     esp, 0Ch<br />
.text:001673FB                 mov     ecx, esi<br />
.text:001673FD                 call    sub_1809A0<br />
.text:00167402                 mov     edi, [eax+34h]<br />
.text:00167405                 mov     ecx, esi<br />
.text:00167407                 call    sub_1809A0<br />
.text:0016740C                 add     eax, edi<br />
.text:0016740E                 push    64h ; &#8216;d&#8217;<br />
.text:00167410                 push    offset aQhpacozsstaznu ; &#8220;qhpacozsstaznupphhedjtuoww&#8221;</p>



<p>In both routines notice a repeated push to an offset<strong> unk_184404</strong>. This offset contains configurations. Noticed that both offset passed into a function<strong> sub_1656B0</strong> (<em>name decrypting_rc4</em>)</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-15 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="864" data-permalink="https://aaqeel01.wordpress.com/2/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png" data-orig-size="639,577" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="2" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png?w=639" loading="lazy" width="639" height="577" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png" alt="" data-id="864" data-link="https://aaqeel01.wordpress.com/2/" class="wp-image-864" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png 639w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png?w=150&amp;h=135 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/2.png?w=300&amp;h=271 300w" sizes="(max-width: 639px) 100vw, 639px" /></figure></li></ul><figcaption class="blocks-gallery-caption">Pseudo code from <strong>sub_1656B0</strong> routine </figcaption></figure>



<p>Decrypting_rc4 function calls multiple function and those are calling other functions. What we are looking here is RC4 algorithm.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-16 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="866" data-permalink="https://aaqeel01.wordpress.com/3-3/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png" data-orig-size="1073,716" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="3-3" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png?w=685" loading="lazy" width="1073" height="716" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png" alt="" data-id="866" data-link="https://aaqeel01.wordpress.com/3-3/" class="wp-image-866" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png 1073w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png?w=150&amp;h=100 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png?w=300&amp;h=200 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png?w=768&amp;h=512 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3-3.png?w=1024&amp;h=683 1024w" sizes="(max-width: 1073px) 100vw, 1073px" /></figure></li></ul></figure>



<p>To have mind map where RC4 algorithm location lets Xref-from Decrypting_rc4 function where Config strings and key retrieved</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery columns-1 is-cropped wp-block-gallery-17 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="868" data-permalink="https://aaqeel01.wordpress.com/3/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png" data-orig-size="1722,710" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="3" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=685" loading="lazy" width="1024" height="422" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=1024" alt="" data-id="868" data-link="https://aaqeel01.wordpress.com/3/" class="wp-image-868" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=1024 1024w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png?w=768 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/3.png 1722w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></li></ul><figcaption class="blocks-gallery-caption">Xref_from <strong>sub_1656B0</strong> (decrypting_rc4)</figcaption></figure>



<p>Now let’s go back to the configuration ‘config’ offset in data block and copy its hex value to CyberChef and use RC4 algorithm to decrypt it with the key (qhpacozsstaznupphhedjtuoww)</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-18 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="871" data-permalink="https://aaqeel01.wordpress.com/4-1/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png" data-orig-size="961,612" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="4-1" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png?w=685" loading="lazy" width="961" height="612" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png" alt="" data-id="871" data-link="https://aaqeel01.wordpress.com/4-1/" class="wp-image-871" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png 961w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png?w=150&amp;h=96 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png?w=300&amp;h=191 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/4-1.png?w=768&amp;h=489 768w" sizes="(max-width: 961px) 100vw, 961px" /></figure></li></ul></figure>



<p>Notice three things: got C2 URLs, list in Table-1, and 123 which is ID for this variant of Zloader, and at the tail there’s this value (djfsf02hf832hf03) which is another RC4 key that decrypt the registry values in \HKEY_CURRENT_USER\Software\Microsoft\bbxk and also encrypt decrypt traffic with C2 <a rel="noreferrer noopener" href="https://www.malwarebytes.com/resources/files/2020/06/the-silent-night-zloader-zbot_final.pdf" target="_blank">[7]</a>.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-19 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="873" data-permalink="https://aaqeel01.wordpress.com/5/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png" data-orig-size="1535,720" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="5" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png?w=685" loading="lazy" width="1535" height="720" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png" alt="" data-id="873" data-link="https://aaqeel01.wordpress.com/5/" class="wp-image-873" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png 1535w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png?w=150&amp;h=70 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png?w=300&amp;h=141 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png?w=768&amp;h=360 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/5.png?w=1024&amp;h=480 1024w" sizes="(max-width: 1535px) 100vw, 1535px" /></figure></li></ul></figure>



<p>Table-1</p>


<p>123<br />
hxxp://gipc.in/post[.]php<br />
hxxp://fbhindia.com/post[.]php<br />
hxxp://ecolenefiber.com/post[.]php<br />
hxxp://design.ecolenefiber.com/post[.]php<br />
hxxp://beta.marlics.ir/post[.]php<br />
hxxp://hari.pk/post[.]php<br />
hxxp://iaiskjmalang.ac.id/post[.]php<br />
hxxp://314xd.com/post[.]php<br />
hxxp://ejournal.iaiskjmalang.ac[.]id/post.php<br />
hxxp://duanvn.com/post[.]php<br />
djfsf02hf832hf03</p>



<p>Decrytped registry key value contains host name and the Zloader in %AppData% directory.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="875" data-permalink="https://aaqeel01.wordpress.com/6/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png" data-orig-size="643,606" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="6" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png?w=643" loading="lazy" width="643" height="606" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png?w=643" alt="" class="wp-image-875" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png 643w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/6.png?w=300 300w" sizes="(max-width: 643px) 100vw, 643px" /></figure></div>



<p class="has-medium-font-size"><strong>DGA:</strong></p>



<p>Zloader know for using DGA algorithm and we notice above some of the generated 32 character length URLs. To find the DGA function in this we can look for<em> .com</em> or <em>post.php</em> strings that been deobfuscatd in the previous section of XORing strings.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="876" data-permalink="https://aaqeel01.wordpress.com/7-dga/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png" data-orig-size="924,562" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="7.-dga" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png?w=685" loading="lazy" width="924" height="562" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png?w=924" alt="" class="wp-image-876" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png 924w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/7.-dga.png?w=768 768w" sizes="(max-width: 924px) 100vw, 924px" /></figure></div>



<p>when cross referencing <em>.com</em> from <strong>rdata:001849B4 </strong>location we find that it&#8217;s been called by one function and let’s name that function the_dga</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-20 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="877" data-permalink="https://aaqeel01.wordpress.com/8/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png" data-orig-size="1179,699" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="8" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png?w=685" loading="lazy" width="1179" height="699" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png" alt="" data-id="877" data-link="https://aaqeel01.wordpress.com/8/" class="wp-image-877" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png 1179w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png?w=150&amp;h=89 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png?w=300&amp;h=178 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png?w=768&amp;h=455 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/8.png?w=1024&amp;h=607 1024w" sizes="(max-width: 1179px) 100vw, 1179px" /></figure></li></ul></figure>



<p>The_dga function has been called one by another function. Based on <a href="https://bin.re/blog/the-dga-of-zloader/" target="_blank" rel="noreferrer noopener">[8]</a>, the caller of DGA routine does it math calculating values called Seed based on time and RC4 key (djfsf02hf832hf03) (second key). So the values generated are much different each day passed in used <strong>GetLocalTime</strong> and <strong>SystemTimetoFileTime</strong> APIs. Notice that the_dga function has passed value of 32 which is the same length of the URL string with Seed value which in this case makes the entire caller function to calculate Seed value. followed by<em> post.php</em> and <em>https</em> while loop. The caller function got many obfuscated function that slows down analysis and it get complicated calculating generated domains manually.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery columns-1 is-cropped wp-block-gallery-21 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="880" data-permalink="https://aaqeel01.wordpress.com/9/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png" data-orig-size="1275,696" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="9" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=685" loading="lazy" width="1024" height="558" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=1024" alt="" data-id="880" data-link="https://aaqeel01.wordpress.com/9/" class="wp-image-880" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=1022 1022w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=300 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png?w=768 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/9.png 1275w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure></li></ul></figure>



<p class="has-medium-font-size"><strong>Zeus Items:</strong></p>



<p>Zeus uses item ID as list below which is the main one, there are more extended list based on Zloader version <a href="https://github.com/Visgean/Zeus" target="_blank" rel="noreferrer noopener">[1]</a> <a href="https://www.honeynet.it/wp-content/uploads/Papers/04-Titans%20revenge.pdf" target="_blank" rel="noreferrer noopener">[2]</a> <a href="https://www.malwarebytes.com/resources/files/2020/06/the-silent-night-zloader-zbot_final.pdf" target="_blank" rel="noreferrer noopener">[7]</a>. Each ID passed into a function and dissect information from victim machine. When that information stored in attacker SQL filed it show retrieved info about the host.</p>



<figure class="wp-block-table aligncenter is-style-stripes"><table><thead><tr><th class="has-text-align-left" data-align="left">Item ID</th><th class="has-text-align-left" data-align="left">Value</th></tr></thead><tbody><tr><td class="has-text-align-left" data-align="left">10001</td><td class="has-text-align-left" data-align="left">SBCID BOT ID</td></tr><tr><td class="has-text-align-left" data-align="left">10002 </td><td class="has-text-align-left" data-align="left">SBCID BOTNET</td></tr><tr><td class="has-text-align-left" data-align="left">10003 </td><td class="has-text-align-left" data-align="left">SBCID BOT VERSION</td></tr><tr><td class="has-text-align-left" data-align="left">10005 </td><td class="has-text-align-left" data-align="left">SBCID NET LATENCY</td></tr><tr><td class="has-text-align-left" data-align="left">10006 </td><td class="has-text-align-left" data-align="left">SBCID TCPPORT S1</td></tr><tr><td class="has-text-align-left" data-align="left">10007 </td><td class="has-text-align-left" data-align="left">SBCID PATH SOURCE</td></tr><tr><td class="has-text-align-left" data-align="left">10008 </td><td class="has-text-align-left" data-align="left">SBCID PATH DEST</td></tr><tr><td class="has-text-align-left" data-align="left">10009 </td><td class="has-text-align-left" data-align="left">SBCID TIME SYSTEM</td></tr><tr><td class="has-text-align-left" data-align="left">10010 </td><td class="has-text-align-left" data-align="left">SBCID TIME TICK</td></tr><tr><td class="has-text-align-left" data-align="left">10011 </td><td class="has-text-align-left" data-align="left">SBCID TIME LOCALBIAS</td></tr><tr><td class="has-text-align-left" data-align="left">10012 </td><td class="has-text-align-left" data-align="left">SBCID OS INFO</td></tr><tr><td class="has-text-align-left" data-align="left">10013 </td><td class="has-text-align-left" data-align="left">SBCID LANGUAGE ID</td></tr><tr><td class="has-text-align-left" data-align="left">10014</td><td class="has-text-align-left" data-align="left">SBCID PROCESS NAME</td></tr><tr><td class="has-text-align-left" data-align="left">10015 </td><td class="has-text-align-left" data-align="left">SBCID PROCESS USER</td></tr><tr><td class="has-text-align-left" data-align="left">10016 </td><td class="has-text-align-left" data-align="left">SBCID IPV4 ADDRESSES</td></tr><tr><td class="has-text-align-left" data-align="left">10017 </td><td class="has-text-align-left" data-align="left">SBCID IPV6 ADDRESSES</td></tr><tr><td class="has-text-align-left" data-align="left">10018 </td><td class="has-text-align-left" data-align="left">SBCID BOTLOG TYPE</td></tr><tr><td class="has-text-align-left" data-align="left">10019 </td><td class="has-text-align-left" data-align="left">SBCID BOTLOG</td></tr></tbody></table></figure>



<p></p>



<p>To get to Zeus item values and function we need to search strings in IDA to find one the common ID values since they are constant. &nbsp;</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-attachment-id="883" data-permalink="https://aaqeel01.wordpress.com/10/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png" data-orig-size="353,246" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="10" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png?w=353" loading="lazy" width="353" height="246" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png?w=353" alt="" class="wp-image-883" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png 353w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png?w=150 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/10.png?w=300 300w" sizes="(max-width: 353px) 100vw, 353px" /></figure></div>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-22 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="884" data-permalink="https://aaqeel01.wordpress.com/11/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png" data-orig-size="1516,262" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="11" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png?w=685" loading="lazy" width="1516" height="262" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png" alt="" data-id="884" data-link="https://aaqeel01.wordpress.com/11/" class="wp-image-884" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png 1516w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png?w=150&amp;h=26 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png?w=300&amp;h=52 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png?w=768&amp;h=133 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/11.png?w=1024&amp;h=177 1024w" sizes="(max-width: 1516px) 100vw, 1516px" /></figure></li></ul></figure>



<p>Notice that most the calls are <strong>sub_1657B0</strong>, let’s call it z_items_main, it’s been crossed referenced 17 times. List of Zeus items being found in 123 variant. </p>



<figure class="wp-block-table aligncenter is-style-stripes"><table><thead><tr><th class="has-text-align-left" data-align="left">Item ID</th><th class="has-text-align-left" data-align="left">Value</th></tr></thead><tbody><tr><td class="has-text-align-left" data-align="left">10001</td><td class="has-text-align-left" data-align="left">SBCID BOT ID</td></tr><tr><td class="has-text-align-left" data-align="left">10003 </td><td class="has-text-align-left" data-align="left">SBCID BOT VERSION</td></tr><tr><td class="has-text-align-left" data-align="left">10006 </td><td class="has-text-align-left" data-align="left">SBCID_PING</td></tr><tr><td class="has-text-align-left" data-align="left">10007 </td><td class="has-text-align-left" data-align="left">SBCID PATH SOURCE</td></tr><tr><td class="has-text-align-left" data-align="left">11014 </td><td class="has-text-align-left" data-align="left">SBCID_GET_FILE</td></tr><tr><td class="has-text-align-left" data-align="left">11015 </td><td class="has-text-align-left" data-align="left">SBCID_GET_FILE_VER</td></tr><tr><td class="has-text-align-left" data-align="left">11031 </td><td class="has-text-align-left" data-align="left">SBCID_LOG_ID_EXT</td></tr><tr><td class="has-text-align-left" data-align="left">11032 </td><td class="has-text-align-left" data-align="left">SBCID_LOG_ERR_CODE</td></tr><tr><td class="has-text-align-left" data-align="left">11033 </td><td class="has-text-align-left" data-align="left">SBCID_LOG_MSG</td></tr><tr><td class="has-text-align-left" data-align="left">10022 </td><td class="has-text-align-left" data-align="left">SBCID_DEBUG</td></tr><tr><td class="has-text-align-left" data-align="left">10025 </td><td class="has-text-align-left" data-align="left">SBCID_MARKER</td></tr><tr><td class="has-text-align-left" data-align="left">20001 </td><td class="has-text-align-left" data-align="left">CFGID_LAST_VERSION</td></tr><tr><td class="has-text-align-left" data-align="left">20000 </td><td class="has-text-align-left" data-align="left">SBCID_BOTLOG</td></tr><tr><td class="has-text-align-left" data-align="left">20005 </td><td class="has-text-align-left" data-align="left">CFG_HTTP_FILTER</td></tr><tr><td class="has-text-align-left" data-align="left">20006 </td><td class="has-text-align-left" data-align="left">CFGID_HTTP_POSTDATA_FILTER</td></tr><tr><td class="has-text-align-left" data-align="left">20008 </td><td class="has-text-align-left" data-align="left">CFGID_DNS_LIST</td></tr></tbody></table></figure>



<p>Just to give an example of the level of obfuscation on every stage of Zloader. Not all the items ID values are retrieved in decimal passed to the function. Some values passed into another function and require to calculate separately like below in v29 value return from <strong>sub_167890</strong> .</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-2 is-cropped wp-block-gallery-23 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="889" data-permalink="https://aaqeel01.wordpress.com/12/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png" data-orig-size="343,132" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="12" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png?w=343" loading="lazy" width="343" height="132" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png" alt="" data-id="889" data-link="https://aaqeel01.wordpress.com/12/" class="wp-image-889" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png 343w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png?w=150&amp;h=58 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/12.png?w=300&amp;h=115 300w" sizes="(max-width: 343px) 100vw, 343px" /></figure></li><li class="blocks-gallery-item"><figure><img data-attachment-id="890" data-permalink="https://aaqeel01.wordpress.com/13-2/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png" data-orig-size="425,453" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="13" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png?w=281" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png?w=425" loading="lazy" width="425" height="453" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png" alt="" data-id="890" data-link="https://aaqeel01.wordpress.com/13-2/" class="wp-image-890" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png 425w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png?w=141&amp;h=150 141w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/13.png?w=281&amp;h=300 281w" sizes="(max-width: 425px) 100vw, 425px" /></figure></li></ul></figure>



<p>To give an example of how Zeus item works let take a look at this function <strong>sub_177110</strong>.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-24 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="892" data-permalink="https://aaqeel01.wordpress.com/14/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png" data-orig-size="1360,731" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="14" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png?w=685" loading="lazy" width="1360" height="731" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png" alt="" data-id="892" data-link="https://aaqeel01.wordpress.com/14/" class="wp-image-892" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png 1360w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png?w=150&amp;h=81 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png?w=300&amp;h=161 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png?w=768&amp;h=413 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/14.png?w=1024&amp;h=550 1024w" sizes="(max-width: 1360px) 100vw, 1360px" /></figure></li></ul></figure>



<p><strong>sub_16F780</strong> has (<em>20001: CFGID_LAST_VERSION</em>) that updates Zloader version. Looking at it in the disassembler would show so much obfuscated function, but to have an idea of what possibly this update could do let’s see the leaked source code having this similar Item ID in similar fashion <a href="https://github.com/Visgean/Zeus/blob/c55a9fa8c8564ec196604a59111708fa8415f020/source/client/dynamicconfig.cpp" target="_blank" rel="noreferrer noopener">[9]</a>.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-25 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="894" data-permalink="https://aaqeel01.wordpress.com/15/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png" data-orig-size="1330,532" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="15" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png?w=685" loading="lazy" width="1330" height="532" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png" alt="" data-id="894" data-link="https://aaqeel01.wordpress.com/15/" class="wp-image-894" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png 1330w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png?w=150&amp;h=60 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png?w=300&amp;h=120 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png?w=768&amp;h=307 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/15.png?w=1024&amp;h=410 1024w" sizes="(max-width: 1330px) 100vw, 1330px" /></figure></li></ul></figure>



<p>The successful update would lead to update registry values in HKCU\Software\Mircosoft\<em>bbxk</em>\ which points to %AppData% directory of possible the new Zloader that has new C2 connections</p>



<p>Finally, to have an idea how Zeus function being called here’s a mind map when Xref-to it.</p>



<figure data-carousel-extra='{"blog_id":187688745,"permalink":"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/"}'  class="wp-block-gallery aligncenter columns-1 is-cropped wp-block-gallery-26 is-layout-flex wp-block-gallery-is-layout-flex"><ul class="blocks-gallery-grid"><li class="blocks-gallery-item"><figure><img data-attachment-id="896" data-permalink="https://aaqeel01.wordpress.com/zeus-location/" data-orig-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png" data-orig-size="1428,1172" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="zeus-location" data-image-description="" data-image-caption="" data-medium-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png?w=300" data-large-file="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png?w=685" loading="lazy" width="1428" height="1172" src="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png" alt="" data-id="896" data-link="https://aaqeel01.wordpress.com/zeus-location/" class="wp-image-896" srcset="https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png 1428w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png?w=150&amp;h=123 150w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png?w=300&amp;h=246 300w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png?w=768&amp;h=630 768w, https://aaqeel01.wordpress.com/wp-content/uploads/2021/10/zeus-location.png?w=1024&amp;h=840 1024w" sizes="(max-width: 1428px) 100vw, 1428px" /></figure></li></ul></figure>



<p class="has-large-font-size">Appendix A</p>



<figure class="wp-block-table"><table><thead><tr><th>Address</th><th>XORed string</th></tr></thead><tbody><tr><td>rdata:00183DED</td><td>kernel32.dll</td></tr><tr><td>rdata:00183DFA</td><td>http</td></tr><tr><td>rdata:00183E26</td><td>post</td></tr><tr><td>rdata:00183E37</td><td>.63</td></tr><tr><td>rdata:00183E3B</td><td>Wininet.dll</td></tr><tr><td>rdata:00183DE0</td><td>Imagehlp.dll</td></tr><tr><td>rdata:00183DB0</td><td>C:\Windows\SystemApps</td></tr><tr><td>rdata:00183D9C</td><td>Local</td></tr><tr><td>rdata:00183D92</td><td>.exe</td></tr><tr><td>rdata:00183D50</td><td>NtQueryVirtualMemory</td></tr><tr><td>rdata:00183D43</td><td>Bcrypt.dll</td></tr><tr><td>rdata:00183D38</td><td>Ftllib.dll</td></tr><tr><td>rdata:00183D2A</td><td>Samlib.dll</td></tr><tr><td>rdata:00183D20</td><td>Post.php</td></tr><tr><td>rdata:00183E47</td><td>Ntdll.dll</td></tr><tr><td>rdata:00183E5C</td><td>CmpMem64</td></tr><tr><td>rdata:00183E70</td><td>INVALID_BOT_ID</td></tr><tr><td>rdata:00183E8E</td><td>\start</td></tr><tr><td>rdata:00183EA0</td><td>HideClass</td></tr><tr><td>rdata:00183EB4</td><td>advapi32.dll</td></tr><tr><td>rdata:00183ED0</td><td>ABCDEFGHIJKLMNOPQRSTUVWZabcdefghijklmnopqrstuvwz</td></tr><tr><td>rdata:00183F21</td><td>ws2_32.dll</td></tr><tr><td>rdata:00183F3B</td><td>Shlwapi.dll</td></tr><tr><td>rdata:00183F47</td><td>crypt32.dll</td></tr><tr><td>rdata:00183F60</td><td>NtProtectVirtualMemory</td></tr><tr><td>rdata:00183F77</td><td>GetMem64</td></tr><tr><td>rdata:00183F90</td><td>Get</td></tr><tr><td>rdata:00183FA0</td><td>Software\Microsoft\Windows\CurrentVersion\Run</td></tr><tr><td>rdata:00183FFC</td><td>Urlmon.dll</td></tr><tr><td>rdata:0018400A</td><td>wtsapi32.dll</td></tr><tr><td>rdata:00184040</td><td>Software\Microsoft</td></tr><tr><td>rdata:00184068</td><td>tmp</td></tr><tr><td>rdata:0018407C</td><td>Iphlpapi.dll</td></tr><tr><td>rdata:0018408C</td><td>Version.dll</td></tr><tr><td>rdata:0018409E</td><td>rpcrt4.dll</td></tr><tr><td>rdata:001840AA</td><td>Dll</td></tr><tr><td>rdata:00184111</td><td>wldap32.dll</td></tr><tr><td>rdata:00184165</td><td>ole32.dll</td></tr><tr><td>rdata:0018416F</td><td>psapi_dll</td></tr><tr><td>rdata:00184180</td><td>NtFreeVirtualMemory</td></tr><tr><td>rdata:001841A0</td><td>NtSetContextThread</td></tr><tr><td>rdata:001841B3</td><td>Winsta.dll</td></tr><tr><td>rdata:001841D0</td><td>user32.dll</td></tr><tr><td>rdata:001841E0</td><td>Software\Microsoft\WindowsNT\CurrentVersion</td></tr><tr><td>rdata:00184288</td><td>gdi32.dll</td></tr><tr><td>rdata:00184292</td><td>Gdiplus.dll</td></tr><tr><td>rdata:001842C0</td><td>regsvr32.exe</td></tr><tr><td>rdata:001842F0</td><td>RtlCreateUserProcess</td></tr><tr><td>rdata:00184310</td><td>NtWriteVirtualMemory</td></tr><tr><td>rdata:00184330</td><td>InstallDate</td></tr><tr><td>rdata:001843B0</td><td>NtReadVirtualMemory</td></tr><tr><td>rdata:001843E0</td><td>RtlCreateProcessParameters</td></tr><tr><td>rdata:00184780</td><td>Connection_close</td></tr><tr><td>rdata:00184794</td><td>Dnsapi.dll</td></tr><tr><td>rdata:001847BC</td><td>secur32.dll</td></tr><tr><td>rdata:001847D0</td><td>kernel32.dll</td></tr><tr><td>rdata:001847F0</td><td>NtGetContextThread</td></tr><tr><td>rdata:00184820</td><td>Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.88 Safari/537.36.</td></tr><tr><td>rdata:00184892</td><td>NtResumeThread</td></tr><tr><td>rdata:001848B0</td><td>SeSecurityPrivilege</td></tr><tr><td>rdata:00184914</td><td>shell32.dll</td></tr><tr><td>rdata:00184920</td><td>Ntdll.dll</td></tr><tr><td>rdata:00184940</td><td>LdrGetProcedureAddress</td></tr><tr><td>rdata:00184957</td><td>netapi32.dll</td></tr><tr><td>rdata:00184964</td><td>Mpr.dll</td></tr><tr><td>rdata:0018496C</td><td>https:\\</td></tr><tr><td>rdata:00184975</td><td>X64Call</td></tr><tr><td>rdata:00184980</td><td>NtAllocateVirtualMemory</td></tr><tr><td>rdata:001849B4</td><td>.com</td></tr><tr><td>rdata:001849BA</td><td>Global</td></tr><tr><td>rdata:001849CA</td><td>Winscard.dll</td></tr><tr><td>rdata:001849D7</td><td>Cabinet.dll</td></tr><tr><td>rdata:001849E3</td><td>Userenv.dll</td></tr><tr><td>rdata:001849EF</td><td>Ncrypt.dll</td></tr></tbody></table></figure>



<p class="has-large-font-size"><strong>References</strong></p>



<p>[1] Zeus opensource, <a href="https://github.com/Visgean/Zeus" target="_blank" rel="noreferrer noopener">https://github.com/Visgean/Zeus</a></p>



<p>[2] Titans’ revenge: detecting Zeus via its own flaws, <a href="https://www.honeynet.it/wp-content/uploads/Papers/04-Titans%20revenge.pdf" target="_blank" rel="noreferrer noopener">https://www.honeynet.it/wp-content/uploads/Papers/04-Titans%20revenge.pdf</a></p>



<p>[3] Hide and Seek | New Zloader Infection Chain Comes With Improved Stealth and Evasion Mechanisms, <a href="https://www.sentinelone.com/labs/hide-and-seek-new-zloader-infection-chain-comes-with-improved-stealth-and-evasion-mechanisms/" target="_blank" rel="noreferrer noopener">https://www.sentinelone.com/labs/hide-and-seek-new-zloader-infection-chain-comes-with-improved-stealth-and-evasion-mechanisms/</a></p>



<p>[4] The Squirrel Strikes Back: Analysis of the newly emerged cobalt-strike loader “SquirrelWaffle” , <a href="https://elis531989.medium.com/the-squirrel-strikes-back-analysis-of-the-newly-emerged-cobalt-strike-loader-squirrelwaffle-937b73dbd9f9" target="_blank" rel="noreferrer noopener">https://elis531989.medium.com/the-squirrel-strikes-back-analysis-of-the-newly-emerged-cobalt-strike-loader-squirrelwaffle-937b73dbd9f9</a></p>



<p>[5] QakBot Quick analysis, <a href="https://twitter.com/aaqeel87/status/1443255927000424449?s=20" target="_blank" rel="noreferrer noopener">https://twitter.com/aaqeel87/status/1443255927000424449?s=20</a></p>



<p>[6] HashDB project, <a href="https://hashdb.openanalysis.net/#section/Using-The-API/Hash-Format" target="_blank" rel="noreferrer noopener">https://hashdb.openanalysis.net/#section/Using-The-API/Hash-Format</a></p>



<p>[7] The “Silent Night” Zloader/Zbot ,<a href="https://www.malwarebytes.com/resources/files/2020/06/the-silent-night-zloader-zbot_final.pdf" target="_blank" rel="noreferrer noopener"> https://www.malwarebytes.com/resources/files/2020/06/the-silent-night-zloader-zbot_final.pdf</a></p>



<p>[8] The DGA of Zloader,<a href="https://bin.re/blog/the-dga-of-zloader/" target="_blank" rel="noreferrer noopener"> https://bin.re/blog/the-dga-of-zloader/</a></p>



<p>[9] Zeus source code, <a href="https://github.com/Visgean/Zeus/blob/c55a9fa8c8564ec196604a59111708fa8415f020/source/client/dynamicconfig.cpp" target="_blank" rel="noreferrer noopener">https://github.com/Visgean/Zeus/blob/c55a9fa8c8564ec196604a59111708fa8415f020/source/client/dynamicconfig.cpp</a></p>
<div id="atatags-370373-6762399cc1f0d">
		<script type="text/javascript">
			__ATA.cmd.push(function() {
				__ATA.initVideoSlot('atatags-370373-6762399cc1f0d', {
					sectionId: '370373',
					format: 'inread'
				});
			});
		</script>
	</div><span id="wordads-inline-marker" style="display: none;"></span>			<div id="atatags-26942-6762399cc2215"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-26942-6762399cc2215',
						location: 120,
						formFactor: '001',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-822" class="share-twitter sd-button share-icon" href="https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-822" class="share-facebook sd-button share-icon" href="https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-187688745-822-6762399cc3cf5' data-src='//widgets.wp.com/likes/index.html?ver=20241218#blog_id=187688745&amp;post_id=822&amp;origin=aaqeel01.wordpress.com&amp;obj_id=187688745-822-6762399cc3cf5' data-name='like-post-frame-187688745-822-6762399cc3cf5' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div></div>	</div>
		<footer class="entry-footer">
		<span class="tags-links">Tagged <a href="https://aaqeel01.wordpress.com/tag/malware-analysis/" rel="tag">malware analysis</a>, <a href="https://aaqeel01.wordpress.com/tag/reverse-engineering/" rel="tag">Reverse Engineering</a>, <a href="https://aaqeel01.wordpress.com/tag/zloader/" rel="tag">Zloader</a></span>	</footer><!-- .entry-footer -->
	</article><!-- #post-## -->
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://aaqeel01.wordpress.com/2021/09/21/dissecting-binaries-from-unknown-threat-actor/" rel="prev"><span class="title">Previous post</span>Dissecting binaries from Egomaniac attack with API hashing&nbsp;technique</a></div></div>
	</nav>
		</main>
	</div>
			</div><!-- #content -->
	<footer id="colophon" class="site-footer" role="contentinfo">
				<div class="site-info">
	<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
	
	</div><!-- .site-info -->	</footer>
</div><!-- #page -->
<!--  -->
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=202451b213a1cbb4e3271ca470eb7790af362ac2e18ce468f8945952c7bd3456d2132e" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Profile not found.': 'Profile not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	</div>
		<script type="text/javascript">
		( function() {
			function init() {
				document.body.addEventListener( 'is.post-load', function() {
					if ( typeof __ATA.insertInlineAds === 'function' ) {
						__ATA.insertInlineAds();
					}
				} );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
		</script>		<!-- CCPA [start] -->
		<script type="text/javascript">
			( function () {

				var setupPrivacy = function() {

					// Minimal Mozilla Cookie library
					// https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie/Simple_document.cookie_framework
					var cookieLib = window.cookieLib = {getItem:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,o,n,t,r,i){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var c="";if(n)switch(n.constructor){case Number:c=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:c="; expires="+n;break;case Date:c="; expires="+n.toUTCString()}return"rootDomain"!==r&&".rootDomain"!==r||(r=(".rootDomain"===r?".":"")+document.location.hostname.split(".").slice(-2).join(".")),document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(o)+c+(r?"; domain="+r:"")+(t?"; path="+t:"")+(i?"; secure":""),!0}};

					// Implement IAB USP API.
					window.__uspapi = function( command, version, callback ) {

						// Validate callback.
						if ( typeof callback !== 'function' ) {
							return;
						}

						// Validate the given command.
						if ( command !== 'getUSPData' || version !== 1 ) {
							callback( null, false );
							return;
						}

						// Check for GPC. If set, override any stored cookie.
						if ( navigator.globalPrivacyControl ) {
							callback( { version: 1, uspString: '1YYN' }, true );
							return;
						}

						// Check for cookie.
						var consent = cookieLib.getItem( 'usprivacy' );

						// Invalid cookie.
						if ( null === consent ) {
							callback( null, false );
							return;
						}

						// Everything checks out. Fire the provided callback with the consent data.
						callback( { version: 1, uspString: consent }, true );
					};

					// Initialization.
					document.addEventListener( 'DOMContentLoaded', function() {

						// Internal functions.
						var setDefaultOptInCookie = function() {
							var value = '1YNN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 365 * 24 * 60 * 60, '/', domain );
						};

						var setDefaultOptOutCookie = function() {
							var value = '1YYN';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setDefaultNotApplicableCookie = function() {
							var value = '1---';
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'usprivacy', value, 24 * 60 * 60, '/', domain );
						};

						var setCcpaAppliesCookie = function( applies ) {
							var domain = '.wordpress.com' === location.hostname.slice( -14 ) ? '.rootDomain' : location.hostname;
							cookieLib.setItem( 'ccpa_applies', applies, 24 * 60 * 60, '/', domain );
						}

						var maybeCallDoNotSellCallback = function() {
							if ( 'function' === typeof window.doNotSellCallback ) {
								return window.doNotSellCallback();
							}

							return false;
						}

						// Look for usprivacy cookie first.
						var usprivacyCookie = cookieLib.getItem( 'usprivacy' );

						// Found a usprivacy cookie.
						if ( null !== usprivacyCookie ) {

							// If the cookie indicates that CCPA does not apply, then bail.
							if ( '1---' === usprivacyCookie ) {
								return;
							}

							// CCPA applies, so call our callback to add Do Not Sell link to the page.
							maybeCallDoNotSellCallback();

							// We're all done, no more processing needed.
							return;
						}

						// We don't have a usprivacy cookie, so check to see if we have a CCPA applies cookie.
						var ccpaCookie = cookieLib.getItem( 'ccpa_applies' );

						// No CCPA applies cookie found, so we'll need to geolocate if this visitor is from California.
						// This needs to happen client side because we do not have region geo data in our $SERVER headers,
						// only country data -- therefore we can't vary cache on the region.
						if ( null === ccpaCookie ) {

							var request = new XMLHttpRequest();
							request.open( 'GET', 'https://public-api.wordpress.com/geo/', true );

							request.onreadystatechange = function () {
								if ( 4 === this.readyState ) {
									if ( 200 === this.status ) {

										// Got a geo response. Parse out the region data.
										var data = JSON.parse( this.response );
										var region      = data.region ? data.region.toLowerCase() : '';
										var ccpa_applies = ['california', 'colorado', 'connecticut', 'delaware', 'indiana', 'iowa', 'montana', 'new jersey', 'oregon', 'tennessee', 'texas', 'utah', 'virginia'].indexOf( region ) > -1;
										// Set CCPA applies cookie. This keeps us from having to make a geo request too frequently.
										setCcpaAppliesCookie( ccpa_applies );

										// Check if CCPA applies to set the proper usprivacy cookie.
										if ( ccpa_applies ) {
											if ( maybeCallDoNotSellCallback() ) {
												// Do Not Sell link added, so set default opt-in.
												setDefaultOptInCookie();
											} else {
												// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
												setDefaultOptOutCookie();
											}
										} else {
											// CCPA does not apply.
											setDefaultNotApplicableCookie();
										}
									} else {
										// Could not geo, so let's assume for now that CCPA applies to be safe.
										setCcpaAppliesCookie( true );
										if ( maybeCallDoNotSellCallback() ) {
											// Do Not Sell link added, so set default opt-in.
											setDefaultOptInCookie();
										} else {
											// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
											setDefaultOptOutCookie();
										}
									}
								}
							};

							// Send the geo request.
							request.send();
						} else {
							// We found a CCPA applies cookie.
							if ( ccpaCookie === 'true' ) {
								if ( maybeCallDoNotSellCallback() ) {
									// Do Not Sell link added, so set default opt-in.
									setDefaultOptInCookie();
								} else {
									// Failed showing Do Not Sell link as required, so default to opt-OUT just to be safe.
									setDefaultOptOutCookie();
								}
							} else {
								// CCPA does not apply.
								setDefaultNotApplicableCookie();
							}
						}
					} );
				};

				// Kickoff initialization.
				if ( window.defQueue && defQueue.isLOHP && defQueue.isLOHP === 2020 ) {
					defQueue.items.push( setupPrivacy );
				} else {
					setupPrivacy();
				}

			} )();
		</script>

		<!-- CCPA [end] -->
		<div class="widget widget_eu_cookie_law_widget">
<div
	class="hide-on-button ads-active"
	data-hide-timeout="30"
	data-consent-expiration="180"
	id="eu-cookie-law"
	style="display: none"
>
	<form method="post">
		<input type="submit" value="Close and accept" class="accept" />

		Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br />
To find out more, including how to control cookies, see here:
				<a href="https://automattic.com/cookies/" rel="nofollow">
			Cookie Policy		</a>
 </form>
</div>
</div>	<div id="actionbar" style="display: none;"
			class="actnbr-pub-karuna actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://aaqeel01.wordpress.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				Malware Analysis			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																				<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="187688745" />
										<input type="hidden" name="source" value="https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="c156537066" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Faaqeel01.wordpress.com%2F2021%2F10%2F18%2Fzloader-reversing%2F&#038;signup_flow=account">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename">
			<a href="https://aaqeel01.wordpress.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				Malware Analysis			</a>
		</li>
								<li class="actnbr-folded-customize">
								<a href="https://aaqeel01.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Faaqeel01.wordpress.com%2F2021%2F10%2F18%2Fzloader-reversing%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"/></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-folded-follow">
												<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
										</li>
																	<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Faaqeel01.wordpress.com%2F2021%2F10%2F18%2Fzloader-reversing%2F&#038;signup_flow=account">Log in</a></li>
																	<li class="actnbr-shortlink"><a href="https://wp.me/pcHwpP-dg">Copy shortlink</a></li>
																	<li class="flb-report">
										<a href="https://wordpress.com/abuse/?report_url=https://aaqeel01.wordpress.com/2021/10/18/zloader-reversing/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader">
										<a href="https://wordpress.com/read/blogs/187688745/posts/822">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20241015";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/aaqeel01.wordpress.com\/2021\/10\/18\/zloader-reversing\/":822};
	</script>
				<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/_static/??-eJyljEsKgDAMBS9kDUUquhDPom0Qaz/BNHh9KdgTuBl4w2PgIWVzKpgKRFEU5DgTg8dCm72+DTHnCicBGex2Z2EMwM9JeKtdkgvYW+YOftTaqYkaXOOix8noQU+z8S9MR0BZ&cssminify=yes' type='text/css' media='all' />
<style id='core-block-supports-inline-css'>
.wp-block-gallery.wp-block-gallery-1{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-2{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-3{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-4{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-5{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-6{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-7{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-8{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-9{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-10{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-11{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-12{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-13{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-14{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-15{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-16{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-17{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-18{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-19{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-20{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-21{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-22{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-23{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-24{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-25{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}.wp-block-gallery.wp-block-gallery-26{--wp--style--unstable-gallery-gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );gap:var( --wp--style--gallery-gap-default, var( --gallery-block--gutter-size, var( --wp--style--block-gap, 0.5em ) ) );}
</style>
<script type="text/javascript" id="comment-like-js-extra">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading...","swipeUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/comment-likes\/js\/lib\/swipe.js?ver=20131008"};
/* ]]> */
</script>
<script type="text/javascript" id="coblocks-loader-js-extra">
/* <![CDATA[ */
var wpcom_coblocks_js = {"coblocks_masonry_js":"https:\/\/s2.wp.com\/wp-content\/plugins\/coblocks\/2.18.1-simple-rev.4\/dist\/js\/coblocks-masonry.min.js","coblocks_lightbox_js":"https:\/\/s2.wp.com\/wp-content\/plugins\/coblocks\/2.18.1-simple-rev.4\/dist\/js\/coblocks-lightbox.min.js","jquery_core_js":"\/wp-includes\/js\/jquery\/jquery.min.js","jquery_migrate_js":"\/wp-includes\/js\/jquery\/jquery-migrate.min.js","masonry_js":"\/wp-includes\/js\/masonry.min.js","imagesloaded_js":"\/wp-includes\/js\/imagesloaded.min.js"};
var coblocksLigthboxData = {"closeLabel":"Close Gallery","leftLabel":"Previous","rightLabel":"Next"};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/aaqeel01.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"b0bf3bec23","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/aaqeel01.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Faaqeel01.wordpress.com%2F2021%2F10%2F18%2Fzloader-reversing%2F","blog_id":"187688745","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=187688745&v=wpcom&tz=3&user_id=0&subd=aaqeel01","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/_static/??-eJydUttOwzAM/SFSaxfEXhCfgtzE7dzcSpys4+9Jt8GmgiaNt/jkHPv4AtOodAyZQoZBwMeWHakilLCvmOLQxWaQJ7jhtS72anSl5yAwxWTQiNIORUjmJBNmt9T4clWw6SkLUKm/0TIphxNk8qPDTAv8Th7HtrI/ChXaYzCO0h2yjt7P/ZxFwwJYCq+q2qu2AutmtWtWSriaJJXo0GzBsORzpjNJuYimmvAclvnynnwtO5YWLKYSEOZh5ZORgAfuMXN8SCWWx+o9WNVFXUR1fHxE3pWg55K/Or8Z2UB5RG0vcT2NGOCdg4a2sDOgMcV6J+6H9w38NYDbTVxoahrrDhbh/+3IHhPVSzSfpyeH/uLjzb+uXjab3fNmu94NX2WEGV8='></script>
<script type="text/javascript" id="jetpack-testimonial-theme-supports-js-after">
/* <![CDATA[ */
const jetpack_testimonial_theme_supports = false
/* ]]> */
</script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&amp;origin=https://aaqeel01.wordpress.com' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?67" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'187688745','blog_tz':'3','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'187688745','v':'wpcom','tz':'3','user_id':'0','post':'822','subd':'aaqeel01'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdTdGbjA/W2lOOVJ0flZiVUJqNzNDQnRaV3ZNOVhiVW4/ZHU1LTFNd1JwWDBKN009LmE0aE1LcHB0OHFdSG1sMGdoSyxaQlU4aSs/ZDJtVzNILE5dbTEwdTJqblQ1dUJxZ1hMTGowRkJhc1pQMl05MXpVRyZjZlNpc0ksLmxEN1VuaDF1OFJVUTcyRlJObkZzenZ4ZUZRcDY5NjV8MEVlWXBwb1tzfjJ3RlJsZmVLcFhEOFBSRF9PRVdiSisxTmYlLTc5V3VafHc1NlE/LU9YUkRIP3VDbkxweXVWNj1PcWF2JWY/bT1MREQvSls4L11oWWgvckVQcDcuQmZhWFFdLyt8UmFMdVhHTVlWOVpyaUdbTjZnNlJTQ3A/OUJwYXg='}]);
_stq.push([ 'clickTrackerInit', '187688745', '822' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur"  data-provider="wordpress.com" data-service="simple"   src="/wp-content/js/bilmur-4.min.js?i=12&m=202451"></script><div id="marketingbar" class="marketing-bar noskim  "><div class="marketing-bar-text">Design a site like this with WordPress.com</div><a class="marketing-bar-button" href="https://wordpress.com/start/?ref=marketing_bar">Get started</a><a class="marketing-bar-link" tabindex="-1" aria-label="Create your website at WordPress.com" href="https://wordpress.com/start/?ref=marketing_bar"></a></div>		<script type="text/javascript">
			window._tkq = window._tkq || [];

			window._tkq.push( [ 'recordEvent', 'wpcom_marketing_bar_impression', {"is_current_user_blog_owner":false} ] );

			document.querySelectorAll( '#marketingbar > a' ).forEach( link => {
				link.addEventListener( 'click', ( e ) => {
					window._tkq.push( [ 'recordEvent', 'wpcom_marketing_bar_cta_click', {"is_current_user_blog_owner":false} ] );
				} );
			});
		</script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
</body>
</html>
