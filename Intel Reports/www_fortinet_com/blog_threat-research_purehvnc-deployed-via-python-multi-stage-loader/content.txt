
    <!DOCTYPE HTML>
    <html lang="en" data-template="post-page">
    <head>
        
        
        
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/visitorapi.min.js"/>
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/at.js"/>
            <script>

                   ;(function(win, doc, style, timeout) {
                   var STYLE_ID = 'at-body-style';
                   function getParent() {
                      return doc.getElementsByTagName('head')[0];
                   }
                   function addStyle(parent, id, def) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.createElement('style');
                      style.id = id;
                      style.innerHTML = def;
                      parent.appendChild(style);
                   }
                   function removeStyle(parent, id) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.getElementById(id);
                      if (!style) {
                      return;
                      }
                      parent.removeChild(style);
                   }
                   addStyle(getParent(), STYLE_ID, style);
                   setTimeout(function() {
                      removeStyle(getParent(), STYLE_ID);
                   }, timeout);
                   }(window, document, "body {opacity: 0 !important}", 3000));
                </script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/visitorapi.min.js"></script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/at.js"></script>
        
        
    <meta charset="UTF-8"/>
    <title>PureHVNC Deployed via Python Multi-stage Loader | FortiGuard Labs</title>
    <meta name="keywords" content="FortiGuard Labs Threat Research,python"/>
    <meta name="description" content="FortiGuard Lab reveals a malware &#34;PureHVNC&#34;, sold on the cybercrime forum, is spreading through a phishing campaign targeting employees via a python multi-stage loader. Learn more."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="PureHVNC Deployed via Python Multi-stage Loader | FortiGuard Labs"/>
<meta property="og:url" content="https://www.fortinet.com/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="FortiGuard Lab reveals a malware &#34;PureHVNC&#34;, sold on the cybercrime forum, is spreading through a phishing campaign targeting employees via a python multi-stage loader. Learn more.…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-heros/purehvnc-python-multi-stage-loader-hero.png"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Yurren Wan"/>

    <meta property="article:section" content="FortiGuard Labs Threat Research"/>


    <meta property="article:published_time" content="2024-08-08T13:00:00.000Z"/>


    <meta property="article:tag" content="python"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>

<link rel="canonical" href="https://www.fortinet.com/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader"/>










    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.900b148ab7b87024003111a1245cca9c.css" type="text/css">





<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    



        <!-- BE IXF: BE IXF: Place getHeadOpen just inside of the head tag -->
        
        
<!-- be_ixf, sdk, gho-->
<meta name="be:sdk" content="java_sdk_1.6.7" />
<meta name="be:timer" content="30ms" />
<meta name="be:norm_url" content="https://www.fortinet.com/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader" />
<meta name="be:capsule_url" content="https://ixfd1-api.bc0a.com/api/ixf/1.0.0/get_capsule/f00000000310757/01085569060" />
<meta name="be:api_dt" content="pny_2024; pnm_10; pnd_22; pnh_11; pnmh_11; pn_epoch:1729620686854" />
<meta name="be:mod_dt" content="pny_1969; pnm_12; pnd_31; pnh_16; pnmh_00; pn_epoch:0" />
<meta name="be:orig_url" content="https://www.fortinet.com/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader" />
<meta name="be:messages" content="34256" /><script type='text/javascript'>
if (window.BEJSSDKObserver === undefined) {
  (function(BEJSSDKObserver, $, undefined) {
    var observer = void 0;
    var listeners = [];
    var readySet = [];
    var doc = window.document;
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

    function checkSelector(selector, fn, indexList) {
      var elements = doc.querySelectorAll(selector);
  /**
    issues on IE @see https://www.codesd.com/item/javascript-es6-not-a-function-error.html
    elements = Array.from(elements);

    */
    for (var i = 0, len = elements.length; i < len; i++) {
      /* -1 means all instances */
      if (indexList != -1 && !(i in indexList)) {
        continue;
      }
      var element = elements[i];
      for (var j = 0; j < readySet.length; j++) {
        if (readySet[j] == element.className || readySet[j] == element.id) {
          return;
        }
      }
      if (element.className) {
        readySet.push(element.className);
      }
      if (element.id) {
        readySet.push(element.id);
      }

      if (!element.ready || MutationObserver==null) {
        element.ready = true;
        fn.call(element, element);
      }
    }
  }

  function checkListeners() {
    listeners.forEach(function (listener) {
      return checkSelector(listener.selector, listener.fn, listener.indexList);
    });
  }

  function removeListener(selector, fn) {
    var i = listeners.length;
    while (i--) {
      var listener = listeners[i];
      if (listener.selector === selector && listener.fn === fn) {
        listeners.splice(i, 1);
        if (!listeners.length && observer) {
          observer.disconnect();
          observer = null;
        }
      }
    }
  }

/**
 * Fire event on first js selector
 * @param selector string to watch on
 * @param fn       callback function
 * @param index_list can be undefined which means only first one
 *                   or -1 which means all
 *                   or a list of allowable indexes
 */
 BEJSSDKObserver.jsElementReady = function(selector, fn, index_list) {
  if (index_list === undefined) {
    index_list = [];
    index_list.push(0);
  }

  if (MutationObserver != null) {
    if (!observer) {
      observer = new MutationObserver(checkListeners);
      observer.observe(doc.documentElement, {
        childList: true,
        subtree: true
      });
    }
    listeners.push({ selector: selector, fn: fn, indexList: index_list });
  } else {
    /* <= IE8 */
    if (!document.addEventListener) {
      /* log("<=IE8 attachEvent assignment"); */
      document.addEventListener = document.attachEvent;
    }
    document.addEventListener("DOMContentLoaded", function(event) {
      var elements = doc.querySelectorAll(selector);
      for (var i = 0, len = elements.length; i < len; i++) {
        /* -1 means all instances */
        if (index_list != -1 && !(i in index_list)) {
          continue;
        }
        var element = elements[i];
        element.ready = true;
        fn.call(element, element);
      }
    });
  }

  checkSelector(selector, fn, index_list);
  return function () {
    return removeListener(selector, fn);
  };
};
}(window.BEJSSDKObserver = window.BEJSSDKObserver || {}));
}
var jsElementReady = window.BEJSSDKObserver.jsElementReady;

if (window.BELinkBlockGenerator === undefined) {
  (function(BELinkBlockGenerator, $, undefined) {
    BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = 100;
    BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = 200;

    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE = 0;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE = 1;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE = 2;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE = 3;

    BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE = 0;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_POST_APPEND_ELEMENT = 1;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT = 2;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT = 3;

    BELinkBlockGenerator.setMaximumHeadlineLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = length;
    };

    BELinkBlockGenerator.setMaximumDescriptionLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = length;
    };

    BELinkBlockGenerator.generateIndividualLinks = function(parentElement, linkStructure, link) {
      var link_level_element_tag = linkStructure[0];
      var link_level_element = document.createElement(link_level_element_tag);
      var link_attribute_dictionary = linkStructure[1];
      var allowable_elements = linkStructure[2];
      var children_link_structures = linkStructure[3];
      for (var link_attribute_key in link_attribute_dictionary) {
        link_level_element.setAttribute(link_attribute_key, link_attribute_dictionary[link_attribute_key]);
      }

      var added_something = false;
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE)>=0) {
        link_level_element.setAttribute('href', link.url);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE)>=0 && link.h1) {
        var headline_text = link.h1;
        if (headline_text.length > BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) {
          headline_text = headline_text.substring(0, BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) + '...';
        }
        var text_node = document.createTextNode(headline_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE)>=0 && link.desc) {
        var desc_text = link.desc;
        if (desc_text.length > BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) {
          desc_text = desc_text.substring(0, BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) + '...';
        }
        var text_node = document.createTextNode(desc_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE)>=0 && link.image) {
        link_level_element.setAttribute('src', link.image);
        added_something = true;
      }
/**
    don't emit for empty links, desc, headline, image
    except for parent structures where allowable_length=0
    */
    if (!added_something && allowable_elements.length != 0) {

      return;
    }
    /* go depth first */
    for (var childrenIndex=0; childrenIndex<children_link_structures.length; childrenIndex++) {
      var childLinkStructure = children_link_structures[childrenIndex];
      BELinkBlockGenerator.generateIndividualLinks(link_level_element, childLinkStructure, link);
    }
    parentElement.appendChild(link_level_element);
  };

  BELinkBlockGenerator.insertLinkBlocks = function(targetElement, replacementStrategy, overallStructure, linkStructure, links,
                                                   titleStructure) {
    if (targetElement == null) {
      return;
    }

    if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE) {
      while (targetElement.firstChild) {
        targetElement.removeChild(targetElement.firstChild);
      }
    }

    var previousElement = targetElement;
    for (var i=0;i<overallStructure.length;i++) {
      var level_definition = overallStructure[i];
      var level_element_tag = level_definition[0];
      var level_element = document.createElement(level_element_tag);
      var attribute_dictionary = level_definition[1];
      for (var attribute_key in attribute_dictionary) {
        level_element.setAttribute(attribute_key, attribute_dictionary[attribute_key]);
      }

      /* need to place title structure */
      if (titleStructure && titleStructure[0] == i) {
        var title_element_tag = titleStructure[1];
        var title_element = document.createElement(title_element_tag);
        var title_attribute_dictionary = titleStructure[2];
        var title_text_content = titleStructure[3];
        for (var title_attribute_key in title_attribute_dictionary) {
          title_element.setAttribute(title_attribute_key, title_attribute_dictionary[title_attribute_key]);
        }

        var title_text_node = document.createTextNode(title_text_content);
        title_element.appendChild(title_text_node);


        level_element.appendChild(title_element);
      }

      /* last level place links */
      if (i == overallStructure.length-1) {
        for (var link_i=0; link_i < links.length; link_i++) {
          var link = links[link_i];
          for (var linkStructureIndex=0;linkStructureIndex < linkStructure.length; linkStructureIndex++) {
            BELinkBlockGenerator.generateIndividualLinks(level_element, linkStructure[linkStructureIndex], link)
          }
        }
      }

      /* first level child we need to check placement */
      if (previousElement == targetElement) {
        if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT) {
          /* 2 means insert right before */
          previousElement.insertBefore(level_element, targetElement.firstChild);
        } else if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT) {
          /* 3 means insert right before at parent level */
          var parentElement = previousElement.parentElement;
          parentElement.insertBefore(level_element, previousElement);
        } else {
          previousElement.appendChild(level_element);
        }
      } else {
        previousElement.appendChild(level_element);
      }
      previousElement = level_element;
    }
  };
}(window.BELinkBlockGenerator = window.BELinkBlockGenerator || {}))
};
</script>


        <!--BE IXF: Header End -->


    </head>
    <body class="table-of-content-body">
    



    
<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>FortiGuard Labs Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/life-at-fortinet">
                                <span>Life at Fortinet</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>FortiGuard Labs Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/life-at-fortinet">
                    <span>Life at Fortinet</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div id="blog-site-search" class="b1-header__search" aria-expanded="false"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <button class="b1-header__search-toggle" aria-controls="blog-site-search" aria-label="Search">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </button>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-heros/purehvnc-python-multi-stage-loader-hero.png);">
    <img class="ratio" alt="PureHVNC Deployed via Python Multi-stage Loader | FortiGuard Labs" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">FortiGuard Labs Threat Research</p>
        
        
        

        <h1 class="b4-hero__headline">PureHVNC Deployed via Python Multi-stage Loader</h1>
        
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                              <a href="/blog/search?author=Yurren+Wan">Yurren Wan</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | August 08, 2024</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="Table-Content aem-GridColumn aem-GridColumn--default--12">
<div class="blog-toc">
    <div class="b3-blog-list__row ">
        <div class="b3-blog-list__column-left table-content-wrapper automatic">
            <ul class="table-of-content">
                <li class="header"><img class="toc-icon" src="/content/dam/fortinet/images/toc-icon.jpg" alt=""/>Article Contents</li>
                
            </ul>
        </div>
        <div class="aem-GridColumn aem-GridColumn--default--8 b3-blog-list__column-right scrolling-content automatic">
            

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                              <a href="/blog/search?author=Yurren+Wan">Yurren Wan</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | August 08, 2024</span>
</div>

            




    
    
    <div class="cmp cmp-text">
  <p style="margin-left: 40.0px;"><b>Affected platforms: </b>Microsoft Windows<br />
<b> Impacted parties: </b>Any organization<br />
<b> Impact: </b>Attackers gain control of the infected systems<br />
<b> Severity level: </b>High</p>
<p>This past April, FortiGuard Labs uncovered a sophisticated attack that leveraged multiple layers of obfuscation and evasion techniques to distribute and execute VenomRAT via ScrubCrypt. However, this attack campaign didn’t end with VenomRAT, as the subsequently loaded plugin continued to deploy various types of malware into the victim’s environment.</p>
<p>We recently identified a phishing campaign that also employs multiple layers of evasion techniques to deploy various malware into an infected environment. This campaign was aimed at employees and posed as a customer requesting a service. The email uses urgent language to deceive a victim into clicking a malicious attachment, initiating a series of harmful activities and deploying several types of malware. All the malware in this attack uses the same packing and obfuscation techniques, including a Python obfuscator, ‘Kramer,’ a shellcode generator, 'donut,' and a shellcode loader, 'laZzzy,' to conceal itself from detection. The deployed malware includes XWorm, Venom RAT, AsyncRAT, and PureHVNC. Figure 1 shows the attack chain.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image.img.png/1722551803052/purehyvnc-1.png" data-title="Figure 1: Attack flow.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image.img.png/1722551803052/purehyvnc-1.png" alt="Attack flow diagram" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 1: Attack flow.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>This threat report describes how this attack is delivered and analyzes the PureHVNC malware used in this campaign.</p>
<h2>Initial Access</h2>
<p>The attack campaign starts with an email, shown in Figure 2. It implies that the inquiry email is from a customer and urges the recipient to open the attachment. This typical phishing email tactic uses job-related information and urgent language to deceive recipients into opening attachments or clicking links. </p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy.img.png/1722551988031/purehyvnc-2.png" data-title="Figure 2: The phishing e-mail.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy.img.png/1722551988031/purehyvnc-2.png" alt="The phishing email. The sender asks for a refund and attaches an HTML file, disguised as an invoice" style="width: 500px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 2: The phishing e-mail.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The attachment is an HTML file that uses the “search-ms” functionality to query the “e_Statement” LNK file on remote file shares, as shown in Figure 3. Once the user opens the HTML file and clicks on “Open” to allow Windows Explorer to open, the malicious LNK file is shown in Windows Explorer and lures the user into executing it using a PDF icon.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376.img.png/1722552040679/purehyvnc-3.png" data-title="Figure 3: HTML invoking “search-ms” URI protocol handler.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376.img.png/1722552040679/purehyvnc-3.png" alt="The HTML file code. It invokes the search-ms URI protocol handler" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 3: HTML invoking “search-ms” URI protocol handler.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The LNK file contains a command to run a remote batch file using conhost.exe as the parent process. The attacker attempts to leverage the built-in Windows binary 'conhost.exe' for indirect execution to evade detection, as shown in Figure 4.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1303116407.img.png/1722552071596/purehyvnc-4.png" data-title="Figure 4: LNK File.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1303116407.img.png/1722552071596/purehyvnc-4.png" alt="the LNK file" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 4: LNK File.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2>new.bat</h2>
<p>This is an obfuscated batch file that hides the script by combining encoding tricks and string obfuscation. The file looks like UTF-16 encoding with Chinese characters because the bytes (FF FE) at the beginning can mislead a file editor into incorrectly detecting the encoding. Next, it performs a large number of character replacement operations with the specific charset. The de-obfuscation process is shown in Figures 5 and 6.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1025429357.img.png/1722877187323/purehyvnc-new.png" data-title="Figure 5: Converting the contents of the Batch File by removing FF FE. ">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1025429357.img.png/1722877187323/purehyvnc-new.png" alt="Converting the contents of the Batch File by removing FF FE" style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 5: Converting the contents of the Batch File by removing FF FE. </span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1389421869.img.png/1722552172511/purehyvnc-6.png" data-title="Figure 6: De-obfuscating the Batch file by replacing characters. ">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1389421869.img.png/1722552172511/purehyvnc-6.png" alt="Unobfuscated batch file" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 6: De-obfuscating the Batch file by replacing characters. </span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The script begins by opening a decoy PDF file from the same remote file share. Next, it downloads two ZIP files via PowerShell, extracts all the content—including the Python Environment—into the folder &quot;%USERPOFILE%\Downloads\Python,&quot; sets the folder to hidden, and then runs the malicious Python program in sequence.</p>
<p>Next, the decoy PDF is re-opened, initiating a persistence routine to download a second batch file and move it to the startup folder. The second ZIP file, used by the startup batch and containing several Python programs similar to those in the previous ZIP, is extracted to the “%USERPOFILE%\Downloads\Print” folder. Before completing all tasks, any unnecessary programs from subsequent tasks are removed.</p>
<h2>Python Shellcode Loader</h2>
<p>Each Python file is quite similar, as shown below. First, it imports a Base64 module to decode shellcode data and then decrypts it using an RC4 algorithm with a specific key. Finally, the code executes shellcode using an imported “ctypes” module. It should be noted that the RC4 key varies in each Python file.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_478419250.img.png/1722552193478/purehyvnc-7.png" data-title="Figure 7: One of the Python files">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_478419250.img.png/1722552193478/purehyvnc-7.png" alt="One of the Python files" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 7: One of the Python files</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>By tracking the same series of samples, we discovered a new Python shellcode loader. It's a compiled version of a Python file with an additional obfuscation layer added.</p>
<p>The obfuscator, named &quot;<a href="https://github.com/billythegoat356/Kramer" target="_blank">Kramer</a>,&quot; is available on GitHub, as shown in Figure 8. It obfuscates a Python file by encrypting the source code using an addition operation with a randomly generated key. The resulting obfuscated Python program combines the encrypted data with functions that limit the use of print and input commands, decode the encryption data, and execute the original source code. Finally, the program is compiled into a .pyc file and renamed with a .py extension.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_1505399129.img.png/1722881751852/purehvnc-new-2.png" data-title="Figure 8: Python obfuscator ‘Kramer’">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_1505399129.img.png/1722881751852/purehvnc-new-2.png" alt="Python obfuscator ‘Kramer’" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 8: Python obfuscator ‘Kramer’</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>By extracting the key and encrypted data and following the decode function defined in the code, we obtained the source code. In this version, the code structure is similar, but the function names and variables are not obfuscated.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_472190827.img.png/1722881822889/purehvnc-new-3.png" data-title="Figure 9: De-obfuscating a new python shellcode loader ">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_472190827.img.png/1722881822889/purehvnc-new-3.png" alt="De-obfuscating a new python shellcode loader " style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 9: De-obfuscating a new python shellcode loader </span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h3>Shellcode Generator - Donut</h3>
<p>The first shellcode primarily functions to decrypt and execute the next stage while bypassing AMSI/WLDP based on its configuration. The hack tool, &quot;donut,&quot; produces the shellcode, as shown in Figure 10. Once the decryption routine is completed, the decrypted data in memory reveals the flag, the APIs used for bypass mechanisms, and the entire PE file for the next stage, as seen in Figure 11.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1426426873.img.png/1722881862873/purehyvnc-8.png" data-title="Figure 10: The syntax for donut.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1426426873.img.png/1722881862873/purehyvnc-8.png" alt="The donut shellcode generator syntax" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 10: The syntax for donut.</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_2007977278.img.png/1722881871888/purehyvnc-9.png" data-title="Figure 11: Decryption routine and decrypted data.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_2007977278.img.png/1722881871888/purehyvnc-9.png" alt="Decryption routine and decrypted data." style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 11: Decryption routine and decrypted data.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h3>Shellcode Loader - laZzzy</h3>
<p>The second stage is a PE file that uses the Microsoft Management Console (MMC) icon, a built-in Windows program, to disguise itself as a regular application while functioning as an injector. This injector includes detailed debug information. As the program runs, each step of the injection process is displayed on the command line, as shown in Figure 12.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1713600450.img.png/1722881902992/purehyvnc-10.png" data-title="Figure 12: Debug information on the command line">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1713600450.img.png/1722881902992/purehyvnc-10.png" alt="Debug information on the command line" style="width: 500px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 12: Debug information on the command line</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>We observed that a shellcode loader named &quot;<a href="https://github.com/capt-meelo/laZzzy" target="_blank">laZzzy</a>&quot; is publicly available on GitHub. It incorporates various execution techniques commonly used by malware and appears to be utilized in this stage for shellcode decryption, injection, and execution.</p>
<p>Ultimately, the program uses the target and execution techniques selected by the attacker to inject the shellcode into notepad.exe and executes the shellcode via Early Bird APC Queue, as shown in Figure 13.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_609938158.img.png/1722882083026/purehyvnc-11.png" data-title="Figure 13: The Shellcode is written to Notepad&#39;s memory space.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_609938158.img.png/1722882083026/purehyvnc-11.png" alt="The Shellcode is written to Notepad&#39;s memory space" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 13: The Shellcode is written to Notepad&#39;s memory space.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>The third stage involves a shellcode within notepad.exe, which is identical to the code found in the first shellcode. After decryption and bypassing AMSI/WLDP, the final payload is executed.</p>
<p>In the next section, we will focus on PureHVNC, one of the malware identified in this attack campaign, along with additional plugins downloaded by the malware.</p>
<h2>PureHVNC</h2>
<p>We observed an unusual malware packed and obfuscated in the Remote Access Trojans (RAT) used in this attack campaign. It’s a .NET application containing a substantial block of built-in data. Its primary function is to decrypt its payload using the AES algorithm and then decompress it with the Gzip method. Once the DLL payload is extracted and loaded into memory, it employs its hard-coded class and method names to execute the payload's entry point, as shown in Figure 14.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_751303102.img.png/1722882100616/purehyvnc-12.png" data-title="Figure 14: The primary function and the encrypted data">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_751303102.img.png/1722882100616/purehyvnc-12.png" alt="The primary function and the encrypted data" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 14: The primary function and the encrypted data</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>DLL Payload is protected by .NET Reactor, as seen in Figure 15. We partially de-obfuscated the program and renamed the functions. Its entry point was very easy to understand. After creating a mutex, the core function is then executed. </p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1197803592.img.png/1722882115970/purehyvnc-13.png" data-title="Figure 15: DLL is protected by .NET Reactor">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1197803592.img.png/1722882115970/purehyvnc-13.png" alt="DLL is protected by .NET Reactor" style="width: 550px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 15: DLL is protected by .NET Reactor</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>In its core functionality, the program initially extracts the hardcoded configuration by performing base64 decoding followed by gzip decompression. Based on the flags in the configuration, it either sets the registry run key using PowerShell or prevents the system from sleeping by utilizing the Win32 API function, “<b>SetThreadExecutionState,</b>” as seen in Figure 16.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1373686275.img.png/1722891335113/purehyvnc-14.png" data-title="Figure 16: Initial setup according to the configuration">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1373686275.img.png/1722891335113/purehyvnc-14.png" alt="Initial setup according to the configuration" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 16: Initial setup according to the configuration</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Next, it attempts to communicate with the C2 server specified in the extracted configuration. Once the connection is established, it begins gathering victim information and reporting it to the C2 server, as shown in Figure 17. It abuses the Windows Management Instrumentation (WMI) system to gather information about the victim's system environment, including installed antivirus products, system and camera details, and user information. The VictimID is generated from the processor ID, disk serial number, memory serial number, and username.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1606215095.img.png/1722891375467/purehyvnc-15.png" data-title="Figure 17: Information collected from the victim’s computer is sent to C&amp;C server">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1606215095.img.png/1722891375467/purehyvnc-15.png" alt="Information collected from the victim’s computer is sent to C&amp;C server" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 17: Information collected from the victim’s computer is sent to C&amp;C server</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Additionally, the program searches for the paths of various extensions and applications based on a predefined list, as shown in Figures 18 and 19. Some applications also check the registry path to verify their installation. This list specifically targets crypto wallets, password managers, two-factor authenticators, and popular communication programs. </p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1310345400.img.png/1722891404646/purehyvnc-16.png" data-title="Figure 18: Extension list and targeted browser folder">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1310345400.img.png/1722891404646/purehyvnc-16.png" alt="Extension list and targeted browser folder" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 18: Extension list and targeted browser folder</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1354495108.img.png/1722891450148/purehyvnc-17.png" data-title="Figure 19: Targeted applications">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1354495108.img.png/1722891450148/purehyvnc-17.png" alt="Targeted applications" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 19: Targeted applications</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>After all the specified information is collected, it is sent to the C2 server to await further plugin loading. Figure 20 illustrates a method for handling incoming data from the C2 server after it has been preprocessed using gunzip and deserialization. When the program receives the plugin, it writes the plugin data and ID into the Windows Registry under the affected user’s HKEY_CURRENT_USER\Software\{VictimID}. The plugin data is then extracted, loaded into memory, and executed.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_306787936.img.png/1722891469077/purehyvnc-18.png" data-title="Figure 20: A method for handling Plugin">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_306787936.img.png/1722891469077/purehyvnc-18.png" alt="A method for handling Plugin" style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 20: A method for handling Plugin</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Our analysis identified some details that helped us pinpoint the malware family. The same information appeared in the subsequently downloaded plugin, as seen below.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_869714817.img.png/1722891479127/purehyvnc-19.png" data-title="Figure 21: The code refers to the PureHVNC Library.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_869714817.img.png/1722891479127/purehyvnc-19.png" alt="The code refers to the PureHVNC Library." style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 21: The code refers to the PureHVNC Library.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>In the following sections, we’ll elaborate on the plugins provided by the PureHVNC C2 server, which are obfuscated using the .NET Reactor.</p>
<h2>Plugin 1 - PluginRemoteDesktop</h2>
<p>The initial plugin we received from the threat actor is a DLL file named “PluginRemoteDesktop.” As Figure 22 shows, its entry method is executed with the binary as a parameter to provide the module with C2 information. After extracting the C2 details, it communicates with the C2 server and executes the Remote Desktop function.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1927554280.img.png/1722891498713/purehyvnc-20.png" data-title="Figure 22: Entry point of PluginRemoteDesktop">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_1927554280.img.png/1722891498713/purehyvnc-20.png" alt="Entry point of PluginRemoteDesktop" style="width: 550px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 22: Entry point of PluginRemoteDesktop</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Figure 23 shows one of the mouse-controlled functions and the APIs used by the RemoteDesktop program.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_5700855.img.png/1722891545289/purehyvnc-21.png" data-title="Figure 23: The mouse-controlled functions and APIs.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_5700855.img.png/1722891545289/purehyvnc-21.png" alt="The mouse-controlled functions and APIs." style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 23: The mouse-controlled functions and APIs.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2>Plugin 2 – PluginExecuting</h2>
<p>PluginExecuting is a module responsible for executing additional files, updating the program, and even uninstalling malware. It follows a process similar to that of PluginRemoteDesktop at the entry point, using the C2 information extracted from parameters to communicate with the C2 server. It then waits to receive a packet to trigger the execution of the core function.</p>
<p>The core function acts as a handler to process different commands based on their type. It supports six types of command, as illustrated in Table 1.</p>
<table border="1" cellspacing="0" cellpadding="10" style="margin-top: 20.0px;">
<tbody><tr><th valign="top"><p>Command</p>
</th>
<th valign="top"><p>Details</p>
</th>
</tr><tr><td valign="top"><p><b>DownloadAndExecuteDisk</b></p>
</td>
<td valign="top"><p>Execute a downloaded file</p>
</td>
</tr><tr><td valign="top"><p><b>DownloadAndUpdate</b></p>
</td>
<td valign="top"><p>Remove the current module and execute the downloaded file.</p>
</td>
</tr><tr><td valign="top"><p><b>UninstallConnection</b></p>
</td>
<td valign="top"><p>Delete the registry entry HKEY_CURRENT_USER\Software\{VictimID}, and remove the malware if it is not located in the %WINDOWS% folder.</p>
</td>
</tr><tr><td valign="top"><p><b>RestartConnection</b></p>
</td>
<td valign="top"><p>Start a new instance of the current module and terminate the existing process.</p>
</td>
</tr><tr><td valign="top"><p><b>CloseConnection</b></p>
</td>
<td valign="top"><p>Terminate the current process.</p>
</td>
</tr><tr><td valign="top"><p><b>DownloadAndExecuteMemory</b></p>
</td>
<td valign="top"><p>Run the downloaded payload in the designated process.</p>
</td>
</tr></tbody></table>
<p style="text-align: center;"><i>Table 1: Commands</i></p>
<p style="text-align: left;">PluginExecuting contains several important commands, particularly those related to downloading. Figure 24 illustrates the command used to create a hidden process that executes the downloaded file. These commands combine with a batch file to achieve both file deletion and execution, as shown in Figure 25.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_2108786718.img.png/1722891576831/purehyvnc-22.png" data-title="Figure 24: Command related to downloading.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_2108786718.img.png/1722891576831/purehyvnc-22.png" alt="Command related to downloading." style="width: 600px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 24: Command related to downloading.</span>


    
</div>


    
    
    <div class="cmp cmp-text"><p class="cq-text-placeholder-ipe" data-emptytext="Text">
  
</p>
</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_815896792.img.png/1722891583832/purehyvnc-23.png" data-title="Figure 25: Batch File for file deletion and execution.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_815896792.img.png/1722891583832/purehyvnc-23.png" alt="Batch File for file deletion and execution." style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 25: Batch File for file deletion and execution.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <p>Additionally, the <b>DownloadAndExecuteMemory</b> command requires a binary and a target name as parameters. It injects the malicious binary into a specified target process using process hollowing and then resumes the injected process to execute the malicious code.</p>


</div>


    
    
    <div class="cmp cmp-image">

    
    <div class="image-enlarge">
        <a class="cmp-image--link" href="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_652431957.img.png/1722891604218/purehyvnc-24.png" data-title="Figure 26: Execute malicious code using Process Hollowing.">
            <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
                <img src="/blog/threat-research/purehvnc-deployed-via-python-multi-stage-loader/_jcr_content/root/responsivegrid/table_content/par/image_copy_475885376_652431957.img.png/1722891604218/purehyvnc-24.png" alt="Execute malicious code using Process Hollowing." style="width: 700px;" class="custom"/>
                
            </noscript>
        </a>
    </div>
    <!--<div class="enlarge-btn" data-sly-test="true"><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    <span class="cmp-image--title">Figure 26: Execute malicious code using Process Hollowing.</span>


    
</div>


    
    
    <div class="cmp cmp-text">
  <h2>Conclusion</h2>
<p>Deploying multiple types of malware in an attack campaign is not unusual. In this case, the threat actor also uses complex, multilayer encryption to avoid detection across all the malware used in this campaign.</p>
<p>In this article, we uncovered a phishing campaign targeting employees that employs a multi-stage execution flow and utilizes public hacking tools to evade detection. We also focused on one obfuscated payload, &quot;PureHVNC,&quot; detailing its functions and the additional plugins collected. Our observations indicate that it targets crypto wallets, password managers, and 2FA authenticators. Finally, it can carry out further attacks using its RemoteDesktop and Executing plugins.</p>
<h2>Fortinet Protections</h2>
<p>The malware described in this report are detected and blocked by <a href="https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/antivirus">FortiGuard Antivirus</a> as:</p>
<p style="margin-left: 40.0px;">HTML/Phishing.3771!tr<br />
LNK/Agent.1B2F!tr<br />
BAT/Agent.PSCL!tr<br />
Python/Agent.PSCL!tr<br />
MSIL/Agent.DWN!tr<br />
MSIL/Agent.CFQ!tr<br />
MSIL/Agent.DWN!tr<br />
MSIL/Bladabindi.SSNY!tr<br />
MSIL/GenericKD.61253965!tr<br />
MSIL/Agent.7C2C!tr<br />
MSIL/Agent.PEP!tr.dldr</p>
<p>FortiGate, FortiMail, FortiClient, and FortiEDR support the FortiGuard Antivirus Service. The FortiGuard antivirus engine is part of each of those solutions. As a result, customers who have these products with up-to-date protections are protected.</p>
<p>The <a href="https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/content-disarm-reconstruction?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortiguard=cdr">FortiGuard CDR</a> (content disarm and reconstruction) service can disarm the malicious macros within the document.</p>
<p>We also suggest that organizations take the free Fortinet <a href="https://www.fortinet.com/nse-training?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortinet-fcf">Fortinet Certified Fundamentals (FCF)</a> cybersecurity training. The training is designed to help users learn about today's threat landscape and introduces basic cybersecurity concepts and technology.</p>
<p><a href="https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/ipreputation-antibot?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortiguard-ip-rep">FortiGuard IP Reputation</a> and <a href="https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/ipreputation-antibot?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=fortiguard-ip-rep">Anti-Botnet Security Service</a> proactively block malware attacks by aggregating malicious source IP data from the Fortinet distributed network of threat sensors, CERTs, MITRE, cooperative competitors, and other global sources that collaborate to provide up-to-date threat intelligence about hostile sources.</p>
<p>If you believe this or any other cybersecurity threat has impacted your organization, please contact the Global <a href="https://www.fortinet.com/corporate/about-us/contact-us/experienced-a-breach?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=">FortiGuard Incident Response Team</a>.</p>
<h2>IOCs</h2>
<h3>C2</h3>
<p>drvenomjh[.]duckdns[.]org</p>
<p>vxsrwrm[.]duckdns[.]org</p>
<p>ncmomenthv[.]duckdns[.]org</p>
<p>ghdsasync[.]duckdns[.]org</p>
<p>anachyyyyy[.]duckdns[.]org</p>
<p>xoowill56[.]duckdns[.]org</p>
<h3>URLs</h3>
<p>hxxps://float-suppose-msg-pulling[.]trycloudflare[.]com/</p>
<h3>Files</h3>
<p>16a4de0540181bab7c5d25fcdf90838a28f2dff4ed9e0e37de3f5f1ab20afe0a</p>
<p>062c5f5e9cdfd731912b262297e963b6d5e1b1d114184728065522f46a5eef2f</p>
<p>2b7ee0ccfa45d2f53098cd8aa4ce73cb00ace462d8490e6843bf05cd07854553</p>
<p>430300b8c527259805d29ab3fd150d9d297004ff77346cc07753290d84e77e95</p>
<p>503ce7bcefdffb96b5de78254f947598a410b86d3aaf597c7334e248c46dae5b</p>
<p>55134d705ccf881d011af949ad2fc0aa80dc7af50fa4a9db29b665647b869aec</p>
<p>561f4b4e2c16f21b0db015819340fc59484e4994022c4cca46cf778006d5d441</p>
<p>6b4f058ba41e829ff993e61b288e55552af3d98f9cd62483eeff088b26f6ab9b</p>
<p>71b797032458aab9b4a1a203e7ca413f009af1961cffb98590e34f672574599a</p>
<p>7292316900a0971aec0a302bc3c6632902d820804ce3b2375a9953744cab1bd9</p>
<p>72ce64d50f9aa15b21631307d2143f426364634a7a2ee4b401ef76bd88c4ff3b</p>
<p>8bbdd3b41a03b86f246564a23e9acd48f74428f372c4bfb0a9a3af42511661c7</p>
<p>8d28191f647572d5e159f35ae55120ddf56209a18f2ca95a28d3ca9408b90d68</p>
<p>90995c621718ae65ca0af4deb10a9cb895bd494df40a7b34031b17efcc63114a</p>
<p>b393323b9834656a2999198d4f02c1a159c6034d3c20c483d22a30aab3810c0c</p>
<p>b3bb7064af80abef417e6e7775a7e14b0bd27233fd66c2252e714a4dd2ee9c21</p>
<p>d4e8bf427c196d1d5ffca52a5af7162cc5cf4df730ee3fe65b4381ac79662a15</p>
<p>e5f7efb35b7316c7ace1c322559fa9a8680ddb1ac15bef7d17e5b84c767f5b75</p>
<p>95a33ba5550747baf72e39b020e6215b6047983eda17250408cd6f4c16a93089</p>
<p>1967661f7c32607f7cfcb9053aeb8dea0a9d8f49979e729be77a43628c91469f</p>
<p>7c4e613cf4db19f54030097687227809f965a951a26a44a882692ece6e642e3c</p>
<p>441c4502584240624f4af6d67eded476c781ff0b72afe95ea236cc87a50e5650</p>


</div>


    
    
    <div class="raw-import">
<div class="text-container"><style>
h3 {
font-size: 2.2rem;
}
</style></div>
</div>



        </div>
    </div>
</div>
</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container" style="display:none">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=python">python</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/threat-research/debugging-postscript-with-ghostscript" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/debugging-postscript-with-ghostscript-thumb.jpg.thumb.319.319.png);">
                <img class="ratio" alt="Debugging PostScript with Ghostscript" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Debugging PostScript with Ghostscript</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/python-based-malware-uses-nsa-exploit-to-propagate-monero--xmr--" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/python_based_malware_uses_nsa_exploit/018_pythonm.png.thumb.319.319.png);">
                <img class="ratio" alt="Python-Based Malware Uses NSA Exploit to Propagate Monero (XMR) Miner" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Python-Based Malware Uses NSA Exploit to Propagate Monero (XMR) Miner</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/threat-research/badpatch-campaign-uses-python-malware" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/badpatch-campaign/badpatch-fifteen.png.thumb.319.319.png);">
                <img class="ratio" alt="Possible New BadPatch Campaign Uses Multi-Component Python Compiled Malware" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    FortiGuard Labs Threat Research
                </p>
                <h5 class="b12-related__title">Possible New BadPatch Campaign Uses Multi-Component Python Compiled Malware</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  
  
 </div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.x.com/Fortinet" target="_blank">
                
    <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"/>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/channel/UCJHo4AuVomwMRzgkA5DQEOA?sub_confirmation=1" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/fortinet/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware Prevention</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="https://community.fortinet.com/" target="_blank">Fortinet Community</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/partners/partner-program/become-a-fortinet-partner" target="_blank">Partner Portal</a>
              </li>
            
              <li>
                <a href="https://investor.fortinet.com/" target="_blank">Investor Relations</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications" target="_blank">Product Certifications</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/nse-training" target="_self">Training</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards" target="_self">Industry Awards</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/corporate-social-responsibility" target="_self">Social Responsibility</a>
              </li>
            
              <li>
                <a href="/resources/cyberglossary" target="_self">CyberGlossary</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/sitemap" target="_self">Sitemap</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/blog/blog-sitemap" target="_self">Blog Sitemap</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2024 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>


    
    
    
    
    
<script src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.ba4f082a77dabb2c6baf715d9eb61c22.js"></script>





    


    

    <!-- BE IXF: The following <div> block needs to be placed in the location where the link block will be displayed
    BE IXF: For your website, the location is above/below ...-->
    <div class="be-ix-link-block">
        <!--
   be_sdkms_pub:bec-built-in; bec-built-in_1.0.0; bodystr;
   be_sdkms_date_modified:pn_tstr:Wed Oct 23 19:12:49 UTC 2024; pn_epoch:1729710769800;
   be_sdkms_timer: 0;
-->

        
    </div>
    <!-- BE IXF: Footer End -->
    </body>
    </html>
