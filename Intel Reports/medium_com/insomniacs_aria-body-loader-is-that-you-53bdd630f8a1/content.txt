<!doctype html><html lang="en"><head><title data-rh="true">Aria-Body Loader? Is that you?. Hello! This is my first time writing a… | by BlueMonkey | insomniacs | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-09-29T06:28:34.425Z"/><meta data-rh="true" name="title" content="Aria-Body Loader? Is that you?. Hello! This is my first time writing a… | by BlueMonkey | insomniacs | Medium"/><meta data-rh="true" property="og:title" content="Aria-Body Loader? Is that you?"/><meta data-rh="true" property="al:android:url" content="medium://p/53bdd630f8a1"/><meta data-rh="true" property="al:ios:url" content="medium://p/53bdd630f8a1"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field and I am trying to do a research into cobalt strike. Recently…"/><meta data-rh="true" property="og:description" content="Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field…"/><meta data-rh="true" property="og:url" content="https://medium.com/insomniacs/aria-body-loader-is-that-you-53bdd630f8a1"/><meta data-rh="true" property="al:web:url" content="https://medium.com/insomniacs/aria-body-loader-is-that-you-53bdd630f8a1"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:280/1*1fDVGzUIIlQUFCVbTsr8EQ.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@bluebluemonkey0"/><meta data-rh="true" name="author" content="BlueMonkey"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Aria-Body Loader? Is that you?"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/53bdd630f8a1"/><meta data-rh="true" property="twitter:description" content="Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:280/1*1fDVGzUIIlQUFCVbTsr8EQ.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@bluebluemonkey0"/><link data-rh="true" rel="canonical" href="https://medium.com/insomniacs/aria-body-loader-is-that-you-53bdd630f8a1"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/53bdd630f8a1"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*1fDVGzUIIlQUFCVbTsr8EQ.png"],"url":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Faria-body-loader-is-that-you-53bdd630f8a1","dateCreated":"2021-09-29T06:28:34.425Z","datePublished":"2021-09-29T06:28:34.425Z","dateModified":"2022-01-05T05:35:13.864Z","headline":"Aria-Body Loader? Is that you? - insomniacs - Medium","name":"Aria-Body Loader? Is that you? - insomniacs - Medium","description":"Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field and I am trying to do a research into cobalt strike. Recently…","identifier":"53bdd630f8a1","author":{"@type":"Person","name":"BlueMonkey","url":"https:\u002F\u002Fmedium.com\u002F@bluebluemonkey0"},"creator":["BlueMonkey"],"publisher":{"@type":"Organization","name":"insomniacs","url":"https:\u002F\u002Fmedium.com\u002Finsomniacs","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*IvMGfHVzEtZei5I-JouCvw.jpeg"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Faria-body-loader-is-that-you-53bdd630f8a1"}</script><style type="text/css" data-fela-rehydration="569" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="569" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:rgba(26, 137, 23, 1)}.es{border-color:rgba(26, 137, 23, 1)}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:rgba(26, 137, 23, 1)}.ez:disabled:hover{border-color:rgba(26, 137, 23, 1)}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-left:-12px}.ii{width:28px}.ij{height:28px}.ik{z-index:1}.il{width:24px}.im{margin-bottom:2px}.in{flex-wrap:nowrap}.io{font-size:16px}.ip{line-height:24px}.ir{margin:0 8px}.is{display:inline}.it{color:rgba(26, 137, 23, 1)}.iu{fill:rgba(26, 137, 23, 1)}.ix{flex:0 0 auto}.ja{flex-wrap:wrap}.jd{white-space:pre-wrap}.je{margin-right:4px}.jf{overflow:hidden}.jg{max-height:20px}.jh{text-overflow:ellipsis}.ji{display:-webkit-box}.jj{-webkit-line-clamp:1}.jk{-webkit-box-orient:vertical}.jl{word-break:break-all}.jn{padding-left:8px}.jo{padding-right:8px}.kp> *{flex-shrink:0}.kq{overflow-x:scroll}.kr::-webkit-scrollbar{display:none}.ks{scrollbar-width:none}.kt{-ms-overflow-style:none}.ku{width:74px}.kv{flex-direction:row}.kw{z-index:2}.kz{-webkit-user-select:none}.la{border:0}.lb{fill:rgba(117, 117, 117, 1)}.le{outline:0}.lf{user-select:none}.lg> svg{pointer-events:none}.lp{cursor:progress}.lq{opacity:1}.lr{padding:4px 0}.lu{margin-top:0px}.lv{width:16px}.lx{display:inline-flex}.md{max-width:100%}.me{padding:8px 2px}.mf svg{color:#6B6B6B}.mw{line-height:1.58}.mx{letter-spacing:-0.004em}.my{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nt{margin-bottom:-0.46em}.nu{box-shadow:inset 3px 0 0 0 #242424}.nv{padding-left:23px}.nw{margin-left:-20px}.nx{font-style:italic}.ny{line-height:1.18}.nz{letter-spacing:-0.022em}.oa{font-weight:600}.oq{margin-bottom:-0.31em}.ow{clear:both}.pc{margin-left:auto}.pd{margin-right:auto}.pe{max-width:1897px}.pk{padding-top:5px}.pl{padding-bottom:5px}.pn{cursor:zoom-in}.po{z-index:auto}.pq{height:auto}.pr{margin-top:10px}.ps{max-width:728px}.pv{max-width:1708px}.pw{max-width:1900px}.px{max-width:624px}.py{max-width:602px}.pz{max-width:472px}.qa{max-width:280px}.qb{max-width:780px}.qc{max-width:471px}.qd{max-width:580px}.qe{max-width:615px}.qf{max-width:656px}.qg{max-width:384px}.qh{max-width:826px}.qi{max-width:1193px}.qj{max-width:312px}.qk{max-width:462px}.ql{max-width:648px}.qm{max-width:307px}.qn{max-width:660px}.qo{margin-top:32px}.qp{margin-bottom:14px}.qq{padding-top:24px}.qr{padding-bottom:10px}.qs{background-color:#000000}.qt{height:3px}.qu{width:3px}.qv{margin-right:20px}.qw{margin-bottom:26px}.qx{margin-top:6px}.qy{margin-top:8px}.qz{margin-right:8px}.ra{padding:8px 16px}.rb{border-radius:100px}.rc{transition:background 300ms ease}.re{white-space:nowrap}.rf{border-top:none}.rg{height:52px}.rh{max-height:52px}.ri{box-sizing:content-box}.rj{position:static}.rl{max-width:155px}.rw{height:0px}.rx{margin-bottom:40px}.ry{margin-bottom:48px}.sm{border-radius:2px}.so{height:64px}.sp{width:64px}.sq{align-self:flex-end}.sr{flex:1 1 auto}.sv{padding-right:4px}.sw{font-weight:500}.td{margin-top:16px}.te{color:rgba(255, 255, 255, 1)}.tf{fill:rgba(255, 255, 255, 1)}.tg{background:rgba(25, 25, 25, 1)}.th{border-color:rgba(25, 25, 25, 1)}.tk:disabled{opacity:0.1}.tl:disabled:hover{background:rgba(25, 25, 25, 1)}.tm:disabled:hover{border-color:rgba(25, 25, 25, 1)}.tn{margin-bottom:54px}.ug{gap:18px}.uh{fill:rgba(61, 61, 61, 1)}.ut{border-bottom:solid 1px #E5E5E5}.uu{margin-top:72px}.uv{padding:24px 0}.uw{margin-bottom:0px}.ux{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:rgba(15, 115, 12, 1)}.eu:hover{border-color:rgba(15, 115, 12, 1)}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.iq:hover{text-decoration:underline}.iv:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.iw:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.ld:hover{fill:rgba(8, 8, 8, 1)}.ls:hover{fill:#000000}.lt:hover p{color:#000000}.lw:hover{color:#000000}.mg:hover svg{color:#000000}.rd:hover{background-color:#F2F2F2}.sn:hover{background-color:none}.ti:hover{background:#000000}.tj:hover{border-color:#242424}.ui:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.lc:focus{fill:rgba(8, 8, 8, 1)}.mh:focus svg{color:#000000}.pp:focus{transform:scale(1.01)}.lh:active{border-style:none}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.kb{border-top:solid 1px #F2F2F2}.kc{border-bottom:solid 1px #F2F2F2}.kd{margin:32px 0 0}.ke{padding:3px 8px}.kn> *{margin-right:24px}.ko> :last-child{margin-right:0}.lo{margin-top:0px}.mc{margin:0}.np{font-size:20px}.nq{margin-top:2.14em}.nr{line-height:32px}.ns{letter-spacing:-0.003em}.on{margin-top:1.72em}.oo{line-height:24px}.op{letter-spacing:0}.ov{margin-top:0.94em}.pb{max-width:1192px}.pj{margin-top:56px}.rq{display:inline-block}.rv{margin-bottom:104px}.rz{flex-direction:row}.sc{margin-bottom:0}.sd{margin-right:20px}.ss{max-width:500px}.ts{margin-bottom:72px}.ud{font-size:24px}.ue{line-height:30px}.uf{letter-spacing:-0.016em}.un{margin:40px 0 0}.us{padding-top:72px}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ln{margin-top:0px}.pt{margin-left:auto}.pu{text-align:center}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.lm{margin-top:0px}.ro{display:inline-block}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.lk{margin-top:0px}.ll{margin-right:0px}.rn{display:inline-block}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.iy{flex-direction:column}.jb{margin-bottom:2px}.jp{margin:24px -24px 0}.jq{padding:0}.kf> *{margin-right:8px}.kg> :last-child{margin-right:24px}.kx{margin-left:0px}.li{margin-top:0px}.lj{margin-right:0px}.ly{margin:0}.mi{border:1px solid #F2F2F2}.mj{border-radius:99em}.mk{padding:0px 16px 0px 12px}.ml{height:38px}.mm{align-items:center}.mo svg{margin-right:8px}.mz{font-size:18px}.na{margin-top:1.56em}.nb{line-height:28px}.nc{letter-spacing:-0.003em}.ob{font-size:16px}.oc{margin-top:1.23em}.od{letter-spacing:0}.or{margin-top:0.67em}.ox{max-width:100%}.pf{margin-top:40px}.rm{display:inline-block}.rr{margin-bottom:96px}.sk{margin-bottom:20px}.sl{margin-right:0}.sx{font-size:24px}.sy{line-height:30px}.sz{letter-spacing:-0.016em}.to{margin-bottom:64px}.tt{font-size:20px}.tu{line-height:24px}.uj{margin:32px 0 0}.uo{padding-top:48px}.mn:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jx{border-top:solid 1px #F2F2F2}.jy{border-bottom:solid 1px #F2F2F2}.jz{margin:32px 0 0}.ka{padding:3px 8px}.kl> *{margin-right:24px}.km> :last-child{margin-right:0}.mb{margin:0}.nl{font-size:20px}.nm{margin-top:2.14em}.nn{line-height:32px}.no{letter-spacing:-0.003em}.ok{margin-top:1.72em}.ol{line-height:24px}.om{letter-spacing:0}.ou{margin-top:0.94em}.pa{max-width:1192px}.pi{margin-top:56px}.ru{margin-bottom:104px}.sa{flex-direction:row}.se{margin-bottom:0}.sf{margin-right:20px}.st{max-width:500px}.tr{margin-bottom:72px}.ua{font-size:24px}.ub{line-height:30px}.uc{letter-spacing:-0.016em}.um{margin:40px 0 0}.ur{padding-top:72px}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jt{border-top:solid 1px #F2F2F2}.ju{border-bottom:solid 1px #F2F2F2}.jv{margin:32px 0 0}.jw{padding:3px 8px}.kj> *{margin-right:24px}.kk> :last-child{margin-right:0}.ma{margin:0}.nh{font-size:20px}.ni{margin-top:2.14em}.nj{line-height:32px}.nk{letter-spacing:-0.003em}.oh{margin-top:1.72em}.oi{line-height:24px}.oj{letter-spacing:0}.ot{margin-top:0.94em}.oz{max-width:100%}.ph{margin-top:56px}.rt{margin-bottom:104px}.sb{flex-direction:row}.sg{margin-bottom:0}.sh{margin-right:20px}.su{max-width:500px}.tq{margin-bottom:72px}.tx{font-size:24px}.ty{line-height:30px}.tz{letter-spacing:-0.016em}.ul{margin:40px 0 0}.uq{padding-top:72px}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iz{flex-direction:column}.jc{margin-bottom:2px}.jr{margin:24px 0 0}.js{padding:0}.kh> *{margin-right:8px}.ki> :last-child{margin-right:8px}.ky{margin-left:0px}.lz{margin:0}.mp{border:1px solid #F2F2F2}.mq{border-radius:99em}.mr{padding:0px 16px 0px 12px}.ms{height:38px}.mt{align-items:center}.mv svg{margin-right:8px}.nd{font-size:18px}.ne{margin-top:1.56em}.nf{line-height:28px}.ng{letter-spacing:-0.003em}.oe{font-size:16px}.of{margin-top:1.23em}.og{letter-spacing:0}.os{margin-top:0.67em}.oy{max-width:100%}.pg{margin-top:40px}.rs{margin-bottom:96px}.si{margin-bottom:20px}.sj{margin-right:0}.ta{font-size:24px}.tb{line-height:30px}.tc{letter-spacing:-0.016em}.tp{margin-bottom:64px}.tv{font-size:20px}.tw{line-height:24px}.uk{margin:32px 0 0}.up{padding-top:48px}.mu:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="print">.rk{display:none}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.jm{max-height:none}</style><style type="text/css" data-fela-rehydration="569" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.pm{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F53bdd630f8a1&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="7ef8" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Aria-Body Loader? Is that you?</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@bluebluemonkey0?source=post_page---byline--53bdd630f8a1--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="BlueMonkey" class="l fd by dd de cx" src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*94UAOTxSHRGvdf2F" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div><div class="ih ab fj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/insomniacs?source=post_page---byline--53bdd630f8a1--------------------------------" rel="noopener follow"><div class="l ii ij by id ik"><div class="l fj"><img alt="insomniacs" class="l fd by br il cx" src="https://miro.medium.com/v2/resize:fill:48:48/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="if by l br il fs n ig ft"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="im ab q"><div class="ab q in"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b io ip bk"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" data-testid="authorName" rel="noopener follow" href="/@bluebluemonkey0?source=post_page---byline--53bdd630f8a1--------------------------------">BlueMonkey</a></p></div></div></div><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b io ip du"><span><a class="it iu ah ai aj ak al am an ao ap aq ar ex iv iw" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffbbbb2c84e9a&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;user=BlueMonkey&amp;userId=fbbbb2c84e9a&amp;source=post_page-fbbbb2c84e9a--byline--53bdd630f8a1---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l ix"><span class="bf b bg z du"><div class="ab cn iy iz ja"><div class="jb jc ab"><div class="bf b bg z du ab jd"><span class="je l ix">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar iq ab q" data-testid="publicationName" href="https://medium.com/insomniacs?source=post_page---byline--53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b bg z jf jg jh ji jj jk jl jm bk">insomniacs</p></a></div></div></div><div class="h k"><span class="ir is" aria-hidden="true"><span class="bf b bg z du">·</span></span></div></div><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="jn jo l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Sep 29, 2021</span></div></span></div></span></div></div></div><div class="ab cp jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke"><div class="h k w fg fh q"><div class="ku l"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2F53bdd630f8a1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;user=BlueMonkey&amp;userId=fbbbb2c84e9a&amp;source=---header_actions--53bdd630f8a1---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q kf kg kh ki kj kk kl km kn ko kp kq kr ks kt"><div class="lv k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53bdd630f8a1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;source=---header_actions--53bdd630f8a1---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lx cn"><div class="l ae"><div class="ab cb"><div class="ly lz ma mb mc md ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh mi mj mk ml s mm mn mo mp mq mr ms u mt mu mv"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="5655" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field and I am trying to do a research into cobalt strike. Recently, I ran a modified public YARA rule for cobalt strike on Virus Total and from the scan, I found two samples which I find interesting.</p><blockquote class="nu nv nw"><p id="3f05" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">1e56c3f05bb53d2dfa60bc016e8509b12fd3beb5f567d274a184bb67af1eb19c</p><p id="fbbf" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">c5696e660f3cfa9232756418e40ad18729cfe32fb284bba2314dd523ba527258</p></blockquote><p id="0d47" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">These two samples have a relative large size (17.05 MB) as compared to other files and their size is exactly the same. Additionally, their upload timing is quite close to each other, around 3 minutes apart. I started to analyze the files and from my finding, it doesn’t look anything like a cobalt strike loader. Turning to my friend who have much more experience in malware analysis, I told him my findings and he told me that from what I had described, it sounds a little bit like Aria-Body instead. So I did some read up on Aria-Body and here are what I had found….</p><p id="a9f4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">In 2020, Check Point Research release a write up (http://research[.]checkpoint[.]com/2020/nikon-apt-cyber-espionage-reloaded) describing how Naikon APT group is using Aria-body. In the report, they summarized the loader to have these capabilities:</p><p id="263e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">1. Establish persistence via the Startup folder or the Run registry key [some variants].</em></p><p id="229b" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">2. Inject itself to another process such as rundll32.exe and dllhost.exe [some variants].</em></p><p id="e94c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">3. Decrypt two blobs: Import Table and the loader configuration.</em></p><p id="4285" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">4. Utilize a DGA algorithm if required</em></p><p id="5d7f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">5. Contact the embedded / calculated C&amp;C address in order to retrieve the next stage payload.</em></p><p id="3cb7" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">6. Decrypt the received payload DLL (Aria-Body backdoor).</em></p><p id="c466" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk"><em class="nx">7. Load and execute an exported function of the DLL — calculated using djb2 hashing algorithm.</em></p><p id="9b4e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Take note on these points as I will be mentioning some of them in this post.</p><h2 id="d761" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Analysis of the samples</h2><p id="3b0f" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">As I had mentioned in the intro, the first thing that I noticed about the two sample is that both of them have exactly the same size. When I loaded them into PE studio, I noticed that they share the same compiler, debugger and exports timestamp.</p></div></div><div class="ow"><div class="ab cb"><div class="ly ox lz oy ma oz cf pa cg pb ci bh"><figure class="pf pg ph pi pj ow pk pl paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd pe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*t9vZ65tN3upoIQYw55o3tg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*t9vZ65tN3upoIQYw55o3tg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*t9vZ65tN3upoIQYw55o3tg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*t9vZ65tN3upoIQYw55o3tg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*t9vZ65tN3upoIQYw55o3tg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*t9vZ65tN3upoIQYw55o3tg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*t9vZ65tN3upoIQYw55o3tg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*t9vZ65tN3upoIQYw55o3tg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md pq c" width="1000" height="283" loading="eager" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Similar Timestamp</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="8d28" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Now looking at the section’s metadata, we can see that all but two of them have the same hash. The two sections with the different hash is the <em class="nx">.text</em> and the <em class="nx">.data</em> section. Although they have a different hash, we can see that the raw-size, virtual-size, raw-address and virtual-address are the same.</p></div></div><div class="ow"><div class="ab cb"><div class="ly ox lz oy ma oz cf pa cg pb ci bh"><figure class="pf pg ph pi pj ow pk pl paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd pv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*CvaCL7o1Ijr8-TWKWEvMbQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md pq c" width="1000" height="540" loading="eager" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Similar Section</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="c20e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Looking into the import and export section, this two samples also have a same import and export.</p></div></div><div class="ow"><div class="ab cb"><div class="ly ox lz oy ma oz cf pa cg pb ci bh"><figure class="pf pg ph pi pj ow pk pl paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd pw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*aKgMnE9_Nb7iox7L3w8POw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*aKgMnE9_Nb7iox7L3w8POw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*aKgMnE9_Nb7iox7L3w8POw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*aKgMnE9_Nb7iox7L3w8POw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*aKgMnE9_Nb7iox7L3w8POw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*aKgMnE9_Nb7iox7L3w8POw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*aKgMnE9_Nb7iox7L3w8POw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*aKgMnE9_Nb7iox7L3w8POw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh md pq c" width="1000" height="344" loading="eager" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Similar Export</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="052a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Looking at the static properties analysis, these two files seems like twins. They could have the same origins or they might be built using a builder. But this is just my speculation at this point as there are not enough information to support the claim.</p><h2 id="5ded" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Looking for the “action”</h2><p id="5adf" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">Now that I had done the analysis on the files properties and confirmed that it is a 64 bit DLL, it’s time to throw the sample 1e56c3f05bb53d2dfa60bc016e8509b12fd3beb5f567d274a184bb67af1eb19c into IDA for analysis. After IDA has finished loading, the first thing that it displayed is this:</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd px"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/format:webp/1*5vtZwVrEwteIpMAFYrKlGA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5vtZwVrEwteIpMAFYrKlGA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5vtZwVrEwteIpMAFYrKlGA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5vtZwVrEwteIpMAFYrKlGA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5vtZwVrEwteIpMAFYrKlGA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5vtZwVrEwteIpMAFYrKlGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5vtZwVrEwteIpMAFYrKlGA.png 1100w, https://miro.medium.com/v2/resize:fit:1248/1*5vtZwVrEwteIpMAFYrKlGA.png 1248w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 624px"/><img alt="" class="bh md pq c" width="624" height="126" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">DllMain</figcaption></figure><p id="fb6f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">That’s all ._. not helpful at all. Seems like I have to find the “action” through other means~~</p><p id="62fa" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Since this is a DLL, we can try to look for the “action” by checking the export functions.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*-dzCdvCIilTP-J5IsA9eGA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-dzCdvCIilTP-J5IsA9eGA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-dzCdvCIilTP-J5IsA9eGA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-dzCdvCIilTP-J5IsA9eGA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-dzCdvCIilTP-J5IsA9eGA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-dzCdvCIilTP-J5IsA9eGA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-dzCdvCIilTP-J5IsA9eGA.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*-dzCdvCIilTP-J5IsA9eGA.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md pq c" width="602" height="578" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Export Functions</figcaption></figure><p id="26f3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">From this list of 30 export functions, two of them <em class="nx">DllEntryPoint</em> and<em class="nx"> ILCreateFromPath</em> caught my attention. After looking through the two functions, I had determined that the <em class="nx">ILCreateFromPath </em>function contains the “actions” that we are interested in.</p><h2 id="d9bf" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Obfuscation</h2><p id="74d3" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">While scrolling through the <em class="nx">ILCreateFromPath</em> function, I noticed a pattern:</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd pz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 1100w, https://miro.medium.com/v2/resize:fit:944/format:webp/1*M2HnbuePBIAmA7TTaHfBHQ.png 944w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 472px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*M2HnbuePBIAmA7TTaHfBHQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*M2HnbuePBIAmA7TTaHfBHQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*M2HnbuePBIAmA7TTaHfBHQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*M2HnbuePBIAmA7TTaHfBHQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*M2HnbuePBIAmA7TTaHfBHQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*M2HnbuePBIAmA7TTaHfBHQ.png 1100w, https://miro.medium.com/v2/resize:fit:944/1*M2HnbuePBIAmA7TTaHfBHQ.png 944w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 472px"/><img alt="" class="bh md pq c" width="472" height="191" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Encoded String</figcaption></figure><p id="738c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Noticed that the value “<em class="nx">]prt-.p,^p,0tnpN.,wSlyowp,b</em>” in the variable <em class="nx">aPrtPP0tnpnWsly</em> was lea into <em class="nx">rcx</em> followed by calling the sub function <em class="nx">sub_180001010</em> then followed by a <em class="nx">call rax</em>. From my analysis, the function sub_18001010 consist of two parts.</p><p id="169d" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">1 — Decode the string</p><p id="5f74" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">First it will decode a string that is passed in as argument which in this case is the value in the variable <em class="nx">aPrtPP0tnpnWsly</em>.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 1100w, https://miro.medium.com/v2/resize:fit:560/format:webp/1*1fDVGzUIIlQUFCVbTsr8EQ.png 560w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 280px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*1fDVGzUIIlQUFCVbTsr8EQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*1fDVGzUIIlQUFCVbTsr8EQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*1fDVGzUIIlQUFCVbTsr8EQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*1fDVGzUIIlQUFCVbTsr8EQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*1fDVGzUIIlQUFCVbTsr8EQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*1fDVGzUIIlQUFCVbTsr8EQ.png 1100w, https://miro.medium.com/v2/resize:fit:560/1*1fDVGzUIIlQUFCVbTsr8EQ.png 560w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 280px"/><img alt="" class="bh md pq c" width="280" height="352" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Decode Section</figcaption></figure><p id="8cc1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">This function decodes the characters by applying the concept of Substitution cipher where it takes the ASCII value of each character, add 28 follow by mod 81 and finally add 42. This is the formula for the substitution cipher that I had just describe: <em class="nx">plain_text = (cipher_text + 28) % 81 + 42</em>. Thus, the value of variable <em class="nx">aPrtPP0tnpnWsly</em> decodes into <em class="nx">RegisterServiceCtrlHandlerW</em> which is a Win32 API.</p><p id="c610" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Using this formula, I wrote a simple python script to do the decryption and ran it on all the strings found in the same data section as <em class="nx">aPrtPP0tnpnWsly</em> and here are the decrypted strings:</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*imYgfwe_5zIVR_GgR7Kkqg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*imYgfwe_5zIVR_GgR7Kkqg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*imYgfwe_5zIVR_GgR7Kkqg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*imYgfwe_5zIVR_GgR7Kkqg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*imYgfwe_5zIVR_GgR7Kkqg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*imYgfwe_5zIVR_GgR7Kkqg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*imYgfwe_5zIVR_GgR7Kkqg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*imYgfwe_5zIVR_GgR7Kkqg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pq c" width="700" height="370" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Decoded String</figcaption></figure><p id="85d8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Looking at the de-obfuscated strings, it seems like they are hiding function calls in strings and decode them during runtime so that we cannot most of its capabilities just from looking at imports table. From the list of the De-obfuscated strings, we can see that some of the capabilities of this malware includes creating thread and writing into memory.</p><p id="ed44" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">2 — GetProcAddress</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 1100w, https://miro.medium.com/v2/resize:fit:942/format:webp/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 942w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 471px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 1100w, https://miro.medium.com/v2/resize:fit:942/1*wZ-OwrVFEeybiXlQ-ZPvkw.png 942w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 471px"/><img alt="" class="bh md pq c" width="471" height="288" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">getProcAddress</figcaption></figure><p id="aaa9" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Once the string is decoded, the function will then call <em class="nx">LoadLibraryA</em> and <em class="nx">GetProcAddress</em> before returning the address of the call.</p><p id="31b8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Alright, now that we know that this malware has the ability to hide its function calls what’s next?</p><h2 id="f62d" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Threading and New Processes</h2><p id="f9c7" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">Following down the <em class="nx">ILCreateFromPath</em>, I saw that the malware creates a new thread to execute the function called <em class="nx">StartAddress</em>.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 1100w, https://miro.medium.com/v2/resize:fit:1160/format:webp/1*JnmO7BANBe7wzn2vhNeplA.png 1160w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 580px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*JnmO7BANBe7wzn2vhNeplA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*JnmO7BANBe7wzn2vhNeplA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*JnmO7BANBe7wzn2vhNeplA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*JnmO7BANBe7wzn2vhNeplA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*JnmO7BANBe7wzn2vhNeplA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*JnmO7BANBe7wzn2vhNeplA.png 1100w, https://miro.medium.com/v2/resize:fit:1160/1*JnmO7BANBe7wzn2vhNeplA.png 1160w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 580px"/><img alt="" class="bh md pq c" width="580" height="356" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Create New Thread</figcaption></figure><p id="abe1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">So the only thing to do is to follow and look at what does the <em class="nx">StartAddress</em> function do.</p><p id="29e1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Looking through the <em class="nx">StartAddress</em> function, the first thing that caught my eyes is a variable containing the string “<em class="nx">%s\\dllhost.exe /Processid:{%s}</em>” followed by <em class="nx">CreateProcessW</em>. It looks like the malware is trying to create a <em class="nx">dllhost</em> process.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 1100w, https://miro.medium.com/v2/resize:fit:1230/format:webp/1*84VV5_zNgygRGFSfQvwUCQ.png 1230w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 615px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*84VV5_zNgygRGFSfQvwUCQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*84VV5_zNgygRGFSfQvwUCQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*84VV5_zNgygRGFSfQvwUCQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*84VV5_zNgygRGFSfQvwUCQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*84VV5_zNgygRGFSfQvwUCQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*84VV5_zNgygRGFSfQvwUCQ.png 1100w, https://miro.medium.com/v2/resize:fit:1230/1*84VV5_zNgygRGFSfQvwUCQ.png 1230w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 615px"/><img alt="" class="bh md pq c" width="615" height="513" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Create New Process</figcaption></figure><p id="f56a" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">After calling <em class="nx">CreateProcessW</em>, the malware then proceeds to call <em class="nx">VirtualAllocEx</em> followed by <em class="nx">WriteProcessMemory</em>.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 1100w, https://miro.medium.com/v2/resize:fit:1312/format:webp/1*0DU6GqY7MiTNEyq9j03c9Q.png 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0DU6GqY7MiTNEyq9j03c9Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0DU6GqY7MiTNEyq9j03c9Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0DU6GqY7MiTNEyq9j03c9Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0DU6GqY7MiTNEyq9j03c9Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0DU6GqY7MiTNEyq9j03c9Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0DU6GqY7MiTNEyq9j03c9Q.png 1100w, https://miro.medium.com/v2/resize:fit:1312/1*0DU6GqY7MiTNEyq9j03c9Q.png 1312w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 656px"/><img alt="" class="bh md pq c" width="656" height="475" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Allocate And Write To Memory</figcaption></figure><p id="a7a1" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">From the above code, we can see that the malware used the <em class="nx">WriteProcessMemory</em> function to write the function <em class="nx">sub_181064570</em> into <em class="nx">dllhost</em> process created earlier. Although this seems to be a common process injection, it matches the checkpoint’s report, where it mentions that it injects itself to another process such as rundll32.exe and dllhost.exe.</p><h2 id="c74e" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Decoding Embedded Data</h2><p id="3872" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">Finally, we have reached the part where we can see what this malware actually wants to do! This is how the first few lines of the function written into the process’s memory looks like:</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 1100w, https://miro.medium.com/v2/resize:fit:768/format:webp/1*_TCIJsAgMDb6fNGqrEf12w.png 768w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 384px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_TCIJsAgMDb6fNGqrEf12w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_TCIJsAgMDb6fNGqrEf12w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_TCIJsAgMDb6fNGqrEf12w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_TCIJsAgMDb6fNGqrEf12w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_TCIJsAgMDb6fNGqrEf12w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_TCIJsAgMDb6fNGqrEf12w.png 1100w, https://miro.medium.com/v2/resize:fit:768/1*_TCIJsAgMDb6fNGqrEf12w.png 768w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 384px"/><img alt="" class="bh md pq c" width="384" height="293" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Write to Memory</figcaption></figure><p id="657e" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">It looks like the malware copying two sets of data located at <em class="nx">qword_181065CC0</em> into the memory.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CQU_wgsOH3WshxmB4bHclQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CQU_wgsOH3WshxmB4bHclQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CQU_wgsOH3WshxmB4bHclQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CQU_wgsOH3WshxmB4bHclQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CQU_wgsOH3WshxmB4bHclQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CQU_wgsOH3WshxmB4bHclQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CQU_wgsOH3WshxmB4bHclQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CQU_wgsOH3WshxmB4bHclQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pq c" width="700" height="635" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Encoded Blob in Memory</figcaption></figure><p id="7319" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">After copying the data into the memory, the malware calls a function which will decode the data.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ICQfaKgR3QFBCAENBuqeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*-ICQfaKgR3QFBCAENBuqeA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*-ICQfaKgR3QFBCAENBuqeA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*-ICQfaKgR3QFBCAENBuqeA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*-ICQfaKgR3QFBCAENBuqeA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*-ICQfaKgR3QFBCAENBuqeA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*-ICQfaKgR3QFBCAENBuqeA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*-ICQfaKgR3QFBCAENBuqeA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh md pq c" width="700" height="111" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">First Decoded Blob</figcaption></figure><p id="a5b2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The first blob of data contains the URL of the C2 server “<em class="nx">news.nyhedmgtxck.com</em>” and a string of characters which doesn’t seems to be used in any part of the execution.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 1100w, https://miro.medium.com/v2/resize:fit:624/format:webp/1*ZJneAXOsOoDmoG3sUp3onw.png 624w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 312px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZJneAXOsOoDmoG3sUp3onw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZJneAXOsOoDmoG3sUp3onw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZJneAXOsOoDmoG3sUp3onw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZJneAXOsOoDmoG3sUp3onw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZJneAXOsOoDmoG3sUp3onw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZJneAXOsOoDmoG3sUp3onw.png 1100w, https://miro.medium.com/v2/resize:fit:624/1*ZJneAXOsOoDmoG3sUp3onw.png 624w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 312px"/><img alt="" class="bh md pq c" width="312" height="246" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Second Decoded Blob</figcaption></figure><p id="8035" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">And the second blob of data contains the imports table which the malware will use in the next phase of its activity. Wait a minute… does the 2 blobs of data sounds familiar?</p><p id="d4f3" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">From checkpoint’s report on aria-body loader, they mentioned that one of the functionality of the loader is to decrypt two blobs of data into an Import Table and a loader configuration.</p><h2 id="36ea" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Download and execute payload</h2><p id="2158" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">By using the decoded import tables, the malware attempts to connects to the C2 URL to download a file.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd py"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/format:webp/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 1100w, https://miro.medium.com/v2/resize:fit:1204/1*UZ-wT1RcxAS1WqrZW7d2NQ.png 1204w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 602px"/><img alt="" class="bh md pq c" width="602" height="513" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Download Payload</figcaption></figure><p id="bced" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">To this point, it actually matches the points mentioned in Check Point’s report where Aria-body contact the embedded / calculated C&amp;C address in order to download retrieve the next stage payload.</p><p id="0e60" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Too bad for us, the URL has already been sinkhole. Therefore, I am not be able download the sample for analysis ):</p><p id="43d2" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">It’s not the end yet! Although I am not able to analyze the next stage payload, I am still able to see what this loader does before passing control to the next stage payload :D</p><p id="88a4" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Once the payload is downloaded, the malware will first decode the payload with a XOR function. The decoded payload will then reside only in the memory. Which suggest that it could be a file-less malware.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 1100w, https://miro.medium.com/v2/resize:fit:924/format:webp/1*3IPpiSjY6wsVWxeMUcSjjg.png 924w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 462px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3IPpiSjY6wsVWxeMUcSjjg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3IPpiSjY6wsVWxeMUcSjjg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3IPpiSjY6wsVWxeMUcSjjg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3IPpiSjY6wsVWxeMUcSjjg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3IPpiSjY6wsVWxeMUcSjjg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3IPpiSjY6wsVWxeMUcSjjg.png 1100w, https://miro.medium.com/v2/resize:fit:924/1*3IPpiSjY6wsVWxeMUcSjjg.png 924w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 462px"/><img alt="" class="bh md pq c" width="462" height="326" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Decode Payload and Copy to Memory</figcaption></figure><p id="f759" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Next, the malware then calls a function which checks if the payload contains the magic number “MZ” and “PE”.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div role="button" tabindex="0" class="pm pn fj po bh pp"><div class="pc pd ql"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 1100w, https://miro.medium.com/v2/resize:fit:1296/format:webp/1*AHnahoKLf_s74T5v2HLMfg.png 1296w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 648px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*AHnahoKLf_s74T5v2HLMfg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AHnahoKLf_s74T5v2HLMfg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AHnahoKLf_s74T5v2HLMfg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AHnahoKLf_s74T5v2HLMfg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AHnahoKLf_s74T5v2HLMfg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AHnahoKLf_s74T5v2HLMfg.png 1100w, https://miro.medium.com/v2/resize:fit:1296/1*AHnahoKLf_s74T5v2HLMfg.png 1296w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 648px"/><img alt="" class="bh md pq c" width="648" height="223" loading="lazy" role="presentation"/></picture></div></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">Check for PE and Section Header</figcaption></figure><p id="17dc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Once verified, the malware will finally get the entry point to the payload by calculating the djb2 hash of the payload’s export and comparing it with 0x2E9AD5FB. Without the second stage payload, I am unable to determine what is the export name based on that hash.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 1100w, https://miro.medium.com/v2/resize:fit:614/format:webp/1*TnxRH77UqIRdIiEMs_j5Xg.png 614w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 307px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*TnxRH77UqIRdIiEMs_j5Xg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TnxRH77UqIRdIiEMs_j5Xg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TnxRH77UqIRdIiEMs_j5Xg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TnxRH77UqIRdIiEMs_j5Xg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TnxRH77UqIRdIiEMs_j5Xg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TnxRH77UqIRdIiEMs_j5Xg.png 1100w, https://miro.medium.com/v2/resize:fit:614/1*TnxRH77UqIRdIiEMs_j5Xg.png 614w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 307px"/><img alt="" class="bh md pq c" width="307" height="98" loading="lazy" role="presentation"/></picture></div><figcaption class="pr ff ps pc pd pt pu bf b bg z du">DJB2 Hash</figcaption></figure><p id="844f" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Finally, the malware then passes the execution control to the payload.</p><figure class="pf pg ph pi pj ow pc pd paragraph-image"><div class="pc pd qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 1100w, https://miro.medium.com/v2/resize:fit:1320/format:webp/1*VPkjI7kLjrHk7YzQEQWQuw.png 1320w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 660px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VPkjI7kLjrHk7YzQEQWQuw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VPkjI7kLjrHk7YzQEQWQuw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VPkjI7kLjrHk7YzQEQWQuw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VPkjI7kLjrHk7YzQEQWQuw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VPkjI7kLjrHk7YzQEQWQuw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VPkjI7kLjrHk7YzQEQWQuw.png 1100w, https://miro.medium.com/v2/resize:fit:1320/1*VPkjI7kLjrHk7YzQEQWQuw.png 1320w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 660px"/><img alt="" class="bh md pq c" width="660" height="259" loading="lazy" role="presentation"/></picture></div></figure><p id="1ccc" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">The way this malware get the entry point also matches what Check Point had described where the loader loads and execute an exported function of the DLL — calculated using djb2 hashing algorithm.</p><h2 id="de89" class="ny nz gu bf oa ob oc dy od oe of ea og nh oh oi oj nl ok ol om np on oo op oq bk">Conclusion</h2><p id="9f69" class="pw-post-body-paragraph mw mx gu my b mz or nb nc nd os nf ng nh ot nj nk nl ou nn no np ov nr ns nt gn bk">Phew… Finally! We’ve reached the conclusion~~ v^^v</p><p id="d4c8" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">From the analysis, this malware looks like a loader which will download a payload from the C2 and execute the payload on the memory. The capabilities of this sample is very similar to the Aria-body loader that is described by Check Point where 5 out of the 7 points matching the analysis. I am unable to determine if this sample “establishes persistence via startup folder or run registry” and the “utilization of the DGA algorithm”. Putting the capabilities aside, I had look through the sample with the hash “40c49ecbe1b7bdodbb935138661b6ca4” mentioned in Check Point’s report and code wise, it looks vastly different from this sample.</p><p id="34d0" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Noticed that up to this point, I have only talked about the analysis of one of the samples. Well, I had done the analysis on both of the sample and in regards of the code executions, they are the same. The only difference between the two sample in regards to what is relevant to the execution and its function, is that the C2 string and the string of character in the first blob of data is different. Instead of going to “<em class="nx">news[.]nyhedmgtxck[.]com</em>”, the C2 of the other sample is “<em class="nx">www[.]etnwtmrkh[.]com</em>” both of which are sinkholed.</p><p id="fd1c" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Therefore, based on the capabilities, am I right to say that this could be a variant of Aria-Body loader?</p></div></div></div><div class="ab cb qo qp qq qr" role="separator"><span class="qs by bm qt qu qv"></span><span class="qs by bm qt qu qv"></span><span class="qs by bm qt qu"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="0187" class="pw-post-body-paragraph mw mx gu my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">Hashes Analyzed:</p><blockquote class="nu nv nw"><p id="0e54" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">1e56c3f05bb53d2dfa60bc016e8509b12fd3beb5f567d274a184bb67af1eb19c</p><p id="0f94" class="mw mx nx my b mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt gn bk">c5696e660f3cfa9232756418e40ad18729cfe32fb284bba2314dd523ba527258</p></blockquote></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qw qx ab ja"><div class="qy ab"><a class="qz ay am ao" rel="noopener follow" href="/tag/aria-body?source=post_page-----53bdd630f8a1--------------------------------"><div class="ra fj cx rb ge rc rd bf b bg z bk re">Aria Body</div></a></div><div class="qy ab"><a class="qz ay am ao" rel="noopener follow" href="/tag/malware?source=post_page-----53bdd630f8a1--------------------------------"><div class="ra fj cx rb ge rc rd bf b bg z bk re">Malware</div></a></div><div class="qy ab"><a class="qz ay am ao" rel="noopener follow" href="/tag/analysis?source=post_page-----53bdd630f8a1--------------------------------"><div class="ra fj cx rb ge rc rd bf b bg z bk re">Analysis</div></a></div></div></div></div><div class="l"></div><footer class="rf qp rg rh ri ab q rj ik c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rk"><div class="ab q kv"><div class="rl l"><span class="l rm rn ro e d"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2F53bdd630f8a1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;user=BlueMonkey&amp;userId=fbbbb2c84e9a&amp;source=---footer_actions--53bdd630f8a1---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span><span class="l h g f rp rq"><div class="ab q kv kw"><div class="pw-multi-vote-icon fj je kx ky kz"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Finsomniacs%2F53bdd630f8a1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;user=BlueMonkey&amp;userId=fbbbb2c84e9a&amp;source=---footer_actions--53bdd630f8a1---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="la ao lb lc ld le am lf lg lh kz"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l li lj lk ll lm ln lo"><p class="bf b dv z du"><span class="lp">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao la lq lr ab q fk ls lt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lu"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="qv l ix"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F53bdd630f8a1&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Finsomniacs%2Faria-body-loader-is-that-you-53bdd630f8a1&amp;source=---footer_actions--53bdd630f8a1---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lw" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="qv l ix"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al me an ao ap ex mf mg lt mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rr rs rt ru rv l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="rw bh r rx"></div><div class="ry l"><div class="ab rz sa sb iz iy"><div class="sc sd se sf sg sh si sj sk sl ab cp"><div class="h k"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--53bdd630f8a1--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="sm ib ic cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="48" height="48" loading="lazy"/><div class="sm l ic ib fs n fr sn"></div></div></a></div><div class="j i d"><a href="https://medium.com/insomniacs?source=post_page---post_publication_info--53bdd630f8a1--------------------------------" rel="noopener follow"><div class="fj ab"><img alt="insomniacs" class="sm sp so cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*IvMGfHVzEtZei5I-JouCvw.jpeg" width="64" height="64" loading="lazy"/><div class="sm l so sp fs n fr sn"></div></div></a></div><div class="j i d sq ix"><div class="ab"></div></div></div><div class="ab co sr"><div class="ss st su oy ox l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" href="https://medium.com/insomniacs?source=post_page---post_publication_info--53bdd630f8a1--------------------------------" rel="noopener follow"><h2 class="pw-author-name bf sw sx sy sz ta tb tc nh oi oj nl ol om np oo op bk"><span class="gn sv">Published in <!-- -->insomniacs</span></h2></a><div class="qy ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/followers?source=post_page---post_publication_info--53bdd630f8a1--------------------------------">60 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/insomniacs/analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0?source=post_page---post_publication_info--53bdd630f8a1--------------------------------">Last published <span>Jun 23, 2022</span></a></div></div><div class="td l"><p class="bf b bg z bk"><span class="gn">reverse engineering away those sleepless nights</span></p></div></div></div><div class="h k"><div class="ab"></div></div></div></div><div class="ab rz sa sb iz iy"><div class="sc sd se sf sg sh si sj sk sl ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@bluebluemonkey0?source=post_page---post_author_info--53bdd630f8a1--------------------------------"><div class="l fj"><img alt="BlueMonkey" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/0*94UAOTxSHRGvdf2F" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sn"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@bluebluemonkey0?source=post_page---post_author_info--53bdd630f8a1--------------------------------"><div class="l fj"><img alt="BlueMonkey" class="l fd by so sp cx" src="https://miro.medium.com/v2/resize:fill:128:128/0*94UAOTxSHRGvdf2F" width="64" height="64" loading="lazy"/><div class="fr by l so sp fs n ay sn"></div></div></a></div><div class="j i d sq ix"><div class="ab"><span><button class="bf b bg z te ra tf tg th ti tj ev ew tk tl tm fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co sr"><div class="ss st su oy ox l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@bluebluemonkey0?source=post_page---post_author_info--53bdd630f8a1--------------------------------"><h2 class="pw-author-name bf sw sx sy sz ta tb tc nh oi oj nl ol om np oo op bk"><span class="gn sv">Written by <!-- -->BlueMonkey</span></h2></a><div class="qy ab ia"><div class="l ix"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@bluebluemonkey0/followers?source=post_page---post_author_info--53bdd630f8a1--------------------------------">2 Followers</a></span></div><div class="bf b bg z du ab jd"><span class="ir l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar iq" rel="noopener follow" href="/@bluebluemonkey0/following?source=post_page---post_author_info--53bdd630f8a1--------------------------------">2 Following</a></div></div><div class="td l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z te ra tf tg th ti tj ev ew tk tl tm fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tn l"><div class="rw bh r to tp tq tr ts"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf sw tt tu od tv tw og tx ty tz ua ub uc ud ue uf bk">No responses yet</h2><div class="ab ug"><div><div class="bm" aria-hidden="false"><a class="uh ui" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--53bdd630f8a1--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="uj uk ul um un l"></div></div></div></div><div class="uo up uq ur us l bx"><div class="h k j"><div class="rw bh ut uu"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uv ab kv ja"><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----53bdd630f8a1--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----53bdd630f8a1--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="uw ux l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----53bdd630f8a1--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="uw l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----53bdd630f8a1--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-53bdd630f8a1","user-fbbbb2c84e9a","collection-8dea5b1882ca"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"feff4744-6982-4f9e-8523-6bf72f819ca7","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-9127f94e4cf5161abd44cb46e577899c-80cc9202a78b2b7d-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Faria-body-loader-is-that-you-53bdd630f8a1","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","collectionByDomainOrSlug({\"domainOrSlug\":\"insomniacs\"})":{"__ref":"Collection:8dea5b1882ca"},"viewer":null,"postResult({\"id\":\"53bdd630f8a1\"})":{"__ref":"Post:53bdd630f8a1"}},"ImageMetadata:":{"__typename":"ImageMetadata","id":""},"Collection:8dea5b1882ca":{"__typename":"Collection","id":"8dea5b1882ca","favicon":{"__ref":"ImageMetadata:"},"domain":null,"slug":"insomniacs","googleAnalyticsId":null,"name":"insomniacs","subscriberCount":60,"description":"reverse engineering away those sleepless nights","avatar":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"},"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:32da9d336ca0"}]},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_90ab9d832695"},"twitterUsername":null,"facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null}},"ImageMetadata:1*IvMGfHVzEtZei5I-JouCvw.jpeg":{"__typename":"ImageMetadata","id":"1*IvMGfHVzEtZei5I-JouCvw.jpeg","originalWidth":1200,"originalHeight":1200},"User:ddd44ddb6480":{"__typename":"User","id":"ddd44ddb6480","customDomainState":null,"hasSubdomain":false,"username":"asuna.amawaka"},"Post:32da9d336ca0":{"__typename":"Post","id":"32da9d336ca0","firstPublishedAt":1656002664270,"creator":{"__ref":"User:ddd44ddb6480"},"collection":{"__ref":"Collection:8dea5b1882ca"},"isSeries":false,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Fanalysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0","sequence":null,"uniqueSlug":"analysis-walkthrough-apt32s-79828cc5-8979-43c0-9299-8e155b397281-dll-32da9d336ca0"},"LinkedAccounts:fbbbb2c84e9a":{"__typename":"LinkedAccounts","mastodon":null,"id":"fbbbb2c84e9a"},"User:fbbbb2c84e9a":{"__typename":"User","id":"fbbbb2c84e9a","linkedAccounts":{"__ref":"LinkedAccounts:fbbbb2c84e9a"},"isSuspended":false,"name":"BlueMonkey","imageId":"0*94UAOTxSHRGvdf2F","customDomainState":null,"hasSubdomain":false,"username":"bluebluemonkey0","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":2,"followingCount":1,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:fbbbb2c84e9a-viewerId:lo_90ab9d832695"},"twitterScreenName":""},"Paragraph:5654a85e436d_0":{"__typename":"Paragraph","id":"5654a85e436d_0","name":"7ef8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Aria-Body Loader? Is that you?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_1":{"__typename":"Paragraph","id":"5654a85e436d_1","name":"5655","type":"P","href":null,"layout":null,"metadata":null,"text":"Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field and I am trying to do a research into cobalt strike. Recently, I ran a modified public YARA rule for cobalt strike on Virus Total and from the scan, I found two samples which I find interesting.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_2":{"__typename":"Paragraph","id":"5654a85e436d_2","name":"3f05","type":"BQ","href":null,"layout":null,"metadata":null,"text":"1e56c3f05bb53d2dfa60bc016e8509b12fd3beb5f567d274a184bb67af1eb19c","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_3":{"__typename":"Paragraph","id":"5654a85e436d_3","name":"fbbf","type":"BQ","href":null,"layout":null,"metadata":null,"text":"c5696e660f3cfa9232756418e40ad18729cfe32fb284bba2314dd523ba527258","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_4":{"__typename":"Paragraph","id":"5654a85e436d_4","name":"0d47","type":"P","href":null,"layout":null,"metadata":null,"text":"These two samples have a relative large size (17.05 MB) as compared to other files and their size is exactly the same. Additionally, their upload timing is quite close to each other, around 3 minutes apart. I started to analyze the files and from my finding, it doesn’t look anything like a cobalt strike loader. Turning to my friend who have much more experience in malware analysis, I told him my findings and he told me that from what I had described, it sounds a little bit like Aria-Body instead. So I did some read up on Aria-Body and here are what I had found….","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_5":{"__typename":"Paragraph","id":"5654a85e436d_5","name":"a9f4","type":"P","href":null,"layout":null,"metadata":null,"text":"In 2020, Check Point Research release a write up (http:\u002F\u002Fresearch[.]checkpoint[.]com\u002F2020\u002Fnikon-apt-cyber-espionage-reloaded) describing how Naikon APT group is using Aria-body. In the report, they summarized the loader to have these capabilities:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_6":{"__typename":"Paragraph","id":"5654a85e436d_6","name":"263e","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Establish persistence via the Startup folder or the Run registry key [some variants].","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_7":{"__typename":"Paragraph","id":"5654a85e436d_7","name":"229b","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Inject itself to another process such as rundll32.exe and dllhost.exe [some variants].","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":89,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_8":{"__typename":"Paragraph","id":"5654a85e436d_8","name":"e94c","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Decrypt two blobs: Import Table and the loader configuration.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_9":{"__typename":"Paragraph","id":"5654a85e436d_9","name":"4285","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Utilize a DGA algorithm if required","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":38,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_10":{"__typename":"Paragraph","id":"5654a85e436d_10","name":"5d7f","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Contact the embedded \u002F calculated C&C address in order to retrieve the next stage payload.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":93,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_11":{"__typename":"Paragraph","id":"5654a85e436d_11","name":"3cb7","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Decrypt the received payload DLL (Aria-Body backdoor).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":57,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_12":{"__typename":"Paragraph","id":"5654a85e436d_12","name":"c466","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Load and execute an exported function of the DLL — calculated using djb2 hashing algorithm.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":94,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_13":{"__typename":"Paragraph","id":"5654a85e436d_13","name":"9b4e","type":"P","href":null,"layout":null,"metadata":null,"text":"Take note on these points as I will be mentioning some of them in this post.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_14":{"__typename":"Paragraph","id":"5654a85e436d_14","name":"d761","type":"H4","href":null,"layout":null,"metadata":null,"text":"Analysis of the samples","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_15":{"__typename":"Paragraph","id":"5654a85e436d_15","name":"3b0f","type":"P","href":null,"layout":null,"metadata":null,"text":"As I had mentioned in the intro, the first thing that I noticed about the two sample is that both of them have exactly the same size. When I loaded them into PE studio, I noticed that they share the same compiler, debugger and exports timestamp.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*t9vZ65tN3upoIQYw55o3tg.png":{"__typename":"ImageMetadata","id":"1*t9vZ65tN3upoIQYw55o3tg.png","originalHeight":535,"originalWidth":1897,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_16":{"__typename":"Paragraph","id":"5654a85e436d_16","name":"89da","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*t9vZ65tN3upoIQYw55o3tg.png"},"text":"Similar Timestamp","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_17":{"__typename":"Paragraph","id":"5654a85e436d_17","name":"8d28","type":"P","href":null,"layout":null,"metadata":null,"text":"Now looking at the section’s metadata, we can see that all but two of them have the same hash. The two sections with the different hash is the .text and the .data section. Although they have a different hash, we can see that the raw-size, virtual-size, raw-address and virtual-address are the same.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":143,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":157,"end":162,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CvaCL7o1Ijr8-TWKWEvMbQ.png":{"__typename":"ImageMetadata","id":"1*CvaCL7o1Ijr8-TWKWEvMbQ.png","originalHeight":922,"originalWidth":1708,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_18":{"__typename":"Paragraph","id":"5654a85e436d_18","name":"a21b","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CvaCL7o1Ijr8-TWKWEvMbQ.png"},"text":"Similar Section","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_19":{"__typename":"Paragraph","id":"5654a85e436d_19","name":"c20e","type":"P","href":null,"layout":null,"metadata":null,"text":"Looking into the import and export section, this two samples also have a same import and export.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*aKgMnE9_Nb7iox7L3w8POw.png":{"__typename":"ImageMetadata","id":"1*aKgMnE9_Nb7iox7L3w8POw.png","originalHeight":652,"originalWidth":1900,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_20":{"__typename":"Paragraph","id":"5654a85e436d_20","name":"6057","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*aKgMnE9_Nb7iox7L3w8POw.png"},"text":"Similar Export","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_21":{"__typename":"Paragraph","id":"5654a85e436d_21","name":"052a","type":"P","href":null,"layout":null,"metadata":null,"text":"Looking at the static properties analysis, these two files seems like twins. They could have the same origins or they might be built using a builder. But this is just my speculation at this point as there are not enough information to support the claim.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_22":{"__typename":"Paragraph","id":"5654a85e436d_22","name":"5ded","type":"H4","href":null,"layout":null,"metadata":null,"text":"Looking for the “action”","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_23":{"__typename":"Paragraph","id":"5654a85e436d_23","name":"5adf","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that I had done the analysis on the files properties and confirmed that it is a 64 bit DLL, it’s time to throw the sample 1e56c3f05bb53d2dfa60bc016e8509b12fd3beb5f567d274a184bb67af1eb19c into IDA for analysis. After IDA has finished loading, the first thing that it displayed is this:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5vtZwVrEwteIpMAFYrKlGA.png":{"__typename":"ImageMetadata","id":"1*5vtZwVrEwteIpMAFYrKlGA.png","originalHeight":126,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_24":{"__typename":"Paragraph","id":"5654a85e436d_24","name":"9410","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5vtZwVrEwteIpMAFYrKlGA.png"},"text":"DllMain","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_25":{"__typename":"Paragraph","id":"5654a85e436d_25","name":"fb6f","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s all ._. not helpful at all. Seems like I have to find the “action” through other means~~","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_26":{"__typename":"Paragraph","id":"5654a85e436d_26","name":"62fa","type":"P","href":null,"layout":null,"metadata":null,"text":"Since this is a DLL, we can try to look for the “action” by checking the export functions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-dzCdvCIilTP-J5IsA9eGA.png":{"__typename":"ImageMetadata","id":"1*-dzCdvCIilTP-J5IsA9eGA.png","originalHeight":578,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_27":{"__typename":"Paragraph","id":"5654a85e436d_27","name":"57dc","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-dzCdvCIilTP-J5IsA9eGA.png"},"text":"Export Functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_28":{"__typename":"Paragraph","id":"5654a85e436d_28","name":"26f3","type":"P","href":null,"layout":null,"metadata":null,"text":"From this list of 30 export functions, two of them DllEntryPoint and ILCreateFromPath caught my attention. After looking through the two functions, I had determined that the ILCreateFromPath function contains the “actions” that we are interested in.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":51,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":68,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":174,"end":191,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_29":{"__typename":"Paragraph","id":"5654a85e436d_29","name":"d9bf","type":"H4","href":null,"layout":null,"metadata":null,"text":"Obfuscation","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_30":{"__typename":"Paragraph","id":"5654a85e436d_30","name":"74d3","type":"P","href":null,"layout":null,"metadata":null,"text":"While scrolling through the ILCreateFromPath function, I noticed a pattern:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":28,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*M2HnbuePBIAmA7TTaHfBHQ.png":{"__typename":"ImageMetadata","id":"1*M2HnbuePBIAmA7TTaHfBHQ.png","originalHeight":191,"originalWidth":472,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_31":{"__typename":"Paragraph","id":"5654a85e436d_31","name":"ee70","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*M2HnbuePBIAmA7TTaHfBHQ.png"},"text":"Encoded String","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_32":{"__typename":"Paragraph","id":"5654a85e436d_32","name":"738c","type":"P","href":null,"layout":null,"metadata":null,"text":"Noticed that the value “]prt-.p,^p,0tnpN.,wSlyowp,b” in the variable aPrtPP0tnpnWsly was lea into rcx followed by calling the sub function sub_180001010 then followed by a call rax. From my analysis, the function sub_18001010 consist of two parts.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":24,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":69,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":98,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":139,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":172,"end":180,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_33":{"__typename":"Paragraph","id":"5654a85e436d_33","name":"169d","type":"P","href":null,"layout":null,"metadata":null,"text":"1 — Decode the string","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_34":{"__typename":"Paragraph","id":"5654a85e436d_34","name":"5f74","type":"P","href":null,"layout":null,"metadata":null,"text":"First it will decode a string that is passed in as argument which in this case is the value in the variable aPrtPP0tnpnWsly.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":108,"end":123,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*1fDVGzUIIlQUFCVbTsr8EQ.png":{"__typename":"ImageMetadata","id":"1*1fDVGzUIIlQUFCVbTsr8EQ.png","originalHeight":352,"originalWidth":280,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_35":{"__typename":"Paragraph","id":"5654a85e436d_35","name":"6268","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*1fDVGzUIIlQUFCVbTsr8EQ.png"},"text":"Decode Section","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_36":{"__typename":"Paragraph","id":"5654a85e436d_36","name":"8cc1","type":"P","href":null,"layout":null,"metadata":null,"text":"This function decodes the characters by applying the concept of Substitution cipher where it takes the ASCII value of each character, add 28 follow by mod 81 and finally add 42. This is the formula for the substitution cipher that I had just describe: plain_text = (cipher_text + 28) % 81 + 42. Thus, the value of variable aPrtPP0tnpnWsly decodes into RegisterServiceCtrlHandlerW which is a Win32 API.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":252,"end":293,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":323,"end":338,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":352,"end":379,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_37":{"__typename":"Paragraph","id":"5654a85e436d_37","name":"c610","type":"P","href":null,"layout":null,"metadata":null,"text":"Using this formula, I wrote a simple python script to do the decryption and ran it on all the strings found in the same data section as aPrtPP0tnpnWsly and here are the decrypted strings:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":136,"end":151,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*imYgfwe_5zIVR_GgR7Kkqg.png":{"__typename":"ImageMetadata","id":"1*imYgfwe_5zIVR_GgR7Kkqg.png","originalHeight":412,"originalWidth":780,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_38":{"__typename":"Paragraph","id":"5654a85e436d_38","name":"91f1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*imYgfwe_5zIVR_GgR7Kkqg.png"},"text":"Decoded String","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_39":{"__typename":"Paragraph","id":"5654a85e436d_39","name":"85d8","type":"P","href":null,"layout":null,"metadata":null,"text":"Looking at the de-obfuscated strings, it seems like they are hiding function calls in strings and decode them during runtime so that we cannot most of its capabilities just from looking at imports table. From the list of the De-obfuscated strings, we can see that some of the capabilities of this malware includes creating thread and writing into memory.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_40":{"__typename":"Paragraph","id":"5654a85e436d_40","name":"ed44","type":"P","href":null,"layout":null,"metadata":null,"text":"2 — GetProcAddress","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wZ-OwrVFEeybiXlQ-ZPvkw.png":{"__typename":"ImageMetadata","id":"1*wZ-OwrVFEeybiXlQ-ZPvkw.png","originalHeight":288,"originalWidth":471,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_41":{"__typename":"Paragraph","id":"5654a85e436d_41","name":"6140","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wZ-OwrVFEeybiXlQ-ZPvkw.png"},"text":"getProcAddress","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_42":{"__typename":"Paragraph","id":"5654a85e436d_42","name":"aaa9","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the string is decoded, the function will then call LoadLibraryA and GetProcAddress before returning the address of the call.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":56,"end":68,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":73,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_43":{"__typename":"Paragraph","id":"5654a85e436d_43","name":"31b8","type":"P","href":null,"layout":null,"metadata":null,"text":"Alright, now that we know that this malware has the ability to hide its function calls what’s next?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_44":{"__typename":"Paragraph","id":"5654a85e436d_44","name":"f62d","type":"H4","href":null,"layout":null,"metadata":null,"text":"Threading and New Processes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_45":{"__typename":"Paragraph","id":"5654a85e436d_45","name":"f9c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Following down the ILCreateFromPath, I saw that the malware creates a new thread to execute the function called StartAddress.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":19,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":112,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*JnmO7BANBe7wzn2vhNeplA.png":{"__typename":"ImageMetadata","id":"1*JnmO7BANBe7wzn2vhNeplA.png","originalHeight":356,"originalWidth":580,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_46":{"__typename":"Paragraph","id":"5654a85e436d_46","name":"f18b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*JnmO7BANBe7wzn2vhNeplA.png"},"text":"Create New Thread","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_47":{"__typename":"Paragraph","id":"5654a85e436d_47","name":"abe1","type":"P","href":null,"layout":null,"metadata":null,"text":"So the only thing to do is to follow and look at what does the StartAddress function do.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":63,"end":75,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_48":{"__typename":"Paragraph","id":"5654a85e436d_48","name":"29e1","type":"P","href":null,"layout":null,"metadata":null,"text":"Looking through the StartAddress function, the first thing that caught my eyes is a variable containing the string “%s\\\\dllhost.exe \u002FProcessid:{%s}” followed by CreateProcessW. It looks like the malware is trying to create a dllhost process.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":20,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":116,"end":147,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":161,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":225,"end":232,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*84VV5_zNgygRGFSfQvwUCQ.png":{"__typename":"ImageMetadata","id":"1*84VV5_zNgygRGFSfQvwUCQ.png","originalHeight":513,"originalWidth":615,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_49":{"__typename":"Paragraph","id":"5654a85e436d_49","name":"92d8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*84VV5_zNgygRGFSfQvwUCQ.png"},"text":"Create New Process","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_50":{"__typename":"Paragraph","id":"5654a85e436d_50","name":"f56a","type":"P","href":null,"layout":null,"metadata":null,"text":"After calling CreateProcessW, the malware then proceeds to call VirtualAllocEx followed by WriteProcessMemory.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":14,"end":28,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":64,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":91,"end":109,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0DU6GqY7MiTNEyq9j03c9Q.png":{"__typename":"ImageMetadata","id":"1*0DU6GqY7MiTNEyq9j03c9Q.png","originalHeight":475,"originalWidth":656,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_51":{"__typename":"Paragraph","id":"5654a85e436d_51","name":"bc8f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0DU6GqY7MiTNEyq9j03c9Q.png"},"text":"Allocate And Write To Memory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_52":{"__typename":"Paragraph","id":"5654a85e436d_52","name":"a7a1","type":"P","href":null,"layout":null,"metadata":null,"text":"From the above code, we can see that the malware used the WriteProcessMemory function to write the function sub_181064570 into dllhost process created earlier. Although this seems to be a common process injection, it matches the checkpoint’s report, where it mentions that it injects itself to another process such as rundll32.exe and dllhost.exe.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":58,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":108,"end":121,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":127,"end":134,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_53":{"__typename":"Paragraph","id":"5654a85e436d_53","name":"c74e","type":"H4","href":null,"layout":null,"metadata":null,"text":"Decoding Embedded Data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_54":{"__typename":"Paragraph","id":"5654a85e436d_54","name":"3872","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, we have reached the part where we can see what this malware actually wants to do! This is how the first few lines of the function written into the process’s memory looks like:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_TCIJsAgMDb6fNGqrEf12w.png":{"__typename":"ImageMetadata","id":"1*_TCIJsAgMDb6fNGqrEf12w.png","originalHeight":293,"originalWidth":384,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_55":{"__typename":"Paragraph","id":"5654a85e436d_55","name":"a158","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_TCIJsAgMDb6fNGqrEf12w.png"},"text":"Write to Memory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_56":{"__typename":"Paragraph","id":"5654a85e436d_56","name":"657e","type":"P","href":null,"layout":null,"metadata":null,"text":"It looks like the malware copying two sets of data located at qword_181065CC0 into the memory.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":62,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CQU_wgsOH3WshxmB4bHclQ.png":{"__typename":"ImageMetadata","id":"1*CQU_wgsOH3WshxmB4bHclQ.png","originalHeight":749,"originalWidth":826,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_57":{"__typename":"Paragraph","id":"5654a85e436d_57","name":"c70c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CQU_wgsOH3WshxmB4bHclQ.png"},"text":"Encoded Blob in Memory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_58":{"__typename":"Paragraph","id":"5654a85e436d_58","name":"7319","type":"P","href":null,"layout":null,"metadata":null,"text":"After copying the data into the memory, the malware calls a function which will decode the data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*-ICQfaKgR3QFBCAENBuqeA.png":{"__typename":"ImageMetadata","id":"1*-ICQfaKgR3QFBCAENBuqeA.png","originalHeight":189,"originalWidth":1193,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_59":{"__typename":"Paragraph","id":"5654a85e436d_59","name":"6f7f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*-ICQfaKgR3QFBCAENBuqeA.png"},"text":"First Decoded Blob","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_60":{"__typename":"Paragraph","id":"5654a85e436d_60","name":"a5b2","type":"P","href":null,"layout":null,"metadata":null,"text":"The first blob of data contains the URL of the C2 server “news.nyhedmgtxck.com” and a string of characters which doesn’t seems to be used in any part of the execution.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":58,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZJneAXOsOoDmoG3sUp3onw.png":{"__typename":"ImageMetadata","id":"1*ZJneAXOsOoDmoG3sUp3onw.png","originalHeight":246,"originalWidth":312,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_61":{"__typename":"Paragraph","id":"5654a85e436d_61","name":"0c98","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZJneAXOsOoDmoG3sUp3onw.png"},"text":"Second Decoded Blob","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_62":{"__typename":"Paragraph","id":"5654a85e436d_62","name":"8035","type":"P","href":null,"layout":null,"metadata":null,"text":"And the second blob of data contains the imports table which the malware will use in the next phase of its activity. Wait a minute… does the 2 blobs of data sounds familiar?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_63":{"__typename":"Paragraph","id":"5654a85e436d_63","name":"d4f3","type":"P","href":null,"layout":null,"metadata":null,"text":"From checkpoint’s report on aria-body loader, they mentioned that one of the functionality of the loader is to decrypt two blobs of data into an Import Table and a loader configuration.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_64":{"__typename":"Paragraph","id":"5654a85e436d_64","name":"36ea","type":"H4","href":null,"layout":null,"metadata":null,"text":"Download and execute payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_65":{"__typename":"Paragraph","id":"5654a85e436d_65","name":"2158","type":"P","href":null,"layout":null,"metadata":null,"text":"By using the decoded import tables, the malware attempts to connects to the C2 URL to download a file.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*UZ-wT1RcxAS1WqrZW7d2NQ.png":{"__typename":"ImageMetadata","id":"1*UZ-wT1RcxAS1WqrZW7d2NQ.png","originalHeight":513,"originalWidth":602,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_66":{"__typename":"Paragraph","id":"5654a85e436d_66","name":"9dfb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UZ-wT1RcxAS1WqrZW7d2NQ.png"},"text":"Download Payload","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_67":{"__typename":"Paragraph","id":"5654a85e436d_67","name":"bced","type":"P","href":null,"layout":null,"metadata":null,"text":"To this point, it actually matches the points mentioned in Check Point’s report where Aria-body contact the embedded \u002F calculated C&C address in order to download retrieve the next stage payload.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_68":{"__typename":"Paragraph","id":"5654a85e436d_68","name":"0e60","type":"P","href":null,"layout":null,"metadata":null,"text":"Too bad for us, the URL has already been sinkhole. Therefore, I am not be able download the sample for analysis ):","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_69":{"__typename":"Paragraph","id":"5654a85e436d_69","name":"43d2","type":"P","href":null,"layout":null,"metadata":null,"text":"It’s not the end yet! Although I am not able to analyze the next stage payload, I am still able to see what this loader does before passing control to the next stage payload :D","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_70":{"__typename":"Paragraph","id":"5654a85e436d_70","name":"88a4","type":"P","href":null,"layout":null,"metadata":null,"text":"Once the payload is downloaded, the malware will first decode the payload with a XOR function. The decoded payload will then reside only in the memory. Which suggest that it could be a file-less malware.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3IPpiSjY6wsVWxeMUcSjjg.png":{"__typename":"ImageMetadata","id":"1*3IPpiSjY6wsVWxeMUcSjjg.png","originalHeight":326,"originalWidth":462,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_71":{"__typename":"Paragraph","id":"5654a85e436d_71","name":"c2de","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3IPpiSjY6wsVWxeMUcSjjg.png"},"text":"Decode Payload and Copy to Memory","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_72":{"__typename":"Paragraph","id":"5654a85e436d_72","name":"f759","type":"P","href":null,"layout":null,"metadata":null,"text":"Next, the malware then calls a function which checks if the payload contains the magic number “MZ” and “PE”.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*AHnahoKLf_s74T5v2HLMfg.png":{"__typename":"ImageMetadata","id":"1*AHnahoKLf_s74T5v2HLMfg.png","originalHeight":222,"originalWidth":648,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_73":{"__typename":"Paragraph","id":"5654a85e436d_73","name":"8d22","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*AHnahoKLf_s74T5v2HLMfg.png"},"text":"Check for PE and Section Header","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_74":{"__typename":"Paragraph","id":"5654a85e436d_74","name":"17dc","type":"P","href":null,"layout":null,"metadata":null,"text":"Once verified, the malware will finally get the entry point to the payload by calculating the djb2 hash of the payload’s export and comparing it with 0x2E9AD5FB. Without the second stage payload, I am unable to determine what is the export name based on that hash.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TnxRH77UqIRdIiEMs_j5Xg.png":{"__typename":"ImageMetadata","id":"1*TnxRH77UqIRdIiEMs_j5Xg.png","originalHeight":98,"originalWidth":307,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_75":{"__typename":"Paragraph","id":"5654a85e436d_75","name":"c6cb","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TnxRH77UqIRdIiEMs_j5Xg.png"},"text":"DJB2 Hash","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_76":{"__typename":"Paragraph","id":"5654a85e436d_76","name":"844f","type":"P","href":null,"layout":null,"metadata":null,"text":"Finally, the malware then passes the execution control to the payload.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VPkjI7kLjrHk7YzQEQWQuw.png":{"__typename":"ImageMetadata","id":"1*VPkjI7kLjrHk7YzQEQWQuw.png","originalHeight":259,"originalWidth":660,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:5654a85e436d_77":{"__typename":"Paragraph","id":"5654a85e436d_77","name":"c619","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VPkjI7kLjrHk7YzQEQWQuw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_78":{"__typename":"Paragraph","id":"5654a85e436d_78","name":"1ccc","type":"P","href":null,"layout":null,"metadata":null,"text":"The way this malware get the entry point also matches what Check Point had described where the loader loads and execute an exported function of the DLL — calculated using djb2 hashing algorithm.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_79":{"__typename":"Paragraph","id":"5654a85e436d_79","name":"de89","type":"H4","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_80":{"__typename":"Paragraph","id":"5654a85e436d_80","name":"9f69","type":"P","href":null,"layout":null,"metadata":null,"text":"Phew… Finally! We’ve reached the conclusion~~ v^^v","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_81":{"__typename":"Paragraph","id":"5654a85e436d_81","name":"d4c8","type":"P","href":null,"layout":null,"metadata":null,"text":"From the analysis, this malware looks like a loader which will download a payload from the C2 and execute the payload on the memory. The capabilities of this sample is very similar to the Aria-body loader that is described by Check Point where 5 out of the 7 points matching the analysis. I am unable to determine if this sample “establishes persistence via startup folder or run registry” and the “utilization of the DGA algorithm”. Putting the capabilities aside, I had look through the sample with the hash “40c49ecbe1b7bdodbb935138661b6ca4” mentioned in Check Point’s report and code wise, it looks vastly different from this sample.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_82":{"__typename":"Paragraph","id":"5654a85e436d_82","name":"34d0","type":"P","href":null,"layout":null,"metadata":null,"text":"Noticed that up to this point, I have only talked about the analysis of one of the samples. Well, I had done the analysis on both of the sample and in regards of the code executions, they are the same. The only difference between the two sample in regards to what is relevant to the execution and its function, is that the C2 string and the string of character in the first blob of data is different. Instead of going to “news[.]nyhedmgtxck[.]com”, the C2 of the other sample is “www[.]etnwtmrkh[.]com” both of which are sinkholed.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":422,"end":446,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":480,"end":501,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_83":{"__typename":"Paragraph","id":"5654a85e436d_83","name":"fd1c","type":"P","href":null,"layout":null,"metadata":null,"text":"Therefore, based on the capabilities, am I right to say that this could be a variant of Aria-Body loader?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_84":{"__typename":"Paragraph","id":"5654a85e436d_84","name":"0187","type":"P","href":null,"layout":null,"metadata":null,"text":"Hashes Analyzed:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_85":{"__typename":"Paragraph","id":"5654a85e436d_85","name":"0e54","type":"BQ","href":null,"layout":null,"metadata":null,"text":"1e56c3f05bb53d2dfa60bc016e8509b12fd3beb5f567d274a184bb67af1eb19c","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:5654a85e436d_86":{"__typename":"Paragraph","id":"5654a85e436d_86","name":"0f94","type":"BQ","href":null,"layout":null,"metadata":null,"text":"c5696e660f3cfa9232756418e40ad18729cfe32fb284bba2314dd523ba527258","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:8dea5b1882ca-viewerId:lo_90ab9d832695":{"__typename":"CollectionViewerEdge","id":"collectionId:8dea5b1882ca-viewerId:lo_90ab9d832695","isEditor":false,"isMuting":false},"UserViewerEdge:userId:fbbbb2c84e9a-viewerId:lo_90ab9d832695":{"__typename":"UserViewerEdge","id":"userId:fbbbb2c84e9a-viewerId:lo_90ab9d832695","isMuting":false},"PostViewerEdge:postId:53bdd630f8a1-viewerId:lo_90ab9d832695":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:53bdd630f8a1-viewerId:lo_90ab9d832695"},"Tag:aria-body":{"__typename":"Tag","id":"aria-body","displayTitle":"Aria Body","normalizedTagSlug":"aria-body"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:analysis":{"__typename":"Tag","id":"analysis","displayTitle":"Analysis","normalizedTagSlug":"analysis"},"Post:53bdd630f8a1":{"__typename":"Post","id":"53bdd630f8a1","collection":{"__ref":"Collection:8dea5b1882ca"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"1f49","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"e0a2","startIndex":84,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:5654a85e436d_0"},{"__ref":"Paragraph:5654a85e436d_1"},{"__ref":"Paragraph:5654a85e436d_2"},{"__ref":"Paragraph:5654a85e436d_3"},{"__ref":"Paragraph:5654a85e436d_4"},{"__ref":"Paragraph:5654a85e436d_5"},{"__ref":"Paragraph:5654a85e436d_6"},{"__ref":"Paragraph:5654a85e436d_7"},{"__ref":"Paragraph:5654a85e436d_8"},{"__ref":"Paragraph:5654a85e436d_9"},{"__ref":"Paragraph:5654a85e436d_10"},{"__ref":"Paragraph:5654a85e436d_11"},{"__ref":"Paragraph:5654a85e436d_12"},{"__ref":"Paragraph:5654a85e436d_13"},{"__ref":"Paragraph:5654a85e436d_14"},{"__ref":"Paragraph:5654a85e436d_15"},{"__ref":"Paragraph:5654a85e436d_16"},{"__ref":"Paragraph:5654a85e436d_17"},{"__ref":"Paragraph:5654a85e436d_18"},{"__ref":"Paragraph:5654a85e436d_19"},{"__ref":"Paragraph:5654a85e436d_20"},{"__ref":"Paragraph:5654a85e436d_21"},{"__ref":"Paragraph:5654a85e436d_22"},{"__ref":"Paragraph:5654a85e436d_23"},{"__ref":"Paragraph:5654a85e436d_24"},{"__ref":"Paragraph:5654a85e436d_25"},{"__ref":"Paragraph:5654a85e436d_26"},{"__ref":"Paragraph:5654a85e436d_27"},{"__ref":"Paragraph:5654a85e436d_28"},{"__ref":"Paragraph:5654a85e436d_29"},{"__ref":"Paragraph:5654a85e436d_30"},{"__ref":"Paragraph:5654a85e436d_31"},{"__ref":"Paragraph:5654a85e436d_32"},{"__ref":"Paragraph:5654a85e436d_33"},{"__ref":"Paragraph:5654a85e436d_34"},{"__ref":"Paragraph:5654a85e436d_35"},{"__ref":"Paragraph:5654a85e436d_36"},{"__ref":"Paragraph:5654a85e436d_37"},{"__ref":"Paragraph:5654a85e436d_38"},{"__ref":"Paragraph:5654a85e436d_39"},{"__ref":"Paragraph:5654a85e436d_40"},{"__ref":"Paragraph:5654a85e436d_41"},{"__ref":"Paragraph:5654a85e436d_42"},{"__ref":"Paragraph:5654a85e436d_43"},{"__ref":"Paragraph:5654a85e436d_44"},{"__ref":"Paragraph:5654a85e436d_45"},{"__ref":"Paragraph:5654a85e436d_46"},{"__ref":"Paragraph:5654a85e436d_47"},{"__ref":"Paragraph:5654a85e436d_48"},{"__ref":"Paragraph:5654a85e436d_49"},{"__ref":"Paragraph:5654a85e436d_50"},{"__ref":"Paragraph:5654a85e436d_51"},{"__ref":"Paragraph:5654a85e436d_52"},{"__ref":"Paragraph:5654a85e436d_53"},{"__ref":"Paragraph:5654a85e436d_54"},{"__ref":"Paragraph:5654a85e436d_55"},{"__ref":"Paragraph:5654a85e436d_56"},{"__ref":"Paragraph:5654a85e436d_57"},{"__ref":"Paragraph:5654a85e436d_58"},{"__ref":"Paragraph:5654a85e436d_59"},{"__ref":"Paragraph:5654a85e436d_60"},{"__ref":"Paragraph:5654a85e436d_61"},{"__ref":"Paragraph:5654a85e436d_62"},{"__ref":"Paragraph:5654a85e436d_63"},{"__ref":"Paragraph:5654a85e436d_64"},{"__ref":"Paragraph:5654a85e436d_65"},{"__ref":"Paragraph:5654a85e436d_66"},{"__ref":"Paragraph:5654a85e436d_67"},{"__ref":"Paragraph:5654a85e436d_68"},{"__ref":"Paragraph:5654a85e436d_69"},{"__ref":"Paragraph:5654a85e436d_70"},{"__ref":"Paragraph:5654a85e436d_71"},{"__ref":"Paragraph:5654a85e436d_72"},{"__ref":"Paragraph:5654a85e436d_73"},{"__ref":"Paragraph:5654a85e436d_74"},{"__ref":"Paragraph:5654a85e436d_75"},{"__ref":"Paragraph:5654a85e436d_76"},{"__ref":"Paragraph:5654a85e436d_77"},{"__ref":"Paragraph:5654a85e436d_78"},{"__ref":"Paragraph:5654a85e436d_79"},{"__ref":"Paragraph:5654a85e436d_80"},{"__ref":"Paragraph:5654a85e436d_81"},{"__ref":"Paragraph:5654a85e436d_82"},{"__ref":"Paragraph:5654a85e436d_83"},{"__ref":"Paragraph:5654a85e436d_84"},{"__ref":"Paragraph:5654a85e436d_85"},{"__ref":"Paragraph:5654a85e436d_86"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:fbbbb2c84e9a"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Finsomniacs\u002Faria-body-loader-is-that-you-53bdd630f8a1","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"javascript"},{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"5654a85e436d","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":0,"allowResponses":true,"isLimitedState":false,"title":"Aria-Body Loader? Is that you?","isSeries":false,"sequence":null,"uniqueSlug":"aria-body-loader-is-that-you-53bdd630f8a1","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1632896914425,"readingTime":8.139622641509435,"previewContent":{"__typename":"PreviewContent","subtitle":"Hello! This is my first time writing a blog on a loader which I had gotten hold of. So, I am a new analyst in the Malware Analysis field…"},"previewImage":{"__ref":"ImageMetadata:1*1fDVGzUIIlQUFCVbTsr8EQ.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1632896914425,"updatedAt":1641360913864,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:53bdd630f8a1-viewerId:lo_90ab9d832695"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:aria-body"},{"__ref":"Tag:malware"},{"__ref":"Tag:analysis"}],"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":1680,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9120.5df29668.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3e1a499c42cae0',t:'MTczNDUxMzg5Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3e1a499c42cae0","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>