<!DOCTYPE html>
<html class='v2' dir='ltr' lang='en'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/3566091532-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<meta content='width=1100' name='viewport'/>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://swapcontext.blogspot.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="The Vault - Atom" href="https://swapcontext.blogspot.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="The Vault - RSS" href="https://swapcontext.blogspot.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="The Vault - Atom" href="https://www.blogger.com/feeds/4548239178288169992/posts/default" />

<link rel="alternate" type="application/atom+xml" title="The Vault - Atom" href="https://swapcontext.blogspot.com/feeds/4954626624978968950/comments/default" />
<!--Can't find substitution for tag [blog.ieCssRetrofitLinks]-->
<link href='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s1600/tdl_r1.png' rel='image_src'/>
<meta content='https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html' property='og:url'/>
<meta content='Dustman APT: Art of Copy-Paste' property='og:title'/>
<meta content='Dustman is a piece of data wiping malware with origin believed to be from Iran or if you like - quote fromÂ  zdnet.com  &quot; Iranian state-spons...' property='og:description'/>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/w1200-h630-p-k-no-nu/tdl_r1.png' property='og:image'/>
<title>The Vault: Dustman APT: Art of Copy-Paste</title>
<style id='page-skin-1' type='text/css'><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #222222;
background: #66bbdd none repeat scroll top left;
padding: 0 40px 40px 40px;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png) repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png) repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 40px rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 5px rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 10px #333333;
box-shadow: 0 0 40px rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 10px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #3399bb;
text-shadow: -1px -1px 1px rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #3399bb;
}
.Header .description {
font-size: 140%;
color: #777777;
}
.header-inner .Header .titlewrapper {
padding: 22px 30px;
}
.header-inner .Header .descriptionwrapper {
padding: 0 30px;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 1px solid #eeeeee;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #eeeeee;
border-left: 0 solid #eeeeee;
border-right: 0 solid #eeeeee;
}
.tabs-inner .widget ul {
background: #f5f5f5 url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png) repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #eeeeee;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #999999;
border-left: 1px solid #ffffff;
border-right: 1px solid #eeeeee;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid #eeeeee;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid #eeeeee;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid #eeeeee;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: transparent;
color: #222222;
padding: inherit;
letter-spacing: inherit;
margin: inherit;
}
.main-inner {
padding-top: 30px;
padding-bottom: 30px;
}
.main-inner .column-center-inner {
padding: 0 15px;
}
.main-inner .column-center-inner .section {
margin: 0 15px;
}
.post {
margin: 0 0 25px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #222222;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #f9f9f9;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid #eeeeee;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #f9f9f9;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid #eeeeee;
}
.blog-pager {
background: transparent none no-repeat scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 0 dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #222222;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #eeeeee;
border-bottom: 1px solid #eeeeee;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #eeeeee;
}

--></style>
<style id='template-skin-1' type='text/css'><!--
body {
min-width: 1500px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 1500px;
max-width: 1500px;
_width: 1500px;
}
.main-inner .columns {
padding-left: 0px;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0px;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0px") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0px;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0px;
right: 100%;
margin-left: -0px;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4548239178288169992&amp;zx=772bc7c4-03be-40f4-a59c-86d62a7644e1' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=4548239178288169992&amp;zx=772bc7c4-03be-40f4-a59c-86d62a7644e1' rel='stylesheet'/></noscript>
<meta name='google-adsense-platform-account' content='ca-host-pub-1556223355139109'/>
<meta name='google-adsense-platform-domain' content='blogspot.com'/>

</head>
<body class='loading variant-pale'>
<div class='navbar section' id='navbar' name='Navbar'><div class='widget Navbar' data-version='1' id='Navbar1'><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"></div>
<script type="text/javascript" src="https://apis.google.com/js/platform.js"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d4548239178288169992\x26blogName\x3dThe+Vault\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://swapcontext.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttps://swapcontext.blogspot.com/\x26targetPostID\x3d4954626624978968950\x26blogPostOrPageUrl\x3dhttps://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html\x26vt\x3d-7633102799881797392',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe",
              messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
              messageHandlers: {
                'blogger-ping': function() {}
              }
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class='body-fauxcolumns'>
<div class='fauxcolumn-outer body-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content'>
<div class='content-fauxcolumns'>
<div class='fauxcolumn-outer content-fauxcolumn-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<div class='content-outer'>
<div class='content-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left content-fauxborder-left'>
<div class='fauxborder-right content-fauxborder-right'></div>
<div class='content-inner'>
<header>
<div class='header-outer'>
<div class='header-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left header-fauxborder-left'>
<div class='fauxborder-right header-fauxborder-right'></div>
<div class='region-inner header-inner'>
<div class='header section' id='header' name='Header'><div class='widget Header' data-version='1' id='Header1'>
<div id='header-inner'>
<div class='titlewrapper'>
<h1 class='title'>
<a href='https://swapcontext.blogspot.com/'>
The Vault
</a>
</h1>
</div>
<div class='descriptionwrapper'>
<p class='description'><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class='header-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</header>
<div class='tabs-outer'>
<div class='tabs-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left tabs-fauxborder-left'>
<div class='fauxborder-right tabs-fauxborder-right'></div>
<div class='region-inner tabs-inner'>
<div class='tabs no-items section' id='crosscol' name='Cross-Column'></div>
<div class='tabs no-items section' id='crosscol-overflow' name='Cross-Column 2'></div>
</div>
</div>
<div class='tabs-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='main-outer'>
<div class='main-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left main-fauxborder-left'>
<div class='fauxborder-right main-fauxborder-right'></div>
<div class='region-inner main-inner'>
<div class='columns fauxcolumns'>
<div class='fauxcolumn-outer fauxcolumn-center-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-left-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div class='cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left'>
<div class='fauxborder-right'></div>
<div class='fauxcolumn-inner'>
</div>
</div>
<div class='cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class='columns-inner'>
<div class='column-center-outer'>
<div class='column-center-inner'>
<div class='main section' id='main' name='Main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='blog-posts hfeed'>

          <div class="date-outer">
        
<h2 class='date-header'><span>Monday, January 20, 2020</span></h2>

          <div class="date-posts">
        
<div class='post-outer'>
<div class='post hentry uncustomized-post-template' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'>
<meta content='https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s1600/tdl_r1.png' itemprop='image_url'/>
<meta content='4548239178288169992' itemprop='blogId'/>
<meta content='4954626624978968950' itemprop='postId'/>
<a name='4954626624978968950'></a>
<h3 class='post-title entry-title' itemprop='name'>
Dustman APT: Art of Copy-Paste
</h3>
<div class='post-header'>
<div class='post-header-line-1'></div>
</div>
<div class='post-body entry-content' id='post-body-4954626624978968950' itemprop='description articleBody'>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Dustman is a piece of data wiping malware with origin believed to be from Iran or if you like - quote from&nbsp;<a href="https://www.zdnet.com/article/new-iranian-data-wiper-malware-hits-bapco-bahrains-national-oil-company/">zdnet.com</a> "</span><span style="font-family: &quot;verdana&quot; , sans-serif;">Iranian state-sponsored hackers".&nbsp;</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">There is a full technical overview of this malware -&gt; <a href="https://www.scribd.com/document/442225568/Saudi-Arabia-CNA-report">https://www.scribd.com/document/442225568/Saudi-Arabia-CNA-report</a>, I wouldn't waste time fully repeating it, as it gives a brief and enough description of this malware key parameters and capabilities.</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Usually I pay zero attention to typical APT hysterics and low quality malware pushed by mass media/various <strike>fake</strike>Av's as "incredible sophisticated" spyware/whatever. With exception if there is anything related to my work, for example copy/pasted from it. Just like in this case.</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">This is believed shared code with another data wiper called "ZeroCleare" - and IBM did analysis with 28 page PDF where they managed to copy-paste from my github repository without even giving a single credit or link to original. Well, ok, fuck you too IBM IRIS rippers ð© </span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Why this thing called Dustman? Well authors of this malware were lazy and left full pdb string inside main dropper <b>C:\Users\Admin\Desktop\Dustman\x64\Release\Dustman.pdb</b>. This doesn't look like fake and left because Visual Studio (and this one created in it) always sets debug information to Release builds by default (Project settings-&gt;Linker-&gt;Debugging). It is something from series of small tips just like if you are wondering why some of rootkits pdb paths always at Z: drive - easy to use hotkey while debugging on VMware.</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Dustman main executable is a muldrop (SHA-1 e3ae32ebe8465c7df1225a51234f13e8a44969cc).&nbsp;</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">It contain three more files stored inside executable resource section. They are encrypted with simple xor.</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">for (ULONG i = 0; i &lt; (ResourceSize / sizeof(ULONG_PTR)); i++) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Buffer[i] ^= 0x7070707070707070;</span></span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"> </span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Resource with id 1 (decrypted SHA-1 7c1b25518dee1e30b5a6eaa1ea8e4a3780c24d0c) is a VirtualBox driver. It is ripped by me from WinNT/Turla (another APT, this time "believed" to be from GRU GS AF RF, that one by the way also had some references/inspirations of my/our previous work). Dustman author(s) got it from my github repository called TDL - Turla Driver Loader (<a href="https://github.com/hfiref0x/TDL">https://github.com/hfiref0x/TDL</a>), well not only that driver, half of their work actually blatant copy-paste of this repository.</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Resource with id 103 (decrypted SHA-1 a7133c316c534d1331c801bbcd3f4c62141013a1) is Eldos RawDisk modified driver (version 3.0.31.121). It is modified by Dustman authors by removing digital certificate from it. Currently I have no answer why they did this, except Eldos RawDisk certificate is widely blacklisted or detected by intrusion prevention systems/AV as possible sign of threat as it was used before multiple times in different malwares (<a href="https://attack.mitre.org/software/S0364/">https://attack.mitre.org/software/S0364/</a>)</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Resource with id 106 (decrypted SHA-1 20d61c337653392ea472352931820dc60c37b2bc) is malware agent application that is intended to work with Eldos RawDisk to perform data wipe. It contain pdb string <b>C:\Users\Admin\Desktop\Dustman\Furutaka\drv\agent.plain.pdb</b> which is giving you insides on VS solution structure. Furutaka is an internal name that I gave to TDL project executable.</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Initial dropper is a modified version of original TDL (Furutaka) version 1.1.5, so it is relatively new, as this is final version in that repository before it was archived at April 2019. Just to show you how much Dustman authors copy-pasted, here is a screenshot of functions which I was able to identify in this malware (while rest of them are various trash from MS runtime).</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s1600/tdl_r1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="577" data-original-width="601" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s1600/tdl_r1.png" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Pic 1. Dustman dropper functions.</td></tr>
</tbody></table>
<span style="font-family: &quot;verdana&quot; , sans-serif;">It seems Dustman author(s) simple took TDL solution and then modified it by removing console/debug output in code and adapting it for their specific tasks - decrypt, drop resources to the disk, load RawDisk driver and start agent application at final stage. Lets take a look on modifications made by Dustman author(s).</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><br /></span>
<span style="font-family: &quot;verdana&quot; , sans-serif;">At main (which is a heavily modified TDLMain from original TDL) right at the beginning Dustman attempts to block multiple copies from installing VirtualBox/mapping Eldos driver by setting mutex with a very specific name "Down With Bin Salman". I do not want to dig into politics and other bullshit but I would like to suggest in case if this is false flag operation (surprise, but we will never know this) use something more creative - like for example "Coded by Soleimani" or "(c) 2019 IRGC", "covfefe" is fine too. If I would doing APT of such kind I would at first refrain from creating such wrong and stupid mutexes or build their unique names based on current environment without using any idiotic constants. Another fun message hidden inside agent executable (dropper resource 106 as mentioned above) "Down With Saudi Kingdom Down With Bin Salman" - very creative (not). Eldos license key is hardcoded in agent executable as "b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d".</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Back to initial dropper, supQueryResourceData (<a href="https://github.com/hfiref0x/TDL/blob/master/Source/Furutaka/sup.c#L99">https://github.com/hfiref0x/TDL/blob/master/Source/Furutaka/sup.c#L99</a>) is modified by adding xor decryption loop mentioned above. Below is screenshot of TDLStartVulnerableDriver routine slightly modified by removing console output, code responsible for backup and new file name for dropped file.</span><br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiur_RAxVu9wlw7ihjCEDmW3I8p0lEeVbih88lnhJIM6qZIeIAHeTlsR4MgcaXdoYRsm7edkrGifdI4NwSk-I510evm3e_ERIX8rRSltO6gO4asw7fWA6XmLPjQhz9VdDTA7sZm_R4_ENg/s1600/tdl_r2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="756" data-original-width="557" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiur_RAxVu9wlw7ihjCEDmW3I8p0lEeVbih88lnhJIM6qZIeIAHeTlsR4MgcaXdoYRsm7edkrGifdI4NwSk-I510evm3e_ERIX8rRSltO6gO4asw7fWA6XmLPjQhz9VdDTA7sZm_R4_ENg/s1600/tdl_r2.png" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Pic 2. TDLStartVulnerableDriver copy-paste.</td></tr>
</tbody></table>
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Original routine <a href="https://github.com/hfiref0x/TDL/blob/master/Source/Furutaka/main.c#L498">https://github.com/hfiref0x/TDL/blob/master/Source/Furutaka/main.c#L498</a></span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Assistant.sys here is VirtualBox driver which is loaded as shown on picture above. Have no idea why Dustman authors left VirtualBox USB/Network drivers unload code intact. In original TDL this is required to load driver on machine with VirtualBox installed and this is requirement because <a href="https://github.com/hfiref0x/VBoxHardenedLoader">VBoxHardenedLoader</a> is depends on this. However this is not required in APT and can be removed, but it seems Dustman author(s) had mediocre understanding of what they are doing. It is a little doubtful that target machines has VirtualBox running which can produce incompatibilities with TDL.</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Our next stop is <a href="https://github.com/hfiref0x/TDL/blob/master/Source/Furutaka/main.c#L320">TDLMapDriver</a> routine. In original TDL proof-of-concept it setups shellcode that next will be executed in kernel by VBoxDrv, maps input file, processes it imports and merges it with shellcode. Next VBoxDrv memory mapping executed and finally exploit called. In shellcode original TDL allocates memory for driver mapping using <b>ExAllocatePoolWithTag</b> routine with tag 'SldT' (Tdl Shellcode), processes image relocs, creates system thread (<b>PsCreateSystemThread</b>) with parameter set to driver entry. TDL mapped drivers must be specially designed as DriverEntry parameters in such way of loading will be invalid. Finally thread handle closed with <b>ZwClose</b>. Function pointers passed to shellcode through registers by small bootstrap code which is constructed in user mode. Dustman author(s) modified this loading scheme in the following way:&nbsp;</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">1) Encryption for module/function names, funny note that the following string used to decrypt strings in runtime <i>"I'm 22 and looking for fulltime job!"</i>. Because this is copy-paste from open source and original TDL is very well detected by various <strike>fake</strike>AVs (<a href="https://www.virustotal.com/gui/file/37805cc7ae226647753aca1a32d7106d804556a98e1a21ac324e5b880b9a04da/detection">https://www.virustotal.com/gui/file/37805cc7ae226647753aca1a32d7106d804556a98e1a21ac324e5b880b9a04da/detection</a>) this maybe an attempt to remove <i>some</i> of these detections.</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">2) They remember <b>ExAllocatePoolWithTag</b>, <b>PsCreateSystemThread</b><i> </i>and <b>IoCreateDriver</b><i> </i>however they never use <b>PsCreateSystemThread</b><i> </i>despite checking it resolving success and instead in their shellcode simple call <b>IoCreateDriver</b> with pointer to driver entry point<i> </i>as </span><span style="font-family: &quot;verdana&quot; , sans-serif;"><span class="st"><i>InitializationFunction</i> param.</span></span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;"><span class="st">Since <b>IoCreateDriver</b> expects</span></span><span style="font-family: &quot;verdana&quot; , sans-serif;"><span class="st"><span class="st"> <i>DriverName</i> </span> as pointer to UNICODE_STRING modified shellcode also contain "<b>\Driver\elRawDsk</b>" string stored as local array of bytes. <b>IoCreateDriver</b> will create driver object with specified name and pass it to the InitializationRoutine as parameter, exactly what Eldos RawDisk need at it driver entry. Thus original TDL limitation bypassed and mapping code can work with usual drivers. As result of successful exploitation Eldos RawDisk will be mapped to the kernel and it DriverEntry executed.</span></span><br />
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
</div>
<span style="font-family: &quot;verdana&quot; , sans-serif;">&nbsp;<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhNgmRnzgsv0zSgHa1qJpAtGyytsuugU-HBiKOMQwG_5brYti6IFWi5VySZP4tfxCE_dpbXnWYl3rjDke9Jx_jd1xVqJlUgIBv2euiCW54bP-JROIn_7wtlr8zuBOgpfSpy57IXg024p7U/s1600/elrawdsk.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="731" data-original-width="1105" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhNgmRnzgsv0zSgHa1qJpAtGyytsuugU-HBiKOMQwG_5brYti6IFWi5VySZP4tfxCE_dpbXnWYl3rjDke9Jx_jd1xVqJlUgIBv2euiCW54bP-JROIn_7wtlr8zuBOgpfSpy57IXg024p7U/s1600/elrawdsk.png" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Pic 3. Eldos driver object as seen by WinObjEx64.</td></tr>
</tbody></table>
</span><br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">Because driver was mapped without involving Windows loader it doesn't have corresponding entry in <b>PsLoadedModulesList</b> therefore WinObjEx64 shows it driver object major functions as belonging to unknown memory area which is always automatically suspicious and usually mean kernel mode malware activity. While Eldos RawDisk DriverEntry execution it creates a symbolic link to provide access for the applications. It also can be seen with WinObjEx64.</span><br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmDN0xY312curWNkwt0k8j6AZrnOSGgQ9VMjqY5ZaiY413tAkxnhY7RxQZlCyfeq4G9v9Tmj4ko9CzEPihy4VQ-4PZzXKB2xZK2n1e7f2WPEylKXSZLKMNPlLPl2PLoPMXIASfmrFsIQk/s1600/elrawdsk2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="778" data-original-width="1043" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhmDN0xY312curWNkwt0k8j6AZrnOSGgQ9VMjqY5ZaiY413tAkxnhY7RxQZlCyfeq4G9v9Tmj4ko9CzEPihy4VQ-4PZzXKB2xZK2n1e7f2WPEylKXSZLKMNPlLPl2PLoPMXIASfmrFsIQk/s1600/elrawdsk2.png" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Pic 4. ElRawDisk symbolic link.</td></tr>
</tbody></table>
<span style="font-family: &quot;verdana&quot; , sans-serif;">Here is a mystery or at least question. Why do they use TDL at all? If you look at Eldos RawDisk previous versions, for example <a href="https://www.virustotal.com/gui/file/c5c821f5808544a1807dc36527ef6f0248d6768ef9ac5ebabae302d17dd960e4/details">https://www.virustotal.com/gui/file/c5c821f5808544a1807dc36527ef6f0248d6768ef9ac5ebabae302d17dd960e4/details</a> you will notice it is digitally signed. As I said at the beginning of this post there can be IPS/AV blocking Eldos driver by it certificate. However why use Eldos RawDisk if you can write your own driver which will be much simpler/smaller (because it will miss useless license check) and use it with TDL? It seems author(s) of Dustman prefer simplest ways and incapable of writing anything beyond simple copy-pasting with small additions. State sponsored hackers, rofl? It of course depends on effectiveness of such methods but I think someone need a bigger budget. However if you take this entire Dustman as false flag operation it looks pretty much ok, because Dustman thing can be built in 4-5 hours and cost almost nothing, while doing severe impact as informational warfare.</span><br />
<br />
<span style="font-family: &quot;verdana&quot; , sans-serif;">A little about agent application, a little because as fact there is nothing interesting inside. It is built as typical C++ MS runtime based application full of ineffective code unrelated to main purpose - wipe data on disk. To do this agent calls Eldos RawDisk with mentioned above license. As data to fill it uses "Down With Saudi Kingdom Down With Bin Salman" string. If agent launched without elevation it will crash with error due to its code quality, state sponsored hackers do you remember?</span><br />
<br />
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgESUbi1Qd6ode-HCfZNiVx2GpYv9tazGxidWzc5aPW0MtiSBbg0esWYTXKmnh2Y-2vEiMmgV8CCcpMdvJB5vnFlx_fTO0eTxt44cIeXyLcI1DKTeGwptC5BGpXFm2wNMD5Fw7mmQbG_-c/s1600/result.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" data-original-height="801" data-original-width="878" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgESUbi1Qd6ode-HCfZNiVx2GpYv9tazGxidWzc5aPW0MtiSBbg0esWYTXKmnh2Y-2vEiMmgV8CCcpMdvJB5vnFlx_fTO0eTxt44cIeXyLcI1DKTeGwptC5BGpXFm2wNMD5Fw7mmQbG_-c/s1600/result.png" /></a></td></tr>
<tr><td class="tr-caption" style="text-align: center;">Pic 5. Wipe in progress.</td></tr>
</tbody></table>
<span style="font-family: &quot;verdana&quot; , sans-serif;"><span style="font-family: &quot;verdana&quot; , sans-serif;">&nbsp;</span> </span>
<div style='clear: both;'></div>
</div>
<div class='post-footer'>
<div class='post-footer-line post-footer-line-1'>
<span class='post-author vcard'>
Posted by
<span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://www.blogger.com/profile/10872911887959394109' itemprop='url'/>
<a class='g-profile' href='https://www.blogger.com/profile/10872911887959394109' rel='author' title='author profile'>
<span itemprop='name'>hfiref0x</span>
</a>
</span>
</span>
<span class='post-timestamp'>
at
<meta content='https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html' itemprop='url'/>
<a class='timestamp-link' href='https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html' rel='bookmark' title='permanent link'><abbr class='published' itemprop='datePublished' title='2020-01-20T08:13:00-08:00'>8:13&#8239;AM</abbr></a>
</span>
<span class='post-comment-link'>
</span>
<span class='post-icons'>
<span class='item-control blog-admin pid-185626028'>
<a href='https://www.blogger.com/post-edit.g?blogID=4548239178288169992&postID=4954626624978968950&from=pencil' title='Edit Post'>
<img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/>
</a>
</span>
</span>
<div class='post-share-buttons goog-inline-block'>
<a class='goog-inline-block share-button sb-email' href='https://www.blogger.com/share-post.g?blogID=4548239178288169992&postID=4954626624978968950&target=email' target='_blank' title='Email This'><span class='share-button-link-text'>Email This</span></a><a class='goog-inline-block share-button sb-blog' href='https://www.blogger.com/share-post.g?blogID=4548239178288169992&postID=4954626624978968950&target=blog' onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target='_blank' title='BlogThis!'><span class='share-button-link-text'>BlogThis!</span></a><a class='goog-inline-block share-button sb-twitter' href='https://www.blogger.com/share-post.g?blogID=4548239178288169992&postID=4954626624978968950&target=twitter' target='_blank' title='Share to X'><span class='share-button-link-text'>Share to X</span></a><a class='goog-inline-block share-button sb-facebook' href='https://www.blogger.com/share-post.g?blogID=4548239178288169992&postID=4954626624978968950&target=facebook' onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target='_blank' title='Share to Facebook'><span class='share-button-link-text'>Share to Facebook</span></a><a class='goog-inline-block share-button sb-pinterest' href='https://www.blogger.com/share-post.g?blogID=4548239178288169992&postID=4954626624978968950&target=pinterest' target='_blank' title='Share to Pinterest'><span class='share-button-link-text'>Share to Pinterest</span></a>
</div>
</div>
<div class='post-footer-line post-footer-line-2'>
<span class='post-labels'>
Labels:
<a href='https://swapcontext.blogspot.com/search/label/apt' rel='tag'>apt</a>,
<a href='https://swapcontext.blogspot.com/search/label/dustman' rel='tag'>dustman</a>,
<a href='https://swapcontext.blogspot.com/search/label/malware' rel='tag'>malware</a>,
<a href='https://swapcontext.blogspot.com/search/label/vboxhardenedloader' rel='tag'>vboxhardenedloader</a>,
<a href='https://swapcontext.blogspot.com/search/label/winobjex64' rel='tag'>winobjex64</a>,
<a href='https://swapcontext.blogspot.com/search/label/zerocleare' rel='tag'>zerocleare</a>
</span>
</div>
<div class='post-footer-line post-footer-line-3'>
<span class='post-location'>
</span>
</div>
</div>
</div>
<div class='comments' id='comments'>
<a name='comments'></a>
<h4>No comments:</h4>
<div id='Blog1_comments-block-wrapper'>
<dl class='avatar-comment-indent' id='comments-block'>
</dl>
</div>
<p class='comment-footer'>
<div class='comment-form'>
<a name='comment-form'></a>
<h4 id='comment-post-message'>Post a Comment</h4>
<p>
</p>
<p>Note: Only a member of this blog may post a comment.</p>
<a href='https://www.blogger.com/comment/frame/4548239178288169992?po=4954626624978968950&hl=en' id='comment-editor-src'></a>
<iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' frameborder='0' height='410px' id='comment-editor' name='comment-editor' src='' width='100%'></iframe>
<script src='https://www.blogger.com/static/v1/jsbin/2315299244-comment_from_post_iframe.js' type='text/javascript'></script>
<script type='text/javascript'>
      BLOG_CMT_createIframe('https://www.blogger.com/rpc_relay.html');
    </script>
</div>
</p>
</div>
</div>

        </div></div>
      
</div>
<div class='blog-pager' id='blog-pager'>
<span id='blog-pager-newer-link'>
<a class='blog-pager-newer-link' href='https://swapcontext.blogspot.com/2020/01/unwinding-rtcore.html' id='Blog1_blog-pager-newer-link' title='Newer Post'>Newer Post</a>
</span>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://swapcontext.blogspot.com/2020/01/winobjex64-v183-release.html' id='Blog1_blog-pager-older-link' title='Older Post'>Older Post</a>
</span>
<a class='home-link' href='https://swapcontext.blogspot.com/'>Home</a>
</div>
<div class='clear'></div>
<div class='post-feeds'>
<div class='feed-links'>
Subscribe to:
<a class='feed-link' href='https://swapcontext.blogspot.com/feeds/4954626624978968950/comments/default' target='_blank' type='application/atom+xml'>Post Comments (Atom)</a>
</div>
</div>
</div></div>
</div>
</div>
<div class='column-left-outer'>
<div class='column-left-inner'>
<aside>
</aside>
</div>
</div>
<div class='column-right-outer'>
<div class='column-right-inner'>
<aside>
<div class='sidebar section' id='sidebar-right-1'><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<h2>Blog Archive</h2>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2022/'>
2022
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2022/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2022/02/'>
February
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2021/'>
2021
</a>
<span class='post-count' dir='ltr'>(2)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2021/04/'>
April
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/'>
2020
</a>
<span class='post-count' dir='ltr'>(11)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/10/'>
October
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/08/'>
August
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/03/'>
March
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/02/'>
February
</a>
<span class='post-count' dir='ltr'>(3)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy toggle-open'>

        &#9660;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2020/01/'>
January
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='posts'>
<li><a href='https://swapcontext.blogspot.com/2020/01/unwinding-rtcore.html'>Unwinding RTCore</a></li>
<li><a href='https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html'>Dustman APT: Art of Copy-Paste</a></li>
<li><a href='https://swapcontext.blogspot.com/2020/01/winobjex64-v183-release.html'>WinObjEx64 v1.8.3 release</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2019/'>
2019
</a>
<span class='post-count' dir='ltr'>(3)</span>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2019/12/'>
December
</a>
<span class='post-count' dir='ltr'>(1)</span>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<a class='toggle' href='javascript:void(0)'>
<span class='zippy'>

        &#9658;&#160;
      
</span>
</a>
<a class='post-count-link' href='https://swapcontext.blogspot.com/2019/11/'>
November
</a>
<span class='post-count' dir='ltr'>(2)</span>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style='clear: both'></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class='main-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
<footer>
<div class='footer-outer'>
<div class='footer-cap-top cap-top'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
<div class='fauxborder-left footer-fauxborder-left'>
<div class='fauxborder-right footer-fauxborder-right'></div>
<div class='region-inner footer-inner'>
<div class='foot no-items section' id='footer-1'></div>
<table border='0' cellpadding='0' cellspacing='0' class='section-columns columns-2'>
<tbody>
<tr>
<td class='first columns-cell'>
<div class='foot no-items section' id='footer-2-1'></div>
</td>
<td class='columns-cell'>
<div class='foot no-items section' id='footer-2-2'></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class='foot section' id='footer-3' name='Footer'><div class='widget Attribution' data-version='1' id='Attribution1'>
<div class='widget-content' style='text-align: center;'>
Simple theme. Powered by <a href='https://www.blogger.com' target='_blank'>Blogger</a>.
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='footer-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class='content-cap-bottom cap-bottom'>
<div class='cap-left'></div>
<div class='cap-right'></div>
</div>
</div>
</div>
<script type='text/javascript'>
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3704019819-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY7788k2zcqo3UXplLjX6Z11SiYn-Q:1734484523593';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d4548239178288169992','//swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html','4548239178288169992');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '4548239178288169992', 'title': 'The Vault', 'url': 'https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html', 'canonicalUrl': 'https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html', 'homepageUrl': 'https://swapcontext.blogspot.com/', 'searchUrl': 'https://swapcontext.blogspot.com/search', 'canonicalHomepageUrl': 'https://swapcontext.blogspot.com/', 'blogspotFaviconUrl': 'https://swapcontext.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The Vault - Atom\x22 href\x3d\x22https://swapcontext.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22The Vault - RSS\x22 href\x3d\x22https://swapcontext.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The Vault - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/4548239178288169992/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The Vault - Atom\x22 href\x3d\x22https://swapcontext.blogspot.com/feeds/4954626624978968950/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'boqCommentIframeForm': true, 'loginRedirectParam': '', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/2dbf2ee4cef330c7', 'plusOneApiSrc': 'https://apis.google.com/js/platform.js', 'disableGComments': true, 'interstitialAccepted': false, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'X', 'key': 'twitter', 'shareMessage': 'Share to X', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 0, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '4954626624978968950', 'postImageThumbnailUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s72-c/tdl_r1.png', 'postImageUrl': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s1600/tdl_r1.png', 'pageName': 'Dustman APT: Art of Copy-Paste', 'pageTitle': 'The Vault: Dustman APT: Art of Copy-Paste'}}, {'name': 'features', 'data': {}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'pale', 'variantId': 'pale'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Dustman APT: Art of Copy-Paste', 'description': 'Dustman is a piece of data wiping malware with origin believed to be from Iran or if you like - quote from\xa0 zdnet.com  \x22 Iranian state-spons...', 'featuredImage': 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhEDNh3XPSHTCK0d2iUJlpuD4lrCUbdUzSYw36vz8EUVW_P7YEmu7BnOi-dEDsV9UFQx9N0C1ArsUoA137WmE6IiqCwuiIbFEjwLjUnQi0gK0lB75iH7CgRFjvmzFyN9kAnOVTUv9m2uOQ/s1600/tdl_r1.png', 'url': 'https://swapcontext.blogspot.com/2020/01/dustman-apt-art-of-copy-paste.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 4954626624978968950}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/2019811046-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/1964470060-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-1', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>
</body>
</html>