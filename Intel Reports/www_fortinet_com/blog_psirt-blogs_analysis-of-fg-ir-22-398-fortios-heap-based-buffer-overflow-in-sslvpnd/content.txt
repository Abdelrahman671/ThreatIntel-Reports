
    <!DOCTYPE HTML>
    <html lang="en" data-template="post-page">
    <head>
        
        
        
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/visitorapi.min.js"/>
            <link rel="preload" as="script" href="/etc/designs/fortinet/adb-target/at.js"/>
            <script>

                   ;(function(win, doc, style, timeout) {
                   var STYLE_ID = 'at-body-style';
                   function getParent() {
                      return doc.getElementsByTagName('head')[0];
                   }
                   function addStyle(parent, id, def) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.createElement('style');
                      style.id = id;
                      style.innerHTML = def;
                      parent.appendChild(style);
                   }
                   function removeStyle(parent, id) {
                      if (!parent) {
                      return;
                      }
                      var style = doc.getElementById(id);
                      if (!style) {
                      return;
                      }
                      parent.removeChild(style);
                   }
                   addStyle(getParent(), STYLE_ID, style);
                   setTimeout(function() {
                      removeStyle(getParent(), STYLE_ID);
                   }, timeout);
                   }(window, document, "body {opacity: 0 !important}", 3000));
                </script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/visitorapi.min.js"></script>
            <script type="text/plain" class="optanon-category-C0003" src="/etc/designs/fortinet/adb-target/at.js"></script>
        
        
    <meta charset="UTF-8"/>
    <title>Analysis of FG-IR-22-398 – FortiOS - heap-based buffer overflow in SSLVPNd | Fortinet Blog</title>
    <meta name="keywords" content="PSIRT Blogs,PSIRT,fortios,ssl vpn"/>
    <meta name="description" content="Fortinet published CVSS: Critical advisory FG-IR-22-398 / CVE-2022-42475 on Dec 12, 2022.  This blog details our initial investigation into this malware and additional IoCs identified during our ongoing analysis. Read more."/>
    <meta name="template" content="post-page"/>
    

    <meta name="viewport" content="width=device-width, initial-scale=1"/>


<meta name="google-site-verification" content="tiQ03tSujT2TSsWJ6tNHiiUn8cwYVmdMQrGUCNrPQmo"/>

<meta property="og:site_name" content="Fortinet Blog"/>
<meta property="og:title" content="Analysis of FG-IR-22-398 – FortiOS - heap-based buffer overflow in SSLVPNd | Fortinet Blog"/>
<meta property="og:url" content="https://www.fortinet.com/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Fortinet published CVSS: Critical advisory FG-IR-22-398 / CVE-2022-42475 on Dec 12, 2022.  This blog details our initial investigation into this malware and additional IoCs identified during our on…"/>
<meta property="og:image" content="https://www.fortinet.com/content/dam/fortinet-blog/article-images/psirt-state-spons-hero.png"/>

<meta property="twitter:card" content="summary"/>
<meta property="twitter:site" content="@Fortinet"/>

<meta property="article:author" content="Carl Windsor, Guillaume Lovet, Hongkei Chan, and Alex Kong"/>

    <meta property="article:section" content="PSIRT Blogs"/>


    <meta property="article:published_time" content="2023-01-11T15:17:00.000Z"/>


    <meta property="article:tag" content="PSIRT"/>

    <meta property="article:tag" content="fortios"/>

    <meta property="article:tag" content="ssl vpn"/>


<link rel="shortcut icon" href="/etc/designs/fortinet-blog/favicon.ico"/>

<link rel="canonical" href="https://www.fortinet.com/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd"/>










    
<link rel="stylesheet" href="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.900b148ab7b87024003111a1245cca9c.css" type="text/css">





<!-- SEO Script -->




<!-- OneTrust Cookies Consent Notice start for fortinet.com -->



    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="f85f39fc-d7aa-467a-b762-fbb722748016"></script>
    <script type="text/javascript">

function OptanonWrapper() {
    {
       try{
            $('#cookiescript_injected').remove(); // remove old cookie script
        }catch(e){}
        window.dataLayer.push({
            event: 'OneTrustGroupsUpdated'
        });
        Optanon.InsertScript('//assets.adobedtm.com/launch-EN23cb8375449840dc93b13f34d935b8b9.min.js','head',null, null, '1',true);
    }
}

</script>


<!-- OneTrust Cookies Consent Notice end for fortinet.com -->
    
    
    

    
    

    
    
    
    

    

    

    

    

    



        <!-- BE IXF: BE IXF: Place getHeadOpen just inside of the head tag -->
        
        
<!-- be_ixf, sdk, gho-->
<meta name="be:sdk" content="java_sdk_1.6.7" />
<meta name="be:timer" content="32ms" />
<meta name="be:norm_url" content="https://www.fortinet.com/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd" />
<meta name="be:capsule_url" content="https://ixfd1-api.bc0a.com/api/ixf/1.0.0/get_capsule/f00000000310757/721726032" />
<meta name="be:api_dt" content="pny_2024; pnm_10; pnd_22; pnh_11; pnmh_11; pn_epoch:1729620686854" />
<meta name="be:mod_dt" content="pny_1969; pnm_12; pnd_31; pnh_16; pnmh_00; pn_epoch:0" />
<meta name="be:orig_url" content="https://www.fortinet.com/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd" />
<meta name="be:messages" content="34434" /><script type='text/javascript'>
if (window.BEJSSDKObserver === undefined) {
  (function(BEJSSDKObserver, $, undefined) {
    var observer = void 0;
    var listeners = [];
    var readySet = [];
    var doc = window.document;
    var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

    function checkSelector(selector, fn, indexList) {
      var elements = doc.querySelectorAll(selector);
  /**
    issues on IE @see https://www.codesd.com/item/javascript-es6-not-a-function-error.html
    elements = Array.from(elements);

    */
    for (var i = 0, len = elements.length; i < len; i++) {
      /* -1 means all instances */
      if (indexList != -1 && !(i in indexList)) {
        continue;
      }
      var element = elements[i];
      for (var j = 0; j < readySet.length; j++) {
        if (readySet[j] == element.className || readySet[j] == element.id) {
          return;
        }
      }
      if (element.className) {
        readySet.push(element.className);
      }
      if (element.id) {
        readySet.push(element.id);
      }

      if (!element.ready || MutationObserver==null) {
        element.ready = true;
        fn.call(element, element);
      }
    }
  }

  function checkListeners() {
    listeners.forEach(function (listener) {
      return checkSelector(listener.selector, listener.fn, listener.indexList);
    });
  }

  function removeListener(selector, fn) {
    var i = listeners.length;
    while (i--) {
      var listener = listeners[i];
      if (listener.selector === selector && listener.fn === fn) {
        listeners.splice(i, 1);
        if (!listeners.length && observer) {
          observer.disconnect();
          observer = null;
        }
      }
    }
  }

/**
 * Fire event on first js selector
 * @param selector string to watch on
 * @param fn       callback function
 * @param index_list can be undefined which means only first one
 *                   or -1 which means all
 *                   or a list of allowable indexes
 */
 BEJSSDKObserver.jsElementReady = function(selector, fn, index_list) {
  if (index_list === undefined) {
    index_list = [];
    index_list.push(0);
  }

  if (MutationObserver != null) {
    if (!observer) {
      observer = new MutationObserver(checkListeners);
      observer.observe(doc.documentElement, {
        childList: true,
        subtree: true
      });
    }
    listeners.push({ selector: selector, fn: fn, indexList: index_list });
  } else {
    /* <= IE8 */
    if (!document.addEventListener) {
      /* log("<=IE8 attachEvent assignment"); */
      document.addEventListener = document.attachEvent;
    }
    document.addEventListener("DOMContentLoaded", function(event) {
      var elements = doc.querySelectorAll(selector);
      for (var i = 0, len = elements.length; i < len; i++) {
        /* -1 means all instances */
        if (index_list != -1 && !(i in index_list)) {
          continue;
        }
        var element = elements[i];
        element.ready = true;
        fn.call(element, element);
      }
    });
  }

  checkSelector(selector, fn, index_list);
  return function () {
    return removeListener(selector, fn);
  };
};
}(window.BEJSSDKObserver = window.BEJSSDKObserver || {}));
}
var jsElementReady = window.BEJSSDKObserver.jsElementReady;

if (window.BELinkBlockGenerator === undefined) {
  (function(BELinkBlockGenerator, $, undefined) {
    BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = 100;
    BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = 200;

    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE = 0;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE = 1;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE = 2;
    BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE = 3;

    BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE = 0;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_POST_APPEND_ELEMENT = 1;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT = 2;
    BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT = 3;

    BELinkBlockGenerator.setMaximumHeadlineLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH = length;
    };

    BELinkBlockGenerator.setMaximumDescriptionLength = function(length) {
      BELinkBlockGenerator.MAXIMUM_DESC_LENGTH = length;
    };

    BELinkBlockGenerator.generateIndividualLinks = function(parentElement, linkStructure, link) {
      var link_level_element_tag = linkStructure[0];
      var link_level_element = document.createElement(link_level_element_tag);
      var link_attribute_dictionary = linkStructure[1];
      var allowable_elements = linkStructure[2];
      var children_link_structures = linkStructure[3];
      for (var link_attribute_key in link_attribute_dictionary) {
        link_level_element.setAttribute(link_attribute_key, link_attribute_dictionary[link_attribute_key]);
      }

      var added_something = false;
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_URL_TYPE)>=0) {
        link_level_element.setAttribute('href', link.url);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_HEADLINE_TYPE)>=0 && link.h1) {
        var headline_text = link.h1;
        if (headline_text.length > BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) {
          headline_text = headline_text.substring(0, BELinkBlockGenerator.MAXIMUM_HEADLINE_LENGTH) + '...';
        }
        var text_node = document.createTextNode(headline_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_DESCRIPTION_TYPE)>=0 && link.desc) {
        var desc_text = link.desc;
        if (desc_text.length > BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) {
          desc_text = desc_text.substring(0, BELinkBlockGenerator.MAXIMUM_DESC_LENGTH) + '...';
        }
        var text_node = document.createTextNode(desc_text);
        link_level_element.appendChild(text_node);
        added_something = true;
      }
      if (allowable_elements.indexOf(BELinkBlockGenerator.IND_LINK_BLOCK_TYPE_IMAGE_TYPE)>=0 && link.image) {
        link_level_element.setAttribute('src', link.image);
        added_something = true;
      }
/**
    don't emit for empty links, desc, headline, image
    except for parent structures where allowable_length=0
    */
    if (!added_something && allowable_elements.length != 0) {

      return;
    }
    /* go depth first */
    for (var childrenIndex=0; childrenIndex<children_link_structures.length; childrenIndex++) {
      var childLinkStructure = children_link_structures[childrenIndex];
      BELinkBlockGenerator.generateIndividualLinks(link_level_element, childLinkStructure, link);
    }
    parentElement.appendChild(link_level_element);
  };

  BELinkBlockGenerator.insertLinkBlocks = function(targetElement, replacementStrategy, overallStructure, linkStructure, links,
                                                   titleStructure) {
    if (targetElement == null) {
      return;
    }

    if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_OVERWRITE) {
      while (targetElement.firstChild) {
        targetElement.removeChild(targetElement.firstChild);
      }
    }

    var previousElement = targetElement;
    for (var i=0;i<overallStructure.length;i++) {
      var level_definition = overallStructure[i];
      var level_element_tag = level_definition[0];
      var level_element = document.createElement(level_element_tag);
      var attribute_dictionary = level_definition[1];
      for (var attribute_key in attribute_dictionary) {
        level_element.setAttribute(attribute_key, attribute_dictionary[attribute_key]);
      }

      /* need to place title structure */
      if (titleStructure && titleStructure[0] == i) {
        var title_element_tag = titleStructure[1];
        var title_element = document.createElement(title_element_tag);
        var title_attribute_dictionary = titleStructure[2];
        var title_text_content = titleStructure[3];
        for (var title_attribute_key in title_attribute_dictionary) {
          title_element.setAttribute(title_attribute_key, title_attribute_dictionary[title_attribute_key]);
        }

        var title_text_node = document.createTextNode(title_text_content);
        title_element.appendChild(title_text_node);


        level_element.appendChild(title_element);
      }

      /* last level place links */
      if (i == overallStructure.length-1) {
        for (var link_i=0; link_i < links.length; link_i++) {
          var link = links[link_i];
          for (var linkStructureIndex=0;linkStructureIndex < linkStructure.length; linkStructureIndex++) {
            BELinkBlockGenerator.generateIndividualLinks(level_element, linkStructure[linkStructureIndex], link)
          }
        }
      }

      /* first level child we need to check placement */
      if (previousElement == targetElement) {
        if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_ELEMENT) {
          /* 2 means insert right before */
          previousElement.insertBefore(level_element, targetElement.firstChild);
        } else if (replacementStrategy == BELinkBlockGenerator.REPLACEMENT_STRATEGY_PRE_APPEND_PARENT) {
          /* 3 means insert right before at parent level */
          var parentElement = previousElement.parentElement;
          parentElement.insertBefore(level_element, previousElement);
        } else {
          previousElement.appendChild(level_element);
        }
      } else {
        previousElement.appendChild(level_element);
      }
      previousElement = level_element;
    }
  };
}(window.BELinkBlockGenerator = window.BELinkBlockGenerator || {}))
};
</script>


        <!--BE IXF: Header End -->


    </head>
    <body>
    



    
<div class="root responsivegrid">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="b1-header aem-GridColumn aem-GridColumn--default--12">


<header class="b1-header__container">
    <div class="b1-header__logo">
        <a href="https://www.fortinet.com">
            
            <img class="desktop-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
            <img class="mobile-logo" src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet home"/>
        </a>
    </div>

    <div class="b1-header__cta-list">
      <a class="b1-header__cta-list-item " href="https://www.fortinet.com/blog">
          <span>Blog</span>
      </a>
    </div>

    <div class="b1-header__nav"><div class="b2-navigation">




    <ul class="b2-navigation__list">
        
            <li class="b2-navigation-categories"><div class="b2-navigation__list-item nav-dropdown-title">Categories</div>
                <ul class="navdropdown">
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/business-and-technology">
                                <span>Business &amp; Technology </span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/threat-research">
                                <span>FortiGuard Labs Threat Research</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/industry-trends">
                                <span>Industry Trends</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/life-at-fortinet">
                                <span>Life at Fortinet</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/partners">
                                <span>Partners</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/customer-stories">
                                <span>Customer Stories</span>
                            </a>
                        </li>
                    
                
                    
                        <li>
                            <a class="b2-navigation__dropdown__list-item" href="/blog/psirt-blogs">
                                <span>PSIRT Blogs</span>
                            </a>
                        </li>
                    
                </ul>
            </li>

        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/business-and-technology">
                    <span>Business &amp; Technology </span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/threat-research">
                    <span>FortiGuard Labs Threat Research</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/industry-trends">
                    <span>Industry Trends</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/life-at-fortinet">
                    <span>Life at Fortinet</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/partners">
                    <span>Partners</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/customer-stories">
                    <span>Customer Stories</span>
                </a>
            </li>
        
            <li class="m-nav-item">
                <a class="b2-navigation__list-item false" href="/blog/psirt-blogs">
                    <span>PSIRT Blogs</span>
                </a>
            </li>
        
        
        
            <li>
                <a class="b2-navigation__list-item false" href="/blog/ciso-collective">
                    <span>CISO Collective</span>
                </a>
            </li>
        
    </ul>


    

</div>
</div>

    <div id="blog-site-search" class="b1-header__search" aria-expanded="false"><div class="b3-searchbox">


<form class="b3-searchbox__form" action="/blog/search" method="get">
    <input class="b3-searchbox__input" type="text" name="q" placeholder="Search Blogs"/>
    <button class="b3-searchbox__icon" aria-label="Search" type="submit">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z" fill="#fff">
        </path>
    </svg>

    </button>
</form>


    

</div>
</div>

    <button class="b1-header__search-toggle" aria-controls="blog-site-search" aria-label="Search">
        
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.688 14.18l-4.075-4.075C12.36 9.06 12.8 7.78 12.8 6.4 12.8 2.87 9.93 0 6.4 0 2.87 0 0 2.87 0 6.4c0 3.53 2.87 6.4 6.4 6.4 1.38 0 2.66-.44 3.705-1.187l4.075 4.075c.207.208.48.312.753.312.274 0 .547-.104.755-.312.416-.417.416-1.093 0-1.51zM2.133 6.4c0-2.357 1.91-4.267 4.267-4.267s4.267 1.91 4.267 4.267-1.91 4.267-4.267 4.267S2.133 8.757 2.133 6.4z">
        </path>
    </svg>

        <div class="b1-header__search-toggle-close">
            <span class="b1-header__search-toggle-close-line"></span>
            <span class="b1-header__search-toggle-close-line"></span>
        </div>
    </button>

    <div class="b1-header__nav-toggle" aria-hidden="true">
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
        <span class="b1-header__nav-toggle-line"></span>
    </div>
</header>

    

</div>
<section class="b4-hero aem-GridColumn aem-GridColumn--default--12">



<div class="b4-hero__container" style="background-image:url(/content/dam/fortinet-blog/article-images/psirt-state-spons-hero.png);">
    <img class="ratio" alt="Analysis of FG-IR-22-398 – FortiOS - heap-based buffer overflow in SSLVPNd | Fortinet Blog" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
    <div class="b4-hero__text text-container">
        <p data-ly-test class="b4-hero__kicker">PSIRT Blogs</p>
        
        
        

        <h1 class="b4-hero__headline">Analysis of FG-IR-22-398 – FortiOS - heap-based buffer overflow in SSLVPNd</h1>
        
        
    </div>
</div>
</section>
<section class="b15-blog-meta aem-GridColumn aem-GridColumn--default--12">

<div class="b15-blog-meta__container text-container">
    <span>By </span>

    <span class="b15-blog-meta__author">

        
					

                        

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=Carl+Windsor">Carl Windsor,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Guillaume+Lovet"> Guillaume Lovet,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                           
                                                 <a href="/blog/search?author=+Hongkei+Chan"> Hongkei Chan,</a>
                                          
                                      
                                  
                          

                                  
                                      
                                            
                                          
                                              <a href="/blog/search?author="></a> and
                                          
                                           
                                      
                                  
                          

                                  
                                      
                                            
                                              <a href="/blog/search?author=Alex+Kong">Alex Kong</a>
                                          
                                          
                                           
                                      
                                  
                          
                    
        
    </span>
    <span class="b15-blog-meta__">
        

              </span>



    <span class="b15-blog-meta__date"> | January 11, 2023</span>
</div>
</section>
<div class="responsivegrid aem-GridColumn aem-GridColumn--default--12">


<div class="aem-Grid aem-Grid--12 aem-Grid--default--12 ">
    
    <div class="raw-import aem-GridColumn aem-GridColumn--default--12">
<div class="text-container"></div>
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p style="margin-left: 40.0px;"><b>Affected Platforms:</b> FortiOS<br />
<b>Impacted Users: </b>Government &amp;<b> </b>large organizations<br />
<b>Impact: </b>Data loss and OS and file corruption<br />
<b>Severity Level: </b>High</p>
<p>Fortinet has published CVSS: Critical advisory <a href="https://www.fortiguard.com/psirt/FG-IR-22-398" target="_blank">FG-IR-22-398</a> / <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-42475" target="_blank">CVE-2022-42475</a> on Dec 12, 2022. The following writeup details our initial investigation into this malware and additional IoCs identified during our ongoing analysis.</p>
<h2>Executive Summary</h2>
<ul>
<li>Multiple additional IoCs have been uncovered related to the incident <a href="https://www.fortiguard.com/psirt/FG-IR-22-398" target="_blank">FG-IR-22-398</a> / <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-42475" target="_blank">CVE-2022-42475</a></li>
<li>The complexity of the exploit suggests an advanced actor and that it is highly targeted at governmental or government-related targets.</li>
</ul>
<h2>Incident Analysis</h2>
<p>As mentioned in the advisory, we detected this issue in the wild and were able to collect a sample of the malware along with related network traffic.</p>
<p>The malware was a variant of a generic Linux implant customized for FortiOS. The following information was gathered during the forensic filesystem and binary analysis of the received appliance.</p>
<p><b>                                                  Libips.bak</b></p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image.img.png/1673466303612/pic-1.png" alt="Screenshot of /data/lib/lipis.bak" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The suspicious binary was located at <i>/data/lib/libips.bak</i>. This file may be masquerading as a component of Fortinet’s IPS Engine, located at /data/lib/libips.so. The file /data/lib/libips.so was present, but with a zero file size.</p>
<p>Here is an image of the /data/lib directory:</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_477914878.img.png/1673136776043/screen-shot-2023-01-07-at-4.12.41-pm.png" alt="Screenshot of /data/lib directory" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p><b>Libgif.so, libips.bak, </b>and<b> libiptcp.so</b> are not part of any FortiOS components or processes.</p>
<p><b>Libips.bak</b> appears to be a trojanized version of the IPS Engine, typically located at <b><i>/data/lib/libips.so</i>.</b> A diff comparing <b><i>libips.bak</i> </b>with a clean <b>libips.so</b> from the same FortiOS build was performed. Up to about the 0x1900 byte mark, the files differ. After that point, the files are identical. Below is a screenshot of<b> libips.bak </b>(top) and the clean <b>libips.so</b> (bottom). <b><i>libips.bak</i></b> contains data where <b>libips.so</b> does not.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_2114129547.img.png/1673136804350/screen-shot-2023-01-07-at-4.13.13-pm.png" alt="Screenshot of the clean libips.so " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>After the first ~0x1900 bytes, the files are identical.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_1834193383.img.png/1673136826252/screen-shot-2023-01-07-at-4.13.36-pm.png" alt="Screenshot of Libips.bak and Libips.so" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p><b>Libips.bak</b> exports the functions <b>ips_so_patch_urldb</b> and <b>ips_so_query_interface</b>. These are the same exports in the clean IPS engine binary, libips.so. Both exported functions lead to the same malicious code. If <b>libps.bak</b> is named libips.so in the <b>/data/lib</b> directory, the malicious code will be executed automatically as components of FortiOS will call these exported functions. The binary does not attempt to return to the clean IPS engine code, so IPS functionality is also compromised. Below is an example export function that immediately calls the malicious code.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--4 aem-GridColumn--default--4">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_1492017380.img.png/1673136853927/screen-shot-2023-01-07-at-4.14.01-pm.png" alt="screenshot of example export function that immediately calls the malicious code" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The primary malicious code is shown below.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--7 aem-GridColumn--offset--default--3">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_142531685.img.png/1673136900362/screen-shot-2023-01-07-at-4.14.50-pm.png" alt="Screenshot of main malicious code " class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The malicious code begins by looping through file descriptors from 3 to 255. If it can duplicate the file descriptors, it will close both the duplicate and original descriptors.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--4 aem-GridColumn--default--4">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_1875517238.img.png/1673136924741/screen-shot-2023-01-07-at-4.15.15-pm.png" alt="Screenshot of malicious code" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>Next, it will read from <b>/data/lib/libiptcp.so</b> and write the data to <b>/data/lib/libjepg.so. /data/lib/libjepg.so </b>is renamed as <b>/data/lib/libips.so. fork() </b>and<b> </b>is used multiple times initially as an anti-debugging technique.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--4 aem-GridColumn--default--4">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_135765974.img.png/1673136961786/screen-shot-2023-01-07-at-4.15.42-pm.png" alt="Screenshot of malicious code" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>It then calls <b>fork() </b>once more. The child process reads from <b>/data/lib/libgif.so</b> and writes that data to <b>/data/lib/libjepg.so. /data/lib/libjepg.so </b>is then renamed as <b>/data/lib/libips.so.</b></p>
<p>The parent process checks for read access to <b>/var/.sslvpnconfigbk</b>. This file is opened, then closed immediately. Finally, <b>/data/lib/libipudp.so </b>is executed with the argument <b>&quot;/data/lib/libipudp.so&quot;</b>.</p>
<p>The files referenced in this code—<b>libiptcp.so, libgif.so, .sslvpnconfigbk, </b>and<b> libipudp.so—</b>could not be recovered.</p>
<p><b>                                                   Wxd.conf</b></p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_200957054.img.png/1673105721349/pic-9.png" alt="Screenshot of data/etc/wxd.conf" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The format of this config file is similar to that of &quot;Fast reverse proxy” found at <a href="https://github.com/fatedier/frp" target="_blank">https://github.com/fatedier/frp</a>. This tool is described as &quot;a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet.&quot;</p>
<p>There are records for the server IP address in logs. It sends traffic to the server's ports 80, 443, and 444. Traffic is sent to a server with the address 188[.]34[.]130[.]40.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--5 aem-GridColumn--offset--default--3">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_2023078018.img.png/1673137022139/screen-shot-2023-01-07-at-4.16.53-pm.png" alt="Screenshot of logs" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Packet Capture Analysis</h2>
<p>Network packet captures obtained and analyzed by the FortiGuard Labs Threat Research Team identified suspicious traffic headed to 103[.]131[.]189[.]143. The major findings of this analysis are highlighted below.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--3 aem-GridColumn--default--4">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_1709979364.img.png/1673462763929/screen-shot-2023-01-11-at-10.45.40.png" alt="Sscreenshot of TCP Stream" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h3>103[.]131[.]189[.]143</h3>
<p>Communications with the suspicious IP 103[.]131[.]189[.]143 server served two primary purposes:(1) downloading payloads and (2) receiving and executing commands. Payloads were hosted on 103[.]131[.]189[.]143 using a Python (SimpleHTTP) server listening on port: 30080.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--10 aem-GridColumn--offset--default--1">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_277439998.img.png/1673106130000/screen-shot-2023-01-07-at-9.41.39-am.png" alt="Screenshot of port" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <p>The FortiGuard Labs Threat Research team was unable to recover the payloads because the packet captures were largely truncated or missing.</p>
<h3>TCP Stream 1894</h3>
<p>TCP stream 1894 contained the connection made to 103[.]131[.]189[.]143 listening on port 30443, which was an interactive shell session.</p>


</div>
<div class="cmp cmp-image aem-GridColumn--default--none aem-GridColumn aem-GridColumn--default--8 aem-GridColumn--offset--default--2">

    
        <noscript data-cmp-image="{&#34;smartImages&#34;:[],&#34;smartSizes&#34;:[],&#34;lazyEnabled&#34;:true}">
            
            <img src="/blog/psirt-blogs/analysis-of-fg-ir-22-398-fortios-heap-based-buffer-overflow-in-sslvpnd/_jcr_content/root/responsivegrid/image_1570194805.img.png/1673137100181/screen-shot-2023-01-07-at-4.18.09-pm.png" alt="Screenshot of TCP Stream" class="custom"/>
        </noscript>
    
    
    <!--<div class="enlarge-btn" data-sly-test=""><div class="gg-maximize-alt"></div> <div>Click to Enlarge</div></div>-->
    


    
</div>
<div class="cmp cmp-text aem-GridColumn aem-GridColumn--default--12">
  <h2>Post Incident Meta Data Investigation</h2>
<p>Through our detailed investigation of the PCAPs, an additional IoC was uncovered.</p>
<p style="margin-left: 40.0px;">185[.]174[.]136[.]20</p>
<p>The identification of this IoC led to a folder on the server containing binaries built specifically for relevant FortiGate hardware versions.</p>
<p>Using a Yara Rule created by the FortiGuard Threat Research Team, we were able to hunt for similar file samples. This also allowed us to identify the <b>/var/w</b> files that were seen executed in the PCAPs but not obtained directly from the file system.</p>
<h3>Sample Analysis</h3>
<p>From the analysis of the collected <b>/var/w files</b> samples, we found that the attacker uses advanced capabilities to manipulate FortiOS logging, as follows:</p>
<ul>
<li>The malware patches the logging processes<b> </b>of FortiOS to manipulate logs to evade detection. – <i>/bin/miglogd</i> &amp; <i>/bin/syslogd</i></li>
<li>It includes offsets and opcodes for 27 FortiGate models and version pairs. The malware opens a handle to the processes and injects data into them.<ul>
<li>Versions range from 6.0.5 to 7.2.1</li>
<li>Models are FG100F, FG101F, FG200D, FG200E, FG201F, FG240D, FG3H0E, FG5H0E, FG6H1E, FG800D, FGT5HD, FGT60F, FGT80F.</li>
</ul>
</li>
<li>The malware can manipulate log files. It searches for elog files, which are logs of events in FortiOS. After decompressing them in memory, it searches for a string the attacker specifies, deletes it, and reconstructs the logs.</li>
<li>The malware can also kill the logging processes.</li>
</ul>
<p>By emulating the malware's execution, we found a unique string of bytes in its <span>communication with its command &amp; control server</span><b> that can be used for an IPS signature. </b></p>
<ul>
<li>This string detects the TLS traffic by the TLS request header. </li>
<li>The buffer “\x00\x0C\x08http/1.1\x02h2\x00\x00\x00\x14\x00\x12\x00\x00\x0Fwww.example.com” (unescaped) should appear inside the “Client Hello” packet.</li>
</ul>
<h2>IOCs<br />
</h2>
<p>The following network indicators were found as part of the original and supplemental analysis (original IoCs are bolded).  For details on how to search on your FortiGate device for evidence of these indicators, see the following <a href="https://community.fortinet.com/t5/FortiGate/Technical-Tip-Critical-vulnerability-Protect-against-heap-based/ta-p/239420" target="_blank">Knowledgebase Article</a>.</p>
<h3>Filenames</h3>
<p>Presence of the following artifacts in the filesystem:</p>
<p><b>/data/lib/libips.bak</b></p>
<p><b>/data/lib/libgif.so</b></p>
<p><b>/data/lib/libiptcp.so</b></p>
<p><b>/data/lib/libipudp.so</b></p>
<p><b>/data/lib/libjepg.so</b></p>
<p><b>/var/.sslvpnconfigbk</b></p>
<p><b>/data/etc/wxd.conf</b></p>
<p><b>/flash</b></p>
<p><b> </b></p>
<h3>IP/Domains</h3>
<p><b>High Confidence</b></p>
<p><b>188[.]34[.]130[.]40                   (port 444 observed)</b></p>
<p><b>103[.]131[.]189[.]143                (ports 30080,30081,30443,20443 observed)</b></p>
<p><b>193[.]36[.]119[.]61                     (ports 8443,444 observed)</b></p>
<p><b>172[.]247[.]168[.]153               (port 8033 observed)</b></p>
<p><b>139[.]180[.]184[.]197</b></p>
<p><b>66[.]42[.]91[.]32</b></p>
<p><b>158[.]247[.]221[.]101</b></p>
<p><b>107[.]148[.]27[.]117</b></p>
<p><b>139[.]180[.]128[.]142</b></p>
<p><b>155[.]138[.]224[.]122</b></p>
<p><b>185[.]174[.]136[.]20</b></p>
<p>139[.]180[.]184[.]197</p>
<p>66[.]42[.]91[.]32</p>
<p>158[.]247[.]221[.]101</p>
<p>107[.]148[.]27[.]117</p>
<p>139[.]180[.]128[.]142</p>
<p>155[.]138[.]224[.]122</p>
<p>185[.]174[.]136[.]20</p>
<p>45[.]86[.]229[.]220<br />
</p>
<p>45[.]86[.]231[.]71</p>
<p>139[.]99[.]35[.]116</p>
<p>139[.]99[.]37[.]119</p>
<p>194[.]62[.]42[.]105</p>
<p>45[.]86[.]231[[.]71</p>
<p>45[.]86[.]229[[.]220</p>
<p>185[.]250[.]149[[.]32</p>
<p>137[.]175[.]30[.]138</p>
<p>146[.]70[.]157[[.]133</p>
<p><b>Older Actor IPs</b></p>
<p>156[.]251[.]162[.]76</p>
<p>156[.]251[.]163[.122</p>
<p>156[.]251[.]163[.]19</p>
<p>156[.]251[.]162[.111</p>
<p> </p>
<h3>File Path Samples</h3>
<p><b><i>Files from /var/w</i></b></p>
<p>Hashes of post-exploitation implants—MD5</p>
<p> </p>
<p><b>f68c3f72270800ea675889e82bb02fb8</b></p>
<p>e3f640d8785c0c864739529889b1863a</p>
<p>08cbaafb176ce6118f7e4e0b2d2d77cf</p>
<p>bdc2d2f5d5246f8956711bcce9f456b6</p>
<p>4548fa6625cb154ab320833186117393</p>
<p>e5d989b651b3eb351e10e408d5a062b3</p>
<p>3191cb2e06e9a30792309813793f78b6</p>
<p>12e28c14bb7f7b9513a02e5857592ad7</p>
<p>ae0839351721db5a9c269fd75dcb57ce</p>
<p>856341349dd954d82b112ba9165c4563</p>
<p> </p>
<p>Windows sample found on VT with significant code similarity to the samples found on FortiGates</p>
<p>54bbea35b095ddfe9740df97b693627b</p>
<p style="margin-left: 40.0px;"> </p>
<h3>JA3 Fingerprint</h3>
<p>The JA3 for the malware SSL/TLS client connection appears to be <b>unique to the malware</b> and can be used to detect an attack.</p>
<p>bf2b95ac267823f6588b2436bc537b26.</p>
<p> </p>
<h2>Summary of Our Knowledge About the Actor</h2>
<p>The complexity of the exploit suggests an advanced actor:</p>
<ul>
<li>The exploit requires a deep understanding of FortiOS and the underlying hardware.</li>
<li>The use of custom implants shows that the actor has advanced capabilities, including reverse-engineering various parts of FortiOS.</li>
<li>The actor is highly targeted, with some hints of preferred governmental or government-related targets.</li>
<li>The discovered Windows sample attributed to the attacker displayed artifacts of having been compiled on a machine in the UTC+8 timezone, which includes Australia, China, Russia, Singapore, and other Eastern Asian countries.</li>
<li>The self-signed certificates created by the attackers were all created between 3 and 8 AM UTC. However, it is difficult to draw any conclusions from this given hackers do not nessesarily operate during office hours and will often operate during victim office hours to help obfuscate their activity with general network traffic.</li>
</ul>
<h2>Conclusion</h2>
<p>Fortinet will continue to track this threat actor activity. To mitigate this issue, we recommend that all customers immediately take the actions recommended in the Critical Advisory, <a href="https://www.fortiguard.com/psirt/FG-IR-22-398" target="_blank">FG-IR-22-398</a>.  Additional guidance has been provided <a href="https://community.fortinet.com/t5/FortiGate/Technical-Tip-Critical-vulnerability-Protect-against-heap-based/ta-p/239420" target="_blank">here for how to search for the IoCs</a>.  Should you identify that your system is showing indicators of compromise, please <a href="https://support.fortinet.com/" target="_blank">reach out to Fortinet for support</a>.</p>
<p>Fortinet will continue to monitor this incident and will update this blog with information as it is found.</p>
<h2>Fortinet Protection</h2>
<p>The Fortinet Antivirus engine detects all binaries discussed in this blog using the following AV signatures:</p>
<p><a href="https://www.fortiguard.com/encyclopedia/virus/10119264">Elf/BakSo.SX!tr</a></p>
<p>The WebFiltering client blocks all network-based URIs.</p>
<p>A Fortinet Outbreak Alert Package has been created for FortiAnalyzer to detect and report on all traffic to or from IPs within the IoC range specified and will be included in Outbreak Alert Package DB 1.00083. </p>
<p><a href="https://www.fortiguard.com/updates/outbreak-detection-service?version=1.00083" target="_blank">https://www.fortiguard.com/updates/outbreak-detection-service?version=1.00083</a></p>
<p>Details on how to search for these IoCs can be found in the following Fortinet Community Tech Tip:</p>
<p><a href="https://community.fortinet.com/t5/FortiAnalyzer/Technical-Tip-Using-FortiAnalyzer-to-detect-the-FortiOS-heap/ta-p/242672" target="_blank">https://community.fortinet.com/t5/FortiAnalyzer/Technical-Tip-Using-FortiAnalyzer-to-detect-the-FortiOS-heap/ta-p/242672</a></p>
<p>Fortinet has released an IPS signature to proactively protect our customers from the exploit CVE-2022-42475 and the C&amp;C channel respectively.<br />
</p>
<p>FortiOS.SSL-VPN.Heap.Buffer.Overflow</p>
<p>Bakso.Linux.Backdoor</p>


</div>

    
</div>
</div>
<div class="b16-blog-tags aem-GridColumn aem-GridColumn--default--12">



  <div class="b16-blog-tags__container text-container" style="display:none">
    <span class="b16-blog-tags__headline">Tags:</span>
    <p class="b16-blog-tags__tag-links">
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=psirt">PSIRT</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=fortios">fortios</a>, 
    
      <a href="https://www.fortinet.com/blog/tags-search.html?tag=ssl-vpn">ssl vpn</a>
    </p>
  </div>

</div>
<section class="b12-related aem-GridColumn aem-GridColumn--default--12">




<div class="b12-related__container text-container">
    

    
    
    <h3>Related Posts</h3>
    <div class="b12-related__posts">
        
        <a href="/blog/psirt-blogs/update-regarding-cve-2018-13379" class="b12-related__post b12-related__post-0">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/psirt-blog/GettyImages-1175026820.jpg.thumb.319.319.png);">
                <img class="ratio" alt="Update Regarding CVE-2018-13379 " aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    PSIRT Blogs
                </p>
                <h5 class="b12-related__title">Update Regarding CVE-2018-13379 </h5>
            </div>
        </a>
    
    
        
        <a href="/blog/psirt-blogs/atp-29-targets-ssl-vpn-flaws" class="b12-related__post b12-related__post-1">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/blog-image-july/image.png.thumb.319.319.png);">
                <img class="ratio" alt="APT 29 Targeting SSL VPN Flaws" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    PSIRT Blogs
                </p>
                <h5 class="b12-related__title">APT 29 Targeting SSL VPN Flaws</h5>
            </div>
        </a>
    
    
        
        <a href="/blog/psirt-blogs/fortios-ssl-vulnerability" class="b12-related__post b12-related__post-2">
            <div class="b12-related__image" style="background-image:url(/content/dam/fortinet-blog/article-images/fortios-ssl/fortios-ssl.png.thumb.319.319.png);">
                <img class="ratio" alt="FortiOS and SSL Vulnerabilities" aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAQAAAAe/WZNAAAADklEQVR42mNkgAJGDAYAAFEABCaLYqoAAAAASUVORK5CYII="/>
            </div>

            <div class="b12-related__text">
                <p class="b12-related__category">
                    PSIRT Blogs
                </p>
                <h5 class="b12-related__title">FortiOS and SSL Vulnerabilities</h5>
            </div>
        </a>
    
    </div>
</div>


</section>
<div class="b13-comment-section aem-GridColumn aem-GridColumn--default--12">


<div class="b13-comment-section__container text-container">


  
  
 </div>
</div>
<div class="b6-footer aem-GridColumn aem-GridColumn--default--12">


  

  <div class="b6-footer__container text-container">
    <div class="b6-footer__footer-info">
      <div class="b6-footer__logo">
        <a href="https://www.fortinet.com" target="_blank">
          <img src="/content/dam/fortinet-blog/fortinet-logo-white.svg" alt="Fortinet"/>
        </a>
      </div>
      <div class="b6-footer__social-footer">
        <ul>
          
            <li class="social-icon linkedin">
              <a href="https://www.linkedin.com/company/fortinet" target="_blank">
                
    <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.934 15.835H12.55v-5.712c0-.897-1.008-1.64-1.905-1.64s-1.48.743-1.48 1.64v5.712H5.78V5.68h3.385v1.693c.558-.905 1.996-1.49 2.96-1.49 2.116 0 3.81 1.727 3.81 3.817v6.135zm-11.846 0H.703V5.68h3.385v10.155zM2.395.605c.935 0 1.693.757 1.693 1.69 0 .936-.758 1.694-1.693 1.694S.703 3.23.703 2.29C.703 1.36 1.46.6 2.395.6z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon twitter">
              <a href="https://www.x.com/Fortinet" target="_blank">
                
    <svg width="1200" height="1227" viewBox="0 0 1200 1227" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z" fill="white"/>
    </svg>

              </a>
            </li>
          
            <li class="social-icon youtube">
              <a href="https://www.youtube.com/channel/UCJHo4AuVomwMRzgkA5DQEOA?sub_confirmation=1" target="_blank">
                
    <svg viewBox="0 0 18 14" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.472 11.027V3.412L12.55 7.22l-5.08 3.806zM15.934.787C15.426.62 12.294.45 9.164.45c-3.13 0-6.26.16-6.77.322-1.32.44-1.69 3.4-1.69 6.447 0 3.03.37 6 1.69 6.43.51.17 3.64.33 6.77.33 3.13 0 6.262-.16 6.77-.33 1.32-.43 1.692-3.4 1.692-6.44 0-3.047-.372-6-1.692-6.43z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon instagram">
              <a href="https://www.instagram.com/fortinet/" target="_blank">
                
    <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
        <path class="st0" d="M16,3.7c4,0,4.5,0,6.1,0.1c1.5,0.1,2.3,0.3,2.8,0.5c0.7,0.3,1.2,0.6,1.7,1.1c0.5,0.5,0.8,1,1.1,1.7
          c0.2,0.5,0.4,1.3,0.5,2.8c0.1,1.6,0.1,2.1,0.1,6.1s0,4.5-0.1,6.1c-0.1,1.5-0.3,2.3-0.5,2.8c-0.3,0.7-0.6,1.2-1.1,1.7
          c-0.5,0.5-1,0.8-1.7,1.1c-0.5,0.2-1.3,0.4-2.8,0.5c-1.6,0.1-2.1,0.1-6.1,0.1s-4.5,0-6.1-0.1c-1.5-0.1-2.3-0.3-2.8-0.5
          c-0.7-0.3-1.2-0.6-1.7-1.1c-0.5-0.5-0.8-1-1.1-1.7c-0.2-0.5-0.4-1.3-0.5-2.8C3.7,20.5,3.7,20,3.7,16s0-4.5,0.1-6.1
          c0.1-1.5,0.3-2.3,0.5-2.8C4.6,6.5,4.9,6,5.4,5.4c0.5-0.5,1-0.8,1.7-1.1c0.5-0.2,1.3-0.4,2.8-0.5C11.5,3.7,12,3.7,16,3.7 M16,1
          c-4.1,0-4.6,0-6.2,0.1C8.2,1.2,7.1,1.4,6.2,1.8c-1,0.4-1.8,0.9-2.7,1.7C2.7,4.4,2.2,5.2,1.8,6.2c-0.4,1-0.6,2-0.7,3.6
          C1,11.4,1,11.9,1,16c0,4.1,0,4.6,0.1,6.2c0.1,1.6,0.3,2.7,0.7,3.6c0.4,1,0.9,1.8,1.7,2.7c0.8,0.8,1.7,1.3,2.7,1.7
          c1,0.4,2,0.6,3.6,0.7C11.4,31,11.9,31,16,31s4.6,0,6.2-0.1c1.6-0.1,2.7-0.3,3.6-0.7c1-0.4,1.8-0.9,2.7-1.7c0.8-0.8,1.3-1.7,1.7-2.7
          c0.4-1,0.6-2,0.7-3.6C31,20.6,31,20.1,31,16s0-4.6-0.1-6.2c-0.1-1.6-0.3-2.7-0.7-3.6c-0.4-1-0.9-1.8-1.7-2.7
          c-0.8-0.8-1.7-1.3-2.7-1.7c-1-0.4-2-0.6-3.6-0.7C20.6,1,20.1,1,16,1L16,1z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <path class="st0" d="M16,8.3c-4.3,0-7.7,3.4-7.7,7.7s3.4,7.7,7.7,7.7s7.7-3.4,7.7-7.7S20.3,8.3,16,8.3z M16,21c-2.8,0-5-2.2-5-5
          s2.2-5,5-5s5,2.2,5,5S18.8,21,16,21z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
        <circle class="st0" cx="24" cy="8" r="1.8" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></circle>
    </svg>

              </a>
            </li>
          
            <li class="social-icon facebook">
              <a href="https://www.facebook.com/fortinet" target="_blank">
                
    <svg viewBox="0 0 9 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M8.934.758v3.385H7.24c-.583 0-.845.685-.845 1.27v2.114h2.54v3.385h-2.54v6.77H3.01v-6.77H.472V7.527H3.01V4.143c0-1.87 1.516-3.385 3.385-3.385h2.54z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
            <li class="social-icon rss">
              <a href="https://www.fortinet.com/rss-feeds.html" target="_blank">
                
    <svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.072 17.68c-1.27 0-2.37-1.1-2.37-2.368 0-1.27 1.1-2.37 2.37-2.37s2.37 1.1 2.37 2.37-1.016 2.37-2.37 2.37zM.702.76v2.538c7.955 0 14.386 6.43 14.386 14.385h2.538C17.626 8.336 10.05.76.703.76zm0 5.162V8.46c5.078 0 9.224 4.146 9.224 9.223h2.54c0-6.514-5.248-11.76-11.763-11.76z" fill-opacity=".8" fill="#fff" fill-rule="evenodd"></path>
    </svg>

              </a>
            </li>
          
        </ul>
      </div>
    </div>
    <div class="b6-footer__footer-links">
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">News &amp; Articles</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/press-releases.html" target="_self">News Releases</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/newsroom/news.html" target="_blank">News Articles</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Security Research</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html" target="_self">Threat Research</a>
              </li>
            
              <li>
                <a href="https://fortiguard.com/" target="_self">FortiGuard Labs</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/fortiguard/threat-intelligence/threat-map.html" target="_self">Threat Map</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/solutions/ransomware.html" target="_self">Ransomware Prevention</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Connect With Us</h4>
          <ul>
            
              <li>
                <a href="https://community.fortinet.com/" target="_blank">Fortinet Community</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/partners/partner-program/become-a-fortinet-partner" target="_blank">Partner Portal</a>
              </li>
            
              <li>
                <a href="https://investor.fortinet.com/" target="_blank">Investor Relations</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/product-certifications" target="_blank">Product Certifications</a>
              </li>
            
          </ul>
        </div>
      
        <div class="b6-footer__footer-links-column">
          <h4 class="b6-footer__header">Company</h4>
          <ul>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/about-us" target="_blank">About Us</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/executive-management" target="_self">Exec Mgmt</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/careers" target="_self">Careers</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/nse-training" target="_self">Training</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/events" target="_self">Events</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/industry-awards" target="_self">Industry Awards</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/corporate/about-us/corporate-social-responsibility" target="_self">Social Responsibility</a>
              </li>
            
              <li>
                <a href="/resources/cyberglossary" target="_self">CyberGlossary</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/sitemap" target="_self">Sitemap</a>
              </li>
            
              <li>
                <a href="https://www.fortinet.com/blog/blog-sitemap" target="_self">Blog Sitemap</a>
              </li>
            
          </ul>
        </div>
      
      <div class="b6-footer__contact-info">
        <h4 class="b6-footer__header">Contact Us</h4>
        <ul>
          <li>(866) 868-3678</li>
        </ul>
      </div>
    </div>
    <div class="b6-footer__copyright">
      <div class="b6-footer__copyright-info">
        <p class="b6-footer__copyright-text">Copyright © 2024 Fortinet, Inc. All Rights Reserved</p>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/legal.html" target="_blank">Terms of Services</a>
        
          <a class="b6-footer__copyright-link" href="https://www.fortinet.com/corporate/about-us/privacy.html" target="_blank">Privacy Policy</a>
        
        <span class="ot-ftnt-cookie-settings"> | <a href="#" onclick="Optanon.ToggleInfoDisplay()">Cookie Settings</a></span>
      </div>
    </div>
  </div>

<!-- Launch COnfiguration -->


<!-- END Launch COnfiguration --></div>

    
</div>
</div>


    
    
    
    
    
<script src="/etc.clientlibs/fortinet-blog/clientlibs/clientlib-base.min.ba4f082a77dabb2c6baf715d9eb61c22.js"></script>





    


    

    <!-- BE IXF: The following <div> block needs to be placed in the location where the link block will be displayed
    BE IXF: For your website, the location is above/below ...-->
    <div class="be-ix-link-block">
        <!--
   be_sdkms_pub:bec-built-in; bec-built-in_1.0.0; bodystr;
   be_sdkms_date_modified:pn_tstr:Wed Oct 23 18:42:42 UTC 2024; pn_epoch:1729708962115;
   be_sdkms_timer: 1;
-->

        
    </div>
    <!-- BE IXF: Footer End -->
    </body>
    </html>
