<!doctype html><html lang="en"><head><title data-rh="true">Pointer: Hunting Cobalt Strike globally | by Pavel Shabarkin and Michael Koczwara | Medium | Towards AWS</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2021-11-21T07:58:19.185Z"/><meta data-rh="true" name="title" content="Pointer: Hunting Cobalt Strike globally | by Pavel Shabarkin and Michael Koczwara | Medium | Towards AWS"/><meta data-rh="true" property="og:title" content="Pointer: Hunting Cobalt Strike globally"/><meta data-rh="true" property="al:android:url" content="medium://p/a334ac50619a"/><meta data-rh="true" property="al:ios:url" content="medium://p/a334ac50619a"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Cobalt Strike is a commercial, full-featured, remote access tool that bills itself as “adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of…"/><meta data-rh="true" property="og:description" content="Introduction"/><meta data-rh="true" property="og:url" content="https://towardsaws.com/pointer-hunting-cobalt-strike-globally-a334ac50619a"/><meta data-rh="true" property="al:web:url" content="https://towardsaws.com/pointer-hunting-cobalt-strike-globally-a334ac50619a"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*l9j-JLGriA0FMQjju7BByg.png"/><meta data-rh="true" property="article:author" content="https://shabarkin.medium.com"/><meta data-rh="true" name="author" content="Pavel Shabarkin"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Pointer: Hunting Cobalt Strike globally"/><meta data-rh="true" name="twitter:site" content="@TowardsAws"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/a334ac50619a"/><meta data-rh="true" property="twitter:description" content="Introduction"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*l9j-JLGriA0FMQjju7BByg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="14 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/resize:fill:256:256/1*jFctRm8LcWg99f9htwwAsg.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://shabarkin.medium.com"/><link data-rh="true" rel="canonical" href="https://towardsaws.com/pointer-hunting-cobalt-strike-globally-a334ac50619a"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/a334ac50619a"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*l9j-JLGriA0FMQjju7BByg.png"],"url":"https:\u002F\u002Ftowardsaws.com\u002Fpointer-hunting-cobalt-strike-globally-a334ac50619a","dateCreated":"2021-09-16T15:37:22.137Z","datePublished":"2021-09-16T15:37:22.137Z","dateModified":"2022-01-05T11:08:00.700Z","headline":"Pointer: Hunting Cobalt Strike globally | by Pavel Shabarkin and Michael Koczwara | Medium | Towards AWS","name":"Pointer: Hunting Cobalt Strike globally | by Pavel Shabarkin and Michael Koczwara | Medium | Towards AWS","description":"Cobalt Strike is a commercial, full-featured, remote access tool that bills itself as “adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of…","identifier":"a334ac50619a","author":{"@type":"Person","name":"Pavel Shabarkin","url":"https:\u002F\u002Fshabarkin.medium.com"},"creator":["Pavel Shabarkin"],"publisher":{"@type":"Organization","name":"Towards AWS","url":"towardsaws.com","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsaws.com\u002Fpointer-hunting-cobalt-strike-globally-a334ac50619a"}</script><style type="text/css" data-fela-rehydration="595" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="595" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{gap:16px}.ag{color:inherit}.ah{fill:inherit}.ai{font-size:inherit}.aj{border:inherit}.ak{font-family:inherit}.al{letter-spacing:inherit}.am{font-weight:inherit}.an{padding:0}.ao{margin:0}.ap{cursor:pointer}.aq:disabled{cursor:not-allowed}.ar:disabled{color:#6B6B6B}.as:disabled{fill:#6B6B6B}.av{width:auto}.aw path{fill:#242424}.ax{height:25px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{width:0}.cc{border-right:none}.cd{transition:width 300ms}.ce{flex:0 0 auto}.cf{padding:24px 0}.cg{flex-direction:column}.ch{gap:8px}.ci{transform:translateX(-240px)}.cj{transition:transform 300ms}.ck{position:fixed}.cl{text-align:left}.cm{color:#6B6B6B}.cn{padding:8px 24px}.cq{margin-left:16px}.cr{overflow:hidden}.cs{max-height:20px}.ct{text-overflow:ellipsis}.cu{display:-webkit-box}.cv{-webkit-line-clamp:1}.cw{-webkit-box-orient:vertical}.cx{word-break:break-all}.cz{border-bottom:1px solid #E5E5E5}.da{margin:8px 24px}.db{width:24px}.dc{width:calc(100% - 240px)}.dd{flex:1 1 auto}.de{justify-content:center}.dk{max-width:680px}.dl{min-width:0}.dm{animation:k1 1.2s ease-in-out infinite}.dn{height:100vh}.do{margin-bottom:16px}.dp{margin-top:48px}.dq{align-items:flex-start}.dr{justify-content:space-between}.ds{margin-bottom:24px}.dy{width:80%}.dz{background-color:#F2F2F2}.ef{height:44px}.eg{width:44px}.eh{margin:auto 0}.ei{margin-bottom:4px}.ej{height:16px}.ek{width:120px}.el{width:80px}.es{margin-bottom:8px}.et{width:96%}.eu{width:98%}.ev{width:81%}.ew{margin-left:8px}.ex{font-size:13px}.ey{height:100%}.fq{color:#FFFFFF}.fr{fill:#FFFFFF}.fs{background:rgba(105, 135, 184, 1)}.ft{border-color:rgba(105, 135, 184, 1)}.fx:disabled{cursor:inherit !important}.fy:disabled{opacity:0.3}.fz:disabled:hover{background:rgba(105, 135, 184, 1)}.ga:disabled:hover{border-color:rgba(105, 135, 184, 1)}.gb{border-radius:99em}.gc{border-width:1px}.gd{border-style:solid}.ge{box-sizing:border-box}.gf{text-decoration:none}.gg{text-align:center}.gj{margin-right:32px}.gk{position:relative}.gl{fill:#6B6B6B}.gn{background:transparent}.go svg{margin-left:4px}.gp svg{fill:#6B6B6B}.gr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.gs{position:absolute}.gu{max-width:100%}.gv{white-space:nowrap}.gw{border-bottom:1px solid #F2F2F2}.gx{height:3px}.gy{background-color:rgba(105, 135, 184, 1)}.gz{max-width:1192px}.hf{font-weight:500}.ht{margin-left:56px}.hu{gap:32px}.hv{margin:0 8px}.hw{display:inline}.hx{font-size:16px}.hy{line-height:24px}.hz{text-decoration:underline}.ia{pointer-events:none}.ib{will-change:opacity, transform}.ie{opacity:0}.if{transform:translateY(89px)}.ig{width:148px}.ih{border-radius:2px}.ii{height:38px}.ij{width:38px}.il{margin-top:16px}.im{word-break:break-word}.is{margin:0 24px}.iw{background:rgba(255, 255, 255, 1)}.ix{border:1px solid #F2F2F2}.iy{box-shadow:0 1px 4px #F2F2F2}.iz{max-height:100vh}.ja{overflow-y:auto}.jb{left:0}.jc{top:calc(100vh + 100px)}.jd{bottom:calc(100vh + 100px)}.je{width:10px}.jf{word-wrap:break-word}.jg:after{display:block}.jh:after{content:""}.ji:after{clear:both}.jj{line-height:1.23}.jk{letter-spacing:0}.jl{font-style:normal}.jm{font-weight:700}.kr{align-items:baseline}.ks{width:48px}.kt{height:48px}.ku{border:2px solid rgba(255, 255, 255, 1)}.kv{z-index:0}.kw{box-shadow:none}.kx{border:1px solid rgba(0, 0, 0, 0.05)}.ky{margin-left:-12px}.kz{width:28px}.la{height:28px}.lb{z-index:1}.lc{margin-bottom:2px}.ld{flex-wrap:nowrap}.lh{flex-wrap:wrap}.li{white-space:pre-wrap}.lj{margin-right:4px}.lk{padding-left:8px}.ll{padding-right:8px}.mm> *{flex-shrink:0}.mn{overflow-x:scroll}.mo::-webkit-scrollbar{display:none}.mp{scrollbar-width:none}.mq{-ms-overflow-style:none}.mr{width:74px}.ms{flex-direction:row}.mt{z-index:2}.mw{-webkit-user-select:none}.mx{border:0}.my{fill:rgba(117, 117, 117, 1)}.nb{outline:0}.nc{user-select:none}.nd> svg{pointer-events:none}.nm{cursor:progress}.nn{opacity:1}.no{padding:4px 0}.nr{margin-top:0px}.ns{width:16px}.nu{display:inline-flex}.oa{padding:8px 2px}.ob svg{color:#6B6B6B}.os{line-height:1.12}.ot{letter-spacing:-0.022em}.ou{font-weight:600}.pn{margin-bottom:-0.28em}.po{line-height:1.58}.pp{letter-spacing:-0.004em}.pq{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.qi{margin-bottom:-0.46em}.qo{clear:both}.qu{margin-left:auto}.qv{margin-right:auto}.qw{max-width:5504px}.rc{padding-top:5px}.rd{padding-bottom:5px}.rf{cursor:zoom-in}.rg{z-index:auto}.ri{height:auto}.rj{margin-top:10px}.rk{max-width:728px}.rn{line-height:1.18}.rt{margin-bottom:-0.31em}.ru{max-width:3018px}.rv{list-style-type:decimal}.rw{margin-left:30px}.rx{padding-left:0px}.sd{list-style-type:disc}.se{padding:2px 4px}.sf{font-size:75%}.sg> strong{font-family:inherit}.sh{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.si{max-width:3494px}.sj{max-width:2212px}.sk{font-style:italic}.sl{max-width:334px}.sm{max-width:2202px}.sn{overflow-x:auto}.so{padding:20px}.sp{border-radius:0}.sq{background:#F2F2F2}.sr{margin-top:-0.09em}.ss{margin-bottom:-0.09em}.st{min-width:fit-content}.su{max-width:3950px}.sv{max-width:5046px}.sw{max-width:2264px}.sx{max-width:1768px}.sy{margin-bottom:26px}.sz{margin-top:6px}.ta{margin-top:8px}.tb{margin-right:8px}.tc{padding:8px 16px}.td{border-radius:100px}.te{transition:background 300ms ease}.tg{border-top:none}.th{margin-bottom:50px}.ti{height:52px}.tj{max-height:52px}.tk{box-sizing:content-box}.tl{position:static}.tn{max-width:155px}.tt{margin-right:20px}.tu{margin-bottom:64px}.tv{margin-bottom:48px}.uj{height:64px}.uk{width:64px}.ul{align-self:flex-end}.um{color:rgba(255, 255, 255, 1)}.un{fill:rgba(255, 255, 255, 1)}.uo{background:rgba(25, 25, 25, 1)}.up{border-color:rgba(25, 25, 25, 1)}.us:disabled{opacity:0.1}.ut:disabled:hover{background:rgba(25, 25, 25, 1)}.uu:disabled:hover{border-color:rgba(25, 25, 25, 1)}.uy{padding-right:4px}.vf{margin-bottom:54px}.vg{height:0px}.vh{gap:18px}.vi{fill:rgba(61, 61, 61, 1)}.vu{border-bottom:solid 1px #E5E5E5}.vv{margin-top:72px}.vw{margin-bottom:0px}.vx{margin-right:16px}.at:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.au:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.co:hover{color:#242424}.cp:hover p{color:#242424}.fu:hover{background:rgba(93, 116, 155, 1)}.fv:hover{border-color:rgba(93, 116, 155, 1)}.fw:hover{cursor:pointer}.gm:hover{fill:#242424}.gq:hover svg{fill:#242424}.gt:hover{background-color:rgba(0, 0, 0, 0.1)}.ik:hover{background-color:none}.le:hover{text-decoration:underline}.na:hover{fill:rgba(8, 8, 8, 1)}.np:hover{fill:#000000}.nq:hover p{color:#000000}.nt:hover{color:#000000}.oc:hover svg{color:#000000}.tf:hover{background-color:#F2F2F2}.uq:hover{background:#000000}.ur:hover{border-color:#242424}.vj:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.mz:focus{fill:rgba(8, 8, 8, 1)}.od:focus svg{color:#000000}.rh:focus{transform:scale(1.01)}.ne:active{border-style:none}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.dj{margin:0 64px}.dx{height:48px}.ee{margin-bottom:52px}.er{margin-bottom:48px}.fh{font-size:14px}.fi{line-height:20px}.fo{font-size:13px}.fp{padding:5px 12px}.gi{display:flex}.he{max-width:250px}.hq{font-size:20px}.hr{line-height:24px}.hs{letter-spacing:0}.ir{margin-bottom:50px}.iv{max-width:680px}.kh{font-size:42px}.ki{margin-top:1.19em}.kj{margin-bottom:32px}.kk{line-height:52px}.kl{letter-spacing:-0.011em}.kq{align-items:center}.ly{border-top:solid 1px #F2F2F2}.lz{border-bottom:solid 1px #F2F2F2}.ma{margin:32px 0 0}.mb{padding:3px 8px}.mk> *{margin-right:24px}.ml> :last-child{margin-right:0}.nl{margin-top:0px}.nz{margin:0}.pj{font-size:24px}.pk{margin-top:1.95em}.pl{line-height:30px}.pm{letter-spacing:-0.016em}.qf{margin-top:0.94em}.qg{line-height:32px}.qh{letter-spacing:-0.003em}.qn{margin-top:2.14em}.qt{max-width:1192px}.rb{margin-top:56px}.rs{margin-top:1.72em}.sc{margin-top:1.14em}.ts{display:inline-block}.tw{flex-direction:row}.tz{margin-bottom:0}.ua{margin-right:20px}.uv{max-width:500px}.vo{margin:40px 0 0}.vt{padding-top:72px}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.nk{margin-top:0px}.rl{margin-left:auto}.rm{text-align:center}.tr{display:inline-block}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.nj{margin-top:0px}.tq{display:inline-block}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.nh{margin-top:0px}.ni{margin-right:0px}.tp{display:inline-block}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.df{margin:0 24px}.dt{height:40px}.ea{margin-bottom:44px}.em{margin-bottom:32px}.ez{font-size:13px}.fa{line-height:20px}.fj{padding:0px 8px 1px}.ha{max-width:150px}.hg{font-size:16px}.hh{letter-spacing:0}.in{margin-bottom:2px}.jn{font-size:32px}.jo{margin-top:1.01em}.jp{margin-bottom:24px}.jq{line-height:38px}.jr{letter-spacing:-0.014em}.km{align-items:flex-start}.lf{flex-direction:column}.lm{margin:24px -24px 0}.ln{padding:0}.mc> *{margin-right:8px}.md> :last-child{margin-right:24px}.mu{margin-left:0px}.nf{margin-top:0px}.ng{margin-right:0px}.nv{margin:0}.oe{border:1px solid #F2F2F2}.of{border-radius:99em}.og{padding:0px 16px 0px 12px}.oh{height:38px}.oi{align-items:center}.ok svg{margin-right:8px}.ov{font-size:20px}.ow{margin-top:1.2em}.ox{line-height:24px}.pr{font-size:18px}.ps{margin-top:0.67em}.pt{line-height:28px}.pu{letter-spacing:-0.003em}.qj{margin-top:1.56em}.qp{max-width:100%}.qx{margin-top:40px}.ro{margin-top:1.23em}.ry{margin-top:1.34em}.to{display:inline-block}.uh{margin-bottom:20px}.ui{margin-right:0}.uz{font-size:24px}.va{line-height:30px}.vb{letter-spacing:-0.016em}.vk{margin:32px 0 0}.vp{padding-top:48px}.oj:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.di{margin:0 64px}.dw{height:48px}.ed{margin-bottom:52px}.eq{margin-bottom:48px}.ff{font-size:14px}.fg{line-height:20px}.fm{font-size:13px}.fn{padding:5px 12px}.gh{display:flex}.hd{max-width:250px}.hn{font-size:20px}.ho{line-height:24px}.hp{letter-spacing:0}.iq{margin-bottom:50px}.iu{max-width:680px}.kc{font-size:42px}.kd{margin-top:1.19em}.ke{margin-bottom:32px}.kf{line-height:52px}.kg{letter-spacing:-0.011em}.kp{align-items:center}.lu{border-top:solid 1px #F2F2F2}.lv{border-bottom:solid 1px #F2F2F2}.lw{margin:32px 0 0}.lx{padding:3px 8px}.mi> *{margin-right:24px}.mj> :last-child{margin-right:0}.ny{margin:0}.pf{font-size:24px}.pg{margin-top:1.95em}.ph{line-height:30px}.pi{letter-spacing:-0.016em}.qc{margin-top:0.94em}.qd{line-height:32px}.qe{letter-spacing:-0.003em}.qm{margin-top:2.14em}.qs{max-width:1192px}.ra{margin-top:56px}.rr{margin-top:1.72em}.sb{margin-top:1.14em}.tx{flex-direction:row}.ub{margin-bottom:0}.uc{margin-right:20px}.uw{max-width:500px}.vn{margin:40px 0 0}.vs{padding-top:72px}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.dh{margin:0 48px}.dv{height:48px}.ec{margin-bottom:52px}.ep{margin-bottom:48px}.fd{font-size:13px}.fe{line-height:20px}.fl{padding:0px 8px 1px}.hc{max-width:250px}.hk{font-size:20px}.hl{line-height:24px}.hm{letter-spacing:0}.ip{margin-bottom:50px}.it{max-width:680px}.jx{font-size:42px}.jy{margin-top:1.19em}.jz{margin-bottom:32px}.ka{line-height:52px}.kb{letter-spacing:-0.011em}.ko{align-items:center}.lq{border-top:solid 1px #F2F2F2}.lr{border-bottom:solid 1px #F2F2F2}.ls{margin:32px 0 0}.lt{padding:3px 8px}.mg> *{margin-right:24px}.mh> :last-child{margin-right:0}.nx{margin:0}.pb{font-size:24px}.pc{margin-top:1.95em}.pd{line-height:30px}.pe{letter-spacing:-0.016em}.pz{margin-top:0.94em}.qa{line-height:32px}.qb{letter-spacing:-0.003em}.ql{margin-top:2.14em}.qr{max-width:100%}.qz{margin-top:56px}.rq{margin-top:1.72em}.sa{margin-top:1.14em}.ty{flex-direction:row}.ud{margin-bottom:0}.ue{margin-right:20px}.ux{max-width:500px}.vm{margin:40px 0 0}.vr{padding-top:72px}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.dg{margin:0 24px}.du{height:40px}.eb{margin-bottom:44px}.eo{margin-bottom:32px}.fb{font-size:13px}.fc{line-height:20px}.fk{padding:0px 8px 1px}.hb{max-width:150px}.hi{font-size:16px}.hj{letter-spacing:0}.io{margin-bottom:2px}.js{font-size:32px}.jt{margin-top:1.01em}.ju{margin-bottom:24px}.jv{line-height:38px}.jw{letter-spacing:-0.014em}.kn{align-items:flex-start}.lg{flex-direction:column}.lo{margin:24px 0 0}.lp{padding:0}.me> *{margin-right:8px}.mf> :last-child{margin-right:8px}.mv{margin-left:0px}.nw{margin:0}.ol{border:1px solid #F2F2F2}.om{border-radius:99em}.on{padding:0px 16px 0px 12px}.oo{height:38px}.op{align-items:center}.or svg{margin-right:8px}.oy{font-size:20px}.oz{margin-top:1.2em}.pa{line-height:24px}.pv{font-size:18px}.pw{margin-top:0.67em}.px{line-height:28px}.py{letter-spacing:-0.003em}.qk{margin-top:1.56em}.qq{max-width:100%}.qy{margin-top:40px}.rp{margin-top:1.23em}.rz{margin-top:1.34em}.uf{margin-bottom:20px}.ug{margin-right:0}.vc{font-size:24px}.vd{line-height:30px}.ve{letter-spacing:-0.016em}.vl{margin:32px 0 0}.vq{padding-top:48px}.oq:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="print">.tm{display:none}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.cy{max-height:none}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ic{transition:opacity 200ms}.re{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style><style type="text/css" data-fela-rehydration="595" data-fela-type="RULE" media="all and (max-width: 1232px)">.id{display:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="cm ah ex bf al b an ao ap aq ar as at au s u w i d q ey z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fa334ac50619a&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderCollection&amp;source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="ew"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b ez fa fb fc fd fe ff fg fh fi cm"><span><a class="bf b ez fa fj fb fc fk fd fe fl fm fg fn fo fi fp fq fr fs ft fu fv fw fx fy fz ga gb gc gd ge bm gf gg" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign up</a></span></p><div class="cq l"><p class="bf b ez fa fb fc fd fe ff fg fh fi cm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae af"><a class="ag ah ai aj ak al am an ao ap aq ar as at au ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="av aw ax"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w gh gi"><div class="gj ab"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav------------------" rel="noopener follow"><div class="bf b bg z cm gk gl ab q co gm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="ew l">Write</div></div></a></span></div></div><div class="k j i d"><div class="gj ab"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSearchButton" href="https://medium.com/search?source=post_page---top_nav_layout_nav-----------------------------------------" rel="noopener follow"><div class="bf b bg z cm gk gl ab q co gm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="gj h k j"><div class="ab q"><p class="bf b ez fa fb fc fd fe ff fg fh fi cm"><span><a class="bf b ez fa fj fb fc fk fd fe fl fm fg fn fo fi fp fq fr fs ft fu fv fw fx fy fz ga gb gc gd ge bm gf gg" data-testid="headerSignUpButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign up</a></span></p><div class="cq l"><p class="bf b ez fa fb fc fd fe ff fg fh fi cm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;source=post_page---top_nav_layout_nav-----------------------global_nav------------------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay gn an ab q ap go gp gq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l gk"><img alt="" class="l ge by bz ca dz" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="gr by l bz ca gs n ay gt"></div></div></button></div></div></div><div class="ab"><div class="cb cc cd ce"><div class="ba cf ab cg ch ci cj ck"><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Home"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.75v10.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-5.5a.25.25 0 0 1 .25-.25h3.5a.25.25 0 0 1 .25.25v5.5c0 .138.112.25.25.25h5a.25.25 0 0 0 .25-.25v-10.5M22 9l-9.1-6.825a1.5 1.5 0 0 0-1.8 0L2 9"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Home</p></div></div></div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/lists?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Lists"><path stroke="currentColor" d="M6.44 6.69a1.5 1.5 0 0 1 1.06-.44h9a1.5 1.5 0 0 1 1.06.44l.354-.354-.353.353A1.5 1.5 0 0 1 18 7.75v14l-5.694-4.396-.306-.236-.306.236L6 21.75v-14c0-.398.158-.78.44-1.06Z"></path><path stroke="currentColor" stroke-linecap="round" d="M12.5 2.75h-8a2 2 0 0 0-2 2v11.5"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Library</p></div></div></div></a><div class="cz da db l"></div><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/stories/drafts?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stories"><path stroke="currentColor" d="M4.75 21.5h14.5a.25.25 0 0 0 .25-.25V2.75a.25.25 0 0 0-.25-.25H4.75a.25.25 0 0 0-.25.25v18.5c0 .138.112.25.25.25Z"></path><path stroke="currentColor" stroke-linecap="round" d="M8 8.5h8M8 15.5h5M8 12h8"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Stories</p></div></div></div></a><a class="ag ah ai ay ak al am an ao ap aq ar as at au bh cl" href="https://medium.com/me/stats?source=post_page--------------------------------------------" rel="noopener follow"><div class="bf b bg z cm cn co cp"><div class="ab q"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Stats"><path stroke="currentColor" d="M2.75 19h4.5a.25.25 0 0 0 .25-.25v-6.5a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v6.5c0 .138.112.25.25.25ZM9.75 19h4.5a.25.25 0 0 0 .25-.25V8.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v10.5c0 .138.112.25.25.25ZM16.75 19h4.5a.25.25 0 0 0 .25-.25V4.25a.25.25 0 0 0-.25-.25h-4.5a.25.25 0 0 0-.25.25v14.5c0 .138.112.25.25.25Z"></path></svg><div class="cq l"><p class="bf b bg z cr cs ct cu cv cw cx cy cm">Stats</p></div></div></div></a></div></div><div class="dc l dd"><div class="l"><div><div class="gw bh l"><div class="gx bh gy"></div><div class="ab de"><div class="df dg dh di dj gz dl bh"><div class="ac ab q"><div class="ha hb hc hd he l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://towardsaws.com/?source=post_page---publication_nav-5da0267791b1-a334ac50619a---------------------------------------" rel="noopener follow"><h2 class="bf hf hg fa hh hi fc hj hk hl hm hn ho hp hq hr hs bk"><div class="gu cr ct gv">Towards AWS</div></h2></a></div><div class="ht h k w gh gi dr hu"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://towardsaws.com/?source=post_page---publication_nav-5da0267791b1-a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b bg z cm">Home</p></a><a class="ag ah ai aj ak al am an ao ap aq ar as at au" rel="noopener follow" href="/newsletter?source=post_page---publication_nav-5da0267791b1-a334ac50619a---------------------------------------"><p class="bf b bg z cm">Newsletter</p></a><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://towardsaws.com/about?source=post_page---publication_nav-5da0267791b1-a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b bg z cm">About</p></a></div><div class="s u j i d"><span class="hv hw" aria-hidden="true"><span class="bf b hx hy bk">·</span></span><p class="bf b hx hy bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as hz" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-aws&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;collection=Towards+AWS&amp;collectionId=5da0267791b1&amp;source=post_page---publication_nav-5da0267791b1-a334ac50619a---------------------publication_nav------------------" rel="noopener follow">Follow publication</a></span></p></div></div></div></div></div></div><div class="ia gs ib bh n ic id ie if"><div class="ab de"><div class="df dg dh di dj gz dl bh"><div class="ig l"><div class="ia"><div class="ab dq cg"><a href="https://towardsaws.com/?source=post_page---post_publication_sidebar-5da0267791b1-a334ac50619a---------------------------------------" rel="noopener follow"><div class="gk"><img alt="Towards AWS" class="dz ih l ij ii" src="https://miro.medium.com/v2/resize:fill:76:76/1*H7nXs2clXxnWZeKjcW17Tg.png" width="38" height="38" loading="lazy"/><div class="ih l ii ij gs n gr ik"></div></div></a><div class="il l"></div><p class="bf b bg z cm"><span class="im">Where Cloud Experts, Heroes, Builders, and Developers share their stories, experiences, and solutions.</span></p><div class="il l"></div><p class="bf b bg z bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as hz" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-aws&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;collection=Towards+AWS&amp;collectionId=5da0267791b1&amp;source=post_page---post_publication_sidebar-5da0267791b1-a334ac50619a---------------------post_publication_sidebar------------------" rel="noopener follow">Follow publication</a></span></p></div></div></div></div></div></div><div class="in io ip iq ir l"><div class="ab de"><div class="dl bh is it iu iv"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="gs jb jc jd je ia"></div><div class="im jf jg jh ji"><div class="ab de"><div class="dl bh is it iu iv"><div><h1 id="9a73" class="pw-post-title jj jk jl bf jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bk" data-testid="storyTitle">Pointer: Hunting Cobalt Strike globally</h1><div><div class="speechify-ignore ab dr"><div class="speechify-ignore bh l"><div class="km kn ko kp kq ab"><div><div class="ab kr"><div><div class="bm" aria-hidden="false"><a href="https://shabarkin.medium.com/?source=post_page---byline--a334ac50619a---------------------------------------" rel="noopener follow"><div class="l ks kt by ku kv"><div class="l gk"><img alt="Pavel Shabarkin" class="l ge by ef eg dz" src="https://miro.medium.com/v2/resize:fill:88:88/1*au7aS6ukZ6IIWNBSKcCk8Q.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="kw by l ef eg gs n kx gt"></div></div></div></a></div></div><div class="ky ab gk"><div><div class="bm" aria-hidden="false"><a href="https://towardsaws.com/?source=post_page---byline--a334ac50619a---------------------------------------" rel="noopener  ugc nofollow"><div class="l kz la by ku lb"><div class="l gk"><img alt="Towards AWS" class="l ge by br db dz" src="https://miro.medium.com/v2/resize:fill:48:48/1*H7nXs2clXxnWZeKjcW17Tg.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="kw by l br db gs n kx gt"></div></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="lc ab q"><div class="ab q ld"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="ag ah ai aj ak al am an ao ap aq ar as le" data-testid="authorName" href="https://shabarkin.medium.com/?source=post_page---byline--a334ac50619a---------------------------------------" rel="noopener follow">Pavel Shabarkin</a></p></div></div></div><span class="hv hw" aria-hidden="true"><span class="bf b bg z bk">·</span></span><p class="bf b hx hy bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as hz" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9284dc7b6da6&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;user=Pavel+Shabarkin&amp;userId=9284dc7b6da6&amp;source=post_page-9284dc7b6da6--byline--a334ac50619a---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ce"><span class="bf b bg z cm"><div class="ab dq lf lg lh"><div class="in io ab"><div class="bf b bg z cm ab li"><span class="lj l ce">Published in</span><div><div class="l" aria-hidden="false"><a class="ag ah ai aj ak al am an ao ap aq ar as le ab q" data-testid="publicationName" href="https://towardsaws.com/?source=post_page---byline--a334ac50619a---------------------------------------" rel="noopener  ugc nofollow"><p class="bf b bg z cr cs ct cu cv cw cx cy bk">Towards AWS</p></a></div></div></div><div class="h k"><span class="hv hw" aria-hidden="true"><span class="bf b bg z cm">·</span></span></div></div><span class="bf b bg z cm"><div class="ab ae"><span data-testid="storyReadTime">14 min read</span><div class="lk ll l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z cm">·</span></span></div><span data-testid="storyPublishDate">Sep 16, 2021</span></div></span></div></span></div></div></div><div class="ab dr lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb"><div class="h k w gh gi q"><div class="mr l"><div class="ab q ms mt"><div class="pw-multi-vote-icon gk lj mu mv mw"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-aws%2Fa334ac50619a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;user=Pavel+Shabarkin&amp;userId=9284dc7b6da6&amp;source=---header_actions--a334ac50619a---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="mx ap my mz na nb an nc nd ne mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l nf ng nh ni nj nk nl"><p class="bf b ex z cm"><span class="nm">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ap mx nn no ab q gl np nq" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q mc md me mf mg mh mi mj mk ml mm mn mo mp mq"><div class="ns k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa334ac50619a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;source=---header_actions--a334ac50619a---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cm nt" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="ge nu dq"><div class="l ae"><div class="ab de"><div class="nv nw nx ny nz gu dl bh"><div class="ab"><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="ag gl ai aj ak al am oa ao ap aq fy ob oc nq od oe of og oh s oi oj ok ol om on oo u op oq or"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cm">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="ag gl ai aj ak al am oa ao ap aq fy ob oc nq od oe of og oh s oi oj ok ol om on oo u op oq or"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z cm">Share</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="81f7" class="os ot jl bf ou ov ow ox hh oy oz pa hj pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Introduction</h1><p id="61b2" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">Cobalt Strike is a commercial, full-featured, remote access tool that bills itself as “adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat actors”. Cobalt Strike’s interactive post-exploit capabilities cover the full range of ATT&amp;CK tactics, all executed within a single, integrated system.</p><p id="4bd9" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">In addition to its own capabilities, Cobalt Strike leverages the capabilities of other well-known tools such as Metasploit and Mimikatz.</p><p id="aa9c" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Cobalt Strike is a legitimate security tool used by penetration testers and red teamers to emulate threat actor activity in a network. However, lately, this tool has been hijacked and abused by cybercriminals.</p><p id="31e6" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Our goal was to develop a tool to help identify default Cobalt Strike servers exposed on the Internet. We strongly believe that understanding and mapping adversaries and their use of Cobalt Strike can improve defenses and boost organization detection &amp; response controls. Blocking, mapping and tracking adversaries is a good start.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*l9j-JLGriA0FMQjju7BByg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*l9j-JLGriA0FMQjju7BByg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*l9j-JLGriA0FMQjju7BByg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*l9j-JLGriA0FMQjju7BByg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*l9j-JLGriA0FMQjju7BByg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*l9j-JLGriA0FMQjju7BByg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*l9j-JLGriA0FMQjju7BByg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*l9j-JLGriA0FMQjju7BByg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="600" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Pointer logo</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><h2 id="1920" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk">Tool Development</h2><p id="96a8" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">A review of existing Cobalt Strike detection tools and public research showed that current tools can only scan a small number of potential Cobalt Strike instances (1–5k hosts). Our goal was to increase the scanning capabilities and validate several million potential Cobalt instances in less than an hour.</p><p id="0783" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">To achieve the above goal within a reasonable timeframe and on a small budget, it was necessary to adapt and scale the current understanding of the Cobalt Strike hunting methodology. The following content assumes an understanding of what Cobalt Strike is and how to locate and identify Cobalt strike instances. Before going into the details of the tool and their components, let’s take a look at the general architecture.</p><h1 id="55f3" class="os ot jl bf ou ov ow ox hh oy oz pa hj pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Architecture review</h1><p id="ee1e" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">Scanning a large number of hosts in a reasonable amount of time does not scale and has physical, cost and power limitations. Unless you have a great home lab and the bandwidth to support it, personal computing cannot really solve the scaling problem, so the decision was made to use AWS to affordably scale and achieve the desired goals.</p><h2 id="d8f4" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk">General architecture review</h2><p id="bbd1" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">The tool is developed and heavily based on AWS SQS, Lambda and DynamoDB.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv ru"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*D-xIj8UnIYtEclAP-y4wMg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*D-xIj8UnIYtEclAP-y4wMg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*D-xIj8UnIYtEclAP-y4wMg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*D-xIj8UnIYtEclAP-y4wMg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*D-xIj8UnIYtEclAP-y4wMg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*D-xIj8UnIYtEclAP-y4wMg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*D-xIj8UnIYtEclAP-y4wMg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*D-xIj8UnIYtEclAP-y4wMg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="656" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="be37" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The Pointer client parses the local json file with a list of IPs, optimally splits them into packets (10–20 IPs), and then adds the packets to be processed to the SQS queue.</p><p id="bae4" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The SQS queue is setup to invoke a lambda function for each packet in the queue. The lambda function (Pointer server) performs the actual scanning of the provided packet of IPs and saves results to DynamoDB.</p><p id="dc21" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">In cases where Lambda fails or throws an error, packets are returned to the SQS queue and will wait for a retry.</p><p id="0687" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">If the packet fails a second time, a new Lambda function is launched that logs the failed packet to DynamoDB for further analysis and rescan each IP individually to locate the failed IPs.</p><h2 id="f46d" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk">Code Review</h2><p id="16ff" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">The scan functionality of the “Pointer server” consists of 4 parts:</p><ol class=""><li id="d05d" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi rv rw rx bk">Port Scanning (Port Workers)</li><li id="b993" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk">HTTP Webservice scan (HTTP Workers)</li></ol><ul class=""><li id="d0da" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">Certificate parsing</li><li id="3146" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">JARM parsing</li></ul><p id="01e3" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">3. HTTPS Webservice scan (HTTPS Workers)</p><p id="68b7" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">4. Beacon Parsing (Beacon Workers)</p><p id="f163" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The tool was designed with an asynchronous approach to IP processing. Each scan probe stands as an independent unit, which is then processed by a Worker. The probes include a port scanning, Certificate Issuer parsing, JARM parsing, webservice scanning, and Beacon parsing. Once each probe is completed, the result is sent to the corresponding controller, which writes the result to the global map. After all scan workers are done, the data is sorted and ordered before being combined into the <code class="dz se sf sg sh b">Target</code> structure. Overall, this reduces the number of delays since each service(ip:port) has its own scan pipeline.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv si"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8aDUzB3fusDAcP3m7Rf06w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*8aDUzB3fusDAcP3m7Rf06w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*8aDUzB3fusDAcP3m7Rf06w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*8aDUzB3fusDAcP3m7Rf06w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*8aDUzB3fusDAcP3m7Rf06w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*8aDUzB3fusDAcP3m7Rf06w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*8aDUzB3fusDAcP3m7Rf06w.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*8aDUzB3fusDAcP3m7Rf06w.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="528" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Internal architecture of Lambda function</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="2979" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk"><strong class="pq jm">Detailed review</strong></p><p id="b1ab" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Initially the lambda function launches Port, HTTP, HTTPS, and Beacon workers. The number of workers depends on the level of internal concurrency (Internal concurrency is the controllable CLI parameter). Each type of worker is portioned accordingly to the required power resources. Portioning has been calculated based on the number of probes each worker performs in average.</p><p id="1386" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Each targeted IP address is scanned for 27 predefined ports, this list includes common ports on which Cobalt Strike beacons are hosted. The “launcher” sends service (ip:port) to the Port Workers through <code class="dz se sf sg sh b">portChannel</code> Golang channel.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*oCMBNFDetYCKfaHhQA0lIQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oCMBNFDetYCKfaHhQA0lIQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oCMBNFDetYCKfaHhQA0lIQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oCMBNFDetYCKfaHhQA0lIQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oCMBNFDetYCKfaHhQA0lIQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oCMBNFDetYCKfaHhQA0lIQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oCMBNFDetYCKfaHhQA0lIQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*oCMBNFDetYCKfaHhQA0lIQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="142" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of the Service Launcher</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="90e3" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Port workers then scan the individual ports. If a port is open, the worker sends the service to the HTTP Worker and Output controller through <code class="dz se sf sg sh b">httpChannel</code> and <code class="dz se sf sg sh b">outputChannel</code> Golang channels. If the port is closed the Port Worker exits the function.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*nLeqyMNHW6iwn7goeY3Ksw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nLeqyMNHW6iwn7goeY3Ksw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nLeqyMNHW6iwn7goeY3Ksw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nLeqyMNHW6iwn7goeY3Ksw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nLeqyMNHW6iwn7goeY3Ksw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nLeqyMNHW6iwn7goeY3Ksw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nLeqyMNHW6iwn7goeY3Ksw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*nLeqyMNHW6iwn7goeY3Ksw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="315" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of Port Worker</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="ad63" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">All workers send results through a single Golang channel, <code class="dz se sf sg sh b">outputChannel</code>, which are then processed by the output controller and saved to the global map (<code class="dz se sf sg sh b">Sorter</code> struct).</p><p id="38a6" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Each result produced by the workers has its own type tag (Ex: <code class="dz se sf sg sh b">&quot;Service|&quot;</code>,<code class="dz se sf sg sh b">&quot;Certificate|&quot;</code>,<code class="dz se sf sg sh b">&quot;Jarm|&quot;</code>, … ), ensuring that the <code class="dz se sf sg sh b">ValidateOutput</code> function can sort the results based on their types.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*XwKbzyaPFjBTd-V_318mKw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*XwKbzyaPFjBTd-V_318mKw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*XwKbzyaPFjBTd-V_318mKw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*XwKbzyaPFjBTd-V_318mKw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*XwKbzyaPFjBTd-V_318mKw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*XwKbzyaPFjBTd-V_318mKw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*XwKbzyaPFjBTd-V_318mKw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*XwKbzyaPFjBTd-V_318mKw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="213" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of Output Controller</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="8739" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The HTTP worker waits for IP and port tuple (service) to be provided by the Port Worker via the <code class="dz se sf sg sh b">httpChannel</code>. If the HTTP Worker receives port 50050 it attempts the following actions:</p><ul class=""><li id="12f0" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">Parse the certificate issuer -&gt; identifying the default self-signed Cobalt certificate</li><li id="fffd" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">Parse the JARM signature -&gt; detecting malicious JARM signatures</li></ul><p id="41c3" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">For other services, it performs a web request to analyse response behaviour. Beacon’s HTTP/HTTPS indicators are controlled by a malleable C2 profile, if the server uses the default malleable C2 profile, it responds with a 404 status code and 0 content-length for requests made to the root web endpoint. (http://domain.com/)</p><p id="d0f7" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">If the request to the targeted web service fails, HTTP Worker sends the service through <code class="dz se sf sg sh b">httpsChannel</code> channel further to the HTTPS Worker to perform the web request through HTTPS protocol.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*7iH2TEOAxL1xWWm69K7Diw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*7iH2TEOAxL1xWWm69K7Diw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*7iH2TEOAxL1xWWm69K7Diw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*7iH2TEOAxL1xWWm69K7Diw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*7iH2TEOAxL1xWWm69K7Diw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*7iH2TEOAxL1xWWm69K7Diw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*7iH2TEOAxL1xWWm69K7Diw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*7iH2TEOAxL1xWWm69K7Diw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="507" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of the HTTP Worker</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="ef34" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Being inspired by the “Analyzing Cobalt Strike for Fun and Profit” research and its corresponding tool for cobalt strike beacon parsing (developed using Python), we integrated the similar logic into our tool for beacon parsing (developed using Golang).</p><p id="46bb" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk"><em class="sk">The guy, who researched how the beacon is packed, how to parse the beacon, how to decrypt the beacon, and how to work with that in general, you did the good job a big thank you!</em></p><p id="b336" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">All identified web services that have been configured with default malleable C2 profile are sent to the Beacon Workers. The Beacon Worker attempts to parse the beacon config. If the parsing succeeds, Beacon Worker sends the <code class="dz se sf sg sh b">CobaltStrikeBeaconStruct</code> struct to the Beacon controller through <code class="dz se sf sg sh b">beaconStructChannel</code> channel, and the beacon location URI to the output controller through <code class="dz se sf sg sh b">outputChannel</code> channel.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*vfQqdvtK-_zQl5mZISaCkg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vfQqdvtK-_zQl5mZISaCkg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vfQqdvtK-_zQl5mZISaCkg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vfQqdvtK-_zQl5mZISaCkg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vfQqdvtK-_zQl5mZISaCkg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vfQqdvtK-_zQl5mZISaCkg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vfQqdvtK-_zQl5mZISaCkg.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*vfQqdvtK-_zQl5mZISaCkg.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="375" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of Beacon Worker</figcaption></figure><figure class="nr qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*4HqlMi7DrMaWBD9MnvTVog.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*4HqlMi7DrMaWBD9MnvTVog.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4HqlMi7DrMaWBD9MnvTVog.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4HqlMi7DrMaWBD9MnvTVog.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4HqlMi7DrMaWBD9MnvTVog.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4HqlMi7DrMaWBD9MnvTVog.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4HqlMi7DrMaWBD9MnvTVog.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*4HqlMi7DrMaWBD9MnvTVog.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="181" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of Beacon Controller</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="090a" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">When all workers finish the scans, the <code class="dz se sf sg sh b">Sort</code> method maps all gathered scan results sent to the output controller into the array of <code class="dz se sf sg sh b">CobaltStrikeStruct</code> type:</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*cdfxRc0GGhMZkS9jw38khA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cdfxRc0GGhMZkS9jw38khA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cdfxRc0GGhMZkS9jw38khA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cdfxRc0GGhMZkS9jw38khA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cdfxRc0GGhMZkS9jw38khA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cdfxRc0GGhMZkS9jw38khA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cdfxRc0GGhMZkS9jw38khA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*cdfxRc0GGhMZkS9jw38khA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="194" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of <code class="dz se sf sg sh b">CobaltStrikeStruct data type</code></figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="f9d9" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The <code class="dz se sf sg sh b">Probability</code> field is assigned when the <code class="dz se sf sg sh b">Voter</code> function calls the internal method <code class="dz se sf sg sh b">Vote</code> for each <code class="dz se sf sg sh b">CobaltStrikeStruct</code> object within the array.</p><p id="396b" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">In case the certificate issuer matches the default Cobalt Strike self-signed certificate, the <code class="dz se sf sg sh b">Vote</code> method gives 100% probability that it is the Cobalt Strike server. The same applies if the Beacon Worker successfully parses the beacon config hosted on the web service.</p><p id="caa9" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Default web service response and malicious JARM signature results cannot give us confidence in assigning the probability rate. Because other web services can respond with 0 content length and 404 status code, and servers can be configured with the same TLS options (<a class="ag hz" href="https://engineering.salesforce.com/easily-identify-malicious-servers-on-the-internet-with-jarm-e095edac525a" rel="noopener ugc nofollow" target="_blank">if you don’t understand what JARM is</a>). If the <code class="dz se sf sg sh b">Vote</code> method matches only those two indicators, it assigns the 70% probability to the object.</p><p id="4540" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">If none of these meet our requirements, it is probably not a Cobalt Strike server. But, again, this tool targets only Cobalt Strike servers with default malleable C2 profile configurations.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*BkZVI7N45LBnTaI9j4CQfA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*BkZVI7N45LBnTaI9j4CQfA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*BkZVI7N45LBnTaI9j4CQfA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*BkZVI7N45LBnTaI9j4CQfA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*BkZVI7N45LBnTaI9j4CQfA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*BkZVI7N45LBnTaI9j4CQfA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*BkZVI7N45LBnTaI9j4CQfA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*BkZVI7N45LBnTaI9j4CQfA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="281" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of the Vote method</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><h2 id="473d" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk"><strong class="am">DynamoDB Component</strong></h2><p id="09d0" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">We chose DynamoDB service to store scan results. DynamoDB can handle more than 10 trillion requests per day and support peaks of more than 20 million requests per second. That is what we needed 100%! We wanted to scan 20000–25000 targets per 60 seconds, which is about 40k-50k writing requests to the database.</p><p id="f390" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">On the first implementation, the Output and Beacon workers exceeded DynamoDB rate limits because they performed a write request to the DynamoDB table for each target object separately, and, in addition, we used the default DynamoDB configuration. The default capacity configuration could not handle that many requests, but by increasing the capacity we would pay more money for autoscaling during constant scanning. Further examination of the AWS documentation revealed that AWS had implemented the batch write to DynamoDB. For each lambda invocation, we have 10–20 targets (depending on the packet size) to scan, so this should reduce the number of requests to DynamoDB tables by a factor of 10–20.</p><p id="dc67" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">We found that DynamoDB’s <code class="dz se sf sg sh b">BatchWriteItemInput</code> function allows writing up to 25 items and up to 16 Mb in one request. The batch write implementation significantly decreased the number of requests and removed the rate limiting issue at the default configuration level. We did not have to pay for unnecessary autoscaling.</p><p id="6ba7" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">This method has the disadvantage that if one of the items in the batch fails to be written, the whole batch will not be saved. (The partition key must be unique and not exist in the table, but this is suitable in our case, as we filter our targets by unique values before launching the scans).</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*cZe84GD2-P0ILzLpPJKVtQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*cZe84GD2-P0ILzLpPJKVtQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*cZe84GD2-P0ILzLpPJKVtQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*cZe84GD2-P0ILzLpPJKVtQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*cZe84GD2-P0ILzLpPJKVtQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*cZe84GD2-P0ILzLpPJKVtQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*cZe84GD2-P0ILzLpPJKVtQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*cZe84GD2-P0ILzLpPJKVtQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="472" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet of the WriteBatchTarget function</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="84cc" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Also, for unpredictable cases where the default capacity configuration cannot handle a large number of requests, we configure autoscaling:</p><p id="f474" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">AWS Console → DynamoDB → choose the Table → Edit Capacity → Read / Write Capacity increase to 10–15. To enable autoscaling we should give the required permissions for the DynamoDB service role .</p><h2 id="4c5a" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk">Lambda Component</h2><p id="2e84" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">AWS Lambda is an interesting service. We wanted to try Lambda as a core service for our scans, however we did not want to get a crazy paycheck at the end of the month, so we had several things to figure out:</p><ol class=""><li id="bcc4" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi rv rw rx bk">How much memory to allocate for Lambda execution</li><li id="c439" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk">What default timeout to set for Lambda execution</li><li id="7254" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk">How to manage Lambda concurrency</li><li id="d759" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk">What internal concurrency would be suited for our model;</li><li id="bc29" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk">What request timeouts would be suited for our model</li><li id="ebdf" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk">What packet size would be suited for our model</li></ol><p id="cfb7" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">And the most difficult question — How to setup everything the way it would be efficient, cheap, and with minimum loss rate?</p><p id="caa1" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk"><strong class="pq jm">Lambda memory allocation</strong></p><p id="7bba" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">It was interesting to research how AWS allocates memory and CPU for Lambda functions, because it is physically impossible to divide 1/10 of the CPU. But it can allocate 1/10 of the time of the CPU to a single function, and you can have 10 of them working at the same time to share the same CPU core (<a class="ag hz" href="https://engineering.opsgenie.com/how-does-proportional-cpu-allocation-work-with-aws-lambda-41cd44da3cac" rel="noopener ugc nofollow" target="_blank">check this research, it explains how AWS Lambda allocates CPU</a>).</p><p id="0649" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The only controllable parameter in AWS for Lambda functions is memory usage:</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*vnFFoWHJEh1-sNf15Gl_qA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*vnFFoWHJEh1-sNf15Gl_qA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*vnFFoWHJEh1-sNf15Gl_qA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*vnFFoWHJEh1-sNf15Gl_qA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*vnFFoWHJEh1-sNf15Gl_qA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*vnFFoWHJEh1-sNf15Gl_qA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*vnFFoWHJEh1-sNf15Gl_qA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*vnFFoWHJEh1-sNf15Gl_qA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="129" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Example of the memory configuration in AWS Console</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="91c9" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">We designed our model with a multithreaded architecture — the more cores we have, the better performance we can potentially obtain. But the nasty thing here is what the price of this luxury is.)))</p><p id="eccb" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">We cannot directly control the number of cores we want to use. The CPU performance scales with the memory configuration. Lambda functions used to always have 2 vCPU cores, regardless of the allocated memory. The rest of the cores are throttled at certain memory configurations. By increasing the memory allocation, we obtain more cores. I found the <a class="ag hz" href="https://www.sentiatechblog.com/aws-re-invent-2020-day-3-optimizing-lambda-cost-with-multi-threading" rel="noopener ugc nofollow" target="_blank">research</a> that discovered how the number of vCPUs and multithreaded computation power vary depending on the memory configuration.</p><p id="8f07" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The price for using the AWS Lambda function is based on the function runtime (in milliseconds) multiplied by the allocated memory (fixed prices per Mb). So, allocating 3008MB for the Lambda function, we get 2 vCPUs, and allocating 3009MB we get 3vCPUs. By allocating 3009MB memory, we could gain more performance, at almost the same price.)))</p><p id="2e2b" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">According to the research, we get better performance gain for multithreading with each spike transition (jump in cores). But for our model we do not need more than 3 cores, 3009MB is enough for our purposes.</p><figure class="qx qy qz ra rb qo qu qv paragraph-image"><div class="qu qv sl"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 1100w, https://miro.medium.com/v2/resize:fit:668/format:webp/1*VvwYpHhd3gyyyj2B1XGFdw.png 668w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 334px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VvwYpHhd3gyyyj2B1XGFdw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VvwYpHhd3gyyyj2B1XGFdw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VvwYpHhd3gyyyj2B1XGFdw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VvwYpHhd3gyyyj2B1XGFdw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VvwYpHhd3gyyyj2B1XGFdw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VvwYpHhd3gyyyj2B1XGFdw.png 1100w, https://miro.medium.com/v2/resize:fit:668/1*VvwYpHhd3gyyyj2B1XGFdw.png 668w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 334px"/><img alt="" class="bh gu ri c" width="334" height="402" loading="eager" role="presentation"/></picture></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Correlation between Lambda memory configuration and number of cores</figcaption></figure><p id="6102" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">By the way, we decided to measure the computational power ourselves, and the practical tests showed that the power spike between 3008–3009 MB is bigger than between 5307–5308 MB. This once again confirms that the 3009MB memory configuration is the best choice for us.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*nGbmjJoDhDIgqnpooDUIBw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*nGbmjJoDhDIgqnpooDUIBw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*nGbmjJoDhDIgqnpooDUIBw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*nGbmjJoDhDIgqnpooDUIBw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*nGbmjJoDhDIgqnpooDUIBw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*nGbmjJoDhDIgqnpooDUIBw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*nGbmjJoDhDIgqnpooDUIBw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*nGbmjJoDhDIgqnpooDUIBw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="734" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Code snippet for measuring the multithreaded computation power</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="8b6d" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk"><strong class="pq jm">Internal parameter tuning</strong></p><p id="d054" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">As we got a solid understanding of how many resources to use, we started tuning and suiting other parameters for our model.</p><p id="29ba" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">In my opinion, the lifetime of the Pointer lambda function should not be more than 60 seconds, because otherwise it will not be a true server-less tool with easy management, stable to errors and autoscaled architecture.</p><p id="37e6" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">With a memory configuration of 3009 Mb and a default timeout of 60 seconds for one Lambda execution, we could scan from 10–20 targets in a single packet.</p><p id="1ccd" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">In case the lambda execution fails, we do not want to rescan all the targets inside the packet again. By having less number of targets in the packet, we minimize the probability that the packet will be crashed. Therefore, the optimal size, in my opinion, is 10–20 targets.</p><p id="cffa" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">By having less number of targets inside the packet, we are minimising the chance that the packet will be crashed. In case the lambda execution fails, we must rescan all targets inside the packet (even those that have been successfully scanned).</p><p id="8c2a" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">When we defined lambda configuration parameters, the rest of the parameters were tuned with a big number of tests:</p><pre class="qx qy qz ra rb sn sh so sp ay sq bk"><span id="0434" class="rn ot jl sh b hx sr ss l li st">Targets/per packet  20    (Items)<br/>Concurrency         140   (Items)<br/>Lambda Memory       3009  (Mb)<br/>Lambda Timeout      60    (sec)<br/>Http timeout        4     (sec)<br/>Port timeout        2     (sec)<br/>Beacon timeout      10    (sec)</span></pre><p id="4143" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk"><strong class="pq jm">Lambda Concurrency</strong></p><p id="db67" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">AWS Lambda provides autoscaling for function instances. But we simply cannot deploy as many instances as we want. We are limited by the AWS region quota (<a class="ag hz" href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html" rel="noopener ugc nofollow" target="_blank">All the lambda functions of an account can use the pool of 1000 unreserved concurrent executions</a>). Thus, having only 1 deployed function, we could get 1000 concurrent executions at the same time.</p><p id="47c7" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Dorking potential Cobalt Strike servers through Shodan, we could retrieve around 200–300k potential targets. However, we are designing the tool to scan 2M-10M targets. For example, 2M targets is about 100k packets (20 targets per packet), which means 100k lambda function invocations. If Lambda function is invoked 100k times, the lambda puller would process only 1k requests at a time, and the rest would be just throttled. So even if we increase the AWS region quota, it will not be enough.</p><p id="68d9" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">So the question arises — how we can manage the invocation process? The answer is simple — SQS.</p><h2 id="fff5" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk"><strong class="am">SQS Component</strong></h2><p id="50d3" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk"><strong class="pq jm">Configuration</strong></p><p id="fa34" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. This means we can send all our packets to the queue and SQS will manage the process of lambda invocation. The SQS management can be configured according to our needs:</p><ol class=""><li id="5318" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi rv rw rx bk">We can control the number of retries.</li></ol><ul class=""><li id="2e59" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">We can configure the maximum number of retries the SQS would perform, if the batch of messages(packets) fails</li><li id="9280" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">The SQS sends messages packed in the batches, we can control the number of messages inside the batch we want to pass to the Lambda function, so having 1 message in the batch will equal 1 message.</li><li id="1f0e" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">In our model we decided that If message fails more than once, it would be sent to the <a class="ag hz" href="https://data.solita.fi/lessons-learned-from-combining-sqs-and-lambda-in-a-data-project/" rel="noopener ugc nofollow" target="_blank">Dead-Letter-Queue</a> (DLQ). We designed the <a class="ag hz" href="https://data.solita.fi/lessons-learned-from-combining-sqs-and-lambda-in-a-data-project/" rel="noopener ugc nofollow" target="_blank">Dead-Letter-Queue</a> (DLQ) to redirect the failed messages to the Lambda function with the same logic as the core one, but before scanning activities it writes the the failed packet to the DynamoDB table and rescans each target separately.</li></ul><p id="825b" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">2. Visibility timeout</p><ul class=""><li id="5a1a" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">The visibility timeout sets the length of time that a message received from the queue (by one lambda function) will not be visible to the lambda function again. If the lambda function fails to process and delete the message before the visibility timeout expires, the message becomes visible to the lambda function again.</li></ul><p id="3142" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">3. SQS batch size</p><ul class=""><li id="6317" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">We configured SQS batch size to a single message.</li></ul><p id="8e90" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk"><strong class="pq jm">SQS &amp; Lambda autoscaling</strong></p><p id="f3b4" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">For standard queues, Lambda uses long polling to poll the queue until it becomes active. When messages are available, Lambda reads up to 5 batches and sends them to our lambda function. If messages are still available, Lambda increases the number of processes that read batches up to 60 more instances per minute. The maximum number of batches that can be processed simultaneously by event source mapping is 1000. This means that the full power we can get after 16 minutes of continuous scanning.</p><h1 id="ec13" class="os ot jl bf ou ov ow ox hh oy oz pa hj pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Results</h1><p id="9545" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">At the first launch, when we ran a scan for 160k targets, we were able to identify 1,700 Cobalt Strike servers and parse 1,400 of their beacon configurations within 40 minutes. The Pointer tool can produce best performance results if the target size exceeds 500k. Scanning 160k targets took a little longer because 1000 concurrent lambda executions were achieved only after 30 minutes when the tool was launched. For the current implementation, the cost of scanning 250k targets is about 20$, however we are looking for a solution that will make it cheaper.</p><h2 id="5feb" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk"><strong class="am">Targets table [sample]</strong></h2><p id="c10d" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">We have developed 2 tables, first one for identified Cobalt Strike servers, and the second for parsed beacon configurations. Identified Cobalt Strike servers can be described by 7 features:</p><ul class=""><li id="a84e" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">IP address is a unique sorting key</li><li id="aa64" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">probability that it’s the actual cobalt strike server (easier filtering)</li><li id="1e1f" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">JARM signature</li><li id="a92d" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">Certificate Issuer</li><li id="cf86" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">Opened Ports</li><li id="3ba7" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">Response behaviour</li><li id="9721" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">Links to the beacon configurations that we parsed and saved to another table</li></ul><p id="7442" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">There is an example of the cobalt strike server table:</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv su"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*YpC9KUZ0vNoeBiguSOSzmA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*YpC9KUZ0vNoeBiguSOSzmA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*YpC9KUZ0vNoeBiguSOSzmA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*YpC9KUZ0vNoeBiguSOSzmA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*YpC9KUZ0vNoeBiguSOSzmA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*YpC9KUZ0vNoeBiguSOSzmA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*YpC9KUZ0vNoeBiguSOSzmA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*YpC9KUZ0vNoeBiguSOSzmA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="151" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Table of parsed Cobalt Strike targets</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><h2 id="5999" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk"><strong class="am">Beacons table [sample]</strong></h2><p id="aa21" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">The Beacon configuration table has the <code class="dz se sf sg sh b">uri</code> feature as a unique sorting key, when the rest of the features are the actual parsed beacon configurations.</p><p id="b0ab" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Here is an example of the table with parsed beacon configurations:</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sv"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*FuFGM2cnkWcya3zz-tg-wQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*FuFGM2cnkWcya3zz-tg-wQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*FuFGM2cnkWcya3zz-tg-wQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*FuFGM2cnkWcya3zz-tg-wQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*FuFGM2cnkWcya3zz-tg-wQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*FuFGM2cnkWcya3zz-tg-wQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*FuFGM2cnkWcya3zz-tg-wQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*FuFGM2cnkWcya3zz-tg-wQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="345" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><p id="86c7" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The full version of tables you can find here:</p><ul class=""><li id="fe48" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk"><a class="ag hz" href="https://docs.google.com/spreadsheets/d/1akSzGDq8ddn97rNfr7BS0w2HcoR52ircFaSMh-OEjTU/edit#gid=311496774" rel="noopener ugc nofollow" target="_blank">Spreadsheet with 1709 Cobalt Strike servers</a></li><li id="d663" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk"><a class="ag hz" href="https://docs.google.com/spreadsheets/d/1akSzGDq8ddn97rNfr7BS0w2HcoR52ircFaSMh-OEjTU/edit#gid=216476235" rel="noopener ugc nofollow" target="_blank">Spreadsheet with 1473 Beacon configurations</a></li></ul><h2 id="0aba" class="rn ot jl bf ou hg ro fa hh hi rp fc hj hk rq hl hm hn rr ho hp hq rs hr hs rt bk">Data analysis</h2><p id="0e11" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">We are using collected data to map attackers infrastructure and understand how the attackers operate Cobalt Strike.</p><p id="8495" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">We know that threat intelligence groups are tracking specific ransomware groups with the help of Watermarks, For example:</p><ul class=""><li id="4273" class="po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi sd rw rx bk">Sodinokibi (Watermark 452436291)</li><li id="dc00" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi sd rw rx bk">APT 27 (Watermark 305419896).</li></ul><p id="4929" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Based on the beacon’s <code class="dz se sf sg sh b">spawnto</code> locations the blue teams can develop detection controls.</p></div></div><div class="qo"><div class="ab de"><div class="nv qp nw qq nx qr di qs dj qt dl bh"><figure class="qx qy qz ra rb qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*c-u159aiTxJ3Lg-CDx61CA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*c-u159aiTxJ3Lg-CDx61CA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*c-u159aiTxJ3Lg-CDx61CA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*c-u159aiTxJ3Lg-CDx61CA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*c-u159aiTxJ3Lg-CDx61CA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*c-u159aiTxJ3Lg-CDx61CA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*c-u159aiTxJ3Lg-CDx61CA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*c-u159aiTxJ3Lg-CDx61CA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="656" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Location of servers (IP) (Hosting provides)</figcaption></figure><figure class="nr qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*5-0J7Ab77A-rb5QEyCQWSQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5-0J7Ab77A-rb5QEyCQWSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5-0J7Ab77A-rb5QEyCQWSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5-0J7Ab77A-rb5QEyCQWSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5-0J7Ab77A-rb5QEyCQWSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5-0J7Ab77A-rb5QEyCQWSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5-0J7Ab77A-rb5QEyCQWSQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*5-0J7Ab77A-rb5QEyCQWSQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="656" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Watermarks</figcaption></figure><figure class="nr qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*rqzOA2U4HCIcUHdkaiFy1g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*rqzOA2U4HCIcUHdkaiFy1g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*rqzOA2U4HCIcUHdkaiFy1g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*rqzOA2U4HCIcUHdkaiFy1g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*rqzOA2U4HCIcUHdkaiFy1g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*rqzOA2U4HCIcUHdkaiFy1g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*rqzOA2U4HCIcUHdkaiFy1g.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*rqzOA2U4HCIcUHdkaiFy1g.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="656" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Countries</figcaption></figure><figure class="nr qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*0Y4jfPkb3BWQlh2LSJyHvQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="656" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Spawn location</figcaption></figure><figure class="nr qo rc rd paragraph-image"><div role="button" tabindex="0" class="re rf gk rg bh rh"><div class="qu qv sx"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*2qVJCh6ie_tRztaTMtnMmw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*2qVJCh6ie_tRztaTMtnMmw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2qVJCh6ie_tRztaTMtnMmw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2qVJCh6ie_tRztaTMtnMmw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2qVJCh6ie_tRztaTMtnMmw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2qVJCh6ie_tRztaTMtnMmw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2qVJCh6ie_tRztaTMtnMmw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*2qVJCh6ie_tRztaTMtnMmw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh gu ri c" width="1000" height="473" loading="eager" role="presentation"/></picture></div></div><figcaption class="rj gg rk qu qv rl rm bf b bg z cm">Sample of the Dork database (not completed)</figcaption></figure></div></div></div><div class="ab de"><div class="dl bh is it iu iv"><h1 id="6a50" class="os ot jl bf ou ov ow ox hh oy oz pa hj pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Summary &amp; Future work</h1><p id="2161" class="pw-post-body-paragraph po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi im bk">For the first Pointer version, we have developed a system with a complete hunting methodology that could be easily scalable up to 2–3 millions targets.</p><p id="a750" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">The first tests showed that the tool can scan 200k targets in 45–50 minutes with 10% packet loss. We strongly believe that we have taken a big step in hunting and detection system.</p><p id="6bf4" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">But, of course, we have not achieved the results we wanted, this is just the first demo version of the Pointer.</p><p id="b926" class="pw-post-body-paragraph po pp jl pq b pr qj pt pu pv qk px py hk ql qa qb hn qm qd qe hq qn qg qh qi im bk">Any feedback is more than welcome and if you have any ideas, suggestions, and recommendations, or if you want to help us improve the Cobalt Strike Hunting tool, just contact Pavel Shabarkin and Michael Koczwara.</p><h1 id="51a7" class="os ot jl bf ou ov ow ox hh oy oz pa hj pb pc pd pe pf pg ph pi pj pk pl pm pn bk">References</h1><ol class=""><li id="4c45" class="po pp jl pq b pr ps pt pu pv pw px py hk pz qa qb hn qc qd qe hq qf qg qh qi rv rw rx bk"><a class="ag hz" href="https://attack.mitre.org/software/S0154/" rel="noopener ugc nofollow" target="_blank">https://attack.mitre.org/software/S0154/</a></li><li id="4d31" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk"><a class="ag hz" href="https://www.randhome.io/blog/2020/12/20/analyzing-cobalt-strike-for-fun-and-profit/" rel="noopener ugc nofollow" target="_blank">https://www.randhome.io/blog/2020/12/20/analyzing-cobalt-strike-for-fun-and-profit/</a></li><li id="9123" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk"><a class="ag hz" href="https://engineering.opsgenie.com/how-does-proportional-cpu-allocation-work-with-aws-lambda-41cd44da3cac" rel="noopener ugc nofollow" target="_blank">https://engineering.opsgenie.com/how-does-proportional-cpu-allocation-work-with-aws-lambda-41cd44da3cac</a></li><li id="df00" class="po pp jl pq b pr ry pt pu pv rz px py hk sa qa qb hn sb qd qe hq sc qg qh qi rv rw rx bk"><a class="ag hz" href="https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html" rel="noopener ugc nofollow" target="_blank">https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html</a></li></ol></div></div></div></div></section></div></div></article></div><div class="ab de"><div class="dl bh is it iu iv"><div class="sy sz ab lh"><div class="ta ab"><a class="tb ay an ap" href="https://medium.com/tag/cybersecurity?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><div class="tc gk dz td ix te tf bf b bg z bk gv">Cybersecurity</div></a></div><div class="ta ab"><a class="tb ay an ap" href="https://medium.com/tag/cybercrime?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><div class="tc gk dz td ix te tf bf b bg z bk gv">Cybercrime</div></a></div><div class="ta ab"><a class="tb ay an ap" href="https://medium.com/tag/aws?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><div class="tc gk dz td ix te tf bf b bg z bk gv">AWS</div></a></div><div class="ta ab"><a class="tb ay an ap" href="https://medium.com/tag/penetration-testing?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><div class="tc gk dz td ix te tf bf b bg z bk gv">Penetration Testing</div></a></div><div class="ta ab"><a class="tb ay an ap" href="https://medium.com/tag/programming?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><div class="tc gk dz td ix te tf bf b bg z bk gv">Programming</div></a></div></div></div></div><div class="l"></div><footer class="tg th ti tj tk ab q tl lb c"><div class="l ae"><div class="ab de"><div class="dl bh is it iu iv"><div class="ab dr tm"><div class="ab q ms"><div class="tn l"><span class="l to tp tq e d"><div class="ab q ms mt"><div class="pw-multi-vote-icon gk lj mu mv mw"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-aws%2Fa334ac50619a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;user=Pavel+Shabarkin&amp;userId=9284dc7b6da6&amp;source=---footer_actions--a334ac50619a---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="mx ap my mz na nb an nc nd ne mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l nf ng nh ni nj nk nl"><p class="bf b ex z cm"><span class="nm">--</span></p></div></div></span><span class="l h g f tr ts"><div class="ab q ms mt"><div class="pw-multi-vote-icon gk lj mu mv mw"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Ftowards-aws%2Fa334ac50619a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;user=Pavel+Shabarkin&amp;userId=9284dc7b6da6&amp;source=---footer_actions--a334ac50619a---------------------clap_footer------------------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="mx ap my mz na nb an nc nd ne mw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l nf ng nh ni nj nk nl"><p class="bf b ex z cm"><span class="nm">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ap mx nn no ab q gl np nq" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="nr"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="tt l ce"><div><div class="bm" aria-hidden="false"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fa334ac50619a&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;source=---footer_actions--a334ac50619a---------------------bookmark_footer------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="cm nt" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="tt l ce"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="ag gl ai aj ak al am oa ao ap aq fy ob oc nq od"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="tu l"><div class="ab de"><div class="dl bh is it iu iv"><div class="tv l"><div class="ab tw tx ty lg lf"><div class="tz ua ub uc ud ue uf ug uh ui ab dr"><div class="h k"><a href="https://towardsaws.com/?source=post_page---post_publication_info--a334ac50619a---------------------------------------" rel="noopener follow"><div class="gk"><img alt="Towards AWS" class="dz ih l ks kt" src="https://miro.medium.com/v2/resize:fill:96:96/1*H7nXs2clXxnWZeKjcW17Tg.png" width="48" height="48" loading="lazy"/><div class="ih l kt ks gs n gr ik"></div></div></a></div><div class="j i d"><a href="https://towardsaws.com/?source=post_page---post_publication_info--a334ac50619a---------------------------------------" rel="noopener follow"><div class="gk"><img alt="Towards AWS" class="dz ih l uk uj" src="https://miro.medium.com/v2/resize:fill:128:128/1*H7nXs2clXxnWZeKjcW17Tg.png" width="64" height="64" loading="lazy"/><div class="ih l uj uk gs n gr ik"></div></div></a></div><div class="j i d ul ce"><div class="ab"><span><a class="bf b bg z um tc un uo up uq ur fw fx us ut uu gb gc gd ge bm gf gg" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-aws&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;collection=Towards+AWS&amp;collectionId=5da0267791b1&amp;source=post_page---post_publication_info--a334ac50619a---------------------follow_profile------------------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab cg dd"><div class="uv uw ux qq qp l"><a class="ag ah ai ak al am an ao ap aq ar as at au ab q" href="https://towardsaws.com/?source=post_page---post_publication_info--a334ac50619a---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bf hf uz va vb vc vd ve hk hl hm hn ho hp hq hr hs bk"><span class="im uy">Published in <!-- -->Towards AWS</span></h2></a><div class="ta ab kr"><div class="l ce"><span class="pw-follower-count bf b bg z cm"><a class="ag ah ai aj ak al am an ao ap aq ar as le" rel="noopener follow" href="/followers?source=post_page---post_publication_info--a334ac50619a---------------------------------------">7.5K Followers</a></span></div><div class="bf b bg z cm ab li"><span class="hv l" aria-hidden="true"><span class="bf b bg z cm">·</span></span><a class="ag ah ai aj ak al am an ao ap aq ar as le" rel="noopener follow" href="/the-underestimated-power-of-personalized-recommendations-7f2e75b12844?source=post_page---post_publication_info--a334ac50619a---------------------------------------">Last published <!-- -->19 hours ago</a></div></div><div class="il l"><p class="bf b bg z bk"><span class="im">Where Cloud Experts, Heroes, Builders, and Developers share their stories, experiences, and solutions.</span></p></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z um tc un uo up uq ur fw fx us ut uu gb gc gd ge bm gf gg" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Ftowards-aws&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;collection=Towards+AWS&amp;collectionId=5da0267791b1&amp;source=post_page---post_publication_info--a334ac50619a---------------------follow_profile------------------" rel="noopener follow">Follow</a></span></div></div></div></div><div class="ab tw tx ty lg lf"><div class="tz ua ub uc ud ue uf ug uh ui ab dr"><div class="h k"><a tabindex="0" href="https://shabarkin.medium.com/?source=post_page---post_author_info--a334ac50619a---------------------------------------" rel="noopener follow"><div class="l gk"><img alt="Pavel Shabarkin" class="l ge by kt ks dz" src="https://miro.medium.com/v2/resize:fill:96:96/1*au7aS6ukZ6IIWNBSKcCk8Q.jpeg" width="48" height="48" loading="lazy"/><div class="gr by l kt ks gs n ay ik"></div></div></a></div><div class="j i d"><a tabindex="0" href="https://shabarkin.medium.com/?source=post_page---post_author_info--a334ac50619a---------------------------------------" rel="noopener follow"><div class="l gk"><img alt="Pavel Shabarkin" class="l ge by uj uk dz" src="https://miro.medium.com/v2/resize:fill:128:128/1*au7aS6ukZ6IIWNBSKcCk8Q.jpeg" width="64" height="64" loading="lazy"/><div class="gr by l uj uk gs n ay ik"></div></div></a></div><div class="j i d ul ce"><div class="ab"><span><a class="bf b bg z um tc un uo up uq ur fw fx us ut uu gb gc gd ge bm gf gg" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9284dc7b6da6&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;user=Pavel+Shabarkin&amp;userId=9284dc7b6da6&amp;source=post_page-9284dc7b6da6--post_author_info--a334ac50619a---------------------follow_profile------------------" rel="noopener follow">Follow</a></span></div></div></div><div class="ab cg dd"><div class="uv uw ux qq qp l"><a class="ag ah ai ak al am an ao ap aq ar as at au ab q" href="https://shabarkin.medium.com/?source=post_page---post_author_info--a334ac50619a---------------------------------------" rel="noopener follow"><h2 class="pw-author-name bf hf uz va vb vc vd ve hk hl hm hn ho hp hq hr hs bk"><span class="im uy">Written by <!-- -->Pavel Shabarkin</span></h2></a><div class="ta ab kr"><div class="l ce"><span class="pw-follower-count bf b bg z cm"><a class="ag ah ai aj ak al am an ao ap aq ar as le" href="https://shabarkin.medium.com/followers?source=post_page---post_author_info--a334ac50619a---------------------------------------" rel="noopener follow">109 Followers</a></span></div><div class="bf b bg z cm ab li"><span class="hv l" aria-hidden="true"><span class="bf b bg z cm">·</span></span><a class="ag ah ai aj ak al am an ao ap aq ar as le" href="https://medium.com/@shabarkin/following?source=post_page---post_author_info--a334ac50619a---------------------------------------" rel="noopener follow">21 Following</a></div></div><div class="il l"><p class="bf b bg z bk">From zero to one in Security and Deep Learning <a class="ag ah ai aj ak al am an ao ap aq ar as hz jf" href="https://www.linkedin.com/in/pavel-shabarkin-b99a31145/" rel="noopener  ugc nofollow">https://www.linkedin.com/in/pavel-shabarkin-b99a31145/</a></p></div></div></div><div class="h k"><div class="ab"><span><a class="bf b bg z um tc un uo up uq ur fw fx us ut uu gb gc gd ge bm gf gg" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9284dc7b6da6&amp;operation=register&amp;redirect=https%3A%2F%2Ftowardsaws.com%2Fpointer-hunting-cobalt-strike-globally-a334ac50619a&amp;user=Pavel+Shabarkin&amp;userId=9284dc7b6da6&amp;source=post_page-9284dc7b6da6--post_author_info--a334ac50619a---------------------follow_profile------------------" rel="noopener follow">Follow</a></span></div></div></div></div></div></div><div class="vf l"><div class="vg bh r tu"></div><div class="ab de"><div class="dl bh is it iu iv"><div class="ab q dr"><h2 class="bf hf ov ox hh oy pa hj pb pd pe pf ph pi pj pl pm bk">No responses yet</h2><div class="ab vh"><div><div class="bm" aria-hidden="false"><a class="vi vj" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--a334ac50619a---------------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="vk vl vm vn vo l"></div></div></div></div><div class="vp vq vr vs vt l bx"><div class="h k j"><div class="vg bh vu vv"></div><div class="ab de"><div class="dl bh is it iu iv"><div class="cf ab ms lh"><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://help.medium.com/hc/en-us?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Help</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.statuspage.io/?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Status</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/about?autoplay=1&amp;source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">About</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Careers</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="mailto:pressinquiries@medium.com" rel="noopener follow"><p class="bf b ex z cm">Press</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://blog.medium.com/?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Blog</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Privacy</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Terms</p></a></div><div class="vw vx l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://speechify.com/medium?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Text to speech</p></a></div><div class="vw l"><a class="ag ah ai aj ak al am an ao ap aq ar as at au" href="https://medium.com/business?source=post_page-----a334ac50619a---------------------------------------" rel="noopener follow"><p class="bf b ex z cm">Teams</p></a></div></div></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250325-084254-43d1e77fa5"</script><script>window.__GRAPHQL_URI__ = "https://towardsaws.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"This request is not using the cache middleware worker","group":"disabled","tags":["group-edgeCachePosts","post-a334ac50619a","user-9284dc7b6da6","collection-5da0267791b1"],"serverVariantState":"","middlewareEnabled":false,"cacheStatus":"DYNAMIC","shouldUseCache":false,"vary":[],"pubFeaturingPostPageLabelEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"COLLECTION","id":"5da0267791b1","explicit":true},"viewerIsBot":false},"debug":{"requestId":"7f732211-adc4-4e69-a4c2-32afa3689206","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-bc55acf80172b131aa5f2be892c6c9f1-869641212304dbf5-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Ftowardsaws.com\u002Fpointer-hunting-cobalt-strike-globally-a334ac50619a","host":"towardsaws.com","hostname":"towardsaws.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null}},"config":{"nodeEnv":"production","version":"main-20250325-084254-43d1e77fa5","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250325-084254-43d1e77fa5","commit":"43d1e77fa54c3aeaea37b29bba9740f2f85307ab"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","variantFlags":[{"__typename":"VariantFlag","name":"enable_newsletter_lo_flow_custom_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_bg_post_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_google_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_country_expansion","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automod","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_new_push_notification_endpoint","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_in_app_free_trial","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"enable_aurora_pub_follower_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pill_based_home_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pub_featuring_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"skip_fs_cache_user_vals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cache_less_following_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_autorefresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_c","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_lists_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"textshots_userid","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"num_post_bottom_responses_to_show","valueType":{"__typename":"VariantFlagString","value":"3"}},{"__typename":"VariantFlag","name":"enable_susi_redesign_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_topic_portals","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_custom_moc_preview_for_google_referrer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_create_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_monthly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_inline_comments","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_homepage","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_new_stripe_customers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_aggregator_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_programming","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier_badge","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_native","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"onboarding_tags_from_top_views","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_susi_redesign_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_iceland_forced_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses_input","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"mobile_custom_app_icon","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_paywall_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_bottom_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"enable_android_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_group_gifting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_postpage_banners","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_continue_this_thread","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creator_welcome_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_seamless_social_sharing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_premium_plan","valueType":{"__typename":"VariantFlagString","value":"4a442ace1476"}},{"__typename":"VariantFlag","name":"enable_diversification_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recommended_publishers_query","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_first_story","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_syntax_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rex_reading_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_see_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cancellation_discount_v1_1","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_track_user_interactions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_eventstats_event_processing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_response_markup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_speechify_widget","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_entities_to_follow_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_moc_load_processor_all_recs_surfaces","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"get_highlights_from_engagement","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"reengagement_notification_duration","valueType":{"__typename":"VariantFlagNumber","value":3}},{"__typename":"VariantFlag","name":"enable_new_manage_membership_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_editor_new_publishing_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_homepage_featured_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium2_kbfd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deprecate_legacy_providers_v3","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_friend_links_creation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_user_follows","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"enable_ios_easy_resubscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_archive_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sprig","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_verified_book_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_monthly_premium_plan","valueType":{"__typename":"VariantFlagString","value":"12a660186432"}},{"__typename":"VariantFlag","name":"reader_fair_distribution_non_qp","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_partner_program_enrollment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_hybrid_ranking_model","valueType":{"__typename":"VariantFlagString","value":"experiment"}},{"__typename":"VariantFlag","name":"enable_recaptcha_enterprise","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_miro_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_avatar_upload","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_rating_prompt_stories_read_threshold","valueType":{"__typename":"VariantFlagNumber","value":2}},{"__typename":"VariantFlag","name":"android_dense_post_preview","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_user_profile_nofollow_attribute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound-source-serif-pro"}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_home_post_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_receive_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_recirc_model","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_verifications_service","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_two_hour_refresh","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_boost_experiment","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_tipping_v0_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards_byline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_members_only_audio","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pub_featuring","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trust_service_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_updated_pub_recs_ui","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_medium_com_canonical_urls","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pre_pp_v4","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_social_share_sheet","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_conversion_model_v2","valueType":{"__typename":"VariantFlagString","value":"group_2"}},{"__typename":"VariantFlag","name":"enable_conversion_ranker_v2","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_story_page_nofollow_meta_tag","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_abandoned_cart_promotion_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_simplified_digest_v2_b","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_legacy_feed_in_iceland","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipping_v0_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_verified_author","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ranker_v10","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"enable_update_explore_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_remove_twitter_onboarding_step","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"rex_generator_max_candidates","valueType":{"__typename":"VariantFlagNumber","value":1000}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_offline_reading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_apple_pay","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sharer_validate_post_share_key","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_programming_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_intrinsic_automatic_actions","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_dynamic_paywall_aspiriational","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pub_featuring_post_page_label","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_display_paywall_after_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_iceland_nux","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"enable_post_publish_permission_check","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"goliath_externalsearch_enable_comment_deindexation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"price_smoke_test_yearly","valueType":{"__typename":"VariantFlagString","value":""}},{"__typename":"VariantFlag","name":"enable_tag_recs","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_follow_on_subscribe","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_deviant_get_variant_flag_from_medium2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_switch_plan_premium_tier","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_update_topic_portals_wtf","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"android_enable_image_sharer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_trial_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_maim_the_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_configure_pronouns","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"can_send_tips_v0","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_client","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mastodon_for_members_username_selection","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_engagement_service_publish_response","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_rex_pub_featuring_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_dynamic_aspirational_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_author_cards","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_pub_featuring_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"redefined_top_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"collectionByDomainOrSlug({\"domainOrSlug\":\"towardsaws.com\"})":{"__ref":"Collection:5da0267791b1"},"viewer":null,"postResult({\"id\":\"a334ac50619a\"})":{"__ref":"Post:a334ac50619a"}},"ImageMetadata:1*jFctRm8LcWg99f9htwwAsg.png":{"__typename":"ImageMetadata","id":"1*jFctRm8LcWg99f9htwwAsg.png"},"Collection:5da0267791b1":{"__typename":"Collection","id":"5da0267791b1","favicon":{"__ref":"ImageMetadata:1*jFctRm8LcWg99f9htwwAsg.png"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFEDF3FF","point":0},{"__typename":"ColorPoint","color":"#FFEAF1FF","point":0.1},{"__typename":"ColorPoint","color":"#FFE7F0FF","point":0.2},{"__typename":"ColorPoint","color":"#FFE3EEFF","point":0.3},{"__typename":"ColorPoint","color":"#FFE0ECFF","point":0.4},{"__typename":"ColorPoint","color":"#FFDCEBFF","point":0.5},{"__typename":"ColorPoint","color":"#FFD9E9FF","point":0.6},{"__typename":"ColorPoint","color":"#FFD5E7FF","point":0.7},{"__typename":"ColorPoint","color":"#FFD2E6FF","point":0.8},{"__typename":"ColorPoint","color":"#FFCEE4FF","point":0.9},{"__typename":"ColorPoint","color":"#FFCBE2FF","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF6987B8","point":0},{"__typename":"ColorPoint","color":"#FF637EA9","point":0.1},{"__typename":"ColorPoint","color":"#FF5D749B","point":0.2},{"__typename":"ColorPoint","color":"#FF566A8C","point":0.3},{"__typename":"ColorPoint","color":"#FF4E607D","point":0.4},{"__typename":"ColorPoint","color":"#FF46566F","point":0.5},{"__typename":"ColorPoint","color":"#FF3E4B60","point":0.6},{"__typename":"ColorPoint","color":"#FF354051","point":0.7},{"__typename":"ColorPoint","color":"#FF2C3442","point":0.8},{"__typename":"ColorPoint","color":"#FF222832","point":0.9},{"__typename":"ColorPoint","color":"#FF161A21","point":1}]},"tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF001E4B","colorPoints":[{"__typename":"ColorPoint","color":"#FF001E4B","point":0},{"__typename":"ColorPoint","color":"#FF243D66","point":0.1},{"__typename":"ColorPoint","color":"#FF41587D","point":0.2},{"__typename":"ColorPoint","color":"#FF5B7092","point":0.3},{"__typename":"ColorPoint","color":"#FF7487A6","point":0.4},{"__typename":"ColorPoint","color":"#FF8C9CB8","point":0.5},{"__typename":"ColorPoint","color":"#FFA3B1CA","point":0.6},{"__typename":"ColorPoint","color":"#FFB9C5DA","point":0.7},{"__typename":"ColorPoint","color":"#FFCFD8EA","point":0.8},{"__typename":"ColorPoint","color":"#FFE5EBF9","point":0.9},{"__typename":"ColorPoint","color":"#FFFAFEFF","point":1}]}},"domain":"towardsaws.com","slug":"towards-aws","googleAnalyticsId":null,"name":"Towards AWS","avatar":{"__ref":"ImageMetadata:1*H7nXs2clXxnWZeKjcW17Tg.png"},"description":"Where Cloud Experts, Heroes, Builders, and Developers share their stories, experiences, and solutions.","subscriberCount":7519,"latestPostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:7f2e75b12844"}]},"isAuroraVisible":false,"tintColor":"#FF001E4B","newsletterV3":{"__ref":"NewsletterV3:1b4bd5fad7d7"},"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:5da0267791b1-viewerId:lo_aad13bbcb0ea"},"twitterUsername":"TowardsAws","facebookPageId":null,"logo":{"__ref":"ImageMetadata:"}},"ImageMetadata:1*H7nXs2clXxnWZeKjcW17Tg.png":{"__typename":"ImageMetadata","id":"1*H7nXs2clXxnWZeKjcW17Tg.png"},"User:a524c9348ae2":{"__typename":"User","id":"a524c9348ae2","customDomainState":null,"hasSubdomain":false,"username":"donkaluarachchi"},"Post:7f2e75b12844":{"__typename":"Post","id":"7f2e75b12844","firstPublishedAt":1742889933445,"creator":{"__ref":"User:a524c9348ae2"},"collection":{"__ref":"Collection:5da0267791b1"},"isSeries":false,"mediumUrl":"https:\u002F\u002Ftowardsaws.com\u002Fthe-underestimated-power-of-personalized-recommendations-7f2e75b12844","sequence":null,"uniqueSlug":"the-underestimated-power-of-personalized-recommendations-7f2e75b12844"},"NewsletterV3:1b4bd5fad7d7":{"__typename":"NewsletterV3","id":"1b4bd5fad7d7"},"LinkedAccounts:9284dc7b6da6":{"__typename":"LinkedAccounts","mastodon":null,"id":"9284dc7b6da6"},"User:9284dc7b6da6":{"__typename":"User","id":"9284dc7b6da6","linkedAccounts":{"__ref":"LinkedAccounts:9284dc7b6da6"},"isSuspended":false,"name":"Pavel Shabarkin","imageId":"1*au7aS6ukZ6IIWNBSKcCk8Q.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"shabarkin.medium.com"}},"hasSubdomain":true,"username":"shabarkin","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":109,"followingCount":15,"collectionFollowingCount":6},"bio":"From zero to one in Security and Deep Learning https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fpavel-shabarkin-b99a31145\u002F","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:9284dc7b6da6-viewerId:lo_aad13bbcb0ea"},"twitterScreenName":""},"Paragraph:e9b421a5a1d_0":{"__typename":"Paragraph","id":"e9b421a5a1d_0","name":"9a73","type":"H3","href":null,"layout":null,"metadata":null,"text":"Pointer: Hunting Cobalt Strike globally","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_1":{"__typename":"Paragraph","id":"e9b421a5a1d_1","name":"81f7","type":"H3","href":null,"layout":null,"metadata":null,"text":"Introduction","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_2":{"__typename":"Paragraph","id":"e9b421a5a1d_2","name":"61b2","type":"P","href":null,"layout":null,"metadata":null,"text":"Cobalt Strike is a commercial, full-featured, remote access tool that bills itself as “adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat actors”. Cobalt Strike’s interactive post-exploit capabilities cover the full range of ATT&CK tactics, all executed within a single, integrated system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_3":{"__typename":"Paragraph","id":"e9b421a5a1d_3","name":"4bd9","type":"P","href":null,"layout":null,"metadata":null,"text":"In addition to its own capabilities, Cobalt Strike leverages the capabilities of other well-known tools such as Metasploit and Mimikatz.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_4":{"__typename":"Paragraph","id":"e9b421a5a1d_4","name":"aa9c","type":"P","href":null,"layout":null,"metadata":null,"text":"Cobalt Strike is a legitimate security tool used by penetration testers and red teamers to emulate threat actor activity in a network. However, lately, this tool has been hijacked and abused by cybercriminals.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_5":{"__typename":"Paragraph","id":"e9b421a5a1d_5","name":"31e6","type":"P","href":null,"layout":null,"metadata":null,"text":"Our goal was to develop a tool to help identify default Cobalt Strike servers exposed on the Internet. We strongly believe that understanding and mapping adversaries and their use of Cobalt Strike can improve defenses and boost organization detection & response controls. Blocking, mapping and tracking adversaries is a good start.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*l9j-JLGriA0FMQjju7BByg.png":{"__typename":"ImageMetadata","id":"1*l9j-JLGriA0FMQjju7BByg.png","originalHeight":3300,"originalWidth":5504,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_6":{"__typename":"Paragraph","id":"e9b421a5a1d_6","name":"3a53","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*l9j-JLGriA0FMQjju7BByg.png"},"text":"Pointer logo","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_7":{"__typename":"Paragraph","id":"e9b421a5a1d_7","name":"1920","type":"H4","href":null,"layout":null,"metadata":null,"text":"Tool Development","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_8":{"__typename":"Paragraph","id":"e9b421a5a1d_8","name":"96a8","type":"P","href":null,"layout":null,"metadata":null,"text":"A review of existing Cobalt Strike detection tools and public research showed that current tools can only scan a small number of potential Cobalt Strike instances (1–5k hosts). Our goal was to increase the scanning capabilities and validate several million potential Cobalt instances in less than an hour.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_9":{"__typename":"Paragraph","id":"e9b421a5a1d_9","name":"0783","type":"P","href":null,"layout":null,"metadata":null,"text":"To achieve the above goal within a reasonable timeframe and on a small budget, it was necessary to adapt and scale the current understanding of the Cobalt Strike hunting methodology. The following content assumes an understanding of what Cobalt Strike is and how to locate and identify Cobalt strike instances. Before going into the details of the tool and their components, let’s take a look at the general architecture.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_10":{"__typename":"Paragraph","id":"e9b421a5a1d_10","name":"55f3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Architecture review","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_11":{"__typename":"Paragraph","id":"e9b421a5a1d_11","name":"ee1e","type":"P","href":null,"layout":null,"metadata":null,"text":"Scanning a large number of hosts in a reasonable amount of time does not scale and has physical, cost and power limitations. Unless you have a great home lab and the bandwidth to support it, personal computing cannot really solve the scaling problem, so the decision was made to use AWS to affordably scale and achieve the desired goals.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_12":{"__typename":"Paragraph","id":"e9b421a5a1d_12","name":"d8f4","type":"H4","href":null,"layout":null,"metadata":null,"text":"General architecture review","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_13":{"__typename":"Paragraph","id":"e9b421a5a1d_13","name":"bbd1","type":"P","href":null,"layout":null,"metadata":null,"text":"The tool is developed and heavily based on AWS SQS, Lambda and DynamoDB.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*D-xIj8UnIYtEclAP-y4wMg.png":{"__typename":"ImageMetadata","id":"1*D-xIj8UnIYtEclAP-y4wMg.png","originalHeight":1978,"originalWidth":3018,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_14":{"__typename":"Paragraph","id":"e9b421a5a1d_14","name":"f8c9","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*D-xIj8UnIYtEclAP-y4wMg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_15":{"__typename":"Paragraph","id":"e9b421a5a1d_15","name":"be37","type":"P","href":null,"layout":null,"metadata":null,"text":"The Pointer client parses the local json file with a list of IPs, optimally splits them into packets (10–20 IPs), and then adds the packets to be processed to the SQS queue.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_16":{"__typename":"Paragraph","id":"e9b421a5a1d_16","name":"bae4","type":"P","href":null,"layout":null,"metadata":null,"text":"The SQS queue is setup to invoke a lambda function for each packet in the queue. The lambda function (Pointer server) performs the actual scanning of the provided packet of IPs and saves results to DynamoDB.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_17":{"__typename":"Paragraph","id":"e9b421a5a1d_17","name":"dc21","type":"P","href":null,"layout":null,"metadata":null,"text":"In cases where Lambda fails or throws an error, packets are returned to the SQS queue and will wait for a retry.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_18":{"__typename":"Paragraph","id":"e9b421a5a1d_18","name":"0687","type":"P","href":null,"layout":null,"metadata":null,"text":"If the packet fails a second time, a new Lambda function is launched that logs the failed packet to DynamoDB for further analysis and rescan each IP individually to locate the failed IPs.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_19":{"__typename":"Paragraph","id":"e9b421a5a1d_19","name":"f46d","type":"H4","href":null,"layout":null,"metadata":null,"text":"Code Review","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_20":{"__typename":"Paragraph","id":"e9b421a5a1d_20","name":"16ff","type":"P","href":null,"layout":null,"metadata":null,"text":"The scan functionality of the “Pointer server” consists of 4 parts:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_21":{"__typename":"Paragraph","id":"e9b421a5a1d_21","name":"d05d","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Port Scanning (Port Workers)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_22":{"__typename":"Paragraph","id":"e9b421a5a1d_22","name":"b993","type":"OLI","href":null,"layout":null,"metadata":null,"text":"HTTP Webservice scan (HTTP Workers)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_23":{"__typename":"Paragraph","id":"e9b421a5a1d_23","name":"d0da","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Certificate parsing","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_24":{"__typename":"Paragraph","id":"e9b421a5a1d_24","name":"3146","type":"ULI","href":null,"layout":null,"metadata":null,"text":"JARM parsing","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_25":{"__typename":"Paragraph","id":"e9b421a5a1d_25","name":"01e3","type":"P","href":null,"layout":null,"metadata":null,"text":"3. HTTPS Webservice scan (HTTPS Workers)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_26":{"__typename":"Paragraph","id":"e9b421a5a1d_26","name":"68b7","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Beacon Parsing (Beacon Workers)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_27":{"__typename":"Paragraph","id":"e9b421a5a1d_27","name":"f163","type":"P","href":null,"layout":null,"metadata":null,"text":"The tool was designed with an asynchronous approach to IP processing. Each scan probe stands as an independent unit, which is then processed by a Worker. The probes include a port scanning, Certificate Issuer parsing, JARM parsing, webservice scanning, and Beacon parsing. Once each probe is completed, the result is sent to the corresponding controller, which writes the result to the global map. After all scan workers are done, the data is sorted and ordered before being combined into the Target structure. Overall, this reduces the number of delays since each service(ip:port) has its own scan pipeline.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":493,"end":499,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*8aDUzB3fusDAcP3m7Rf06w.png":{"__typename":"ImageMetadata","id":"1*8aDUzB3fusDAcP3m7Rf06w.png","originalHeight":1842,"originalWidth":3494,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_28":{"__typename":"Paragraph","id":"e9b421a5a1d_28","name":"5387","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8aDUzB3fusDAcP3m7Rf06w.png"},"text":"Internal architecture of Lambda function","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_29":{"__typename":"Paragraph","id":"e9b421a5a1d_29","name":"2979","type":"P","href":null,"layout":null,"metadata":null,"text":"Detailed review","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_30":{"__typename":"Paragraph","id":"e9b421a5a1d_30","name":"b1ab","type":"P","href":null,"layout":null,"metadata":null,"text":"Initially the lambda function launches Port, HTTP, HTTPS, and Beacon workers. The number of workers depends on the level of internal concurrency (Internal concurrency is the controllable CLI parameter). Each type of worker is portioned accordingly to the required power resources. Portioning has been calculated based on the number of probes each worker performs in average.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_31":{"__typename":"Paragraph","id":"e9b421a5a1d_31","name":"1386","type":"P","href":null,"layout":null,"metadata":null,"text":"Each targeted IP address is scanned for 27 predefined ports, this list includes common ports on which Cobalt Strike beacons are hosted. The “launcher” sends service (ip:port) to the Port Workers through portChannel Golang channel.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":203,"end":214,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oCMBNFDetYCKfaHhQA0lIQ.png":{"__typename":"ImageMetadata","id":"1*oCMBNFDetYCKfaHhQA0lIQ.png","originalHeight":314,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_32":{"__typename":"Paragraph","id":"e9b421a5a1d_32","name":"b2f4","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oCMBNFDetYCKfaHhQA0lIQ.png"},"text":"Code snippet of the Service Launcher","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_33":{"__typename":"Paragraph","id":"e9b421a5a1d_33","name":"90e3","type":"P","href":null,"layout":null,"metadata":null,"text":"Port workers then scan the individual ports. If a port is open, the worker sends the service to the HTTP Worker and Output controller through httpChannel and outputChannel Golang channels. If the port is closed the Port Worker exits the function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":142,"end":153,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":158,"end":171,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nLeqyMNHW6iwn7goeY3Ksw.png":{"__typename":"ImageMetadata","id":"1*nLeqyMNHW6iwn7goeY3Ksw.png","originalHeight":696,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_34":{"__typename":"Paragraph","id":"e9b421a5a1d_34","name":"f3c0","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nLeqyMNHW6iwn7goeY3Ksw.png"},"text":"Code snippet of Port Worker","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_35":{"__typename":"Paragraph","id":"e9b421a5a1d_35","name":"ad63","type":"P","href":null,"layout":null,"metadata":null,"text":"All workers send results through a single Golang channel, outputChannel, which are then processed by the output controller and saved to the global map (Sorter struct).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":58,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":152,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_36":{"__typename":"Paragraph","id":"e9b421a5a1d_36","name":"38a6","type":"P","href":null,"layout":null,"metadata":null,"text":"Each result produced by the workers has its own type tag (Ex: \"Service|\",\"Certificate|\",\"Jarm|\", … ), ensuring that the ValidateOutput function can sort the results based on their types.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":62,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":73,"end":87,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":88,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":120,"end":134,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*XwKbzyaPFjBTd-V_318mKw.png":{"__typename":"ImageMetadata","id":"1*XwKbzyaPFjBTd-V_318mKw.png","originalHeight":470,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_37":{"__typename":"Paragraph","id":"e9b421a5a1d_37","name":"f407","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XwKbzyaPFjBTd-V_318mKw.png"},"text":"Code snippet of Output Controller","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_38":{"__typename":"Paragraph","id":"e9b421a5a1d_38","name":"8739","type":"P","href":null,"layout":null,"metadata":null,"text":"The HTTP worker waits for IP and port tuple (service) to be provided by the Port Worker via the httpChannel. If the HTTP Worker receives port 50050 it attempts the following actions:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":96,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_39":{"__typename":"Paragraph","id":"e9b421a5a1d_39","name":"12f0","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Parse the certificate issuer -\u003E identifying the default self-signed Cobalt certificate","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_40":{"__typename":"Paragraph","id":"e9b421a5a1d_40","name":"fffd","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Parse the JARM signature -\u003E detecting malicious JARM signatures","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_41":{"__typename":"Paragraph","id":"e9b421a5a1d_41","name":"41c3","type":"P","href":null,"layout":null,"metadata":null,"text":"For other services, it performs a web request to analyse response behaviour. Beacon’s HTTP\u002FHTTPS indicators are controlled by a malleable C2 profile, if the server uses the default malleable C2 profile, it responds with a 404 status code and 0 content-length for requests made to the root web endpoint. (http:\u002F\u002Fdomain.com\u002F)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_42":{"__typename":"Paragraph","id":"e9b421a5a1d_42","name":"d0f7","type":"P","href":null,"layout":null,"metadata":null,"text":"If the request to the targeted web service fails, HTTP Worker sends the service through httpsChannel channel further to the HTTPS Worker to perform the web request through HTTPS protocol.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":88,"end":100,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*7iH2TEOAxL1xWWm69K7Diw.png":{"__typename":"ImageMetadata","id":"1*7iH2TEOAxL1xWWm69K7Diw.png","originalHeight":1120,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_43":{"__typename":"Paragraph","id":"e9b421a5a1d_43","name":"b35f","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*7iH2TEOAxL1xWWm69K7Diw.png"},"text":"Code snippet of the HTTP Worker","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_44":{"__typename":"Paragraph","id":"e9b421a5a1d_44","name":"ef34","type":"P","href":null,"layout":null,"metadata":null,"text":"Being inspired by the “Analyzing Cobalt Strike for Fun and Profit” research and its corresponding tool for cobalt strike beacon parsing (developed using Python), we integrated the similar logic into our tool for beacon parsing (developed using Golang).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_45":{"__typename":"Paragraph","id":"e9b421a5a1d_45","name":"46bb","type":"P","href":null,"layout":null,"metadata":null,"text":"The guy, who researched how the beacon is packed, how to parse the beacon, how to decrypt the beacon, and how to work with that in general, you did the good job a big thank you!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":177,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_46":{"__typename":"Paragraph","id":"e9b421a5a1d_46","name":"b336","type":"P","href":null,"layout":null,"metadata":null,"text":"All identified web services that have been configured with default malleable C2 profile are sent to the Beacon Workers. The Beacon Worker attempts to parse the beacon config. If the parsing succeeds, Beacon Worker sends the CobaltStrikeBeaconStruct struct to the Beacon controller through beaconStructChannel channel, and the beacon location URI to the output controller through outputChannel channel.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":224,"end":248,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":289,"end":308,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":379,"end":392,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vfQqdvtK-_zQl5mZISaCkg.png":{"__typename":"ImageMetadata","id":"1*vfQqdvtK-_zQl5mZISaCkg.png","originalHeight":828,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_47":{"__typename":"Paragraph","id":"e9b421a5a1d_47","name":"0515","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vfQqdvtK-_zQl5mZISaCkg.png"},"text":"Code snippet of Beacon Worker","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4HqlMi7DrMaWBD9MnvTVog.png":{"__typename":"ImageMetadata","id":"1*4HqlMi7DrMaWBD9MnvTVog.png","originalHeight":400,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_48":{"__typename":"Paragraph","id":"e9b421a5a1d_48","name":"b664","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4HqlMi7DrMaWBD9MnvTVog.png"},"text":"Code snippet of Beacon Controller","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_49":{"__typename":"Paragraph","id":"e9b421a5a1d_49","name":"090a","type":"P","href":null,"layout":null,"metadata":null,"text":"When all workers finish the scans, the Sort method maps all gathered scan results sent to the output controller into the array of CobaltStrikeStruct type:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":39,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":130,"end":148,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cdfxRc0GGhMZkS9jw38khA.png":{"__typename":"ImageMetadata","id":"1*cdfxRc0GGhMZkS9jw38khA.png","originalHeight":428,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_50":{"__typename":"Paragraph","id":"e9b421a5a1d_50","name":"f0e1","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cdfxRc0GGhMZkS9jw38khA.png"},"text":"Code snippet of CobaltStrikeStruct data type","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":16,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_51":{"__typename":"Paragraph","id":"e9b421a5a1d_51","name":"f9d9","type":"P","href":null,"layout":null,"metadata":null,"text":"The Probability field is assigned when the Voter function calls the internal method Vote for each CobaltStrikeStruct object within the array.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":4,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":43,"end":48,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":84,"end":88,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":98,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_52":{"__typename":"Paragraph","id":"e9b421a5a1d_52","name":"396b","type":"P","href":null,"layout":null,"metadata":null,"text":"In case the certificate issuer matches the default Cobalt Strike self-signed certificate, the Vote method gives 100% probability that it is the Cobalt Strike server. The same applies if the Beacon Worker successfully parses the beacon config hosted on the web service.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":94,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_53":{"__typename":"Paragraph","id":"e9b421a5a1d_53","name":"caa9","type":"P","href":null,"layout":null,"metadata":null,"text":"Default web service response and malicious JARM signature results cannot give us confidence in assigning the probability rate. Because other web services can respond with 0 content length and 404 status code, and servers can be configured with the same TLS options (if you don’t understand what JARM is). If the Vote method matches only those two indicators, it assigns the 70% probability to the object.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":312,"end":316,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":266,"end":302,"href":"https:\u002F\u002Fengineering.salesforce.com\u002Feasily-identify-malicious-servers-on-the-internet-with-jarm-e095edac525a","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_54":{"__typename":"Paragraph","id":"e9b421a5a1d_54","name":"4540","type":"P","href":null,"layout":null,"metadata":null,"text":"If none of these meet our requirements, it is probably not a Cobalt Strike server. But, again, this tool targets only Cobalt Strike servers with default malleable C2 profile configurations.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*BkZVI7N45LBnTaI9j4CQfA.png":{"__typename":"ImageMetadata","id":"1*BkZVI7N45LBnTaI9j4CQfA.png","originalHeight":620,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_55":{"__typename":"Paragraph","id":"e9b421a5a1d_55","name":"1a5f","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*BkZVI7N45LBnTaI9j4CQfA.png"},"text":"Code snippet of the Vote method","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_56":{"__typename":"Paragraph","id":"e9b421a5a1d_56","name":"473d","type":"H4","href":null,"layout":null,"metadata":null,"text":"DynamoDB Component","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_57":{"__typename":"Paragraph","id":"e9b421a5a1d_57","name":"09d0","type":"P","href":null,"layout":null,"metadata":null,"text":"We chose DynamoDB service to store scan results. DynamoDB can handle more than 10 trillion requests per day and support peaks of more than 20 million requests per second. That is what we needed 100%! We wanted to scan 20000–25000 targets per 60 seconds, which is about 40k-50k writing requests to the database.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_58":{"__typename":"Paragraph","id":"e9b421a5a1d_58","name":"f390","type":"P","href":null,"layout":null,"metadata":null,"text":"On the first implementation, the Output and Beacon workers exceeded DynamoDB rate limits because they performed a write request to the DynamoDB table for each target object separately, and, in addition, we used the default DynamoDB configuration. The default capacity configuration could not handle that many requests, but by increasing the capacity we would pay more money for autoscaling during constant scanning. Further examination of the AWS documentation revealed that AWS had implemented the batch write to DynamoDB. For each lambda invocation, we have 10–20 targets (depending on the packet size) to scan, so this should reduce the number of requests to DynamoDB tables by a factor of 10–20.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_59":{"__typename":"Paragraph","id":"e9b421a5a1d_59","name":"dc67","type":"P","href":null,"layout":null,"metadata":null,"text":"We found that DynamoDB’s BatchWriteItemInput function allows writing up to 25 items and up to 16 Mb in one request. The batch write implementation significantly decreased the number of requests and removed the rate limiting issue at the default configuration level. We did not have to pay for unnecessary autoscaling.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":25,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_60":{"__typename":"Paragraph","id":"e9b421a5a1d_60","name":"6ba7","type":"P","href":null,"layout":null,"metadata":null,"text":"This method has the disadvantage that if one of the items in the batch fails to be written, the whole batch will not be saved. (The partition key must be unique and not exist in the table, but this is suitable in our case, as we filter our targets by unique values before launching the scans).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*cZe84GD2-P0ILzLpPJKVtQ.png":{"__typename":"ImageMetadata","id":"1*cZe84GD2-P0ILzLpPJKVtQ.png","originalHeight":1042,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_61":{"__typename":"Paragraph","id":"e9b421a5a1d_61","name":"efa5","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*cZe84GD2-P0ILzLpPJKVtQ.png"},"text":"Code snippet of the WriteBatchTarget function","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_62":{"__typename":"Paragraph","id":"e9b421a5a1d_62","name":"84cc","type":"P","href":null,"layout":null,"metadata":null,"text":"Also, for unpredictable cases where the default capacity configuration cannot handle a large number of requests, we configure autoscaling:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_63":{"__typename":"Paragraph","id":"e9b421a5a1d_63","name":"f474","type":"P","href":null,"layout":null,"metadata":null,"text":"AWS Console → DynamoDB → choose the Table → Edit Capacity → Read \u002F Write Capacity increase to 10–15. To enable autoscaling we should give the required permissions for the DynamoDB service role .","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_64":{"__typename":"Paragraph","id":"e9b421a5a1d_64","name":"4c5a","type":"H4","href":null,"layout":null,"metadata":null,"text":"Lambda Component","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_65":{"__typename":"Paragraph","id":"e9b421a5a1d_65","name":"2e84","type":"P","href":null,"layout":null,"metadata":null,"text":"AWS Lambda is an interesting service. We wanted to try Lambda as a core service for our scans, however we did not want to get a crazy paycheck at the end of the month, so we had several things to figure out:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_66":{"__typename":"Paragraph","id":"e9b421a5a1d_66","name":"bcc4","type":"OLI","href":null,"layout":null,"metadata":null,"text":"How much memory to allocate for Lambda execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_67":{"__typename":"Paragraph","id":"e9b421a5a1d_67","name":"c439","type":"OLI","href":null,"layout":null,"metadata":null,"text":"What default timeout to set for Lambda execution","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_68":{"__typename":"Paragraph","id":"e9b421a5a1d_68","name":"7254","type":"OLI","href":null,"layout":null,"metadata":null,"text":"How to manage Lambda concurrency","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_69":{"__typename":"Paragraph","id":"e9b421a5a1d_69","name":"d759","type":"OLI","href":null,"layout":null,"metadata":null,"text":"What internal concurrency would be suited for our model;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_70":{"__typename":"Paragraph","id":"e9b421a5a1d_70","name":"bc29","type":"OLI","href":null,"layout":null,"metadata":null,"text":"What request timeouts would be suited for our model","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_71":{"__typename":"Paragraph","id":"e9b421a5a1d_71","name":"ebdf","type":"OLI","href":null,"layout":null,"metadata":null,"text":"What packet size would be suited for our model","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_72":{"__typename":"Paragraph","id":"e9b421a5a1d_72","name":"cfb7","type":"P","href":null,"layout":null,"metadata":null,"text":"And the most difficult question — How to setup everything the way it would be efficient, cheap, and with minimum loss rate?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_73":{"__typename":"Paragraph","id":"e9b421a5a1d_73","name":"caa1","type":"P","href":null,"layout":null,"metadata":null,"text":"Lambda memory allocation","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_74":{"__typename":"Paragraph","id":"e9b421a5a1d_74","name":"7bba","type":"P","href":null,"layout":null,"metadata":null,"text":"It was interesting to research how AWS allocates memory and CPU for Lambda functions, because it is physically impossible to divide 1\u002F10 of the CPU. But it can allocate 1\u002F10 of the time of the CPU to a single function, and you can have 10 of them working at the same time to share the same CPU core (check this research, it explains how AWS Lambda allocates CPU).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":300,"end":361,"href":"https:\u002F\u002Fengineering.opsgenie.com\u002Fhow-does-proportional-cpu-allocation-work-with-aws-lambda-41cd44da3cac","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_75":{"__typename":"Paragraph","id":"e9b421a5a1d_75","name":"0649","type":"P","href":null,"layout":null,"metadata":null,"text":"The only controllable parameter in AWS for Lambda functions is memory usage:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*vnFFoWHJEh1-sNf15Gl_qA.png":{"__typename":"ImageMetadata","id":"1*vnFFoWHJEh1-sNf15Gl_qA.png","originalHeight":284,"originalWidth":2212,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_76":{"__typename":"Paragraph","id":"e9b421a5a1d_76","name":"947b","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*vnFFoWHJEh1-sNf15Gl_qA.png"},"text":"Example of the memory configuration in AWS Console","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_77":{"__typename":"Paragraph","id":"e9b421a5a1d_77","name":"91c9","type":"P","href":null,"layout":null,"metadata":null,"text":"We designed our model with a multithreaded architecture — the more cores we have, the better performance we can potentially obtain. But the nasty thing here is what the price of this luxury is.)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_78":{"__typename":"Paragraph","id":"e9b421a5a1d_78","name":"eccb","type":"P","href":null,"layout":null,"metadata":null,"text":"We cannot directly control the number of cores we want to use. The CPU performance scales with the memory configuration. Lambda functions used to always have 2 vCPU cores, regardless of the allocated memory. The rest of the cores are throttled at certain memory configurations. By increasing the memory allocation, we obtain more cores. I found the research that discovered how the number of vCPUs and multithreaded computation power vary depending on the memory configuration.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":349,"end":357,"href":"https:\u002F\u002Fwww.sentiatechblog.com\u002Faws-re-invent-2020-day-3-optimizing-lambda-cost-with-multi-threading","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_79":{"__typename":"Paragraph","id":"e9b421a5a1d_79","name":"8f07","type":"P","href":null,"layout":null,"metadata":null,"text":"The price for using the AWS Lambda function is based on the function runtime (in milliseconds) multiplied by the allocated memory (fixed prices per Mb). So, allocating 3008MB for the Lambda function, we get 2 vCPUs, and allocating 3009MB we get 3vCPUs. By allocating 3009MB memory, we could gain more performance, at almost the same price.)))","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_80":{"__typename":"Paragraph","id":"e9b421a5a1d_80","name":"2e2b","type":"P","href":null,"layout":null,"metadata":null,"text":"According to the research, we get better performance gain for multithreading with each spike transition (jump in cores). But for our model we do not need more than 3 cores, 3009MB is enough for our purposes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VvwYpHhd3gyyyj2B1XGFdw.png":{"__typename":"ImageMetadata","id":"1*VvwYpHhd3gyyyj2B1XGFdw.png","originalHeight":402,"originalWidth":334,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_81":{"__typename":"Paragraph","id":"e9b421a5a1d_81","name":"4c3f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VvwYpHhd3gyyyj2B1XGFdw.png"},"text":"Correlation between Lambda memory configuration and number of cores","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_82":{"__typename":"Paragraph","id":"e9b421a5a1d_82","name":"6102","type":"P","href":null,"layout":null,"metadata":null,"text":"By the way, we decided to measure the computational power ourselves, and the practical tests showed that the power spike between 3008–3009 MB is bigger than between 5307–5308 MB. This once again confirms that the 3009MB memory configuration is the best choice for us.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*nGbmjJoDhDIgqnpooDUIBw.png":{"__typename":"ImageMetadata","id":"1*nGbmjJoDhDIgqnpooDUIBw.png","originalHeight":1616,"originalWidth":2202,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_83":{"__typename":"Paragraph","id":"e9b421a5a1d_83","name":"bb9b","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*nGbmjJoDhDIgqnpooDUIBw.png"},"text":"Code snippet for measuring the multithreaded computation power","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_84":{"__typename":"Paragraph","id":"e9b421a5a1d_84","name":"8b6d","type":"P","href":null,"layout":null,"metadata":null,"text":"Internal parameter tuning","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":25,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_85":{"__typename":"Paragraph","id":"e9b421a5a1d_85","name":"d054","type":"P","href":null,"layout":null,"metadata":null,"text":"As we got a solid understanding of how many resources to use, we started tuning and suiting other parameters for our model.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_86":{"__typename":"Paragraph","id":"e9b421a5a1d_86","name":"29ba","type":"P","href":null,"layout":null,"metadata":null,"text":"In my opinion, the lifetime of the Pointer lambda function should not be more than 60 seconds, because otherwise it will not be a true server-less tool with easy management, stable to errors and autoscaled architecture.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_87":{"__typename":"Paragraph","id":"e9b421a5a1d_87","name":"37e6","type":"P","href":null,"layout":null,"metadata":null,"text":"With a memory configuration of 3009 Mb and a default timeout of 60 seconds for one Lambda execution, we could scan from 10–20 targets in a single packet.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_88":{"__typename":"Paragraph","id":"e9b421a5a1d_88","name":"1ccd","type":"P","href":null,"layout":null,"metadata":null,"text":"In case the lambda execution fails, we do not want to rescan all the targets inside the packet again. By having less number of targets in the packet, we minimize the probability that the packet will be crashed. Therefore, the optimal size, in my opinion, is 10–20 targets.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_89":{"__typename":"Paragraph","id":"e9b421a5a1d_89","name":"cffa","type":"P","href":null,"layout":null,"metadata":null,"text":"By having less number of targets inside the packet, we are minimising the chance that the packet will be crashed. In case the lambda execution fails, we must rescan all targets inside the packet (even those that have been successfully scanned).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_90":{"__typename":"Paragraph","id":"e9b421a5a1d_90","name":"8c2a","type":"P","href":null,"layout":null,"metadata":null,"text":"When we defined lambda configuration parameters, the rest of the parameters were tuned with a big number of tests:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_91":{"__typename":"Paragraph","id":"e9b421a5a1d_91","name":"0434","type":"PRE","href":null,"layout":null,"metadata":null,"text":"Targets\u002Fper packet  20    (Items)\nConcurrency         140   (Items)\nLambda Memory       3009  (Mb)\nLambda Timeout      60    (sec)\nHttp timeout        4     (sec)\nPort timeout        2     (sec)\nBeacon timeout      10    (sec)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":0,"end":226,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_92":{"__typename":"Paragraph","id":"e9b421a5a1d_92","name":"4143","type":"P","href":null,"layout":null,"metadata":null,"text":"Lambda Concurrency","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_93":{"__typename":"Paragraph","id":"e9b421a5a1d_93","name":"db67","type":"P","href":null,"layout":null,"metadata":null,"text":"AWS Lambda provides autoscaling for function instances. But we simply cannot deploy as many instances as we want. We are limited by the AWS region quota (All the lambda functions of an account can use the pool of 1000 unreserved concurrent executions). Thus, having only 1 deployed function, we could get 1000 concurrent executions at the same time.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":154,"end":250,"href":"https:\u002F\u002Fdocs.aws.amazon.com\u002Flambda\u002Flatest\u002Fdg\u002Fconfiguration-concurrency.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_94":{"__typename":"Paragraph","id":"e9b421a5a1d_94","name":"47c7","type":"P","href":null,"layout":null,"metadata":null,"text":"Dorking potential Cobalt Strike servers through Shodan, we could retrieve around 200–300k potential targets. However, we are designing the tool to scan 2M-10M targets. For example, 2M targets is about 100k packets (20 targets per packet), which means 100k lambda function invocations. If Lambda function is invoked 100k times, the lambda puller would process only 1k requests at a time, and the rest would be just throttled. So even if we increase the AWS region quota, it will not be enough.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_95":{"__typename":"Paragraph","id":"e9b421a5a1d_95","name":"68d9","type":"P","href":null,"layout":null,"metadata":null,"text":"So the question arises — how we can manage the invocation process? The answer is simple — SQS.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_96":{"__typename":"Paragraph","id":"e9b421a5a1d_96","name":"fff5","type":"H4","href":null,"layout":null,"metadata":null,"text":"SQS Component","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_97":{"__typename":"Paragraph","id":"e9b421a5a1d_97","name":"50d3","type":"P","href":null,"layout":null,"metadata":null,"text":"Configuration","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_98":{"__typename":"Paragraph","id":"e9b421a5a1d_98","name":"fa34","type":"P","href":null,"layout":null,"metadata":null,"text":"Amazon Simple Queue Service (SQS) is a fully managed message queuing service that enables you to decouple and scale microservices, distributed systems, and serverless applications. This means we can send all our packets to the queue and SQS will manage the process of lambda invocation. The SQS management can be configured according to our needs:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_99":{"__typename":"Paragraph","id":"e9b421a5a1d_99","name":"5318","type":"OLI","href":null,"layout":null,"metadata":null,"text":"We can control the number of retries.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_100":{"__typename":"Paragraph","id":"e9b421a5a1d_100","name":"2e59","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We can configure the maximum number of retries the SQS would perform, if the batch of messages(packets) fails","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_101":{"__typename":"Paragraph","id":"e9b421a5a1d_101","name":"9280","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The SQS sends messages packed in the batches, we can control the number of messages inside the batch we want to pass to the Lambda function, so having 1 message in the batch will equal 1 message.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_102":{"__typename":"Paragraph","id":"e9b421a5a1d_102","name":"1f0e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"In our model we decided that If message fails more than once, it would be sent to the Dead-Letter-Queue (DLQ). We designed the Dead-Letter-Queue (DLQ) to redirect the failed messages to the Lambda function with the same logic as the core one, but before scanning activities it writes the the failed packet to the DynamoDB table and rescans each target separately.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":86,"end":103,"href":"https:\u002F\u002Fdata.solita.fi\u002Flessons-learned-from-combining-sqs-and-lambda-in-a-data-project\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"A","start":127,"end":144,"href":"https:\u002F\u002Fdata.solita.fi\u002Flessons-learned-from-combining-sqs-and-lambda-in-a-data-project\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_103":{"__typename":"Paragraph","id":"e9b421a5a1d_103","name":"825b","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Visibility timeout","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_104":{"__typename":"Paragraph","id":"e9b421a5a1d_104","name":"5a1a","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The visibility timeout sets the length of time that a message received from the queue (by one lambda function) will not be visible to the lambda function again. If the lambda function fails to process and delete the message before the visibility timeout expires, the message becomes visible to the lambda function again.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_105":{"__typename":"Paragraph","id":"e9b421a5a1d_105","name":"3142","type":"P","href":null,"layout":null,"metadata":null,"text":"3. SQS batch size","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_106":{"__typename":"Paragraph","id":"e9b421a5a1d_106","name":"6317","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We configured SQS batch size to a single message.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_107":{"__typename":"Paragraph","id":"e9b421a5a1d_107","name":"8e90","type":"P","href":null,"layout":null,"metadata":null,"text":"SQS & Lambda autoscaling","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_108":{"__typename":"Paragraph","id":"e9b421a5a1d_108","name":"f3b4","type":"P","href":null,"layout":null,"metadata":null,"text":"For standard queues, Lambda uses long polling to poll the queue until it becomes active. When messages are available, Lambda reads up to 5 batches and sends them to our lambda function. If messages are still available, Lambda increases the number of processes that read batches up to 60 more instances per minute. The maximum number of batches that can be processed simultaneously by event source mapping is 1000. This means that the full power we can get after 16 minutes of continuous scanning.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_109":{"__typename":"Paragraph","id":"e9b421a5a1d_109","name":"ec13","type":"H3","href":null,"layout":null,"metadata":null,"text":"Results","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_110":{"__typename":"Paragraph","id":"e9b421a5a1d_110","name":"9545","type":"P","href":null,"layout":null,"metadata":null,"text":"At the first launch, when we ran a scan for 160k targets, we were able to identify 1,700 Cobalt Strike servers and parse 1,400 of their beacon configurations within 40 minutes. The Pointer tool can produce best performance results if the target size exceeds 500k. Scanning 160k targets took a little longer because 1000 concurrent lambda executions were achieved only after 30 minutes when the tool was launched. For the current implementation, the cost of scanning 250k targets is about 20$, however we are looking for a solution that will make it cheaper.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_111":{"__typename":"Paragraph","id":"e9b421a5a1d_111","name":"5feb","type":"H4","href":null,"layout":null,"metadata":null,"text":"Targets table [sample]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_112":{"__typename":"Paragraph","id":"e9b421a5a1d_112","name":"c10d","type":"P","href":null,"layout":null,"metadata":null,"text":"We have developed 2 tables, first one for identified Cobalt Strike servers, and the second for parsed beacon configurations. Identified Cobalt Strike servers can be described by 7 features:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_113":{"__typename":"Paragraph","id":"e9b421a5a1d_113","name":"a84e","type":"ULI","href":null,"layout":null,"metadata":null,"text":"IP address is a unique sorting key","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_114":{"__typename":"Paragraph","id":"e9b421a5a1d_114","name":"aa64","type":"ULI","href":null,"layout":null,"metadata":null,"text":"probability that it’s the actual cobalt strike server (easier filtering)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_115":{"__typename":"Paragraph","id":"e9b421a5a1d_115","name":"1e1f","type":"ULI","href":null,"layout":null,"metadata":null,"text":"JARM signature","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_116":{"__typename":"Paragraph","id":"e9b421a5a1d_116","name":"a92d","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Certificate Issuer","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_117":{"__typename":"Paragraph","id":"e9b421a5a1d_117","name":"cf86","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Opened Ports","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_118":{"__typename":"Paragraph","id":"e9b421a5a1d_118","name":"3ba7","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Response behaviour","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_119":{"__typename":"Paragraph","id":"e9b421a5a1d_119","name":"9721","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Links to the beacon configurations that we parsed and saved to another table","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_120":{"__typename":"Paragraph","id":"e9b421a5a1d_120","name":"7442","type":"P","href":null,"layout":null,"metadata":null,"text":"There is an example of the cobalt strike server table:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*YpC9KUZ0vNoeBiguSOSzmA.png":{"__typename":"ImageMetadata","id":"1*YpC9KUZ0vNoeBiguSOSzmA.png","originalHeight":596,"originalWidth":3950,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_121":{"__typename":"Paragraph","id":"e9b421a5a1d_121","name":"f7f6","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*YpC9KUZ0vNoeBiguSOSzmA.png"},"text":"Table of parsed Cobalt Strike targets","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_122":{"__typename":"Paragraph","id":"e9b421a5a1d_122","name":"5999","type":"H4","href":null,"layout":null,"metadata":null,"text":"Beacons table [sample]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":22,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_123":{"__typename":"Paragraph","id":"e9b421a5a1d_123","name":"aa21","type":"P","href":null,"layout":null,"metadata":null,"text":"The Beacon configuration table has the uri feature as a unique sorting key, when the rest of the features are the actual parsed beacon configurations.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":39,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_124":{"__typename":"Paragraph","id":"e9b421a5a1d_124","name":"b0ab","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is an example of the table with parsed beacon configurations:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*FuFGM2cnkWcya3zz-tg-wQ.png":{"__typename":"ImageMetadata","id":"1*FuFGM2cnkWcya3zz-tg-wQ.png","originalHeight":1740,"originalWidth":5046,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_125":{"__typename":"Paragraph","id":"e9b421a5a1d_125","name":"fa41","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*FuFGM2cnkWcya3zz-tg-wQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_126":{"__typename":"Paragraph","id":"e9b421a5a1d_126","name":"86c7","type":"P","href":null,"layout":null,"metadata":null,"text":"The full version of tables you can find here:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_127":{"__typename":"Paragraph","id":"e9b421a5a1d_127","name":"fe48","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Spreadsheet with 1709 Cobalt Strike servers","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":43,"href":"https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F1akSzGDq8ddn97rNfr7BS0w2HcoR52ircFaSMh-OEjTU\u002Fedit#gid=311496774","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_128":{"__typename":"Paragraph","id":"e9b421a5a1d_128","name":"d663","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Spreadsheet with 1473 Beacon configurations","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":43,"href":"https:\u002F\u002Fdocs.google.com\u002Fspreadsheets\u002Fd\u002F1akSzGDq8ddn97rNfr7BS0w2HcoR52ircFaSMh-OEjTU\u002Fedit#gid=216476235","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_129":{"__typename":"Paragraph","id":"e9b421a5a1d_129","name":"0aba","type":"H4","href":null,"layout":null,"metadata":null,"text":"Data analysis","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_130":{"__typename":"Paragraph","id":"e9b421a5a1d_130","name":"0e11","type":"P","href":null,"layout":null,"metadata":null,"text":"We are using collected data to map attackers infrastructure and understand how the attackers operate Cobalt Strike.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_131":{"__typename":"Paragraph","id":"e9b421a5a1d_131","name":"8495","type":"P","href":null,"layout":null,"metadata":null,"text":"We know that threat intelligence groups are tracking specific ransomware groups with the help of Watermarks, For example:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_132":{"__typename":"Paragraph","id":"e9b421a5a1d_132","name":"4273","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Sodinokibi (Watermark 452436291)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_133":{"__typename":"Paragraph","id":"e9b421a5a1d_133","name":"dc00","type":"ULI","href":null,"layout":null,"metadata":null,"text":"APT 27 (Watermark 305419896).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_134":{"__typename":"Paragraph","id":"e9b421a5a1d_134","name":"4929","type":"P","href":null,"layout":null,"metadata":null,"text":"Based on the beacon’s spawnto locations the blue teams can develop detection controls.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":22,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*c-u159aiTxJ3Lg-CDx61CA.png":{"__typename":"ImageMetadata","id":"1*c-u159aiTxJ3Lg-CDx61CA.png","originalHeight":1484,"originalWidth":2264,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_135":{"__typename":"Paragraph","id":"e9b421a5a1d_135","name":"0e70","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*c-u159aiTxJ3Lg-CDx61CA.png"},"text":"Location of servers (IP) (Hosting provides)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5-0J7Ab77A-rb5QEyCQWSQ.png":{"__typename":"ImageMetadata","id":"1*5-0J7Ab77A-rb5QEyCQWSQ.png","originalHeight":1484,"originalWidth":2264,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_136":{"__typename":"Paragraph","id":"e9b421a5a1d_136","name":"d43e","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5-0J7Ab77A-rb5QEyCQWSQ.png"},"text":"Watermarks","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*rqzOA2U4HCIcUHdkaiFy1g.png":{"__typename":"ImageMetadata","id":"1*rqzOA2U4HCIcUHdkaiFy1g.png","originalHeight":1484,"originalWidth":2264,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_137":{"__typename":"Paragraph","id":"e9b421a5a1d_137","name":"7ee0","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*rqzOA2U4HCIcUHdkaiFy1g.png"},"text":"Countries","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0Y4jfPkb3BWQlh2LSJyHvQ.png":{"__typename":"ImageMetadata","id":"1*0Y4jfPkb3BWQlh2LSJyHvQ.png","originalHeight":1484,"originalWidth":2264,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_138":{"__typename":"Paragraph","id":"e9b421a5a1d_138","name":"e652","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0Y4jfPkb3BWQlh2LSJyHvQ.png"},"text":"Spawn location","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2qVJCh6ie_tRztaTMtnMmw.png":{"__typename":"ImageMetadata","id":"1*2qVJCh6ie_tRztaTMtnMmw.png","originalHeight":836,"originalWidth":1768,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:e9b421a5a1d_139":{"__typename":"Paragraph","id":"e9b421a5a1d_139","name":"a3b0","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2qVJCh6ie_tRztaTMtnMmw.png"},"text":"Sample of the Dork database (not completed)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_140":{"__typename":"Paragraph","id":"e9b421a5a1d_140","name":"6a50","type":"H3","href":null,"layout":null,"metadata":null,"text":"Summary & Future work","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_141":{"__typename":"Paragraph","id":"e9b421a5a1d_141","name":"2161","type":"P","href":null,"layout":null,"metadata":null,"text":"For the first Pointer version, we have developed a system with a complete hunting methodology that could be easily scalable up to 2–3 millions targets.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_142":{"__typename":"Paragraph","id":"e9b421a5a1d_142","name":"a750","type":"P","href":null,"layout":null,"metadata":null,"text":"The first tests showed that the tool can scan 200k targets in 45–50 minutes with 10% packet loss. We strongly believe that we have taken a big step in hunting and detection system.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_143":{"__typename":"Paragraph","id":"e9b421a5a1d_143","name":"6bf4","type":"P","href":null,"layout":null,"metadata":null,"text":"But, of course, we have not achieved the results we wanted, this is just the first demo version of the Pointer.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_144":{"__typename":"Paragraph","id":"e9b421a5a1d_144","name":"b926","type":"P","href":null,"layout":null,"metadata":null,"text":"Any feedback is more than welcome and if you have any ideas, suggestions, and recommendations, or if you want to help us improve the Cobalt Strike Hunting tool, just contact Pavel Shabarkin and Michael Koczwara.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_145":{"__typename":"Paragraph","id":"e9b421a5a1d_145","name":"51a7","type":"H3","href":null,"layout":null,"metadata":null,"text":"References","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_146":{"__typename":"Paragraph","id":"e9b421a5a1d_146","name":"4c45","type":"OLI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fattack.mitre.org\u002Fsoftware\u002FS0154\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":40,"href":"https:\u002F\u002Fattack.mitre.org\u002Fsoftware\u002FS0154\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_147":{"__typename":"Paragraph","id":"e9b421a5a1d_147","name":"4d31","type":"OLI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.randhome.io\u002Fblog\u002F2020\u002F12\u002F20\u002Fanalyzing-cobalt-strike-for-fun-and-profit\u002F","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":83,"href":"https:\u002F\u002Fwww.randhome.io\u002Fblog\u002F2020\u002F12\u002F20\u002Fanalyzing-cobalt-strike-for-fun-and-profit\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_148":{"__typename":"Paragraph","id":"e9b421a5a1d_148","name":"9123","type":"OLI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fengineering.opsgenie.com\u002Fhow-does-proportional-cpu-allocation-work-with-aws-lambda-41cd44da3cac","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":103,"href":"https:\u002F\u002Fengineering.opsgenie.com\u002Fhow-does-proportional-cpu-allocation-work-with-aws-lambda-41cd44da3cac","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:e9b421a5a1d_149":{"__typename":"Paragraph","id":"e9b421a5a1d_149","name":"df00","type":"OLI","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fdocs.aws.amazon.com\u002Flambda\u002Flatest\u002Fdg\u002Fconfiguration-concurrency.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":75,"href":"https:\u002F\u002Fdocs.aws.amazon.com\u002Flambda\u002Flatest\u002Fdg\u002Fconfiguration-concurrency.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:5da0267791b1-viewerId:lo_aad13bbcb0ea":{"__typename":"CollectionViewerEdge","id":"collectionId:5da0267791b1-viewerId:lo_aad13bbcb0ea","isEditor":false,"isMuting":false},"UserViewerEdge:userId:9284dc7b6da6-viewerId:lo_aad13bbcb0ea":{"__typename":"UserViewerEdge","id":"userId:9284dc7b6da6-viewerId:lo_aad13bbcb0ea","isMuting":false},"ImageMetadata:":{"__typename":"ImageMetadata","id":"","originalWidth":0,"originalHeight":0},"PostViewerEdge:postId:a334ac50619a-viewerId:lo_aad13bbcb0ea":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:a334ac50619a-viewerId:lo_aad13bbcb0ea","shouldFollowPostForExternalSearch":true},"Tag:cybersecurity":{"__typename":"Tag","id":"cybersecurity","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:cybercrime":{"__typename":"Tag","id":"cybercrime","displayTitle":"Cybercrime","normalizedTagSlug":"cybercrime"},"Tag:aws":{"__typename":"Tag","id":"aws","displayTitle":"AWS","normalizedTagSlug":"aws"},"Tag:penetration-testing":{"__typename":"Tag","id":"penetration-testing","displayTitle":"Penetration Testing","normalizedTagSlug":"penetration-testing"},"Tag:programming":{"__typename":"Tag","id":"programming","displayTitle":"Programming","normalizedTagSlug":"programming"},"Post:a334ac50619a":{"__typename":"Post","id":"a334ac50619a","collection":{"__ref":"Collection:5da0267791b1"},"content({\"postMeteringOptions\":{\"referrer\":\"\"}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"385f","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:e9b421a5a1d_0"},{"__ref":"Paragraph:e9b421a5a1d_1"},{"__ref":"Paragraph:e9b421a5a1d_2"},{"__ref":"Paragraph:e9b421a5a1d_3"},{"__ref":"Paragraph:e9b421a5a1d_4"},{"__ref":"Paragraph:e9b421a5a1d_5"},{"__ref":"Paragraph:e9b421a5a1d_6"},{"__ref":"Paragraph:e9b421a5a1d_7"},{"__ref":"Paragraph:e9b421a5a1d_8"},{"__ref":"Paragraph:e9b421a5a1d_9"},{"__ref":"Paragraph:e9b421a5a1d_10"},{"__ref":"Paragraph:e9b421a5a1d_11"},{"__ref":"Paragraph:e9b421a5a1d_12"},{"__ref":"Paragraph:e9b421a5a1d_13"},{"__ref":"Paragraph:e9b421a5a1d_14"},{"__ref":"Paragraph:e9b421a5a1d_15"},{"__ref":"Paragraph:e9b421a5a1d_16"},{"__ref":"Paragraph:e9b421a5a1d_17"},{"__ref":"Paragraph:e9b421a5a1d_18"},{"__ref":"Paragraph:e9b421a5a1d_19"},{"__ref":"Paragraph:e9b421a5a1d_20"},{"__ref":"Paragraph:e9b421a5a1d_21"},{"__ref":"Paragraph:e9b421a5a1d_22"},{"__ref":"Paragraph:e9b421a5a1d_23"},{"__ref":"Paragraph:e9b421a5a1d_24"},{"__ref":"Paragraph:e9b421a5a1d_25"},{"__ref":"Paragraph:e9b421a5a1d_26"},{"__ref":"Paragraph:e9b421a5a1d_27"},{"__ref":"Paragraph:e9b421a5a1d_28"},{"__ref":"Paragraph:e9b421a5a1d_29"},{"__ref":"Paragraph:e9b421a5a1d_30"},{"__ref":"Paragraph:e9b421a5a1d_31"},{"__ref":"Paragraph:e9b421a5a1d_32"},{"__ref":"Paragraph:e9b421a5a1d_33"},{"__ref":"Paragraph:e9b421a5a1d_34"},{"__ref":"Paragraph:e9b421a5a1d_35"},{"__ref":"Paragraph:e9b421a5a1d_36"},{"__ref":"Paragraph:e9b421a5a1d_37"},{"__ref":"Paragraph:e9b421a5a1d_38"},{"__ref":"Paragraph:e9b421a5a1d_39"},{"__ref":"Paragraph:e9b421a5a1d_40"},{"__ref":"Paragraph:e9b421a5a1d_41"},{"__ref":"Paragraph:e9b421a5a1d_42"},{"__ref":"Paragraph:e9b421a5a1d_43"},{"__ref":"Paragraph:e9b421a5a1d_44"},{"__ref":"Paragraph:e9b421a5a1d_45"},{"__ref":"Paragraph:e9b421a5a1d_46"},{"__ref":"Paragraph:e9b421a5a1d_47"},{"__ref":"Paragraph:e9b421a5a1d_48"},{"__ref":"Paragraph:e9b421a5a1d_49"},{"__ref":"Paragraph:e9b421a5a1d_50"},{"__ref":"Paragraph:e9b421a5a1d_51"},{"__ref":"Paragraph:e9b421a5a1d_52"},{"__ref":"Paragraph:e9b421a5a1d_53"},{"__ref":"Paragraph:e9b421a5a1d_54"},{"__ref":"Paragraph:e9b421a5a1d_55"},{"__ref":"Paragraph:e9b421a5a1d_56"},{"__ref":"Paragraph:e9b421a5a1d_57"},{"__ref":"Paragraph:e9b421a5a1d_58"},{"__ref":"Paragraph:e9b421a5a1d_59"},{"__ref":"Paragraph:e9b421a5a1d_60"},{"__ref":"Paragraph:e9b421a5a1d_61"},{"__ref":"Paragraph:e9b421a5a1d_62"},{"__ref":"Paragraph:e9b421a5a1d_63"},{"__ref":"Paragraph:e9b421a5a1d_64"},{"__ref":"Paragraph:e9b421a5a1d_65"},{"__ref":"Paragraph:e9b421a5a1d_66"},{"__ref":"Paragraph:e9b421a5a1d_67"},{"__ref":"Paragraph:e9b421a5a1d_68"},{"__ref":"Paragraph:e9b421a5a1d_69"},{"__ref":"Paragraph:e9b421a5a1d_70"},{"__ref":"Paragraph:e9b421a5a1d_71"},{"__ref":"Paragraph:e9b421a5a1d_72"},{"__ref":"Paragraph:e9b421a5a1d_73"},{"__ref":"Paragraph:e9b421a5a1d_74"},{"__ref":"Paragraph:e9b421a5a1d_75"},{"__ref":"Paragraph:e9b421a5a1d_76"},{"__ref":"Paragraph:e9b421a5a1d_77"},{"__ref":"Paragraph:e9b421a5a1d_78"},{"__ref":"Paragraph:e9b421a5a1d_79"},{"__ref":"Paragraph:e9b421a5a1d_80"},{"__ref":"Paragraph:e9b421a5a1d_81"},{"__ref":"Paragraph:e9b421a5a1d_82"},{"__ref":"Paragraph:e9b421a5a1d_83"},{"__ref":"Paragraph:e9b421a5a1d_84"},{"__ref":"Paragraph:e9b421a5a1d_85"},{"__ref":"Paragraph:e9b421a5a1d_86"},{"__ref":"Paragraph:e9b421a5a1d_87"},{"__ref":"Paragraph:e9b421a5a1d_88"},{"__ref":"Paragraph:e9b421a5a1d_89"},{"__ref":"Paragraph:e9b421a5a1d_90"},{"__ref":"Paragraph:e9b421a5a1d_91"},{"__ref":"Paragraph:e9b421a5a1d_92"},{"__ref":"Paragraph:e9b421a5a1d_93"},{"__ref":"Paragraph:e9b421a5a1d_94"},{"__ref":"Paragraph:e9b421a5a1d_95"},{"__ref":"Paragraph:e9b421a5a1d_96"},{"__ref":"Paragraph:e9b421a5a1d_97"},{"__ref":"Paragraph:e9b421a5a1d_98"},{"__ref":"Paragraph:e9b421a5a1d_99"},{"__ref":"Paragraph:e9b421a5a1d_100"},{"__ref":"Paragraph:e9b421a5a1d_101"},{"__ref":"Paragraph:e9b421a5a1d_102"},{"__ref":"Paragraph:e9b421a5a1d_103"},{"__ref":"Paragraph:e9b421a5a1d_104"},{"__ref":"Paragraph:e9b421a5a1d_105"},{"__ref":"Paragraph:e9b421a5a1d_106"},{"__ref":"Paragraph:e9b421a5a1d_107"},{"__ref":"Paragraph:e9b421a5a1d_108"},{"__ref":"Paragraph:e9b421a5a1d_109"},{"__ref":"Paragraph:e9b421a5a1d_110"},{"__ref":"Paragraph:e9b421a5a1d_111"},{"__ref":"Paragraph:e9b421a5a1d_112"},{"__ref":"Paragraph:e9b421a5a1d_113"},{"__ref":"Paragraph:e9b421a5a1d_114"},{"__ref":"Paragraph:e9b421a5a1d_115"},{"__ref":"Paragraph:e9b421a5a1d_116"},{"__ref":"Paragraph:e9b421a5a1d_117"},{"__ref":"Paragraph:e9b421a5a1d_118"},{"__ref":"Paragraph:e9b421a5a1d_119"},{"__ref":"Paragraph:e9b421a5a1d_120"},{"__ref":"Paragraph:e9b421a5a1d_121"},{"__ref":"Paragraph:e9b421a5a1d_122"},{"__ref":"Paragraph:e9b421a5a1d_123"},{"__ref":"Paragraph:e9b421a5a1d_124"},{"__ref":"Paragraph:e9b421a5a1d_125"},{"__ref":"Paragraph:e9b421a5a1d_126"},{"__ref":"Paragraph:e9b421a5a1d_127"},{"__ref":"Paragraph:e9b421a5a1d_128"},{"__ref":"Paragraph:e9b421a5a1d_129"},{"__ref":"Paragraph:e9b421a5a1d_130"},{"__ref":"Paragraph:e9b421a5a1d_131"},{"__ref":"Paragraph:e9b421a5a1d_132"},{"__ref":"Paragraph:e9b421a5a1d_133"},{"__ref":"Paragraph:e9b421a5a1d_134"},{"__ref":"Paragraph:e9b421a5a1d_135"},{"__ref":"Paragraph:e9b421a5a1d_136"},{"__ref":"Paragraph:e9b421a5a1d_137"},{"__ref":"Paragraph:e9b421a5a1d_138"},{"__ref":"Paragraph:e9b421a5a1d_139"},{"__ref":"Paragraph:e9b421a5a1d_140"},{"__ref":"Paragraph:e9b421a5a1d_141"},{"__ref":"Paragraph:e9b421a5a1d_142"},{"__ref":"Paragraph:e9b421a5a1d_143"},{"__ref":"Paragraph:e9b421a5a1d_144"},{"__ref":"Paragraph:e9b421a5a1d_145"},{"__ref":"Paragraph:e9b421a5a1d_146"},{"__ref":"Paragraph:e9b421a5a1d_147"},{"__ref":"Paragraph:e9b421a5a1d_148"},{"__ref":"Paragraph:e9b421a5a1d_149"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:9284dc7b6da6"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Ftowardsaws.com\u002Fpointer-hunting-cobalt-strike-globally-a334ac50619a","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isLimitedState":false,"isPublished":true,"allowResponses":true,"responsesLocked":false,"visibility":"PUBLIC","latestPublishedVersion":"e9b421a5a1d","postResponses":{"__typename":"PostResponses","count":0},"responseDistribution":"NOT_DISTRIBUTED","clapCount":100,"title":"Pointer: Hunting Cobalt Strike globally","isSeries":false,"sequence":null,"uniqueSlug":"pointer-hunting-cobalt-strike-globally-a334ac50619a","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1637481499185,"readingTime":13.834905660377357,"previewContent":{"__typename":"PreviewContent","subtitle":"Introduction"},"previewImage":{"__ref":"ImageMetadata:1*l9j-JLGriA0FMQjju7BByg.png"},"isShortform":false,"seoTitle":"Pointer: Hunting Cobalt Strike globally | by Pavel Shabarkin and Michael Koczwara | Medium","firstPublishedAt":1631806642137,"updatedAt":1641380880700,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:a334ac50619a-viewerId:lo_aad13bbcb0ea"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:cybercrime"},{"__ref":"Tag:aws"},{"__ref":"Tag:penetration-testing"},{"__ref":"Tag:programming"}],"isFeaturedInPublishedPublication":false,"isNewsletter":false,"statusForCollection":"APPROVED","pendingCollection":null,"detectedLanguage":"en","wordCount":3176,"layerCake":0}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.9aa319da.js"></script><script src="https://cdn-client.medium.com/lite/static/js/1205.1777a8fc.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.144ff907.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.5bef8967.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8813.659c88d9.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4505.6dfaf853.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9380.fb176dee.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.14632006.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.2791b202.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.e7627065.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4737.f07510eb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7381.f09fa09c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6372.2eeebbff.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7938.607ab959.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6240.ce1d8647.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6199.a99e1025.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4929.485ef991.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3623.d618fbb7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7979.15bcd496.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.5b5a8ee0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.ba40f706.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8664.b06e2cc0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4378.14d600be.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/144.a14bc52a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3666.cdb15b43.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8768.c294838b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1069.499eaa23.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3523.a6edc225.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3515.502362cb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.db09bb75.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.0d800846.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.1770f8f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.9a5e00e7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.55ad176a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.00cf71c8.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'92639fb21f851666',t:'MTc0Mjk2MDM5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"92639fb21f851666","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>