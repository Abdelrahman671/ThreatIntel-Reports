<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
	<meta charset="UTF-8" /> 
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<link rel="pingback" href="https://security-soup.net/xmlrpc.php">
		<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Analysis of Valak Maldoc &#8211; Security Soup</title>
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//v0.wordpress.com' />
<link rel="alternate" type="application/rss+xml" title="Security Soup &raquo; Feed" href="https://security-soup.net/feed/" />
<link rel="alternate" type="application/rss+xml" title="Security Soup &raquo; Comments Feed" href="https://security-soup.net/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Security Soup &raquo; Analysis of Valak Maldoc Comments Feed" href="https://security-soup.net/analysis-of-valak-maldoc/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/security-soup.net\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.5.5"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://security-soup.net/wp-includes/css/dist/block-library/style.min.css?ver=6.5.5' type='text/css' media='all' />
<style id='wp-block-library-inline-css' type='text/css'>
.has-text-align-justify{text-align:justify;}
</style>
<link rel='stylesheet' id='mediaelement-css' href='https://security-soup.net/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css?ver=4.2.17' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://security-soup.net/wp-includes/js/mediaelement/wp-mediaelement.min.css?ver=6.5.5' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://security-soup.net/wp-content/plugins/contact-widgets/assets/css/font-awesome.min.css?ver=4.7.0' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #1f1f1f;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--primary: ;--wp--preset--color--secondary: ;--wp--preset--color--dark-gray: #333333;--wp--preset--color--gray: #6e6e6e;--wp--preset--color--light-gray: #d9d9d9;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 22px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--regular: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='cpsh-shortcodes-css' href='https://security-soup.net/wp-content/plugins/column-shortcodes//assets/css/shortcodes.css?ver=1.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='yada-wiki-css' href='https://security-soup.net/wp-content/plugins/yada-wiki/inc/../css/yadawiki.css?ver=6.5.5' type='text/css' media='all' />
<link rel='stylesheet' id='stsblogfeedly-fonts-css' href='https://fonts.googleapis.com/css?family=Karla%3A400%2C400i%2C700%2C700i' type='text/css' media='all' />
<link rel='stylesheet' id='stsblogfeedly-style-css' href='https://security-soup.net/wp-content/themes/blogfeedly/style.css?ver=6.5.5' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='stsblogfeedly-ie-css' href='https://security-soup.net/wp-content/themes/blogfeedly/css/ie.css?ver=1.6.0' type='text/css' media='all' />
<![endif]-->
<link rel='stylesheet' id='wpcw-css' href='https://security-soup.net/wp-content/plugins/contact-widgets/assets/css/style.min.css?ver=1.0.1' type='text/css' media='all' />
<link rel='stylesheet' id='newsletter-css' href='https://security-soup.net/wp-content/plugins/newsletter/style.css?ver=8.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css' href='https://security-soup.net/wp-content/plugins/jetpack/css/jetpack.css?ver=13.4' type='text/css' media='all' />
<!--[if lt IE 9]>
<script type="text/javascript" src="https://security-soup.net/wp-content/themes/blogfeedly/js/html5.js?ver=3.7.3" id="stsblogfeedly-html5-js"></script>
<![endif]-->
<script type="text/javascript" src="https://security-soup.net/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://security-soup.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://security-soup.net/wp-json/" /><link rel="alternate" type="application/json" href="https://security-soup.net/wp-json/wp/v2/posts/1096" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://security-soup.net/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.5.5" />
<link rel="canonical" href="https://security-soup.net/analysis-of-valak-maldoc/" />
<link rel='shortlink' href='https://wp.me/paC05P-hG' />
<link rel="alternate" type="application/json+oembed" href="https://security-soup.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurity-soup.net%2Fanalysis-of-valak-maldoc%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://security-soup.net/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsecurity-soup.net%2Fanalysis-of-valak-maldoc%2F&#038;format=xml" />
	<style>img#wpstats{display:none}</style>
		
		<style type="text/css">
		.site-title a,.site-description { color: ; }
		.site-navigation{ border-color: ; }
		#menu-toggle { background-color: ; }
		.site-navigation a,#menu-toggle{ color: ; }
		.archive-list-title, .page-title, .not-found .page-title, .social-title, .comments-title, .tag-links, .parent-post-link, .comment-author .fn, .comment-author .url, .comment-reply-title, .entry-content h1, .entry-content h2, .entry-content h3, .entry-content h4, .entry-content h5, .entry-content h6, .entry-content th, .entry-title, .entry-title a, .entry-title a:hover{ color: ; }
		.entry-meta, .entry-meta *, .entry-meta, .entry-meta *:hover{ color: ; }
		.entry-summary, .comments-area, .comments-area p, .entry-content, .entry-content address, .entry-content dt, .page-content, .page-content p, .entry-content p, .entry-content span, .entry-content div, .entry-content li, .entry-content ul, .entry-content ol, .entry-content td, .entry-content dd, .entry-content blockquote { color: ; }
		.page-content .search-field, .archive-list-title, .comments-area *, .entry-content *{ border-color: ; }
		.archive-list a, .comments-area a, .page .entry-content a, .single .entry-content a, .error404 .entry-content a { color: ; }
		.tag-links a, button:hover, button:focus, button:active, input[type="submit"]:hover, input[type="submit"]:focus, input[type="submit"]:active, input[type="button"]:hover, input[type="button"]:focus, input[type="button"]:active, input[type="reset"]:hover, input[type="reset"]:focus, input[type="reset"]:active, button, input[type="submit"], input[type="button"], input[type="reset"], a.more-link{ background-color: ; }
		button:hover, button:focus, button:active, input[type="submit"]:hover, input[type="submit"]:focus, input[type="submit"]:active, input[type="button"]:hover, input[type="button"]:focus, input[type="button"]:active, input[type="reset"]:hover, input[type="reset"]:focus, input[type="reset"]:active, button, input[type="submit"], input[type="button"], input[type="reset"], a.more-link{ border-color: ; }
		.tag-links a, button:hover, button:focus, button:active, input[type="submit"]:hover, input[type="submit"]:focus, input[type="submit"]:active, input[type="button"]:hover, input[type="button"]:focus, input[type="button"]:active, input[type="reset"]:hover, input[type="reset"]:focus, input[type="reset"]:active, button, input[type="submit"], input[type="button"], input[type="reset"], a.more-link{ color: ; }
		.nav-previous a, .nav-next a, .nav-previous a:hover, .nav-next a:hover,.pagination .page-numbers, .pagination .page-numbers:hover{ background-color: ; }
		.nav-previous a, .nav-next a, .nav-previous a:hover, .nav-next a:hover,.pagination .page-numbers,.pagination .page-numbers:hover{ color: ; }
		.featured-sidebar .widget-title{ color: ; }
		.featured-sidebar *{ color: ; }
		.featured-sidebar a{ color: ; }
		.featured-sidebar .tagcloud a, .featured-sidebar .widget-title, .featured-sidebar *{ border-color: ; }
		.featured-sidebar .widget input[type="submit"]{ background-color: ; }
		.featured-sidebar .widget input[type="submit"]{ color: ; }
				.site-footer{ background-color: #1e74bf; }
		.site-footer .widget-title{ color: #1e74bf; }
		.site-footer li, .site-footer ol, .site-footer ul, .site-footer p, .site-footer span, .site-footer div, .site-footer { color: ; }
		.icon-chevron-up:before, .site-footer a{ color: ; }
		.site-footer .tagcloud a, .site-footer *{ border-color: #ffffff; }
		.site-footer .widget input[type="submit"] { background-color: #1e74bf; }
		.site-footer .widget input[type="submit"] { border-color: #1e74bf; }
		.site-footer .widget input[type="submit"] { color: #ffffff; }
		body{ background: ; }
		.site-navigation, .site-header, .site-navigation .menu-wrap{ background: ; }


		</style>
		
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Analysis of Valak Maldoc" />
<meta property="og:url" content="https://security-soup.net/analysis-of-valak-maldoc/" />
<meta property="og:description" content="Summary The Valak malware variant appears to be an emerging threat due to an increased volume of campaign activity by its operators. Besides its relative newness, Valak is also noteworthy for a few…" />
<meta property="article:published_time" content="2020-06-08T02:58:33+00:00" />
<meta property="article:modified_time" content="2020-06-11T17:06:56+00:00" />
<meta property="og:site_name" content="Security Soup" />
<meta property="og:image" content="https://security-soup.net/wp-content/uploads/2019/02/Screen-Shot-2019-02-22-at-12.04.13-AM.png" />
<meta property="og:image:width" content="666" />
<meta property="og:image:height" content="528" />
<meta property="og:image:alt" content="" />
<meta name="twitter:text:title" content="Analysis of Valak Maldoc" />
<meta name="twitter:image" content="https://security-soup.net/wp-content/uploads/2019/02/Screen-Shot-2019-02-22-at-12.04.13-AM.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://security-soup.net/wp-content/uploads/2019/02/cropped-souplock2-3-32x32.png" sizes="32x32" />
<link rel="icon" href="https://security-soup.net/wp-content/uploads/2019/02/cropped-souplock2-3-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://security-soup.net/wp-content/uploads/2019/02/cropped-souplock2-3-180x180.png" />
<meta name="msapplication-TileImage" content="https://security-soup.net/wp-content/uploads/2019/02/cropped-souplock2-3-270x270.png" />
</head>
<body class="post-template-default single single-post postid-1096 single-format-standard wp-custom-logo single-author animated-navigation">
<div id="page" class="site">
	<header class="site-header">
		<div class="inner">
			<a href="https://security-soup.net/" class="custom-logo-link" rel="home"><img src="https://security-soup.net/wp-content/uploads/2019/02/cropped-website_newlogo.png" width="778" alt="Security Soup" /></a>						<p class="site-title screen-reader-text"><a href="https://security-soup.net/" rel="home">Security Soup</a></p>
									<p class="site-description">infosec news, commentary, and research</p>
					</div> <!-- .inner -->
	</header><!-- .site-header -->
	<nav class="site-navigation" aria-label="Menu">
		<div class="menu-wrap"><ul id="menu-blog" class="menu"><li id="menu-item-321" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-321"><a href="https://security-soup.net">Home</a></li>
<li id="menu-item-326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-326"><a href="https://security-soup.net/about-2/">About</a></li>
<li id="menu-item-328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-328"><a href="https://security-soup.net/?page_id=320">Resources</a></li>
<li id="menu-item-1414" class="menu-item menu-item-type-post_type menu-item-object-yada_wiki menu-item-1414"><a href="https://security-soup.net/wiki/welcome-to-the-infosec-wiki/">Knowledge Base</a></li>
<li id="menu-item-327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-327"><a title="ryan@security-soup.net" href="https://security-soup.net/contact-2/">Contact</a></li>
</ul></div>		<a href="#" id="menu-toggle" title="Show Menu">Menu</a>
	</nav><!-- .site-navigation --><div id="content" class="site-content">
	<!-- If has sidebar start -->
	<main id="main" class="site-main main-with-sidebar inner">
		<div class="main-has-sidebar">
			<!-- If has sidebar end -->
			<article id="post-1096" class="post-1096 post type-post status-publish format-standard has-post-thumbnail hentry category-malware-analysis category-research category-tutorial tag-attck tag-macros tag-malware-analysis tag-oledump-py tag-olevba tag-python tag-research tag-valak">
		<div class="post-thumbnail">
		<img width="666" height="528" src="https://security-soup.net/wp-content/uploads/2019/02/Screen-Shot-2019-02-22-at-12.04.13-AM.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" fetchpriority="high" srcset="https://security-soup.net/wp-content/uploads/2019/02/Screen-Shot-2019-02-22-at-12.04.13-AM.png 666w, https://security-soup.net/wp-content/uploads/2019/02/Screen-Shot-2019-02-22-at-12.04.13-AM-300x238.png 300w" sizes="(max-width: 666px) 100vw, 666px" />	</div><!-- .post-thumbnail -->
		<header class="entry-header">
		<h1 class="entry-title">Analysis of Valak Maldoc</h1>		<div class="entry-meta">
			<span class="posted-on"><span class="screen-reader-text">Posted on </span><a href="https://security-soup.net/analysis-of-valak-maldoc/" rel="bookmark"><time class="entry-date published" datetime="2020-06-08T02:58:33+00:00">June 8, 2020</time><time class="updated" datetime="2020-06-11T17:06:56+00:00">June 11, 2020</time></a></span><span class="entry-author"><span class="author vcard"><span class="screen-reader-text">Author </span><a class="url fn n" href="https://security-soup.net/author/admin/">admin</a></span></span><span class="cat-links"><span class="screen-reader-text">Posted in </span><a href="https://security-soup.net/category/malware-analysis/" rel="category tag">Malware Analysis</a>, <a href="https://security-soup.net/category/research/" rel="category tag">Research</a>, <a href="https://security-soup.net/category/tutorial/" rel="category tag">Tutorial</a></span><span class="comments-link"><a href="https://security-soup.net/analysis-of-valak-maldoc/#respond">Leave a Reply</a></span>		</div>
	</header><!-- .entry-header -->
	<div class="entry-content">
		
		
<h2 class="wp-block-heading">Summary</h2>



<p>The Valak malware variant appears to be an emerging threat due to an increased volume of campaign activity by its operators. Besides its relative newness, Valak is also noteworthy for a few of its other operational aspects such as an interesting execution chain and some unconventional  tactics leveraged in the VB macro script of its maldoc downloader. One of these interesting samples of the Valak malware came across my desk earlier this week, so I wanted to share some additional details that may help others in their own analysis and perhaps provide some insight into how to approach its detection, response, and remediation. </p>



<p>In this blog, I will briefly share a Python script I developed to crack the password protected maldocs in the event an analyst does not have access to the original email message containing the password. Next, I will cover a few different methods that can be utilized to extract the VBA macros from the document. Finally, I will show a quick how-to with some basic static analysis techniques to de-obfuscate the macro script, and review the anti-analysis/evasion tactics within the document, and extract the indicators of compromise (IOCs) therein. Let’s go!</p>



<h2 class="wp-block-heading">Valak Overview</h2>



<p>The&nbsp;Valak malware was first discovered around December 2019. It appears to be generally used as a downloader to deliver secondary malware payloads for other eCrime actors. In particular, it <a href="https://www.malware-traffic-analysis.net/2020/06/03/index2.html">appears</a> that <a href="https://malpedia.caad.fkie.fraunhofer.de/actor/lunar_spider">Lunar Spider</a>&#8216;s Bokbot (IcedID) is a common follow-up malware in recent campaigns. However, Valak is a modular framework that has the capability to download additional plugins to facilitate infostealing and reconnaissance. Security researchers at Cybereason recently produced a great <a href="https://www.cybereason.com/blog/valak-more-than-meets-the-eye">write up</a> detailing these additional capabilities and its overall execution chain so I would recommend checking out this resource for more technical details. </p>



<h2 class="wp-block-heading">Cracking the ZIP Archive</h2>



<p>The recent Valak campaigns that I have observed have all been delivered via zipped email attachments that are password protected. The ZIP archive contains a Microsoft Word document that is weaponized with macros. The password is provided in the body of the email. This tactic serves a dual purpose for the threat actor as it enables some basic sandbox evasion, but also supports the social engineering pretext by building trust with the intended victim and appearing more secure. </p>



<p>Many analysts are likely to have access to the original email and thus can easily recover the password. However, in some cases analysts may encounter scenarios where they obtain the ZIP archive containing the maldoc, but do not have access to the email for a variety of reasons whether due to privacy limitations or simply sourcing issues from an online repository or similar. I found myself in this same spot earlier this week as I  was looking into Valak samples. I had obtained the ZIP from , but I did not have access to the original email. I needed to get inside to get a peek at those sweet IOCs.</p>



<figure class="wp-block-image size-large"><img decoding="async" width="640" height="360" src="https://security-soup.net/wp-content/uploads/2020/06/eric.gif" alt="" class="wp-image-1103"/><figcaption>Figure 1. Eric Andre</figcaption></figure>



<p> Ultimately, my solution was to write a quick <a href="https://github.com/Sec-Soup/valak-cracker">program in Python</a> to brute-force the password and extract the archive&#8217;s contents. The password cracking portion is based on a regex of the known password naming convention, so it should be noted that if/when the actors change this convention this script would need to be updated. In future revisions I also plan to add the capability to pass a dictionary file to the program as an argument that will help extend its functionality. I&#8217;m certainly no Pythonista, so YMMV, but this does get the job done. Please feel free to use and/or suggest changes on the <a href="https://github.com/Sec-Soup/valak-cracker">github</a>:    </p>



<figure class="wp-block-image alignwide size-large"><img decoding="async" width="654" height="376" src="https://security-soup.net/wp-content/uploads/2020/06/valcrack.png" alt="" class="wp-image-1105" srcset="https://security-soup.net/wp-content/uploads/2020/06/valcrack.png 654w, https://security-soup.net/wp-content/uploads/2020/06/valcrack-300x172.png 300w" sizes="(max-width: 654px) 100vw, 654px" /><figcaption>Figure 2. valak-cracker.py</figcaption></figure>



<p>Using the program is very simple as you can see below. Just invoke the Python interpreter and then the script&#8217;s name with the argument &#8220;-f&#8221; followed by the name of the ZIP archive. It will extract the file to your working directory and print &#8220;extraction succeeded&#8221; when the correct password is found. This is compatible with Python3 and you will also need a couple dependencies such as <a href="https://github.com/danifus/pyzipper">pyzipper</a> and <a href="https://github.com/asciimoo/exrex">exrex</a>.</p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="898" height="68" src="https://security-soup.net/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-3.13.44-PM.png" alt="" class="wp-image-1108" srcset="https://security-soup.net/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-3.13.44-PM.png 898w, https://security-soup.net/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-3.13.44-PM-300x23.png 300w, https://security-soup.net/wp-content/uploads/2020/06/Screen-Shot-2020-06-03-at-3.13.44-PM-768x58.png 768w" sizes="(max-width: 898px) 100vw, 898px" /><figcaption>Figure 3. Extraction Succeeded</figcaption></figure>



<p></p>



<h2 class="wp-block-heading">Extracting the VBA Macro</h2>



<p>A Microsoft Office document weaponized with macros is nothing new. These VBA macros are executed when an unsuspecting user clicks “Enable Content,” kicking off the infection chain and leading to the download of next-stage payloads. </p>



<p>Whether opening this particular maldoc with a known password or using my tool, the next step is focused on extracting the VBA macro code from the Word DOC itself, which is the downloader for the initial Valak DLL payload. The following document is what I recovered after running the script:</p>



<ul><li>Filename: <a href="https://www.virustotal.com/gui/file/a4f1ea5dd434deee93bdf312f658a7a26f767c7683601fa8b23ef096392eef17/detection">dictate.06.20.doc</a></li><li>SHA256: a4f1ea5dd434deee93bdf312f658a7a26f767c7683601fa8b23ef096392eef17</li></ul>



<p>Usually, analysts can quickly review these macros by simply opening up the onboard VBA project editor within the MS Word Program. I&#8217;ve shown <a href="https://security-soup.net/how-to-extract-network-indicators-of-compromise-iocs-from-maldoc-macros-part-3/">how to do this</a> before, so I won&#8217;t go into much detail here. Suffice to say that you can hold down SHIFT while stepping through the macro to disable the auto open function or simply search through the modules contained within the project and copy out the VBA code. This approach is fairly straightforward, but can often be slow due to its manual nature, and if the macro is heavily obfuscated, can unnecessarily complicate analysis. We can do better with tools. </p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" src="https://security-soup.net/wp-content/uploads/2020/06/tool-man-1.jpg" alt="" class="wp-image-1112" width="564" height="422"/><figcaption>Figure 4. The Tool Man</figcaption></figure></div>



<p>There are lots of tools available that can help out with macro analysis, but I tend to always gravitate to either <a href="https://blog.didierstevens.com/programs/oledump-py/">oledump</a> or <a href="https://github.com/decalage2/oletools/wiki/olevba">olevba</a>. Both work great for this type of task and I will briefly compare/contrast how to use these to extract the macros and also provide a little insight into their pros and cons and maybe why in certain situations you would want to use one over the other. I will also give an honorable mention to <a href="https://github.com/decalage2/ViperMonkey">ViperMonkey</a>. This is is a powerful tool that includes similar functionality to dump OLE steams and parse the VBA macro, but also includes a VBA emulation engine that can automatically de-obfuscate the code as well &#8212; saving a ton of time. Unfortunately, I kept getting errors on this sample so I had to do that bit by hand. More on this later in the next section. </p>



<h4 class="wp-block-heading">oledump.py</h4>



<p>Anyways, oledump is a program written by security researcher, Didier Stevens. As you might have guessed, it dumps the streams from OLE files (DOC, XLS, PPT, etc&#8230;) and has wide variety of plugins that you can use to further manipulate the dumped streams. The basic usage for oledump.py is very simple and and will print the document streams.</p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="899" height="288" src="https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-21_27_44-oledump1-1.png" alt="" class="wp-image-1114" srcset="https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-21_27_44-oledump1-1.png 899w, https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-21_27_44-oledump1-1-300x96.png 300w, https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-21_27_44-oledump1-1-768x246.png 768w" sizes="(max-width: 899px) 100vw, 899px" /><figcaption>Figure 5. The Dumped Streams</figcaption></figure>



<p>As highlighted in Figure 5 above, the basic command dumps the streams and highlights those that contain VBA macro code. Based on this output we now know that streams A3, A4, A5, A12, and A13 all contain macros. I like oledump for its plugin flexibility and additional analysis capabilities, but it also has many options that come onboard that can be passed as arguments. Possibly the two most important that analysts will need to use is the &#8220;decompress&#8221; option which is used with the &#8220;-v&#8221; argument and the &#8220;select&#8221; option used with &#8220;-s&#8221;. The raw dump of the OLE streams are compressed, so using this option combo to select streams of interest is the best way to get the code human readable on the quick. </p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="714" height="467" src="https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_06_47-Screen-Shot-2020-06-03-at-3.32.23-PM.png" alt="" class="wp-image-1115" srcset="https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_06_47-Screen-Shot-2020-06-03-at-3.32.23-PM.png 714w, https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_06_47-Screen-Shot-2020-06-03-at-3.32.23-PM-300x196.png 300w" sizes="(max-width: 714px) 100vw, 714px" /><figcaption>Figure 6. Select and decompress</figcaption></figure>



<p>Here we have our first look at the obfuscated code contained within the functions of the macro. An analyst  could choose to select all of the streams and dump them out at once, but here they are shown separately. Most of the streams can be skipped over because they are comprised of garbage code. Once we get to stream A13, we finally find something pretty interesting. </p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="897" height="469" src="https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_17_24-Screen-Shot-2020-06-03-at-3.34.38-PM-2.png" alt="" class="wp-image-1122" srcset="https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_17_24-Screen-Shot-2020-06-03-at-3.34.38-PM-2.png 897w, https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_17_24-Screen-Shot-2020-06-03-at-3.34.38-PM-2-300x157.png 300w, https://security-soup.net/wp-content/uploads/2020/06/2020-06-06-22_17_24-Screen-Shot-2020-06-03-at-3.34.38-PM-2-768x402.png 768w" sizes="(max-width: 897px) 100vw, 897px" /><figcaption>Figure 7. Obfuscated Array</figcaption></figure>



<p>I gotta tell ya, bad guys just love arrays for obfuscating their macros. Rarely do I stumble across a sample that doesn&#8217;t contain some sort of array declaration and then subsequent operations on the indices of that array to scramble the code. For now, we can just copy out the dumped macros or write them to a file for future analysis. We have one more tool to discuss before getting into the de-obfuscation .</p>



<h4 class="wp-block-heading">olevba</h4>



<p>Next up is olevba, a tool written by security researcher, Philippe Lagadec. It has similar functionality as oledump, but its output is slightly different and comparatively less flexible as it does not have an extensive list of plugins. However, a noteworthy feature of oledump is its default triage mode that performs an initial analysis of the macro and provides a summary of suspicious strings and operations that are identified in the document. This may give analysts a quick boost to speed up an investigation when time constraints are critical. This program can also be ran against multiple files if there is a use-case for a high volume of analyses that require automated workloads. Usage of olevba is also quite simple and can be executed via the command line or used as a python module. </p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="694" height="536" src="https://security-soup.net/wp-content/uploads/2020/06/olevba1.png" alt="" class="wp-image-1125" srcset="https://security-soup.net/wp-content/uploads/2020/06/olevba1.png 694w, https://security-soup.net/wp-content/uploads/2020/06/olevba1-300x232.png 300w" sizes="(max-width: 694px) 100vw, 694px" /><figcaption>Figure 8. Default olevba output</figcaption></figure>



<p> The output is for both tools is generally similar, although olevba does include a feature that highlights potentially suspicious keywords in the dumped macro. For example, it will highlight the &#8220;AutoOpen()&#8221; function in bright yellow, which is typically the initial indicator an analyst will seek out as this function is what will immediately execute when a victim opens the document. Keep in mind that macros are often obfuscated and not necessarily linear in operation. </p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="821" height="254" src="https://security-soup.net/wp-content/uploads/2020/06/oledump2.png" alt="" class="wp-image-1127" srcset="https://security-soup.net/wp-content/uploads/2020/06/oledump2.png 821w, https://security-soup.net/wp-content/uploads/2020/06/oledump2-300x93.png 300w, https://security-soup.net/wp-content/uploads/2020/06/oledump2-768x238.png 768w" sizes="(max-width: 821px) 100vw, 821px" /><figcaption>Figure 9. Highlight AutoOpen()</figcaption></figure>



<p>In the next example from the olevba output, we can see suspicious keywords highlighted in red. Here, we see a <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement">declare statement</a> that includes what appears to be capability to download files from via the <strong>URLDownloadToFile</strong>&nbsp;function, which is part of the <a href="https://wellsr.com/vba/2018/excel/download-files-with-vba-urldownloadtofile/">urlmon</a> library built in to Windows. The Lib clause is a required statement in the declaration syntax and indicates the macro will be loading a DLL or some other code resource (urlmon in this case).  </p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="869" height="311" src="https://security-soup.net/wp-content/uploads/2020/06/olevba3-1.png" alt="" class="wp-image-1129" srcset="https://security-soup.net/wp-content/uploads/2020/06/olevba3-1.png 869w, https://security-soup.net/wp-content/uploads/2020/06/olevba3-1-300x107.png 300w, https://security-soup.net/wp-content/uploads/2020/06/olevba3-1-768x275.png 768w" sizes="(max-width: 869px) 100vw, 869px" /><figcaption>Figure 10. Highlight suspicious keywords</figcaption></figure>



<p>Finally, we get to the end of the dumped macro. We can see here that olevba has extracted the same obfuscated array as we observed previously. At the end of the output, is the triage summary, which summarized all of the suspicious keywords that were highlighted in the automated analysis. </p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="1024" height="634" src="https://security-soup.net/wp-content/uploads/2020/06/olevba-4-1-1024x634.png" alt="" class="wp-image-1131" srcset="https://security-soup.net/wp-content/uploads/2020/06/olevba-4-1-1024x634.png 1024w, https://security-soup.net/wp-content/uploads/2020/06/olevba-4-1-300x186.png 300w, https://security-soup.net/wp-content/uploads/2020/06/olevba-4-1-768x476.png 768w, https://security-soup.net/wp-content/uploads/2020/06/olevba-4-1.png 1204w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 11. Array (again) and Summary</figcaption></figure>



<p>So, that&#8217;s a quick look at two different tools that have similar capability to dump and analyze macros. Both are easy to use and have broad functionality. I use both tools frequently, depending on the task at hand. I would recommend downloading both and keeping them as a part of your kit. </p>



<h2 class="wp-block-heading">De-obfuscating the Macro</h2>



<p>Now that the macro code has been obtained, the final analysis step here is to de-obfuscate the macro. Obfuscation and anti-analysis techniques are commonly employed to evade detection and avoid complete analysis by automated sandboxes. This particular macro for the Valak malware sample is not that complicated and so it can be decoded fairly easily. The tools covered above include several options that can aid in this type of de-obfuscation such as manipulating and decoding strings, but it isn&#8217;t really necessary in this situation. Compared to some of the bizarrely extensive obfuscation in a lot of other eCrime downloaders, this example is downright simple. It&#8217;s about 200 lines of mostly junk code. After removing about 75% of the code, we are left with the only lines that perform some operations.</p>



<figure class="wp-block-image alignfull size-large"><img loading="lazy" decoding="async" width="1024" height="732" src="https://security-soup.net/wp-content/uploads/2020/06/decoder-1024x732.png" alt="" class="wp-image-1132" srcset="https://security-soup.net/wp-content/uploads/2020/06/decoder-1024x732.png 1024w, https://security-soup.net/wp-content/uploads/2020/06/decoder-300x214.png 300w, https://security-soup.net/wp-content/uploads/2020/06/decoder-768x549.png 768w, https://security-soup.net/wp-content/uploads/2020/06/decoder.png 1296w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 12.Macro after junk removal</figcaption></figure>



<p>Despite the relative simplicity of the macro obfuscation, this macro code is pretty interesting for a few of its features related to evading detection. The operators have used a few sneaky tricks that diverge from a lot of classic TTPs that are observed in similar eCrime downloaders. Notably, here we see a complete absence of PowerShell and/or the WebClent class to download the payload from the URL. Instead we see the usage of the URLDownloadToFile, which is a VBA function along with the urlmon Windows library. We also see a command shell opened via an interesting usage of the <a href="https://www.vbsedit.com/html/5593b353-ef4b-4c99-8ae1-f963bac48929.asp">Exec method</a> with a <a href="https://www.vbsedit.com/html/5593b353-ef4b-4c99-8ae1-f963bac48929.asp">WshShell object</a>. Let me repeat that: the adversary just got shell and downloaded a file without using CMD or PowerShell. I&#8217;m no detection engineer, but I think that might cause some problems. Nice. </p>



<p>Finally, the script launches regsvr32 and loads the downloaded DLL payload into the process. The last block is the encoded array that was covered in the previous section. Decoding this block is easy as long as we pay attention to the split/join functions and do a simple string replacement using the two keys &#8220;love&#8221; and &#8220;xxxxxxx&#8221;. The array ultimately decodes into the URL where the actors have stashed the Valak DLL. It also includes an argument to write that downloaded file into the &#8220;C:\ProgramData&#8221; directory as a randomly named .dat file. Here&#8217;s what the final pieces look like all cleaned up:</p>



<figure class="wp-block-image alignwide size-large"><img loading="lazy" decoding="async" width="1024" height="449" src="https://security-soup.net/wp-content/uploads/2020/06/finall-1-1024x449.png" alt="" class="wp-image-1134" srcset="https://security-soup.net/wp-content/uploads/2020/06/finall-1-1024x449.png 1024w, https://security-soup.net/wp-content/uploads/2020/06/finall-1-300x132.png 300w, https://security-soup.net/wp-content/uploads/2020/06/finall-1-768x337.png 768w, https://security-soup.net/wp-content/uploads/2020/06/finall-1.png 1161w" sizes="(max-width: 1024px) 100vw, 1024px" /><figcaption>Figure 13. Final code</figcaption></figure>



<h2 class="wp-block-heading">Conclusion</h2>



<p>So that’s it, my take on conducting analysis on a recent Valak sample. I&#8217;ve shared a few resources and tools that can hopefully enable analysts to improve the velocity and fidelity of their data gathering for triage and investigations. This variant of Valak is deceptively simple in its obfuscation, but definitely has some intriguing evasion and anti-analysis tricks up its sleeve. This is a newer threat that is just now emerging into the landscape so it remains to be seen what its ultimate impact may be going forward. Its association with other high profile eCrime threats could indicate a continuing trend towards collaboration on high volume campaigns, sophisticated development cycles, and devastating post-intrusion action. ATT&amp;CK tagging is provided below, and I&#8217;ve included only the IOCs from this specific maldoc, but others from the overall <a href="https://pastebin.com/WmAWQQ06">campaign</a> are available thanks to Brad Duncan. </p>



<h2 class="wp-block-heading">IOCs</h2>



<p>hxxp[:]//nwwgbluv65j6g0xgr-xk[.]com/czwih/fxla[.]php?l=gap6[.]cab</p>



<h2 class="wp-block-heading">ATT&amp;CK Tagging</h2>



<ul><li><strong>Initial Access</strong><ul><li><strong>Phishing attachment (<a rel="noreferrer noopener" href="https://attack.mitre.org/techniques/T1193/" target="_blank">ATT&amp;CK ID: T1193</a>)</strong></li></ul></li><li><strong>Execution</strong><ul><li><strong>User Execution (<a rel="noreferrer noopener" href="https://attack.mitre.org/techniques/T1204/" target="_blank">ATT&amp;CK ID: T1204</a>)</strong></li><li><strong>Scripting</strong>&nbsp;<strong>(<a href="https://attack.mitre.org/techniques/T1064/">ATT&amp;CK ID: T1064</a>)&nbsp;</strong></li><li><strong>Regsvr32 (<a rel="noreferrer noopener" href="https://attack.mitre.org/techniques/T1117/" target="_blank">ATT&amp;CK ID: ID:&nbsp;T1117</a>)</strong></li></ul></li><li><strong>Defense Evasion</strong><ul><li><strong>Deobfuscate/Decode Files or Information (<a href="https://attack.mitre.org/techniques/T1140/">ATT&amp;CK ID: T1140</a>)</strong></li><li><strong>Masquerading (<a href="https://attack.mitre.org/techniques/T1036/">ATT&amp;CK ID: T1036</a>)</strong></li><li><strong>Process Injection (<a href="https://attack.mitre.org/techniques/T1055/">ATT&amp;CK ID: T1055</a>)</strong></li></ul></li><li><strong>Command and Control</strong><ul><li><strong>Remote File Copy (<a href="https://attack.mitre.org/techniques/T1105/">ATT&amp;CK ID: T1105</a>)</strong></li></ul></li></ul>



<h2 class="wp-block-heading">References</h2>



<p>[1]&nbsp;<a href="https://www.crowdstrike.com/blog/big-game-hunting-the-evolution-of-indrik-spider-from-dridex-wire-fraud-to-bitpaymer-targeted-ransomware/"></a><a href="https://www.malware-traffic-analysis.net/2020/06/03/index2.html">https://www.malware-traffic-analysis.net/2020/06/03/index2.html</a></p>



<p>[2]&nbsp;<a href="https://malpedia.caad.fkie.fraunhofer.de/actor/lunar_spider">https://malpedia.caad.fkie.fraunhofer.de/actor/lunar_spider</a></p>



<p>[3] <a href="https://www.cybereason.com/blog/valak-more-than-meets-the-eye">https://www.cybereason.com/blog/valak-more-than-meets-the-eye</a></p>



<p>[4]&nbsp;<a href="https://ratexcel.wordpress.com/2017/03/22/how-to-really-protect-your-code-making-vba-project-unviewable/"></a><a href="https://github.com/Sec-Soup/valak-cracker">https://github.com/Sec-Soup/valak-cracker</a></p>



<p>[5]&nbsp;<a href="https://github.com/outflanknl/EvilClippy"></a><a href="https://github.com/danifus/pyzipper">https://github.com/danifus/pyzipper</a></p>



<p>[6]&nbsp;<a href="https://github.com/danielbohannon/Invoke-DOSfuscation"></a><a href="https://github.com/asciimoo/exrex">https://github.com/asciimoo/exrex</a></p>



<p>[7]&nbsp;<a href="https://www.virustotal.com/gui/file/a4f1ea5dd434deee93bdf312f658a7a26f767c7683601fa8b23ef096392eef17/detection">https://www.virustotal.com/gui/file/a4f1ea5dd434deee93bdf312f658a7a26f767c7683601fa8b23ef096392eef17/detection</a></p>



<p>[8]&nbsp;<a href="https://github.com/Sec-Soup/Array-Decoder/blob/master/arrayDecoder.py">https://github.com/Sec-Soup/Array-Decoder/blob/master/arrayDecoder.py</a></p>



<p>[9] <a href="https://security-soup.net/how-to-extract-network-indicators-of-compromise-iocs-from-maldoc-macros-part-3/">https://security-soup.net/how-to-extract-network-indicators-of-compromise-iocs-from-maldoc-macros-part-3/</a>&nbsp;</p>



<p>[10] <a href="https://blog.didierstevens.com/programs/oledump-py/">https://blog.didierstevens.com/programs/oledump-py/</a></p>



<p>[11] <a href="https://github.com/decalage2/oletools/wiki/olevba">https://github.com/decalage2/oletools/wiki/olevba</a></p>



<p>[12] <a href="https://github.com/decalage2/ViperMonkey">https://github.com/decalage2/ViperMonkey</a></p>



<p>[13] <a href="https://wellsr.com/vba/2018/excel/download-files-with-vba-urldownloadtofile/">https://wellsr.com/vba/2018/excel/download-files-with-vba-urldownloadtofile/</a></p>



<p>[14] <a href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement</a></p>



<p>[15] <a href="https://www.vbsedit.com/html/5593b353-ef4b-4c99-8ae1-f963bac48929.asp">https://www.vbsedit.com/html/5593b353-ef4b-4c99-8ae1-f963bac48929.asp</a></p>



<p>[16] <a href="https://www.vbsedit.com/html/7b956233-c1aa-4b59-b36d-f3e97a9b02f0.asp">https://www.vbsedit.com/html/7b956233-c1aa-4b59-b36d-f3e97a9b02f0.asp</a></p>



<p>[17] <a href="https://pastebin.com/WmAWQQ06">https://pastebin.com/WmAWQQ06</a></p>



<p>[10]&nbsp;<a href="https://attack.mitre.org/techniques/T1204/">https://attack.mitre.org/techniques/T1204/</a></p>



<p>[11] <a href="https://attack.mitre.org/techniques/T1086/"><a href="https://attack.mitre.org/techniques/T1117/">https://attack.mitre.org/techniques/T1117/</a></a></p>



<p>[12]&nbsp;<a href="https://attack.mitre.org/techniques/T1047/">https://attack.mitre.org/techniques/T1047/</a></p>



<p>[14]&nbsp;<a href="https://attack.mitre.org/techniques/T1140/">https://attack.mitre.org/techniques/T1140/</a></p>



<p>[15]&nbsp;<a href="https://attack.mitre.org/techniques/T1036/">https://attack.mitre.org/techniques/T1036/</a></p>



<p>[16]&nbsp;<a href="https://attack.mitre.org/techniques/T1055/">https://attack.mitre.org/techniques/T1055/</a></p>



<p>[17]&nbsp;<a href="https://attack.mitre.org/techniques/T1105/">https://attack.mitre.org/techniques/T1105/</a></p>



<p></p>
			</div><!-- .entry-content -->
						<footer class="entry-footer">
								<div class="tag-links">Tagged: <a href="https://security-soup.net/tag/attck/" rel="tag">ATT&amp;CK</a><a href="https://security-soup.net/tag/macros/" rel="tag">Macros</a><a href="https://security-soup.net/tag/malware-analysis/" rel="tag">Malware Analysis</a><a href="https://security-soup.net/tag/oledump-py/" rel="tag">oledump.py</a><a href="https://security-soup.net/tag/olevba/" rel="tag">olevba</a><a href="https://security-soup.net/tag/python/" rel="tag">Python</a><a href="https://security-soup.net/tag/research/" rel="tag">Research</a><a href="https://security-soup.net/tag/valak/" rel="tag">Valak</a></div>			</footer><!-- .entry-footer -->
		</article><!-- #post -->
	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://security-soup.net/weekly-news-roundup-may-31-to-june-6/" rel="prev">&larr; Weekly News Roundup — May 31 to June 6</a></div><div class="nav-next"><a href="https://security-soup.net/weekly-news-roundup-june-21-to-june-27/" rel="next">Weekly News Roundup — June 21 to June 27 &rarr;</a></div></div>
	</nav><div id="comments" class="comments-area">
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/analysis-of-valak-maldoc/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://security-soup.net/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" autocomplete="url" /></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1096' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="97d8c616ff" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="2"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	</div><!-- .comments-area -->				<!-- If has sidebar start -->
	</div>

<aside id="secondary" class="featured-sidebar widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://security-soup.net/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="wpcw_social-3" class="widget wpcw-widgets wpcw-widget-social"><ul><li class="no-label"><a href="https://security-soup.net/feed/" target="_blank" title="Visit Security Soup on RSS feed"><span class="fa fa-2x fa-rss"></span></a></li><li class="no-label"><a href="https://twitter.com/sec_soup" target="_blank" title="Visit Security Soup on Twitter"><span class="fa fa-2x fa-twitter"></span></a></li><li class="no-label"><a href="https://www.linkedin.com/in/ryan-campbell-7219b7138/" target="_blank" title="Visit Security Soup on LinkedIn"><span class="fa fa-2x fa-linkedin"></span></a></li><li class="no-label"><a href="https://github.com/sec-soup" target="_blank" title="Visit Security Soup on GitHub"><span class="fa fa-2x fa-github"></span></a></li></ul></section><section id="newsletterwidget-3" class="widget widget_newsletterwidget"><h2 class="widget-title">Newsletter Sign-up</h2>Please submit your email if you would like to receive the Weekly News Roundups when they are posted.<div class="tnp tnp-subscription tnp-widget">
<form method="post" action="https://security-soup.net/?na=s">
<input type="hidden" name="nr" value="widget">
<input type="hidden" name="nlang" value="">
<div class="tnp-field tnp-field-email"><label for="tnp-1">Email</label>
<input class="tnp-email" type="email" name="ne" id="tnp-1" value="" placeholder="" required></div>
<div class="tnp-field tnp-field-button" style="text-align: left"><input class="tnp-submit" type="submit" value="Subscribe" style="">
</div>
</form>
</div>
</section><section id="archives-4" class="widget widget_archive"><h2 class="widget-title">Archives</h2>
			<ul>
					<li><a href='https://security-soup.net/2022/10/'>October 2022</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2022/09/'>September 2022</a>&nbsp;(2)</li>
	<li><a href='https://security-soup.net/2022/08/'>August 2022</a>&nbsp;(1)</li>
	<li><a href='https://security-soup.net/2022/07/'>July 2022</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2022/06/'>June 2022</a>&nbsp;(2)</li>
	<li><a href='https://security-soup.net/2022/05/'>May 2022</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2022/04/'>April 2022</a>&nbsp;(1)</li>
	<li><a href='https://security-soup.net/2022/03/'>March 2022</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2022/02/'>February 2022</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2022/01/'>January 2022</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2021/12/'>December 2021</a>&nbsp;(2)</li>
	<li><a href='https://security-soup.net/2021/11/'>November 2021</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2021/10/'>October 2021</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2021/09/'>September 2021</a>&nbsp;(6)</li>
	<li><a href='https://security-soup.net/2021/08/'>August 2021</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2021/07/'>July 2021</a>&nbsp;(2)</li>
	<li><a href='https://security-soup.net/2021/06/'>June 2021</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2021/05/'>May 2021</a>&nbsp;(1)</li>
	<li><a href='https://security-soup.net/2021/04/'>April 2021</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2021/03/'>March 2021</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2021/02/'>February 2021</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2021/01/'>January 2021</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2020/12/'>December 2020</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2020/11/'>November 2020</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2020/10/'>October 2020</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2020/09/'>September 2020</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2020/08/'>August 2020</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2020/07/'>July 2020</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2020/06/'>June 2020</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2020/05/'>May 2020</a>&nbsp;(6)</li>
	<li><a href='https://security-soup.net/2020/04/'>April 2020</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2020/03/'>March 2020</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2020/02/'>February 2020</a>&nbsp;(3)</li>
	<li><a href='https://security-soup.net/2020/01/'>January 2020</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2019/12/'>December 2019</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2019/11/'>November 2019</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2019/10/'>October 2019</a>&nbsp;(1)</li>
	<li><a href='https://security-soup.net/2019/09/'>September 2019</a>&nbsp;(7)</li>
	<li><a href='https://security-soup.net/2019/08/'>August 2019</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2019/07/'>July 2019</a>&nbsp;(6)</li>
	<li><a href='https://security-soup.net/2019/06/'>June 2019</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2019/05/'>May 2019</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2019/04/'>April 2019</a>&nbsp;(5)</li>
	<li><a href='https://security-soup.net/2019/03/'>March 2019</a>&nbsp;(6)</li>
	<li><a href='https://security-soup.net/2019/02/'>February 2019</a>&nbsp;(4)</li>
	<li><a href='https://security-soup.net/2019/01/'>January 2019</a>&nbsp;(1)</li>
			</ul>

			</section><section id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widget-title">Tags</h2><div class="tagcloud"><a href="https://security-soup.net/tag/attck/" class="tag-cloud-link tag-link-23 tag-link-position-1" style="font-size: 14px;" aria-label="ATT&amp;CK (3 items)">ATT&amp;CK<span class="tag-link-count"> (3)</span></a>
<a href="https://security-soup.net/tag/career-development/" class="tag-cloud-link tag-link-44 tag-link-position-2" style="font-size: 14px;" aria-label="Career Development (1 item)">Career Development<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/certificaton/" class="tag-cloud-link tag-link-43 tag-link-position-3" style="font-size: 14px;" aria-label="Certificaton (1 item)">Certificaton<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/cissp/" class="tag-cloud-link tag-link-42 tag-link-position-4" style="font-size: 14px;" aria-label="CISSP (1 item)">CISSP<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/cyberchef/" class="tag-cloud-link tag-link-58 tag-link-position-5" style="font-size: 14px;" aria-label="CyberChef (1 item)">CyberChef<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/cyberpolicy/" class="tag-cloud-link tag-link-62 tag-link-position-6" style="font-size: 14px;" aria-label="Cyberpolicy (1 item)">Cyberpolicy<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/danabot/" class="tag-cloud-link tag-link-66 tag-link-position-7" style="font-size: 14px;" aria-label="Danabot (1 item)">Danabot<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/dns/" class="tag-cloud-link tag-link-48 tag-link-position-8" style="font-size: 14px;" aria-label="DNS (1 item)">DNS<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/domain-names/" class="tag-cloud-link tag-link-45 tag-link-position-9" style="font-size: 14px;" aria-label="Domain Names (1 item)">Domain Names<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/doppeldridex/" class="tag-cloud-link tag-link-64 tag-link-position-10" style="font-size: 14px;" aria-label="DoppelDridex (1 item)">DoppelDridex<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/doppelspider/" class="tag-cloud-link tag-link-65 tag-link-position-11" style="font-size: 14px;" aria-label="DoppelSpider (1 item)">DoppelSpider<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/dridex/" class="tag-cloud-link tag-link-49 tag-link-position-12" style="font-size: 14px;" aria-label="Dridex (2 items)">Dridex<span class="tag-link-count"> (2)</span></a>
<a href="https://security-soup.net/tag/emotet/" class="tag-cloud-link tag-link-13 tag-link-position-13" style="font-size: 14px;" aria-label="Emotet (11 items)">Emotet<span class="tag-link-count"> (11)</span></a>
<a href="https://security-soup.net/tag/excel/" class="tag-cloud-link tag-link-27 tag-link-position-14" style="font-size: 14px;" aria-label="Excel (2 items)">Excel<span class="tag-link-count"> (2)</span></a>
<a href="https://security-soup.net/tag/flawedammyy/" class="tag-cloud-link tag-link-22 tag-link-position-15" style="font-size: 14px;" aria-label="FlawedAmmyy (1 item)">FlawedAmmyy<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/government/" class="tag-cloud-link tag-link-61 tag-link-position-16" style="font-size: 14px;" aria-label="Government (1 item)">Government<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/javascript/" class="tag-cloud-link tag-link-20 tag-link-position-17" style="font-size: 14px;" aria-label="JavaScript (1 item)">JavaScript<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/macros/" class="tag-cloud-link tag-link-14 tag-link-position-18" style="font-size: 14px;" aria-label="Macros (12 items)">Macros<span class="tag-link-count"> (12)</span></a>
<a href="https://security-soup.net/tag/malware-analysis/" class="tag-cloud-link tag-link-15 tag-link-position-19" style="font-size: 14px;" aria-label="Malware Analysis (17 items)">Malware Analysis<span class="tag-link-count"> (17)</span></a>
<a href="https://security-soup.net/tag/mitreattack/" class="tag-cloud-link tag-link-39 tag-link-position-20" style="font-size: 14px;" aria-label="MITREattack (1 item)">MITREattack<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/msiexec/" class="tag-cloud-link tag-link-26 tag-link-position-21" style="font-size: 14px;" aria-label="msiexec (1 item)">msiexec<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/news/" class="tag-cloud-link tag-link-7 tag-link-position-22" style="font-size: 14px;" aria-label="News (146 items)">News<span class="tag-link-count"> (146)</span></a>
<a href="https://security-soup.net/tag/oledump-py/" class="tag-cloud-link tag-link-36 tag-link-position-23" style="font-size: 14px;" aria-label="oledump.py (2 items)">oledump.py<span class="tag-link-count"> (2)</span></a>
<a href="https://security-soup.net/tag/olevba/" class="tag-cloud-link tag-link-54 tag-link-position-24" style="font-size: 14px;" aria-label="olevba (1 item)">olevba<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/phishing/" class="tag-cloud-link tag-link-47 tag-link-position-25" style="font-size: 14px;" aria-label="Phishing (2 items)">Phishing<span class="tag-link-count"> (2)</span></a>
<a href="https://security-soup.net/tag/policy/" class="tag-cloud-link tag-link-60 tag-link-position-26" style="font-size: 14px;" aria-label="Policy (1 item)">Policy<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/powershell/" class="tag-cloud-link tag-link-57 tag-link-position-27" style="font-size: 14px;" aria-label="PowerShell (2 items)">PowerShell<span class="tag-link-count"> (2)</span></a>
<a href="https://security-soup.net/tag/python/" class="tag-cloud-link tag-link-51 tag-link-position-28" style="font-size: 14px;" aria-label="Python (4 items)">Python<span class="tag-link-count"> (4)</span></a>
<a href="https://security-soup.net/tag/regsvr32/" class="tag-cloud-link tag-link-56 tag-link-position-29" style="font-size: 14px;" aria-label="regsvr32 (1 item)">regsvr32<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/research/" class="tag-cloud-link tag-link-18 tag-link-position-30" style="font-size: 14px;" aria-label="Research (10 items)">Research<span class="tag-link-count"> (10)</span></a>
<a href="https://security-soup.net/tag/tlds/" class="tag-cloud-link tag-link-46 tag-link-position-31" style="font-size: 14px;" aria-label="TLDs (1 item)">TLDs<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/tools/" class="tag-cloud-link tag-link-17 tag-link-position-32" style="font-size: 14px;" aria-label="Tools (4 items)">Tools<span class="tag-link-count"> (4)</span></a>
<a href="https://security-soup.net/tag/tutorial/" class="tag-cloud-link tag-link-16 tag-link-position-33" style="font-size: 14px;" aria-label="Tutorial (6 items)">Tutorial<span class="tag-link-count"> (6)</span></a>
<a href="https://security-soup.net/tag/valak/" class="tag-cloud-link tag-link-53 tag-link-position-34" style="font-size: 14px;" aria-label="Valak (1 item)">Valak<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/vbscript/" class="tag-cloud-link tag-link-67 tag-link-position-35" style="font-size: 14px;" aria-label="VBScript (1 item)">VBScript<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/wmi/" class="tag-cloud-link tag-link-52 tag-link-position-36" style="font-size: 14px;" aria-label="WMI (1 item)">WMI<span class="tag-link-count"> (1)</span></a>
<a href="https://security-soup.net/tag/yara/" class="tag-cloud-link tag-link-35 tag-link-position-37" style="font-size: 14px;" aria-label="YARA (2 items)">YARA<span class="tag-link-count"> (2)</span></a></div>
</section><section id="yadawiki_toc_widget-3" class="widget widget_yadawiki_toc_widget"><div class="widget-text yadawiki_toc_widget_box"><div class="widget-title"><h2 class="widget-title">Knowledge Base</h2></div><div class="widget_links"><h1>Table of Contents</h1>
<ul>
<li><a href="https://security-soup.net/wiki/information-security-news/" class="wikilink-published">Information Security News</a></li>
<li><a href="https://security-soup.net/wiki/technical-research-whitepapers/" class="wikilink-published">Technical Research & Blogs</a></li>
<li><a href="https://security-soup.net/wiki/documentation-frameworks/" class="wikilink-published">Recommended Reading</a></li>
<li><a href="https://security-soup.net/wiki/tools-tips/" class="wikilink-published">Tools & Platforms</a></li>
<li><a href="https://security-soup.net/wiki/career-development/" class="wikilink-published">Training & Development</a></li>
<li><a href="https://security-soup.net/wiki/article-index/" class="wikilink-published">Article Index</a></li>
</ul>
</div></div></section></aside><!-- #secondary -->
<!-- If has sidebar end -->

		</main><!-- .site-main -->
	</div><!-- .site-content -->
			<footer class="site-footer">
		<div class="inner">
			<div class="supplementary">
	<div class="grid">
			<div class="one-fourth">
			<section id="wpcw_contact-6" class="widget wpcw-widgets wpcw-widget-contact"><h2 class="widget-title">Contact</h2><ul><li class="has-label"><strong>Email</strong><br><div><a href="mailto:&#114;ya&#110;&#64;s&#101;&#99;ur&#105;ty&#45;so&#117;&#112;&#46;&#110;et">&#114;ya&#110;&#64;s&#101;&#99;ur&#105;ty&#45;so&#117;&#112;&#46;&#110;et</a></div></li></ul></section>		</div>
				<div class="one-fourth">
			<section id="wpcw_social-5" class="widget wpcw-widgets wpcw-widget-social"><ul><li class="no-label"><a href="https://security-soup.net/feed/" target="_blank" title="Visit Security Soup on RSS feed"><span class="fa fa-2x fa-rss"></span></a></li><li class="no-label"><a href="https://twitter.com/sec_soup" target="_blank" title="Visit Security Soup on Twitter"><span class="fa fa-2x fa-twitter"></span></a></li><li class="no-label"><a href="https://www.linkedin.com/in/ryan-campbell-7219b7138/" target="_blank" title="Visit Security Soup on LinkedIn"><span class="fa fa-2x fa-linkedin"></span></a></li></ul></section><section id="wpcw_contact-4" class="widget wpcw-widgets wpcw-widget-contact"><h2 class="widget-title">Contact Us</h2><ul><li class="has-label"><strong>Email</strong><br><div><a href="mailto:&#114;&#121;&#97;&#110;&#64;&#115;&#101;&#99;&#117;ri&#116;y&#45;s&#111;&#117;&#112;&#46;net">&#114;&#121;&#97;&#110;&#64;&#115;&#101;&#99;&#117;ri&#116;y&#45;s&#111;&#117;&#112;&#46;net</a></div></li></ul></section>		</div>
				<div class="one-fourth">
			<section id="newsletterwidget-2" class="widget widget_newsletterwidget"><h2 class="widget-title">Newsletter Sign-up</h2>Please submit your email if you would like to receive the Weekly News Roundups when they are posted.<div class="tnp tnp-subscription tnp-widget">
<form method="post" action="https://security-soup.net/?na=s">
<input type="hidden" name="nr" value="widget">
<input type="hidden" name="nlang" value="">
<div class="tnp-field tnp-field-email"><label for="tnp-3">Email</label>
<input class="tnp-email" type="email" name="ne" id="tnp-3" value="" placeholder="" required></div>
<div class="tnp-field tnp-field-button" style="text-align: left"><input class="tnp-submit" type="submit" value="Subscribe" style="">
</div>
</form>
</div>
</section>		</div>
				<div class="one-fourth">
			<section id="calendar-5" class="widget widget_calendar"><div id="calendar_wrap" class="calendar_wrap"><table id="wp-calendar" class="wp-calendar-table">
	<caption>December 2024</caption>
	<thead>
	<tr>
		<th scope="col" title="Monday">M</th>
		<th scope="col" title="Tuesday">T</th>
		<th scope="col" title="Wednesday">W</th>
		<th scope="col" title="Thursday">T</th>
		<th scope="col" title="Friday">F</th>
		<th scope="col" title="Saturday">S</th>
		<th scope="col" title="Sunday">S</th>
	</tr>
	</thead>
	<tbody>
	<tr>
		<td colspan="6" class="pad">&nbsp;</td><td>1</td>
	</tr>
	<tr>
		<td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td>
	</tr>
	<tr>
		<td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td>
	</tr>
	<tr>
		<td>16</td><td>17</td><td id="today">18</td><td>19</td><td>20</td><td>21</td><td>22</td>
	</tr>
	<tr>
		<td>23</td><td>24</td><td>25</td><td>26</td><td>27</td><td>28</td><td>29</td>
	</tr>
	<tr>
		<td>30</td><td>31</td>
		<td class="pad" colspan="5">&nbsp;</td>
	</tr>
	</tbody>
	</table><nav aria-label="Previous and next months" class="wp-calendar-nav">
		<span class="wp-calendar-nav-prev"><a href="https://security-soup.net/2022/10/">&laquo; Oct</a></span>
		<span class="pad">&nbsp;</span>
		<span class="wp-calendar-nav-next">&nbsp;</span>
	</nav></div></section>		</div>
		</div><!-- .grid -->
</div><!-- .supplementary -->			<div class="site-info">
				<p class="copyright">
			&copy;2024 Security Soup			<!-- Delete below lines to remove copyright from footer -->
			<span class="footer-info-right">
				 | Theme by <a href="https://superbthemes.com/">SuperbThemes.Com</a>
			</span>
			<!-- Delete above lines to remove copyright from footer -->
				</p>
				<a href="#" id="back-to-top" title="Back To Top"><i aria-hidden="true" class="icon-chevron-up"></i></a>
			</div><!-- .site-info -->
		</div><!-- .inner -->
	</footer><!-- .site-footer -->
</div><!-- .site -->
<script type="text/javascript" src="https://security-soup.net/wp-includes/js/comment-reply.min.js?ver=6.5.5" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script type="text/javascript" src="https://security-soup.net/wp-content/themes/blogfeedly/js/custom.js?ver=1.6.0" id="stsblogfeedly-script-js"></script>
<script type="text/javascript" src="https://stats.wp.com/e-202451.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"156820185\",\"post\":\"1096\",\"tz\":\"0\",\"srv\":\"security-soup.net\",\"j\":\"1:13.4\"}") ]);
_stq.push([ "clickTrackerInit", "156820185", "1096" ]);
/* ]]> */
</script>
<script defer type="text/javascript" src="https://security-soup.net/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1715292814" id="akismet-frontend-js"></script>
</body>
</html>