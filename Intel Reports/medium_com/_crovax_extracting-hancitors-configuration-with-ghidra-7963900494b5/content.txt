<!doctype html><html lang="en"><head><title data-rh="true">Extracting Hancitor’s Configuration with Ghidra part 1 | by Crovax | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2022-01-21T15:06:07.174Z"/><meta data-rh="true" name="title" content="Extracting Hancitor’s Configuration with Ghidra part 1 | by Crovax | Medium"/><meta data-rh="true" property="og:title" content="Extracting Hancitor’s Configuration with Ghidra part 1"/><meta data-rh="true" property="al:android:url" content="medium://p/7963900494b5"/><meta data-rh="true" property="al:ios:url" content="medium://p/7963900494b5"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="Hancitor is an older malware loader that is known to drop additional malware on to the system once infected (cobalt strike and some ransomware variants). The entry point is from your typical malspam…"/><meta data-rh="true" property="og:description" content="Topics covered"/><meta data-rh="true" property="og:url" content="https://medium.com/@crovax/extracting-hancitors-configuration-with-ghidra-7963900494b5"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@crovax/extracting-hancitors-configuration-with-ghidra-7963900494b5"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*Cnej7WsFM_HKJ8SWuBG2gw.png"/><meta data-rh="true" property="article:author" content="https://medium.com/@crovax"/><meta data-rh="true" name="author" content="Crovax"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Extracting Hancitor’s Configuration with Ghidra part 1"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/7963900494b5"/><meta data-rh="true" property="twitter:description" content="Topics covered"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*Cnej7WsFM_HKJ8SWuBG2gw.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@crovax"/><link data-rh="true" rel="canonical" href="https://medium.com/@crovax/extracting-hancitors-configuration-with-ghidra-7963900494b5"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/7963900494b5"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*Cnej7WsFM_HKJ8SWuBG2gw.png"],"url":"https:\u002F\u002Fmedium.com\u002F@crovax\u002Fextracting-hancitors-configuration-with-ghidra-7963900494b5","dateCreated":"2021-12-27T23:54:33.109Z","datePublished":"2021-12-27T23:54:33.109Z","dateModified":"2022-01-21T15:06:17.440Z","headline":"Extracting Hancitor’s Configuration with Ghidra part 1","name":"Extracting Hancitor’s Configuration with Ghidra part 1","description":"Hancitor is an older malware loader that is known to drop additional malware on to the system once infected (cobalt strike and some ransomware variants). The entry point is from your typical malspam…","identifier":"7963900494b5","author":{"@type":"Person","name":"Crovax","url":"https:\u002F\u002Fmedium.com\u002F@crovax"},"creator":["Crovax"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@crovax\u002Fextracting-hancitors-configuration-with-ghidra-7963900494b5"}</script><style type="text/css" data-fela-rehydration="562" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="562" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{margin-top:32px}.mh{margin-bottom:14px}.mi{padding-top:24px}.mj{padding-bottom:10px}.mk{background-color:#000000}.ml{height:3px}.mm{width:3px}.mn{margin-right:20px}.mo{line-height:1.12}.mp{letter-spacing:-0.022em}.mq{font-weight:600}.nl{margin-bottom:-0.28em}.nm{line-height:1.58}.nn{letter-spacing:-0.004em}.no{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.oj{margin-bottom:-0.46em}.ok{list-style-type:disc}.ol{margin-left:30px}.om{padding-left:0px}.pc{box-shadow:inset 3px 0 0 0 #242424}.pd{padding-left:23px}.pe{margin-left:-20px}.pf{font-style:italic}.pg{text-decoration:underline}.ph{clear:both}.pn{margin-left:auto}.po{margin-right:auto}.pp{max-width:1571px}.pv{padding-top:5px}.pw{padding-bottom:5px}.py{cursor:zoom-in}.pz{z-index:auto}.qb{height:auto}.qc{max-width:1289px}.qd{max-width:1163px}.qe{max-width:1180px}.qf{max-width:1235px}.qg{max-width:1625px}.qh{max-width:1748px}.qi{max-width:1740px}.qj{max-width:1746px}.qk{max-width:1117px}.ql{overflow-x:auto}.qm{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.qn{padding:20px}.qo{border-radius:0}.qp{background:#F2F2F2}.qq{line-height:1.18}.qr{margin-top:-0.09em}.qs{margin-bottom:-0.09em}.qt{white-space:pre-wrap}.qu{min-width:fit-content}.qv{margin-top:0.91em}.qw{max-width:927px}.qx{margin-bottom:26px}.qy{margin-top:6px}.qz{margin-top:8px}.ra{margin-right:8px}.rb{padding:8px 16px}.rc{border-radius:100px}.rd{transition:background 300ms ease}.rf{white-space:nowrap}.rg{border-top:none}.rh{height:52px}.ri{max-height:52px}.rj{box-sizing:content-box}.rk{position:static}.rl{z-index:1}.rn{max-width:155px}.ry{height:0px}.rz{margin-bottom:40px}.so{height:64px}.sp{width:64px}.sq{align-self:flex-end}.sr{color:rgba(255, 255, 255, 1)}.ss{fill:rgba(255, 255, 255, 1)}.st{background:rgba(25, 25, 25, 1)}.su{border-color:rgba(25, 25, 25, 1)}.sx:disabled{opacity:0.1}.sy:disabled:hover{background:rgba(25, 25, 25, 1)}.sz:disabled:hover{border-color:rgba(25, 25, 25, 1)}.ta{flex:1 1 auto}.te{padding-right:4px}.tf{font-weight:500}.ts{margin-top:16px}.tt{margin-bottom:54px}.tz{gap:18px}.ua{fill:rgba(61, 61, 61, 1)}.um{border-bottom:solid 1px #E5E5E5}.un{margin-top:72px}.uo{padding:24px 0}.up{margin-bottom:0px}.uq{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.re:hover{background-color:#F2F2F2}.sn:hover{background-color:none}.sv:hover{background:#000000}.sw:hover{border-color:#242424}.ub:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.qa:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:68px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.nh{font-size:24px}.ni{margin-top:1.25em}.nj{line-height:30px}.nk{letter-spacing:-0.016em}.of{font-size:20px}.og{margin-top:0.94em}.oh{line-height:32px}.oi{letter-spacing:-0.003em}.or{margin-top:1.14em}.ow{margin-top:1.95em}.pb{margin-top:2.14em}.pm{max-width:1192px}.pu{margin-top:56px}.rs{display:inline-block}.rx{margin-bottom:104px}.sa{flex-direction:row}.sd{margin-bottom:0}.se{margin-right:20px}.tb{max-width:500px}.tq{line-height:24px}.tr{letter-spacing:0}.ty{margin-bottom:72px}.ug{margin:40px 0 0}.ul{padding-top:72px}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.rr{display:inline-block}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.rq{display:inline-block}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.rp{display:inline-block}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:4px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mr{font-size:20px}.ms{margin-top:0.93em}.mt{line-height:24px}.mu{letter-spacing:0}.np{font-size:18px}.nq{margin-top:0.67em}.nr{line-height:28px}.ns{letter-spacing:-0.003em}.on{margin-top:1.34em}.os{margin-top:1.2em}.ox{margin-top:1.56em}.pi{max-width:100%}.pq{margin-top:40px}.ro{display:inline-block}.rt{margin-bottom:96px}.sl{margin-bottom:20px}.sm{margin-right:0}.tg{font-size:24px}.th{line-height:30px}.ti{letter-spacing:-0.016em}.tu{margin-bottom:64px}.uc{margin:32px 0 0}.uh{padding-top:48px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:68px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.nd{font-size:24px}.ne{margin-top:1.25em}.nf{line-height:30px}.ng{letter-spacing:-0.016em}.ob{font-size:20px}.oc{margin-top:0.94em}.od{line-height:32px}.oe{letter-spacing:-0.003em}.oq{margin-top:1.14em}.ov{margin-top:1.95em}.pa{margin-top:2.14em}.pl{max-width:1192px}.pt{margin-top:56px}.rw{margin-bottom:104px}.sb{flex-direction:row}.sf{margin-bottom:0}.sg{margin-right:20px}.tc{max-width:500px}.to{line-height:24px}.tp{letter-spacing:0}.tx{margin-bottom:72px}.uf{margin:40px 0 0}.uk{padding-top:72px}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:68px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.mz{font-size:24px}.na{margin-top:1.25em}.nb{line-height:30px}.nc{letter-spacing:-0.016em}.nx{font-size:20px}.ny{margin-top:0.94em}.nz{line-height:32px}.oa{letter-spacing:-0.003em}.op{margin-top:1.14em}.ou{margin-top:1.95em}.oz{margin-top:2.14em}.pk{max-width:100%}.ps{margin-top:56px}.rv{margin-bottom:104px}.sc{flex-direction:row}.sh{margin-bottom:0}.si{margin-right:20px}.td{max-width:500px}.tm{line-height:24px}.tn{letter-spacing:0}.tw{margin-bottom:72px}.ue{margin:40px 0 0}.uj{padding-top:72px}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:4px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mv{font-size:20px}.mw{margin-top:0.93em}.mx{line-height:24px}.my{letter-spacing:0}.nt{font-size:18px}.nu{margin-top:0.67em}.nv{line-height:28px}.nw{letter-spacing:-0.003em}.oo{margin-top:1.34em}.ot{margin-top:1.2em}.oy{margin-top:1.56em}.pj{max-width:100%}.pr{margin-top:40px}.ru{margin-bottom:96px}.sj{margin-bottom:20px}.sk{margin-right:0}.tj{font-size:24px}.tk{line-height:30px}.tl{letter-spacing:-0.016em}.tv{margin-bottom:64px}.ud{margin:32px 0 0}.ui{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="print">.rm{display:none}</style><style type="text/css" data-fela-rehydration="562" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.px{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F7963900494b5&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---top_nav_layout_nav----------------------------------"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" rel="noopener follow" href="/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" rel="noopener follow" href="/search?source=---top_nav_layout_nav----------------------------------"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" rel="noopener follow" href="/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="ad2a" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Extracting Hancitor’s Configuration with Ghidra part 1</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/@crovax?source=post_page---byline--7963900494b5--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Crovax" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*PZTWZlkG3FJWX_MxK5Hw4Q.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/@crovax?source=post_page---byline--7963900494b5--------------------------------">Crovax</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fbbc74ef8ef79&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;user=Crovax&amp;userId=bbc74ef8ef79&amp;source=post_page-bbc74ef8ef79--byline--7963900494b5---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Dec 27, 2021</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F7963900494b5&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;user=Crovax&amp;userId=bbc74ef8ef79&amp;source=---header_actions--7963900494b5---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7963900494b5&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;source=---header_actions--7963900494b5---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div></div></div></div><div class="ab cb mg mh mi mj" role="separator"><span class="mk by bm ml mm mn"></span><span class="mk by bm ml mm mn"></span><span class="mk by bm ml mm"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="7865" class="mo mp gu bf mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl bk">Topics covered</h1><ul class=""><li id="a11b" class="nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj ok ol om bk">Locate the decryption function</li><li id="9ac4" class="nm nn gu no b np on nr ns nt oo nv nw nx op nz oa ob oq od oe of or oh oi oj ok ol om bk">Determine the decryption algorithm</li><li id="b027" class="nm nn gu no b np on nr ns nt oo nv nw nx op nz oa ob oq od oe of or oh oi oj ok ol om bk">Build Ghidra script to decrypt the configuration file</li><li id="5c35" class="nm nn gu no b np on nr ns nt oo nv nw nx op nz oa ob oq od oe of or oh oi oj ok ol om bk">Build yara detection rule (In part 2)</li></ul><h1 id="f8ec" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">Hancitor Overview</h1><p id="5a18" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">Hancitor is an older malware loader that is known to drop additional malware on to the system once infected (cobalt strike and some ransomware variants). The entry point is from your typical malspam campaign, that contains a link to an office doc or already has one embedded in the email.</p><p id="80cc" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">The original dll is usually packed, and once unpacked, will execute the hancitor payload and reach out to one of its hard coded c2&#x27;s.</p><blockquote class="pc pd pe"><p id="70d8" class="nm nn pf no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">Original packed samples:</strong></p></blockquote><p id="d2d3" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><a class="af pg" href="https://www.malware-traffic-analysis.net/2021/06/17/index.html" rel="noopener ugc nofollow" target="_blank">https://www.malware-traffic-analysis.net/2021/06/17/index.html</a></p><blockquote class="pc pd pe"><p id="5250" class="nm nn pf no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">Unpacked Sample</strong>:</p><p id="39d4" class="nm nn pf no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">SHA-256</p><p id="f486" class="nm nn pf no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">882b30e147fe5fa6c79b7c7411ce9d8035086ad2f58650f5d79aadfb2ffd34f4</p></blockquote></div></div></div><div class="ab cb mg mh mi mj" role="separator"><span class="mk by bm ml mm mn"></span><span class="mk by bm ml mm mn"></span><span class="mk by bm ml mm"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="be4b" class="mo mp gu bf mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl bk">Locating the decryption function</h1><p id="3ec8" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">Hancitor leverages the Windows native Cryptographic Service provider (CSP) context to perform its decryption routine. Knowing that, locating the decryption function will be relatively easy.</p><p id="3c9d" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">One way, is to load the binary into Ghidra and look at import table list for one of the cryptographic functions (CryptDecrypt, CryptAcquireContextA etc) then follow the referenced function from there.</p></div></div><div class="ph"><div class="ab cb"><div class="li pi lj pj lk pk cf pl cg pm ci bh"><figure class="pq pr ps pt pu ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po pp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Cnej7WsFM_HKJ8SWuBG2gw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Cnej7WsFM_HKJ8SWuBG2gw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Cnej7WsFM_HKJ8SWuBG2gw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Cnej7WsFM_HKJ8SWuBG2gw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Cnej7WsFM_HKJ8SWuBG2gw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Cnej7WsFM_HKJ8SWuBG2gw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Cnej7WsFM_HKJ8SWuBG2gw.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*Cnej7WsFM_HKJ8SWuBG2gw.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="300" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="6f7c" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">Now that we have located the function leveraging the CryptDecrypt routine, we can get a better picture of how the decryption process works. Below is the decompiled view of the function performing the decryption routine. We’ll step through each function to determine how the decryption logic works then start programming it out.</p></div></div><div class="ph"><div class="ab cb"><div class="li pi lj pj lk pk cf pl cg pm ci bh"><figure class="pq pr ps pt pu ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*O1PF2eyPUWAy--lWLMaGSQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*O1PF2eyPUWAy--lWLMaGSQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*O1PF2eyPUWAy--lWLMaGSQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*O1PF2eyPUWAy--lWLMaGSQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*O1PF2eyPUWAy--lWLMaGSQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*O1PF2eyPUWAy--lWLMaGSQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*O1PF2eyPUWAy--lWLMaGSQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*O1PF2eyPUWAy--lWLMaGSQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="464" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="8f1b" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">CryptAcquireContextA</h1><p id="eb42" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">The CryptAcquireContextA function initiates the call to the Cryptographic Service Provider (CSP) to determine what kind of CSP to use for the CryptoAPI functions. This function is straightforward as its role is just to initiate the CSP context for use. We can determine which CSP is going to be used by the first ‘PUSH 0x0&quot; instruction. Since its a null value being used, the default selection is made (native windows cryptographic service provider).</p><figure class="pq pr ps pt pu ph pn po paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wO8LGNfzZbiq35vTfi-g7w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wO8LGNfzZbiq35vTfi-g7w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wO8LGNfzZbiq35vTfi-g7w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wO8LGNfzZbiq35vTfi-g7w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wO8LGNfzZbiq35vTfi-g7w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wO8LGNfzZbiq35vTfi-g7w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wO8LGNfzZbiq35vTfi-g7w.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wO8LGNfzZbiq35vTfi-g7w.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln qb c" width="700" height="279" loading="eager" role="presentation"/></picture></div></div></figure><h1 id="9d44" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">CryptCreateHash</h1><p id="e557" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">When the CryptCreateHash function is called, it creates the hashing object to be used in the cryptographic routine, and determines the type of hashing algorithm to be used. Once successful, it returns a handle to the object, for subsequent calls to the other cryptographic functions.</p><p id="f1dc" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">To determine what hashing algorithm is being used, we can look at the ‘Algid’ value that will be pushed on to the stack. In this case, we see the ‘PUSH CALG_SHA1’ instruction is being used. So, we know that the hashing algorithm is SHA1.</p><figure class="pq pr ps pt pu ph pn po paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qe"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_AuoTBQjMaN3fsfvFNAfw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*A_AuoTBQjMaN3fsfvFNAfw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*A_AuoTBQjMaN3fsfvFNAfw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*A_AuoTBQjMaN3fsfvFNAfw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*A_AuoTBQjMaN3fsfvFNAfw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*A_AuoTBQjMaN3fsfvFNAfw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*A_AuoTBQjMaN3fsfvFNAfw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*A_AuoTBQjMaN3fsfvFNAfw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln qb c" width="700" height="247" loading="lazy" role="presentation"/></picture></div></div></figure><h1 id="affc" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">CryptHashData</h1><p id="f513" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">This function is going to hash the data passed to it, using the previously specified algorithm(SHA1). But what is being hashed and how do we figure it out?</p><p id="e809" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">First we need to look back at the arguments being passed into the function (I have labeled it “Decryption’) to see what data is being passed and where its located.</p><p id="56d1" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">by looking at the arguments and their position in which they&#x27;re being passed in, we need to find out what the data is expecting and where is it located. In order to find this information we can follow the data that is being passed into the function.</p><p id="b3b5" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">Hint: I have already labeled it 😃</p></div></div><div class="ph"><div class="ab cb"><div class="li pi lj pj lk pk cf pl cg pm ci bh"><figure class="pq pr ps pt pu ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qf"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*QMkeojEP9Sl_U5b7hmoxew.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*QMkeojEP9Sl_U5b7hmoxew.png 640w, https://miro.medium.com/v2/resize:fit:720/1*QMkeojEP9Sl_U5b7hmoxew.png 720w, https://miro.medium.com/v2/resize:fit:750/1*QMkeojEP9Sl_U5b7hmoxew.png 750w, https://miro.medium.com/v2/resize:fit:786/1*QMkeojEP9Sl_U5b7hmoxew.png 786w, https://miro.medium.com/v2/resize:fit:828/1*QMkeojEP9Sl_U5b7hmoxew.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*QMkeojEP9Sl_U5b7hmoxew.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*QMkeojEP9Sl_U5b7hmoxew.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="456" loading="eager" role="presentation"/></picture></div></div></figure><figure class="le ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qg"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*2463yELD5d5QoHhxZ_HYcA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*2463yELD5d5QoHhxZ_HYcA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2463yELD5d5QoHhxZ_HYcA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2463yELD5d5QoHhxZ_HYcA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2463yELD5d5QoHhxZ_HYcA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2463yELD5d5QoHhxZ_HYcA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2463yELD5d5QoHhxZ_HYcA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*2463yELD5d5QoHhxZ_HYcA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="363" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="ec83" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">As you can see, the third argument being passed is a pointer to the ‘key’ thats going to be hashed, and the argument being passed to the right of it (8) is the key length.</p><p id="b60c" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">so we know the following:</p><p id="dfad" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">Key</strong> = b’\xb3\x03\x18\xaa\x0a\xd2\x77\xde’</p><p id="a09d" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">Key length</strong> = 8 bytes</p><h1 id="a64c" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">CryptDeriveKey</h1><p id="e76e" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">This next part is going to be a bit tricky. The CryptDeriveKey is going to accept a few parameters:</p><p id="608c" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">hProv </strong>= handle to the cryptographic service provided being used.</p><p id="54bc" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">Algid</strong> = algorithm for which the key is to be generated. In this case, its going to be RC4.</p><p id="c9bf" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">hHash or hBaseData =</strong> handle to the hash object that points to the data.</p><p id="3286" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">dwFlags </strong>= this is going to be key length that is going to be used. Which is the lower 16 bits of the value being passed. In our case that value is 0x00280011, so we only want the lower values or 0x0028 (we can truncate the leading zeros). So by dividing 0x28 / key length(8) that was being passed to the CryptHashData function, we know how many bytes of the RC4 key is going to be used to decrypt the configuration data.</p><p id="e30c" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">RC4 key</strong>: 0x28 / 8 = (5 bytes)</p></div></div><div class="ph"><div class="ab cb"><div class="li pi lj pj lk pk cf pl cg pm ci bh"><figure class="pq pr ps pt pu ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qh"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*3R-8QV9CBii2KS_TXnqkmA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*3R-8QV9CBii2KS_TXnqkmA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*3R-8QV9CBii2KS_TXnqkmA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*3R-8QV9CBii2KS_TXnqkmA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*3R-8QV9CBii2KS_TXnqkmA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*3R-8QV9CBii2KS_TXnqkmA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*3R-8QV9CBii2KS_TXnqkmA.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*3R-8QV9CBii2KS_TXnqkmA.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="255" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><h1 id="0997" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">CryptDecrypt</h1><p id="166f" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">This function is straightforward, it accepts the data to be decrypted, the key used, and the length of the data as parameters. To verify, we can once again look at the arguments that are being passed to the function.</p></div></div><div class="ph"><div class="ab cb"><div class="li pi lj pj lk pk cf pl cg pm ci bh"><figure class="pq pr ps pt pu ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*F8Yo-6FGQbFiaTAYW8CrWQ.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="262" loading="eager" role="presentation"/></picture></div></div></figure><figure class="le ph pv pw paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qj"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/format:webp/1*2wMFx0VsGW1MmrZJxBul4A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*2wMFx0VsGW1MmrZJxBul4A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*2wMFx0VsGW1MmrZJxBul4A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*2wMFx0VsGW1MmrZJxBul4A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*2wMFx0VsGW1MmrZJxBul4A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*2wMFx0VsGW1MmrZJxBul4A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*2wMFx0VsGW1MmrZJxBul4A.png 1100w, https://miro.medium.com/v2/resize:fit:2000/1*2wMFx0VsGW1MmrZJxBul4A.png 2000w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 1000px"/><img alt="" class="bh ln qb c" width="1000" height="183" loading="eager" role="presentation"/></picture></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="fa35" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">based on the value being passed in, we can see the encrypted data length is equal to 0x2000 bytes.</p><p id="ee79" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">Below is a graphical representation of the actions performed thus far.</p><figure class="pq pr ps pt pu ph pn po paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sa3RvlyN0JNbKP1ScwzaUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*sa3RvlyN0JNbKP1ScwzaUQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*sa3RvlyN0JNbKP1ScwzaUQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*sa3RvlyN0JNbKP1ScwzaUQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*sa3RvlyN0JNbKP1ScwzaUQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*sa3RvlyN0JNbKP1ScwzaUQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*sa3RvlyN0JNbKP1ScwzaUQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*sa3RvlyN0JNbKP1ScwzaUQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln qb c" width="700" height="416" loading="eager" role="presentation"/></picture></div></div></figure><h1 id="1ccc" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">Creating the Ghidra script</h1><p id="cf29" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">We now understand how the decryption process works. The next step is to create a script in Ghidra to automate this whole process, so we can extract the build/campaign id and the c2 domains from this sample.</p><p id="c867" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><strong class="no gv">Note</strong>: the python script can be downloaded from my github (link <a class="af pg" href="https://github.com/CrovaxTheCursed/CrovaxTheCursed/tree/main/Malware_Analysis/Hancitor_Ghidra_Script" rel="noopener ugc nofollow" target="_blank">here</a>). Your cursor needs to be pointing to the first address of the encrypted data before running the script. This is due to the ‘currentAddress’ method.</p><p id="882a" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">We know we need to create a sha1 hash of the 8 byte key that’s being passed into the Decryption function. So we can copy those bytes out of Ghidra and store them into a variable. The next step is to get a hash (sha1) of the key and extract the first 5 bytes (Key Hash: a956a1e6ff).</p><pre class="pq pr ps pt pu ql qm qn qo ay qp bk"><span id="f07c" class="qq mp gu qm b ij qr qs l qt qu"><em class="pf">import hashlib <br/>import binascii</em></span><span id="2fd1" class="qq mp gu qm b ij qv qs l qt qu"><em class="pf">key_bytes = ‘\xb3\x03\x18\xaa\x0a\xd2\x77\xde’<br/>print ‘key length’, len(key_bytes)<br/>get_hash = hashlib.sha1()<br/>get_hash.update(key_bytes)<br/>key_hash = get_hash.digest()[:5]</em></span></pre><p id="2006" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">Next we need to get the encrypted data using ghidra’s getBytes function, and then perform any necessary conversions on the hex values</p><pre class="pq pr ps pt pu ql qm qn qo ay qp bk"><span id="c7b1" class="qq mp gu qm b ij qr qs l qt qu">def get_encrypted_bytes():   <br/>    get_addr = currentAddress<br/>    get_bytes = list(getBytes(get_addr, 2000))<br/>    converted_bytes = &#x27;&#x27;<br/>    cByte = &#x27;&#x27;<br/>    for byte in get_bytes:<br/>        if byte &lt; 0:<br/>            cByte = (0xff - abs(byte) + 1)<br/>        else:<br/>            cByte = byte<br/>        converted_bytes += chr(cByte)<br/>        <br/>    return converted_bytes</span></pre><p id="bb27" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">We now have our key and the encrypted data we need to decrypt. The last step is to pass these parameters to a our rc4 decryption function to perform the remaining steps.</p><pre class="pq pr ps pt pu ql qm qn qo ay qp bk"><span id="7f66" class="qq mp gu qm b ij qr qs l qt qu">def rc4_decrypt(key, data):<br/>    x = 0<br/>    box = range(256)<br/>    for i in range(256):<br/>        x = (x + box[i] + ord(key[i % len(key)])) % 256<br/>        box[i], box[x] = box[x], box[i]<br/>    x = 0<br/>    y = 0<br/>    out = []<br/>    for char in data:<br/>        x = (x + 1) % 256<br/>        y = (y + box[x]) % 256<br/>        box[x], box[y] = box[y], box[x]<br/>        out.append(chr(ord(char) ^ box[(box[x] + box[y]) % 256]))<br/>    return &#x27;&#x27;.join(out)</span></pre><p id="58bd" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">Now that we have our decrypted data, we just need to format the data we want and discard any null bytes.</p><pre class="pq pr ps pt pu ql qm qn qo ay qp bk"><span id="8a3b" class="qq mp gu qm b ij qr qs l qt qu">print &#x27;Current Address:&#x27;, currentAddress <br/>print &#x27;Key Hash:&#x27;,binascii.hexlify(key_hash)</span><span id="39b3" class="qq mp gu qm b ij qv qs l qt qu">get_data = get_encrypted_bytes()</span><span id="e806" class="qq mp gu qm b ij qv qs l qt qu">config =  rc4_decrypt(key_hash, get_data)<br/>build_id = config.split(&#x27;\x00&#x27;)[0]<br/>print  &#x27;Build_id:&#x27;, build_id</span><span id="f546" class="qq mp gu qm b ij qv qs l qt qu">for string in config.split(&#x27;\x00&#x27;)[1:]:<br/>    if string != &#x27;&#x27;:<br/>        c2 = string<br/>        break<br/>c2_List = c2.split(&#x27;|&#x27;)</span><span id="5231" class="qq mp gu qm b ij qv qs l qt qu">for c2 in c2_List:<br/>    if c2 != &#x27;&#x27;:<br/>        print &#x27;c2:&#x27;, c2</span></pre><p id="c415" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">The output should look something like this 😃</p><figure class="pq pr ps pt pu ph pn po paragraph-image"><div role="button" tabindex="0" class="px py fj pz bh qa"><div class="pn po qw"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VF48UKBfq-QQi-JJHV7hBQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VF48UKBfq-QQi-JJHV7hBQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VF48UKBfq-QQi-JJHV7hBQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VF48UKBfq-QQi-JJHV7hBQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VF48UKBfq-QQi-JJHV7hBQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VF48UKBfq-QQi-JJHV7hBQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VF48UKBfq-QQi-JJHV7hBQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*VF48UKBfq-QQi-JJHV7hBQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln qb c" width="700" height="356" loading="lazy" role="presentation"/></picture></div></div></figure><p id="2602" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk"><em class="pf">Decode_Config.py&gt; Running…<br/>key length 8<br/>Current Address: 005c5018<br/>Key Hash: a956a1e6ff<br/>Build_id: 1706_apkreb6<br/>c2: http://thestaccultur.com/8/forum[.]php<br/>c2: http://arguendinfuld.ru/8/forum[.]php<br/>c2: http://waxotheousch.ru/8/forum[.]php</em></p><h1 id="e4d5" class="mo mp gu bf mq mr os mt mu mv ot mx my mz ou nb nc nd ov nf ng nh ow nj nk nl bk">Conclusion</h1><p id="6540" class="pw-post-body-paragraph nm nn gu no b np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of og oh oi oj gn bk">By breaking down the individual functions of the decryption routine we were able to determine how hancitor was decrypting its c2 domain configuration. We then applied the same process in creating a Ghidra script to automatically perform the same steps statically, to reveal the encrypted data.</p><p id="f198" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">In part 2, we well take a similar approach and build a yara rule to test our theory and see if we can detect multiple hancitor variants.</p><p id="0dc7" class="pw-post-body-paragraph nm nn gu no b np ox nr ns nt oy nv nw nx oz nz oa ob pa od oe of pb oh oi oj gn bk">As always, Don’t expect much, as I have no clue what I’m doing. 😃</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qx qy ab iv"><div class="qz ab"><a class="ra ay am ao" rel="noopener follow" href="/tag/malware?source=post_page-----7963900494b5--------------------------------"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Malware</div></a></div><div class="qz ab"><a class="ra ay am ao" rel="noopener follow" href="/tag/ghidra?source=post_page-----7963900494b5--------------------------------"><div class="rb fj cx rc ge rd re bf b bg z bk rf">Ghidra</div></a></div></div></div></div><div class="l"></div><footer class="rg mh rh ri rj ab q rk rl c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rm"><div class="ab q ke"><div class="rn l"><span class="l ro rp rq e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F7963900494b5&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;user=Crovax&amp;userId=bbc74ef8ef79&amp;source=---footer_actions--7963900494b5---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f rr rs"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F7963900494b5&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;user=Crovax&amp;userId=bbc74ef8ef79&amp;source=---footer_actions--7963900494b5---------------------clap_footer-----------"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="mn l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F7963900494b5&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40crovax%2Fextracting-hancitors-configuration-with-ghidra-7963900494b5&amp;source=---footer_actions--7963900494b5---------------------bookmark_footer-----------"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="mn l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="rt ru rv rw rx l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ry bh r rz"></div><div class="ab sa sb sc iu it"><div class="sd se sf sg sh si sj sk sl sm ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/@crovax?source=post_page---post_author_info--7963900494b5--------------------------------"><div class="l fj"><img alt="Crovax" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*PZTWZlkG3FJWX_MxK5Hw4Q.jpeg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sn"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/@crovax?source=post_page---post_author_info--7963900494b5--------------------------------"><div class="l fj"><img alt="Crovax" class="l fd by so sp cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*PZTWZlkG3FJWX_MxK5Hw4Q.jpeg" width="64" height="64" loading="lazy"/><div class="fr by l so sp fs n ay sn"></div></div></a></div><div class="j i d sq is"><div class="ab"><span><button class="bf b bg z sr rb ss st su sv sw ev ew sx sy sz fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co ta"><div class="tb tc td pj pi l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@crovax?source=post_page---post_author_info--7963900494b5--------------------------------"><h2 class="pw-author-name bf tf tg th ti tj tk tl nx tm tn ob to tp of tq tr bk"><span class="gn te">Written by <!-- -->Crovax</span></h2></a><div class="qz ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@crovax/followers?source=post_page---post_author_info--7963900494b5--------------------------------">32 Followers</a></span></div><div class="bf b bg z du ab qt"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/@crovax/following?source=post_page---post_author_info--7963900494b5--------------------------------">11 Following</a></div></div><div class="ts l"><p class="bf b bg z bk"><span class="gn">There and Back Again — A Reverser’s Tale.</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sr rb ss st su sv sw ev ew sx sy sz fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tt l"><div class="ry bh r tu tv tw tx ty"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf tf mr mt mu mv mx my mz nb nc nd nf ng nh nj nk bk">No responses yet</h2><div class="ab tz"><div><div class="bm" aria-hidden="false"><a class="ua ub" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--7963900494b5--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="uc ud ue uf ug l"></div></div></div></div><div class="uh ui uj uk ul l bx"><div class="h k j"><div class="ry bh um un"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="uo ab ke iv"><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/about?autoplay=1&amp;source=post_page-----7963900494b5--------------------------------"><p class="bf b dv z du">About</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----7963900494b5--------------------------------"><p class="bf b dv z du">Careers</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="up uq l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----7963900494b5--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="up l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----7963900494b5--------------------------------"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20241216-164309-0d4958d8a6"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-7963900494b5","user-bbc74ef8ef79"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"943568a4-50e7-43c9-bc8e-04313c95aa1e","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-8276ea6eb4284b6c4dbe2948b4408d76-7d6bf6b275cd2852-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@crovax\u002Fextracting-hancitors-configuration-with-ghidra-7963900494b5","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20241216-164309-0d4958d8a6","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20241216-164309-0d4958d8a6","commit":"0d4958d8a6e728d0bc7ba6245eaad002411a6eb7"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"medium.com\"})":null,"postResult({\"id\":\"7963900494b5\"})":{"__ref":"Post:7963900494b5"}},"LinkedAccounts:bbc74ef8ef79":{"__typename":"LinkedAccounts","mastodon":null,"id":"bbc74ef8ef79"},"Membership:d779db41009a":{"__typename":"Membership","tier":"MEMBER","id":"d779db41009a"},"User:bbc74ef8ef79":{"__typename":"User","id":"bbc74ef8ef79","linkedAccounts":{"__ref":"LinkedAccounts:bbc74ef8ef79"},"isSuspended":false,"name":"Crovax","imageId":"1*PZTWZlkG3FJWX_MxK5Hw4Q.jpeg","customDomainState":null,"hasSubdomain":false,"username":"crovax","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":32,"followingCount":10,"collectionFollowingCount":1},"bio":"There and Back Again — A Reverser’s Tale.","membership":{"__ref":"Membership:d779db41009a"},"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:bbc74ef8ef79-viewerId:lo_d2fca2008016"},"twitterScreenName":""},"Paragraph:79e42e6f5f71_0":{"__typename":"Paragraph","id":"79e42e6f5f71_0","name":"ad2a","type":"H3","href":null,"layout":null,"metadata":null,"text":"Extracting Hancitor’s Configuration with Ghidra part 1","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_1":{"__typename":"Paragraph","id":"79e42e6f5f71_1","name":"7865","type":"H3","href":null,"layout":null,"metadata":null,"text":"Topics covered","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_2":{"__typename":"Paragraph","id":"79e42e6f5f71_2","name":"a11b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Locate the decryption function","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_3":{"__typename":"Paragraph","id":"79e42e6f5f71_3","name":"9ac4","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Determine the decryption algorithm","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_4":{"__typename":"Paragraph","id":"79e42e6f5f71_4","name":"b027","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Build Ghidra script to decrypt the configuration file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_5":{"__typename":"Paragraph","id":"79e42e6f5f71_5","name":"5c35","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Build yara detection rule (In part 2)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_6":{"__typename":"Paragraph","id":"79e42e6f5f71_6","name":"f8ec","type":"H3","href":null,"layout":null,"metadata":null,"text":"Hancitor Overview","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_7":{"__typename":"Paragraph","id":"79e42e6f5f71_7","name":"5a18","type":"P","href":null,"layout":null,"metadata":null,"text":"Hancitor is an older malware loader that is known to drop additional malware on to the system once infected (cobalt strike and some ransomware variants). The entry point is from your typical malspam campaign, that contains a link to an office doc or already has one embedded in the email.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_8":{"__typename":"Paragraph","id":"79e42e6f5f71_8","name":"80cc","type":"P","href":null,"layout":null,"metadata":null,"text":"The original dll is usually packed, and once unpacked, will execute the hancitor payload and reach out to one of its hard coded c2's.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_9":{"__typename":"Paragraph","id":"79e42e6f5f71_9","name":"70d8","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Original packed samples:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_10":{"__typename":"Paragraph","id":"79e42e6f5f71_10","name":"d2d3","type":"P","href":null,"layout":null,"metadata":null,"text":"https:\u002F\u002Fwww.malware-traffic-analysis.net\u002F2021\u002F06\u002F17\u002Findex.html","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":62,"href":"https:\u002F\u002Fwww.malware-traffic-analysis.net\u002F2021\u002F06\u002F17\u002Findex.html","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_11":{"__typename":"Paragraph","id":"79e42e6f5f71_11","name":"5250","type":"BQ","href":null,"layout":null,"metadata":null,"text":"Unpacked Sample:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_12":{"__typename":"Paragraph","id":"79e42e6f5f71_12","name":"39d4","type":"BQ","href":null,"layout":null,"metadata":null,"text":"SHA-256","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_13":{"__typename":"Paragraph","id":"79e42e6f5f71_13","name":"f486","type":"BQ","href":null,"layout":null,"metadata":null,"text":"882b30e147fe5fa6c79b7c7411ce9d8035086ad2f58650f5d79aadfb2ffd34f4","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_14":{"__typename":"Paragraph","id":"79e42e6f5f71_14","name":"be4b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Locating the decryption function","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_15":{"__typename":"Paragraph","id":"79e42e6f5f71_15","name":"3ec8","type":"P","href":null,"layout":null,"metadata":null,"text":"Hancitor leverages the Windows native Cryptographic Service provider (CSP) context to perform its decryption routine. Knowing that, locating the decryption function will be relatively easy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_16":{"__typename":"Paragraph","id":"79e42e6f5f71_16","name":"3c9d","type":"P","href":null,"layout":null,"metadata":null,"text":"One way, is to load the binary into Ghidra and look at import table list for one of the cryptographic functions (CryptDecrypt, CryptAcquireContextA etc) then follow the referenced function from there.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Cnej7WsFM_HKJ8SWuBG2gw.png":{"__typename":"ImageMetadata","id":"1*Cnej7WsFM_HKJ8SWuBG2gw.png","originalHeight":471,"originalWidth":1571,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_17":{"__typename":"Paragraph","id":"79e42e6f5f71_17","name":"8a66","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Cnej7WsFM_HKJ8SWuBG2gw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_18":{"__typename":"Paragraph","id":"79e42e6f5f71_18","name":"6f7c","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have located the function leveraging the CryptDecrypt routine, we can get a better picture of how the decryption process works. Below is the decompiled view of the function performing the decryption routine. We’ll step through each function to determine how the decryption logic works then start programming it out.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*O1PF2eyPUWAy--lWLMaGSQ.png":{"__typename":"ImageMetadata","id":"1*O1PF2eyPUWAy--lWLMaGSQ.png","originalHeight":597,"originalWidth":1289,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_19":{"__typename":"Paragraph","id":"79e42e6f5f71_19","name":"26f6","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*O1PF2eyPUWAy--lWLMaGSQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_20":{"__typename":"Paragraph","id":"79e42e6f5f71_20","name":"8f1b","type":"H3","href":null,"layout":null,"metadata":null,"text":"CryptAcquireContextA","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_21":{"__typename":"Paragraph","id":"79e42e6f5f71_21","name":"eb42","type":"P","href":null,"layout":null,"metadata":null,"text":"The CryptAcquireContextA function initiates the call to the Cryptographic Service Provider (CSP) to determine what kind of CSP to use for the CryptoAPI functions. This function is straightforward as its role is just to initiate the CSP context for use. We can determine which CSP is going to be used by the first ‘PUSH 0x0\" instruction. Since its a null value being used, the default selection is made (native windows cryptographic service provider).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wO8LGNfzZbiq35vTfi-g7w.png":{"__typename":"ImageMetadata","id":"1*wO8LGNfzZbiq35vTfi-g7w.png","originalHeight":462,"originalWidth":1163,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_22":{"__typename":"Paragraph","id":"79e42e6f5f71_22","name":"6b27","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wO8LGNfzZbiq35vTfi-g7w.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_23":{"__typename":"Paragraph","id":"79e42e6f5f71_23","name":"9d44","type":"H3","href":null,"layout":null,"metadata":null,"text":"CryptCreateHash","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_24":{"__typename":"Paragraph","id":"79e42e6f5f71_24","name":"e557","type":"P","href":null,"layout":null,"metadata":null,"text":"When the CryptCreateHash function is called, it creates the hashing object to be used in the cryptographic routine, and determines the type of hashing algorithm to be used. Once successful, it returns a handle to the object, for subsequent calls to the other cryptographic functions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_25":{"__typename":"Paragraph","id":"79e42e6f5f71_25","name":"f1dc","type":"P","href":null,"layout":null,"metadata":null,"text":"To determine what hashing algorithm is being used, we can look at the ‘Algid’ value that will be pushed on to the stack. In this case, we see the ‘PUSH CALG_SHA1’ instruction is being used. So, we know that the hashing algorithm is SHA1.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*A_AuoTBQjMaN3fsfvFNAfw.png":{"__typename":"ImageMetadata","id":"1*A_AuoTBQjMaN3fsfvFNAfw.png","originalHeight":415,"originalWidth":1180,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_26":{"__typename":"Paragraph","id":"79e42e6f5f71_26","name":"0eb1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*A_AuoTBQjMaN3fsfvFNAfw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_27":{"__typename":"Paragraph","id":"79e42e6f5f71_27","name":"affc","type":"H3","href":null,"layout":null,"metadata":null,"text":"CryptHashData","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_28":{"__typename":"Paragraph","id":"79e42e6f5f71_28","name":"f513","type":"P","href":null,"layout":null,"metadata":null,"text":"This function is going to hash the data passed to it, using the previously specified algorithm(SHA1). But what is being hashed and how do we figure it out?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_29":{"__typename":"Paragraph","id":"79e42e6f5f71_29","name":"e809","type":"P","href":null,"layout":null,"metadata":null,"text":"First we need to look back at the arguments being passed into the function (I have labeled it “Decryption’) to see what data is being passed and where its located.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_30":{"__typename":"Paragraph","id":"79e42e6f5f71_30","name":"56d1","type":"P","href":null,"layout":null,"metadata":null,"text":"by looking at the arguments and their position in which they're being passed in, we need to find out what the data is expecting and where is it located. In order to find this information we can follow the data that is being passed into the function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_31":{"__typename":"Paragraph","id":"79e42e6f5f71_31","name":"b3b5","type":"P","href":null,"layout":null,"metadata":null,"text":"Hint: I have already labeled it 😃","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QMkeojEP9Sl_U5b7hmoxew.png":{"__typename":"ImageMetadata","id":"1*QMkeojEP9Sl_U5b7hmoxew.png","originalHeight":563,"originalWidth":1235,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_32":{"__typename":"Paragraph","id":"79e42e6f5f71_32","name":"c65b","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*QMkeojEP9Sl_U5b7hmoxew.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2463yELD5d5QoHhxZ_HYcA.png":{"__typename":"ImageMetadata","id":"1*2463yELD5d5QoHhxZ_HYcA.png","originalHeight":589,"originalWidth":1625,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_33":{"__typename":"Paragraph","id":"79e42e6f5f71_33","name":"cbdd","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2463yELD5d5QoHhxZ_HYcA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_34":{"__typename":"Paragraph","id":"79e42e6f5f71_34","name":"ec83","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, the third argument being passed is a pointer to the ‘key’ thats going to be hashed, and the argument being passed to the right of it (8) is the key length.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_35":{"__typename":"Paragraph","id":"79e42e6f5f71_35","name":"b60c","type":"P","href":null,"layout":null,"metadata":null,"text":"so we know the following:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_36":{"__typename":"Paragraph","id":"79e42e6f5f71_36","name":"dfad","type":"P","href":null,"layout":null,"metadata":null,"text":"Key = b’\\xb3\\x03\\x18\\xaa\\x0a\\xd2\\x77\\xde’","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_37":{"__typename":"Paragraph","id":"79e42e6f5f71_37","name":"a09d","type":"P","href":null,"layout":null,"metadata":null,"text":"Key length = 8 bytes","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":10,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_38":{"__typename":"Paragraph","id":"79e42e6f5f71_38","name":"a64c","type":"H3","href":null,"layout":null,"metadata":null,"text":"CryptDeriveKey","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_39":{"__typename":"Paragraph","id":"79e42e6f5f71_39","name":"e76e","type":"P","href":null,"layout":null,"metadata":null,"text":"This next part is going to be a bit tricky. The CryptDeriveKey is going to accept a few parameters:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_40":{"__typename":"Paragraph","id":"79e42e6f5f71_40","name":"608c","type":"P","href":null,"layout":null,"metadata":null,"text":"hProv = handle to the cryptographic service provided being used.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":6,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_41":{"__typename":"Paragraph","id":"79e42e6f5f71_41","name":"54bc","type":"P","href":null,"layout":null,"metadata":null,"text":"Algid = algorithm for which the key is to be generated. In this case, its going to be RC4.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_42":{"__typename":"Paragraph","id":"79e42e6f5f71_42","name":"c9bf","type":"P","href":null,"layout":null,"metadata":null,"text":"hHash or hBaseData = handle to the hash object that points to the data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_43":{"__typename":"Paragraph","id":"79e42e6f5f71_43","name":"3286","type":"P","href":null,"layout":null,"metadata":null,"text":"dwFlags = this is going to be key length that is going to be used. Which is the lower 16 bits of the value being passed. In our case that value is 0x00280011, so we only want the lower values or 0x0028 (we can truncate the leading zeros). So by dividing 0x28 \u002F key length(8) that was being passed to the CryptHashData function, we know how many bytes of the RC4 key is going to be used to decrypt the configuration data.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_44":{"__typename":"Paragraph","id":"79e42e6f5f71_44","name":"e30c","type":"P","href":null,"layout":null,"metadata":null,"text":"RC4 key: 0x28 \u002F 8 = (5 bytes)","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*3R-8QV9CBii2KS_TXnqkmA.png":{"__typename":"ImageMetadata","id":"1*3R-8QV9CBii2KS_TXnqkmA.png","originalHeight":444,"originalWidth":1748,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_45":{"__typename":"Paragraph","id":"79e42e6f5f71_45","name":"9925","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*3R-8QV9CBii2KS_TXnqkmA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_46":{"__typename":"Paragraph","id":"79e42e6f5f71_46","name":"0997","type":"H3","href":null,"layout":null,"metadata":null,"text":"CryptDecrypt","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_47":{"__typename":"Paragraph","id":"79e42e6f5f71_47","name":"166f","type":"P","href":null,"layout":null,"metadata":null,"text":"This function is straightforward, it accepts the data to be decrypted, the key used, and the length of the data as parameters. To verify, we can once again look at the arguments that are being passed to the function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*F8Yo-6FGQbFiaTAYW8CrWQ.png":{"__typename":"ImageMetadata","id":"1*F8Yo-6FGQbFiaTAYW8CrWQ.png","originalHeight":455,"originalWidth":1740,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_48":{"__typename":"Paragraph","id":"79e42e6f5f71_48","name":"f1f1","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*F8Yo-6FGQbFiaTAYW8CrWQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*2wMFx0VsGW1MmrZJxBul4A.png":{"__typename":"ImageMetadata","id":"1*2wMFx0VsGW1MmrZJxBul4A.png","originalHeight":319,"originalWidth":1746,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_49":{"__typename":"Paragraph","id":"79e42e6f5f71_49","name":"bca4","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2wMFx0VsGW1MmrZJxBul4A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_50":{"__typename":"Paragraph","id":"79e42e6f5f71_50","name":"fa35","type":"P","href":null,"layout":null,"metadata":null,"text":"based on the value being passed in, we can see the encrypted data length is equal to 0x2000 bytes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_51":{"__typename":"Paragraph","id":"79e42e6f5f71_51","name":"ee79","type":"P","href":null,"layout":null,"metadata":null,"text":"Below is a graphical representation of the actions performed thus far.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*sa3RvlyN0JNbKP1ScwzaUQ.png":{"__typename":"ImageMetadata","id":"1*sa3RvlyN0JNbKP1ScwzaUQ.png","originalHeight":663,"originalWidth":1117,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_52":{"__typename":"Paragraph","id":"79e42e6f5f71_52","name":"e02e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sa3RvlyN0JNbKP1ScwzaUQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_53":{"__typename":"Paragraph","id":"79e42e6f5f71_53","name":"1ccc","type":"H3","href":null,"layout":null,"metadata":null,"text":"Creating the Ghidra script","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_54":{"__typename":"Paragraph","id":"79e42e6f5f71_54","name":"cf29","type":"P","href":null,"layout":null,"metadata":null,"text":"We now understand how the decryption process works. The next step is to create a script in Ghidra to automate this whole process, so we can extract the build\u002Fcampaign id and the c2 domains from this sample.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_55":{"__typename":"Paragraph","id":"79e42e6f5f71_55","name":"c867","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: the python script can be downloaded from my github (link here). Your cursor needs to be pointing to the first address of the encrypted data before running the script. This is due to the ‘currentAddress’ method.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":63,"end":67,"href":"https:\u002F\u002Fgithub.com\u002FCrovaxTheCursed\u002FCrovaxTheCursed\u002Ftree\u002Fmain\u002FMalware_Analysis\u002FHancitor_Ghidra_Script","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_56":{"__typename":"Paragraph","id":"79e42e6f5f71_56","name":"882a","type":"P","href":null,"layout":null,"metadata":null,"text":"We know we need to create a sha1 hash of the 8 byte key that’s being passed into the Decryption function. So we can copy those bytes out of Ghidra and store them into a variable. The next step is to get a hash (sha1) of the key and extract the first 5 bytes (Key Hash: a956a1e6ff).","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_57":{"__typename":"Paragraph","id":"79e42e6f5f71_57","name":"f07c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import hashlib \nimport binascii","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_58":{"__typename":"Paragraph","id":"79e42e6f5f71_58","name":"2fd1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"key_bytes = ‘\\xb3\\x03\\x18\\xaa\\x0a\\xd2\\x77\\xde’\nprint ‘key length’, len(key_bytes)\nget_hash = hashlib.sha1()\nget_hash.update(key_bytes)\nkey_hash = get_hash.digest()[:5]","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":167,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_59":{"__typename":"Paragraph","id":"79e42e6f5f71_59","name":"2006","type":"P","href":null,"layout":null,"metadata":null,"text":"Next we need to get the encrypted data using ghidra’s getBytes function, and then perform any necessary conversions on the hex values","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_60":{"__typename":"Paragraph","id":"79e42e6f5f71_60","name":"c7b1","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def get_encrypted_bytes():   \n    get_addr = currentAddress\n    get_bytes = list(getBytes(get_addr, 2000))\n    converted_bytes = ''\n    cByte = ''\n    for byte in get_bytes:\n        if byte \u003C 0:\n            cByte = (0xff - abs(byte) + 1)\n        else:\n            cByte = byte\n        converted_bytes += chr(cByte)\n        \n    return converted_bytes","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_61":{"__typename":"Paragraph","id":"79e42e6f5f71_61","name":"bb27","type":"P","href":null,"layout":null,"metadata":null,"text":"We now have our key and the encrypted data we need to decrypt. The last step is to pass these parameters to a our rc4 decryption function to perform the remaining steps.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_62":{"__typename":"Paragraph","id":"79e42e6f5f71_62","name":"7f66","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def rc4_decrypt(key, data):\n    x = 0\n    box = range(256)\n    for i in range(256):\n        x = (x + box[i] + ord(key[i % len(key)])) % 256\n        box[i], box[x] = box[x], box[i]\n    x = 0\n    y = 0\n    out = []\n    for char in data:\n        x = (x + 1) % 256\n        y = (y + box[x]) % 256\n        box[x], box[y] = box[y], box[x]\n        out.append(chr(ord(char) ^ box[(box[x] + box[y]) % 256]))\n    return ''.join(out)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_63":{"__typename":"Paragraph","id":"79e42e6f5f71_63","name":"58bd","type":"P","href":null,"layout":null,"metadata":null,"text":"Now that we have our decrypted data, we just need to format the data we want and discard any null bytes.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_64":{"__typename":"Paragraph","id":"79e42e6f5f71_64","name":"8a3b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"print 'Current Address:', currentAddress \nprint 'Key Hash:',binascii.hexlify(key_hash)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_65":{"__typename":"Paragraph","id":"79e42e6f5f71_65","name":"39b3","type":"PRE","href":null,"layout":null,"metadata":null,"text":"get_data = get_encrypted_bytes()","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_66":{"__typename":"Paragraph","id":"79e42e6f5f71_66","name":"e806","type":"PRE","href":null,"layout":null,"metadata":null,"text":"config =  rc4_decrypt(key_hash, get_data)\nbuild_id = config.split('\\x00')[0]\nprint  'Build_id:', build_id","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_67":{"__typename":"Paragraph","id":"79e42e6f5f71_67","name":"f546","type":"PRE","href":null,"layout":null,"metadata":null,"text":"for string in config.split('\\x00')[1:]:\n    if string != '':\n        c2 = string\n        break\nc2_List = c2.split('|')","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_68":{"__typename":"Paragraph","id":"79e42e6f5f71_68","name":"5231","type":"PRE","href":null,"layout":null,"metadata":null,"text":"for c2 in c2_List:\n    if c2 != '':\n        print 'c2:', c2","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_69":{"__typename":"Paragraph","id":"79e42e6f5f71_69","name":"c415","type":"P","href":null,"layout":null,"metadata":null,"text":"The output should look something like this 😃","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VF48UKBfq-QQi-JJHV7hBQ.png":{"__typename":"ImageMetadata","id":"1*VF48UKBfq-QQi-JJHV7hBQ.png","originalHeight":471,"originalWidth":927,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:79e42e6f5f71_70":{"__typename":"Paragraph","id":"79e42e6f5f71_70","name":"2693","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VF48UKBfq-QQi-JJHV7hBQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_71":{"__typename":"Paragraph","id":"79e42e6f5f71_71","name":"2602","type":"P","href":null,"layout":null,"metadata":null,"text":"Decode_Config.py\u003E Running…\nkey length 8\nCurrent Address: 005c5018\nKey Hash: a956a1e6ff\nBuild_id: 1706_apkreb6\nc2: http:\u002F\u002Fthestaccultur.com\u002F8\u002Fforum[.]php\nc2: http:\u002F\u002Farguendinfuld.ru\u002F8\u002Fforum[.]php\nc2: http:\u002F\u002Fwaxotheousch.ru\u002F8\u002Fforum[.]php","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"EM","start":0,"end":235,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_72":{"__typename":"Paragraph","id":"79e42e6f5f71_72","name":"e4d5","type":"H3","href":null,"layout":null,"metadata":null,"text":"Conclusion","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_73":{"__typename":"Paragraph","id":"79e42e6f5f71_73","name":"6540","type":"P","href":null,"layout":null,"metadata":null,"text":"By breaking down the individual functions of the decryption routine we were able to determine how hancitor was decrypting its c2 domain configuration. We then applied the same process in creating a Ghidra script to automatically perform the same steps statically, to reveal the encrypted data.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_74":{"__typename":"Paragraph","id":"79e42e6f5f71_74","name":"f198","type":"P","href":null,"layout":null,"metadata":null,"text":"In part 2, we well take a similar approach and build a yara rule to test our theory and see if we can detect multiple hancitor variants.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:79e42e6f5f71_75":{"__typename":"Paragraph","id":"79e42e6f5f71_75","name":"0dc7","type":"P","href":null,"layout":null,"metadata":null,"text":"As always, Don’t expect much, as I have no clue what I’m doing. 😃","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:bbc74ef8ef79-viewerId:lo_d2fca2008016":{"__typename":"UserViewerEdge","id":"userId:bbc74ef8ef79-viewerId:lo_d2fca2008016","isMuting":false},"PostViewerEdge:postId:7963900494b5-viewerId:lo_d2fca2008016":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:7963900494b5-viewerId:lo_d2fca2008016"},"Tag:malware":{"__typename":"Tag","id":"malware","displayTitle":"Malware","normalizedTagSlug":"malware"},"Tag:ghidra":{"__typename":"Tag","id":"ghidra","displayTitle":"Ghidra","normalizedTagSlug":"ghidra"},"Post:7963900494b5":{"__typename":"Post","id":"7963900494b5","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"a173","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"f0d9","startIndex":1,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6fb2","startIndex":14,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:79e42e6f5f71_0"},{"__ref":"Paragraph:79e42e6f5f71_1"},{"__ref":"Paragraph:79e42e6f5f71_2"},{"__ref":"Paragraph:79e42e6f5f71_3"},{"__ref":"Paragraph:79e42e6f5f71_4"},{"__ref":"Paragraph:79e42e6f5f71_5"},{"__ref":"Paragraph:79e42e6f5f71_6"},{"__ref":"Paragraph:79e42e6f5f71_7"},{"__ref":"Paragraph:79e42e6f5f71_8"},{"__ref":"Paragraph:79e42e6f5f71_9"},{"__ref":"Paragraph:79e42e6f5f71_10"},{"__ref":"Paragraph:79e42e6f5f71_11"},{"__ref":"Paragraph:79e42e6f5f71_12"},{"__ref":"Paragraph:79e42e6f5f71_13"},{"__ref":"Paragraph:79e42e6f5f71_14"},{"__ref":"Paragraph:79e42e6f5f71_15"},{"__ref":"Paragraph:79e42e6f5f71_16"},{"__ref":"Paragraph:79e42e6f5f71_17"},{"__ref":"Paragraph:79e42e6f5f71_18"},{"__ref":"Paragraph:79e42e6f5f71_19"},{"__ref":"Paragraph:79e42e6f5f71_20"},{"__ref":"Paragraph:79e42e6f5f71_21"},{"__ref":"Paragraph:79e42e6f5f71_22"},{"__ref":"Paragraph:79e42e6f5f71_23"},{"__ref":"Paragraph:79e42e6f5f71_24"},{"__ref":"Paragraph:79e42e6f5f71_25"},{"__ref":"Paragraph:79e42e6f5f71_26"},{"__ref":"Paragraph:79e42e6f5f71_27"},{"__ref":"Paragraph:79e42e6f5f71_28"},{"__ref":"Paragraph:79e42e6f5f71_29"},{"__ref":"Paragraph:79e42e6f5f71_30"},{"__ref":"Paragraph:79e42e6f5f71_31"},{"__ref":"Paragraph:79e42e6f5f71_32"},{"__ref":"Paragraph:79e42e6f5f71_33"},{"__ref":"Paragraph:79e42e6f5f71_34"},{"__ref":"Paragraph:79e42e6f5f71_35"},{"__ref":"Paragraph:79e42e6f5f71_36"},{"__ref":"Paragraph:79e42e6f5f71_37"},{"__ref":"Paragraph:79e42e6f5f71_38"},{"__ref":"Paragraph:79e42e6f5f71_39"},{"__ref":"Paragraph:79e42e6f5f71_40"},{"__ref":"Paragraph:79e42e6f5f71_41"},{"__ref":"Paragraph:79e42e6f5f71_42"},{"__ref":"Paragraph:79e42e6f5f71_43"},{"__ref":"Paragraph:79e42e6f5f71_44"},{"__ref":"Paragraph:79e42e6f5f71_45"},{"__ref":"Paragraph:79e42e6f5f71_46"},{"__ref":"Paragraph:79e42e6f5f71_47"},{"__ref":"Paragraph:79e42e6f5f71_48"},{"__ref":"Paragraph:79e42e6f5f71_49"},{"__ref":"Paragraph:79e42e6f5f71_50"},{"__ref":"Paragraph:79e42e6f5f71_51"},{"__ref":"Paragraph:79e42e6f5f71_52"},{"__ref":"Paragraph:79e42e6f5f71_53"},{"__ref":"Paragraph:79e42e6f5f71_54"},{"__ref":"Paragraph:79e42e6f5f71_55"},{"__ref":"Paragraph:79e42e6f5f71_56"},{"__ref":"Paragraph:79e42e6f5f71_57"},{"__ref":"Paragraph:79e42e6f5f71_58"},{"__ref":"Paragraph:79e42e6f5f71_59"},{"__ref":"Paragraph:79e42e6f5f71_60"},{"__ref":"Paragraph:79e42e6f5f71_61"},{"__ref":"Paragraph:79e42e6f5f71_62"},{"__ref":"Paragraph:79e42e6f5f71_63"},{"__ref":"Paragraph:79e42e6f5f71_64"},{"__ref":"Paragraph:79e42e6f5f71_65"},{"__ref":"Paragraph:79e42e6f5f71_66"},{"__ref":"Paragraph:79e42e6f5f71_67"},{"__ref":"Paragraph:79e42e6f5f71_68"},{"__ref":"Paragraph:79e42e6f5f71_69"},{"__ref":"Paragraph:79e42e6f5f71_70"},{"__ref":"Paragraph:79e42e6f5f71_71"},{"__ref":"Paragraph:79e42e6f5f71_72"},{"__ref":"Paragraph:79e42e6f5f71_73"},{"__ref":"Paragraph:79e42e6f5f71_74"},{"__ref":"Paragraph:79e42e6f5f71_75"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:bbc74ef8ef79"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@crovax\u002Fextracting-hancitors-configuration-with-ghidra-7963900494b5","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"79e42e6f5f71","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":0,"allowResponses":true,"isLimitedState":false,"title":"Extracting Hancitor’s Configuration with Ghidra part 1","isSeries":false,"sequence":null,"uniqueSlug":"extracting-hancitors-configuration-with-ghidra-7963900494b5","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1642777567174,"readingTime":6.115094339622641,"previewContent":{"__typename":"PreviewContent","subtitle":"Topics covered"},"previewImage":{"__ref":"ImageMetadata:1*Cnej7WsFM_HKJ8SWuBG2gw.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1640649273109,"updatedAt":1642777577440,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:7963900494b5-viewerId:lo_d2fca2008016"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:malware"},{"__ref":"Tag:ghidra"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1276,"layerCake":0,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"MISS"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.48bdf878.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.872afbe3.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9898.d9e26c5e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.247b1d02.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.cd03f950.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2420.2a5e2d95.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.0350840b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.73a57633.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.7749bc66.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.2dc8b1c6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.d5e0c2f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.7ad7ca92.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'8f3d99e79acfcad7',t:'MTczNDUwODYzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"8f3d99e79acfcad7","version":"2024.10.5","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>