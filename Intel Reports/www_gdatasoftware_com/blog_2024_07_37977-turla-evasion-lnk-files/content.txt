<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8">  <title>Turla: A Master of Deception</title> <meta http-equiv="x-ua-compatible" content="IE=edge" /> <meta name="generator" content="TYPO3 CMS" /> <meta name="description" content="Turla, a well-known piece of malware, has taken to weaponising LNK-files to infect computers. We have observed a current example of this." /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="application-name" content="G DATA | Trust in German Sicherheit" /> <meta http-equiv="content-language" content="en" /> <meta property="og:title" content="Turla: A Master of Deception" /> <meta property="og:description" content="Turla, a well-known piece of malware, has taken to weaponising LNK-files to infect computers. We have observed a current example of this. Learn more about the details in this article!" /> <meta property="og:image" content="https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2024/07/G_DATA_Blog_Turla2024_OGTag.jpg" /> <meta property="og:image:url" content="https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2024/07/G_DATA_Blog_Turla2024_OGTag.jpg" /> <meta property="og:image:width" content="1200" /> <meta property="og:image:height" content="630" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Turla: A Master of Deception" /> <meta name="twitter:description" content="Turla, a well-known piece of malware, has taken to weaponising LNK-files to infect computers. We have observed a current example of this. Learn more about the details in this article!" /> <meta name="twitter:image" content="https://www.gdatasoftware.com/fileadmin/user_upload/Presse/Deutschland/2024/07/G_DATA_Blog_Turla2024_OGTag.jpg" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="msapplication-navbutton-color" content="#1e1e1e" /> <meta name="yandex-verification" content="4cf0234eb3af74fb" /> <meta name="dc.title" content="Turla: A Master of Deception" /> <meta name="date" content="2024-07-05T09:30:17" /> <meta name="dc.date" content="2024-07-05T09:30:17" /> <meta name="copyright" content="G DATA CyberDefense AG, 2024. All rights reserved." /> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/basic-styles.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/font/gcon.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/font/source-sans-pro.css?1729663114" media="all"> <link rel="stylesheet" href="/typo3conf/ext/gd_sites/Resources/Public/Styles/assets/prism.css?1729663114" media="all"> <link href="/typo3conf/ext/gd_sites/Resources/Public/Styles/elements/menu-2019.css?1729663114" rel="stylesheet" > <link href="/typo3conf/ext/gd_sites/Resources/Public/Styles/assets/blogpage.css?1729663114" rel="stylesheet" > <script type="text/javascript" data-cmp-ab="1" src="https://cdn.consentmanager.net/delivery/autoblocking/fe6daaf9c1a67.js" data-cmp-host="b.delivery.consentmanager.net" data-cmp-cdn="cdn.consentmanager.net" data-cmp-codesrc="0"></script> <script>
    function setOffline(e,o) {o.dontshow = 1;}
    if (window.location.href.indexOf('gd-ncb=2') !== -1 || window.sessionStorage.getItem('gd_no-tracking') === 'true') {
        __cmp("addEventListener",["init",setOffline,false],null);
        __cmp("addEventListener",["settings",setOffline,false],null);
        window.sessionStorage.setItem('gd_no-tracking', 'true');
    }
  </script> <link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="alternate" type="application/atom+xml" title="G DATA SecurityBlog (deutsch)" href="https://feeds.feedblitz.com/GDataSecurityBlog-DE&x=1" /> <link rel="alternate" type="application/atom+xml" title="G DATA SecurityBlog (english)" href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&x=1" /><meta name="author" content="G DATA Security Lab"><meta name="DC.author" content="G DATA Security Lab"> <link rel="dns-prefetch" href="//file.gdatasoftware.com"> <link rel="dns-prefetch" href="//static.gdatasoftware.com"> <link rel="dns-prefetch" href="//www.google-analytics.com"> <link rel="dns-prefetch" href="//www.googletagmanager.com"> <link rel="canonical" href="https://www.gdatasoftware.com/blog/2024/07/37977-turla-evasion-lnk-files"/>  <script type="application/ld+json">[{"@context":"https:\/\/www.schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.gdatasoftware.com\/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/www.gdatasoftware.com\/blog","name":"Blog (EN)"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.gdatasoftware.com\/blog\/2024\/07\/37977-turla-evasion-lnk-files","name":"A Master\u2019s Art of Evasion"}}]}]</script> </head> <body id="page-37977" class="fe-0 be-"> <div id="outer-wrap"> <header id="site-header" class="height-auto"> <div class="menu-overlay" data-menu-close></div> <div id="mobile-head" data-menu-website="blog" class="clearfix hide-for-large"> <a href="/blog" id="mobile-logo"> <div class="logo"> <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-dark.svg" alt="G DATA Logo" height="40""/> </div> </a> <a id="service-nav-trigger"><span>MENU</span> <div id="hamburger" class="hamburger-icon-container"> <span class="hamburger-icon"></span> </div> </a> </div> <div id="main-navi" data-menu-website="blog" class="logged-in main-navi-before"> <div class="level-1 flex-container"> <div class="logo show-for-large"> <a href="/blog" > <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-dark.svg" alt="G DATA Logo" height="40"/> </a> </div> <nav role="navigation"> <ul class="menu"> <li> <a class="effect-underline" href="/blog/awareness">Awareness</a> </li> <li> <a class="effect-underline" href="/blog/g-data-campues">G DATA Campus</a> </li> <li> <a class="effect-underline" href="/blog/smb-secuerity">SMB Security</a> </li> <li> <a class="effect-underline" href="/blog/tips-and-tricks">Tips and tricks</a> </li> <li> <a class="effect-underline" href="/blog/techblog">Techblog</a> </li> <li class="ar pop-up choose-language"> <a href="https://www.gdata.de/blog"> <img src="/typo3conf/ext/gd_sites/Resources/Public/Images/Flags/DE.svg" style="height:20px" alt="Switch to german version" /> </a> </li> <li class="ar pop-up rss"> <a href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&amp;x=1" target="_blank" rel="noreferrer"> <i class="icon-rss"></i><span class="title"></span> </a> </li> </ul> </nav> <div class="blog-subwrap"> <ul class="blog-subnavi"> <li> <a class="nav-link" href="/blog/ransomware">Ransomware</a> </li> <li> <a class="nav-link" href="/blog/warning">Warning</a> </li> <li> <a class="nav-link" href="/blog/malware">Malware</a> </li> <li> <a class="nav-link" href="/blog/cybercrime">CyberCrime</a> </li> <li> <a class="nav-link" href="/blog/exploits">Exploits</a> </li> <li> <a class="nav-link" href="/blog/phishing">Phishing</a> </li> <li> <a class="nav-link" href="/blog/bots-botnets">Bots &amp; Botnets</a> </li> </ul> <div class="searchbox"> <form action="/blog/search" method="GET"> <input type="text" name="tx_kesearch_pi1[sword]" placeholder="search phrase" /> <button data-trigger-searchinput type="button"><i class="icon-search"></i></button> </form> </div> </div> </div> </div> </header> <div id="inner-wrap"> <div id="main" role="main"> <div class="row expanded blog-head-container"> <div class="pagenews-header blogpage-header text-white bg-right bgm-left"> <div class="outer"> <div class="inner v-middle"> <header> <h1><span>Turla: </span>A Master’s Art of Evasion</h1> <span itemprop="dateCreated">07/05/2024 </span> </header> </div> </div> <span class="cat-title">G DATA <strong>Blog</strong></span> <span class="cat-icon"><i class="icon-blog has-top top"></i></span> </div> <style> .blogpage-header { background-image:url(/fileadmin/user_upload/Presse/Deutschland/2024/07/G_DATA_Blog_Turla2024_Header.jpg); } @media only screen and (max-width: 767px) { .blogpage-header { background-image:url(/fileadmin/_processed_/4/1/G_DATA_Blog_Turla2024_Header_743738dd10.jpg); }} </style> </div> <div class="row"> <div class="column small-12 medium-12 large-9" id="blogpage-content-container"> <div class="row"> <div class="column fce small-12"> <p class="intro-text">Turla, a well-known piece of malware, has taken to weaponising LNK-files to infect computers. We have observed a current example of this. Learn more about the details in this article!</p> </div> </div> <div class="row hide-for-large"> <div class="column small-12"> <div class="pagenews-progress"> <div class="reading-time"> <span class="eta"></span> <span class="word-count"></span> </div> <div data-sticky-container id="mobile-progress-container" class="hide-on-large"> <progress value="0" class="sticky" data-sticky data-margin-top="0" data-sticky-on="small" data-margin-bottom="0" data-top-anchor="mobile-progress-container" data-btm-anchor="site-footer:top"></progress> </div> </div> <nav class="mobile-menu"> <ul class="pagenews-menu"> <li> <a href="#c233912" data-scroll-link> <span>Introduction</span> </a> </li> <li> <a href="#c233913" data-scroll-link> <span>Technical Details</span> </a> </li> <li> <a href="#c233914" data-scroll-link> <span>Intrusion and infection</span> </a> </li> <li> <a href="#c233915" data-scroll-link> <span>Technical Analysis</span> </a> </li> <li> <a href="#c233919" data-scroll-link> <span>The Backdoor</span> </a> </li> <li> <a href="#c233921" data-scroll-link> <span>Backdoor Commands</span> </a> </li> <li> <a href="#c233923" data-scroll-link> <span>Conclusion</span> </a> </li> <li> <a href="#c233925" data-scroll-link> <span>MITRE ATT&amp;CK</span> </a> </li> <li> <a href="#c233926" data-scroll-link> <span>IOC</span> </a> </li> <li> <a href="#pagenews-related-articles"> <span>Related articles</span> </a> </li> </ul> </nav> </div> </div> <div class="row"> <div id="c234012" class="fce column large-12 small-12 frame-layout-0 " ><p><i>An analysis by <i>Ricardo Pineda, Jr. and Arvin Bandong</i></i></p></div> <div data-magellan-target="c233912" class="small-12 column"><div class="row"> <div id="c233912" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h1 class=" "> Introduction </h1></header><p>A shortcut file is a handle in a user interface that allows the user to execute a file or resource located in a different folder which provides convenience to the user in a system. But what if threat actors weaponize it to do their bidding? On the 9th day of May 2024, GDATA analysts observed a possible new campaign that uses malicious shortcut file that leverages on Microsoft's platform for building application to deploy a fileless backdoor into the system. It also employs memory patching, bypass AMSI and disable system’s event logging features to impair system’s defense to enhance its evasion capability. Turla, also known by other names such as "Uroburos" is a name that G DATA researchers are familiar with, since they have contributed to one of the <a href="/blog/2014/02/23968-uroburos-highly-complex-espionage-software-with-russian-roots">first analyses of this Russia-based malware - more than 10 years ago</a>.&nbsp;</p><p>&nbsp;</p></div> </div></div> <div data-magellan-target="c233913" class="small-12 column"><div class="row"> <div id="c233913" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-above"><div class="ce-bodytext"><header class=" "><h1 class=" "> Technical Details </h1></header></div></div></div> </div></div> <div data-magellan-target="c233914" class="small-12 column"><div class="row"> <div id="c233914" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><header class=" "><h2 class=" "> Intrusion and infection </h2></header><p>The malicious shortcut file's package origin is from a compromised website of one of the top newspaper and media outlet from the Philippines, Philippine Daily Inquirer at&nbsp;<strong>hxxps://ies.inquirer.com.ph/--REDACTED--/Advisory23-UCDMS04-11-01.zip</strong></p><p>The infection starts with a malicious package downloaded from a compromised website. The link to the file is potentially distributed through phishing emails that contain the URL of said website. When an unsuspecting user executes the extracted malicious shortcut file from the downloaded package, it will lead to an execution of a PowerShell script that will deploy a fileless backdoor into the system. It leverages Microsoft’s msbuild.exe to implement AWL (Application Whitelist) Bypass to avoid detection. It also creates a scheduled task to serve as part of its persistence method and to maintain its existence in the system to carry out its malicious routines.</p></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_1.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_1.png" width="746" height="344" loading="lazy" alt="" /></a></figure></div></div></div></div> </div></div> <div data-magellan-target="c233915" class="small-12 column"><div class="row"> <div id="c233915" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-above"><div class="ce-bodytext"><header class=" "><h2 class=" "> Technical Analysis </h2></header><p>The malicious shortcut file arrives on the system, masquerading itself as a shortcut file of a normal pdf document. It uses the filename Advisory23-USDMS04-11-01.pdf.lnk, which represents a reference number of Philippine Statistic Authority (PSA) Public Advisory. PSA is the national statistical authority of the Philippines that is responsible for all national censuses and surveys, and compilation of national accounts.</p><p>Upon execution of the malicious shortcut file, it will trigger an execution of a PowerShell script that will drop the following files:</p><p>&nbsp;</p><pre><code class="language-bash">%temp%\ChromeConnection
%temp%\ Advisory23-USDMS04-11-01.pdf
</code></pre></div></div></div> <div id="c233916" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><p>The file Advisory23-USDMS04-11-01.pdf is a benign document that contains the PSA Public Advisory as shown in the figure below:</p></div><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_2.png" class="fancybox"><img class="image-embed-item " src="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_2.png" width="623" height="296" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 2. Decoy PDF Document </figcaption></figure></div></div></div></div> <div id="c233917" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-left"><div class="image-gallery-wrap"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_3.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/2/9/TURLA_Figure_3_8703b89b97.png" width="300" height="95" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 3 PowerShell script embedded in the LNK file </figcaption></figure></div></div></div><p>This document is a decoy which is to detract from of the malicious activities performed in the background by <strong>ChromeConnection</strong>. Said file is a malicious MSBuild project file that will be loaded by msbuild.exe after being triggered by a PowerShell script.</p><p>The project file will only work on 64-bit operating systems as the assembly file indicated in it is located in the Framework64 directory of Microsoft.Net. Upon execution of the project file “ChromeConnection” via msbuild.exe, it creates a scheduled task as part of the malware’s persistence mechanism:</p><p>&nbsp;</p><pre><code class="language-powershell">/create /sc MINUTE /mo 30 /st 07:00:00 /tn "ChromeConnection" /tr "cmd /c start /min 
%windir%\Microsoft.NET\Framework64\v4.0.30319\MSBuild %temp%\ChromeConnection" /f</code></pre><p>&nbsp;</p><p>As we can see, "ChromeConnection" is started every 30 minutes, starting at 7 a.m.<br> Then it loads the obfuscated payload of the project file into the system. This payload is a &nbsp;fileless backdoor.</p></div></div> <div id="c233918" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-above"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/1/a/TURLA_Figure_4_10a49bcadc.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/1/a/TURLA_Figure_4_e07932930a.png" width="1436" height="711" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 4. Obfuscated payload in the MSBuild project file </figcaption></figure></div></div><div class="ce-bodytext"><p>The backdoor is an MSIL compiled binary. It is protected by SmartAssembly, a powerful obfuscation tool that secures an application against disassembly and reverse engineering and some of its codes are hidden, which can be considered as part of its anti-debugging schemes.</p></div></div></div> </div></div> <div data-magellan-target="c233919" class="small-12 column"><div class="row"> <div id="c233919" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-right"><header class=" "><h2 class=" "> The Backdoor </h2></header><div class="image-gallery-wrap"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_5.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/f/4/TURLA_Figure_5_7e4ae966f7.png" width="400" height="253" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 5. Initial communication to the server </figcaption></figure></div></div></div><p>Backdoors such as this one are capable of evading detection by disabling the system’s Event Tracing for Windows (ETW). This feature provides a mechanism to trace and log events that are generated by user-mode applications as well as kernel-mode drivers. The backdoor also performs memory patching on some of the in-memory system module components as part of its anti-detection scheme. Another part of this scheme is the &nbsp;bypassing of the Windows Antimalware Scan Interface (AMSI), a security feature in Windows that enables applications and services to integrate with any antimalware product present on a computer.<br> Next, a connection to its command &amp; control server (c2 server) is established using different URLs. First the malware will establish a connection to the following URL:</p><p>hxxp://files.philbendeck.com/<strong>file</strong>/&lt;computed string encoded ID&gt;.jsp</p><p>This URL is a personal website of an individual whose website was compromised. This connection will verify the continuity of the backdoor’s routine depending on the server’s response.</p></div></div> <div id="c233920" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-center ce-below"><div class="ce-bodytext"><p>Upon successful verification from the server, it will establish connection to the server using the next URL:<br> hxxp://files.philbendeck.com/<strong>help</strong>/&lt;computed string encoded ID&gt;.jsp<br> When connecting to the server, it will transmit commands for the backdoor:This connection will dictate the commands of the backdoor depending on the response of the server.</p></div><div class="ce-gallery row small-up-1 medium-up-2 large-up-2"><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_6.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/f/b/TURLA_Figure_6_81ddaf11ca.png" width="300" height="228" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 6. Communication with the server for the malware’s backdoor commands </figcaption></figure></div><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_7.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/b/4/TURLA_Figure_7_56d01afd95.png" width="300" height="184" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 7. Backdoor commands </figcaption></figure></div></div></div></div> </div></div> <div data-magellan-target="c233921" class="small-12 column"><div class="row"> <div id="c233921" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-right"><header class=" "><h2 class=" "> Backdoor Commands </h2></header><div class="image-gallery-wrap"><div class="ce-gallery row small-up-1 medium-up-1 large-up-1"><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/d/1/TURLA_Figure_8_c4d26d2457.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/d/1/TURLA_Figure_8_45d76ed396.png" width="300" height="76" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 8. Disabling ETW </figcaption></figure></div><div class="column column-block"><figure class="image"><a href="/fileadmin/_processed_/d/1/TURLA_Figure_8_c4d26d2457.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/d/1/TURLA_Figure_8_45d76ed396.png" width="300" height="76" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 9. Disabling event related modules </figcaption></figure></div><div class="column column-block"><figure class="image"><a href="/fileadmin/user_upload/Presse/Deutschland/2024/07/TURLA_Figure_10.png" class="fancybox"><img class="image-embed-item thumbnail" src="/fileadmin/_processed_/3/1/TURLA_Figure_10_7c5fc497c0.png" width="300" height="169" loading="lazy" alt="" /></a><figcaption class="image-caption"> Figure 10. Memory Patching Routine </figcaption></figure></div></div></div><p><strong>ps </strong>creates a PowerShell runspace that will perform the following:</p><ul class="csc-bulletlist-3"><li>disable event related features of the system by disabling the ETW</li><li>disable event related module functions by performing memory patching on in-memory system module components</li><li>disable AMSI scan feature by performing memory patching on in-memory amsi.dll</li><li>execute a PowerShell script received from the server</li></ul><p>All of these are logged and will be sent to the URL hxxp://files.philbendeck.com/<strong>article</strong>/&lt;computed string encoded ID&gt;.jsp<br><br><strong>cps</strong></p><ul class="csc-bulletlist-3"><li>closes the PowerShell runspace</li></ul><p><strong>op</strong></p><ul class="csc-bulletlist-3"><li>reports reconnect, sleep and receive timeout of the backdoor</li><li><p>This information is sent to the server via the following URL: hxxp://files.philbendeck.com/<strong>about</strong>/&lt;computed string encoded ID&gt;.jsp</p></li></ul><p><strong>uf</strong></p><ul class="csc-bulletlist-3"><li>creates a file using the username as its filename, where in the content is received from the server</li></ul></div></div> </div></div> <div data-magellan-target="c233923" class="small-12 column"><div class="row"> <div id="c233923" class="fce column large-12 small-12 frame-layout-0 " ><div class="ce-textpic ce-intext-right"><header class=" "><h1 class=" "> Conclusion </h1></header><div class="image-gallery-wrap"></div><p>Upon analyzing this malware, we were able to find some similarities with other malware utilized by Turla. First, is its use of compromised website as its server. Next, is AMSI bypassing by patching on in-memory amsi.dll. Another one is usage of PowerShell script to load malicious codes in memory which enables it to evade detection. Lastly is execution of other PowerShell scripts provided by the server and reporting the result back to it. We also identified new techniques employed by this malware that are not yet utilized by malware from Turla APT Family.</p><ul class="gcon-list-check-red"><li>Employment of LNK file</li><li>Usage of MSbuild to load project file that will launch fileless backdoor</li><li>Disabling event related module functions by patching on in-memory system module components (advapi32.dll, ntdll.dll)</li><li>Disabling Event Tracing for Windows (ETW)</li></ul></div></div> <div id="c233924" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h1 class=" "> Prevention </h1></header><p>To prevent this kind of malware infecting your system, here are some practical tips:</p><ul class="gcon-list-check-green"><li>Set PowerShell execution policy to execute only signed scripts.</li><li>It may be possible to remove PowerShell from systems when not needed, but a review should be performed to assess the impact on an environment, since it could be in use for many legitimate purposes and administrative functions.</li><li>Disable/restrict the WinRM Service to help prevent uses of PowerShell for remote execution.</li><li>MSBuild.exe may not be necessary within an environment and should be removed if not being used.</li><li>Use application control configured to block execution of msbuild.exe if it is not required for a given system or network to prevent potential misuse by adversaries.</li></ul></div> </div></div> <div data-magellan-target="c233925" class="small-12 column"><div class="row"> <div id="c233925" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h3 class=" "> MITRE ATT&CK </h3></header><table class="table"><thead><tr><th scope="col"><strong>Techniques</strong></th><th scope="col"><strong>Sub-Techniques</strong></th><th scope="col">ID</th><th scope="col">Procedure</th></tr></thead><tbody><tr><td>Masquerading</td><td>&nbsp;</td><td>T1036</td><td>masquerades itself as a shortcut file of a normal pdf document</td></tr><tr><td>Command and Scripting Interpreter</td><td>PowerShell</td><td>T1059.001</td><td>used obfuscated PowerShell to extract an encoded payload from within an .LNK file and open a decoy document</td></tr><tr><td>Impair Defenses</td><td>Disable or Modify Tools</td><td>T1562.001</td><td><p>** performed AMSI bypass, which patches the in-memory amsi.dll</p> ** disable event related module functions by patching in-memory system modules (advapi32.dll, ntdll.dll)</td></tr><tr><td>&nbsp;</td><td>Disable Windows Event Logging</td><td>T1562.002</td><td>disable system's ETW (Event Tracing for Windows)</td></tr><tr><td>Trusted Developer Utilities Proxy Execution</td><td>MSBuild</td><td>T1127.001</td><td>used msbuild to load a malicious project file</td></tr><tr><td>Scheduled Task/Job</td><td>Scheduled Task</td><td>T1053.005</td><td>achieved persistence via scheduled tasks</td></tr><tr><td>Deobfuscate/Decode Files or Information</td><td>&nbsp;</td><td>T1140</td><td>decode information</td></tr><tr><td>Obfuscated Files or Information</td><td>Encrypted/Encoded File</td><td>T1027.013</td><td>encode information</td></tr><tr><td>&nbsp;</td><td>Embedded Payloads</td><td>T1027.009</td><td>loads an embedded payload in the memory</td></tr><tr><td>&nbsp;</td><td>Fileless Storage</td><td>T1027.011</td><td>encoded malicious binary embedded in a project file</td></tr><tr><td>Application Layer Protocol</td><td>Web Protocols</td><td>T1071.001</td><td>use HTTP to communicate with C2 server</td></tr></tbody></table><p>&nbsp;</p></div> </div></div> <div data-magellan-target="c233926" class="small-12 column"><div class="row"> <div id="c233926" class="fce column large-12 small-12 frame-layout-0 " ><header class=" "><h1 class=" "> IOC </h1></header><table class="table" style="height:144px; width:1126px"><tbody><tr><td><strong>SHA256</strong></td><td><strong>Filename</strong></td></tr><tr><td>cac4d4364d20fa343bf681f6544b31995a57d8f69ee606c4675db60be5ae8775</td><td>Advisory23-CDMS04-11-01.pdf.lnk</td></tr><tr><td>c2618fb013135485f9f9aa27983df3371dfdcb7beecde86d02cee0c258d5ed7f</td><td>Advisory23-UCDMS04-11-01.pdf.zip</td></tr><tr><td>b6abbeab6e000036c6cdffc57c096d796397263e280ea264eba73ac5bab39441</td><td>ChromeConnection</td></tr><tr><td>7091ce97fb5906680c1b09558bafdf9681a81f5f524677b90fd0f7fc0a05bc00</td><td>None (extracted embedded binary)</td></tr></tbody></table><table class="table"><tbody><tr><td><strong>URL</strong></td><td><strong>Description</strong></td></tr><tr><td>hxxps://ies.inquirer.com.ph/advprod03/assets/images/Advisory23-UCDMS04-11-01.zip</td><td>Origin of the malicious lnk file's package</td></tr><tr><td>hxxp://files.philbendeck.com/file/&lt;computed string encoded ID&gt;.jsp</td><td>malware server used for connection verification</td></tr><tr><td>hxxp://files.philbendeck.com/help/&lt;computed string encoded ID&gt;.jsp</td><td>malware server used for backdoor commands</td></tr><tr><td>hxxp://files.philbendeck.com/article/&lt;computed string encoded ID&gt;.jsp</td><td>malware server used for reporting of disabling system event features and script execution result</td></tr><tr><td>hxxp://files.philbendeck.com/about/&lt;computed string encoded ID&gt;.jsp</td><td>malware server used for reporting of time of malware's reconnection, sleep and receive timeout</td></tr></tbody></table><p>&nbsp;</p></div> </div></div> </div> </div> <div class="column small-12 medium-12 large-3" id="blogpage-sidebar-container"> <div class="row"> <div class="column small-12 fce"> <div class="pagenews-authorbox"> <div class="media-object"> <div class="media-object-section middle"> <img src="/fileadmin/_processed_/f/8/nopicture_profile_eb01881170.png" srcset="/fileadmin/_processed_/f/8/nopicture_profile_eb01881170.png 1x, /fileadmin/_processed_/f/8/nopicture_profile_7b92a1af7e.png 2x" width="100" height="100"> </div> <div class="media-object-section middle"> <p><strong>from G DATA Security Lab</strong><br/>Virus-Analyst Team</p> </div> </div> </div> </div> </div> <div class="row"> <div id="pagenews-sticky-sidebar-container" class="column small-12" data-sticky-container> <div class="sticky" id="pagenews-sticky-sidebar" data-sticky data-margin-top="0" style="width:100%;" data-deep-linking data-sticky-on="large" data-margin-bottom="0" data-top-anchor="pagenews-sticky-sidebar-container" data-btm-anchor="blogpage-content-container:bottom"> <div class="show-for-large"> <div class="sidebar-socialshare margin-bottom"> <div class="shariff" data-button-style="icon" data-twitter-via="GDATA" data-orientation="horizontal" data-lang="en" data-services="[&quot;twitter&quot;,&quot;xing&quot;,&quot;linkedin&quot;,&quot;facebook&quot;,&quot;reddit&quot]"></div> </div> <div class="pagenews-progress"> <div class="reading-time"> <span class="eta"></span> <span class="word-count"></span> </div> <progress value="0"></progress> </div> <nav data-magellan> <ul class="pagenews-menu"> <li> <a href="#c233912"> <span>Introduction</span> </a> </li> <li> <a href="#c233913"> <span>Technical Details</span> </a> </li> <li> <a href="#c233914"> <span>Intrusion and infection</span> </a> </li> <li> <a href="#c233915"> <span>Technical Analysis</span> </a> </li> <li> <a href="#c233919"> <span>The Backdoor</span> </a> </li> <li> <a href="#c233921"> <span>Backdoor Commands</span> </a> </li> <li> <a href="#c233923"> <span>Conclusion</span> </a> </li> <li> <a href="#c233925"> <span>MITRE ATT&amp;CK</span> </a> </li> <li> <a href="#c233926"> <span>IOC</span> </a> </li> <li> <a href="#pagenews-related-articles"> <span>Related articles</span> </a> </li> </ul> </nav> </div> <div class="row"> <div class="fce column small-12 blog-categories"> <ul> <li><a href="/blog/malware"><span class="label label-default">Malware</span></a></li> <li><a href="/blog/techblog"><span class="label label-default">Techblog</span></a></li> </ul> </div> </div> <div class="row"> </div> </div> </div> </div> </div> </div> <div class="row expanded pagenews-footer" id="blogpage-footer"> <div class="small-12 column"> <div class="row" > <div class="small-12 medium-6 large-3 column fce"> <a class="button expanded no-margin" href="/blog">back to list</a> </div> <div class="small-12 medium-6 large-3 column fce"> <div class="sidebar-socialshare"> <div class="shariff" data-button-style="icon" data-twitter-via="GDATA" data-orientation="horizontal" data-lang="en" data-services="[&quot;twitter&quot;,&quot;xing&quot;,&quot;linkedin&quot;,&quot;facebook&quot;,&quot;reddit&quot]"></div> </div> </div> <div class="small-12 medium-12 large-3 column fce last-update"> </div> </div> </div> </div> <div class="row"> <div class="column small-12 large-12 pagenews-related-articles fce" id="pagenews-related-articles" data-magellan-target="pagenews-related-articles"> <h4>Related articles:</h4> <div class="column small-12 medium-6 guidebook-relatedbox fce"> <a class="media-object" href="/blog/2014/06/23953-analysis-of-uroburos-using-windbg"> <div class="media-object-section middle"> </div> <div class="media-object-section middle"> <h5>Analysis of Uroburos, using WinDbg</h5> <p>Uroburos was already described as a very sophisticated and highly complex malware in our G DATA Red Paper, where we had a look at the malware’s&hellip;</p> </div> </a> </div> </div> </div> </div> <div class="row"><nav id="breadcrumb" class="small-12 columns"><ul class="breadcrumbs"><li class="info-text">You are here:</li><li><a href="/blog"><span>Blog (EN)</span></a></li><li><span>A Master’s Art of Evasion</span></li></ul></nav></div> <footer id="site-footer"> <div class="row flexcontainer"> <div class="logo"> <img src="https://www.gdatasoftware.com/typo3conf/ext/gd_sites/Resources/Public/Images/logo-for-light.svg" alt="G DATA Logo" height="50" style="height: 50px; margin:16px;"/> </div> <div class="socialbar"> <div class="social text-center"> <a href="https://de.linkedin.com/company/g-data-cyberdefense" title="G DATA CyberDefense AG on Linked-In" target="_blank" rel="noreferrer"><i class="icon-linkedin"></i></a><a href="https://www.facebook.com/gdatasoftwareag" title="G DATA CyberDefense AG on Facebook" target="_blank" rel="noreferrer"><i class="icon-facebook"></i></a><a href="https://www.threads.net/@gdatacyberdefense" title="G DATA CyberDefense AG on Threads" target="_blank" rel="noreferrer"><i class="icon-threads"></i></a><a href="https://www.instagram.com/gdatacyberdefense" title="G DATA CyberDefense AG on Instagram" target="_blank" rel="noreferrer"><i class="icon-instagram"></i></a><a href="https://www.youtube.com/user/GDataSoftwareAG" title="G DATA CyberDefense AG on Youtube" target="_blank" rel="noreferrer"><i class="icon-youtube"></i></a><a href="https://feeds.feedblitz.com/GDataSecurityBlog-EN&amp;x=1" target="_blank" rel="noreferrer"><i class="icon-rss"></i></a> </div> </div> </div> <div class="sitemap row small-up-1 medium-up-2 large-up-4"> <div class="column"> <h5>G DATA</h5> <ul> <li> <a href="/about-g-data" data-event-action="click" data-event-category="Menu-Footer" data-event-label="About G DATA">About G DATA</a> </li> <li> <a href="/g-data/newsroom" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Newsroom">Newsroom</a> </li> <li> <a href="/about-g-data/jobs" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Jobs &amp; Career">Jobs &amp; Career</a> </li> <li> <a href="/about-g-data/awards" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Awards">Awards</a> </li> </ul> </div> <div class="column"> <h5>Services</h5> <ul> <li> <a href="/pc/free-trial" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Free Trial">Free Trial</a> </li> <li> <a href="https://www.gdata.de/help/en/business/HowToArtikel/Virenanalyse/DateiURLAppEinsenden/" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Submit a suspicious file, app or URL">Submit a suspicious file, app or URL</a> </li> </ul> </div> <div class="column"> <h5>G DATA Solutions</h5> <ul> <li> <a href="/pc" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Consumer">Consumer</a> </li> <li> <a href="/business" data-event-action="click" data-event-category="Menu-Footer" data-event-label="Business">Business</a> </li> </ul> </div> </div> <div class="row"> <hr/> </div> <div class="footnav row"> <div class="large-7 medium-6 small-12 column imprint"> <a href="/privacy">Data Protection </a><a href="/support/contact">Contact </a><a href="/imprint">Imprint </a><a href="/">gdatasoftware.com </a> </div> <div class="large-5 medium-6 small-12 column copyright"> <span>&copy;&nbsp;2024&nbsp;G DATA CyberDefense AG. All rights reserved.</span> </div> </div> </footer> <a href="#" class="go-top"><i class="icon-angle-up-regular"></i></a> </div> </div> <script src="/typo3temp/assets/compressed/merged-f081765a3ed763d7fe90ca1c11ab5a25.js?1729664179"></script> <script src="/typo3conf/ext/gd_sites/Resources/Public/JavaScript/gd-mainmenu-2019.js?1729663114"></script> <script src="/typo3conf/ext/gd_pagenews/Resources/Public/JavaScript/gd-guidebook.js?1729663114"></script> <script>
            $(document).ready(function() {
				GdScrollIndicator.init('#blogpage-content-container','','');
				GdScrollIndicator.calculateReadingTime([$('#blogpage-content-container'),$('.pagenews-teaser')],{readingTimeTarget:'.eta',wordCountTarget:'.word-count', prependTimeString:'Reading time: ', lessThanAMinuteString:'less then a minute', prependWordString:'(',apendWordString:' words)'});
			});
		</script> <script>
    document.addEventListener( 'DOMContentLoaded', function(e) {
        window.GdTracking = new GdTrackingModule();
        GdTracking.initialize();
    });
</script> <script data-cmp-vendor="s905" type="text/plain" class="cmplazyload">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'analytics_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'wait_for_update': 500
        });

        dataLayer.push({
            'event': 'default_consent'
        });
    </script> <script data-cmp-vendor="s905" type="text/plain" class="cmplazyload">
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NQG4RJ');
    </script> </body> </html>