<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Debugging Injected Code with IDA Pro | malwarereversing</title>
	<!--[if lte IE 8]>
	<link rel="stylesheet" href="https://s2.wp.com/wp-content/themes/pub/chaoticsoul/ie.css" type="text/css" media="screen" />
	<![endif]-->
	<link rel="pingback" href="https://malwarereversing.wordpress.com/xmlrpc.php" />
	<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//widgets.wp.com' />
<link rel="alternate" type="application/rss+xml" title="malwarereversing &raquo; Feed" href="https://malwarereversing.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="malwarereversing &raquo; Comments Feed" href="https://malwarereversing.wordpress.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="malwarereversing &raquo; Debugging Injected Code with IDA&nbsp;Pro Comments Feed" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
	<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s2.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1719498190i&ver=6.8-alpha-59438"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-1' href='https://s1.wp.com/_static/??-eJx9jVsKwjAQRTdkHBoR6Ye4liQd02mTTEgmiLu3FVF84M+Fc7kPuGTlOAkmgdhUDs1TqjChZOPmB0NkXmVoASsUDEZwUJmrfNDW1bqB35OBZnwN3+krbgP7ZyGaMqNQ8sqaAkv03fn3RelMieQKMmJcXnOz4EbDQq5yC2v1FI/dQfd73e86Pd0AvrxijA==&cssminify=yes' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-2-1' href='https://s0.wp.com/_static/??-eJydzEEOAiEMheELCXUGE3VhPAswpOmIQNqi4faObty5cPny8v3wbCbWoqkotNyRigD2bYbEuD2c4DGd7cnuIXTKC4Rc481kCux5gOjIyUaRHfwMfZTAmrT5N/ejdjXItPybYK9UUL78er9MR+fcfHCzW185xE/S&cssminify=yes' type='text/css' media='all' />
<style id='wp-block-library-inline-css'>
.has-text-align-justify {
	text-align:justify;
}
.has-text-align-justify{text-align:justify;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-4-1' href='https://s2.wp.com/_static/??-eJzTLy/QzcxLzilNSS3WzyrWz01NyUxMzUnNTc0rQeEU5CRWphbp5qSmJyZX6uVm5uklFxfr6OPTDpRD5sM02efaGpoZmFkYGRuZGmQBAHPvL0Y=&cssminify=yes' type='text/css' media='all' />
<style id='jetpack-sharing-buttons-style-inline-css'>
.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-8-1' href='https://s1.wp.com/_static/??/wp-content/mu-plugins/core-compat/wp-mediaelement.css,/wp-content/mu-plugins/wpcom-bbpress-premium-themes.css?m=1432920480j&cssminify=yes' type='text/css' media='all' />
<style id='global-styles-inline-css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-family--albert-sans: 'Albert Sans', sans-serif;--wp--preset--font-family--alegreya: Alegreya, serif;--wp--preset--font-family--arvo: Arvo, serif;--wp--preset--font-family--bodoni-moda: 'Bodoni Moda', serif;--wp--preset--font-family--bricolage-grotesque: 'Bricolage Grotesque', sans-serif;--wp--preset--font-family--cabin: Cabin, sans-serif;--wp--preset--font-family--chivo: Chivo, sans-serif;--wp--preset--font-family--commissioner: Commissioner, sans-serif;--wp--preset--font-family--cormorant: Cormorant, serif;--wp--preset--font-family--courier-prime: 'Courier Prime', monospace;--wp--preset--font-family--crimson-pro: 'Crimson Pro', serif;--wp--preset--font-family--dm-mono: 'DM Mono', monospace;--wp--preset--font-family--dm-sans: 'DM Sans', sans-serif;--wp--preset--font-family--dm-serif-display: 'DM Serif Display', serif;--wp--preset--font-family--domine: Domine, serif;--wp--preset--font-family--eb-garamond: 'EB Garamond', serif;--wp--preset--font-family--epilogue: Epilogue, sans-serif;--wp--preset--font-family--fahkwang: Fahkwang, sans-serif;--wp--preset--font-family--figtree: Figtree, sans-serif;--wp--preset--font-family--fira-sans: 'Fira Sans', sans-serif;--wp--preset--font-family--fjalla-one: 'Fjalla One', sans-serif;--wp--preset--font-family--fraunces: Fraunces, serif;--wp--preset--font-family--gabarito: Gabarito, system-ui;--wp--preset--font-family--ibm-plex-mono: 'IBM Plex Mono', monospace;--wp--preset--font-family--ibm-plex-sans: 'IBM Plex Sans', sans-serif;--wp--preset--font-family--ibarra-real-nova: 'Ibarra Real Nova', serif;--wp--preset--font-family--instrument-serif: 'Instrument Serif', serif;--wp--preset--font-family--inter: Inter, sans-serif;--wp--preset--font-family--josefin-sans: 'Josefin Sans', sans-serif;--wp--preset--font-family--jost: Jost, sans-serif;--wp--preset--font-family--libre-baskerville: 'Libre Baskerville', serif;--wp--preset--font-family--libre-franklin: 'Libre Franklin', sans-serif;--wp--preset--font-family--literata: Literata, serif;--wp--preset--font-family--lora: Lora, serif;--wp--preset--font-family--merriweather: Merriweather, serif;--wp--preset--font-family--montserrat: Montserrat, sans-serif;--wp--preset--font-family--newsreader: Newsreader, serif;--wp--preset--font-family--noto-sans-mono: 'Noto Sans Mono', sans-serif;--wp--preset--font-family--nunito: Nunito, sans-serif;--wp--preset--font-family--open-sans: 'Open Sans', sans-serif;--wp--preset--font-family--overpass: Overpass, sans-serif;--wp--preset--font-family--pt-serif: 'PT Serif', serif;--wp--preset--font-family--petrona: Petrona, serif;--wp--preset--font-family--piazzolla: Piazzolla, serif;--wp--preset--font-family--playfair-display: 'Playfair Display', serif;--wp--preset--font-family--plus-jakarta-sans: 'Plus Jakarta Sans', sans-serif;--wp--preset--font-family--poppins: Poppins, sans-serif;--wp--preset--font-family--raleway: Raleway, sans-serif;--wp--preset--font-family--roboto: Roboto, sans-serif;--wp--preset--font-family--roboto-slab: 'Roboto Slab', serif;--wp--preset--font-family--rubik: Rubik, sans-serif;--wp--preset--font-family--rufina: Rufina, serif;--wp--preset--font-family--sora: Sora, sans-serif;--wp--preset--font-family--source-sans-3: 'Source Sans 3', sans-serif;--wp--preset--font-family--source-serif-4: 'Source Serif 4', serif;--wp--preset--font-family--space-mono: 'Space Mono', monospace;--wp--preset--font-family--syne: Syne, sans-serif;--wp--preset--font-family--texturina: Texturina, serif;--wp--preset--font-family--urbanist: Urbanist, sans-serif;--wp--preset--font-family--work-sans: 'Work Sans', sans-serif;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}.has-albert-sans-font-family{font-family: var(--wp--preset--font-family--albert-sans) !important;}.has-alegreya-font-family{font-family: var(--wp--preset--font-family--alegreya) !important;}.has-arvo-font-family{font-family: var(--wp--preset--font-family--arvo) !important;}.has-bodoni-moda-font-family{font-family: var(--wp--preset--font-family--bodoni-moda) !important;}.has-bricolage-grotesque-font-family{font-family: var(--wp--preset--font-family--bricolage-grotesque) !important;}.has-cabin-font-family{font-family: var(--wp--preset--font-family--cabin) !important;}.has-chivo-font-family{font-family: var(--wp--preset--font-family--chivo) !important;}.has-commissioner-font-family{font-family: var(--wp--preset--font-family--commissioner) !important;}.has-cormorant-font-family{font-family: var(--wp--preset--font-family--cormorant) !important;}.has-courier-prime-font-family{font-family: var(--wp--preset--font-family--courier-prime) !important;}.has-crimson-pro-font-family{font-family: var(--wp--preset--font-family--crimson-pro) !important;}.has-dm-mono-font-family{font-family: var(--wp--preset--font-family--dm-mono) !important;}.has-dm-sans-font-family{font-family: var(--wp--preset--font-family--dm-sans) !important;}.has-dm-serif-display-font-family{font-family: var(--wp--preset--font-family--dm-serif-display) !important;}.has-domine-font-family{font-family: var(--wp--preset--font-family--domine) !important;}.has-eb-garamond-font-family{font-family: var(--wp--preset--font-family--eb-garamond) !important;}.has-epilogue-font-family{font-family: var(--wp--preset--font-family--epilogue) !important;}.has-fahkwang-font-family{font-family: var(--wp--preset--font-family--fahkwang) !important;}.has-figtree-font-family{font-family: var(--wp--preset--font-family--figtree) !important;}.has-fira-sans-font-family{font-family: var(--wp--preset--font-family--fira-sans) !important;}.has-fjalla-one-font-family{font-family: var(--wp--preset--font-family--fjalla-one) !important;}.has-fraunces-font-family{font-family: var(--wp--preset--font-family--fraunces) !important;}.has-gabarito-font-family{font-family: var(--wp--preset--font-family--gabarito) !important;}.has-ibm-plex-mono-font-family{font-family: var(--wp--preset--font-family--ibm-plex-mono) !important;}.has-ibm-plex-sans-font-family{font-family: var(--wp--preset--font-family--ibm-plex-sans) !important;}.has-ibarra-real-nova-font-family{font-family: var(--wp--preset--font-family--ibarra-real-nova) !important;}.has-instrument-serif-font-family{font-family: var(--wp--preset--font-family--instrument-serif) !important;}.has-inter-font-family{font-family: var(--wp--preset--font-family--inter) !important;}.has-josefin-sans-font-family{font-family: var(--wp--preset--font-family--josefin-sans) !important;}.has-jost-font-family{font-family: var(--wp--preset--font-family--jost) !important;}.has-libre-baskerville-font-family{font-family: var(--wp--preset--font-family--libre-baskerville) !important;}.has-libre-franklin-font-family{font-family: var(--wp--preset--font-family--libre-franklin) !important;}.has-literata-font-family{font-family: var(--wp--preset--font-family--literata) !important;}.has-lora-font-family{font-family: var(--wp--preset--font-family--lora) !important;}.has-merriweather-font-family{font-family: var(--wp--preset--font-family--merriweather) !important;}.has-montserrat-font-family{font-family: var(--wp--preset--font-family--montserrat) !important;}.has-newsreader-font-family{font-family: var(--wp--preset--font-family--newsreader) !important;}.has-noto-sans-mono-font-family{font-family: var(--wp--preset--font-family--noto-sans-mono) !important;}.has-nunito-font-family{font-family: var(--wp--preset--font-family--nunito) !important;}.has-open-sans-font-family{font-family: var(--wp--preset--font-family--open-sans) !important;}.has-overpass-font-family{font-family: var(--wp--preset--font-family--overpass) !important;}.has-pt-serif-font-family{font-family: var(--wp--preset--font-family--pt-serif) !important;}.has-petrona-font-family{font-family: var(--wp--preset--font-family--petrona) !important;}.has-piazzolla-font-family{font-family: var(--wp--preset--font-family--piazzolla) !important;}.has-playfair-display-font-family{font-family: var(--wp--preset--font-family--playfair-display) !important;}.has-plus-jakarta-sans-font-family{font-family: var(--wp--preset--font-family--plus-jakarta-sans) !important;}.has-poppins-font-family{font-family: var(--wp--preset--font-family--poppins) !important;}.has-raleway-font-family{font-family: var(--wp--preset--font-family--raleway) !important;}.has-roboto-font-family{font-family: var(--wp--preset--font-family--roboto) !important;}.has-roboto-slab-font-family{font-family: var(--wp--preset--font-family--roboto-slab) !important;}.has-rubik-font-family{font-family: var(--wp--preset--font-family--rubik) !important;}.has-rufina-font-family{font-family: var(--wp--preset--font-family--rufina) !important;}.has-sora-font-family{font-family: var(--wp--preset--font-family--sora) !important;}.has-source-sans-3-font-family{font-family: var(--wp--preset--font-family--source-sans-3) !important;}.has-source-serif-4-font-family{font-family: var(--wp--preset--font-family--source-serif-4) !important;}.has-space-mono-font-family{font-family: var(--wp--preset--font-family--space-mono) !important;}.has-syne-font-family{font-family: var(--wp--preset--font-family--syne) !important;}.has-texturina-font-family{font-family: var(--wp--preset--font-family--texturina) !important;}.has-urbanist-font-family{font-family: var(--wp--preset--font-family--urbanist) !important;}.has-work-sans-font-family{font-family: var(--wp--preset--font-family--work-sans) !important;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-10-1' href='https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.css?m=1729082728i&cssminify=yes' type='text/css' media='all' />
<link rel='stylesheet' id='verbum-gutenberg-css-css' href='https://widgets.wp.com/verbum-block-editor/block-editor.css?ver=1721244820' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='all-css-12-1' href='https://s0.wp.com/_static/??-eJx9i0EKgzAQAD/UdBFS1EPpW+KyxsgmG9wNpb+v3vTibQZm4FsdSjEqBrZQJoXaJsAliCVUaQxqP6Ynqj7gFOfmKreYisJGE0vcMcJenfRuiiSOBYMlKRdxM4e0Hesnvzv/Gr0f+s6vf50NPuM=&cssminify=yes' type='text/css' media='all' />
<link crossorigin='anonymous' rel='stylesheet' id='print-css-13-1' href='https://s1.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035i&cssminify=yes' type='text/css' media='print' />
<style id='jetpack-global-styles-frontend-style-inline-css'>
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link crossorigin='anonymous' rel='stylesheet' id='all-css-16-1' href='https://s2.wp.com/_static/??-eJyNjcEKwjAQRH/IuA1aehI/ReImJKmb3eAmFP9eW3oRL16GeTC8gaUaFG6BG5RuKvWYWWEOrTp87AxFZA3fKShocs/gnfevrWaOR1Q9wP+mW2YEFcyODEkU/YIfW0uhfH7TGSLJ3dE6uJaLneww2mkYT/MbUOlJHA==&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack_related-posts-js-extra">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" id="wpcom-actionbar-placeholder-js-extra">
/* <![CDATA[ */
var actionbardata = {"siteID":"19015966","postID":"148","siteURL":"http:\/\/malwarereversing.wordpress.com","xhrURL":"https:\/\/malwarereversing.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"c432faa6c1","isLoggedIn":"","statusMessage":"","subsEmailDefault":"instantly","proxyScriptUrl":"https:\/\/s0.wp.com\/wp-content\/js\/wpcom-proxy-request.js?ver=20211021","shortlink":"https:\/\/wp.me\/p1hMV8-2o","i18n":{"followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar"}};
/* ]]> */
</script>
<script type="text/javascript" id="jetpack-mu-wpcom-settings-js-before">
/* <![CDATA[ */
var JETPACK_MU_WPCOM_SETTINGS = {"assetsUrl":"https:\/\/s1.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/vendor\/automattic\/jetpack-mu-wpcom\/src\/build\/"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/_static/??/wp-content/mu-plugins/jetpack-plugin/moon/_inc/build/related-posts/related-posts.min.js,/wp-content/js/rlt-proxy.js?m=1733762913j'></script>
<script type="text/javascript" id="rlt-proxy-js-after">
/* <![CDATA[ */
	rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
/* ]]> */
</script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://malwarereversing.wordpress.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/" />
<link rel='shortlink' href='https://wp.me/p1hMV8-2o' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fmalwarereversing.wordpress.com%2F2011%2F09%2F27%2Fdebugging-injected-code-with-ida-pro%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fmalwarereversing.wordpress.com%2F2011%2F09%2F27%2Fdebugging-injected-code-with-ida-pro%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Debugging Injected Code with IDA Pro" />
<meta property="og:url" content="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/" />
<meta property="og:description" content="Hello all!  Today I wanted to talk about how you go about debugging/analyzing injected code.  In today&#8217;s malware environment a lot of malicious code doesn&#8217;t sit resident in memory in th…" />
<meta property="article:published_time" content="2011-09-27T21:59:43+00:00" />
<meta property="article:modified_time" content="2011-09-28T01:15:02+00:00" />
<meta property="og:site_name" content="malwarereversing" />
<meta property="og:image" content="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg" />
<meta property="og:image:width" content="497" />
<meta property="og:image:height" content="279" />
<meta property="og:image:alt" content="" />
<meta property="og:locale" content="en_US" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<meta name="twitter:text:title" content="Debugging Injected Code with IDA&nbsp;Pro" />
<meta name="twitter:image" content="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=640" />
<meta name="twitter:card" content="summary_large_image" />

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="icon" type="image/x-icon" href="https://s1.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48" />
<link rel="apple-touch-icon" href="https://s2.wp.com/i/webclip.png" />
<link rel='openid.server' href='https://malwarereversing.wordpress.com/?openidserver=1' />
<link rel='openid.delegate' href='https://malwarereversing.wordpress.com/' />
<link rel="search" type="application/opensearchdescription+xml" href="https://malwarereversing.wordpress.com/osd.xml" title="malwarereversing" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<meta name="application-name" content="malwarereversing" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="Malware reversing, security research, random things" /><meta name="description" content="Hello all!  Today I wanted to talk about how you go about debugging/analyzing injected code.  In today&#039;s malware environment a lot of malicious code doesn&#039;t sit resident in memory in the context of it&#039;s own process.  Back in the day you could look at task manager and recognize some weird executable that didn&#039;t belong.  Those&hellip;" />
</head>
<body class="post-template-default single single-post postid-148 single-format-standard customizer-styles-applied jetpack-reblog-enabled has-marketing-bar has-marketing-bar-theme-chaoticsoul">
<div id="page">

<div id="header">
	<h1><a href="https://malwarereversing.wordpress.com/">malwarereversing</a></h1>
	<div class="description">Malware reversing, security research, random things</div>
</div>

<div class="hr">&nbsp;</div> <!-- because IE sucks at styling HRs -->

<div id="headerimg" class="clearfix">
	<div id="header-overlay"> </div>
	<div id="header-image"><img alt="" src="https://s2.wp.com/wp-content/themes/pub/chaoticsoul/images/chaostheory.jpg" /></div>
</div>

	<div class="hr">&nbsp;</div>

<div id="wrapper" class="clearfix">
	<div id="content" class="widecolumn">

  
		<div class="post-148 post type-post status-publish format-standard hentry category-uncategorized" id="post-148">
		<h2 class="title">Debugging Injected Code with IDA&nbsp;Pro</h2>

			<div class="entrytext">
				<p>Hello all!  Today I wanted to talk about how you go about debugging/analyzing injected code.  In today&#8217;s malware environment a lot of malicious code doesn&#8217;t sit resident in memory in the context of it&#8217;s own process.  Back in the day you could look at task manager and recognize some weird executable that didn&#8217;t belong.  Those days are mostly over.  The new(er) malware classes will typically inject malicious code and hook dll&#8217;s in legitimate looking processes (explorer.exe, winlogon.exe, svchost.exe, etc.) to evade detection.  This makes analyzing malware trickier as you need a wider skill set than opening up a bad binary in IDA.  I&#8217;m going to shed some light on that process when you run into this type of malware.</p>
<p>First off we need to find some malware that uses code injection.  Code injection is usually done through the <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a> API call through Windows.  I&#8217;ve provided a sample <a href="http://www.mediafire.com/?0vowzbf40gp9s8f">here</a> which just happens to be the <a href="http://www.mediafire.com/?0vowzbf40gp9s8f">shylock malware</a> that was posted recently at <a href="http://contagiodump.blogspot.com/" target="_blank">Contagio</a>.   Download to follow along (the password is infected).  This executable injects code into the explorer.exe process of the target machine (xp sp3 os running on virtualbox).  This is what we will be working with if you want to follow along.  Now I haven&#8217;t done a complete in depth-analysis on this yet (it&#8217;s coming) but I suspect there isn&#8217;t any VM breakout that will totally hose your host OS.  If there is well sorry bout that! 😛 You need to also make sure your vm is accessible from your host machine.  I used &#8216;<a href="http://www.virtualbox.org/manual/ch06.html">Host-Only Networking</a>&#8216; and made sure the guest was accessible from my host box.</p>
<p>So once you have your vm up (and it has an IP you can reach from your host box).  You&#8217;ll need to copy over to the share a file that exists in your IDA Pro file to enable remote debugging. The file is &#8220;win32_remote.exe&#8221;.  This is a server that allows IDA to connect up to a port on a <a href="http://www.hex-rays.com/idapro/idadoc/1463.shtml">remote server debugging</a> to debug across the world or across memory in the sense of a VM.  Now one caveat with this program is that it only allows one debugging session per server (depending on version,  newer versions of IDA support multiple debugging sessions over the same port).  So if you want to debug 2 programs at the same time (which we will be doing) you need two instances of this running on different ports.  You specify the port with the -p flag and there is NO SPACES after the -p switch so if you want to set it up on port 1000 you&#8217;d run &#8220;win32_remote -p1000&#8221; from the command line.  <a href="http://www.woodmann.com/TiGa/">Tiga</a> also has posted a video tutorial about remote debugging with IDA.  His entire <a href="http://www.woodmann.com/TiGa/">tutorial series</a> is very good.</p>
<p>Open up a IDA Pro and Run -&gt; <a href="http://www.hex-rays.com/idapro/idadoc/1463.shtml">Remote Win32 Debugger</a></p>
<p><a href="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg"><img data-attachment-id="157" data-permalink="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/ida_run_remote_debugger1/" data-orig-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg" data-orig-size="1366,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="ida_run_remote_debugger1" data-image-description="" data-image-caption="" data-medium-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=300" data-large-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=497" class="aligncenter size-full wp-image-157" title="ida_run_remote_debugger1" src="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=497&#038;h=279" alt="" width="497" height="279" srcset="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=497&amp;h=279 497w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=992&amp;h=558 992w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=150&amp;h=84 150w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=300&amp;h=169 300w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger1.jpg?w=768&amp;h=432 768w" sizes="(max-width: 497px) 100vw, 497px" /></a></p>
<p>Make sure your connection/paths are correct.</p>
<p><a href="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg"><img data-attachment-id="160" data-permalink="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/ida_run_remote_debugger2/" data-orig-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg" data-orig-size="1366,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="ida_run_remote_debugger2" data-image-description="" data-image-caption="" data-medium-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=300" data-large-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=497" class="aligncenter size-full wp-image-160" title="ida_run_remote_debugger2" src="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=497&#038;h=279" alt="" width="497" height="279" srcset="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=497&amp;h=279 497w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=992&amp;h=558 992w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=150&amp;h=84 150w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=300&amp;h=169 300w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_run_remote_debugger2.jpg?w=768&amp;h=432 768w" sizes="(max-width: 497px) 100vw, 497px" /></a></p>
<p>Click ok and  you&#8217;ll break at the entry point of the module</p>
<p><a href="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg"><img data-attachment-id="156" data-permalink="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/ida_debug1/" data-orig-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg" data-orig-size="1366,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="ida_debug1" data-image-description="" data-image-caption="" data-medium-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=300" data-large-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=497" class="aligncenter size-full wp-image-156" title="ida_debug1" src="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=497&#038;h=279" alt="" width="497" height="279" srcset="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=497&amp;h=279 497w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=992&amp;h=558 992w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=150&amp;h=84 150w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=300&amp;h=169 300w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug1.jpg?w=768&amp;h=432 768w" sizes="(max-width: 497px) 100vw, 497px" /></a></p>
<p>Now we&#8217;re going to set a breakpoint at <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory()</a> (In IDA that equates to kernel32_<a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a>.  From here on out it will be referred to as <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a>)</p>
<p><a href="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg"><img data-attachment-id="161" data-permalink="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/ida_debug3/" data-orig-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg" data-orig-size="1366,768" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="ida_debug3" data-image-description="" data-image-caption="" data-medium-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=300" data-large-file="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=497" loading="lazy" class="aligncenter size-full wp-image-161" title="ida_debug3" src="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=497&#038;h=279" alt="" width="497" height="279" srcset="https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=497&amp;h=279 497w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=992&amp;h=558 992w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=150&amp;h=84 150w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=300&amp;h=169 300w, https://malwarereversing.wordpress.com/wp-content/uploads/2011/09/ida_debug3.jpg?w=768&amp;h=432 768w" sizes="(max-width: 497px) 100vw, 497px" /></a></p>
<p>Hit f9 to go and it breaks on <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a>() (How did I know how to break here?  I reversed the program roughly to get a feel for the program from the beginning up until this point.)</p>
<p>Now the code injection routine is a separate link <a href="http://pastebin.com/wzMMxF8q">here</a>.  shows why we want to break on <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a>().  There are a few basic methods on how to inject code into a process that is not yours  on Windows.  <a href="http://www.codeproject.com/KB/threads/winspy.aspx">Here</a> is a good breakdown describing those methods.  Most of the tactics revolve around <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a> system call.  This particular piece of malware uses the third type of injection mentioned in the code project article.  Before this specific function was reached the malware took a snapshot of the system state and iterated through the processes until it found explorer.exe then called this function.  So the short version of the disassembly is that it opens the target process,  allocates some memory inside the process,  writes memory that was allocated (repeats 3 times), then starts a remote thread to execute this new code, wait for thread to exit then cleanup handles.  The reason 3 sections of memory are mapped into the target process is there is a loader there that reconstructs a dll in memory that is allocated inside Explorer.  This happens all before the exit status code is returned from the thread and the code is successfully injected.<br />
<code><br />
</code><br />
Let&#8217;s fire up another IDA instance and use the Attach -&gt; Remote Win32 Debugger and put in the port for the second server that was different than the first. Hit ok then we should see a process listing and let&#8217;s choose our injected process (explorer.exe) from the menu. If you took note of the injected code locations from <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms682437%28v=vs.85%29.aspx">CreateRemoteThread</a> structure.<br />
<code></code></p>
<pre>HANDLE WINAPI CreateRemoteThread(
  __in   HANDLE hProcess,
  __in   LPSECURITY_ATTRIBUTES lpThreadAttributes,
  __in   SIZE_T dwStackSize,
  __in   LPTHREAD_START_ROUTINE lpStartAddress,
  __in   LPVOID lpParameter,
  __in   DWORD dwCreationFlags,
  __out  LPDWORD lpThreadId
);
  __in   LPTHREAD_START_ROUTINE lpStartAddress,</pre>
<dl>
<dt><em>lpStartAddress</em> [in]</dt>
<dd>A pointer to the application-defined function of type <strong>LPTHREAD_START_ROUTINE</strong> to be executed by the thread and represents the starting address of the thread in the remote process. The function must exist in the remote process. For more information, see <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms686736%28v=vs.85%29.aspx"><strong>ThreadProc</strong></a>.</dd>
</dl>
<p>We can mark this location with a breakpoint once we attach to explorer.exe (before the thread is started but after the memory was written). Then we hit run in the shylock.exe (injector process) and then we should have a breakpoint hit in explorer.exe and sure enough we do. We can continue on reversing from here but let&#8217;s dump this segment and save it so we can annotate our debugging sessions and build on this previous knowledge. The way we can do this in IDA is take a memory snapshot.  We have to View -&gt; Open Subviews -&gt; Segments so that we can view a memory map. Noting our addresses from <a href="http://msdn.microsoft.com/en-us/library/ms681674%28VS.85%29.aspx" target="_blank">WriteProcessMemory</a> we need to change those segments to <a href="http://www.hex-rays.com/idapro/idadoc/514.shtml">Loader segments</a>. Next up go to Debugger and take memory snapshot and choose only Loader Segments. If you notice in our column our only dump will be of the three sections we marked &#8216;Loader&#8217; segment.  If you don&#8217;t mark them as Loader segments IDA will ignore them and exclude from putting them into the database/idb.  Here you have it and that&#8217;s how you dump injected code from any process with IDA Pro. Hope you enjoyed reading this article.</p>
<p>References:</p>
<p>[1] &#8211; <a href="http://www.woodmann.com/TiGa/">Tiga&#8217;s IDA video tutorials</a></p>
<p>[2] &#8211; <a href="http://www.codeproject.com/KB/threads/winspy.aspx">CodeProject Code Injection methods</a></p>
<p>[3] &#8211; <a href="http://contagiodump.blogspot.com/" target="_blank">Contagio malware dump</a></p>
<p>[4] &#8211; <a href="http://www.hex-rays.com/idapro/idadoc/" target="_blank">IDA Docs Page</a></p>
<p>[5] &#8211; <a href="http://www.virtualbox.org/manual/ch06.html" target="_blank">Virtualbox Networking Doc</a></p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-148" class="share-facebook sd-button share-icon" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?share=facebook" target="_blank" title="Click to share on Facebook" ><span>Facebook</span></a></li><li class="share-x"><a rel="nofollow noopener noreferrer" data-shared="sharing-x-148" class="share-x sd-button share-icon" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?share=x" target="_blank" title="Click to share on X" ><span>X</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-19015966-148-67625917011a6' data-src='//widgets.wp.com/likes/index.html?ver=20241218#blog_id=19015966&amp;post_id=148&amp;origin=malwarereversing.wordpress.com&amp;obj_id=19015966-148-67625917011a6' data-name='like-post-frame-19015966-148-67625917011a6' data-title='Like or Reblog'><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class='loading'>Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div></div>								<p class="authormeta">~ by malwareninja on September 27, 2011.</p>
				<p class="postmetadata">Posted in <a href="https://malwarereversing.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a>									</p>
			</div>
		</div>

	
<!-- You can start editing here. -->

<div class="comments" id="comments">
	<h3>7 Responses to &#8220;Debugging Injected Code with IDA&nbsp;Pro&#8221;</h3>

	<ol class="commentlist">
		<li class="comment even thread-even depth-1" id="comment-41">
			<p>I dont&#8217;t know if I understood the problem, but couldn&#8217;t I do the same running two instances of IDA inside the VM?</p>
			<p class="commentmetadata">
				<img alt='' src='https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=32&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=32&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=48&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=64&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=96&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite>Sérgio</cite> said this on								<a href="#comment-41" title="">September 28, 2011 at 10:13 am</a> | <a rel="nofollow" class="comment-reply-link" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?replytocom=41#respond" data-commentid="41" data-postid="148" data-belowelement="comment-41" data-respondelement="respond" data-replyto="Reply to Sérgio" aria-label="Reply to Sérgio">Reply</a> 				</small>
			</p>
<ul class="children">
	<li class="comment byuser comment-author-malwareninja bypostauthor odd alt depth-2" id="comment-42">
			<p>Well I ran into a problem as the guest OS was locking up when I tried to dump from the explorer.exe process.  There may be a way around this but I wasn&#8217;t sure of one and I&#8217;m open for suggestions. This locking issue was the main motivation for doing this remotely.  You could do the same thing inside the guest OS with two instances of IDA if the process wasn&#8217;t explorer.exe.</p>
			<p class="commentmetadata">
				<img alt='' src='https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=32&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=32&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=48&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=64&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=96&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite><a href="https://malwarereversing.wordpress.com" class="url" rel="ugc">malwareninja</a></cite> said this on								<a href="#comment-42" title="">September 28, 2011 at 11:01 am</a> | <a rel="nofollow" class="comment-reply-link" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?replytocom=42#respond" data-commentid="42" data-postid="148" data-belowelement="comment-42" data-respondelement="respond" data-replyto="Reply to malwareninja" aria-label="Reply to malwareninja">Reply</a> 				</small>
			</p>
<ul class="children">
	<li class="comment even depth-3" id="comment-43">
			<p>Well done, man. Thanks for your answer.</p>
			<p class="commentmetadata">
				<img alt='' src='https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=32&#038;d=identicon&#038;r=G' srcset='https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=32&#038;d=identicon&#038;r=G 1x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=48&#038;d=identicon&#038;r=G 1.5x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=64&#038;d=identicon&#038;r=G 2x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=96&#038;d=identicon&#038;r=G 3x, https://1.gravatar.com/avatar/787115aac0fe2b5835fe0684d948de83e26de090a6b45db03fd78d1a3c4f31f3?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite>Sérgio</cite> said this on								<a href="#comment-43" title="">September 28, 2011 at 11:23 am</a> 				</small>
			</p>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-46">
			<p>What is the password for the .RAR file?</p>
			<p class="commentmetadata">
				<img alt='' src='https://0.gravatar.com/avatar/c36db4fce11c2c6989e9a940be5586f8b290af778dd6af72ad91bc52ab915092?s=32&#038;d=identicon&#038;r=G' srcset='https://0.gravatar.com/avatar/c36db4fce11c2c6989e9a940be5586f8b290af778dd6af72ad91bc52ab915092?s=32&#038;d=identicon&#038;r=G 1x, https://0.gravatar.com/avatar/c36db4fce11c2c6989e9a940be5586f8b290af778dd6af72ad91bc52ab915092?s=48&#038;d=identicon&#038;r=G 1.5x, https://0.gravatar.com/avatar/c36db4fce11c2c6989e9a940be5586f8b290af778dd6af72ad91bc52ab915092?s=64&#038;d=identicon&#038;r=G 2x, https://0.gravatar.com/avatar/c36db4fce11c2c6989e9a940be5586f8b290af778dd6af72ad91bc52ab915092?s=96&#038;d=identicon&#038;r=G 3x, https://0.gravatar.com/avatar/c36db4fce11c2c6989e9a940be5586f8b290af778dd6af72ad91bc52ab915092?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite>HUMPF</cite> said this on								<a href="#comment-46" title="">September 29, 2011 at 9:42 am</a> | <a rel="nofollow" class="comment-reply-link" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?replytocom=46#respond" data-commentid="46" data-postid="148" data-belowelement="comment-46" data-respondelement="respond" data-replyto="Reply to HUMPF" aria-label="Reply to HUMPF">Reply</a> 				</small>
			</p>
<ul class="children">
	<li class="comment byuser comment-author-malwareninja bypostauthor even depth-2" id="comment-47">
			<p>The pw is &#8220;infected&#8221;</p>
			<p class="commentmetadata">
				<img alt='' src='https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=32&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=32&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=48&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=64&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=96&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite><a href="https://malwarereversing.wordpress.com" class="url" rel="ugc">malwareninja</a></cite> said this on								<a href="#comment-47" title="">September 29, 2011 at 10:01 am</a> | <a rel="nofollow" class="comment-reply-link" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?replytocom=47#respond" data-commentid="47" data-postid="148" data-belowelement="comment-47" data-respondelement="respond" data-replyto="Reply to malwareninja" aria-label="Reply to malwareninja">Reply</a> 				</small>
			</p>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1" id="comment-48">
			<p>Gr8 post!</p>
<p>Tried to reproduce the analysis but couldn&#8217;t find any WriteProcessMemory function ref. (in import table) , can u please instruct how to? thx and keep up the gr8 job!</p>
			<p class="commentmetadata">
				<img alt='' src='https://2.gravatar.com/avatar/b034b813c712551f5f72fc4eb25e269842884b2109f9a1275471ed35b2a19f1d?s=32&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/b034b813c712551f5f72fc4eb25e269842884b2109f9a1275471ed35b2a19f1d?s=32&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/b034b813c712551f5f72fc4eb25e269842884b2109f9a1275471ed35b2a19f1d?s=48&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/b034b813c712551f5f72fc4eb25e269842884b2109f9a1275471ed35b2a19f1d?s=64&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/b034b813c712551f5f72fc4eb25e269842884b2109f9a1275471ed35b2a19f1d?s=96&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/b034b813c712551f5f72fc4eb25e269842884b2109f9a1275471ed35b2a19f1d?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite>juli</cite> said this on								<a href="#comment-48" title="">September 30, 2011 at 4:58 pm</a> | <a rel="nofollow" class="comment-reply-link" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?replytocom=48#respond" data-commentid="48" data-postid="148" data-belowelement="comment-48" data-respondelement="respond" data-replyto="Reply to juli" aria-label="Reply to juli">Reply</a> 				</small>
			</p>
<ul class="children">
	<li class="comment byuser comment-author-malwareninja bypostauthor even depth-2" id="comment-49">
			<p>IDA handles imports a little differently, reference it as &#8220;kernel32_WriteProcessMemory&#8221;.  You have to jump to this address and set a breakpoint as it probably be explicitly imported due on start to avoid AV detection.</p>
			<p class="commentmetadata">
				<img alt='' src='https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=32&#038;d=identicon&#038;r=G' srcset='https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=32&#038;d=identicon&#038;r=G 1x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=48&#038;d=identicon&#038;r=G 1.5x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=64&#038;d=identicon&#038;r=G 2x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=96&#038;d=identicon&#038;r=G 3x, https://2.gravatar.com/avatar/597373c61b6c7b694a268d7e0b980e80bba34e90635fc1777dcb14bb90d918c0?s=128&#038;d=identicon&#038;r=G 4x' class='avatar avatar-32' height='32' width='32' loading='lazy' decoding='async' />				<small>
				<cite><a href="https://malwarereversing.wordpress.com" class="url" rel="ugc">malwareninja</a></cite> said this on								<a href="#comment-49" title="">September 30, 2011 at 5:11 pm</a> | <a rel="nofollow" class="comment-reply-link" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/?replytocom=49#respond" data-commentid="49" data-postid="148" data-belowelement="comment-49" data-respondelement="respond" data-replyto="Reply to malwareninja" aria-label="Reply to malwareninja">Reply</a> 				</small>
			</p>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	</ol>

	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
	</div>

</div>



	<div class="comments clearfix">	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2011/09/27/debugging-injected-code-with-ida-pro/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://malwarereversing.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">


<div id="comment-form__verbum" class="transparent"></div><div class="verbum-form-meta"><input type='hidden' name='comment_post_ID' value='148' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />

			<input type="hidden" name="highlander_comment_nonce" id="highlander_comment_nonce" value="ca4dccea44" />
			<input type="hidden" name="verbum_show_subscription_modal" value="" /></div><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4b3d16e0d6" /></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="137"/><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	</div>


	
	</div>

	<div id="sidebar">
		<div id="twitter-3" class="widget widget_twitter"><h3><a href='http://twitter.com/bradarndt'>Twitter feed</a></h3><a class="twitter-timeline" data-height="600" data-dnt="true" href="https://twitter.com/bradarndt">Tweets by bradarndt</a></div><div id="categories-3" class="widget widget_categories"><h3>Categories</h3>
			<ul>
					<li class="cat-item cat-item-2360537"><a href="https://malwarereversing.wordpress.com/category/incident-response/">incident response</a> (3)
</li>
	<li class="cat-item cat-item-15593"><a href="https://malwarereversing.wordpress.com/category/malware/">Malware</a> (4)
</li>
	<li class="cat-item cat-item-1"><a href="https://malwarereversing.wordpress.com/category/uncategorized/">Uncategorized</a> (6)
</li>
			</ul>

			</div><div id="archives-3" class="widget widget_archive"><h3>Archives</h3>
			<ul>
					<li><a href='https://malwarereversing.wordpress.com/2011/09/'>September 2011</a>&nbsp;(4)</li>
	<li><a href='https://malwarereversing.wordpress.com/2011/05/'>May 2011</a>&nbsp;(2)</li>
	<li><a href='https://malwarereversing.wordpress.com/2011/03/'>March 2011</a>&nbsp;(1)</li>
	<li><a href='https://malwarereversing.wordpress.com/2011/01/'>January 2011</a>&nbsp;(3)</li>
			</ul>

			</div><div id="tag_cloud-2" class="widget widget_tag_cloud"><h3></h3><div style="overflow: hidden;"><a href="https://malwarereversing.wordpress.com/category/incident-response/" style="font-size: 100%; padding: 1px; margin: 1px;"  title="incident response (3)">incident response</a> <a href="https://malwarereversing.wordpress.com/category/malware/" style="font-size: 158.33333333333%; padding: 1px; margin: 1px;"  title="Malware (4)">Malware</a> <a href="https://malwarereversing.wordpress.com/category/uncategorized/" style="font-size: 275%; padding: 1px; margin: 1px;"  title="Uncategorized (6)">Uncategorized</a> </div></div>
	</div>

</div>

<div class="hr last">&nbsp;</div>
<div id="footer">
	<p><a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a> </p>
</div>
</div>

<!--  -->
<script type="text/javascript" src="//0.gravatar.com/js/hovercards/hovercards.min.js?ver=202451b213a1cbb4e3271ca470eb7790af362ac2e18ce468f8945952c7bd3456d2132e" id="grofiles-cards-js"></script>
<script type="text/javascript" id="wpgroho-js-extra">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1610363240i'></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init(
					'body',
					'#wp-admin-bar-my-account',
					{
						i18n: {
							'Edit your profile →': 'Edit your profile →',
							'View profile →': 'View profile →',
							'Contact': 'Contact',
							'Send money': 'Send money',
							'Sorry, we are unable to load this Gravatar profile.': 'Sorry, we are unable to load this Gravatar profile.',
							'Profile not found.': 'Profile not found.',
							'Too Many Requests.': 'Too Many Requests.',
							'Internal Server Error.': 'Internal Server Error.',
						},
					}
				);
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-aca8190901a9467b28ee1080b8d02cf4">
	</div>
	<div class="grofile-hash-map-8fa4b60fd0d4e0ec353f540c44055ae9">
	</div>
	<div class="grofile-hash-map-8b05c300fc06e8bebfa6c2deab0a4fe5">
	</div>
	<div class="grofile-hash-map-a22774cc03b3e693b3e002395547e5fa">
	</div>
	</div>
	<div id="actionbar" style="display: none;"
			class="actnbr-pub-chaoticsoul actnbr-has-follow">
		<ul>
								<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-comment" href="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/#comments">
							<svg class="gridicon gridicons-comment" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M12 16l-5 5v-5H5c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h14c1.1 0 2 .9 2 2v9c0 1.1-.9 2-2 2h-7z"/></g></svg>							<span>Comment						</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
						<a class="actnbr-action actnbr-actn-reblog" href="">
							<svg class="gridicon gridicons-reblog" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M22.086 9.914L20 7.828V18c0 1.105-.895 2-2 2h-7v-2h7V7.828l-2.086 2.086L14.5 8.5 19 4l4.5 4.5-1.414 1.414zM6 16.172V6h7V4H6c-1.105 0-2 .895-2 2v10.172l-2.086-2.086L.5 15.5 5 20l4.5-4.5-1.414-1.414L6 16.172z"/></g></svg><span>Reblog</span>
						</a>
					</li>
									<li class="actnbr-btn actnbr-hidden">
								<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
							<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble">
							<div class="tip-arrow"></div>
							<div class="tip-inner actnbr-follow-bubble">
															<ul>
											<li class="actnbr-sitename">
			<a href="https://malwarereversing.wordpress.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				malwarereversing			</a>
		</li>
										<div class="actnbr-message no-display"></div>
									<form method="post" action="https://subscribe.wordpress.com" accept-charset="utf-8" style="display: none;">
																				<div>
										<input type="email" name="email" placeholder="Enter your email address" class="actnbr-email-field" aria-label="Enter your email address" />
										</div>
										<input type="hidden" name="action" value="subscribe" />
										<input type="hidden" name="blog_id" value="19015966" />
										<input type="hidden" name="source" value="https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/" />
										<input type="hidden" name="sub-type" value="actionbar-follow" />
										<input type="hidden" id="_wpnonce" name="_wpnonce" value="74a27a32dd" />										<div class="actnbr-button-wrap">
											<button type="submit" value="Sign me up">
												Sign me up											</button>
										</div>
									</form>
									<li class="actnbr-login-nudge">
										<div>
											Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fmalwarereversing.wordpress.com%2F2011%2F09%2F27%2Fdebugging-injected-code-with-ida-pro%2F&#038;signup_flow=account">Log in now.</a>										</div>
									</li>
								</ul>
															</div>
						</div>
					</li>
							<li class="actnbr-ellipsis actnbr-hidden">
				<svg class="gridicon gridicons-ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M7 12c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm12-2c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-7 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2z"/></g></svg>				<div class="actnbr-popover tip tip-top-left actnbr-more">
					<div class="tip-arrow"></div>
					<div class="tip-inner">
						<ul>
									<li class="actnbr-sitename">
			<a href="https://malwarereversing.wordpress.com">
				<img loading='lazy' alt='' src='https://s2.wp.com/i/logo/wpcom-gray-white.png' srcset='https://s2.wp.com/i/logo/wpcom-gray-white.png 1x' class='avatar avatar-50' height='50' width='50' />				malwarereversing			</a>
		</li>
								<li class="actnbr-folded-customize">
								<a href="https://malwarereversing.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fmalwarereversing.wordpress.com%2F2011%2F09%2F27%2Fdebugging-injected-code-with-ida-pro%2F">
									<svg class="gridicon gridicons-customize" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z"/></g></svg>									<span>Customize</span>
								</a>
							</li>
																<li class="actnbr-folded-follow">
												<a class="actnbr-action actnbr-actn-follow " href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path clip-rule="evenodd" d="m4 4.5h12v6.5h1.5v-6.5-1.5h-1.5-12-1.5v1.5 10.5c0 1.1046.89543 2 2 2h7v-1.5h-7c-.27614 0-.5-.2239-.5-.5zm10.5 2h-9v1.5h9zm-5 3h-4v1.5h4zm3.5 1.5h-1v1h1zm-1-1.5h-1.5v1.5 1 1.5h1.5 1 1.5v-1.5-1-1.5h-1.5zm-2.5 2.5h-4v1.5h4zm6.5 1.25h1.5v2.25h2.25v1.5h-2.25v2.25h-1.5v-2.25h-2.25v-1.5h2.25z"  fill-rule="evenodd"></path></svg>
			<span>Subscribe</span>
		</a>
		<a class="actnbr-action actnbr-actn-following  no-display" href="">
			<svg class="gridicon" height="20" width="20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" d="M16 4.5H4V15C4 15.2761 4.22386 15.5 4.5 15.5H11.5V17H4.5C3.39543 17 2.5 16.1046 2.5 15V4.5V3H4H16H17.5V4.5V12.5H16V4.5ZM5.5 6.5H14.5V8H5.5V6.5ZM5.5 9.5H9.5V11H5.5V9.5ZM12 11H13V12H12V11ZM10.5 9.5H12H13H14.5V11V12V13.5H13H12H10.5V12V11V9.5ZM5.5 12H9.5V13.5H5.5V12Z" fill="#008A20"></path><path class="following-icon-tick" d="M13.5 16L15.5 18L19 14.5" stroke="#008A20" stroke-width="1.5"></path></svg>
			<span>Subscribed</span>
		</a>
										</li>
																	<li class="actnbr-signup"><a href="https://wordpress.com/start/">Sign up</a></li>
									<li class="actnbr-login"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fmalwarereversing.wordpress.com%2F2011%2F09%2F27%2Fdebugging-injected-code-with-ida-pro%2F&#038;signup_flow=account">Log in</a></li>
																	<li class="actnbr-shortlink"><a href="https://wp.me/p1hMV8-2o">Copy shortlink</a></li>
																	<li class="flb-report">
										<a href="https://wordpress.com/abuse/?report_url=https://malwarereversing.wordpress.com/2011/09/27/debugging-injected-code-with-ida-pro/" target="_blank" rel="noopener noreferrer">
											Report this content										</a>
									</li>
																	<li class="actnbr-reader">
										<a href="https://wordpress.com/read/blogs/19015966/posts/148">
											View post in Reader										</a>
									</li>
																	<li class="actnbr-subs">
										<a href="https://subscribe.wordpress.com/">Manage subscriptions</a>
									</li>
																		<li class="actnbr-fold"><a href="">Collapse this bar</a></li>
															</ul>
					</div>
				</div>
			</li>
		</ul>
	</div>
	
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20241015";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20231122";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div
				class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions"
				itemscope
				itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"/>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"/>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"/>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"/>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"/>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
							</span>
						</a>
												<a href="#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"/>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea
													name="comment"
													class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea"
													id="jp-carousel-comment-form-comment-field"
													placeholder="Write a Comment..."
												></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field" />
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field" />
															</fieldset>
																											</div>
													<input
														type="submit"
														name="submit"
														class="jp-carousel-comment-form-button"
														id="jp-carousel-comment-form-button-submit"
														value="Post Comment" />
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" href="#" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"/>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"/>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/malwarereversing.wordpress.com\/2011\/09\/27\/debugging-injected-code-with-ida-pro\/":148};
	</script>
				<link crossorigin='anonymous' rel='stylesheet' id='all-css-0-2' href='https://s0.wp.com/_static/??-eJyljEsKgDAMBS9kDUUquhDPom0Qaz/BNHh9KdgTuBl4w2PgIWVzKpgKRFEU5DgTg8dCm72+DTHnCicBGex2Z2EMwM9JeKtdkgvYW+YOftTaqYkaXOOix8noQU+z8S9MR0BZ&cssminify=yes' type='text/css' media='all' />
<script type="text/javascript" id="jetpack-carousel-js-extra">
/* <![CDATA[ */
var jetpackSwiperLibraryPath = {"url":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-plugin\/moon\/_inc\/build\/carousel\/swiper-bundle.min.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/malwarereversing.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"b0bf3bec23","display_exif":"1","display_comments":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","image_label":"Open image in full-screen.","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/malwarereversing.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fmalwarereversing.wordpress.com%2F2011%2F09%2F27%2Fdebugging-injected-code-with-ida-pro%2F","blog_id":"19015966","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=19015966&v=wpcom&tz=-5&user_id=0&subd=malwarereversing","is_public":"1"};
/* ]]> */
</script>
<script type="text/javascript" id="verbum-settings-js-before">
/* <![CDATA[ */
window.VerbumComments = {"Log in or provide your name and email to leave a reply.":"Log in or provide your name and email to leave a reply.","Log in or provide your name and email to leave a comment.":"Log in or provide your name and email to leave a comment.","Receive web and mobile notifications for posts on this site.":"Receive web and mobile notifications for posts on this site.","Name":"Name","Email (address never made public)":"Email (address never made public)","Website (optional)":"Website (optional)","Leave a reply. (log in optional)":"Leave a reply. (log in optional)","Leave a comment. (log in optional)":"Leave a comment. (log in optional)","Log in to leave a reply.":"Log in to leave a reply.","Log in to leave a comment.":"Log in to leave a comment.","Logged in via %s":"Logged in via %s","Log out":"Log out","Email":"Email","(Address never made public)":"(Address never made public)","Instantly":"Instantly","Daily":"Daily","Reply":"Reply","Comment":"Comment","WordPress":"WordPress","Weekly":"Weekly","Notify me of new posts":"Notify me of new posts","Email me new posts":"Email me new posts","Email me new comments":"Email me new comments","Cancel":"Cancel","Write a comment...":"Write a comment...","Write a reply...":"Write a reply...","Website":"Website","Optional":"Optional","We'll keep you in the loop!":"We'll keep you in the loop!","Loading your comment...":"Loading your comment...","Discover more from":"Discover more from malwarereversing","Subscribe now to keep reading and get access to the full archive.":"Subscribe now to keep reading and get access to the full archive.","Continue reading":"Continue reading","Never miss a beat!":"Never miss a beat!","Interested in getting blog post updates? Simply click the button below to stay in the loop!":"Interested in getting blog post updates? Simply click the button below to stay in the loop!","Enter your email address":"Enter your email address","Subscribe":"Subscribe","Comment sent successfully":"Comment sent successfully","Save my name, email, and website in this browser for the next time I comment.":"Save my name, email, and website in this browser for the next time I comment.","siteId":19015966,"postId":148,"mustLogIn":false,"requireNameEmail":true,"commentRegistration":false,"connectURL":"https:\/\/malwarereversing.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/malwarereversing.wordpress.com\/wp-login.php?action=logout&_wpnonce=3fc39b95e5","homeURL":"https:\/\/malwarereversing.wordpress.com\/","subscribeToBlog":true,"subscribeToComment":true,"isJetpackCommentsLoggedIn":false,"jetpackUsername":"","jetpackUserId":0,"jetpackSignature":"","jetpackAvatar":"https:\/\/0.gravatar.com\/avatar\/?s=96&amp;d=identicon&amp;r=G","enableBlocks":true,"enableSubscriptionModal":true,"currentLocale":"en","isJetpackComments":false,"allowedBlocks":["core\/paragraph","core\/list","core\/code","core\/list-item","core\/quote","core\/image","core\/embed","core\/quote","core\/code"],"embedNonce":"c7fc681eca","verbumBundleUrl":"https:\/\/s2.wp.com\/wp-content\/mu-plugins\/jetpack-mu-wpcom-plugin\/moon\/vendor\/automattic\/jetpack-mu-wpcom\/src\/features\/verbum-comments\/dist\/index.js","isRTL":false,"vbeCacheBuster":1721244820,"iframeUniqueId":0}
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s0.wp.com/_static/??-eJyNkNFOwzAMRX+INIOCthfEp6A0cTe3dpLFCVP/HgMtmjQEPEW6Pj6+ir1k41OsEKudxHIakMA0geKOmhmMY+omubNXHDeTqR0xiiWcQey5QYOTi4GgbDBGTy3oUK0Bpdo3iCGVj1FOtIxI1DHGX9wT1Oz8bDS6ZJ94HWjHFDebazWxqxX9DW6leDs0pKBwGRrrDWa9IdaJgD5hiY7RG0ou/Fx83TAFMi3/rHvd8lVlawfvStJvpW9uC/7QuhmFoZq+233ptmAsn3DQ3Rd+vt/3/eGpf3w4TO/Wzq68'></script>
<script type="text/javascript" src="https://platform.twitter.com/widgets.js?ver=20111117" id="twitter-widgets-js"></script>
<script type="text/javascript" id="sharing-js-js-extra">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
/* ]]> */
</script>
<script crossorigin='anonymous' type='text/javascript'  src='https://s2.wp.com/_static/??/wp-content/mu-plugins/carousel-wpcom/carousel-wpcom.js,/wp-content/mu-plugins/jetpack-plugin/moon/_inc/build/sharedaddy/sharing.min.js?m=1725888675j'></script>
<script type="text/javascript" id="sharing-js-js-after">
/* <![CDATA[ */
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-x' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-x' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomx', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
/* ]]> */
</script>

	<script type="text/javascript">
		(function () {
			var wpcom_reblog = {
				source: 'toolbar',

				toggle_reblog_box_flair: function (obj_id, post_id) {

					// Go to site selector. This will redirect to their blog if they only have one.
					const postEndpoint = `https://wordpress.com/post`;

					// Ideally we would use the permalink here, but fortunately this will be replaced with the 
					// post permalink in the editor.
					const originalURL = `${ document.location.href }?page_id=${ post_id }`; 
					
					const url =
						postEndpoint +
						'?url=' +
						encodeURIComponent( originalURL ) +
						'&is_post_share=true' +
						'&v=5';

					const redirect = function () {
						if (
							! window.open( url, '_blank' )
						) {
							location.href = url;
						}
					};

					if ( /Firefox/.test( navigator.userAgent ) ) {
						setTimeout( redirect, 0 );
					} else {
						redirect();
					}
				},
			};

			window.wpcom_reblog = wpcom_reblog;
		})();
	</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src='https://widgets.wp.com/likes/master.html?ver=20241218#ver=20241218&amp;origin=https://malwarereversing.wordpress.com' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
	<div id='likes-other-gravatars' class='wpl-new-layout' role="dialog" aria-hidden="true" tabindex="-1">
		<div class="likes-text">
			<span>%d</span>		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>

		<script src="//stats.wp.com/w.js?67" defer></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'19015966','blog_tz':'-5','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'19015966','v':'wpcom','tz':'-5','user_id':'0','post':'148','subd':'malwarereversing'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1wamRFTUJvcCVmdVtvcCUrditEcC5rdHw4JUQsQU4vR3dMJT82VTRnczRMU105WE5qZWtoXWczU3FUeU5sTDU3Tmhpa0swRWk4UUJjSlV6LjQuXWNZYW5JUWM9aFRiY0VVQ1JhP0V2T2R0ZmI5Lm15Q2svaDZjJSxNSF1YYUhOREdYbU9wcTB0SGsxUStsUnJNQ2wvVUdRTnhrR0kvPVZ4OX5VMy1oRkJ+NHFYPy53Kz12RHVjaSVXRn5wOEsuSGJodkdbYndGV01lSWx8dnx1fHBaZS4sLkxmTFFWZWMvN0pPT2tWRz9EWTc9S0xRZlFydmtVRFk1aHguSjg4ajVqYy9GWm5+THc4aldrbH4xVCwzOElofjlPMVFsclFoenQvS0hsMFRk'}]);
_stq.push([ 'clickTrackerInit', '19015966', '148' ]);
</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script defer id="bilmur"  data-provider="wordpress.com" data-service="simple"   src="/wp-content/js/bilmur-4.min.js?i=12&m=202451"></script><div id="marketingbar" class="marketing-bar noskim  "><div class="marketing-bar-text">Design a site like this with WordPress.com</div><a class="marketing-bar-button" href="https://wordpress.com/start/?ref=marketing_bar">Get started</a><a class="marketing-bar-link" tabindex="-1" aria-label="Create your website at WordPress.com" href="https://wordpress.com/start/?ref=marketing_bar"></a></div>		<script type="text/javascript">
			window._tkq = window._tkq || [];

			window._tkq.push( [ 'recordEvent', 'wpcom_marketing_bar_impression', {"is_current_user_blog_owner":false} ] );

			document.querySelectorAll( '#marketingbar > a' ).forEach( link => {
				link.addEventListener( 'click', ( e ) => {
					window._tkq.push( [ 'recordEvent', 'wpcom_marketing_bar_cta_click', {"is_current_user_blog_owner":false} ] );
				} );
			});
		</script><script>
( function() {
	function getMobileUserAgentInfo() {
		if ( typeof wpcom_mobile_user_agent_info === 'object' ) {
			wpcom_mobile_user_agent_info.init();
			var mobileStatsQueryString = '';

			if ( wpcom_mobile_user_agent_info.matchedPlatformName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
			}

			if ( wpcom_mobile_user_agent_info.matchedUserAgentName !== false ) {
				mobileStatsQueryString += '&x_' + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
			}

			if ( wpcom_mobile_user_agent_info.isIPad() ) {
				mobileStatsQueryString += '&x_' + 'ipad_views' + '=' + 'views';
			}

			if ( mobileStatsQueryString != '' ) {
				new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
			}
		}
	}

	document.addEventListener( 'DOMContentLoaded', getMobileUserAgentInfo );
} )();
</script>
<script type='disabled' id='wp-enqueue-dynamic-script:wp-i18n:after:1'>
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>

<script>
(function() {
	'use strict';

	const fetches = {};
	const promises = {};
	const urls = {
		'wp-hooks': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v19.8.0/build/hooks/index.min.js?m=1733324323i&ver=84e753e2b66eb7028d38',
		'wp-i18n': 'https://s0.wp.com/wp-content/plugins/gutenberg-core/v19.8.0/build/i18n/index.min.js?m=1733324323i&ver=bd5a2533e717a1043151',
		'verbum': 'https://s2.wp.com/wp-content/mu-plugins/jetpack-mu-wpcom-plugin/moon/vendor/automattic/jetpack-mu-wpcom/src/build/verbum-comments/verbum-comments.js?m=1733934734i&minify=false&ver=0b4f9908fccda8a8b143'
	};
	const loaders = {
		'verbum': () => {
			fetchExternalScript('wp-hooks');
			fetchExternalScript('wp-i18n');
			fetchExternalScript('verbum');
			promises['wp-hooks'] = promises['wp-hooks'] || loadWPScript('wp-hooks');
			promises['wp-i18n'] = promises['wp-i18n'] || promises['wp-hooks'].then( () => loadWPScript('wp-i18n') );
			promises['verbum'] = promises['verbum'] || promises['wp-i18n'].then( () => loadWPScript('verbum') );
			return promises['verbum'];
		},
		
	};
	const scriptExtras = {
		'wp-i18n': { translations: 0, before: 0, after: 1 },
		
	};

	window.WP_Enqueue_Dynamic_Script = {
		loadScript: (handle) => {
			if (!loaders[handle]) {
				console.error('WP_Enqueue_Dynamic_Script: unregistered script `' + handle + '`.');
			}
			return loaders[handle]();
		}
	};

	function fetchExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		fetches[handle] = fetches[handle] || fetch(urls[handle], { mode: 'no-cors' });
		return fetches[handle];
	}

	function runExtraScript(handle, type, index) {
		const id = 'wp-enqueue-dynamic-script:' + handle + ':' + type + ':' + (index + 1);
		const template = document.getElementById(id);
		if (!template) {
			return Promise.reject();
		}

		const script = document.createElement( 'script' );
		script.innerHTML = template.innerHTML;
		document.body.appendChild( script );
		return Promise.resolve();
	}

	function loadExternalScript(handle) {
		if (!urls[handle]) {
			return Promise.resolve();
		}

		return fetches[handle].then(() => {
			return new Promise((resolve, reject) => {
				const script = document.createElement('script');
				script.onload = () => resolve();
				script.onerror = (e) => reject(e);
				script.src = urls[handle];
				document.body.appendChild(script);
			});
		});
	}

	function loadExtra(handle, pos) {
		const count = (scriptExtras[handle] && scriptExtras[handle][pos]) || 0;
		let promise = Promise.resolve();

		for (let i = 0; i < count; i++) {
			promise = promise.then(() => runExtraScript(handle, pos, i));
		}

		return promise;
	}

	function loadWPScript(handle) {
		// Core loads scripts in this order. See: https://github.com/WordPress/WordPress/blob/a59eb9d39c4fcba834b70c9e8dfd64feeec10ba6/wp-includes/class-wp-scripts.php#L428.
		return loadExtra(handle, 'translations')
			.then(() => loadExtra(handle, 'before'))
			.then(() => loadExternalScript(handle))
			.then(() => loadExtra(handle, 'after'));
	}
} )();
</script>
</body>
</html>
