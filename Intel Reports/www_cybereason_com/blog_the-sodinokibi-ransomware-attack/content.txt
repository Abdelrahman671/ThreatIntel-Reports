<!doctype html><!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" > <![endif]--><!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" >        <![endif]--><!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" >               <![endif]--><!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]--><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Cybereason Nocturnus">
    <meta name="description" content="Cybereason has been tracking a new type of ransomware dubbed REvil / Sodinokibi - the Cybereason Defense Platform detects and blocks this nasty ransomware that struck meatpacker JBS.">
    <meta name="generator" content="HubSpot">
    <title>REvil / Sodinokibi: The Crown Prince of Ransomware</title>
    <link rel="shortcut icon" href="https://www.cybereason.com/hubfs/cr-favicon-1.png">
    
<meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:description" content="Cybereason has been tracking a new type of ransomware dubbed REvil / Sodinokibi - the Cybereason Defense Platform detects and blocks this nasty ransomware that struck meatpacker JBS.">
    <meta property="og:title" content="REvil / Sodinokibi: The Crown Prince of Ransomware">
    <meta name="twitter:description" content="Cybereason has been tracking a new type of ransomware dubbed REvil / Sodinokibi - the Cybereason Defense Platform detects and blocks this nasty ransomware that struck meatpacker JBS.">
    <meta name="twitter:title" content="REvil / Sodinokibi: The Crown Prince of Ransomware">

    

    
    <style>
a.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}
</style>

<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386203/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443237/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042214535/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/1669911113479/module_86933076631_CR_-_Sticky_CTA_Bar.css">
<link rel="stylesheet" href="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/34473990280/1704383554067/module_34473990280_CR_-_Footer_Full__en_US.min.css">
    

    
<!--  Added by GoogleTagManager integration -->
<script>
var _hsp = window._hsp = window._hsp || [];
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}

var useGoogleConsentModeV2 = true;
var waitForUpdateMillis = 1000;



var hsLoadGtm = function loadGtm() {
    if(window._hsGtmLoadOnce) {
      return;
    }

    if (useGoogleConsentModeV2) {

      gtag('set','developer_id.dZTQ1Zm',true);

      gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'wait_for_update': waitForUpdateMillis
      });

      _hsp.push(['useGoogleConsentModeV2'])
    }

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TJVVB7C');

    window._hsGtmLoadOnce = true;
};

_hsp.push(['addPrivacyConsentListener', function(consent){
  if(consent.allowed || (consent.categories && consent.categories.analytics)){
    hsLoadGtm();
  }
}]);

</script>

<!-- /Added by GoogleTagManager integration -->


<script src="https://use.typekit.net/vyv2ljd.js"></script>
<script>try{Typekit.load({ async: false });}catch(e){}</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link rel="preload" href="/hubfs/__dam/fonts/ionicons.eot" as="font" type="font/otf" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/criteria/Criteria-CF-Medium.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/hubfs/dam/fonts/peristyle/Peristyle-Black.woff2" as="font" type="font/woff2" crossorigin>
<link rel="amphtml" href="https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack?hs_amp=true">

<meta property="og:image" content="https://www.cybereason.com/hubfs/Sodinokibi-blog-1.png">
<meta property="og:image:alt" content="REvil, Sodinokibi ransomware malware research">
<meta name="twitter:image" content="https://www.cybereason.com/hubfs/Sodinokibi-blog-1.png">
<meta name="twitter:image:alt" content="REvil, Sodinokibi ransomware malware research">

<meta property="og:url" content="https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@cr_nocturnus">

<link rel="canonical" href="https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack">

<meta property="og:type" content="article">
<link rel="alternate" type="application/rss+xml" href="https://www.cybereason.com/blog/rss.xml">
<meta name="twitter:domain" content="www.cybereason.com">
<script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
</script>

<meta http-equiv="content-language" content="en">
<link rel="stylesheet" href="//7052064.fs1.hubspotusercontent-na1.net/hub/7052064/hub_generated/template_assets/1729622897632/hubspot/hubspot_default/shared/responsive/layout.min.css">


<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470223313/1696396395659/__CR_Web_Platform/CSS/cr-master__cta.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470477360/1710134689941/__CR_Web_Platform/CSS/cr-master__main.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35275979682/1642096258129/__CR_Web_Platform/CSS/ionicons.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42760289143/1724041950600/__CR_Web_Platform/CSS/cr-mln__build.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/34470224480/1635957556830/__CR_Web_Platform/CSS/bulma/cr-framework__bulma-columns.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/35291999472/1696396871390/__CR_Web_Platform/CSS/bulma/cr-framework__bulma.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42363645447/1635957556555/__CR_Web_Platform/CSS/hamburger-animation.min.css">
<link rel="stylesheet" href="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507091846/1635957557027/__CR_Web_Platform/CSS/animate.min.css">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
<script src="/hubfs/dam/plugins/marker-animation.js"></script>
<script>
$(document).ready(function() {
  $('.highlight').markerAnimation({
    "color":'var(--cr-yellow)',
    "font_weight":'normal',
    "background-size": '200% 1.2em'
  });
});
</script>

    <style>
.cr-mln__blog-post .container-is-blog.cr-mln__blog-post--body .column:nth-of-type(2) img {
    background: #FFFFFF;
    border: 1px solid #CCCCCC;
    border-radius: 5px 5px 5px 5px;
    padding: 10px;
} 
</style>

</head>
<body class="   hs-content-id-11621636073 hs-blog-post hs-blog-id-5272851739" style="">
<!--  Added by GoogleTagManager integration -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJVVB7C" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- /Added by GoogleTagManager integration -->

    <div class="header-container-wrapper">
    <div class="header-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433790649568" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section id="cr-malicious-life-network__tier-one-header" class="position-flex">
  <div class="#">
    <div id="logo"><a href="https://www.cybereason.com"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-black.png"></a></div>
    <div id="back-to">
      <a href="https://www.cybereason.com">Back to <span>Cybereason.com</span></a>
    </div>
    <!-- Hamburger Menu -->
    <button class="hamburger hamburger--collapse" type="button">
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="cr-mln__hamburger-menu--overlay">
      <ul>
        <li><a href="https://www.cybereason.com/blog/all"><span class="underline">All Posts</span></a></li>
        <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
        <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
        <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
        <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
        <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
        <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
      </ul>
      <div class="subscribe">
        <a href="#blog-subscribe">Subscribe</a>
      </div>
    </div>
    <!-- -->
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget mln-homepage" style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1615433785464566" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><section class="cr-malicious-life-network__hero-main base">
  <div class="container-is-blog columns hero-content page-center">
    <div class="column is-5-fullhd is-5-desktop is-12-touch">
      <a href="/blog"><img class="cr-mln-logo" src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-malicious-life-logo-v2.png"></a>
    </div>
    <div class="column is-7-fullhd is-7-desktop is-hidden-mobile is-hidden-tablet-only">
      <div class="cr-mln__search-subscribe">
        <div class="cr-mln__search">
          <a href="#cr-search-modal" class="search-btn"><img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/cr-blog-icon--search-dark-gray.png" alt="Search"></a>
        </div>
        <div class="cr-mln__subscribe">
          <a class="btn-subscribe" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>
      <div class="cr-mln__category-nav">
        <ul>
          <li><a href="/blog/category/all"><span class="underline">All</span></a></li>
          <li><a href="/blog/category/research"><span class="underline">Research</span></a></li>
          <li><a href="/blog/category/podcasts"><span class="underline">Podcasts</span></a></li>
          <li><a href="/blog/category/webinars"><span class="underline">Webinars</span></a></li>
          <li><a href="/blog/category/resources"><span class="underline">Resources</span></a></li>
          <li><a href="/blog/category/videos"><span class="underline">Videos</span></a></li>
          <li><a href="/blog/category/news"><span class="underline">News</span></a></li>
        </ul>
      </div>
    </div>
  </div>
      <!-- MOBILE Search and Subscribe -->
      <div class="container-is-blog columns is-gapless is-hidden-desktop cr-mln__search-subscribe--mobile">
        <div class="column">
          <a class="search-btn">Search</a>
        </div>
        <div class="column">
          <a class="#" href="#blog-subscribe">Subscribe</a>
        </div>
      </div>

      <!-- END MOBILE Search and Subscribe -->
  
  <!-- SEARCH Modal Wrap -->

  <div id="cr-search-modal">
        <!--THIS IS IMPORTANT! to close the modal, the class name has to match the name given on the ID -->
        <div id="btn-close-modal" class="close-cr-search-modal"> 
            X
        </div>

        <div class="modal-content">
            <div class="container columns">
              <div class="column">
                <div class="cr-search-modal__search-bar">
                  <h3>Search</h3>
                  <form action="/hs-search-results">
                    <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search...">
                    <input type="hidden" name="type" value="BLOG_POST">
                    <input type="hidden" name="type" value="LISTING_PAGE">
                    <button type="submit" class="arrow"></button>
                  </form>
                  
                </div>

              </div>
          </div>
        </div>
    </div>
  <!-- END Search Modal Wrap -->

</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end header -->
</div><!--end header wrapper -->

<div class="body-container-wrapper">
    <div class="body-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-blog_content " style="" data-widget-type="blog_content" data-x="0" data-w="12">







<div class="cr-mln__blog-post">
  <div class="container-is-blog columns is-multiline page-center">

    <div class="column is-8-fullhd is-8-desktop is-offset-2-fullhd is-offset-2-desktop is-10-tablet is-offset-1-tablet">
      <div class="featured-image"><img src="https://www.cybereason.com/hubfs/Sodinokibi-blog-1.png" alt=""></div>
      <h1><span id="hs_cos_wrapper_name" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="text">REvil / Sodinokibi: The Crown Prince of Ransomware</span></h1>
      <div class="cr-mln__post-author-share">
      <div id="hubspot-author_data" class="hubspot-editable cr-mln__post-meta" data-hubspot-form-id="author_data" data-hubspot-name="Blog Author">
        
          <span class="descriptor">Written By</span>
          <p><span class="author">Cybereason Nocturnus</span></p>
         
      </div>
    </div>
     
    </div>
    
    <!-- Sticky Author and Social Box -->
    
    <!-- END Sticky Author and Social Box -->
      <div class="container-is-blog columns is-multiline page-center cr-mln__blog-post--body">
        
        <div class="column is-7-fullhd is-7-desktop is-10-tablet is-10-mobile is-offset-1-fullhd is-offset-1-desktop is-offset-1-tablet is-offset-1-mobile">
          <span id="hs_cos_wrapper_post_body" class="hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text" style="" data-hs-cos-general-type="meta_field" data-hs-cos-type="rich_text"><p>Research By: Tom Fakterman</p>
<div class="hs-responsive-embed-wrapper hs-responsive-embed" style="width: 100%; height: auto; position: relative; overflow: hidden; padding: 0; max-width: 560px; max-height: 315px; min-width: 256px; margin: 0px auto; display: block;">
<div class="hs-responsive-embed-inner-wrapper" style="position: relative; overflow: hidden; max-width: 100%; padding-bottom: 56.25%; margin: 0;"><iframe class="hs-responsive-embed-iframe" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" xml="lang" src="//www.youtube.com/embed/EdPiEJm3PDk" width="560" height="315" frameborder="0" allowfullscreen data-service="youtube"></iframe></div>
</div>
<!--more-->
<h2 style="line-height: 1.75;">What is Sodinokibi RANSOMWARE?</h2>
<p>In April of 2019, the Cybereason Nocturnus team encountered and analyzed a new type of ransomware dubbed REvil/Sodinokibi. REvil/Sodinokibi is highly evasive, and takes many measures to prevent its detection by antivirus and other means.</p>
<p>The authors of REvil/Sodinokibi have previously been connected to the same authors of the prolific <a href="https://www.cybereason.com/blog/gandcrab-evasive-infection-chain">GandCrab ransomware</a>, which <a href="https://www.zdnet.com/article/gandcrab-ransomware-operation-says-its-shutting-down/">was recently retired</a>. GandCrab is responsible for <a href="https://www.zdnet.com/article/bitdefender-releases-third-gandcrab-ransomware-free-decrypter-in-the-past-year/">40% of all ransomware infections globally</a>. If the association is accurate, GandCrab sets a good example for just how impactful REvil/Sodinokibi may become.</p>
<p>Ransomware remains a huge business risk to organizations in many vectors. Highly evasive ransomware such as REvil/Sodinokibi and GandCrab are the cause of huge damage to organizations each year.</p>
<p>In this report we analyze the attack and malware, and offer security recommendations for defenders to consider when coming up against this attack.</p>
<h2 style="line-height: 1.75;">WHO IS BEHIND SODINOKIBI?</h2>
<p>Initially, most of the REvil / Sodinokibi attacks were observed in Asia. Although recently Europe became one of the significant affected regions.</p>
<p>When the ransomware first emerged, it exploited vulnerabilities in servers and other critical assets of SMBs. As time went by, we saw other infection vectors such as phishing and exploit kits.</p>
<p>During our investigation, we also encountered several instances where the REvil / Sodinokibi ransomware purposefully searches for an AV made by the&nbsp; <a href="https://global.ahnlab.com/site/main.do">South Korean security vendor "Ahnlab"</a> in the infected machine in order to inject its malicious payload to the trusted AV vendor.</p>
<p>There is evidence presented in this research and <a href="https://www.certego.net/en/news/malware-tales-sodinokibi/">by previous vendors</a> that suggests that the REvil / Sodinokibi ransomware was created by the same group as the prolific GandCrab ransomware.</p>
<h2 style="line-height: 1.75;">Security Recommendations</h2>
<p style="line-height: 1.25;">Do not download files from suspicious sources or click on suspicious links.</p>
<p style="line-height: 1.25;">Make regular backups of important files, both locally and externally in the cloud.</p>
<p style="line-height: 1.25;">Enable PowerShell prevention in the Cybereason solution.</p>
<p style="line-height: 1.25;">Activate Cybereason anti-ransomware in Prevention mode to detect and prevent this threat and other, similar threats.</p>
<h2 style="line-height: 1.75;">Table of Contents</h2>
<p style="line-height: 1.25;"><a href="#introduction" rel=" noopener">Introduction</a></p>
<p style="line-height: 1.25;"><a href="#analysis" rel=" noopener">Analysis of the Attack</a></p>
<p style="line-height: 1.25;"><a href="#loader1" rel=" noopener">Loader Phase One: The UAC Bypass</a></p>
<p style="line-height: 1.25;"><a href="#loader2" rel=" noopener">Loader Phase Two: Injection to Ahnlab</a></p>
<p style="line-height: 1.25;"><a href="#payload" rel=" noopener">The Sodinokibi Payload</a></p>
<p style="line-height: 1.25;"><a href="#conclusion" rel=" noopener">Conclusion</a></p>
<p style="line-height: 1.25;"><a href="#mitre" rel=" noopener">MITRE ATT&amp;CK Technique Breakdown</a></p>
<p style="line-height: 1.25;"><a href="#iocs" rel=" noopener">Indicators of Compromise</a></p>
<br><a id="introduction" data-hs-anchor="true"></a>
<h2 style="line-height: 1.75;">Introduction</h2>
<p>In April of 2019, the Cybereason Nocturnus team encountered several instances where REvil / Sodinokibi was dropped to the target machine via a malicious link as a zip file containing malicious JavaScript.</p>
<p>Though the Cybereason solution prevented the ransomware, we have seen it <a href="https://www.bleepingcomputer.com/news/security/sodinokibi-ransomware-exploits-windows-bug-to-elevate-privileges/">successfully execute in other organizations</a>. It is able to completely incapacitate a business by preventing the access of data and critical assets of a target machine, among other damage. As of now, the malware does not have the capability to self-propagate, but once that is implemented, it could extend its impact across a network.</p>
<p>When first discovered in late April, REvil / Sodinokibi (AKA Sodin) was reported as being installed on machines by exploiting an Oracle WebLogic vulnerability (<a href="https://www.oracle.com/technetwork/security-advisory/alert-cve-2019-2725-5466295.html">CVE-2019-2725</a>) and subsequently started propagating through exploit kits and spam.&nbsp;</p>
<p>In this blog post, we perform a deep technical analysis of the <a href="https://www.bleepingcomputer.com/news/security/ryuk-sodinokibi-ransomware-responsible-for-higher-average-ransoms/">Sodinokibi ransomware</a>, focusing on the ransomware delivery method as well as the defensive mechanisms put in place by the malware authors in order to evade AV detection.&nbsp;</p>
<p>This malware showcases a resurgence of ransomware we have been tracking in the industry. Though some have <a href="https://www.networkcomputing.com/network-security/ransomware-attacks-drop-sharply-crytojacking-rises">reported ransomware attacks decreasing</a>, we are seeing that ransomware is here to stay. In fact, <a href="https://www.bleepingcomputer.com/news/security/ryuk-sodinokibi-ransomware-responsible-for-higher-average-ransoms/">ransomware attack payments have doubled</a> in the second quarter of this year. Organizations need security products that are able to defend against the latest attacks in order to stay on top and detect and prevent successfully.</p>
<p>During our analysis, we have noticed interesting similarities between the <a href="https://www.cybereason.com/blog/gandcrab-evasive-infection-chain">GandCrab ransomware</a>, whose operators claimed in June 2019 that <a href="https://www.zdnet.com/article/gandcrab-ransomware-operation-says-its-shutting-down/">they are retiring and discontinuing their operation</a>. Our findings bode well with <a href="https://www.tesorion.nl/aconnection-between-the-sodinokibi-and-gandcrab-ransomware-families/">other reports</a> by other security researchers that also <a href="https://krebsonsecurity.com/2019/07/is-revil-the-new-gandcrab-ransomware/">found similarities between the two ransomware</a>.</p>
<h2>HOW IS SODINOKIBI DELIVERED?</h2>
<a id="analysis" data-hs-anchor="true"></a>
<h3 style="line-height: 1.75;">Analysis of the Attack</h3>
<p>The initial infection vector used by the threat actor is a phishing email containing a malicious link. When pressed, the link downloads a supposedly legitimate zip file that is actually malicious. REvil / Sodinokibi zip files have a very low detection rate on VirusTotal, which signals that the majority of antivirus vendors do not flag the initial payload as malicious.</p>
<p>Since the initial REvil / Sodinokibi payload is able to pass undetected, the first layer of defense for many organizations is immediately bypassed:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=1751&amp;name=Sodinokibi-blog-image-1.png" alt="Sodinokibi / REvil zip file detection rate on virustotal" width="1751" loading="lazy" style="width: 1751px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=876&amp;name=Sodinokibi-blog-image-1.png 876w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=1751&amp;name=Sodinokibi-blog-image-1.png 1751w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=2627&amp;name=Sodinokibi-blog-image-1.png 2627w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=3502&amp;name=Sodinokibi-blog-image-1.png 3502w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=4378&amp;name=Sodinokibi-blog-image-1.png 4378w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-1.png?width=5253&amp;name=Sodinokibi-blog-image-1.png 5253w" sizes="(max-width: 1751px) 100vw, 1751px"></em></p>
<p style="text-align: center;"><em>The REvil / Sodinokibi zip file detection rate on VirusTotal is quite low. </em></p>
<p>The zip file contains an obfuscated JavaScript file. When the user double clicks on the JavaScript file, WScript executes it:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=499&amp;name=Sodinokibi-blog-image-2.png" alt="Sodinokibi / REvil WScript execution" width="499" loading="lazy" style="width: 499px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=250&amp;name=Sodinokibi-blog-image-2.png 250w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=499&amp;name=Sodinokibi-blog-image-2.png 499w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=749&amp;name=Sodinokibi-blog-image-2.png 749w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=998&amp;name=Sodinokibi-blog-image-2.png 998w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=1248&amp;name=Sodinokibi-blog-image-2.png 1248w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-2.png?width=1497&amp;name=Sodinokibi-blog-image-2.png 1497w" sizes="(max-width: 499px) 100vw, 499px"></em></p>
<p style="text-align: center;"><em>WScript executing malicious JavaScript.</em></p>
<p style="text-align: center;"><em style="background-color: transparent;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=1920&amp;name=Sodinokibi-blog-image-3.png" alt="Sodinokibi / REvil first stage process tree" width="1920" loading="lazy" style="width: 1920px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=960&amp;name=Sodinokibi-blog-image-3.png 960w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=1920&amp;name=Sodinokibi-blog-image-3.png 1920w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=2880&amp;name=Sodinokibi-blog-image-3.png 2880w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=3840&amp;name=Sodinokibi-blog-image-3.png 3840w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=4800&amp;name=Sodinokibi-blog-image-3.png 4800w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-3.png?width=5760&amp;name=Sodinokibi-blog-image-3.png 5760w" sizes="(max-width: 1920px) 100vw, 1920px"></em></p>
<p style="text-align: center;"><em style="background-color: transparent;">The first stage process tree as seen in the Cybereason solution.</em></p>
<p>The JavaScript file de-obfuscates itself by rearranging characters from a list called <em>eiculwo, </em>which is located in the JavaScript file:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=1858&amp;name=Sodinokibi-blog-image-4.png" alt="Sodinokibi / REvil obfuscated JavaScript file" width="1858" loading="lazy" style="width: 1858px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=929&amp;name=Sodinokibi-blog-image-4.png 929w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=1858&amp;name=Sodinokibi-blog-image-4.png 1858w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=2787&amp;name=Sodinokibi-blog-image-4.png 2787w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=3716&amp;name=Sodinokibi-blog-image-4.png 3716w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=4645&amp;name=Sodinokibi-blog-image-4.png 4645w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-4.png?width=5574&amp;name=Sodinokibi-blog-image-4.png 5574w" sizes="(max-width: 1858px) 100vw, 1858px"></em></p>
<p style="text-align: center;"><em>The first half of the obfuscated JavaScript file. </em></p>
<p>The variable <em>vhtsxspmssj</em>, located in the JavaScript file, is an obfuscated PowerShell script that will be de-obfuscated by the attackers later on in the attack:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=956&amp;name=Sodinokibi-blog-image-5.png" alt="Sodinokibi / REvil de-obfuscated JavaScript file" width="956" loading="lazy" style="width: 956px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=478&amp;name=Sodinokibi-blog-image-5.png 478w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=956&amp;name=Sodinokibi-blog-image-5.png 956w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=1434&amp;name=Sodinokibi-blog-image-5.png 1434w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=1912&amp;name=Sodinokibi-blog-image-5.png 1912w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=2390&amp;name=Sodinokibi-blog-image-5.png 2390w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-5.png?width=2868&amp;name=Sodinokibi-blog-image-5.png 2868w" sizes="(max-width: 956px) 100vw, 956px"></em></p>
<p style="text-align: center;"><em>The de-obfuscated JavaScript file.</em></p>
<p>The JavaScript file de-obfuscates the variable <em>vhtsxspmssj</em>, mentioned earlier as the PowerShell script, and saves it in the directory <em>temp</em> with the name <em>jurhtcbvj.tmp</em>.</p>
<p><em>Note: We have encountered variants of the malware where the script downloads the secondary payload instead of embedding it within the initial script.</em></p>
<p>The file <em>jurhtcbvj.tmp</em> is a PowerShell script filled with multiple unnecessary exclamation marks, most likely to further obfuscate itself. The JavaScript file launches a PowerShell command to remove the exclamation marks and execute the PowerShell script:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=1672&amp;name=Sodinokibi-blog-image-6.png" alt="Sodinokibi / REvil  contents of the obfuscated PowerShell script jurhtcbvj.tmp" width="1672" loading="lazy" style="width: 1672px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=836&amp;name=Sodinokibi-blog-image-6.png 836w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=1672&amp;name=Sodinokibi-blog-image-6.png 1672w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=2508&amp;name=Sodinokibi-blog-image-6.png 2508w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=3344&amp;name=Sodinokibi-blog-image-6.png 3344w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=4180&amp;name=Sodinokibi-blog-image-6.png 4180w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-6.png?width=5016&amp;name=Sodinokibi-blog-image-6.png 5016w" sizes="(max-width: 1672px) 100vw, 1672px"></em></p>
<p style="text-align: center;"><em>The contents of the obfuscated PowerShell script jurhtcbvj.tmp.</em></p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=526&amp;name=Sodinokibi-blog-image-7.png" alt="Sodinokibi command to execute the PowerShell script" width="526" style="width: 526px; display: block; margin-left: auto; margin-right: auto;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=263&amp;name=Sodinokibi-blog-image-7.png 263w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=526&amp;name=Sodinokibi-blog-image-7.png 526w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=789&amp;name=Sodinokibi-blog-image-7.png 789w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=1052&amp;name=Sodinokibi-blog-image-7.png 1052w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=1315&amp;name=Sodinokibi-blog-image-7.png 1315w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-7.png?width=1578&amp;name=Sodinokibi-blog-image-7.png 1578w" sizes="(max-width: 526px) 100vw, 526px"></p>
<p style="text-align: center;"><em>The command to replace exclamation marks and execute the PowerShell script.</em></p>
<p>The PowerShell script decodes an additional script that is Base64-encoded and executes it. The decoded script contains a .NET module also encoded with Base64, which is subsequently decoded and loaded into the PowerShell process memory. Once loaded, it executes the function <em>Install1:</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=1476&amp;name=Sodinokibi-blog-image-8.png" alt="Sodinokibi / REvil decoded script decrypting and loading module test.dll into memory" width="1476" loading="lazy" style="width: 1476px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=738&amp;name=Sodinokibi-blog-image-8.png 738w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=1476&amp;name=Sodinokibi-blog-image-8.png 1476w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=2214&amp;name=Sodinokibi-blog-image-8.png 2214w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=2952&amp;name=Sodinokibi-blog-image-8.png 2952w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=3690&amp;name=Sodinokibi-blog-image-8.png 3690w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-8.png?width=4428&amp;name=Sodinokibi-blog-image-8.png 4428w" sizes="(max-width: 1476px) 100vw, 1476px"></em></p>
<p style="text-align: center;"><em>The decoded script decrypting and loading module test.dll into memory.</em></p>
<p>The module <em>test.dll</em> is one of many layers of this delivery process. The function <em>Install1</em> contains yet another module encoded with Base64. The function decodes the module and loads it into memory:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=1370&amp;name=Sodinokibi-blog-image-9.png" alt="Sodinokibi Base64-encoded module Install1" width="1370" loading="lazy" style="width: 1370px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=685&amp;name=Sodinokibi-blog-image-9.png 685w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=1370&amp;name=Sodinokibi-blog-image-9.png 1370w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=2055&amp;name=Sodinokibi-blog-image-9.png 2055w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=2740&amp;name=Sodinokibi-blog-image-9.png 2740w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=3425&amp;name=Sodinokibi-blog-image-9.png 3425w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-9.png?width=4110&amp;name=Sodinokibi-blog-image-9.png 4110w" sizes="(max-width: 1370px) 100vw, 1370px"></em></p>
<p style="text-align: center;"><em>Base64-encoded module Install1.</em></p>
<p style="text-align: center;"><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=515&amp;name=Sodinokibi-blog-image-10.png" alt="Sodinokibi / REvil loading the module Install1 into memory" width="515" loading="lazy" style="width: 515px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=258&amp;name=Sodinokibi-blog-image-10.png 258w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=515&amp;name=Sodinokibi-blog-image-10.png 515w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=773&amp;name=Sodinokibi-blog-image-10.png 773w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=1030&amp;name=Sodinokibi-blog-image-10.png 1030w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=1288&amp;name=Sodinokibi-blog-image-10.png 1288w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-10.png?width=1545&amp;name=Sodinokibi-blog-image-10.png 1545w" sizes="(max-width: 515px) 100vw, 515px"></p>
<p style="text-align: center;">Loading the module <em>Install1</em> into memory.</p>
<p>If the malware was unable to gain high enough privileges, it will attempt a User Access Control bypass.</p>
<a id="loader1" data-hs-anchor="true"></a>
<h2 style="line-height: 1.75;">Loader Phase One: The UAC Bypass</h2>
<p>The module loaded into memory functions as a loader for the next phase of the malware. The module uses <a href="https://docs.microsoft.com/en-us/windows/desktop/api/securitybaseapi/nf-securitybaseapi-checktokenmembership">CheckTokenMembership</a> to confirm the processes’ privileges. If the processes’ privileges are insufficient, it <a href="https://www.google.com/url?q=https://www.winhelponline.com/blog/compmgmtlauncher-uac-bypass-windows-10/&amp;sa=D&amp;ust=1563896258026000&amp;usg=AFQjCNHEtGHgAg04t0LM18W3oFiQFOlmvw">tries to bypass</a> User Access Control (<a href="https://java.com/en/download/faq/uac.xml">UAC</a>). In order to bypass UAC, the malware writes itself to the registry key <em>Software\Classes\mscfile\shell\open\command\</em> and launches a new instance of explorer.exe <a href="https://www.google.com/url?q=https://github.com/ChaitanyaHaritash/My-Exploits/tree/master/COMPMGMTLAUNCHER_UAC_BYPASS&amp;sa=D&amp;ust=1563896258026000&amp;usg=AFQjCNEnA9mux_XUW5sapR5w5MdlYlPWDw">to execute CompMgmtLauncher.exe:</a></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=1385&amp;name=Sodinokibi-blog-image-11.png" alt="Sodinokibi / REvil creating the registry key and launching CompMgmtLauncher.exe" width="1385" loading="lazy" style="width: 1385px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=693&amp;name=Sodinokibi-blog-image-11.png 693w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=1385&amp;name=Sodinokibi-blog-image-11.png 1385w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=2078&amp;name=Sodinokibi-blog-image-11.png 2078w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=2770&amp;name=Sodinokibi-blog-image-11.png 2770w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=3463&amp;name=Sodinokibi-blog-image-11.png 3463w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-11.png?width=4155&amp;name=Sodinokibi-blog-image-11.png 4155w" sizes="(max-width: 1385px) 100vw, 1385px"></em></p>
<p style="text-align: center;"><em>Creating the registry key and launching CompMgmtLauncher.exe.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=482&amp;name=Sodinokibi-blog-image-12.png" alt="Sodinokibi / REvil explorer.exe is used to launch ComMgmtLauncher.exe" width="482" loading="lazy" style="width: 482px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=241&amp;name=Sodinokibi-blog-image-12.png 241w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=482&amp;name=Sodinokibi-blog-image-12.png 482w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=723&amp;name=Sodinokibi-blog-image-12.png 723w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=964&amp;name=Sodinokibi-blog-image-12.png 964w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=1205&amp;name=Sodinokibi-blog-image-12.png 1205w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-12.png?width=1446&amp;name=Sodinokibi-blog-image-12.png 1446w" sizes="(max-width: 482px) 100vw, 482px"></em></p>
<p style="text-align: center;"><em>Explorer.exe is used to launch ComMgmtLauncher.exe.</em></p>
<p>When <em>CompMgmtLauncher.exe</em> is executed, it executes anything configured in the registry key <em>Software\Classes\mscfile\shell\open\command\</em>. In this instance, it is executing the same PowerShell command executed earlier to replace exclamation marks and execute the PowerShell script, but with higher privileges:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=823&amp;name=Sodinokibi-blog-image-13.png" alt="Sodinokibi / REvil registry key creation in order to bypass UAC" width="823" style="display: block; margin-left: auto; margin-right: auto; width: 823px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=412&amp;name=Sodinokibi-blog-image-13.png 412w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=823&amp;name=Sodinokibi-blog-image-13.png 823w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=1235&amp;name=Sodinokibi-blog-image-13.png 1235w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=1646&amp;name=Sodinokibi-blog-image-13.png 1646w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=2058&amp;name=Sodinokibi-blog-image-13.png 2058w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-13.png?width=2469&amp;name=Sodinokibi-blog-image-13.png 2469w" sizes="(max-width: 823px) 100vw, 823px"></p>
<p style="text-align: center;"><em>The registry key creation in order to bypass UAC.</em></p>
<p>The process is now being executed with the highest privileges, and the attack continues:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=1915&amp;name=Sodinokibi-blog-image-14.png" alt="Sodinokibi / REvil the process tree after the UAC bypass" width="1915" loading="lazy" style="width: 1915px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=958&amp;name=Sodinokibi-blog-image-14.png 958w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=1915&amp;name=Sodinokibi-blog-image-14.png 1915w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=2873&amp;name=Sodinokibi-blog-image-14.png 2873w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=3830&amp;name=Sodinokibi-blog-image-14.png 3830w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=4788&amp;name=Sodinokibi-blog-image-14.png 4788w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-14.png?width=5745&amp;name=Sodinokibi-blog-image-14.png 5745w" sizes="(max-width: 1915px) 100vw, 1915px"></em></p>
<p style="text-align: center;"><em>The process tree after the UAC bypass as seen in the Cybereason solution.</em></p>
<p>The loader module is loaded into memory and checks again for privileges. This time, it has sufficient privileges and continues the attack. Within the loader module resources is an xor encrypted portable executable.</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=1188&amp;name=Sodinokibi-blog-image-15.png" alt="Sodinokibi / REvil xor encrypted PE" width="1188" loading="lazy" style="width: 1188px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=594&amp;name=Sodinokibi-blog-image-15.png 594w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=1188&amp;name=Sodinokibi-blog-image-15.png 1188w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=1782&amp;name=Sodinokibi-blog-image-15.png 1782w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=2376&amp;name=Sodinokibi-blog-image-15.png 2376w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=2970&amp;name=Sodinokibi-blog-image-15.png 2970w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-15.png?width=3564&amp;name=Sodinokibi-blog-image-15.png 3564w" sizes="(max-width: 1188px) 100vw, 1188px"></em></p>
<p style="text-align: center;"><em>The xor encrypted PE.</em></p>
<p>The loader loads the portable executable from the resource into memory, decrypts it in memory using the key <em>7B,</em> then executes it:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=1136&amp;name=Sodinokibi-blog-image-16.png" alt="Sodinokibi / REvil portable executable in memory" width="1136" loading="lazy" style="width: 1136px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=568&amp;name=Sodinokibi-blog-image-16.png 568w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=1136&amp;name=Sodinokibi-blog-image-16.png 1136w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=1704&amp;name=Sodinokibi-blog-image-16.png 1704w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=2272&amp;name=Sodinokibi-blog-image-16.png 2272w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=2840&amp;name=Sodinokibi-blog-image-16.png 2840w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-16.png?width=3408&amp;name=Sodinokibi-blog-image-16.png 3408w" sizes="(max-width: 1136px) 100vw, 1136px"></em></p>
<p style="text-align: center;"><em>The portable executable in memory before the xor decryption.</em></p>
<div><img src="https://lh4.googleusercontent.com/Nj4xxPZQ3_FZ8t703ioShCsLyr3QQqS_nOPeXQGxmPlumstpb7yjjvB3YnXHbmuUuBfxDmwn9cn4zCB_tGtjL0Z-xQdxTaizPH7BitKMAbQR-LWOyxbvOyKjvumzHReEzfW0_yeI" alt="" style="display: block; margin-left: auto; margin-right: auto;"></div>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=1165&amp;name=Sodinokibi-blog-image-17.png" alt="Sodinokibi / REvil portable executable" width="1165" loading="lazy" style="width: 1165px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=583&amp;name=Sodinokibi-blog-image-17.png 583w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=1165&amp;name=Sodinokibi-blog-image-17.png 1165w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=1748&amp;name=Sodinokibi-blog-image-17.png 1748w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=2330&amp;name=Sodinokibi-blog-image-17.png 2330w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=2913&amp;name=Sodinokibi-blog-image-17.png 2913w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-17.png?width=3495&amp;name=Sodinokibi-blog-image-17.png 3495w" sizes="(max-width: 1165px) 100vw, 1165px"></em></p>
<p style="text-align: center;"><em>The portable executable in memory after the xor decryption.</em></p>
<a id="loader2" data-hs-anchor="true"></a>
<h2 style="line-height: 1.75;">Loader Phase Two: Injection to Ahnlab</h2>
<p>The portable executable in memory is the second loader module that will be used for the final payload. In this phase, the malware attempts to inject the ransomware payload into an <a href="https://www.ahnlab.com/">Ahnlab antivirus process</a>.</p>
<p>In order to do so, the second loader checks to see if Ahnlab antivirus is installed on the target machine. If the <em>Ahnlab V3 Lite</em> software service <em>V3 Service</em> exists, it checks if the file <em>autoup.exe</em> is available. <em>autoup.exe </em>is part of the Ahnlab Updater and is vulnerable to attack.</p>
<p>The GandCrab authors have been <a href="https://www.bleepingcomputer.com/news/security/gandcrab-ransomware-author-bitter-after-security-vendor-releases-vaccine-app/">reported</a> to be bitter with Ahnlab. Given this, it is interesting to note that REvil / Sodinokibi specifically searches for Ahnlab and attempts to use it for the attack:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=1133&amp;name=Sodinokibi-blog-image-18.png" alt="Sodinokibi / REvil malware" width="1133" loading="lazy" style="width: 1133px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=567&amp;name=Sodinokibi-blog-image-18.png 567w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=1133&amp;name=Sodinokibi-blog-image-18.png 1133w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=1700&amp;name=Sodinokibi-blog-image-18.png 1700w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=2266&amp;name=Sodinokibi-blog-image-18.png 2266w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=2833&amp;name=Sodinokibi-blog-image-18.png 2833w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-18.png?width=3399&amp;name=Sodinokibi-blog-image-18.png 3399w" sizes="(max-width: 1133px) 100vw, 1133px"></em></p>
<p style="text-align: center;"><em>The malware checking for the Ahnlab antivirus.</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=1121&amp;name=Sodinokibi-blog-image-19.png" alt="Sodinokibi / REvil path string for autoup.exe" width="1121" loading="lazy" style="width: 1121px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=561&amp;name=Sodinokibi-blog-image-19.png 561w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=1121&amp;name=Sodinokibi-blog-image-19.png 1121w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=1682&amp;name=Sodinokibi-blog-image-19.png 1682w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=2242&amp;name=Sodinokibi-blog-image-19.png 2242w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=2803&amp;name=Sodinokibi-blog-image-19.png 2803w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-19.png?width=3363&amp;name=Sodinokibi-blog-image-19.png 3363w" sizes="(max-width: 1121px) 100vw, 1121px"></em></p>
<p style="text-align: center;"><em>The path string for autoup.exe.</em></p>
<p>If the malware is able to find the Ahnlab service and executable, the loader automatically launches the autoup.exe process in a suspended state and attempts to inject the REvil / Sodinokibi payload into it via process hollowing.</p>
<p>If the Ahnlab antivirus is not installed on the machine, the loader will launch a separate instance of the current PowerShell process in a suspended state and try to inject the REvil / Sodinokibi payload into it via process hollowing.</p>
<p>The payload is stored in the module resources as an xor-encrypted portable executable with key <em>7B:</em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=1186&amp;name=Sodinokibi-blog-image-20.png" alt="Sodinokibi / REvil xor encrypted portable executable" width="1186" loading="lazy" style="width: 1186px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=593&amp;name=Sodinokibi-blog-image-20.png 593w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=1186&amp;name=Sodinokibi-blog-image-20.png 1186w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=1779&amp;name=Sodinokibi-blog-image-20.png 1779w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=2372&amp;name=Sodinokibi-blog-image-20.png 2372w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=2965&amp;name=Sodinokibi-blog-image-20.png 2965w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-20.png?width=3558&amp;name=Sodinokibi-blog-image-20.png 3558w" sizes="(max-width: 1186px) 100vw, 1186px"></em></p>
<p style="text-align: center;"><em>The xor encrypted portable executable.</em></p>
<a id="payload" data-hs-anchor="true"></a>
<h2 style="line-height: 1.75;">The Sodinokibi Payload</h2>
<p>The malware stores encrypted configuration data with RC4 encryption in the <em>.grrr</em>. The name differs among various malware variants:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=982&amp;height=231&amp;name=Sodinokibi-blog-image-21.png" alt="sections of the REvil / Sodinokibi payload" width="982" height="231" loading="lazy" style="width: 982px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=491&amp;height=116&amp;name=Sodinokibi-blog-image-21.png 491w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=982&amp;height=231&amp;name=Sodinokibi-blog-image-21.png 982w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=1473&amp;height=347&amp;name=Sodinokibi-blog-image-21.png 1473w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=1964&amp;height=462&amp;name=Sodinokibi-blog-image-21.png 1964w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=2455&amp;height=578&amp;name=Sodinokibi-blog-image-21.png 2455w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-21.png?width=2946&amp;height=693&amp;name=Sodinokibi-blog-image-21.png 2946w" sizes="(max-width: 982px) 100vw, 982px"></p>
<p style="text-align: center;"><em>The sections of the REvil/Sodinokibi payload.</em></p>
<p>The configuration file contains information about which folders, files, and file extensions to exclude from encrypting. It also contains information on which processes to kill, which services to delete, how to escalate privileges with <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2018-8453">CVE-2018-8453</a>, how to communicate with C2s, and ransom note to display:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=1727&amp;name=Sodinokibi-blog-image-22.png" alt="configuration file for REvil / Sodinokibi" width="1727" loading="lazy" style="width: 1727px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=864&amp;name=Sodinokibi-blog-image-22.png 864w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=1727&amp;name=Sodinokibi-blog-image-22.png 1727w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=2591&amp;name=Sodinokibi-blog-image-22.png 2591w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=3454&amp;name=Sodinokibi-blog-image-22.png 3454w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=4318&amp;name=Sodinokibi-blog-image-22.png 4318w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-22.png?width=5181&amp;name=Sodinokibi-blog-image-22.png 5181w" sizes="(max-width: 1727px) 100vw, 1727px"></p>
<p style="text-align: center;"><em>The configuration file for REvil / Sodinokibi.</em></p>
<p>REvil / Sodinokibi identifies which keyboard languages are configured using <a href="https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-getkeyboardlayoutlist">GetKeyboardLayoutList</a>. It checks the primary language ID with a switch case. If one of the chosen languages is configured, the malware shuts down. The malware authors do not want to ransom files from the specific set of countries seen in the switch case below.</p>
<p>In this REvil / Sodinokibi variant, a check for <span style="font-weight: normal;">Syrian </span>was added, along with new checks for the system language using <a href="https://docs.microsoft.com/en-us/windows/win32/api/winnls/nf-winnls-getsystemdefaultuilanguage">GetSystemDefaultUILanguage</a> and <a href="https://docs.microsoft.com/en-us/windows/win32/api/winnls/nf-winnls-getuserdefaultuilanguage">GetUserDefaultUILanguage:</a></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=767&amp;name=Sodinokibi-blog-image-23.png" alt="Sodinokibi / REvil switch case for the primary language ID" width="767" loading="lazy" style="width: 767px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=384&amp;name=Sodinokibi-blog-image-23.png 384w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=767&amp;name=Sodinokibi-blog-image-23.png 767w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=1151&amp;name=Sodinokibi-blog-image-23.png 1151w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=1534&amp;name=Sodinokibi-blog-image-23.png 1534w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=1918&amp;name=Sodinokibi-blog-image-23.png 1918w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-23.png?width=2301&amp;name=Sodinokibi-blog-image-23.png 2301w" sizes="(max-width: 767px) 100vw, 767px"></em></p>
<p style="text-align: center;"><em>The switch case for the primary language ID.</em></p>
<p>Once the language checks pass, the malware continues its execution. It deletes shadow copies from the machine with <em>vssadmin.exe</em> to make file recovery more difficult:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=416&amp;name=Sodinokibi-blog-image-24.png" alt="Sodinokibi Shadow copy deletion with vssadmin.exe" width="416" loading="lazy" style="width: 416px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=208&amp;name=Sodinokibi-blog-image-24.png 208w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=416&amp;name=Sodinokibi-blog-image-24.png 416w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=624&amp;name=Sodinokibi-blog-image-24.png 624w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=832&amp;name=Sodinokibi-blog-image-24.png 832w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=1040&amp;name=Sodinokibi-blog-image-24.png 1040w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-24.png?width=1248&amp;name=Sodinokibi-blog-image-24.png 1248w" sizes="(max-width: 416px) 100vw, 416px"></em></p>
<p style="text-align: center;"><em>Shadow copy deletion with vssadmin.exe.</em></p>
<p>The ransomware iterates through all folders on the machine, encrypts all files, and drops a ransom note in each folder. Once it has finished encryption, it changes the desktop wallpaper to help inform the user of the attack:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=1916&amp;name=Sodinokibi-blog-image-25.png" alt="Sodinokibi / REvil new wallpaper after the ransomware encrypts the files" width="1916" loading="lazy" style="width: 1916px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=958&amp;name=Sodinokibi-blog-image-25.png 958w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=1916&amp;name=Sodinokibi-blog-image-25.png 1916w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=2874&amp;name=Sodinokibi-blog-image-25.png 2874w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=3832&amp;name=Sodinokibi-blog-image-25.png 3832w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=4790&amp;name=Sodinokibi-blog-image-25.png 4790w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-25.png?width=5748&amp;name=Sodinokibi-blog-image-25.png 5748w" sizes="(max-width: 1916px) 100vw, 1916px"></em></p>
<p style="text-align: center;"><em>The new wallpaper after the ransomware encrypts the files. </em></p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=1668&amp;name=Sodinokibi-blog-image-26.png" alt="Sodinokibi / REvil ransom note" width="1668" loading="lazy" style="width: 1668px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=834&amp;name=Sodinokibi-blog-image-26.png 834w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=1668&amp;name=Sodinokibi-blog-image-26.png 1668w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=2502&amp;name=Sodinokibi-blog-image-26.png 2502w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=3336&amp;name=Sodinokibi-blog-image-26.png 3336w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=4170&amp;name=Sodinokibi-blog-image-26.png 4170w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-26.png?width=5004&amp;name=Sodinokibi-blog-image-26.png 5004w" sizes="(max-width: 1668px) 100vw, 1668px"></em></p>
<p style="text-align: center;"><em>The ransom note for the ransomware.</em></p>
<p>After the malware encrypts the files on the target machine, it tries to establish communication with a C2 server. In order to generate the URL for the C2, it iterates through a list of domains configured in the previously decoded configuration file:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=1678&amp;name=Sodinokibi-blog-image-27.png" alt="Sodinokibi domain list from the configuration file" width="1678" loading="lazy" style="width: 1678px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=839&amp;name=Sodinokibi-blog-image-27.png 839w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=1678&amp;name=Sodinokibi-blog-image-27.png 1678w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=2517&amp;name=Sodinokibi-blog-image-27.png 2517w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=3356&amp;name=Sodinokibi-blog-image-27.png 3356w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=4195&amp;name=Sodinokibi-blog-image-27.png 4195w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-27.png?width=5034&amp;name=Sodinokibi-blog-image-27.png 5034w" sizes="(max-width: 1678px) 100vw, 1678px"></em></p>
<p style="text-align: center;"><em>The domain list from the configuration file. </em></p>
<p>The malware creates several random URLs using the domains with a combination of hard-coded and randomly generated strings. <a href="https://www.tesorion.nl/aconnection-between-the-sodinokibi-and-gandcrab-ransomware-families/">A recent report by Tesorion</a> covers the similarities in the way REvil / Sodinokibi and GandCrab generate random URLs, which further strengthens suspicions of a potential shared author:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=902&amp;name=Sodinokibi-blog-image-28.png" alt="Sodinokibi / REvil hard-coded strings" width="902" loading="lazy" style="width: 902px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=451&amp;name=Sodinokibi-blog-image-28.png 451w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=902&amp;name=Sodinokibi-blog-image-28.png 902w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=1353&amp;name=Sodinokibi-blog-image-28.png 1353w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=1804&amp;name=Sodinokibi-blog-image-28.png 1804w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=2255&amp;name=Sodinokibi-blog-image-28.png 2255w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-28.png?width=2706&amp;name=Sodinokibi-blog-image-28.png 2706w" sizes="(max-width: 902px) 100vw, 902px"><br>The hard-coded strings for random URL generation.</em></p>
<p>Once the URLs are generated, the malware sends encrypted machine information to each of the domains including usernames, machine name, domain name, machine language, operating system type, and CPU architecture:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=748&amp;name=Sodinokibi-blog-image-29.png" alt="Sodinokibi / REvil data sent to the C2 server before encryption" width="748" loading="lazy" style="width: 748px; margin-left: auto; margin-right: auto; display: block;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=374&amp;name=Sodinokibi-blog-image-29.png 374w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=748&amp;name=Sodinokibi-blog-image-29.png 748w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=1122&amp;name=Sodinokibi-blog-image-29.png 1122w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=1496&amp;name=Sodinokibi-blog-image-29.png 1496w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=1870&amp;name=Sodinokibi-blog-image-29.png 1870w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-29.png?width=2244&amp;name=Sodinokibi-blog-image-29.png 2244w" sizes="(max-width: 748px) 100vw, 748px"></em></p>
<p style="text-align: center;"><em>The data sent to the C2 server before encryption.</em></p>
<p>When the user clicks on the ransom note and enters the key, a page appears that lists the price they must pay in bitcoin to retrieve their files:</p>
<p><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=1918&amp;name=Sodinokibi-blog-image-30.png" alt="Sodinokibi / REvil Tor browser ransom note" width="1918" loading="lazy" style="width: 1918px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=959&amp;name=Sodinokibi-blog-image-30.png 959w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=1918&amp;name=Sodinokibi-blog-image-30.png 1918w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=2877&amp;name=Sodinokibi-blog-image-30.png 2877w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=3836&amp;name=Sodinokibi-blog-image-30.png 3836w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=4795&amp;name=Sodinokibi-blog-image-30.png 4795w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-30.png?width=5754&amp;name=Sodinokibi-blog-image-30.png 5754w" sizes="(max-width: 1918px) 100vw, 1918px"><img src="https://lh6.googleusercontent.com/N_3Ba0GIPlWf7VVDHBQVRBcoTVSgnLwstyP9PPOY48NapMTCnYBL1_MskeEyemopHqDSIeolyxCo5RjA_D_BlGmIFphHvJlHrdH7GkLgONYee5jNV6MvGbRa6xlfAQmk2RMdqGHC" alt="" style="display: block; margin-left: auto; margin-right: auto;"></p>
<p style="text-align: center;"><em>The Tor browser ransom note.</em></p>
<p>The Cybereason anti-ransomware solution identified the threat and mitigated the incident before any damage was caused:</p>
<p style="text-align: center;"><em><img src="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=1918&amp;name=Sodinokibi-blog-image-31.png" alt="Cybereason anti-ransomware solution detects and prevents the REvil / Sodinokibi ransomware" width="1918" loading="lazy" style="width: 1918px;" srcset="https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=959&amp;name=Sodinokibi-blog-image-31.png 959w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=1918&amp;name=Sodinokibi-blog-image-31.png 1918w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=2877&amp;name=Sodinokibi-blog-image-31.png 2877w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=3836&amp;name=Sodinokibi-blog-image-31.png 3836w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=4795&amp;name=Sodinokibi-blog-image-31.png 4795w, https://www.cybereason.com/hs-fs/hubfs/dam/images/images-web/blog-images/Sodinokibi-blog-image-31.png?width=5754&amp;name=Sodinokibi-blog-image-31.png 5754w" sizes="(max-width: 1918px) 100vw, 1918px"></em></p>
<p style="text-align: center;"><em>The Cybereason anti-ransomware solution detects and prevents the REvil/Sodinokibi ransomware. </em></p>
<a id="conclusion" data-hs-anchor="true"></a>
<h2 style="line-height: 1.75;">Conclusion</h2>
<p>In this blog, we took a deep dive into the REvil / Sodinokibi ransomware infection process, and showed that even though the obfuscation techniques used by the ransomware authors are quite simple,&nbsp; they are still proving to be very effective in bypassing most antivirus vendors.</p>
<p>Our analysis further supports the suspicion that the threat actors behind the REvil / Sodinokibi ransomware are the same allegedly retired authors who created the GandCrab ransomware, based on findings detailed in this report, such as: similarities in the language and countries whitelist (Russian-speaking countries and even Syrian Arabic), the “revengeful” targeting of an Ahnlab product for process injection,&nbsp; and the similarities in the URL-generation routine.&nbsp;</p>
<p>Since April 2019, the REvil / Sodinokibi ransomware has become very prolific and has become the <a href="https://www.bleepingcomputer.com/news/security/ryuk-sodinokibi-ransomware-responsible-for-higher-average-ransoms/">4th most common ransomware</a> within less than 4 months after its first appearance. It has since gone through several minor updates, and it is our assessment that its industrious authors will continue to develop the ransomware, adding more features and improving its evasive capabilities.&nbsp;</p>
<a id="mitre" data-hs-anchor="true"></a>
<h2 style="line-height: 1.25;">MITRE ATT&amp;CK TECHNIQUES BREAKDOWN</h2>
<table style="height: 486.076px; border-style: solid; border-color: #2d3236; width: 971px; margin-left: auto; margin-right: auto;">
<tbody>
<tr style="height: 80.9896px;">
<td style="background-color: #cccccc; height: 81px; width: 178.229px; border-style: solid; border-color: #00212e; text-align: center; vertical-align: middle;">
<p><span style="color: #000000;"><strong>Initial Access</strong></span></p>
</td>
<td style="background-color: #cccccc; height: 81px; width: 177.535px; border-style: solid; border-color: #00212e; text-align: center; vertical-align: middle;">
<p><span style="color: #000000;"><strong>Execution</strong></span></p>
</td>
<td style="background-color: #cccccc; height: 81px; width: 207.205px; border-style: solid; border-color: #00212e; text-align: center; vertical-align: middle;">
<p><span style="color: #000000;"><strong>Privilege Escalation</strong></span></p>
</td>
<td style="background-color: #cccccc; height: 81px; width: 207.188px; border-style: solid; border-color: #00212e; text-align: center; vertical-align: middle;">
<p><span style="color: #000000;"><strong>Defense Evasion</strong></span></p>
</td>
<td style="background-color: #cccccc; height: 81px; width: 199.722px; border-style: solid; border-color: #00212e; text-align: center; vertical-align: middle;">
<p><span style="color: #000000;"><strong>Impact</strong></span></p>
</td>
</tr>
<tr style="height: 80px;">
<td style="height: 80px; width: 178.229px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1192/" rel=" noopener">Spearphishing Link</a></p>
</td>
<td style="height: 80px; width: 177.535px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1059/" rel=" noopener">Command-Line Interface</a></p>
</td>
<td style="height: 80px; width: 207.205px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1134/" rel=" noopener">Access Token Manipulation</a></p>
</td>
<td style="height: 80px; width: 207.188px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1140/" rel=" noopener">Deobfuscate/</a><a href="https://attack.mitre.org/techniques/T1140/" rel=" noopener">Decode Files or Information</a></p>
</td>
<td style="height: 80px; width: 199.722px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1486/">Data Encrypted for Impact</a></p>
</td>
</tr>
<tr style="height: 110px;">
<td style="height: 110px; width: 178.229px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1193/" rel=" noopener">Spearphishing Attachment</a></p>
</td>
<td style="height: 110px; width: 177.535px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1129/" rel=" noopener">Execution through Module Load</a></p>
</td>
<td style="height: 110px; width: 207.205px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1088/" rel=" noopener">Bypass User Account Control</a></p>
</td>
<td style="height: 110px; width: 207.188px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1089/" rel=" noopener">Disabling Security Tools</a></p>
</td>
<td style="height: 110px; width: 199.722px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1490/" rel=" noopener">Inhibit System Recovery</a></p>
</td>
</tr>
<tr style="height: 106.997px;">
<td style="height: 107px; width: 178.229px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1190/" rel=" noopener">Exploit Public-Facing Application</a></p>
</td>
<td style="height: 107px; width: 177.535px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1086/" rel=" noopener">PowerShell</a></p>
</td>
<td style="height: 107px; width: 207.205px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1068/">Exploitation for Privilege Escalation</a></p>
</td>
<td style="height: 107px; width: 207.188px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1093/" rel=" noopener">Process Hollowing</a></p>
</td>
<td style="height: 107px; width: 199.722px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
</tr>
<tr style="height: 52.9861px;">
<td style="height: 53px; width: 178.229px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
<td style="height: 53px; width: 177.535px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1204/" rel=" noopener">User Execution</a></p>
</td>
<td style="height: 53px; width: 207.205px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
<td style="height: 53px; width: 207.188px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
<td style="height: 53px; width: 199.722px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
</tr>
<tr style="height: 53.9931px;">
<td style="height: 54px; width: 178.229px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
<td style="height: 54px; width: 177.535px; border-style: solid; border-color: #00212e; text-align: center;">
<p><a href="https://attack.mitre.org/techniques/T1064/" rel=" noopener">Scripting</a></p>
</td>
<td style="height: 54px; width: 207.205px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
<td style="height: 54px; width: 207.188px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
<td style="height: 54px; width: 199.722px; border-style: solid; border-color: #00212e; text-align: center;">&nbsp;</td>
</tr>
</tbody>
</table>
<a id="iocs" data-hs-anchor="true"></a>
<h2 style="line-height: 1.75;">Indicators of Compromise</h2>
<p><strong>Java Script </strong></p>
<p>MD5 - 3e974b7347d347ae31c1b11c05a667e2</p>
<p>SHA1 - 2cc597d6bffda9ef6b42fed84f7a20f6f52c4756</p>
<p>&nbsp;</p>
<p><strong>Jurhrtcbvj.tmp</strong></p>
<p>MD5 - e402d34e8d0f14037769294a15060508</p>
<p>SHA1 - b751d0d722d3c602bcc33be1d62b1ba2b0910e03</p>
<p>&nbsp;</p>
<p><strong>Test.dll</strong></p>
<p>MD5 - 8ea320dff9ef835269c0355ca6850b33</p>
<p>SHA1 - f9df190a616653e2e1869d82abd4f212320e9f4b</p>
<p>&nbsp;</p>
<p><strong>sodinokibi_loader_1.dll</strong></p>
<p>MD5 - 7d4c2211f3279201599f9138d6b61162</p>
<p>SHA1 - ee410f1d10edc70f8de3b27907fc10fa341f620a</p>
<p>&nbsp;</p>
<p><strong>sodinokibi_loader_2.dll</strong></p>
<p>MD5 - 613dc98a6cf34b20528183fbcc78a8ee</p>
<p>SHA1 - 5cd8eadcd70b89f6963cbd852c056195a17d0ce2</p>
<p>&nbsp;</p>
<p><strong>sodinokibi_payload.exe</strong></p>
<p>MD5 - b488bdeeaeda94a273e4746db0082841</p>
<p>SHA1 - 5dac89d5ecc2794b3fc084416a78c965c2be0d2a</p></span>
          
          <!-- IOC PopUp Modal -->
          
          
          
          <!-- -->
          
          <!-- Social Share -->
          <div class="cr-blog-post__social-sharing">
            <span>Share</span>
            <div id="hs_cos_wrapper_module_161724375084957" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-social_sharing" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">






<div class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_social_sharing" data-hs-cos-general-type="widget" data-hs-cos-type="social_sharing">
  
	
  
    
    
    
			
		

    <a href="https://twitter.com/intent/tweet?original_referer=https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack&amp;utm_medium=social&amp;utm_source=twitter&amp;url=https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack&amp;utm_medium=social&amp;utm_source=twitter&amp;source=tweetbutton&amp;text=" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/twitter-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on twitter">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.facebook.com/share.php?u=https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack&amp;utm_medium=social&amp;utm_source=facebook" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/facebook-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on facebook">
    </a>
	

  
	
  
    
    
    
			
		

    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.cybereason.com/blog/research/the-sodinokibi-ransomware-attack&amp;utm_medium=social&amp;utm_source=linkedin" target="_blank" rel="noopener" style="width:16px;">
      <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/linkedin-gray.svg" class="hs-image-widget hs-image-social-sharing-24" style="height:16px;width:16px;" width="16" hspace="0" alt="Share on linkedin">
    </a>
	

</div></div>
          </div> 
          
          
          <!-- CONDITIONAL Author Box Display -->
            <div class="container columns cr-mln__author-listing-single">
              
                <div class="column headshot is-3-full-hd is-3-desktop is-3-tablet is-12-mobile">
                  <img class="cr-speaker-headshot" src="https://www.cybereason.com/hubfs/CR_Owl_Web_Mono@3x%202.png" alt="Cybereason Nocturnus">
                </div>
              
              <div class="column is-9-full-hd is-9-desktop is-12-mobile">
                <span class="descriptor">About the Author</span>
                <h4>Cybereason Nocturnus</h4>
                
                  <a class="social" href="https://www.linkedin.com/company/cybereason" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-linkedin.png">
                  </a>
                
                
                  <a class="social" href="https://twitter.com/cr_nocturnus" target="_blank">
                    <img src="https://www.cybereason.com/hubfs/dam/images/images-web/blog-images/template-images/icon-social-gray-twitter.svg">
                  </a>
                
                
                  <p>The Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence, and enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack methodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason Nocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.</p>
                
                
                  <a class="cr-button cr-button__min" href="https://www.cybereason.com/blog/authors/cybereason-nocturnus">All Posts by Cybereason Nocturnus</a>
                
              </div>            
            </div>
          
        <!-- CONDITIONAL Post Type Choices -->
        
        <!-- Malicious Life Post -->
        
        
        <!-- CISO Stories -->
        
        <!-- Webinar -->
        
          
        <!-- CONDITIONAL Transcript -->
          
        
         <!-- Related Posts -->
        <div id="hs_cos_wrapper_module_1649342860525315" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><img src="https://www.cybereason.com/hubfs/strifewater.png" alt="StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations"></a>
    <h4><a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><span class="underline">StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations</span></a></h4>
     <p>Cybereason discovered an undocumented RAT dubbed StrifeWater attributed to Iranian APT Moses Staff who deploy destructive ransomware following network infiltration and the exfiltration of sensitive data...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage"><img src="https://www.cybereason.com/hubfs/powerless.png" alt="PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage"></a>
    <h4><a href="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage"><span class="underline">PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage</span></a></h4>
     <p>Cybereason discovered a new toolset developed by Iranian APT Phosphorus which revealed a connection to Memento ransomware and includes the newly discovered PowerLess Backdoor that evades detection by running PowerShell in a .NET context...</p>
   </div>
 </div>



    </div>
  </div>
</section></div>
          
          
      </div>
        
        <!-- Sidebar -->

      <div class="column is-3-fullhd is-3-desktop is-12-mobile cr-malicious-life-network__sidebar">
        <div class="cr-ml-sidebar--group">
        <div class="top-stripe"></div>
        <div class="sidebar-block search-section">
          <form action="/hs-search-results">
            <input type="search" class="hs-search-field__input" name="term" autocomplete="on" placeholder="Search">
            <input type="hidden" name="type" value="BLOG_POST">
            <input type="hidden" name="type" value="LISTING_PAGE">
            <button type="submit" class="arrow"></button>
          </form>
        </div>
        <div class="sidebar-block subscribe">
          <a href="#blog-subscribe">
            <h4>Subscribe</h4>
            <span>Never miss a blog.</span>
          </a>
        </div>

        <div class="sidebar-block recent-posts">
          <h4>Recent Posts</h4>
          
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/malicious-life-podcast-operation-snow-white-part-2" class="post-name"><span class="underline">Malicious Life Podcast: Operation Snow White, Part 2</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/threat-analysis-beast-ransomware" class="post-name"><span class="underline">THREAT ANALYSIS: Beast Ransomware</span></a>
                       
                    </div>
                </div>
            
                <div class="recent-posts__single-post">
                    <div class="text-content-bundle">
                        <a href="https://www.cybereason.com/blog/cuckoo-spear-pt2-threat-actor-arsenal" class="post-name"><span class="underline">CUCKOO SPEAR Part 2: Threat Actor Arsenal</span></a>
                       
                    </div>
                </div>
            
        </div>

        <div class="sidebar-block category-listing">
          <h4>Categories</h4>
          <ul>
            <li><a href="https://www.cybereason.com/blog/category/research">Research</a></li>
            <li><a href="https://www.cybereason.com/blog/category/podcasts">Podcasts</a></li>
            <li><a href="https://www.cybereason.com/blog/category/webinars">Webinars</a></li>
            <li><a href="https://www.cybereason.com/blog/category/resources">Resources</a></li>
            <li><a href="https://www.cybereason.com/blog/category/videos">Videos</a></li>
            <li><a href="https://www.cybereason.com/blog/category/news">News</a></li>
          </ul>

          <a class="rec-category__single--view-all" href="/blog/category/research">All Posts</a>
        </div>

        
      </div><!-- END .rec-categories__all -->
      
      
      
    </div>
       
    </div>
  </div>
</div></div>

</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-2 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="display: none;" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_1616011887658867" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module">
<section class="cr-section related-posts__wrapper">
  <div class="container container-is-blog page-center">
     <h3>Related Posts</h3>
     <div class="columns is-multiline">
       
  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><img src="https://www.cybereason.com/hubfs/strifewater.png" alt="StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations"></a>
    <h4><a href="https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"><span class="underline">StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations</span></a></h4>
     <p>Cybereason discovered an undocumented RAT dubbed StrifeWater attributed to Iranian APT Moses Staff who deploy destructive ransomware following network infiltration and the exfiltration of sensitive data...</p>
   </div>
 </div>


  
 <div class="column is-6-fullhd is-6-desktop is-full-mobile blog-listing__single-post">
  <div class="text-content-bundle">
    <a href="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage"><img src="https://www.cybereason.com/hubfs/powerless.png" alt="PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage"></a>
    <h4><a href="https://www.cybereason.com/blog/research/powerless-trojan-iranian-apt-phosphorus-adds-new-powershell-backdoor-for-espionage"><span class="underline">PowerLess Trojan: Iranian APT Phosphorus Adds New PowerShell Backdoor for Espionage</span></a></h4>
     <p>Cybereason discovered a new toolset developed by Iranian APT Phosphorus which revealed a connection to Memento ransomware and includes the newly discovered PowerLess Backdoor that evades detection by running PowerShell in a .NET context...</p>
   </div>
 </div>



    </div>
  </div>
</section></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-3 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_161767462015235" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module widget-type-blog_subscribe" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-mln__blog-listing-page__subscribe-footer">
  <div class="container container-is-blog columns page-center">
    <div class="column is-8-fullhd is-8-desktop is-10-tablet is-12-mobile">
      <span class="tag">NEWSLETTER</span>
      <h3>Never miss a blog</h3>
      <p>Get the latest research, expert insights, and security industry news.</p>
      <a class="cr-button cr-mln__subscribe" href="#blog-subscribe">Subscribe</a>
    </div>
    <!--<div class="column is-5-fullhd is-5-desktop is-half-tablet is-12-mobile is-offset-1-fullhd is-offset-1-desktop">
      <div class="inputs-wrapper">
        
        
      </div>
    </div>-->
  </div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

<div class="row-fluid-wrapper row-depth-1 row-number-4 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_166508001252918" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><div class="cr-sticky-cta-bar bg-black" id="sticky-bar">
  <div class="content">
    <span>Want to see the Cybereason Defense Platform in action?</span>
    <a class="cr-button cr-button__fill-yellow" href="https://www.cybereason.com/request-a-demo" target="_blank">Schedule a Demo</a>
  </div>
  <div class="close">X</div>
</div></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end body -->
</div><!--end body wrapper -->

<div class="footer-container-wrapper">
    <div class="footer-container container-fluid">

<div class="row-fluid-wrapper row-depth-1 row-number-1 ">
<div class="row-fluid ">
<div class="span12 widget-span widget-type-custom_widget " style="" data-widget-type="custom_widget" data-x="0" data-w="12">
<div id="hs_cos_wrapper_module_16036762394194314" class="hs_cos_wrapper hs_cos_wrapper_widget hs_cos_wrapper_type_module" style="" data-hs-cos-general-type="widget" data-hs-cos-type="module"><!-- FOOTER -->

<footer class="cr-section cr-footer cr-footer__full">
    <div class="container page-center">
      <div class="columns">
          <div class="column is-6-fullhd is-5-desktop cr-footer__col cr-footer__left">
            <div class="cr-footer__Left-logo">
              
                <a href="https://www.cybereason.com">
                  
                <img src="https://www.cybereason.com/hubfs/dam/images/images-web/logos/cr-brand/cr-logo-inline--primary-white.png">
              </a>
            </div>
          </div>
          <div class="columns column is-6-fullhd is-6-desktop cr-footer__col cr-footer__right">
            <div class="cr-footer__links-list column">
              <h4>About</h4>
              <ul>
                <li><a href="https://www.cybereason.com/company/who-we-are">Who We Are</a>
                </li><li><a href="https://www.cybereason.com/company/careers">Careers</a>
          <!-- </li><li><a href="https://www.cybereason.com/company/leadership">Leadership</a> --->
                </li><li><a href="https://www.cybereason.com/company/contact-us">Contact</a>
              </li></ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Resources</h4>
              <ul>
                <li><a href="https://www.cybereason.com/blog">Blog</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/case-study">Case Studies</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/webinars">Webinars</a></li>
                <li><a href="https://www.cybereason.com/resources/tag/white-papers">White Papers</a></li>
             </ul>
            </div>
            <div class="cr-footer__links-list column">
              <h4>Platform</h4>
              <ul>
                
                <li><a href="https://www.cybereason.com/platform">Overview</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-prevention">Endpoint Protection</a></li>
                <li><a href="https://www.cybereason.com/platform/endpoint-detection-response-edr">EDR</a></li>
                <li><a href="https://www.cybereason.com/platform/managed-detection-response-mdr">MDR</a></li>
              </ul>
            </div>
          </div>
      </div>
    </div>
  
    <div class="container page-center">
      <div class="columns cr-footer__bottom-bar">
        <div class="column">
          <p>©Cybereason 2024. All Rights Reserved.</p>
        </div>
        <div class="column bottom-bar__links">
          <ul>
            <li><a href="https://www.cybereason.com/terms-of-use">Terms of Use</a></li>
            <li><a href="https://www.cybereason.com/privacy-notice">Privacy Notice</a></li>
            <li><a href="https://www.cybereason.com/ccpa-privacy-request">Do Not Sell</a></li>
            <li><a href="https://www.cybereason.com/security">Security</a></li>
            <!--<li><a href="#">Cookie Policy</a></li>-->
          </ul>
        </div>

        <div class="column bottom-bar__social">
          <ul>
            <li><a class="facebook" href="https://www.facebook.com/Cybereason/"></a></li>
            <li><a class="twitter" href="https://twitter.com/cybereason"></a></li>
            <li><a class="youtube" href="https://www.youtube.com/channel/UCOm7AaB0HiNH4Phe66sK0Ew"></a></li>
            <li><a class="linkedin" href="https://www.linkedin.com/company/cybereason"></a></li>
            <li><a class="instagram" href="https://www.instagram.com/cybereason"></a></li>
          </ul>
        </div>
    </div>
  </div>

</footer></div>

</div><!--end widget-span -->
</div><!--end row-->
</div><!--end row-wrapper -->

    </div><!--end footer -->
</div><!--end footer wrapper -->

    
<!-- HubSpot performance collection script -->
<script defer src="https://static.hsappstatic.net/content-cwv-embed/static-1.1293/embed.js"></script>
<script src="//cdn2.hubspot.net/hub/3354902/hub_generated/template_assets/42507089303/1644440411417/__CR_Web_Platform/JS/animatedModal/animatedModal.min.js"></script>
<script>
var hsVars = hsVars || {}; hsVars['language'] = 'en';
</script>

<script src="/hs/hsstatic/cos-i18n/static-1.53/bundles/project.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41681847227/1644941386128/module_41681847227_CR_-_Malicious_Life_Network_--_Tier_One_Header.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/41682410610/1644941443113/module_41682410610_CR_-_Malicious_Life_Network_--_Main_Hero.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/43300360745/1724042213858/module_43300360745_CR_-_Malicious_Life_Network_--_Related_Posts.min.js"></script>
<script src="https://cdn2.hubspot.net/hub/3354902/hub_generated/module_assets/86933076631/1669911113440/module_86933076631_CR_-_Sticky_CTA_Bar.min.js"></script>

<!-- Start of HubSpot Analytics Code -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "blog-post"]);
_hsq.push(["setCanonicalUrl", "https:\/\/www.cybereason.com\/blog\/research\/the-sodinokibi-ransomware-attack"]);
_hsq.push(["setPageId", "11621636073"]);
_hsq.push(["setContentMetadata", {
    "contentPageId": 11621636073,
    "legacyPageId": "11621636073",
    "contentFolderId": null,
    "contentGroupId": 5272851739,
    "abTestId": null,
    "languageVariantId": 11621636073,
    "languageCode": "en",
    
    
}]);
</script>

<script type="text/javascript" id="hs-script-loader" async defer src="/hs/scriptloader/3354902.js"></script>
<!-- End of HubSpot Analytics Code -->


<script type="text/javascript">
var hsVars = {
    render_id: "c7626690-c711-4d62-bf02-8e8597701792",
    ticks: 1729733313514,
    page_id: 11621636073,
    
    content_group_id: 5272851739,
    portal_id: 3354902,
    app_hs_base_url: "https://app.hubspot.com",
    cp_hs_base_url: "https://cp.hubspot.com",
    language: "en",
    analytics_page_type: "blog-post",
    scp_content_type: "",
    analytics_page_id: "11621636073",
    category_id: 3,
    folder_id: 0,
    is_hubspot_user: false
}
</script>


<script defer src="/hs/hsstatic/HubspotToolsMenu/static-1.354/js/index.js"></script>

<script>if ($('[id^="hs_form"]').length > 0) {
  var myInterval = setInterval(
  function() {
    var myFields = document.getElementsByClassName('hs-input');
    if (myFields.length > 0) {
      clearInterval(myInterval);
      for (var i = 0; i < myFields.length; i++) {
        var myField = myFields[i];
		var myTagName = myField.tagName.toLowerCase();
        if (myTagName == 'input' || myTagName == 'textarea') {
          if (myField.placeholder != null) {
            myField.placeholder = myField.placeholder.replace('*', '');
          }
        } else if (myTagName == 'select') {
          myField.options[0].innerHTML = myField.options[0].innerHTML.replace('*', '');
        }
      }
    }
  }, 100);
}
</script>

<div id="fb-root"></div>
  <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v3.0";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
 


    <script>
function sticky_relocate() {
  var window_top = $(window).scrollTop();
  var div_top = $('#sticky-anchor').offset().top;
  if (window_top > div_top) {
    $('#sticky').addClass('stick');
  } else {
    $('#sticky').removeClass('stick');
  }
}

$(function() {
  $(window).scroll(sticky_relocate);
  sticky_relocate();
});
</script>
    <!-- Generated by the HubSpot Template Builder - template version 1.03 -->

<script type="text/javascript" src="/_Incapsula_Resource?SWJIYLWA=719d34d31c8e3a6e6fffd425f7e032f3&ns=6&cb=1096362108" async></script></body></html>