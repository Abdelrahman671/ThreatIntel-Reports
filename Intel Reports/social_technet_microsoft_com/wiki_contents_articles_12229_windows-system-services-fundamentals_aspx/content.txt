<!DOCTYPE html><html
	class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus theme-light"
	lang="en-us"
	dir="ltr"
	data-authenticated="false"
	data-auth-status-determined="false"
	data-target="docs"
	x-ms-format-detection="none">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Windows System Services Fundamentals" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://learn.microsoft.com/en-us/archive/technet-wiki/12229.windows-system-services-fundamentals" /><meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />

	<meta property="og:image:alt" content="Microsoft Learn" />

	<meta name="twitter:card" content="summary_large_image" />

	<meta name="twitter:site" content="@MicrosoftLearn" />

	<meta name="color-scheme" content="light dark"><meta name="author" content="Archiveddocs" />
<meta name="breadcrumb_path" content="/archive/technet-wiki/breadcrumb/toc.json" />
<meta name="depot_name" content="MSDN.technet-wiki-archive" />
<meta name="document_id" content="02557b43-a772-09fa-de25-ac8da47117dd" />
<meta name="document_version_independent_id" content="f33a6f14-ce5d-0bc5-8148-16f48f1dfec0" />
<meta name="feedback_help_link_type" content="" />
<meta name="feedback_help_link_url" content="" />
<meta name="feedback_product_url" content="" />
<meta name="feedback_system" content="None" />
<meta name="git_commit_id" content="34006db6ab3513e11d257fe8070c340fec1942a9" />
<meta name="gitcommit" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/technet-wiki-archive/commit/34006db6ab3513e11d257fe8070c340fec1942a9?path=/technet-wiki-archive/w/12229.windows-system-services-fundamentals.md&amp;_a=contents" />
<meta name="is_archived" content="true" />
<meta name="locale" content="en-us" />
<meta name="ms:mtpsurl" content="https://social.technet.microsoft.com/wiki/contents/articles/12229.windows-system-services-fundamentals.aspx" />
<meta name="ms.author" content="Archiveddocs" />
<meta name="ms.date" content="1/9/2024 7:30:02 AM" />
<meta name="ms.topic" content="Archived" />
<meta name="original_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/technet-wiki-archive?path=/technet-wiki-archive/w/12229.windows-system-services-fundamentals.md&amp;version=GBlive&amp;_a=contents" />
<meta name="page_type" content="conceptual" />
<meta name="permissioned-type" content="public" />
<meta name="Robots" content="NOINDEX,NOFOLLOW" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="toc_rel" content="toc.json" />
<meta name="TOCTitle" content="Windows System Services Fundamentals" />
<meta name="uhfHeaderId" content="MSDocsHeader-Archive" />
<meta name="updated_at" content="2024-01-17 02:00 AM" />
<meta name="word_count" content="7184" />
<meta name="persistent_id" content="222d6246-55da-4b9a-2e0c-d46512cda8e6" />
	<meta name="github_feedback_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/technet-wiki-archive?path=/technet-wiki-archive/w/12229.windows-system-services-fundamentals.md&version=GBlive&_a=contents" /><link href="https://learn.microsoft.com/en-us/archive/technet-wiki/12229.windows-system-services-fundamentals" rel="canonical"><title>Windows System Services Fundamentals | Microsoft Learn</title><link rel="stylesheet" href="/static/assets/0.4.028676160/styles/site-ltr.css">

	<script id="msdocs-script">
	var msDocs = {environment: {
			supportLevel: 'production',
			accessLevel: 'online',
			reviewFeatures: false,
			systemContent: true,
			azurePortalHostname: 'portal.azure.com',
			legacyHosting: false,
			siteName: 'learn',
		},data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {},
			hasBinaryRating: false,
			feedbackHelpLinkType:'',
			feedbackHelpLinkUrl:'',
			standardFeedback: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',extendBreadcrumb: false,isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasPrintButton: true,
			hasBookmark: true,
			hasShare: true,
			isPermissioned: false,
			isPrivateUnauthorized: false,hasRecommendations: true,},
		functions:{}
	};
	</script><script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script><script src="/static/assets/0.4.028676160/global/deprecation.js"></script><script src="/static/assets/0.4.028676160/scripts/en-us/index-docs.js"></script></head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" style="z-index: 1070" class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center  has-body-background" tabindex="1">Skip to main content</a><div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>

		<div id="unsupported-browser" style="
			background-color: white;
			color: black;
			padding: 16px;
			border-bottom: 1px solid grey;"
			hidden
		>
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
						style="
						background-color: #0078d4;
						border: 1px solid #0078d4;
						color: white;
						padding: 6px 12px;
						border-radius: 2px;
						display: inline-block;
						">Download Microsoft Edge</a>
					<a href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
						style="
							background-color: white;
							padding: 6px 12px;
							border: 1px solid #505050;
							color: #171717;
							border-radius: 2px;
							display: inline-block;
							">More info about Internet Explorer and Microsoft Edge</a>
				</div>
			</div>
		</div>
		<!-- liquid-tag banners global -->

		<!-- site header -->
		<header id="ms--site-header" data-test-id="site-header-wrapper" role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization">
			<div id="ms--mobile-nav" class="site-header display-none-tablet padding-inline-none gap-none" data-bi-name="mobile-header" data-test-id="mobile-header"></div>
			<div id="ms--primary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L1-header" data-test-id="primary-header"></div>
			<div id="ms--secondary-nav" class="site-header display-none display-flex-tablet" data-bi-name="L2-header" data-test-id="secondary-header"></div>
		</header><div id="content-header" class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
				<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
					<button type="button" class="contents-button button button-sm margin-right-xxs" data-bi-name="contents-expand" aria-haspopup="true" data-contents-button>
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button button-sm" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
			</div><div id="disclaimer-holder" class="has-overflow-hidden has-default-focus">
			<!-- liquid-tag banners sectional -->
		</div>
	</div>

	<div class="mainContainer  uhf-container has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile "><div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="margin-top-sm-tablet position-sticky display-flex flex-direction-column" aria-label="Primary"></nav>
			</div><!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps "><div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" class="" role="main" data-bi-name="content" lang="en-us" dir="ltr"><!-- article-header -->
							<div id="article-header" class="background-color-body margin-top-sm-tablet margin-bottom-xs display-none-print">
								<div class="display-flex align-items-center "><details id="article-header-breadcrumbs-overflow-popover" class="popover" data-for="article-header-breadcrumbs">
										<summary class="button button-clear button-primary button-sm inner-focus" aria-label="All breadcrumbs">
											<span class="icon">
												<span class="docon docon-more"></span>
											</span>
										</summary>
										<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none">

										</div>
									</details>

									<bread-crumbs id="article-header-breadcrumbs" data-test-id="article-header-breadcrumbs" class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"></bread-crumbs><div id="article-header-page-actions"  class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"><a
											id="lang-link-tablet"
											class="button button-primary button-clear button-sm display-none display-inline-flex-tablet"
											title="Read in English" data-bi-name="language-toggle"
											data-read-in-link
											hidden>
											<span class="icon margin-none" aria-hidden="true" data-read-in-link-icon>
												<span class="docon docon-locale-globe"></span>
											</span>
											<span class="is-visually-hidden" data-read-in-link-text>Read in English</span>
										</a><button
												type="button"
												class="collection button button-clear button-sm button-primary display-none display-inline-flex-tablet"
												data-list-type="collection"
												data-bi-name="collection"
												title="Add to collection">
												<span class="icon margin-none" aria-hidden="true">
													<span class="docon docon-circle-addition"></span>
												</span>
												<span class="collection-status is-visually-hidden">Save</span>
											</button>
										<details class="popover popover-right" id="article-header-page-actions-overflow">
											<summary class="justify-content-flex-start button button-clear button-sm button-primary" aria-label="More actions" title="More actions">
												<span class="icon" aria-hidden="true">
													<span class="docon docon-more-vertical"></span>
												</span>
											</summary>
											<div class="popover-content padding-xs"><button
														data-page-action-item="overflow-mobile"
														type="button"
														class="justify-content-flex-start button-block button-sm has-inner-focus button button-clear display-none-tablet"
														data-bi-name="contents-expand"
														data-contents-button
														data-popover-close>
														<span class="icon">
															<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
														</span><span class="contents-expand-title">Table of contents</span></button><a
													id="lang-link-overflow"
													class="justify-content-flex-start button-sm has-inner-focus button button-clear button-block display-none-tablet"
													title="Read in English" data-bi-name="language-toggle"
													data-page-action-item="overflow-mobile"
													data-check-hidden="true"
													data-read-in-link
													hidden
													>
													<span class="icon" aria-hidden="true" data-read-in-link-icon>
														<span class="docon docon-locale-globe"></span>
													</span>
													<span data-read-in-link-text>Read in English</span>
												</a><button
														type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="collection"
														data-bi-name="collection"
														title="Save"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="collection-status">Save</span>
													</button>

			 										
													<button
													 	type="button"
														class="collection justify-content-flex-start button button-clear button-sm has-inner-focus button-block display-none-tablet"
														data-list-type="plan"
														data-bi-name="plan"
														title="Add to Plan"
														data-page-action-item="overflow-mobile"
														data-check-hidden="true"
														data-popover-close
														hidden>
														<span class="icon" aria-hidden="true">
															<span class="docon docon-circle-addition"></span>
														</span>
														<span class="plan-status">Add to Plan</span>
													</button><div aria-hidden="true" class="margin-none" data-page-action-item="overflow-all"></div>
														<hr class="display-none-tablet margin-bottom-xxs margin-top-xxs" />
														<h4 class="font-size-sm padding-left-xxs">Share via</h4>

													<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start share-facebook" data-bi-name="facebook" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-facebook-share font-size-md color-primary"></span>
															</span>
															<span class="margin-left-xxs">Facebook</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-twitter" data-bi-name="twitter" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-xlogo-share font-size-xxs"></span>
															</span>
															<span class="margin-left-xxs">x.com</span>
														</a>
														<a class="button button-clear button-sm has-inner-focus button-block text-decoration-none justify-content-flex-start share-linkedin" data-bi-name="linkedin" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-linked-in-logo font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">LinkedIn</span>
														</a>
														<a class="button button-clear button-sm button-block has-inner-focus text-decoration-none justify-content-flex-start margin-bottom-xxs share-email" data-bi-name="email" data-page-action-item="overflow-all">
															<span class="icon" aria-hidden="true">
																<span class="docon docon-mail-message font-size-sm color-primary"></span>
															</span>
															<span class="margin-left-xxs">Email</span>
														</a><hr />
													<button
														class="button button-block button-clear button-sm justify-content-flex-start has-inner-focus margin-top-xxs"
														title="Print"
														type="button"
														aria-label="Print"
														data-bi-name="print"
														data-page-action-item="overflow-all"
														data-popover-close
														data-print-page
														data-check-hidden="true">
														<span class="icon" aria-hidden="true">
															<span class="docon docon-print font-size-sm color-primary"></span>
														</span>
														<span class="margin-left-xxs">Print</span>
													</button>
											</div>
										</details>
										
									</div></div>
							</div>
							<!-- end article-header --><div>
								<button type="button" class="border contents-button button button-clear button-sm is-hidden-tablet has-inner-focus" data-bi-name="contents-expand" data-contents-button hidden>
									<span class="icon">
										<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
									</span><span class="contents-expand-title">Table of contents</span></button>
							</div><!-- end mobile-contents button  -->

							<div class="content "><h1 id="windows-system-services-fundamentals">Windows System Services Fundamentals</h1><div class="display-flex justify-content-space-between align-items-center flex-wrap-wrap page-metadata-container">
										<div class="margin-right-xxs">
											<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr"><li>Article</li><li>
														<time class="is-invisible" data-article-date aria-label="Article review date" datetime="2024-01-17T02:00:00.131Z" data-article-date-source="git">1/17/2024</time>
													</li></ul>
										</div></div><nav id="center-doc-outline" class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm" data-bi-name="intopic toc" aria-label="In this article">
											<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">In this article</h2>
										</nav><!-- <content> --><h2 id="the-basics-of-windows-services">The Basics of Windows Services</h2>
<p>Windows system services are applications that start when the computer is booted and run in the background. &nbsp;Services handle&nbsp;<br>
low-level tasks that require no user interaction. There are over 200+ operating system features&nbsp;which&nbsp;implement a system service(s), to support&nbsp;features and functionality such as:</p>
<ul>
<li>
<ul>
<li>Authentication, Certificate, Encryption&nbsp;services</li>
<li>Networking features such as DNS, DHCP, Network Location Awareness, 802.11 Wireless and Wired Services.</li>
<li>Hardware related services such as Plug and Play services, display driver enhancements,&nbsp; audio and effects,&nbsp; print services, Bluetooth</li>
<li>Remote access. Terminal Services allow users to log on to a computer from a remote location.</li>
</ul>
</li>
</ul>
<p>In addition to core services that are part of Windows, third-party applications can implement&nbsp;device&nbsp;or file system drivers. Common examples of third-party services include&nbsp;video, sound, printing, &nbsp;firewall and antivirus services.</p>
<h4 id="services-architecture">Services Architecture</h4>
<p>The main components of the core service architecture are the Service Control Manager (SCM), service control programs, and service applications.&nbsp; The service control programs do not communicate with services directly; all communication goes through the SCM.&nbsp; This architecture is precisely what makes remote administration transparent to the service control program and service applications.</p>
<p>**&nbsp;**<a href="w/resources/8831.ser.jpg" data-linktype="relative-path"><img src="w/resources/8831.ser.jpg" alt="" data-linktype="relative-path"></a></p>
<p>&nbsp;</p>
<p><strong>Service Control Manager</strong><br>
The SCM is a special system process that runs the image systemroot\System32\Services.exe, which is responsible for starting, stopping, and interacting with services. Services are Win32 applications that call special Win32 functions to interact with the SCM to perform such actions as registering the serviceâs successful startup, responding to status requests, and pausing or shutting down the service.</p>
<p><strong>Service Control Programs</strong><br>
Service control programs are standard Win32 applications that use the SCM APIs CreateService, OpenService, StartService, ControlService, QueryServiceStatus, and DeleteService to communicate with or control services. To use the SCM functions, a service control program must first open a communications channel to the SCM. At the time of the open call, the service control program must specify what types of actions it wants to perform. For example, if a service control program simply wants to enumerate and display the services present in the SCM database, it requests Enumerate Service access. During its initialization, the SCM creates an internal object that represents the SCM database and uses Windows security functions to protect the object with a security descriptor that specifies which accounts can open the object by using which access permissions.</p>
<p>The SCM stores the security descriptor in the serviceâs registry subkey as the Security value, and it reads the value of Security when it scans the registryâs Services key during initialization so in the same way that a service control program must specify what types of access it wants to the SCM database, a service control program must also tell the SCM what access it wants to a service. Examples of accesses that a service control program can request include the ability to query a serviceâs status and to configure, stop, and start a service.&nbsp; For example, the security descriptor indicates that the Authenticated Users group can open the SCM object with enumerate-service access. However, only administrators can open the object with the access required to create or delete a service.</p>
<p>A service application contains the infrastructure necessary for communicating with the SCM, which sends commands to the service telling it to stop, pause, continue, or shut down. A service also calls special functions that communicate its status back to the SCM.&nbsp;&nbsp; Service applications, such as Web servers, consist of at least one application that runs as a service. A user who wants to start, stop, or configure a service uses a service control program. Although Windows provides built-in service control programs that provide general start, stop, pause, and continue functionality, some service applications include their own service control program that allows administrators to specify configuration settings particular to the service they manage.</p>
<p>Because most services do not (and absolutely should not) have a user interface, they are built as console programs. When you install an application that includes a service, the applicationâs setup program must register the service with the SCM. To register the service, the setup program calls the Win32 CreateService function, a services-related function whose client side is implemented in Advapi32.dll (located in the systemroot\System32 folder). Advapi32.dll, the âAdvanced APIâ DLL, implements all the client-side SCM APIs.</p>
<p>The primary difference between services and normal applications is that services are managed by the Service Control Manager (SCM). Services are implemented with the services API, which handles the interaction between the SCM and services. The SCM maintains a database of installed services and provides a unified way to control them, including:</p>
<ul>
<li>
<ul>
<li>Starting services.</li>
<li>Stopping services.</li>
<li>Managing running services.</li>
<li>Maintaining service-related state information.</li>
</ul>
</li>
</ul>
<p><strong>Services have one of three states: <em>started</em>, <em>stopped</em>, or <em>paused</em>.</strong></p>
<ul>
<li>
<ul>
<li>Started:&nbsp;&nbsp;service has successfully started.</li>
<li>Stopped:&nbsp;&nbsp;a stopped service has been completely shut down and must go through a normal startup procedure to enter the started state again.</li>
<li>Paused:&nbsp;&nbsp;a paused service suspends normal processing, but remains in memory and continues to respond to control requests. Paused services can, therefore, return to the started state without going through the startup procedure.</li>
</ul>
</li>
</ul>
<p>A key characteristic of a service is how it is started. The SCM has a database that includes information on how each service should be started. The following are the service startup types:</p>
<p><strong>Automatic:</strong>&nbsp;The SCM automatically starts these services during the system's boot process. They are often called <em>auto-start</em> services.<br>
<strong>Manual:</strong> &nbsp;These services must be started manually with the&nbsp;sc.exe command-line tool, or programmatically with the <strong>StartService</strong> function.<br>
They are often called <em>demand-start</em> services.<br>
<strong>Disabled:</strong> &nbsp;These services cannot be started. To start a disabled service, the user must first change the startup type to automatic or manual and click apply. After a service has started, the SCM uses <em>control requests</em> to manage the service's state. For example, the SCM sends control requests to notify a service that it is pausing, is resuming operation, or should be preparing to shut down. The SCM's database also contains the security settings for each service. These settings control how much access a service has to system resources and enable system administrators to control access to each service.</p>
<p>&nbsp;</p>
<h4 id="service-processes">Service Processes</h4>
<p>Running every service in its own process, instead of having services share a process whenever possible, wastes system resources. However, sharing processes means that if any of the services in the process encounters a problem that causes the process to exit, all the services in that process stop.</p>
<p>Some Windows&nbsp;Server&nbsp;2003 built-in services run in their own process; however, most services share a process with other services. For example, the SCM process, Services.exe, hosts the Event Log and the Plug and Play services.</p>
<p>The security-related services, such as the Security Accounts Manager service, the Net Logon service, and the IPSEC Services service, share the Lsass.exe process.</p>
<p>There is also a âgenericâ process named Service Host (Svchost, or the Svchost.exe application), which contains multiple services, located in the <em>systemroot</em>\Windows\System32 folder.</p>
<h4 id="generic-process">Generic Process</h4>
<p>A âgenericâ process named Svchost contains multiple services, and multiple instances of Svchost can run under different security contexts. Services that run in Svchost processes include Telephony, Remote Procedure Call (RPC), and Remote Access Connection Manager.</p>
<p>Windows&nbsp;Server&nbsp;2003 implements services that run in Svchost as DLLs and specifies the location of the DLL of a service in the value of the registry entry ImagePath (which has the form â<em>systemroot</em>\System32\svchost.exe -k <em>svchost instance name</em>â) in the corresponding service subkey. Every serviceâs registry subkey must also have a registry entry named ServiceDll under its Parameters subkey that points to the serviceâs DLL file. All services that share a common Svchost process specify the same parameter (â-k <em>svchost instance name</em>â).</p>
<p>Typically, each Svchost instance running on a Windows&nbsp;Server&nbsp;2003-based computer corresponds to a distinct account. For example, the ânetsvcsâ instance runs as LocalSystem, the âLocalServiceâ instance runs as NT AUTHORITY\LocalService, and the âNetworkServiceâ instance runs as NT AUTHORITY\NetworkService. There are one or two exceptions â for example, the Remote Procedure Call (RPC) service runs in its own LocalSystem instance for security reasons.</p>
<p>When the SCM encounters the first service that has an image path of âsvchost.exe -k <em>svchost instance name</em>â during service startup, it creates a new image database record for the Svchost instance name and starts the process as configured.</p>
<p>The new Svchost process takes the parameter and looks for a registry subkey having the same name as the parameter in HKLM\SOFTWARE\Microsoft\Windows&nbsp;NT\CurrentVersion\SvcHost. Svchost reads the contents of the SvcHost subkey, interpreting its contents as a list of service names, and notifies the SCM that it is hosting those services when Svchost registers with the SCM.</p>
<p>When the SCM encounters a Svchost process during service startup for which the value of its ImagePath matches that of an entry that SCM already has in the image database, SCM does not start the second process but instead just sends a start command for the service to the Svchost process it already started for that ImagePath value. The existing Svchost process reads the value of ServiceDll in the serviceâs subkey and loads the DLL into its process to start the service.</p>
<p>In general, the reason services share processes is to diminish memory footprint and thread usage, both of which increase dramatically as you add additional processes to the system. For example, every process typically ends up with its own thread pool, such as RPC server threads. The different Svchost instances on your computer are, for the most part, all running in different accounts, and each one hosts the services that run in that particular account. By running the Tasklist.exe tool with the /svc switch, you can see the account name listed for each Svchost instance.</p>
<h4 id="service-groups">Service Groups</h4>
<p>Many services will not work properly unless other components of the system are already running. When a computer is started, it follows an algorithm that dictates the order in which services are started. In Windows, system services are divided into a set of predefined groups. Assigning a service to a group has no effect other than to fine-tune its startup with respect to other services that belong to different groups.</p>
<p>The SCM builds the internal service database and reads and stores the contents of the List entry in the HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder subkey, a string value that lists the names and order of the defined service groups. A serviceâs registry subkey contains an optional Group entry to be used if that service or device driver needs to control its startup ordering with respect to services from other groups.</p>
<p>The SCM reads the value of a serviceâs Group entry to determine whether it is a member of a group and associates this value with the groupâs entry in the ServiceGroupOrder subkey mentioned earlier. The SCM also reads and records in the database the serviceâs group and service dependencies by querying its DependOnGroup and DependOnService registry entries.</p>
<p>For example, the Windows&nbsp;Server&nbsp;2003 networking stack is built from the bottom up, so networking services must specify Group entries that place them later in the startup sequence than networking device drivers. The SCM internally creates a group list that preserves the ordering of the groups it reads from the registry. Groups include (but are not limited to) NDIS, TDI, Primary Disk, Keyboard Port, and Keyboard Class. Add-on and third-party applications can even define their own groups and add them to the list.</p>
<p>Since the introduction of Plug and Play in MicrosoftÂ® WindowsÂ®&nbsp;2000, the service group order mechanism has become less significant. In Windows&nbsp;Server&nbsp;2003, Plug and Play is responsible for loading kernel drivers and services. Plug and Play manages the loading of kernel-mode drivers based on the presence of their associated devices.</p>
<p>The SCM is almost never involved in the loading of a driver. The most interesting remaining use of the service group order mechanism in kernel mode is for file system filter drivers.</p>
<p>The auto-start option for kernel-mode drivers is being phased out. Even if a driver is marked as AUTO_START, as soon as it starts the first time, it will receive a root-enumerated devnode registered on its behalf, and on all subsequent boots that root-enumerated devnode will cause the driver to be loaded by Plug and Play during the system start phase before the SCM is started.</p>
<p>The demand-start option is recommended for almost all Plug and Play drivers. Demand-start no longer means âwhen SCM is requested to start the driverâ (for example, in response to a net start command) as it did in prior versions of Windows. It now means when Plug and Play âdemandsâ it because of the discovery of devices associated with that driver.</p>
<p>&nbsp;</p>
<h4 id="service-dependencies">Service Dependencies</h4>
<p>In addition to notifying the SCM that a service is part of a particular load order group, you can tell the SCM that this service requires other services to be running before this service can run. For example, many Internet services â including the FTP Publishing Service, the World Wide Web Publishing Service, and the Simple Mail Transfer Protocol (SMTP) Service â are dependent on the IIS Admin Service. If the IIS Admin Service is not available, then none of these dependent services can run.</p>
<p>Conversely, you cannot stop the IIS Admin Service without first stopping the dependent services. If you could stop the IIS Admin Service first, all its dependent services would fail because those services cannot run unless IIS Admin Service is also running. The IIS Admin Service is therefore antecedent to its dependent services.</p>
<p>There are two types of service dependencies:</p>
<ul>
<li>The current service depends on other services to start. If Service X is antecedent to Service Y, Service X must be running before you can run Service Y.</li>
<li>Other services depend on the current service to start. If Service X is dependent on Service Y, Service Y must be running before you can run Service X.</li>
</ul>
<p>For example, if you run the Sc.exe tool, you will see that three services depend on the Telephony service. If an administrator attempts to stop the Telephony service and any dependent services are running, the call fails and the SCM returns the following error:</p>
<p>ERROR_DEPENDENT_SERVICES_RUNNING</p>
<p>&nbsp;</p>
<p>For another example, if you stop the Workstation service by using the following Net.exe command, you will receive a list of dependent services that need to be stopped as well.</p>
<p>net stop workstation</p>
<p>This command displays the following information:</p>
<p>The following services are dependent on the Workstation service.</p>
<p>Stopping the Workstation service will also stop these services.</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;Net Logon</p>
<p>&nbsp;&nbsp;&nbsp;Distributed File System</p>
<p>&nbsp;&nbsp;&nbsp;Computer Browser</p>
<p>&nbsp;</p>
<p>Do you want to continue this operation? (Y/N) [N]: y</p>
<p>The Net Logon service is stopping.</p>
<p>The Net Logon service was stopped successfully.</p>
<p>&nbsp;</p>
<p>The Distributed File System service is stopping.</p>
<p>The Distributed File System service was stopped successfully.</p>
<p>&nbsp;</p>
<p>The Computer Browser service is stopping.</p>
<p>The Computer Browser service was stopped successfully.</p>
<p>&nbsp;</p>
<p>The Workstation service is stopping.</p>
<p>The Workstation service was stopped successfully.</p>
<p>&nbsp;</p>
<p>If you restart the Workstation service by using the following command, the dependent services are not started automatically; you need to manually restart the services.</p>
<p>net start workstation</p>
<p>This command displays the following information:</p>
<p>The Workstation service is starting.</p>
<p>The Workstation service was started successfully.</p>
<p>&nbsp;</p>
<p>The reason is that the services being stopped are all the currently running services that depend on the Workstation service. They cannot run unless the Workstation service has already started. Since the Workstation service does not depend on any of those services, there is no requirement for the Workstation service to start the other services</p>
<p>However, if you were to start a dependent service while the Workstation service was stopped, the Workstation service would be started first.</p>
<h4 id="functions-of-the-scm">Functions of the SCM</h4>
<p>The SCM runs within Services.exe. The SCM automatically starts when the operating system is loaded, and stops when the operating system is shut down. The SCM runs with system privileges, and provides a unified and secure means of controlling service applications. The SCM is responsible for communicating with the various services and instructing them to start, stop, pause, and continue.</p>
<h4 id="starting-services">Starting Services</h4>
<p>The SCM maintains a database of installed services and device drivers in the registry. The database is used by the SCM and programs that add, modify, or configure services. The registry subkey for this database is HKLM\SYSTEM\CurrentControlSet\Services.</p>
<p>This subkey contains a subkey for each installed service and driver. The name of the subkey is the name the service or driver had when the SCM installed it.</p>
<p>An initial copy of the SCM database is created during Windows&nbsp;Server&nbsp;2003 setup. The database includes all the service-related parameters defined for a service, in addition to fields that track the serviceâs status. Additionally, the database contains records for the device drivers required during system restart. The Type entries are found in the registry in the service subkeys under the HKLM\SYSTEM\CurrentControlSet\Services subkey.</p>
<p>There are four values that apply to device drivers:</p>
<ul>
<li>1 (SERVICE_KERNEL_DRIVER)</li>
<li>2 (SERVICE_FILE_SYSTEM_DRIVER)</li>
<li>4 (SERVICE_ADAPTER)</li>
<li>8 (SERVICE_RECOGNIZER_DRIVER)</li>
</ul>
<p>The value of the Start entry determines if and when the service or driver is loaded during system startup.</p>
<h4 id="starting-service-processes">Starting Service Processes</h4>
<p>When the SCM starts a service process, the following occurs:</p>
<p>The process immediately invokes a service function, StartServiceCtrlDispatcher, which accepts a list of entry points into services, with one entry point for each service in the process. Each entry point is identified by the name of the service the entry point corresponds to.</p>
<p>StartServiceCtrlDispatcher creates a named pipe communications connection to the SCM and then sits in a loop waiting for commands to come through the pipe.</p>
<p>The SCM sends a service-start command each time it starts a service the process owns. For each start command it receives, the function creates a thread, called a service thread, to invoke the starting serviceâs entry point.</p>
<p>The StartServiceCtrlDispatcher service function waits indefinitely for commands from the SCM and returns control to the processâs main function only when all the processâs service threads have terminated, allowing the service process to clean up resources before exiting.</p>
<p>The first action of a serviceâs entry point (ServiceMain routine) is to call the RegisterServiceCtrlHandler(Ex) API, which takes a pointer to the serviceâs Handler(Ex) function. The Handler(Ex) function is designed to receive and handle control messages sent to the service, which are passed along from the SCM.</p>
<p>The StartServiceCtrlDispatcher service function stores the table in local process memory, and the RegisterServiceCtrlHandler finishes populating it with the serviceâs HandlerEx pointer and SERVICE_STATUS_HANDLE. The service entry point continues initializing the service, which can include allocating memory, creating communications end points, and reading private configuration data from the registry. A convention most services follow is to store their service-specific parameters under a Parameters subkey in their service registry subkey.</p>
<p>While the entry point is initializing the service, it might periodically send status messages to the SCM to indicate how the serviceâs startup is progressing. After the entry point finishes initialization, a service thread usually sits in a loop waiting for requests from client applications. For example, a Web server would initialize a Transmission Control Protocol (TCP) listen socket and wait for inbound Hypertext Transmission Protocol (HTTP) connection requests.</p>
<p>A service processâs main thread, which invokes and runs inside of StartServiceCtrlDispatcher, receives SCM commands directed at services in the process and uses the table of the servicesâ handler functions to locate and invoke the service function responsible for responding to a command. SCM commands include stop, pause, resume, interrogate, shut down, and application-defined commands.</p>
<p>For more information about the StartServiceCtrlDispatcher and RegisterServiceCtrlDispatcher APIs, see the Software Development Kit (SDK) information in the MSDN Library link on the Web Resources page (<a href="http://go.microsoft.com/fwlink/?linkid=291" data-linktype="external">http://go.microsoft.com/fwlink/?linkid=291</a>) at <a href="http://www.microsoft.com/windows/reskits/webresources" data-linktype="external">http://www.microsoft.com/windows/reskits/webresources</a>.</p>
<h4 id="automatically-starting-services">Automatically Starting Services</h4>
<p>During service initialization, the SCM starts all services that have Start registry entries with a value of 2&nbsp;(SERVICE_AUTO_START) and the services on which they depend. For example, if services that are automatically started depend on a manually started service, the demand-start service is also started automatically. The load order is determined by the following:</p>
<ol>
<li>The order of service groups in the load-ordering group list subkey, HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder.</li>
</ol>
<p>The order of drivers within a group specified in the HKLM\SYSTEM\CurrentControlSet\Control\GroupOrderList subkey.</p>
<p>The dependencies listed for each service.</p>
<p>When the startup process is complete, the system executes the boot verification program specified in the HKLM\SYSTEM\CurrentControlSet\Control\BootVerificationProgram subkey.</p>
<p>By default, this value is not set. The system reports that the startup process was successful after the auto-start sequence completes.</p>
<p>After the computer has started successfully, the operating system saves a clone of the database in the Last Known Good configuration. The system can restore this copy of the database if changes made to the active database cause restarting the computer to fail.</p>
<p>For more information about the Last Known Good configuration, see âAccepting the Boot and Last Known Good Configurationâ later in this chapter.</p>
<p>The following sequence describes how services are automatically started:</p>
<ol>
<li>The SCM starts all services that have a Start registry entry with a value of 2&nbsp;(SERVICE_AUTO_START). The SCM also starts auto-start device drivers.</li>
</ol>
<p>The algorithm for starting services in the correct order proceeds in various stages, whereby a stage corresponds to a group, and stages proceed in the sequence defined by the group order stored in the List registry entry in the HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder subkey. The value of the List entry includes the names of groups in the order that the SCM starts them.</p>
<p>For more information about the ServiceGroupOrder subkey, see âService Groupsâ earlier in this chapter.</p>
<p>The SCM marks all the service entries that belong to the stageâs group for startup.</p>
<p>The SCM loops through the marked services, verifying whether it can start each service. The verification consists of determining whether the service has a dependency on another group, as specified by the existence of the DependOnGroup entry in the subkey for a service.</p>
<ul>
<li>If a dependency exists, the group on which the service is dependent must have already been initialized, and at least one service in that group must have successfully started.</li>
<li>If the service depends on a group that starts later than the serviceâs group in the group startup sequence, the SCM logs a circular dependency error for the service.</li>
</ul>
<p>The SCM checks to see whether the service depends on one or more services, and whether those services have already started. Service dependencies are indicated by the value of the DependOnService entry in the subkey for a service.</p>
<ul>
<li>If a service depends on other services that belong to groups that come later in the List entry in the HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder subkey, the SCM also returns a circular dependency error such as âDetected circular dependencies demand to start,â and does not start the service.</li>
<li>If the service depends on any services from the same group that have not yet started, the service is skipped.</li>
</ul>
<p>When the dependencies of a service have been satisfied, the SCM makes a final check to see whether the service is part of the current boot configuration before starting the service.</p>
<p>When the SCM starts a service, it first determines the name of the file that runs the serviceâs process by reading the value of the ImagePath entry in the serviceâs registry subkey.</p>
<p>It then examines the value of the Type entry in the serviceâs subkey, and if that value is 32 (that is, the service shares a process), the SCM ensures that the process the service runs in â if already started â is logged on by using the same account as specified for the service being started. A serviceâs ObjectName registry entry stores the user account where the service runs. The SCM will fail to start a service with a missing ObjectName, and will return the error ERROR_INVALID_SERVICE_ACCOUNT.</p>
<p>The SCM verifies that the serviceâs process has not already been started in a different account by checking to see whether the value of the serviceâs ImagePath entry has a record in an internal SCM database identified as the <em>image</em> <em>database</em>.</p>
<ul>
<li>&nbsp;If the image database does not have a record for the ImagePath entry, the SCM creates one. When the SCM creates a new record, it stores the logon account name used for the service and the data from the value of the serviceâs ImagePath entry. The SCM requires services to have an ImagePath entry.</li>
<li>If a service does not have an ImagePath entry, the SCM returns an error stating that it could not find the serviceâs path and is not able to start the service.</li>
<li>If the SCM locates an existing image database record with matching data from the value of the ImagePath entry, the SCM ensures that the user account information for the service it is starting is the same as the information stored in the database record. A process can be logged on as only one account, so the SCM returns an error (ERROR_DIFFERENT_SERVICE_ACCOUNT) when a service specifies a different account name than another service that has already started in the same process.</li>
</ul>
<p>The SCM logs on a service if the serviceâs configuration specifies the serviceâs process should be started. The SCM logs on services that do not run in the system account by calling the LogonUserEx API, implemented by the Local Security Authority (Lsass.exe). Lsass.exe normally requires a password, but the SCM indicates to Lsass.exe that the password is stored as a Local Security Authority (LSA) secret in the registry subkey HKLM\SECURITY\Policy\Secrets.</p>
<p>When the SCM calls LogonUserEx, it specifies a service logon as the logon type. Lsass.exe looks up the password in the Secrets subkey in HKLM\SECURITY\Secrets that has a name in the form <em>_SC_&lt;service name&gt;</em>. The SCM directs Lsass.exe to store a logon password as a secret when a service control program configures a serviceâs logon information by using the CreateService or ChangeServiceConfig APIs.</p>
<p>When a logon is successful, LogonUserEx returns a handle to an access token to the caller. Windows&nbsp;Server&nbsp;2003 uses access tokens to represent your security context, and the SCM later associates the access token with the process that implements the service.</p>
<p>After a successful logon, the SCM loads the accountâs profile information, if it is not already loaded, by calling LoadUserProfile, which is implemented in Userenv.dll from <em>systemroot</em>\System32. The ProfileImagePath registry entry in the HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\user profile key&gt; subkey contains the location on disk of a registry hive that loads into the registry, making the information in the hive the HKEY_CURRENT_USER key for the service.</p>
<p>The SCM proceeds to start the serviceâs process if the process has not already been started (for a previous service, for example). The SCM starts the process in a suspended state and creates a named pipe through which it communicates with the service process, and it assigns the pipe the name \Pipe\Net\NetControlPipeX, where <em>X</em> is a number that is incremented each time the SCM creates a pipe.</p>
<p>The SCM resumes the service process and waits for the service to connect to its SCM pipe.</p>
<ul>
<li>If the pipe exists, the value of the ServicesPipeTimeout registry entry in the HKLM\SYSTEM\CurrentControlSet\Control subkey determines the length of time that the SCM waits for a service to connect before it gives up and terminates the process.</li>
<li>If the ServicesPipeTimeout entry does not exist, the SCM uses a default time-out of 30&nbsp;seconds. The SCM uses the same time-out value for all its service communications.</li>
</ul>
<p>When a service connects to the SCM through the pipe, the SCM sends the service a start command. If the service fails to respond positively to the start command within the time-out period, the SCM gives up and moves on to start the next service.</p>
<p>When a service does not respond to a start request, the SCM will stop the process if the process does not contain other running services. The SCM will stop the process if an OWN_PROCESS service fails or if the first SHARED_PROCESS service to be started in a process fails. In the latter case, the SCM will return ERROR_SERVICE_REQUEST_TIMEOUT (for demand-start requests) and log EVENT_CONNECTION_TIMEOUT.</p>
<p>A hung auto-start service â for example, a service stuck in SERVICE_START_PENDING forever â is not stopped by the SCM, but will generate an event log message (EVENT_SERVICE_START_HUNG) and possibly a message box popup.</p>
<p>Thus, the SCM continues looping through the services belonging to a group until all the services have either started or returned errors (the services could fail to start for other reasons). Looping is way the SCM automatically orders services within a group according to the value of their DependOnService entries. Looping helps the SCM send start parameters to a dependent service while the arguments are held in the stack until the dependent service is started. The SCM will start the services that other services depend on in earlier loops, skipping the dependent services until subsequent loops.</p>
<p>After the SCM completely checks for all the groups in the List entry in the HKLM\SYSTEM\CurrentControlSet\Control\ServiceGroupOrder subkey, it performs a check for all the remaining (that is, ungrouped) services.</p>
<p>When the dependencies of a service have been satisfied, the SCM makes a final check to see whether the service is part of the Last Known Good configuration before starting the service.</p>
<h4 id="starting-a-device-driver">Starting a Device Driver</h4>
<p>The SCM adds entries to the SCM database for device drivers in addition to services. The SCM starts drivers configured as auto-start and detects startup failures for drivers configured as boot-start and system-start. The I/O Manager loads drivers configured as boot-start and system-start before any user-mode processes start, and therefore any drivers having these start types are loaded before the SCM starts itself.</p>
<p>If a service the SCM starts has a value of 1&nbsp;(SERVICE_KERNEL_DRIVER) or 2&nbsp;(SERVICE_FILE_SYSTEM_DRIVER) for its Type registry entry, the service is a device driver, and the SCM loads the driver.</p>
<p>The SCM enables the load driver security privilege for the SCM process and then invokes the kernel API NtLoadDriver, passing in the value of the ImagePath entry in the driverâs registry subkey.</p>
<h4 id="starting-services-and-drivers-under-safe-mode">Starting Services and Drivers Under Safe Mode</h4>
<p>When the operating system is started in Safe Mode, the SCM ensures that each service and driver is either identified by name or by group in the appropriate subkey in the SafeBoot registry subkey. There are two safe boot registry subkeys, Minimal and Network, located in the HKLM\SYSTEM\CurrentControlSet\Control\SafeBoot subkey. The one that the SCM checks depends on which mode the user selected during a restart of the computer.</p>
<ul>
<li>If you select Safe Mode or Safe Mode with Command Prompt at the special boot menu (which you can access by pressing F8 when prompted in the boot process), the SCM references the HKLM\SYSTEM\CurrentControlSet\SafeBoot\Minimal subkey.</li>
<li>If you select Safe Mode with Networking, the SCM references the HKLM\SYSTEM\CurrentControlSet\SafeBoot\Network subkey. The existence of an Option entry of data type string in the SafeBoot subkey indicates not only that the system booted in Safe Mode but also the mode the user selected.</li>
</ul>
<p>The minimum services and drivers started under Safe Mode or Safe Mode with Command Prompt are the following:</p>
<ul>
<li>Cryptographic Services</li>
<li>Event Log</li>
<li>Help and Support</li>
<li>Logical Disk Manager Administrative Service</li>
<li>Net Logon</li>
<li>Plug and Play</li>
<li>Remote Procedure Call (RPC)</li>
<li>Windows Management Instrumentation</li>
</ul>
<p>The minimum services and drivers started under Safe Mode with Networking are the following:</p>
<ul>
<li>AFD Networking Support Environment</li>
<li>Computer Browser</li>
<li>DHCP Client</li>
<li>DNS Client</li>
<li>Event Log</li>
<li>Help and Support</li>
<li>Logical Disk Manager</li>
<li>NetBIOS Interface</li>
<li>NetBIOS over TCPIP</li>
<li>Net Logon</li>
<li>Network Connections</li>
<li>Plug and Play</li>
<li>Remote Procedure Call (RPC)</li>
<li>Server</li>
<li>TCP/IP NetBIOS Helper</li>
<li>TCP/IP Protocol Driver</li>
<li>Terminal Services</li>
<li>Windows Management Instrumentation</li>
<li>Workstation</li>
</ul>
<p>&nbsp;</p>
<h4 id="accepting-the-boot-and-last-known-good-configuration">Accepting the Boot and Last Known Good Configuration</h4>
<p>Besides starting services, the system charges the SCM with determining when the systemâs registry configuration, HKLM\SYSTEM\CurrentControlSet, needs to be saved as the Last Known Good configuration control set. The CurrentControlSet registry subkey contains the Services subkey. Therefore, CurrentControlSet includes the registry representation of the SCM database. It also contains the Control subkey, which stores many kernel-mode and user-mode subsystem configuration settings.</p>
<p>By default, a successful startup consists of a successful startup of auto-start services and a successful user logon. A startup process fails if the operating system halts because a device driver fails and stops the operating system during startup, or if an auto-start service that has an ErrorControl registry entry with a value of 2 (SERVICE_ERROR_SEVERE) or 3 (SERVICE_ERROR_CRITICAL) returns a startup error. For more information about ErrorControl registry entries, see the Software Development Kit (SDK) information in the MSDN Library link on the Web Resources page (<a href="http://go.microsoft.com/fwlink/?linkid=291" data-linktype="external">http://go.microsoft.com/fwlink/?linkid=291</a>) at <a href="http://www.microsoft.com/windows/reskits/webresources" data-linktype="external">http://www.microsoft.com/windows/reskits/webresources</a>.</p>
<p>The SCM knows when it has completed a successful startup of the auto-start services; however, the Winlogon application, located in <em>systemroot</em>\System32*,* must notify the SCM when there is a successful logon, indicating that the system has successfully proceeded so that the current control set can be saved and selected as the new Last Known Good configuration control set. When you log on, Winlogon sends a message to the SCM. Following a successful start of the auto-start services, the SCM saves the current registry startup configuration.</p>
<p>Third-party vendors can supersede the Winlogon definition of a successful logon with their own definition. For example, a system running SQL Server might not consider the startup process successful until after SQL Server is able to accept and process transactions.</p>
<p>&nbsp;</p>
<h4 id="scm-role-in-system-shutdown">SCM Role in System Shutdown</h4>
<p>When your computer is shut down, the following occurs:</p>
<ol>
<li>The Winlogon process sends a message to the Client Server Runtime Subsystem (Csrss.exe), the Win32 subsystem process, to invoke the Csrss.exe shutdown routine.</li>
</ol>
<p>Csrss.exe loops through the active processes and notifies them that the system is shutting down. For every system process except Services.exe, Csrss.exe waits up to the number of seconds specified by the value of the registry entry WaitToKillAppTimeout in the HKEY_USERS\DEFAULT\Control Panel\Desktop subkey for the process to exit before moving on to the next process. The default value of the WaitToKillAppTimeout entry is 20&nbsp;seconds.</p>
<p>When Csrss.exe encounters the Services.exe process, it also notifies it that the operating system is shutting down, but a time-out specific to the SCM.</p>
<p>Csrss.exe recognizes the SCM by using the process identifier (PID) Csrss.exe saved when the SCM registered with Csrss.exe during system initialization.</p>
<p>The SCM time-out differs from that of other processes because the Csrss.exe process waits while the SCM communicates with services that need to perform cleanup when they shut down; therefore, an administrator might need to adjust only the SCM time-out. The SCM time-out value resides in the registry entry WaitToKillServiceTimeout in the HKLM\SYSTEM\CurrentControlSet\Control subkey. Its default value is 20&nbsp;seconds.</p>
<p>The SCM shutdown handler is responsible for sending shutdown notifications asynchronously to only those services that requested shutdown notification when they initialized with the SCM. The shutdown control code is SERVICE_CONTROL_SHUTDOWN.</p>
<p>The SCM loops through the SCM database, searching for services that need shutdown notification, and sends each one a shutdown command.</p>
<p>For each service that is about to be shut down, the SCM sends a shutdown command and it records the value of the serviceâs wait hint â a value that the service also specifies when it registers with the SCM.</p>
<p>A serviceâs wait hint is the amount of time the SCM sits in a loop waiting for a service to start or shut down. The wait hint must indicate how many milliseconds the program that is sending the control code should wait before polling the serviceâs status again. The SCM keeps track of the largest wait hint it receives.</p>
<p>After sending the shutdown messages, the SCM waits until all of the services it notified of the shutdown have exited, until the time specified by the largest wait hint passes, or until the value of the WaitToKillServiceTimeout entry is exceeded. Services.exe itself is stopped by Csrss.exe.</p>
<ul>
<li>If the wait hint expires without a service exiting, the SCM determines whether one or more of the services it was waiting on to exit have sent a message to the SCM telling the SCM that the service is progressing in its shutdown process.</li>
<li>If at least one service made progress, the SCM waits again for the duration of the wait hint. The SCM continues executing this wait loop until either all the services have exited or none of the services upon which it is waiting has notified it of progress within the wait hint time-out period.</li>
</ul>
<p>While the SCM is busy telling services to shut down and waiting for them to exit, Csrss.exe waits for the SCM to exit.</p>
<ul>
<li>If all services end in the SERVICE_STOPPED state, the SCM exits on its own.</li>
<li>If the services do not all end up in the SERVICE_STOPPED state, the SCM loops for 30&nbsp;seconds. The services that did not end up in the SERVICE_STOPPED state are eventually stopped, along with Services.exe itself, by Csrss.exe as the system shuts down.</li>
<li>If the wait by Csrss.exe ends without the SCM having exited (that is, the WaitToKillServiceTimeout time expires), Csrss.exe just continues the shutdown process and eventually stops Services.exe as a result.</li>
</ul>
<p>The SCM supports handle types or entry points to allow access to the following objects:</p>
<ul>
<li>The database of installed services</li>
<li>A service</li>
<li>The database lock</li>
</ul>
<p>The database of installed services is represented by an internal container object that holds service objects. This handle or entry point is used when installing, deleting, opening, and enumerating services and when locking the services database.</p>
<p>An installed service is represented by a service object. The requested access is granted or denied depending on the access token of the calling process and the security descriptor associated with the internal or service object. This level of access is then associated with all subsequent calls that use this handle. If a subsequent call requires a level of access that was not originally requested for that handle, the call will fail, regardless of whether the current user could have requested a handle that allowed that level of access. A best practice for clients of the SCM APIs is to request only the level of access that will be required.</p>
<p>The database lock is represented by a lock object that is created during SCM initialization to serialize access to the database of installed services. The SCM acquires the lock before starting a service or driver. Thus if an installer program has acquired a database lock, a demand-start cannot progress until the lock is released. It is important for installer programs to release this lock as soon as they can. Any installer program that subsequently tries to acquire this lock will receive the ERROR_SERVICE_DATABASE_LOCKED error, and retry after a short wait.</p>
<p>Traditionally, services in Windows operating systems earlier than MicrosoftÂ® WindowsÂ®&nbsp;XP and Windows&nbsp;2000 have had the choice of running under either the LocalSystem security context or under an arbitrary user account. Creating user accounts for each service is cumbersome, especially because of password management for those accounts. Because of this, nearly all local services were configured to run as LocalSystem. The problem with this is that the LocalSystem account is highly privileged, and breaking into the service is often an easy way to achieve a privilege elevation attack.</p>
<p>Many services do not need an elevated privilege level; hence the need for a lower privilege level security context available on all computers.</p>
<p>In Windows services can run under the following security contexts:</p>
<ul>
<li>LocalSystem account</li>
<li>NetworkService account (NT AUTHORITY\NetworkService)</li>
<li>LocalService account (NT AUTHORITY\LocalService)</li>
<li>Domain user account</li>
<li>Local user account</li>
</ul>
<p>The security context under which the service runs affects the access rights that the service has on the computer and on the network. The security context of a service is an important consideration for service developers and system administrators because it dictates what resources the process can access. Unless a service installation program or administrator specifies otherwise, services run in the security context of the LocalSystem account (displayed sometimes as SYSTEM and other times as LocalSystem), which has some special characteristics.</p>
<h4 id="localsystem-account">LocalSystem Account</h4>
<p>LocalSystem is a special, predefined local account available only to system processes. This account does not have a password.</p>
<p>On computers running any version of MicrosoftÂ® Windows&nbsp;NTÂ®, a service that runs in the context of the LocalSystem account inherits the security context of the SCM. The service is not associated with any logged-on user account and does not have credentials (domain name, user name, and password) to be used for verification. The service has limited access to network resources, such as shared folders and named pipes, because it has no credentials and must connect by using a null session.</p>
<p>On computers running Windows&nbsp;2000 or Windows&nbsp;Server&nbsp;2003, a service that runs in the context of the LocalSystem account uses the credentials of the computer when accessing resources over the network and has full access to local resources. For services that access the Active DirectoryÂ® directory service, the LocalSystem context is constraining. When a service runs under the LocalSystem account on a computer that is a domain member, such as a Windows&nbsp;Server&nbsp;2003âbased computer running as a member server or Microsoft Windows&nbsp;XP Professional, the service runs under the context of the computer account when it accesses domain resources. Computer accounts typically have very few privileges and do not belong to groups. Adding computer accounts to groups is not recommended because the accounts are subject to deletion and re-creation if the computer leaves and then rejoins the domain.</p>
<p>On the other hand, a service that runs in the context of LocalSystem on a domain controller has full access to the directory, because the domain controller hosts a directory replica and LocalSystem has complete access to local resources. The Net Logon service is an example of a service that runs under the LocalSystem account.</p>
<p>The LocalSystem account is the same account in which all the Windows&nbsp;Server&nbsp;2003 user-mode operating system components run, including Session Manager (Smss.exe), Csrss.exe, Lsass.exe, the Winlogon process (Winlogon.exe), some services located in the <em>systemroot</em>\System32 folder, and the SCM (Services.exe).</p>
<p>From a security perspective, the LocalSystem account is extremely powerful â more powerful than any local or domain account when it comes to security on a local computer. This account has the following characteristics:</p>
<ul>
<li>It is a member of the local Administrators group.</li>
<li>It has the right to enable virtually every privilege, even privileges not normally granted to the local administrator account, such as creating security tokens.</li>
<li>Most files and registry keys grant full access to the LocalSystem account. Even if they do not grant full access, a process that runs under the LocalSystem account can exercise the Take Ownership privilege to gain access.</li>
<li>Processes running under the LocalSystem account run with the default user profile (HKEY_USERS\DEFAULT). They can access configuration information stored in the user profiles of other accounts through the registry key HKEY_USERS\SID&gt;.</li>
<li>When a computer is a member of a Windows&nbsp;Server&nbsp;2003âbased domain, the LocalSystem account includes the computer security identifier (SID) for the computer on which a service process is running. Therefore, a process running in the LocalSystem account will be automatically authenticated on other computers in the same forest by using the computer account of the computer running the service process. (A forest is a grouping of domains.)</li>
<li>Unless the computer account is specifically granted access to resources (such as shared folders, named pipes, and so on), a process can access network resources that allow null sessions â that is, connections that require no credentials. You can specify the shared folders and named pipes on a particular computer that permits null sessions in the NullSessionPipes and NullSessionShares registry entries in the HKLM\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters subkey.</li>
</ul>
<h2 id="additional-resources">Additional Resources&nbsp;</h2>
<p><strong>IT Professionals</strong></p>
<p><strong><a href="http://www.microsoft.com/whdc/system/pnppwr/powermgmt/BackgroundProcs.mspx" data-linktype="external">Developing Efficient Background Processes for Windows</a></strong><br>
<strong><a href="http://www.microsoft.com/whdc/system/sysinternals/Session0Changes.mspx" data-linktype="external">Impact of Session&nbsp;0 Isolation on Services and Drivers in Windows</a></strong><br>
**&nbsp;**</p>
<h5 id="msdn">MSDN</h5>
<p><a href="http://msdn.microsoft.com/en-us/library/ms685141(VS.85).aspx" data-linktype="external">Windows Services documentation</a><br>
<a href="http://msdn.microsoft.com/en-us/library/aa286579.aspx" data-linktype="external">Internet Connection Sharing and Internet Connection Firewall</a><br>
<a href="http://msdn.microsoft.com/en-us/library/ms684276(VS.85).aspx" data-linktype="external">NotifyServiceStatusChange Function</a><br>
<a href="http://msdn.microsoft.com/en-us/library/ms685149(VS.85).aspx" data-linktype="external">Service Control&nbsp;Handler Function</a>&nbsp;<br>
<a href="http://msdn.microsoft.com/en-us/library/dd405513(VS.85).aspx" data-linktype="external">Service Trigger Events</a><br>
<a href="http://msdn.microsoft.com/en-us/library/ms682053(VS.85).aspx" data-linktype="external">Configuring a Service Using SC</a></p>
</div><div id="ms--inline-notifications" class="margin-block-xs" data-bi-name="inline-notification"></div><div id="assertive-live-region" role="alert" aria-live="assertive" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<div id="polite-live-region" role="status" aria-live="polite" class="visually-hidden" aria-relevant="additions" aria-atomic="true"></div>
							<!-- </content> -->

						</main><!-- recommendations section --><!-- end recommendations section -->

						<!-- feedback section --><!-- end feedback section -->

						<!-- feedback report section --><!-- end feedback report section --><aside
								id="ms--additional-resources-mobile"
								aria-label="Additional resources"
								class="display-none-desktop display-none-print"
							>
								<hr class="hr" hidden />
								<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>Additional resources</h2>
								<section id="right-rail-recommendations-mobile" data-bi-name="recommendations" hidden></section>
								<section id="right-rail-training-mobile" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-events-mobile" data-bi-name="events-card" hidden></section>
								<section id="right-rail-qna-mobile" data-bi-name="qna-link-card" hidden></section>
							</aside><div class="border-top is-visible-interactive has-default-focus margin-top-sm "><footer id="footer-interactive" data-bi-name="footer" class="footer-layout"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer></div></div><div
							id="ms--additional-resources"
							class="right-container column is-4-desktop display-none display-block-desktop"
							data-bi-name="pageactions"
							role="complementary"
							aria-label="Additional resources"
						>
							<div id="affixed-right-container" class="margin-top-sm-tablet" data-bi-name="right-column">
								<h2 id="ms--additional-resources-heading" class="title is-6 margin-top-md" hidden>Additional resources</h2>
								<section id="right-rail-events" data-bi-name="events-card" hidden></section>
								<section id="right-rail-training" data-bi-name="learning-resources-card" hidden></section>
								<section id="right-rail-recommendations" data-bi-name="recommendations" hidden></section>
								<nav id="side-doc-outline" class="doc-outline" data-bi-name="intopic toc" aria-label="In this article">
									<h3>In this article</h3>
								</nav>
								<section id="right-rail-qna" class="margin-top-xxs" data-bi-name="qna-link-card" hidden></section>
							</div>
						</div></div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm "><footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo"><div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop"><a
				data-mscc-ic="false"
				class="locale-selector-link button button-sm button-clear flex-shrink-0"
				href="#"
				data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text"></span></a><div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
<a
	href="https://aka.ms/yourcaliforniaprivacychoices"
	class="button button-sm button-clear flex-shrink-0"
	data-mscc-ic="false"
	data-bi-name="your-privacy-choices"
>
	<svg
		role="img"
		aria-label="California Consumer Privacy Act (CCPA) Opt-Out Icon"
		xmlns="http://www.w3.org/2000/svg"
		viewBox="0 0 30 14"
		xml:space="preserve"
		height="16"
		width="43"
		focusable="false"
	>
		<title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
		<path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
		<path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
		<path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
		<path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
	</svg>
	<span>Your Privacy Choices</span>
</a>

		</div>
		<div class="flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger"
		aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
		<span class="icon expanded-indicator" aria-hidden="true">
			<span class="docon docon-chevron-down-light"></span>
		</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector padding-xxs" role="none">
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="light">
					<span class="theme-light margin-right-xxs">
						<span
							class="theme-selector-icon border display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Light</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="dark">
					<span class="theme-dark margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>Dark</span>
				</button>
			</li>
			<li class="theme display-block" role="menuitem">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start"
					data-theme-to="high-contrast">
					<span class="theme-high-contrast margin-right-xxs">
						<span
							class="border theme-selector-icon display-inline-block has-body-background"
							aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background" />
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
							</svg>
						</span>
					</span>
					<span>High contrast</span>
				</button>
			</li>
		</ul>
	</div>
</div>

		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/previous-versions/" data-bi-name="archivelink">Previous Versions</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog" data-bi-name="bloglink">Blog</a></li>
				<li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/contribute/" data-bi-name="contributorGuide">Contribute</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li><li><a class="external-link-indicator" data-mscc-ic="false" href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/" data-bi-name="trademarks">Trademarks</a></li><li>&copy; Microsoft 2024</li>
	</ul>
</footer>

	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>
</body>
</html>