


<!DOCTYPE html>
<html lang="en-us" dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/  dc: http://purl.org/dc/terms/  foaf: http://xmlns.com/foaf/0.1/  og: http://ogp.me/ns#  rdfs: http://www.w3.org/2000/01/rdf-schema#  schema: http://schema.org/  sioc: http://rdfs.org/sioc/ns#  sioct: http://rdfs.org/sioc/types#  skos: http://www.w3.org/2004/02/skos/core#  xsd: http://www.w3.org/2001/XMLSchema# " class="page-en">
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MGR7P8X');</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B1V8SZE3GL"></script>
<script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-B1V8SZE3GL');</script>
<script>(function(){var a=window.mutiny=window.mutiny||{};if(!window.mutiny.client){a.client={_queue:{}};var b=["identify","trackConversion"];var c=[].concat(b,["defaultOptOut","optOut","optIn"]);var d=function factory(c){return function(){for(var d=arguments.length,e=new Array(d),f=0;f<d;f++){e[f]=arguments[f]}a.client._queue[c]=a.client._queue[c]||[];if(b.includes(c)){return new Promise(function(b,d){a.client._queue[c].push({args:e,resolve:b,reject:d})})}else{a.client._queue[c].push({args:e})}}};c.forEach(function(b){a.client[b]=d(b)})}})();</script>
<script data-cfasync="false" src="https://client-registry.mutinycdn.com/personalize/client/d454424c4514a20a.js"></script>
<meta charset="utf-8" />
<meta name="description" content="Proofpoint researchers describe the unique bytecode config used by Nymaim malware." />
<link rel="canonical" href="https://www.proofpoint.com/us/threat-insight/post/nymaim-config-decoded" />
<link rel="shortlink" href="https://www.proofpoint.com/us/threat-insight/post/nymaim-config-decoded" />
<link rel="image_src" href="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/decode.png.webp?itok=MkDtOeBI" />
<link rel="icon" href="/themes/custom/proofpoint/apps/drupal/favicon.ico" />
<link rel="mask-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon.svg" />
<link rel="icon" sizes="16x16" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-16x16.png" />
<link rel="icon" sizes="32x32" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-32x32.png" />
<link rel="icon" sizes="96x96" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-96x96.png" />
<link rel="icon" sizes="192x192" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-192x192.png" />
<link rel="apple-touch-icon" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-60x60.png" />
<link rel="apple-touch-icon" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<link rel="apple-touch-icon-precomposed" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-152x152.png" />
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/themes/custom/proofpoint/apps/drupal/images/favicons/favicon-180x180.png" />
<meta property="og:site_name" content="Proofpoint" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.proofpoint.com/us/threat-insight/post/nymaim-config-decoded" />
<meta property="og:title" content="Nymaim config decoded | Proofpoint US" />
<meta property="og:description" content="Proofpoint researchers describe the unique bytecode config used by Nymaim malware." />
<meta property="og:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/decode.png.webp?itok=MkDtOeBI" />
<meta property="og:image:url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/decode.png.webp?itok=MkDtOeBI" />
<meta property="og:image:secure_url" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/decode.png.webp?itok=MkDtOeBI" />
<meta property="article:published_time" content="2019-03-12T12:51:44-07:00" />
<meta property="article:modified_time" content="2019-04-03T06:01:52-07:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@proofpoint" />
<meta name="twitter:description" content="Proofpoint researchers describe the unique bytecode config used by Nymaim malware." />
<meta name="twitter:title" content="Nymaim config decoded | Proofpoint US" />
<meta name="twitter:url" content="https://www.proofpoint.com/us/threat-insight/post/nymaim-config-decoded" />
<meta name="twitter:image" content="https://www.proofpoint.com/sites/default/files/styles/metatag/public/images/Blog/decode.png.webp?itok=MkDtOeBI" />
<script data-cfasync="false" type="text/javascript" id="vwoCode">window._vwo_code=window._vwo_code || (function() {
      var account_id=1002484,
      version=1.3,
      settings_tolerance=2000,
      library_tolerance=2500,z
      use_existing_jquery=false,
      is_spa=1,
      hide_element='body',
      /* DO NOT EDIT BELOW THIS LINE */
      f=false,d=document,code={use_existing_jquery:function(){return use_existing_jquery},library_tolerance:function(){return library_tolerance},finish:function(){if(!f){f=true;var e=d.getElementById('_vis_opt_path_hides');if(e)e.parentNode.removeChild(e)}},finished:function(){return f},load:function(e){var t=d.createElement('script');t.fetchPriority='high';t.src=e;t.type='text/javascript';t.innerText;t.onerror=function(){_vwo_code.finish()};d.getElementsByTagName('head')[0].appendChild(t)},init:function(){window.settings_timer=setTimeout(function(){_vwo_code.finish()},settings_tolerance);var e=d.createElement('style'),t=hide_element?hide_element+'{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}':'',i=d.getElementsByTagName('head')[0];e.setAttribute('id','_vis_opt_path_hides');e.setAttribute('nonce',document.querySelector('#vwoCode').nonce);e.setAttribute('type','text/css');if(e.styleSheet)e.styleSheet.cssText=t;else e.appendChild(d.createTextNode(t));i.appendChild(e);this.load('https://dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&f='+ +is_spa+'&vn='+version);return settings_timer}};window._vwo_settings_timer = code.init();return code;}());</script>
<meta name="facebook-domain-verification" content="l349mr2tyecyl7w3a1146378lqxru1" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/proofpoint.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Regular-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/fjalla-one-v7-latin-regular.woff2" as="font" crossorigin="anonymous" />
<link rel="preload" href="/themes/custom/proofpoint/dist/app-drupal/assets/fonts/RobotoCondensed-Bold-webfont.woff" as="font" crossorigin="anonymous" />
<link rel="alternate" hreflang="en-us" href="https://www.proofpoint.com/us/threat-insight/post/nymaim-config-decoded" />

    <title>Nymaim config decoded | Proofpoint US</title>
    <link rel="stylesheet" media="all" href="/sites/default/files/css/css_lU4Ioaf3R6UrS0uGXtit16d46yiN0qAsRSfzbn2WSZg.css?delta=0&amp;language=en&amp;theme=particle&amp;include=eJxVj0EOAyEIRS80xkVPBJaxpigTwEl6-9p0oa4ID_L4uAgjaPR_PexjTjUiGB0XqJfEFJPo0mWRzBROaW6TniJOGu7HRMiSV0lzah4uyKTbUnoH62hJC1LA7i5tzl8Ez9IWD-ogSXtF209NyeSL93dn1464De7lMRYEDsRUR1D7ApFWbSI" />
<link rel="stylesheet" media="all" href="/sites/default/files/css/css_kNBflpplxurR8MuEncwxsmIY99rl7i0aoXWJJaNo-9c.css?delta=1&amp;language=en&amp;theme=particle&amp;include=eJxVj0EOAyEIRS80xkVPBJaxpigTwEl6-9p0oa4ID_L4uAgjaPR_PexjTjUiGB0XqJfEFJPo0mWRzBROaW6TniJOGu7HRMiSV0lzah4uyKTbUnoH62hJC1LA7i5tzl8Ez9IWD-ogSXtF209NyeSL93dn1464De7lMRYEDsRUR1D7ApFWbSI" />

    <script src="/sites/default/files/js/js_L66B4ykoym9_-33ZMf8UzW3ch3MFFdemzlbHNsNeMWI.js?scope=header&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://platform-api.sharethis.com/js/sharethis.js#property=6543fd1a2398960013d900a7&amp;product=inline-share-buttons&amp;source=platform"></script>

  </head>
  <body class="path-node user-anonymous">
        <a href="#main-content" class="visually-hidden focusable">
      Skip to main content
    </a>
    <div class="limit-width-wrapper">
      
        <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    
  

  
  
  
  


<div class="header-nav__spacer"></div>
<div class="header-nav js-is-top">
	<div class="header-nav__extra">
		<div class="header-nav__extra-wrap">
			<div class="header-nav__top-language" data-open="content:x_lng">
				<span>English (Americas)</span>
			</div>
			<div class="header-nav__actions">
				<div class="header-nav__top-search" data-open="content:x_sch">
					<span>Search</span>
				</div>
				<div class="header-nav__top-login" data-open="content:x_lgn">
					<span>Login</span>
				</div>
			</div>
		</div>
	</div>
	<div class="header-nav__main">
		<div class="header-nav__main-wrap">
			<div class="header-nav__expand" data-open="home"></div>
			<ul class="header-nav__top-links">
																						<li class="header-nav__top-link">
								<div data-open="content:platform_panel" class="header-nav__top-link-text">
									Platform
								</div>
							</li>
																																	<li class="header-nav__top-link">
								<div data-open="content:products_panel" class="header-nav__top-link-text">
									Products
								</div>
							</li>
																																	<li class="header-nav__top-link">
								<div data-open="content:solutions_panel" class="header-nav__top-link-text">
									Solutions
								</div>
							</li>
																																													</ul>
			<a href="/us" class="header-nav__logo">Proofpoint</a>
			<div class="header-nav__buttons">
									

    


  <a href=/us/contact class="global-elements__cta-button--outline header-nav__button" >
    <span>Contact</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


							</div>
			<div class="header-nav__mobile-actions">
				<div class="header-nav__mobile-search" data-open="content:x_sch">Search</div>
				<div class="header-nav__mobile-menu" data-open="home"></div>
			</div>
		</div>
	</div>
</div>

<div class="header-nav__menu">
	<div class="header-nav__menu-wrapper">
		<div class="header-nav__menu-close"></div>
		<div class="header-nav__menu-pane" data-home={true}>
			<ul class="header-nav__home-links">
				                      <li class="header-nav__home-link" data-open="content:platform_panel" ><span>Platform</span></li>
          				                      <li class="header-nav__home-link" data-open="content:products_panel" ><span>Products</span></li>
          				                      <li class="header-nav__home-link" data-open="content:solutions_panel" ><span>Solutions</span></li>
          				                      <li class="header-nav__home-link" data-open="content:partners_panel" ><span>Partners</span></li>
          				                      <li class="header-nav__home-link" data-open="content:resources_panel" ><span>Resources</span></li>
          				                      <li class="header-nav__home-link" data-open="content:company_panel" ><span>Company</span></li>
          							</ul>
			<div class="header-nav__menu-extras">
				<div class="header-nav__menu-search" data-open="content:x_sch">Search</div>
				<div class="header-nav__menu-login" data-open="content:x_lgn">Login</div>
				<div class="header-nav__menu-language" data-open="content:x_lng">English (Americas)</div>
			</div>
		</div>
					<div class="header-nav__menu-pane" data-sublinks="Platform">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Platform</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Products">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Products</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Solutions">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Solutions</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Partners">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Partners</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Resources">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Resources</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
					<div class="header-nav__menu-pane" data-sublinks="Company">
				<div class="header-nav__sublinks">
					<div class="header-nav__expand-title">Company</div>
					<ul class="header-nav__expand-links">
											</ul>
				</div>
			</div>
							<div class="header-nav__menu-pane" data-content="products_panel">
				<div class="header-nav__content">
																																												                                 <a href="/us/products/protect-people" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Protect People</div>
                    									    <div class="header-nav__content-group-desc">Multi-layered, adaptive defenses for threat detection, impersonation, and supplier risk.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="/us/products/threat-defense" class="header-nav__content-link-text">Email Security</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/impersonation-protection" class="header-nav__content-link-text">Impersonation Protection</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:products_more_tp_products_panel">More products</a>
                                                          </div>
              						                                 <a href="/us/products/defend-data" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Defend Data</div>
                    									    <div class="header-nav__content-group-desc">Transform your information protection with a human-centric, omni-channel approach.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="/us/products/data-security-posture-management" class="header-nav__content-link-text">Data Security Posture Management</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/data-loss-prevention" class="header-nav__content-link-text">Enterprise DLP</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-dlp" class="header-nav__content-link-text">Adaptive Email DLP</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/insider-threat-management" class="header-nav__content-link-text">Insider Threat Management</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/compliance-and-archiving" class="header-nav__content-link-text">Intelligent Compliance</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Mitigate Human Risk</div>
                    									    <div class="header-nav__content-group-desc">Unlock full user risk visibility and drive behavior change.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/products/mitigate-human-risk" class="header-nav__content-link-text">Security Awareness</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Augment Your Capabilities</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/products/premium-services" class="header-nav__content-link-text">Managed Services</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/packages" class="header-nav__content-link-text">Product Packages</a>
                                                          </div>
              						                                <div class="header-nav__content-link-spacer"></div>
                																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="products_more_tp_products_panel">
				<div class="header-nav__content">
																	 <div class="header-nav__content-heading">More Protect People Products</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/products/identity-protection" class="header-nav__content-link-text">Account Take-Over and Identity Protection</a>
                                                              <div class="header-nav__content-link-desc">Secure vulnerable identities, stop lateral movement and privilege escalation.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/adaptive-email-security" class="header-nav__content-link-text">Adaptive Email Security</a>
                                                              <div class="header-nav__content-link-desc">Stop more threats with a fully integrated layer of behavioral AI.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/email-protection/email-fraud-defense" class="header-nav__content-link-text">Email Fraud Defense</a>
                                                              <div class="header-nav__content-link-desc">Protect your brand reputation, increase deliverability and identify lookalikes of your domains.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/products/email-security-and-protection/secure-email-relay" class="header-nav__content-link-text">Secure Email Relay</a>
                                                              <div class="header-nav__content-link-desc">Secure your application email and accelerate DMARC implementation.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_panel">
				<div class="header-nav__content">
																																												                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Use Case</div>
                    									    <div class="header-nav__content-group-desc">How Proofpoint protects your people and data.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/ensure-acceptable-genai-use" class="header-nav__content-link-text">Ensure Acceptable GenAI Use</a>
                                                              <div class="header-nav__content-link-desc">Empower your workforce with safe GenAI practices.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-authentication-with-dmarc" class="header-nav__content-link-text">Authenticate Your Email</a>
                                                              <div class="header-nav__content-link-desc">Protect your email deliverability with DMARC.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-email-and-cloud-threats" class="header-nav__content-link-text">Combat Email and Cloud Threats</a>
                                                              <div class="header-nav__content-link-desc">Protect your people from email and cloud threats with an intelligent and holistic approach.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_use_case_panel">More use cases</a>
                                                          </div>
              						                                                  <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Solutions by Industry</div>
                    									    <div class="header-nav__content-group-desc">People-centric solutions for your organization.</div>
                                      </div>
                                  						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/federal" class="header-nav__content-link-text">Federal Government</a>
                                                              <div class="header-nav__content-link-desc">Cybersecurity for federal government agencies.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/state-and-local-government" class="header-nav__content-link-text">State and Local Government</a>
                                                              <div class="header-nav__content-link-desc">Protecting the public sector, and the public from cyber threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:solutions_by_industry_panel">More industries</a>
                                                          </div>
              						                                 <a href="/us/compare" class="header-nav__content-link-group-anchor">                   <div class="header-nav__content-link-group">
                    <div class="header-nav__content-group-title">Comparing Proofpoint</div>
                    									    <div class="header-nav__content-group-desc">Evaluating cybersecurity vendors? Check out our side-by-side comparisons.</div>
                                      </div>
                   </a>                 						                                <div class="header-nav__content-link">
                                          <a href="#" class="header-nav__content-link-text" data-open="content:compare_proofpoint_panel">View comparisons</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_by_use_case_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Solutions By Use Case</h3> 						 <div class="header-nav__content-heading">How Proofpoint protects your people and data.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/change-user-behavior" class="header-nav__content-link-text">Change User Behavior</a>
                                                              <div class="header-nav__content-link-desc">Help your employees identify, resist and report attacks before the damage is done.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/combat-data-loss-and-insider-risk" class="header-nav__content-link-text">Combat Data Loss and Insider Risk</a>
                                                              <div class="header-nav__content-link-desc">Prevent data loss via negligent, compromised and malicious insiders.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/enable-intelligent-compliance" class="header-nav__content-link-text">Modernize Compliance and Archiving</a>
                                                              <div class="header-nav__content-link-desc">Manage risk and data retention needs with a modern compliance and archiving solution.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/protect-cloud-apps" class="header-nav__content-link-text">Protect Cloud Apps</a>
                                                              <div class="header-nav__content-link-desc">Keep your people and their cloud apps secure by eliminating threats and data loss.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/prevent-loss-from-ransomware" class="header-nav__content-link-text">Prevent Loss from Ransomware</a>
                                                              <div class="header-nav__content-link-desc">Learn about this growing threat and stop attacks by securing ransomware&#039;s top vector: email.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/secure-microsoft-365" class="header-nav__content-link-text">Secure Microsoft 365</a>
                                                              <div class="header-nav__content-link-desc">Implement the best security and compliance solution for Microsoft 365.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="solutions_by_industry_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Solutions By Industry</h3> 						 <div class="header-nav__content-heading">People-centric solutions for your organization.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/higher-education-security" class="header-nav__content-link-text">Higher Education</a>
                                                              <div class="header-nav__content-link-desc">A higher level of security for higher education.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/financial-services-and-insurance" class="header-nav__content-link-text">Financial Services</a>
                                                              <div class="header-nav__content-link-desc">Eliminate threats, build trust and foster growth for your organization.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/healthcare-information-security" class="header-nav__content-link-text">Healthcare</a>
                                                              <div class="header-nav__content-link-desc">Protect clinicians, patient data, and your intellectual property against advanced threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/mobile-message-security-solutions-for-service-providers" class="header-nav__content-link-text">Mobile Operators</a>
                                                              <div class="header-nav__content-link-desc">Make your messaging environment a secure environment.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/email-security-solutions-for-service-providers" class="header-nav__content-link-text">Internet Service Providers</a>
                                                              <div class="header-nav__content-link-desc">Cloudmark email protection.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/solutions/protection-compliance-small-business" class="header-nav__content-link-text">Small and Medium Businesses</a>
                                                              <div class="header-nav__content-link-desc">Big-time security for small business.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="compare_proofpoint_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Proofpoint vs. the competition</h3> 						 <div class="header-nav__content-heading">Side-by-side comparisons.</div> 																											                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-abnormal-security" class="header-nav__content-link-text">Proofpoint vs. Abnormal Security</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-mimecast" class="header-nav__content-link-text">Proofpoint vs. Mimecast</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-cisco" class="header-nav__content-link-text">Proofpoint vs. Cisco</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft" class="header-nav__content-link-text">Proofpoint vs Microsoft</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-microsoft-purview" class="header-nav__content-link-text">Proofpoint vs. Microsoft Purview</a>
                                                          </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/compare/proofpoint-vs-legacy-dlp" class="header-nav__content-link-text">Proofpoint vs. Legacy DLP</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="partners_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Partners</h3> 						 <div class="header-nav__content-heading">Deliver Proofpoint solutions to your customers.</div> 													

  


  <a href=https://partners.proofpoint.com class="global-elements__cta-button header-nav__content-button" >
    <span>Become a Partner</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/partners/trusted-data-solutions-partnership" class="header-nav__content-link-text">Archive Extraction Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about Extraction Partners.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/global-system-integrator-gsi-and-global-managed-service-provider-msp-partners" class="header-nav__content-link-text">GSI Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our global consulting.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/technology-alliance-partners" class="header-nav__content-link-text">Technology and Alliance Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our relationships.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/digital-risk-and-compliance-partners" class="header-nav__content-link-text">Social Media Protection Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about the technology and....</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/partners/msp" class="header-nav__content-link-text">MSP Partners</a>
                                                              <div class="header-nav__content-link-desc">Learn about our MSP solutions.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="https://partners.proofpoint.com" class="header-nav__content-link-text">Portal Login</a>
                                                          </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="resources_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Resources</h3> 						 <div class="header-nav__content-heading">Find reports, webinars, blogs, events, podcasts and more.</div> 													

  


  <a href=/us/resources class="global-elements__cta-button header-nav__content-button" >
    <span>Resource Library</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/blog" class="header-nav__content-link-text">Blog</a>
                                                              <div class="header-nav__content-link-desc">Keep up with the latest news and happenings.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/webinars" class="header-nav__content-link-text">Webinars</a>
                                                              <div class="header-nav__content-link-desc">Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/cybersecurity-academy" class="header-nav__content-link-text">Cybersecurity Academy</a>
                                                              <div class="header-nav__content-link-desc">Earn your certification to become a Proofpoint Certified Guardian.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/podcasts" class="header-nav__content-link-text">Podcasts</a>
                                                              <div class="header-nav__content-link-desc">Learn about the human side of cybersecurity.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/new-perimeters" class="header-nav__content-link-text">New Perimeters Magazine</a>
                                                              <div class="header-nav__content-link-desc">Get the latest cybersecurity insights in your hands.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/threat-reference" class="header-nav__content-link-text">Threat Glossary</a>
                                                              <div class="header-nav__content-link-desc">Learn about the latest security threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/events" class="header-nav__content-link-text">Events</a>
                                                              <div class="header-nav__content-link-desc">Connect with us at events to learn how to protect your people and data from ever-evolving threats.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/customer-stories" class="header-nav__content-link-text">Customer Stories</a>
                                                              <div class="header-nav__content-link-desc">Read how our customers solve their most pressing cybersecurity challenges.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="company_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Company</h3> 						 <div class="header-nav__content-heading">Proofpoint protects organizations' greatest assets and biggest risks: their people.</div> 													

  


  <a href=/us/company/about class="global-elements__cta-button header-nav__content-button" >
    <span>About Proofpoint</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/why-proofpoint" class="header-nav__content-link-text">Why Proofpoint</a>
                                                              <div class="header-nav__content-link-desc">Learn about our unique people-centric approach to protection.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/company/careers" class="header-nav__content-link-text">Careers</a>
                                                              <div class="header-nav__content-link-desc">Stand out and make a difference at one of the world&#039;s leading cybersecurity companies.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/newsroom" class="header-nav__content-link-text">News Center</a>
                                                              <div class="header-nav__content-link-desc">Read the latest press releases, news stories and media highlights about Proofpoint.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/legal/trust" class="header-nav__content-link-text">Privacy and Trust</a>
                                                              <div class="header-nav__content-link-desc">Learn about how we handle data and make commitments to privacy and other regulations.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/legal/esg" class="header-nav__content-link-text">Environmental, Social, and Governance</a>
                                                              <div class="header-nav__content-link-desc">Learn how we apply our principles to positively impact our community.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/support-services" class="header-nav__content-link-text">Support</a>
                                                              <div class="header-nav__content-link-desc">Access the full range of Proofpoint support services.</div>
                                      </div>
              																				</div>
			</div>
					<div class="header-nav__menu-pane" data-content="platform_panel">
				<div class="header-nav__content">
											 <h3 class="header-nav__content-title">Platform</h3> 						 <div class="header-nav__content-heading">Discover the Proofpoint human-centric platform.</div> 													

  


  <a href=/us/platform class="global-elements__cta-button header-nav__content-button" >
    <span>Learn More</span>
    <div class="global-elements__cta-button--arrow-wrapper"></div>
  </a>


																											                                <div class="header-nav__content-link">
                                          <a href="/us/platform/nexus" class="header-nav__content-link-text">Nexus</a>
                                                              <div class="header-nav__content-link-desc">Detection technologies to protect people and defend data.</div>
                                      </div>
              						                                <div class="header-nav__content-link">
                                          <a href="/us/platform/zen" class="header-nav__content-link-text">Zen</a>
                                                              <div class="header-nav__content-link-desc">Protect and engage users wherever they work.</div>
                                      </div>
              																				</div>
			</div>
				<div class="header-nav__menu-pane" data-content="x_sch">
			<div class="header-nav__content">
				<div class="header-nav__content-title--search">
					Search Proofpoint
				</div>
				<div class="header-nav__search">

					<form class="header-nav__search-form">
						<input type="text" class="header-nav__search-input" placeholder="">
						<input type="submit" class="header-nav__search-button" val="Search">
					</form>
					<div class="header-nav__search-sugg-title">Try searching for</div>
					<div class="header-nav__search-suggestions">
													<a href="/us/search?content%5Bquery%5D=Email%20Security" class="header-nav__search-suggestion">Email Security</a>
													<a href="/us/search?content%5Bquery%5D=Phishing" class="header-nav__search-suggestion">Phishing</a>
													<a href="/us/search?content%5Bquery%5D=DLP" class="header-nav__search-suggestion">DLP</a>
													<a href="/us/search?content%5Bquery%5D=Email%20Fraud" class="header-nav__search-suggestion">Email Fraud</a>
											</div>
				</div>
			</div>
		</div>
		<div class="header-nav__menu-pane" data-content="x_lgn">
			<div class="header-nav__content">
				<div class="header-nav__content-title">
					Select Product Login
				</div>
				<ul class="header-nav__logins">
											<li class="header-nav__content-login">
							<a href="https://proofpoint.my.site.com/community/s/" target="_blank">Support Log-in</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://proofpointcybersecurityacademy.adobelearningmanager.com" target="_blank">Proofpoint Cybersecurity Academy</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://digitalrisk.proofpoint.com/" target="_blank">Digital Risk Portal</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://emaildefense.proofpoint.com/login.php" target="_blank">Email Fraud Defense</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://threatintel.proofpoint.com/" target="_blank">ET Intelligence</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://us1.proofpointessentials.com/app/login.php" target="_blank">Proofpoint Essentials</a>
						</li>
											<li class="header-nav__content-login">
							<a href="https://proofpointcommunities.force.com/community" target="_blank">Sendmail Support Log-in</a>
						</li>
									</ul>
			</div>
		</div>
		<div class="header-nav__menu-pane" data-content="x_lng">
			<div class="header-nav__content">
				<div class="header-nav__content-title">
					Select Language
				</div>

				<ul class="header-nav__language-links">
                    <li class="header-nav__language-link">
            <a href="/us">English (Americas)</a>
          </li>
          					            					                          <li class="header-nav__language-link">
                <a href="/uk">English (Europe, Middle East, Africa)</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/au">English (Asia-Pacific)</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/es">Español</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/de">Deutsch</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/fr">Français</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/it">Italiano</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/br">Português</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/jp">日本語</a>
              </li>
            					                          <li class="header-nav__language-link">
                <a href="/kr">한국어</a>
              </li>
            									</ul>
			</div>
		</div>
	</div>
</div>



<div class="layout-container">
  
    <div>
    <div data-drupal-messages-fallback class="hidden"></div>

  </div>


  <main class="container" role="main">
    <a id="main-content" tabindex="-1"></a>    <section class="row">
      <div class="layout-content">
          <div>
    <div id="block-particle-content">
  
    
      




<article about="/us/threat-insight/post/nymaim-config-decoded" class="node--type--blog-post node--view-mode--full node node-blog-full">
  



  <div class="breadcrumbs"><div class="nav-crumbs"><div class="breadcrumb__item"><a href="/us/blog" class="breadcrum__item-link">Blog</a></div><div class="breadcrumb__item"><a href="/us/blog/threat-insight" class="breadcrum__item-link">Threat Insight</a></div><div class="breadcrumb__item">
            Nymaim config decoded          </div></div></div>

  <div class="blog-banner">
    <div class="blog-banner__image">      <picture>
                  <source srcset="/sites/default/files/styles/image_1920_750/public/images/Blog/decode.png.webp?itok=K-TxC-ei 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/images/Blog/decode.png.webp?itok=pq7y45YE 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/images/Blog/decode.png.webp?itok=eGV6-YT4 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
              <source srcset="/sites/default/files/styles/image_1920_750/public/images/Blog/decode.png.webp?itok=K-TxC-ei 1x" media="screen and (min-width: 1440px)" type="image/webp" width="1920" height="750"/>
              <source srcset="/sites/default/files/styles/image_1024_400/public/images/Blog/decode.png.webp?itok=pq7y45YE 1x" media="screen and (min-width: 1024px)" type="image/webp" width="1024" height="400"/>
              <source srcset="/sites/default/files/styles/image_768_375/public/images/Blog/decode.png.webp?itok=eGV6-YT4 1x" media="screen and (min-width: 768px)" type="image/webp" width="768" height="375"/>
                  <img loading="lazy" src="/sites/default/files/styles/image_768_300/public/images/Blog/decode.png.webp?itok=KOEZyeRL" width="768" height="300" typeof="foaf:Image" />

  </picture>


</div>
    <div class="blog-banner__gradient-overlay"></div>
    <div class="blog-banner__heading-wrap">
      
      


<h1 class="blog-banner__heading">
      <span>Nymaim config decoded</span>

  </h1>

    </div>
  </div>

  <div class="blog-content">
    <div class="blog-content__sharethis sharethis_toolbox sharethis_32x32_style">
      <div class="blog-content__sharethis_label sharethis__label">Share with your network!</div>
      <div class="blog-content__sharethis_buttons sharethis_buttons">
        <div class="sharethis-inline-share-buttons"></div>
        
<span class="addthis_button_subscribe at300b UNCONVERTED" title=Subscribe>
  <span class="at-icon-wrapper block-subscribe-button__trigger block-subscribe-button__addthis"></span>
</span>


      </div>
    </div>
        <div class="blog-content__metadata blog-content__metadata-author">
      <span class="blog-content__date">  <time datetime="2019-03-12T19:45:00Z">March 12, 2019</time>

</span>
        <span class="blog-content__author">
                Georgi Mladenov
  
        </span>
    </div>
    <div class="node-full__body blog-content__body">  <p><strong>Overview</strong></p>

<p>First documented in 2013 [1], Nymaim was originally identified as both a first-stage downloader and second-stage locking malware. Primarily distributed via the Blackhole exploit kit, most users found out they were infected because of the screen lock that demanded varying ransoms. In 2016, we documented distribution of the Ursnif banking Trojan via email campaigns and the presence of webinjects within Nymaim itself [2]. More recently, Nymaim has evolved into an even more robust downloader that includes a range of information stealing and system profiling capabilities. This incarnation of Nymaim has appeared in both global campaigns as well as attacks targeting North America, Germany, Italy, and Poland. In this respect, Nymaim is following global malware trends, with a focus on persistent, non-destructive infection to collect information long-term and flexibly download additional malware of the threat actor’s choosing.</p>

<p>Despite its long history and increasing incidence of spreading via email, many aspects of Nymaim are not well understood, including its ownership and availability to groups of threat actors. Moreover, the configuration file format outlined in this blog and the config’s interaction with a virtual machine running within the malware itself appears to be unique. While CERT.pl described the configuration encryption algorithms previously [3], recent samples now employ a bytecode language with its own logic that is interpreted by the malware, running in a virtual machine managed by Nymaim. Technical details of the config file and its interaction with the Nymaim interpreter are outlined below.</p>

<p><strong>Analysis</strong></p>

<p><em>Config parsing</em></p>

<p>As other researchers have noted for various components of&nbsp; Nymaim [4], the configuration data is stored in an encrypted and, in some cases, aPLib-compressed format.</p>

<p>The configuration data consists of a binary structure composed of multiple config components or chunks. Each data component has a recognizable pattern that is structured in the following format:</p>

<p>struct CONFIG_LINE {</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; opcode;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; params_length;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byte&nbsp;&nbsp;&nbsp;&nbsp; params[params_length];</p>

<p>}</p>

<p>Upon further analysis, we found that the configuration is compiled bytecode-like data that runs in a custom virtual machine environment inside Nymaim. The config has its own CODE and DATA sections, stack, local variables, registers, conditional cases, procedures, and API calls.</p>

<p>Additionally, the config parser includes a built-in integrity check of the params data, such that on initialization, the structure outlined above is expanded in memory to four parameters:</p>

<p>struct CONFIG_LINE_PARSED {</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; opcode;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crc;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; params_length;</p>

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byte&nbsp;&nbsp;&nbsp;&nbsp; params[params_length];</p>

<p>}</p>

<p>The integrity check uses a checksum algorithm that is widely used in the malware and this is its implementation:</p>

<p>def crc(data, data_len):</p>

<p>&nbsp;&nbsp;&nbsp; delta = 0x9AF598DC</p>

<p>&nbsp;&nbsp;&nbsp; crc = 0</p>

<p>&nbsp;&nbsp;&nbsp; for i in range(0, data_len // 4):</p>

<p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;crc += struct.unpack_from("&lt;L", data, i * 4)[0]</p>

<p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;crc&nbsp;&nbsp;&nbsp; += data_len</p>

<p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;crc&nbsp;&nbsp;&nbsp; += delta</p>

<p>&nbsp;&nbsp;&nbsp; return crc &amp; 0xFFFFFFFF</p>

<p>The first entries from the config contain the compile timestamp, version, and -- if present -- the expiration date. Although the virtual machine skips these entries, they allow us to precisely date each sample from the day it was first distributed to the day on which the campaign ended.</p>

<p>The virtual machine parses the rest of the config file line by line from top to bottom, first reading the code section and then reading the data section at the bottom of the file.</p>

<p><em>Config execution</em></p>

<p>As part of the virtual machine, the config interpreter can use its own stack and local variables, along with six general purpose registers. Additionally there is designated space for instruction pointers and flags used by the IF-THEN-GOTO code and API/procedure results.</p>

<p>The config interpreter running on the virtual machine can communicate with other parts of the Nymaim code using a structure holding initial data, which includes:</p>

<ul>
	<li>IsAdmin flag;</li>
	<li>System version from a OSVERSIONINFOEXW structure;</li>
	<li>SubAuthID;</li>
	<li>Locale obtained by GetLocaleInfoA;</li>
	<li>Pointer to the PEB;</li>
	<li>Event handles;</li>
	<li>Many additional flags;</li>
</ul>

<p>In the samples we analyzed, the interpreter did not necessarily use all of these parameters. However they are all accessible from the config's code.</p>

<p>The interpreter itself uses a limited number of basic code logic instructions, including flexible variable and register assignments represented in pseudocode below:</p>

<p>// &amp;ADDR:**** is the addressing, line by line of the config code</p>

<p>// SP_00 to SP_** are represented as stack pointers</p>

<p>// R0 to R5 are general purpose registers</p>

<p>// Additionally local variables decompiled as LOC_** can be used</p>

<p>&amp;ADDR:0003&nbsp;&nbsp; SP_00 = 0xFFFFFFFF; // immediate value to stack pointer assignment</p>

<p>&amp;ADDR:0004&nbsp;&nbsp; SP_04 = 0x00000000;</p>

<p>&amp;ADDR:0005&nbsp;&nbsp; SP_08 = 0x00000002;</p>

<p>&amp;ADDR:0006&nbsp;&nbsp; SP_0C = 0x00000004;</p>

<p>&amp;ADDR:0007&nbsp;&nbsp; SP_10 = 0x00000008;</p>

<p>&amp;ADDR:0008&nbsp;&nbsp; SP_14 = 0x0000000C;</p>

<p>&amp;ADDR:0009&nbsp;&nbsp; SP_18 = 0x00000010;</p>

<p>...</p>

<p>&amp;ADDR:0017&nbsp;&nbsp; R0 = &amp;CPU; // pointer to the CPU data to stack pointer assignment</p>

<p>&amp;ADDR:0018&nbsp;&nbsp; R1 = 0x0000003C;&nbsp; // immediate value to register assignment</p>

<p>&amp;ADDR:0019&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:001A&nbsp;&nbsp; R3 = &amp;SP_04;&nbsp; // stack pointer to register assignment</p>

<p>&amp;ADDR:001B&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:001C&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>Data initialization for the next stage, using labels as delimiters, is shown below:</p>

<p>&amp;ADDR:006D&nbsp;&nbsp; InitData(start=&amp;ADDR:007A, end=&amp;ADDR:0081);</p>

<p>...</p>

<p>&amp;ADDR:0079&nbsp;&nbsp; LABEL_79:</p>

<p>...</p>

<p>&amp;ADDR:0082&nbsp;&nbsp; LABEL_82:</p>

<p>TEST and IF-THEN-GOTO instructions for conditional branching:</p>

<p>&amp;ADDR:0021&nbsp;&nbsp; TEST &amp;SP_34 == &amp;SP_44;</p>

<p>&amp;ADDR:0022&nbsp;&nbsp; IF True GOTO LABEL_4B;</p>

<p>...</p>

<p>&amp;ADDR:002D&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_4B;</p>

<p>Procedure calls using entry point LABEL and RET instruction:</p>

<p>&amp;ADDR:001F&nbsp;&nbsp; CALL PROC_69;</p>

<p>...</p>

<p>&amp;ADDR:0069&nbsp;&nbsp; PROC_69:</p>

<p>...</p>

<p>&amp;ADDR:006E&nbsp;&nbsp; RET;</p>

<p>API-like functions can call into other Nymaim code for more complicated jobs as outlined below:</p>

<ul>
	<li>Determine presence of a Environment strings (IsEnvStringSet())</li>
	<li>Determine presence of certain processes running (IsProcessRunning())</li>
	<li>Terminate config code execution (Exit())</li>
	<li>Signaling events created by Nymaim (SignalEvent())</li>
	<li>Sending debug messages to Nymaim (DebugMessage())</li>
	<li>Detecting sandboxing and debugging environment (IsDebugged())</li>
</ul>

<p>Upon further analysis, we were able to decode the checksums for the following processes:</p>

<ul>
	<li>updatesrv.exe</li>
	<li>vsserv.exe</li>
	<li>pchooklaunch32.exe</li>
	<li>bdagent.exe</li>
	<li>seccenter.exe</li>
	<li>aswidsagenta.exe</li>
	<li>avastui.exe</li>
	<li>avastsvc.exe</li>
</ul>

<p>All of these point to executables associated with antivirus applications, suggesting that IsProcessRunning() is used to detect installed AV utilities.</p>

<p>The virtual machine uses IsDebugged() for anti-debugging checks, looking for&nbsp; blacklisted items associated with research environments:</p>

<ul>
	<li>MAC addresses associated with&nbsp; virtual machine platform vendors VmWare, Dell, PCS Computer Systems GmbH, Microsoft Corporation, Parallels, and Xensource.</li>
	<li>Loaded libraries "dbghelp.dll" and "SbieDll.dll" (parts of Debugging Tools For Windows and Sandboxie).</li>
	<li>User names "currentuser" and "sandbox" along with computer names including "sandbox"</li>
</ul>

<p>Nymaim does not appear to currently use the DebugMessage() function, but passes the argument to the two occurrences of this API call in plaintext:</p>

<ul>
	<li>"own inside started" // on stage 1 initialization</li>
	<li>"no known av detected" // self explanatory</li>
</ul>

<p><em>Typical decompiled configuration</em></p>

<p>With this information, we were able to decompile Nymaim's config bytecode to a more human-readable pseudocode script. For reference, a complete implementation of the decompiler that generates the following output is available here [6].</p>

<p>// VM &amp;CPU @ B2564545</p>

<p>// VM &amp;TIME @ 06C742A3</p>

<p>// VM &amp;FLAG @ 5878305F</p>

<p>&amp;ADDR:0000&nbsp;&nbsp; // compile timestamp: 2018-11-20T16:36:01.263625</p>

<p>&amp;ADDR:0001&nbsp;&nbsp; // version: 2.1.20.21</p>

<p>&amp;ADDR:0002&nbsp;&nbsp; // expiration date: 23 November 2018</p>

<p>&amp;ADDR:0003&nbsp;&nbsp; SP_00 = 0xFFFFFFFF;</p>

<p>&amp;ADDR:0004&nbsp;&nbsp; SP_04 = 0x00000000;</p>

<p>&amp;ADDR:0005&nbsp;&nbsp; SP_08 = 0x00000002;</p>

<p>&amp;ADDR:0006&nbsp;&nbsp; SP_0C = 0x00000004;</p>

<p>&amp;ADDR:0007&nbsp;&nbsp; SP_10 = 0x00000008;</p>

<p>&amp;ADDR:0008&nbsp;&nbsp; SP_14 = 0x0000000C;</p>

<p>&amp;ADDR:0009&nbsp;&nbsp; SP_18 = 0x00000010;</p>

<p>&amp;ADDR:000A&nbsp;&nbsp; SP_1C = &amp;SP_00;</p>

<p>&amp;ADDR:000B&nbsp;&nbsp; SP_20 = &amp;SP_04;</p>

<p>&amp;ADDR:000C&nbsp;&nbsp; SP_24 = &amp;SP_0C;</p>

<p>&amp;ADDR:000D&nbsp;&nbsp; SP_28 = &amp;SP_10;</p>

<p>&amp;ADDR:000E&nbsp;&nbsp; SP_2C = &amp;SP_14;</p>

<p>&amp;ADDR:000F&nbsp;&nbsp; SP_30 = &amp;SP_18;</p>

<p>&amp;ADDR:0010&nbsp;&nbsp; SP_34 = &amp;FLAG;</p>

<p>&amp;ADDR:0011&nbsp;&nbsp; SP_38 = 0x00000000;</p>

<p>&amp;ADDR:0012&nbsp;&nbsp; SP_3C = 0x0DDD766C;</p>

<p>&amp;ADDR:0013&nbsp;&nbsp; SP_40 = 0x0CD874EC;</p>

<p>&amp;ADDR:0014&nbsp;&nbsp; SP_44 = &amp;SP_3C;</p>

<p>&amp;ADDR:0015&nbsp;&nbsp; SP_48 = &amp;SP_40;</p>

<p>&amp;ADDR:0016&nbsp;&nbsp; InitData(start=&amp;ADDR:0084, end=&amp;ADDR:0091);</p>

<p>&amp;ADDR:0017&nbsp;&nbsp; R0 = &amp;CPU;</p>

<p>&amp;ADDR:0018&nbsp;&nbsp; R1 = 0x0000003C;</p>

<p>&amp;ADDR:0019&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:001A&nbsp;&nbsp; R3 = &amp;SP_04;</p>

<p>&amp;ADDR:001B&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:001C&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:001D&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_5F;</p>

<p>&amp;ADDR:001E&nbsp;&nbsp; DebugMessage("own inside started"); // not processed in any way</p>

<p>&amp;ADDR:001F&nbsp;&nbsp; CALL PROC_69;</p>

<p>&amp;ADDR:0020&nbsp;&nbsp; IsProcessRunning(0x9BC217C0); // Enabled</p>

<p>&amp;ADDR:0021&nbsp;&nbsp; TEST &amp;SP_34 == &amp;SP_44;</p>

<p>&amp;ADDR:0022&nbsp;&nbsp; IF True GOTO LABEL_4B;</p>

<p>&amp;ADDR:0023&nbsp;&nbsp; IsEnvStringSet(0xDD076E3D);</p>

<p>&amp;ADDR:0024&nbsp;&nbsp; TEST &amp;SP_34 == &amp;SP_44;</p>

<p>&amp;ADDR:0025&nbsp;&nbsp; IF True GOTO LABEL_4B;</p>

<p>&amp;ADDR:0026&nbsp;&nbsp; IsDebugged(TODO flags); // 00000000 00000001 0000000F 00000000</p>

<p>&amp;ADDR:0027&nbsp;&nbsp; R0 = &amp;FLAG;</p>

<p>&amp;ADDR:0028&nbsp;&nbsp; R1 = 0x00000010;</p>

<p>&amp;ADDR:0029&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:002A&nbsp;&nbsp; R3 = &amp;SP_04;</p>

<p>&amp;ADDR:002B&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:002C&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:002D&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_4B;</p>

<p>&amp;ADDR:002E&nbsp;&nbsp; R0 = &amp;FLAG;</p>

<p>&amp;ADDR:002F&nbsp;&nbsp; R1 = 0x00000004;</p>

<p>&amp;ADDR:0030&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:0031&nbsp;&nbsp; R3 = &amp;SP_04;</p>

<p>&amp;ADDR:0032&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:0033&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:0034&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_66;</p>

<p>&amp;ADDR:0035&nbsp;&nbsp; R0 = &amp;FLAG;</p>

<p>&amp;ADDR:0036&nbsp;&nbsp; R1 = 0x00000008;</p>

<p>&amp;ADDR:0037&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:0038&nbsp;&nbsp; R3 = &amp;SP_04;</p>

<p>&amp;ADDR:0039&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:003A&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:003B&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_66;</p>

<p>&amp;ADDR:003C&nbsp;&nbsp; SP_4C = 0xFFFFFFF7;</p>

<p>&amp;ADDR:003D&nbsp;&nbsp; R0 = &amp;FLAG;</p>

<p>&amp;ADDR:003E&nbsp;&nbsp; R1 = 0x0000000C;</p>

<p>&amp;ADDR:003F&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:0040&nbsp;&nbsp; R3 = &amp;SP_4C;</p>

<p>&amp;ADDR:0041&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:0042&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:0043&nbsp;&nbsp; LOC_00 = &amp;R0[R1] &amp; &amp;R3[R4];</p>

<p>&amp;ADDR:0044&nbsp;&nbsp; R0 = &amp;LOC_00;</p>

<p>&amp;ADDR:0045&nbsp;&nbsp; R1 = 0x00000000;</p>

<p>&amp;ADDR:0046&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:0047&nbsp;&nbsp; R3 = &amp;SP_04;</p>

<p>&amp;ADDR:0048&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:0049&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:004A&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_66;</p>

<p>&amp;ADDR:004B&nbsp;&nbsp; LABEL_4B:</p>

<p>&amp;ADDR:004C&nbsp;&nbsp; IsProcessRunning("updatesrv.exe", "vsserv.exe", "pchooklaunch32.exe", "bdagent.exe", "seccenter.exe"); // Enabled</p>

<p>&amp;ADDR:004D&nbsp;&nbsp; TEST &amp;SP_34 == &amp;SP_44;</p>

<p>&amp;ADDR:004E&nbsp;&nbsp; IF True GOTO LABEL_5D;</p>

<p>&amp;ADDR:004F&nbsp;&nbsp; R0 = 0x00000100;</p>

<p>&amp;ADDR:0050&nbsp;&nbsp; R1 = 0x00000400;</p>

<p>&amp;ADDR:0051&nbsp;&nbsp; R2 = 0x00000000;</p>

<p>&amp;ADDR:0052&nbsp;&nbsp; R3 = 0x00000003;</p>

<p>&amp;ADDR:0053&nbsp;&nbsp; // TODO ID:7DD14382 DATA:b'00000000'</p>

<p>&amp;ADDR:0054&nbsp;&nbsp; TEST &amp;SP_34 == &amp;SP_44;</p>

<p>&amp;ADDR:0055&nbsp;&nbsp; IF True GOTO LABEL_5D;</p>

<p>&amp;ADDR:0056&nbsp;&nbsp; R0 = &amp;FLAG;</p>

<p>&amp;ADDR:0057&nbsp;&nbsp; R1 = 0x00000004;</p>

<p>&amp;ADDR:0058&nbsp;&nbsp; R2 = 0x00000004;</p>

<p>&amp;ADDR:0059&nbsp;&nbsp; R3 = &amp;SP_04;</p>

<p>&amp;ADDR:005A&nbsp;&nbsp; R4 = 0x00000000;</p>

<p>&amp;ADDR:005B&nbsp;&nbsp; R5 = 0x00000004;</p>

<p>&amp;ADDR:005C&nbsp;&nbsp; IF &amp;R0[R1] == &amp;R3[R4] GOTO LABEL_63;</p>

<p>&amp;ADDR:005D&nbsp;&nbsp; LABEL_5D:</p>

<p>&amp;ADDR:005E&nbsp;&nbsp; GOTO LABEL_61;</p>

<p>&amp;ADDR:005F&nbsp;&nbsp; LABEL_5F:</p>

<p>&amp;ADDR:0060&nbsp;&nbsp; CALL PROC_69;</p>

<p>&amp;ADDR:0061&nbsp;&nbsp; LABEL_61:</p>

<p>&amp;ADDR:0062&nbsp;&nbsp; Exit(0); // Exit process</p>

<p>&amp;ADDR:0063&nbsp;&nbsp; LABEL_63:</p>

<p>&amp;ADDR:0064&nbsp;&nbsp; SignalEvent(); // pre-process termination</p>

<p>&amp;ADDR:0065&nbsp;&nbsp; Exit(0); // Exit process</p>

<p>&amp;ADDR:0066&nbsp;&nbsp; LABEL_66:</p>

<p>&amp;ADDR:0067&nbsp;&nbsp; SignalEvent(); // pre-process termination</p>

<p>&amp;ADDR:0068&nbsp;&nbsp; Exit(0); // Exit process</p>

<p>&amp;ADDR:0069&nbsp;&nbsp; PROC_69:</p>

<p>&amp;ADDR:006A&nbsp;&nbsp; IsProcessRunning("aswidsagenta.exe", "avastui.exe", "avastsvc.exe"); // Enabled</p>

<p>&amp;ADDR:006B&nbsp;&nbsp; TEST &amp;SP_34 == &amp;SP_44;</p>

<p>&amp;ADDR:006C&nbsp;&nbsp; IF True GOTO LABEL_6F;</p>

<p>&amp;ADDR:006D&nbsp;&nbsp; InitData(start=&amp;ADDR:007A, end=&amp;ADDR:0081);</p>

<p>&amp;ADDR:006E&nbsp;&nbsp; RET;</p>

<p>&amp;ADDR:006F&nbsp;&nbsp; LABEL_6F:</p>

<p>&amp;ADDR:0070&nbsp;&nbsp; DebugMessage("no known av detected"); // not processed in any way</p>

<p>&amp;ADDR:0071&nbsp;&nbsp; InitData(start=&amp;ADDR:007A, end=&amp;ADDR:0081);</p>

<p>&amp;ADDR:0072&nbsp;&nbsp; RET;</p>

<p>&amp;ADDR:0073&nbsp;&nbsp; LABEL_73:</p>

<p>&amp;ADDR:0074&nbsp;&nbsp; DATA_DFE8715B = [0x00001F40, 0x00000001, 0x00000004, 0x00000001, 0x00001770, 0x00002000, 0x00000000, 0x000000C8, 0x00000064];</p>

<p>&amp;ADDR:0075&nbsp;&nbsp; DATA_97AC42CB = [0x00000000];</p>

<p>&amp;ADDR:0076&nbsp;&nbsp; DATA_PAYLOAD_TARGET_ENUMERATOR = [0x00000000, 0x00000000, "*'%ProgramFiles(x86)%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*instal#*;#!#*setup#*;#!#*config#*;#!#*iexplore.exe;#!#*chrome.exe;#!#*opera.exe';$'#!#*windows#*;#!#*adobe#*';!'0;0;-%!rndl_0_0_2_1_3%';$'#*';!'0;0;-%!rndl_0_0_2_1_3%';*'%ProgramW6432%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*install#*;#!#*setup#*;#!#*config#*';$'#!#*windows#*;#!#*adobe#*';!'0;0;-%!rndl_0_0_2_1_3%';$'#*';!'0;0;-%!rndl_0_0_2_1_3%'"];</p>

<p>&amp;ADDR:0077&nbsp;&nbsp; DATA_D3955141 = [0x00000001, 0x00000000, "%!system32W6432%\rundll32.exe; -%!rndl_0_0_2_1_3% %!rndl_0_0_2_3_8%.dll"];</p>

<p>&amp;ADDR:0078&nbsp;&nbsp; LABEL_78:</p>

<p>&amp;ADDR:0079&nbsp;&nbsp; LABEL_79:</p>

<p>&amp;ADDR:007A&nbsp;&nbsp; DATA_DFE8715B = [0x00001F40, 0x00000001, 0x00000004, 0x00000001, 0x00001770, 0x00002000, 0x00000000, 0x000000C8, 0x00000064];</p>

<p>&amp;ADDR:007B&nbsp;&nbsp; DATA_97AC42CB = [0x00000001];</p>

<p>&amp;ADDR:007C&nbsp;&nbsp; DATA_BB98FAB8 = [0x00000400];</p>

<p>&amp;ADDR:007D&nbsp;&nbsp; DATA_3FEF1B94 = [0x00000004];</p>

<p>&amp;ADDR:007E&nbsp;&nbsp; DATA_PAYLOAD_DROPPATH = "%SystemRoot%#*";</p>

<p>&amp;ADDR:007F&nbsp;&nbsp; DATA_PAYLOAD_DROPFILE = "#!#*flashutil32#*;#!#*flashplayerpl#*;#!#*windowslivemail#*";</p>

<p>&amp;ADDR:0080&nbsp;&nbsp; DATA_PROCLIST_EXCLUDE_EXT = ["iexplore.exe", "firefox.exe", "chrome.exe", "winword.exe", "outlook.exe", "excel.exe", "powerpnt.exe", "iexplore.exe", "firefox.exe", "chrome.exe", "winword.exe", "outlook.exe", "excel.exe", "powerpnt.exe", "acrord32.exe", "java.exe", "javaw.exe", "regsvr32.exe", "wscript.exe", "cscript.exe", "powershell.exe", "mshta.exe", "certutil.exe", "sqlservr.exe", "opera.exe", "msaccess.exe", "sysprep.exe", "setupsqm.exe", "cliconfg.exe", "winsat.exe", "mmc.exe", "oobe.exe", "inetmgr.exe", "taskhost.exe", "inetmgr.exe", "dism.exe", "dismhost.exe", "taskeng.exe", "cmd.exe", "wscript.exe", "cscript.exe", "java.exe", "powershell.exe", "mshta.exe", "winlogon.exe", "services.exe", "svchost.exe", "spoolsv.exe", "explorer.exe", "explorer.exe", "cmd.exe", "rundll32.exe", "msiexec.exe", "mspaint.exe", "notepad.exe", "calc.exe", "taskhost.exe", "dwm.exe", "taskmgr.exe", "msnmsgr.exe", 0xF6FE5321, "dllhost.exe", "runouce.exe", "vds.exe", "mstsc.exe", "mysqld.exe", "onenotem.exe", "dropbox.exe", "conhost.exe", "jusched.exe", "sihost.exe", "splwow64.exe", "msdt.exe", "onedrive.exe", "skype.exe", "solitaire.exe", "steam.exe"];</p>

<p>&amp;ADDR:0081&nbsp;&nbsp; DATA_PAYLOAD_TARGET_ENUMERATOR = [0x00000000, 0x00000000, "*'%ProgramFiles(x86)%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*instal#*;#!#*setup#*;#!#*config#*;#!#*iexplore.exe;#!#*chrome.exe;#!#*opera.exe';$'#!#*windows#*;#!#*adobe#*';!'0;0;-%!rndl_0_0_2_1_3%';$'#*';!'0;0;-%!rndl_0_0_2_1_3%';*'%ProgramW6432%;#!#*.exe';@'#!#*avast#*;#!#*defender#*;#!#*uninstall#*;#!#*install#*;#!#*setup#*;#!#*config#*';$'#!#*windows#*;#!#*adobe#*';!'0;0;-%!rndl_0_0_2_1_3%';$'#*';!'0;0;-%!rndl_0_0_2_1_3%'"];</p>

<p>&amp;ADDR:0082&nbsp;&nbsp; LABEL_82:</p>

<p>&amp;ADDR:0083&nbsp;&nbsp; LABEL_83:</p>

<p>&amp;ADDR:0084&nbsp;&nbsp; DATA_8568A01D = [0x00000001, 0x00000001];</p>

<p>&amp;ADDR:0085&nbsp;&nbsp; DATA_14A8D56E = [0x00, 0x02, 0x00, 0x00, 0xD4, 0x30, 0x37, 0xBF, 0x80, 0x4B, 0x8F, 0xE0, 0xE5, 0xCC, 0x27, 0xE7, 0x23, 0xCF, 0x53, 0x37, 0xB1, 0x46, 0xD8, 0x03, 0xCA, 0xEE, 0x29, 0x4B, 0x66, 0x8A, 0x9A, 0xCA, 0x51, 0xA8, 0x95, 0x81, 0x28, 0x93, 0x01, 0xF9, 0x60, 0x7D, 0x9A, 0x6C, 0xB2, 0x93, 0x15, 0x2B, 0x44, 0xC0, 0x6F, 0x6F, 0xB7, 0x1A, 0xC8, 0x12, 0x52, 0x1A, 0xC7, 0x28, 0x0A, 0x46, 0x0D, 0x2E, 0x84, 0x50, 0x9B, 0xFD, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x01];</p>

<p>&amp;ADDR:0086&nbsp;&nbsp; DATA_56B437D3 = ["system", "lsass.exe", "smss.exe", "csrss.exe", "wininit.exe", "services.exe", "lsm.exe", "audiodg.exe", "svchost.exe", "winlogon.exe", "spoolsv.exe", "searchindexer.exe", "msdtc.exe", "searchprotocolhost.exe", "dllhost.exe"];</p>

<p>&amp;ADDR:0087&nbsp;&nbsp; DATA_DBED7DFB = ["system", "lsass.exe", "smss.exe", "csrss.exe", "wininit.exe", "services.exe", "lsm.exe", "audiodg.exe", "svchost.exe", "winlogon.exe", "spoolsv.exe", "searchindexer.exe", "msdtc.exe", "explorer.exe", "dwm.exe"];</p>

<p>&amp;ADDR:0088&nbsp;&nbsp; DATA_PROCLIST_EXCLUDE = ["wininit.exe", "csrss.exe", "smss.exe", "avp.exe", "avpui.exe", "avgnt.exe", "avguard.exe", "sched.exe", "aswidsagenta.exe", "avastsvc.exe", "avastui.exe", "ccsvchst.exe", "avgcsrvx.exe", "avgnsx.exe", "avgrsx.exe", "avgtray.exe", 0x6EEA1E2D, "avgwdsvc.exe", "ekrn.exe", "egui.exe", "msmpeng.exe", "msseces.exe", "mpcmdrun.exe", "psimsvc.exe", "apvxdwin.exe", "avengine.exe", "pavfnsvr.exe", "pavprsrv.exe", "pavsrvx86.exe", "psctrls.exe", "psksvc.exe", "fpavserver.exe", 0xBAA21E23, "fpwin.exe", "cmdagent.exe", "cfp.exe", "gdscan.exe", "gdsc.exe", "avktray.exe", "avkservice.exe", "avkproxy.exe", "pctsgui.exe", "pctssvc.exe", "pctsauxs.exe", "update.exe", "updatesrv.exe", "vsserv.exe", "pchooklaunch32.exe", "bdagent.exe", "seccenter.exe", "mrt.exe", "mcupdate.exe", "mcagent.exe", "mcmscsvc.exe", "mcnasvc.exe", "mcproxy.exe", "mcsacore.exe", "mcshell.exe", "mcshield.exe", "mcsysmon.exe", "mpfsrv.exe", "msksrver.exe", "udaterui.exe", "engineserver.exe", "frameworkservice.exe", "engineserver.exe", "frameworkservice.exe", "mctray.exe", "naprdmgr.exe", "shstat.exe", "vstskmgr.exe", "almon.exe", "alsvc.exe", "savadminservice.exe", 0x12FCC4EB, "savservice.exe", "swi_service.exe", 0xBC6D3196, "protoolbarupdate.exe", "sfctlcom.exe", "tmbmsrv.exe", "tmpfw.exe", "tmproxy.exe", "tscfplatformcomsvr.exe", 0xAEF84E17, "ufseagnt.exe", 0x3DC44746, 0x13F2ED0D, 0x4B4EA20C, "umxagent.exe", "umxcfg.exe", "umxpol.exe", "caav.exe", "casc.exe", "cavrid.exe", "ccprovsp.exe", "vetmsg.exe", "vmwaretray.exe", "vmwareuser.exe", 0xBD157242, "vmtoolsd.exe", "wrsa.exe"];</p>

<p>&amp;ADDR:0089&nbsp;&nbsp; DATA_5DD00BF4 = ["winlogon.exe"];</p>

<p>&amp;ADDR:008A&nbsp;&nbsp; DATA_87045172 = ["explorer.exe", "dwm.exe", "taskhost.exe", "conhost.exe"];</p>

<p>&amp;ADDR:008B&nbsp;&nbsp; DATA_0B7EEE53 = [0x00000000];</p>

<p>&amp;ADDR:008C&nbsp;&nbsp; DATA_FFF28C72 = "zepter.com;carfax.com;";</p>

<p>&amp;ADDR:008D&nbsp;&nbsp; DATA_GOOGLE_DNS = [0x00000003, timeout_write=8000, timeout_read=8000, 0x00000001, 0x00000002, "8.8.8.8:53;8.8.4.4:53"];</p>

<p>&amp;ADDR:008E&nbsp;&nbsp; DATA_992CC894 = [0x00000000, 0x00000001, 0x00000001, 0x00000002, 0x00000001, 0x00000001, 0x00000000, 0x00000000, 0x00000000, 0x00000000, "gx3Gd93kdXdjd]dGdg573"];</p>

<p>&amp;ADDR:008F&nbsp;&nbsp; DATA_8DB1E244 = [0x00000001, 0x18482642, 0x78643587, 0x87568289, 0x00000010];</p>

<p>&amp;ADDR:0090&nbsp;&nbsp; DATA_C9393B40 = "~[duewosgems.com];fiosbewos.com;";</p>

<p>&amp;ADDR:0091&nbsp;&nbsp; DATA_F50DF89A = [0x00000019, 0x000493E0, 0x00000001, 0x00000001, "~[duewosgems.com]/pkbn74is/index.php;fiosbewos.com/pkbn74is/index.php;"];</p>

<p>&amp;ADDR:0092&nbsp;&nbsp; LABEL_92:</p>

<p>&amp;ADDR:0093&nbsp;&nbsp; END;</p>

<p><strong>Conclusion</strong></p>

<p>Nymaim is one of a number of downloaders appearing regularly in the wild, reflecting the trend of installing persistent malware on victim devices. Although Nymaim has a long history as a downloader and earlier incarnations as ransomware and a desktop locker, little is known about its ownership or availability to other threat actors. We were, however, able to decode the unique config, providing additional insight for defenders and potential victims of increasingly frequent Nymaim campaigns.</p>

<p><strong>References</strong></p>

<p>[1] <u><a href="https://www.welivesecurity.com/2013/08/26/nymaim-obfuscation-chronicles/">https://www.welivesecurity.com/2013/08/26/nymaim-obfuscation-chronicles/</a></u></p>

<p>[2] <u><a href="https://www.proofpoint.com/us/what-old-new-again-nymaim-moves-past-its-ransomware-roots-0">https://www.proofpoint.com/us/what-old-new-again-nymaim-moves-past-its-ransomware-roots-0</a></u></p>

<p>[3] <u><a href="https://www.welivesecurity.com/2013/10/23/nymaim-browsing-for-trouble/">https://www.welivesecurity.com/2013/10/23/nymaim-browsing-for-trouble/</a></u></p>

<p>[4] <a href="http://www.eset.com/int/about/press/articles/article/nymaim-ransomware-still-active-finding-new-infection-vector-to-spread-black-hat-seo/">http://www.eset.com/int/about/press/articles/article/nymaim-ransomware-still-active-finding-new-infection-vector-to-spread-black-hat-seo/</a></p>

<p>[5] <u><a href="https://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Ransom:Win32/Nymaim.F#tab=2">https://www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Ransom:Win32/Nymaim.F#tab=2</a></u></p>

<p>[6] <u><a href="https://github.com/EmergingThreats/threatresearch/blob/master/Nymaim/config_decompiler.py">https://github.com/EmergingThreats/threatresearch/blob/master/Nymaim/config_decompiler.py</a></u></p>

<p>&nbsp;</p>

<p><strong>Indicators of Compromise (IOCs)</strong></p>

<table border="1" cellpadding="0" cellspacing="0" width="624">
	<tbody>
		<tr>
			<td style="width:382px;">
			<p><strong>IOC</strong></p>
			</td>
			<td style="width:88px;">
			<p><strong>IOC Type</strong></p>
			</td>
			<td style="width:154px;">
			<p><strong>Description</strong></p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>76b855f4822c0b26e098d7395723b31ad73c1606aebdb972380ef6c9f0bb4936</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>Nymaim sample (2019)</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>8cb27fca6cf68888126a82c304083ebd78bba2b9f6fb241d2a177a3a80f12e8a</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>Nymaim sample (2019)</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>0f115ff9d7ecbe2b4872a18c14e97d6071a61435690729c9aa741cecc8982383</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>Nymaim sample (2019)</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>7541c32d82b17e9d3a993f6721a1b84221dfbee6cbe7f060413a118c48ae64ee</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>Nymaim sample (2019)</p>
			</td>
		</tr>
		<tr>
			<td style="width:382px;">
			<p>43c19be78773a14196abb4ecb6436b54729373eacf84da7a9a2c3592ad960cae</p>
			</td>
			<td style="width:88px;">
			<p>SHA256</p>
			</td>
			<td style="width:154px;">
			<p>Nymaim sample (2019)</p>
			</td>
		</tr>
	</tbody>
</table>

</div>
  </div>

      <div class="blog__content-pager">
      
  <div class="content-pager">
    <div class="content-pager__items-wrapper">
      <div class="content-pager__items">
        <div class="content-pager__item content-pager__item--prev">
          <a href="/us/threat-insight/post/fake-jobs-campaigns-delivering-moreeggs-backdoor-fake-job-offers" hreflang="en">Previous Blog Post</a>
        </div>
        <div class="content-pager__item content-pager__item--next">
          <a href="/us/threat-insight/post/danabot-control-panel-revealed" hreflang="en">Next Blog Post</a>
        </div>
      </div>
    </div>
  </div>

    </div>
        




  
        
<div class="subscribe-block blog-subscribe subscribe-block--black blog-subscribe--black v3-dark-bg-only" data-animate="true">
  <div class="subscribe-block__inner blog-subscribe__inner">
    <div class="subscribe-block__copy">
      

      
<h3 class="subscribe-block__heading">
      Subscribe to the Proofpoint Blog
  </h3>

          </div>
    <div class="subscribe-block__form">
        <div class="mk-form">
  <div class="mk-form__form-container">
    <script type="IN/Form2"
      data-data-form="mktoForm_19277"
      data-field-firstname="FirstName"
      data-field-lastname="LastName"
      data-field-email="Email"
      data-field-company="Company"
      data-field-title="Title"
      data-field-state="State"
      data-field-country="Country"
    ></script>
    <form
      id="mktoForm_19277"
      data-mkto-id="19277"
      data-mkto-base="//go.proofpoint.com"
      data-munchkin-id="309-RHV-619"
      data-submit-text=""
      data-redirect-link=""
      data-prefill=""
      data-event-label=""
      data-lang-code="us"
      data-validate-email="1"
      class="mk-form__form marketo-form-block__form"
    ></form>
  </div>
</div>


    </div>
  </div>
</div>



  </article>


  </div>

  </div>

      </div>
    </section>
  </main>

</div>

<div class="footer-v3" data-animate="true">
  <div class="footer-v3__inner">
          <nav class="footer-v3__nav">
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Products</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="/us/products/protect-people">Protect People</a></li>
            <li><a href="/us/products/defend-data">Defend Data</a></li>
            <li><a href="/us/products/mitigate-human-risk">Mitigate Human Risk</a></li>
            <li><a href="/us/products/premium-services">Premium Services</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Get Support</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="https://proofpoint.my.site.com/community/s/" target="_blank">Product Support Login</a></li>
            <li><a href="/us/support-services">Support Services</a></li>
            <li><a href="https://ipcheck.proofpoint.com" target="_blank">IP Address Blocked?</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">Connect with Us</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="tel:+1-408-517-4710" class="icon-phone-ppoint">+1-408-517-4710</a></li>
            <li><a href="/us/events">Attend an Event</a></li>
            <li><a href="/us/contact">Contact Us</a></li>
            <li><a href="/us/free-demo-request">Free Demo Request</a></li>
          </ul>
        </div>
        <div class="footer-v3__nav-wrapper">
          <div class="footer-v3__nav-heading">More</div>
          <ul class="footer-v3__nav-collapsible">
            <li><a href="/us/company/about">About Proofpoint</a></li>
            <li><a href="/us/why-proofpoint">Why Proofpoint</a></li>
            <li><a href="/us/company/careers">Careers</a></li>
            <li><a href="/us/leadership-team">Leadership Team</a></li>
            <li><a href="/us/newsroom">News Center</a></li>
            <li><a href="/us/legal/trust">Privacy and Trust</a></li>
          </ul>
        </div>
      </nav>
        <div class="footer-v3__bottom-wrap">
      <section class="footer-v3__bottom">
        <div class="footer-v3__logo">
          <a href="/us" class="footer-v3__logo-link">
            <div class="footer-v3__logo-image"></div>
          </a>
          <div class="footer-v3__bottom-copyright-info">&copy;
            2025.
            All rights reserved.
          </div>
        </div>
        <div class="footer-v3__bottom-copyright">
          <a class="footer-v3__bottom-copyright-info" href="/us/legal/license">Terms and conditions</a>
          <a class="footer-v3__bottom-copyright-info" href="/us/legal/privacy-policy">Privacy Policy</a>
          <a class="footer-v3__bottom-copyright-info" href="/us/sitemap">Sitemap</a>
        </div>
        <ul class="footer-v3__bottom-social-menu">
          <li>
            <a href="http://www.facebook.com/proofpoint" class="icon-facebook" target="_blank"></a>
          </li>
          <li>
            <a href="http://www.twitter.com/proofpoint" class="icon-twitter" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.linkedin.com/company/proofpoint" class="icon-linkedin" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.youtube.com/channel/UCIvtJgsrUzFo90NKeiVozhQ" class="icon-youtube-play" target="_blank"></a>
          </li>
          <li>
            <a href="https://www.instagram.com/proofpoint" class="icon-instagram" target="_blank"></a>
          </li>
        </ul>
      </section>
    </div>
  </div>
</div>


  </div>

      <script type="text/javascript">document.write(unescape("%3Cscript src='//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E")); </script> <script>Munchkin.init('309-RHV-619');</script><div class="element-invisible" style="clear:both;"><!-- Google Code for Remarketing Tag -->
                <!--------------------------------------------------
                Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. See more information and instructions on how to setup the tag on: http://google.com/ads/remarketingsetup
                --------------------------------------------------->
                <script type="text/javascript">
                /* <![CDATA[ */
                var google_conversion_id = 950296937;
                var google_custom_params = window.google_tag_params;
                var google_remarketing_only = true;
                /* ]]> */
                </script>
                <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
                </script>
                <noscript>
                <div style="display:inline;">
                <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/950296937/?value=0&amp;guid=ON&amp;script=0"/>
                </div>
                </noscript></div>
    </div>
    <div id="flyout-container"></div>
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","pathPrefix":"us\/","currentPath":"node\/58211","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","suppressDeprecationErrors":true,"ajaxPageState":{"libraries":"eJxVj0GOBCEIRS9Uxkxm07eZgE2rKQWD2EnffqxadFkbEh7w_6eBWg6FPBYJu-sDe9CM5HCYCW9tmcd7dy0vXAmeQUfFfsEgbMTmGkTSFety-RIxUvf-vVAsglAcFarzfBGMIrGQe8mNpmk9FRjed5Z5Cb48eDy8tfaXfx7sC3AcM597klEw0WNSQXcy8XVwSHvmg3UCDckPy6WffQKdske1lE9kaQb2BsiAeLp_mUhB0K1_ulH1CJ3-Ae6OlH4","theme":"particle","theme_token":null},"ajaxTrustedUrl":[],"vwo":{"id":1002484,"timeout_library":2500,"timeout_setting":2000,"usejquery":"false","testnull":null},"pp_i18n":{"language":"us"},"instantsearch":{"indexName":"content","path":"search"},"user":{"uid":0,"permissionsHash":"950e699712383dfb12102e31b44368231fb90da457b28535a744dde764a08ef5"}}</script>
<script src="/sites/default/files/js/js_0PTCwSWOAiJfplqS7IFUoDMAex3W5Bbe_Jb-l5UBdEg.js?scope=footer&amp;delta=0&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="https://geoip-js.com/js/apis/geoip2/v2.1/geoip2.js"></script>
<script src="/sites/default/files/js/js_wkNfGxWc0_xjHnljIpXLLuxGbYfbmVyUkyJqtaY6aW8.js?scope=footer&amp;delta=2&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//munchkin.marketo.net/munchkin.js"></script>
<script src="/sites/default/files/js/js_zEAv3h028JMo53L_-Row7FrtbUFIpsoOM8aflgqba6U.js?scope=footer&amp;delta=4&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="/themes/custom/proofpoint/apps/drupal/../../dist/app-drupal/assets/js/app.js?q=oTIF1xfmvVY&amp;v=1"></script>
<script src="/sites/default/files/js/js_zzdzQ-ZTO1G8iCWRlb03McG3cjvNopJ7pLFZ6iL6viI.js?scope=footer&amp;delta=6&amp;language=en&amp;theme=particle&amp;include=eJxNjVEKwzAMQy-0Yva32xTH82LTxA6Oc_-tZbD9CCTxpDF2vT8MGlpdWHl7cjKlx22MvWMcnA59GcmhdmaTMUhgpbZ5-hTuDOneCn4gjFRqDOTBfzUWw1LU6jUhGAyXpuj8Qd-_7eXR38ApO00"></script>
<script src="//go.proofpoint.com/js/forms2/js/forms2.min.js"></script>

  </body>
</html>
